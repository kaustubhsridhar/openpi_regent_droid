nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
09:14:00.886 [I] Running on: ivy                                                                  (2169255:train_pi0_fast_regent.py:209)
INFO:2025-03-02 09:14:01,413:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
09:14:01.413 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2169255:xla_bridge.py:945)
INFO:2025-03-02 09:14:01,414:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
09:14:01.414 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2169255:xla_bridge.py:945)
09:14:02.270 [I] Wiped checkpoint directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent/first_try (2169255:checkpoints.py:25)
09:14:02.270 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (2169255:base_pytree_checkpoint_handler.py:332)
09:14:02.270 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (2169255:base_pytree_checkpoint_handler.py:332)
09:14:02.270 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2169255:multihost.py:375)
09:14:02.271 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7fe2784daa50>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe2780232d0>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe278020550>}, handler_registry=None (2169255:checkpoint_manager.py:622)
09:14:02.271 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7fe2784daa50>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (2169255:composite_checkpoint_handler.py:239)
09:14:02.271 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe2780232d0>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2169255:composite_checkpoint_handler.py:239)
09:14:02.271 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe278020550>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2169255:composite_checkpoint_handler.py:239)
09:14:02.272 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fe2784dac10>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (2169255:composite_checkpoint_handler.py:239)
09:14:02.272 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fe2784daa50>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fe2784daa50>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe2780232d0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe2780232d0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe278020550>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe278020550>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fe2784dac10>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fe2784dac10>}). (2169255:composite_checkpoint_handler.py:508)
09:14:02.272 [I] orbax-checkpoint version: 0.11.1                                                 (2169255:abstract_checkpointer.py:35)
09:14:02.272 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7fe2780267a0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (2169255:async_checkpointer.py:80)
09:14:02.273 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent/first_try (2169255:checkpoint_manager.py:1528)
09:14:02.273 [I] Saving root metadata                                                             (2169255:checkpoint_manager.py:1569)
09:14:02.273 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (2169255:multihost.py:293)
09:14:02.273 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent/first_try: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7fe27814aa10> (2169255:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250302_091402-4x8k7518
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run first_try
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/4x8k7518
Some kwargs in processor config are unused and will not have any effect: time_horizon, action_dim, min_token, scale, vocab_size. 
Some kwargs in processor config are unused and will not have any effect: time_horizon, action_dim, min_token, scale, vocab_size. 
09:14:04.399 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent/droid (2169255:config.py:167)
len_dataset: 1159833
09:14:23.677 [I] Initialized data loader:
[0].query_image_masks['base_0_rgb']: (32,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (32,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (32,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (32,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (32,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (32,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (32,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (32,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (32,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (32,)@bool
[0].retrieved_4_image_masks['base_0_rgb']: (32,)@bool
[0].retrieved_4_image_masks['left_wrist_0_rgb']: (32,)@bool
[0].query_image_embeddings['base_0_rgb']: (32, 1, 2048)@float32
[0].query_image_embeddings['left_wrist_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_0_image_embeddings['base_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_0_image_embeddings['left_wrist_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_1_image_embeddings['base_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_1_image_embeddings['left_wrist_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_2_image_embeddings['base_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_2_image_embeddings['left_wrist_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_3_image_embeddings['base_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_3_image_embeddings['left_wrist_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_4_image_embeddings['base_0_rgb']: (32, 1, 2048)@float32
[0].retrieved_4_image_embeddings['left_wrist_0_rgb']: (32, 1, 2048)@float32
[0].query_state: (32, 8)@float32
[0].retrieved_0_state: (32, 8)@float32
[0].retrieved_1_state: (32, 8)@float32
[0].retrieved_2_state: (32, 8)@float32
[0].retrieved_3_state: (32, 8)@float32
[0].retrieved_4_state: (32, 8)@float32
[0].query_tokenized_prompt: (32, 180)@int32
[0].retrieved_0_tokenized_prompt: (32, 180)@int32
[0].retrieved_1_tokenized_prompt: (32, 180)@int32
[0].retrieved_2_tokenized_prompt: (32, 180)@int32
[0].retrieved_3_tokenized_prompt: (32, 180)@int32
[0].retrieved_4_tokenized_prompt: (32, 180)@int32
[0].query_tokenized_prompt_mask: (32, 180)@bool
[0].retrieved_0_tokenized_prompt_mask: (32, 180)@bool
[0].retrieved_1_tokenized_prompt_mask: (32, 180)@bool
[0].retrieved_2_tokenized_prompt_mask: (32, 180)@bool
[0].retrieved_3_tokenized_prompt_mask: (32, 180)@bool
[0].retrieved_4_tokenized_prompt_mask: (32, 180)@bool
[0].query_token_ar_mask: (32, 180)@int32
[0].retrieved_0_token_ar_mask: (32, 180)@int32
[0].retrieved_1_token_ar_mask: (32, 180)@int32
[0].retrieved_2_token_ar_mask: (32, 180)@int32
[0].retrieved_3_token_ar_mask: (32, 180)@int32
[0].retrieved_4_token_ar_mask: (32, 180)@int32
[0].query_token_loss_mask: (32, 180)@bool
[0].retrieved_0_token_loss_mask: (32, 180)@bool
[0].retrieved_1_token_loss_mask: (32, 180)@bool
[0].retrieved_2_token_loss_mask: (32, 180)@bool
[0].retrieved_3_token_loss_mask: (32, 180)@bool
[0].retrieved_4_token_loss_mask: (32, 180)@bool
[1]: (32, 8)@float32 (2169255:train_pi0_fast_regent.py:241)
09:14:24.240 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (2169255:base_pytree_checkpoint_handler.py:332)
09:14:24.266 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (2169255:checkpointer.py:256)
09:14:44.954 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 539.1 MiB/s (total bytes: 10.9 GiB) (time elapsed: 20 seconds) (per-host) (2169255:base_pytree_checkpoint_handler.py:113)
09:14:44.954 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (2169255:checkpointer.py:259)
09:14:44.955 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (2169255:multihost.py:293)
2025-03-02 09:14:48.572137: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 20.88GiB (22423335423 bytes) by rematerialization; only reduced to 37.38GiB (40136508028 bytes), down from 37.38GiB (40136508028 bytes) originally
09:14:50.025 [I] Initialized train state:
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (2169255:train_pi0_fast_regent.py:245)
decode_indices shape: (1074,)
09:14:50.111 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:00 postfix:-                  (2169255:tqdm_logging.py:145)
input_token_embeddings shape: (32, 1092, 2048)
attn_mask shape: (32, 1092, 1092)
loss_mask shape: (32, 1074)
targets shape: (32, 1074, 257152)
pre_logits shape: (32, 1091, 2048)
logits shape: (32, 1074, 257152)
logp shape: (32, 1074, 257152)
token_pplx shape: (32, 1074)
loss shape: (32,)
2025-03-02 09:14:51.482413: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.538650: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.553351: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.690910: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.695816: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.707637: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.710896: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.718691: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.766577: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:51.766963: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:53.089290: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:53.621680: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:53.878390: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:54.639426: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.149846: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.154972: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.162222: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.355566: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.410635: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 33.19GiB (35636936720 bytes), down from 33.19GiB (35636936720 bytes) originally
2025-03-02 09:14:55.509214: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.626561: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.750137: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.825218: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.844324: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.915141: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:55.997278: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:56.171162: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:56.189825: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:56.210738: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:56.221515: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:56.253465: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:14:56.258676: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 26.89GiB (28871253360 bytes) by rematerialization; only reduced to 32.92GiB (35351199744 bytes), down from 32.92GiB (35351199744 bytes) originally
2025-03-02 09:15:01.875304: W external/xla/xla/tsl/framework/bfc_allocator.cc:310] Allocator (GPU_0_bfc) ran out of memory trying to allocate 32.94GiB with freed_by_count=0. The caller indicates that this is not a failure, but this may mean that there could be performance gains if more memory were available.
09:15:01.905 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:11 postfix:-                  (2169255:tqdm_logging.py:145)
Traceback (most recent call last):
  File "/home/ksridhar/openpi_regent_droid/scripts/train_pi0_fast_regent.py", line 289, in <module>
    main(_config.cli())
  File "/home/ksridhar/openpi_regent_droid/scripts/train_pi0_fast_regent.py", line 270, in main
    train_state, info = ptrain_step(train_rng, train_state, batch)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 35367976960 bytes.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
[1;34mwandb[0m: üöÄ View run [33mfirst_try[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/4x8k7518[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250302_091402-4x8k7518/logs[0m
