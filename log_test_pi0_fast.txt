(openpi) (branch: main) ksridhar@ivy:~/openpi_regent_droid$ CUDA_VISIBLE_DEVICES=5 python scripts/test_pi0_fast.py 
18:15:23.456 [I] Loading model...                                                                 (2713038:policy_config.py:55)
INFO:2025-03-05 18:15:23,982:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
18:15:23.982 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2713038:xla_bridge.py:945)
INFO:2025-03-05 18:15:23,983:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
18:15:23.983 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2713038:xla_bridge.py:945)
18:15:23.996 [I] orbax-checkpoint version: 0.11.1                                                 (2713038:abstract_checkpointer.py:35)
18:15:23.996 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (2713038:base_pytree_checkpoint_handler.py:332)
18:15:24.025 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (2713038:checkpointer.py:256)
18:15:43.822 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2713038:multihost.py:375)
18:15:43.823 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 281.7 MiB/s (total bytes: 5.4 GiB) (time elapsed: 19 seconds) (per-host) (2713038:base_pytree_checkpoint_handler.py:113)
18:15:43.823 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (2713038:checkpointer.py:259)
18:15:43.824 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (2713038:multihost.py:293)
18:15:45.192 [I] Norm stats not found in /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid/droid, skipping. (2713038:config.py:170)
Some kwargs in processor config are unused and will not have any effect: vocab_size, min_token, time_horizon, scale, action_dim. 
Some kwargs in processor config are unused and will not have any effect: vocab_size, min_token, time_horizon, scale, action_dim. 
18:15:46.318 [I] Loaded norm stats from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/assets/droid (2713038:checkpoints.py:109)
outputs: {'actions': array([4.02200e+03, 2.35292e+05, 2.35248e+05, 2.56757e+05, 2.56672e+05,
       2.56757e+05, 2.55811e+05, 2.56071e+05, 2.56584e+05, 2.56757e+05,
       2.56474e+05, 2.56740e+05, 2.56455e+05, 2.56661e+05, 2.56722e+05,
       2.55597e+05, 2.56736e+05, 2.56762e+05, 2.56708e+05, 2.35371e+05,
       1.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00, 0.00000e+00,
       0.00000e+00], dtype=float32), 'state': array([ 0.01869074, -0.77366734,  0.03449751, -0.77577007,  0.04463369,
       -0.41322666, -0.04858513, -1.        ], dtype=float32)}
18:16:02.700 [I] final_outputs: {'actions': array([[-0.04296727,  0.13859412,  0.03042152,  0.04564406, -0.01839382,
         0.09444006,  0.06018246, -0.00596324],
       [-0.04101812,  0.20713741,  0.02122685,  0.07465029, -0.01839382,
         0.13228586,  0.04162686, -0.00596324],
       [-0.03731063,  0.31142665,  0.0058005 ,  0.12583225, -0.01839382,
         0.18560517,  0.00977213, -0.00596324],
       [-0.0322077 ,  0.40736611, -0.01100952,  0.18772202, -0.01839382,
         0.22589523, -0.0266973 , -0.00596324],
       [-0.02620885,  0.46660713, -0.02421977,  0.24780354, -0.01839382,
         0.23834293, -0.05864532, -0.00596324],
       [-0.01990128,  0.48974355, -0.03047416,  0.29620443, -0.01839382,
         0.23007027, -0.0795045 , -0.00596324],
       [-0.01390243,  0.49776419, -0.02916048,  0.32818688, -0.01839382,
         0.22122272, -0.08723299, -0.00596324],
       [-0.0087995 ,  0.51082735, -0.02247029,  0.3446114 , -0.01839382,
         0.22705634, -0.0845144 , -0.00596324],
       [-0.00509201,  0.53224029, -0.01439643,  0.3503281 , -0.01839382,
         0.24591921, -0.0771811 , -0.00596324],
       [-0.00314286,  0.5495632 , -0.00906718,  0.35123526, -0.01839382,
         0.26246975, -0.07151718, -0.00596324]])} (2713038:policy.py:70)
action_chunk.shape=(10, 8)
action_chunk=array([[-0.04296727,  0.13859412,  0.03042152,  0.04564406, -0.01839382,
         0.09444006,  0.06018246, -0.00596324],
       [-0.04101812,  0.20713741,  0.02122685,  0.07465029, -0.01839382,
         0.13228586,  0.04162686, -0.00596324],
       [-0.03731063,  0.31142665,  0.0058005 ,  0.12583225, -0.01839382,
         0.18560517,  0.00977213, -0.00596324],
       [-0.0322077 ,  0.40736611, -0.01100952,  0.18772202, -0.01839382,
         0.22589523, -0.0266973 , -0.00596324],
       [-0.02620885,  0.46660713, -0.02421977,  0.24780354, -0.01839382,
         0.23834293, -0.05864532, -0.00596324],
       [-0.01990128,  0.48974355, -0.03047416,  0.29620443, -0.01839382,
         0.23007027, -0.0795045 , -0.00596324],
       [-0.01390243,  0.49776419, -0.02916048,  0.32818688, -0.01839382,
         0.22122272, -0.08723299, -0.00596324],
       [-0.0087995 ,  0.51082735, -0.02247029,  0.3446114 , -0.01839382,
         0.22705634, -0.0845144 , -0.00596324],
       [-0.00509201,  0.53224029, -0.01439643,  0.3503281 , -0.01839382,
         0.24591921, -0.0771811 , -0.00596324],
       [-0.00314286,  0.5495632 , -0.00906718,  0.35123526, -0.01839382,
         0.26246975, -0.07151718, -0.00596324]])
(openpi) (branch: main) ksridhar@ivy:~/openpi_regent_droid$ 




______________________________________________

(openpi) (branch: main) ksridhar@ivy:~/openpi_regent_droid$ CUDA_VISIBLE_DEVICES=5 python scripts/test_pi0_fast.py
21:19:59.562 [I] Loading model...                                                                 (2961063:policy_config.py:55)
INFO:2025-03-06 21:20:00,081:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
21:20:00.081 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2961063:xla_bridge.py:945)
INFO:2025-03-06 21:20:00,082:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
21:20:00.082 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2961063:xla_bridge.py:945)
21:20:00.094 [I] orbax-checkpoint version: 0.11.1                                                 (2961063:abstract_checkpointer.py:35)
21:20:00.094 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (2961063:base_pytree_checkpoint_handler.py:332)
21:20:00.114 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (2961063:checkpointer.py:256)
21:20:19.407 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2961063:multihost.py:375)
21:20:19.409 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 289.0 MiB/s (total bytes: 5.4 GiB) (time elapsed: 19 seconds) (per-host) (2961063:base_pytree_checkpoint_handler.py:113)
21:20:19.410 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (2961063:checkpointer.py:259)
21:20:19.410 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (2961063:multihost.py:293)
21:20:20.741 [I] Norm stats not found in /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid/droid, skipping. (2961063:config.py:170)
Some kwargs in processor config are unused and will not have any effect: scale, min_token, action_dim, vocab_size, time_horizon. 
Some kwargs in processor config are unused and will not have any effect: scale, min_token, action_dim, vocab_size, time_horizon. 
21:20:21.817 [I] Loaded norm stats from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/assets/droid (2961063:checkpoints.py:109)
prefix_attn_mask shape: (1, 1018, 1274)
prefix_positions shape: (1, 1018)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[815]]
token_embedding shape: (1, 1, 2048)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[816]]
token_embedding shape: (1, 1, 2048)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[817]]
token_embedding shape: (1, 1, 2048)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[818]]
token_embedding shape: (1, 1, 2048)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[819]]
token_embedding shape: (1, 1, 2048)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[820]]
token_embedding shape: (1, 1, 2048)
mask shape: (1, 1, 1274)
mask values: [[[False False False ... False False False]]]
positions shape: (1, 1)
positions values: [[821]]
token_embedding shape: (1, 1, 2048)