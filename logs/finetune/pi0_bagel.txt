nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
09:22:50.993 [I] Running on: ivy                                                                  (501617:train.py:195)
INFO:2025-04-08 09:22:51,926:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
09:22:51.926 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (501617:xla_bridge.py:945)
INFO:2025-04-08 09:22:51,927:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
09:22:51.927 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (501617:xla_bridge.py:945)
09:22:53.114 [I] Wiped checkpoint directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel (501617:checkpoints.py:25)
09:22:53.114 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (501617:base_pytree_checkpoint_handler.py:332)
09:22:53.114 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (501617:base_pytree_checkpoint_handler.py:332)
09:22:53.114 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (501617:multihost.py:375)
09:22:53.115 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7fdb1afcf310>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1c231790>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1b14a390>}, handler_registry=None (501617:checkpoint_manager.py:622)
09:22:53.115 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7fdb1afcf310>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (501617:composite_checkpoint_handler.py:239)
09:22:53.115 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1c231790>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (501617:composite_checkpoint_handler.py:239)
09:22:53.115 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1b14a390>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (501617:composite_checkpoint_handler.py:239)
09:22:53.115 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fdb1b2d3c10>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (501617:composite_checkpoint_handler.py:239)
09:22:53.115 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fdb1afcf310>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fdb1afcf310>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1c231790>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1c231790>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1b14a390>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fdb1b14a390>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fdb1b2d3c10>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fdb1b2d3c10>}). (501617:composite_checkpoint_handler.py:508)
09:22:53.115 [I] orbax-checkpoint version: 0.11.1                                                 (501617:abstract_checkpointer.py:35)
09:22:53.115 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7fdb1af1eac0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (501617:async_checkpointer.py:80)
09:22:53.115 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel (501617:checkpoint_manager.py:1528)
09:22:53.115 [I] Saving root metadata                                                             (501617:checkpoint_manager.py:1569)
09:22:53.116 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (501617:multihost.py:293)
09:22:53.116 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7fdb1afe3090> (501617:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250408_092253-1uxk69iy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_pi0_bagel
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/1uxk69iy
09:22:54.168 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid___finetune_on_bagel/droid (501617:config.py:167)
Some kwargs in processor config are unused and will not have any effect: min_token, scale, action_dim, time_horizon, vocab_size. 
Some kwargs in processor config are unused and will not have any effect: min_token, scale, action_dim, time_horizon, vocab_size. 
num states in collected demos given by count_collected_demos: 1354
len_dataset: 1354
num episodes: 20
common_prompt: pick up the bagel and put it in the toaster
09:23:13.620 [I] Initialized data loader:
[0].images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].images['wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (16,)@bool
[0].image_masks['base_1_rgb']: (16,)@bool
[0].image_masks['wrist_0_rgb']: (16,)@bool
[0].state: (16, 8)@float32
[0].tokenized_prompt: (16, 250)@int32
[0].tokenized_prompt_mask: (16, 250)@bool
[0].token_ar_mask: (16, 250)@int32
[0].token_loss_mask: (16, 250)@bool
[1]: (16, 10, 8)@float32 (501617:train.py:227)
09:23:14.362 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (501617:base_pytree_checkpoint_handler.py:332)
09:23:14.397 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (501617:checkpointer.py:256)
09:23:29.432 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 741.8 MiB/s (total bytes: 10.9 GiB) (time elapsed: 15 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:23:29.432 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (501617:checkpointer.py:259)
09:23:29.432 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (501617:multihost.py:293)
2025-04-08 09:23:33.629596: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 19.42GiB (20847081029 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
09:23:36.127 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (501617:train.py:231)
09:23:36.223 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (501617:tqdm_logging.py:145)
Step 0: grad_norm=13.1172, loss=3.5481, param_norm=1886.4708
Step 1: grad_norm=23.3983, loss=3.5401, param_norm=1886.4708
Step 2: grad_norm=13.1993, loss=3.1404, param_norm=1886.4708
Step 3: grad_norm=21.4210, loss=3.1891, param_norm=1886.4708
09:23:47.203 [I] Progress on: 3.00it/1.00kit rate:2.6s/it remaining:42:45 elapsed:00:10 postfix:- (501617:tqdm_logging.py:145)
Step 4: grad_norm=11.6526, loss=3.0936, param_norm=1886.4708
Step 5: grad_norm=11.4971, loss=3.0781, param_norm=1886.4708
Step 6: grad_norm=11.9520, loss=2.8769, param_norm=1886.4707
Step 7: grad_norm=11.3976, loss=2.9916, param_norm=1886.4707
Step 8: grad_norm=10.9101, loss=3.0374, param_norm=1886.4706
Step 9: grad_norm=10.7140, loss=2.5872, param_norm=1886.4705
Step 10: grad_norm=10.4837, loss=2.8738, param_norm=1886.4705
Step 11: grad_norm=16.1766, loss=2.6460, param_norm=1886.4703
Step 12: grad_norm=8.9586, loss=2.4480, param_norm=1886.4703
Step 13: grad_norm=16.7424, loss=2.6870, param_norm=1886.4703
09:23:57.783 [I] Progress on: 13.0it/1.00kit rate:1.1s/it remaining:17:50 elapsed:00:21 postfix:- (501617:tqdm_logging.py:145)
Step 14: grad_norm=8.6822, loss=2.5151, param_norm=1886.4703
Step 15: grad_norm=7.8831, loss=2.3709, param_norm=1886.4702
Step 16: grad_norm=14.1771, loss=2.4176, param_norm=1886.4702
Step 17: grad_norm=7.8951, loss=2.2610, param_norm=1886.4702
Step 18: grad_norm=8.4163, loss=2.4028, param_norm=1886.4702
Step 19: grad_norm=7.8000, loss=2.2559, param_norm=1886.4702
Step 20: grad_norm=7.9022, loss=2.2966, param_norm=1886.4702
Step 21: grad_norm=7.5600, loss=2.2593, param_norm=1886.4702
Step 22: grad_norm=13.9651, loss=2.1746, param_norm=1886.4702
Step 23: grad_norm=16.5105, loss=2.2656, param_norm=1886.4702
09:24:08.392 [I] Progress on: 23.0it/1.00kit rate:1.1s/it remaining:17:16 elapsed:00:32 postfix:- (501617:tqdm_logging.py:145)
Step 24: grad_norm=6.8413, loss=2.2605, param_norm=1886.4702
Step 25: grad_norm=11.1842, loss=2.2643, param_norm=1886.4702
Step 26: grad_norm=7.7810, loss=2.0426, param_norm=1886.4703
Step 27: grad_norm=6.4740, loss=2.1013, param_norm=1886.4703
Step 28: grad_norm=10.1553, loss=2.0251, param_norm=1886.4703
Step 29: grad_norm=6.1775, loss=2.1461, param_norm=1886.4705
Step 30: grad_norm=5.9754, loss=2.0973, param_norm=1886.4705
Step 31: grad_norm=6.0168, loss=2.1886, param_norm=1886.4705
Step 32: grad_norm=11.3580, loss=2.0689, param_norm=1886.4706
Step 33: grad_norm=10.1001, loss=1.9637, param_norm=1886.4707
09:24:19.040 [I] Progress on: 33.0it/1.00kit rate:1.1s/it remaining:17:09 elapsed:00:42 postfix:- (501617:tqdm_logging.py:145)
Step 34: grad_norm=6.4615, loss=1.9112, param_norm=1886.4708
Step 35: grad_norm=8.7272, loss=1.7860, param_norm=1886.4709
Step 36: grad_norm=10.9070, loss=1.8797, param_norm=1886.4711
Step 37: grad_norm=8.3128, loss=2.0006, param_norm=1886.4711
Step 38: grad_norm=5.6170, loss=2.0202, param_norm=1886.4712
Step 39: grad_norm=7.3085, loss=1.9341, param_norm=1886.4713
Step 40: grad_norm=8.0376, loss=1.7937, param_norm=1886.4714
Step 41: grad_norm=9.6857, loss=1.9317, param_norm=1886.4716
Step 42: grad_norm=16.4585, loss=2.0585, param_norm=1886.4718
Step 43: grad_norm=5.7286, loss=1.9633, param_norm=1886.4719
09:24:29.716 [I] Progress on: 43.0it/1.00kit rate:1.1s/it remaining:17:00 elapsed:00:53 postfix:- (501617:tqdm_logging.py:145)
Step 44: grad_norm=28.6729, loss=2.0090, param_norm=1886.4722
Step 45: grad_norm=9.2174, loss=1.7346, param_norm=1886.4724
Step 46: grad_norm=11.4079, loss=1.8248, param_norm=1886.4727
Step 47: grad_norm=8.8196, loss=1.8205, param_norm=1886.4729
Step 48: grad_norm=7.4786, loss=1.8783, param_norm=1886.4731
Step 49: grad_norm=7.5556, loss=1.9706, param_norm=1886.4734
Step 50: grad_norm=5.9630, loss=1.8914, param_norm=1886.4739
Step 51: grad_norm=12.3057, loss=1.8556, param_norm=1886.4741
Step 52: grad_norm=6.2059, loss=1.9371, param_norm=1886.4744
Step 53: grad_norm=12.1692, loss=1.8197, param_norm=1886.4746
09:24:40.413 [I] Progress on: 53.0it/1.00kit rate:1.1s/it remaining:16:51 elapsed:01:04 postfix:- (501617:tqdm_logging.py:145)
Step 54: grad_norm=5.4883, loss=1.8355, param_norm=1886.4749
Step 55: grad_norm=8.3697, loss=1.5598, param_norm=1886.4751
Step 56: grad_norm=5.6140, loss=1.7271, param_norm=1886.4755
Step 57: grad_norm=5.5675, loss=1.7502, param_norm=1886.4756
Step 58: grad_norm=5.5356, loss=1.7967, param_norm=1886.4758
Step 59: grad_norm=7.8733, loss=1.8478, param_norm=1886.4763
Step 60: grad_norm=4.9722, loss=1.7396, param_norm=1886.4766
Step 61: grad_norm=5.6874, loss=1.6332, param_norm=1886.4768
Step 62: grad_norm=7.4618, loss=1.7494, param_norm=1886.4772
Step 63: grad_norm=5.3628, loss=1.7892, param_norm=1886.4775
09:24:51.146 [I] Progress on: 63.0it/1.00kit rate:1.1s/it remaining:16:42 elapsed:01:14 postfix:- (501617:tqdm_logging.py:145)
Step 64: grad_norm=9.1401, loss=1.8181, param_norm=1886.4779
Step 65: grad_norm=5.2774, loss=1.5973, param_norm=1886.4781
Step 66: grad_norm=7.6614, loss=1.7631, param_norm=1886.4785
Step 67: grad_norm=5.4927, loss=1.7670, param_norm=1886.4790
Step 68: grad_norm=6.0584, loss=1.7585, param_norm=1886.4792
Step 69: grad_norm=10.5680, loss=1.8024, param_norm=1886.4795
Step 70: grad_norm=6.9403, loss=1.7758, param_norm=1886.4799
Step 71: grad_norm=6.4595, loss=1.6906, param_norm=1886.4803
Step 72: grad_norm=7.1213, loss=1.8765, param_norm=1886.4806
Step 73: grad_norm=5.0534, loss=1.6928, param_norm=1886.4811
09:25:01.922 [I] Progress on: 73.0it/1.00kit rate:1.1s/it remaining:16:42 elapsed:01:25 postfix:- (501617:tqdm_logging.py:145)
Step 74: grad_norm=7.9481, loss=1.7289, param_norm=1886.4814
Step 75: grad_norm=6.8809, loss=1.6718, param_norm=1886.4818
Step 76: grad_norm=12.5436, loss=1.7652, param_norm=1886.4823
Step 77: grad_norm=7.1303, loss=1.7058, param_norm=1886.4827
Step 78: grad_norm=17.9265, loss=1.7747, param_norm=1886.4830
Step 79: grad_norm=15.4181, loss=1.7090, param_norm=1886.4834
Step 80: grad_norm=11.5944, loss=1.7767, param_norm=1886.4836
Step 81: grad_norm=5.3574, loss=1.7202, param_norm=1886.4840
Step 82: grad_norm=7.6117, loss=1.8649, param_norm=1886.4843
Step 83: grad_norm=8.8960, loss=1.4743, param_norm=1886.4845
09:25:12.674 [I] Progress on: 83.0it/1.00kit rate:1.1s/it remaining:16:26 elapsed:01:36 postfix:- (501617:tqdm_logging.py:145)
Step 84: grad_norm=4.9667, loss=1.3514, param_norm=1886.4850
Step 85: grad_norm=12.5186, loss=1.4724, param_norm=1886.4852
Step 86: grad_norm=22.7745, loss=1.5298, param_norm=1886.4856
Step 87: grad_norm=13.8435, loss=1.3038, param_norm=1886.4860
Step 88: grad_norm=10.9316, loss=1.4543, param_norm=1886.4863
Step 89: grad_norm=8.3462, loss=1.4178, param_norm=1886.4866
Step 90: grad_norm=4.4646, loss=1.4054, param_norm=1886.4868
Step 91: grad_norm=5.2654, loss=1.3679, param_norm=1886.4872
Step 92: grad_norm=5.5026, loss=1.3534, param_norm=1886.4875
09:25:22.727 [I] Progress on: 92.0it/1.00kit rate:1.1s/it remaining:16:25 elapsed:01:46 postfix:- (501617:tqdm_logging.py:145)
Step 93: grad_norm=7.3821, loss=1.4344, param_norm=1886.4879
Step 94: grad_norm=7.7391, loss=1.4038, param_norm=1886.4883
Step 95: grad_norm=12.5430, loss=1.3350, param_norm=1886.4885
Step 96: grad_norm=11.3041, loss=1.3380, param_norm=1886.4889
Step 97: grad_norm=9.1070, loss=1.4296, param_norm=1886.4894
Step 98: grad_norm=6.9386, loss=1.5023, param_norm=1886.4897
Step 99: grad_norm=14.4491, loss=1.3325, param_norm=1886.4901
Step 100: grad_norm=6.8456, loss=1.3936, param_norm=1886.4904
09:25:31.409 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:25:31.409 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (501617:checkpoint_manager.py:1767)
09:25:31.410 [I] [process=0] Saving checkpoint at step 100                                        (501617:checkpoint_manager.py:1286)
09:25:31.411 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100. (501617:async_checkpointer.py:358)
09:25:31.413 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:25:31.413 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0 (501617:atomicity.py:144)
09:25:31.415 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:25:31.415 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:25:31.416 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744118731414558457, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1744118731414558457, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (501617:checkpoint.py:185)
09:25:31.417 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (501617:atomicity.py:144)
09:25:31.417 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (501617:atomicity.py:144)
09:25:31.418 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:25:31.428 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:25:35.492 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:25:35.501 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:25:35.502 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:25:35.504 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:25:35.510 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:25:35.512 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:25:35.518 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:25:35.519 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744118731.4094045, 'wait_for_prev_duration_secs': 0.0004987716674804688, 'checkpointer_blocking_start_time': 1744118731.4107594, 'checkpointer_blocking_duration_secs': 4.099262237548828, 'get_old_steps_start_time': 1744118735.51027, 'get_old_steps_duration_secs': 3.4809112548828125e-05, 'checkpoint_manager_blocking_start_time': 1744118731.409121, 'checkpoint_manager_blocking_duration_secs': 4.1105523109436035} (501617:standard_logger.py:34)
09:25:35.531 [I] Progress on: 101it/1.00kit rate:2.3s/it remaining:34:46 elapsed:01:59 postfix:-  (501617:tqdm_logging.py:145)
Step 101: grad_norm=6.7968, loss=1.3618, param_norm=1886.4908
Step 102: grad_norm=5.0999, loss=1.3555, param_norm=1886.4912
Step 103: grad_norm=20.1569, loss=1.6053, param_norm=1886.4915
Step 104: grad_norm=16.1203, loss=1.3414, param_norm=1886.4918
Step 105: grad_norm=8.7880, loss=1.4273, param_norm=1886.4922
Step 106: grad_norm=7.7215, loss=1.2937, param_norm=1886.4926
Step 107: grad_norm=15.2202, loss=1.5096, param_norm=1886.4928
Step 108: grad_norm=6.1602, loss=1.3817, param_norm=1886.4932
Step 109: grad_norm=5.3171, loss=1.2394, param_norm=1886.4935
09:25:45.628 [I] ChainedFuture completed 1/1 futures in 10.12 seconds.                            (501617:future.py:137)
09:25:45.629 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 729.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 14 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:25:45.629 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:25:45.630 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744118731414558457, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (501617:checkpoint.py:225)
09:25:45.632 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0 (501617:async_checkpointer.py:406)
09:25:45.633 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/assets (501617:atomicity.py:287)
09:25:45.729 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744118731414558457, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (501617:checkpoint.py:244)
09:25:45.770 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0/params (501617:atomicity.py:287)
09:25:45.770 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100 (501617:async_checkpointer.py:416)
09:25:45.771 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0 (501617:async_checkpointer.py:426)
09:25:45.771 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100 (501617:atomicity.py:287)
09:25:45.773 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/100`. (501617:atomicity.py:548)
09:25:45.773 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:25:45.774 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:25:45.774 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:25:45.775 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:25:45.775 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 110: grad_norm=6.1515, loss=1.3083, param_norm=1886.4940
09:25:46.407 [I] Progress on: 110it/1.00kit rate:1.1s/it remaining:16:47 elapsed:02:10 postfix:-  (501617:tqdm_logging.py:145)
Step 111: grad_norm=10.1000, loss=1.4278, param_norm=1886.4944
Step 112: grad_norm=6.9339, loss=1.4742, param_norm=1886.4948
Step 113: grad_norm=21.2884, loss=1.4466, param_norm=1886.4951
Step 114: grad_norm=14.3314, loss=1.4716, param_norm=1886.4954
Step 115: grad_norm=14.1926, loss=1.4223, param_norm=1886.4958
Step 116: grad_norm=18.1218, loss=1.4180, param_norm=1886.4963
Step 117: grad_norm=7.1731, loss=1.2898, param_norm=1886.4966
Step 118: grad_norm=5.3578, loss=1.4454, param_norm=1886.4969
Step 119: grad_norm=5.5072, loss=1.3936, param_norm=1886.4973
09:25:56.625 [I] Progress on: 119it/1.00kit rate:1.1s/it remaining:16:07 elapsed:02:20 postfix:-  (501617:tqdm_logging.py:145)
Step 120: grad_norm=5.3406, loss=1.4674, param_norm=1886.4977
Step 121: grad_norm=5.0959, loss=1.4595, param_norm=1886.4980
Step 122: grad_norm=7.8794, loss=1.3118, param_norm=1886.4985
Step 123: grad_norm=5.2652, loss=1.2690, param_norm=1886.4989
Step 124: grad_norm=5.1496, loss=1.2857, param_norm=1886.4994
Step 125: grad_norm=5.4508, loss=1.3749, param_norm=1886.4998
Step 126: grad_norm=5.7935, loss=1.4135, param_norm=1886.5001
Step 127: grad_norm=11.2127, loss=1.4717, param_norm=1886.5005
Step 128: grad_norm=5.0836, loss=1.2631, param_norm=1886.5009
Step 129: grad_norm=7.1423, loss=1.3899, param_norm=1886.5012
09:26:07.433 [I] Progress on: 129it/1.00kit rate:1.1s/it remaining:15:41 elapsed:02:31 postfix:-  (501617:tqdm_logging.py:145)
Step 130: grad_norm=5.3967, loss=1.3341, param_norm=1886.5016
Step 131: grad_norm=10.9287, loss=1.3164, param_norm=1886.5020
Step 132: grad_norm=5.0229, loss=1.4252, param_norm=1886.5023
Step 133: grad_norm=5.1143, loss=1.4434, param_norm=1886.5027
Step 134: grad_norm=5.1564, loss=1.3998, param_norm=1886.5031
Step 135: grad_norm=5.0983, loss=1.4143, param_norm=1886.5035
Step 136: grad_norm=5.5257, loss=1.3133, param_norm=1886.5039
Step 137: grad_norm=5.3970, loss=1.3766, param_norm=1886.5043
Step 138: grad_norm=6.0132, loss=1.3452, param_norm=1886.5046
Step 139: grad_norm=13.5752, loss=1.3361, param_norm=1886.5051
09:26:18.237 [I] Progress on: 139it/1.00kit rate:1.1s/it remaining:15:29 elapsed:02:42 postfix:-  (501617:tqdm_logging.py:145)
Step 140: grad_norm=8.3710, loss=1.3862, param_norm=1886.5055
Step 141: grad_norm=5.5688, loss=1.3650, param_norm=1886.5059
Step 142: grad_norm=5.1981, loss=1.4096, param_norm=1886.5062
Step 143: grad_norm=5.2433, loss=1.2994, param_norm=1886.5067
Step 144: grad_norm=5.3199, loss=1.2864, param_norm=1886.5071
Step 145: grad_norm=10.6397, loss=1.2181, param_norm=1886.5074
Step 146: grad_norm=10.0876, loss=1.3036, param_norm=1886.5081
Step 147: grad_norm=5.9933, loss=1.3175, param_norm=1886.5083
Step 148: grad_norm=5.4834, loss=1.1303, param_norm=1886.5087
Step 149: grad_norm=8.7067, loss=1.3610, param_norm=1886.5089
09:26:29.055 [I] Progress on: 149it/1.00kit rate:1.1s/it remaining:15:20 elapsed:02:52 postfix:-  (501617:tqdm_logging.py:145)
Step 150: grad_norm=9.7442, loss=1.3597, param_norm=1886.5093
Step 151: grad_norm=13.2919, loss=1.4087, param_norm=1886.5098
Step 152: grad_norm=12.6531, loss=1.2863, param_norm=1886.5100
Step 153: grad_norm=15.1319, loss=1.1900, param_norm=1886.5104
Step 154: grad_norm=22.4918, loss=1.4615, param_norm=1886.5106
Step 155: grad_norm=5.9333, loss=1.3788, param_norm=1886.5109
Step 156: grad_norm=13.6814, loss=1.2925, param_norm=1886.5111
Step 157: grad_norm=8.9165, loss=1.1945, param_norm=1886.5114
Step 158: grad_norm=24.2561, loss=1.3110, param_norm=1886.5117
Step 159: grad_norm=22.4127, loss=1.4539, param_norm=1886.5120
09:26:39.893 [I] Progress on: 159it/1.00kit rate:1.1s/it remaining:15:11 elapsed:03:03 postfix:-  (501617:tqdm_logging.py:145)
Step 160: grad_norm=12.2362, loss=1.4363, param_norm=1886.5122
Step 161: grad_norm=19.9894, loss=1.2988, param_norm=1886.5126
Step 162: grad_norm=5.1664, loss=1.4293, param_norm=1886.5128
Step 163: grad_norm=5.7351, loss=1.2511, param_norm=1886.5131
Step 164: grad_norm=6.0190, loss=1.1678, param_norm=1886.5134
Step 165: grad_norm=4.7524, loss=1.3891, param_norm=1886.5137
Step 166: grad_norm=12.2858, loss=1.2056, param_norm=1886.5142
Step 167: grad_norm=6.3324, loss=1.2564, param_norm=1886.5144
Step 168: grad_norm=9.4850, loss=1.1894, param_norm=1886.5148
09:26:49.961 [I] Progress on: 168it/1.00kit rate:1.2s/it remaining:16:19 elapsed:03:13 postfix:-  (501617:tqdm_logging.py:145)
Step 169: grad_norm=10.8368, loss=1.0802, param_norm=1886.5150
Step 170: grad_norm=11.3587, loss=1.0353, param_norm=1886.5154
Step 171: grad_norm=6.1910, loss=1.0436, param_norm=1886.5157
Step 172: grad_norm=4.6873, loss=1.1146, param_norm=1886.5160
Step 173: grad_norm=12.4185, loss=1.0346, param_norm=1886.5164
Step 174: grad_norm=6.5842, loss=1.0555, param_norm=1886.5166
Step 175: grad_norm=15.4382, loss=1.0415, param_norm=1886.5168
Step 176: grad_norm=4.7238, loss=1.1089, param_norm=1886.5172
Step 177: grad_norm=5.5376, loss=1.0639, param_norm=1886.5175
Step 178: grad_norm=5.4572, loss=1.0547, param_norm=1886.5178
09:27:00.825 [I] Progress on: 178it/1.00kit rate:1.1s/it remaining:14:55 elapsed:03:24 postfix:-  (501617:tqdm_logging.py:145)
Step 179: grad_norm=14.8948, loss=1.0684, param_norm=1886.5182
Step 180: grad_norm=7.2238, loss=0.8082, param_norm=1886.5184
Step 181: grad_norm=8.3918, loss=0.9862, param_norm=1886.5189
Step 182: grad_norm=4.7413, loss=0.8978, param_norm=1886.5192
Step 183: grad_norm=5.7155, loss=1.1474, param_norm=1886.5195
Step 184: grad_norm=6.9862, loss=0.9802, param_norm=1886.5199
Step 185: grad_norm=6.9110, loss=0.9679, param_norm=1886.5204
Step 186: grad_norm=4.9944, loss=0.9174, param_norm=1886.5208
Step 187: grad_norm=5.6464, loss=0.9534, param_norm=1886.5211
Step 188: grad_norm=5.0189, loss=0.8180, param_norm=1886.5215
09:27:11.699 [I] Progress on: 188it/1.00kit rate:1.1s/it remaining:14:44 elapsed:03:35 postfix:-  (501617:tqdm_logging.py:145)
Step 189: grad_norm=5.5220, loss=1.1686, param_norm=1886.5220
Step 190: grad_norm=5.7346, loss=1.0217, param_norm=1886.5225
Step 191: grad_norm=6.7262, loss=1.0352, param_norm=1886.5231
Step 192: grad_norm=5.4023, loss=1.0349, param_norm=1886.5236
Step 193: grad_norm=8.1318, loss=1.1913, param_norm=1886.5239
Step 194: grad_norm=10.1511, loss=1.0350, param_norm=1886.5244
Step 195: grad_norm=6.0063, loss=0.9708, param_norm=1886.5250
Step 196: grad_norm=6.6629, loss=1.0272, param_norm=1886.5254
Step 197: grad_norm=6.6987, loss=1.1495, param_norm=1886.5259
Step 198: grad_norm=5.1659, loss=1.0443, param_norm=1886.5262
09:27:22.579 [I] Progress on: 198it/1.00kit rate:1.1s/it remaining:14:33 elapsed:03:46 postfix:-  (501617:tqdm_logging.py:145)
Step 199: grad_norm=5.9135, loss=1.1163, param_norm=1886.5267
Step 200: grad_norm=7.8547, loss=0.9996, param_norm=1886.5271
09:27:24.791 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:27:24.791 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:27:24.792 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (501617:checkpoint_manager.py:1786)
09:27:24.792 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (501617:checkpoint_manager.py:1817)
09:27:24.792 [I] [process=0] Saving checkpoint at step 200                                        (501617:checkpoint_manager.py:1286)
09:27:24.793 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200. (501617:async_checkpointer.py:358)
09:27:24.794 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:27:24.794 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3 (501617:atomicity.py:144)
09:27:24.795 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:27:24.795 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:27:24.796 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (501617:atomicity.py:144)
09:27:24.796 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (501617:atomicity.py:144)
09:27:24.797 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:27:24.802 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:27:29.030 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:27:29.031 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:27:29.033 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:27:29.036 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:27:29.056 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:27:29.060 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:27:29.063 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:27:29.067 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:27:29.068 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744118844.791583, 'wait_for_prev_duration_secs': 0.0006041526794433594, 'checkpointer_blocking_start_time': 1744118844.7927184, 'checkpointer_blocking_duration_secs': 4.263352870941162, 'get_old_steps_start_time': 1744118849.0562966, 'get_old_steps_duration_secs': 0.004225254058837891, 'checkpoint_manager_blocking_start_time': 1744118844.7914898, 'checkpoint_manager_blocking_duration_secs': 4.277313232421875} (501617:standard_logger.py:34)
Step 201: grad_norm=6.1570, loss=0.9717, param_norm=1886.5276
Step 202: grad_norm=12.0568, loss=1.1139, param_norm=1886.5281
Step 203: grad_norm=10.1017, loss=1.0076, param_norm=1886.5284
Step 204: grad_norm=10.2057, loss=1.1024, param_norm=1886.5289
09:27:33.455 [I] Progress on: 204it/1.00kit rate:1.5s/it remaining:20:24 elapsed:03:57 postfix:-  (501617:tqdm_logging.py:145)
Step 205: grad_norm=6.6829, loss=1.1425, param_norm=1886.5293
Step 206: grad_norm=5.5779, loss=1.0991, param_norm=1886.5298
Step 207: grad_norm=8.7650, loss=1.1422, param_norm=1886.5302
Step 208: grad_norm=20.6396, loss=0.9691, param_norm=1886.5305
Step 209: grad_norm=11.4048, loss=1.0164, param_norm=1886.5309
09:27:39.638 [I] ChainedFuture completed 1/1 futures in 10.59 seconds.                            (501617:future.py:137)
09:27:39.639 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 698.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 14 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:27:39.639 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:27:39.641 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3 (501617:async_checkpointer.py:406)
09:27:39.642 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3/assets (501617:atomicity.py:287)
09:27:39.655 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3/params (501617:atomicity.py:287)
09:27:39.655 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200 (501617:async_checkpointer.py:416)
09:27:39.656 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3 (501617:async_checkpointer.py:426)
09:27:39.656 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200 (501617:atomicity.py:287)
09:27:39.658 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/200`. (501617:atomicity.py:548)
09:27:39.658 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:27:39.659 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:27:39.659 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:27:39.660 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:27:39.660 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 210: grad_norm=11.9659, loss=1.0718, param_norm=1886.5314
Step 211: grad_norm=7.5657, loss=1.0319, param_norm=1886.5316
Step 212: grad_norm=10.7689, loss=1.2318, param_norm=1886.5320
Step 213: grad_norm=5.7956, loss=1.0404, param_norm=1886.5322
Step 214: grad_norm=6.3785, loss=1.1782, param_norm=1886.5326
09:27:44.426 [I] Progress on: 214it/1.00kit rate:1.1s/it remaining:14:31 elapsed:04:08 postfix:-  (501617:tqdm_logging.py:145)
Step 215: grad_norm=11.3808, loss=1.0393, param_norm=1886.5330
Step 216: grad_norm=7.4788, loss=1.0634, param_norm=1886.5333
Step 217: grad_norm=18.9770, loss=1.0886, param_norm=1886.5336
Step 218: grad_norm=8.7787, loss=1.1920, param_norm=1886.5339
Step 219: grad_norm=15.5135, loss=1.1722, param_norm=1886.5342
Step 220: grad_norm=16.2117, loss=1.1907, param_norm=1886.5345
Step 221: grad_norm=17.7606, loss=0.9636, param_norm=1886.5347
Step 222: grad_norm=9.7780, loss=0.9674, param_norm=1886.5350
Step 223: grad_norm=6.3507, loss=1.1114, param_norm=1886.5353
Step 224: grad_norm=4.9983, loss=0.9289, param_norm=1886.5355
09:27:55.316 [I] Progress on: 224it/1.00kit rate:1.1s/it remaining:14:05 elapsed:04:19 postfix:-  (501617:tqdm_logging.py:145)
Step 225: grad_norm=8.4965, loss=1.0046, param_norm=1886.5358
Step 226: grad_norm=8.0805, loss=0.9770, param_norm=1886.5361
Step 227: grad_norm=19.2871, loss=1.2142, param_norm=1886.5365
Step 228: grad_norm=5.3914, loss=1.1098, param_norm=1886.5367
Step 229: grad_norm=10.4331, loss=0.8955, param_norm=1886.5371
Step 230: grad_norm=16.1178, loss=0.9443, param_norm=1886.5375
Step 231: grad_norm=11.6181, loss=1.0178, param_norm=1886.5377
Step 232: grad_norm=9.4701, loss=1.1522, param_norm=1886.5381
Step 233: grad_norm=10.8686, loss=0.9443, param_norm=1886.5383
Step 234: grad_norm=10.2560, loss=1.0456, param_norm=1886.5386
09:28:06.613 [I] Progress on: 234it/1.00kit rate:1.1s/it remaining:13:55 elapsed:04:30 postfix:-  (501617:tqdm_logging.py:145)
Step 235: grad_norm=13.8025, loss=1.1790, param_norm=1886.5391
Step 236: grad_norm=6.6041, loss=1.0969, param_norm=1886.5393
Step 237: grad_norm=5.2304, loss=0.9796, param_norm=1886.5396
Step 238: grad_norm=6.1699, loss=1.1238, param_norm=1886.5398
Step 239: grad_norm=10.8028, loss=1.0162, param_norm=1886.5400
Step 240: grad_norm=20.5973, loss=1.1954, param_norm=1886.5405
Step 241: grad_norm=26.4256, loss=0.9591, param_norm=1886.5406
Step 242: grad_norm=11.0468, loss=0.9996, param_norm=1886.5410
Step 243: grad_norm=14.7591, loss=1.1061, param_norm=1886.5413
Step 244: grad_norm=5.3779, loss=1.0988, param_norm=1886.5415
09:28:17.518 [I] Progress on: 244it/1.00kit rate:1.1s/it remaining:13:47 elapsed:04:41 postfix:-  (501617:tqdm_logging.py:145)
Step 245: grad_norm=33.4395, loss=1.2683, param_norm=1886.5420
Step 246: grad_norm=7.3841, loss=1.0570, param_norm=1886.5422
Step 247: grad_norm=14.2303, loss=1.1030, param_norm=1886.5426
Step 248: grad_norm=5.3449, loss=1.1622, param_norm=1886.5428
Step 249: grad_norm=8.3399, loss=0.9507, param_norm=1886.5432
Step 250: grad_norm=6.4109, loss=0.9405, param_norm=1886.5435
Step 251: grad_norm=11.7473, loss=1.0109, param_norm=1886.5438
Step 252: grad_norm=5.3328, loss=0.6759, param_norm=1886.5442
Step 253: grad_norm=7.9326, loss=0.7423, param_norm=1886.5444
09:28:27.651 [I] Progress on: 253it/1.00kit rate:1.2s/it remaining:14:25 elapsed:04:51 postfix:-  (501617:tqdm_logging.py:145)
Step 254: grad_norm=5.5484, loss=0.8855, param_norm=1886.5448
Step 255: grad_norm=10.8596, loss=0.8779, param_norm=1886.5452
Step 256: grad_norm=5.2967, loss=0.8210, param_norm=1886.5454
Step 257: grad_norm=4.5932, loss=0.8299, param_norm=1886.5458
Step 258: grad_norm=4.2377, loss=0.7532, param_norm=1886.5460
Step 259: grad_norm=7.3450, loss=0.6986, param_norm=1886.5465
Step 260: grad_norm=7.4166, loss=0.8014, param_norm=1886.5469
Step 261: grad_norm=10.5913, loss=0.7721, param_norm=1886.5472
Step 262: grad_norm=7.0063, loss=0.6114, param_norm=1886.5476
Step 263: grad_norm=9.3101, loss=0.8238, param_norm=1886.5480
09:28:38.569 [I] Progress on: 263it/1.00kit rate:1.1s/it remaining:13:26 elapsed:05:02 postfix:-  (501617:tqdm_logging.py:145)
Step 264: grad_norm=5.2637, loss=0.8172, param_norm=1886.5485
Step 265: grad_norm=9.5838, loss=0.9362, param_norm=1886.5490
Step 266: grad_norm=17.8411, loss=0.8675, param_norm=1886.5492
Step 267: grad_norm=13.3848, loss=0.8846, param_norm=1886.5498
Step 268: grad_norm=5.5518, loss=0.8613, param_norm=1886.5500
Step 269: grad_norm=10.2528, loss=0.9939, param_norm=1886.5505
Step 270: grad_norm=6.7262, loss=0.8281, param_norm=1886.5508
Step 271: grad_norm=14.4481, loss=0.6477, param_norm=1886.5513
Step 272: grad_norm=14.6982, loss=0.7504, param_norm=1886.5515
Step 273: grad_norm=13.4959, loss=0.7642, param_norm=1886.5519
09:28:49.483 [I] Progress on: 273it/1.00kit rate:1.1s/it remaining:13:13 elapsed:05:13 postfix:-  (501617:tqdm_logging.py:145)
Step 274: grad_norm=8.8964, loss=0.7274, param_norm=1886.5522
Step 275: grad_norm=10.9201, loss=0.7904, param_norm=1886.5525
Step 276: grad_norm=7.5262, loss=0.8254, param_norm=1886.5529
Step 277: grad_norm=9.7133, loss=0.7119, param_norm=1886.5531
Step 278: grad_norm=7.3829, loss=0.8899, param_norm=1886.5533
Step 279: grad_norm=6.7061, loss=0.8286, param_norm=1886.5537
Step 280: grad_norm=8.7125, loss=0.7846, param_norm=1886.5540
Step 281: grad_norm=8.0141, loss=1.0567, param_norm=1886.5542
Step 282: grad_norm=6.7005, loss=0.7699, param_norm=1886.5546
Step 283: grad_norm=7.8950, loss=0.8791, param_norm=1886.5549
09:29:00.408 [I] Progress on: 283it/1.00kit rate:1.1s/it remaining:13:03 elapsed:05:24 postfix:-  (501617:tqdm_logging.py:145)
Step 284: grad_norm=18.3580, loss=0.7854, param_norm=1886.5552
Step 285: grad_norm=7.1198, loss=0.8505, param_norm=1886.5553
Step 286: grad_norm=5.3903, loss=0.7855, param_norm=1886.5557
Step 287: grad_norm=8.5922, loss=0.8369, param_norm=1886.5560
Step 288: grad_norm=5.9552, loss=0.7165, param_norm=1886.5564
Step 289: grad_norm=7.4395, loss=0.8087, param_norm=1886.5566
Step 290: grad_norm=18.9671, loss=0.7020, param_norm=1886.5569
Step 291: grad_norm=8.9236, loss=0.7611, param_norm=1886.5573
Step 292: grad_norm=7.3364, loss=0.7472, param_norm=1886.5576
Step 293: grad_norm=11.5689, loss=0.8528, param_norm=1886.5579
09:29:11.334 [I] Progress on: 293it/1.00kit rate:1.1s/it remaining:12:52 elapsed:05:35 postfix:-  (501617:tqdm_logging.py:145)
Step 294: grad_norm=15.2132, loss=0.9699, param_norm=1886.5582
Step 295: grad_norm=9.6452, loss=0.7937, param_norm=1886.5585
Step 296: grad_norm=11.7523, loss=0.9650, param_norm=1886.5587
Step 297: grad_norm=8.9773, loss=0.7928, param_norm=1886.5590
Step 298: grad_norm=5.3832, loss=0.8102, param_norm=1886.5593
Step 299: grad_norm=10.2286, loss=0.8347, param_norm=1886.5596
Step 300: grad_norm=16.1330, loss=0.7573, param_norm=1886.5599
09:29:19.008 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:29:19.008 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:29:19.009 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (501617:checkpoint_manager.py:1786)
09:29:19.009 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (501617:checkpoint_manager.py:1817)
09:29:19.009 [I] [process=0] Saving checkpoint at step 300                                        (501617:checkpoint_manager.py:1286)
09:29:19.010 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300. (501617:async_checkpointer.py:358)
09:29:19.010 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:29:19.011 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6 (501617:atomicity.py:144)
09:29:19.012 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:29:19.012 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:29:19.013 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (501617:atomicity.py:144)
09:29:19.013 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (501617:atomicity.py:144)
09:29:19.014 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:29:19.019 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:29:23.136 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:29:23.144 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:29:23.146 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:29:23.148 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:29:23.153 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:29:23.156 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:29:23.158 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:29:23.165 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:29:23.171 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:29:23.175 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744118959.0086834, 'wait_for_prev_duration_secs': 0.0005953311920166016, 'checkpointer_blocking_start_time': 1744118959.0097544, 'checkpointer_blocking_duration_secs': 4.143124580383301, 'get_old_steps_start_time': 1744118963.1530788, 'get_old_steps_duration_secs': 0.00569915771484375, 'checkpoint_manager_blocking_start_time': 1744118959.00859, 'checkpoint_manager_blocking_duration_secs': 4.166445255279541} (501617:standard_logger.py:34)
09:29:23.179 [I] Progress on: 301it/1.00kit rate:2.3s/it remaining:27:18 elapsed:05:46 postfix:-  (501617:tqdm_logging.py:145)
Step 301: grad_norm=8.9631, loss=0.8749, param_norm=1886.5602
Step 302: grad_norm=5.5661, loss=0.8432, param_norm=1886.5604
Step 303: grad_norm=10.8654, loss=0.7552, param_norm=1886.5608
Step 304: grad_norm=12.1986, loss=0.7251, param_norm=1886.5610
Step 305: grad_norm=6.6676, loss=0.7268, param_norm=1886.5614
Step 306: grad_norm=7.3228, loss=0.7388, param_norm=1886.5616
Step 307: grad_norm=8.7911, loss=0.7939, param_norm=1886.5619
Step 308: grad_norm=7.5200, loss=0.7917, param_norm=1886.5623
Step 309: grad_norm=8.6631, loss=0.6772, param_norm=1886.5625
Step 310: grad_norm=6.8063, loss=0.7830, param_norm=1886.5629
09:29:34.071 [I] Progress on: 310it/1.00kit rate:1.1s/it remaining:13:08 elapsed:05:57 postfix:-  (501617:tqdm_logging.py:145)
09:29:34.461 [I] ChainedFuture completed 1/1 futures in 11.31 seconds.                            (501617:future.py:137)
09:29:34.461 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 670.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 15 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:29:34.461 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:29:34.463 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6 (501617:async_checkpointer.py:406)
09:29:34.464 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6/assets (501617:atomicity.py:287)
09:29:34.474 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6/params (501617:atomicity.py:287)
09:29:34.475 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300 (501617:async_checkpointer.py:416)
09:29:34.475 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6 (501617:async_checkpointer.py:426)
09:29:34.475 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300 (501617:atomicity.py:287)
09:29:34.477 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/300`. (501617:atomicity.py:548)
09:29:34.477 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:29:34.477 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:29:34.478 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:29:34.478 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:29:34.478 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 311: grad_norm=5.6518, loss=0.7086, param_norm=1886.5630
Step 312: grad_norm=8.1874, loss=0.7538, param_norm=1886.5634
Step 313: grad_norm=5.8813, loss=0.8854, param_norm=1886.5637
Step 314: grad_norm=4.9542, loss=0.7852, param_norm=1886.5640
Step 315: grad_norm=8.1251, loss=1.1600, param_norm=1886.5642
Step 316: grad_norm=6.7823, loss=0.7617, param_norm=1886.5646
Step 317: grad_norm=6.0721, loss=0.7521, param_norm=1886.5649
Step 318: grad_norm=8.1197, loss=0.8818, param_norm=1886.5653
Step 319: grad_norm=11.5301, loss=0.7576, param_norm=1886.5656
Step 320: grad_norm=6.1064, loss=0.8761, param_norm=1886.5658
09:29:45.015 [I] Progress on: 320it/1.00kit rate:1.1s/it remaining:12:25 elapsed:06:08 postfix:-  (501617:tqdm_logging.py:145)
Step 321: grad_norm=7.9588, loss=0.6826, param_norm=1886.5662
Step 322: grad_norm=12.2858, loss=0.7991, param_norm=1886.5664
Step 323: grad_norm=4.4707, loss=0.8080, param_norm=1886.5668
Step 324: grad_norm=5.0582, loss=0.7394, param_norm=1886.5670
Step 325: grad_norm=10.3326, loss=0.6984, param_norm=1886.5674
Step 326: grad_norm=10.3179, loss=0.7614, param_norm=1886.5676
Step 327: grad_norm=11.9046, loss=0.9073, param_norm=1886.5679
Step 328: grad_norm=6.5861, loss=0.8840, param_norm=1886.5681
Step 329: grad_norm=11.0225, loss=0.7778, param_norm=1886.5685
Step 330: grad_norm=9.4753, loss=0.7609, param_norm=1886.5687
09:29:55.950 [I] Progress on: 330it/1.00kit rate:1.1s/it remaining:12:12 elapsed:06:19 postfix:-  (501617:tqdm_logging.py:145)
Step 331: grad_norm=7.1880, loss=0.8977, param_norm=1886.5690
Step 332: grad_norm=5.8990, loss=0.8508, param_norm=1886.5692
Step 333: grad_norm=12.9239, loss=0.7859, param_norm=1886.5695
Step 334: grad_norm=13.5235, loss=0.7959, param_norm=1886.5697
Step 335: grad_norm=10.3605, loss=0.7627, param_norm=1886.5699
Step 336: grad_norm=6.9054, loss=0.5360, param_norm=1886.5701
Step 337: grad_norm=6.4433, loss=0.5918, param_norm=1886.5703
Step 338: grad_norm=4.0451, loss=0.5502, param_norm=1886.5706
Step 339: grad_norm=3.8545, loss=0.5484, param_norm=1886.5707
09:30:06.121 [I] Progress on: 339it/1.00kit rate:1.1s/it remaining:12:24 elapsed:06:29 postfix:-  (501617:tqdm_logging.py:145)
Step 340: grad_norm=11.4841, loss=0.7635, param_norm=1886.5709
Step 341: grad_norm=4.2990, loss=0.5666, param_norm=1886.5710
Step 342: grad_norm=4.5974, loss=0.5674, param_norm=1886.5714
Step 343: grad_norm=12.6966, loss=0.6346, param_norm=1886.5717
Step 344: grad_norm=8.2089, loss=0.5768, param_norm=1886.5718
Step 345: grad_norm=5.6076, loss=0.7563, param_norm=1886.5720
Step 346: grad_norm=4.5598, loss=0.5746, param_norm=1886.5723
Step 347: grad_norm=6.0413, loss=0.6117, param_norm=1886.5724
Step 348: grad_norm=8.2239, loss=0.6366, param_norm=1886.5726
Step 349: grad_norm=5.5196, loss=0.6126, param_norm=1886.5730
09:30:17.063 [I] Progress on: 349it/1.00kit rate:1.1s/it remaining:11:53 elapsed:06:40 postfix:-  (501617:tqdm_logging.py:145)
Step 350: grad_norm=6.6507, loss=0.5509, param_norm=1886.5732
Step 351: grad_norm=4.9790, loss=0.7176, param_norm=1886.5735
Step 352: grad_norm=4.5318, loss=0.6794, param_norm=1886.5737
Step 353: grad_norm=5.7717, loss=0.6131, param_norm=1886.5740
Step 354: grad_norm=7.1153, loss=0.5834, param_norm=1886.5742
Step 355: grad_norm=5.5282, loss=0.5935, param_norm=1886.5746
Step 356: grad_norm=9.5768, loss=0.6045, param_norm=1886.5748
Step 357: grad_norm=6.3255, loss=0.6051, param_norm=1886.5751
Step 358: grad_norm=5.1939, loss=0.6047, param_norm=1886.5754
09:30:27.174 [I] Progress on: 358it/1.00kit rate:1.1s/it remaining:12:17 elapsed:06:50 postfix:-  (501617:tqdm_logging.py:145)
Step 359: grad_norm=10.9286, loss=0.6695, param_norm=1886.5757
Step 360: grad_norm=8.8539, loss=0.7032, param_norm=1886.5759
Step 361: grad_norm=5.7962, loss=0.6860, param_norm=1886.5762
Step 362: grad_norm=8.5306, loss=0.7939, param_norm=1886.5764
Step 363: grad_norm=4.7641, loss=0.5832, param_norm=1886.5767
Step 364: grad_norm=6.5993, loss=0.5682, param_norm=1886.5770
Step 365: grad_norm=10.1947, loss=0.5684, param_norm=1886.5773
Step 366: grad_norm=7.8726, loss=0.7542, param_norm=1886.5776
Step 367: grad_norm=6.3781, loss=0.5991, param_norm=1886.5778
Step 368: grad_norm=7.9560, loss=0.6381, param_norm=1886.5781
09:30:38.119 [I] Progress on: 368it/1.00kit rate:1.1s/it remaining:11:32 elapsed:07:01 postfix:-  (501617:tqdm_logging.py:145)
Step 369: grad_norm=5.8589, loss=0.6244, param_norm=1886.5784
Step 370: grad_norm=10.9356, loss=0.6942, param_norm=1886.5786
Step 371: grad_norm=7.0968, loss=0.7194, param_norm=1886.5789
Step 372: grad_norm=6.4119, loss=0.5992, param_norm=1886.5792
Step 373: grad_norm=8.8177, loss=0.6351, param_norm=1886.5793
Step 374: grad_norm=7.8582, loss=0.6014, param_norm=1886.5797
Step 375: grad_norm=6.6244, loss=0.6159, param_norm=1886.5800
Step 376: grad_norm=8.6422, loss=0.6910, param_norm=1886.5802
Step 377: grad_norm=6.8051, loss=0.5919, param_norm=1886.5804
Step 378: grad_norm=4.8316, loss=0.6815, param_norm=1886.5808
09:30:49.061 [I] Progress on: 378it/1.00kit rate:1.1s/it remaining:11:20 elapsed:07:12 postfix:-  (501617:tqdm_logging.py:145)
Step 379: grad_norm=6.2419, loss=0.7207, param_norm=1886.5811
Step 380: grad_norm=7.9278, loss=0.6659, param_norm=1886.5813
Step 381: grad_norm=11.1285, loss=0.6507, param_norm=1886.5815
Step 382: grad_norm=6.9279, loss=0.6583, param_norm=1886.5818
Step 383: grad_norm=7.1317, loss=0.6915, param_norm=1886.5820
Step 384: grad_norm=7.4554, loss=0.6484, param_norm=1886.5823
Step 385: grad_norm=9.7595, loss=0.6155, param_norm=1886.5825
Step 386: grad_norm=8.4533, loss=0.6053, param_norm=1886.5826
Step 387: grad_norm=4.1847, loss=0.6138, param_norm=1886.5829
Step 388: grad_norm=10.6746, loss=0.6691, param_norm=1886.5831
09:31:00.014 [I] Progress on: 388it/1.00kit rate:1.1s/it remaining:11:10 elapsed:07:23 postfix:-  (501617:tqdm_logging.py:145)
Step 389: grad_norm=4.8321, loss=0.6328, param_norm=1886.5833
Step 390: grad_norm=7.8192, loss=0.5005, param_norm=1886.5835
Step 391: grad_norm=9.2411, loss=0.6144, param_norm=1886.5836
Step 392: grad_norm=8.1384, loss=0.6274, param_norm=1886.5839
Step 393: grad_norm=6.5522, loss=0.6231, param_norm=1886.5840
Step 394: grad_norm=12.8456, loss=0.6098, param_norm=1886.5841
Step 395: grad_norm=4.9338, loss=0.6291, param_norm=1886.5842
Step 396: grad_norm=40.4618, loss=0.6680, param_norm=1886.5844
Step 397: grad_norm=10.1040, loss=0.6102, param_norm=1886.5846
Step 398: grad_norm=10.1900, loss=0.5619, param_norm=1886.5848
09:31:10.983 [I] Progress on: 398it/1.00kit rate:1.1s/it remaining:10:59 elapsed:07:34 postfix:-  (501617:tqdm_logging.py:145)
Step 399: grad_norm=9.4071, loss=0.6178, param_norm=1886.5850
Step 400: grad_norm=6.9159, loss=0.6103, param_norm=1886.5851
09:31:13.208 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:31:13.208 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:31:13.208 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (501617:checkpoint_manager.py:1786)
09:31:13.208 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (501617:checkpoint_manager.py:1817)
09:31:13.209 [I] [process=0] Saving checkpoint at step 400                                        (501617:checkpoint_manager.py:1286)
09:31:13.210 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400. (501617:async_checkpointer.py:358)
09:31:13.211 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:31:13.211 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9 (501617:atomicity.py:144)
09:31:13.212 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:31:13.213 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:31:13.215 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (501617:atomicity.py:144)
09:31:13.215 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (501617:atomicity.py:144)
09:31:13.216 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:31:13.221 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:31:17.267 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:31:17.268 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:31:17.269 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:31:17.271 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:31:17.286 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:31:17.291 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:31:17.293 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:31:17.295 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:31:17.298 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:31:17.299 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:31:17.299 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119073.2081323, 'wait_for_prev_duration_secs': 0.0006365776062011719, 'checkpointer_blocking_start_time': 1744119073.209392, 'checkpointer_blocking_duration_secs': 4.077333450317383, 'get_old_steps_start_time': 1744119077.2867992, 'get_old_steps_duration_secs': 0.008330821990966797, 'checkpoint_manager_blocking_start_time': 1744119073.2079127, 'checkpoint_manager_blocking_duration_secs': 4.0912604331970215} (501617:standard_logger.py:34)
Step 401: grad_norm=5.6580, loss=0.6803, param_norm=1886.5854
Step 402: grad_norm=5.6564, loss=0.6996, param_norm=1886.5856
Step 403: grad_norm=7.5647, loss=0.6345, param_norm=1886.5857
Step 404: grad_norm=7.4323, loss=0.5819, param_norm=1886.5858
09:31:21.686 [I] Progress on: 404it/1.00kit rate:1.5s/it remaining:15:07 elapsed:07:45 postfix:-  (501617:tqdm_logging.py:145)
Step 405: grad_norm=6.3983, loss=0.6068, param_norm=1886.5861
Step 406: grad_norm=7.6627, loss=0.7714, param_norm=1886.5862
Step 407: grad_norm=8.7589, loss=0.6427, param_norm=1886.5864
Step 408: grad_norm=8.9385, loss=0.5430, param_norm=1886.5865
Step 409: grad_norm=10.3729, loss=0.7007, param_norm=1886.5868
Step 410: grad_norm=6.5746, loss=0.5382, param_norm=1886.5870
09:31:29.224 [I] ChainedFuture completed 1/1 futures in 11.95 seconds.                            (501617:future.py:137)
09:31:29.225 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 647.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 16 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:31:29.225 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:31:29.226 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9 (501617:async_checkpointer.py:406)
09:31:29.227 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9/assets (501617:atomicity.py:287)
09:31:29.237 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9/params (501617:atomicity.py:287)
09:31:29.238 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400 (501617:async_checkpointer.py:416)
09:31:29.238 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9 (501617:async_checkpointer.py:426)
09:31:29.238 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400 (501617:atomicity.py:287)
09:31:29.240 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/400`. (501617:atomicity.py:548)
09:31:29.240 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:31:29.241 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:31:29.241 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:31:29.241 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:31:29.242 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 411: grad_norm=4.1754, loss=0.5383, param_norm=1886.5870
Step 412: grad_norm=6.6843, loss=0.6998, param_norm=1886.5873
Step 413: grad_norm=34.4433, loss=0.6325, param_norm=1886.5875
Step 414: grad_norm=15.1318, loss=0.6517, param_norm=1886.5878
09:31:32.617 [I] Progress on: 414it/1.00kit rate:1.1s/it remaining:10:47 elapsed:07:56 postfix:-  (501617:tqdm_logging.py:145)
Step 415: grad_norm=7.8251, loss=0.5215, param_norm=1886.5879
Step 416: grad_norm=12.6893, loss=0.6666, param_norm=1886.5881
Step 417: grad_norm=9.8995, loss=0.7173, param_norm=1886.5883
Step 418: grad_norm=6.8823, loss=0.5385, param_norm=1886.5886
Step 419: grad_norm=5.0013, loss=0.6650, param_norm=1886.5889
Step 420: grad_norm=4.5316, loss=0.5003, param_norm=1886.5890
Step 421: grad_norm=4.1558, loss=0.4955, param_norm=1886.5892
Step 422: grad_norm=3.9360, loss=0.4978, param_norm=1886.5894
Step 423: grad_norm=11.5856, loss=0.5038, param_norm=1886.5896
09:31:42.800 [I] Progress on: 423it/1.00kit rate:1.1s/it remaining:10:51 elapsed:08:06 postfix:-  (501617:tqdm_logging.py:145)
Step 424: grad_norm=8.5754, loss=0.3788, param_norm=1886.5898
Step 425: grad_norm=10.9645, loss=0.4924, param_norm=1886.5901
Step 426: grad_norm=13.7679, loss=0.3913, param_norm=1886.5903
Step 427: grad_norm=13.3375, loss=0.5426, param_norm=1886.5905
Step 428: grad_norm=9.8672, loss=0.3854, param_norm=1886.5907
Step 429: grad_norm=6.2138, loss=0.5893, param_norm=1886.5909
Step 430: grad_norm=9.1858, loss=0.4492, param_norm=1886.5911
Step 431: grad_norm=6.5675, loss=0.3973, param_norm=1886.5913
Step 432: grad_norm=15.2816, loss=0.5522, param_norm=1886.5916
Step 433: grad_norm=23.6235, loss=0.5045, param_norm=1886.5918
09:31:53.749 [I] Progress on: 433it/1.00kit rate:1.1s/it remaining:10:21 elapsed:08:17 postfix:-  (501617:tqdm_logging.py:145)
Step 434: grad_norm=5.8676, loss=0.4041, param_norm=1886.5919
Step 435: grad_norm=10.9667, loss=0.7126, param_norm=1886.5920
Step 436: grad_norm=4.8680, loss=0.4165, param_norm=1886.5923
Step 437: grad_norm=4.8773, loss=0.4908, param_norm=1886.5925
Step 438: grad_norm=5.1912, loss=0.4342, param_norm=1886.5927
Step 439: grad_norm=4.1688, loss=0.3896, param_norm=1886.5928
Step 440: grad_norm=10.6208, loss=0.5128, param_norm=1886.5930
Step 441: grad_norm=9.3776, loss=0.4435, param_norm=1886.5933
Step 442: grad_norm=4.4202, loss=0.4794, param_norm=1886.5935
Step 443: grad_norm=5.7161, loss=0.5344, param_norm=1886.5936
09:32:04.704 [I] Progress on: 443it/1.00kit rate:1.1s/it remaining:10:10 elapsed:08:28 postfix:-  (501617:tqdm_logging.py:145)
Step 444: grad_norm=4.6341, loss=0.4928, param_norm=1886.5939
Step 445: grad_norm=4.5899, loss=0.4746, param_norm=1886.5940
Step 446: grad_norm=3.8758, loss=0.3883, param_norm=1886.5941
Step 447: grad_norm=4.8921, loss=0.5169, param_norm=1886.5944
Step 448: grad_norm=5.1436, loss=0.4809, param_norm=1886.5946
Step 449: grad_norm=6.7983, loss=0.3666, param_norm=1886.5948
Step 450: grad_norm=6.1267, loss=0.3819, param_norm=1886.5951
Step 451: grad_norm=12.3699, loss=0.4568, param_norm=1886.5952
Step 452: grad_norm=4.6856, loss=0.4117, param_norm=1886.5955
Step 453: grad_norm=5.5912, loss=0.5188, param_norm=1886.5957
09:32:15.660 [I] Progress on: 453it/1.00kit rate:1.1s/it remaining:09:59 elapsed:08:39 postfix:-  (501617:tqdm_logging.py:145)
Step 454: grad_norm=5.5181, loss=0.5264, param_norm=1886.5958
Step 455: grad_norm=6.6609, loss=0.5128, param_norm=1886.5961
Step 456: grad_norm=4.7073, loss=0.3926, param_norm=1886.5963
Step 457: grad_norm=7.1142, loss=0.5278, param_norm=1886.5964
Step 458: grad_norm=7.8778, loss=0.4868, param_norm=1886.5966
Step 459: grad_norm=12.5009, loss=0.3999, param_norm=1886.5968
Step 460: grad_norm=7.6262, loss=0.5810, param_norm=1886.5970
Step 461: grad_norm=6.1742, loss=0.5515, param_norm=1886.5972
Step 462: grad_norm=5.3439, loss=0.5096, param_norm=1886.5974
Step 463: grad_norm=20.3681, loss=0.5039, param_norm=1886.5975
09:32:26.607 [I] Progress on: 463it/1.00kit rate:1.1s/it remaining:09:47 elapsed:08:50 postfix:-  (501617:tqdm_logging.py:145)
Step 464: grad_norm=7.0876, loss=0.4728, param_norm=1886.5979
Step 465: grad_norm=5.7416, loss=0.5421, param_norm=1886.5980
Step 466: grad_norm=6.1863, loss=0.4530, param_norm=1886.5983
Step 467: grad_norm=6.3279, loss=0.5506, param_norm=1886.5984
Step 468: grad_norm=10.6921, loss=0.5693, param_norm=1886.5986
Step 469: grad_norm=6.1860, loss=0.5382, param_norm=1886.5988
Step 470: grad_norm=6.6479, loss=0.4330, param_norm=1886.5989
Step 471: grad_norm=12.3313, loss=0.5052, param_norm=1886.5990
Step 472: grad_norm=8.6375, loss=0.5169, param_norm=1886.5991
Step 473: grad_norm=6.8931, loss=0.5157, param_norm=1886.5994
09:32:37.555 [I] Progress on: 473it/1.00kit rate:1.1s/it remaining:09:36 elapsed:09:01 postfix:-  (501617:tqdm_logging.py:145)
Step 474: grad_norm=5.9831, loss=0.4269, param_norm=1886.5995
Step 475: grad_norm=6.2061, loss=0.4605, param_norm=1886.5996
Step 476: grad_norm=6.6182, loss=0.4084, param_norm=1886.5997
Step 477: grad_norm=4.4148, loss=0.4509, param_norm=1886.5999
Step 478: grad_norm=6.7381, loss=0.4754, param_norm=1886.6001
Step 479: grad_norm=4.1279, loss=0.4180, param_norm=1886.6002
Step 480: grad_norm=7.9099, loss=0.5391, param_norm=1886.6003
Step 481: grad_norm=3.8067, loss=0.4068, param_norm=1886.6006
Step 482: grad_norm=6.0444, loss=0.4886, param_norm=1886.6008
Step 483: grad_norm=4.8902, loss=0.4239, param_norm=1886.6010
09:32:48.575 [I] Progress on: 483it/1.00kit rate:1.1s/it remaining:09:28 elapsed:09:12 postfix:-  (501617:tqdm_logging.py:145)
Step 484: grad_norm=13.9075, loss=0.4153, param_norm=1886.6011
Step 485: grad_norm=7.4041, loss=0.5356, param_norm=1886.6012
Step 486: grad_norm=4.5574, loss=0.3844, param_norm=1886.6014
Step 487: grad_norm=5.1871, loss=0.4453, param_norm=1886.6014
Step 488: grad_norm=4.4324, loss=0.4396, param_norm=1886.6018
Step 489: grad_norm=7.0334, loss=0.5950, param_norm=1886.6019
Step 490: grad_norm=5.8942, loss=0.5157, param_norm=1886.6021
Step 491: grad_norm=9.1691, loss=0.3989, param_norm=1886.6023
Step 492: grad_norm=12.3890, loss=0.5319, param_norm=1886.6025
Step 493: grad_norm=12.4902, loss=0.7049, param_norm=1886.6027
09:32:59.568 [I] Progress on: 493it/1.00kit rate:1.1s/it remaining:09:17 elapsed:09:23 postfix:-  (501617:tqdm_logging.py:145)
Step 494: grad_norm=8.1436, loss=0.4200, param_norm=1886.6029
Step 495: grad_norm=4.1348, loss=0.4161, param_norm=1886.6031
Step 496: grad_norm=5.4637, loss=0.5590, param_norm=1886.6033
Step 497: grad_norm=5.8079, loss=0.4731, param_norm=1886.6034
Step 498: grad_norm=4.3646, loss=0.4004, param_norm=1886.6035
Step 499: grad_norm=6.1627, loss=0.4262, param_norm=1886.6036
Step 500: grad_norm=5.1822, loss=0.4926, param_norm=1886.6040
09:33:07.294 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:33:07.295 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:33:07.295 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (501617:checkpoint_manager.py:1786)
09:33:07.295 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (501617:checkpoint_manager.py:1817)
09:33:07.296 [I] [process=0] Saving checkpoint at step 500                                        (501617:checkpoint_manager.py:1286)
09:33:07.297 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500. (501617:async_checkpointer.py:358)
09:33:07.298 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:33:07.299 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12 (501617:atomicity.py:144)
09:33:07.300 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:33:07.300 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:33:07.301 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (501617:atomicity.py:144)
09:33:07.301 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (501617:atomicity.py:144)
09:33:07.302 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:33:07.316 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:33:11.387 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:33:11.396 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:33:11.398 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:33:11.399 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:33:11.405 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:33:11.408 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:33:11.415 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:33:11.422 [I] Preserving Checkpoint[step=400 | time=2025-04-08 13:31:17.286739+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:33:11.424 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:33:11.428 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:33:11.431 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:33:11.433 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119187.2948053, 'wait_for_prev_duration_secs': 0.0012319087982177734, 'checkpointer_blocking_start_time': 1744119187.2967405, 'checkpointer_blocking_duration_secs': 4.108352899551392, 'get_old_steps_start_time': 1744119191.4052608, 'get_old_steps_duration_secs': 0.018967390060424805, 'checkpoint_manager_blocking_start_time': 1744119187.2945812, 'checkpoint_manager_blocking_duration_secs': 4.139204025268555} (501617:standard_logger.py:34)
09:33:11.436 [I] Progress on: 501it/1.00kit rate:2.3s/it remaining:19:28 elapsed:09:35 postfix:-  (501617:tqdm_logging.py:145)
Step 501: grad_norm=7.5437, loss=0.5300, param_norm=1886.6041
Step 502: grad_norm=6.0092, loss=0.4194, param_norm=1886.6042
Step 503: grad_norm=7.9638, loss=0.5740, param_norm=1886.6044
Step 504: grad_norm=5.2243, loss=0.3212, param_norm=1886.6045
Step 505: grad_norm=8.1463, loss=0.3604, param_norm=1886.6047
Step 506: grad_norm=7.7428, loss=0.3675, param_norm=1886.6047
Step 507: grad_norm=4.2869, loss=0.3415, param_norm=1886.6050
Step 508: grad_norm=5.0572, loss=0.3715, param_norm=1886.6050
Step 509: grad_norm=3.8084, loss=0.3118, param_norm=1886.6051
09:33:21.639 [I] Progress on: 509it/1.00kit rate:1.2s/it remaining:09:44 elapsed:09:45 postfix:-  (501617:tqdm_logging.py:145)
Step 510: grad_norm=4.7042, loss=0.3940, param_norm=1886.6052
09:33:23.799 [I] ChainedFuture completed 1/1 futures in 12.40 seconds.                            (501617:future.py:137)
09:33:23.800 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 628.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 16 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:33:23.800 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:33:23.801 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12 (501617:async_checkpointer.py:406)
09:33:23.802 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12/assets (501617:atomicity.py:287)
09:33:23.814 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12/params (501617:atomicity.py:287)
09:33:23.815 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500 (501617:async_checkpointer.py:416)
09:33:23.815 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12 (501617:async_checkpointer.py:426)
09:33:23.815 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500 (501617:atomicity.py:287)
09:33:23.817 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/500`. (501617:atomicity.py:548)
09:33:23.817 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:33:23.818 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:33:23.818 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:33:23.819 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:33:23.819 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 511: grad_norm=5.2581, loss=0.3339, param_norm=1886.6053
Step 512: grad_norm=4.3199, loss=0.3437, param_norm=1886.6056
Step 513: grad_norm=5.3199, loss=0.4272, param_norm=1886.6056
Step 514: grad_norm=6.9141, loss=0.3121, param_norm=1886.6057
Step 515: grad_norm=4.1052, loss=0.3915, param_norm=1886.6058
Step 516: grad_norm=5.2922, loss=0.3628, param_norm=1886.6060
Step 517: grad_norm=4.0291, loss=0.3790, param_norm=1886.6062
Step 518: grad_norm=10.0480, loss=0.3481, param_norm=1886.6063
Step 519: grad_norm=4.0064, loss=0.3460, param_norm=1886.6064
09:33:32.660 [I] Progress on: 519it/1.00kit rate:1.1s/it remaining:08:49 elapsed:09:56 postfix:-  (501617:tqdm_logging.py:145)
Step 520: grad_norm=3.9753, loss=0.3296, param_norm=1886.6064
Step 521: grad_norm=3.9568, loss=0.2831, param_norm=1886.6067
Step 522: grad_norm=4.0447, loss=0.3793, param_norm=1886.6068
Step 523: grad_norm=4.4356, loss=0.3003, param_norm=1886.6071
Step 524: grad_norm=8.1353, loss=0.3323, param_norm=1886.6071
Step 525: grad_norm=7.8801, loss=0.3648, param_norm=1886.6073
Step 526: grad_norm=7.5441, loss=0.3736, param_norm=1886.6074
Step 527: grad_norm=5.3601, loss=0.4030, param_norm=1886.6075
Step 528: grad_norm=6.5568, loss=0.3264, param_norm=1886.6075
Step 529: grad_norm=5.3949, loss=0.3777, param_norm=1886.6078
09:33:43.620 [I] Progress on: 529it/1.00kit rate:1.1s/it remaining:08:36 elapsed:10:07 postfix:-  (501617:tqdm_logging.py:145)
Step 530: grad_norm=10.7534, loss=0.4465, param_norm=1886.6079
Step 531: grad_norm=8.0985, loss=0.2934, param_norm=1886.6079
Step 532: grad_norm=20.5398, loss=0.4002, param_norm=1886.6080
Step 533: grad_norm=8.7989, loss=0.4161, param_norm=1886.6083
Step 534: grad_norm=5.0946, loss=0.3740, param_norm=1886.6083
Step 535: grad_norm=7.7872, loss=0.3096, param_norm=1886.6084
Step 536: grad_norm=5.5870, loss=0.3288, param_norm=1886.6085
Step 537: grad_norm=6.3922, loss=0.3822, param_norm=1886.6086
Step 538: grad_norm=7.7490, loss=0.4447, param_norm=1886.6088
Step 539: grad_norm=4.3736, loss=0.3983, param_norm=1886.6089
09:33:54.599 [I] Progress on: 539it/1.00kit rate:1.1s/it remaining:08:24 elapsed:10:18 postfix:-  (501617:tqdm_logging.py:145)
Step 540: grad_norm=5.8390, loss=0.3599, param_norm=1886.6090
Step 541: grad_norm=7.7412, loss=0.3157, param_norm=1886.6091
Step 542: grad_norm=6.7495, loss=0.3867, param_norm=1886.6093
Step 543: grad_norm=8.6461, loss=0.3699, param_norm=1886.6094
Step 544: grad_norm=4.2274, loss=0.3807, param_norm=1886.6095
Step 545: grad_norm=3.9651, loss=0.3395, param_norm=1886.6096
Step 546: grad_norm=5.3960, loss=0.3751, param_norm=1886.6097
Step 547: grad_norm=5.0977, loss=0.3955, param_norm=1886.6099
Step 548: grad_norm=7.2387, loss=0.3494, param_norm=1886.6100
Step 549: grad_norm=4.2522, loss=0.3443, param_norm=1886.6102
09:34:05.647 [I] Progress on: 549it/1.00kit rate:1.1s/it remaining:08:17 elapsed:10:29 postfix:-  (501617:tqdm_logging.py:145)
Step 550: grad_norm=7.8308, loss=0.3278, param_norm=1886.6102
Step 551: grad_norm=3.8331, loss=0.3008, param_norm=1886.6105
Step 552: grad_norm=4.2143, loss=0.3633, param_norm=1886.6105
Step 553: grad_norm=3.6928, loss=0.3488, param_norm=1886.6106
Step 554: grad_norm=5.1965, loss=0.3582, param_norm=1886.6107
Step 555: grad_norm=3.6208, loss=0.3333, param_norm=1886.6108
Step 556: grad_norm=4.9872, loss=0.3957, param_norm=1886.6110
Step 557: grad_norm=9.0942, loss=0.3833, param_norm=1886.6111
Step 558: grad_norm=8.3703, loss=0.3749, param_norm=1886.6111
Step 559: grad_norm=4.5707, loss=0.4054, param_norm=1886.6113
09:34:16.642 [I] Progress on: 559it/1.00kit rate:1.1s/it remaining:08:04 elapsed:10:40 postfix:-  (501617:tqdm_logging.py:145)
Step 560: grad_norm=3.9890, loss=0.3568, param_norm=1886.6115
Step 561: grad_norm=5.1676, loss=0.3507, param_norm=1886.6116
Step 562: grad_norm=5.8931, loss=0.4133, param_norm=1886.6117
Step 563: grad_norm=8.8413, loss=0.4080, param_norm=1886.6118
Step 564: grad_norm=4.3680, loss=0.3226, param_norm=1886.6119
Step 565: grad_norm=4.2270, loss=0.3323, param_norm=1886.6121
Step 566: grad_norm=4.2030, loss=0.3054, param_norm=1886.6122
Step 567: grad_norm=3.8486, loss=0.3284, param_norm=1886.6122
Step 568: grad_norm=11.1877, loss=0.4077, param_norm=1886.6123
Step 569: grad_norm=12.4757, loss=0.2887, param_norm=1886.6124
09:34:27.618 [I] Progress on: 569it/1.00kit rate:1.1s/it remaining:07:53 elapsed:10:51 postfix:-  (501617:tqdm_logging.py:145)
Step 570: grad_norm=4.1615, loss=0.3491, param_norm=1886.6125
Step 571: grad_norm=5.8754, loss=0.3817, param_norm=1886.6127
Step 572: grad_norm=4.6323, loss=0.3908, param_norm=1886.6128
Step 573: grad_norm=10.5606, loss=0.3762, param_norm=1886.6129
Step 574: grad_norm=4.1445, loss=0.3911, param_norm=1886.6130
Step 575: grad_norm=4.9275, loss=0.3428, param_norm=1886.6133
Step 576: grad_norm=4.6015, loss=0.3822, param_norm=1886.6134
Step 577: grad_norm=4.1161, loss=0.3655, param_norm=1886.6135
Step 578: grad_norm=4.8926, loss=0.4435, param_norm=1886.6136
Step 579: grad_norm=11.5987, loss=0.4431, param_norm=1886.6138
09:34:38.581 [I] Progress on: 579it/1.00kit rate:1.1s/it remaining:07:41 elapsed:11:02 postfix:-  (501617:tqdm_logging.py:145)
Step 580: grad_norm=4.2098, loss=0.3172, param_norm=1886.6138
Step 581: grad_norm=7.6534, loss=0.3671, param_norm=1886.6139
Step 582: grad_norm=5.1814, loss=0.3639, param_norm=1886.6140
Step 583: grad_norm=4.8560, loss=0.3310, param_norm=1886.6141
Step 584: grad_norm=3.6322, loss=0.3208, param_norm=1886.6141
Step 585: grad_norm=9.1407, loss=0.3729, param_norm=1886.6143
Step 586: grad_norm=6.8399, loss=0.4807, param_norm=1886.6144
Step 587: grad_norm=3.9614, loss=0.3120, param_norm=1886.6144
Step 588: grad_norm=6.2753, loss=0.3013, param_norm=1886.6145
09:34:48.813 [I] Progress on: 588it/1.00kit rate:1.2s/it remaining:08:15 elapsed:11:12 postfix:-  (501617:tqdm_logging.py:145)
Step 589: grad_norm=6.0111, loss=0.2703, param_norm=1886.6145
Step 590: grad_norm=7.3057, loss=0.2753, param_norm=1886.6145
Step 591: grad_norm=3.6785, loss=0.2788, param_norm=1886.6146
Step 592: grad_norm=3.6859, loss=0.3184, param_norm=1886.6147
Step 593: grad_norm=6.6985, loss=0.2994, param_norm=1886.6149
Step 594: grad_norm=3.9439, loss=0.2820, param_norm=1886.6150
Step 595: grad_norm=3.0265, loss=0.1976, param_norm=1886.6151
Step 596: grad_norm=4.0634, loss=0.2611, param_norm=1886.6151
Step 597: grad_norm=4.3648, loss=0.2193, param_norm=1886.6152
Step 598: grad_norm=4.5930, loss=0.2757, param_norm=1886.6152
09:34:59.776 [I] Progress on: 598it/1.00kit rate:1.1s/it remaining:07:22 elapsed:11:23 postfix:-  (501617:tqdm_logging.py:145)
Step 599: grad_norm=3.8700, loss=0.3140, param_norm=1886.6154
Step 600: grad_norm=6.9630, loss=0.2650, param_norm=1886.6154
09:35:02.038 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:35:02.038 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:35:02.038 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (501617:checkpoint_manager.py:1786)
09:35:02.038 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (501617:checkpoint_manager.py:1817)
09:35:02.039 [I] [process=0] Saving checkpoint at step 600                                        (501617:checkpoint_manager.py:1286)
09:35:02.040 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600. (501617:async_checkpointer.py:358)
09:35:02.041 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:35:02.041 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15 (501617:atomicity.py:144)
09:35:02.042 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:35:02.042 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:35:02.043 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (501617:atomicity.py:144)
09:35:02.044 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (501617:atomicity.py:144)
09:35:02.044 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:35:02.049 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:35:06.096 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:35:06.104 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:35:06.105 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:35:06.108 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:35:06.109 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:35:06.113 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:35:06.114 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:35:06.114 [I] Preserving Checkpoint[step=400 | time=2025-04-08 13:31:17.286739+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:35:06.115 [I] Preserving Checkpoint[step=500 | time=2025-04-08 13:33:11.405170+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:35:06.116 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:35:06.117 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:35:06.126 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:35:06.130 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119302.0381866, 'wait_for_prev_duration_secs': 0.0006844997406005859, 'checkpointer_blocking_start_time': 1744119302.039494, 'checkpointer_blocking_duration_secs': 4.070024013519287, 'get_old_steps_start_time': 1744119306.109722, 'get_old_steps_duration_secs': 0.006509542465209961, 'checkpoint_manager_blocking_start_time': 1744119302.0379937, 'checkpoint_manager_blocking_duration_secs': 4.092644453048706} (501617:standard_logger.py:34)
Step 601: grad_norm=7.5690, loss=0.2400, param_norm=1886.6155
Step 602: grad_norm=3.9714, loss=0.2253, param_norm=1886.6156
Step 603: grad_norm=3.0669, loss=0.2616, param_norm=1886.6157
Step 604: grad_norm=3.1809, loss=0.1995, param_norm=1886.6157
09:35:10.687 [I] Progress on: 604it/1.00kit rate:1.5s/it remaining:10:13 elapsed:11:34 postfix:-  (501617:tqdm_logging.py:145)
Step 605: grad_norm=5.5647, loss=0.3186, param_norm=1886.6158
Step 606: grad_norm=3.9616, loss=0.2612, param_norm=1886.6160
Step 607: grad_norm=6.1982, loss=0.2672, param_norm=1886.6160
Step 608: grad_norm=5.4969, loss=0.3363, param_norm=1886.6161
Step 609: grad_norm=7.5082, loss=0.3718, param_norm=1886.6161
Step 610: grad_norm=3.6773, loss=0.2898, param_norm=1886.6163
Step 611: grad_norm=6.2952, loss=0.2497, param_norm=1886.6163
Step 612: grad_norm=19.0014, loss=0.2600, param_norm=1886.6165
Step 613: grad_norm=4.1278, loss=0.3148, param_norm=1886.6166
09:35:20.745 [I] ChainedFuture completed 1/1 futures in 14.64 seconds.                            (501617:future.py:137)
09:35:20.746 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 554.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 18 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:35:20.746 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:35:20.747 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15 (501617:async_checkpointer.py:406)
09:35:20.748 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15/assets (501617:atomicity.py:287)
09:35:20.758 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15/params (501617:atomicity.py:287)
09:35:20.759 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600 (501617:async_checkpointer.py:416)
09:35:20.759 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15 (501617:async_checkpointer.py:426)
09:35:20.759 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600 (501617:atomicity.py:287)
09:35:20.761 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/600`. (501617:atomicity.py:548)
09:35:20.761 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:35:20.762 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:35:20.762 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:35:20.762 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:35:20.763 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 614: grad_norm=3.6921, loss=0.2513, param_norm=1886.6166
09:35:21.622 [I] Progress on: 614it/1.00kit rate:1.1s/it remaining:07:06 elapsed:11:45 postfix:-  (501617:tqdm_logging.py:145)
Step 615: grad_norm=3.3281, loss=0.2367, param_norm=1886.6166
Step 616: grad_norm=6.8506, loss=0.2534, param_norm=1886.6167
Step 617: grad_norm=3.6967, loss=0.2626, param_norm=1886.6168
Step 618: grad_norm=5.4650, loss=0.2950, param_norm=1886.6169
Step 619: grad_norm=5.1020, loss=0.2158, param_norm=1886.6171
Step 620: grad_norm=4.7631, loss=0.2310, param_norm=1886.6171
Step 621: grad_norm=3.5957, loss=0.2848, param_norm=1886.6172
Step 622: grad_norm=9.5188, loss=0.2468, param_norm=1886.6172
Step 623: grad_norm=6.4495, loss=0.2689, param_norm=1886.6173
Step 624: grad_norm=6.6535, loss=0.2383, param_norm=1886.6173
09:35:32.577 [I] Progress on: 624it/1.00kit rate:1.1s/it remaining:06:51 elapsed:11:56 postfix:-  (501617:tqdm_logging.py:145)
Step 625: grad_norm=3.4047, loss=0.2177, param_norm=1886.6174
Step 626: grad_norm=4.3351, loss=0.2927, param_norm=1886.6174
Step 627: grad_norm=3.0471, loss=0.2493, param_norm=1886.6176
Step 628: grad_norm=3.3072, loss=0.2176, param_norm=1886.6176
Step 629: grad_norm=5.3862, loss=0.2179, param_norm=1886.6177
Step 630: grad_norm=5.3607, loss=0.3366, param_norm=1886.6177
Step 631: grad_norm=3.4752, loss=0.2635, param_norm=1886.6179
Step 632: grad_norm=3.5122, loss=0.2546, param_norm=1886.6179
Step 633: grad_norm=5.1813, loss=0.3339, param_norm=1886.6179
Step 634: grad_norm=4.1030, loss=0.2221, param_norm=1886.6179
09:35:43.554 [I] Progress on: 634it/1.00kit rate:1.1s/it remaining:06:41 elapsed:12:07 postfix:-  (501617:tqdm_logging.py:145)
Step 635: grad_norm=3.4780, loss=0.2501, param_norm=1886.6180
Step 636: grad_norm=3.9652, loss=0.1754, param_norm=1886.6180
Step 637: grad_norm=4.9717, loss=0.2293, param_norm=1886.6182
Step 638: grad_norm=3.3918, loss=0.2023, param_norm=1886.6182
Step 639: grad_norm=4.6307, loss=0.2385, param_norm=1886.6182
Step 640: grad_norm=8.7032, loss=0.2400, param_norm=1886.6183
Step 641: grad_norm=3.8428, loss=0.2255, param_norm=1886.6183
Step 642: grad_norm=13.0381, loss=0.2929, param_norm=1886.6184
Step 643: grad_norm=4.3744, loss=0.2620, param_norm=1886.6184
Step 644: grad_norm=7.4211, loss=0.2571, param_norm=1886.6185
09:35:54.536 [I] Progress on: 644it/1.00kit rate:1.1s/it remaining:06:31 elapsed:12:18 postfix:-  (501617:tqdm_logging.py:145)
Step 645: grad_norm=4.1769, loss=0.2653, param_norm=1886.6187
Step 646: grad_norm=4.8076, loss=0.2057, param_norm=1886.6187
Step 647: grad_norm=6.9803, loss=0.2831, param_norm=1886.6188
Step 648: grad_norm=3.6653, loss=0.1685, param_norm=1886.6188
Step 649: grad_norm=4.3470, loss=0.2701, param_norm=1886.6189
Step 650: grad_norm=4.1320, loss=0.2635, param_norm=1886.6189
Step 651: grad_norm=6.1777, loss=0.2452, param_norm=1886.6190
Step 652: grad_norm=3.1352, loss=0.2079, param_norm=1886.6190
Step 653: grad_norm=5.9632, loss=0.2787, param_norm=1886.6191
Step 654: grad_norm=3.6414, loss=0.2381, param_norm=1886.6191
09:36:05.510 [I] Progress on: 654it/1.00kit rate:1.1s/it remaining:06:19 elapsed:12:29 postfix:-  (501617:tqdm_logging.py:145)
Step 655: grad_norm=4.2161, loss=0.2553, param_norm=1886.6193
Step 656: grad_norm=3.3693, loss=0.2199, param_norm=1886.6193
Step 657: grad_norm=3.4475, loss=0.2202, param_norm=1886.6194
Step 658: grad_norm=6.0647, loss=0.2817, param_norm=1886.6195
Step 659: grad_norm=5.9582, loss=0.2944, param_norm=1886.6196
Step 660: grad_norm=3.9458, loss=0.2349, param_norm=1886.6196
Step 661: grad_norm=4.9869, loss=0.2633, param_norm=1886.6196
Step 662: grad_norm=6.1585, loss=0.2672, param_norm=1886.6198
Step 663: grad_norm=5.2872, loss=0.2646, param_norm=1886.6198
Step 664: grad_norm=19.2375, loss=0.2533, param_norm=1886.6199
09:36:16.502 [I] Progress on: 664it/1.00kit rate:1.1s/it remaining:06:09 elapsed:12:40 postfix:-  (501617:tqdm_logging.py:145)
Step 665: grad_norm=5.8090, loss=0.2669, param_norm=1886.6200
Step 666: grad_norm=3.8525, loss=0.2656, param_norm=1886.6200
Step 667: grad_norm=6.2901, loss=0.3213, param_norm=1886.6201
Step 668: grad_norm=3.7893, loss=0.2914, param_norm=1886.6202
Step 669: grad_norm=7.4192, loss=0.2656, param_norm=1886.6202
Step 670: grad_norm=4.0928, loss=0.2692, param_norm=1886.6202
Step 671: grad_norm=7.9876, loss=0.3031, param_norm=1886.6204
Step 672: grad_norm=3.8913, loss=0.2342, param_norm=1886.6204
Step 673: grad_norm=2.7654, loss=0.1777, param_norm=1886.6204
09:36:26.708 [I] Progress on: 673it/1.00kit rate:1.2s/it remaining:06:20 elapsed:12:50 postfix:-  (501617:tqdm_logging.py:145)
Step 674: grad_norm=2.8048, loss=0.1885, param_norm=1886.6204
Step 675: grad_norm=3.2429, loss=0.2459, param_norm=1886.6205
Step 676: grad_norm=2.9936, loss=0.2243, param_norm=1886.6205
Step 677: grad_norm=3.3560, loss=0.2146, param_norm=1886.6206
Step 678: grad_norm=3.9256, loss=0.2404, param_norm=1886.6206
Step 679: grad_norm=3.2456, loss=0.2308, param_norm=1886.6207
Step 680: grad_norm=2.8446, loss=0.1835, param_norm=1886.6207
Step 681: grad_norm=4.0982, loss=0.1613, param_norm=1886.6207
Step 682: grad_norm=4.6047, loss=0.2344, param_norm=1886.6208
Step 683: grad_norm=3.2078, loss=0.1994, param_norm=1886.6210
09:36:37.700 [I] Progress on: 683it/1.00kit rate:1.1s/it remaining:05:48 elapsed:13:01 postfix:-  (501617:tqdm_logging.py:145)
Step 684: grad_norm=2.6634, loss=0.1697, param_norm=1886.6210
Step 685: grad_norm=5.6055, loss=0.2336, param_norm=1886.6210
Step 686: grad_norm=3.4660, loss=0.1970, param_norm=1886.6211
Step 687: grad_norm=5.8478, loss=0.1803, param_norm=1886.6211
Step 688: grad_norm=3.3473, loss=0.1560, param_norm=1886.6211
Step 689: grad_norm=4.3144, loss=0.1627, param_norm=1886.6212
Step 690: grad_norm=5.2526, loss=0.1827, param_norm=1886.6212
Step 691: grad_norm=2.9346, loss=0.1564, param_norm=1886.6212
Step 692: grad_norm=5.9896, loss=0.1830, param_norm=1886.6213
Step 693: grad_norm=4.6894, loss=0.2391, param_norm=1886.6213
09:36:48.686 [I] Progress on: 693it/1.00kit rate:1.1s/it remaining:05:37 elapsed:13:12 postfix:-  (501617:tqdm_logging.py:145)
Step 694: grad_norm=4.1839, loss=0.2737, param_norm=1886.6215
Step 695: grad_norm=4.0193, loss=0.2051, param_norm=1886.6215
Step 696: grad_norm=5.5790, loss=0.1651, param_norm=1886.6215
Step 697: grad_norm=5.1157, loss=0.2343, param_norm=1886.6215
Step 698: grad_norm=3.6061, loss=0.1545, param_norm=1886.6216
Step 699: grad_norm=2.9108, loss=0.1760, param_norm=1886.6216
Step 700: grad_norm=10.3343, loss=0.1772, param_norm=1886.6216
09:36:56.413 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:36:56.413 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:36:56.413 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (501617:checkpoint_manager.py:1786)
09:36:56.413 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (501617:checkpoint_manager.py:1817)
09:36:56.414 [I] [process=0] Saving checkpoint at step 700                                        (501617:checkpoint_manager.py:1286)
09:36:56.415 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700. (501617:async_checkpointer.py:358)
09:36:56.416 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:36:56.417 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18 (501617:atomicity.py:144)
09:36:56.417 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:36:56.418 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:36:56.419 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (501617:atomicity.py:144)
09:36:56.419 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (501617:atomicity.py:144)
09:36:56.420 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:36:56.425 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:37:00.610 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:37:00.610 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:37:00.612 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:37:00.613 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:37:00.637 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:37:00.639 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:37:00.641 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:37:00.644 [I] Preserving Checkpoint[step=400 | time=2025-04-08 13:31:17.286739+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:37:00.647 [I] Preserving Checkpoint[step=500 | time=2025-04-08 13:33:11.405170+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:37:00.710 [I] Preserving Checkpoint[step=600 | time=2025-04-08 13:35:06.109622+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:37:00.714 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:37:00.724 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:37:00.844 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:37:00.845 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119416.413006, 'wait_for_prev_duration_secs': 0.0008287429809570312, 'checkpointer_blocking_start_time': 1744119416.414565, 'checkpointer_blocking_duration_secs': 4.222743511199951, 'get_old_steps_start_time': 1744119420.6373627, 'get_old_steps_duration_secs': 0.07719922065734863, 'checkpoint_manager_blocking_start_time': 1744119416.4127696, 'checkpoint_manager_blocking_duration_secs': 4.432862997055054} (501617:standard_logger.py:34)
09:37:00.853 [I] Progress on: 701it/1.00kit rate:2.4s/it remaining:12:07 elapsed:13:24 postfix:-  (501617:tqdm_logging.py:145)
Step 701: grad_norm=3.3403, loss=0.2137, param_norm=1886.6216
Step 702: grad_norm=4.9957, loss=0.1378, param_norm=1886.6217
Step 703: grad_norm=4.3596, loss=0.2216, param_norm=1886.6218
Step 704: grad_norm=6.7630, loss=0.2278, param_norm=1886.6218
Step 705: grad_norm=3.1988, loss=0.1912, param_norm=1886.6218
Step 706: grad_norm=4.0294, loss=0.2007, param_norm=1886.6219
Step 707: grad_norm=5.1480, loss=0.1497, param_norm=1886.6219
Step 708: grad_norm=3.7222, loss=0.2026, param_norm=1886.6219
Step 709: grad_norm=2.4011, loss=0.1866, param_norm=1886.6221
09:37:10.804 [I] ChainedFuture completed 1/1 futures in 10.18 seconds.                            (501617:future.py:137)
09:37:10.805 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 720.3 MiB/s (total bytes: 10.1 GiB) (time elapsed: 14 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:37:10.805 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:37:10.806 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18 (501617:async_checkpointer.py:406)
09:37:10.807 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18/assets (501617:atomicity.py:287)
09:37:10.817 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18/params (501617:atomicity.py:287)
09:37:10.817 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700 (501617:async_checkpointer.py:416)
09:37:10.818 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18 (501617:async_checkpointer.py:426)
09:37:10.818 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700 (501617:atomicity.py:287)
09:37:10.819 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/700`. (501617:atomicity.py:548)
09:37:10.820 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:37:10.820 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:37:10.821 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:37:10.821 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:37:10.821 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 710: grad_norm=3.4028, loss=0.1858, param_norm=1886.6222
09:37:11.810 [I] Progress on: 710it/1.00kit rate:1.1s/it remaining:05:33 elapsed:13:35 postfix:-  (501617:tqdm_logging.py:145)
Step 711: grad_norm=2.5960, loss=0.1411, param_norm=1886.6222
Step 712: grad_norm=2.8913, loss=0.1933, param_norm=1886.6223
Step 713: grad_norm=6.0826, loss=0.2112, param_norm=1886.6223
Step 714: grad_norm=6.2137, loss=0.1537, param_norm=1886.6223
Step 715: grad_norm=6.0244, loss=0.3095, param_norm=1886.6226
Step 716: grad_norm=4.4136, loss=0.1739, param_norm=1886.6226
Step 717: grad_norm=3.1090, loss=0.1793, param_norm=1886.6227
Step 718: grad_norm=3.5319, loss=0.2180, param_norm=1886.6227
Step 719: grad_norm=4.5692, loss=0.3163, param_norm=1886.6227
09:37:22.229 [I] Progress on: 719it/1.00kit rate:1.1s/it remaining:05:19 elapsed:13:46 postfix:-  (501617:tqdm_logging.py:145)
Step 720: grad_norm=3.3038, loss=0.2123, param_norm=1886.6228
Step 721: grad_norm=4.9409, loss=0.1719, param_norm=1886.6228
Step 722: grad_norm=3.3955, loss=0.1502, param_norm=1886.6228
Step 723: grad_norm=3.8852, loss=0.2061, param_norm=1886.6229
Step 724: grad_norm=3.5036, loss=0.2017, param_norm=1886.6229
Step 725: grad_norm=2.6253, loss=0.1660, param_norm=1886.6230
Step 726: grad_norm=2.6403, loss=0.1450, param_norm=1886.6230
Step 727: grad_norm=3.0067, loss=0.1869, param_norm=1886.6232
Step 728: grad_norm=9.7479, loss=0.1910, param_norm=1886.6232
Step 729: grad_norm=5.7122, loss=0.2518, param_norm=1886.6233
09:37:33.150 [I] Progress on: 729it/1.00kit rate:1.1s/it remaining:04:56 elapsed:13:56 postfix:-  (501617:tqdm_logging.py:145)
Step 730: grad_norm=3.3108, loss=0.1885, param_norm=1886.6233
Step 731: grad_norm=4.0348, loss=0.1734, param_norm=1886.6234
Step 732: grad_norm=4.2127, loss=0.1749, param_norm=1886.6234
Step 733: grad_norm=6.0890, loss=0.2689, param_norm=1886.6234
Step 734: grad_norm=3.7300, loss=0.2106, param_norm=1886.6234
Step 735: grad_norm=3.1490, loss=0.1507, param_norm=1886.6235
Step 736: grad_norm=2.6598, loss=0.1652, param_norm=1886.6235
Step 737: grad_norm=3.0385, loss=0.1829, param_norm=1886.6237
Step 738: grad_norm=3.7437, loss=0.2240, param_norm=1886.6235
Step 739: grad_norm=3.4577, loss=0.1909, param_norm=1886.6235
09:37:44.071 [I] Progress on: 739it/1.00kit rate:1.1s/it remaining:04:45 elapsed:14:07 postfix:-  (501617:tqdm_logging.py:145)
Step 740: grad_norm=5.9044, loss=0.1808, param_norm=1886.6235
Step 741: grad_norm=3.2954, loss=0.1957, param_norm=1886.6237
Step 742: grad_norm=4.1897, loss=0.2001, param_norm=1886.6237
Step 743: grad_norm=4.8888, loss=0.1870, param_norm=1886.6237
Step 744: grad_norm=3.9473, loss=0.2172, param_norm=1886.6237
Step 745: grad_norm=3.3846, loss=0.2126, param_norm=1886.6238
Step 746: grad_norm=2.6346, loss=0.1696, param_norm=1886.6238
Step 747: grad_norm=3.1791, loss=0.1830, param_norm=1886.6238
Step 748: grad_norm=3.5361, loss=0.1986, param_norm=1886.6238
Step 749: grad_norm=3.0058, loss=0.1478, param_norm=1886.6238
09:37:54.999 [I] Progress on: 749it/1.00kit rate:1.1s/it remaining:04:34 elapsed:14:18 postfix:-  (501617:tqdm_logging.py:145)
Step 750: grad_norm=4.9618, loss=0.1906, param_norm=1886.6239
Step 751: grad_norm=4.9622, loss=0.1940, param_norm=1886.6239
Step 752: grad_norm=4.3769, loss=0.2246, param_norm=1886.6239
Step 753: grad_norm=2.7772, loss=0.1752, param_norm=1886.6239
Step 754: grad_norm=4.1360, loss=0.2378, param_norm=1886.6239
Step 755: grad_norm=3.1785, loss=0.1679, param_norm=1886.6239
Step 756: grad_norm=7.2189, loss=0.1688, param_norm=1886.6239
Step 757: grad_norm=4.2580, loss=0.1434, param_norm=1886.6241
Step 758: grad_norm=4.4110, loss=0.1436, param_norm=1886.6241
09:38:05.159 [I] Progress on: 758it/1.00kit rate:1.1s/it remaining:04:35 elapsed:14:28 postfix:-  (501617:tqdm_logging.py:145)
Step 759: grad_norm=5.1030, loss=0.1777, param_norm=1886.6241
Step 760: grad_norm=3.1245, loss=0.1747, param_norm=1886.6241
Step 761: grad_norm=2.6322, loss=0.1385, param_norm=1886.6241
Step 762: grad_norm=2.4621, loss=0.1260, param_norm=1886.6241
Step 763: grad_norm=2.0041, loss=0.1257, param_norm=1886.6243
Step 764: grad_norm=2.3845, loss=0.1226, param_norm=1886.6243
Step 765: grad_norm=4.7776, loss=0.1398, param_norm=1886.6243
Step 766: grad_norm=4.0406, loss=0.1490, param_norm=1886.6243
Step 767: grad_norm=7.0716, loss=0.1729, param_norm=1886.6243
Step 768: grad_norm=2.6539, loss=0.1325, param_norm=1886.6243
09:38:16.079 [I] Progress on: 768it/1.00kit rate:1.1s/it remaining:04:13 elapsed:14:39 postfix:-  (501617:tqdm_logging.py:145)
Step 769: grad_norm=2.7588, loss=0.1448, param_norm=1886.6243
Step 770: grad_norm=2.0978, loss=0.1178, param_norm=1886.6244
Step 771: grad_norm=3.8888, loss=0.1706, param_norm=1886.6244
Step 772: grad_norm=3.9704, loss=0.1587, param_norm=1886.6244
Step 773: grad_norm=3.9154, loss=0.1531, param_norm=1886.6244
Step 774: grad_norm=3.1264, loss=0.1296, param_norm=1886.6245
Step 775: grad_norm=2.9828, loss=0.1362, param_norm=1886.6245
Step 776: grad_norm=2.6296, loss=0.1384, param_norm=1886.6245
Step 777: grad_norm=5.6412, loss=0.2098, param_norm=1886.6245
Step 778: grad_norm=2.9347, loss=0.1977, param_norm=1886.6246
09:38:27.004 [I] Progress on: 778it/1.00kit rate:1.1s/it remaining:04:02 elapsed:14:50 postfix:-  (501617:tqdm_logging.py:145)
Step 779: grad_norm=4.6245, loss=0.1718, param_norm=1886.6246
Step 780: grad_norm=4.5132, loss=0.1554, param_norm=1886.6248
Step 781: grad_norm=3.9829, loss=0.1140, param_norm=1886.6248
Step 782: grad_norm=2.0984, loss=0.1059, param_norm=1886.6248
Step 783: grad_norm=3.1760, loss=0.1206, param_norm=1886.6248
Step 784: grad_norm=3.1642, loss=0.1570, param_norm=1886.6249
Step 785: grad_norm=2.7411, loss=0.1298, param_norm=1886.6248
Step 786: grad_norm=2.9814, loss=0.1216, param_norm=1886.6249
Step 787: grad_norm=3.2853, loss=0.1364, param_norm=1886.6250
Step 788: grad_norm=2.8186, loss=0.1348, param_norm=1886.6250
09:38:37.910 [I] Progress on: 788it/1.00kit rate:1.1s/it remaining:03:51 elapsed:15:01 postfix:-  (501617:tqdm_logging.py:145)
Step 789: grad_norm=2.5981, loss=0.1377, param_norm=1886.6250
Step 790: grad_norm=4.4692, loss=0.1452, param_norm=1886.6250
Step 791: grad_norm=2.4631, loss=0.1219, param_norm=1886.6250
Step 792: grad_norm=3.1634, loss=0.1665, param_norm=1886.6250
Step 793: grad_norm=2.5204, loss=0.1591, param_norm=1886.6250
Step 794: grad_norm=3.5574, loss=0.1888, param_norm=1886.6250
Step 795: grad_norm=2.3790, loss=0.1245, param_norm=1886.6250
Step 796: grad_norm=4.9876, loss=0.1734, param_norm=1886.6251
Step 797: grad_norm=2.6189, loss=0.1522, param_norm=1886.6251
Step 798: grad_norm=2.3966, loss=0.1183, param_norm=1886.6251
09:38:48.965 [I] Progress on: 798it/1.00kit rate:1.1s/it remaining:03:42 elapsed:15:12 postfix:-  (501617:tqdm_logging.py:145)
Step 799: grad_norm=2.2679, loss=0.1336, param_norm=1886.6251
Step 800: grad_norm=2.9297, loss=0.1243, param_norm=1886.6251
09:38:51.200 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:38:51.200 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:38:51.201 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (501617:checkpoint_manager.py:1786)
09:38:51.201 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (501617:checkpoint_manager.py:1817)
09:38:51.201 [I] [process=0] Saving checkpoint at step 800                                        (501617:checkpoint_manager.py:1286)
09:38:51.202 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800. (501617:async_checkpointer.py:358)
09:38:51.203 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:38:51.204 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21 (501617:atomicity.py:144)
09:38:51.204 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:38:51.205 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:38:51.206 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (501617:atomicity.py:144)
09:38:51.206 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (501617:atomicity.py:144)
09:38:51.207 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:38:51.212 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:38:55.188 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:38:55.189 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:38:55.190 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:38:55.191 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:38:55.213 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.215 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.216 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.219 [I] Preserving Checkpoint[step=400 | time=2025-04-08 13:31:17.286739+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.221 [I] Preserving Checkpoint[step=500 | time=2025-04-08 13:33:11.405170+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.230 [I] Preserving Checkpoint[step=600 | time=2025-04-08 13:35:06.109622+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.235 [I] Preserving Checkpoint[step=700 | time=2025-04-08 13:37:00.637324+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:38:55.237 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:38:55.238 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:38:55.245 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:38:55.246 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119531.200559, 'wait_for_prev_duration_secs': 0.0006623268127441406, 'checkpointer_blocking_start_time': 1744119531.2018113, 'checkpointer_blocking_duration_secs': 4.011707067489624, 'get_old_steps_start_time': 1744119535.2135844, 'get_old_steps_duration_secs': 0.023385047912597656, 'checkpoint_manager_blocking_start_time': 1744119531.2003403, 'checkpoint_manager_blocking_duration_secs': 4.045781850814819} (501617:standard_logger.py:34)
Step 801: grad_norm=3.2228, loss=0.1533, param_norm=1886.6251
Step 802: grad_norm=12.0443, loss=0.1458, param_norm=1886.6251
Step 803: grad_norm=2.7533, loss=0.1439, param_norm=1886.6252
Step 804: grad_norm=2.5053, loss=0.1278, param_norm=1886.6252
09:38:59.578 [I] Progress on: 804it/1.00kit rate:1.5s/it remaining:04:55 elapsed:15:23 postfix:-  (501617:tqdm_logging.py:145)
Step 805: grad_norm=2.9034, loss=0.1418, param_norm=1886.6252
Step 806: grad_norm=3.8903, loss=0.1235, param_norm=1886.6252
Step 807: grad_norm=4.6163, loss=0.1147, param_norm=1886.6254
09:39:03.109 [I] ChainedFuture completed 1/1 futures in 7.90 seconds.                             (501617:future.py:137)
09:39:03.109 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 870.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:39:03.110 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:39:03.111 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21 (501617:async_checkpointer.py:406)
09:39:03.112 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21/assets (501617:atomicity.py:287)
09:39:03.123 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21/params (501617:atomicity.py:287)
09:39:03.123 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800 (501617:async_checkpointer.py:416)
09:39:03.124 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21 (501617:async_checkpointer.py:426)
09:39:03.124 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800 (501617:atomicity.py:287)
09:39:03.126 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/800`. (501617:atomicity.py:548)
09:39:03.126 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:39:03.126 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:39:03.127 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:39:03.127 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:39:03.128 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 808: grad_norm=3.1712, loss=0.1353, param_norm=1886.6254
Step 809: grad_norm=3.9048, loss=0.1504, param_norm=1886.6254
Step 810: grad_norm=4.6880, loss=0.1306, param_norm=1886.6254
Step 811: grad_norm=3.3108, loss=0.1424, param_norm=1886.6254
Step 812: grad_norm=3.0568, loss=0.1689, param_norm=1886.6254
Step 813: grad_norm=3.8293, loss=0.1219, param_norm=1886.6255
Step 814: grad_norm=3.3059, loss=0.1825, param_norm=1886.6255
09:39:10.490 [I] Progress on: 814it/1.00kit rate:1.1s/it remaining:03:24 elapsed:15:34 postfix:-  (501617:tqdm_logging.py:145)
Step 815: grad_norm=3.3314, loss=0.1462, param_norm=1886.6255
Step 816: grad_norm=3.1921, loss=0.1365, param_norm=1886.6256
Step 817: grad_norm=2.3694, loss=0.1060, param_norm=1886.6256
Step 818: grad_norm=6.2463, loss=0.1609, param_norm=1886.6256
Step 819: grad_norm=2.4751, loss=0.1210, param_norm=1886.6256
Step 820: grad_norm=3.2257, loss=0.1095, param_norm=1886.6256
Step 821: grad_norm=3.1415, loss=0.1278, param_norm=1886.6257
Step 822: grad_norm=2.3729, loss=0.1133, param_norm=1886.6257
Step 823: grad_norm=4.1681, loss=0.1671, param_norm=1886.6257
Step 824: grad_norm=3.4181, loss=0.1189, param_norm=1886.6257
09:39:21.379 [I] Progress on: 824it/1.00kit rate:1.1s/it remaining:03:11 elapsed:15:45 postfix:-  (501617:tqdm_logging.py:145)
Step 825: grad_norm=2.2330, loss=0.1146, param_norm=1886.6257
Step 826: grad_norm=2.5741, loss=0.1679, param_norm=1886.6257
Step 827: grad_norm=2.1619, loss=0.1179, param_norm=1886.6259
Step 828: grad_norm=2.4214, loss=0.1253, param_norm=1886.6259
Step 829: grad_norm=2.3380, loss=0.1346, param_norm=1886.6259
Step 830: grad_norm=2.7872, loss=0.1588, param_norm=1886.6259
Step 831: grad_norm=2.5678, loss=0.1533, param_norm=1886.6259
Step 832: grad_norm=2.6146, loss=0.1242, param_norm=1886.6259
Step 833: grad_norm=2.8909, loss=0.1517, param_norm=1886.6260
Step 834: grad_norm=2.6216, loss=0.1061, param_norm=1886.6259
09:39:32.251 [I] Progress on: 834it/1.00kit rate:1.1s/it remaining:03:00 elapsed:15:56 postfix:-  (501617:tqdm_logging.py:145)
Step 835: grad_norm=2.6294, loss=0.1464, param_norm=1886.6260
Step 836: grad_norm=5.4966, loss=0.1502, param_norm=1886.6260
Step 837: grad_norm=2.8471, loss=0.1432, param_norm=1886.6260
Step 838: grad_norm=2.3898, loss=0.1239, param_norm=1886.6260
Step 839: grad_norm=4.0228, loss=0.1159, param_norm=1886.6260
Step 840: grad_norm=3.9075, loss=0.1109, param_norm=1886.6260
Step 841: grad_norm=2.4317, loss=0.1349, param_norm=1886.6260
Step 842: grad_norm=1.8899, loss=0.0874, param_norm=1886.6261
Step 843: grad_norm=2.5669, loss=0.1144, param_norm=1886.6261
09:39:42.505 [I] Progress on: 843it/1.00kit rate:1.1s/it remaining:02:56 elapsed:16:06 postfix:-  (501617:tqdm_logging.py:145)
Step 844: grad_norm=2.3241, loss=0.1114, param_norm=1886.6261
Step 845: grad_norm=2.7174, loss=0.1005, param_norm=1886.6261
Step 846: grad_norm=1.8270, loss=0.0779, param_norm=1886.6261
Step 847: grad_norm=2.3402, loss=0.1206, param_norm=1886.6261
Step 848: grad_norm=2.1189, loss=0.0940, param_norm=1886.6262
Step 849: grad_norm=3.9505, loss=0.1082, param_norm=1886.6262
Step 850: grad_norm=1.9406, loss=0.0989, param_norm=1886.6262
Step 851: grad_norm=4.2808, loss=0.1309, param_norm=1886.6262
Step 852: grad_norm=2.0596, loss=0.0924, param_norm=1886.6262
Step 853: grad_norm=2.5660, loss=0.1219, param_norm=1886.6262
09:39:53.389 [I] Progress on: 853it/1.00kit rate:1.1s/it remaining:02:40 elapsed:16:17 postfix:-  (501617:tqdm_logging.py:145)
Step 854: grad_norm=3.6652, loss=0.1443, param_norm=1886.6263
Step 855: grad_norm=3.2835, loss=0.0939, param_norm=1886.6263
Step 856: grad_norm=2.4712, loss=0.0952, param_norm=1886.6263
Step 857: grad_norm=2.7693, loss=0.0861, param_norm=1886.6263
Step 858: grad_norm=2.9975, loss=0.0894, param_norm=1886.6263
Step 859: grad_norm=4.3184, loss=0.1055, param_norm=1886.6263
Step 860: grad_norm=4.0239, loss=0.1144, param_norm=1886.6263
Step 861: grad_norm=2.9636, loss=0.1016, param_norm=1886.6263
Step 862: grad_norm=2.3745, loss=0.0837, param_norm=1886.6265
Step 863: grad_norm=2.1116, loss=0.0890, param_norm=1886.6265
09:40:04.259 [I] Progress on: 863it/1.00kit rate:1.1s/it remaining:02:29 elapsed:16:28 postfix:-  (501617:tqdm_logging.py:145)
Step 864: grad_norm=1.7832, loss=0.0915, param_norm=1886.6265
Step 865: grad_norm=1.5197, loss=0.0691, param_norm=1886.6265
Step 866: grad_norm=3.6194, loss=0.1310, param_norm=1886.6265
Step 867: grad_norm=1.9300, loss=0.0813, param_norm=1886.6265
Step 868: grad_norm=3.0314, loss=0.1131, param_norm=1886.6265
Step 869: grad_norm=2.5239, loss=0.1368, param_norm=1886.6265
Step 870: grad_norm=3.9991, loss=0.1114, param_norm=1886.6265
Step 871: grad_norm=2.8684, loss=0.1123, param_norm=1886.6265
Step 872: grad_norm=3.1938, loss=0.0936, param_norm=1886.6266
Step 873: grad_norm=1.8846, loss=0.0759, param_norm=1886.6266
09:40:15.137 [I] Progress on: 873it/1.00kit rate:1.1s/it remaining:02:18 elapsed:16:38 postfix:-  (501617:tqdm_logging.py:145)
Step 874: grad_norm=2.2024, loss=0.0837, param_norm=1886.6266
Step 875: grad_norm=2.2436, loss=0.1069, param_norm=1886.6266
Step 876: grad_norm=2.3314, loss=0.1008, param_norm=1886.6267
Step 877: grad_norm=1.7090, loss=0.0816, param_norm=1886.6267
Step 878: grad_norm=2.0843, loss=0.0825, param_norm=1886.6267
Step 879: grad_norm=3.4602, loss=0.0921, param_norm=1886.6267
Step 880: grad_norm=2.9639, loss=0.1177, param_norm=1886.6267
Step 881: grad_norm=2.0595, loss=0.0777, param_norm=1886.6267
Step 882: grad_norm=2.2206, loss=0.1096, param_norm=1886.6267
Step 883: grad_norm=3.3355, loss=0.0960, param_norm=1886.6268
09:40:26.026 [I] Progress on: 883it/1.00kit rate:1.1s/it remaining:02:07 elapsed:16:49 postfix:-  (501617:tqdm_logging.py:145)
Step 884: grad_norm=3.2180, loss=0.0987, param_norm=1886.6268
Step 885: grad_norm=3.2241, loss=0.0939, param_norm=1886.6268
Step 886: grad_norm=3.9279, loss=0.1488, param_norm=1886.6268
Step 887: grad_norm=2.2767, loss=0.0822, param_norm=1886.6268
Step 888: grad_norm=2.4886, loss=0.1262, param_norm=1886.6268
Step 889: grad_norm=3.4128, loss=0.1139, param_norm=1886.6268
Step 890: grad_norm=2.6297, loss=0.1037, param_norm=1886.6268
Step 891: grad_norm=2.1981, loss=0.1017, param_norm=1886.6268
Step 892: grad_norm=2.0669, loss=0.0876, param_norm=1886.6268
Step 893: grad_norm=3.7070, loss=0.1042, param_norm=1886.6268
09:40:36.911 [I] Progress on: 893it/1.00kit rate:1.1s/it remaining:01:56 elapsed:17:00 postfix:-  (501617:tqdm_logging.py:145)
Step 894: grad_norm=2.8044, loss=0.1456, param_norm=1886.6270
Step 895: grad_norm=3.2675, loss=0.0756, param_norm=1886.6270
Step 896: grad_norm=2.6843, loss=0.0921, param_norm=1886.6270
Step 897: grad_norm=1.9426, loss=0.0806, param_norm=1886.6270
Step 898: grad_norm=3.9824, loss=0.1044, param_norm=1886.6270
Step 899: grad_norm=3.4731, loss=0.1083, param_norm=1886.6270
Step 900: grad_norm=4.3550, loss=0.1195, param_norm=1886.6270
09:40:44.585 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:40:44.585 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:40:44.585 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (501617:checkpoint_manager.py:1786)
09:40:44.586 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (501617:checkpoint_manager.py:1817)
09:40:44.586 [I] [process=0] Saving checkpoint at step 900                                        (501617:checkpoint_manager.py:1286)
09:40:44.586 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900. (501617:async_checkpointer.py:358)
09:40:44.587 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:40:44.588 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24 (501617:atomicity.py:144)
09:40:44.588 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:40:44.589 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:40:44.590 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (501617:atomicity.py:144)
09:40:44.590 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (501617:atomicity.py:144)
09:40:44.591 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:40:44.595 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:40:48.654 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:40:48.655 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:40:48.656 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:40:48.657 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:40:48.673 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.679 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.683 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.687 [I] Preserving Checkpoint[step=400 | time=2025-04-08 13:31:17.286739+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.689 [I] Preserving Checkpoint[step=500 | time=2025-04-08 13:33:11.405170+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.691 [I] Preserving Checkpoint[step=600 | time=2025-04-08 13:35:06.109622+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.693 [I] Preserving Checkpoint[step=700 | time=2025-04-08 13:37:00.637324+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.694 [I] Preserving Checkpoint[step=800 | time=2025-04-08 13:38:55.213535+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:40:48.694 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:40:48.694 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:40:48.695 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:40:48.695 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119644.5855362, 'wait_for_prev_duration_secs': 0.0005469322204589844, 'checkpointer_blocking_start_time': 1744119644.586504, 'checkpointer_blocking_duration_secs': 4.086472749710083, 'get_old_steps_start_time': 1744119648.673024, 'get_old_steps_duration_secs': 0.0214536190032959, 'checkpoint_manager_blocking_start_time': 1744119644.5854642, 'checkpoint_manager_blocking_duration_secs': 4.1101648807525635} (501617:standard_logger.py:34)
09:40:48.696 [I] Progress on: 901it/1.00kit rate:2.3s/it remaining:03:50 elapsed:17:12 postfix:-  (501617:tqdm_logging.py:145)
Step 901: grad_norm=1.7474, loss=0.0869, param_norm=1886.6270
Step 902: grad_norm=2.1910, loss=0.1125, param_norm=1886.6270
Step 903: grad_norm=2.5748, loss=0.1048, param_norm=1886.6270
Step 904: grad_norm=2.9398, loss=0.0878, param_norm=1886.6270
Step 905: grad_norm=2.4297, loss=0.1245, param_norm=1886.6270
Step 906: grad_norm=5.2615, loss=0.1154, param_norm=1886.6270
Step 907: grad_norm=3.0392, loss=0.0754, param_norm=1886.6272
Step 908: grad_norm=2.2189, loss=0.1052, param_norm=1886.6272
09:40:58.477 [I] ChainedFuture completed 1/1 futures in 9.81 seconds.                             (501617:future.py:137)
09:40:58.478 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 746.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:40:58.479 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:40:58.481 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24 (501617:async_checkpointer.py:406)
09:40:58.482 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24/assets (501617:atomicity.py:287)
Step 909: grad_norm=2.4715, loss=0.0803, param_norm=1886.6272
09:40:58.498 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24/params (501617:atomicity.py:287)
09:40:58.499 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900 (501617:async_checkpointer.py:416)
09:40:58.500 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24 (501617:async_checkpointer.py:426)
09:40:58.500 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900 (501617:atomicity.py:287)
09:40:58.502 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/900`. (501617:atomicity.py:548)
09:40:58.503 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:40:58.503 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:40:58.504 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:40:58.504 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:40:58.505 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
Step 910: grad_norm=2.2011, loss=0.0983, param_norm=1886.6272
09:40:59.587 [I] Progress on: 910it/1.00kit rate:1.1s/it remaining:01:43 elapsed:17:23 postfix:-  (501617:tqdm_logging.py:145)
Step 911: grad_norm=3.6966, loss=0.1136, param_norm=1886.6272
Step 912: grad_norm=2.7967, loss=0.1240, param_norm=1886.6272
Step 913: grad_norm=2.8747, loss=0.1147, param_norm=1886.6272
Step 914: grad_norm=1.9570, loss=0.1085, param_norm=1886.6272
Step 915: grad_norm=2.7526, loss=0.0914, param_norm=1886.6272
Step 916: grad_norm=4.1856, loss=0.1009, param_norm=1886.6272
Step 917: grad_norm=3.2083, loss=0.0863, param_norm=1886.6272
Step 918: grad_norm=3.0727, loss=0.1085, param_norm=1886.6272
Step 919: grad_norm=4.7712, loss=0.1277, param_norm=1886.6272
Step 920: grad_norm=2.4700, loss=0.1123, param_norm=1886.6272
09:41:10.470 [I] Progress on: 920it/1.00kit rate:1.1s/it remaining:01:27 elapsed:17:34 postfix:-  (501617:tqdm_logging.py:145)
Step 921: grad_norm=2.1778, loss=0.1029, param_norm=1886.6272
Step 922: grad_norm=2.5795, loss=0.1082, param_norm=1886.6272
Step 923: grad_norm=4.2748, loss=0.1225, param_norm=1886.6273
Step 924: grad_norm=1.6523, loss=0.0870, param_norm=1886.6273
Step 925: grad_norm=2.5234, loss=0.0980, param_norm=1886.6273
Step 926: grad_norm=1.7184, loss=0.0799, param_norm=1886.6273
Step 927: grad_norm=1.6873, loss=0.0793, param_norm=1886.6273
Step 928: grad_norm=4.6823, loss=0.0935, param_norm=1886.6273
Step 929: grad_norm=3.3832, loss=0.0985, param_norm=1886.6273
09:41:20.586 [I] Progress on: 929it/1.00kit rate:1.1s/it remaining:01:18 elapsed:17:44 postfix:-  (501617:tqdm_logging.py:145)
Step 930: grad_norm=1.7503, loss=0.0900, param_norm=1886.6273
Step 931: grad_norm=1.9764, loss=0.0772, param_norm=1886.6273
Step 932: grad_norm=2.0268, loss=0.0924, param_norm=1886.6273
Step 933: grad_norm=1.6204, loss=0.0830, param_norm=1886.6274
Step 934: grad_norm=3.3865, loss=0.0680, param_norm=1886.6274
Step 935: grad_norm=1.6625, loss=0.0605, param_norm=1886.6274
Step 936: grad_norm=2.6120, loss=0.0892, param_norm=1886.6273
Step 937: grad_norm=1.7535, loss=0.0675, param_norm=1886.6274
Step 938: grad_norm=1.2970, loss=0.0617, param_norm=1886.6274
Step 939: grad_norm=2.7483, loss=0.0643, param_norm=1886.6274
09:41:31.482 [I] Progress on: 939it/1.00kit rate:1.1s/it remaining:01:06 elapsed:17:55 postfix:-  (501617:tqdm_logging.py:145)
Step 940: grad_norm=2.0494, loss=0.0860, param_norm=1886.6274
Step 941: grad_norm=1.6042, loss=0.0778, param_norm=1886.6274
Step 942: grad_norm=2.0913, loss=0.0902, param_norm=1886.6274
Step 943: grad_norm=2.4731, loss=0.1083, param_norm=1886.6274
Step 944: grad_norm=1.7107, loss=0.0829, param_norm=1886.6274
Step 945: grad_norm=1.8524, loss=0.0798, param_norm=1886.6274
Step 946: grad_norm=1.4783, loss=0.0743, param_norm=1886.6274
Step 947: grad_norm=1.5060, loss=0.0608, param_norm=1886.6276
Step 948: grad_norm=2.4178, loss=0.0598, param_norm=1886.6274
Step 949: grad_norm=1.5543, loss=0.0523, param_norm=1886.6276
09:41:42.365 [I] Progress on: 949it/1.00kit rate:1.1s/it remaining:00:55 elapsed:18:06 postfix:-  (501617:tqdm_logging.py:145)
Step 950: grad_norm=1.8286, loss=0.0797, param_norm=1886.6276
Step 951: grad_norm=2.3752, loss=0.0706, param_norm=1886.6276
Step 952: grad_norm=2.0476, loss=0.0667, param_norm=1886.6276
Step 953: grad_norm=2.3701, loss=0.0927, param_norm=1886.6276
Step 954: grad_norm=4.5445, loss=0.1146, param_norm=1886.6276
Step 955: grad_norm=1.9994, loss=0.0734, param_norm=1886.6276
Step 956: grad_norm=4.2038, loss=0.0804, param_norm=1886.6276
Step 957: grad_norm=1.7769, loss=0.0695, param_norm=1886.6276
Step 958: grad_norm=3.0306, loss=0.0770, param_norm=1886.6277
09:41:52.522 [I] Progress on: 958it/1.00kit rate:1.2s/it remaining:00:50 elapsed:18:16 postfix:-  (501617:tqdm_logging.py:145)
Step 959: grad_norm=2.4634, loss=0.0780, param_norm=1886.6277
Step 960: grad_norm=2.6834, loss=0.0946, param_norm=1886.6277
Step 961: grad_norm=1.7511, loss=0.0720, param_norm=1886.6277
Step 962: grad_norm=2.1387, loss=0.0841, param_norm=1886.6277
Step 963: grad_norm=1.5105, loss=0.0689, param_norm=1886.6277
Step 964: grad_norm=2.5550, loss=0.0882, param_norm=1886.6277
Step 965: grad_norm=2.7655, loss=0.1113, param_norm=1886.6277
Step 966: grad_norm=2.7261, loss=0.0821, param_norm=1886.6277
Step 967: grad_norm=3.6603, loss=0.0896, param_norm=1886.6277
Step 968: grad_norm=1.8433, loss=0.0855, param_norm=1886.6277
09:42:03.416 [I] Progress on: 968it/1.00kit rate:1.1s/it remaining:00:34 elapsed:18:27 postfix:-  (501617:tqdm_logging.py:145)
Step 969: grad_norm=2.7615, loss=0.0944, param_norm=1886.6277
Step 970: grad_norm=2.7938, loss=0.0881, param_norm=1886.6277
Step 971: grad_norm=1.9235, loss=0.0841, param_norm=1886.6277
Step 972: grad_norm=2.6865, loss=0.0822, param_norm=1886.6278
Step 973: grad_norm=2.8711, loss=0.0817, param_norm=1886.6278
Step 974: grad_norm=1.9598, loss=0.0789, param_norm=1886.6278
Step 975: grad_norm=3.0409, loss=0.0786, param_norm=1886.6278
Step 976: grad_norm=2.1358, loss=0.0834, param_norm=1886.6278
Step 977: grad_norm=2.1857, loss=0.0856, param_norm=1886.6278
Step 978: grad_norm=2.1064, loss=0.0874, param_norm=1886.6278
09:42:14.313 [I] Progress on: 978it/1.00kit rate:1.1s/it remaining:00:23 elapsed:18:38 postfix:-  (501617:tqdm_logging.py:145)
Step 979: grad_norm=2.8164, loss=0.0769, param_norm=1886.6278
Step 980: grad_norm=2.3384, loss=0.0839, param_norm=1886.6278
Step 981: grad_norm=2.0494, loss=0.0913, param_norm=1886.6278
Step 982: grad_norm=1.6593, loss=0.0529, param_norm=1886.6279
Step 983: grad_norm=1.9840, loss=0.0964, param_norm=1886.6279
Step 984: grad_norm=3.4839, loss=0.0660, param_norm=1886.6279
Step 985: grad_norm=1.5319, loss=0.0819, param_norm=1886.6279
Step 986: grad_norm=1.7959, loss=0.0766, param_norm=1886.6279
Step 987: grad_norm=1.4376, loss=0.0682, param_norm=1886.6279
Step 988: grad_norm=2.1205, loss=0.0813, param_norm=1886.6279
09:42:25.218 [I] Progress on: 988it/1.00kit rate:1.1s/it remaining:00:13 elapsed:18:48 postfix:-  (501617:tqdm_logging.py:145)
Step 989: grad_norm=2.6275, loss=0.0858, param_norm=1886.6279
Step 990: grad_norm=2.0747, loss=0.1092, param_norm=1886.6279
Step 991: grad_norm=2.3135, loss=0.0974, param_norm=1886.6279
Step 992: grad_norm=2.4409, loss=0.0845, param_norm=1886.6279
Step 993: grad_norm=2.8223, loss=0.0993, param_norm=1886.6279
Step 994: grad_norm=1.9443, loss=0.0817, param_norm=1886.6279
Step 995: grad_norm=2.1489, loss=0.0814, param_norm=1886.6279
Step 996: grad_norm=2.7272, loss=0.0856, param_norm=1886.6281
Step 997: grad_norm=1.8729, loss=0.0750, param_norm=1886.6281
Step 998: grad_norm=2.5198, loss=0.0836, param_norm=1886.6281
09:42:36.126 [I] Progress on: 998it/1.00kit rate:1.1s/it remaining:00:02 elapsed:18:59 postfix:-  (501617:tqdm_logging.py:145)
Step 999: grad_norm=2.1701, loss=0.1051, param_norm=1886.6281
09:42:37.249 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:42:37.249 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:42:37.249 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (501617:checkpoint_manager.py:1786)
09:42:37.249 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (501617:checkpoint_manager.py:1817)
09:42:37.250 [I] [process=0] Saving checkpoint at step 999                                        (501617:checkpoint_manager.py:1286)
09:42:37.250 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999. (501617:async_checkpointer.py:358)
09:42:37.251 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:42:37.252 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27 (501617:atomicity.py:144)
09:42:37.252 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:42:37.253 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (501617:multihost.py:293)
09:42:37.254 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (501617:atomicity.py:144)
09:42:37.254 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (501617:atomicity.py:144)
09:42:37.255 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (501617:multihost.py:293)
09:42:37.259 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (501617:replica_slices.py:419)
09:42:41.238 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:42:41.240 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (501617:tensorstore_utils.py:371)
09:42:41.243 [I] [process=0][thread=async_save] Background save thread started.                   (501617:async_checkpointer.py:121)
09:42:41.244 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (501617:tensorstore_utils.py:371)
09:42:41.249 [I] Preserving Checkpoint[step=100 | time=2025-04-08 13:25:35.510143+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.251 [I] Preserving Checkpoint[step=200 | time=2025-04-08 13:27:29.056181+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.255 [I] Preserving Checkpoint[step=300 | time=2025-04-08 13:29:23.152978+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.266 [I] Preserving Checkpoint[step=400 | time=2025-04-08 13:31:17.286739+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.270 [I] Preserving Checkpoint[step=500 | time=2025-04-08 13:33:11.405170+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.271 [I] Preserving Checkpoint[step=600 | time=2025-04-08 13:35:06.109622+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.271 [I] Preserving Checkpoint[step=700 | time=2025-04-08 13:37:00.637324+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.278 [I] Preserving Checkpoint[step=800 | time=2025-04-08 13:38:55.213535+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.279 [I] Preserving Checkpoint[step=900 | time=2025-04-08 13:40:48.672989+00:00 | is_locked=None]: (Reason: on keep_period=100). (501617:checkpoint_manager.py:1734)
09:42:41.282 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (501617:multihost.py:293)
09:42:41.283 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (501617:checkpoint_manager.py:1328)
09:42:41.283 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (501617:async_checkpointer.py:231)
09:42:41.284 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744119757.2490232, 'wait_for_prev_duration_secs': 0.0007321834564208984, 'checkpointer_blocking_start_time': 1744119757.250259, 'checkpointer_blocking_duration_secs': 3.999427080154419, 'get_old_steps_start_time': 1744119761.2498217, 'get_old_steps_duration_secs': 0.03248286247253418, 'checkpoint_manager_blocking_start_time': 1744119757.248922, 'checkpoint_manager_blocking_duration_secs': 4.035008668899536} (501617:standard_logger.py:34)
09:42:41.285 [I] Progress on: 1.00kit/1.00kit rate:2.3s/it remaining:00:00 elapsed:19:05 postfix:- (501617:tqdm_logging.py:145)
09:42:41.288 [I] Waiting for checkpoint manager to finish                                         (501617:train.py:268)
09:42:41.289 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (501617:checkpoint_manager.py:1759)
09:42:41.297 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (501617:checkpoint_manager.py:1777)
09:42:49.438 [I] ChainedFuture completed 1/1 futures in 8.19 seconds.                             (501617:future.py:137)
09:42:49.438 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 850.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (501617:base_pytree_checkpoint_handler.py:113)
09:42:49.438 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (501617:async_checkpointer.py:131)
09:42:49.439 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fdb1b0f3f10> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27 (501617:async_checkpointer.py:406)
09:42:49.440 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27/assets (501617:atomicity.py:287)
09:42:49.447 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27/params (501617:atomicity.py:287)
09:42:49.448 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999 (501617:async_checkpointer.py:416)
09:42:49.448 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27 (501617:async_checkpointer.py:426)
09:42:49.448 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999 (501617:atomicity.py:287)
09:42:49.449 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_bagel/1st_try_pi0_bagel/999`. (501617:atomicity.py:548)
09:42:49.449 [I] [process=0][thread=async_save] Background save thread done.                      (501617:async_checkpointer.py:183)
09:42:49.450 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (501617:async_checkpointer.py:239)
09:42:49.450 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (501617:async_checkpointer.py:249)
09:42:49.450 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (501617:checkpoint_manager.py:1890)
09:42:49.451 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (501617:checkpoint_manager.py:1905)
09:42:49.451 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (501617:checkpoint_manager.py:1786)
09:42:49.451 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (501617:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_pi0_bagel[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/1uxk69iy[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250408_092253-1uxk69iy/logs[0m
