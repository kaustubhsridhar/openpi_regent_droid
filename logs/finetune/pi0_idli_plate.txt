nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
22:19:00.831 [I] Running on: ivy                                                                  (3498206:train.py:195)
INFO:2025-03-23 22:19:01,714:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
22:19:01.714 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (3498206:xla_bridge.py:945)
INFO:2025-03-23 22:19:01,715:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
22:19:01.715 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (3498206:xla_bridge.py:945)
22:19:02.647 [I] Wiped checkpoint directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate (3498206:checkpoints.py:25)
22:19:02.647 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3498206:base_pytree_checkpoint_handler.py:332)
22:19:02.647 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3498206:base_pytree_checkpoint_handler.py:332)
22:19:02.647 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (3498206:multihost.py:375)
22:19:02.648 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7fa337b73250>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336d69850>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336cca610>}, handler_registry=None (3498206:checkpoint_manager.py:622)
22:19:02.648 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7fa337b73250>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (3498206:composite_checkpoint_handler.py:239)
22:19:02.648 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336d69850>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3498206:composite_checkpoint_handler.py:239)
22:19:02.648 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336cca610>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3498206:composite_checkpoint_handler.py:239)
22:19:02.649 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fa336d6bc90>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (3498206:composite_checkpoint_handler.py:239)
22:19:02.649 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fa337b73250>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fa337b73250>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336d69850>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336d69850>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336cca610>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa336cca610>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fa336d6bc90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fa336d6bc90>}). (3498206:composite_checkpoint_handler.py:508)
22:19:02.649 [I] orbax-checkpoint version: 0.11.1                                                 (3498206:abstract_checkpointer.py:35)
22:19:02.649 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7fa33695bf60> timeout: 7200 secs and primary_host=0 for async checkpoint writes (3498206:async_checkpointer.py:80)
22:19:02.650 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate (3498206:checkpoint_manager.py:1528)
22:19:02.650 [I] Saving root metadata                                                             (3498206:checkpoint_manager.py:1569)
22:19:02.650 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (3498206:multihost.py:293)
22:19:02.650 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7fa336dd8950> (3498206:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250323_221902-ah0sd6la
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_pi0_idli_plate
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/ah0sd6la
22:19:03.654 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid___finetune_on_idli_plate/droid (3498206:config.py:167)
Some kwargs in processor config are unused and will not have any effect: min_token, action_dim, scale, vocab_size, time_horizon. 
Some kwargs in processor config are unused and will not have any effect: min_token, action_dim, scale, vocab_size, time_horizon. 
num states in collected demos given by count_collected_demos: 1197
len_dataset: 1197
common_prompt: move the idli plate to the right
22:19:27.020 [I] Initialized data loader:
[0].images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].images['wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (16,)@bool
[0].image_masks['base_1_rgb']: (16,)@bool
[0].image_masks['wrist_0_rgb']: (16,)@bool
[0].state: (16, 8)@float32
[0].tokenized_prompt: (16, 250)@int32
[0].tokenized_prompt_mask: (16, 250)@bool
[0].token_ar_mask: (16, 250)@int32
[0].token_loss_mask: (16, 250)@bool
[1]: (16, 10, 8)@float32 (3498206:train.py:227)
22:19:28.095 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3498206:base_pytree_checkpoint_handler.py:332)
22:19:28.122 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (3498206:checkpointer.py:256)
22:19:44.843 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 667.0 MiB/s (total bytes: 10.9 GiB) (time elapsed: 16 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:19:44.843 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (3498206:checkpointer.py:259)
22:19:44.843 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (3498206:multihost.py:293)
2025-03-23 22:21:15.320050: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 19.42GiB (20847081029 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
22:21:19.881 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (3498206:train.py:231)
22:21:19.984 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (3498206:tqdm_logging.py:145)
Step 0: grad_norm=13.0218, loss=3.5226, param_norm=1886.4708
Step 1: grad_norm=12.8575, loss=3.3041, param_norm=1886.4708
Step 2: grad_norm=11.5786, loss=3.2198, param_norm=1886.4708
Step 3: grad_norm=14.5500, loss=3.4952, param_norm=1886.4708
22:21:30.362 [I] Progress on: 3.00it/1.00kit rate:2.4s/it remaining:40:36 elapsed:00:10 postfix:- (3498206:tqdm_logging.py:145)
Step 4: grad_norm=10.7037, loss=3.5339, param_norm=1886.4708
Step 5: grad_norm=11.1054, loss=2.7236, param_norm=1886.4708
Step 6: grad_norm=13.9232, loss=2.9582, param_norm=1886.4708
Step 7: grad_norm=11.1409, loss=2.7746, param_norm=1886.4707
Step 8: grad_norm=10.8835, loss=3.3043, param_norm=1886.4707
Step 9: grad_norm=14.6550, loss=3.0685, param_norm=1886.4706
Step 10: grad_norm=8.8872, loss=3.0659, param_norm=1886.4706
Step 11: grad_norm=9.4590, loss=2.6624, param_norm=1886.4706
Step 12: grad_norm=10.3791, loss=2.5435, param_norm=1886.4706
Step 13: grad_norm=9.5035, loss=2.6095, param_norm=1886.4706
22:21:41.005 [I] Progress on: 13.0it/1.00kit rate:1.1s/it remaining:17:56 elapsed:00:21 postfix:- (3498206:tqdm_logging.py:145)
Step 14: grad_norm=8.3973, loss=2.7958, param_norm=1886.4705
Step 15: grad_norm=10.7036, loss=2.6524, param_norm=1886.4705
Step 16: grad_norm=7.8033, loss=2.6369, param_norm=1886.4705
Step 17: grad_norm=12.1198, loss=2.3676, param_norm=1886.4705
Step 18: grad_norm=6.7421, loss=2.3198, param_norm=1886.4705
Step 19: grad_norm=6.5620, loss=2.5221, param_norm=1886.4705
Step 20: grad_norm=6.2656, loss=2.3844, param_norm=1886.4705
Step 21: grad_norm=16.5445, loss=2.4753, param_norm=1886.4705
Step 22: grad_norm=14.0794, loss=2.4860, param_norm=1886.4706
Step 23: grad_norm=7.9173, loss=2.5525, param_norm=1886.4706
22:21:51.711 [I] Progress on: 23.0it/1.00kit rate:1.1s/it remaining:17:23 elapsed:00:31 postfix:- (3498206:tqdm_logging.py:145)
Step 24: grad_norm=6.9259, loss=2.3161, param_norm=1886.4706
Step 25: grad_norm=13.2922, loss=2.3238, param_norm=1886.4707
Step 26: grad_norm=8.5867, loss=2.4236, param_norm=1886.4707
Step 27: grad_norm=11.8626, loss=2.3830, param_norm=1886.4708
Step 28: grad_norm=5.0457, loss=2.1313, param_norm=1886.4708
Step 29: grad_norm=7.0682, loss=2.0021, param_norm=1886.4709
Step 30: grad_norm=4.9743, loss=2.2738, param_norm=1886.4711
Step 31: grad_norm=15.0456, loss=2.1921, param_norm=1886.4711
Step 32: grad_norm=6.8598, loss=2.2448, param_norm=1886.4712
Step 33: grad_norm=16.4899, loss=2.3437, param_norm=1886.4712
22:22:02.399 [I] Progress on: 33.0it/1.00kit rate:1.1s/it remaining:17:13 elapsed:00:42 postfix:- (3498206:tqdm_logging.py:145)
Step 34: grad_norm=11.7215, loss=2.2271, param_norm=1886.4713
Step 35: grad_norm=8.8685, loss=2.3190, param_norm=1886.4714
Step 36: grad_norm=7.1873, loss=2.1041, param_norm=1886.4716
Step 37: grad_norm=7.5091, loss=2.4049, param_norm=1886.4717
Step 38: grad_norm=5.0514, loss=2.0442, param_norm=1886.4718
Step 39: grad_norm=14.5154, loss=2.3527, param_norm=1886.4720
Step 40: grad_norm=5.3513, loss=2.2336, param_norm=1886.4722
Step 41: grad_norm=7.0174, loss=2.2744, param_norm=1886.4724
Step 42: grad_norm=18.6966, loss=2.0942, param_norm=1886.4727
Step 43: grad_norm=18.8452, loss=2.1184, param_norm=1886.4729
22:22:13.151 [I] Progress on: 43.0it/1.00kit rate:1.1s/it remaining:17:13 elapsed:00:53 postfix:- (3498206:tqdm_logging.py:145)
Step 44: grad_norm=11.1745, loss=1.7919, param_norm=1886.4731
Step 45: grad_norm=10.3403, loss=2.0285, param_norm=1886.4734
Step 46: grad_norm=6.5007, loss=2.1532, param_norm=1886.4735
Step 47: grad_norm=9.4549, loss=2.2501, param_norm=1886.4739
Step 48: grad_norm=9.7165, loss=2.0416, param_norm=1886.4741
Step 49: grad_norm=10.4994, loss=2.2930, param_norm=1886.4744
Step 50: grad_norm=5.1529, loss=1.8949, param_norm=1886.4746
Step 51: grad_norm=6.4433, loss=1.9812, param_norm=1886.4750
Step 52: grad_norm=8.1720, loss=2.0510, param_norm=1886.4752
Step 53: grad_norm=5.1936, loss=2.0012, param_norm=1886.4756
22:22:23.925 [I] Progress on: 53.0it/1.00kit rate:1.1s/it remaining:16:57 elapsed:01:03 postfix:- (3498206:tqdm_logging.py:145)
Step 54: grad_norm=5.1384, loss=1.8263, param_norm=1886.4760
Step 55: grad_norm=7.0274, loss=1.9903, param_norm=1886.4763
Step 56: grad_norm=18.4197, loss=1.9380, param_norm=1886.4768
Step 57: grad_norm=18.3169, loss=1.9473, param_norm=1886.4772
Step 58: grad_norm=5.7678, loss=2.1212, param_norm=1886.4775
Step 59: grad_norm=10.7264, loss=1.8930, param_norm=1886.4779
Step 60: grad_norm=5.4132, loss=2.2060, param_norm=1886.4781
Step 61: grad_norm=6.3274, loss=1.9661, param_norm=1886.4785
Step 62: grad_norm=12.8279, loss=2.0321, param_norm=1886.4788
Step 63: grad_norm=10.1653, loss=1.9130, param_norm=1886.4791
22:22:34.697 [I] Progress on: 63.0it/1.00kit rate:1.1s/it remaining:16:49 elapsed:01:14 postfix:- (3498206:tqdm_logging.py:145)
Step 64: grad_norm=19.9806, loss=2.1328, param_norm=1886.4794
Step 65: grad_norm=11.1296, loss=1.8591, param_norm=1886.4797
Step 66: grad_norm=14.5708, loss=1.8973, param_norm=1886.4800
Step 67: grad_norm=9.3160, loss=2.0595, param_norm=1886.4803
Step 68: grad_norm=9.0010, loss=2.0278, param_norm=1886.4807
Step 69: grad_norm=16.6594, loss=1.9432, param_norm=1886.4810
Step 70: grad_norm=6.7799, loss=1.9940, param_norm=1886.4812
Step 71: grad_norm=15.3461, loss=1.9119, param_norm=1886.4817
Step 72: grad_norm=10.3624, loss=1.7840, param_norm=1886.4819
Step 73: grad_norm=5.2735, loss=1.7697, param_norm=1886.4823
22:22:45.617 [I] Progress on: 73.0it/1.00kit rate:1.1s/it remaining:16:56 elapsed:01:25 postfix:- (3498206:tqdm_logging.py:145)
Step 74: grad_norm=8.7908, loss=1.6947, param_norm=1886.4825
Step 75: grad_norm=7.0505, loss=1.6716, param_norm=1886.4829
Step 76: grad_norm=6.1001, loss=1.8091, param_norm=1886.4833
Step 77: grad_norm=6.8234, loss=1.5129, param_norm=1886.4836
Step 78: grad_norm=6.4656, loss=1.6176, param_norm=1886.4841
Step 79: grad_norm=4.9732, loss=1.5852, param_norm=1886.4844
Step 80: grad_norm=8.6855, loss=1.7289, param_norm=1886.4850
Step 81: grad_norm=5.3719, loss=1.4331, param_norm=1886.4852
Step 82: grad_norm=7.9500, loss=1.6668, param_norm=1886.4857
22:22:55.755 [I] Progress on: 82.0it/1.00kit rate:1.1s/it remaining:16:42 elapsed:01:35 postfix:- (3498206:tqdm_logging.py:145)
Step 83: grad_norm=5.6421, loss=1.7821, param_norm=1886.4860
Step 84: grad_norm=9.2306, loss=1.5752, param_norm=1886.4866
Step 85: grad_norm=9.8191, loss=1.6262, param_norm=1886.4869
Step 86: grad_norm=12.4053, loss=1.5165, param_norm=1886.4873
Step 87: grad_norm=7.4906, loss=1.6461, param_norm=1886.4878
Step 88: grad_norm=5.3280, loss=1.5763, param_norm=1886.4882
Step 89: grad_norm=9.3884, loss=1.6296, param_norm=1886.4885
Step 90: grad_norm=22.5797, loss=1.4913, param_norm=1886.4889
Step 91: grad_norm=8.5101, loss=1.6879, param_norm=1886.4894
Step 92: grad_norm=6.6988, loss=1.8823, param_norm=1886.4896
22:23:06.699 [I] Progress on: 92.0it/1.00kit rate:1.1s/it remaining:16:32 elapsed:01:46 postfix:- (3498206:tqdm_logging.py:145)
Step 93: grad_norm=5.2475, loss=1.6953, param_norm=1886.4900
Step 94: grad_norm=13.6728, loss=1.6552, param_norm=1886.4904
Step 95: grad_norm=64.0327, loss=1.7403, param_norm=1886.4906
Step 96: grad_norm=4.8276, loss=1.4704, param_norm=1886.4910
Step 97: grad_norm=9.3762, loss=1.6887, param_norm=1886.4913
Step 98: grad_norm=5.0682, loss=1.6537, param_norm=1886.4917
Step 99: grad_norm=4.9867, loss=1.4719, param_norm=1886.4919
Step 100: grad_norm=11.7301, loss=1.4769, param_norm=1886.4924
22:23:15.472 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:23:15.473 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (3498206:checkpoint_manager.py:1767)
22:23:15.474 [I] [process=0] Saving checkpoint at step 100                                        (3498206:checkpoint_manager.py:1286)
22:23:15.476 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100. (3498206:async_checkpointer.py:358)
22:23:15.477 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:23:15.478 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0 (3498206:atomicity.py:144)
22:23:15.479 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:23:15.480 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:23:15.481 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742782995479159857, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742782995479159857, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3498206:checkpoint.py:185)
22:23:15.481 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (3498206:atomicity.py:144)
22:23:15.482 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (3498206:atomicity.py:144)
22:23:15.482 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:23:15.492 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:23:19.593 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:23:19.595 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:23:19.601 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:23:19.604 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:23:19.608 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:23:19.647 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:23:19.652 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:23:19.653 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742782995.4728518, 'wait_for_prev_duration_secs': 0.0006761550903320312, 'checkpointer_blocking_start_time': 1742782995.4747055, 'checkpointer_blocking_duration_secs': 4.13329291343689, 'get_old_steps_start_time': 1742782999.6081529, 'get_old_steps_duration_secs': 1.6689300537109375e-05, 'checkpoint_manager_blocking_start_time': 1742782995.472445, 'checkpoint_manager_blocking_duration_secs': 4.180936574935913} (3498206:standard_logger.py:34)
22:23:19.662 [I] Progress on: 101it/1.00kit rate:2.3s/it remaining:35:09 elapsed:01:59 postfix:-  (3498206:tqdm_logging.py:145)
Step 101: grad_norm=11.8842, loss=1.6905, param_norm=1886.4928
Step 102: grad_norm=16.6031, loss=1.6614, param_norm=1886.4932
Step 103: grad_norm=5.5781, loss=1.5588, param_norm=1886.4935
Step 104: grad_norm=14.3666, loss=1.6027, param_norm=1886.4940
Step 105: grad_norm=10.3842, loss=1.5503, param_norm=1886.4944
Step 106: grad_norm=9.6929, loss=1.6497, param_norm=1886.4949
Step 107: grad_norm=19.8062, loss=1.7268, param_norm=1886.4952
Step 108: grad_norm=5.8650, loss=1.7741, param_norm=1886.4956
22:23:28.811 [I] ChainedFuture completed 1/1 futures in 9.21 seconds.                             (3498206:future.py:137)
22:23:28.812 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 777.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:23:28.812 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:23:28.813 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742782995479159857, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3498206:checkpoint.py:225)
22:23:28.815 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0 (3498206:async_checkpointer.py:406)
22:23:28.816 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/assets (3498206:atomicity.py:287)
22:23:28.822 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742782995479159857, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3498206:checkpoint.py:244)
Step 109: grad_norm=8.6298, loss=1.6069, param_norm=1886.4960
22:23:29.978 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0/params (3498206:atomicity.py:287)
22:23:29.979 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100 (3498206:async_checkpointer.py:416)
22:23:29.979 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0 (3498206:async_checkpointer.py:426)
22:23:29.980 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100 (3498206:atomicity.py:287)
22:23:29.984 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/100`. (3498206:atomicity.py:548)
22:23:30.686 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:23:30.687 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:23:30.688 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:23:30.690 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:23:30.690 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 110: grad_norm=5.7689, loss=1.4902, param_norm=1886.4963
22:23:30.696 [I] Progress on: 110it/1.00kit rate:1.1s/it remaining:17:01 elapsed:02:10 postfix:-  (3498206:tqdm_logging.py:145)
Step 111: grad_norm=4.6200, loss=1.5719, param_norm=1886.4967
Step 112: grad_norm=6.6311, loss=1.4791, param_norm=1886.4972
Step 113: grad_norm=14.0518, loss=1.6751, param_norm=1886.4976
Step 114: grad_norm=7.0512, loss=1.6897, param_norm=1886.4979
Step 115: grad_norm=5.6639, loss=1.6289, param_norm=1886.4983
Step 116: grad_norm=8.3459, loss=1.4583, param_norm=1886.4988
Step 117: grad_norm=9.3973, loss=1.6308, param_norm=1886.4990
Step 118: grad_norm=6.3706, loss=1.3908, param_norm=1886.4995
Step 119: grad_norm=5.2387, loss=1.5464, param_norm=1886.4998
Step 120: grad_norm=7.1117, loss=1.5172, param_norm=1886.5002
22:23:41.649 [I] Progress on: 120it/1.00kit rate:1.1s/it remaining:16:05 elapsed:02:21 postfix:-  (3498206:tqdm_logging.py:145)
Step 121: grad_norm=7.5342, loss=1.4096, param_norm=1886.5005
Step 122: grad_norm=7.4868, loss=1.5797, param_norm=1886.5009
Step 123: grad_norm=6.2944, loss=1.5884, param_norm=1886.5012
Step 124: grad_norm=6.5114, loss=1.7161, param_norm=1886.5015
Step 125: grad_norm=6.1881, loss=1.5721, param_norm=1886.5020
Step 126: grad_norm=6.0829, loss=1.5923, param_norm=1886.5022
Step 127: grad_norm=16.1126, loss=1.4062, param_norm=1886.5026
Step 128: grad_norm=5.2604, loss=1.3980, param_norm=1886.5029
Step 129: grad_norm=14.5612, loss=1.7032, param_norm=1886.5033
Step 130: grad_norm=6.8087, loss=1.6158, param_norm=1886.5035
22:23:52.613 [I] Progress on: 130it/1.00kit rate:1.1s/it remaining:15:56 elapsed:02:32 postfix:-  (3498206:tqdm_logging.py:145)
Step 131: grad_norm=11.6197, loss=1.4273, param_norm=1886.5038
Step 132: grad_norm=5.3828, loss=1.6003, param_norm=1886.5042
Step 133: grad_norm=8.4784, loss=1.5459, param_norm=1886.5044
Step 134: grad_norm=4.6341, loss=1.4644, param_norm=1886.5049
Step 135: grad_norm=12.4334, loss=1.6532, param_norm=1886.5052
Step 136: grad_norm=14.1495, loss=1.7401, param_norm=1886.5056
Step 137: grad_norm=6.1975, loss=1.5919, param_norm=1886.5059
Step 138: grad_norm=6.1203, loss=1.6444, param_norm=1886.5062
Step 139: grad_norm=5.1310, loss=1.4781, param_norm=1886.5066
Step 140: grad_norm=6.0653, loss=1.3868, param_norm=1886.5068
22:24:03.469 [I] Progress on: 140it/1.00kit rate:1.1s/it remaining:15:35 elapsed:02:43 postfix:-  (3498206:tqdm_logging.py:145)
Step 141: grad_norm=6.7465, loss=1.6736, param_norm=1886.5072
Step 142: grad_norm=7.5250, loss=1.5172, param_norm=1886.5076
Step 143: grad_norm=8.9708, loss=1.5392, param_norm=1886.5079
Step 144: grad_norm=12.3808, loss=1.4955, param_norm=1886.5083
Step 145: grad_norm=5.0500, loss=1.4389, param_norm=1886.5085
Step 146: grad_norm=5.2369, loss=1.5968, param_norm=1886.5090
Step 147: grad_norm=5.1679, loss=1.4295, param_norm=1886.5093
Step 148: grad_norm=9.9692, loss=1.3110, param_norm=1886.5096
Step 149: grad_norm=16.2709, loss=1.2191, param_norm=1886.5100
22:24:13.613 [I] Progress on: 149it/1.00kit rate:1.2s/it remaining:16:32 elapsed:02:53 postfix:-  (3498206:tqdm_logging.py:145)
Step 150: grad_norm=15.9310, loss=1.5211, param_norm=1886.5104
Step 151: grad_norm=18.6259, loss=1.3411, param_norm=1886.5107
Step 152: grad_norm=8.9715, loss=1.2888, param_norm=1886.5111
Step 153: grad_norm=10.2736, loss=1.2072, param_norm=1886.5115
Step 154: grad_norm=5.0833, loss=1.1698, param_norm=1886.5118
Step 155: grad_norm=5.5675, loss=1.2992, param_norm=1886.5121
Step 156: grad_norm=13.1641, loss=1.2230, param_norm=1886.5126
Step 157: grad_norm=4.9212, loss=1.3089, param_norm=1886.5129
Step 158: grad_norm=4.4385, loss=1.1576, param_norm=1886.5132
Step 159: grad_norm=11.9620, loss=1.3539, param_norm=1886.5137
22:24:24.472 [I] Progress on: 159it/1.00kit rate:1.1s/it remaining:15:14 elapsed:03:04 postfix:-  (3498206:tqdm_logging.py:145)
Step 160: grad_norm=6.6366, loss=1.2013, param_norm=1886.5142
Step 161: grad_norm=6.6089, loss=1.2032, param_norm=1886.5144
Step 162: grad_norm=7.6301, loss=1.2325, param_norm=1886.5149
Step 163: grad_norm=7.5857, loss=1.2813, param_norm=1886.5153
Step 164: grad_norm=13.6311, loss=1.1393, param_norm=1886.5155
Step 165: grad_norm=9.3215, loss=1.3068, param_norm=1886.5160
Step 166: grad_norm=5.3373, loss=1.2479, param_norm=1886.5162
Step 167: grad_norm=10.4935, loss=1.3828, param_norm=1886.5167
Step 168: grad_norm=5.9154, loss=1.1529, param_norm=1886.5172
Step 169: grad_norm=10.8713, loss=1.1659, param_norm=1886.5176
22:24:35.322 [I] Progress on: 169it/1.00kit rate:1.1s/it remaining:14:59 elapsed:03:15 postfix:-  (3498206:tqdm_logging.py:145)
Step 170: grad_norm=6.5104, loss=1.2622, param_norm=1886.5179
Step 171: grad_norm=20.8016, loss=1.3038, param_norm=1886.5183
Step 172: grad_norm=12.0898, loss=1.2304, param_norm=1886.5188
Step 173: grad_norm=5.5541, loss=1.2144, param_norm=1886.5192
Step 174: grad_norm=5.0435, loss=1.1299, param_norm=1886.5195
Step 175: grad_norm=8.1087, loss=1.0561, param_norm=1886.5199
Step 176: grad_norm=5.5068, loss=1.1774, param_norm=1886.5204
Step 177: grad_norm=23.6650, loss=1.3754, param_norm=1886.5208
Step 178: grad_norm=13.2160, loss=1.2014, param_norm=1886.5211
Step 179: grad_norm=9.2791, loss=1.2474, param_norm=1886.5216
22:24:46.147 [I] Progress on: 179it/1.00kit rate:1.1s/it remaining:14:47 elapsed:03:26 postfix:-  (3498206:tqdm_logging.py:145)
Step 180: grad_norm=10.9100, loss=1.3105, param_norm=1886.5220
Step 181: grad_norm=10.3910, loss=1.1482, param_norm=1886.5223
Step 182: grad_norm=5.3012, loss=1.1420, param_norm=1886.5227
Step 183: grad_norm=11.9769, loss=1.3272, param_norm=1886.5232
Step 184: grad_norm=9.1112, loss=1.2713, param_norm=1886.5234
Step 185: grad_norm=11.1756, loss=1.2118, param_norm=1886.5238
Step 186: grad_norm=6.1587, loss=1.3052, param_norm=1886.5242
Step 187: grad_norm=8.1578, loss=1.1650, param_norm=1886.5244
Step 188: grad_norm=6.7036, loss=1.2190, param_norm=1886.5248
Step 189: grad_norm=4.9281, loss=1.0079, param_norm=1886.5251
22:24:57.002 [I] Progress on: 189it/1.00kit rate:1.1s/it remaining:14:40 elapsed:03:37 postfix:-  (3498206:tqdm_logging.py:145)
Step 190: grad_norm=6.3420, loss=1.3363, param_norm=1886.5254
Step 191: grad_norm=7.6759, loss=1.2219, param_norm=1886.5258
Step 192: grad_norm=9.1175, loss=1.0459, param_norm=1886.5260
Step 193: grad_norm=5.8804, loss=1.0489, param_norm=1886.5264
Step 194: grad_norm=10.7391, loss=1.2040, param_norm=1886.5267
Step 195: grad_norm=9.9667, loss=1.2273, param_norm=1886.5270
Step 196: grad_norm=9.4756, loss=1.2563, param_norm=1886.5273
Step 197: grad_norm=8.0966, loss=1.1263, param_norm=1886.5277
Step 198: grad_norm=6.0996, loss=1.3174, param_norm=1886.5282
Step 199: grad_norm=6.7438, loss=1.0312, param_norm=1886.5286
22:25:07.832 [I] Progress on: 199it/1.00kit rate:1.1s/it remaining:14:26 elapsed:03:47 postfix:-  (3498206:tqdm_logging.py:145)
Step 200: grad_norm=6.1143, loss=1.1950, param_norm=1886.5289
22:25:08.947 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:25:08.947 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:25:08.948 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (3498206:checkpoint_manager.py:1786)
22:25:08.948 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (3498206:checkpoint_manager.py:1817)
22:25:08.949 [I] [process=0] Saving checkpoint at step 200                                        (3498206:checkpoint_manager.py:1286)
22:25:08.950 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200. (3498206:async_checkpointer.py:358)
22:25:08.951 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:25:08.952 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3 (3498206:atomicity.py:144)
22:25:08.953 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:25:08.953 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:25:08.954 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (3498206:atomicity.py:144)
22:25:08.955 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (3498206:atomicity.py:144)
22:25:08.955 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:25:08.961 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:25:12.839 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:25:12.840 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:25:12.842 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:25:12.844 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:25:12.907 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:25:12.910 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:25:12.910 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:25:12.918 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:25:12.919 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783108.9474728, 'wait_for_prev_duration_secs': 0.0010406970977783203, 'checkpointer_blocking_start_time': 1742783108.949456, 'checkpointer_blocking_duration_secs': 3.9576210975646973, 'get_old_steps_start_time': 1742783112.907157, 'get_old_steps_duration_secs': 0.002753019332885742, 'checkpoint_manager_blocking_start_time': 1742783108.9472291, 'checkpoint_manager_blocking_duration_secs': 3.971952438354492} (3498206:standard_logger.py:34)
Step 201: grad_norm=5.2402, loss=1.1785, param_norm=1886.5293
Step 202: grad_norm=9.3123, loss=1.2579, param_norm=1886.5298
Step 203: grad_norm=8.0950, loss=1.2124, param_norm=1886.5302
Step 204: grad_norm=7.2583, loss=1.0554, param_norm=1886.5305
Step 205: grad_norm=11.2212, loss=1.1289, param_norm=1886.5308
22:25:18.377 [I] Progress on: 205it/1.00kit rate:1.4s/it remaining:18:16 elapsed:03:58 postfix:-  (3498206:tqdm_logging.py:145)
Step 206: grad_norm=6.8950, loss=1.2159, param_norm=1886.5311
Step 207: grad_norm=7.0990, loss=1.1994, param_norm=1886.5315
Step 208: grad_norm=9.4663, loss=1.3071, param_norm=1886.5319
22:25:22.676 [I] ChainedFuture completed 1/1 futures in 9.82 seconds.                             (3498206:future.py:137)
22:25:22.677 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 755.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:25:22.678 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:25:22.680 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3 (3498206:async_checkpointer.py:406)
22:25:22.682 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3/assets (3498206:atomicity.py:287)
Step 209: grad_norm=5.1588, loss=1.2461, param_norm=1886.5322
22:25:23.428 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3/params (3498206:atomicity.py:287)
22:25:23.430 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200 (3498206:async_checkpointer.py:416)
22:25:23.430 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3 (3498206:async_checkpointer.py:426)
22:25:23.430 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200 (3498206:atomicity.py:287)
22:25:23.433 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/200`. (3498206:atomicity.py:548)
22:25:23.433 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:25:23.434 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:25:23.434 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:25:23.435 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:25:23.436 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 210: grad_norm=8.5670, loss=1.1547, param_norm=1886.5326
Step 211: grad_norm=14.3311, loss=1.3961, param_norm=1886.5330
Step 212: grad_norm=7.9996, loss=1.2499, param_norm=1886.5333
Step 213: grad_norm=5.1265, loss=1.1437, param_norm=1886.5337
Step 214: grad_norm=12.0986, loss=1.3028, param_norm=1886.5339
Step 215: grad_norm=11.3904, loss=1.1304, param_norm=1886.5344
22:25:29.345 [I] Progress on: 215it/1.00kit rate:1.1s/it remaining:14:24 elapsed:04:09 postfix:-  (3498206:tqdm_logging.py:145)
Step 216: grad_norm=19.3234, loss=1.1785, param_norm=1886.5345
Step 217: grad_norm=7.0356, loss=1.2567, param_norm=1886.5349
Step 218: grad_norm=18.6202, loss=1.2463, param_norm=1886.5352
Step 219: grad_norm=17.9097, loss=1.3389, param_norm=1886.5354
Step 220: grad_norm=9.1242, loss=1.2067, param_norm=1886.5358
Step 221: grad_norm=12.7472, loss=1.2266, param_norm=1886.5360
Step 222: grad_norm=10.5590, loss=1.1130, param_norm=1886.5364
Step 223: grad_norm=22.1369, loss=0.9963, param_norm=1886.5367
Step 224: grad_norm=12.4114, loss=0.9583, param_norm=1886.5370
22:25:39.458 [I] Progress on: 224it/1.00kit rate:1.1s/it remaining:14:43 elapsed:04:19 postfix:-  (3498206:tqdm_logging.py:145)
Step 225: grad_norm=11.6363, loss=1.1243, param_norm=1886.5374
Step 226: grad_norm=6.6333, loss=0.9371, param_norm=1886.5377
Step 227: grad_norm=9.3331, loss=0.7381, param_norm=1886.5381
Step 228: grad_norm=17.9678, loss=0.8531, param_norm=1886.5383
Step 229: grad_norm=5.4659, loss=0.8872, param_norm=1886.5386
Step 230: grad_norm=15.3820, loss=0.9327, param_norm=1886.5389
Step 231: grad_norm=8.0447, loss=0.8614, param_norm=1886.5393
Step 232: grad_norm=13.1876, loss=0.9455, param_norm=1886.5396
Step 233: grad_norm=17.8835, loss=0.8359, param_norm=1886.5398
22:25:49.629 [I] Progress on: 233it/1.00kit rate:1.2s/it remaining:14:55 elapsed:04:29 postfix:-  (3498206:tqdm_logging.py:145)
Step 234: grad_norm=21.6320, loss=0.9476, param_norm=1886.5402
Step 235: grad_norm=15.6163, loss=0.8967, param_norm=1886.5404
Step 236: grad_norm=16.3189, loss=0.9762, param_norm=1886.5408
Step 237: grad_norm=10.7749, loss=1.0640, param_norm=1886.5411
Step 238: grad_norm=10.9188, loss=0.8793, param_norm=1886.5414
Step 239: grad_norm=6.9313, loss=0.9599, param_norm=1886.5417
Step 240: grad_norm=14.9543, loss=0.9686, param_norm=1886.5421
Step 241: grad_norm=5.1033, loss=0.9285, param_norm=1886.5424
Step 242: grad_norm=5.7625, loss=0.8147, param_norm=1886.5428
Step 243: grad_norm=7.6685, loss=0.9180, param_norm=1886.5431
22:26:00.555 [I] Progress on: 243it/1.00kit rate:1.1s/it remaining:13:46 elapsed:04:40 postfix:-  (3498206:tqdm_logging.py:145)
Step 244: grad_norm=6.7238, loss=1.0795, param_norm=1886.5436
Step 245: grad_norm=9.5126, loss=1.0892, param_norm=1886.5438
Step 246: grad_norm=6.3056, loss=0.8468, param_norm=1886.5442
Step 247: grad_norm=5.7921, loss=0.8762, param_norm=1886.5446
Step 248: grad_norm=20.5694, loss=0.9714, param_norm=1886.5449
Step 249: grad_norm=5.8170, loss=0.8905, param_norm=1886.5454
Step 250: grad_norm=11.0295, loss=0.9918, param_norm=1886.5458
Step 251: grad_norm=5.9064, loss=0.8905, param_norm=1886.5461
Step 252: grad_norm=10.8726, loss=1.1106, param_norm=1886.5464
Step 253: grad_norm=11.0130, loss=0.9249, param_norm=1886.5469
22:26:11.434 [I] Progress on: 253it/1.00kit rate:1.1s/it remaining:13:29 elapsed:04:51 postfix:-  (3498206:tqdm_logging.py:145)
Step 254: grad_norm=5.9194, loss=0.8776, param_norm=1886.5471
Step 255: grad_norm=5.4486, loss=0.8098, param_norm=1886.5476
Step 256: grad_norm=15.9616, loss=1.0870, param_norm=1886.5479
Step 257: grad_norm=5.0775, loss=0.8915, param_norm=1886.5482
Step 258: grad_norm=5.9567, loss=0.8892, param_norm=1886.5485
Step 259: grad_norm=7.3506, loss=0.9488, param_norm=1886.5490
Step 260: grad_norm=18.4320, loss=1.0420, param_norm=1886.5492
Step 261: grad_norm=6.2008, loss=0.8975, param_norm=1886.5496
Step 262: grad_norm=11.7014, loss=0.8954, param_norm=1886.5499
Step 263: grad_norm=8.5720, loss=1.0490, param_norm=1886.5503
22:26:22.264 [I] Progress on: 263it/1.00kit rate:1.1s/it remaining:13:16 elapsed:05:02 postfix:-  (3498206:tqdm_logging.py:145)
Step 264: grad_norm=6.0116, loss=1.0145, param_norm=1886.5505
Step 265: grad_norm=9.4496, loss=0.8528, param_norm=1886.5508
Step 266: grad_norm=11.6088, loss=0.8907, param_norm=1886.5513
Step 267: grad_norm=19.8161, loss=0.8624, param_norm=1886.5515
Step 268: grad_norm=13.2587, loss=1.0518, param_norm=1886.5518
Step 269: grad_norm=8.4681, loss=0.9776, param_norm=1886.5522
Step 270: grad_norm=18.3646, loss=1.0107, param_norm=1886.5525
Step 271: grad_norm=9.2128, loss=0.9960, param_norm=1886.5529
Step 272: grad_norm=9.7748, loss=1.0087, param_norm=1886.5532
Step 273: grad_norm=11.1550, loss=0.8824, param_norm=1886.5536
22:26:33.101 [I] Progress on: 273it/1.00kit rate:1.1s/it remaining:13:07 elapsed:05:13 postfix:-  (3498206:tqdm_logging.py:145)
Step 274: grad_norm=10.5418, loss=0.9648, param_norm=1886.5540
Step 275: grad_norm=12.4783, loss=1.0547, param_norm=1886.5542
Step 276: grad_norm=17.4851, loss=1.0714, param_norm=1886.5546
Step 277: grad_norm=5.9252, loss=0.9128, param_norm=1886.5548
Step 278: grad_norm=6.4997, loss=1.0529, param_norm=1886.5551
Step 279: grad_norm=10.9137, loss=0.8590, param_norm=1886.5553
Step 280: grad_norm=18.9504, loss=1.0537, param_norm=1886.5557
Step 281: grad_norm=9.0682, loss=0.9550, param_norm=1886.5559
Step 282: grad_norm=9.0393, loss=1.0773, param_norm=1886.5562
Step 283: grad_norm=6.6807, loss=1.0642, param_norm=1886.5564
22:26:43.945 [I] Progress on: 283it/1.00kit rate:1.1s/it remaining:12:56 elapsed:05:23 postfix:-  (3498206:tqdm_logging.py:145)
Step 284: grad_norm=6.7906, loss=0.9723, param_norm=1886.5566
Step 285: grad_norm=4.8836, loss=0.9472, param_norm=1886.5569
Step 286: grad_norm=6.3330, loss=0.9766, param_norm=1886.5571
Step 287: grad_norm=5.9956, loss=1.0262, param_norm=1886.5573
Step 288: grad_norm=5.8106, loss=1.0351, param_norm=1886.5577
Step 289: grad_norm=7.1026, loss=0.8008, param_norm=1886.5580
Step 290: grad_norm=5.3222, loss=0.9483, param_norm=1886.5583
Step 291: grad_norm=5.9717, loss=0.8351, param_norm=1886.5586
Step 292: grad_norm=8.4774, loss=0.9150, param_norm=1886.5588
Step 293: grad_norm=6.8573, loss=0.9475, param_norm=1886.5592
22:26:54.793 [I] Progress on: 293it/1.00kit rate:1.1s/it remaining:12:45 elapsed:05:34 postfix:-  (3498206:tqdm_logging.py:145)
Step 294: grad_norm=6.5081, loss=0.9699, param_norm=1886.5596
Step 295: grad_norm=6.6610, loss=1.0210, param_norm=1886.5598
Step 296: grad_norm=5.1629, loss=0.6263, param_norm=1886.5602
Step 297: grad_norm=7.1719, loss=0.8563, param_norm=1886.5607
Step 298: grad_norm=7.1709, loss=0.7829, param_norm=1886.5609
Step 299: grad_norm=8.3204, loss=0.7693, param_norm=1886.5613
Step 300: grad_norm=11.5092, loss=0.6682, param_norm=1886.5615
22:27:02.730 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:27:02.731 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:27:02.731 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (3498206:checkpoint_manager.py:1786)
22:27:02.731 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (3498206:checkpoint_manager.py:1817)
22:27:02.732 [I] [process=0] Saving checkpoint at step 300                                        (3498206:checkpoint_manager.py:1286)
22:27:02.733 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300. (3498206:async_checkpointer.py:358)
22:27:02.734 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:27:02.735 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6 (3498206:atomicity.py:144)
22:27:02.737 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:27:02.737 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:27:02.738 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (3498206:atomicity.py:144)
22:27:02.740 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (3498206:atomicity.py:144)
22:27:02.760 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:27:02.772 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:27:06.547 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:27:06.548 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:27:06.550 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:27:06.552 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:27:06.577 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:27:06.579 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:27:06.581 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:27:06.583 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:27:06.595 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:27:06.596 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783222.7304165, 'wait_for_prev_duration_secs': 0.0014371871948242188, 'checkpointer_blocking_start_time': 1742783222.7326713, 'checkpointer_blocking_duration_secs': 3.844484329223633, 'get_old_steps_start_time': 1742783226.5772595, 'get_old_steps_duration_secs': 0.004242420196533203, 'checkpoint_manager_blocking_start_time': 1742783222.7301314, 'checkpoint_manager_blocking_duration_secs': 3.865938186645508} (3498206:standard_logger.py:34)
22:27:06.599 [I] Progress on: 301it/1.00kit rate:2.3s/it remaining:26:21 elapsed:05:46 postfix:-  (3498206:tqdm_logging.py:145)
Step 301: grad_norm=10.2327, loss=0.8603, param_norm=1886.5618
Step 302: grad_norm=5.4666, loss=0.7598, param_norm=1886.5621
Step 303: grad_norm=7.1298, loss=0.7650, param_norm=1886.5624
Step 304: grad_norm=9.5109, loss=0.7323, param_norm=1886.5627
Step 305: grad_norm=10.3755, loss=0.7970, param_norm=1886.5631
Step 306: grad_norm=5.2802, loss=0.7884, param_norm=1886.5634
Step 307: grad_norm=5.7781, loss=0.7407, param_norm=1886.5637
Step 308: grad_norm=8.8207, loss=0.8091, param_norm=1886.5640
Step 309: grad_norm=6.7982, loss=0.8144, param_norm=1886.5642
22:27:16.522 [I] ChainedFuture completed 1/1 futures in 9.95 seconds.                             (3498206:future.py:137)
22:27:16.523 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 752.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:27:16.524 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:27:16.529 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6 (3498206:async_checkpointer.py:406)
22:27:16.531 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6/assets (3498206:atomicity.py:287)
22:27:16.553 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6/params (3498206:atomicity.py:287)
22:27:16.558 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300 (3498206:async_checkpointer.py:416)
22:27:16.559 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6 (3498206:async_checkpointer.py:426)
22:27:16.559 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300 (3498206:atomicity.py:287)
22:27:16.566 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/300`. (3498206:atomicity.py:548)
22:27:16.567 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:27:16.568 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:27:16.570 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:27:16.571 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:27:16.572 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
22:27:16.613 [I] Progress on: 310it/1.00kit rate:1.2s/it remaining:13:31 elapsed:05:56 postfix:-  (3498206:tqdm_logging.py:145)
Step 310: grad_norm=5.0300, loss=0.8199, param_norm=1886.5646
Step 311: grad_norm=4.9929, loss=0.6595, param_norm=1886.5649
Step 312: grad_norm=7.4398, loss=0.8451, param_norm=1886.5653
Step 313: grad_norm=9.2131, loss=0.8419, param_norm=1886.5656
Step 314: grad_norm=6.2082, loss=0.7669, param_norm=1886.5658
Step 315: grad_norm=9.2160, loss=0.7444, param_norm=1886.5662
Step 316: grad_norm=7.1575, loss=0.7524, param_norm=1886.5664
Step 317: grad_norm=6.1460, loss=0.7459, param_norm=1886.5668
Step 318: grad_norm=6.1061, loss=0.7746, param_norm=1886.5670
Step 319: grad_norm=5.7610, loss=0.7261, param_norm=1886.5673
22:27:27.429 [I] Progress on: 319it/1.00kit rate:1.1s/it remaining:12:18 elapsed:06:07 postfix:-  (3498206:tqdm_logging.py:145)
Step 320: grad_norm=8.0943, loss=0.7458, param_norm=1886.5675
Step 321: grad_norm=8.9292, loss=0.7407, param_norm=1886.5679
Step 322: grad_norm=7.1219, loss=0.8094, param_norm=1886.5681
Step 323: grad_norm=6.4278, loss=0.7296, param_norm=1886.5684
Step 324: grad_norm=6.9340, loss=0.6753, param_norm=1886.5686
Step 325: grad_norm=6.8669, loss=0.7487, param_norm=1886.5690
Step 326: grad_norm=5.3986, loss=0.7911, param_norm=1886.5692
Step 327: grad_norm=14.3439, loss=0.7165, param_norm=1886.5695
Step 328: grad_norm=17.3803, loss=0.7716, param_norm=1886.5699
Step 329: grad_norm=12.7126, loss=0.8080, param_norm=1886.5702
22:27:38.311 [I] Progress on: 329it/1.00kit rate:1.1s/it remaining:12:06 elapsed:06:18 postfix:-  (3498206:tqdm_logging.py:145)
Step 330: grad_norm=5.6325, loss=0.7148, param_norm=1886.5706
Step 331: grad_norm=17.3465, loss=0.8935, param_norm=1886.5708
Step 332: grad_norm=8.8331, loss=0.7848, param_norm=1886.5712
Step 333: grad_norm=7.4916, loss=0.7166, param_norm=1886.5715
Step 334: grad_norm=14.1999, loss=0.8132, param_norm=1886.5718
Step 335: grad_norm=14.3068, loss=0.8049, param_norm=1886.5720
Step 336: grad_norm=4.6631, loss=0.7478, param_norm=1886.5724
Step 337: grad_norm=7.8979, loss=0.8729, param_norm=1886.5726
Step 338: grad_norm=14.8792, loss=0.8108, param_norm=1886.5730
Step 339: grad_norm=7.2109, loss=0.6915, param_norm=1886.5731
22:27:49.167 [I] Progress on: 339it/1.00kit rate:1.1s/it remaining:11:55 elapsed:06:29 postfix:-  (3498206:tqdm_logging.py:145)
Step 340: grad_norm=4.9256, loss=0.6885, param_norm=1886.5734
Step 341: grad_norm=6.3034, loss=0.8793, param_norm=1886.5737
Step 342: grad_norm=12.9799, loss=0.6999, param_norm=1886.5739
Step 343: grad_norm=5.9214, loss=0.7719, param_norm=1886.5741
Step 344: grad_norm=11.3251, loss=0.7493, param_norm=1886.5743
Step 345: grad_norm=6.6856, loss=0.8558, param_norm=1886.5747
Step 346: grad_norm=10.2819, loss=0.6981, param_norm=1886.5750
Step 347: grad_norm=9.9407, loss=0.6619, param_norm=1886.5754
Step 348: grad_norm=7.5376, loss=0.7059, param_norm=1886.5757
Step 349: grad_norm=12.2458, loss=0.7178, param_norm=1886.5760
22:28:00.011 [I] Progress on: 349it/1.00kit rate:1.1s/it remaining:11:44 elapsed:06:40 postfix:-  (3498206:tqdm_logging.py:145)
Step 350: grad_norm=7.2492, loss=0.7796, param_norm=1886.5763
Step 351: grad_norm=5.0308, loss=0.7197, param_norm=1886.5765
Step 352: grad_norm=7.6532, loss=0.7584, param_norm=1886.5768
Step 353: grad_norm=14.1530, loss=0.8007, param_norm=1886.5770
Step 354: grad_norm=5.7128, loss=0.7023, param_norm=1886.5773
Step 355: grad_norm=7.7086, loss=0.8142, param_norm=1886.5774
Step 356: grad_norm=8.7982, loss=0.7644, param_norm=1886.5778
Step 357: grad_norm=4.8009, loss=0.6444, param_norm=1886.5780
Step 358: grad_norm=13.2623, loss=0.6775, param_norm=1886.5782
22:28:10.236 [I] Progress on: 358it/1.00kit rate:1.1s/it remaining:11:59 elapsed:06:50 postfix:-  (3498206:tqdm_logging.py:145)
Step 359: grad_norm=18.6681, loss=0.7687, param_norm=1886.5784
Step 360: grad_norm=8.5490, loss=0.7220, param_norm=1886.5786
Step 361: grad_norm=4.8522, loss=0.6159, param_norm=1886.5789
Step 362: grad_norm=12.4620, loss=0.7280, param_norm=1886.5792
Step 363: grad_norm=8.9061, loss=0.7616, param_norm=1886.5795
Step 364: grad_norm=10.5602, loss=0.7400, param_norm=1886.5797
Step 365: grad_norm=9.1520, loss=0.8014, param_norm=1886.5800
Step 366: grad_norm=7.0657, loss=0.6673, param_norm=1886.5802
Step 367: grad_norm=14.9184, loss=0.7557, param_norm=1886.5804
Step 368: grad_norm=13.3864, loss=0.7020, param_norm=1886.5808
22:28:21.120 [I] Progress on: 368it/1.00kit rate:1.1s/it remaining:11:26 elapsed:07:01 postfix:-  (3498206:tqdm_logging.py:145)
Step 369: grad_norm=7.6139, loss=0.7172, param_norm=1886.5811
Step 370: grad_norm=5.2703, loss=0.5496, param_norm=1886.5814
Step 371: grad_norm=19.1870, loss=0.5760, param_norm=1886.5817
Step 372: grad_norm=4.9690, loss=0.6072, param_norm=1886.5818
Step 373: grad_norm=5.5094, loss=0.5371, param_norm=1886.5820
Step 374: grad_norm=7.5216, loss=0.6872, param_norm=1886.5823
Step 375: grad_norm=9.6062, loss=0.5363, param_norm=1886.5825
Step 376: grad_norm=7.1013, loss=0.5342, param_norm=1886.5826
Step 377: grad_norm=7.7819, loss=0.5880, param_norm=1886.5829
22:28:31.285 [I] Progress on: 377it/1.00kit rate:1.1s/it remaining:11:23 elapsed:07:11 postfix:-  (3498206:tqdm_logging.py:145)
Step 378: grad_norm=8.1833, loss=0.4781, param_norm=1886.5831
Step 379: grad_norm=9.7429, loss=0.6303, param_norm=1886.5833
Step 380: grad_norm=4.4887, loss=0.4808, param_norm=1886.5834
Step 381: grad_norm=8.7421, loss=0.6111, param_norm=1886.5836
Step 382: grad_norm=8.9613, loss=0.5911, param_norm=1886.5840
Step 383: grad_norm=6.3533, loss=0.5472, param_norm=1886.5842
Step 384: grad_norm=5.3424, loss=0.6239, param_norm=1886.5844
Step 385: grad_norm=6.1859, loss=0.6001, param_norm=1886.5846
Step 386: grad_norm=7.1810, loss=0.5122, param_norm=1886.5847
Step 387: grad_norm=5.4562, loss=0.6113, param_norm=1886.5851
22:28:42.137 [I] Progress on: 387it/1.00kit rate:1.1s/it remaining:11:03 elapsed:07:22 postfix:-  (3498206:tqdm_logging.py:145)
Step 388: grad_norm=8.0283, loss=0.5540, param_norm=1886.5853
Step 389: grad_norm=8.7240, loss=0.5597, param_norm=1886.5854
Step 390: grad_norm=11.8376, loss=0.6244, param_norm=1886.5857
Step 391: grad_norm=16.5875, loss=0.5370, param_norm=1886.5859
Step 392: grad_norm=13.5174, loss=0.6290, param_norm=1886.5862
Step 393: grad_norm=14.7661, loss=0.5590, param_norm=1886.5864
Step 394: grad_norm=6.0763, loss=0.6484, param_norm=1886.5867
Step 395: grad_norm=11.0106, loss=0.6259, param_norm=1886.5869
Step 396: grad_norm=12.2404, loss=0.7598, param_norm=1886.5872
Step 397: grad_norm=12.7768, loss=0.6217, param_norm=1886.5873
22:28:52.980 [I] Progress on: 397it/1.00kit rate:1.1s/it remaining:10:53 elapsed:07:32 postfix:-  (3498206:tqdm_logging.py:145)
Step 398: grad_norm=4.8620, loss=0.5860, param_norm=1886.5876
Step 399: grad_norm=14.2053, loss=0.4368, param_norm=1886.5878
Step 400: grad_norm=17.4354, loss=0.6193, param_norm=1886.5879
22:28:56.269 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:28:56.269 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:28:56.270 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (3498206:checkpoint_manager.py:1786)
22:28:56.270 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (3498206:checkpoint_manager.py:1817)
22:28:56.270 [I] [process=0] Saving checkpoint at step 400                                        (3498206:checkpoint_manager.py:1286)
22:28:56.271 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400. (3498206:async_checkpointer.py:358)
22:28:56.272 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:28:56.273 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9 (3498206:atomicity.py:144)
22:28:56.274 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:28:56.274 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:28:56.276 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (3498206:atomicity.py:144)
22:28:56.276 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (3498206:atomicity.py:144)
22:28:56.296 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:28:56.307 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:29:00.131 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:29:00.132 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:29:00.133 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:29:00.134 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:29:00.156 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:29:00.158 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:29:00.159 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:29:00.162 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:29:00.163 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:29:00.166 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:29:00.166 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783336.2695334, 'wait_for_prev_duration_secs': 0.0009169578552246094, 'checkpointer_blocking_start_time': 1742783336.2711027, 'checkpointer_blocking_duration_secs': 3.8856377601623535, 'get_old_steps_start_time': 1742783340.1567774, 'get_old_steps_duration_secs': 0.005445003509521484, 'checkpoint_manager_blocking_start_time': 1742783336.2694314, 'checkpoint_manager_blocking_duration_secs': 3.8972318172454834} (3498206:standard_logger.py:34)
Step 401: grad_norm=14.7771, loss=0.6021, param_norm=1886.5881
Step 402: grad_norm=8.8916, loss=0.5610, param_norm=1886.5883
Step 403: grad_norm=5.7736, loss=0.7308, param_norm=1886.5886
22:29:03.413 [I] Progress on: 403it/1.00kit rate:1.7s/it remaining:16:32 elapsed:07:43 postfix:-  (3498206:tqdm_logging.py:145)
Step 404: grad_norm=4.4554, loss=0.5824, param_norm=1886.5889
Step 405: grad_norm=11.4954, loss=0.6537, param_norm=1886.5890
Step 406: grad_norm=9.4566, loss=0.6493, param_norm=1886.5892
Step 407: grad_norm=18.9135, loss=0.6880, param_norm=1886.5895
22:29:08.808 [I] ChainedFuture completed 1/1 futures in 8.67 seconds.                             (3498206:future.py:137)
22:29:08.810 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 828.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:29:08.810 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:29:08.815 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9 (3498206:async_checkpointer.py:406)
22:29:08.816 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9/assets (3498206:atomicity.py:287)
22:29:08.835 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9/params (3498206:atomicity.py:287)
22:29:08.838 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400 (3498206:async_checkpointer.py:416)
22:29:08.838 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9 (3498206:async_checkpointer.py:426)
22:29:08.839 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400 (3498206:atomicity.py:287)
22:29:08.842 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/400`. (3498206:atomicity.py:548)
22:29:08.843 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:29:08.844 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:29:08.845 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:29:08.846 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:29:08.847 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 408: grad_norm=9.0694, loss=0.5776, param_norm=1886.5897
Step 409: grad_norm=5.0803, loss=0.5724, param_norm=1886.5900
Step 410: grad_norm=8.3035, loss=0.6018, param_norm=1886.5902
Step 411: grad_norm=10.7375, loss=0.7262, param_norm=1886.5903
Step 412: grad_norm=10.0996, loss=0.5718, param_norm=1886.5907
Step 413: grad_norm=6.5418, loss=0.6226, param_norm=1886.5908
22:29:14.392 [I] Progress on: 413it/1.00kit rate:1.1s/it remaining:10:51 elapsed:07:54 postfix:-  (3498206:tqdm_logging.py:145)
Step 414: grad_norm=6.3073, loss=0.6169, param_norm=1886.5911
Step 415: grad_norm=11.2564, loss=0.6580, param_norm=1886.5913
Step 416: grad_norm=7.2717, loss=0.6572, param_norm=1886.5916
Step 417: grad_norm=14.9324, loss=0.5899, param_norm=1886.5918
Step 418: grad_norm=9.5755, loss=0.4972, param_norm=1886.5920
Step 419: grad_norm=10.2699, loss=0.4503, param_norm=1886.5923
Step 420: grad_norm=7.4751, loss=0.4826, param_norm=1886.5925
Step 421: grad_norm=5.1925, loss=0.5423, param_norm=1886.5928
Step 422: grad_norm=4.3482, loss=0.5017, param_norm=1886.5930
Step 423: grad_norm=11.7143, loss=0.6133, param_norm=1886.5933
22:29:25.259 [I] Progress on: 423it/1.00kit rate:1.1s/it remaining:10:26 elapsed:08:05 postfix:-  (3498206:tqdm_logging.py:145)
Step 424: grad_norm=19.5334, loss=0.6557, param_norm=1886.5935
Step 425: grad_norm=7.1913, loss=0.6060, param_norm=1886.5936
Step 426: grad_norm=7.6317, loss=0.6087, param_norm=1886.5939
Step 427: grad_norm=4.5995, loss=0.5281, param_norm=1886.5940
Step 428: grad_norm=4.5044, loss=0.5060, param_norm=1886.5942
Step 429: grad_norm=7.8407, loss=0.5043, param_norm=1886.5945
Step 430: grad_norm=5.8155, loss=0.5050, param_norm=1886.5945
Step 431: grad_norm=5.4560, loss=0.5216, param_norm=1886.5947
Step 432: grad_norm=4.9508, loss=0.5271, param_norm=1886.5950
Step 433: grad_norm=16.4942, loss=0.6469, param_norm=1886.5952
22:29:36.091 [I] Progress on: 433it/1.00kit rate:1.1s/it remaining:10:12 elapsed:08:16 postfix:-  (3498206:tqdm_logging.py:145)
Step 434: grad_norm=5.8506, loss=0.5954, param_norm=1886.5953
Step 435: grad_norm=4.5141, loss=0.5219, param_norm=1886.5956
Step 436: grad_norm=14.3514, loss=0.8349, param_norm=1886.5957
Step 437: grad_norm=6.6471, loss=0.5745, param_norm=1886.5959
Step 438: grad_norm=12.7961, loss=0.6284, param_norm=1886.5962
Step 439: grad_norm=8.1419, loss=0.5623, param_norm=1886.5963
Step 440: grad_norm=11.6685, loss=0.6145, param_norm=1886.5966
Step 441: grad_norm=5.4954, loss=0.6310, param_norm=1886.5968
Step 442: grad_norm=4.5522, loss=0.5338, param_norm=1886.5970
Step 443: grad_norm=10.4368, loss=0.5996, param_norm=1886.5972
22:29:46.916 [I] Progress on: 443it/1.00kit rate:1.1s/it remaining:10:02 elapsed:08:26 postfix:-  (3498206:tqdm_logging.py:145)
Step 444: grad_norm=5.7200, loss=0.6051, param_norm=1886.5974
Step 445: grad_norm=5.7445, loss=0.4158, param_norm=1886.5975
Step 446: grad_norm=4.7647, loss=0.5047, param_norm=1886.5978
Step 447: grad_norm=3.8282, loss=0.4000, param_norm=1886.5979
Step 448: grad_norm=7.4023, loss=0.5799, param_norm=1886.5980
Step 449: grad_norm=7.3260, loss=0.5354, param_norm=1886.5981
Step 450: grad_norm=5.1865, loss=0.4134, param_norm=1886.5983
Step 451: grad_norm=6.3884, loss=0.5194, param_norm=1886.5984
Step 452: grad_norm=5.9127, loss=0.4957, param_norm=1886.5986
22:29:57.080 [I] Progress on: 452it/1.00kit rate:1.1s/it remaining:09:59 elapsed:08:37 postfix:-  (3498206:tqdm_logging.py:145)
Step 453: grad_norm=6.9694, loss=0.4725, param_norm=1886.5988
Step 454: grad_norm=4.3608, loss=0.4938, param_norm=1886.5989
Step 455: grad_norm=9.1910, loss=0.5347, param_norm=1886.5991
Step 456: grad_norm=7.8120, loss=0.4820, param_norm=1886.5991
Step 457: grad_norm=8.9660, loss=0.4679, param_norm=1886.5994
Step 458: grad_norm=9.0224, loss=0.4733, param_norm=1886.5996
Step 459: grad_norm=7.8139, loss=0.4691, param_norm=1886.5997
Step 460: grad_norm=22.7054, loss=0.6632, param_norm=1886.6000
Step 461: grad_norm=8.4093, loss=0.4784, param_norm=1886.6001
Step 462: grad_norm=7.3155, loss=0.4933, param_norm=1886.6003
22:30:07.914 [I] Progress on: 462it/1.00kit rate:1.1s/it remaining:09:45 elapsed:08:47 postfix:-  (3498206:tqdm_logging.py:145)
Step 463: grad_norm=4.6343, loss=0.5089, param_norm=1886.6005
Step 464: grad_norm=5.8756, loss=0.4245, param_norm=1886.6006
Step 465: grad_norm=4.3212, loss=0.4636, param_norm=1886.6008
Step 466: grad_norm=6.8433, loss=0.4341, param_norm=1886.6011
Step 467: grad_norm=4.5753, loss=0.4820, param_norm=1886.6013
Step 468: grad_norm=6.0147, loss=0.5127, param_norm=1886.6014
Step 469: grad_norm=5.7968, loss=0.4270, param_norm=1886.6017
Step 470: grad_norm=5.3545, loss=0.5902, param_norm=1886.6018
Step 471: grad_norm=4.7788, loss=0.4098, param_norm=1886.6021
Step 472: grad_norm=6.6673, loss=0.5537, param_norm=1886.6023
22:30:18.798 [I] Progress on: 472it/1.00kit rate:1.1s/it remaining:09:36 elapsed:08:58 postfix:-  (3498206:tqdm_logging.py:145)
Step 473: grad_norm=6.8219, loss=0.4679, param_norm=1886.6025
Step 474: grad_norm=12.9703, loss=0.4963, param_norm=1886.6027
Step 475: grad_norm=4.9651, loss=0.4806, param_norm=1886.6029
Step 476: grad_norm=5.7547, loss=0.4985, param_norm=1886.6030
Step 477: grad_norm=4.5363, loss=0.4264, param_norm=1886.6031
Step 478: grad_norm=9.5943, loss=0.5276, param_norm=1886.6034
Step 479: grad_norm=10.9736, loss=0.4122, param_norm=1886.6035
Step 480: grad_norm=5.4143, loss=0.4641, param_norm=1886.6038
Step 481: grad_norm=4.9142, loss=0.4446, param_norm=1886.6040
22:30:28.814 [I] Progress on: 482it/1.00kit rate:1.1s/it remaining:09:26 elapsed:09:08 postfix:-  (3498206:tqdm_logging.py:145)
Step 482: grad_norm=4.0101, loss=0.4115, param_norm=1886.6041
Step 483: grad_norm=8.3652, loss=0.5315, param_norm=1886.6044
Step 484: grad_norm=4.9292, loss=0.4930, param_norm=1886.6044
Step 485: grad_norm=5.4553, loss=0.3836, param_norm=1886.6046
Step 486: grad_norm=4.5333, loss=0.4547, param_norm=1886.6049
Step 487: grad_norm=4.0994, loss=0.4514, param_norm=1886.6049
Step 488: grad_norm=5.0426, loss=0.4188, param_norm=1886.6050
Step 489: grad_norm=6.9482, loss=0.4876, param_norm=1886.6051
Step 490: grad_norm=7.0485, loss=0.3734, param_norm=1886.6052
Step 491: grad_norm=4.3963, loss=0.4585, param_norm=1886.6055
22:30:39.619 [I] Progress on: 491it/1.00kit rate:1.1s/it remaining:09:11 elapsed:09:19 postfix:-  (3498206:tqdm_logging.py:145)
Step 492: grad_norm=10.1682, loss=0.4711, param_norm=1886.6056
Step 493: grad_norm=8.3534, loss=0.5480, param_norm=1886.6057
Step 494: grad_norm=4.7908, loss=0.4575, param_norm=1886.6060
Step 495: grad_norm=4.3437, loss=0.3714, param_norm=1886.6061
Step 496: grad_norm=8.3254, loss=0.4855, param_norm=1886.6061
Step 497: grad_norm=4.2414, loss=0.3860, param_norm=1886.6063
Step 498: grad_norm=6.4521, loss=0.3661, param_norm=1886.6064
Step 499: grad_norm=6.9462, loss=0.3620, param_norm=1886.6066
Step 500: grad_norm=9.4456, loss=0.4800, param_norm=1886.6067
22:30:49.445 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:30:49.445 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:30:49.445 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (3498206:checkpoint_manager.py:1786)
22:30:49.445 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (3498206:checkpoint_manager.py:1817)
22:30:49.446 [I] [process=0] Saving checkpoint at step 500                                        (3498206:checkpoint_manager.py:1286)
22:30:49.446 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500. (3498206:async_checkpointer.py:358)
22:30:49.447 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:30:49.448 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12 (3498206:atomicity.py:144)
22:30:49.449 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:30:49.449 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:30:49.450 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (3498206:atomicity.py:144)
22:30:49.451 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (3498206:atomicity.py:144)
22:30:49.451 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:30:49.457 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:30:53.329 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:30:53.330 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:30:53.330 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:30:53.332 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:30:53.353 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:30:53.355 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:30:53.359 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:30:53.361 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:29:00.156752+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:30:53.366 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:30:53.369 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:30:53.372 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:30:53.374 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783449.4452229, 'wait_for_prev_duration_secs': 0.0007843971252441406, 'checkpointer_blocking_start_time': 1742783449.446538, 'checkpointer_blocking_duration_secs': 3.9066789150238037, 'get_old_steps_start_time': 1742783453.3532796, 'get_old_steps_duration_secs': 0.013175249099731445, 'checkpoint_manager_blocking_start_time': 1742783449.4450881, 'checkpoint_manager_blocking_duration_secs': 3.928978443145752} (3498206:standard_logger.py:34)
22:30:53.378 [I] Progress on: 501it/1.00kit rate:2.3s/it remaining:18:50 elapsed:09:33 postfix:-  (3498206:tqdm_logging.py:145)
Step 501: grad_norm=7.5676, loss=0.4859, param_norm=1886.6068
Step 502: grad_norm=9.2577, loss=0.4386, param_norm=1886.6071
Step 503: grad_norm=6.9371, loss=0.4278, param_norm=1886.6072
Step 504: grad_norm=5.2769, loss=0.4864, param_norm=1886.6073
Step 505: grad_norm=4.4960, loss=0.4113, param_norm=1886.6074
Step 506: grad_norm=5.3393, loss=0.5092, param_norm=1886.6075
Step 507: grad_norm=4.7099, loss=0.4568, param_norm=1886.6078
Step 508: grad_norm=5.9597, loss=0.4191, param_norm=1886.6079
22:31:02.460 [I] ChainedFuture completed 1/1 futures in 9.12 seconds.                             (3498206:future.py:137)
22:31:02.463 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 796.3 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:31:02.463 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:31:02.468 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12 (3498206:async_checkpointer.py:406)
22:31:02.470 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12/assets (3498206:atomicity.py:287)
22:31:02.486 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12/params (3498206:atomicity.py:287)
22:31:02.488 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500 (3498206:async_checkpointer.py:416)
22:31:02.489 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12 (3498206:async_checkpointer.py:426)
22:31:02.489 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500 (3498206:atomicity.py:287)
22:31:02.491 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/500`. (3498206:atomicity.py:548)
22:31:02.492 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:31:02.493 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:31:02.493 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:31:02.494 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:31:02.494 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 509: grad_norm=5.1364, loss=0.5599, param_norm=1886.6082
Step 510: grad_norm=8.8683, loss=0.5124, param_norm=1886.6083
22:31:04.318 [I] Progress on: 510it/1.00kit rate:1.1s/it remaining:09:21 elapsed:09:44 postfix:-  (3498206:tqdm_logging.py:145)
Step 511: grad_norm=6.7517, loss=0.4804, param_norm=1886.6084
Step 512: grad_norm=10.2865, loss=0.5526, param_norm=1886.6086
Step 513: grad_norm=9.5639, loss=0.5727, param_norm=1886.6088
Step 514: grad_norm=4.6021, loss=0.4409, param_norm=1886.6090
Step 515: grad_norm=4.8469, loss=0.4531, param_norm=1886.6091
Step 516: grad_norm=7.3118, loss=0.4883, param_norm=1886.6093
Step 517: grad_norm=6.1708, loss=0.3922, param_norm=1886.6095
Step 518: grad_norm=7.9924, loss=0.3369, param_norm=1886.6096
Step 519: grad_norm=3.9866, loss=0.4210, param_norm=1886.6097
22:31:14.544 [I] Progress on: 519it/1.00kit rate:1.2s/it remaining:09:28 elapsed:09:54 postfix:-  (3498206:tqdm_logging.py:145)
Step 520: grad_norm=4.2654, loss=0.3099, param_norm=1886.6099
Step 521: grad_norm=6.7763, loss=0.3336, param_norm=1886.6100
Step 522: grad_norm=4.0041, loss=0.3610, param_norm=1886.6102
Step 523: grad_norm=3.5321, loss=0.2792, param_norm=1886.6104
Step 524: grad_norm=17.3708, loss=0.4122, param_norm=1886.6105
Step 525: grad_norm=4.0478, loss=0.3591, param_norm=1886.6106
Step 526: grad_norm=5.8716, loss=0.3882, param_norm=1886.6107
Step 527: grad_norm=5.2980, loss=0.3524, param_norm=1886.6108
Step 528: grad_norm=8.2732, loss=0.3910, param_norm=1886.6110
Step 529: grad_norm=13.8954, loss=0.3714, param_norm=1886.6111
22:31:25.364 [I] Progress on: 529it/1.00kit rate:1.1s/it remaining:08:30 elapsed:10:05 postfix:-  (3498206:tqdm_logging.py:145)
Step 530: grad_norm=7.0281, loss=0.2945, param_norm=1886.6112
Step 531: grad_norm=6.5291, loss=0.4906, param_norm=1886.6113
Step 532: grad_norm=7.2454, loss=0.4278, param_norm=1886.6115
Step 533: grad_norm=4.7353, loss=0.3989, param_norm=1886.6116
Step 534: grad_norm=4.3847, loss=0.3677, param_norm=1886.6117
Step 535: grad_norm=5.5589, loss=0.4190, param_norm=1886.6118
Step 536: grad_norm=6.3084, loss=0.3809, param_norm=1886.6119
Step 537: grad_norm=5.8046, loss=0.4080, param_norm=1886.6121
Step 538: grad_norm=5.2716, loss=0.3198, param_norm=1886.6122
Step 539: grad_norm=12.6784, loss=0.3635, param_norm=1886.6123
22:31:36.202 [I] Progress on: 539it/1.00kit rate:1.1s/it remaining:08:18 elapsed:10:16 postfix:-  (3498206:tqdm_logging.py:145)
Step 540: grad_norm=6.3940, loss=0.3496, param_norm=1886.6123
Step 541: grad_norm=4.3042, loss=0.3865, param_norm=1886.6125
Step 542: grad_norm=4.7757, loss=0.4185, param_norm=1886.6127
Step 543: grad_norm=5.8198, loss=0.3352, param_norm=1886.6128
Step 544: grad_norm=7.5432, loss=0.3976, param_norm=1886.6128
Step 545: grad_norm=4.0547, loss=0.3530, param_norm=1886.6130
Step 546: grad_norm=4.3712, loss=0.3290, param_norm=1886.6132
Step 547: grad_norm=5.5177, loss=0.3876, param_norm=1886.6133
Step 548: grad_norm=8.7206, loss=0.4574, param_norm=1886.6134
Step 549: grad_norm=7.8098, loss=0.3881, param_norm=1886.6135
22:31:47.051 [I] Progress on: 549it/1.00kit rate:1.1s/it remaining:08:08 elapsed:10:27 postfix:-  (3498206:tqdm_logging.py:145)
Step 550: grad_norm=3.9428, loss=0.3363, param_norm=1886.6136
Step 551: grad_norm=5.3812, loss=0.3028, param_norm=1886.6138
Step 552: grad_norm=4.3291, loss=0.4216, param_norm=1886.6139
Step 553: grad_norm=5.0500, loss=0.3871, param_norm=1886.6140
Step 554: grad_norm=4.2291, loss=0.3815, param_norm=1886.6141
Step 555: grad_norm=5.3742, loss=0.3879, param_norm=1886.6143
Step 556: grad_norm=6.2625, loss=0.2888, param_norm=1886.6143
Step 557: grad_norm=4.4658, loss=0.3514, param_norm=1886.6144
Step 558: grad_norm=5.4839, loss=0.4018, param_norm=1886.6145
Step 559: grad_norm=4.5972, loss=0.3692, param_norm=1886.6146
22:31:57.923 [I] Progress on: 559it/1.00kit rate:1.1s/it remaining:08:00 elapsed:10:37 postfix:-  (3498206:tqdm_logging.py:145)
Step 560: grad_norm=6.3799, loss=0.3390, param_norm=1886.6147
Step 561: grad_norm=6.9081, loss=0.3032, param_norm=1886.6150
Step 562: grad_norm=9.7452, loss=0.3675, param_norm=1886.6151
Step 563: grad_norm=3.9046, loss=0.3659, param_norm=1886.6151
Step 564: grad_norm=3.7845, loss=0.3073, param_norm=1886.6152
Step 565: grad_norm=5.5604, loss=0.3626, param_norm=1886.6154
Step 566: grad_norm=10.2383, loss=0.4079, param_norm=1886.6155
Step 567: grad_norm=4.3782, loss=0.3756, param_norm=1886.6156
Step 568: grad_norm=4.2103, loss=0.3220, param_norm=1886.6157
Step 569: grad_norm=3.8087, loss=0.3564, param_norm=1886.6158
22:32:08.818 [I] Progress on: 569it/1.00kit rate:1.1s/it remaining:07:48 elapsed:10:48 postfix:-  (3498206:tqdm_logging.py:145)
Step 570: grad_norm=5.1474, loss=0.3973, param_norm=1886.6158
Step 571: grad_norm=4.3211, loss=0.3178, param_norm=1886.6160
Step 572: grad_norm=5.4466, loss=0.3095, param_norm=1886.6161
Step 573: grad_norm=4.5204, loss=0.4225, param_norm=1886.6161
Step 574: grad_norm=4.2237, loss=0.4045, param_norm=1886.6163
Step 575: grad_norm=8.4407, loss=0.4198, param_norm=1886.6163
Step 576: grad_norm=4.1173, loss=0.3114, param_norm=1886.6165
Step 577: grad_norm=8.7202, loss=0.3514, param_norm=1886.6166
Step 578: grad_norm=5.4587, loss=0.4131, param_norm=1886.6166
Step 579: grad_norm=4.0638, loss=0.3165, param_norm=1886.6167
22:32:19.704 [I] Progress on: 579it/1.00kit rate:1.1s/it remaining:07:38 elapsed:10:59 postfix:-  (3498206:tqdm_logging.py:145)
Step 580: grad_norm=4.1797, loss=0.3875, param_norm=1886.6168
Step 581: grad_norm=4.7317, loss=0.3520, param_norm=1886.6169
Step 582: grad_norm=6.4963, loss=0.3353, param_norm=1886.6171
Step 583: grad_norm=5.3086, loss=0.3527, param_norm=1886.6172
Step 584: grad_norm=4.0393, loss=0.3287, param_norm=1886.6172
Step 585: grad_norm=3.9714, loss=0.3684, param_norm=1886.6173
Step 586: grad_norm=5.3833, loss=0.2664, param_norm=1886.6174
Step 587: grad_norm=4.2638, loss=0.3825, param_norm=1886.6176
Step 588: grad_norm=4.7023, loss=0.3358, param_norm=1886.6176
Step 589: grad_norm=5.5884, loss=0.3623, param_norm=1886.6178
22:32:30.590 [I] Progress on: 589it/1.00kit rate:1.1s/it remaining:07:26 elapsed:11:10 postfix:-  (3498206:tqdm_logging.py:145)
Step 590: grad_norm=11.5013, loss=0.3678, param_norm=1886.6179
Step 591: grad_norm=4.9205, loss=0.4164, param_norm=1886.6180
Step 592: grad_norm=3.0991, loss=0.2474, param_norm=1886.6180
Step 593: grad_norm=8.4646, loss=0.3001, param_norm=1886.6182
Step 594: grad_norm=5.8590, loss=0.2543, param_norm=1886.6183
Step 595: grad_norm=4.0220, loss=0.3069, param_norm=1886.6183
Step 596: grad_norm=4.4374, loss=0.2812, param_norm=1886.6184
Step 597: grad_norm=4.9955, loss=0.2502, param_norm=1886.6184
Step 598: grad_norm=3.1828, loss=0.2438, param_norm=1886.6185
22:32:41.206 [I] Progress on: 598it/1.00kit rate:1.2s/it remaining:07:43 elapsed:11:21 postfix:-  (3498206:tqdm_logging.py:145)
Step 599: grad_norm=5.6033, loss=0.3374, param_norm=1886.6187
Step 600: grad_norm=3.8025, loss=0.2807, param_norm=1886.6188
22:32:43.417 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:32:43.418 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:32:43.418 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (3498206:checkpoint_manager.py:1786)
22:32:43.418 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (3498206:checkpoint_manager.py:1817)
22:32:43.419 [I] [process=0] Saving checkpoint at step 600                                        (3498206:checkpoint_manager.py:1286)
22:32:43.420 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600. (3498206:async_checkpointer.py:358)
22:32:43.421 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:32:43.421 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15 (3498206:atomicity.py:144)
22:32:43.422 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:32:43.423 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:32:43.424 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (3498206:atomicity.py:144)
22:32:43.425 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (3498206:atomicity.py:144)
22:32:43.426 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:32:43.432 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:32:47.056 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:32:47.057 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:32:47.058 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:32:47.062 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:32:47.086 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:32:47.089 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:32:47.093 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:32:47.095 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:29:00.156752+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:32:47.100 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:30:53.353234+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:32:47.102 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:32:47.103 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:32:47.113 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:32:47.115 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783563.4177723, 'wait_for_prev_duration_secs': 0.001009225845336914, 'checkpointer_blocking_start_time': 1742783563.4195454, 'checkpointer_blocking_duration_secs': 3.6669411659240723, 'get_old_steps_start_time': 1742783567.0865495, 'get_old_steps_duration_secs': 0.016078948974609375, 'checkpoint_manager_blocking_start_time': 1742783563.4176347, 'checkpoint_manager_blocking_duration_secs': 3.6963865756988525} (3498206:standard_logger.py:34)
Step 601: grad_norm=5.6196, loss=0.2948, param_norm=1886.6188
Step 602: grad_norm=3.4677, loss=0.2967, param_norm=1886.6189
Step 603: grad_norm=3.7444, loss=0.2888, param_norm=1886.6190
Step 604: grad_norm=3.3465, loss=0.2740, param_norm=1886.6190
22:32:51.460 [I] Progress on: 604it/1.00kit rate:1.5s/it remaining:09:47 elapsed:11:31 postfix:-  (3498206:tqdm_logging.py:145)
Step 605: grad_norm=4.6149, loss=0.2829, param_norm=1886.6191
Step 606: grad_norm=4.0467, loss=0.2716, param_norm=1886.6191
Step 607: grad_norm=2.7643, loss=0.2228, param_norm=1886.6191
22:32:55.658 [I] ChainedFuture completed 1/1 futures in 8.58 seconds.                             (3498206:future.py:137)
22:32:55.659 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 847.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:32:55.659 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:32:55.660 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15 (3498206:async_checkpointer.py:406)
22:32:55.661 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15/assets (3498206:atomicity.py:287)
22:32:55.671 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15/params (3498206:atomicity.py:287)
22:32:55.672 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600 (3498206:async_checkpointer.py:416)
22:32:55.672 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15 (3498206:async_checkpointer.py:426)
22:32:55.672 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600 (3498206:atomicity.py:287)
22:32:55.674 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/600`. (3498206:atomicity.py:548)
22:32:55.674 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:32:55.675 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:32:55.675 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:32:55.675 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:32:55.676 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 608: grad_norm=4.9899, loss=0.2334, param_norm=1886.6193
Step 609: grad_norm=3.8090, loss=0.2688, param_norm=1886.6193
Step 610: grad_norm=6.4460, loss=0.3120, param_norm=1886.6193
Step 611: grad_norm=6.1600, loss=0.3210, param_norm=1886.6195
Step 612: grad_norm=4.1577, loss=0.3104, param_norm=1886.6195
Step 613: grad_norm=8.1301, loss=0.2778, param_norm=1886.6196
Step 614: grad_norm=3.2040, loss=0.2737, param_norm=1886.6198
22:33:02.366 [I] Progress on: 614it/1.00kit rate:1.1s/it remaining:07:05 elapsed:11:42 postfix:-  (3498206:tqdm_logging.py:145)
Step 615: grad_norm=3.6544, loss=0.2795, param_norm=1886.6198
Step 616: grad_norm=3.9463, loss=0.2644, param_norm=1886.6199
Step 617: grad_norm=5.2264, loss=0.2430, param_norm=1886.6200
Step 618: grad_norm=4.2001, loss=0.2826, param_norm=1886.6201
Step 619: grad_norm=4.2198, loss=0.3358, param_norm=1886.6202
Step 620: grad_norm=3.5654, loss=0.3024, param_norm=1886.6202
Step 621: grad_norm=3.9231, loss=0.3565, param_norm=1886.6204
Step 622: grad_norm=3.4409, loss=0.2026, param_norm=1886.6205
Step 623: grad_norm=3.5088, loss=0.2993, param_norm=1886.6206
Step 624: grad_norm=6.5538, loss=0.2377, param_norm=1886.6206
22:33:13.303 [I] Progress on: 624it/1.00kit rate:1.1s/it remaining:06:52 elapsed:11:53 postfix:-  (3498206:tqdm_logging.py:145)
Step 625: grad_norm=3.0912, loss=0.2414, param_norm=1886.6207
Step 626: grad_norm=5.1102, loss=0.2836, param_norm=1886.6208
Step 627: grad_norm=3.7123, loss=0.2917, param_norm=1886.6210
Step 628: grad_norm=4.0768, loss=0.2993, param_norm=1886.6211
Step 629: grad_norm=8.5190, loss=0.3575, param_norm=1886.6211
Step 630: grad_norm=3.9389, loss=0.2784, param_norm=1886.6212
Step 631: grad_norm=2.9967, loss=0.2169, param_norm=1886.6212
Step 632: grad_norm=3.3266, loss=0.2411, param_norm=1886.6212
Step 633: grad_norm=8.4638, loss=0.2096, param_norm=1886.6213
Step 634: grad_norm=5.8782, loss=0.2955, param_norm=1886.6215
22:33:24.211 [I] Progress on: 634it/1.00kit rate:1.1s/it remaining:06:41 elapsed:12:04 postfix:-  (3498206:tqdm_logging.py:145)
Step 635: grad_norm=5.2768, loss=0.3028, param_norm=1886.6215
Step 636: grad_norm=4.2165, loss=0.2448, param_norm=1886.6216
Step 637: grad_norm=3.9908, loss=0.3431, param_norm=1886.6216
Step 638: grad_norm=8.1711, loss=0.2621, param_norm=1886.6217
Step 639: grad_norm=4.4429, loss=0.2628, param_norm=1886.6218
Step 640: grad_norm=4.2721, loss=0.3085, param_norm=1886.6218
Step 641: grad_norm=4.2450, loss=0.2786, param_norm=1886.6219
Step 642: grad_norm=5.4341, loss=0.3156, param_norm=1886.6221
Step 643: grad_norm=5.8384, loss=0.2980, param_norm=1886.6222
Step 644: grad_norm=3.8282, loss=0.2629, param_norm=1886.6222
22:33:35.183 [I] Progress on: 644it/1.00kit rate:1.1s/it remaining:06:30 elapsed:12:15 postfix:-  (3498206:tqdm_logging.py:145)
Step 645: grad_norm=3.8646, loss=0.2533, param_norm=1886.6223
Step 646: grad_norm=4.8478, loss=0.3064, param_norm=1886.6223
Step 647: grad_norm=3.2293, loss=0.2447, param_norm=1886.6226
Step 648: grad_norm=3.0068, loss=0.2089, param_norm=1886.6226
Step 649: grad_norm=4.6584, loss=0.2524, param_norm=1886.6226
Step 650: grad_norm=6.8890, loss=0.3415, param_norm=1886.6227
Step 651: grad_norm=5.2779, loss=0.3002, param_norm=1886.6227
Step 652: grad_norm=3.6582, loss=0.2600, param_norm=1886.6228
Step 653: grad_norm=3.6677, loss=0.3021, param_norm=1886.6228
Step 654: grad_norm=3.1034, loss=0.2534, param_norm=1886.6229
22:33:46.049 [I] Progress on: 654it/1.00kit rate:1.1s/it remaining:06:16 elapsed:12:26 postfix:-  (3498206:tqdm_logging.py:145)
Step 655: grad_norm=4.0182, loss=0.3000, param_norm=1886.6230
Step 656: grad_norm=7.4036, loss=0.2772, param_norm=1886.6230
Step 657: grad_norm=6.1647, loss=0.2920, param_norm=1886.6230
Step 658: grad_norm=3.6978, loss=0.2379, param_norm=1886.6232
Step 659: grad_norm=3.3039, loss=0.2523, param_norm=1886.6232
Step 660: grad_norm=5.2068, loss=0.2981, param_norm=1886.6233
Step 661: grad_norm=3.8551, loss=0.2915, param_norm=1886.6233
Step 662: grad_norm=4.6972, loss=0.3197, param_norm=1886.6233
Step 663: grad_norm=3.2238, loss=0.2423, param_norm=1886.6234
Step 664: grad_norm=5.1591, loss=0.3174, param_norm=1886.6234
22:33:56.974 [I] Progress on: 664it/1.00kit rate:1.1s/it remaining:06:08 elapsed:12:36 postfix:-  (3498206:tqdm_logging.py:145)
Step 665: grad_norm=4.9390, loss=0.2168, param_norm=1886.6234
Step 666: grad_norm=3.2854, loss=0.2766, param_norm=1886.6235
Step 667: grad_norm=3.3486, loss=0.2401, param_norm=1886.6235
Step 668: grad_norm=2.9805, loss=0.2222, param_norm=1886.6237
Step 669: grad_norm=3.7981, loss=0.2022, param_norm=1886.6238
Step 670: grad_norm=5.0203, loss=0.2348, param_norm=1886.6238
Step 671: grad_norm=3.5048, loss=0.2587, param_norm=1886.6239
Step 672: grad_norm=2.8831, loss=0.2016, param_norm=1886.6239
Step 673: grad_norm=2.6762, loss=0.2033, param_norm=1886.6240
22:34:07.185 [I] Progress on: 673it/1.00kit rate:1.1s/it remaining:05:59 elapsed:12:47 postfix:-  (3498206:tqdm_logging.py:145)
Step 674: grad_norm=3.6518, loss=0.2402, param_norm=1886.6241
Step 675: grad_norm=3.2501, loss=0.2251, param_norm=1886.6241
Step 676: grad_norm=3.5278, loss=0.2307, param_norm=1886.6243
Step 677: grad_norm=3.3314, loss=0.2345, param_norm=1886.6243
Step 678: grad_norm=5.2321, loss=0.1652, param_norm=1886.6243
Step 679: grad_norm=2.6884, loss=0.1444, param_norm=1886.6244
Step 680: grad_norm=3.0168, loss=0.1905, param_norm=1886.6244
Step 681: grad_norm=6.5916, loss=0.2326, param_norm=1886.6245
Step 682: grad_norm=2.6819, loss=0.2052, param_norm=1886.6245
Step 683: grad_norm=5.7982, loss=0.2498, param_norm=1886.6246
22:34:18.103 [I] Progress on: 683it/1.00kit rate:1.1s/it remaining:05:46 elapsed:12:58 postfix:-  (3498206:tqdm_logging.py:145)
Step 684: grad_norm=4.2238, loss=0.2468, param_norm=1886.6246
Step 685: grad_norm=5.2318, loss=0.1759, param_norm=1886.6248
Step 686: grad_norm=3.4377, loss=0.1540, param_norm=1886.6248
Step 687: grad_norm=3.7210, loss=0.1973, param_norm=1886.6249
Step 688: grad_norm=3.1083, loss=0.1968, param_norm=1886.6249
Step 689: grad_norm=4.9383, loss=0.2399, param_norm=1886.6250
Step 690: grad_norm=4.5043, loss=0.1947, param_norm=1886.6251
Step 691: grad_norm=2.9090, loss=0.1848, param_norm=1886.6251
Step 692: grad_norm=3.6469, loss=0.2410, param_norm=1886.6251
Step 693: grad_norm=3.7300, loss=0.2466, param_norm=1886.6251
22:34:29.050 [I] Progress on: 693it/1.00kit rate:1.1s/it remaining:05:35 elapsed:13:09 postfix:-  (3498206:tqdm_logging.py:145)
Step 694: grad_norm=2.4148, loss=0.1420, param_norm=1886.6252
Step 695: grad_norm=2.5263, loss=0.1788, param_norm=1886.6252
Step 696: grad_norm=3.8431, loss=0.2616, param_norm=1886.6252
Step 697: grad_norm=3.9592, loss=0.1805, param_norm=1886.6254
Step 698: grad_norm=2.9557, loss=0.1608, param_norm=1886.6254
Step 699: grad_norm=4.2435, loss=0.1553, param_norm=1886.6256
Step 700: grad_norm=3.4630, loss=0.2434, param_norm=1886.6256
22:34:36.765 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:34:36.766 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:34:36.766 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (3498206:checkpoint_manager.py:1786)
22:34:36.766 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (3498206:checkpoint_manager.py:1817)
22:34:36.767 [I] [process=0] Saving checkpoint at step 700                                        (3498206:checkpoint_manager.py:1286)
22:34:36.768 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700. (3498206:async_checkpointer.py:358)
22:34:36.770 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:34:36.770 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18 (3498206:atomicity.py:144)
22:34:36.795 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:34:36.796 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:34:36.823 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (3498206:atomicity.py:144)
22:34:36.824 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (3498206:atomicity.py:144)
22:34:36.826 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:34:36.845 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:34:41.233 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.3 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:34:41.239 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:34:41.241 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:34:41.243 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:34:41.249 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:34:41.250 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:34:41.250 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:34:41.251 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:29:00.156752+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:34:41.252 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:30:53.353234+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:34:41.254 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:32:47.086503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:34:41.255 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:34:41.256 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:34:41.259 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:34:41.261 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783676.7654753, 'wait_for_prev_duration_secs': 0.0011260509490966797, 'checkpointer_blocking_start_time': 1742783676.7675889, 'checkpointer_blocking_duration_secs': 4.481281280517578, 'get_old_steps_start_time': 1742783681.2489638, 'get_old_steps_duration_secs': 0.006238698959350586, 'checkpoint_manager_blocking_start_time': 1742783676.7651923, 'checkpoint_manager_blocking_duration_secs': 4.496304512023926} (3498206:standard_logger.py:34)
22:34:41.267 [I] Progress on: 701it/1.00kit rate:2.4s/it remaining:12:11 elapsed:13:21 postfix:-  (3498206:tqdm_logging.py:145)
Step 701: grad_norm=4.5557, loss=0.2724, param_norm=1886.6256
Step 702: grad_norm=3.3286, loss=0.2044, param_norm=1886.6256
Step 703: grad_norm=3.4089, loss=0.2066, param_norm=1886.6257
Step 704: grad_norm=4.1486, loss=0.2225, param_norm=1886.6257
Step 705: grad_norm=3.7548, loss=0.2391, param_norm=1886.6259
Step 706: grad_norm=3.0240, loss=0.2063, param_norm=1886.6259
Step 707: grad_norm=3.9497, loss=0.2335, param_norm=1886.6259
22:34:49.190 [I] ChainedFuture completed 1/1 futures in 7.95 seconds.                             (3498206:future.py:137)
22:34:49.190 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 838.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:34:49.190 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:34:49.192 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18 (3498206:async_checkpointer.py:406)
22:34:49.192 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18/assets (3498206:atomicity.py:287)
22:34:49.203 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18/params (3498206:atomicity.py:287)
22:34:49.203 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700 (3498206:async_checkpointer.py:416)
22:34:49.204 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18 (3498206:async_checkpointer.py:426)
22:34:49.204 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700 (3498206:atomicity.py:287)
22:34:49.205 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/700`. (3498206:atomicity.py:548)
22:34:49.206 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:34:49.206 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:34:49.206 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:34:49.207 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:34:49.207 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 708: grad_norm=6.0477, loss=0.2914, param_norm=1886.6259
Step 709: grad_norm=3.1174, loss=0.2068, param_norm=1886.6261
Step 710: grad_norm=3.2088, loss=0.1797, param_norm=1886.6261
22:34:52.250 [I] Progress on: 710it/1.00kit rate:1.1s/it remaining:05:33 elapsed:13:32 postfix:-  (3498206:tqdm_logging.py:145)
Step 711: grad_norm=3.0987, loss=0.1654, param_norm=1886.6261
Step 712: grad_norm=3.1771, loss=0.1994, param_norm=1886.6261
Step 713: grad_norm=3.7748, loss=0.2284, param_norm=1886.6261
Step 714: grad_norm=3.3146, loss=0.2187, param_norm=1886.6262
Step 715: grad_norm=3.7467, loss=0.2599, param_norm=1886.6262
Step 716: grad_norm=4.3433, loss=0.2194, param_norm=1886.6262
Step 717: grad_norm=4.0210, loss=0.1987, param_norm=1886.6262
Step 718: grad_norm=7.5907, loss=0.2387, param_norm=1886.6263
Step 719: grad_norm=3.7345, loss=0.2154, param_norm=1886.6263
Step 720: grad_norm=2.9759, loss=0.2258, param_norm=1886.6265
22:35:03.150 [I] Progress on: 720it/1.00kit rate:1.1s/it remaining:05:05 elapsed:13:43 postfix:-  (3498206:tqdm_logging.py:145)
Step 721: grad_norm=3.7058, loss=0.2429, param_norm=1886.6265
Step 722: grad_norm=3.0441, loss=0.1945, param_norm=1886.6265
Step 723: grad_norm=3.3253, loss=0.2014, param_norm=1886.6265
Step 724: grad_norm=4.2806, loss=0.2491, param_norm=1886.6265
Step 725: grad_norm=3.0409, loss=0.2199, param_norm=1886.6266
Step 726: grad_norm=3.4932, loss=0.1767, param_norm=1886.6266
Step 727: grad_norm=3.4735, loss=0.1960, param_norm=1886.6266
Step 728: grad_norm=6.4782, loss=0.1827, param_norm=1886.6266
Step 729: grad_norm=5.3757, loss=0.2116, param_norm=1886.6266
Step 730: grad_norm=3.7954, loss=0.2163, param_norm=1886.6266
22:35:14.042 [I] Progress on: 730it/1.00kit rate:1.1s/it remaining:04:54 elapsed:13:54 postfix:-  (3498206:tqdm_logging.py:145)
Step 731: grad_norm=3.3953, loss=0.2204, param_norm=1886.6267
Step 732: grad_norm=4.6710, loss=0.2330, param_norm=1886.6267
Step 733: grad_norm=3.5267, loss=0.2266, param_norm=1886.6267
Step 734: grad_norm=3.4875, loss=0.2019, param_norm=1886.6267
Step 735: grad_norm=3.1203, loss=0.1583, param_norm=1886.6268
Step 736: grad_norm=6.0615, loss=0.2258, param_norm=1886.6268
Step 737: grad_norm=4.8422, loss=0.1852, param_norm=1886.6268
Step 738: grad_norm=4.0517, loss=0.1985, param_norm=1886.6270
Step 739: grad_norm=4.1624, loss=0.1786, param_norm=1886.6270
22:35:24.269 [I] Progress on: 740it/1.00kit rate:1.2s/it remaining:05:13 elapsed:14:04 postfix:-  (3498206:tqdm_logging.py:145)
Step 740: grad_norm=2.8296, loss=0.1670, param_norm=1886.6270
Step 741: grad_norm=3.0581, loss=0.1785, param_norm=1886.6270
Step 742: grad_norm=3.1761, loss=0.1844, param_norm=1886.6272
Step 743: grad_norm=2.4497, loss=0.1501, param_norm=1886.6272
Step 744: grad_norm=6.1155, loss=0.1282, param_norm=1886.6272
Step 745: grad_norm=3.6606, loss=0.1607, param_norm=1886.6272
Step 746: grad_norm=3.5985, loss=0.1516, param_norm=1886.6273
Step 747: grad_norm=4.9627, loss=0.1353, param_norm=1886.6273
Step 748: grad_norm=2.6352, loss=0.1549, param_norm=1886.6273
Step 749: grad_norm=2.8765, loss=0.1672, param_norm=1886.6274
22:35:35.108 [I] Progress on: 749it/1.00kit rate:1.1s/it remaining:04:33 elapsed:14:15 postfix:-  (3498206:tqdm_logging.py:145)
Step 750: grad_norm=3.5978, loss=0.2039, param_norm=1886.6274
Step 751: grad_norm=2.9039, loss=0.1518, param_norm=1886.6274
Step 752: grad_norm=5.6680, loss=0.1387, param_norm=1886.6274
Step 753: grad_norm=4.2603, loss=0.1997, param_norm=1886.6274
Step 754: grad_norm=4.0126, loss=0.1897, param_norm=1886.6274
Step 755: grad_norm=3.1743, loss=0.1581, param_norm=1886.6276
Step 756: grad_norm=4.3134, loss=0.1644, param_norm=1886.6276
Step 757: grad_norm=2.2159, loss=0.1464, param_norm=1886.6276
Step 758: grad_norm=2.6748, loss=0.1481, param_norm=1886.6277
Step 759: grad_norm=2.3737, loss=0.1097, param_norm=1886.6277
22:35:46.073 [I] Progress on: 759it/1.00kit rate:1.1s/it remaining:04:24 elapsed:14:26 postfix:-  (3498206:tqdm_logging.py:145)
Step 760: grad_norm=2.1665, loss=0.1291, param_norm=1886.6277
Step 761: grad_norm=3.1261, loss=0.1608, param_norm=1886.6278
Step 762: grad_norm=7.1764, loss=0.1989, param_norm=1886.6278
Step 763: grad_norm=6.3206, loss=0.1585, param_norm=1886.6279
Step 764: grad_norm=2.9033, loss=0.1669, param_norm=1886.6278
Step 765: grad_norm=3.9958, loss=0.2146, param_norm=1886.6279
Step 766: grad_norm=3.2907, loss=0.1897, param_norm=1886.6279
Step 767: grad_norm=2.6907, loss=0.1534, param_norm=1886.6279
Step 768: grad_norm=2.6209, loss=0.1484, param_norm=1886.6281
Step 769: grad_norm=6.2005, loss=0.1592, param_norm=1886.6281
22:35:56.959 [I] Progress on: 769it/1.00kit rate:1.1s/it remaining:04:11 elapsed:14:36 postfix:-  (3498206:tqdm_logging.py:145)
Step 770: grad_norm=2.5047, loss=0.1788, param_norm=1886.6281
Step 771: grad_norm=3.0714, loss=0.1309, param_norm=1886.6282
Step 772: grad_norm=2.7854, loss=0.1916, param_norm=1886.6282
Step 773: grad_norm=6.2663, loss=0.1609, param_norm=1886.6282
Step 774: grad_norm=2.8197, loss=0.1643, param_norm=1886.6282
Step 775: grad_norm=3.3399, loss=0.1550, param_norm=1886.6283
Step 776: grad_norm=3.7650, loss=0.1959, param_norm=1886.6282
Step 777: grad_norm=3.6512, loss=0.1264, param_norm=1886.6283
Step 778: grad_norm=2.4914, loss=0.1522, param_norm=1886.6283
Step 779: grad_norm=4.2386, loss=0.1609, param_norm=1886.6283
22:36:07.844 [I] Progress on: 779it/1.00kit rate:1.1s/it remaining:04:00 elapsed:14:47 postfix:-  (3498206:tqdm_logging.py:145)
Step 780: grad_norm=3.1072, loss=0.1593, param_norm=1886.6283
Step 781: grad_norm=2.7243, loss=0.1684, param_norm=1886.6284
Step 782: grad_norm=3.0139, loss=0.1531, param_norm=1886.6283
Step 783: grad_norm=2.5739, loss=0.1507, param_norm=1886.6284
Step 784: grad_norm=5.7292, loss=0.1349, param_norm=1886.6284
Step 785: grad_norm=2.8857, loss=0.1633, param_norm=1886.6284
Step 786: grad_norm=3.1148, loss=0.1617, param_norm=1886.6285
Step 787: grad_norm=3.4307, loss=0.1766, param_norm=1886.6285
Step 788: grad_norm=4.2447, loss=0.1568, param_norm=1886.6285
Step 789: grad_norm=2.9128, loss=0.1386, param_norm=1886.6285
22:36:18.747 [I] Progress on: 789it/1.00kit rate:1.1s/it remaining:03:50 elapsed:14:58 postfix:-  (3498206:tqdm_logging.py:145)
Step 790: grad_norm=3.2762, loss=0.1139, param_norm=1886.6288
Step 791: grad_norm=2.5538, loss=0.1444, param_norm=1886.6285
Step 792: grad_norm=2.5495, loss=0.1252, param_norm=1886.6288
Step 793: grad_norm=2.9644, loss=0.1709, param_norm=1886.6288
Step 794: grad_norm=2.8736, loss=0.1689, param_norm=1886.6288
Step 795: grad_norm=3.7529, loss=0.1453, param_norm=1886.6288
Step 796: grad_norm=3.6051, loss=0.1105, param_norm=1886.6289
Step 797: grad_norm=3.5770, loss=0.1911, param_norm=1886.6289
Step 798: grad_norm=2.2673, loss=0.1336, param_norm=1886.6289
Step 799: grad_norm=3.2047, loss=0.1925, param_norm=1886.6289
22:36:29.697 [I] Progress on: 799it/1.00kit rate:1.1s/it remaining:03:39 elapsed:15:09 postfix:-  (3498206:tqdm_logging.py:145)
Step 800: grad_norm=3.7703, loss=0.1888, param_norm=1886.6289
22:36:30.822 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:36:30.822 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:36:30.822 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (3498206:checkpoint_manager.py:1786)
22:36:30.822 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (3498206:checkpoint_manager.py:1817)
22:36:30.823 [I] [process=0] Saving checkpoint at step 800                                        (3498206:checkpoint_manager.py:1286)
22:36:30.823 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800. (3498206:async_checkpointer.py:358)
22:36:30.824 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:36:30.825 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21 (3498206:atomicity.py:144)
22:36:30.826 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:36:30.826 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:36:30.829 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (3498206:atomicity.py:144)
22:36:30.829 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (3498206:atomicity.py:144)
22:36:30.830 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:36:30.835 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:36:34.516 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:36:34.517 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:36:34.518 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:36:34.519 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:36:34.530 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.533 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.533 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.534 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:29:00.156752+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.534 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:30:53.353234+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.538 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:32:47.086503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.542 [I] Preserving Checkpoint[step=700 | time=2025-03-24 02:34:41.248888+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:36:34.544 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:36:34.545 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:36:34.547 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:36:34.548 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783790.822178, 'wait_for_prev_duration_secs': 0.0008203983306884766, 'checkpointer_blocking_start_time': 1742783790.8235438, 'checkpointer_blocking_duration_secs': 3.7067384719848633, 'get_old_steps_start_time': 1742783794.5303268, 'get_old_steps_duration_secs': 0.014420747756958008, 'checkpoint_manager_blocking_start_time': 1742783790.8220897, 'checkpoint_manager_blocking_duration_secs': 3.7261269092559814} (3498206:standard_logger.py:34)
Step 801: grad_norm=5.4798, loss=0.1328, param_norm=1886.6290
Step 802: grad_norm=2.8732, loss=0.1561, param_norm=1886.6290
Step 803: grad_norm=3.1753, loss=0.1946, param_norm=1886.6290
Step 804: grad_norm=3.6016, loss=0.1510, param_norm=1886.6290
Step 805: grad_norm=4.1613, loss=0.1646, param_norm=1886.6290
22:36:39.983 [I] Progress on: 805it/1.00kit rate:1.4s/it remaining:04:25 elapsed:15:19 postfix:-  (3498206:tqdm_logging.py:145)
Step 806: grad_norm=3.3342, loss=0.1265, param_norm=1886.6290
Step 807: grad_norm=3.1954, loss=0.1654, param_norm=1886.6290
22:36:42.393 [I] ChainedFuture completed 1/1 futures in 7.87 seconds.                             (3498206:future.py:137)
22:36:42.394 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 896.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:36:42.394 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:36:42.395 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21 (3498206:async_checkpointer.py:406)
22:36:42.395 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21/assets (3498206:atomicity.py:287)
22:36:42.406 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21/params (3498206:atomicity.py:287)
22:36:42.407 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800 (3498206:async_checkpointer.py:416)
22:36:42.407 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21 (3498206:async_checkpointer.py:426)
22:36:42.408 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800 (3498206:atomicity.py:287)
22:36:42.410 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/800`. (3498206:atomicity.py:548)
22:36:42.410 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:36:42.410 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:36:42.411 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:36:42.411 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:36:42.411 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 808: grad_norm=2.9947, loss=0.1610, param_norm=1886.6290
Step 809: grad_norm=2.7151, loss=0.1464, param_norm=1886.6290
Step 810: grad_norm=3.4137, loss=0.1699, param_norm=1886.6292
Step 811: grad_norm=2.9495, loss=0.1898, param_norm=1886.6290
Step 812: grad_norm=2.9836, loss=0.1401, param_norm=1886.6292
Step 813: grad_norm=2.4716, loss=0.1400, param_norm=1886.6292
Step 814: grad_norm=1.9754, loss=0.1210, param_norm=1886.6292
22:36:50.192 [I] Progress on: 814it/1.00kit rate:1.2s/it remaining:03:46 elapsed:15:30 postfix:-  (3498206:tqdm_logging.py:145)
Step 815: grad_norm=1.9790, loss=0.1104, param_norm=1886.6292
Step 816: grad_norm=3.6765, loss=0.1174, param_norm=1886.6292
Step 817: grad_norm=2.3639, loss=0.1116, param_norm=1886.6292
Step 818: grad_norm=2.1718, loss=0.1154, param_norm=1886.6292
Step 819: grad_norm=3.4699, loss=0.1297, param_norm=1886.6292
Step 820: grad_norm=2.7112, loss=0.1361, param_norm=1886.6292
Step 821: grad_norm=2.4393, loss=0.1188, param_norm=1886.6293
Step 822: grad_norm=2.1508, loss=0.1287, param_norm=1886.6293
Step 823: grad_norm=2.1164, loss=0.1216, param_norm=1886.6293
Step 824: grad_norm=2.7890, loss=0.1209, param_norm=1886.6293
22:37:01.059 [I] Progress on: 824it/1.00kit rate:1.1s/it remaining:03:12 elapsed:15:41 postfix:-  (3498206:tqdm_logging.py:145)
Step 825: grad_norm=2.0987, loss=0.1007, param_norm=1886.6293
Step 826: grad_norm=2.2963, loss=0.1247, param_norm=1886.6293
Step 827: grad_norm=3.0171, loss=0.1214, param_norm=1886.6293
Step 828: grad_norm=3.2837, loss=0.1194, param_norm=1886.6294
Step 829: grad_norm=3.2647, loss=0.1434, param_norm=1886.6294
Step 830: grad_norm=4.0233, loss=0.1456, param_norm=1886.6294
Step 831: grad_norm=2.5168, loss=0.1061, param_norm=1886.6294
Step 832: grad_norm=2.6444, loss=0.1375, param_norm=1886.6294
Step 833: grad_norm=1.8937, loss=0.1041, param_norm=1886.6294
22:37:11.233 [I] Progress on: 833it/1.00kit rate:1.1s/it remaining:03:02 elapsed:15:51 postfix:-  (3498206:tqdm_logging.py:145)
Step 834: grad_norm=2.5758, loss=0.1233, param_norm=1886.6294
Step 835: grad_norm=4.7805, loss=0.1342, param_norm=1886.6294
Step 836: grad_norm=2.4927, loss=0.1589, param_norm=1886.6295
Step 837: grad_norm=2.9639, loss=0.1087, param_norm=1886.6295
Step 838: grad_norm=4.4625, loss=0.1084, param_norm=1886.6295
Step 839: grad_norm=3.3073, loss=0.1085, param_norm=1886.6295
Step 840: grad_norm=2.8851, loss=0.1175, param_norm=1886.6296
Step 841: grad_norm=2.4699, loss=0.1302, param_norm=1886.6296
Step 842: grad_norm=2.6495, loss=0.1186, param_norm=1886.6296
Step 843: grad_norm=2.2190, loss=0.1109, param_norm=1886.6296
22:37:22.145 [I] Progress on: 843it/1.00kit rate:1.1s/it remaining:02:51 elapsed:16:02 postfix:-  (3498206:tqdm_logging.py:145)
Step 844: grad_norm=2.3283, loss=0.1199, param_norm=1886.6296
Step 845: grad_norm=2.4438, loss=0.1254, param_norm=1886.6296
Step 846: grad_norm=2.5407, loss=0.1285, param_norm=1886.6296
Step 847: grad_norm=2.9110, loss=0.1587, param_norm=1886.6296
Step 848: grad_norm=2.8233, loss=0.1543, param_norm=1886.6296
Step 849: grad_norm=2.3481, loss=0.1103, param_norm=1886.6298
Step 850: grad_norm=2.1760, loss=0.1275, param_norm=1886.6298
Step 851: grad_norm=2.5251, loss=0.1047, param_norm=1886.6298
Step 852: grad_norm=2.9364, loss=0.0911, param_norm=1886.6298
Step 853: grad_norm=2.2324, loss=0.1377, param_norm=1886.6298
22:37:33.036 [I] Progress on: 853it/1.00kit rate:1.1s/it remaining:02:40 elapsed:16:13 postfix:-  (3498206:tqdm_logging.py:145)
Step 854: grad_norm=2.1459, loss=0.1220, param_norm=1886.6298
Step 855: grad_norm=2.6062, loss=0.1110, param_norm=1886.6298
Step 856: grad_norm=2.5223, loss=0.1074, param_norm=1886.6298
Step 857: grad_norm=3.4174, loss=0.1060, param_norm=1886.6298
Step 858: grad_norm=2.1240, loss=0.1052, param_norm=1886.6299
Step 859: grad_norm=2.0118, loss=0.1056, param_norm=1886.6299
Step 860: grad_norm=1.8665, loss=0.1028, param_norm=1886.6299
Step 861: grad_norm=3.1458, loss=0.1003, param_norm=1886.6299
Step 862: grad_norm=2.2270, loss=0.1037, param_norm=1886.6299
Step 863: grad_norm=2.0137, loss=0.1304, param_norm=1886.6300
22:37:43.950 [I] Progress on: 863it/1.00kit rate:1.1s/it remaining:02:29 elapsed:16:23 postfix:-  (3498206:tqdm_logging.py:145)
Step 864: grad_norm=2.1110, loss=0.1117, param_norm=1886.6300
Step 865: grad_norm=4.0687, loss=0.1189, param_norm=1886.6300
Step 866: grad_norm=2.6077, loss=0.1139, param_norm=1886.6300
Step 867: grad_norm=4.6321, loss=0.1256, param_norm=1886.6300
Step 868: grad_norm=4.8266, loss=0.1048, param_norm=1886.6301
Step 869: grad_norm=4.0650, loss=0.1217, param_norm=1886.6301
Step 870: grad_norm=3.2078, loss=0.1412, param_norm=1886.6301
Step 871: grad_norm=1.9413, loss=0.1062, param_norm=1886.6302
Step 872: grad_norm=3.0483, loss=0.1192, param_norm=1886.6301
Step 873: grad_norm=2.8307, loss=0.1220, param_norm=1886.6301
22:37:54.839 [I] Progress on: 873it/1.00kit rate:1.1s/it remaining:02:17 elapsed:16:34 postfix:-  (3498206:tqdm_logging.py:145)
Step 874: grad_norm=2.0978, loss=0.0996, param_norm=1886.6302
Step 875: grad_norm=2.0861, loss=0.1070, param_norm=1886.6302
Step 876: grad_norm=2.1760, loss=0.1229, param_norm=1886.6302
Step 877: grad_norm=3.3822, loss=0.1046, param_norm=1886.6302
Step 878: grad_norm=2.7782, loss=0.1097, param_norm=1886.6302
Step 879: grad_norm=4.3765, loss=0.1114, param_norm=1886.6302
Step 880: grad_norm=2.1906, loss=0.1115, param_norm=1886.6302
Step 881: grad_norm=3.2654, loss=0.1298, param_norm=1886.6302
Step 882: grad_norm=2.0501, loss=0.1391, param_norm=1886.6302
Step 883: grad_norm=2.0922, loss=0.1115, param_norm=1886.6304
22:38:05.733 [I] Progress on: 883it/1.00kit rate:1.1s/it remaining:02:07 elapsed:16:45 postfix:-  (3498206:tqdm_logging.py:145)
Step 884: grad_norm=4.2365, loss=0.1312, param_norm=1886.6304
Step 885: grad_norm=2.3270, loss=0.0960, param_norm=1886.6304
Step 886: grad_norm=2.0934, loss=0.1080, param_norm=1886.6304
Step 887: grad_norm=1.6621, loss=0.0938, param_norm=1886.6304
Step 888: grad_norm=1.7052, loss=0.0631, param_norm=1886.6305
Step 889: grad_norm=2.0373, loss=0.0998, param_norm=1886.6305
Step 890: grad_norm=2.4294, loss=0.1016, param_norm=1886.6305
Step 891: grad_norm=3.2199, loss=0.0872, param_norm=1886.6305
Step 892: grad_norm=1.8761, loss=0.1085, param_norm=1886.6305
22:38:15.986 [I] Progress on: 892it/1.00kit rate:1.1s/it remaining:02:00 elapsed:16:56 postfix:-  (3498206:tqdm_logging.py:145)
Step 893: grad_norm=1.7443, loss=0.1032, param_norm=1886.6305
Step 894: grad_norm=2.4292, loss=0.0807, param_norm=1886.6305
Step 895: grad_norm=2.2623, loss=0.1004, param_norm=1886.6306
Step 896: grad_norm=1.5909, loss=0.0852, param_norm=1886.6306
Step 897: grad_norm=2.5315, loss=0.1234, param_norm=1886.6305
Step 898: grad_norm=1.6622, loss=0.0801, param_norm=1886.6306
Step 899: grad_norm=2.1743, loss=0.0766, param_norm=1886.6306
Step 900: grad_norm=1.8344, loss=0.0914, param_norm=1886.6306
22:38:24.723 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:38:24.723 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:38:24.724 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (3498206:checkpoint_manager.py:1786)
22:38:24.724 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (3498206:checkpoint_manager.py:1817)
22:38:24.725 [I] [process=0] Saving checkpoint at step 900                                        (3498206:checkpoint_manager.py:1286)
22:38:24.725 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900. (3498206:async_checkpointer.py:358)
22:38:24.727 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:38:24.728 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24 (3498206:atomicity.py:144)
22:38:24.729 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:38:24.729 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:38:24.730 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (3498206:atomicity.py:144)
22:38:24.730 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (3498206:atomicity.py:144)
22:38:24.731 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:38:24.736 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:38:28.401 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:38:28.402 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:38:28.404 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:38:28.406 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:38:28.433 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.434 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.436 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.437 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:29:00.156752+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.449 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:30:53.353234+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.454 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:32:47.086503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.454 [I] Preserving Checkpoint[step=700 | time=2025-03-24 02:34:41.248888+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.458 [I] Preserving Checkpoint[step=800 | time=2025-03-24 02:36:34.530296+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:38:28.459 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:38:28.460 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:38:28.464 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:38:28.464 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783904.7235029, 'wait_for_prev_duration_secs': 0.0008268356323242188, 'checkpointer_blocking_start_time': 1742783904.7251658, 'checkpointer_blocking_duration_secs': 3.7079286575317383, 'get_old_steps_start_time': 1742783908.4331508, 'get_old_steps_duration_secs': 0.026462554931640625, 'checkpoint_manager_blocking_start_time': 1742783904.7232864, 'checkpoint_manager_blocking_duration_secs': 3.7414262294769287} (3498206:standard_logger.py:34)
22:38:28.469 [I] Progress on: 901it/1.00kit rate:2.2s/it remaining:03:39 elapsed:17:08 postfix:-  (3498206:tqdm_logging.py:145)
Step 901: grad_norm=2.1741, loss=0.0931, param_norm=1886.6306
Step 902: grad_norm=2.7690, loss=0.1009, param_norm=1886.6306
Step 903: grad_norm=1.8615, loss=0.0981, param_norm=1886.6306
Step 904: grad_norm=2.8225, loss=0.0841, param_norm=1886.6306
Step 905: grad_norm=1.7319, loss=0.0815, param_norm=1886.6306
Step 906: grad_norm=2.1529, loss=0.0847, param_norm=1886.6307
22:38:35.721 [I] ChainedFuture completed 1/1 futures in 7.30 seconds.                             (3498206:future.py:137)
22:38:35.721 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 942.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:38:35.722 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:38:35.723 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24 (3498206:async_checkpointer.py:406)
22:38:35.723 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24/assets (3498206:atomicity.py:287)
22:38:35.734 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24/params (3498206:atomicity.py:287)
22:38:35.734 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900 (3498206:async_checkpointer.py:416)
22:38:35.735 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24 (3498206:async_checkpointer.py:426)
22:38:35.735 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900 (3498206:atomicity.py:287)
22:38:35.737 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/900`. (3498206:atomicity.py:548)
22:38:35.737 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:38:35.737 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:38:35.738 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:38:35.738 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:38:35.738 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
Step 907: grad_norm=2.5555, loss=0.1014, param_norm=1886.6307
Step 908: grad_norm=1.8270, loss=0.0978, param_norm=1886.6307
Step 909: grad_norm=2.2428, loss=0.0888, param_norm=1886.6307
Step 910: grad_norm=1.6916, loss=0.0713, param_norm=1886.6307
22:38:39.421 [I] Progress on: 910it/1.00kit rate:1.1s/it remaining:01:42 elapsed:17:19 postfix:-  (3498206:tqdm_logging.py:145)
Step 911: grad_norm=2.7382, loss=0.0649, param_norm=1886.6307
Step 912: grad_norm=2.1798, loss=0.1208, param_norm=1886.6307
Step 913: grad_norm=1.9677, loss=0.0939, param_norm=1886.6307
Step 914: grad_norm=3.4550, loss=0.0770, param_norm=1886.6307
Step 915: grad_norm=2.2051, loss=0.1006, param_norm=1886.6309
Step 916: grad_norm=2.4110, loss=0.1145, param_norm=1886.6309
Step 917: grad_norm=1.6391, loss=0.0895, param_norm=1886.6309
Step 918: grad_norm=3.6710, loss=0.1087, param_norm=1886.6309
Step 919: grad_norm=3.4820, loss=0.0846, param_norm=1886.6309
Step 920: grad_norm=1.8961, loss=0.1130, param_norm=1886.6309
22:38:50.315 [I] Progress on: 920it/1.00kit rate:1.1s/it remaining:01:27 elapsed:17:30 postfix:-  (3498206:tqdm_logging.py:145)
Step 921: grad_norm=2.1658, loss=0.1147, param_norm=1886.6309
Step 922: grad_norm=2.2626, loss=0.1060, param_norm=1886.6309
Step 923: grad_norm=1.6210, loss=0.0819, param_norm=1886.6309
Step 924: grad_norm=1.8627, loss=0.1060, param_norm=1886.6309
Step 925: grad_norm=2.6009, loss=0.1174, param_norm=1886.6309
Step 926: grad_norm=1.9119, loss=0.1015, param_norm=1886.6309
Step 927: grad_norm=1.6204, loss=0.0917, param_norm=1886.6309
Step 928: grad_norm=2.7243, loss=0.0917, param_norm=1886.6309
Step 929: grad_norm=1.8452, loss=0.0916, param_norm=1886.6309
Step 930: grad_norm=4.8758, loss=0.0902, param_norm=1886.6310
22:39:01.274 [I] Progress on: 930it/1.00kit rate:1.1s/it remaining:01:16 elapsed:17:41 postfix:-  (3498206:tqdm_logging.py:145)
Step 931: grad_norm=3.3865, loss=0.1053, param_norm=1886.6310
Step 932: grad_norm=2.1193, loss=0.0986, param_norm=1886.6310
Step 933: grad_norm=2.2274, loss=0.0904, param_norm=1886.6310
Step 934: grad_norm=4.9421, loss=0.1016, param_norm=1886.6310
Step 935: grad_norm=3.4535, loss=0.0903, param_norm=1886.6310
Step 936: grad_norm=2.2508, loss=0.0908, param_norm=1886.6310
Step 937: grad_norm=2.0509, loss=0.1076, param_norm=1886.6310
Step 938: grad_norm=1.7743, loss=0.0854, param_norm=1886.6310
Step 939: grad_norm=1.9513, loss=0.1132, param_norm=1886.6310
Step 940: grad_norm=2.4985, loss=0.0898, param_norm=1886.6311
22:39:12.222 [I] Progress on: 940it/1.00kit rate:1.1s/it remaining:01:05 elapsed:17:52 postfix:-  (3498206:tqdm_logging.py:145)
Step 941: grad_norm=2.9761, loss=0.1192, param_norm=1886.6311
Step 942: grad_norm=2.4094, loss=0.1162, param_norm=1886.6311
Step 943: grad_norm=4.0306, loss=0.0887, param_norm=1886.6311
Step 944: grad_norm=2.2490, loss=0.1184, param_norm=1886.6311
Step 945: grad_norm=3.2024, loss=0.0899, param_norm=1886.6311
Step 946: grad_norm=2.0451, loss=0.0780, param_norm=1886.6311
Step 947: grad_norm=4.3988, loss=0.0986, param_norm=1886.6311
Step 948: grad_norm=2.0439, loss=0.1077, param_norm=1886.6311
Step 949: grad_norm=1.6295, loss=0.0908, param_norm=1886.6311
Step 950: grad_norm=1.3610, loss=0.0649, param_norm=1886.6311
22:39:23.128 [I] Progress on: 950it/1.00kit rate:1.1s/it remaining:00:54 elapsed:18:03 postfix:-  (3498206:tqdm_logging.py:145)
Step 951: grad_norm=1.1918, loss=0.0602, param_norm=1886.6311
Step 952: grad_norm=2.4843, loss=0.1136, param_norm=1886.6311
Step 953: grad_norm=3.3398, loss=0.0881, param_norm=1886.6311
Step 954: grad_norm=2.0873, loss=0.0891, param_norm=1886.6311
Step 955: grad_norm=2.5733, loss=0.0822, param_norm=1886.6311
Step 956: grad_norm=1.6102, loss=0.0877, param_norm=1886.6311
Step 957: grad_norm=2.0267, loss=0.1003, param_norm=1886.6311
Step 958: grad_norm=2.6821, loss=0.0898, param_norm=1886.6311
Step 959: grad_norm=2.8730, loss=0.0958, param_norm=1886.6312
22:39:33.290 [I] Progress on: 959it/1.00kit rate:1.1s/it remaining:00:45 elapsed:18:13 postfix:-  (3498206:tqdm_logging.py:145)
Step 960: grad_norm=1.5984, loss=0.0808, param_norm=1886.6312
Step 961: grad_norm=2.8221, loss=0.0922, param_norm=1886.6313
Step 962: grad_norm=1.7217, loss=0.0687, param_norm=1886.6312
Step 963: grad_norm=1.6347, loss=0.0739, param_norm=1886.6312
Step 964: grad_norm=2.7373, loss=0.0753, param_norm=1886.6312
Step 965: grad_norm=1.5486, loss=0.0735, param_norm=1886.6313
Step 966: grad_norm=1.6385, loss=0.0779, param_norm=1886.6313
Step 967: grad_norm=1.7529, loss=0.0586, param_norm=1886.6313
Step 968: grad_norm=2.1082, loss=0.1084, param_norm=1886.6313
22:39:43.482 [I] Progress on: 968it/1.00kit rate:1.1s/it remaining:00:35 elapsed:18:23 postfix:-  (3498206:tqdm_logging.py:145)
Step 969: grad_norm=2.1277, loss=0.0782, param_norm=1886.6313
Step 970: grad_norm=1.9028, loss=0.0992, param_norm=1886.6313
Step 971: grad_norm=1.6695, loss=0.0971, param_norm=1886.6313
Step 972: grad_norm=1.6708, loss=0.0908, param_norm=1886.6313
Step 973: grad_norm=1.7067, loss=0.0760, param_norm=1886.6313
Step 974: grad_norm=1.7771, loss=0.0849, param_norm=1886.6313
Step 975: grad_norm=1.6504, loss=0.0802, param_norm=1886.6313
Step 976: grad_norm=1.4918, loss=0.0800, param_norm=1886.6313
Step 977: grad_norm=2.0904, loss=0.0970, param_norm=1886.6313
Step 978: grad_norm=1.4438, loss=0.0677, param_norm=1886.6313
22:39:54.388 [I] Progress on: 978it/1.00kit rate:1.1s/it remaining:00:24 elapsed:18:34 postfix:-  (3498206:tqdm_logging.py:145)
Step 979: grad_norm=2.1573, loss=0.0809, param_norm=1886.6313
Step 980: grad_norm=2.5806, loss=0.0696, param_norm=1886.6313
Step 981: grad_norm=2.0268, loss=0.0725, param_norm=1886.6315
Step 982: grad_norm=2.0000, loss=0.0779, param_norm=1886.6315
Step 983: grad_norm=3.3533, loss=0.0751, param_norm=1886.6315
Step 984: grad_norm=1.6677, loss=0.0726, param_norm=1886.6315
Step 985: grad_norm=2.9044, loss=0.0778, param_norm=1886.6315
Step 986: grad_norm=1.8583, loss=0.0997, param_norm=1886.6315
Step 987: grad_norm=1.5692, loss=0.0652, param_norm=1886.6315
Step 988: grad_norm=1.6755, loss=0.0846, param_norm=1886.6315
22:40:05.370 [I] Progress on: 988it/1.00kit rate:1.1s/it remaining:00:13 elapsed:18:45 postfix:-  (3498206:tqdm_logging.py:145)
Step 989: grad_norm=1.1349, loss=0.0539, param_norm=1886.6315
Step 990: grad_norm=2.2561, loss=0.0729, param_norm=1886.6315
Step 991: grad_norm=1.6078, loss=0.0842, param_norm=1886.6315
Step 992: grad_norm=2.2014, loss=0.0670, param_norm=1886.6315
Step 993: grad_norm=2.3633, loss=0.1075, param_norm=1886.6315
Step 994: grad_norm=2.1153, loss=0.0833, param_norm=1886.6315
Step 995: grad_norm=3.7496, loss=0.0963, param_norm=1886.6316
Step 996: grad_norm=3.3903, loss=0.1022, param_norm=1886.6316
Step 997: grad_norm=2.0460, loss=0.0810, param_norm=1886.6316
Step 998: grad_norm=1.9278, loss=0.0726, param_norm=1886.6316
22:40:16.273 [I] Progress on: 998it/1.00kit rate:1.1s/it remaining:00:02 elapsed:18:56 postfix:-  (3498206:tqdm_logging.py:145)
Step 999: grad_norm=1.5162, loss=0.0677, param_norm=1886.6316
22:40:17.393 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:40:17.393 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:40:17.394 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (3498206:checkpoint_manager.py:1786)
22:40:17.394 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (3498206:checkpoint_manager.py:1817)
22:40:17.394 [I] [process=0] Saving checkpoint at step 999                                        (3498206:checkpoint_manager.py:1286)
22:40:17.394 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999. (3498206:async_checkpointer.py:358)
22:40:17.395 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:40:17.396 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27 (3498206:atomicity.py:144)
22:40:17.396 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:40:17.397 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498206:multihost.py:293)
22:40:17.398 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (3498206:atomicity.py:144)
22:40:17.398 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (3498206:atomicity.py:144)
22:40:17.398 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498206:multihost.py:293)
22:40:17.403 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498206:replica_slices.py:419)
22:40:21.033 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498206:tensorstore_utils.py:371)
22:40:21.033 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:40:21.034 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498206:tensorstore_utils.py:371)
22:40:21.036 [I] [process=0][thread=async_save] Background save thread started.                   (3498206:async_checkpointer.py:121)
22:40:21.043 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:19.608049+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.045 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:12.907103+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.049 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:27:06.577200+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.060 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:29:00.156752+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.063 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:30:53.353234+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.065 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:32:47.086503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.071 [I] Preserving Checkpoint[step=700 | time=2025-03-24 02:34:41.248888+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.072 [I] Preserving Checkpoint[step=800 | time=2025-03-24 02:36:34.530296+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.075 [I] Preserving Checkpoint[step=900 | time=2025-03-24 02:38:28.433106+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498206:checkpoint_manager.py:1734)
22:40:21.076 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498206:multihost.py:293)
22:40:21.078 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (3498206:checkpoint_manager.py:1328)
22:40:21.083 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498206:async_checkpointer.py:231)
22:40:21.084 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742784017.393596, 'wait_for_prev_duration_secs': 0.0005655288696289062, 'checkpointer_blocking_start_time': 1742784017.3945038, 'checkpointer_blocking_duration_secs': 3.6487083435058594, 'get_old_steps_start_time': 1742784021.043254, 'get_old_steps_duration_secs': 0.03326582908630371, 'checkpoint_manager_blocking_start_time': 1742784017.3935473, 'checkpoint_manager_blocking_duration_secs': 3.691070079803467} (3498206:standard_logger.py:34)
22:40:21.088 [I] Progress on: 1.00kit/1.00kit rate:2.2s/it remaining:00:00 elapsed:19:01 postfix:- (3498206:tqdm_logging.py:145)
22:40:21.089 [I] Waiting for checkpoint manager to finish                                         (3498206:train.py:268)
22:40:21.089 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498206:checkpoint_manager.py:1759)
22:40:21.089 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498206:checkpoint_manager.py:1777)
22:40:27.864 [I] ChainedFuture completed 1/1 futures in 6.82 seconds.                             (3498206:future.py:137)
22:40:27.864 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 989.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (3498206:base_pytree_checkpoint_handler.py:113)
22:40:27.865 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498206:async_checkpointer.py:131)
22:40:27.866 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa336d6bc50> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27 (3498206:async_checkpointer.py:406)
22:40:27.866 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27/assets (3498206:atomicity.py:287)
22:40:27.877 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27/params (3498206:atomicity.py:287)
22:40:27.878 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999 (3498206:async_checkpointer.py:416)
22:40:27.878 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27 (3498206:async_checkpointer.py:426)
22:40:27.878 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999 (3498206:atomicity.py:287)
22:40:27.880 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate/999`. (3498206:atomicity.py:548)
22:40:27.880 [I] [process=0][thread=async_save] Background save thread done.                      (3498206:async_checkpointer.py:183)
22:40:27.881 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498206:async_checkpointer.py:239)
22:40:27.881 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498206:async_checkpointer.py:249)
22:40:27.882 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (3498206:checkpoint_manager.py:1890)
22:40:27.882 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (3498206:checkpoint_manager.py:1905)
22:40:27.882 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (3498206:checkpoint_manager.py:1786)
22:40:27.882 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (3498206:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_pi0_idli_plate[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/ah0sd6la[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250323_221902-ah0sd6la/logs[0m
