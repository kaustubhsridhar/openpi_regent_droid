nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
21:38:51.920 [I] Running on: ivy                                                                  (286420:train.py:195)
INFO:2025-03-24 21:38:52,767:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
21:38:52.767 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (286420:xla_bridge.py:945)
INFO:2025-03-24 21:38:52,769:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
21:38:52.769 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (286420:xla_bridge.py:945)
21:38:53.646 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (286420:base_pytree_checkpoint_handler.py:332)
21:38:53.647 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (286420:base_pytree_checkpoint_handler.py:332)
21:38:53.647 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (286420:multihost.py:375)
21:38:53.647 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7f574cbedcd0>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574ce60390>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574cc56b90>}, handler_registry=None (286420:checkpoint_manager.py:622)
21:38:53.648 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7f574cbedcd0>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (286420:composite_checkpoint_handler.py:239)
21:38:53.648 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574ce60390>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (286420:composite_checkpoint_handler.py:239)
21:38:53.648 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574cc56b90>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (286420:composite_checkpoint_handler.py:239)
21:38:53.648 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f574cacbc90>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (286420:composite_checkpoint_handler.py:239)
21:38:53.648 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f574cbedcd0>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f574cbedcd0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574ce60390>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574ce60390>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574cc56b90>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f574cc56b90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f574cacbc90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f574cacbc90>}). (286420:composite_checkpoint_handler.py:508)
21:38:53.648 [I] orbax-checkpoint version: 0.11.1                                                 (286420:abstract_checkpointer.py:35)
21:38:53.649 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f574cc5fec0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (286420:async_checkpointer.py:80)
21:38:53.649 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5 (286420:checkpoint_manager.py:1528)
21:38:53.649 [I] Saving root metadata                                                             (286420:checkpoint_manager.py:1569)
21:38:53.649 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (286420:multihost.py:293)
21:38:53.649 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f574cd13950> (286420:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250324_213853-fgyi901x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_pi0_idli_plate_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/fgyi901x
21:38:54.613 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid___finetune_on_idli_plate/droid (286420:config.py:167)
Some kwargs in processor config are unused and will not have any effect: vocab_size, scale, min_token, action_dim, time_horizon. 
Some kwargs in processor config are unused and will not have any effect: vocab_size, scale, min_token, action_dim, time_horizon. 
num states in collected demos given by count_collected_demos: 340
len_dataset: 340
num episodes: 5
common_prompt: move the idli plate to the right
21:39:14.231 [I] Initialized data loader:
[0].images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].images['wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (16,)@bool
[0].image_masks['base_1_rgb']: (16,)@bool
[0].image_masks['wrist_0_rgb']: (16,)@bool
[0].state: (16, 8)@float32
[0].tokenized_prompt: (16, 250)@int32
[0].tokenized_prompt_mask: (16, 250)@bool
[0].token_ar_mask: (16, 250)@int32
[0].token_loss_mask: (16, 250)@bool
[1]: (16, 10, 8)@float32 (286420:train.py:227)
21:39:15.286 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (286420:base_pytree_checkpoint_handler.py:332)
21:39:15.311 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (286420:checkpointer.py:256)
21:39:33.985 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 597.2 MiB/s (total bytes: 10.9 GiB) (time elapsed: 18 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:39:33.986 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (286420:checkpointer.py:259)
21:39:33.987 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (286420:multihost.py:293)
2025-03-24 21:45:15.995101: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 19.42GiB (20847081029 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
21:45:18.197 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (286420:train.py:231)
21:45:18.278 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (286420:tqdm_logging.py:145)
Step 0: grad_norm=12.0358, loss=3.2473, param_norm=1886.4708
Step 1: grad_norm=12.6182, loss=3.2949, param_norm=1886.4708
21:45:28.776 [I] Progress on: 1.00it/1.00kit rate:9.5s/it remaining:2:37:40 elapsed:00:10 postfix:- (286420:tqdm_logging.py:145)
Step 2: grad_norm=11.4411, loss=3.4694, param_norm=1886.4708
Step 3: grad_norm=11.6864, loss=3.1463, param_norm=1886.4708
Step 4: grad_norm=17.1779, loss=3.1008, param_norm=1886.4708
Step 5: grad_norm=12.8273, loss=3.2725, param_norm=1886.4708
Step 6: grad_norm=11.9743, loss=2.8598, param_norm=1886.4708
Step 7: grad_norm=11.4137, loss=2.9569, param_norm=1886.4707
Step 8: grad_norm=12.3518, loss=2.7470, param_norm=1886.4707
Step 9: grad_norm=9.7209, loss=2.6183, param_norm=1886.4706
Step 10: grad_norm=8.6069, loss=2.4736, param_norm=1886.4706
Step 11: grad_norm=8.1490, loss=2.7139, param_norm=1886.4706
21:45:39.437 [I] Progress on: 11.0it/1.00kit rate:1.1s/it remaining:18:45 elapsed:00:21 postfix:- (286420:tqdm_logging.py:145)
Step 12: grad_norm=9.1289, loss=2.4058, param_norm=1886.4706
Step 13: grad_norm=10.9233, loss=2.4248, param_norm=1886.4706
Step 14: grad_norm=18.6835, loss=2.2422, param_norm=1886.4706
Step 15: grad_norm=10.2117, loss=2.4004, param_norm=1886.4706
Step 16: grad_norm=9.9251, loss=2.2638, param_norm=1886.4706
Step 17: grad_norm=7.5478, loss=2.0786, param_norm=1886.4706
Step 18: grad_norm=8.7793, loss=2.2570, param_norm=1886.4706
Step 19: grad_norm=8.2922, loss=1.9205, param_norm=1886.4708
Step 20: grad_norm=9.3874, loss=1.9655, param_norm=1886.4708
21:45:49.491 [I] Progress on: 21.0it/1.00kit rate:1.2s/it remaining:19:29 elapsed:00:31 postfix:- (286420:tqdm_logging.py:145)
Step 21: grad_norm=8.0454, loss=2.0095, param_norm=1886.4708
Step 22: grad_norm=6.7565, loss=1.9057, param_norm=1886.4708
Step 23: grad_norm=5.9121, loss=1.7931, param_norm=1886.4708
Step 24: grad_norm=8.8967, loss=1.7337, param_norm=1886.4709
Step 25: grad_norm=7.5863, loss=1.7350, param_norm=1886.4711
Step 26: grad_norm=10.0670, loss=1.8566, param_norm=1886.4712
Step 27: grad_norm=12.0478, loss=1.7125, param_norm=1886.4712
Step 28: grad_norm=28.0406, loss=1.7326, param_norm=1886.4713
Step 29: grad_norm=8.7629, loss=1.5913, param_norm=1886.4716
Step 30: grad_norm=10.0598, loss=1.7287, param_norm=1886.4717
21:46:00.186 [I] Progress on: 30.0it/1.00kit rate:1.1s/it remaining:17:25 elapsed:00:41 postfix:- (286420:tqdm_logging.py:145)
Step 31: grad_norm=16.4758, loss=1.6559, param_norm=1886.4717
Step 32: grad_norm=7.1696, loss=1.7454, param_norm=1886.4719
Step 33: grad_norm=10.7605, loss=1.6922, param_norm=1886.4720
Step 34: grad_norm=10.9260, loss=1.5392, param_norm=1886.4722
Step 35: grad_norm=17.0322, loss=1.6253, param_norm=1886.4724
Step 36: grad_norm=6.9789, loss=1.7017, param_norm=1886.4725
Step 37: grad_norm=9.1473, loss=1.4127, param_norm=1886.4727
Step 38: grad_norm=6.5452, loss=1.8066, param_norm=1886.4729
Step 39: grad_norm=13.8348, loss=1.4478, param_norm=1886.4731
Step 40: grad_norm=11.9274, loss=1.4072, param_norm=1886.4734
21:46:10.943 [I] Progress on: 40.0it/1.00kit rate:1.1s/it remaining:17:09 elapsed:00:52 postfix:- (286420:tqdm_logging.py:145)
Step 41: grad_norm=7.4697, loss=1.4629, param_norm=1886.4736
Step 42: grad_norm=6.4729, loss=1.3269, param_norm=1886.4739
Step 43: grad_norm=8.1838, loss=1.3460, param_norm=1886.4741
Step 44: grad_norm=6.1342, loss=1.3341, param_norm=1886.4744
Step 45: grad_norm=13.4462, loss=1.3135, param_norm=1886.4747
Step 46: grad_norm=9.4122, loss=1.2069, param_norm=1886.4750
Step 47: grad_norm=7.0303, loss=1.4087, param_norm=1886.4755
Step 48: grad_norm=5.9031, loss=1.3130, param_norm=1886.4756
Step 49: grad_norm=8.7180, loss=1.2368, param_norm=1886.4761
21:46:21.059 [I] Progress on: 49.0it/1.00kit rate:1.1s/it remaining:17:12 elapsed:01:02 postfix:- (286420:tqdm_logging.py:145)
Step 50: grad_norm=6.2158, loss=1.0705, param_norm=1886.4764
Step 51: grad_norm=5.6485, loss=1.2282, param_norm=1886.4768
Step 52: grad_norm=6.1993, loss=1.1449, param_norm=1886.4773
Step 53: grad_norm=5.8137, loss=1.2251, param_norm=1886.4777
Step 54: grad_norm=7.7492, loss=1.1614, param_norm=1886.4780
Step 55: grad_norm=6.3715, loss=1.3574, param_norm=1886.4785
Step 56: grad_norm=11.7263, loss=1.2215, param_norm=1886.4789
Step 57: grad_norm=6.8686, loss=1.2744, param_norm=1886.4794
Step 58: grad_norm=7.3798, loss=1.2740, param_norm=1886.4797
Step 59: grad_norm=6.2242, loss=1.2304, param_norm=1886.4802
21:46:31.877 [I] Progress on: 59.0it/1.00kit rate:1.1s/it remaining:16:58 elapsed:01:13 postfix:- (286420:tqdm_logging.py:145)
Step 60: grad_norm=16.4280, loss=1.3160, param_norm=1886.4806
Step 61: grad_norm=13.1230, loss=1.4569, param_norm=1886.4811
Step 62: grad_norm=13.4524, loss=1.2269, param_norm=1886.4814
Step 63: grad_norm=11.8921, loss=1.0653, param_norm=1886.4818
Step 64: grad_norm=5.6103, loss=1.1476, param_norm=1886.4822
Step 65: grad_norm=10.5024, loss=1.1412, param_norm=1886.4825
Step 66: grad_norm=6.4984, loss=1.2129, param_norm=1886.4828
Step 67: grad_norm=6.2361, loss=1.1754, param_norm=1886.4833
Step 68: grad_norm=7.0915, loss=1.0617, param_norm=1886.4836
21:46:41.998 [I] Progress on: 68.0it/1.00kit rate:1.1s/it remaining:17:09 elapsed:01:23 postfix:- (286420:tqdm_logging.py:145)
Step 69: grad_norm=5.5898, loss=1.1737, param_norm=1886.4841
Step 70: grad_norm=6.3300, loss=1.0271, param_norm=1886.4844
Step 71: grad_norm=5.9284, loss=1.1573, param_norm=1886.4849
Step 72: grad_norm=6.2659, loss=1.0955, param_norm=1886.4851
Step 73: grad_norm=8.2825, loss=1.1380, param_norm=1886.4855
Step 74: grad_norm=7.4677, loss=0.9277, param_norm=1886.4858
Step 75: grad_norm=7.6157, loss=1.0469, param_norm=1886.4861
Step 76: grad_norm=5.2119, loss=0.9762, param_norm=1886.4866
Step 77: grad_norm=5.3698, loss=0.9344, param_norm=1886.4869
Step 78: grad_norm=5.3761, loss=0.9552, param_norm=1886.4872
21:46:52.877 [I] Progress on: 78.0it/1.00kit rate:1.1s/it remaining:16:43 elapsed:01:34 postfix:- (286420:tqdm_logging.py:145)
Step 79: grad_norm=14.2679, loss=1.0145, param_norm=1886.4875
Step 80: grad_norm=7.6102, loss=0.9933, param_norm=1886.4879
Step 81: grad_norm=6.4851, loss=0.9429, param_norm=1886.4882
Step 82: grad_norm=6.0889, loss=1.0446, param_norm=1886.4884
Step 83: grad_norm=8.5108, loss=0.9721, param_norm=1886.4888
Step 84: grad_norm=8.2738, loss=0.8198, param_norm=1886.4891
Step 85: grad_norm=6.7293, loss=0.7580, param_norm=1886.4895
Step 86: grad_norm=5.2031, loss=0.9026, param_norm=1886.4897
Step 87: grad_norm=6.0205, loss=0.8592, param_norm=1886.4902
21:47:03.069 [I] Progress on: 87.0it/1.00kit rate:1.1s/it remaining:17:09 elapsed:01:44 postfix:- (286420:tqdm_logging.py:145)
Step 88: grad_norm=4.4249, loss=0.7772, param_norm=1886.4905
Step 89: grad_norm=7.9875, loss=0.8266, param_norm=1886.4910
Step 90: grad_norm=12.9511, loss=0.8242, param_norm=1886.4913
Step 91: grad_norm=5.7484, loss=0.6875, param_norm=1886.4917
Step 92: grad_norm=9.4194, loss=0.8648, param_norm=1886.4921
Step 93: grad_norm=6.8746, loss=0.8001, param_norm=1886.4926
Step 94: grad_norm=6.2679, loss=0.9203, param_norm=1886.4929
Step 95: grad_norm=5.6137, loss=0.7936, param_norm=1886.4933
Step 96: grad_norm=4.7254, loss=0.7440, param_norm=1886.4935
Step 97: grad_norm=7.9487, loss=0.8141, param_norm=1886.4939
21:47:14.020 [I] Progress on: 97.0it/1.00kit rate:1.1s/it remaining:16:26 elapsed:01:55 postfix:- (286420:tqdm_logging.py:145)
Step 98: grad_norm=13.9060, loss=0.9246, param_norm=1886.4943
Step 99: grad_norm=8.2467, loss=0.8157, param_norm=1886.4946
Step 100: grad_norm=9.3608, loss=0.7779, param_norm=1886.4950
21:47:17.348 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286420:checkpoint_manager.py:1759)
21:47:17.349 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (286420:checkpoint_manager.py:1767)
21:47:17.350 [I] [process=0] Saving checkpoint at step 100                                        (286420:checkpoint_manager.py:1286)
21:47:17.351 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100. (286420:async_checkpointer.py:358)
21:47:17.353 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:47:17.354 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0 (286420:atomicity.py:144)
21:47:17.355 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:47:17.356 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:47:17.356 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742867237354703309, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742867237354703309, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (286420:checkpoint.py:185)
21:47:17.357 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (286420:atomicity.py:144)
21:47:17.358 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (286420:atomicity.py:144)
21:47:17.359 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:47:17.369 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286420:replica_slices.py:419)
21:47:21.130 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:47:21.137 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286420:tensorstore_utils.py:371)
21:47:21.139 [I] [process=0][thread=async_save] Background save thread started.                   (286420:async_checkpointer.py:121)
21:47:21.141 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286420:tensorstore_utils.py:371)
21:47:21.145 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286420:multihost.py:293)
21:47:21.147 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (286420:checkpoint_manager.py:1328)
21:47:21.174 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286420:async_checkpointer.py:231)
21:47:21.176 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742867237.3488233, 'wait_for_prev_duration_secs': 0.0006518363952636719, 'checkpointer_blocking_start_time': 1742867237.3506904, 'checkpointer_blocking_duration_secs': 3.7949728965759277, 'get_old_steps_start_time': 1742867241.1457827, 'get_old_steps_duration_secs': 2.002716064453125e-05, 'checkpoint_manager_blocking_start_time': 1742867237.3484218, 'checkpoint_manager_blocking_duration_secs': 3.8276469707489014} (286420:standard_logger.py:34)
Step 101: grad_norm=6.6747, loss=0.7661, param_norm=1886.4952
Step 102: grad_norm=14.6323, loss=0.7989, param_norm=1886.4957
Step 103: grad_norm=10.2196, loss=0.7656, param_norm=1886.4961
21:47:24.476 [I] Progress on: 103it/1.00kit rate:1.7s/it remaining:24:54 elapsed:02:06 postfix:-  (286420:tqdm_logging.py:145)
Step 104: grad_norm=6.2116, loss=0.8351, param_norm=1886.4965
Step 105: grad_norm=4.9751, loss=0.6570, param_norm=1886.4968
Step 106: grad_norm=5.7666, loss=0.5391, param_norm=1886.4973
21:47:28.691 [I] ChainedFuture completed 1/1 futures in 7.55 seconds.                             (286420:future.py:137)
21:47:28.691 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 914.3 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:47:28.692 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286420:async_checkpointer.py:131)
21:47:28.692 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742867237354703309, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (286420:checkpoint.py:225)
21:47:28.693 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f574cbedfd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0 (286420:async_checkpointer.py:406)
21:47:28.694 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/assets (286420:atomicity.py:287)
21:47:28.696 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742867237354703309, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (286420:checkpoint.py:244)
21:47:28.704 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0/params (286420:atomicity.py:287)
21:47:28.704 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100 (286420:async_checkpointer.py:416)
21:47:28.704 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0 (286420:async_checkpointer.py:426)
21:47:28.704 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100 (286420:atomicity.py:287)
21:47:28.705 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/100`. (286420:atomicity.py:548)
21:47:28.706 [I] [process=0][thread=async_save] Background save thread done.                      (286420:async_checkpointer.py:183)
21:47:28.706 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286420:async_checkpointer.py:239)
21:47:28.706 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286420:async_checkpointer.py:249)
21:47:28.707 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (286420:checkpoint_manager.py:1890)
21:47:28.707 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (286420:checkpoint_manager.py:1905)
Step 107: grad_norm=12.1053, loss=0.5907, param_norm=1886.4976
Step 108: grad_norm=5.0521, loss=0.5679, param_norm=1886.4979
Step 109: grad_norm=10.2645, loss=0.6045, param_norm=1886.4983
Step 110: grad_norm=6.8542, loss=0.5470, param_norm=1886.4988
Step 111: grad_norm=12.9096, loss=0.6896, param_norm=1886.4990
Step 112: grad_norm=4.6708, loss=0.6851, param_norm=1886.4994
21:47:34.705 [I] Progress on: 112it/1.00kit rate:1.1s/it remaining:16:40 elapsed:02:16 postfix:-  (286420:tqdm_logging.py:145)
Step 113: grad_norm=6.5585, loss=0.6503, param_norm=1886.4998
Step 114: grad_norm=5.7152, loss=0.6870, param_norm=1886.5002
Step 115: grad_norm=5.7231, loss=0.7191, param_norm=1886.5005
Step 116: grad_norm=12.1895, loss=0.5960, param_norm=1886.5010
Step 117: grad_norm=10.2620, loss=0.6175, param_norm=1886.5012
Step 118: grad_norm=9.7685, loss=0.6747, param_norm=1886.5017
Step 119: grad_norm=11.3693, loss=0.8051, param_norm=1886.5020
Step 120: grad_norm=5.6711, loss=0.6857, param_norm=1886.5023
Step 121: grad_norm=5.0605, loss=0.6415, param_norm=1886.5027
Step 122: grad_norm=6.0510, loss=0.6815, param_norm=1886.5031
21:47:45.688 [I] Progress on: 122it/1.00kit rate:1.1s/it remaining:16:02 elapsed:02:27 postfix:-  (286420:tqdm_logging.py:145)
Step 123: grad_norm=6.7719, loss=0.6291, param_norm=1886.5034
Step 124: grad_norm=7.3569, loss=0.6290, param_norm=1886.5038
Step 125: grad_norm=14.3093, loss=0.6894, param_norm=1886.5042
Step 126: grad_norm=5.0847, loss=0.5982, param_norm=1886.5044
Step 127: grad_norm=10.4933, loss=0.7009, param_norm=1886.5046
Step 128: grad_norm=7.1985, loss=0.5336, param_norm=1886.5050
Step 129: grad_norm=4.5640, loss=0.5662, param_norm=1886.5052
Step 130: grad_norm=3.9576, loss=0.4444, param_norm=1886.5056
Step 131: grad_norm=4.0411, loss=0.4714, param_norm=1886.5059
21:47:55.953 [I] Progress on: 131it/1.00kit rate:1.1s/it remaining:16:10 elapsed:02:37 postfix:-  (286420:tqdm_logging.py:145)
Step 132: grad_norm=6.5844, loss=0.4622, param_norm=1886.5061
Step 133: grad_norm=6.3847, loss=0.5858, param_norm=1886.5066
Step 134: grad_norm=6.2833, loss=0.5893, param_norm=1886.5070
Step 135: grad_norm=10.8626, loss=0.5358, param_norm=1886.5072
Step 136: grad_norm=5.6524, loss=0.6464, param_norm=1886.5076
Step 137: grad_norm=4.6526, loss=0.5603, param_norm=1886.5079
Step 138: grad_norm=6.3900, loss=0.6256, param_norm=1886.5083
Step 139: grad_norm=7.1020, loss=0.5162, param_norm=1886.5087
Step 140: grad_norm=7.6350, loss=0.5677, param_norm=1886.5090
Step 141: grad_norm=13.3163, loss=0.4902, param_norm=1886.5095
21:48:06.935 [I] Progress on: 141it/1.00kit rate:1.1s/it remaining:15:41 elapsed:02:48 postfix:-  (286420:tqdm_logging.py:145)
Step 142: grad_norm=7.8189, loss=0.5836, param_norm=1886.5098
Step 143: grad_norm=9.1334, loss=0.6304, param_norm=1886.5101
Step 144: grad_norm=11.0009, loss=0.6366, param_norm=1886.5105
Step 145: grad_norm=6.9433, loss=0.5661, param_norm=1886.5107
Step 146: grad_norm=5.1707, loss=0.6436, param_norm=1886.5112
Step 147: grad_norm=6.0583, loss=0.3871, param_norm=1886.5116
Step 148: grad_norm=4.8604, loss=0.4860, param_norm=1886.5120
Step 149: grad_norm=3.8475, loss=0.4108, param_norm=1886.5122
Step 150: grad_norm=4.5052, loss=0.4205, param_norm=1886.5126
21:48:17.211 [I] Progress on: 150it/1.00kit rate:1.1s/it remaining:16:05 elapsed:02:58 postfix:-  (286420:tqdm_logging.py:145)
Step 151: grad_norm=7.7155, loss=0.5207, param_norm=1886.5129
Step 152: grad_norm=5.3431, loss=0.5192, param_norm=1886.5132
Step 153: grad_norm=4.0402, loss=0.4232, param_norm=1886.5135
Step 154: grad_norm=13.8343, loss=0.5918, param_norm=1886.5138
Step 155: grad_norm=6.0013, loss=0.5253, param_norm=1886.5142
Step 156: grad_norm=6.8865, loss=0.5101, param_norm=1886.5145
Step 157: grad_norm=12.2417, loss=0.5594, param_norm=1886.5149
Step 158: grad_norm=4.3890, loss=0.4597, param_norm=1886.5151
Step 159: grad_norm=12.7898, loss=0.5859, param_norm=1886.5155
Step 160: grad_norm=7.4137, loss=0.5910, param_norm=1886.5159
21:48:28.165 [I] Progress on: 160it/1.00kit rate:1.1s/it remaining:15:21 elapsed:03:09 postfix:-  (286420:tqdm_logging.py:145)
Step 161: grad_norm=10.2711, loss=0.6116, param_norm=1886.5161
Step 162: grad_norm=6.1699, loss=0.5158, param_norm=1886.5165
Step 163: grad_norm=9.6980, loss=0.5205, param_norm=1886.5168
Step 164: grad_norm=5.8362, loss=0.4103, param_norm=1886.5172
Step 165: grad_norm=5.5797, loss=0.5901, param_norm=1886.5176
Step 166: grad_norm=4.5866, loss=0.4461, param_norm=1886.5178
Step 167: grad_norm=7.2837, loss=0.4819, param_norm=1886.5182
Step 168: grad_norm=5.8119, loss=0.3863, param_norm=1886.5186
Step 169: grad_norm=9.6943, loss=0.3764, param_norm=1886.5190
21:48:38.403 [I] Progress on: 169it/1.00kit rate:1.2s/it remaining:16:18 elapsed:03:20 postfix:-  (286420:tqdm_logging.py:145)
Step 170: grad_norm=5.7921, loss=0.4749, param_norm=1886.5193
Step 171: grad_norm=9.5751, loss=0.4845, param_norm=1886.5197
Step 172: grad_norm=10.7946, loss=0.5256, param_norm=1886.5199
Step 173: grad_norm=25.3610, loss=0.4161, param_norm=1886.5201
Step 174: grad_norm=6.2167, loss=0.4678, param_norm=1886.5206
Step 175: grad_norm=5.9025, loss=0.5730, param_norm=1886.5209
Step 176: grad_norm=7.7135, loss=0.4562, param_norm=1886.5211
Step 177: grad_norm=6.6666, loss=0.4806, param_norm=1886.5215
Step 178: grad_norm=5.3693, loss=0.4076, param_norm=1886.5219
Step 179: grad_norm=23.5536, loss=0.3831, param_norm=1886.5222
21:48:49.325 [I] Progress on: 179it/1.00kit rate:1.1s/it remaining:14:58 elapsed:03:31 postfix:-  (286420:tqdm_logging.py:145)
Step 180: grad_norm=24.9805, loss=0.5727, param_norm=1886.5225
Step 181: grad_norm=35.6918, loss=0.4483, param_norm=1886.5228
Step 182: grad_norm=8.7149, loss=0.4628, param_norm=1886.5232
Step 183: grad_norm=9.0054, loss=0.5581, param_norm=1886.5236
Step 184: grad_norm=4.7368, loss=0.4730, param_norm=1886.5238
Step 185: grad_norm=12.3089, loss=0.5986, param_norm=1886.5242
Step 186: grad_norm=5.1830, loss=0.4186, param_norm=1886.5244
Step 187: grad_norm=6.3995, loss=0.4879, param_norm=1886.5248
Step 188: grad_norm=4.5554, loss=0.3754, param_norm=1886.5251
21:48:59.586 [I] Progress on: 189it/1.00kit rate:1.2s/it remaining:16:27 elapsed:03:41 postfix:-  (286420:tqdm_logging.py:145)
Step 189: grad_norm=4.2032, loss=0.3353, param_norm=1886.5255
Step 190: grad_norm=13.4576, loss=0.5990, param_norm=1886.5259
Step 191: grad_norm=19.6059, loss=0.4207, param_norm=1886.5262
Step 192: grad_norm=14.1835, loss=0.5705, param_norm=1886.5267
Step 193: grad_norm=8.3756, loss=0.5311, param_norm=1886.5270
Step 194: grad_norm=4.9757, loss=0.5215, param_norm=1886.5275
Step 195: grad_norm=5.4283, loss=0.4830, param_norm=1886.5277
Step 196: grad_norm=5.9453, loss=0.5226, param_norm=1886.5282
Step 197: grad_norm=10.6112, loss=0.4433, param_norm=1886.5284
Step 198: grad_norm=6.9994, loss=0.4710, param_norm=1886.5288
21:49:10.434 [I] Progress on: 198it/1.00kit rate:1.1s/it remaining:14:35 elapsed:03:52 postfix:-  (286420:tqdm_logging.py:145)
Step 199: grad_norm=20.2053, loss=0.6620, param_norm=1886.5292
Step 200: grad_norm=9.2023, loss=0.4447, param_norm=1886.5294
21:49:12.645 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286420:checkpoint_manager.py:1759)
21:49:12.645 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286420:checkpoint_manager.py:1777)
21:49:12.645 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (286420:checkpoint_manager.py:1786)
21:49:12.645 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (286420:checkpoint_manager.py:1817)
21:49:12.646 [I] [process=0] Saving checkpoint at step 200                                        (286420:checkpoint_manager.py:1286)
21:49:12.646 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200. (286420:async_checkpointer.py:358)
21:49:12.647 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:49:12.647 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3 (286420:atomicity.py:144)
21:49:12.648 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:49:12.649 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:49:12.649 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (286420:atomicity.py:144)
21:49:12.650 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (286420:atomicity.py:144)
21:49:12.650 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:49:12.655 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286420:replica_slices.py:419)
21:49:16.071 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.0 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:49:16.076 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286420:tensorstore_utils.py:371)
21:49:16.078 [I] [process=0][thread=async_save] Background save thread started.                   (286420:async_checkpointer.py:121)
21:49:16.080 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286420:tensorstore_utils.py:371)
21:49:16.088 [I] Preserving Checkpoint[step=100 | time=2025-03-25 01:47:21.145718+00:00 | is_locked=None]: (Reason: on keep_period=100). (286420:checkpoint_manager.py:1734)
21:49:16.089 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286420:multihost.py:293)
21:49:16.092 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (286420:checkpoint_manager.py:1328)
21:49:16.095 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286420:async_checkpointer.py:231)
21:49:16.097 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742867352.6451297, 'wait_for_prev_duration_secs': 0.0005624294281005859, 'checkpointer_blocking_start_time': 1742867352.6461313, 'checkpointer_blocking_duration_secs': 3.441530227661133, 'get_old_steps_start_time': 1742867356.087814, 'get_old_steps_duration_secs': 0.0020036697387695312, 'checkpoint_manager_blocking_start_time': 1742867352.6450307, 'checkpoint_manager_blocking_duration_secs': 3.452054262161255} (286420:standard_logger.py:34)
Step 201: grad_norm=9.6541, loss=0.4664, param_norm=1886.5298
Step 202: grad_norm=6.8431, loss=0.4923, param_norm=1886.5302
Step 203: grad_norm=7.5477, loss=0.5331, param_norm=1886.5305
Step 204: grad_norm=11.4949, loss=0.5531, param_norm=1886.5309
21:49:20.600 [I] Progress on: 204it/1.00kit rate:1.5s/it remaining:19:30 elapsed:04:02 postfix:-  (286420:tqdm_logging.py:145)
Step 205: grad_norm=7.0937, loss=0.4127, param_norm=1886.5312
Step 206: grad_norm=5.5646, loss=0.4848, param_norm=1886.5315
Step 207: grad_norm=15.8206, loss=0.4757, param_norm=1886.5319
21:49:24.079 [I] ChainedFuture completed 1/1 futures in 8.00 seconds.                             (286420:future.py:137)
21:49:24.080 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 906.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:49:24.080 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286420:async_checkpointer.py:131)
21:49:24.081 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f574cbedfd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3 (286420:async_checkpointer.py:406)
21:49:24.082 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3/assets (286420:atomicity.py:287)
21:49:24.092 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3/params (286420:atomicity.py:287)
21:49:24.093 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200 (286420:async_checkpointer.py:416)
21:49:24.093 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3 (286420:async_checkpointer.py:426)
21:49:24.093 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200 (286420:atomicity.py:287)
21:49:24.095 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/200`. (286420:atomicity.py:548)
21:49:24.095 [I] [process=0][thread=async_save] Background save thread done.                      (286420:async_checkpointer.py:183)
21:49:24.096 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286420:async_checkpointer.py:239)
21:49:24.096 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286420:async_checkpointer.py:249)
21:49:24.096 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (286420:checkpoint_manager.py:1890)
21:49:24.097 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (286420:checkpoint_manager.py:1905)
Step 208: grad_norm=6.5375, loss=0.4277, param_norm=1886.5321
Step 209: grad_norm=3.8329, loss=0.4067, param_norm=1886.5323
Step 210: grad_norm=3.4445, loss=0.3386, param_norm=1886.5327
Step 211: grad_norm=4.4020, loss=0.3127, param_norm=1886.5330
Step 212: grad_norm=9.2433, loss=0.3661, param_norm=1886.5333
Step 213: grad_norm=5.1687, loss=0.3713, param_norm=1886.5336
21:49:30.627 [I] Progress on: 213it/1.00kit rate:1.1s/it remaining:14:45 elapsed:04:12 postfix:-  (286420:tqdm_logging.py:145)
Step 214: grad_norm=9.5777, loss=0.4267, param_norm=1886.5338
Step 215: grad_norm=21.4687, loss=0.4093, param_norm=1886.5343
Step 216: grad_norm=11.5060, loss=0.4682, param_norm=1886.5345
Step 217: grad_norm=16.9376, loss=0.7979, param_norm=1886.5349
Step 218: grad_norm=6.4882, loss=0.3916, param_norm=1886.5352
Step 219: grad_norm=8.1705, loss=0.3246, param_norm=1886.5354
Step 220: grad_norm=6.7537, loss=0.3973, param_norm=1886.5359
Step 221: grad_norm=9.1093, loss=0.3975, param_norm=1886.5361
Step 222: grad_norm=13.5549, loss=0.5190, param_norm=1886.5364
21:49:41.014 [I] Progress on: 222it/1.00kit rate:1.2s/it remaining:15:16 elapsed:04:22 postfix:-  (286420:tqdm_logging.py:145)
Step 223: grad_norm=6.6881, loss=0.3874, param_norm=1886.5367
Step 224: grad_norm=11.2873, loss=0.4578, param_norm=1886.5370
Step 225: grad_norm=27.6752, loss=0.3649, param_norm=1886.5374
Step 226: grad_norm=10.3994, loss=0.3910, param_norm=1886.5376
Step 227: grad_norm=5.8865, loss=0.3144, param_norm=1886.5380
Step 228: grad_norm=6.9477, loss=0.3610, param_norm=1886.5382
Step 229: grad_norm=9.3041, loss=0.6938, param_norm=1886.5385
Step 230: grad_norm=13.7719, loss=0.4243, param_norm=1886.5389
Step 231: grad_norm=3.0857, loss=0.3055, param_norm=1886.5392
21:49:51.212 [I] Progress on: 231it/1.00kit rate:1.2s/it remaining:15:38 elapsed:04:32 postfix:-  (286420:tqdm_logging.py:145)
Step 232: grad_norm=5.6138, loss=0.3034, param_norm=1886.5394
Step 233: grad_norm=6.1579, loss=0.2931, param_norm=1886.5398
Step 234: grad_norm=4.2146, loss=0.3188, param_norm=1886.5402
Step 235: grad_norm=4.5966, loss=0.3972, param_norm=1886.5404
Step 236: grad_norm=5.5494, loss=0.3110, param_norm=1886.5408
Step 237: grad_norm=2.9802, loss=0.2835, param_norm=1886.5411
Step 238: grad_norm=2.8645, loss=0.2476, param_norm=1886.5414
Step 239: grad_norm=4.9503, loss=0.2757, param_norm=1886.5417
Step 240: grad_norm=8.3299, loss=0.4599, param_norm=1886.5421
Step 241: grad_norm=3.6242, loss=0.2863, param_norm=1886.5424
21:50:02.050 [I] Progress on: 241it/1.00kit rate:1.1s/it remaining:13:46 elapsed:04:43 postfix:-  (286420:tqdm_logging.py:145)
Step 242: grad_norm=14.6047, loss=0.4654, param_norm=1886.5427
Step 243: grad_norm=5.3347, loss=0.2615, param_norm=1886.5431
Step 244: grad_norm=3.4434, loss=0.3335, param_norm=1886.5433
Step 245: grad_norm=3.4173, loss=0.2837, param_norm=1886.5437
Step 246: grad_norm=7.7043, loss=0.3343, param_norm=1886.5441
Step 247: grad_norm=13.2119, loss=0.4841, param_norm=1886.5443
Step 248: grad_norm=10.1027, loss=0.3452, param_norm=1886.5446
Step 249: grad_norm=7.5466, loss=0.4818, param_norm=1886.5448
Step 250: grad_norm=8.8549, loss=0.5009, param_norm=1886.5453
Step 251: grad_norm=17.3897, loss=0.4117, param_norm=1886.5454
21:50:12.896 [I] Progress on: 251it/1.00kit rate:1.1s/it remaining:13:34 elapsed:04:54 postfix:-  (286420:tqdm_logging.py:145)
Step 252: grad_norm=7.8078, loss=0.3438, param_norm=1886.5458
Step 253: grad_norm=12.6144, loss=0.5730, param_norm=1886.5460
Step 254: grad_norm=11.6076, loss=0.5069, param_norm=1886.5463
Step 255: grad_norm=7.0096, loss=0.6236, param_norm=1886.5464
Step 256: grad_norm=5.6103, loss=0.2822, param_norm=1886.5469
Step 257: grad_norm=8.2957, loss=0.4865, param_norm=1886.5470
Step 258: grad_norm=8.4459, loss=0.3514, param_norm=1886.5474
Step 259: grad_norm=5.8896, loss=0.3006, param_norm=1886.5476
Step 260: grad_norm=4.3262, loss=0.3596, param_norm=1886.5479
21:50:23.025 [I] Progress on: 260it/1.00kit rate:1.1s/it remaining:13:27 elapsed:05:04 postfix:-  (286420:tqdm_logging.py:145)
Step 261: grad_norm=5.6226, loss=0.2934, param_norm=1886.5482
Step 262: grad_norm=6.5256, loss=0.2949, param_norm=1886.5485
Step 263: grad_norm=3.9764, loss=0.3942, param_norm=1886.5487
Step 264: grad_norm=10.8734, loss=0.4103, param_norm=1886.5491
Step 265: grad_norm=20.7063, loss=0.3066, param_norm=1886.5493
Step 266: grad_norm=6.8496, loss=0.3352, param_norm=1886.5496
Step 267: grad_norm=9.9363, loss=0.4134, param_norm=1886.5499
Step 268: grad_norm=8.5165, loss=0.2876, param_norm=1886.5503
Step 269: grad_norm=9.1516, loss=0.3347, param_norm=1886.5505
Step 270: grad_norm=4.9112, loss=0.3354, param_norm=1886.5508
21:50:33.869 [I] Progress on: 270it/1.00kit rate:1.1s/it remaining:13:13 elapsed:05:15 postfix:-  (286420:tqdm_logging.py:145)
Step 271: grad_norm=10.4187, loss=0.2999, param_norm=1886.5510
Step 272: grad_norm=17.3114, loss=0.3791, param_norm=1886.5513
Step 273: grad_norm=3.3059, loss=0.2136, param_norm=1886.5515
Step 274: grad_norm=7.7086, loss=0.3627, param_norm=1886.5518
Step 275: grad_norm=5.6402, loss=0.2626, param_norm=1886.5520
Step 276: grad_norm=3.2951, loss=0.2239, param_norm=1886.5522
Step 277: grad_norm=4.1384, loss=0.3756, param_norm=1886.5525
Step 278: grad_norm=15.1814, loss=0.3983, param_norm=1886.5527
Step 279: grad_norm=8.7103, loss=0.2423, param_norm=1886.5530
21:50:44.036 [I] Progress on: 279it/1.00kit rate:1.1s/it remaining:13:14 elapsed:05:25 postfix:-  (286420:tqdm_logging.py:145)
Step 280: grad_norm=2.2958, loss=0.2159, param_norm=1886.5531
Step 281: grad_norm=2.9141, loss=0.2357, param_norm=1886.5533
Step 282: grad_norm=12.0615, loss=0.3618, param_norm=1886.5536
Step 283: grad_norm=5.3275, loss=0.2549, param_norm=1886.5540
Step 284: grad_norm=3.1667, loss=0.2378, param_norm=1886.5542
Step 285: grad_norm=7.3026, loss=0.3974, param_norm=1886.5544
Step 286: grad_norm=5.8873, loss=0.2725, param_norm=1886.5547
Step 287: grad_norm=4.6822, loss=0.3589, param_norm=1886.5551
Step 288: grad_norm=12.1913, loss=0.3117, param_norm=1886.5553
Step 289: grad_norm=6.1809, loss=0.2835, param_norm=1886.5557
21:50:54.869 [I] Progress on: 289it/1.00kit rate:1.1s/it remaining:12:51 elapsed:05:36 postfix:-  (286420:tqdm_logging.py:145)
Step 290: grad_norm=5.6893, loss=0.3666, param_norm=1886.5559
Step 291: grad_norm=3.6179, loss=0.2017, param_norm=1886.5562
Step 292: grad_norm=3.9906, loss=0.3203, param_norm=1886.5564
Step 293: grad_norm=2.6257, loss=0.2306, param_norm=1886.5568
Step 294: grad_norm=7.5099, loss=0.2869, param_norm=1886.5570
Step 295: grad_norm=3.4039, loss=0.1886, param_norm=1886.5575
Step 296: grad_norm=6.3421, loss=0.3045, param_norm=1886.5577
Step 297: grad_norm=2.9843, loss=0.1816, param_norm=1886.5580
Step 298: grad_norm=3.6013, loss=0.2911, param_norm=1886.5583
21:51:05.010 [I] Progress on: 298it/1.00kit rate:1.1s/it remaining:13:02 elapsed:05:46 postfix:-  (286420:tqdm_logging.py:145)
Step 299: grad_norm=3.7675, loss=0.2267, param_norm=1886.5587
Step 300: grad_norm=3.2305, loss=0.2402, param_norm=1886.5591
21:51:07.203 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286420:checkpoint_manager.py:1759)
21:51:07.203 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286420:checkpoint_manager.py:1777)
21:51:07.204 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (286420:checkpoint_manager.py:1786)
21:51:07.204 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (286420:checkpoint_manager.py:1817)
21:51:07.204 [I] [process=0] Saving checkpoint at step 300                                        (286420:checkpoint_manager.py:1286)
21:51:07.205 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300. (286420:async_checkpointer.py:358)
21:51:07.206 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:51:07.207 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6 (286420:atomicity.py:144)
21:51:07.208 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:51:07.208 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:51:07.209 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (286420:atomicity.py:144)
21:51:07.210 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (286420:atomicity.py:144)
21:51:07.210 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:51:07.215 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286420:replica_slices.py:419)
21:51:10.733 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.9 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:51:10.738 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286420:tensorstore_utils.py:371)
21:51:10.741 [I] [process=0][thread=async_save] Background save thread started.                   (286420:async_checkpointer.py:121)
21:51:10.742 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286420:tensorstore_utils.py:371)
21:51:10.748 [I] Preserving Checkpoint[step=100 | time=2025-03-25 01:47:21.145718+00:00 | is_locked=None]: (Reason: on keep_period=100). (286420:checkpoint_manager.py:1734)
21:51:10.750 [I] Preserving Checkpoint[step=200 | time=2025-03-25 01:49:16.087681+00:00 | is_locked=None]: (Reason: on keep_period=100). (286420:checkpoint_manager.py:1734)
21:51:10.751 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286420:multihost.py:293)
21:51:10.752 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (286420:checkpoint_manager.py:1328)
21:51:10.759 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286420:async_checkpointer.py:231)
21:51:10.761 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742867467.2035756, 'wait_for_prev_duration_secs': 0.0008332729339599609, 'checkpointer_blocking_start_time': 1742867467.2050521, 'checkpointer_blocking_duration_secs': 3.543304443359375, 'get_old_steps_start_time': 1742867470.7484624, 'get_old_steps_duration_secs': 0.002626180648803711, 'checkpoint_manager_blocking_start_time': 1742867467.2034066, 'checkpoint_manager_blocking_duration_secs': 3.5573928356170654} (286420:standard_logger.py:34)
Step 301: grad_norm=3.2754, loss=0.2785, param_norm=1886.5593
Step 302: grad_norm=5.7347, loss=0.2531, param_norm=1886.5596
Step 303: grad_norm=5.4541, loss=0.2656, param_norm=1886.5598
Step 304: grad_norm=5.6321, loss=0.2410, param_norm=1886.5601
21:51:15.136 [I] Progress on: 304it/1.00kit rate:1.5s/it remaining:17:00 elapsed:05:56 postfix:-  (286420:tqdm_logging.py:145)
Step 305: grad_norm=3.4964, loss=0.2980, param_norm=1886.5603
Step 306: grad_norm=6.5096, loss=0.2517, param_norm=1886.5607
Step 307: grad_norm=4.1828, loss=0.2531, param_norm=1886.5609
21:51:18.475 [I] ChainedFuture completed 1/1 futures in 7.73 seconds.                             (286420:future.py:137)
21:51:18.476 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 919.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:51:18.476 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286420:async_checkpointer.py:131)
21:51:18.477 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f574cbedfd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6 (286420:async_checkpointer.py:406)
21:51:18.477 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6/assets (286420:atomicity.py:287)
21:51:18.485 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6/params (286420:atomicity.py:287)
21:51:18.486 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300 (286420:async_checkpointer.py:416)
21:51:18.486 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6 (286420:async_checkpointer.py:426)
21:51:18.486 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300 (286420:atomicity.py:287)
21:51:18.487 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/300`. (286420:atomicity.py:548)
21:51:18.488 [I] [process=0][thread=async_save] Background save thread done.                      (286420:async_checkpointer.py:183)
21:51:18.488 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286420:async_checkpointer.py:239)
21:51:18.488 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286420:async_checkpointer.py:249)
21:51:18.489 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (286420:checkpoint_manager.py:1890)
21:51:18.489 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (286420:checkpoint_manager.py:1905)
Step 308: grad_norm=4.9037, loss=0.4606, param_norm=1886.5610
Step 309: grad_norm=3.7625, loss=0.2962, param_norm=1886.5614
Step 310: grad_norm=3.2942, loss=0.2191, param_norm=1886.5616
Step 311: grad_norm=4.1951, loss=0.2950, param_norm=1886.5619
Step 312: grad_norm=5.0935, loss=0.3955, param_norm=1886.5621
Step 313: grad_norm=5.7989, loss=0.2875, param_norm=1886.5624
Step 314: grad_norm=5.8684, loss=0.2524, param_norm=1886.5626
21:51:25.956 [I] Progress on: 314it/1.00kit rate:1.1s/it remaining:12:28 elapsed:06:07 postfix:-  (286420:tqdm_logging.py:145)
Step 315: grad_norm=3.4687, loss=0.2274, param_norm=1886.5630
Step 316: grad_norm=6.8440, loss=0.1857, param_norm=1886.5632
Step 317: grad_norm=4.9854, loss=0.3784, param_norm=1886.5635
Step 318: grad_norm=2.3478, loss=0.1726, param_norm=1886.5637
Step 319: grad_norm=4.9833, loss=0.2389, param_norm=1886.5641
Step 320: grad_norm=18.2781, loss=0.3409, param_norm=1886.5643
Step 321: grad_norm=3.6714, loss=0.2193, param_norm=1886.5646
Step 322: grad_norm=7.4761, loss=0.2395, param_norm=1886.5648
Step 323: grad_norm=3.0651, loss=0.1933, param_norm=1886.5651
21:51:36.107 [I] Progress on: 323it/1.00kit rate:1.1s/it remaining:12:18 elapsed:06:17 postfix:-  (286420:tqdm_logging.py:145)
Step 324: grad_norm=2.6322, loss=0.1860, param_norm=1886.5653
Step 325: grad_norm=4.3784, loss=0.2221, param_norm=1886.5654
Step 326: grad_norm=13.8692, loss=0.2866, param_norm=1886.5658
Step 327: grad_norm=3.8178, loss=0.2361, param_norm=1886.5660
Step 328: grad_norm=4.7893, loss=0.1595, param_norm=1886.5662
Step 329: grad_norm=8.1742, loss=0.2674, param_norm=1886.5664
Step 330: grad_norm=4.6434, loss=0.3686, param_norm=1886.5668
Step 331: grad_norm=9.9639, loss=0.3103, param_norm=1886.5671
Step 332: grad_norm=4.9911, loss=0.2703, param_norm=1886.5673
Step 333: grad_norm=4.4450, loss=0.2573, param_norm=1886.5676
21:51:46.938 [I] Progress on: 333it/1.00kit rate:1.1s/it remaining:12:03 elapsed:06:28 postfix:-  (286420:tqdm_logging.py:145)
Step 334: grad_norm=3.1279, loss=0.2278, param_norm=1886.5679
Step 335: grad_norm=4.1230, loss=0.2626, param_norm=1886.5682
Step 336: grad_norm=3.0730, loss=0.1549, param_norm=1886.5685
Step 337: grad_norm=2.3064, loss=0.1548, param_norm=1886.5687
Step 338: grad_norm=4.5766, loss=0.2530, param_norm=1886.5690
Step 339: grad_norm=2.4983, loss=0.1720, param_norm=1886.5692
Step 340: grad_norm=5.7992, loss=0.2569, param_norm=1886.5695
Step 341: grad_norm=2.7995, loss=0.1849, param_norm=1886.5697
Step 342: grad_norm=4.0002, loss=0.2196, param_norm=1886.5699
21:51:57.522 [I] Progress on: 342it/1.00kit rate:1.2s/it remaining:13:05 elapsed:06:39 postfix:-  (286420:tqdm_logging.py:145)
Step 343: grad_norm=2.9487, loss=0.2624, param_norm=1886.5702
Step 344: grad_norm=3.0240, loss=0.1898, param_norm=1886.5704
Step 345: grad_norm=4.2231, loss=0.2697, param_norm=1886.5707
Step 346: grad_norm=4.7740, loss=0.2153, param_norm=1886.5709
Step 347: grad_norm=5.2621, loss=0.2663, param_norm=1886.5712
Step 348: grad_norm=4.8413, loss=0.1729, param_norm=1886.5715
Step 349: grad_norm=3.0218, loss=0.2007, param_norm=1886.5718
Step 350: grad_norm=3.1844, loss=0.2267, param_norm=1886.5720
Step 351: grad_norm=3.6387, loss=0.2497, param_norm=1886.5721
Step 352: grad_norm=2.4159, loss=0.1565, param_norm=1886.5724
21:52:08.357 [I] Progress on: 352it/1.00kit rate:1.1s/it remaining:11:44 elapsed:06:50 postfix:-  (286420:tqdm_logging.py:145)
Step 353: grad_norm=3.9046, loss=0.1572, param_norm=1886.5726
Step 354: grad_norm=8.3311, loss=0.1821, param_norm=1886.5728
Step 355: grad_norm=6.7165, loss=0.2404, param_norm=1886.5731
Step 356: grad_norm=3.9847, loss=0.2742, param_norm=1886.5734
Step 357: grad_norm=3.1742, loss=0.1782, param_norm=1886.5736
Step 358: grad_norm=2.0340, loss=0.1272, param_norm=1886.5737
Step 359: grad_norm=3.6787, loss=0.2373, param_norm=1886.5740
Step 360: grad_norm=19.0857, loss=0.2944, param_norm=1886.5742
Step 361: grad_norm=5.6522, loss=0.1666, param_norm=1886.5746
21:52:18.517 [I] Progress on: 361it/1.00kit rate:1.1s/it remaining:11:52 elapsed:07:00 postfix:-  (286420:tqdm_logging.py:145)
Step 362: grad_norm=2.9166, loss=0.1716, param_norm=1886.5747
Step 363: grad_norm=3.1592, loss=0.1982, param_norm=1886.5750
Step 364: grad_norm=3.9292, loss=0.2026, param_norm=1886.5751
Step 365: grad_norm=4.3660, loss=0.1639, param_norm=1886.5753
Step 366: grad_norm=3.3400, loss=0.2329, param_norm=1886.5754
Step 367: grad_norm=2.9840, loss=0.2047, param_norm=1886.5757
Step 368: grad_norm=3.2776, loss=0.1755, param_norm=1886.5758
Step 369: grad_norm=4.8306, loss=0.2034, param_norm=1886.5760
Step 370: grad_norm=3.0780, loss=0.2053, param_norm=1886.5762
Step 371: grad_norm=2.3222, loss=0.1412, param_norm=1886.5764
21:52:29.333 [I] Progress on: 371it/1.00kit rate:1.1s/it remaining:11:20 elapsed:07:11 postfix:-  (286420:tqdm_logging.py:145)
Step 372: grad_norm=3.3727, loss=0.2408, param_norm=1886.5765
Step 373: grad_norm=5.6462, loss=0.2014, param_norm=1886.5768
Step 374: grad_norm=3.2633, loss=0.2413, param_norm=1886.5769
Step 375: grad_norm=3.7328, loss=0.2244, param_norm=1886.5771
Step 376: grad_norm=8.9708, loss=0.2730, param_norm=1886.5774
Step 377: grad_norm=5.1288, loss=0.2239, param_norm=1886.5776
Step 378: grad_norm=2.6441, loss=0.1731, param_norm=1886.5779
Step 379: grad_norm=3.2694, loss=0.2149, param_norm=1886.5780
Step 380: grad_norm=4.0593, loss=0.1494, param_norm=1886.5782
21:52:39.453 [I] Progress on: 380it/1.00kit rate:1.1s/it remaining:11:46 elapsed:07:21 postfix:-  (286420:tqdm_logging.py:145)
Step 381: grad_norm=4.6452, loss=0.1715, param_norm=1886.5785
Step 382: grad_norm=3.3801, loss=0.1362, param_norm=1886.5786
Step 383: grad_norm=5.8562, loss=0.1682, param_norm=1886.5787
Step 384: grad_norm=3.2125, loss=0.2330, param_norm=1886.5790
Step 385: grad_norm=3.2028, loss=0.1684, param_norm=1886.5792
Step 386: grad_norm=2.5000, loss=0.1876, param_norm=1886.5793
Step 387: grad_norm=5.4456, loss=0.1954, param_norm=1886.5796
Step 388: grad_norm=3.4061, loss=0.1676, param_norm=1886.5798
Step 389: grad_norm=5.7702, loss=0.1791, param_norm=1886.5800
Step 390: grad_norm=4.6552, loss=0.1994, param_norm=1886.5802
21:52:50.297 [I] Progress on: 390it/1.00kit rate:1.1s/it remaining:11:04 elapsed:07:32 postfix:-  (286420:tqdm_logging.py:145)
Step 391: grad_norm=4.1069, loss=0.3173, param_norm=1886.5803
Step 392: grad_norm=4.1695, loss=0.1919, param_norm=1886.5807
Step 393: grad_norm=3.0178, loss=0.1956, param_norm=1886.5809
Step 394: grad_norm=5.4159, loss=0.1819, param_norm=1886.5811
Step 395: grad_norm=6.5249, loss=0.2355, param_norm=1886.5813
Step 396: grad_norm=10.4920, loss=0.1536, param_norm=1886.5815
Step 397: grad_norm=8.6353, loss=0.2210, param_norm=1886.5817
Step 398: grad_norm=2.8504, loss=0.2203, param_norm=1886.5818
Step 399: grad_norm=3.1279, loss=0.2076, param_norm=1886.5820
21:53:00.482 [I] Progress on: 399it/1.00kit rate:1.2s/it remaining:12:10 elapsed:07:42 postfix:-  (286420:tqdm_logging.py:145)
Step 400: grad_norm=2.9442, loss=0.1436, param_norm=1886.5823
21:53:01.599 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286420:checkpoint_manager.py:1759)
21:53:01.600 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286420:checkpoint_manager.py:1777)
21:53:01.600 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (286420:checkpoint_manager.py:1786)
21:53:01.600 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (286420:checkpoint_manager.py:1817)
21:53:01.600 [I] [process=0] Saving checkpoint at step 400                                        (286420:checkpoint_manager.py:1286)
21:53:01.601 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/400. (286420:async_checkpointer.py:358)
21:53:01.602 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:53:01.602 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/400.orbax-checkpoint-tmp-9 (286420:atomicity.py:144)
21:53:01.603 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:53:01.603 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286420:multihost.py:293)
21:53:01.604 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (286420:atomicity.py:144)
21:53:01.604 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (286420:atomicity.py:144)
21:53:01.605 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286420:multihost.py:293)
21:53:01.610 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286420:replica_slices.py:419)
21:53:07.414 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 5 seconds) (per-host) (286420:base_pytree_checkpoint_handler.py:113)
21:53:07.417 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286420:tensorstore_utils.py:371)
21:53:07.419 [I] [process=0][thread=async_save] Background save thread started.                   (286420:async_checkpointer.py:121)
21:53:07.421 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286420:tensorstore_utils.py:371)
21:53:07.425 [I] Preserving Checkpoint[step=100 | time=2025-03-25 01:47:21.145718+00:00 | is_locked=None]: (Reason: on keep_period=100). (286420:checkpoint_manager.py:1734)
21:53:07.429 [I] Preserving Checkpoint[step=200 | time=2025-03-25 01:49:16.087681+00:00 | is_locked=None]: (Reason: on keep_period=100). (286420:checkpoint_manager.py:1734)
21:53:07.437 [I] Preserving Checkpoint[step=300 | time=2025-03-25 01:51:10.748395+00:00 | is_locked=None]: (Reason: on keep_period=100). (286420:checkpoint_manager.py:1734)
21:53:07.444 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286420:multihost.py:293)
21:53:07.448 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (286420:checkpoint_manager.py:1328)
21:53:07.450 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286420:async_checkpointer.py:231)
21:53:07.451 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_idli_plate/1st_try_pi0_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742867581.599947, 'wait_for_prev_duration_secs': 0.0006222724914550781, 'checkpointer_blocking_start_time': 1742867581.6010113, 'checkpointer_blocking_duration_secs': 5.824690818786621, 'get_old_steps_start_time': 1742867587.4258437, 'get_old_steps_duration_secs': 0.01828789710998535, 'checkpoint_manager_blocking_start_time': 1742867581.5998702, 'checkpoint_manager_blocking_duration_secs': 5.8516621589660645} (286420:standard_logger.py:34)
Step 401: grad_norm=2.7394, loss=0.1612, param_norm=1886.5825
Step 402: grad_norm=3.1823, loss=0.1590, param_norm=1886.5828
Step 403: grad_norm=1.5188, loss=0.1155, param_norm=1886.5830
21:53:10.711 [I] Progress on: 403it/1.00kit rate:2.0s/it remaining:19:45 elapsed:07:52 postfix:-  (286420:tqdm_logging.py:145)
Step 404: grad_norm=3.2676, loss=0.1114, param_norm=1886.5831
Step 405: grad_norm=3.4862, loss=0.1370, param_norm=1886.5834
Step 406: grad_norm=4.3102, loss=0.1176, param_norm=1886.5836
