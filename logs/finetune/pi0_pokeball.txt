nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
22:19:02.547 [I] Running on: ivy                                                                  (3498277:train.py:195)
INFO:2025-03-23 22:19:03,311:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
22:19:03.311 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (3498277:xla_bridge.py:945)
INFO:2025-03-23 22:19:03,312:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
22:19:03.312 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (3498277:xla_bridge.py:945)
22:19:04.248 [I] Wiped checkpoint directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball (3498277:checkpoints.py:25)
22:19:04.249 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3498277:base_pytree_checkpoint_handler.py:332)
22:19:04.249 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3498277:base_pytree_checkpoint_handler.py:332)
22:19:04.249 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (3498277:multihost.py:375)
22:19:04.250 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7fe7d5fb0850>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60e5c50>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60765d0>}, handler_registry=None (3498277:checkpoint_manager.py:622)
22:19:04.250 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7fe7d5fb0850>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (3498277:composite_checkpoint_handler.py:239)
22:19:04.250 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60e5c50>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3498277:composite_checkpoint_handler.py:239)
22:19:04.250 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60765d0>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3498277:composite_checkpoint_handler.py:239)
22:19:04.251 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fe7d6014150>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (3498277:composite_checkpoint_handler.py:239)
22:19:04.251 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fe7d5fb0850>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fe7d5fb0850>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60e5c50>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60e5c50>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60765d0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fe7d60765d0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fe7d6014150>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fe7d6014150>}). (3498277:composite_checkpoint_handler.py:508)
22:19:04.251 [I] orbax-checkpoint version: 0.11.1                                                 (3498277:abstract_checkpointer.py:35)
22:19:04.251 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7fe7d5f53ec0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (3498277:async_checkpointer.py:80)
22:19:04.252 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball (3498277:checkpoint_manager.py:1528)
22:19:04.252 [I] Saving root metadata                                                             (3498277:checkpoint_manager.py:1569)
22:19:04.252 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (3498277:multihost.py:293)
22:19:04.252 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7fe7d5d8fdd0> (3498277:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250323_221904-ahr49u42
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_pi0_pokeball
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/ahr49u42
22:19:05.210 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid___finetune_on_pokeball/droid (3498277:config.py:167)
Some kwargs in processor config are unused and will not have any effect: scale, time_horizon, action_dim, min_token, vocab_size. 
Some kwargs in processor config are unused and will not have any effect: scale, time_horizon, action_dim, min_token, vocab_size. 
num states in collected demos given by count_collected_demos: 1108
len_dataset: 1108
common_prompt: pick up the poke ball and put it in the tray
22:19:24.761 [I] Initialized data loader:
[0].images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].images['wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (16,)@bool
[0].image_masks['base_1_rgb']: (16,)@bool
[0].image_masks['wrist_0_rgb']: (16,)@bool
[0].state: (16, 8)@float32
[0].tokenized_prompt: (16, 250)@int32
[0].tokenized_prompt_mask: (16, 250)@bool
[0].token_ar_mask: (16, 250)@int32
[0].token_loss_mask: (16, 250)@bool
[1]: (16, 10, 8)@float32 (3498277:train.py:227)
22:19:25.861 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3498277:base_pytree_checkpoint_handler.py:332)
22:19:25.885 [I] Restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (3498277:checkpointer.py:256)
22:19:42.436 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 673.8 MiB/s (total bytes: 10.9 GiB) (time elapsed: 16 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:19:42.437 [I] Finished restoring checkpoint from /home/ksridhar/.cache/openpi/openpi-assets/checkpoints/pi0_fast_droid/params. (3498277:checkpointer.py:259)
22:19:42.437 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (3498277:multihost.py:293)
2025-03-23 22:21:13.641906: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 19.42GiB (20847081029 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
22:21:19.569 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (3498277:train.py:231)
22:21:19.656 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (3498277:tqdm_logging.py:145)
Step 0: grad_norm=13.0225, loss=3.5217, param_norm=1886.4708
Step 1: grad_norm=10.9242, loss=3.4742, param_norm=1886.4708
Step 2: grad_norm=12.5037, loss=3.5347, param_norm=1886.4708
22:21:30.916 [I] Progress on: 2.00it/1.00kit rate:4.3s/it remaining:1:11:25 elapsed:00:11 postfix:- (3498277:tqdm_logging.py:145)
Step 3: grad_norm=11.0999, loss=3.1924, param_norm=1886.4708
Step 4: grad_norm=11.5200, loss=3.2821, param_norm=1886.4707
Step 5: grad_norm=9.2828, loss=3.0581, param_norm=1886.4706
Step 6: grad_norm=12.1264, loss=2.9710, param_norm=1886.4706
Step 7: grad_norm=18.1596, loss=3.0186, param_norm=1886.4705
Step 8: grad_norm=10.0325, loss=3.1055, param_norm=1886.4705
Step 9: grad_norm=13.6084, loss=3.0751, param_norm=1886.4705
Step 10: grad_norm=8.7007, loss=2.9630, param_norm=1886.4703
Step 11: grad_norm=9.4866, loss=2.9389, param_norm=1886.4703
22:21:41.847 [I] Progress on: 11.0it/1.00kit rate:1.2s/it remaining:20:13 elapsed:00:22 postfix:- (3498277:tqdm_logging.py:145)
Step 12: grad_norm=7.7379, loss=2.5145, param_norm=1886.4702
Step 13: grad_norm=14.4308, loss=2.6241, param_norm=1886.4702
Step 14: grad_norm=10.4167, loss=2.6225, param_norm=1886.4702
Step 15: grad_norm=10.1249, loss=2.6469, param_norm=1886.4701
Step 16: grad_norm=11.1970, loss=2.5715, param_norm=1886.4701
Step 17: grad_norm=7.5021, loss=2.4641, param_norm=1886.4701
Step 18: grad_norm=8.0601, loss=2.4794, param_norm=1886.4701
Step 19: grad_norm=13.2631, loss=2.4255, param_norm=1886.4701
Step 20: grad_norm=10.6037, loss=2.3536, param_norm=1886.4701
22:21:52.406 [I] Progress on: 20.0it/1.00kit rate:1.1s/it remaining:18:38 elapsed:00:32 postfix:- (3498277:tqdm_logging.py:145)
Step 21: grad_norm=10.3742, loss=2.4399, param_norm=1886.4702
Step 22: grad_norm=7.0009, loss=2.1683, param_norm=1886.4702
Step 23: grad_norm=6.5570, loss=2.4282, param_norm=1886.4702
Step 24: grad_norm=6.5980, loss=2.4265, param_norm=1886.4703
Step 25: grad_norm=9.3839, loss=2.4210, param_norm=1886.4703
Step 26: grad_norm=5.6791, loss=2.3019, param_norm=1886.4703
Step 27: grad_norm=5.7958, loss=2.1483, param_norm=1886.4705
Step 28: grad_norm=7.4264, loss=2.0877, param_norm=1886.4706
22:22:03.040 [I] Progress on: 28.0it/1.00kit rate:1.3s/it remaining:21:39 elapsed:00:43 postfix:- (3498277:tqdm_logging.py:145)
Step 29: grad_norm=9.1016, loss=2.2915, param_norm=1886.4706
Step 30: grad_norm=5.5412, loss=2.1660, param_norm=1886.4708
Step 31: grad_norm=10.1370, loss=1.9364, param_norm=1886.4708
Step 32: grad_norm=16.8065, loss=2.0420, param_norm=1886.4709
Step 33: grad_norm=9.1302, loss=2.2612, param_norm=1886.4711
Step 34: grad_norm=9.9669, loss=2.0341, param_norm=1886.4712
Step 35: grad_norm=15.3182, loss=2.2601, param_norm=1886.4714
Step 36: grad_norm=5.0353, loss=2.1341, param_norm=1886.4716
Step 37: grad_norm=5.1712, loss=1.7786, param_norm=1886.4718
22:22:13.599 [I] Progress on: 37.0it/1.00kit rate:1.2s/it remaining:18:45 elapsed:00:53 postfix:- (3498277:tqdm_logging.py:145)
Step 38: grad_norm=7.7677, loss=2.1098, param_norm=1886.4720
Step 39: grad_norm=8.7197, loss=1.9443, param_norm=1886.4722
Step 40: grad_norm=12.4227, loss=1.7426, param_norm=1886.4724
Step 41: grad_norm=5.7230, loss=1.9907, param_norm=1886.4727
Step 42: grad_norm=8.8180, loss=2.1107, param_norm=1886.4729
Step 43: grad_norm=11.3382, loss=1.8660, param_norm=1886.4731
Step 44: grad_norm=5.6611, loss=1.9365, param_norm=1886.4734
Step 45: grad_norm=11.1120, loss=2.1404, param_norm=1886.4736
Step 46: grad_norm=7.1981, loss=1.9077, param_norm=1886.4740
22:22:24.801 [I] Progress on: 46.0it/1.00kit rate:1.3s/it remaining:21:04 elapsed:01:05 postfix:- (3498277:tqdm_logging.py:145)
Step 47: grad_norm=6.8106, loss=1.8450, param_norm=1886.4742
Step 48: grad_norm=6.5814, loss=2.0451, param_norm=1886.4744
Step 49: grad_norm=6.7061, loss=2.0616, param_norm=1886.4747
Step 50: grad_norm=6.2423, loss=1.9233, param_norm=1886.4750
Step 51: grad_norm=8.9533, loss=1.9758, param_norm=1886.4753
Step 52: grad_norm=6.6575, loss=1.8153, param_norm=1886.4757
Step 53: grad_norm=5.7522, loss=1.8064, param_norm=1886.4761
Step 54: grad_norm=6.3028, loss=1.8710, param_norm=1886.4764
22:22:35.386 [I] Progress on: 54.0it/1.00kit rate:1.3s/it remaining:20:16 elapsed:01:15 postfix:- (3498277:tqdm_logging.py:145)
Step 55: grad_norm=11.3280, loss=1.8131, param_norm=1886.4768
Step 56: grad_norm=8.0276, loss=2.1507, param_norm=1886.4772
Step 57: grad_norm=15.9718, loss=1.9772, param_norm=1886.4775
Step 58: grad_norm=9.8932, loss=1.8012, param_norm=1886.4779
Step 59: grad_norm=5.4413, loss=2.0416, param_norm=1886.4781
Step 60: grad_norm=6.9839, loss=1.8061, param_norm=1886.4786
Step 61: grad_norm=7.1710, loss=1.9274, param_norm=1886.4789
Step 62: grad_norm=5.4088, loss=1.7002, param_norm=1886.4792
Step 63: grad_norm=6.9776, loss=1.9189, param_norm=1886.4795
22:22:45.603 [I] Progress on: 63.0it/1.00kit rate:1.1s/it remaining:17:34 elapsed:01:25 postfix:- (3498277:tqdm_logging.py:145)
Step 64: grad_norm=7.0189, loss=1.8580, param_norm=1886.4797
Step 65: grad_norm=5.5038, loss=1.8164, param_norm=1886.4801
Step 66: grad_norm=15.4749, loss=1.8016, param_norm=1886.4805
Step 67: grad_norm=18.9653, loss=1.7329, param_norm=1886.4808
Step 68: grad_norm=5.4782, loss=1.7699, param_norm=1886.4811
Step 69: grad_norm=13.7659, loss=1.3547, param_norm=1886.4814
Step 70: grad_norm=10.2765, loss=1.4636, param_norm=1886.4818
22:22:55.969 [I] Progress on: 70.0it/1.00kit rate:1.4s/it remaining:22:05 elapsed:01:36 postfix:- (3498277:tqdm_logging.py:145)
Step 71: grad_norm=9.5065, loss=1.7282, param_norm=1886.4822
Step 72: grad_norm=6.2243, loss=1.5138, param_norm=1886.4825
Step 73: grad_norm=9.7124, loss=1.3454, param_norm=1886.4829
Step 74: grad_norm=12.1779, loss=1.5027, param_norm=1886.4833
Step 75: grad_norm=11.4544, loss=1.6440, param_norm=1886.4836
Step 76: grad_norm=9.6935, loss=1.4738, param_norm=1886.4840
Step 77: grad_norm=6.1947, loss=1.2441, param_norm=1886.4844
Step 78: grad_norm=7.2115, loss=1.6331, param_norm=1886.4847
Step 79: grad_norm=5.1254, loss=1.5121, param_norm=1886.4851
22:23:07.027 [I] Progress on: 79.0it/1.00kit rate:1.2s/it remaining:18:43 elapsed:01:47 postfix:- (3498277:tqdm_logging.py:145)
Step 80: grad_norm=7.8232, loss=1.4807, param_norm=1886.4855
Step 81: grad_norm=5.0210, loss=1.2970, param_norm=1886.4857
Step 82: grad_norm=7.0371, loss=1.3998, param_norm=1886.4862
Step 83: grad_norm=14.4957, loss=1.6930, param_norm=1886.4866
Step 84: grad_norm=10.5445, loss=1.5550, param_norm=1886.4869
Step 85: grad_norm=7.4450, loss=1.4746, param_norm=1886.4873
Step 86: grad_norm=4.7852, loss=1.5202, param_norm=1886.4878
Step 87: grad_norm=7.0913, loss=1.6240, param_norm=1886.4882
Step 88: grad_norm=6.4202, loss=1.5868, param_norm=1886.4885
22:23:18.256 [I] Progress on: 88.0it/1.00kit rate:1.3s/it remaining:19:41 elapsed:01:58 postfix:- (3498277:tqdm_logging.py:145)
Step 89: grad_norm=8.8545, loss=1.3759, param_norm=1886.4889
Step 90: grad_norm=5.3606, loss=1.6175, param_norm=1886.4891
Step 91: grad_norm=15.3829, loss=1.5551, param_norm=1886.4896
Step 92: grad_norm=7.4904, loss=1.6182, param_norm=1886.4899
Step 93: grad_norm=11.3385, loss=1.3999, param_norm=1886.4904
Step 94: grad_norm=6.5843, loss=1.5318, param_norm=1886.4906
Step 95: grad_norm=7.5286, loss=1.4260, param_norm=1886.4910
Step 96: grad_norm=12.3521, loss=1.5568, param_norm=1886.4913
22:23:29.126 [I] Progress on: 96.0it/1.00kit rate:1.4s/it remaining:20:23 elapsed:02:09 postfix:- (3498277:tqdm_logging.py:145)
Step 97: grad_norm=5.7704, loss=1.6763, param_norm=1886.4917
Step 98: grad_norm=5.3670, loss=1.4030, param_norm=1886.4919
Step 99: grad_norm=11.0295, loss=1.4114, param_norm=1886.4924
Step 100: grad_norm=7.2311, loss=1.3379, param_norm=1886.4927
22:23:33.810 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:23:33.811 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (3498277:checkpoint_manager.py:1767)
22:23:33.811 [I] [process=0] Saving checkpoint at step 100                                        (3498277:checkpoint_manager.py:1286)
22:23:33.813 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100. (3498277:async_checkpointer.py:358)
22:23:33.814 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:23:33.815 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0 (3498277:atomicity.py:144)
22:23:33.823 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:23:33.824 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:23:33.825 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742783013822712385, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742783013822712385, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3498277:checkpoint.py:185)
22:23:33.827 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (3498277:atomicity.py:144)
22:23:33.828 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (3498277:atomicity.py:144)
22:23:33.829 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:23:33.860 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:23:38.426 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.2 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:23:38.435 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:23:38.439 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:23:38.443 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:23:38.455 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:23:38.457 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:23:38.464 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:23:38.467 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783013.810589, 'wait_for_prev_duration_secs': 0.0005667209625244141, 'checkpointer_blocking_start_time': 1742783013.8120966, 'checkpointer_blocking_duration_secs': 4.642682790756226, 'get_old_steps_start_time': 1742783018.45508, 'get_old_steps_duration_secs': 3.457069396972656e-05, 'checkpoint_manager_blocking_start_time': 1742783013.8102024, 'checkpoint_manager_blocking_duration_secs': 4.656528472900391} (3498277:standard_logger.py:34)
Step 101: grad_norm=5.6038, loss=1.4764, param_norm=1886.4930
22:23:39.554 [I] Progress on: 101it/1.00kit rate:2.6s/it remaining:39:03 elapsed:02:19 postfix:-  (3498277:tqdm_logging.py:145)
Step 102: grad_norm=6.3047, loss=1.4360, param_norm=1886.4935
Step 103: grad_norm=5.4282, loss=1.4783, param_norm=1886.4938
Step 104: grad_norm=5.0209, loss=1.4713, param_norm=1886.4943
Step 105: grad_norm=5.3222, loss=1.4682, param_norm=1886.4948
Step 106: grad_norm=7.3683, loss=1.4667, param_norm=1886.4950
22:23:48.194 [I] ChainedFuture completed 1/1 futures in 9.75 seconds.                             (3498277:future.py:137)
22:23:48.195 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 721.3 MiB/s (total bytes: 10.1 GiB) (time elapsed: 14 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:23:48.196 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:23:48.199 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742783013822712385, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3498277:checkpoint.py:225)
22:23:48.204 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0 (3498277:async_checkpointer.py:406)
22:23:48.206 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/assets (3498277:atomicity.py:287)
22:23:48.209 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742783013822712385, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3498277:checkpoint.py:244)
22:23:48.225 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0/params (3498277:atomicity.py:287)
22:23:48.226 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100 (3498277:async_checkpointer.py:416)
22:23:48.226 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0 (3498277:async_checkpointer.py:426)
22:23:48.227 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100 (3498277:atomicity.py:287)
22:23:48.230 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/100`. (3498277:atomicity.py:548)
22:23:48.231 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:23:48.232 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:23:48.233 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:23:48.233 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:23:48.234 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 107: grad_norm=5.0788, loss=1.5260, param_norm=1886.4956
Step 108: grad_norm=6.6331, loss=1.4823, param_norm=1886.4960
22:23:50.501 [I] Progress on: 108it/1.00kit rate:1.8s/it remaining:26:10 elapsed:02:30 postfix:-  (3498277:tqdm_logging.py:145)
Step 109: grad_norm=17.0121, loss=1.5109, param_norm=1886.4965
Step 110: grad_norm=4.8902, loss=1.2984, param_norm=1886.4969
Step 111: grad_norm=8.8388, loss=1.4883, param_norm=1886.4974
Step 112: grad_norm=4.6797, loss=1.4063, param_norm=1886.4977
Step 113: grad_norm=5.3093, loss=1.5213, param_norm=1886.4982
Step 114: grad_norm=4.7268, loss=1.3403, param_norm=1886.4987
Step 115: grad_norm=7.7528, loss=1.5163, param_norm=1886.4990
Step 116: grad_norm=10.1369, loss=1.5193, param_norm=1886.4994
Step 117: grad_norm=7.0240, loss=1.5565, param_norm=1886.4998
22:24:01.335 [I] Progress on: 117it/1.00kit rate:1.2s/it remaining:17:53 elapsed:02:41 postfix:-  (3498277:tqdm_logging.py:145)
Step 118: grad_norm=7.7950, loss=1.4401, param_norm=1886.5000
Step 119: grad_norm=10.0839, loss=1.4792, param_norm=1886.5005
Step 120: grad_norm=6.2352, loss=1.4285, param_norm=1886.5007
Step 121: grad_norm=4.6593, loss=1.4690, param_norm=1886.5011
Step 122: grad_norm=6.0749, loss=1.4829, param_norm=1886.5013
Step 123: grad_norm=15.5862, loss=1.4619, param_norm=1886.5017
Step 124: grad_norm=14.8676, loss=1.5172, param_norm=1886.5021
Step 125: grad_norm=5.1331, loss=1.6224, param_norm=1886.5024
Step 126: grad_norm=4.4786, loss=1.4218, param_norm=1886.5027
22:24:12.695 [I] Progress on: 126it/1.00kit rate:1.3s/it remaining:19:11 elapsed:02:53 postfix:-  (3498277:tqdm_logging.py:145)
Step 127: grad_norm=10.0471, loss=1.3715, param_norm=1886.5031
Step 128: grad_norm=7.6923, loss=1.4770, param_norm=1886.5035
Step 129: grad_norm=5.1186, loss=1.3457, param_norm=1886.5038
Step 130: grad_norm=5.0026, loss=1.5180, param_norm=1886.5042
Step 131: grad_norm=8.3634, loss=1.4297, param_norm=1886.5045
Step 132: grad_norm=8.6339, loss=1.5844, param_norm=1886.5050
Step 133: grad_norm=9.5823, loss=1.3871, param_norm=1886.5054
Step 134: grad_norm=14.6175, loss=1.6636, param_norm=1886.5057
22:24:23.295 [I] Progress on: 134it/1.00kit rate:1.3s/it remaining:18:44 elapsed:03:03 postfix:-  (3498277:tqdm_logging.py:145)
Step 135: grad_norm=8.1720, loss=1.3920, param_norm=1886.5061
Step 136: grad_norm=13.6390, loss=1.6408, param_norm=1886.5066
Step 137: grad_norm=6.9160, loss=1.5203, param_norm=1886.5068
Step 138: grad_norm=5.3178, loss=1.2540, param_norm=1886.5072
Step 139: grad_norm=4.9109, loss=1.2374, param_norm=1886.5074
Step 140: grad_norm=5.6000, loss=1.0475, param_norm=1886.5079
Step 141: grad_norm=14.8449, loss=1.1088, param_norm=1886.5083
Step 142: grad_norm=7.4551, loss=1.2197, param_norm=1886.5085
Step 143: grad_norm=4.4707, loss=1.0609, param_norm=1886.5089
22:24:33.783 [I] Progress on: 143it/1.00kit rate:1.1s/it remaining:16:13 elapsed:03:14 postfix:-  (3498277:tqdm_logging.py:145)
Step 144: grad_norm=8.5106, loss=1.1531, param_norm=1886.5093
Step 145: grad_norm=8.2473, loss=1.0246, param_norm=1886.5098
Step 146: grad_norm=4.6616, loss=1.1193, param_norm=1886.5101
Step 147: grad_norm=11.1951, loss=1.1042, param_norm=1886.5104
Step 148: grad_norm=11.1257, loss=0.9898, param_norm=1886.5107
Step 149: grad_norm=5.6529, loss=1.1631, param_norm=1886.5111
Step 150: grad_norm=5.6536, loss=1.0238, param_norm=1886.5115
Step 151: grad_norm=11.3682, loss=1.0007, param_norm=1886.5118
22:24:45.149 [I] Progress on: 151it/1.00kit rate:1.4s/it remaining:19:35 elapsed:03:25 postfix:-  (3498277:tqdm_logging.py:145)
Step 152: grad_norm=9.2558, loss=1.1619, param_norm=1886.5121
Step 153: grad_norm=5.0415, loss=1.1779, param_norm=1886.5126
Step 154: grad_norm=12.9464, loss=1.0995, param_norm=1886.5129
Step 155: grad_norm=4.6680, loss=1.1400, param_norm=1886.5134
Step 156: grad_norm=7.8620, loss=1.0514, param_norm=1886.5138
Step 157: grad_norm=5.8924, loss=0.9877, param_norm=1886.5143
Step 158: grad_norm=5.8927, loss=1.2768, param_norm=1886.5148
Step 159: grad_norm=5.1755, loss=1.0171, param_norm=1886.5151
Step 160: grad_norm=8.0711, loss=1.1663, param_norm=1886.5156
22:24:55.997 [I] Progress on: 160it/1.00kit rate:1.2s/it remaining:16:40 elapsed:03:36 postfix:-  (3498277:tqdm_logging.py:145)
Step 161: grad_norm=16.7016, loss=1.1047, param_norm=1886.5160
Step 162: grad_norm=11.7539, loss=1.1384, param_norm=1886.5165
Step 163: grad_norm=10.6255, loss=1.0461, param_norm=1886.5168
Step 164: grad_norm=21.8946, loss=1.2492, param_norm=1886.5173
Step 165: grad_norm=6.4514, loss=1.2215, param_norm=1886.5176
Step 166: grad_norm=7.1275, loss=1.1616, param_norm=1886.5179
Step 167: grad_norm=12.6473, loss=1.1732, param_norm=1886.5183
Step 168: grad_norm=9.3183, loss=1.0998, param_norm=1886.5187
22:25:06.027 [I] Progress on: 168it/1.00kit rate:1.3s/it remaining:17:52 elapsed:03:46 postfix:-  (3498277:tqdm_logging.py:145)
Step 169: grad_norm=12.5796, loss=1.1262, param_norm=1886.5190
Step 170: grad_norm=9.7501, loss=0.9542, param_norm=1886.5194
Step 171: grad_norm=5.5780, loss=1.0361, param_norm=1886.5199
Step 172: grad_norm=11.1975, loss=1.1845, param_norm=1886.5204
Step 173: grad_norm=17.9101, loss=1.1457, param_norm=1886.5206
Step 174: grad_norm=18.5721, loss=1.2228, param_norm=1886.5210
Step 175: grad_norm=11.7859, loss=1.0534, param_norm=1886.5214
Step 176: grad_norm=12.3971, loss=1.1288, param_norm=1886.5219
22:25:16.816 [I] Progress on: 176it/1.00kit rate:1.4s/it remaining:19:06 elapsed:03:57 postfix:-  (3498277:tqdm_logging.py:145)
Step 177: grad_norm=15.7461, loss=1.2250, param_norm=1886.5222
Step 178: grad_norm=5.4291, loss=1.2937, param_norm=1886.5226
Step 179: grad_norm=5.1287, loss=1.0290, param_norm=1886.5229
Step 180: grad_norm=12.2513, loss=1.1409, param_norm=1886.5232
Step 181: grad_norm=8.7573, loss=1.1348, param_norm=1886.5237
Step 182: grad_norm=19.9434, loss=1.1985, param_norm=1886.5239
Step 183: grad_norm=26.3280, loss=1.0384, param_norm=1886.5243
Step 184: grad_norm=14.5321, loss=1.1971, param_norm=1886.5247
Step 185: grad_norm=5.0111, loss=1.2863, param_norm=1886.5250
22:25:27.028 [I] Progress on: 185it/1.00kit rate:1.1s/it remaining:15:32 elapsed:04:07 postfix:-  (3498277:tqdm_logging.py:145)
Step 186: grad_norm=9.3336, loss=1.2972, param_norm=1886.5254
Step 187: grad_norm=13.6205, loss=1.1120, param_norm=1886.5256
Step 188: grad_norm=5.1809, loss=1.1456, param_norm=1886.5260
Step 189: grad_norm=31.8231, loss=1.3937, param_norm=1886.5264
Step 190: grad_norm=21.5582, loss=1.1921, param_norm=1886.5267
Step 191: grad_norm=9.1375, loss=1.2076, param_norm=1886.5271
Step 192: grad_norm=4.7554, loss=1.1319, param_norm=1886.5275
Step 193: grad_norm=4.7710, loss=1.0510, param_norm=1886.5277
22:25:37.733 [I] Progress on: 193it/1.00kit rate:1.3s/it remaining:17:57 elapsed:04:18 postfix:-  (3498277:tqdm_logging.py:145)
Step 194: grad_norm=40.8308, loss=1.2472, param_norm=1886.5282
Step 195: grad_norm=17.9018, loss=1.2091, param_norm=1886.5286
Step 196: grad_norm=10.8632, loss=1.1831, param_norm=1886.5289
Step 197: grad_norm=12.4197, loss=1.1202, param_norm=1886.5292
Step 198: grad_norm=5.7724, loss=1.1575, param_norm=1886.5297
Step 199: grad_norm=12.0885, loss=1.0912, param_norm=1886.5299
Step 200: grad_norm=11.7841, loss=1.0948, param_norm=1886.5303
22:25:46.778 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:25:46.779 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:25:46.779 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (3498277:checkpoint_manager.py:1786)
22:25:46.779 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (3498277:checkpoint_manager.py:1817)
22:25:46.780 [I] [process=0] Saving checkpoint at step 200                                        (3498277:checkpoint_manager.py:1286)
22:25:46.780 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200. (3498277:async_checkpointer.py:358)
22:25:46.782 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:25:46.782 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3 (3498277:atomicity.py:144)
22:25:46.783 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:25:46.784 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:25:46.785 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (3498277:atomicity.py:144)
22:25:46.785 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (3498277:atomicity.py:144)
22:25:46.786 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:25:46.791 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:25:50.826 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:25:50.842 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:25:50.847 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:25:50.850 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:25:50.871 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:25:50.880 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:25:50.892 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:25:50.905 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:25:50.908 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783146.7787752, 'wait_for_prev_duration_secs': 0.0010995864868164062, 'checkpointer_blocking_start_time': 1742783146.7805355, 'checkpointer_blocking_duration_secs': 4.090581655502319, 'get_old_steps_start_time': 1742783150.8712037, 'get_old_steps_duration_secs': 0.008905649185180664, 'checkpoint_manager_blocking_start_time': 1742783146.778698, 'checkpoint_manager_blocking_duration_secs': 4.129567623138428} (3498277:standard_logger.py:34)
22:25:50.923 [I] Progress on: 201it/1.00kit rate:2.5s/it remaining:32:40 elapsed:04:31 postfix:-  (3498277:tqdm_logging.py:145)
Step 201: grad_norm=4.6624, loss=1.1835, param_norm=1886.5306
Step 202: grad_norm=7.1756, loss=1.1100, param_norm=1886.5309
Step 203: grad_norm=16.0374, loss=1.0957, param_norm=1886.5312
Step 204: grad_norm=13.7712, loss=1.0509, param_norm=1886.5316
Step 205: grad_norm=5.6633, loss=0.9416, param_norm=1886.5319
Step 206: grad_norm=8.2633, loss=1.1413, param_norm=1886.5322
Step 207: grad_norm=9.6391, loss=1.0145, param_norm=1886.5325
22:25:59.852 [I] ChainedFuture completed 1/1 futures in 8.99 seconds.                             (3498277:future.py:137)
22:25:59.855 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 792.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:25:59.856 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:25:59.860 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3 (3498277:async_checkpointer.py:406)
22:25:59.862 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3/assets (3498277:atomicity.py:287)
22:25:59.883 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3/params (3498277:atomicity.py:287)
22:25:59.885 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200 (3498277:async_checkpointer.py:416)
22:25:59.885 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3 (3498277:async_checkpointer.py:426)
22:25:59.886 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200 (3498277:atomicity.py:287)
22:25:59.891 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/200`. (3498277:atomicity.py:548)
22:25:59.892 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:25:59.893 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:25:59.894 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:25:59.896 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:25:59.896 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 208: grad_norm=6.7481, loss=0.8288, param_norm=1886.5330
22:26:00.964 [I] Progress on: 209it/1.00kit rate:1.4s/it remaining:18:30 elapsed:04:41 postfix:-  (3498277:tqdm_logging.py:145)
Step 209: grad_norm=4.7660, loss=0.9742, param_norm=1886.5332
Step 210: grad_norm=11.4905, loss=0.9216, param_norm=1886.5336
Step 211: grad_norm=5.1075, loss=0.9816, param_norm=1886.5339
Step 212: grad_norm=11.9220, loss=0.9797, param_norm=1886.5343
Step 213: grad_norm=12.6680, loss=0.7620, param_norm=1886.5345
Step 214: grad_norm=5.5223, loss=0.7870, param_norm=1886.5350
Step 215: grad_norm=4.6437, loss=0.8580, param_norm=1886.5354
Step 216: grad_norm=5.9458, loss=0.8744, param_norm=1886.5359
22:26:12.055 [I] Progress on: 216it/1.00kit rate:1.4s/it remaining:17:45 elapsed:04:52 postfix:-  (3498277:tqdm_logging.py:145)
Step 217: grad_norm=11.9090, loss=0.9185, param_norm=1886.5363
Step 218: grad_norm=6.6941, loss=0.7553, param_norm=1886.5366
Step 219: grad_norm=12.6504, loss=0.9857, param_norm=1886.5371
Step 220: grad_norm=12.2759, loss=0.8889, param_norm=1886.5375
Step 221: grad_norm=5.4755, loss=0.8313, param_norm=1886.5380
Step 222: grad_norm=9.0423, loss=0.9581, param_norm=1886.5383
Step 223: grad_norm=9.3064, loss=0.9497, param_norm=1886.5387
Step 224: grad_norm=12.6839, loss=0.8911, param_norm=1886.5391
Step 225: grad_norm=10.9852, loss=0.8710, param_norm=1886.5394
22:26:22.240 [I] Progress on: 225it/1.00kit rate:1.2s/it remaining:14:55 elapsed:05:02 postfix:-  (3498277:tqdm_logging.py:145)
Step 226: grad_norm=8.0460, loss=0.8096, param_norm=1886.5398
Step 227: grad_norm=16.3766, loss=1.0437, param_norm=1886.5402
Step 228: grad_norm=5.6526, loss=1.0450, param_norm=1886.5405
Step 229: grad_norm=13.9325, loss=0.8188, param_norm=1886.5408
Step 230: grad_norm=8.2191, loss=0.9750, param_norm=1886.5413
Step 231: grad_norm=5.8738, loss=0.8485, param_norm=1886.5415
Step 232: grad_norm=6.9893, loss=1.0234, param_norm=1886.5417
Step 233: grad_norm=11.2657, loss=1.0088, param_norm=1886.5422
22:26:33.133 [I] Progress on: 233it/1.00kit rate:1.4s/it remaining:17:52 elapsed:05:13 postfix:-  (3498277:tqdm_logging.py:145)
Step 234: grad_norm=10.7739, loss=0.8675, param_norm=1886.5426
Step 235: grad_norm=9.0618, loss=1.0780, param_norm=1886.5431
Step 236: grad_norm=9.4863, loss=0.9110, param_norm=1886.5433
Step 237: grad_norm=7.2748, loss=0.7142, param_norm=1886.5438
Step 238: grad_norm=5.4089, loss=0.9240, param_norm=1886.5443
Step 239: grad_norm=7.4494, loss=0.8321, param_norm=1886.5447
Step 240: grad_norm=16.7426, loss=0.9438, param_norm=1886.5452
Step 241: grad_norm=10.8917, loss=0.7808, param_norm=1886.5455
22:26:43.184 [I] Progress on: 241it/1.00kit rate:1.2s/it remaining:15:04 elapsed:05:23 postfix:-  (3498277:tqdm_logging.py:145)
Step 242: grad_norm=15.4934, loss=0.8714, param_norm=1886.5460
Step 243: grad_norm=17.9941, loss=1.0291, param_norm=1886.5464
Step 244: grad_norm=5.3423, loss=0.8100, param_norm=1886.5468
Step 245: grad_norm=14.7073, loss=1.0822, param_norm=1886.5471
Step 246: grad_norm=16.5692, loss=1.0204, param_norm=1886.5475
Step 247: grad_norm=16.0815, loss=1.1175, param_norm=1886.5477
Step 248: grad_norm=14.3226, loss=1.0620, param_norm=1886.5480
Step 249: grad_norm=14.1038, loss=0.8695, param_norm=1886.5483
Step 250: grad_norm=5.3363, loss=0.7901, param_norm=1886.5486
22:26:54.231 [I] Progress on: 250it/1.00kit rate:1.3s/it remaining:15:55 elapsed:05:34 postfix:-  (3498277:tqdm_logging.py:145)
Step 251: grad_norm=11.2062, loss=0.9897, param_norm=1886.5488
Step 252: grad_norm=6.8974, loss=0.7834, param_norm=1886.5492
Step 253: grad_norm=5.6519, loss=0.7014, param_norm=1886.5494
Step 254: grad_norm=6.7138, loss=0.9428, param_norm=1886.5498
Step 255: grad_norm=9.5441, loss=0.9018, param_norm=1886.5500
Step 256: grad_norm=10.6805, loss=0.8961, param_norm=1886.5504
Step 257: grad_norm=5.3582, loss=0.9309, param_norm=1886.5508
Step 258: grad_norm=7.9152, loss=0.9976, param_norm=1886.5510
22:27:05.256 [I] Progress on: 258it/1.00kit rate:1.4s/it remaining:17:33 elapsed:05:45 postfix:-  (3498277:tqdm_logging.py:145)
Step 259: grad_norm=8.6225, loss=0.9084, param_norm=1886.5514
Step 260: grad_norm=9.7935, loss=0.8743, param_norm=1886.5518
Step 261: grad_norm=19.7631, loss=0.9870, param_norm=1886.5520
Step 262: grad_norm=5.6380, loss=0.8045, param_norm=1886.5522
Step 263: grad_norm=7.8129, loss=0.7999, param_norm=1886.5526
Step 264: grad_norm=8.5602, loss=0.8826, param_norm=1886.5529
Step 265: grad_norm=5.3487, loss=1.0036, param_norm=1886.5532
Step 266: grad_norm=5.5182, loss=0.8729, param_norm=1886.5535
Step 267: grad_norm=9.8969, loss=0.8571, param_norm=1886.5537
22:27:15.466 [I] Progress on: 267it/1.00kit rate:1.1s/it remaining:13:55 elapsed:05:55 postfix:-  (3498277:tqdm_logging.py:145)
Step 268: grad_norm=24.0209, loss=0.8104, param_norm=1886.5540
Step 269: grad_norm=33.0886, loss=0.9604, param_norm=1886.5543
Step 270: grad_norm=10.7738, loss=0.9572, param_norm=1886.5547
Step 271: grad_norm=13.9717, loss=0.9127, param_norm=1886.5549
Step 272: grad_norm=15.8006, loss=0.9477, param_norm=1886.5553
Step 273: grad_norm=5.2956, loss=0.8761, param_norm=1886.5555
Step 274: grad_norm=12.0572, loss=0.9992, param_norm=1886.5559
Step 275: grad_norm=8.8188, loss=0.8664, param_norm=1886.5562
22:27:26.627 [I] Progress on: 275it/1.00kit rate:1.4s/it remaining:16:22 elapsed:06:06 postfix:-  (3498277:tqdm_logging.py:145)
Step 276: grad_norm=6.3497, loss=0.5786, param_norm=1886.5565
Step 277: grad_norm=6.1579, loss=0.8722, param_norm=1886.5568
Step 278: grad_norm=16.5011, loss=0.6578, param_norm=1886.5571
Step 279: grad_norm=14.0584, loss=0.6617, param_norm=1886.5573
Step 280: grad_norm=9.1212, loss=0.5826, param_norm=1886.5576
Step 281: grad_norm=5.5437, loss=0.8498, param_norm=1886.5579
Step 282: grad_norm=9.1294, loss=0.7099, param_norm=1886.5582
Step 283: grad_norm=5.6916, loss=0.7797, param_norm=1886.5585
22:27:36.639 [I] Progress on: 283it/1.00kit rate:1.2s/it remaining:14:08 elapsed:06:16 postfix:-  (3498277:tqdm_logging.py:145)
Step 284: grad_norm=5.2499, loss=0.8061, param_norm=1886.5587
Step 285: grad_norm=15.0185, loss=0.6424, param_norm=1886.5591
Step 286: grad_norm=7.4924, loss=0.6863, param_norm=1886.5594
Step 287: grad_norm=6.0850, loss=0.7872, param_norm=1886.5597
Step 288: grad_norm=7.6848, loss=0.7094, param_norm=1886.5601
Step 289: grad_norm=14.1616, loss=0.8050, param_norm=1886.5604
Step 290: grad_norm=15.1956, loss=0.7810, param_norm=1886.5608
Step 291: grad_norm=7.6911, loss=0.7005, param_norm=1886.5610
Step 292: grad_norm=6.7507, loss=0.7621, param_norm=1886.5614
22:27:47.722 [I] Progress on: 292it/1.00kit rate:1.3s/it remaining:14:48 elapsed:06:28 postfix:-  (3498277:tqdm_logging.py:145)
Step 293: grad_norm=5.1791, loss=0.7301, param_norm=1886.5618
Step 294: grad_norm=4.8476, loss=0.5978, param_norm=1886.5621
Step 295: grad_norm=16.1955, loss=0.8762, param_norm=1886.5624
Step 296: grad_norm=7.6863, loss=0.4877, param_norm=1886.5626
Step 297: grad_norm=16.5339, loss=0.7909, param_norm=1886.5630
Step 298: grad_norm=9.5114, loss=0.7901, param_norm=1886.5632
Step 299: grad_norm=5.1634, loss=0.8437, param_norm=1886.5636
Step 300: grad_norm=9.2624, loss=0.6144, param_norm=1886.5638
22:27:58.627 [I] Progress on: 300it/1.00kit rate:1.4s/it remaining:16:12 elapsed:06:38 postfix:-  (3498277:tqdm_logging.py:145)
22:27:58.662 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:27:58.662 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:27:58.662 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (3498277:checkpoint_manager.py:1786)
22:27:58.662 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (3498277:checkpoint_manager.py:1817)
22:27:58.663 [I] [process=0] Saving checkpoint at step 300                                        (3498277:checkpoint_manager.py:1286)
22:27:58.663 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300. (3498277:async_checkpointer.py:358)
22:27:58.664 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:27:58.665 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6 (3498277:atomicity.py:144)
22:27:58.689 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:27:58.690 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:27:58.715 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (3498277:atomicity.py:144)
22:27:58.716 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (3498277:atomicity.py:144)
22:27:58.717 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:27:58.730 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:28:02.423 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:28:02.427 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:28:02.428 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:28:02.430 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:28:02.437 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:28:02.440 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:28:02.441 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:28:02.442 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:28:02.450 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:28:02.451 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783278.6619964, 'wait_for_prev_duration_secs': 0.0007140636444091797, 'checkpointer_blocking_start_time': 1742783278.6632907, 'checkpointer_blocking_duration_secs': 3.774343252182007, 'get_old_steps_start_time': 1742783282.4376943, 'get_old_steps_duration_secs': 0.003463268280029297, 'checkpoint_manager_blocking_start_time': 1742783278.6618793, 'checkpoint_manager_blocking_duration_secs': 3.789271354675293} (3498277:standard_logger.py:34)
Step 301: grad_norm=4.5923, loss=0.5939, param_norm=1886.5642
Step 302: grad_norm=4.7196, loss=0.5485, param_norm=1886.5645
Step 303: grad_norm=9.6848, loss=0.7375, param_norm=1886.5647
Step 304: grad_norm=5.9028, loss=0.7572, param_norm=1886.5649
Step 305: grad_norm=8.9343, loss=0.7710, param_norm=1886.5652
Step 306: grad_norm=13.2027, loss=0.7881, param_norm=1886.5656
22:28:09.076 [I] Progress on: 306it/1.00kit rate:1.3s/it remaining:15:21 elapsed:06:49 postfix:-  (3498277:tqdm_logging.py:145)
Step 307: grad_norm=20.4346, loss=0.6349, param_norm=1886.5658
22:28:11.193 [I] ChainedFuture completed 1/1 futures in 8.76 seconds.                             (3498277:future.py:137)
22:28:11.194 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 830.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:28:11.195 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:28:11.198 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6 (3498277:async_checkpointer.py:406)
22:28:11.199 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6/assets (3498277:atomicity.py:287)
22:28:11.215 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6/params (3498277:atomicity.py:287)
22:28:11.217 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300 (3498277:async_checkpointer.py:416)
22:28:11.217 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6 (3498277:async_checkpointer.py:426)
22:28:11.217 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300 (3498277:atomicity.py:287)
22:28:11.220 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/300`. (3498277:atomicity.py:548)
22:28:11.221 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:28:11.221 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:28:11.223 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:28:11.224 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:28:11.225 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 308: grad_norm=7.7995, loss=0.6695, param_norm=1886.5660
Step 309: grad_norm=13.7196, loss=0.8849, param_norm=1886.5664
Step 310: grad_norm=5.4393, loss=0.6568, param_norm=1886.5667
Step 311: grad_norm=5.8041, loss=0.8783, param_norm=1886.5670
Step 312: grad_norm=4.6489, loss=0.7127, param_norm=1886.5673
Step 313: grad_norm=6.0732, loss=0.7295, param_norm=1886.5676
Step 314: grad_norm=10.6034, loss=0.7545, param_norm=1886.5680
22:28:19.916 [I] Progress on: 314it/1.00kit rate:1.3s/it remaining:15:21 elapsed:07:00 postfix:-  (3498277:tqdm_logging.py:145)
Step 315: grad_norm=6.8820, loss=0.7250, param_norm=1886.5685
Step 316: grad_norm=9.3091, loss=0.8028, param_norm=1886.5687
Step 317: grad_norm=6.2767, loss=0.7825, param_norm=1886.5691
Step 318: grad_norm=9.6514, loss=0.6577, param_norm=1886.5693
Step 319: grad_norm=6.7864, loss=0.6695, param_norm=1886.5697
Step 320: grad_norm=6.1596, loss=0.7262, param_norm=1886.5701
Step 321: grad_norm=6.4504, loss=0.8047, param_norm=1886.5704
Step 322: grad_norm=5.1291, loss=0.6668, param_norm=1886.5708
22:28:29.995 [I] Progress on: 322it/1.00kit rate:1.2s/it remaining:13:32 elapsed:07:10 postfix:-  (3498277:tqdm_logging.py:145)
Step 323: grad_norm=4.8747, loss=0.7421, param_norm=1886.5710
Step 324: grad_norm=11.9168, loss=0.6433, param_norm=1886.5714
Step 325: grad_norm=4.3187, loss=0.5208, param_norm=1886.5717
Step 326: grad_norm=10.6742, loss=0.6917, param_norm=1886.5720
Step 327: grad_norm=5.9100, loss=0.6211, param_norm=1886.5723
Step 328: grad_norm=5.8237, loss=0.7398, param_norm=1886.5726
Step 329: grad_norm=10.2140, loss=0.6965, param_norm=1886.5730
Step 330: grad_norm=9.7952, loss=0.6444, param_norm=1886.5732
Step 331: grad_norm=12.5831, loss=0.7598, param_norm=1886.5735
22:28:41.048 [I] Progress on: 331it/1.00kit rate:1.3s/it remaining:14:08 elapsed:07:21 postfix:-  (3498277:tqdm_logging.py:145)
Step 332: grad_norm=5.1111, loss=0.7508, param_norm=1886.5737
Step 333: grad_norm=5.4582, loss=0.7992, param_norm=1886.5740
Step 334: grad_norm=6.3017, loss=0.6775, param_norm=1886.5742
Step 335: grad_norm=7.9457, loss=0.7275, param_norm=1886.5743
Step 336: grad_norm=5.1118, loss=0.6729, param_norm=1886.5746
Step 337: grad_norm=6.8733, loss=0.5936, param_norm=1886.5750
Step 338: grad_norm=12.8871, loss=0.8497, param_norm=1886.5751
Step 339: grad_norm=8.4254, loss=0.6658, param_norm=1886.5753
22:28:51.958 [I] Progress on: 339it/1.00kit rate:1.4s/it remaining:15:12 elapsed:07:32 postfix:-  (3498277:tqdm_logging.py:145)
Step 340: grad_norm=4.1874, loss=0.5430, param_norm=1886.5756
Step 341: grad_norm=9.4567, loss=0.8208, param_norm=1886.5758
Step 342: grad_norm=9.9269, loss=0.6510, param_norm=1886.5760
Step 343: grad_norm=7.6474, loss=0.7693, param_norm=1886.5763
Step 344: grad_norm=13.5748, loss=0.8385, param_norm=1886.5764
Step 345: grad_norm=4.5355, loss=0.5719, param_norm=1886.5767
Step 346: grad_norm=4.9178, loss=0.5678, param_norm=1886.5770
Step 347: grad_norm=4.4638, loss=0.5783, param_norm=1886.5771
Step 348: grad_norm=5.7414, loss=0.4618, param_norm=1886.5775
22:29:02.592 [I] Progress on: 348it/1.00kit rate:1.2s/it remaining:12:31 elapsed:07:42 postfix:-  (3498277:tqdm_logging.py:145)
Step 349: grad_norm=7.1695, loss=0.6051, param_norm=1886.5778
Step 350: grad_norm=8.4085, loss=0.6574, param_norm=1886.5780
Step 351: grad_norm=10.7339, loss=0.5574, param_norm=1886.5784
Step 352: grad_norm=9.7843, loss=0.5291, param_norm=1886.5786
Step 353: grad_norm=5.2898, loss=0.6201, param_norm=1886.5789
Step 354: grad_norm=12.7627, loss=0.8077, param_norm=1886.5792
Step 355: grad_norm=8.9799, loss=0.5740, param_norm=1886.5795
22:29:12.658 [I] Progress on: 355it/1.00kit rate:1.4s/it remaining:14:53 elapsed:07:53 postfix:-  (3498277:tqdm_logging.py:145)
Step 356: grad_norm=5.9533, loss=0.6459, param_norm=1886.5797
Step 357: grad_norm=4.1897, loss=0.5047, param_norm=1886.5800
Step 358: grad_norm=8.2543, loss=0.4193, param_norm=1886.5802
Step 359: grad_norm=6.0877, loss=0.5577, param_norm=1886.5804
Step 360: grad_norm=5.8748, loss=0.6053, param_norm=1886.5808
Step 361: grad_norm=8.3919, loss=0.5988, param_norm=1886.5811
Step 362: grad_norm=4.4069, loss=0.5441, param_norm=1886.5812
Step 363: grad_norm=7.7726, loss=0.5659, param_norm=1886.5813
Step 364: grad_norm=8.3653, loss=0.5789, param_norm=1886.5815
22:29:23.561 [I] Progress on: 364it/1.00kit rate:1.2s/it remaining:12:30 elapsed:08:03 postfix:-  (3498277:tqdm_logging.py:145)
Step 365: grad_norm=7.3886, loss=0.6639, param_norm=1886.5817
Step 366: grad_norm=6.1334, loss=0.4968, param_norm=1886.5819
Step 367: grad_norm=5.3583, loss=0.5771, param_norm=1886.5820
Step 368: grad_norm=5.0719, loss=0.4193, param_norm=1886.5823
Step 369: grad_norm=7.6827, loss=0.5347, param_norm=1886.5824
Step 370: grad_norm=5.2868, loss=0.5029, param_norm=1886.5826
Step 371: grad_norm=4.5959, loss=0.5620, param_norm=1886.5828
Step 372: grad_norm=7.7920, loss=0.6037, param_norm=1886.5831
Step 373: grad_norm=4.6383, loss=0.5146, param_norm=1886.5833
22:29:34.792 [I] Progress on: 373it/1.00kit rate:1.3s/it remaining:13:56 elapsed:08:15 postfix:-  (3498277:tqdm_logging.py:145)
Step 374: grad_norm=5.5461, loss=0.6109, param_norm=1886.5834
Step 375: grad_norm=12.6878, loss=0.5244, param_norm=1886.5836
Step 376: grad_norm=6.6534, loss=0.6135, param_norm=1886.5840
Step 377: grad_norm=6.4435, loss=0.6035, param_norm=1886.5842
Step 378: grad_norm=6.5437, loss=0.5950, param_norm=1886.5844
Step 379: grad_norm=6.5949, loss=0.6142, param_norm=1886.5847
Step 380: grad_norm=4.9209, loss=0.5811, param_norm=1886.5850
Step 381: grad_norm=5.4537, loss=0.5301, param_norm=1886.5852
22:29:45.303 [I] Progress on: 381it/1.00kit rate:1.3s/it remaining:13:11 elapsed:08:25 postfix:-  (3498277:tqdm_logging.py:145)
Step 382: grad_norm=5.0661, loss=0.5557, param_norm=1886.5856
Step 383: grad_norm=6.6382, loss=0.5880, param_norm=1886.5858
Step 384: grad_norm=10.6538, loss=0.5410, param_norm=1886.5861
Step 385: grad_norm=4.6495, loss=0.5429, param_norm=1886.5864
Step 386: grad_norm=9.4316, loss=0.5174, param_norm=1886.5865
Step 387: grad_norm=6.2729, loss=0.6628, param_norm=1886.5869
Step 388: grad_norm=8.8119, loss=0.6030, param_norm=1886.5872
Step 389: grad_norm=7.3780, loss=0.5385, param_norm=1886.5874
Step 390: grad_norm=7.6958, loss=0.5996, param_norm=1886.5876
22:29:56.170 [I] Progress on: 390it/1.00kit rate:1.2s/it remaining:12:03 elapsed:08:36 postfix:-  (3498277:tqdm_logging.py:145)
Step 391: grad_norm=4.6185, loss=0.5534, param_norm=1886.5879
Step 392: grad_norm=10.5198, loss=0.5249, param_norm=1886.5880
Step 393: grad_norm=11.6684, loss=0.4381, param_norm=1886.5883
Step 394: grad_norm=8.4501, loss=0.5435, param_norm=1886.5886
Step 395: grad_norm=4.9575, loss=0.5501, param_norm=1886.5889
Step 396: grad_norm=7.3403, loss=0.5967, param_norm=1886.5892
Step 397: grad_norm=4.5017, loss=0.5161, param_norm=1886.5894
Step 398: grad_norm=6.3604, loss=0.4901, param_norm=1886.5896
22:30:07.106 [I] Progress on: 398it/1.00kit rate:1.4s/it remaining:13:54 elapsed:08:47 postfix:-  (3498277:tqdm_logging.py:145)
Step 399: grad_norm=15.7725, loss=0.5344, param_norm=1886.5900
Step 400: grad_norm=4.8113, loss=0.5677, param_norm=1886.5902
22:30:09.851 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:30:09.851 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:30:09.852 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (3498277:checkpoint_manager.py:1786)
22:30:09.852 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (3498277:checkpoint_manager.py:1817)
22:30:09.852 [I] [process=0] Saving checkpoint at step 400                                        (3498277:checkpoint_manager.py:1286)
22:30:09.853 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400. (3498277:async_checkpointer.py:358)
22:30:09.854 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:30:09.854 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9 (3498277:atomicity.py:144)
22:30:09.855 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:30:09.856 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:30:09.857 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (3498277:atomicity.py:144)
22:30:09.857 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (3498277:atomicity.py:144)
22:30:09.857 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:30:09.862 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:30:13.647 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:30:13.648 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:30:13.650 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:30:13.652 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:30:13.676 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:30:13.677 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:30:13.678 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:30:13.681 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:30:13.685 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:30:13.687 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:30:13.690 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783409.851501, 'wait_for_prev_duration_secs': 0.0007250308990478516, 'checkpointer_blocking_start_time': 1742783409.852809, 'checkpointer_blocking_duration_secs': 3.823004722595215, 'get_old_steps_start_time': 1742783413.6758986, 'get_old_steps_duration_secs': 0.00552821159362793, 'checkpoint_manager_blocking_start_time': 1742783409.851328, 'checkpoint_manager_blocking_duration_secs': 3.83886456489563} (3498277:standard_logger.py:34)
Step 401: grad_norm=4.4797, loss=0.5552, param_norm=1886.5905
Step 402: grad_norm=8.0641, loss=0.8356, param_norm=1886.5906
Step 403: grad_norm=14.8912, loss=0.4800, param_norm=1886.5908
22:30:17.175 [I] Progress on: 403it/1.00kit rate:1.8s/it remaining:18:07 elapsed:08:57 postfix:-  (3498277:tqdm_logging.py:145)
Step 404: grad_norm=4.4529, loss=0.4567, param_norm=1886.5911
Step 405: grad_norm=10.0427, loss=0.6137, param_norm=1886.5913
Step 406: grad_norm=6.0746, loss=0.5721, param_norm=1886.5917
Step 407: grad_norm=12.4973, loss=0.5851, param_norm=1886.5918
22:30:22.465 [I] ChainedFuture completed 1/1 futures in 8.81 seconds.                             (3498277:future.py:137)
22:30:22.466 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 821.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:30:22.467 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:30:22.471 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9 (3498277:async_checkpointer.py:406)
22:30:22.472 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9/assets (3498277:atomicity.py:287)
22:30:22.490 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9/params (3498277:atomicity.py:287)
22:30:22.491 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400 (3498277:async_checkpointer.py:416)
22:30:22.492 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9 (3498277:async_checkpointer.py:426)
22:30:22.493 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400 (3498277:atomicity.py:287)
22:30:22.495 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/400`. (3498277:atomicity.py:548)
22:30:22.496 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:30:22.497 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:30:22.497 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:30:22.498 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:30:22.498 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 408: grad_norm=4.1680, loss=0.4086, param_norm=1886.5920
Step 409: grad_norm=8.3788, loss=0.4851, param_norm=1886.5924
Step 410: grad_norm=8.3058, loss=0.5003, param_norm=1886.5925
Step 411: grad_norm=6.2967, loss=0.5469, param_norm=1886.5928
22:30:27.229 [I] Progress on: 411it/1.00kit rate:1.4s/it remaining:13:15 elapsed:09:07 postfix:-  (3498277:tqdm_logging.py:145)
Step 412: grad_norm=13.1807, loss=0.6498, param_norm=1886.5929
Step 413: grad_norm=6.5172, loss=0.5670, param_norm=1886.5931
Step 414: grad_norm=4.2972, loss=0.3525, param_norm=1886.5934
Step 415: grad_norm=3.4422, loss=0.3449, param_norm=1886.5935
Step 416: grad_norm=4.4226, loss=0.4800, param_norm=1886.5938
Step 417: grad_norm=7.6987, loss=0.3698, param_norm=1886.5940
Step 418: grad_norm=12.0349, loss=0.4845, param_norm=1886.5942
Step 419: grad_norm=10.1515, loss=0.5190, param_norm=1886.5944
22:30:38.192 [I] Progress on: 419it/1.00kit rate:1.3s/it remaining:12:40 elapsed:09:18 postfix:-  (3498277:tqdm_logging.py:145)
Step 420: grad_norm=6.0768, loss=0.4764, param_norm=1886.5945
Step 421: grad_norm=6.5247, loss=0.3709, param_norm=1886.5948
Step 422: grad_norm=4.1319, loss=0.4417, param_norm=1886.5950
Step 423: grad_norm=7.3646, loss=0.4404, param_norm=1886.5952
Step 424: grad_norm=6.9541, loss=0.3884, param_norm=1886.5955
Step 425: grad_norm=4.0586, loss=0.3984, param_norm=1886.5956
Step 426: grad_norm=7.6818, loss=0.4913, param_norm=1886.5957
Step 427: grad_norm=5.9959, loss=0.5957, param_norm=1886.5959
Step 428: grad_norm=6.9430, loss=0.4687, param_norm=1886.5962
22:30:48.350 [I] Progress on: 428it/1.00kit rate:1.1s/it remaining:10:39 elapsed:09:28 postfix:-  (3498277:tqdm_logging.py:145)
Step 429: grad_norm=11.9641, loss=0.4250, param_norm=1886.5963
Step 430: grad_norm=7.0797, loss=0.4792, param_norm=1886.5964
Step 431: grad_norm=6.3796, loss=0.4512, param_norm=1886.5966
Step 432: grad_norm=27.3809, loss=0.3775, param_norm=1886.5968
Step 433: grad_norm=7.5162, loss=0.4939, param_norm=1886.5970
Step 434: grad_norm=4.5987, loss=0.3585, param_norm=1886.5972
Step 435: grad_norm=8.6304, loss=0.3202, param_norm=1886.5973
22:30:58.429 [I] Progress on: 435it/1.00kit rate:1.4s/it remaining:13:14 elapsed:09:38 postfix:-  (3498277:tqdm_logging.py:145)
Step 436: grad_norm=12.4287, loss=0.4424, param_norm=1886.5975
Step 437: grad_norm=4.4635, loss=0.3708, param_norm=1886.5979
Step 438: grad_norm=12.2538, loss=0.4798, param_norm=1886.5979
Step 439: grad_norm=6.6661, loss=0.3648, param_norm=1886.5981
Step 440: grad_norm=5.7966, loss=0.4850, param_norm=1886.5983
Step 441: grad_norm=9.4905, loss=0.4529, param_norm=1886.5985
Step 442: grad_norm=14.1771, loss=0.5037, param_norm=1886.5988
Step 443: grad_norm=11.3572, loss=0.4265, param_norm=1886.5989
Step 444: grad_norm=7.4078, loss=0.5305, param_norm=1886.5991
22:31:09.515 [I] Progress on: 444it/1.00kit rate:1.2s/it remaining:11:15 elapsed:09:49 postfix:-  (3498277:tqdm_logging.py:145)
Step 445: grad_norm=4.8423, loss=0.5450, param_norm=1886.5992
Step 446: grad_norm=5.7902, loss=0.3816, param_norm=1886.5995
Step 447: grad_norm=4.0565, loss=0.3352, param_norm=1886.5997
Step 448: grad_norm=3.9237, loss=0.4324, param_norm=1886.5999
Step 449: grad_norm=10.1501, loss=0.4135, param_norm=1886.6001
Step 450: grad_norm=5.4446, loss=0.4543, param_norm=1886.6002
Step 451: grad_norm=4.6882, loss=0.4322, param_norm=1886.6005
Step 452: grad_norm=4.6982, loss=0.4166, param_norm=1886.6006
Step 453: grad_norm=14.5649, loss=0.4939, param_norm=1886.6008
22:31:20.112 [I] Progress on: 453it/1.00kit rate:1.3s/it remaining:11:27 elapsed:10:00 postfix:-  (3498277:tqdm_logging.py:145)
Step 454: grad_norm=5.3495, loss=0.4962, param_norm=1886.6011
Step 455: grad_norm=5.0467, loss=0.4868, param_norm=1886.6013
Step 456: grad_norm=4.7739, loss=0.5001, param_norm=1886.6016
Step 457: grad_norm=4.9138, loss=0.4548, param_norm=1886.6018
Step 458: grad_norm=4.3700, loss=0.3946, param_norm=1886.6021
Step 459: grad_norm=6.8391, loss=0.4430, param_norm=1886.6024
Step 460: grad_norm=5.5019, loss=0.4454, param_norm=1886.6027
Step 461: grad_norm=3.7295, loss=0.3351, param_norm=1886.6029
22:31:31.423 [I] Progress on: 461it/1.00kit rate:1.4s/it remaining:12:27 elapsed:10:11 postfix:-  (3498277:tqdm_logging.py:145)
Step 462: grad_norm=7.4548, loss=0.4567, param_norm=1886.6031
Step 463: grad_norm=4.1304, loss=0.4590, param_norm=1886.6034
Step 464: grad_norm=4.2244, loss=0.3944, param_norm=1886.6036
Step 465: grad_norm=8.4756, loss=0.4813, param_norm=1886.6039
Step 466: grad_norm=6.8473, loss=0.4379, param_norm=1886.6041
Step 467: grad_norm=4.6699, loss=0.4639, param_norm=1886.6042
Step 468: grad_norm=3.8985, loss=0.3731, param_norm=1886.6045
Step 469: grad_norm=7.3051, loss=0.4126, param_norm=1886.6047
Step 470: grad_norm=4.2896, loss=0.3687, param_norm=1886.6049
22:31:41.652 [I] Progress on: 470it/1.00kit rate:1.2s/it remaining:10:17 elapsed:10:21 postfix:-  (3498277:tqdm_logging.py:145)
Step 471: grad_norm=9.5527, loss=0.5470, param_norm=1886.6050
Step 472: grad_norm=5.9797, loss=0.4770, param_norm=1886.6052
Step 473: grad_norm=4.3428, loss=0.3909, param_norm=1886.6056
Step 474: grad_norm=6.5731, loss=0.4416, param_norm=1886.6057
Step 475: grad_norm=8.2024, loss=0.3987, param_norm=1886.6060
Step 476: grad_norm=4.0268, loss=0.3983, param_norm=1886.6061
Step 477: grad_norm=4.0087, loss=0.4089, param_norm=1886.6063
Step 478: grad_norm=8.1157, loss=0.4926, param_norm=1886.6066
22:31:52.845 [I] Progress on: 478it/1.00kit rate:1.4s/it remaining:12:05 elapsed:10:33 postfix:-  (3498277:tqdm_logging.py:145)
Step 479: grad_norm=4.6306, loss=0.4597, param_norm=1886.6066
Step 480: grad_norm=4.0727, loss=0.3727, param_norm=1886.6067
Step 481: grad_norm=11.3786, loss=0.5159, param_norm=1886.6069
Step 482: grad_norm=5.1824, loss=0.4277, param_norm=1886.6071
Step 483: grad_norm=4.3295, loss=0.3818, param_norm=1886.6072
Step 484: grad_norm=3.2282, loss=0.3107, param_norm=1886.6073
Step 485: grad_norm=2.8335, loss=0.2116, param_norm=1886.6075
Step 486: grad_norm=4.8353, loss=0.3139, param_norm=1886.6075
22:32:02.849 [I] Progress on: 486it/1.00kit rate:1.2s/it remaining:10:22 elapsed:10:43 postfix:-  (3498277:tqdm_logging.py:145)
Step 487: grad_norm=9.2981, loss=0.3270, param_norm=1886.6078
Step 488: grad_norm=3.6187, loss=0.3602, param_norm=1886.6078
Step 489: grad_norm=8.9117, loss=0.3335, param_norm=1886.6080
Step 490: grad_norm=4.6867, loss=0.4230, param_norm=1886.6082
Step 491: grad_norm=4.5612, loss=0.3968, param_norm=1886.6083
Step 492: grad_norm=3.9824, loss=0.3825, param_norm=1886.6084
Step 493: grad_norm=5.7471, loss=0.4404, param_norm=1886.6085
Step 494: grad_norm=3.2512, loss=0.3020, param_norm=1886.6088
Step 495: grad_norm=4.6336, loss=0.3560, param_norm=1886.6089
22:32:13.707 [I] Progress on: 495it/1.00kit rate:1.2s/it remaining:10:00 elapsed:10:54 postfix:-  (3498277:tqdm_logging.py:145)
Step 496: grad_norm=10.7799, loss=0.4181, param_norm=1886.6090
Step 497: grad_norm=6.0181, loss=0.2984, param_norm=1886.6090
Step 498: grad_norm=5.0650, loss=0.2952, param_norm=1886.6093
Step 499: grad_norm=6.2385, loss=0.3259, param_norm=1886.6094
Step 500: grad_norm=5.3211, loss=0.5492, param_norm=1886.6095
22:32:20.548 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:32:20.549 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:32:20.549 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (3498277:checkpoint_manager.py:1786)
22:32:20.549 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (3498277:checkpoint_manager.py:1817)
22:32:20.549 [I] [process=0] Saving checkpoint at step 500                                        (3498277:checkpoint_manager.py:1286)
22:32:20.549 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500. (3498277:async_checkpointer.py:358)
22:32:20.551 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:32:20.552 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12 (3498277:atomicity.py:144)
22:32:20.552 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:32:20.553 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:32:20.554 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (3498277:atomicity.py:144)
22:32:20.555 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (3498277:atomicity.py:144)
22:32:20.555 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:32:20.561 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:32:24.853 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:32:24.859 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:32:24.861 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:32:24.861 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:32:24.875 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:32:24.876 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:32:24.878 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:32:24.879 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:30:13.675846+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:32:24.882 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:32:24.883 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:32:24.886 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:32:24.886 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783540.5486567, 'wait_for_prev_duration_secs': 0.0006372928619384766, 'checkpointer_blocking_start_time': 1742783540.549683, 'checkpointer_blocking_duration_secs': 4.32577109336853, 'get_old_steps_start_time': 1742783544.8754997, 'get_old_steps_duration_secs': 0.006613492965698242, 'checkpoint_manager_blocking_start_time': 1742783540.5485928, 'checkpoint_manager_blocking_duration_secs': 4.338144063949585} (3498277:standard_logger.py:34)
22:32:24.895 [I] Progress on: 501it/1.00kit rate:2.7s/it remaining:22:08 elapsed:11:05 postfix:-  (3498277:tqdm_logging.py:145)
Step 501: grad_norm=4.7351, loss=0.3748, param_norm=1886.6096
Step 502: grad_norm=4.2789, loss=0.3743, param_norm=1886.6097
Step 503: grad_norm=5.8205, loss=0.2907, param_norm=1886.6099
Step 504: grad_norm=9.2451, loss=0.3604, param_norm=1886.6100
Step 505: grad_norm=4.1334, loss=0.3355, param_norm=1886.6101
Step 506: grad_norm=3.8947, loss=0.3194, param_norm=1886.6104
Step 507: grad_norm=4.8590, loss=0.4378, param_norm=1886.6105
22:32:33.370 [I] ChainedFuture completed 1/1 futures in 8.50 seconds.                             (3498277:future.py:137)
22:32:33.371 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 808.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:32:33.372 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:32:33.374 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12 (3498277:async_checkpointer.py:406)
22:32:33.374 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12/assets (3498277:atomicity.py:287)
22:32:33.390 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12/params (3498277:atomicity.py:287)
22:32:33.391 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500 (3498277:async_checkpointer.py:416)
22:32:33.392 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12 (3498277:async_checkpointer.py:426)
22:32:33.393 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500 (3498277:atomicity.py:287)
22:32:33.395 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/500`. (3498277:atomicity.py:548)
22:32:33.395 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:32:33.396 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:32:33.397 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:32:33.398 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:32:33.399 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 508: grad_norm=5.9136, loss=0.3386, param_norm=1886.6106
Step 509: grad_norm=3.3261, loss=0.2846, param_norm=1886.6110
22:32:35.673 [I] Progress on: 509it/1.00kit rate:1.3s/it remaining:10:18 elapsed:11:16 postfix:-  (3498277:tqdm_logging.py:145)
Step 510: grad_norm=3.8619, loss=0.2897, param_norm=1886.6111
Step 511: grad_norm=5.8823, loss=0.4172, param_norm=1886.6113
Step 512: grad_norm=4.5755, loss=0.3546, param_norm=1886.6115
Step 513: grad_norm=5.2696, loss=0.3777, param_norm=1886.6115
Step 514: grad_norm=4.0874, loss=0.4013, param_norm=1886.6118
Step 515: grad_norm=3.9169, loss=0.3673, param_norm=1886.6118
Step 516: grad_norm=5.4819, loss=0.4281, param_norm=1886.6121
Step 517: grad_norm=4.1424, loss=0.3726, param_norm=1886.6122
Step 518: grad_norm=6.1277, loss=0.4575, param_norm=1886.6123
22:32:46.865 [I] Progress on: 518it/1.00kit rate:1.3s/it remaining:10:09 elapsed:11:27 postfix:-  (3498277:tqdm_logging.py:145)
Step 519: grad_norm=4.5624, loss=0.3960, param_norm=1886.6124
Step 520: grad_norm=4.2353, loss=0.3647, param_norm=1886.6125
Step 521: grad_norm=4.4647, loss=0.3714, param_norm=1886.6128
Step 522: grad_norm=5.9970, loss=0.2978, param_norm=1886.6129
Step 523: grad_norm=5.2814, loss=0.3416, param_norm=1886.6129
Step 524: grad_norm=3.6652, loss=0.2857, param_norm=1886.6132
Step 525: grad_norm=8.2709, loss=0.3213, param_norm=1886.6133
Step 526: grad_norm=4.1364, loss=0.3524, param_norm=1886.6134
22:32:57.602 [I] Progress on: 526it/1.00kit rate:1.3s/it remaining:10:28 elapsed:11:37 postfix:-  (3498277:tqdm_logging.py:145)
Step 527: grad_norm=7.3515, loss=0.3528, param_norm=1886.6135
Step 528: grad_norm=4.8234, loss=0.2747, param_norm=1886.6136
Step 529: grad_norm=6.8003, loss=0.3637, param_norm=1886.6139
Step 530: grad_norm=4.3304, loss=0.3194, param_norm=1886.6140
Step 531: grad_norm=6.7061, loss=0.3649, param_norm=1886.6140
Step 532: grad_norm=6.9990, loss=0.3602, param_norm=1886.6143
Step 533: grad_norm=5.8609, loss=0.4449, param_norm=1886.6144
Step 534: grad_norm=4.9330, loss=0.3205, param_norm=1886.6144
Step 535: grad_norm=4.0827, loss=0.3624, param_norm=1886.6146
22:33:07.806 [I] Progress on: 535it/1.00kit rate:1.1s/it remaining:08:46 elapsed:11:48 postfix:-  (3498277:tqdm_logging.py:145)
Step 536: grad_norm=4.7464, loss=0.3049, param_norm=1886.6146
Step 537: grad_norm=3.9690, loss=0.3072, param_norm=1886.6150
Step 538: grad_norm=5.1165, loss=0.3862, param_norm=1886.6150
Step 539: grad_norm=4.0911, loss=0.3008, param_norm=1886.6151
Step 540: grad_norm=3.3614, loss=0.2927, param_norm=1886.6152
Step 541: grad_norm=6.8715, loss=0.3693, param_norm=1886.6154
Step 542: grad_norm=4.4910, loss=0.3666, param_norm=1886.6155
Step 543: grad_norm=7.7203, loss=0.4142, param_norm=1886.6156
22:33:19.162 [I] Progress on: 543it/1.00kit rate:1.4s/it remaining:10:37 elapsed:11:59 postfix:-  (3498277:tqdm_logging.py:145)
Step 544: grad_norm=10.9649, loss=0.3798, param_norm=1886.6157
Step 545: grad_norm=3.6103, loss=0.2857, param_norm=1886.6157
Step 546: grad_norm=4.2350, loss=0.3333, param_norm=1886.6158
Step 547: grad_norm=4.2902, loss=0.3764, param_norm=1886.6160
Step 548: grad_norm=4.6017, loss=0.3707, param_norm=1886.6161
Step 549: grad_norm=3.7910, loss=0.3125, param_norm=1886.6161
Step 550: grad_norm=4.4336, loss=0.4078, param_norm=1886.6163
Step 551: grad_norm=3.8754, loss=0.3427, param_norm=1886.6165
22:33:29.319 [I] Progress on: 552it/1.00kit rate:1.3s/it remaining:09:45 elapsed:12:09 postfix:-  (3498277:tqdm_logging.py:145)
Step 552: grad_norm=2.9370, loss=0.2265, param_norm=1886.6166
Step 553: grad_norm=4.5660, loss=0.2828, param_norm=1886.6167
Step 554: grad_norm=5.2827, loss=0.2427, param_norm=1886.6168
Step 555: grad_norm=3.7433, loss=0.2919, param_norm=1886.6169
Step 556: grad_norm=3.0236, loss=0.2715, param_norm=1886.6171
Step 557: grad_norm=3.4385, loss=0.2697, param_norm=1886.6172
Step 558: grad_norm=2.8924, loss=0.2646, param_norm=1886.6174
Step 559: grad_norm=3.8089, loss=0.3081, param_norm=1886.6176
Step 560: grad_norm=8.2440, loss=0.2843, param_norm=1886.6177
22:33:40.675 [I] Progress on: 560it/1.00kit rate:1.3s/it remaining:09:40 elapsed:12:21 postfix:-  (3498277:tqdm_logging.py:145)
Step 561: grad_norm=4.1239, loss=0.2590, param_norm=1886.6178
Step 562: grad_norm=5.8143, loss=0.2771, param_norm=1886.6179
Step 563: grad_norm=3.6572, loss=0.3216, param_norm=1886.6180
Step 564: grad_norm=8.8128, loss=0.3701, param_norm=1886.6182
Step 565: grad_norm=4.4391, loss=0.2562, param_norm=1886.6183
Step 566: grad_norm=4.0965, loss=0.3783, param_norm=1886.6184
Step 567: grad_norm=3.3450, loss=0.2336, param_norm=1886.6185
Step 568: grad_norm=4.5200, loss=0.2500, param_norm=1886.6187
22:33:51.448 [I] Progress on: 568it/1.00kit rate:1.3s/it remaining:09:31 elapsed:12:31 postfix:-  (3498277:tqdm_logging.py:145)
Step 569: grad_norm=3.6177, loss=0.2443, param_norm=1886.6187
Step 570: grad_norm=2.5130, loss=0.1777, param_norm=1886.6188
Step 571: grad_norm=7.2832, loss=0.3069, param_norm=1886.6189
Step 572: grad_norm=3.9765, loss=0.3134, param_norm=1886.6190
Step 573: grad_norm=6.4623, loss=0.3007, param_norm=1886.6191
Step 574: grad_norm=4.5442, loss=0.2801, param_norm=1886.6191
Step 575: grad_norm=4.4439, loss=0.2122, param_norm=1886.6193
Step 576: grad_norm=3.4739, loss=0.2105, param_norm=1886.6195
Step 577: grad_norm=4.1395, loss=0.2815, param_norm=1886.6195
22:34:01.719 [I] Progress on: 577it/1.00kit rate:1.1s/it remaining:08:01 elapsed:12:42 postfix:-  (3498277:tqdm_logging.py:145)
Step 578: grad_norm=3.6451, loss=0.2384, param_norm=1886.6196
Step 579: grad_norm=4.4282, loss=0.3817, param_norm=1886.6198
Step 580: grad_norm=4.3214, loss=0.2651, param_norm=1886.6199
Step 581: grad_norm=3.0384, loss=0.2462, param_norm=1886.6200
Step 582: grad_norm=6.7694, loss=0.3280, param_norm=1886.6200
Step 583: grad_norm=4.9007, loss=0.2127, param_norm=1886.6201
Step 584: grad_norm=5.8811, loss=0.2675, param_norm=1886.6202
Step 585: grad_norm=4.0223, loss=0.2573, param_norm=1886.6204
22:34:12.801 [I] Progress on: 585it/1.00kit rate:1.4s/it remaining:09:38 elapsed:12:53 postfix:-  (3498277:tqdm_logging.py:145)
Step 586: grad_norm=5.6417, loss=0.2995, param_norm=1886.6204
Step 587: grad_norm=3.7906, loss=0.2857, param_norm=1886.6205
Step 588: grad_norm=3.4279, loss=0.3204, param_norm=1886.6206
Step 589: grad_norm=3.5349, loss=0.2642, param_norm=1886.6207
Step 590: grad_norm=4.3627, loss=0.2364, param_norm=1886.6207
Step 591: grad_norm=4.4500, loss=0.2567, param_norm=1886.6210
Step 592: grad_norm=13.0665, loss=0.3627, param_norm=1886.6211
Step 593: grad_norm=3.5533, loss=0.2865, param_norm=1886.6211
22:34:22.996 [I] Progress on: 593it/1.00kit rate:1.3s/it remaining:08:29 elapsed:13:03 postfix:-  (3498277:tqdm_logging.py:145)
Step 594: grad_norm=5.8562, loss=0.2784, param_norm=1886.6212
Step 595: grad_norm=3.9760, loss=0.2808, param_norm=1886.6213
Step 596: grad_norm=4.3569, loss=0.3170, param_norm=1886.6213
Step 597: grad_norm=4.6082, loss=0.2827, param_norm=1886.6215
Step 598: grad_norm=3.9019, loss=0.2580, param_norm=1886.6216
Step 599: grad_norm=4.8148, loss=0.2912, param_norm=1886.6218
Step 600: grad_norm=3.1033, loss=0.2752, param_norm=1886.6218
22:34:31.566 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:34:31.566 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:34:31.566 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (3498277:checkpoint_manager.py:1786)
22:34:31.567 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (3498277:checkpoint_manager.py:1817)
22:34:31.567 [I] [process=0] Saving checkpoint at step 600                                        (3498277:checkpoint_manager.py:1286)
22:34:31.568 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600. (3498277:async_checkpointer.py:358)
22:34:31.569 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:34:31.570 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15 (3498277:atomicity.py:144)
22:34:31.588 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:34:31.589 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:34:31.590 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (3498277:atomicity.py:144)
22:34:31.591 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (3498277:atomicity.py:144)
22:34:31.593 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:34:31.603 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:34:35.211 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:34:35.211 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:34:35.212 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:34:35.214 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:34:35.238 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:34:35.240 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:34:35.241 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:34:35.243 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:30:13.675846+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:34:35.244 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:32:24.875471+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:34:35.244 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:34:35.244 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:34:35.245 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:34:35.245 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783671.5663242, 'wait_for_prev_duration_secs': 0.0008609294891357422, 'checkpointer_blocking_start_time': 1742783671.5678108, 'checkpointer_blocking_duration_secs': 3.6708524227142334, 'get_old_steps_start_time': 1742783675.238724, 'get_old_steps_duration_secs': 0.005502223968505859, 'checkpoint_manager_blocking_start_time': 1742783671.5662038, 'checkpoint_manager_blocking_duration_secs': 3.6791579723358154} (3498277:standard_logger.py:34)
22:34:35.247 [I] Progress on: 601it/1.00kit rate:2.4s/it remaining:15:55 elapsed:13:15 postfix:-  (3498277:tqdm_logging.py:145)
Step 601: grad_norm=4.7144, loss=0.3111, param_norm=1886.6219
Step 602: grad_norm=3.5181, loss=0.2624, param_norm=1886.6221
Step 603: grad_norm=4.5828, loss=0.2819, param_norm=1886.6221
Step 604: grad_norm=14.5049, loss=0.3308, param_norm=1886.6222
Step 605: grad_norm=5.5352, loss=0.2315, param_norm=1886.6223
Step 606: grad_norm=8.0566, loss=0.2397, param_norm=1886.6223
22:34:44.261 [I] ChainedFuture completed 1/1 futures in 9.03 seconds.                             (3498277:future.py:137)
22:34:44.263 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 817.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:34:44.264 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:34:44.268 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15 (3498277:async_checkpointer.py:406)
22:34:44.269 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15/assets (3498277:atomicity.py:287)
22:34:44.290 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15/params (3498277:atomicity.py:287)
22:34:44.294 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600 (3498277:async_checkpointer.py:416)
22:34:44.295 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15 (3498277:async_checkpointer.py:426)
22:34:44.295 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600 (3498277:atomicity.py:287)
22:34:44.297 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/600`. (3498277:atomicity.py:548)
22:34:44.297 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:34:44.298 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:34:44.299 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:34:44.299 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:34:44.300 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 607: grad_norm=3.6702, loss=0.2718, param_norm=1886.6226
Step 608: grad_norm=5.8221, loss=0.2631, param_norm=1886.6226
22:34:45.908 [I] Progress on: 608it/1.00kit rate:1.5s/it remaining:09:45 elapsed:13:26 postfix:-  (3498277:tqdm_logging.py:145)
Step 609: grad_norm=3.8584, loss=0.2981, param_norm=1886.6227
Step 610: grad_norm=8.1651, loss=0.3238, param_norm=1886.6228
Step 611: grad_norm=6.0245, loss=0.2864, param_norm=1886.6229
Step 612: grad_norm=3.6136, loss=0.2761, param_norm=1886.6229
Step 613: grad_norm=6.2106, loss=0.3338, param_norm=1886.6230
Step 614: grad_norm=3.6353, loss=0.2647, param_norm=1886.6230
Step 615: grad_norm=3.9017, loss=0.3121, param_norm=1886.6232
Step 616: grad_norm=4.1872, loss=0.2643, param_norm=1886.6233
Step 617: grad_norm=7.3114, loss=0.2654, param_norm=1886.6234
22:34:56.143 [I] Progress on: 617it/1.00kit rate:1.1s/it remaining:07:20 elapsed:13:36 postfix:-  (3498277:tqdm_logging.py:145)
Step 618: grad_norm=5.0505, loss=0.2625, param_norm=1886.6234
Step 619: grad_norm=4.5456, loss=0.2658, param_norm=1886.6235
Step 620: grad_norm=2.7031, loss=0.1935, param_norm=1886.6237
Step 621: grad_norm=5.5394, loss=0.2519, param_norm=1886.6238
Step 622: grad_norm=2.9810, loss=0.1984, param_norm=1886.6239
Step 623: grad_norm=4.5837, loss=0.2638, param_norm=1886.6239
Step 624: grad_norm=2.9768, loss=0.1754, param_norm=1886.6239
Step 625: grad_norm=2.2290, loss=0.1643, param_norm=1886.6241
22:35:07.021 [I] Progress on: 625it/1.00kit rate:1.4s/it remaining:08:29 elapsed:13:47 postfix:-  (3498277:tqdm_logging.py:145)
Step 626: grad_norm=4.3234, loss=0.2092, param_norm=1886.6243
Step 627: grad_norm=2.8306, loss=0.2208, param_norm=1886.6243
Step 628: grad_norm=9.2252, loss=0.1817, param_norm=1886.6243
Step 629: grad_norm=2.6443, loss=0.1478, param_norm=1886.6244
Step 630: grad_norm=3.0975, loss=0.1806, param_norm=1886.6244
Step 631: grad_norm=3.9954, loss=0.2288, param_norm=1886.6244
Step 632: grad_norm=3.3169, loss=0.2076, param_norm=1886.6245
Step 633: grad_norm=2.9778, loss=0.2093, param_norm=1886.6245
22:35:17.324 [I] Progress on: 633it/1.00kit rate:1.2s/it remaining:07:24 elapsed:13:57 postfix:-  (3498277:tqdm_logging.py:145)
Step 634: grad_norm=2.6698, loss=0.1920, param_norm=1886.6246
Step 635: grad_norm=2.8788, loss=0.2210, param_norm=1886.6246
Step 636: grad_norm=3.3010, loss=0.2024, param_norm=1886.6246
Step 637: grad_norm=4.2096, loss=0.1875, param_norm=1886.6248
Step 638: grad_norm=4.2088, loss=0.2119, param_norm=1886.6249
Step 639: grad_norm=4.3820, loss=0.1918, param_norm=1886.6249
Step 640: grad_norm=2.9186, loss=0.2257, param_norm=1886.6249
Step 641: grad_norm=3.9262, loss=0.2626, param_norm=1886.6249
Step 642: grad_norm=4.6270, loss=0.1863, param_norm=1886.6250
22:35:28.144 [I] Progress on: 642it/1.00kit rate:1.2s/it remaining:07:24 elapsed:14:08 postfix:-  (3498277:tqdm_logging.py:145)
Step 643: grad_norm=2.4931, loss=0.1966, param_norm=1886.6250
Step 644: grad_norm=3.0054, loss=0.2122, param_norm=1886.6251
Step 645: grad_norm=5.8733, loss=0.2168, param_norm=1886.6251
Step 646: grad_norm=15.5227, loss=0.1998, param_norm=1886.6252
Step 647: grad_norm=3.8907, loss=0.1565, param_norm=1886.6252
Step 648: grad_norm=2.1686, loss=0.1486, param_norm=1886.6254
Step 649: grad_norm=4.1859, loss=0.1901, param_norm=1886.6255
Step 650: grad_norm=3.0020, loss=0.1945, param_norm=1886.6257
22:35:39.023 [I] Progress on: 650it/1.00kit rate:1.4s/it remaining:08:09 elapsed:14:19 postfix:-  (3498277:tqdm_logging.py:145)
Step 651: grad_norm=4.0806, loss=0.2418, param_norm=1886.6257
Step 652: grad_norm=4.4213, loss=0.1853, param_norm=1886.6257
Step 653: grad_norm=4.5874, loss=0.1820, param_norm=1886.6259
Step 654: grad_norm=2.9814, loss=0.2638, param_norm=1886.6259
Step 655: grad_norm=3.5625, loss=0.2494, param_norm=1886.6260
Step 656: grad_norm=4.2071, loss=0.2142, param_norm=1886.6260
Step 657: grad_norm=3.2047, loss=0.2134, param_norm=1886.6261
Step 658: grad_norm=3.2888, loss=0.2518, param_norm=1886.6261
Step 659: grad_norm=2.7657, loss=0.1954, param_norm=1886.6262
22:35:49.779 [I] Progress on: 659it/1.00kit rate:1.2s/it remaining:06:43 elapsed:14:30 postfix:-  (3498277:tqdm_logging.py:145)
Step 660: grad_norm=3.1203, loss=0.2159, param_norm=1886.6262
Step 661: grad_norm=3.9272, loss=0.2091, param_norm=1886.6263
Step 662: grad_norm=3.8212, loss=0.2646, param_norm=1886.6265
Step 663: grad_norm=4.2982, loss=0.2733, param_norm=1886.6265
Step 664: grad_norm=13.1863, loss=0.2765, param_norm=1886.6266
Step 665: grad_norm=2.6628, loss=0.1704, param_norm=1886.6266
Step 666: grad_norm=3.5044, loss=0.2640, param_norm=1886.6267
Step 667: grad_norm=5.1482, loss=0.2396, param_norm=1886.6267
22:35:59.989 [I] Progress on: 667it/1.00kit rate:1.3s/it remaining:07:25 elapsed:14:40 postfix:-  (3498277:tqdm_logging.py:145)
Step 668: grad_norm=6.5406, loss=0.2277, param_norm=1886.6268
Step 669: grad_norm=2.6097, loss=0.1622, param_norm=1886.6270
Step 670: grad_norm=5.2817, loss=0.2027, param_norm=1886.6272
Step 671: grad_norm=3.1711, loss=0.1925, param_norm=1886.6271
Step 672: grad_norm=3.4208, loss=0.2545, param_norm=1886.6272
Step 673: grad_norm=2.7460, loss=0.1903, param_norm=1886.6273
Step 674: grad_norm=4.8720, loss=0.2051, param_norm=1886.6273
Step 675: grad_norm=4.9744, loss=0.3258, param_norm=1886.6273
22:36:10.782 [I] Progress on: 675it/1.00kit rate:1.4s/it remaining:07:36 elapsed:14:51 postfix:-  (3498277:tqdm_logging.py:145)
Step 676: grad_norm=3.5269, loss=0.2527, param_norm=1886.6274
Step 677: grad_norm=4.4188, loss=0.2518, param_norm=1886.6276
Step 678: grad_norm=3.0996, loss=0.2247, param_norm=1886.6276
Step 679: grad_norm=3.1074, loss=0.1955, param_norm=1886.6277
Step 680: grad_norm=5.0127, loss=0.2434, param_norm=1886.6277
Step 681: grad_norm=4.2710, loss=0.1939, param_norm=1886.6277
Step 682: grad_norm=2.8935, loss=0.1823, param_norm=1886.6278
Step 683: grad_norm=5.8130, loss=0.1914, param_norm=1886.6279
Step 684: grad_norm=3.1589, loss=0.2138, param_norm=1886.6279
22:36:21.088 [I] Progress on: 684it/1.00kit rate:1.1s/it remaining:06:02 elapsed:15:01 postfix:-  (3498277:tqdm_logging.py:145)
Step 685: grad_norm=3.5782, loss=0.2084, param_norm=1886.6281
Step 686: grad_norm=4.0954, loss=0.2448, param_norm=1886.6282
Step 687: grad_norm=5.4000, loss=0.2281, param_norm=1886.6282
Step 688: grad_norm=2.6055, loss=0.1900, param_norm=1886.6282
Step 689: grad_norm=2.4729, loss=0.1534, param_norm=1886.6283
Step 690: grad_norm=4.0848, loss=0.1594, param_norm=1886.6283
Step 691: grad_norm=2.5972, loss=0.1908, param_norm=1886.6283
22:36:31.415 [I] Progress on: 691it/1.00kit rate:1.5s/it remaining:07:34 elapsed:15:11 postfix:-  (3498277:tqdm_logging.py:145)
Step 692: grad_norm=2.1568, loss=0.1670, param_norm=1886.6284
Step 693: grad_norm=3.1695, loss=0.2029, param_norm=1886.6284
Step 694: grad_norm=4.0412, loss=0.2206, param_norm=1886.6284
Step 695: grad_norm=3.5315, loss=0.1831, param_norm=1886.6284
Step 696: grad_norm=2.5003, loss=0.1859, param_norm=1886.6285
Step 697: grad_norm=3.4904, loss=0.1477, param_norm=1886.6285
Step 698: grad_norm=3.8138, loss=0.1758, param_norm=1886.6285
Step 699: grad_norm=4.0989, loss=0.1540, param_norm=1886.6285
Step 700: grad_norm=2.6302, loss=0.1494, param_norm=1886.6287
22:36:42.476 [I] Progress on: 700it/1.00kit rate:1.2s/it remaining:06:02 elapsed:15:22 postfix:-  (3498277:tqdm_logging.py:145)
22:36:42.513 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:36:42.513 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:36:42.514 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (3498277:checkpoint_manager.py:1786)
22:36:42.514 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (3498277:checkpoint_manager.py:1817)
22:36:42.514 [I] [process=0] Saving checkpoint at step 700                                        (3498277:checkpoint_manager.py:1286)
22:36:42.515 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700. (3498277:async_checkpointer.py:358)
22:36:42.517 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:36:42.517 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18 (3498277:atomicity.py:144)
22:36:42.518 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:36:42.518 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:36:42.520 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (3498277:atomicity.py:144)
22:36:42.520 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (3498277:atomicity.py:144)
22:36:42.521 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:36:42.526 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:36:46.244 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:36:46.245 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:36:46.246 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:36:46.251 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:36:46.276 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:36:46.348 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:36:46.348 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:36:46.353 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:30:13.675846+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:36:46.355 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:32:24.875471+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:36:46.357 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:34:35.238689+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:36:46.359 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:36:46.365 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:36:46.370 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:36:46.372 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783802.5134954, 'wait_for_prev_duration_secs': 0.0007748603820800781, 'checkpointer_blocking_start_time': 1742783802.5149758, 'checkpointer_blocking_duration_secs': 3.761155128479004, 'get_old_steps_start_time': 1742783806.2761903, 'get_old_steps_duration_secs': 0.08284997940063477, 'checkpoint_manager_blocking_start_time': 1742783802.5132906, 'checkpoint_manager_blocking_duration_secs': 3.8587403297424316} (3498277:standard_logger.py:34)
Step 701: grad_norm=4.8231, loss=0.1954, param_norm=1886.6288
Step 702: grad_norm=2.3454, loss=0.1714, param_norm=1886.6288
Step 703: grad_norm=2.2951, loss=0.1104, param_norm=1886.6288
Step 704: grad_norm=2.4728, loss=0.1724, param_norm=1886.6289
Step 705: grad_norm=2.1131, loss=0.1467, param_norm=1886.6289
22:36:52.895 [I] Progress on: 705it/1.00kit rate:1.6s/it remaining:07:46 elapsed:15:33 postfix:-  (3498277:tqdm_logging.py:145)
22:36:53.648 [I] ChainedFuture completed 1/1 futures in 7.39 seconds.                             (3498277:future.py:137)
22:36:53.648 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 931.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:36:53.649 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:36:53.650 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18 (3498277:async_checkpointer.py:406)
22:36:53.650 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18/assets (3498277:atomicity.py:287)
22:36:53.662 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18/params (3498277:atomicity.py:287)
22:36:53.662 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700 (3498277:async_checkpointer.py:416)
22:36:53.663 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18 (3498277:async_checkpointer.py:426)
22:36:53.663 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700 (3498277:atomicity.py:287)
22:36:53.665 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/700`. (3498277:atomicity.py:548)
22:36:53.665 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:36:53.666 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:36:54.307 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:36:54.308 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:36:54.308 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 706: grad_norm=4.1177, loss=0.1980, param_norm=1886.6289
Step 707: grad_norm=2.6487, loss=0.1854, param_norm=1886.6289
Step 708: grad_norm=2.6446, loss=0.1341, param_norm=1886.6289
Step 709: grad_norm=2.5669, loss=0.1661, param_norm=1886.6289
Step 710: grad_norm=6.1333, loss=0.2117, param_norm=1886.6290
Step 711: grad_norm=3.5619, loss=0.1450, param_norm=1886.6290
Step 712: grad_norm=2.7050, loss=0.1554, param_norm=1886.6290
Step 713: grad_norm=2.3888, loss=0.1517, param_norm=1886.6290
22:37:04.069 [I] Progress on: 713it/1.00kit rate:1.4s/it remaining:06:53 elapsed:15:44 postfix:-  (3498277:tqdm_logging.py:145)
Step 714: grad_norm=2.8627, loss=0.1600, param_norm=1886.6292
Step 715: grad_norm=2.2860, loss=0.1440, param_norm=1886.6292
Step 716: grad_norm=2.3741, loss=0.1368, param_norm=1886.6292
Step 717: grad_norm=2.6161, loss=0.1338, param_norm=1886.6292
Step 718: grad_norm=2.3600, loss=0.1384, param_norm=1886.6293
Step 719: grad_norm=3.8529, loss=0.1499, param_norm=1886.6293
Step 720: grad_norm=3.7605, loss=0.1699, param_norm=1886.6293
Step 721: grad_norm=2.8539, loss=0.1645, param_norm=1886.6293
Step 722: grad_norm=4.0167, loss=0.1811, param_norm=1886.6294
22:37:14.357 [I] Progress on: 722it/1.00kit rate:1.2s/it remaining:05:27 elapsed:15:54 postfix:-  (3498277:tqdm_logging.py:145)
Step 723: grad_norm=2.9128, loss=0.1559, param_norm=1886.6294
Step 724: grad_norm=2.5169, loss=0.1828, param_norm=1886.6295
Step 725: grad_norm=5.6177, loss=0.1330, param_norm=1886.6296
Step 726: grad_norm=3.9520, loss=0.1912, param_norm=1886.6296
Step 727: grad_norm=2.5292, loss=0.1461, param_norm=1886.6296
Step 728: grad_norm=4.5709, loss=0.2191, param_norm=1886.6296
Step 729: grad_norm=2.3808, loss=0.1514, param_norm=1886.6298
Step 730: grad_norm=2.8459, loss=0.1638, param_norm=1886.6298
22:37:24.941 [I] Progress on: 730it/1.00kit rate:1.4s/it remaining:06:05 elapsed:16:05 postfix:-  (3498277:tqdm_logging.py:145)
Step 731: grad_norm=2.4663, loss=0.1920, param_norm=1886.6298
Step 732: grad_norm=3.3557, loss=0.1641, param_norm=1886.6299
Step 733: grad_norm=2.9536, loss=0.1768, param_norm=1886.6299
Step 734: grad_norm=4.0465, loss=0.2217, param_norm=1886.6299
Step 735: grad_norm=3.3415, loss=0.2115, param_norm=1886.6300
Step 736: grad_norm=2.8214, loss=0.1255, param_norm=1886.6300
Step 737: grad_norm=3.6208, loss=0.1439, param_norm=1886.6300
Step 738: grad_norm=3.5414, loss=0.2076, param_norm=1886.6302
22:37:35.163 [I] Progress on: 738it/1.00kit rate:1.2s/it remaining:05:27 elapsed:16:15 postfix:-  (3498277:tqdm_logging.py:145)
Step 739: grad_norm=2.5184, loss=0.1465, param_norm=1886.6302
Step 740: grad_norm=2.8765, loss=0.1608, param_norm=1886.6302
Step 741: grad_norm=4.4454, loss=0.1180, param_norm=1886.6304
Step 742: grad_norm=2.4107, loss=0.1375, param_norm=1886.6304
Step 743: grad_norm=2.2088, loss=0.1305, param_norm=1886.6304
Step 744: grad_norm=3.1580, loss=0.1523, param_norm=1886.6304
Step 745: grad_norm=3.7810, loss=0.2332, param_norm=1886.6305
Step 746: grad_norm=2.1571, loss=0.1151, param_norm=1886.6305
Step 747: grad_norm=2.5653, loss=0.1575, param_norm=1886.6305
22:37:45.796 [I] Progress on: 747it/1.00kit rate:1.2s/it remaining:04:53 elapsed:16:26 postfix:-  (3498277:tqdm_logging.py:145)
Step 748: grad_norm=2.2254, loss=0.1135, param_norm=1886.6305
Step 749: grad_norm=2.1560, loss=0.1054, param_norm=1886.6306
Step 750: grad_norm=2.6562, loss=0.1595, param_norm=1886.6306
Step 751: grad_norm=3.4108, loss=0.1720, param_norm=1886.6306
Step 752: grad_norm=3.5488, loss=0.1810, param_norm=1886.6306
Step 753: grad_norm=3.5182, loss=0.1916, param_norm=1886.6307
Step 754: grad_norm=2.6129, loss=0.1077, param_norm=1886.6307
Step 755: grad_norm=2.2909, loss=0.1401, param_norm=1886.6307
22:37:56.985 [I] Progress on: 755it/1.00kit rate:1.4s/it remaining:05:40 elapsed:16:37 postfix:-  (3498277:tqdm_logging.py:145)
Step 756: grad_norm=2.7912, loss=0.1678, param_norm=1886.6307
Step 757: grad_norm=2.1368, loss=0.1464, param_norm=1886.6309
Step 758: grad_norm=2.8186, loss=0.1632, param_norm=1886.6309
Step 759: grad_norm=1.5497, loss=0.0709, param_norm=1886.6309
Step 760: grad_norm=2.0195, loss=0.1193, param_norm=1886.6309
Step 761: grad_norm=2.5361, loss=0.1565, param_norm=1886.6310
Step 762: grad_norm=2.2611, loss=0.1358, param_norm=1886.6310
Step 763: grad_norm=2.6972, loss=0.1020, param_norm=1886.6311
Step 764: grad_norm=2.6920, loss=0.1237, param_norm=1886.6310
22:38:07.921 [I] Progress on: 764it/1.00kit rate:1.2s/it remaining:04:47 elapsed:16:48 postfix:-  (3498277:tqdm_logging.py:145)
Step 765: grad_norm=2.4213, loss=0.1050, param_norm=1886.6311
Step 766: grad_norm=2.6248, loss=0.0953, param_norm=1886.6312
Step 767: grad_norm=2.0070, loss=0.0966, param_norm=1886.6311
Step 768: grad_norm=2.3532, loss=0.1231, param_norm=1886.6311
Step 769: grad_norm=2.9018, loss=0.1130, param_norm=1886.6312
Step 770: grad_norm=2.4142, loss=0.1586, param_norm=1886.6312
Step 771: grad_norm=2.1827, loss=0.1089, param_norm=1886.6312
Step 772: grad_norm=2.5835, loss=0.1403, param_norm=1886.6312
22:38:18.537 [I] Progress on: 772it/1.00kit rate:1.4s/it remaining:05:08 elapsed:16:58 postfix:-  (3498277:tqdm_logging.py:145)
Step 773: grad_norm=2.1336, loss=0.1289, param_norm=1886.6313
Step 774: grad_norm=2.0020, loss=0.1001, param_norm=1886.6312
Step 775: grad_norm=3.4501, loss=0.1554, param_norm=1886.6313
Step 776: grad_norm=4.1425, loss=0.0969, param_norm=1886.6313
Step 777: grad_norm=2.3464, loss=0.1471, param_norm=1886.6313
Step 778: grad_norm=2.4456, loss=0.1451, param_norm=1886.6315
Step 779: grad_norm=2.6865, loss=0.1259, param_norm=1886.6315
Step 780: grad_norm=2.8867, loss=0.1221, param_norm=1886.6315
22:38:28.820 [I] Progress on: 780it/1.00kit rate:1.2s/it remaining:04:32 elapsed:17:09 postfix:-  (3498277:tqdm_logging.py:145)
Step 781: grad_norm=2.0113, loss=0.1049, param_norm=1886.6316
Step 782: grad_norm=2.5438, loss=0.1361, param_norm=1886.6316
Step 783: grad_norm=3.0104, loss=0.1178, param_norm=1886.6316
Step 784: grad_norm=2.0437, loss=0.1163, param_norm=1886.6316
Step 785: grad_norm=2.4887, loss=0.1113, param_norm=1886.6318
Step 786: grad_norm=2.0170, loss=0.1255, param_norm=1886.6318
Step 787: grad_norm=2.6498, loss=0.1277, param_norm=1886.6318
Step 788: grad_norm=3.9040, loss=0.1369, param_norm=1886.6318
Step 789: grad_norm=2.1533, loss=0.1144, param_norm=1886.6318
22:38:39.429 [I] Progress on: 789it/1.00kit rate:1.1s/it remaining:03:55 elapsed:17:19 postfix:-  (3498277:tqdm_logging.py:145)
Step 790: grad_norm=3.3362, loss=0.1221, param_norm=1886.6318
Step 791: grad_norm=4.2289, loss=0.1429, param_norm=1886.6320
Step 792: grad_norm=2.0597, loss=0.1136, param_norm=1886.6320
Step 793: grad_norm=2.3999, loss=0.1098, param_norm=1886.6320
Step 794: grad_norm=2.7956, loss=0.0997, param_norm=1886.6320
Step 795: grad_norm=2.5338, loss=0.1238, param_norm=1886.6320
Step 796: grad_norm=2.5338, loss=0.1583, param_norm=1886.6321
22:38:49.568 [I] Progress on: 796it/1.00kit rate:1.4s/it remaining:04:51 elapsed:17:29 postfix:-  (3498277:tqdm_logging.py:145)
Step 797: grad_norm=2.2953, loss=0.1301, param_norm=1886.6321
Step 798: grad_norm=2.7697, loss=0.0938, param_norm=1886.6321
Step 799: grad_norm=2.5761, loss=0.1101, param_norm=1886.6321
Step 800: grad_norm=2.0594, loss=0.1112, param_norm=1886.6321
22:38:54.633 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:38:54.634 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:38:54.634 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (3498277:checkpoint_manager.py:1786)
22:38:54.634 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (3498277:checkpoint_manager.py:1817)
22:38:54.634 [I] [process=0] Saving checkpoint at step 800                                        (3498277:checkpoint_manager.py:1286)
22:38:54.635 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800. (3498277:async_checkpointer.py:358)
22:38:54.636 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:38:54.636 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21 (3498277:atomicity.py:144)
22:38:54.637 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:38:54.637 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:38:54.638 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (3498277:atomicity.py:144)
22:38:54.638 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (3498277:atomicity.py:144)
22:38:54.639 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:38:54.643 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:38:58.305 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:38:58.306 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:38:58.320 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:38:58.322 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:38:58.337 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.338 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.339 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.340 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:30:13.675846+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.344 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:32:24.875471+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.352 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:34:35.238689+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.364 [I] Preserving Checkpoint[step=700 | time=2025-03-24 02:36:46.276150+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:38:58.371 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:38:58.384 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:38:58.390 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:38:58.390 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783934.6336737, 'wait_for_prev_duration_secs': 0.0007007122039794922, 'checkpointer_blocking_start_time': 1742783934.6348124, 'checkpointer_blocking_duration_secs': 3.7021102905273438, 'get_old_steps_start_time': 1742783938.3369646, 'get_old_steps_duration_secs': 0.03486013412475586, 'checkpoint_manager_blocking_start_time': 1742783934.6335995, 'checkpoint_manager_blocking_duration_secs': 3.756814479827881} (3498277:standard_logger.py:34)
Step 801: grad_norm=2.2288, loss=0.1344, param_norm=1886.6321
Step 802: grad_norm=2.1272, loss=0.1302, param_norm=1886.6321
22:39:00.547 [I] Progress on: 802it/1.00kit rate:2.0s/it remaining:06:35 elapsed:17:40 postfix:-  (3498277:tqdm_logging.py:145)
Step 803: grad_norm=2.0099, loss=0.1132, param_norm=1886.6322
Step 804: grad_norm=2.7662, loss=0.1271, param_norm=1886.6322
Step 805: grad_norm=2.6319, loss=0.1298, param_norm=1886.6322
Step 806: grad_norm=2.9708, loss=0.1260, param_norm=1886.6322
Step 807: grad_norm=2.3060, loss=0.1189, param_norm=1886.6323
22:39:06.290 [I] ChainedFuture completed 1/1 futures in 7.96 seconds.                             (3498277:future.py:137)
22:39:06.291 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 889.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:39:06.291 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:39:06.292 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21 (3498277:async_checkpointer.py:406)
22:39:06.293 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21/assets (3498277:atomicity.py:287)
22:39:06.306 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21/params (3498277:atomicity.py:287)
22:39:06.307 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800 (3498277:async_checkpointer.py:416)
22:39:06.307 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21 (3498277:async_checkpointer.py:426)
22:39:06.307 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800 (3498277:atomicity.py:287)
22:39:06.309 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/800`. (3498277:atomicity.py:548)
22:39:06.310 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:39:06.310 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:39:06.311 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:39:06.311 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:39:06.311 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 808: grad_norm=3.9178, loss=0.1691, param_norm=1886.6323
Step 809: grad_norm=3.6398, loss=0.1615, param_norm=1886.6323
Step 810: grad_norm=3.3042, loss=0.1205, param_norm=1886.6323
Step 811: grad_norm=2.4379, loss=0.1503, param_norm=1886.6323
22:39:11.762 [I] Progress on: 811it/1.00kit rate:1.3s/it remaining:04:03 elapsed:17:52 postfix:-  (3498277:tqdm_logging.py:145)
Step 812: grad_norm=2.5043, loss=0.1313, param_norm=1886.6323
Step 813: grad_norm=3.4068, loss=0.1350, param_norm=1886.6323
Step 814: grad_norm=2.1715, loss=0.1114, param_norm=1886.6324
Step 815: grad_norm=2.3160, loss=0.1275, param_norm=1886.6326
Step 816: grad_norm=4.2690, loss=0.1399, param_norm=1886.6326
Step 817: grad_norm=2.3020, loss=0.1370, param_norm=1886.6326
Step 818: grad_norm=2.3312, loss=0.1466, param_norm=1886.6326
Step 819: grad_norm=2.1237, loss=0.0973, param_norm=1886.6326
22:39:22.703 [I] Progress on: 819it/1.00kit rate:1.4s/it remaining:04:18 elapsed:18:03 postfix:-  (3498277:tqdm_logging.py:145)
Step 820: grad_norm=2.0100, loss=0.1093, param_norm=1886.6327
Step 821: grad_norm=3.1298, loss=0.1418, param_norm=1886.6327
Step 822: grad_norm=2.1581, loss=0.1170, param_norm=1886.6327
Step 823: grad_norm=2.2585, loss=0.1379, param_norm=1886.6327
Step 824: grad_norm=2.1590, loss=0.1168, param_norm=1886.6327
Step 825: grad_norm=1.8292, loss=0.1033, param_norm=1886.6327
Step 826: grad_norm=2.7401, loss=0.1390, param_norm=1886.6327
Step 827: grad_norm=2.1261, loss=0.1038, param_norm=1886.6327
Step 828: grad_norm=1.6736, loss=0.0760, param_norm=1886.6328
22:39:33.347 [I] Progress on: 828it/1.00kit rate:1.3s/it remaining:03:37 elapsed:18:13 postfix:-  (3498277:tqdm_logging.py:145)
Step 829: grad_norm=1.9541, loss=0.1038, param_norm=1886.6328
Step 830: grad_norm=1.5572, loss=0.0821, param_norm=1886.6328
Step 831: grad_norm=1.4674, loss=0.0822, param_norm=1886.6328
Step 832: grad_norm=1.4024, loss=0.0701, param_norm=1886.6328
Step 833: grad_norm=1.7058, loss=0.0763, param_norm=1886.6328
Step 834: grad_norm=1.5760, loss=0.0886, param_norm=1886.6328
Step 835: grad_norm=1.4282, loss=0.0756, param_norm=1886.6328
Step 836: grad_norm=2.7897, loss=0.1136, param_norm=1886.6328
22:39:43.583 [I] Progress on: 836it/1.00kit rate:1.3s/it remaining:03:38 elapsed:18:23 postfix:-  (3498277:tqdm_logging.py:145)
Step 837: grad_norm=1.8902, loss=0.0888, param_norm=1886.6329
Step 838: grad_norm=2.0061, loss=0.0957, param_norm=1886.6329
Step 839: grad_norm=2.1444, loss=0.1084, param_norm=1886.6329
Step 840: grad_norm=1.8363, loss=0.0677, param_norm=1886.6329
Step 841: grad_norm=2.5485, loss=0.0941, param_norm=1886.6329
Step 842: grad_norm=1.4064, loss=0.0706, param_norm=1886.6329
Step 843: grad_norm=2.0784, loss=0.1099, param_norm=1886.6331
Step 844: grad_norm=2.7308, loss=0.0996, param_norm=1886.6331
22:39:54.092 [I] Progress on: 844it/1.00kit rate:1.3s/it remaining:03:25 elapsed:18:34 postfix:-  (3498277:tqdm_logging.py:145)
Step 845: grad_norm=4.7774, loss=0.1045, param_norm=1886.6331
Step 846: grad_norm=2.5405, loss=0.1371, param_norm=1886.6331
Step 847: grad_norm=1.8891, loss=0.0974, param_norm=1886.6331
Step 848: grad_norm=2.1207, loss=0.1231, param_norm=1886.6331
Step 849: grad_norm=1.7074, loss=0.0716, param_norm=1886.6331
Step 850: grad_norm=2.8346, loss=0.0739, param_norm=1886.6331
Step 851: grad_norm=2.0281, loss=0.0934, param_norm=1886.6331
Step 852: grad_norm=1.6836, loss=0.0903, param_norm=1886.6332
Step 853: grad_norm=1.7751, loss=0.0859, param_norm=1886.6332
22:40:04.399 [I] Progress on: 853it/1.00kit rate:1.2s/it remaining:02:50 elapsed:18:44 postfix:-  (3498277:tqdm_logging.py:145)
Step 854: grad_norm=2.1706, loss=0.0792, param_norm=1886.6332
Step 855: grad_norm=1.7455, loss=0.0882, param_norm=1886.6332
Step 856: grad_norm=2.2773, loss=0.0941, param_norm=1886.6333
Step 857: grad_norm=1.8722, loss=0.0955, param_norm=1886.6333
Step 858: grad_norm=2.7984, loss=0.1082, param_norm=1886.6333
Step 859: grad_norm=2.2415, loss=0.1011, param_norm=1886.6333
Step 860: grad_norm=2.7864, loss=0.1201, param_norm=1886.6334
Step 861: grad_norm=2.1913, loss=0.0923, param_norm=1886.6334
22:40:14.825 [I] Progress on: 861it/1.00kit rate:1.3s/it remaining:03:06 elapsed:18:55 postfix:-  (3498277:tqdm_logging.py:145)
Step 862: grad_norm=1.9431, loss=0.0780, param_norm=1886.6334
Step 863: grad_norm=2.3371, loss=0.1040, param_norm=1886.6334
Step 864: grad_norm=1.5796, loss=0.0650, param_norm=1886.6334
Step 865: grad_norm=1.7113, loss=0.0861, param_norm=1886.6334
Step 866: grad_norm=2.0550, loss=0.0922, param_norm=1886.6334
Step 867: grad_norm=2.1615, loss=0.1035, param_norm=1886.6334
Step 868: grad_norm=1.6923, loss=0.1049, param_norm=1886.6335
Step 869: grad_norm=1.8763, loss=0.0836, param_norm=1886.6335
22:40:25.263 [I] Progress on: 869it/1.00kit rate:1.3s/it remaining:02:45 elapsed:19:05 postfix:-  (3498277:tqdm_logging.py:145)
Step 870: grad_norm=3.4300, loss=0.1084, param_norm=1886.6335
Step 871: grad_norm=2.0800, loss=0.0683, param_norm=1886.6335
Step 872: grad_norm=1.6871, loss=0.0951, param_norm=1886.6335
Step 873: grad_norm=2.3182, loss=0.0737, param_norm=1886.6335
Step 874: grad_norm=1.6578, loss=0.0725, param_norm=1886.6337
Step 875: grad_norm=1.9478, loss=0.0907, param_norm=1886.6337
Step 876: grad_norm=1.7005, loss=0.0824, param_norm=1886.6337
Step 877: grad_norm=1.9269, loss=0.1081, param_norm=1886.6337
Step 878: grad_norm=3.4769, loss=0.1040, param_norm=1886.6337
22:40:35.649 [I] Progress on: 878it/1.00kit rate:1.1s/it remaining:02:16 elapsed:19:15 postfix:-  (3498277:tqdm_logging.py:145)
Step 879: grad_norm=2.3090, loss=0.1157, param_norm=1886.6337
Step 880: grad_norm=2.8070, loss=0.1038, param_norm=1886.6337
Step 881: grad_norm=1.5478, loss=0.0728, param_norm=1886.6337
Step 882: grad_norm=1.7366, loss=0.0896, param_norm=1886.6337
Step 883: grad_norm=2.4158, loss=0.0929, param_norm=1886.6337
Step 884: grad_norm=3.0915, loss=0.1159, param_norm=1886.6338
Step 885: grad_norm=2.6814, loss=0.1142, param_norm=1886.6338
22:40:45.779 [I] Progress on: 885it/1.00kit rate:1.4s/it remaining:02:37 elapsed:19:26 postfix:-  (3498277:tqdm_logging.py:145)
Step 886: grad_norm=2.2674, loss=0.1201, param_norm=1886.6338
Step 887: grad_norm=2.1601, loss=0.0968, param_norm=1886.6338
Step 888: grad_norm=2.5171, loss=0.1273, param_norm=1886.6338
Step 889: grad_norm=1.8776, loss=0.0767, param_norm=1886.6338
Step 890: grad_norm=2.2800, loss=0.1156, param_norm=1886.6338
Step 891: grad_norm=1.4885, loss=0.0821, param_norm=1886.6339
Step 892: grad_norm=2.0984, loss=0.0867, param_norm=1886.6339
Step 893: grad_norm=2.6286, loss=0.1161, param_norm=1886.6339
Step 894: grad_norm=1.9194, loss=0.1062, param_norm=1886.6339
22:40:56.650 [I] Progress on: 894it/1.00kit rate:1.2s/it remaining:02:08 elapsed:19:36 postfix:-  (3498277:tqdm_logging.py:145)
Step 895: grad_norm=2.2765, loss=0.1088, param_norm=1886.6339
Step 896: grad_norm=1.9201, loss=0.1103, param_norm=1886.6339
Step 897: grad_norm=1.5130, loss=0.0715, param_norm=1886.6339
Step 898: grad_norm=1.0476, loss=0.0469, param_norm=1886.6339
Step 899: grad_norm=2.3891, loss=0.0884, param_norm=1886.6339
Step 900: grad_norm=1.4888, loss=0.0901, param_norm=1886.6339
22:41:04.397 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:41:04.398 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:41:04.398 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (3498277:checkpoint_manager.py:1786)
22:41:04.398 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (3498277:checkpoint_manager.py:1817)
22:41:04.399 [I] [process=0] Saving checkpoint at step 900                                        (3498277:checkpoint_manager.py:1286)
22:41:04.400 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900. (3498277:async_checkpointer.py:358)
22:41:04.401 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:41:04.402 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24 (3498277:atomicity.py:144)
22:41:04.403 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:41:04.404 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:41:04.405 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (3498277:atomicity.py:144)
22:41:04.405 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (3498277:atomicity.py:144)
22:41:04.406 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:41:04.414 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:41:08.117 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:41:08.118 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:41:08.120 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:41:08.121 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:41:08.138 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.139 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.145 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.146 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:30:13.675846+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.148 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:32:24.875471+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.148 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:34:35.238689+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.151 [I] Preserving Checkpoint[step=700 | time=2025-03-24 02:36:46.276150+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.151 [I] Preserving Checkpoint[step=800 | time=2025-03-24 02:38:58.336937+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:41:08.152 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:41:08.157 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:41:08.168 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:41:08.168 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742784064.3978581, 'wait_for_prev_duration_secs': 0.0010457038879394531, 'checkpointer_blocking_start_time': 1742784064.3997035, 'checkpointer_blocking_duration_secs': 3.7389419078826904, 'get_old_steps_start_time': 1742784068.1386955, 'get_old_steps_duration_secs': 0.01371145248413086, 'checkpoint_manager_blocking_start_time': 1742784064.3976686, 'checkpoint_manager_blocking_duration_secs': 3.7708232402801514} (3498277:standard_logger.py:34)
22:41:08.169 [I] Progress on: 901it/1.00kit rate:2.4s/it remaining:04:02 elapsed:19:48 postfix:-  (3498277:tqdm_logging.py:145)
Step 901: grad_norm=1.2577, loss=0.0567, param_norm=1886.6339
Step 902: grad_norm=1.7076, loss=0.0822, param_norm=1886.6339
Step 903: grad_norm=1.6749, loss=0.0881, param_norm=1886.6339
Step 904: grad_norm=1.3752, loss=0.0888, param_norm=1886.6340
Step 905: grad_norm=1.7362, loss=0.0634, param_norm=1886.6339
22:41:15.352 [I] ChainedFuture completed 1/1 futures in 7.22 seconds.                             (3498277:future.py:137)
22:41:15.352 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 946.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:41:15.353 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:41:15.354 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24 (3498277:async_checkpointer.py:406)
22:41:15.354 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24/assets (3498277:atomicity.py:287)
22:41:15.365 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24/params (3498277:atomicity.py:287)
22:41:15.366 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900 (3498277:async_checkpointer.py:416)
22:41:15.366 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24 (3498277:async_checkpointer.py:426)
22:41:15.366 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900 (3498277:atomicity.py:287)
22:41:15.368 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/900`. (3498277:atomicity.py:548)
22:41:15.368 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:41:15.369 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:41:15.369 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:41:15.369 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:41:15.370 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
Step 906: grad_norm=1.9421, loss=0.0509, param_norm=1886.6339
Step 907: grad_norm=1.1619, loss=0.0596, param_norm=1886.6340
Step 908: grad_norm=1.6043, loss=0.0850, param_norm=1886.6340
22:41:18.914 [I] Progress on: 908it/1.00kit rate:1.4s/it remaining:02:11 elapsed:19:59 postfix:-  (3498277:tqdm_logging.py:145)
Step 909: grad_norm=2.9083, loss=0.0907, param_norm=1886.6340
Step 910: grad_norm=1.6171, loss=0.0685, param_norm=1886.6340
Step 911: grad_norm=1.8052, loss=0.0507, param_norm=1886.6340
Step 912: grad_norm=1.7817, loss=0.0710, param_norm=1886.6340
Step 913: grad_norm=2.5290, loss=0.1057, param_norm=1886.6342
Step 914: grad_norm=1.6999, loss=0.0945, param_norm=1886.6342
Step 915: grad_norm=1.7077, loss=0.0810, param_norm=1886.6342
Step 916: grad_norm=1.5560, loss=0.0764, param_norm=1886.6342
Step 917: grad_norm=1.4774, loss=0.0658, param_norm=1886.6342
22:41:29.130 [I] Progress on: 917it/1.00kit rate:1.1s/it remaining:01:35 elapsed:20:09 postfix:-  (3498277:tqdm_logging.py:145)
Step 918: grad_norm=2.2249, loss=0.0871, param_norm=1886.6342
Step 919: grad_norm=1.7672, loss=0.0839, param_norm=1886.6342
Step 920: grad_norm=2.2169, loss=0.0843, param_norm=1886.6342
Step 921: grad_norm=1.6511, loss=0.0665, param_norm=1886.6342
Step 922: grad_norm=2.3544, loss=0.1106, param_norm=1886.6342
Step 923: grad_norm=2.7234, loss=0.0766, param_norm=1886.6342
Step 924: grad_norm=1.5820, loss=0.0728, param_norm=1886.6343
Step 925: grad_norm=2.1575, loss=0.0990, param_norm=1886.6343
22:41:40.182 [I] Progress on: 925it/1.00kit rate:1.4s/it remaining:01:44 elapsed:20:20 postfix:-  (3498277:tqdm_logging.py:145)
Step 926: grad_norm=1.7120, loss=0.0626, param_norm=1886.6343
Step 927: grad_norm=2.0230, loss=0.1046, param_norm=1886.6343
Step 928: grad_norm=1.7988, loss=0.0835, param_norm=1886.6343
Step 929: grad_norm=2.6432, loss=0.0783, param_norm=1886.6343
Step 930: grad_norm=1.6437, loss=0.0720, param_norm=1886.6343
Step 931: grad_norm=2.2152, loss=0.0697, param_norm=1886.6343
Step 932: grad_norm=3.4737, loss=0.0868, param_norm=1886.6344
Step 933: grad_norm=1.9231, loss=0.0768, param_norm=1886.6344
Step 934: grad_norm=1.9817, loss=0.0819, param_norm=1886.6344
22:41:51.252 [I] Progress on: 934it/1.00kit rate:1.2s/it remaining:01:17 elapsed:20:31 postfix:-  (3498277:tqdm_logging.py:145)
Step 935: grad_norm=1.3738, loss=0.0578, param_norm=1886.6344
Step 936: grad_norm=1.6837, loss=0.0683, param_norm=1886.6344
Step 937: grad_norm=1.8861, loss=0.0867, param_norm=1886.6344
Step 938: grad_norm=1.4207, loss=0.0753, param_norm=1886.6344
Step 939: grad_norm=2.1184, loss=0.0590, param_norm=1886.6344
Step 940: grad_norm=2.2997, loss=0.1101, param_norm=1886.6344
Step 941: grad_norm=1.7508, loss=0.0607, param_norm=1886.6344
Step 942: grad_norm=2.2363, loss=0.0523, param_norm=1886.6344
Step 943: grad_norm=1.3149, loss=0.0566, param_norm=1886.6344
22:42:02.217 [I] Progress on: 943it/1.00kit rate:1.3s/it remaining:01:13 elapsed:20:42 postfix:-  (3498277:tqdm_logging.py:145)
Step 944: grad_norm=1.5757, loss=0.0562, param_norm=1886.6344
Step 945: grad_norm=1.7097, loss=0.0736, param_norm=1886.6344
Step 946: grad_norm=1.7946, loss=0.0836, param_norm=1886.6344
Step 947: grad_norm=1.7862, loss=0.0881, param_norm=1886.6344
Step 948: grad_norm=2.0701, loss=0.0895, param_norm=1886.6344
Step 949: grad_norm=1.9220, loss=0.0775, param_norm=1886.6344
Step 950: grad_norm=1.8847, loss=0.0608, param_norm=1886.6344
22:42:12.540 [I] Progress on: 950it/1.00kit rate:1.4s/it remaining:01:10 elapsed:20:52 postfix:-  (3498277:tqdm_logging.py:145)
Step 951: grad_norm=2.3007, loss=0.0715, param_norm=1886.6344
Step 952: grad_norm=1.9813, loss=0.0930, param_norm=1886.6344
Step 953: grad_norm=1.6502, loss=0.0787, param_norm=1886.6344
Step 954: grad_norm=1.4691, loss=0.0727, param_norm=1886.6344
Step 955: grad_norm=1.5989, loss=0.0774, param_norm=1886.6345
Step 956: grad_norm=2.8753, loss=0.1076, param_norm=1886.6345
Step 957: grad_norm=2.5816, loss=0.0661, param_norm=1886.6345
Step 958: grad_norm=2.3227, loss=0.1078, param_norm=1886.6345
Step 959: grad_norm=2.7682, loss=0.1019, param_norm=1886.6345
22:42:22.739 [I] Progress on: 959it/1.00kit rate:1.2s/it remaining:00:47 elapsed:21:03 postfix:-  (3498277:tqdm_logging.py:145)
Step 960: grad_norm=1.5060, loss=0.0730, param_norm=1886.6345
Step 961: grad_norm=1.4605, loss=0.0563, param_norm=1886.6345
Step 962: grad_norm=1.4178, loss=0.0678, param_norm=1886.6345
Step 963: grad_norm=1.9983, loss=0.1040, param_norm=1886.6345
Step 964: grad_norm=1.6369, loss=0.0551, param_norm=1886.6345
Step 965: grad_norm=1.4163, loss=0.0569, param_norm=1886.6345
Step 966: grad_norm=1.6129, loss=0.0582, param_norm=1886.6345
Step 967: grad_norm=1.4010, loss=0.0741, param_norm=1886.6345
22:42:33.849 [I] Progress on: 967it/1.00kit rate:1.5s/it remaining:00:48 elapsed:21:14 postfix:-  (3498277:tqdm_logging.py:145)
Step 968: grad_norm=1.1959, loss=0.0359, param_norm=1886.6345
Step 969: grad_norm=1.4943, loss=0.0642, param_norm=1886.6345
Step 970: grad_norm=1.4477, loss=0.0430, param_norm=1886.6345
Step 971: grad_norm=1.3973, loss=0.0608, param_norm=1886.6345
Step 972: grad_norm=1.7401, loss=0.0667, param_norm=1886.6346
Step 973: grad_norm=1.3845, loss=0.0555, param_norm=1886.6346
Step 974: grad_norm=1.6561, loss=0.0731, param_norm=1886.6346
Step 975: grad_norm=1.6023, loss=0.0747, param_norm=1886.6346
22:42:43.931 [I] Progress on: 975it/1.00kit rate:1.2s/it remaining:00:29 elapsed:21:24 postfix:-  (3498277:tqdm_logging.py:145)
Step 976: grad_norm=1.6110, loss=0.0718, param_norm=1886.6346
Step 977: grad_norm=1.1525, loss=0.0619, param_norm=1886.6346
Step 978: grad_norm=1.8448, loss=0.0675, param_norm=1886.6346
Step 979: grad_norm=1.5409, loss=0.0646, param_norm=1886.6346
Step 980: grad_norm=2.2960, loss=0.0855, param_norm=1886.6346
Step 981: grad_norm=1.1185, loss=0.0399, param_norm=1886.6346
Step 982: grad_norm=1.9523, loss=0.0830, param_norm=1886.6346
Step 983: grad_norm=1.4040, loss=0.0596, param_norm=1886.6346
Step 984: grad_norm=0.8272, loss=0.0360, param_norm=1886.6346
22:42:55.075 [I] Progress on: 984it/1.00kit rate:1.2s/it remaining:00:19 elapsed:21:35 postfix:-  (3498277:tqdm_logging.py:145)
Step 985: grad_norm=1.5388, loss=0.0589, param_norm=1886.6346
Step 986: grad_norm=2.0988, loss=0.0783, param_norm=1886.6348
Step 987: grad_norm=1.4952, loss=0.0557, param_norm=1886.6348
Step 988: grad_norm=1.8649, loss=0.0844, param_norm=1886.6348
Step 989: grad_norm=1.1942, loss=0.0542, param_norm=1886.6348
Step 990: grad_norm=1.0701, loss=0.0494, param_norm=1886.6348
Step 991: grad_norm=1.2632, loss=0.0486, param_norm=1886.6348
Step 992: grad_norm=1.3394, loss=0.0637, param_norm=1886.6348
22:43:06.268 [I] Progress on: 992it/1.00kit rate:1.4s/it remaining:00:11 elapsed:21:46 postfix:-  (3498277:tqdm_logging.py:145)
Step 993: grad_norm=2.1609, loss=0.0826, param_norm=1886.6349
Step 994: grad_norm=1.6473, loss=0.0814, param_norm=1886.6349
Step 995: grad_norm=1.4814, loss=0.0727, param_norm=1886.6349
Step 996: grad_norm=2.5961, loss=0.0811, param_norm=1886.6349
Step 997: grad_norm=3.5714, loss=0.0921, param_norm=1886.6349
Step 998: grad_norm=1.6627, loss=0.0631, param_norm=1886.6349
Step 999: grad_norm=1.4969, loss=0.0649, param_norm=1886.6349
22:43:14.341 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:43:14.341 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:43:14.341 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (3498277:checkpoint_manager.py:1786)
22:43:14.341 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (3498277:checkpoint_manager.py:1817)
22:43:14.342 [I] [process=0] Saving checkpoint at step 999                                        (3498277:checkpoint_manager.py:1286)
22:43:14.342 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999. (3498277:async_checkpointer.py:358)
22:43:14.344 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:43:14.344 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27 (3498277:atomicity.py:144)
22:43:14.345 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:43:14.346 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3498277:multihost.py:293)
22:43:14.347 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (3498277:atomicity.py:144)
22:43:14.347 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (3498277:atomicity.py:144)
22:43:14.349 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3498277:multihost.py:293)
22:43:14.361 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3498277:replica_slices.py:419)
22:43:17.981 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3498277:tensorstore_utils.py:371)
22:43:17.981 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:43:17.983 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3498277:tensorstore_utils.py:371)
22:43:17.987 [I] [process=0][thread=async_save] Background save thread started.                   (3498277:async_checkpointer.py:121)
22:43:18.012 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:23:38.454858+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.014 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:25:50.871141+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.018 [I] Preserving Checkpoint[step=300 | time=2025-03-24 02:28:02.437658+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.019 [I] Preserving Checkpoint[step=400 | time=2025-03-24 02:30:13.675846+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.020 [I] Preserving Checkpoint[step=500 | time=2025-03-24 02:32:24.875471+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.020 [I] Preserving Checkpoint[step=600 | time=2025-03-24 02:34:35.238689+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.020 [I] Preserving Checkpoint[step=700 | time=2025-03-24 02:36:46.276150+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.021 [I] Preserving Checkpoint[step=800 | time=2025-03-24 02:38:58.336937+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.021 [I] Preserving Checkpoint[step=900 | time=2025-03-24 02:41:08.138660+00:00 | is_locked=None]: (Reason: on keep_period=100). (3498277:checkpoint_manager.py:1734)
22:43:18.021 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3498277:multihost.py:293)
22:43:18.021 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (3498277:checkpoint_manager.py:1328)
22:43:18.022 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3498277:async_checkpointer.py:231)
22:43:18.022 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742784194.3413534, 'wait_for_prev_duration_secs': 0.0006358623504638672, 'checkpointer_blocking_start_time': 1742784194.3424985, 'checkpointer_blocking_duration_secs': 3.670304536819458, 'get_old_steps_start_time': 1742784198.012853, 'get_old_steps_duration_secs': 0.00862264633178711, 'checkpoint_manager_blocking_start_time': 1742784194.3412275, 'checkpoint_manager_blocking_duration_secs': 3.681537628173828} (3498277:standard_logger.py:34)
22:43:18.023 [I] Progress on: 1.00kit/1.00kit rate:2.3s/it remaining:00:00 elapsed:21:58 postfix:- (3498277:tqdm_logging.py:145)
22:43:18.024 [I] Progress on: 1.00kit/1.00kit rate:2.3s/it remaining:00:00 elapsed:21:58 postfix:- (3498277:tqdm_logging.py:145)
22:43:18.024 [I] Waiting for checkpoint manager to finish                                         (3498277:train.py:268)
22:43:18.024 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3498277:checkpoint_manager.py:1759)
22:43:18.026 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3498277:checkpoint_manager.py:1777)
22:43:24.788 [I] ChainedFuture completed 1/1 futures in 6.79 seconds.                             (3498277:future.py:137)
22:43:24.789 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 992.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (3498277:base_pytree_checkpoint_handler.py:113)
22:43:24.789 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3498277:async_checkpointer.py:131)
22:43:24.790 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fe7d602e490> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27 (3498277:async_checkpointer.py:406)
22:43:24.791 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27/assets (3498277:atomicity.py:287)
22:43:24.800 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27/params (3498277:atomicity.py:287)
22:43:24.801 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999 (3498277:async_checkpointer.py:416)
22:43:24.801 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27 (3498277:async_checkpointer.py:426)
22:43:24.801 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999 (3498277:atomicity.py:287)
22:43:24.803 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid___finetune_on_pokeball/1st_try_pi0_pokeball/999`. (3498277:atomicity.py:548)
22:43:24.803 [I] [process=0][thread=async_save] Background save thread done.                      (3498277:async_checkpointer.py:183)
22:43:24.803 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3498277:async_checkpointer.py:239)
22:43:24.804 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3498277:async_checkpointer.py:249)
22:43:24.804 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (3498277:checkpoint_manager.py:1890)
22:43:24.804 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (3498277:checkpoint_manager.py:1905)
22:43:24.805 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (3498277:checkpoint_manager.py:1786)
22:43:24.805 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (3498277:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_pi0_pokeball[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/ahr49u42[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250323_221904-ahr49u42/logs[0m
