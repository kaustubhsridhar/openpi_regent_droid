nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
09:46:26.249 [I] Running on: ivy                                                                  (511844:train_pi0_fast_regent.py:226)
INFO:2025-04-08 09:46:27,084:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
09:46:27.084 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (511844:xla_bridge.py:945)
INFO:2025-04-08 09:46:27,085:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
09:46:27.085 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (511844:xla_bridge.py:945)
09:46:28.413 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (511844:base_pytree_checkpoint_handler.py:332)
09:46:28.414 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (511844:base_pytree_checkpoint_handler.py:332)
09:46:28.414 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (511844:multihost.py:375)
09:46:28.414 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7f00c84e5990>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c8636a50>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c87ee650>}, handler_registry=None (511844:checkpoint_manager.py:622)
09:46:28.414 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7f00c84e5990>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (511844:composite_checkpoint_handler.py:239)
09:46:28.414 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c8636a50>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (511844:composite_checkpoint_handler.py:239)
09:46:28.414 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c87ee650>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (511844:composite_checkpoint_handler.py:239)
09:46:28.414 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f00c8635390>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (511844:composite_checkpoint_handler.py:239)
09:46:28.414 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f00c84e5990>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f00c84e5990>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c8636a50>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c8636a50>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c87ee650>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f00c87ee650>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f00c8635390>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f00c8635390>}). (511844:composite_checkpoint_handler.py:508)
09:46:28.415 [I] orbax-checkpoint version: 0.11.1                                                 (511844:abstract_checkpointer.py:35)
09:46:28.415 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f00c8707560> timeout: 7200 secs and primary_host=0 for async checkpoint writes (511844:async_checkpointer.py:80)
09:46:28.415 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel (511844:checkpoint_manager.py:1528)
09:46:28.415 [I] Saving root metadata                                                             (511844:checkpoint_manager.py:1569)
09:46:28.415 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (511844:multihost.py:293)
09:46:28.415 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f00c8639c90> (511844:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250408_094628-jry3e5l1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_regent_bagel
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/jry3e5l1
Some kwargs in processor config are unused and will not have any effect: min_token, time_horizon, action_dim, vocab_size, scale. 
Some kwargs in processor config are unused and will not have any effect: min_token, time_horizon, action_dim, vocab_size, scale. 
09:46:30.582 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/droid (511844:config.py:167)
count_droid: 0, count_collected_demos: 1354
len_dataset: 1354
all 20 episode prompts are the same: pick up the bagel and put it in the toaster
09:46:51.804 [I] Initialized data loader:
[0].query_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].query_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].query_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].query_image_masks['base_0_rgb']: (16,)@bool
[0].query_image_masks['base_1_rgb']: (16,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].exp_lamda_distances: (16, 5, 1)@float32
[0].query_state: (16, 8)@float32
[0].retrieved_0_state: (16, 8)@float32
[0].retrieved_1_state: (16, 8)@float32
[0].retrieved_2_state: (16, 8)@float32
[0].retrieved_3_state: (16, 8)@float32
[0].query_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_prefix: (16, 125)@int32
[0].query_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_postfix: (16, 125)@int32
[0].query_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_0_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_1_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_2_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_3_tokenized_prompt_mask: (16, 250)@bool
[0].query_token_ar_mask: (16, 250)@int32
[0].retrieved_0_token_ar_mask: (16, 250)@int32
[0].retrieved_1_token_ar_mask: (16, 250)@int32
[0].retrieved_2_token_ar_mask: (16, 250)@int32
[0].retrieved_3_token_ar_mask: (16, 250)@int32
[0].query_token_loss_mask: (16, 250)@bool
[0].retrieved_0_token_loss_mask: (16, 250)@bool
[0].retrieved_1_token_loss_mask: (16, 250)@bool
[0].retrieved_2_token_loss_mask: (16, 250)@bool
[0].retrieved_3_token_loss_mask: (16, 250)@bool
[1]: (16, 15, 8)@float32 (511844:train_pi0_fast_regent.py:258)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
09:46:52.617 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (511844:base_pytree_checkpoint_handler.py:332)
09:46:52.652 [I] Restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (511844:checkpointer.py:256)
09:47:02.944 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 1006.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
09:47:02.945 [I] Finished restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (511844:checkpointer.py:259)
09:47:02.945 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (511844:multihost.py:293)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
2025-04-08 09:47:08.019677: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 30.69GiB (32957682654 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
09:47:10.287 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (511844:train_pi0_fast_regent.py:262)
decode_indices shape: (1245,)
09:47:10.376 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (511844:tqdm_logging.py:145)
first_targets shape: (16, 125, 257152)
input_token_embeddings shape: (16, 5090, 2048)
attn_mask shape: (16, 5090, 5090)
loss_mask shape: (16, 249)
targets shape: (16, 249, 257152)
pre_logits shape: (16, 5089, 2048)
logits shape: (16, 249, 257152)
new_logits shape: (16, 249, 257152)
logp shape: (16, 249, 257152)
token_pplx shape: (16, 249)
loss shape: (16,)
Step 0: grad_norm=11.084589004516602, loss=3.366734504699707, param_norm=1886.9476318359375
09:47:31.216 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:20 postfix:-                   (511844:tqdm_logging.py:145)
Step 1: grad_norm=14.037179946899414, loss=3.522433280944824, param_norm=1886.9476318359375
Step 2: grad_norm=11.96941089630127, loss=3.587193250656128, param_norm=1886.9476318359375
09:47:48.393 [I] Progress on: 2.00it/1.00kit rate:13.7s/it remaining:3:48:09 elapsed:00:38 postfix:- (511844:tqdm_logging.py:145)
Step 3: grad_norm=11.665314674377441, loss=3.5983033180236816, param_norm=1886.9476318359375
Step 4: grad_norm=10.466195106506348, loss=3.321204423904419, param_norm=1886.9476318359375
09:48:05.604 [I] Progress on: 4.00it/1.00kit rate:10.3s/it remaining:2:50:41 elapsed:00:55 postfix:- (511844:tqdm_logging.py:145)
Step 5: grad_norm=14.575883865356445, loss=3.4624338150024414, param_norm=1886.9476318359375
Step 6: grad_norm=14.97249698638916, loss=3.685300827026367, param_norm=1886.947509765625
09:48:22.855 [I] Progress on: 6.00it/1.00kit rate:9.3s/it remaining:2:34:29 elapsed:01:12 postfix:- (511844:tqdm_logging.py:145)
Step 7: grad_norm=8.694304466247559, loss=3.2173781394958496, param_norm=1886.9473876953125
Step 8: grad_norm=8.78324031829834, loss=3.4888393878936768, param_norm=1886.9473876953125
09:48:40.153 [I] Progress on: 8.00it/1.00kit rate:9.0s/it remaining:2:28:06 elapsed:01:29 postfix:- (511844:tqdm_logging.py:145)
Step 9: grad_norm=8.69891357421875, loss=3.061070442199707, param_norm=1886.9473876953125
Step 10: grad_norm=15.180377960205078, loss=3.2373008728027344, param_norm=1886.947265625
09:48:57.500 [I] Progress on: 10.0it/1.00kit rate:8.8s/it remaining:2:25:21 elapsed:01:47 postfix:- (511844:tqdm_logging.py:145)
Step 11: grad_norm=8.55062484741211, loss=3.0864481925964355, param_norm=1886.9471435546875
Step 12: grad_norm=7.4271955490112305, loss=3.184422492980957, param_norm=1886.9471435546875
09:49:14.867 [I] Progress on: 12.0it/1.00kit rate:8.7s/it remaining:2:24:00 elapsed:02:04 postfix:- (511844:tqdm_logging.py:145)
Step 13: grad_norm=16.636831283569336, loss=3.2335119247436523, param_norm=1886.947021484375
Step 14: grad_norm=13.307779312133789, loss=3.0369348526000977, param_norm=1886.947021484375
09:49:32.272 [I] Progress on: 14.0it/1.00kit rate:8.7s/it remaining:2:23:21 elapsed:02:21 postfix:- (511844:tqdm_logging.py:145)
Step 15: grad_norm=5.450131893157959, loss=2.9222798347473145, param_norm=1886.947021484375
Step 16: grad_norm=7.363194942474365, loss=2.844717502593994, param_norm=1886.947021484375
09:49:49.675 [I] Progress on: 16.0it/1.00kit rate:8.7s/it remaining:2:22:57 elapsed:02:39 postfix:- (511844:tqdm_logging.py:145)
Step 17: grad_norm=6.808437824249268, loss=3.130707263946533, param_norm=1886.9468994140625
Step 18: grad_norm=11.221914291381836, loss=3.104094982147217, param_norm=1886.9468994140625
09:50:07.132 [I] Progress on: 18.0it/1.00kit rate:8.7s/it remaining:2:22:46 elapsed:02:56 postfix:- (511844:tqdm_logging.py:145)
Step 19: grad_norm=10.734049797058105, loss=2.838170051574707, param_norm=1886.9468994140625
Step 20: grad_norm=7.134007930755615, loss=2.8517489433288574, param_norm=1886.9468994140625
09:50:24.657 [I] Progress on: 20.0it/1.00kit rate:8.7s/it remaining:2:22:47 elapsed:03:14 postfix:- (511844:tqdm_logging.py:145)
Step 21: grad_norm=17.972959518432617, loss=3.084324836730957, param_norm=1886.9468994140625
Step 22: grad_norm=11.5770263671875, loss=2.857862710952759, param_norm=1886.9468994140625
09:50:42.143 [I] Progress on: 22.0it/1.00kit rate:8.7s/it remaining:2:22:32 elapsed:03:31 postfix:- (511844:tqdm_logging.py:145)
Step 23: grad_norm=5.552380084991455, loss=2.829857110977173, param_norm=1886.9468994140625
Step 24: grad_norm=8.154455184936523, loss=2.8924596309661865, param_norm=1886.9468994140625
09:50:59.645 [I] Progress on: 24.0it/1.00kit rate:8.8s/it remaining:2:22:20 elapsed:03:49 postfix:- (511844:tqdm_logging.py:145)
Step 25: grad_norm=5.561005592346191, loss=2.9443328380584717, param_norm=1886.947021484375
Step 26: grad_norm=13.888296127319336, loss=2.772303581237793, param_norm=1886.947021484375
09:51:17.169 [I] Progress on: 26.0it/1.00kit rate:8.8s/it remaining:2:22:12 elapsed:04:06 postfix:- (511844:tqdm_logging.py:145)
Step 27: grad_norm=17.732250213623047, loss=2.838442802429199, param_norm=1886.9471435546875
Step 28: grad_norm=6.783775329589844, loss=2.8634204864501953, param_norm=1886.9471435546875
09:51:34.735 [I] Progress on: 28.0it/1.00kit rate:8.8s/it remaining:2:22:10 elapsed:04:24 postfix:- (511844:tqdm_logging.py:145)
Step 29: grad_norm=17.209787368774414, loss=2.7717509269714355, param_norm=1886.9473876953125
Step 30: grad_norm=7.163238525390625, loss=2.8395252227783203, param_norm=1886.9473876953125
09:51:52.293 [I] Progress on: 30.0it/1.00kit rate:8.8s/it remaining:2:21:59 elapsed:04:41 postfix:- (511844:tqdm_logging.py:145)
Step 31: grad_norm=4.826144695281982, loss=2.8678948879241943, param_norm=1886.9473876953125
Step 32: grad_norm=5.070949554443359, loss=2.8084006309509277, param_norm=1886.947509765625
09:52:09.817 [I] Progress on: 32.0it/1.00kit rate:8.8s/it remaining:2:21:32 elapsed:04:59 postfix:- (511844:tqdm_logging.py:145)
Step 33: grad_norm=5.195446968078613, loss=2.609799385070801, param_norm=1886.94775390625
Step 34: grad_norm=15.535022735595703, loss=2.657970905303955, param_norm=1886.9478759765625
09:52:27.369 [I] Progress on: 34.0it/1.00kit rate:8.8s/it remaining:2:21:21 elapsed:05:16 postfix:- (511844:tqdm_logging.py:145)
Step 35: grad_norm=7.588723182678223, loss=2.6224472522735596, param_norm=1886.947998046875
Step 36: grad_norm=6.195496559143066, loss=2.703235149383545, param_norm=1886.9482421875
09:52:44.924 [I] Progress on: 36.0it/1.00kit rate:8.8s/it remaining:2:21:04 elapsed:05:34 postfix:- (511844:tqdm_logging.py:145)
Step 37: grad_norm=6.831555366516113, loss=2.540985584259033, param_norm=1886.9483642578125
Step 38: grad_norm=14.229071617126465, loss=2.722384452819824, param_norm=1886.9486083984375
09:53:02.498 [I] Progress on: 38.0it/1.00kit rate:8.8s/it remaining:2:20:55 elapsed:05:52 postfix:- (511844:tqdm_logging.py:145)
Step 39: grad_norm=5.915472984313965, loss=2.9014430046081543, param_norm=1886.94873046875
Step 40: grad_norm=5.435000419616699, loss=2.486147403717041, param_norm=1886.948974609375
09:53:20.111 [I] Progress on: 40.0it/1.00kit rate:8.8s/it remaining:2:20:46 elapsed:06:09 postfix:- (511844:tqdm_logging.py:145)
Step 41: grad_norm=7.4781670570373535, loss=2.649012327194214, param_norm=1886.94921875
Step 42: grad_norm=6.339537620544434, loss=2.7475223541259766, param_norm=1886.949462890625
09:53:37.721 [I] Progress on: 42.0it/1.00kit rate:8.8s/it remaining:2:20:37 elapsed:06:27 postfix:- (511844:tqdm_logging.py:145)
Step 43: grad_norm=8.167806625366211, loss=2.8047008514404297, param_norm=1886.9498291015625
Step 44: grad_norm=8.010272979736328, loss=2.894355297088623, param_norm=1886.949951171875
09:53:55.294 [I] Progress on: 44.0it/1.00kit rate:8.8s/it remaining:2:20:11 elapsed:06:44 postfix:- (511844:tqdm_logging.py:145)
Step 45: grad_norm=6.502098083496094, loss=2.7221133708953857, param_norm=1886.9501953125
Step 46: grad_norm=11.9764986038208, loss=2.549190044403076, param_norm=1886.9505615234375
09:54:12.872 [I] Progress on: 46.0it/1.00kit rate:8.8s/it remaining:2:19:55 elapsed:07:02 postfix:- (511844:tqdm_logging.py:145)
Step 47: grad_norm=8.565903663635254, loss=2.5847854614257812, param_norm=1886.950927734375
Step 48: grad_norm=6.192019462585449, loss=2.6387746334075928, param_norm=1886.951171875
09:54:30.433 [I] Progress on: 48.0it/1.00kit rate:8.8s/it remaining:2:19:29 elapsed:07:20 postfix:- (511844:tqdm_logging.py:145)
Step 49: grad_norm=7.153148174285889, loss=2.609335422515869, param_norm=1886.951416015625
Step 50: grad_norm=9.54094409942627, loss=2.697859287261963, param_norm=1886.9517822265625
09:54:47.991 [I] Progress on: 50.0it/1.00kit rate:8.8s/it remaining:2:19:12 elapsed:07:37 postfix:- (511844:tqdm_logging.py:145)
Step 51: grad_norm=9.54584789276123, loss=2.688307285308838, param_norm=1886.9521484375
Step 52: grad_norm=6.287583351135254, loss=2.7097394466400146, param_norm=1886.9525146484375
09:55:05.538 [I] Progress on: 52.0it/1.00kit rate:8.8s/it remaining:2:18:50 elapsed:07:55 postfix:- (511844:tqdm_logging.py:145)
Step 53: grad_norm=7.114154815673828, loss=2.6362509727478027, param_norm=1886.952880859375
Step 54: grad_norm=8.641084671020508, loss=2.729597806930542, param_norm=1886.953125
09:55:23.106 [I] Progress on: 54.0it/1.00kit rate:8.8s/it remaining:2:18:34 elapsed:08:12 postfix:- (511844:tqdm_logging.py:145)
Step 55: grad_norm=9.573271751403809, loss=2.3474888801574707, param_norm=1886.95361328125
Step 56: grad_norm=12.651483535766602, loss=2.5980935096740723, param_norm=1886.953857421875
09:55:40.666 [I] Progress on: 56.0it/1.00kit rate:8.8s/it remaining:2:18:17 elapsed:08:30 postfix:- (511844:tqdm_logging.py:145)
Step 57: grad_norm=5.717981338500977, loss=2.7866322994232178, param_norm=1886.9541015625
Step 58: grad_norm=23.397661209106445, loss=2.653322696685791, param_norm=1886.9544677734375
09:55:58.294 [I] Progress on: 58.0it/1.00kit rate:8.8s/it remaining:2:18:17 elapsed:08:47 postfix:- (511844:tqdm_logging.py:145)
Step 59: grad_norm=15.068880081176758, loss=2.690715789794922, param_norm=1886.9547119140625
Step 60: grad_norm=17.297117233276367, loss=2.7060489654541016, param_norm=1886.9549560546875
09:56:15.890 [I] Progress on: 60.0it/1.00kit rate:8.8s/it remaining:2:17:58 elapsed:09:05 postfix:- (511844:tqdm_logging.py:145)
Step 61: grad_norm=16.21091079711914, loss=2.5860657691955566, param_norm=1886.955322265625
Step 62: grad_norm=15.91600227355957, loss=2.4472384452819824, param_norm=1886.95556640625
09:56:33.499 [I] Progress on: 62.0it/1.00kit rate:8.8s/it remaining:2:17:43 elapsed:09:23 postfix:- (511844:tqdm_logging.py:145)
Step 63: grad_norm=8.906991004943848, loss=2.656155824661255, param_norm=1886.9556884765625
Step 64: grad_norm=10.734545707702637, loss=2.6196818351745605, param_norm=1886.9561767578125
09:56:51.089 [I] Progress on: 64.0it/1.00kit rate:8.8s/it remaining:2:17:21 elapsed:09:40 postfix:- (511844:tqdm_logging.py:145)
Step 65: grad_norm=5.698453903198242, loss=2.548611640930176, param_norm=1886.9564208984375
Step 66: grad_norm=8.715673446655273, loss=2.604900360107422, param_norm=1886.9566650390625
09:57:08.678 [I] Progress on: 66.0it/1.00kit rate:8.8s/it remaining:2:17:04 elapsed:09:58 postfix:- (511844:tqdm_logging.py:145)
Step 67: grad_norm=10.122475624084473, loss=2.6513895988464355, param_norm=1886.9569091796875
Step 68: grad_norm=6.097752094268799, loss=2.4294159412384033, param_norm=1886.9571533203125
09:57:26.249 [I] Progress on: 68.0it/1.00kit rate:8.8s/it remaining:2:16:40 elapsed:10:15 postfix:- (511844:tqdm_logging.py:145)
Step 69: grad_norm=7.886449813842773, loss=2.471374034881592, param_norm=1886.95751953125
Step 70: grad_norm=4.906610012054443, loss=2.590625762939453, param_norm=1886.957763671875
09:57:43.848 [I] Progress on: 70.0it/1.00kit rate:8.8s/it remaining:2:16:26 elapsed:10:33 postfix:- (511844:tqdm_logging.py:145)
Step 71: grad_norm=13.879974365234375, loss=2.417210102081299, param_norm=1886.9580078125
Step 72: grad_norm=7.779964447021484, loss=2.629347324371338, param_norm=1886.9583740234375
09:58:01.426 [I] Progress on: 72.0it/1.00kit rate:8.8s/it remaining:2:16:07 elapsed:10:51 postfix:- (511844:tqdm_logging.py:145)
Step 73: grad_norm=10.327840805053711, loss=2.581231117248535, param_norm=1886.958740234375
Step 74: grad_norm=5.713099002838135, loss=2.5963926315307617, param_norm=1886.9591064453125
09:58:19.023 [I] Progress on: 74.0it/1.00kit rate:8.8s/it remaining:2:15:52 elapsed:11:08 postfix:- (511844:tqdm_logging.py:145)
Step 75: grad_norm=5.015537738800049, loss=2.541745185852051, param_norm=1886.95947265625
Step 76: grad_norm=14.697351455688477, loss=2.6827433109283447, param_norm=1886.9598388671875
09:58:36.624 [I] Progress on: 76.0it/1.00kit rate:8.8s/it remaining:2:15:37 elapsed:11:26 postfix:- (511844:tqdm_logging.py:145)
Step 77: grad_norm=5.755417346954346, loss=2.5775842666625977, param_norm=1886.9600830078125
Step 78: grad_norm=8.207154273986816, loss=2.592923164367676, param_norm=1886.9603271484375
09:58:54.253 [I] Progress on: 78.0it/1.00kit rate:8.8s/it remaining:2:15:26 elapsed:11:43 postfix:- (511844:tqdm_logging.py:145)
Step 79: grad_norm=8.875225067138672, loss=2.7520034313201904, param_norm=1886.960693359375
Step 80: grad_norm=7.6082587242126465, loss=2.6694934368133545, param_norm=1886.9610595703125
09:59:11.841 [I] Progress on: 80.0it/1.00kit rate:8.8s/it remaining:2:15:03 elapsed:12:01 postfix:- (511844:tqdm_logging.py:145)
Step 81: grad_norm=6.253138065338135, loss=2.5028414726257324, param_norm=1886.9613037109375
Step 82: grad_norm=11.703722953796387, loss=2.6466140747070312, param_norm=1886.961669921875
09:59:29.450 [I] Progress on: 82.0it/1.00kit rate:8.8s/it remaining:2:14:48 elapsed:12:19 postfix:- (511844:tqdm_logging.py:145)
Step 83: grad_norm=5.226897239685059, loss=2.2484638690948486, param_norm=1886.9619140625
09:59:40.798 [I] Progress on: 84.0it/1.00kit rate:9.5s/it remaining:2:25:26 elapsed:12:30 postfix:- (511844:tqdm_logging.py:145)
Step 84: grad_norm=5.328095436096191, loss=2.1506502628326416, param_norm=1886.9622802734375
Step 85: grad_norm=5.534212112426758, loss=2.3981497287750244, param_norm=1886.9625244140625
09:59:58.272 [I] Progress on: 85.0it/1.00kit rate:9.3s/it remaining:2:22:09 elapsed:12:47 postfix:- (511844:tqdm_logging.py:145)
Step 86: grad_norm=5.708208084106445, loss=2.3667221069335938, param_norm=1886.962890625
Step 87: grad_norm=12.211404800415039, loss=2.1066887378692627, param_norm=1886.963134765625
10:00:15.859 [I] Progress on: 87.0it/1.00kit rate:9.1s/it remaining:2:17:43 elapsed:13:05 postfix:- (511844:tqdm_logging.py:145)
Step 88: grad_norm=6.02760648727417, loss=2.227677822113037, param_norm=1886.9635009765625
Step 89: grad_norm=6.238579750061035, loss=2.206056594848633, param_norm=1886.9638671875
10:00:33.437 [I] Progress on: 89.0it/1.00kit rate:8.9s/it remaining:2:15:24 elapsed:13:23 postfix:- (511844:tqdm_logging.py:145)
Step 90: grad_norm=10.743695259094238, loss=2.2842516899108887, param_norm=1886.9642333984375
Step 91: grad_norm=12.86949634552002, loss=2.0635900497436523, param_norm=1886.964599609375
10:00:51.015 [I] Progress on: 91.0it/1.00kit rate:8.9s/it remaining:2:14:08 elapsed:13:40 postfix:- (511844:tqdm_logging.py:145)
Step 92: grad_norm=11.791359901428223, loss=2.245371103286743, param_norm=1886.9649658203125
Step 93: grad_norm=12.79101276397705, loss=2.2506632804870605, param_norm=1886.9654541015625
10:01:08.593 [I] Progress on: 93.0it/1.00kit rate:8.8s/it remaining:2:13:20 elapsed:13:58 postfix:- (511844:tqdm_logging.py:145)
Step 94: grad_norm=9.969998359680176, loss=2.2857894897460938, param_norm=1886.9658203125
Step 95: grad_norm=5.778167247772217, loss=2.27764630317688, param_norm=1886.9661865234375
10:01:26.189 [I] Progress on: 95.0it/1.00kit rate:8.8s/it remaining:2:12:53 elapsed:14:15 postfix:- (511844:tqdm_logging.py:145)
Step 96: grad_norm=22.517961502075195, loss=2.1271071434020996, param_norm=1886.9666748046875
Step 97: grad_norm=10.27649211883545, loss=2.4007930755615234, param_norm=1886.967041015625
10:01:43.775 [I] Progress on: 97.0it/1.00kit rate:8.8s/it remaining:2:12:28 elapsed:14:33 postfix:- (511844:tqdm_logging.py:145)
Step 98: grad_norm=7.975195407867432, loss=2.4182233810424805, param_norm=1886.9674072265625
Step 99: grad_norm=11.66555118560791, loss=2.2953739166259766, param_norm=1886.9677734375
10:02:01.360 [I] Progress on: 99.0it/1.00kit rate:8.8s/it remaining:2:12:07 elapsed:14:50 postfix:- (511844:tqdm_logging.py:145)
Step 100: grad_norm=15.343722343444824, loss=2.3631134033203125, param_norm=1886.9681396484375
10:02:10.310 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
10:02:10.311 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (511844:checkpoint_manager.py:1767)
10:02:10.312 [I] [process=0] Saving checkpoint at step 100                                        (511844:checkpoint_manager.py:1286)
10:02:10.313 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100. (511844:async_checkpointer.py:358)
10:02:10.314 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:02:10.315 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0 (511844:atomicity.py:144)
10:02:10.316 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:02:10.317 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:02:10.317 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744120930315779823, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1744120930315779823, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (511844:checkpoint.py:185)
10:02:10.318 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (511844:atomicity.py:144)
10:02:10.318 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (511844:atomicity.py:144)
10:02:10.319 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:02:10.329 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
10:02:13.951 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
10:02:13.952 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:02:13.953 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
10:02:13.955 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
10:02:13.972 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
10:02:13.980 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
10:02:13.985 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
10:02:13.986 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744120930.3108177, 'wait_for_prev_duration_secs': 0.0006699562072753906, 'checkpointer_blocking_start_time': 1744120930.3123853, 'checkpointer_blocking_duration_secs': 3.660261392593384, 'get_old_steps_start_time': 1744120933.972747, 'get_old_steps_duration_secs': 6.4373016357421875e-06, 'checkpoint_manager_blocking_start_time': 1744120930.3106086, 'checkpoint_manager_blocking_duration_secs': 3.6759209632873535} (511844:standard_logger.py:34)
10:02:13.989 [I] Progress on: 101it/1.00kit rate:9.9s/it remaining:2:28:23 elapsed:15:03 postfix:- (511844:tqdm_logging.py:145)
Step 101: grad_norm=11.177484512329102, loss=2.2763190269470215, param_norm=1886.9686279296875
10:02:22.939 [I] ChainedFuture completed 1/1 futures in 8.98 seconds.                             (511844:future.py:137)
10:02:22.940 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 821.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:02:22.940 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
10:02:22.941 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744120930315779823, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (511844:checkpoint.py:225)
10:02:22.943 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0 (511844:async_checkpointer.py:406)
10:02:22.944 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/assets (511844:atomicity.py:287)
10:02:22.947 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744120930315779823, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (511844:checkpoint.py:244)
10:02:22.956 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0/params (511844:atomicity.py:287)
10:02:22.957 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100 (511844:async_checkpointer.py:416)
10:02:22.957 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0 (511844:async_checkpointer.py:426)
10:02:22.957 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100 (511844:atomicity.py:287)
10:02:22.959 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/100`. (511844:atomicity.py:548)
10:02:22.959 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
10:02:22.959 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
10:02:22.960 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
10:02:22.960 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
10:02:22.960 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 102: grad_norm=8.786652565002441, loss=2.1267645359039307, param_norm=1886.9688720703125
10:02:31.487 [I] Progress on: 102it/1.00kit rate:9.6s/it remaining:2:23:30 elapsed:15:21 postfix:- (511844:tqdm_logging.py:145)
Step 103: grad_norm=6.107678413391113, loss=2.1997809410095215, param_norm=1886.96923828125
Step 104: grad_norm=10.140023231506348, loss=2.0995733737945557, param_norm=1886.9696044921875
10:02:49.083 [I] Progress on: 104it/1.00kit rate:9.2s/it remaining:2:17:11 elapsed:15:38 postfix:- (511844:tqdm_logging.py:145)
Step 105: grad_norm=10.19511604309082, loss=2.2199251651763916, param_norm=1886.969970703125
Step 106: grad_norm=6.5114827156066895, loss=2.330183506011963, param_norm=1886.9703369140625
10:03:06.663 [I] Progress on: 106it/1.00kit rate:9.0s/it remaining:2:13:49 elapsed:15:56 postfix:- (511844:tqdm_logging.py:145)
Step 107: grad_norm=9.339160919189453, loss=2.4244236946105957, param_norm=1886.970703125
Step 108: grad_norm=12.285429954528809, loss=2.2815346717834473, param_norm=1886.970947265625
10:03:24.256 [I] Progress on: 108it/1.00kit rate:8.9s/it remaining:2:12:07 elapsed:16:13 postfix:- (511844:tqdm_logging.py:145)
Step 109: grad_norm=9.244466781616211, loss=2.124696969985962, param_norm=1886.971435546875
Step 110: grad_norm=6.587001800537109, loss=2.128356456756592, param_norm=1886.9718017578125
10:03:41.855 [I] Progress on: 110it/1.00kit rate:8.8s/it remaining:2:11:08 elapsed:16:31 postfix:- (511844:tqdm_logging.py:145)
Step 111: grad_norm=5.403702259063721, loss=2.4039738178253174, param_norm=1886.97216796875
Step 112: grad_norm=5.664291858673096, loss=2.147839069366455, param_norm=1886.9725341796875
10:03:59.479 [I] Progress on: 112it/1.00kit rate:8.8s/it remaining:2:10:37 elapsed:16:49 postfix:- (511844:tqdm_logging.py:145)
Step 113: grad_norm=7.327009677886963, loss=1.974092960357666, param_norm=1886.97314453125
Step 114: grad_norm=5.9851484298706055, loss=2.331730842590332, param_norm=1886.973388671875
10:04:17.089 [I] Progress on: 114it/1.00kit rate:8.8s/it remaining:2:10:10 elapsed:17:06 postfix:- (511844:tqdm_logging.py:145)
Step 115: grad_norm=10.346638679504395, loss=2.289646625518799, param_norm=1886.9737548828125
Step 116: grad_norm=8.76501750946045, loss=2.1278276443481445, param_norm=1886.97412109375
10:04:34.713 [I] Progress on: 116it/1.00kit rate:8.8s/it remaining:2:09:49 elapsed:17:24 postfix:- (511844:tqdm_logging.py:145)
Step 117: grad_norm=12.097888946533203, loss=2.0083022117614746, param_norm=1886.9744873046875
Step 118: grad_norm=5.9712018966674805, loss=2.301448345184326, param_norm=1886.974853515625
10:04:52.338 [I] Progress on: 118it/1.00kit rate:8.8s/it remaining:2:09:30 elapsed:17:41 postfix:- (511844:tqdm_logging.py:145)
Step 119: grad_norm=6.01664400100708, loss=2.2561018466949463, param_norm=1886.9752197265625
Step 120: grad_norm=8.666749954223633, loss=2.3480565547943115, param_norm=1886.9755859375
10:05:09.936 [I] Progress on: 120it/1.00kit rate:8.8s/it remaining:2:09:09 elapsed:17:59 postfix:- (511844:tqdm_logging.py:145)
Step 121: grad_norm=10.235313415527344, loss=2.398890733718872, param_norm=1886.97607421875
Step 122: grad_norm=6.008869171142578, loss=2.2198193073272705, param_norm=1886.9765625
10:05:27.546 [I] Progress on: 122it/1.00kit rate:8.8s/it remaining:2:08:49 elapsed:18:17 postfix:- (511844:tqdm_logging.py:145)
Step 123: grad_norm=19.066635131835938, loss=2.2705931663513184, param_norm=1886.9769287109375
Step 124: grad_norm=7.743252754211426, loss=2.0996439456939697, param_norm=1886.977294921875
10:05:45.166 [I] Progress on: 124it/1.00kit rate:8.8s/it remaining:2:08:33 elapsed:18:34 postfix:- (511844:tqdm_logging.py:145)
Step 125: grad_norm=11.063220024108887, loss=2.3213019371032715, param_norm=1886.977783203125
Step 126: grad_norm=8.687455177307129, loss=2.2180752754211426, param_norm=1886.97802734375
10:06:02.779 [I] Progress on: 126it/1.00kit rate:8.8s/it remaining:2:08:16 elapsed:18:52 postfix:- (511844:tqdm_logging.py:145)
Step 127: grad_norm=12.241096496582031, loss=2.2263474464416504, param_norm=1886.9783935546875
Step 128: grad_norm=7.23168420791626, loss=2.096931219100952, param_norm=1886.978759765625
10:06:20.401 [I] Progress on: 128it/1.00kit rate:8.8s/it remaining:2:07:59 elapsed:19:10 postfix:- (511844:tqdm_logging.py:145)
Step 129: grad_norm=8.747631072998047, loss=2.308419704437256, param_norm=1886.9791259765625
Step 130: grad_norm=5.2984795570373535, loss=2.087404727935791, param_norm=1886.9796142578125
10:06:38.021 [I] Progress on: 130it/1.00kit rate:8.8s/it remaining:2:07:43 elapsed:19:27 postfix:- (511844:tqdm_logging.py:145)
Step 131: grad_norm=13.181710243225098, loss=2.1923623085021973, param_norm=1886.97998046875
Step 132: grad_norm=10.056106567382812, loss=2.2680063247680664, param_norm=1886.980224609375
10:06:55.642 [I] Progress on: 132it/1.00kit rate:8.8s/it remaining:2:07:25 elapsed:19:45 postfix:- (511844:tqdm_logging.py:145)
Step 133: grad_norm=15.25468635559082, loss=2.235835075378418, param_norm=1886.9805908203125
Step 134: grad_norm=10.767669677734375, loss=2.063002586364746, param_norm=1886.98095703125
10:07:13.260 [I] Progress on: 134it/1.00kit rate:8.8s/it remaining:2:07:07 elapsed:20:02 postfix:- (511844:tqdm_logging.py:145)
Step 135: grad_norm=5.965076923370361, loss=2.279109477996826, param_norm=1886.981201171875
Step 136: grad_norm=11.16905689239502, loss=2.1728663444519043, param_norm=1886.9815673828125
10:07:30.880 [I] Progress on: 136it/1.00kit rate:8.8s/it remaining:2:06:50 elapsed:20:20 postfix:- (511844:tqdm_logging.py:145)
Step 137: grad_norm=8.648167610168457, loss=2.2764687538146973, param_norm=1886.9818115234375
Step 138: grad_norm=11.25009536743164, loss=2.2270727157592773, param_norm=1886.9822998046875
10:07:48.499 [I] Progress on: 138it/1.00kit rate:8.8s/it remaining:2:06:32 elapsed:20:38 postfix:- (511844:tqdm_logging.py:145)
Step 139: grad_norm=12.022262573242188, loss=2.161432981491089, param_norm=1886.982666015625
Step 140: grad_norm=5.731684684753418, loss=2.1783251762390137, param_norm=1886.9830322265625
10:08:06.124 [I] Progress on: 140it/1.00kit rate:8.8s/it remaining:2:06:16 elapsed:20:55 postfix:- (511844:tqdm_logging.py:145)
Step 141: grad_norm=4.508368968963623, loss=2.0848984718322754, param_norm=1886.9835205078125
Step 142: grad_norm=6.4262614250183105, loss=2.106638193130493, param_norm=1886.9840087890625
10:08:23.744 [I] Progress on: 142it/1.00kit rate:8.8s/it remaining:2:05:57 elapsed:21:13 postfix:- (511844:tqdm_logging.py:145)
Step 143: grad_norm=15.933959007263184, loss=2.203630208969116, param_norm=1886.9844970703125
Step 144: grad_norm=7.2738938331604, loss=2.111847400665283, param_norm=1886.98486328125
10:08:41.362 [I] Progress on: 144it/1.00kit rate:8.8s/it remaining:2:05:38 elapsed:21:30 postfix:- (511844:tqdm_logging.py:145)
Step 145: grad_norm=10.350717544555664, loss=1.9919650554656982, param_norm=1886.9852294921875
Step 146: grad_norm=5.545710563659668, loss=2.0772390365600586, param_norm=1886.985595703125
10:08:58.983 [I] Progress on: 146it/1.00kit rate:8.8s/it remaining:2:05:22 elapsed:21:48 postfix:- (511844:tqdm_logging.py:145)
Step 147: grad_norm=4.884159564971924, loss=2.262129306793213, param_norm=1886.9859619140625
Step 148: grad_norm=6.255053520202637, loss=1.9348934888839722, param_norm=1886.986328125
10:09:16.634 [I] Progress on: 148it/1.00kit rate:8.8s/it remaining:2:05:10 elapsed:22:06 postfix:- (511844:tqdm_logging.py:145)
Step 149: grad_norm=15.996790885925293, loss=2.074040412902832, param_norm=1886.9866943359375
Step 150: grad_norm=10.18454360961914, loss=2.2329258918762207, param_norm=1886.987060546875
10:09:34.269 [I] Progress on: 150it/1.00kit rate:8.8s/it remaining:2:04:54 elapsed:22:23 postfix:- (511844:tqdm_logging.py:145)
Step 151: grad_norm=10.775382041931152, loss=2.3231515884399414, param_norm=1886.9874267578125
Step 152: grad_norm=16.128501892089844, loss=1.96077561378479, param_norm=1886.98779296875
10:09:51.907 [I] Progress on: 152it/1.00kit rate:8.8s/it remaining:2:04:36 elapsed:22:41 postfix:- (511844:tqdm_logging.py:145)
Step 153: grad_norm=8.024819374084473, loss=1.9664192199707031, param_norm=1886.9881591796875
Step 154: grad_norm=20.532804489135742, loss=2.172029495239258, param_norm=1886.9886474609375
10:10:09.551 [I] Progress on: 154it/1.00kit rate:8.8s/it remaining:2:04:18 elapsed:22:59 postfix:- (511844:tqdm_logging.py:145)
Step 155: grad_norm=22.214893341064453, loss=2.2230172157287598, param_norm=1886.989013671875
Step 156: grad_norm=12.958282470703125, loss=2.234297752380371, param_norm=1886.9893798828125
10:10:27.186 [I] Progress on: 156it/1.00kit rate:8.8s/it remaining:2:04:01 elapsed:23:16 postfix:- (511844:tqdm_logging.py:145)
Step 157: grad_norm=10.777854919433594, loss=1.9755275249481201, param_norm=1886.9896240234375
Step 158: grad_norm=10.975701332092285, loss=2.333735466003418, param_norm=1886.9898681640625
10:10:44.832 [I] Progress on: 158it/1.00kit rate:8.8s/it remaining:2:03:44 elapsed:23:34 postfix:- (511844:tqdm_logging.py:145)
Step 159: grad_norm=8.714704513549805, loss=2.3687069416046143, param_norm=1886.990234375
Step 160: grad_norm=20.622631072998047, loss=2.2012834548950195, param_norm=1886.9906005859375
10:11:02.474 [I] Progress on: 160it/1.00kit rate:8.8s/it remaining:2:03:27 elapsed:23:52 postfix:- (511844:tqdm_logging.py:145)
Step 161: grad_norm=16.540542602539062, loss=2.235117197036743, param_norm=1886.99072265625
Step 162: grad_norm=20.013914108276367, loss=2.302109956741333, param_norm=1886.9910888671875
10:11:20.160 [I] Progress on: 162it/1.00kit rate:8.8s/it remaining:2:03:19 elapsed:24:09 postfix:- (511844:tqdm_logging.py:145)
Step 163: grad_norm=10.049664497375488, loss=2.0258736610412598, param_norm=1886.991455078125
Step 164: grad_norm=13.59967041015625, loss=2.1323275566101074, param_norm=1886.9918212890625
10:11:37.790 [I] Progress on: 164it/1.00kit rate:8.8s/it remaining:2:02:55 elapsed:24:27 postfix:- (511844:tqdm_logging.py:145)
Step 165: grad_norm=6.859129905700684, loss=2.444695472717285, param_norm=1886.9920654296875
Step 166: grad_norm=9.334070205688477, loss=2.1311185359954834, param_norm=1886.992431640625
10:11:55.420 [I] Progress on: 166it/1.00kit rate:8.8s/it remaining:2:02:36 elapsed:24:45 postfix:- (511844:tqdm_logging.py:145)
Step 167: grad_norm=17.393272399902344, loss=2.150672435760498, param_norm=1886.99267578125
10:12:06.725 [I] Progress on: 168it/1.00kit rate:9.5s/it remaining:2:11:55 elapsed:24:56 postfix:- (511844:tqdm_logging.py:145)
Step 168: grad_norm=19.729598999023438, loss=2.0498127937316895, param_norm=1886.9931640625
Step 169: grad_norm=22.922988891601562, loss=1.9175291061401367, param_norm=1886.9935302734375
10:12:24.179 [I] Progress on: 169it/1.00kit rate:9.3s/it remaining:2:08:51 elapsed:25:13 postfix:- (511844:tqdm_logging.py:145)
Step 170: grad_norm=5.479038238525391, loss=1.7572855949401855, param_norm=1886.9937744140625
Step 171: grad_norm=5.397643566131592, loss=2.0164899826049805, param_norm=1886.9942626953125
10:12:41.794 [I] Progress on: 171it/1.00kit rate:9.0s/it remaining:2:05:02 elapsed:25:31 postfix:- (511844:tqdm_logging.py:145)
Step 172: grad_norm=11.210933685302734, loss=2.0909509658813477, param_norm=1886.9945068359375
Step 173: grad_norm=5.328157901763916, loss=1.960796594619751, param_norm=1886.9949951171875
10:12:59.426 [I] Progress on: 173it/1.00kit rate:8.9s/it remaining:2:03:04 elapsed:25:49 postfix:- (511844:tqdm_logging.py:145)
Step 174: grad_norm=15.878992080688477, loss=1.9138514995574951, param_norm=1886.9952392578125
Step 175: grad_norm=7.992599964141846, loss=1.8969173431396484, param_norm=1886.9957275390625
10:13:17.053 [I] Progress on: 175it/1.00kit rate:8.9s/it remaining:2:02:00 elapsed:26:06 postfix:- (511844:tqdm_logging.py:145)
Step 176: grad_norm=19.302143096923828, loss=2.0157155990600586, param_norm=1886.99609375
Step 177: grad_norm=5.957432270050049, loss=1.911935567855835, param_norm=1886.99658203125
10:13:34.929 [I] Progress on: 177it/1.00kit rate:8.9s/it remaining:2:02:00 elapsed:26:24 postfix:- (511844:tqdm_logging.py:145)
Step 178: grad_norm=7.822851181030273, loss=1.926794409751892, param_norm=1886.9970703125
Step 179: grad_norm=14.809476852416992, loss=1.7354240417480469, param_norm=1886.99755859375
10:13:52.574 [I] Progress on: 179it/1.00kit rate:8.9s/it remaining:2:01:13 elapsed:26:42 postfix:- (511844:tqdm_logging.py:145)
Step 180: grad_norm=11.475942611694336, loss=1.8022407293319702, param_norm=1886.998046875
Step 181: grad_norm=6.021161079406738, loss=1.805877447128296, param_norm=1886.9984130859375
10:14:10.217 [I] Progress on: 181it/1.00kit rate:8.8s/it remaining:2:00:40 elapsed:26:59 postfix:- (511844:tqdm_logging.py:145)
Step 182: grad_norm=6.408236026763916, loss=1.796220302581787, param_norm=1886.9989013671875
Step 183: grad_norm=5.882692337036133, loss=1.9353854656219482, param_norm=1886.9993896484375
10:14:27.846 [I] Progress on: 183it/1.00kit rate:8.8s/it remaining:2:00:13 elapsed:27:17 postfix:- (511844:tqdm_logging.py:145)
Step 184: grad_norm=6.002502918243408, loss=1.8611279726028442, param_norm=1886.999755859375
Step 185: grad_norm=6.031153678894043, loss=1.8047115802764893, param_norm=1887.000244140625
10:14:45.473 [I] Progress on: 185it/1.00kit rate:8.8s/it remaining:1:59:49 elapsed:27:35 postfix:- (511844:tqdm_logging.py:145)
Step 186: grad_norm=13.770842552185059, loss=1.6943323612213135, param_norm=1887.000732421875
Step 187: grad_norm=10.26728343963623, loss=1.7876994609832764, param_norm=1887.0010986328125
10:15:03.109 [I] Progress on: 187it/1.00kit rate:8.8s/it remaining:1:59:30 elapsed:27:52 postfix:- (511844:tqdm_logging.py:145)
Step 188: grad_norm=8.2177734375, loss=1.499216079711914, param_norm=1887.0015869140625
Step 189: grad_norm=6.929776668548584, loss=1.9621831178665161, param_norm=1887.001953125
10:15:20.746 [I] Progress on: 189it/1.00kit rate:8.8s/it remaining:1:59:10 elapsed:28:10 postfix:- (511844:tqdm_logging.py:145)
Step 190: grad_norm=6.005884170532227, loss=1.9489346742630005, param_norm=1887.0023193359375
Step 191: grad_norm=21.61825942993164, loss=2.0422019958496094, param_norm=1887.0028076171875
10:15:38.454 [I] Progress on: 191it/1.00kit rate:8.8s/it remaining:1:59:03 elapsed:28:28 postfix:- (511844:tqdm_logging.py:145)
Step 192: grad_norm=14.368786811828613, loss=1.8688418865203857, param_norm=1887.003173828125
Step 193: grad_norm=7.2026777267456055, loss=1.8829004764556885, param_norm=1887.003662109375
10:15:56.141 [I] Progress on: 193it/1.00kit rate:8.8s/it remaining:1:58:58 elapsed:28:45 postfix:- (511844:tqdm_logging.py:145)
Step 194: grad_norm=36.586185455322266, loss=1.8920080661773682, param_norm=1887.004150390625
Step 195: grad_norm=7.494757175445557, loss=1.795544147491455, param_norm=1887.0045166015625
10:16:13.727 [I] Progress on: 195it/1.00kit rate:8.8s/it remaining:1:58:27 elapsed:29:03 postfix:- (511844:tqdm_logging.py:145)
Step 196: grad_norm=7.975977420806885, loss=2.0228610038757324, param_norm=1887.0048828125
Step 197: grad_norm=10.603249549865723, loss=1.9339478015899658, param_norm=1887.00537109375
10:16:31.221 [I] Progress on: 197it/1.00kit rate:8.8s/it remaining:1:57:45 elapsed:29:20 postfix:- (511844:tqdm_logging.py:145)
Step 198: grad_norm=6.054927825927734, loss=1.8082284927368164, param_norm=1887.005859375
Step 199: grad_norm=6.284762859344482, loss=1.803441047668457, param_norm=1887.0062255859375
10:16:48.671 [I] Progress on: 199it/1.00kit rate:8.8s/it remaining:1:57:00 elapsed:29:38 postfix:- (511844:tqdm_logging.py:145)
Step 200: grad_norm=9.445760726928711, loss=1.756829023361206, param_norm=1887.006591796875
10:16:57.565 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
10:16:57.565 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
10:16:57.566 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (511844:checkpoint_manager.py:1786)
10:16:57.566 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (511844:checkpoint_manager.py:1817)
10:16:57.566 [I] [process=0] Saving checkpoint at step 200                                        (511844:checkpoint_manager.py:1286)
10:16:57.567 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200. (511844:async_checkpointer.py:358)
10:16:57.568 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:16:57.568 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3 (511844:atomicity.py:144)
10:16:57.569 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:16:57.569 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:16:57.571 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (511844:atomicity.py:144)
10:16:57.571 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (511844:atomicity.py:144)
10:16:57.572 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:16:57.576 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
10:17:01.477 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:17:01.489 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
10:17:01.490 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
10:17:01.492 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
10:17:01.493 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
10:17:01.498 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
10:17:01.500 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
10:17:01.508 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
10:17:01.521 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744121817.5656486, 'wait_for_prev_duration_secs': 0.0006520748138427734, 'checkpointer_blocking_start_time': 1744121817.566871, 'checkpointer_blocking_duration_secs': 3.9267024993896484, 'get_old_steps_start_time': 1744121821.493637, 'get_old_steps_duration_secs': 0.004477024078369141, 'checkpoint_manager_blocking_start_time': 1744121817.5654914, 'checkpoint_manager_blocking_duration_secs': 3.955658435821533} (511844:standard_logger.py:34)
10:17:01.524 [I] Progress on: 201it/1.00kit rate:9.9s/it remaining:2:12:17 elapsed:29:51 postfix:- (511844:tqdm_logging.py:145)
10:17:09.235 [I] ChainedFuture completed 1/1 futures in 7.74 seconds.                             (511844:future.py:137)
10:17:09.237 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 888.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:17:09.237 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
10:17:09.239 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3 (511844:async_checkpointer.py:406)
10:17:09.239 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3/assets (511844:atomicity.py:287)
10:17:09.250 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3/params (511844:atomicity.py:287)
10:17:09.251 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200 (511844:async_checkpointer.py:416)
10:17:09.251 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3 (511844:async_checkpointer.py:426)
10:17:09.251 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200 (511844:atomicity.py:287)
10:17:09.253 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/200`. (511844:atomicity.py:548)
10:17:09.253 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
10:17:09.254 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
10:17:09.254 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
10:17:09.255 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
10:17:09.255 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 201: grad_norm=7.587551593780518, loss=1.698022484779358, param_norm=1887.0069580078125
Step 202: grad_norm=10.236042976379395, loss=1.8588659763336182, param_norm=1887.0074462890625
10:17:18.766 [I] Progress on: 202it/1.00kit rate:9.6s/it remaining:2:07:12 elapsed:30:08 postfix:- (511844:tqdm_logging.py:145)
Step 203: grad_norm=6.8180766105651855, loss=2.0199546813964844, param_norm=1887.0078125
Step 204: grad_norm=8.066161155700684, loss=1.9071424007415771, param_norm=1887.00830078125
10:17:36.120 [I] Progress on: 204it/1.00kit rate:9.1s/it remaining:2:00:53 elapsed:30:25 postfix:- (511844:tqdm_logging.py:145)
Step 205: grad_norm=9.980483055114746, loss=1.9043389558792114, param_norm=1887.0087890625
Step 206: grad_norm=13.290671348571777, loss=2.0378637313842773, param_norm=1887.0091552734375
10:17:53.528 [I] Progress on: 206it/1.00kit rate:8.9s/it remaining:1:57:48 elapsed:30:43 postfix:- (511844:tqdm_logging.py:145)
Step 207: grad_norm=7.608328819274902, loss=1.8923301696777344, param_norm=1887.009521484375
Step 208: grad_norm=7.347642421722412, loss=1.749513864517212, param_norm=1887.010009765625
10:18:10.962 [I] Progress on: 208it/1.00kit rate:8.8s/it remaining:1:56:12 elapsed:31:00 postfix:- (511844:tqdm_logging.py:145)
Step 209: grad_norm=10.125285148620605, loss=1.6303353309631348, param_norm=1887.0103759765625
Step 210: grad_norm=8.348410606384277, loss=1.964280605316162, param_norm=1887.0107421875
10:18:28.395 [I] Progress on: 210it/1.00kit rate:8.8s/it remaining:1:55:20 elapsed:31:18 postfix:- (511844:tqdm_logging.py:145)
Step 211: grad_norm=14.190176010131836, loss=1.6871085166931152, param_norm=1887.01123046875
Step 212: grad_norm=19.01593017578125, loss=1.5418813228607178, param_norm=1887.011474609375
10:18:45.826 [I] Progress on: 212it/1.00kit rate:8.7s/it remaining:1:54:43 elapsed:31:35 postfix:- (511844:tqdm_logging.py:145)
Step 213: grad_norm=28.050403594970703, loss=1.5499907732009888, param_norm=1887.0118408203125
Step 214: grad_norm=9.48150634765625, loss=2.0000393390655518, param_norm=1887.01220703125
10:19:03.272 [I] Progress on: 214it/1.00kit rate:8.7s/it remaining:1:54:18 elapsed:31:52 postfix:- (511844:tqdm_logging.py:145)
Step 215: grad_norm=11.894482612609863, loss=1.8808550834655762, param_norm=1887.0125732421875
Step 216: grad_norm=9.851299285888672, loss=1.8009270429611206, param_norm=1887.0128173828125
10:19:20.736 [I] Progress on: 216it/1.00kit rate:8.7s/it remaining:1:54:01 elapsed:32:10 postfix:- (511844:tqdm_logging.py:145)
Step 217: grad_norm=8.590270042419434, loss=1.7624151706695557, param_norm=1887.01318359375
Step 218: grad_norm=6.187878131866455, loss=1.866860032081604, param_norm=1887.0135498046875
10:19:38.206 [I] Progress on: 218it/1.00kit rate:8.7s/it remaining:1:53:45 elapsed:32:27 postfix:- (511844:tqdm_logging.py:145)
Step 219: grad_norm=5.093018054962158, loss=1.8008813858032227, param_norm=1887.013916015625
Step 220: grad_norm=6.876134395599365, loss=2.123021125793457, param_norm=1887.014404296875
10:19:55.677 [I] Progress on: 220it/1.00kit rate:8.7s/it remaining:1:53:29 elapsed:32:45 postfix:- (511844:tqdm_logging.py:145)
Step 221: grad_norm=9.39208698272705, loss=1.7995294332504272, param_norm=1887.014892578125
Step 222: grad_norm=5.720675468444824, loss=1.7865818738937378, param_norm=1887.0152587890625
10:20:13.163 [I] Progress on: 222it/1.00kit rate:8.7s/it remaining:1:53:15 elapsed:33:02 postfix:- (511844:tqdm_logging.py:145)
Step 223: grad_norm=8.973485946655273, loss=1.895815134048462, param_norm=1887.0155029296875
Step 224: grad_norm=5.802723407745361, loss=1.7425673007965088, param_norm=1887.015869140625
10:20:30.657 [I] Progress on: 224it/1.00kit rate:8.7s/it remaining:1:53:00 elapsed:33:20 postfix:- (511844:tqdm_logging.py:145)
Step 225: grad_norm=14.938560485839844, loss=1.7334332466125488, param_norm=1887.0162353515625
Step 226: grad_norm=5.579400539398193, loss=1.7659988403320312, param_norm=1887.0166015625
10:20:48.151 [I] Progress on: 226it/1.00kit rate:8.7s/it remaining:1:52:46 elapsed:33:37 postfix:- (511844:tqdm_logging.py:145)
Step 227: grad_norm=12.994355201721191, loss=2.030299663543701, param_norm=1887.0169677734375
Step 228: grad_norm=9.895803451538086, loss=1.9524532556533813, param_norm=1887.017333984375
10:21:05.629 [I] Progress on: 228it/1.00kit rate:8.7s/it remaining:1:52:29 elapsed:33:55 postfix:- (511844:tqdm_logging.py:145)
Step 229: grad_norm=6.54821252822876, loss=1.6466314792633057, param_norm=1887.017578125
Step 230: grad_norm=8.762386322021484, loss=1.735794186592102, param_norm=1887.0179443359375
10:21:23.107 [I] Progress on: 230it/1.00kit rate:8.7s/it remaining:1:52:08 elapsed:34:12 postfix:- (511844:tqdm_logging.py:145)
Step 231: grad_norm=6.476984024047852, loss=1.9438989162445068, param_norm=1887.0184326171875
Step 232: grad_norm=10.644978523254395, loss=1.999194622039795, param_norm=1887.0186767578125
10:21:40.580 [I] Progress on: 232it/1.00kit rate:8.7s/it remaining:1:51:50 elapsed:34:30 postfix:- (511844:tqdm_logging.py:145)
Step 233: grad_norm=14.179328918457031, loss=1.8114856481552124, param_norm=1887.01904296875
Step 234: grad_norm=5.966268062591553, loss=1.9265166521072388, param_norm=1887.019287109375
10:21:58.060 [I] Progress on: 234it/1.00kit rate:8.7s/it remaining:1:51:32 elapsed:34:47 postfix:- (511844:tqdm_logging.py:145)
Step 235: grad_norm=9.430816650390625, loss=1.7755703926086426, param_norm=1887.0196533203125
Step 236: grad_norm=9.194260597229004, loss=1.7328872680664062, param_norm=1887.0198974609375
10:22:15.541 [I] Progress on: 236it/1.00kit rate:8.7s/it remaining:1:51:15 elapsed:35:05 postfix:- (511844:tqdm_logging.py:145)
Step 237: grad_norm=21.64306640625, loss=1.8183200359344482, param_norm=1887.0201416015625
Step 238: grad_norm=12.699263572692871, loss=1.8932902812957764, param_norm=1887.0205078125
10:22:33.020 [I] Progress on: 238it/1.00kit rate:8.7s/it remaining:1:50:58 elapsed:35:22 postfix:- (511844:tqdm_logging.py:145)
Step 239: grad_norm=12.465746879577637, loss=1.8732683658599854, param_norm=1887.0206298828125
Step 240: grad_norm=5.624885559082031, loss=2.041663646697998, param_norm=1887.0211181640625
10:22:50.494 [I] Progress on: 240it/1.00kit rate:8.7s/it remaining:1:50:38 elapsed:35:40 postfix:- (511844:tqdm_logging.py:145)
Step 241: grad_norm=8.873125076293945, loss=1.7666022777557373, param_norm=1887.021484375
Step 242: grad_norm=7.413690567016602, loss=1.7519230842590332, param_norm=1887.0216064453125
10:23:07.971 [I] Progress on: 242it/1.00kit rate:8.7s/it remaining:1:50:23 elapsed:35:57 postfix:- (511844:tqdm_logging.py:145)
Step 243: grad_norm=10.882548332214355, loss=1.9631249904632568, param_norm=1887.02197265625
Step 244: grad_norm=5.928594589233398, loss=1.8558225631713867, param_norm=1887.0223388671875
10:23:25.434 [I] Progress on: 244it/1.00kit rate:8.7s/it remaining:1:50:02 elapsed:36:15 postfix:- (511844:tqdm_logging.py:145)
Step 245: grad_norm=9.8809175491333, loss=1.8258203268051147, param_norm=1887.022705078125
Step 246: grad_norm=6.448206901550293, loss=1.8263700008392334, param_norm=1887.0230712890625
10:23:42.904 [I] Progress on: 246it/1.00kit rate:8.7s/it remaining:1:49:43 elapsed:36:32 postfix:- (511844:tqdm_logging.py:145)
Step 247: grad_norm=5.4596052169799805, loss=1.597316861152649, param_norm=1887.0234375
Step 248: grad_norm=7.9474029541015625, loss=1.9548078775405884, param_norm=1887.0238037109375
10:24:00.372 [I] Progress on: 248it/1.00kit rate:8.7s/it remaining:1:49:27 elapsed:36:49 postfix:- (511844:tqdm_logging.py:145)
Step 249: grad_norm=5.3656206130981445, loss=1.7318027019500732, param_norm=1887.0240478515625
Step 250: grad_norm=7.665634632110596, loss=1.6356319189071655, param_norm=1887.0245361328125
10:24:17.841 [I] Progress on: 250it/1.00kit rate:8.7s/it remaining:1:49:10 elapsed:37:07 postfix:- (511844:tqdm_logging.py:145)
Step 251: grad_norm=6.732546329498291, loss=1.8275539875030518, param_norm=1887.0247802734375
10:24:28.718 [I] Progress on: 252it/1.00kit rate:9.3s/it remaining:1:56:14 elapsed:37:18 postfix:- (511844:tqdm_logging.py:145)
Step 252: grad_norm=7.559754848480225, loss=1.512063980102539, param_norm=1887.025146484375
Step 253: grad_norm=12.239176750183105, loss=1.5405032634735107, param_norm=1887.0255126953125
10:24:46.061 [I] Progress on: 253it/1.00kit rate:9.2s/it remaining:1:54:01 elapsed:37:35 postfix:- (511844:tqdm_logging.py:145)
Step 254: grad_norm=8.690052032470703, loss=1.715839147567749, param_norm=1887.02587890625
Step 255: grad_norm=9.584854125976562, loss=1.5730762481689453, param_norm=1887.0262451171875
10:25:03.624 [I] Progress on: 255it/1.00kit rate:9.0s/it remaining:1:51:18 elapsed:37:53 postfix:- (511844:tqdm_logging.py:145)
Step 256: grad_norm=10.800638198852539, loss=1.585927128791809, param_norm=1887.026611328125
Step 257: grad_norm=13.634455680847168, loss=1.7065625190734863, param_norm=1887.0269775390625
10:25:21.159 [I] Progress on: 257it/1.00kit rate:8.9s/it remaining:1:49:47 elapsed:38:10 postfix:- (511844:tqdm_logging.py:145)
Step 258: grad_norm=6.018385410308838, loss=1.672544002532959, param_norm=1887.0274658203125
Step 259: grad_norm=5.5474677085876465, loss=1.554915428161621, param_norm=1887.02783203125
10:25:38.764 [I] Progress on: 259it/1.00kit rate:8.8s/it remaining:1:49:10 elapsed:38:28 postfix:- (511844:tqdm_logging.py:145)
Step 260: grad_norm=9.997612953186035, loss=1.520463466644287, param_norm=1887.0281982421875
Step 261: grad_norm=12.997076988220215, loss=1.4756426811218262, param_norm=1887.0284423828125
10:25:56.276 [I] Progress on: 261it/1.00kit rate:8.8s/it remaining:1:48:23 elapsed:38:45 postfix:- (511844:tqdm_logging.py:145)
Step 262: grad_norm=14.990477561950684, loss=1.505250334739685, param_norm=1887.0289306640625
Step 263: grad_norm=7.052345275878906, loss=1.5906553268432617, param_norm=1887.029296875
10:26:13.815 [I] Progress on: 263it/1.00kit rate:8.8s/it remaining:1:47:51 elapsed:39:03 postfix:- (511844:tqdm_logging.py:145)
Step 264: grad_norm=10.408618927001953, loss=1.7028782367706299, param_norm=1887.0296630859375
Step 265: grad_norm=6.28111457824707, loss=1.637816309928894, param_norm=1887.030029296875
10:26:31.325 [I] Progress on: 265it/1.00kit rate:8.8s/it remaining:1:47:27 elapsed:39:20 postfix:- (511844:tqdm_logging.py:145)
Step 266: grad_norm=11.004953384399414, loss=1.5714688301086426, param_norm=1887.0302734375
Step 267: grad_norm=9.354161262512207, loss=1.4335603713989258, param_norm=1887.0306396484375
10:26:48.911 [I] Progress on: 267it/1.00kit rate:8.8s/it remaining:1:47:20 elapsed:39:38 postfix:- (511844:tqdm_logging.py:145)
Step 268: grad_norm=11.610933303833008, loss=1.7037642002105713, param_norm=1887.0311279296875
Step 269: grad_norm=10.146928787231445, loss=1.7456520795822144, param_norm=1887.0313720703125
10:27:06.463 [I] Progress on: 269it/1.00kit rate:8.8s/it remaining:1:46:59 elapsed:39:56 postfix:- (511844:tqdm_logging.py:145)
Step 270: grad_norm=9.698262214660645, loss=1.6835174560546875, param_norm=1887.03173828125
Step 271: grad_norm=6.200405597686768, loss=1.379814624786377, param_norm=1887.0321044921875
10:27:23.990 [I] Progress on: 271it/1.00kit rate:8.8s/it remaining:1:46:37 elapsed:40:13 postfix:- (511844:tqdm_logging.py:145)
Step 272: grad_norm=6.94094181060791, loss=1.4670488834381104, param_norm=1887.0323486328125
Step 273: grad_norm=12.66907787322998, loss=1.6465022563934326, param_norm=1887.0328369140625
10:27:41.493 [I] Progress on: 273it/1.00kit rate:8.8s/it remaining:1:46:11 elapsed:40:31 postfix:- (511844:tqdm_logging.py:145)
Step 274: grad_norm=26.82364845275879, loss=1.4726262092590332, param_norm=1887.0330810546875
Step 275: grad_norm=13.825648307800293, loss=1.3590176105499268, param_norm=1887.033447265625
10:27:59.014 [I] Progress on: 275it/1.00kit rate:8.8s/it remaining:1:45:52 elapsed:40:48 postfix:- (511844:tqdm_logging.py:145)
Step 276: grad_norm=9.103870391845703, loss=1.5740187168121338, param_norm=1887.0338134765625
Step 277: grad_norm=8.026773452758789, loss=1.4920310974121094, param_norm=1887.0341796875
10:28:16.522 [I] Progress on: 277it/1.00kit rate:8.8s/it remaining:1:45:33 elapsed:41:06 postfix:- (511844:tqdm_logging.py:145)
Step 278: grad_norm=12.399652481079102, loss=1.7614611387252808, param_norm=1887.0345458984375
Step 279: grad_norm=9.479349136352539, loss=1.5624700784683228, param_norm=1887.034912109375
10:28:34.041 [I] Progress on: 279it/1.00kit rate:8.8s/it remaining:1:45:15 elapsed:41:23 postfix:- (511844:tqdm_logging.py:145)
Step 280: grad_norm=11.253859519958496, loss=1.6182173490524292, param_norm=1887.0352783203125
Step 281: grad_norm=10.029499053955078, loss=1.634785771369934, param_norm=1887.0355224609375
10:28:51.581 [I] Progress on: 281it/1.00kit rate:8.8s/it remaining:1:45:03 elapsed:41:41 postfix:- (511844:tqdm_logging.py:145)
Step 282: grad_norm=7.050196170806885, loss=1.587460994720459, param_norm=1887.035888671875
Step 283: grad_norm=5.48424768447876, loss=1.6758880615234375, param_norm=1887.0360107421875
10:29:09.110 [I] Progress on: 283it/1.00kit rate:8.8s/it remaining:1:44:46 elapsed:41:58 postfix:- (511844:tqdm_logging.py:145)
Step 284: grad_norm=5.011346340179443, loss=1.583134412765503, param_norm=1887.036376953125
Step 285: grad_norm=19.291290283203125, loss=1.5243895053863525, param_norm=1887.0367431640625
10:29:26.617 [I] Progress on: 285it/1.00kit rate:8.8s/it remaining:1:44:23 elapsed:42:16 postfix:- (511844:tqdm_logging.py:145)
Step 286: grad_norm=16.305011749267578, loss=1.4484453201293945, param_norm=1887.037109375
Step 287: grad_norm=9.970952987670898, loss=1.5852771997451782, param_norm=1887.0374755859375
10:29:44.114 [I] Progress on: 287it/1.00kit rate:8.8s/it remaining:1:44:04 elapsed:42:33 postfix:- (511844:tqdm_logging.py:145)
Step 288: grad_norm=14.936705589294434, loss=1.6619951725006104, param_norm=1887.037841796875
Step 289: grad_norm=9.568228721618652, loss=1.6547412872314453, param_norm=1887.038330078125
10:30:01.599 [I] Progress on: 289it/1.00kit rate:8.7s/it remaining:1:43:41 elapsed:42:51 postfix:- (511844:tqdm_logging.py:145)
Step 290: grad_norm=12.22297477722168, loss=1.4437360763549805, param_norm=1887.0386962890625
Step 291: grad_norm=13.087843894958496, loss=1.4597786664962769, param_norm=1887.0390625
10:30:19.089 [I] Progress on: 291it/1.00kit rate:8.8s/it remaining:1:43:24 elapsed:43:08 postfix:- (511844:tqdm_logging.py:145)
Step 292: grad_norm=15.071182250976562, loss=1.5580339431762695, param_norm=1887.0394287109375
Step 293: grad_norm=22.37578010559082, loss=1.5680038928985596, param_norm=1887.039794921875
10:30:36.579 [I] Progress on: 293it/1.00kit rate:8.7s/it remaining:1:43:04 elapsed:43:26 postfix:- (511844:tqdm_logging.py:145)
Step 294: grad_norm=9.595274925231934, loss=1.5108349323272705, param_norm=1887.0400390625
Step 295: grad_norm=6.733915328979492, loss=1.5461673736572266, param_norm=1887.0401611328125
10:30:54.070 [I] Progress on: 295it/1.00kit rate:8.7s/it remaining:1:42:47 elapsed:43:43 postfix:- (511844:tqdm_logging.py:145)
Step 296: grad_norm=6.477689743041992, loss=1.6848686933517456, param_norm=1887.04052734375
Step 297: grad_norm=5.571616172790527, loss=1.4238495826721191, param_norm=1887.040771484375
10:31:11.536 [I] Progress on: 297it/1.00kit rate:8.7s/it remaining:1:42:26 elapsed:44:01 postfix:- (511844:tqdm_logging.py:145)
Step 298: grad_norm=9.210712432861328, loss=1.4822187423706055, param_norm=1887.041015625
Step 299: grad_norm=8.81230640411377, loss=1.5974979400634766, param_norm=1887.041259765625
10:31:29.040 [I] Progress on: 299it/1.00kit rate:8.7s/it remaining:1:42:12 elapsed:44:18 postfix:- (511844:tqdm_logging.py:145)
Step 300: grad_norm=11.611540794372559, loss=1.4265029430389404, param_norm=1887.0416259765625
10:31:37.955 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
10:31:37.955 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
10:31:37.955 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (511844:checkpoint_manager.py:1786)
10:31:37.956 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (511844:checkpoint_manager.py:1817)
10:31:37.956 [I] [process=0] Saving checkpoint at step 300                                        (511844:checkpoint_manager.py:1286)
10:31:37.957 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300. (511844:async_checkpointer.py:358)
10:31:37.958 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:31:37.958 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6 (511844:atomicity.py:144)
10:31:37.959 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:31:37.959 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:31:37.960 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (511844:atomicity.py:144)
10:31:37.961 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (511844:atomicity.py:144)
10:31:37.961 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:31:37.966 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
10:31:41.891 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
10:31:41.892 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:31:41.894 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
10:31:41.898 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
10:31:41.922 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
10:31:41.926 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
10:31:41.930 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
10:31:41.930 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
10:31:41.934 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
10:31:41.936 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744122697.955497, 'wait_for_prev_duration_secs': 0.0006411075592041016, 'checkpointer_blocking_start_time': 1744122697.9567294, 'checkpointer_blocking_duration_secs': 3.9654695987701416, 'get_old_steps_start_time': 1744122701.9223547, 'get_old_steps_duration_secs': 0.008140087127685547, 'checkpoint_manager_blocking_start_time': 1744122697.955329, 'checkpoint_manager_blocking_duration_secs': 3.980820894241333} (511844:standard_logger.py:34)
10:31:41.940 [I] Progress on: 301it/1.00kit rate:9.9s/it remaining:1:55:50 elapsed:44:31 postfix:- (511844:tqdm_logging.py:145)
10:31:49.553 [I] ChainedFuture completed 1/1 futures in 7.64 seconds.                             (511844:future.py:137)
10:31:49.553 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 893.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:31:49.554 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
10:31:49.555 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6 (511844:async_checkpointer.py:406)
10:31:49.556 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6/assets (511844:atomicity.py:287)
10:31:49.567 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6/params (511844:atomicity.py:287)
10:31:49.567 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300 (511844:async_checkpointer.py:416)
10:31:49.568 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6 (511844:async_checkpointer.py:426)
10:31:49.568 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300 (511844:atomicity.py:287)
10:31:49.569 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/300`. (511844:atomicity.py:548)
10:31:49.569 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
10:31:49.570 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
10:31:49.570 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
10:31:49.571 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
10:31:49.571 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 301: grad_norm=11.262784004211426, loss=1.5731102228164673, param_norm=1887.0418701171875
Step 302: grad_norm=9.633450508117676, loss=1.5822712182998657, param_norm=1887.0421142578125
10:31:59.221 [I] Progress on: 302it/1.00kit rate:9.6s/it remaining:1:51:22 elapsed:44:48 postfix:- (511844:tqdm_logging.py:145)
Step 303: grad_norm=8.44749927520752, loss=1.4247820377349854, param_norm=1887.04248046875
Step 304: grad_norm=5.720586776733398, loss=1.5426089763641357, param_norm=1887.0426025390625
10:32:16.714 [I] Progress on: 304it/1.00kit rate:9.1s/it remaining:1:46:07 elapsed:45:06 postfix:- (511844:tqdm_logging.py:145)
Step 305: grad_norm=12.275970458984375, loss=1.5040929317474365, param_norm=1887.0430908203125
Step 306: grad_norm=6.804083347320557, loss=1.659938097000122, param_norm=1887.0433349609375
10:32:34.215 [I] Progress on: 306it/1.00kit rate:8.9s/it remaining:1:43:24 elapsed:45:23 postfix:- (511844:tqdm_logging.py:145)
Step 307: grad_norm=10.582717895507812, loss=1.4208991527557373, param_norm=1887.043701171875
Step 308: grad_norm=18.312049865722656, loss=1.6877866983413696, param_norm=1887.0439453125
10:32:51.755 [I] Progress on: 308it/1.00kit rate:8.9s/it remaining:1:42:09 elapsed:45:41 postfix:- (511844:tqdm_logging.py:145)
Step 309: grad_norm=19.99036407470703, loss=1.3058156967163086, param_norm=1887.04443359375
Step 310: grad_norm=5.8357110023498535, loss=1.5531044006347656, param_norm=1887.044677734375
10:33:09.229 [I] Progress on: 310it/1.00kit rate:8.8s/it remaining:1:41:07 elapsed:45:58 postfix:- (511844:tqdm_logging.py:145)
Step 311: grad_norm=12.244659423828125, loss=1.466599464416504, param_norm=1887.044921875
Step 312: grad_norm=6.68192720413208, loss=1.442425012588501, param_norm=1887.0452880859375
10:33:26.706 [I] Progress on: 312it/1.00kit rate:8.8s/it remaining:1:40:31 elapsed:46:16 postfix:- (511844:tqdm_logging.py:145)
Step 313: grad_norm=6.603934288024902, loss=1.5758235454559326, param_norm=1887.0455322265625
Step 314: grad_norm=16.143341064453125, loss=1.4931548833847046, param_norm=1887.0457763671875
10:33:44.190 [I] Progress on: 314it/1.00kit rate:8.8s/it remaining:1:40:03 elapsed:46:33 postfix:- (511844:tqdm_logging.py:145)
Step 315: grad_norm=8.278145790100098, loss=1.550874948501587, param_norm=1887.046142578125
Step 316: grad_norm=10.35663890838623, loss=1.3850606679916382, param_norm=1887.04638671875
10:34:01.684 [I] Progress on: 316it/1.00kit rate:8.7s/it remaining:1:39:44 elapsed:46:51 postfix:- (511844:tqdm_logging.py:145)
Step 317: grad_norm=8.518608093261719, loss=1.4591822624206543, param_norm=1887.0467529296875
Step 318: grad_norm=7.201295375823975, loss=1.5443730354309082, param_norm=1887.047119140625
10:34:19.169 [I] Progress on: 318it/1.00kit rate:8.7s/it remaining:1:39:24 elapsed:47:08 postfix:- (511844:tqdm_logging.py:145)
Step 319: grad_norm=11.297243118286133, loss=1.3217650651931763, param_norm=1887.04736328125
Step 320: grad_norm=12.99336051940918, loss=1.5687934160232544, param_norm=1887.0477294921875
10:34:36.655 [I] Progress on: 320it/1.00kit rate:8.7s/it remaining:1:39:04 elapsed:47:26 postfix:- (511844:tqdm_logging.py:145)
Step 321: grad_norm=6.745067119598389, loss=1.4875226020812988, param_norm=1887.0479736328125
Step 322: grad_norm=12.773045539855957, loss=1.504954218864441, param_norm=1887.04833984375
10:34:54.141 [I] Progress on: 322it/1.00kit rate:8.7s/it remaining:1:38:47 elapsed:47:43 postfix:- (511844:tqdm_logging.py:145)
Step 323: grad_norm=6.6362433433532715, loss=1.6004058122634888, param_norm=1887.048583984375
Step 324: grad_norm=8.035582542419434, loss=1.4165701866149902, param_norm=1887.048828125
10:35:11.635 [I] Progress on: 324it/1.00kit rate:8.7s/it remaining:1:38:29 elapsed:48:01 postfix:- (511844:tqdm_logging.py:145)
Step 325: grad_norm=8.867400169372559, loss=1.4070340394973755, param_norm=1887.0491943359375
Step 326: grad_norm=6.23635196685791, loss=1.5288469791412354, param_norm=1887.0494384765625
10:35:29.132 [I] Progress on: 326it/1.00kit rate:8.7s/it remaining:1:38:13 elapsed:48:18 postfix:- (511844:tqdm_logging.py:145)
Step 327: grad_norm=10.765508651733398, loss=1.5188522338867188, param_norm=1887.0496826171875
Step 328: grad_norm=9.886605262756348, loss=1.603502869606018, param_norm=1887.050048828125
10:35:46.630 [I] Progress on: 328it/1.00kit rate:8.7s/it remaining:1:37:57 elapsed:48:36 postfix:- (511844:tqdm_logging.py:145)
Step 329: grad_norm=31.875526428222656, loss=1.4287214279174805, param_norm=1887.05029296875
Step 330: grad_norm=6.3747711181640625, loss=1.5855071544647217, param_norm=1887.05078125
10:36:04.118 [I] Progress on: 330it/1.00kit rate:8.7s/it remaining:1:37:39 elapsed:48:53 postfix:- (511844:tqdm_logging.py:145)
Step 331: grad_norm=19.470808029174805, loss=1.4652645587921143, param_norm=1887.051025390625
Step 332: grad_norm=6.51765251159668, loss=1.5736236572265625, param_norm=1887.0513916015625
10:36:21.617 [I] Progress on: 332it/1.00kit rate:8.7s/it remaining:1:37:20 elapsed:49:11 postfix:- (511844:tqdm_logging.py:145)
Step 333: grad_norm=5.773037910461426, loss=1.623252034187317, param_norm=1887.0517578125
Step 334: grad_norm=7.579498291015625, loss=1.481658697128296, param_norm=1887.0518798828125
10:36:39.110 [I] Progress on: 334it/1.00kit rate:8.7s/it remaining:1:37:04 elapsed:49:28 postfix:- (511844:tqdm_logging.py:145)
Step 335: grad_norm=7.106036186218262, loss=1.4649667739868164, param_norm=1887.05224609375
10:36:50.315 [I] Progress on: 336it/1.00kit rate:9.4s/it remaining:1:44:24 elapsed:49:39 postfix:- (511844:tqdm_logging.py:145)
Step 336: grad_norm=5.685551166534424, loss=1.138140082359314, param_norm=1887.052490234375
Step 337: grad_norm=9.632125854492188, loss=1.2393467426300049, param_norm=1887.052734375
10:37:07.636 [I] Progress on: 337it/1.00kit rate:9.2s/it remaining:1:41:57 elapsed:49:57 postfix:- (511844:tqdm_logging.py:145)
Step 338: grad_norm=7.037271976470947, loss=1.3633036613464355, param_norm=1887.05322265625
Step 339: grad_norm=7.060795307159424, loss=1.357100486755371, param_norm=1887.053466796875
10:37:25.117 [I] Progress on: 339it/1.00kit rate:9.0s/it remaining:1:38:54 elapsed:50:14 postfix:- (511844:tqdm_logging.py:145)
Step 340: grad_norm=12.965435981750488, loss=1.290186882019043, param_norm=1887.0538330078125
Step 341: grad_norm=9.288897514343262, loss=1.218593716621399, param_norm=1887.0540771484375
10:37:42.615 [I] Progress on: 341it/1.00kit rate:8.9s/it remaining:1:37:20 elapsed:50:32 postfix:- (511844:tqdm_logging.py:145)
Step 342: grad_norm=8.514528274536133, loss=1.267290472984314, param_norm=1887.054443359375
Step 343: grad_norm=7.921883583068848, loss=1.292701244354248, param_norm=1887.0548095703125
10:38:00.098 [I] Progress on: 343it/1.00kit rate:8.8s/it remaining:1:36:21 elapsed:50:49 postfix:- (511844:tqdm_logging.py:145)
Step 344: grad_norm=13.905875205993652, loss=1.1801352500915527, param_norm=1887.0552978515625
Step 345: grad_norm=14.078036308288574, loss=1.38071608543396, param_norm=1887.0555419921875
10:38:17.524 [I] Progress on: 345it/1.00kit rate:8.8s/it remaining:1:35:35 elapsed:51:07 postfix:- (511844:tqdm_logging.py:145)
Step 346: grad_norm=6.932333946228027, loss=1.201552391052246, param_norm=1887.055908203125
Step 347: grad_norm=6.158651828765869, loss=1.1289265155792236, param_norm=1887.05615234375
10:38:35.022 [I] Progress on: 347it/1.00kit rate:8.8s/it remaining:1:35:16 elapsed:51:24 postfix:- (511844:tqdm_logging.py:145)
Step 348: grad_norm=7.71077823638916, loss=1.436110019683838, param_norm=1887.0565185546875
Step 349: grad_norm=5.11686897277832, loss=1.1322532892227173, param_norm=1887.0570068359375
10:38:52.522 [I] Progress on: 349it/1.00kit rate:8.8s/it remaining:1:34:58 elapsed:51:42 postfix:- (511844:tqdm_logging.py:145)
Step 350: grad_norm=6.199829578399658, loss=1.2545942068099976, param_norm=1887.057373046875
Step 351: grad_norm=14.40746784210205, loss=1.390244722366333, param_norm=1887.0577392578125
10:39:10.007 [I] Progress on: 351it/1.00kit rate:8.7s/it remaining:1:34:38 elapsed:51:59 postfix:- (511844:tqdm_logging.py:145)
Step 352: grad_norm=9.02649974822998, loss=1.3491774797439575, param_norm=1887.05810546875
Step 353: grad_norm=5.966495990753174, loss=1.312614917755127, param_norm=1887.0584716796875
10:39:27.452 [I] Progress on: 353it/1.00kit rate:8.7s/it remaining:1:34:13 elapsed:52:17 postfix:- (511844:tqdm_logging.py:145)
Step 354: grad_norm=8.3729887008667, loss=1.2813358306884766, param_norm=1887.058837890625
Step 355: grad_norm=9.349980354309082, loss=1.315385341644287, param_norm=1887.05908203125
10:39:44.899 [I] Progress on: 355it/1.00kit rate:8.7s/it remaining:1:33:52 elapsed:52:34 postfix:- (511844:tqdm_logging.py:145)
Step 356: grad_norm=7.467767715454102, loss=1.3229562044143677, param_norm=1887.0594482421875
Step 357: grad_norm=7.53112268447876, loss=1.2020742893218994, param_norm=1887.0596923828125
10:40:02.516 [I] Progress on: 357it/1.00kit rate:8.7s/it remaining:1:33:39 elapsed:52:52 postfix:- (511844:tqdm_logging.py:145)
Step 358: grad_norm=7.40845251083374, loss=1.2556663751602173, param_norm=1887.06005859375
Step 359: grad_norm=15.857279777526855, loss=1.29328453540802, param_norm=1887.060302734375
10:40:20.022 [I] Progress on: 359it/1.00kit rate:8.8s/it remaining:1:33:43 elapsed:53:09 postfix:- (511844:tqdm_logging.py:145)
Step 360: grad_norm=7.311392784118652, loss=1.4646966457366943, param_norm=1887.060546875
Step 361: grad_norm=7.601251602172852, loss=1.3869200944900513, param_norm=1887.0609130859375
10:40:37.503 [I] Progress on: 361it/1.00kit rate:8.8s/it remaining:1:33:15 elapsed:53:27 postfix:- (511844:tqdm_logging.py:145)
Step 362: grad_norm=6.482094764709473, loss=1.3291220664978027, param_norm=1887.0611572265625
Step 363: grad_norm=11.223165512084961, loss=1.3207216262817383, param_norm=1887.061279296875
10:40:54.998 [I] Progress on: 363it/1.00kit rate:8.8s/it remaining:1:32:56 elapsed:53:44 postfix:- (511844:tqdm_logging.py:145)
Step 364: grad_norm=8.12979793548584, loss=1.0890889167785645, param_norm=1887.061767578125
Step 365: grad_norm=8.56355094909668, loss=1.2542037963867188, param_norm=1887.06201171875
10:41:12.481 [I] Progress on: 365it/1.00kit rate:8.7s/it remaining:1:32:35 elapsed:54:02 postfix:- (511844:tqdm_logging.py:145)
Step 366: grad_norm=18.486547470092773, loss=1.4174071550369263, param_norm=1887.062255859375
Step 367: grad_norm=8.692790985107422, loss=1.2133203744888306, param_norm=1887.0626220703125
10:41:29.954 [I] Progress on: 367it/1.00kit rate:8.7s/it remaining:1:32:14 elapsed:54:19 postfix:- (511844:tqdm_logging.py:145)
Step 368: grad_norm=18.746742248535156, loss=1.4316034317016602, param_norm=1887.062744140625
Step 369: grad_norm=37.6026496887207, loss=1.2537767887115479, param_norm=1887.0631103515625
10:41:47.429 [I] Progress on: 369it/1.00kit rate:8.7s/it remaining:1:31:54 elapsed:54:37 postfix:- (511844:tqdm_logging.py:145)
Step 370: grad_norm=11.450039863586426, loss=1.3833937644958496, param_norm=1887.0633544921875
Step 371: grad_norm=11.292692184448242, loss=1.2825331687927246, param_norm=1887.0635986328125
10:42:04.915 [I] Progress on: 371it/1.00kit rate:8.7s/it remaining:1:31:38 elapsed:54:54 postfix:- (511844:tqdm_logging.py:145)
Step 372: grad_norm=14.178037643432617, loss=1.2287547588348389, param_norm=1887.0638427734375
Step 373: grad_norm=17.6047306060791, loss=1.1201790571212769, param_norm=1887.0640869140625
10:42:22.401 [I] Progress on: 373it/1.00kit rate:8.7s/it remaining:1:31:22 elapsed:55:12 postfix:- (511844:tqdm_logging.py:145)
Step 374: grad_norm=9.379246711730957, loss=1.1576253175735474, param_norm=1887.0643310546875
Step 375: grad_norm=13.656511306762695, loss=1.3485305309295654, param_norm=1887.0645751953125
10:42:39.879 [I] Progress on: 375it/1.00kit rate:8.7s/it remaining:1:31:04 elapsed:55:29 postfix:- (511844:tqdm_logging.py:145)
Step 376: grad_norm=10.471487998962402, loss=1.2061498165130615, param_norm=1887.0648193359375
Step 377: grad_norm=12.916304588317871, loss=1.2630014419555664, param_norm=1887.0650634765625
10:42:57.356 [I] Progress on: 377it/1.00kit rate:8.7s/it remaining:1:30:45 elapsed:55:46 postfix:- (511844:tqdm_logging.py:145)
Step 378: grad_norm=9.72488021850586, loss=1.4464091062545776, param_norm=1887.065185546875
Step 379: grad_norm=9.537050247192383, loss=1.292067527770996, param_norm=1887.0654296875
10:43:14.841 [I] Progress on: 379it/1.00kit rate:8.7s/it remaining:1:30:28 elapsed:56:04 postfix:- (511844:tqdm_logging.py:145)
Step 380: grad_norm=9.405875205993652, loss=1.4406800270080566, param_norm=1887.065673828125
Step 381: grad_norm=10.801912307739258, loss=1.3602814674377441, param_norm=1887.065673828125
10:43:32.318 [I] Progress on: 381it/1.00kit rate:8.7s/it remaining:1:30:10 elapsed:56:21 postfix:- (511844:tqdm_logging.py:145)
Step 382: grad_norm=11.661514282226562, loss=1.315242052078247, param_norm=1887.06591796875
Step 383: grad_norm=9.836873054504395, loss=1.3557448387145996, param_norm=1887.0662841796875
10:43:49.812 [I] Progress on: 383it/1.00kit rate:8.7s/it remaining:1:29:55 elapsed:56:39 postfix:- (511844:tqdm_logging.py:145)
Step 384: grad_norm=14.16008186340332, loss=1.3462467193603516, param_norm=1887.0665283203125
Step 385: grad_norm=7.9037861824035645, loss=1.1981362104415894, param_norm=1887.066650390625
10:44:07.307 [I] Progress on: 385it/1.00kit rate:8.7s/it remaining:1:29:38 elapsed:56:56 postfix:- (511844:tqdm_logging.py:145)
Step 386: grad_norm=13.126127243041992, loss=1.11822509765625, param_norm=1887.0670166015625
Step 387: grad_norm=7.530646324157715, loss=1.2474489212036133, param_norm=1887.0672607421875
10:44:24.808 [I] Progress on: 387it/1.00kit rate:8.7s/it remaining:1:29:23 elapsed:57:14 postfix:- (511844:tqdm_logging.py:145)
Step 388: grad_norm=6.451400279998779, loss=1.3524141311645508, param_norm=1887.0675048828125
Step 389: grad_norm=14.994087219238281, loss=1.3179833889007568, param_norm=1887.0677490234375
10:44:42.301 [I] Progress on: 389it/1.00kit rate:8.7s/it remaining:1:29:04 elapsed:57:31 postfix:- (511844:tqdm_logging.py:145)
Step 390: grad_norm=19.8834228515625, loss=1.2235746383666992, param_norm=1887.0679931640625
Step 391: grad_norm=6.134459495544434, loss=1.1816898584365845, param_norm=1887.0682373046875
10:44:59.810 [I] Progress on: 391it/1.00kit rate:8.8s/it remaining:1:28:50 elapsed:57:49 postfix:- (511844:tqdm_logging.py:145)
Step 392: grad_norm=7.349946975708008, loss=1.1398780345916748, param_norm=1887.0684814453125
Step 393: grad_norm=6.531676292419434, loss=1.3243401050567627, param_norm=1887.0687255859375
10:45:17.312 [I] Progress on: 393it/1.00kit rate:8.8s/it remaining:1:28:33 elapsed:58:06 postfix:- (511844:tqdm_logging.py:145)
Step 394: grad_norm=5.7165985107421875, loss=1.1888706684112549, param_norm=1887.0689697265625
Step 395: grad_norm=5.6255364418029785, loss=1.2686073780059814, param_norm=1887.0693359375
10:45:34.822 [I] Progress on: 395it/1.00kit rate:8.8s/it remaining:1:28:16 elapsed:58:24 postfix:- (511844:tqdm_logging.py:145)
Step 396: grad_norm=5.756767272949219, loss=1.2081902027130127, param_norm=1887.069580078125
Step 397: grad_norm=9.103781700134277, loss=1.0728349685668945, param_norm=1887.06982421875
10:45:52.316 [I] Progress on: 397it/1.00kit rate:8.8s/it remaining:1:27:57 elapsed:58:41 postfix:- (511844:tqdm_logging.py:145)
Step 398: grad_norm=7.340155601501465, loss=1.1522400379180908, param_norm=1887.070068359375
Step 399: grad_norm=8.781281471252441, loss=1.2122137546539307, param_norm=1887.0703125
10:46:09.817 [I] Progress on: 399it/1.00kit rate:8.8s/it remaining:1:27:39 elapsed:58:59 postfix:- (511844:tqdm_logging.py:145)
Step 400: grad_norm=7.837216854095459, loss=1.0889642238616943, param_norm=1887.070556640625
10:46:18.742 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
10:46:18.742 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
10:46:18.742 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (511844:checkpoint_manager.py:1786)
10:46:18.742 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (511844:checkpoint_manager.py:1817)
10:46:18.743 [I] [process=0] Saving checkpoint at step 400                                        (511844:checkpoint_manager.py:1286)
10:46:18.743 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400. (511844:async_checkpointer.py:358)
10:46:18.744 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:46:18.745 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9 (511844:atomicity.py:144)
10:46:18.745 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:46:18.746 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
10:46:18.747 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (511844:atomicity.py:144)
10:46:18.747 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (511844:atomicity.py:144)
10:46:18.748 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
10:46:18.752 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
10:46:22.366 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
10:46:22.367 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:46:22.368 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
10:46:22.373 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
10:46:22.396 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
10:46:22.399 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
10:46:22.404 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
10:46:22.407 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
10:46:22.408 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
10:46:22.411 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
10:46:22.412 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744123578.742096, 'wait_for_prev_duration_secs': 0.0006315708160400391, 'checkpointer_blocking_start_time': 1744123578.743274, 'checkpointer_blocking_duration_secs': 3.653062105178833, 'get_old_steps_start_time': 1744123582.3964763, 'get_old_steps_duration_secs': 0.010406970977783203, 'checkpoint_manager_blocking_start_time': 1744123578.7419257, 'checkpoint_manager_blocking_duration_secs': 3.6708219051361084} (511844:standard_logger.py:34)
10:46:22.417 [I] Progress on: 401it/1.00kit rate:9.9s/it remaining:1:38:24 elapsed:59:12 postfix:- (511844:tqdm_logging.py:145)
10:46:30.038 [I] ChainedFuture completed 1/1 futures in 7.66 seconds.                             (511844:future.py:137)
10:46:30.038 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 917.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
10:46:30.039 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
10:46:30.040 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9 (511844:async_checkpointer.py:406)
10:46:30.041 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9/assets (511844:atomicity.py:287)
10:46:30.064 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9/params (511844:atomicity.py:287)
10:46:30.065 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400 (511844:async_checkpointer.py:416)
10:46:30.065 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9 (511844:async_checkpointer.py:426)
10:46:30.065 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400 (511844:atomicity.py:287)
10:46:30.066 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/400`. (511844:atomicity.py:548)
10:46:30.067 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
10:46:30.067 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
10:46:30.068 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
10:46:30.068 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
10:46:30.068 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 401: grad_norm=5.767548084259033, loss=1.1639244556427002, param_norm=1887.0709228515625
Step 402: grad_norm=9.380471229553223, loss=1.3068228960037231, param_norm=1887.0711669921875
10:46:39.818 [I] Progress on: 402it/1.00kit rate:9.5s/it remaining:1:35:09 elapsed:59:29 postfix:- (511844:tqdm_logging.py:145)
Step 403: grad_norm=7.505916118621826, loss=1.2851276397705078, param_norm=1887.071533203125
Step 404: grad_norm=7.288233757019043, loss=1.1216950416564941, param_norm=1887.07177734375
10:46:57.328 [I] Progress on: 404it/1.00kit rate:9.1s/it remaining:1:30:49 elapsed:59:46 postfix:- (511844:tqdm_logging.py:145)
Step 405: grad_norm=5.545980930328369, loss=1.014736533164978, param_norm=1887.072021484375
Step 406: grad_norm=6.022117614746094, loss=1.2910175323486328, param_norm=1887.0723876953125
10:47:14.847 [I] Progress on: 406it/1.00kit rate:8.9s/it remaining:1:28:35 elapsed:1:00:04 postfix:- (511844:tqdm_logging.py:145)
Step 407: grad_norm=7.992639541625977, loss=1.1513919830322266, param_norm=1887.0726318359375
Step 408: grad_norm=6.4408087730407715, loss=1.0983915328979492, param_norm=1887.0728759765625
10:47:32.349 [I] Progress on: 408it/1.00kit rate:8.8s/it remaining:1:27:16 elapsed:1:00:21 postfix:- (511844:tqdm_logging.py:145)
Step 409: grad_norm=7.601851463317871, loss=1.2452013492584229, param_norm=1887.0731201171875
Step 410: grad_norm=17.060415267944336, loss=0.9954876899719238, param_norm=1887.073486328125
10:47:49.862 [I] Progress on: 410it/1.00kit rate:8.8s/it remaining:1:26:31 elapsed:1:00:39 postfix:- (511844:tqdm_logging.py:145)
Step 411: grad_norm=6.213664531707764, loss=1.2414894104003906, param_norm=1887.0736083984375
Step 412: grad_norm=13.681921005249023, loss=1.3320093154907227, param_norm=1887.073974609375
10:48:07.364 [I] Progress on: 412it/1.00kit rate:8.8s/it remaining:1:25:59 elapsed:1:00:56 postfix:- (511844:tqdm_logging.py:145)
Step 413: grad_norm=8.33825969696045, loss=1.3860483169555664, param_norm=1887.07421875
Step 414: grad_norm=11.199438095092773, loss=1.188380241394043, param_norm=1887.0745849609375
10:48:24.879 [I] Progress on: 414it/1.00kit rate:8.8s/it remaining:1:25:36 elapsed:1:01:14 postfix:- (511844:tqdm_logging.py:145)
Step 415: grad_norm=12.117059707641602, loss=1.140855312347412, param_norm=1887.0748291015625
Step 416: grad_norm=5.558449745178223, loss=1.2099015712738037, param_norm=1887.074951171875
10:48:42.385 [I] Progress on: 416it/1.00kit rate:8.8s/it remaining:1:25:15 elapsed:1:01:32 postfix:- (511844:tqdm_logging.py:145)
Step 417: grad_norm=8.176624298095703, loss=1.40833580493927, param_norm=1887.0751953125
Step 418: grad_norm=6.9369330406188965, loss=1.0204041004180908, param_norm=1887.075439453125
10:48:59.881 [I] Progress on: 418it/1.00kit rate:8.8s/it remaining:1:24:54 elapsed:1:01:49 postfix:- (511844:tqdm_logging.py:145)
Step 419: grad_norm=10.3722562789917, loss=1.3134162425994873, param_norm=1887.07568359375
10:49:10.784 [I] Progress on: 420it/1.00kit rate:9.3s/it remaining:1:30:21 elapsed:1:02:00 postfix:- (511844:tqdm_logging.py:145)
Step 420: grad_norm=4.960593223571777, loss=1.036653995513916, param_norm=1887.0758056640625
Step 421: grad_norm=11.569828987121582, loss=1.0041722059249878, param_norm=1887.0760498046875
10:49:28.121 [I] Progress on: 421it/1.00kit rate:9.2s/it remaining:1:28:29 elapsed:1:02:17 postfix:- (511844:tqdm_logging.py:145)
Step 422: grad_norm=10.036504745483398, loss=0.9965164065361023, param_norm=1887.0762939453125
Step 423: grad_norm=6.017230987548828, loss=1.0469073057174683, param_norm=1887.076416015625
10:49:45.611 [I] Progress on: 423it/1.00kit rate:9.0s/it remaining:1:26:05 elapsed:1:02:35 postfix:- (511844:tqdm_logging.py:145)
Step 424: grad_norm=18.969680786132812, loss=0.9705108404159546, param_norm=1887.07666015625
Step 425: grad_norm=5.305083274841309, loss=1.03067147731781, param_norm=1887.0770263671875
10:50:03.104 [I] Progress on: 425it/1.00kit rate:8.8s/it remaining:1:24:48 elapsed:1:02:52 postfix:- (511844:tqdm_logging.py:145)
Step 426: grad_norm=11.175442695617676, loss=0.9980686902999878, param_norm=1887.0771484375
Step 427: grad_norm=14.898124694824219, loss=1.0565924644470215, param_norm=1887.077392578125
10:50:20.599 [I] Progress on: 427it/1.00kit rate:8.8s/it remaining:1:23:59 elapsed:1:03:10 postfix:- (511844:tqdm_logging.py:145)
Step 428: grad_norm=9.597285270690918, loss=0.977961003780365, param_norm=1887.07763671875
Step 429: grad_norm=6.796638011932373, loss=1.1883251667022705, param_norm=1887.077880859375
10:50:38.105 [I] Progress on: 429it/1.00kit rate:8.8s/it remaining:1:23:30 elapsed:1:03:27 postfix:- (511844:tqdm_logging.py:145)
Step 430: grad_norm=12.071440696716309, loss=0.9386566877365112, param_norm=1887.0780029296875
Step 431: grad_norm=5.437513828277588, loss=0.9203071594238281, param_norm=1887.0782470703125
10:50:55.619 [I] Progress on: 431it/1.00kit rate:8.8s/it remaining:1:23:07 elapsed:1:03:45 postfix:- (511844:tqdm_logging.py:145)
Step 432: grad_norm=9.346938133239746, loss=1.11582612991333, param_norm=1887.07861328125
Step 433: grad_norm=5.700417995452881, loss=1.1093878746032715, param_norm=1887.078857421875
10:51:13.115 [I] Progress on: 433it/1.00kit rate:8.8s/it remaining:1:22:47 elapsed:1:04:02 postfix:- (511844:tqdm_logging.py:145)
Step 434: grad_norm=6.138662338256836, loss=1.1326195001602173, param_norm=1887.0789794921875
Step 435: grad_norm=10.967341423034668, loss=0.8749010562896729, param_norm=1887.079345703125
10:51:30.598 [I] Progress on: 435it/1.00kit rate:8.8s/it remaining:1:22:24 elapsed:1:04:20 postfix:- (511844:tqdm_logging.py:145)
Step 436: grad_norm=8.400343894958496, loss=0.9270113110542297, param_norm=1887.07958984375
Step 437: grad_norm=9.59457015991211, loss=1.0740535259246826, param_norm=1887.079833984375
10:51:48.087 [I] Progress on: 437it/1.00kit rate:8.7s/it remaining:1:22:04 elapsed:1:04:37 postfix:- (511844:tqdm_logging.py:145)
Step 438: grad_norm=6.5156660079956055, loss=1.0212843418121338, param_norm=1887.0802001953125
Step 439: grad_norm=17.33859634399414, loss=0.9108315706253052, param_norm=1887.080322265625
10:52:05.599 [I] Progress on: 439it/1.00kit rate:8.8s/it remaining:1:21:49 elapsed:1:04:55 postfix:- (511844:tqdm_logging.py:145)
Step 440: grad_norm=11.604838371276855, loss=0.8948732614517212, param_norm=1887.08056640625
Step 441: grad_norm=6.583193302154541, loss=0.9215712547302246, param_norm=1887.0809326171875
10:52:23.101 [I] Progress on: 441it/1.00kit rate:8.8s/it remaining:1:21:32 elapsed:1:05:12 postfix:- (511844:tqdm_logging.py:145)
Step 442: grad_norm=8.171721458435059, loss=1.0246448516845703, param_norm=1887.0811767578125
Step 443: grad_norm=5.679710388183594, loss=1.0392813682556152, param_norm=1887.081298828125
10:52:40.600 [I] Progress on: 443it/1.00kit rate:8.8s/it remaining:1:21:15 elapsed:1:05:30 postfix:- (511844:tqdm_logging.py:145)
Step 444: grad_norm=19.20694351196289, loss=1.036395788192749, param_norm=1887.0816650390625
Step 445: grad_norm=17.957120895385742, loss=0.9262316226959229, param_norm=1887.0819091796875
10:52:58.071 [I] Progress on: 445it/1.00kit rate:8.7s/it remaining:1:20:52 elapsed:1:05:47 postfix:- (511844:tqdm_logging.py:145)
Step 446: grad_norm=15.859938621520996, loss=0.8538349866867065, param_norm=1887.0821533203125
Step 447: grad_norm=17.45926856994629, loss=1.141451358795166, param_norm=1887.0823974609375
10:53:15.548 [I] Progress on: 447it/1.00kit rate:8.7s/it remaining:1:20:32 elapsed:1:06:05 postfix:- (511844:tqdm_logging.py:145)
Step 448: grad_norm=9.932827949523926, loss=0.9884480237960815, param_norm=1887.0826416015625
Step 449: grad_norm=33.48709487915039, loss=0.9567432403564453, param_norm=1887.0828857421875
10:53:33.118 [I] Progress on: 449it/1.00kit rate:8.8s/it remaining:1:20:29 elapsed:1:06:22 postfix:- (511844:tqdm_logging.py:145)
Step 450: grad_norm=8.037675857543945, loss=0.9517688751220703, param_norm=1887.0830078125
Step 451: grad_norm=5.949196815490723, loss=1.0345172882080078, param_norm=1887.0833740234375
10:53:50.628 [I] Progress on: 451it/1.00kit rate:8.8s/it remaining:1:20:09 elapsed:1:06:40 postfix:- (511844:tqdm_logging.py:145)
Step 452: grad_norm=8.076045036315918, loss=0.971328616142273, param_norm=1887.0836181640625
Step 453: grad_norm=5.816361904144287, loss=0.9817338585853577, param_norm=1887.083740234375
10:54:08.114 [I] Progress on: 453it/1.00kit rate:8.8s/it remaining:1:19:48 elapsed:1:06:57 postfix:- (511844:tqdm_logging.py:145)
Step 454: grad_norm=6.238041877746582, loss=0.9783579111099243, param_norm=1887.0838623046875
Step 455: grad_norm=11.098111152648926, loss=1.0038082599639893, param_norm=1887.0841064453125
10:54:25.641 [I] Progress on: 455it/1.00kit rate:8.8s/it remaining:1:19:33 elapsed:1:07:15 postfix:- (511844:tqdm_logging.py:145)
Step 456: grad_norm=7.411327362060547, loss=0.8362441062927246, param_norm=1887.0843505859375
Step 457: grad_norm=7.122583389282227, loss=0.9396106004714966, param_norm=1887.0843505859375
10:54:43.143 [I] Progress on: 457it/1.00kit rate:8.8s/it remaining:1:19:15 elapsed:1:07:32 postfix:- (511844:tqdm_logging.py:145)
Step 458: grad_norm=10.161077499389648, loss=1.0116370916366577, param_norm=1887.0845947265625
Step 459: grad_norm=14.989265441894531, loss=0.8560578227043152, param_norm=1887.0848388671875
10:55:00.660 [I] Progress on: 459it/1.00kit rate:8.8s/it remaining:1:18:57 elapsed:1:07:50 postfix:- (511844:tqdm_logging.py:145)
Step 460: grad_norm=7.9659953117370605, loss=1.11466646194458, param_norm=1887.0850830078125
Step 461: grad_norm=10.005358695983887, loss=1.1053996086120605, param_norm=1887.085205078125
10:55:18.163 [I] Progress on: 461it/1.00kit rate:8.8s/it remaining:1:18:39 elapsed:1:08:07 postfix:- (511844:tqdm_logging.py:145)
Step 462: grad_norm=5.979028701782227, loss=0.9908841848373413, param_norm=1887.08544921875
Step 463: grad_norm=9.238321304321289, loss=1.025294542312622, param_norm=1887.0855712890625
10:55:35.668 [I] Progress on: 463it/1.00kit rate:8.8s/it remaining:1:18:21 elapsed:1:08:25 postfix:- (511844:tqdm_logging.py:145)
Step 464: grad_norm=13.14974308013916, loss=1.0362287759780884, param_norm=1887.0858154296875
Step 465: grad_norm=10.684304237365723, loss=1.004448413848877, param_norm=1887.0859375
10:55:53.182 [I] Progress on: 465it/1.00kit rate:8.8s/it remaining:1:18:04 elapsed:1:08:42 postfix:- (511844:tqdm_logging.py:145)
Step 466: grad_norm=9.010607719421387, loss=0.9013999700546265, param_norm=1887.086181640625
Step 467: grad_norm=8.94914722442627, loss=1.1315699815750122, param_norm=1887.0865478515625
10:56:10.694 [I] Progress on: 467it/1.00kit rate:8.8s/it remaining:1:17:46 elapsed:1:09:00 postfix:- (511844:tqdm_logging.py:145)
Step 468: grad_norm=6.461987018585205, loss=0.977988600730896, param_norm=1887.0867919921875
Step 469: grad_norm=7.753414154052734, loss=1.114330530166626, param_norm=1887.0869140625
10:56:28.209 [I] Progress on: 469it/1.00kit rate:8.8s/it remaining:1:17:31 elapsed:1:09:17 postfix:- (511844:tqdm_logging.py:145)
Step 470: grad_norm=20.711402893066406, loss=0.97186279296875, param_norm=1887.087158203125
Step 471: grad_norm=9.276679039001465, loss=0.98138427734375, param_norm=1887.08740234375
10:56:45.722 [I] Progress on: 471it/1.00kit rate:8.8s/it remaining:1:17:13 elapsed:1:09:35 postfix:- (511844:tqdm_logging.py:145)
Step 472: grad_norm=12.701574325561523, loss=1.015183448791504, param_norm=1887.087646484375
Step 473: grad_norm=5.2276387214660645, loss=0.9556416273117065, param_norm=1887.087890625
10:57:03.214 [I] Progress on: 473it/1.00kit rate:8.8s/it remaining:1:16:53 elapsed:1:09:52 postfix:- (511844:tqdm_logging.py:145)
Step 474: grad_norm=9.850493431091309, loss=1.0234334468841553, param_norm=1887.088134765625
Step 475: grad_norm=12.776278495788574, loss=1.0638564825057983, param_norm=1887.0882568359375
10:57:20.721 [I] Progress on: 475it/1.00kit rate:8.8s/it remaining:1:16:34 elapsed:1:10:10 postfix:- (511844:tqdm_logging.py:145)
Step 476: grad_norm=6.9889326095581055, loss=0.9393318891525269, param_norm=1887.0885009765625
Step 477: grad_norm=44.6644287109375, loss=0.9908839464187622, param_norm=1887.0887451171875
10:57:38.225 [I] Progress on: 477it/1.00kit rate:8.8s/it remaining:1:16:17 elapsed:1:10:27 postfix:- (511844:tqdm_logging.py:145)
Step 478: grad_norm=9.839752197265625, loss=1.0586795806884766, param_norm=1887.0888671875
Step 479: grad_norm=8.108330726623535, loss=0.9553860425949097, param_norm=1887.089111328125
10:57:55.738 [I] Progress on: 479it/1.00kit rate:8.8s/it remaining:1:16:00 elapsed:1:10:45 postfix:- (511844:tqdm_logging.py:145)
Step 480: grad_norm=6.104351997375488, loss=1.1755107641220093, param_norm=1887.0892333984375
Step 481: grad_norm=6.140264987945557, loss=1.0242247581481934, param_norm=1887.0894775390625
10:58:13.245 [I] Progress on: 481it/1.00kit rate:8.8s/it remaining:1:15:44 elapsed:1:11:02 postfix:- (511844:tqdm_logging.py:145)
Step 482: grad_norm=6.468997001647949, loss=1.1176362037658691, param_norm=1887.089599609375
Step 483: grad_norm=5.4818878173828125, loss=0.8880752921104431, param_norm=1887.08984375
10:58:30.752 [I] Progress on: 483it/1.00kit rate:8.8s/it remaining:1:15:26 elapsed:1:11:20 postfix:- (511844:tqdm_logging.py:145)
Step 484: grad_norm=8.5796480178833, loss=1.0240979194641113, param_norm=1887.0899658203125
Step 485: grad_norm=6.730050086975098, loss=0.9743720889091492, param_norm=1887.0902099609375
10:58:48.246 [I] Progress on: 485it/1.00kit rate:8.8s/it remaining:1:15:07 elapsed:1:11:37 postfix:- (511844:tqdm_logging.py:145)
Step 486: grad_norm=9.03703498840332, loss=0.8420056700706482, param_norm=1887.09033203125
Step 487: grad_norm=6.199681282043457, loss=1.0012786388397217, param_norm=1887.0904541015625
10:59:05.748 [I] Progress on: 487it/1.00kit rate:8.8s/it remaining:1:14:50 elapsed:1:11:55 postfix:- (511844:tqdm_logging.py:145)
Step 488: grad_norm=6.308995723724365, loss=0.9937224984169006, param_norm=1887.0906982421875
Step 489: grad_norm=11.303173065185547, loss=1.1741819381713867, param_norm=1887.0909423828125
10:59:23.252 [I] Progress on: 489it/1.00kit rate:8.8s/it remaining:1:14:32 elapsed:1:12:12 postfix:- (511844:tqdm_logging.py:145)
Step 490: grad_norm=11.564509391784668, loss=1.0687364339828491, param_norm=1887.0911865234375
Step 491: grad_norm=8.887203216552734, loss=0.8270261287689209, param_norm=1887.09130859375
10:59:40.762 [I] Progress on: 491it/1.00kit rate:8.8s/it remaining:1:14:16 elapsed:1:12:30 postfix:- (511844:tqdm_logging.py:145)
Step 492: grad_norm=8.446221351623535, loss=0.9386563301086426, param_norm=1887.09130859375
Step 493: grad_norm=6.852673053741455, loss=1.0226094722747803, param_norm=1887.091552734375
10:59:58.279 [I] Progress on: 493it/1.00kit rate:8.8s/it remaining:1:13:59 elapsed:1:12:47 postfix:- (511844:tqdm_logging.py:145)
Step 494: grad_norm=14.953072547912598, loss=0.8893500566482544, param_norm=1887.091796875
Step 495: grad_norm=7.150144577026367, loss=0.8968062400817871, param_norm=1887.0919189453125
11:00:15.786 [I] Progress on: 495it/1.00kit rate:8.8s/it remaining:1:13:41 elapsed:1:13:05 postfix:- (511844:tqdm_logging.py:145)
Step 496: grad_norm=6.560406684875488, loss=0.949049711227417, param_norm=1887.092041015625
Step 497: grad_norm=5.461147785186768, loss=0.9636237621307373, param_norm=1887.09228515625
11:00:33.304 [I] Progress on: 497it/1.00kit rate:8.8s/it remaining:1:13:25 elapsed:1:13:22 postfix:- (511844:tqdm_logging.py:145)
Step 498: grad_norm=6.639797687530518, loss=0.9140427112579346, param_norm=1887.092529296875
Step 499: grad_norm=7.074336528778076, loss=0.8749772310256958, param_norm=1887.0926513671875
11:00:50.823 [I] Progress on: 499it/1.00kit rate:8.8s/it remaining:1:13:07 elapsed:1:13:40 postfix:- (511844:tqdm_logging.py:145)
Step 500: grad_norm=7.4756975173950195, loss=1.0237596035003662, param_norm=1887.0928955078125
11:00:59.752 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
11:00:59.752 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
11:00:59.752 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (511844:checkpoint_manager.py:1786)
11:00:59.752 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (511844:checkpoint_manager.py:1817)
11:00:59.753 [I] [process=0] Saving checkpoint at step 500                                        (511844:checkpoint_manager.py:1286)
11:00:59.753 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500. (511844:async_checkpointer.py:358)
11:00:59.754 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:00:59.755 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12 (511844:atomicity.py:144)
11:00:59.755 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:00:59.756 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:00:59.757 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (511844:atomicity.py:144)
11:00:59.757 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (511844:atomicity.py:144)
11:00:59.758 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:00:59.762 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
11:01:03.315 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:01:03.318 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
11:01:03.320 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
11:01:03.322 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
11:01:03.323 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:01:03.326 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:01:03.329 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:01:03.332 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:22.396378+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:01:03.338 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
11:01:03.345 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
11:01:03.349 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
11:01:03.351 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744124459.7520154, 'wait_for_prev_duration_secs': 0.0006680488586425781, 'checkpointer_blocking_start_time': 1744124459.7532086, 'checkpointer_blocking_duration_secs': 3.5702691078186035, 'get_old_steps_start_time': 1744124463.3235457, 'get_old_steps_duration_secs': 0.014882802963256836, 'checkpoint_manager_blocking_start_time': 1744124459.7518578, 'checkpoint_manager_blocking_duration_secs': 3.599451780319214} (511844:standard_logger.py:34)
11:01:03.356 [I] Progress on: 501it/1.00kit rate:9.8s/it remaining:1:21:51 elapsed:1:13:52 postfix:- (511844:tqdm_logging.py:145)
11:01:10.525 [I] ChainedFuture completed 1/1 futures in 7.20 seconds.                             (511844:future.py:137)
11:01:10.526 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 962.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:01:10.526 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
11:01:10.527 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12 (511844:async_checkpointer.py:406)
11:01:10.528 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12/assets (511844:atomicity.py:287)
11:01:10.538 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12/params (511844:atomicity.py:287)
11:01:10.538 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500 (511844:async_checkpointer.py:416)
11:01:10.539 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12 (511844:async_checkpointer.py:426)
11:01:10.539 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500 (511844:atomicity.py:287)
11:01:10.540 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/500`. (511844:atomicity.py:548)
11:01:10.540 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
11:01:10.541 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
11:01:10.541 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
11:01:10.542 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
11:01:10.542 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 501: grad_norm=16.947193145751953, loss=1.0357282161712646, param_norm=1887.093017578125
Step 502: grad_norm=15.134153366088867, loss=0.9070000648498535, param_norm=1887.0931396484375
11:01:20.663 [I] Progress on: 502it/1.00kit rate:9.5s/it remaining:1:18:55 elapsed:1:14:10 postfix:- (511844:tqdm_logging.py:145)
Step 503: grad_norm=5.731666564941406, loss=0.9987356662750244, param_norm=1887.0933837890625
11:01:32.110 [I] Progress on: 504it/1.00kit rate:9.9s/it remaining:1:21:39 elapsed:1:14:21 postfix:- (511844:tqdm_logging.py:145)
Step 504: grad_norm=10.627961158752441, loss=0.773837685585022, param_norm=1887.0936279296875
Step 505: grad_norm=6.8571577072143555, loss=0.8331283926963806, param_norm=1887.0938720703125
11:01:49.443 [I] Progress on: 505it/1.00kit rate:9.5s/it remaining:1:18:41 elapsed:1:14:39 postfix:- (511844:tqdm_logging.py:145)
Step 506: grad_norm=6.031094551086426, loss=0.8990089893341064, param_norm=1887.0941162109375
Step 507: grad_norm=17.80137825012207, loss=0.7825831174850464, param_norm=1887.09423828125
11:02:06.933 [I] Progress on: 507it/1.00kit rate:9.1s/it remaining:1:15:03 elapsed:1:14:56 postfix:- (511844:tqdm_logging.py:145)
Step 508: grad_norm=17.255598068237305, loss=0.8739511370658875, param_norm=1887.0943603515625
Step 509: grad_norm=9.607725143432617, loss=0.7979373335838318, param_norm=1887.0946044921875
11:02:24.409 [I] Progress on: 509it/1.00kit rate:8.9s/it remaining:1:13:08 elapsed:1:15:14 postfix:- (511844:tqdm_logging.py:145)
Step 510: grad_norm=8.648811340332031, loss=0.8468459844589233, param_norm=1887.0947265625
Step 511: grad_norm=5.12681245803833, loss=0.7094768285751343, param_norm=1887.094970703125
11:02:41.889 [I] Progress on: 511it/1.00kit rate:8.8s/it remaining:1:12:00 elapsed:1:15:31 postfix:- (511844:tqdm_logging.py:145)
Step 512: grad_norm=8.569211959838867, loss=0.8986728191375732, param_norm=1887.0950927734375
Step 513: grad_norm=14.921918869018555, loss=0.8596950769424438, param_norm=1887.0950927734375
11:02:59.382 [I] Progress on: 513it/1.00kit rate:8.8s/it remaining:1:11:21 elapsed:1:15:49 postfix:- (511844:tqdm_logging.py:145)
Step 514: grad_norm=7.462957859039307, loss=0.8017951250076294, param_norm=1887.0953369140625
Step 515: grad_norm=12.598691940307617, loss=0.8915491700172424, param_norm=1887.095458984375
11:03:16.879 [I] Progress on: 515it/1.00kit rate:8.8s/it remaining:1:10:53 elapsed:1:16:06 postfix:- (511844:tqdm_logging.py:145)
Step 516: grad_norm=4.5809645652771, loss=0.7243162393569946, param_norm=1887.095458984375
Step 517: grad_norm=8.002090454101562, loss=0.8113754391670227, param_norm=1887.095703125
11:03:34.351 [I] Progress on: 517it/1.00kit rate:8.8s/it remaining:1:10:27 elapsed:1:16:23 postfix:- (511844:tqdm_logging.py:145)
Step 518: grad_norm=6.650301456451416, loss=0.8010825514793396, param_norm=1887.0958251953125
Step 519: grad_norm=7.016881465911865, loss=0.8607144951820374, param_norm=1887.095947265625
11:03:51.819 [I] Progress on: 519it/1.00kit rate:8.7s/it remaining:1:10:06 elapsed:1:16:41 postfix:- (511844:tqdm_logging.py:145)
Step 520: grad_norm=4.715689659118652, loss=0.7516263723373413, param_norm=1887.09619140625
Step 521: grad_norm=6.210107326507568, loss=0.733748733997345, param_norm=1887.0963134765625
11:04:09.271 [I] Progress on: 521it/1.00kit rate:8.7s/it remaining:1:09:45 elapsed:1:16:58 postfix:- (511844:tqdm_logging.py:145)
Step 522: grad_norm=5.399554252624512, loss=0.8718409538269043, param_norm=1887.096435546875
Step 523: grad_norm=7.015178203582764, loss=0.7026905417442322, param_norm=1887.0966796875
11:04:26.742 [I] Progress on: 523it/1.00kit rate:8.7s/it remaining:1:09:25 elapsed:1:17:16 postfix:- (511844:tqdm_logging.py:145)
Step 524: grad_norm=6.573431015014648, loss=0.7826133966445923, param_norm=1887.0968017578125
Step 525: grad_norm=5.819036960601807, loss=0.866020143032074, param_norm=1887.096923828125
11:04:44.234 [I] Progress on: 525it/1.00kit rate:8.7s/it remaining:1:09:12 elapsed:1:17:33 postfix:- (511844:tqdm_logging.py:145)
Step 526: grad_norm=10.676976203918457, loss=0.8546370267868042, param_norm=1887.09716796875
Step 527: grad_norm=8.67431926727295, loss=0.7984657287597656, param_norm=1887.097412109375
11:05:01.702 [I] Progress on: 527it/1.00kit rate:8.7s/it remaining:1:08:53 elapsed:1:17:51 postfix:- (511844:tqdm_logging.py:145)
Step 528: grad_norm=5.034817695617676, loss=0.7184298038482666, param_norm=1887.0975341796875
Step 529: grad_norm=5.586864948272705, loss=0.8449506759643555, param_norm=1887.09765625
11:05:19.167 [I] Progress on: 529it/1.00kit rate:8.7s/it remaining:1:08:35 elapsed:1:18:08 postfix:- (511844:tqdm_logging.py:145)
Step 530: grad_norm=9.044407844543457, loss=0.8711150884628296, param_norm=1887.0977783203125
Step 531: grad_norm=5.594649314880371, loss=0.7745766639709473, param_norm=1887.0980224609375
11:05:36.636 [I] Progress on: 531it/1.00kit rate:8.7s/it remaining:1:08:16 elapsed:1:18:26 postfix:- (511844:tqdm_logging.py:145)
Step 532: grad_norm=7.964659214019775, loss=0.8511813282966614, param_norm=1887.09814453125
Step 533: grad_norm=6.576338768005371, loss=0.6950495839118958, param_norm=1887.098388671875
11:05:54.105 [I] Progress on: 533it/1.00kit rate:8.7s/it remaining:1:07:59 elapsed:1:18:43 postfix:- (511844:tqdm_logging.py:145)
Step 534: grad_norm=8.000688552856445, loss=0.8420239090919495, param_norm=1887.0985107421875
Step 535: grad_norm=6.610908508300781, loss=0.8165015578269958, param_norm=1887.0987548828125
11:06:11.568 [I] Progress on: 535it/1.00kit rate:8.7s/it remaining:1:07:41 elapsed:1:19:01 postfix:- (511844:tqdm_logging.py:145)
Step 536: grad_norm=5.683437824249268, loss=0.7760099172592163, param_norm=1887.098876953125
Step 537: grad_norm=7.733179569244385, loss=0.7896528244018555, param_norm=1887.09912109375
11:06:29.042 [I] Progress on: 537it/1.00kit rate:8.7s/it remaining:1:07:24 elapsed:1:19:18 postfix:- (511844:tqdm_logging.py:145)
Step 538: grad_norm=6.003392696380615, loss=0.9164313673973083, param_norm=1887.0992431640625
Step 539: grad_norm=6.155853271484375, loss=0.8380615711212158, param_norm=1887.099365234375
11:06:46.498 [I] Progress on: 539it/1.00kit rate:8.7s/it remaining:1:07:06 elapsed:1:19:36 postfix:- (511844:tqdm_logging.py:145)
Step 540: grad_norm=8.073209762573242, loss=0.8846440315246582, param_norm=1887.099609375
Step 541: grad_norm=7.981183052062988, loss=0.7981132864952087, param_norm=1887.0997314453125
11:07:03.987 [I] Progress on: 541it/1.00kit rate:8.7s/it remaining:1:06:52 elapsed:1:19:53 postfix:- (511844:tqdm_logging.py:145)
Step 542: grad_norm=6.5309529304504395, loss=0.8972439169883728, param_norm=1887.099853515625
Step 543: grad_norm=7.398922443389893, loss=1.0140161514282227, param_norm=1887.10009765625
11:07:21.439 [I] Progress on: 543it/1.00kit rate:8.7s/it remaining:1:06:32 elapsed:1:20:11 postfix:- (511844:tqdm_logging.py:145)
Step 544: grad_norm=5.2293195724487305, loss=0.8653367757797241, param_norm=1887.100341796875
Step 545: grad_norm=11.422811508178711, loss=0.7850385904312134, param_norm=1887.1004638671875
11:07:38.921 [I] Progress on: 545it/1.00kit rate:8.7s/it remaining:1:06:16 elapsed:1:20:28 postfix:- (511844:tqdm_logging.py:145)
Step 546: grad_norm=7.755959510803223, loss=0.667073130607605, param_norm=1887.1005859375
Step 547: grad_norm=5.334948539733887, loss=0.7472478747367859, param_norm=1887.1007080078125
11:07:56.400 [I] Progress on: 547it/1.00kit rate:8.7s/it remaining:1:05:59 elapsed:1:20:46 postfix:- (511844:tqdm_logging.py:145)
Step 548: grad_norm=10.146230697631836, loss=0.8172469139099121, param_norm=1887.100830078125
Step 549: grad_norm=6.231732368469238, loss=0.7676979899406433, param_norm=1887.1009521484375
11:08:13.882 [I] Progress on: 549it/1.00kit rate:8.7s/it remaining:1:05:42 elapsed:1:21:03 postfix:- (511844:tqdm_logging.py:145)
Step 550: grad_norm=6.918146133422852, loss=0.8776063919067383, param_norm=1887.1011962890625
Step 551: grad_norm=5.076173782348633, loss=0.7760183811187744, param_norm=1887.101318359375
11:08:31.382 [I] Progress on: 551it/1.00kit rate:8.7s/it remaining:1:05:26 elapsed:1:21:21 postfix:- (511844:tqdm_logging.py:145)
Step 552: grad_norm=13.713006019592285, loss=0.7731823325157166, param_norm=1887.1014404296875
Step 553: grad_norm=5.788176536560059, loss=0.918087363243103, param_norm=1887.1016845703125
11:08:48.870 [I] Progress on: 553it/1.00kit rate:8.7s/it remaining:1:05:08 elapsed:1:21:38 postfix:- (511844:tqdm_logging.py:145)
Step 554: grad_norm=12.562524795532227, loss=0.8595661520957947, param_norm=1887.101806640625
Step 555: grad_norm=8.549073219299316, loss=0.7934492826461792, param_norm=1887.10205078125
11:09:06.362 [I] Progress on: 555it/1.00kit rate:8.7s/it remaining:1:04:52 elapsed:1:21:55 postfix:- (511844:tqdm_logging.py:145)
Step 556: grad_norm=18.356840133666992, loss=0.8635528087615967, param_norm=1887.10205078125
Step 557: grad_norm=10.78704833984375, loss=0.849051833152771, param_norm=1887.1021728515625
11:09:23.854 [I] Progress on: 557it/1.00kit rate:8.7s/it remaining:1:04:34 elapsed:1:22:13 postfix:- (511844:tqdm_logging.py:145)
Step 558: grad_norm=8.936519622802734, loss=0.8890056014060974, param_norm=1887.1024169921875
Step 559: grad_norm=6.422472953796387, loss=0.9527258276939392, param_norm=1887.1024169921875
11:09:41.360 [I] Progress on: 559it/1.00kit rate:8.7s/it remaining:1:04:18 elapsed:1:22:30 postfix:- (511844:tqdm_logging.py:145)
Step 560: grad_norm=7.468697547912598, loss=0.8237862586975098, param_norm=1887.1026611328125
Step 561: grad_norm=5.32752799987793, loss=0.8308055400848389, param_norm=1887.1026611328125
11:09:58.836 [I] Progress on: 561it/1.00kit rate:8.7s/it remaining:1:04:00 elapsed:1:22:48 postfix:- (511844:tqdm_logging.py:145)
Step 562: grad_norm=10.381918907165527, loss=0.7400033473968506, param_norm=1887.102783203125
Step 563: grad_norm=9.28684139251709, loss=0.8383029699325562, param_norm=1887.1029052734375
11:10:16.329 [I] Progress on: 563it/1.00kit rate:8.7s/it remaining:1:03:40 elapsed:1:23:05 postfix:- (511844:tqdm_logging.py:145)
Step 564: grad_norm=5.676046848297119, loss=0.7163033485412598, param_norm=1887.10302734375
Step 565: grad_norm=5.876304626464844, loss=0.8552132248878479, param_norm=1887.10302734375
11:10:33.812 [I] Progress on: 565it/1.00kit rate:8.7s/it remaining:1:03:22 elapsed:1:23:23 postfix:- (511844:tqdm_logging.py:145)
Step 566: grad_norm=5.114641189575195, loss=0.7394537925720215, param_norm=1887.1031494140625
Step 567: grad_norm=8.985025405883789, loss=0.6786870956420898, param_norm=1887.1033935546875
11:10:51.298 [I] Progress on: 567it/1.00kit rate:8.7s/it remaining:1:03:06 elapsed:1:23:40 postfix:- (511844:tqdm_logging.py:145)
Step 568: grad_norm=13.384840965270996, loss=0.8463094830513, param_norm=1887.103515625
Step 569: grad_norm=5.433011054992676, loss=0.7536853551864624, param_norm=1887.1036376953125
11:11:08.764 [I] Progress on: 569it/1.00kit rate:8.7s/it remaining:1:02:45 elapsed:1:23:58 postfix:- (511844:tqdm_logging.py:145)
Step 570: grad_norm=14.815321922302246, loss=0.8375293612480164, param_norm=1887.103759765625
Step 571: grad_norm=8.38924503326416, loss=0.7893556356430054, param_norm=1887.10400390625
11:11:26.263 [I] Progress on: 571it/1.00kit rate:8.7s/it remaining:1:02:31 elapsed:1:24:15 postfix:- (511844:tqdm_logging.py:145)
Step 572: grad_norm=6.342097759246826, loss=0.8087307214736938, param_norm=1887.10400390625
Step 573: grad_norm=8.125665664672852, loss=0.7236130237579346, param_norm=1887.104248046875
11:11:43.762 [I] Progress on: 573it/1.00kit rate:8.7s/it remaining:1:02:15 elapsed:1:24:33 postfix:- (511844:tqdm_logging.py:145)
Step 574: grad_norm=7.012001037597656, loss=0.8248451352119446, param_norm=1887.1043701171875
Step 575: grad_norm=9.486068725585938, loss=0.6569286584854126, param_norm=1887.1046142578125
11:12:01.265 [I] Progress on: 575it/1.00kit rate:8.7s/it remaining:1:01:58 elapsed:1:24:50 postfix:- (511844:tqdm_logging.py:145)
Step 576: grad_norm=11.837950706481934, loss=0.7510408163070679, param_norm=1887.104736328125
Step 577: grad_norm=12.060087203979492, loss=0.7666350603103638, param_norm=1887.1048583984375
11:12:18.767 [I] Progress on: 577it/1.00kit rate:8.8s/it remaining:1:01:41 elapsed:1:25:08 postfix:- (511844:tqdm_logging.py:145)
Step 578: grad_norm=9.932552337646484, loss=0.7783763408660889, param_norm=1887.1051025390625
Step 579: grad_norm=9.977381706237793, loss=0.8280511498451233, param_norm=1887.1051025390625
11:12:36.276 [I] Progress on: 579it/1.00kit rate:8.8s/it remaining:1:01:25 elapsed:1:25:25 postfix:- (511844:tqdm_logging.py:145)
Step 580: grad_norm=7.291865348815918, loss=0.7708325386047363, param_norm=1887.105224609375
Step 581: grad_norm=9.439338684082031, loss=0.8373578190803528, param_norm=1887.1053466796875
11:12:53.786 [I] Progress on: 581it/1.00kit rate:8.8s/it remaining:1:01:08 elapsed:1:25:43 postfix:- (511844:tqdm_logging.py:145)
Step 582: grad_norm=5.17340087890625, loss=0.8384820222854614, param_norm=1887.10546875
Step 583: grad_norm=4.9701714515686035, loss=0.7579085230827332, param_norm=1887.10546875
11:13:11.307 [I] Progress on: 583it/1.00kit rate:8.8s/it remaining:1:00:52 elapsed:1:26:00 postfix:- (511844:tqdm_logging.py:145)
Step 584: grad_norm=9.783073425292969, loss=0.801404595375061, param_norm=1887.105712890625
Step 585: grad_norm=5.487892150878906, loss=0.8921313881874084, param_norm=1887.1058349609375
11:13:28.894 [I] Progress on: 585it/1.00kit rate:8.8s/it remaining:1:00:43 elapsed:1:26:18 postfix:- (511844:tqdm_logging.py:145)
Step 586: grad_norm=4.999275207519531, loss=0.7460443377494812, param_norm=1887.10595703125
Step 587: grad_norm=5.3615031242370605, loss=0.8398475646972656, param_norm=1887.10595703125
11:13:46.396 [I] Progress on: 587it/1.00kit rate:8.8s/it remaining:1:00:20 elapsed:1:26:36 postfix:- (511844:tqdm_logging.py:145)
Step 588: grad_norm=4.805821418762207, loss=0.6259160041809082, param_norm=1887.106201171875
11:13:57.574 [I] Progress on: 588it/1.00kit rate:9.5s/it remaining:1:05:11 elapsed:1:26:47 postfix:- (511844:tqdm_logging.py:145)
Step 589: grad_norm=4.699334144592285, loss=0.6672123670578003, param_norm=1887.1063232421875
Step 590: grad_norm=4.694286823272705, loss=0.675836443901062, param_norm=1887.1065673828125
11:14:15.059 [I] Progress on: 590it/1.00kit rate:9.1s/it remaining:1:02:14 elapsed:1:27:04 postfix:- (511844:tqdm_logging.py:145)
Step 591: grad_norm=5.6424641609191895, loss=0.6343780755996704, param_norm=1887.1065673828125
Step 592: grad_norm=4.628615379333496, loss=0.7099540829658508, param_norm=1887.1068115234375
11:14:32.520 [I] Progress on: 592it/1.00kit rate:8.9s/it remaining:1:00:37 elapsed:1:27:22 postfix:- (511844:tqdm_logging.py:145)
Step 593: grad_norm=5.108919143676758, loss=0.7626602053642273, param_norm=1887.1068115234375
Step 594: grad_norm=5.322969913482666, loss=0.6786007881164551, param_norm=1887.10693359375
11:14:50.010 [I] Progress on: 594it/1.00kit rate:8.8s/it remaining:59:44 elapsed:1:27:39 postfix:- (511844:tqdm_logging.py:145)
Step 595: grad_norm=5.705184459686279, loss=0.6074548959732056, param_norm=1887.1070556640625
Step 596: grad_norm=6.634179592132568, loss=0.6818376779556274, param_norm=1887.1070556640625
11:15:07.503 [I] Progress on: 596it/1.00kit rate:8.8s/it remaining:59:08 elapsed:1:27:57 postfix:- (511844:tqdm_logging.py:145)
Step 597: grad_norm=4.446712970733643, loss=0.5748386979103088, param_norm=1887.107177734375
Step 598: grad_norm=4.594161033630371, loss=0.6227766275405884, param_norm=1887.1072998046875
11:15:25.000 [I] Progress on: 598it/1.00kit rate:8.8s/it remaining:58:43 elapsed:1:28:14 postfix:- (511844:tqdm_logging.py:145)
Step 599: grad_norm=5.5006256103515625, loss=0.7738604545593262, param_norm=1887.107421875
Step 600: grad_norm=5.972018241882324, loss=0.6784871220588684, param_norm=1887.1075439453125
11:15:42.494 [I] Progress on: 600it/1.00kit rate:8.8s/it remaining:58:22 elapsed:1:28:32 postfix:- (511844:tqdm_logging.py:145)
11:15:42.668 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
11:15:42.668 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
11:15:42.669 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (511844:checkpoint_manager.py:1786)
11:15:42.669 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (511844:checkpoint_manager.py:1817)
11:15:42.669 [I] [process=0] Saving checkpoint at step 600                                        (511844:checkpoint_manager.py:1286)
11:15:42.670 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600. (511844:async_checkpointer.py:358)
11:15:42.671 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:15:42.671 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15 (511844:atomicity.py:144)
11:15:42.672 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:15:42.672 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:15:42.673 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (511844:atomicity.py:144)
11:15:42.674 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (511844:atomicity.py:144)
11:15:42.674 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:15:42.679 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
11:15:46.430 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
11:15:46.431 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:15:46.432 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
11:15:46.433 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
11:15:46.456 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:15:46.458 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:15:46.463 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:15:46.466 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:22.396378+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:15:46.467 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:03.323498+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:15:46.469 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
11:15:46.471 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
11:15:46.472 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
11:15:46.485 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744125342.6685913, 'wait_for_prev_duration_secs': 0.0006661415100097656, 'checkpointer_blocking_start_time': 1744125342.669795, 'checkpointer_blocking_duration_secs': 3.7869670391082764, 'get_old_steps_start_time': 1744125346.4568238, 'get_old_steps_duration_secs': 0.012480974197387695, 'checkpoint_manager_blocking_start_time': 1744125342.6684306, 'checkpoint_manager_blocking_duration_secs': 3.816946029663086} (511844:standard_logger.py:34)
11:15:54.189 [I] ChainedFuture completed 1/1 futures in 7.74 seconds.                             (511844:future.py:137)
11:15:54.190 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 899.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:15:54.190 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
11:15:54.192 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15 (511844:async_checkpointer.py:406)
11:15:54.192 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15/assets (511844:atomicity.py:287)
11:15:54.202 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15/params (511844:atomicity.py:287)
11:15:54.203 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600 (511844:async_checkpointer.py:416)
11:15:54.203 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15 (511844:async_checkpointer.py:426)
11:15:54.203 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600 (511844:atomicity.py:287)
11:15:54.205 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/600`. (511844:atomicity.py:548)
11:15:54.205 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
11:15:54.205 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
11:15:54.206 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
11:15:54.206 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
11:15:54.206 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 601: grad_norm=6.039268493652344, loss=0.7397624850273132, param_norm=1887.107666015625
11:15:55.063 [I] Progress on: 601it/1.00kit rate:9.9s/it remaining:1:05:51 elapsed:1:28:44 postfix:- (511844:tqdm_logging.py:145)
Step 602: grad_norm=4.887880802154541, loss=0.6576343774795532, param_norm=1887.1077880859375
Step 603: grad_norm=5.608948707580566, loss=0.6327089071273804, param_norm=1887.10791015625
11:16:12.583 [I] Progress on: 603it/1.00kit rate:9.3s/it remaining:1:01:39 elapsed:1:29:02 postfix:- (511844:tqdm_logging.py:145)
Step 604: grad_norm=4.491953372955322, loss=0.6263546347618103, param_norm=1887.108154296875
Step 605: grad_norm=5.859504699707031, loss=0.7307732701301575, param_norm=1887.1082763671875
11:16:30.061 [I] Progress on: 605it/1.00kit rate:9.0s/it remaining:59:25 elapsed:1:29:19 postfix:- (511844:tqdm_logging.py:145)
Step 606: grad_norm=5.307470798492432, loss=0.6319591999053955, param_norm=1887.1083984375
Step 607: grad_norm=4.683241367340088, loss=0.628749668598175, param_norm=1887.1085205078125
11:16:47.546 [I] Progress on: 607it/1.00kit rate:8.9s/it remaining:58:10 elapsed:1:29:37 postfix:- (511844:tqdm_logging.py:145)
Step 608: grad_norm=6.895736217498779, loss=0.6541371941566467, param_norm=1887.108642578125
Step 609: grad_norm=4.992804050445557, loss=0.6739652156829834, param_norm=1887.1087646484375
11:17:05.034 [I] Progress on: 609it/1.00kit rate:8.8s/it remaining:57:25 elapsed:1:29:54 postfix:- (511844:tqdm_logging.py:145)
Step 610: grad_norm=5.9055070877075195, loss=0.7645488977432251, param_norm=1887.10888671875
Step 611: grad_norm=7.152560234069824, loss=0.6421802043914795, param_norm=1887.1090087890625
11:17:22.523 [I] Progress on: 611it/1.00kit rate:8.8s/it remaining:56:54 elapsed:1:30:12 postfix:- (511844:tqdm_logging.py:145)
Step 612: grad_norm=7.1278510093688965, loss=0.5967831015586853, param_norm=1887.109130859375
Step 613: grad_norm=5.417713642120361, loss=0.7659816145896912, param_norm=1887.1092529296875
11:17:40.016 [I] Progress on: 613it/1.00kit rate:8.8s/it remaining:56:30 elapsed:1:30:29 postfix:- (511844:tqdm_logging.py:145)
Step 614: grad_norm=6.449394702911377, loss=0.6472283601760864, param_norm=1887.109375
Step 615: grad_norm=5.696308612823486, loss=0.6947199106216431, param_norm=1887.1094970703125
11:17:57.507 [I] Progress on: 615it/1.00kit rate:8.8s/it remaining:56:10 elapsed:1:30:47 postfix:- (511844:tqdm_logging.py:145)
Step 616: grad_norm=7.789190292358398, loss=0.7257038950920105, param_norm=1887.109619140625
Step 617: grad_norm=5.935337066650391, loss=0.7236735820770264, param_norm=1887.1097412109375
11:18:14.986 [I] Progress on: 617it/1.00kit rate:8.7s/it remaining:55:50 elapsed:1:31:04 postfix:- (511844:tqdm_logging.py:145)
Step 618: grad_norm=9.01050853729248, loss=0.728369951248169, param_norm=1887.10986328125
Step 619: grad_norm=6.492196083068848, loss=0.6167021989822388, param_norm=1887.1099853515625
11:18:32.489 [I] Progress on: 619it/1.00kit rate:8.8s/it remaining:55:34 elapsed:1:31:22 postfix:- (511844:tqdm_logging.py:145)
Step 620: grad_norm=4.872705936431885, loss=0.6318821907043457, param_norm=1887.110107421875
Step 621: grad_norm=4.756321907043457, loss=0.7056925296783447, param_norm=1887.1102294921875
11:18:49.969 [I] Progress on: 621it/1.00kit rate:8.7s/it remaining:55:14 elapsed:1:31:39 postfix:- (511844:tqdm_logging.py:145)
Step 622: grad_norm=7.9580159187316895, loss=0.6391019225120544, param_norm=1887.1103515625
Step 623: grad_norm=8.033345222473145, loss=0.6774395704269409, param_norm=1887.1104736328125
11:19:07.434 [I] Progress on: 623it/1.00kit rate:8.7s/it remaining:54:55 elapsed:1:31:57 postfix:- (511844:tqdm_logging.py:145)
Step 624: grad_norm=4.379937171936035, loss=0.5877125859260559, param_norm=1887.110595703125
Step 625: grad_norm=5.494854927062988, loss=0.6059656143188477, param_norm=1887.110595703125
11:19:24.915 [I] Progress on: 625it/1.00kit rate:8.7s/it remaining:54:37 elapsed:1:32:14 postfix:- (511844:tqdm_logging.py:145)
Step 626: grad_norm=5.770622253417969, loss=0.7896552681922913, param_norm=1887.1107177734375
Step 627: grad_norm=5.845111846923828, loss=0.608582615852356, param_norm=1887.11083984375
11:19:42.391 [I] Progress on: 627it/1.00kit rate:8.7s/it remaining:54:20 elapsed:1:32:32 postfix:- (511844:tqdm_logging.py:145)
Step 628: grad_norm=6.442567825317383, loss=0.5857986211776733, param_norm=1887.1109619140625
Step 629: grad_norm=4.086009502410889, loss=0.6268049478530884, param_norm=1887.111083984375
11:19:59.907 [I] Progress on: 629it/1.00kit rate:8.7s/it remaining:54:01 elapsed:1:32:49 postfix:- (511844:tqdm_logging.py:145)
Step 630: grad_norm=5.1692891120910645, loss=0.7264970541000366, param_norm=1887.1112060546875
Step 631: grad_norm=4.721507549285889, loss=0.6317802667617798, param_norm=1887.111328125
11:20:17.408 [I] Progress on: 631it/1.00kit rate:8.8s/it remaining:53:49 elapsed:1:33:07 postfix:- (511844:tqdm_logging.py:145)
Step 632: grad_norm=4.744437217712402, loss=0.5965396761894226, param_norm=1887.111328125
Step 633: grad_norm=5.406501293182373, loss=0.7793461084365845, param_norm=1887.1114501953125
11:20:34.877 [I] Progress on: 633it/1.00kit rate:8.7s/it remaining:53:30 elapsed:1:33:24 postfix:- (511844:tqdm_logging.py:145)
Step 634: grad_norm=10.49202823638916, loss=0.6756569743156433, param_norm=1887.1114501953125
Step 635: grad_norm=4.344810485839844, loss=0.6482957601547241, param_norm=1887.111572265625
11:20:52.343 [I] Progress on: 635it/1.00kit rate:8.7s/it remaining:53:09 elapsed:1:33:41 postfix:- (511844:tqdm_logging.py:145)
Step 636: grad_norm=5.309041500091553, loss=0.6493418216705322, param_norm=1887.1116943359375
Step 637: grad_norm=4.671509742736816, loss=0.5233724117279053, param_norm=1887.1116943359375
11:21:09.817 [I] Progress on: 637it/1.00kit rate:8.7s/it remaining:52:52 elapsed:1:33:59 postfix:- (511844:tqdm_logging.py:145)
Step 638: grad_norm=7.911374092102051, loss=0.672187864780426, param_norm=1887.11181640625
Step 639: grad_norm=5.66370964050293, loss=0.6092566847801208, param_norm=1887.1119384765625
11:21:27.294 [I] Progress on: 639it/1.00kit rate:8.7s/it remaining:52:34 elapsed:1:34:16 postfix:- (511844:tqdm_logging.py:145)
Step 640: grad_norm=7.537040710449219, loss=0.6519899964332581, param_norm=1887.112060546875
Step 641: grad_norm=4.737980365753174, loss=0.5694882869720459, param_norm=1887.112060546875
11:21:44.768 [I] Progress on: 641it/1.00kit rate:8.7s/it remaining:52:17 elapsed:1:34:34 postfix:- (511844:tqdm_logging.py:145)
Step 642: grad_norm=5.160677909851074, loss=0.7152194976806641, param_norm=1887.1121826171875
Step 643: grad_norm=5.652571201324463, loss=0.6345663070678711, param_norm=1887.1121826171875
11:22:02.244 [I] Progress on: 643it/1.00kit rate:8.7s/it remaining:51:59 elapsed:1:34:51 postfix:- (511844:tqdm_logging.py:145)
Step 644: grad_norm=5.504947662353516, loss=0.651518702507019, param_norm=1887.1123046875
Step 645: grad_norm=4.703588008880615, loss=0.668668270111084, param_norm=1887.1124267578125
11:22:19.727 [I] Progress on: 645it/1.00kit rate:8.7s/it remaining:51:42 elapsed:1:35:09 postfix:- (511844:tqdm_logging.py:145)
Step 646: grad_norm=5.163954734802246, loss=0.6016393899917603, param_norm=1887.1124267578125
Step 647: grad_norm=4.334925651550293, loss=0.5937271118164062, param_norm=1887.112548828125
11:22:37.216 [I] Progress on: 647it/1.00kit rate:8.7s/it remaining:51:26 elapsed:1:35:26 postfix:- (511844:tqdm_logging.py:145)
Step 648: grad_norm=5.594188213348389, loss=0.5778550505638123, param_norm=1887.1126708984375
Step 649: grad_norm=4.681199550628662, loss=0.5690188407897949, param_norm=1887.11279296875
11:22:54.701 [I] Progress on: 649it/1.00kit rate:8.7s/it remaining:51:08 elapsed:1:35:44 postfix:- (511844:tqdm_logging.py:145)
Step 650: grad_norm=5.043834209442139, loss=0.7011087536811829, param_norm=1887.1129150390625
Step 651: grad_norm=6.638976097106934, loss=0.7254354357719421, param_norm=1887.1129150390625
11:23:12.179 [I] Progress on: 651it/1.00kit rate:8.7s/it remaining:50:50 elapsed:1:36:01 postfix:- (511844:tqdm_logging.py:145)
Step 652: grad_norm=6.693838119506836, loss=0.5749809741973877, param_norm=1887.113037109375
Step 653: grad_norm=9.224690437316895, loss=0.596382737159729, param_norm=1887.1131591796875
11:23:29.677 [I] Progress on: 653it/1.00kit rate:8.7s/it remaining:50:34 elapsed:1:36:19 postfix:- (511844:tqdm_logging.py:145)
Step 654: grad_norm=6.30393123626709, loss=0.6108212471008301, param_norm=1887.1131591796875
Step 655: grad_norm=5.161901473999023, loss=0.6636354923248291, param_norm=1887.11328125
11:23:47.158 [I] Progress on: 655it/1.00kit rate:8.7s/it remaining:50:16 elapsed:1:36:36 postfix:- (511844:tqdm_logging.py:145)
Step 656: grad_norm=5.817567348480225, loss=0.6187938451766968, param_norm=1887.11328125
Step 657: grad_norm=7.047879695892334, loss=0.5868048667907715, param_norm=1887.1134033203125
11:24:04.648 [I] Progress on: 657it/1.00kit rate:8.7s/it remaining:49:59 elapsed:1:36:54 postfix:- (511844:tqdm_logging.py:145)
Step 658: grad_norm=7.483678817749023, loss=0.6663615703582764, param_norm=1887.113525390625
Step 659: grad_norm=5.190915584564209, loss=0.6701369285583496, param_norm=1887.113525390625
11:24:22.140 [I] Progress on: 659it/1.00kit rate:8.7s/it remaining:49:42 elapsed:1:37:11 postfix:- (511844:tqdm_logging.py:145)
Step 660: grad_norm=4.372917652130127, loss=0.7007198333740234, param_norm=1887.113525390625
Step 661: grad_norm=7.412521839141846, loss=0.6116541624069214, param_norm=1887.11376953125
11:24:39.639 [I] Progress on: 661it/1.00kit rate:8.7s/it remaining:49:25 elapsed:1:37:29 postfix:- (511844:tqdm_logging.py:145)
Step 662: grad_norm=4.289230823516846, loss=0.5654431581497192, param_norm=1887.11376953125
Step 663: grad_norm=4.342599868774414, loss=0.6245436072349548, param_norm=1887.1138916015625
11:24:57.135 [I] Progress on: 663it/1.00kit rate:8.8s/it remaining:49:08 elapsed:1:37:46 postfix:- (511844:tqdm_logging.py:145)
Step 664: grad_norm=6.045250415802002, loss=0.5969674587249756, param_norm=1887.1138916015625
Step 665: grad_norm=5.106807708740234, loss=0.6402150392532349, param_norm=1887.114013671875
11:25:14.645 [I] Progress on: 665it/1.00kit rate:8.8s/it remaining:48:51 elapsed:1:38:04 postfix:- (511844:tqdm_logging.py:145)
Step 666: grad_norm=5.123588562011719, loss=0.6564826369285583, param_norm=1887.1141357421875
Step 667: grad_norm=6.9514689445495605, loss=0.7114790678024292, param_norm=1887.1142578125
11:25:32.144 [I] Progress on: 667it/1.00kit rate:8.8s/it remaining:48:34 elapsed:1:38:21 postfix:- (511844:tqdm_logging.py:145)
Step 668: grad_norm=6.339221954345703, loss=0.6843966245651245, param_norm=1887.1143798828125
Step 669: grad_norm=7.178466320037842, loss=0.6841456890106201, param_norm=1887.1143798828125
11:25:49.632 [I] Progress on: 669it/1.00kit rate:8.7s/it remaining:48:15 elapsed:1:38:39 postfix:- (511844:tqdm_logging.py:145)
Step 670: grad_norm=4.82309103012085, loss=0.6104306578636169, param_norm=1887.114501953125
Step 671: grad_norm=6.079522132873535, loss=0.7638619542121887, param_norm=1887.1146240234375
11:26:07.121 [I] Progress on: 671it/1.00kit rate:8.7s/it remaining:47:57 elapsed:1:38:56 postfix:- (511844:tqdm_logging.py:145)
Step 672: grad_norm=5.982295989990234, loss=0.613136887550354, param_norm=1887.11474609375
11:26:18.195 [I] Progress on: 672it/1.00kit rate:9.4s/it remaining:51:38 elapsed:1:39:07 postfix:- (511844:tqdm_logging.py:145)
Step 673: grad_norm=3.5586845874786377, loss=0.5240933895111084, param_norm=1887.11474609375
Step 674: grad_norm=4.273270606994629, loss=0.5714690089225769, param_norm=1887.1148681640625
11:26:35.695 [I] Progress on: 674it/1.00kit rate:9.1s/it remaining:49:25 elapsed:1:39:25 postfix:- (511844:tqdm_logging.py:145)
Step 675: grad_norm=4.40193510055542, loss=0.4972150921821594, param_norm=1887.114990234375
Step 676: grad_norm=4.645437717437744, loss=0.6255012154579163, param_norm=1887.114990234375
11:26:53.180 [I] Progress on: 676it/1.00kit rate:8.9s/it remaining:48:10 elapsed:1:39:42 postfix:- (511844:tqdm_logging.py:145)
Step 677: grad_norm=3.670194387435913, loss=0.5018056631088257, param_norm=1887.114990234375
Step 678: grad_norm=4.761885643005371, loss=0.549105167388916, param_norm=1887.1151123046875
11:27:10.679 [I] Progress on: 678it/1.00kit rate:8.8s/it remaining:47:26 elapsed:1:40:00 postfix:- (511844:tqdm_logging.py:145)
Step 679: grad_norm=4.0557780265808105, loss=0.5534197092056274, param_norm=1887.115234375
Step 680: grad_norm=4.4050822257995605, loss=0.593697190284729, param_norm=1887.115234375
11:27:28.177 [I] Progress on: 680it/1.00kit rate:8.8s/it remaining:46:54 elapsed:1:40:17 postfix:- (511844:tqdm_logging.py:145)
Step 681: grad_norm=3.9301419258117676, loss=0.5309256911277771, param_norm=1887.1153564453125
Step 682: grad_norm=4.659849166870117, loss=0.5237383246421814, param_norm=1887.1153564453125
11:27:45.686 [I] Progress on: 682it/1.00kit rate:8.8s/it remaining:46:32 elapsed:1:40:35 postfix:- (511844:tqdm_logging.py:145)
Step 683: grad_norm=7.4710493087768555, loss=0.5772318840026855, param_norm=1887.115478515625
Step 684: grad_norm=4.332513809204102, loss=0.5324690937995911, param_norm=1887.1156005859375
11:28:03.184 [I] Progress on: 684it/1.00kit rate:8.8s/it remaining:46:10 elapsed:1:40:52 postfix:- (511844:tqdm_logging.py:145)
Step 685: grad_norm=5.274458408355713, loss=0.6225959062576294, param_norm=1887.1156005859375
Step 686: grad_norm=4.815043926239014, loss=0.5320348739624023, param_norm=1887.1156005859375
11:28:20.698 [I] Progress on: 686it/1.00kit rate:8.8s/it remaining:45:52 elapsed:1:41:10 postfix:- (511844:tqdm_logging.py:145)
Step 687: grad_norm=4.438512325286865, loss=0.508199155330658, param_norm=1887.1158447265625
Step 688: grad_norm=4.191768169403076, loss=0.49544066190719604, param_norm=1887.1158447265625
11:28:38.204 [I] Progress on: 688it/1.00kit rate:8.8s/it remaining:45:34 elapsed:1:41:27 postfix:- (511844:tqdm_logging.py:145)
Step 689: grad_norm=7.181237697601318, loss=0.5357090830802917, param_norm=1887.115966796875
Step 690: grad_norm=4.6605024337768555, loss=0.5146862864494324, param_norm=1887.1160888671875
11:28:55.719 [I] Progress on: 690it/1.00kit rate:8.8s/it remaining:45:17 elapsed:1:41:45 postfix:- (511844:tqdm_logging.py:145)
Step 691: grad_norm=4.087274074554443, loss=0.5508670806884766, param_norm=1887.1162109375
Step 692: grad_norm=4.282321453094482, loss=0.5291973352432251, param_norm=1887.1162109375
11:29:13.221 [I] Progress on: 692it/1.00kit rate:8.8s/it remaining:44:59 elapsed:1:42:02 postfix:- (511844:tqdm_logging.py:145)
Step 693: grad_norm=5.125986576080322, loss=0.6031851768493652, param_norm=1887.1163330078125
Step 694: grad_norm=4.482712268829346, loss=0.550442099571228, param_norm=1887.1163330078125
11:29:30.734 [I] Progress on: 694it/1.00kit rate:8.8s/it remaining:44:42 elapsed:1:42:20 postfix:- (511844:tqdm_logging.py:145)
Step 695: grad_norm=4.337667942047119, loss=0.5544323921203613, param_norm=1887.116455078125
Step 696: grad_norm=4.381013870239258, loss=0.49971309304237366, param_norm=1887.1165771484375
11:29:48.233 [I] Progress on: 696it/1.00kit rate:8.8s/it remaining:44:23 elapsed:1:42:37 postfix:- (511844:tqdm_logging.py:145)
Step 697: grad_norm=5.859818458557129, loss=0.5323827862739563, param_norm=1887.1165771484375
Step 698: grad_norm=4.184837341308594, loss=0.43955570459365845, param_norm=1887.11669921875
11:30:05.751 [I] Progress on: 698it/1.00kit rate:8.8s/it remaining:44:07 elapsed:1:42:55 postfix:- (511844:tqdm_logging.py:145)
Step 699: grad_norm=5.2698516845703125, loss=0.5164486169815063, param_norm=1887.11669921875
Step 700: grad_norm=3.818896770477295, loss=0.4691687822341919, param_norm=1887.1168212890625
11:30:23.259 [I] Progress on: 700it/1.00kit rate:8.8s/it remaining:43:49 elapsed:1:43:12 postfix:- (511844:tqdm_logging.py:145)
11:30:23.375 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
11:30:23.375 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
11:30:23.376 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (511844:checkpoint_manager.py:1786)
11:30:23.376 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (511844:checkpoint_manager.py:1817)
11:30:23.376 [I] [process=0] Saving checkpoint at step 700                                        (511844:checkpoint_manager.py:1286)
11:30:23.377 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700. (511844:async_checkpointer.py:358)
11:30:23.378 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:30:23.378 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18 (511844:atomicity.py:144)
11:30:23.379 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:30:23.379 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:30:23.380 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (511844:atomicity.py:144)
11:30:23.380 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (511844:atomicity.py:144)
11:30:23.381 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:30:23.386 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
11:30:27.226 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
11:30:27.227 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:30:27.228 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
11:30:27.230 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
11:30:27.249 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:30:27.254 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:30:27.255 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:30:27.258 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:22.396378+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:30:27.262 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:03.323498+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:30:27.269 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:15:46.456779+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:30:27.271 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
11:30:27.273 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
11:30:27.276 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
11:30:27.277 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744126223.3755538, 'wait_for_prev_duration_secs': 0.0006711483001708984, 'checkpointer_blocking_start_time': 1744126223.3767798, 'checkpointer_blocking_duration_secs': 3.872612476348877, 'get_old_steps_start_time': 1744126227.249459, 'get_old_steps_duration_secs': 0.021564483642578125, 'checkpoint_manager_blocking_start_time': 1744126223.3753867, 'checkpoint_manager_blocking_duration_secs': 3.9018633365631104} (511844:standard_logger.py:34)
11:30:34.259 [I] ChainedFuture completed 1/1 futures in 7.02 seconds.                             (511844:future.py:137)
11:30:34.259 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 952.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:30:34.259 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
11:30:34.261 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18 (511844:async_checkpointer.py:406)
11:30:34.261 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18/assets (511844:atomicity.py:287)
11:30:34.272 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18/params (511844:atomicity.py:287)
11:30:34.272 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700 (511844:async_checkpointer.py:416)
11:30:34.272 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18 (511844:async_checkpointer.py:426)
11:30:34.273 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700 (511844:atomicity.py:287)
11:30:34.274 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/700`. (511844:atomicity.py:548)
11:30:34.274 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
11:30:34.274 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
11:30:34.275 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
11:30:34.275 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
11:30:34.275 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 701: grad_norm=4.16622257232666, loss=0.5473936796188354, param_norm=1887.1168212890625
11:30:35.846 [I] Progress on: 701it/1.00kit rate:9.9s/it remaining:49:25 elapsed:1:43:25 postfix:- (511844:tqdm_logging.py:145)
Step 702: grad_norm=3.377877950668335, loss=0.4582219123840332, param_norm=1887.116943359375
Step 703: grad_norm=5.737269401550293, loss=0.5844643115997314, param_norm=1887.116943359375
11:30:53.396 [I] Progress on: 703it/1.00kit rate:9.3s/it remaining:46:08 elapsed:1:43:43 postfix:- (511844:tqdm_logging.py:145)
Step 704: grad_norm=8.54951000213623, loss=0.5536613464355469, param_norm=1887.1170654296875
Step 705: grad_norm=4.8691792488098145, loss=0.5457937717437744, param_norm=1887.1170654296875
11:31:10.909 [I] Progress on: 705it/1.00kit rate:9.0s/it remaining:44:23 elapsed:1:44:00 postfix:- (511844:tqdm_logging.py:145)
Step 706: grad_norm=4.438469409942627, loss=0.5637755393981934, param_norm=1887.1171875
Step 707: grad_norm=4.195725917816162, loss=0.4992690682411194, param_norm=1887.1171875
11:31:28.405 [I] Progress on: 707it/1.00kit rate:8.9s/it remaining:43:22 elapsed:1:44:18 postfix:- (511844:tqdm_logging.py:145)
Step 708: grad_norm=4.637912273406982, loss=0.5423522591590881, param_norm=1887.1173095703125
Step 709: grad_norm=6.800676345825195, loss=0.5840986967086792, param_norm=1887.117431640625
11:31:45.900 [I] Progress on: 709it/1.00kit rate:8.8s/it remaining:42:42 elapsed:1:44:35 postfix:- (511844:tqdm_logging.py:145)
Step 710: grad_norm=5.559598922729492, loss=0.4884679317474365, param_norm=1887.117431640625
Step 711: grad_norm=3.890571355819702, loss=0.4163609445095062, param_norm=1887.117431640625
11:32:03.408 [I] Progress on: 711it/1.00kit rate:8.8s/it remaining:42:15 elapsed:1:44:53 postfix:- (511844:tqdm_logging.py:145)
Step 712: grad_norm=3.7047481536865234, loss=0.4905815124511719, param_norm=1887.1175537109375
Step 713: grad_norm=4.648467540740967, loss=0.5628955960273743, param_norm=1887.11767578125
11:32:20.907 [I] Progress on: 713it/1.00kit rate:8.8s/it remaining:41:52 elapsed:1:45:10 postfix:- (511844:tqdm_logging.py:145)
Step 714: grad_norm=4.365867614746094, loss=0.5341697931289673, param_norm=1887.11767578125
Step 715: grad_norm=4.001099109649658, loss=0.5638615489006042, param_norm=1887.1177978515625
11:32:38.419 [I] Progress on: 715it/1.00kit rate:8.8s/it remaining:41:34 elapsed:1:45:28 postfix:- (511844:tqdm_logging.py:145)
Step 716: grad_norm=4.204957962036133, loss=0.5429917573928833, param_norm=1887.1177978515625
Step 717: grad_norm=4.994081974029541, loss=0.5184240341186523, param_norm=1887.117919921875
11:32:55.917 [I] Progress on: 717it/1.00kit rate:8.7s/it remaining:41:14 elapsed:1:45:45 postfix:- (511844:tqdm_logging.py:145)
Step 718: grad_norm=5.975399971008301, loss=0.5641187429428101, param_norm=1887.1180419921875
Step 719: grad_norm=5.482721328735352, loss=0.6495135426521301, param_norm=1887.1180419921875
11:33:13.432 [I] Progress on: 719it/1.00kit rate:8.7s/it remaining:40:57 elapsed:1:46:03 postfix:- (511844:tqdm_logging.py:145)
Step 720: grad_norm=4.181623458862305, loss=0.5205041170120239, param_norm=1887.1181640625
Step 721: grad_norm=5.67909049987793, loss=0.463837206363678, param_norm=1887.1181640625
11:33:31.155 [I] Progress on: 721it/1.00kit rate:8.8s/it remaining:40:57 elapsed:1:46:20 postfix:- (511844:tqdm_logging.py:145)
Step 722: grad_norm=5.767751216888428, loss=0.4380653500556946, param_norm=1887.1182861328125
Step 723: grad_norm=5.976130962371826, loss=0.5725382566452026, param_norm=1887.1182861328125
11:33:48.687 [I] Progress on: 723it/1.00kit rate:8.8s/it remaining:40:32 elapsed:1:46:38 postfix:- (511844:tqdm_logging.py:145)
Step 724: grad_norm=4.6718549728393555, loss=0.5252366065979004, param_norm=1887.1182861328125
Step 725: grad_norm=4.458508491516113, loss=0.4978696405887604, param_norm=1887.1182861328125
11:34:06.169 [I] Progress on: 725it/1.00kit rate:8.8s/it remaining:40:08 elapsed:1:46:55 postfix:- (511844:tqdm_logging.py:145)
Step 726: grad_norm=3.8730926513671875, loss=0.43706831336021423, param_norm=1887.118408203125
Step 727: grad_norm=4.9994916915893555, loss=0.541115403175354, param_norm=1887.118408203125
11:34:23.665 [I] Progress on: 727it/1.00kit rate:8.7s/it remaining:39:48 elapsed:1:47:13 postfix:- (511844:tqdm_logging.py:145)
Step 728: grad_norm=4.274661540985107, loss=0.4918278157711029, param_norm=1887.118408203125
Step 729: grad_norm=5.740635395050049, loss=0.5890783667564392, param_norm=1887.1185302734375
11:34:41.135 [I] Progress on: 729it/1.00kit rate:8.7s/it remaining:39:28 elapsed:1:47:30 postfix:- (511844:tqdm_logging.py:145)
Step 730: grad_norm=4.219621181488037, loss=0.49974367022514343, param_norm=1887.1185302734375
Step 731: grad_norm=9.518860816955566, loss=0.5415074229240417, param_norm=1887.11865234375
11:34:58.609 [I] Progress on: 731it/1.00kit rate:8.7s/it remaining:39:09 elapsed:1:47:48 postfix:- (511844:tqdm_logging.py:145)
Step 732: grad_norm=4.155426979064941, loss=0.4454420208930969, param_norm=1887.11865234375
Step 733: grad_norm=4.732354640960693, loss=0.6071925163269043, param_norm=1887.1187744140625
11:35:16.053 [I] Progress on: 733it/1.00kit rate:8.7s/it remaining:38:49 elapsed:1:48:05 postfix:- (511844:tqdm_logging.py:145)
Step 734: grad_norm=5.016558647155762, loss=0.5772781372070312, param_norm=1887.11865234375
Step 735: grad_norm=6.152792453765869, loss=0.5196653604507446, param_norm=1887.118896484375
11:35:33.517 [I] Progress on: 735it/1.00kit rate:8.7s/it remaining:38:31 elapsed:1:48:23 postfix:- (511844:tqdm_logging.py:145)
Step 736: grad_norm=4.639432907104492, loss=0.5561171770095825, param_norm=1887.1190185546875
Step 737: grad_norm=3.758687973022461, loss=0.5424720048904419, param_norm=1887.1190185546875
11:35:50.981 [I] Progress on: 737it/1.00kit rate:8.7s/it remaining:38:13 elapsed:1:48:40 postfix:- (511844:tqdm_logging.py:145)
Step 738: grad_norm=6.51511812210083, loss=0.616571843624115, param_norm=1887.1190185546875
Step 739: grad_norm=4.325673580169678, loss=0.45806625485420227, param_norm=1887.119140625
11:36:08.478 [I] Progress on: 739it/1.00kit rate:8.7s/it remaining:37:57 elapsed:1:48:58 postfix:- (511844:tqdm_logging.py:145)
Step 740: grad_norm=4.021739959716797, loss=0.5207221508026123, param_norm=1887.119140625
Step 741: grad_norm=4.367175579071045, loss=0.5210161805152893, param_norm=1887.119140625
11:36:25.975 [I] Progress on: 741it/1.00kit rate:8.7s/it remaining:37:41 elapsed:1:49:15 postfix:- (511844:tqdm_logging.py:145)
Step 742: grad_norm=4.142541408538818, loss=0.4665777385234833, param_norm=1887.1192626953125
Step 743: grad_norm=4.576772212982178, loss=0.5351120233535767, param_norm=1887.1192626953125
11:36:43.491 [I] Progress on: 743it/1.00kit rate:8.7s/it remaining:37:25 elapsed:1:49:33 postfix:- (511844:tqdm_logging.py:145)
Step 744: grad_norm=5.4719390869140625, loss=0.5864473581314087, param_norm=1887.1192626953125
Step 745: grad_norm=5.369652271270752, loss=0.5543873310089111, param_norm=1887.119384765625
11:37:00.990 [I] Progress on: 745it/1.00kit rate:8.7s/it remaining:37:08 elapsed:1:49:50 postfix:- (511844:tqdm_logging.py:145)
Step 746: grad_norm=6.973748683929443, loss=0.503945529460907, param_norm=1887.119384765625
Step 747: grad_norm=5.675913333892822, loss=0.48795002698898315, param_norm=1887.119384765625
11:37:18.512 [I] Progress on: 747it/1.00kit rate:8.7s/it remaining:36:52 elapsed:1:50:08 postfix:- (511844:tqdm_logging.py:145)
Step 748: grad_norm=3.7176733016967773, loss=0.4695269465446472, param_norm=1887.119384765625
Step 749: grad_norm=4.473545551300049, loss=0.45047152042388916, param_norm=1887.1195068359375
11:37:36.039 [I] Progress on: 749it/1.00kit rate:8.7s/it remaining:36:35 elapsed:1:50:25 postfix:- (511844:tqdm_logging.py:145)
Step 750: grad_norm=9.362910270690918, loss=0.5115236043930054, param_norm=1887.1195068359375
Step 751: grad_norm=9.38731575012207, loss=0.49665215611457825, param_norm=1887.1195068359375
11:37:53.585 [I] Progress on: 751it/1.00kit rate:8.8s/it remaining:36:19 elapsed:1:50:43 postfix:- (511844:tqdm_logging.py:145)
Step 752: grad_norm=4.231957912445068, loss=0.49430957436561584, param_norm=1887.1195068359375
Step 753: grad_norm=4.537919998168945, loss=0.523303210735321, param_norm=1887.11962890625
11:38:11.113 [I] Progress on: 753it/1.00kit rate:8.8s/it remaining:36:01 elapsed:1:51:00 postfix:- (511844:tqdm_logging.py:145)
Step 754: grad_norm=5.1023383140563965, loss=0.5928901433944702, param_norm=1887.11962890625
Step 755: grad_norm=5.698446750640869, loss=0.470750629901886, param_norm=1887.1197509765625
11:38:28.664 [I] Progress on: 755it/1.00kit rate:8.8s/it remaining:35:45 elapsed:1:51:18 postfix:- (511844:tqdm_logging.py:145)
Step 756: grad_norm=4.628464698791504, loss=0.5351964831352234, param_norm=1887.1197509765625
11:38:39.748 [I] Progress on: 756it/1.00kit rate:9.5s/it remaining:38:28 elapsed:1:51:29 postfix:- (511844:tqdm_logging.py:145)
Step 757: grad_norm=3.264568567276001, loss=0.422843337059021, param_norm=1887.1197509765625
Step 758: grad_norm=3.484884738922119, loss=0.4536914527416229, param_norm=1887.1197509765625
11:38:57.264 [I] Progress on: 758it/1.00kit rate:9.1s/it remaining:36:42 elapsed:1:51:46 postfix:- (511844:tqdm_logging.py:145)
Step 759: grad_norm=4.837576866149902, loss=0.5099983215332031, param_norm=1887.119873046875
Step 760: grad_norm=5.517549514770508, loss=0.5116614103317261, param_norm=1887.1199951171875
11:39:14.792 [I] Progress on: 760it/1.00kit rate:8.9s/it remaining:35:42 elapsed:1:52:04 postfix:- (511844:tqdm_logging.py:145)
Step 761: grad_norm=15.204704284667969, loss=0.5105763673782349, param_norm=1887.1199951171875
Step 762: grad_norm=3.801452875137329, loss=0.39645349979400635, param_norm=1887.1199951171875
11:39:32.309 [I] Progress on: 762it/1.00kit rate:8.8s/it remaining:35:04 elapsed:1:52:21 postfix:- (511844:tqdm_logging.py:145)
Step 763: grad_norm=4.185940265655518, loss=0.4463226795196533, param_norm=1887.1201171875
Step 764: grad_norm=4.537254333496094, loss=0.43236541748046875, param_norm=1887.1201171875
11:39:49.827 [I] Progress on: 764it/1.00kit rate:8.8s/it remaining:34:36 elapsed:1:52:39 postfix:- (511844:tqdm_logging.py:145)
Step 765: grad_norm=4.273838520050049, loss=0.4202308654785156, param_norm=1887.1201171875
Step 766: grad_norm=4.073115348815918, loss=0.4688428044319153, param_norm=1887.1201171875
11:40:07.345 [I] Progress on: 766it/1.00kit rate:8.8s/it remaining:34:13 elapsed:1:52:56 postfix:- (511844:tqdm_logging.py:145)
Step 767: grad_norm=4.399636268615723, loss=0.4311828017234802, param_norm=1887.1202392578125
Step 768: grad_norm=4.096429824829102, loss=0.4497811794281006, param_norm=1887.1202392578125
11:40:24.873 [I] Progress on: 768it/1.00kit rate:8.8s/it remaining:33:54 elapsed:1:53:14 postfix:- (511844:tqdm_logging.py:145)
Step 769: grad_norm=4.231533527374268, loss=0.44373804330825806, param_norm=1887.120361328125
Step 770: grad_norm=3.7260167598724365, loss=0.4525734782218933, param_norm=1887.120361328125
11:40:42.386 [I] Progress on: 770it/1.00kit rate:8.8s/it remaining:33:35 elapsed:1:53:32 postfix:- (511844:tqdm_logging.py:145)
Step 771: grad_norm=4.671848297119141, loss=0.4758305549621582, param_norm=1887.120361328125
Step 772: grad_norm=3.3947668075561523, loss=0.43395668268203735, param_norm=1887.1204833984375
11:40:59.919 [I] Progress on: 772it/1.00kit rate:8.8s/it remaining:33:18 elapsed:1:53:49 postfix:- (511844:tqdm_logging.py:145)
Step 773: grad_norm=3.304582118988037, loss=0.4435596168041229, param_norm=1887.12060546875
Step 774: grad_norm=3.9002954959869385, loss=0.5096611976623535, param_norm=1887.12060546875
11:41:17.439 [I] Progress on: 774it/1.00kit rate:8.8s/it remaining:33:00 elapsed:1:54:07 postfix:- (511844:tqdm_logging.py:145)
Step 775: grad_norm=3.9349658489227295, loss=0.45476412773132324, param_norm=1887.1207275390625
Step 776: grad_norm=3.231722116470337, loss=0.3740795850753784, param_norm=1887.120849609375
11:41:34.961 [I] Progress on: 776it/1.00kit rate:8.8s/it remaining:32:42 elapsed:1:54:24 postfix:- (511844:tqdm_logging.py:145)
Step 777: grad_norm=3.6450679302215576, loss=0.4611712396144867, param_norm=1887.120849609375
Step 778: grad_norm=4.154983997344971, loss=0.5297442674636841, param_norm=1887.120849609375
11:41:52.471 [I] Progress on: 778it/1.00kit rate:8.8s/it remaining:32:24 elapsed:1:54:42 postfix:- (511844:tqdm_logging.py:145)
Step 779: grad_norm=4.8072829246521, loss=0.4600333571434021, param_norm=1887.120849609375
Step 780: grad_norm=4.027288436889648, loss=0.43008333444595337, param_norm=1887.1209716796875
11:42:09.995 [I] Progress on: 780it/1.00kit rate:8.8s/it remaining:32:06 elapsed:1:54:59 postfix:- (511844:tqdm_logging.py:145)
Step 781: grad_norm=4.412654876708984, loss=0.3948606252670288, param_norm=1887.1209716796875
Step 782: grad_norm=4.372406959533691, loss=0.46451953053474426, param_norm=1887.12109375
11:42:27.530 [I] Progress on: 782it/1.00kit rate:8.8s/it remaining:31:49 elapsed:1:55:17 postfix:- (511844:tqdm_logging.py:145)
Step 783: grad_norm=3.8428335189819336, loss=0.42510420083999634, param_norm=1887.12109375
Step 784: grad_norm=3.456298351287842, loss=0.43659865856170654, param_norm=1887.12109375
11:42:45.061 [I] Progress on: 784it/1.00kit rate:8.8s/it remaining:31:32 elapsed:1:55:34 postfix:- (511844:tqdm_logging.py:145)
Step 785: grad_norm=4.633908748626709, loss=0.4691101610660553, param_norm=1887.1212158203125
Step 786: grad_norm=4.43745231628418, loss=0.5326669216156006, param_norm=1887.1212158203125
11:43:02.597 [I] Progress on: 786it/1.00kit rate:8.8s/it remaining:31:15 elapsed:1:55:52 postfix:- (511844:tqdm_logging.py:145)
Step 787: grad_norm=4.570842742919922, loss=0.42889052629470825, param_norm=1887.121337890625
Step 788: grad_norm=4.242878437042236, loss=0.46709686517715454, param_norm=1887.121337890625
11:43:20.127 [I] Progress on: 788it/1.00kit rate:8.8s/it remaining:30:58 elapsed:1:56:09 postfix:- (511844:tqdm_logging.py:145)
Step 789: grad_norm=3.917982339859009, loss=0.41249868273735046, param_norm=1887.121337890625
Step 790: grad_norm=3.5545191764831543, loss=0.4168170094490051, param_norm=1887.121337890625
11:43:37.664 [I] Progress on: 790it/1.00kit rate:8.8s/it remaining:30:40 elapsed:1:56:27 postfix:- (511844:tqdm_logging.py:145)
Step 791: grad_norm=4.645637512207031, loss=0.4611343741416931, param_norm=1887.1214599609375
Step 792: grad_norm=4.094398498535156, loss=0.4528205394744873, param_norm=1887.1214599609375
11:43:55.496 [I] Progress on: 792it/1.00kit rate:8.9s/it remaining:30:42 elapsed:1:56:45 postfix:- (511844:tqdm_logging.py:145)
Step 793: grad_norm=5.605384826660156, loss=0.5255791544914246, param_norm=1887.1214599609375
Step 794: grad_norm=4.153675556182861, loss=0.47233685851097107, param_norm=1887.12158203125
11:44:13.041 [I] Progress on: 794it/1.00kit rate:8.8s/it remaining:30:14 elapsed:1:57:02 postfix:- (511844:tqdm_logging.py:145)
Step 795: grad_norm=3.933140277862549, loss=0.4381057918071747, param_norm=1887.12158203125
Step 796: grad_norm=4.328850746154785, loss=0.45442456007003784, param_norm=1887.12158203125
11:44:30.585 [I] Progress on: 796it/1.00kit rate:8.8s/it remaining:29:53 elapsed:1:57:20 postfix:- (511844:tqdm_logging.py:145)
Step 797: grad_norm=4.776831150054932, loss=0.4763734042644501, param_norm=1887.1217041015625
Step 798: grad_norm=3.5405030250549316, loss=0.392716646194458, param_norm=1887.1217041015625
11:44:48.125 [I] Progress on: 798it/1.00kit rate:8.8s/it remaining:29:33 elapsed:1:57:37 postfix:- (511844:tqdm_logging.py:145)
Step 799: grad_norm=7.007660388946533, loss=0.44786199927330017, param_norm=1887.1217041015625
Step 800: grad_norm=3.8171775341033936, loss=0.35562369227409363, param_norm=1887.121826171875
11:45:05.661 [I] Progress on: 800it/1.00kit rate:8.8s/it remaining:29:14 elapsed:1:57:55 postfix:- (511844:tqdm_logging.py:145)
11:45:05.837 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
11:45:05.837 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
11:45:05.837 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (511844:checkpoint_manager.py:1786)
11:45:05.837 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (511844:checkpoint_manager.py:1817)
11:45:05.838 [I] [process=0] Saving checkpoint at step 800                                        (511844:checkpoint_manager.py:1286)
11:45:05.838 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800. (511844:async_checkpointer.py:358)
11:45:05.839 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:45:05.840 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21 (511844:atomicity.py:144)
11:45:05.840 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:45:05.841 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:45:05.842 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (511844:atomicity.py:144)
11:45:05.842 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (511844:atomicity.py:144)
11:45:05.843 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:45:05.847 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
11:45:10.004 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
11:45:10.006 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:45:10.007 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
11:45:10.011 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
11:45:10.039 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.043 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.046 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.046 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:22.396378+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.047 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:03.323498+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.047 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:15:46.456779+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.047 [I] Preserving Checkpoint[step=700 | time=2025-04-08 15:30:27.249410+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:45:10.048 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
11:45:10.048 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
11:45:10.051 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
11:45:10.053 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744127105.8370132, 'wait_for_prev_duration_secs': 0.0006101131439208984, 'checkpointer_blocking_start_time': 1744127105.838147, 'checkpointer_blocking_duration_secs': 4.201458692550659, 'get_old_steps_start_time': 1744127110.0397534, 'get_old_steps_duration_secs': 0.008295774459838867, 'checkpoint_manager_blocking_start_time': 1744127105.83685, 'checkpoint_manager_blocking_duration_secs': 4.2159953117370605} (511844:standard_logger.py:34)
11:45:18.430 [I] ChainedFuture completed 1/1 futures in 8.41 seconds.                             (511844:future.py:137)
11:45:18.431 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 823.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:45:18.431 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
11:45:18.433 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21 (511844:async_checkpointer.py:406)
11:45:18.433 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21/assets (511844:atomicity.py:287)
11:45:18.443 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21/params (511844:atomicity.py:287)
11:45:18.444 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800 (511844:async_checkpointer.py:416)
11:45:18.444 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21 (511844:async_checkpointer.py:426)
11:45:18.444 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800 (511844:atomicity.py:287)
11:45:18.446 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/800`. (511844:atomicity.py:548)
11:45:18.446 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
11:45:18.447 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
11:45:18.447 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
11:45:18.447 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
11:45:18.448 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 801: grad_norm=4.479187965393066, loss=0.47298914194107056, param_norm=1887.121826171875
11:45:18.650 [I] Progress on: 801it/1.00kit rate:10.0s/it remaining:33:18 elapsed:1:58:08 postfix:- (511844:tqdm_logging.py:145)
Step 802: grad_norm=4.195344924926758, loss=0.4518221914768219, param_norm=1887.121826171875
Step 803: grad_norm=3.69303560256958, loss=0.3799179792404175, param_norm=1887.121826171875
11:45:36.200 [I] Progress on: 803it/1.00kit rate:9.4s/it remaining:30:51 elapsed:1:58:25 postfix:- (511844:tqdm_logging.py:145)
Step 804: grad_norm=4.226973533630371, loss=0.475212037563324, param_norm=1887.121826171875
Step 805: grad_norm=3.424316644668579, loss=0.42902591824531555, param_norm=1887.121826171875
11:45:53.734 [I] Progress on: 805it/1.00kit rate:9.1s/it remaining:29:29 elapsed:1:58:43 postfix:- (511844:tqdm_logging.py:145)
Step 806: grad_norm=3.872246742248535, loss=0.4133278727531433, param_norm=1887.121826171875
Step 807: grad_norm=4.457517623901367, loss=0.46250492334365845, param_norm=1887.1219482421875
11:46:11.287 [I] Progress on: 807it/1.00kit rate:8.9s/it remaining:28:42 elapsed:1:59:00 postfix:- (511844:tqdm_logging.py:145)
Step 808: grad_norm=3.3901376724243164, loss=0.4527815878391266, param_norm=1887.1220703125
Step 809: grad_norm=3.690638780593872, loss=0.4502182900905609, param_norm=1887.1220703125
11:46:29.177 [I] Progress on: 809it/1.00kit rate:8.8s/it remaining:28:09 elapsed:1:59:18 postfix:- (511844:tqdm_logging.py:145)
Step 810: grad_norm=4.701054573059082, loss=0.48561084270477295, param_norm=1887.1220703125
Step 811: grad_norm=6.21235466003418, loss=0.4221097230911255, param_norm=1887.1220703125
11:46:46.734 [I] Progress on: 811it/1.00kit rate:8.9s/it remaining:27:59 elapsed:1:59:36 postfix:- (511844:tqdm_logging.py:145)
Step 812: grad_norm=3.83447265625, loss=0.5079624056816101, param_norm=1887.1220703125
Step 813: grad_norm=3.734117269515991, loss=0.392525315284729, param_norm=1887.1220703125
11:47:04.278 [I] Progress on: 813it/1.00kit rate:8.8s/it remaining:27:30 elapsed:1:59:53 postfix:- (511844:tqdm_logging.py:145)
Step 814: grad_norm=3.878629684448242, loss=0.4322727918624878, param_norm=1887.1220703125
Step 815: grad_norm=3.6476919651031494, loss=0.39508163928985596, param_norm=1887.1221923828125
11:47:21.843 [I] Progress on: 815it/1.00kit rate:8.8s/it remaining:27:09 elapsed:2:00:11 postfix:- (511844:tqdm_logging.py:145)
Step 816: grad_norm=3.4129674434661865, loss=0.41572555899620056, param_norm=1887.122314453125
Step 817: grad_norm=3.5765938758850098, loss=0.42377087473869324, param_norm=1887.122314453125
11:47:39.383 [I] Progress on: 817it/1.00kit rate:8.8s/it remaining:26:48 elapsed:2:00:29 postfix:- (511844:tqdm_logging.py:145)
Step 818: grad_norm=4.021627426147461, loss=0.49654078483581543, param_norm=1887.122314453125
Step 819: grad_norm=4.13516902923584, loss=0.48113366961479187, param_norm=1887.122314453125
11:47:56.937 [I] Progress on: 819it/1.00kit rate:8.8s/it remaining:26:29 elapsed:2:00:46 postfix:- (511844:tqdm_logging.py:145)
Step 820: grad_norm=4.072702407836914, loss=0.47942915558815, param_norm=1887.122314453125
Step 821: grad_norm=3.1999905109405518, loss=0.37083616852760315, param_norm=1887.122314453125
11:48:14.503 [I] Progress on: 821it/1.00kit rate:8.8s/it remaining:26:12 elapsed:2:01:04 postfix:- (511844:tqdm_logging.py:145)
Step 822: grad_norm=3.8551485538482666, loss=0.44145137071609497, param_norm=1887.1224365234375
Step 823: grad_norm=4.700534820556641, loss=0.48292720317840576, param_norm=1887.1224365234375
11:48:32.070 [I] Progress on: 823it/1.00kit rate:8.8s/it remaining:25:54 elapsed:2:01:21 postfix:- (511844:tqdm_logging.py:145)
Step 824: grad_norm=7.072140693664551, loss=0.35252004861831665, param_norm=1887.12255859375
Step 825: grad_norm=5.359974384307861, loss=0.46667757630348206, param_norm=1887.12255859375
11:48:49.635 [I] Progress on: 825it/1.00kit rate:8.8s/it remaining:25:37 elapsed:2:01:39 postfix:- (511844:tqdm_logging.py:145)
Step 826: grad_norm=3.5867207050323486, loss=0.47302109003067017, param_norm=1887.12255859375
Step 827: grad_norm=3.507718563079834, loss=0.409234881401062, param_norm=1887.12255859375
11:49:07.201 [I] Progress on: 827it/1.00kit rate:8.8s/it remaining:25:19 elapsed:2:01:56 postfix:- (511844:tqdm_logging.py:145)
Step 828: grad_norm=3.984959602355957, loss=0.4665997326374054, param_norm=1887.12255859375
Step 829: grad_norm=5.321636199951172, loss=0.5048600435256958, param_norm=1887.1226806640625
11:49:24.777 [I] Progress on: 829it/1.00kit rate:8.8s/it remaining:25:02 elapsed:2:02:14 postfix:- (511844:tqdm_logging.py:145)
Step 830: grad_norm=5.969319820404053, loss=0.4667365550994873, param_norm=1887.1226806640625
Step 831: grad_norm=4.162082672119141, loss=0.4423084259033203, param_norm=1887.1226806640625
11:49:42.349 [I] Progress on: 831it/1.00kit rate:8.8s/it remaining:24:45 elapsed:2:02:31 postfix:- (511844:tqdm_logging.py:145)
Step 832: grad_norm=5.334929943084717, loss=0.4365401864051819, param_norm=1887.1226806640625
Step 833: grad_norm=4.143948554992676, loss=0.47437185049057007, param_norm=1887.1226806640625
11:49:59.906 [I] Progress on: 833it/1.00kit rate:8.8s/it remaining:24:27 elapsed:2:02:49 postfix:- (511844:tqdm_logging.py:145)
Step 834: grad_norm=3.768594741821289, loss=0.388807088136673, param_norm=1887.1226806640625
Step 835: grad_norm=7.58555269241333, loss=0.4824475347995758, param_norm=1887.122802734375
11:50:17.469 [I] Progress on: 835it/1.00kit rate:8.8s/it remaining:24:09 elapsed:2:03:07 postfix:- (511844:tqdm_logging.py:145)
Step 836: grad_norm=4.184576988220215, loss=0.4681525230407715, param_norm=1887.122802734375
Step 837: grad_norm=5.1772918701171875, loss=0.4482358396053314, param_norm=1887.122802734375
11:50:35.053 [I] Progress on: 837it/1.00kit rate:8.8s/it remaining:23:52 elapsed:2:03:24 postfix:- (511844:tqdm_logging.py:145)
Step 838: grad_norm=4.469584941864014, loss=0.43732282519340515, param_norm=1887.122802734375
Step 839: grad_norm=4.63427209854126, loss=0.33211272954940796, param_norm=1887.122802734375
11:50:52.615 [I] Progress on: 839it/1.00kit rate:8.8s/it remaining:23:34 elapsed:2:03:42 postfix:- (511844:tqdm_logging.py:145)
Step 840: grad_norm=3.82672381401062, loss=0.3688858449459076, param_norm=1887.122802734375
11:51:03.791 [I] Progress on: 840it/1.00kit rate:9.5s/it remaining:25:21 elapsed:2:03:53 postfix:- (511844:tqdm_logging.py:145)
Step 841: grad_norm=3.3580868244171143, loss=0.4447096288204193, param_norm=1887.1229248046875
Step 842: grad_norm=3.610812187194824, loss=0.3528091013431549, param_norm=1887.1229248046875
11:51:21.357 [I] Progress on: 842it/1.00kit rate:9.1s/it remaining:24:04 elapsed:2:04:10 postfix:- (511844:tqdm_logging.py:145)
Step 843: grad_norm=2.8290607929229736, loss=0.3812141418457031, param_norm=1887.1229248046875
Step 844: grad_norm=3.3585402965545654, loss=0.40499475598335266, param_norm=1887.1229248046875
11:51:38.915 [I] Progress on: 844it/1.00kit rate:9.0s/it remaining:23:18 elapsed:2:04:28 postfix:- (511844:tqdm_logging.py:145)
Step 845: grad_norm=3.62249755859375, loss=0.37901586294174194, param_norm=1887.123046875
Step 846: grad_norm=4.4333696365356445, loss=0.3446023166179657, param_norm=1887.123046875
11:51:56.479 [I] Progress on: 846it/1.00kit rate:8.9s/it remaining:22:47 elapsed:2:04:46 postfix:- (511844:tqdm_logging.py:145)
Step 847: grad_norm=2.9205212593078613, loss=0.39052367210388184, param_norm=1887.123046875
Step 848: grad_norm=4.3885698318481445, loss=0.3818954825401306, param_norm=1887.123046875
11:52:14.047 [I] Progress on: 848it/1.00kit rate:8.8s/it remaining:22:23 elapsed:2:05:03 postfix:- (511844:tqdm_logging.py:145)
Step 849: grad_norm=3.754317045211792, loss=0.4376392364501953, param_norm=1887.1231689453125
Step 850: grad_norm=3.1830296516418457, loss=0.376248836517334, param_norm=1887.123046875
11:52:31.579 [I] Progress on: 850it/1.00kit rate:8.8s/it remaining:22:00 elapsed:2:05:21 postfix:- (511844:tqdm_logging.py:145)
Step 851: grad_norm=5.4193549156188965, loss=0.38559630513191223, param_norm=1887.123046875
Step 852: grad_norm=4.913121700286865, loss=0.36663973331451416, param_norm=1887.1231689453125
11:52:49.089 [I] Progress on: 852it/1.00kit rate:8.8s/it remaining:21:40 elapsed:2:05:38 postfix:- (511844:tqdm_logging.py:145)
Step 853: grad_norm=5.839801788330078, loss=0.4108145236968994, param_norm=1887.123291015625
Step 854: grad_norm=3.9984264373779297, loss=0.44762110710144043, param_norm=1887.123291015625
11:53:06.619 [I] Progress on: 854it/1.00kit rate:8.8s/it remaining:21:21 elapsed:2:05:56 postfix:- (511844:tqdm_logging.py:145)
Step 855: grad_norm=3.339052200317383, loss=0.38739100098609924, param_norm=1887.1231689453125
Step 856: grad_norm=4.067869186401367, loss=0.38846105337142944, param_norm=1887.1231689453125
11:53:24.136 [I] Progress on: 856it/1.00kit rate:8.8s/it remaining:21:03 elapsed:2:06:13 postfix:- (511844:tqdm_logging.py:145)
Step 857: grad_norm=3.6043059825897217, loss=0.3326765298843384, param_norm=1887.1231689453125
Step 858: grad_norm=3.4271955490112305, loss=0.37146517634391785, param_norm=1887.123291015625
11:53:41.665 [I] Progress on: 858it/1.00kit rate:8.8s/it remaining:20:45 elapsed:2:06:31 postfix:- (511844:tqdm_logging.py:145)
Step 859: grad_norm=3.717439651489258, loss=0.385334849357605, param_norm=1887.123291015625
Step 860: grad_norm=4.395003318786621, loss=0.4448803663253784, param_norm=1887.123291015625
11:53:59.174 [I] Progress on: 860it/1.00kit rate:8.8s/it remaining:20:27 elapsed:2:06:48 postfix:- (511844:tqdm_logging.py:145)
Step 861: grad_norm=4.205632209777832, loss=0.3842056691646576, param_norm=1887.1234130859375
Step 862: grad_norm=3.37873911857605, loss=0.2908066511154175, param_norm=1887.1234130859375
11:54:16.709 [I] Progress on: 862it/1.00kit rate:8.8s/it remaining:20:10 elapsed:2:07:06 postfix:- (511844:tqdm_logging.py:145)
Step 863: grad_norm=3.609520196914673, loss=0.37588822841644287, param_norm=1887.1234130859375
Step 864: grad_norm=3.798860549926758, loss=0.37091749906539917, param_norm=1887.1234130859375
11:54:34.224 [I] Progress on: 864it/1.00kit rate:8.8s/it remaining:19:52 elapsed:2:07:23 postfix:- (511844:tqdm_logging.py:145)
Step 865: grad_norm=4.052302360534668, loss=0.3748208284378052, param_norm=1887.12353515625
Step 866: grad_norm=4.637388229370117, loss=0.4317370057106018, param_norm=1887.12353515625
11:54:51.754 [I] Progress on: 866it/1.00kit rate:8.8s/it remaining:19:35 elapsed:2:07:41 postfix:- (511844:tqdm_logging.py:145)
Step 867: grad_norm=3.09855580329895, loss=0.3516632318496704, param_norm=1887.12353515625
Step 868: grad_norm=5.9319586753845215, loss=0.3756813406944275, param_norm=1887.12353515625
11:55:09.269 [I] Progress on: 868it/1.00kit rate:8.8s/it remaining:19:17 elapsed:2:07:58 postfix:- (511844:tqdm_logging.py:145)
Step 869: grad_norm=5.127919673919678, loss=0.4642520844936371, param_norm=1887.1236572265625
Step 870: grad_norm=3.507049560546875, loss=0.4345575273036957, param_norm=1887.1236572265625
11:55:26.802 [I] Progress on: 870it/1.00kit rate:8.8s/it remaining:19:00 elapsed:2:08:16 postfix:- (511844:tqdm_logging.py:145)
Step 871: grad_norm=3.6257553100585938, loss=0.4135526418685913, param_norm=1887.1236572265625
Step 872: grad_norm=3.8791141510009766, loss=0.3957374393939972, param_norm=1887.1236572265625
11:55:44.336 [I] Progress on: 872it/1.00kit rate:8.8s/it remaining:18:42 elapsed:2:08:33 postfix:- (511844:tqdm_logging.py:145)
Step 873: grad_norm=3.463000774383545, loss=0.32210609316825867, param_norm=1887.1236572265625
Step 874: grad_norm=3.0757436752319336, loss=0.35041069984436035, param_norm=1887.1236572265625
11:56:01.872 [I] Progress on: 874it/1.00kit rate:8.8s/it remaining:18:25 elapsed:2:08:51 postfix:- (511844:tqdm_logging.py:145)
Step 875: grad_norm=2.946058988571167, loss=0.34525835514068604, param_norm=1887.1236572265625
Step 876: grad_norm=3.3370285034179688, loss=0.390566349029541, param_norm=1887.123779296875
11:56:19.390 [I] Progress on: 876it/1.00kit rate:8.8s/it remaining:18:07 elapsed:2:09:09 postfix:- (511844:tqdm_logging.py:145)
Step 877: grad_norm=4.065977573394775, loss=0.40514248609542847, param_norm=1887.123779296875
Step 878: grad_norm=3.971666097640991, loss=0.413272500038147, param_norm=1887.123779296875
11:56:36.925 [I] Progress on: 878it/1.00kit rate:8.8s/it remaining:17:50 elapsed:2:09:26 postfix:- (511844:tqdm_logging.py:145)
Step 879: grad_norm=3.91652250289917, loss=0.3733638525009155, param_norm=1887.123779296875
Step 880: grad_norm=4.208927631378174, loss=0.413310706615448, param_norm=1887.123779296875
11:56:54.451 [I] Progress on: 880it/1.00kit rate:8.8s/it remaining:17:32 elapsed:2:09:44 postfix:- (511844:tqdm_logging.py:145)
Step 881: grad_norm=3.9476962089538574, loss=0.4314386546611786, param_norm=1887.1239013671875
Step 882: grad_norm=3.3958771228790283, loss=0.36490529775619507, param_norm=1887.123779296875
11:57:11.984 [I] Progress on: 882it/1.00kit rate:8.8s/it remaining:17:15 elapsed:2:10:01 postfix:- (511844:tqdm_logging.py:145)
Step 883: grad_norm=3.914184093475342, loss=0.3952919542789459, param_norm=1887.1239013671875
Step 884: grad_norm=3.4470417499542236, loss=0.36381345987319946, param_norm=1887.1239013671875
11:57:29.518 [I] Progress on: 884it/1.00kit rate:8.8s/it remaining:16:57 elapsed:2:10:19 postfix:- (511844:tqdm_logging.py:145)
Step 885: grad_norm=3.233238697052002, loss=0.37662556767463684, param_norm=1887.1239013671875
Step 886: grad_norm=3.5733442306518555, loss=0.418567419052124, param_norm=1887.1239013671875
11:57:47.058 [I] Progress on: 886it/1.00kit rate:8.8s/it remaining:16:40 elapsed:2:10:36 postfix:- (511844:tqdm_logging.py:145)
Step 887: grad_norm=3.6679110527038574, loss=0.36514216661453247, param_norm=1887.1239013671875
Step 888: grad_norm=3.1898624897003174, loss=0.36415189504623413, param_norm=1887.1239013671875
11:58:04.581 [I] Progress on: 888it/1.00kit rate:8.8s/it remaining:16:22 elapsed:2:10:54 postfix:- (511844:tqdm_logging.py:145)
Step 889: grad_norm=3.1254217624664307, loss=0.3672674000263214, param_norm=1887.1240234375
Step 890: grad_norm=3.160064458847046, loss=0.3492570221424103, param_norm=1887.1240234375
11:58:22.125 [I] Progress on: 890it/1.00kit rate:8.8s/it remaining:16:05 elapsed:2:11:11 postfix:- (511844:tqdm_logging.py:145)
Step 891: grad_norm=4.039459228515625, loss=0.3896610140800476, param_norm=1887.1240234375
Step 892: grad_norm=3.4993090629577637, loss=0.3183857500553131, param_norm=1887.1240234375
11:58:39.650 [I] Progress on: 892it/1.00kit rate:8.8s/it remaining:15:47 elapsed:2:11:29 postfix:- (511844:tqdm_logging.py:145)
Step 893: grad_norm=3.618844747543335, loss=0.38397032022476196, param_norm=1887.1240234375
Step 894: grad_norm=3.4511914253234863, loss=0.42042016983032227, param_norm=1887.1240234375
11:58:57.197 [I] Progress on: 894it/1.00kit rate:8.8s/it remaining:15:30 elapsed:2:11:46 postfix:- (511844:tqdm_logging.py:145)
Step 895: grad_norm=3.768996477127075, loss=0.31564247608184814, param_norm=1887.1240234375
Step 896: grad_norm=2.974501848220825, loss=0.3584952652454376, param_norm=1887.1241455078125
11:59:14.731 [I] Progress on: 896it/1.00kit rate:8.8s/it remaining:15:12 elapsed:2:12:04 postfix:- (511844:tqdm_logging.py:145)
Step 897: grad_norm=3.3742289543151855, loss=0.294044554233551, param_norm=1887.124267578125
Step 898: grad_norm=4.013378143310547, loss=0.42532289028167725, param_norm=1887.124267578125
11:59:32.283 [I] Progress on: 898it/1.00kit rate:8.8s/it remaining:14:55 elapsed:2:12:21 postfix:- (511844:tqdm_logging.py:145)
Step 899: grad_norm=3.9250082969665527, loss=0.42558640241622925, param_norm=1887.124267578125
Step 900: grad_norm=3.6401207447052, loss=0.39394938945770264, param_norm=1887.1241455078125
11:59:49.819 [I] Progress on: 900it/1.00kit rate:8.8s/it remaining:14:37 elapsed:2:12:39 postfix:- (511844:tqdm_logging.py:145)
11:59:49.934 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
11:59:49.934 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
11:59:49.934 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (511844:checkpoint_manager.py:1786)
11:59:49.934 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (511844:checkpoint_manager.py:1817)
11:59:49.935 [I] [process=0] Saving checkpoint at step 900                                        (511844:checkpoint_manager.py:1286)
11:59:49.935 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900. (511844:async_checkpointer.py:358)
11:59:49.936 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:59:49.937 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24 (511844:atomicity.py:144)
11:59:49.938 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:59:49.938 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
11:59:49.939 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (511844:atomicity.py:144)
11:59:49.939 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (511844:atomicity.py:144)
11:59:49.940 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
11:59:49.945 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
11:59:53.577 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
11:59:53.581 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
11:59:53.582 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
11:59:53.583 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
11:59:53.584 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.587 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.587 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.588 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:22.396378+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.588 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:03.323498+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.589 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:15:46.456779+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.589 [I] Preserving Checkpoint[step=700 | time=2025-04-08 15:30:27.249410+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.590 [I] Preserving Checkpoint[step=800 | time=2025-04-08 15:45:10.039651+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
11:59:53.590 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
11:59:53.591 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
11:59:53.591 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
11:59:53.594 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744127989.9341214, 'wait_for_prev_duration_secs': 0.0006585121154785156, 'checkpointer_blocking_start_time': 1744127989.9352794, 'checkpointer_blocking_duration_secs': 3.6494035720825195, 'get_old_steps_start_time': 1744127993.5847015, 'get_old_steps_duration_secs': 0.005805492401123047, 'checkpoint_manager_blocking_start_time': 1744127989.9339876, 'checkpoint_manager_blocking_duration_secs': 3.6607778072357178} (511844:standard_logger.py:34)
12:00:00.614 [I] ChainedFuture completed 1/1 futures in 7.03 seconds.                             (511844:future.py:137)
12:00:00.615 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 970.6 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
12:00:01.110 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
12:00:01.111 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24 (511844:async_checkpointer.py:406)
12:00:01.111 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24/assets (511844:atomicity.py:287)
12:00:01.119 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24/params (511844:atomicity.py:287)
12:00:01.119 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900 (511844:async_checkpointer.py:416)
12:00:01.119 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24 (511844:async_checkpointer.py:426)
12:00:01.120 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900 (511844:atomicity.py:287)
12:00:01.121 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/900`. (511844:atomicity.py:548)
12:00:01.121 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
12:00:01.121 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
12:00:01.121 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
12:00:01.122 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
12:00:01.122 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
Step 901: grad_norm=2.7905311584472656, loss=0.30355292558670044, param_norm=1887.1241455078125
12:00:02.198 [I] Progress on: 901it/1.00kit rate:9.9s/it remaining:16:16 elapsed:2:12:51 postfix:- (511844:tqdm_logging.py:145)
Step 902: grad_norm=3.7789595127105713, loss=0.42746931314468384, param_norm=1887.1241455078125
Step 903: grad_norm=5.217688083648682, loss=0.37961792945861816, param_norm=1887.124267578125
12:00:19.750 [I] Progress on: 903it/1.00kit rate:9.3s/it remaining:15:02 elapsed:2:13:09 postfix:- (511844:tqdm_logging.py:145)
Step 904: grad_norm=3.7041819095611572, loss=0.36081674695014954, param_norm=1887.124267578125
Step 905: grad_norm=3.451881170272827, loss=0.45883822441101074, param_norm=1887.1243896484375
12:00:37.268 [I] Progress on: 905it/1.00kit rate:9.0s/it remaining:14:16 elapsed:2:13:26 postfix:- (511844:tqdm_logging.py:145)
Step 906: grad_norm=3.5097391605377197, loss=0.3478977084159851, param_norm=1887.1243896484375
Step 907: grad_norm=3.2673540115356445, loss=0.3658962845802307, param_norm=1887.1243896484375
12:00:54.775 [I] Progress on: 907it/1.00kit rate:8.9s/it remaining:13:45 elapsed:2:13:44 postfix:- (511844:tqdm_logging.py:145)
Step 908: grad_norm=3.2063817977905273, loss=0.3759634494781494, param_norm=1887.1243896484375
Step 909: grad_norm=3.542193651199341, loss=0.37597745656967163, param_norm=1887.1243896484375
12:01:12.283 [I] Progress on: 909it/1.00kit rate:8.8s/it remaining:13:21 elapsed:2:14:01 postfix:- (511844:tqdm_logging.py:145)
Step 910: grad_norm=3.611453056335449, loss=0.39492350816726685, param_norm=1887.1243896484375
Step 911: grad_norm=4.274703502655029, loss=0.3999278247356415, param_norm=1887.1243896484375
12:01:29.819 [I] Progress on: 911it/1.00kit rate:8.8s/it remaining:13:01 elapsed:2:14:19 postfix:- (511844:tqdm_logging.py:145)
Step 912: grad_norm=3.4132964611053467, loss=0.40798473358154297, param_norm=1887.1243896484375
Step 913: grad_norm=4.194450378417969, loss=0.37865835428237915, param_norm=1887.1243896484375
12:01:47.336 [I] Progress on: 913it/1.00kit rate:8.8s/it remaining:12:42 elapsed:2:14:36 postfix:- (511844:tqdm_logging.py:145)
Step 914: grad_norm=3.897582769393921, loss=0.40665167570114136, param_norm=1887.1243896484375
Step 915: grad_norm=3.21134090423584, loss=0.33299022912979126, param_norm=1887.1243896484375
12:02:04.844 [I] Progress on: 915it/1.00kit rate:8.8s/it remaining:12:24 elapsed:2:14:54 postfix:- (511844:tqdm_logging.py:145)
Step 916: grad_norm=4.050556659698486, loss=0.3807778060436249, param_norm=1887.1243896484375
Step 917: grad_norm=4.870108127593994, loss=0.37429291009902954, param_norm=1887.1243896484375
12:02:22.353 [I] Progress on: 917it/1.00kit rate:8.8s/it remaining:12:06 elapsed:2:15:11 postfix:- (511844:tqdm_logging.py:145)
Step 918: grad_norm=3.7587296962738037, loss=0.40937161445617676, param_norm=1887.1243896484375
Step 919: grad_norm=3.659947633743286, loss=0.41243720054626465, param_norm=1887.1243896484375
12:02:39.888 [I] Progress on: 919it/1.00kit rate:8.8s/it remaining:11:49 elapsed:2:15:29 postfix:- (511844:tqdm_logging.py:145)
Step 920: grad_norm=4.517231464385986, loss=0.3916921615600586, param_norm=1887.1243896484375
Step 921: grad_norm=3.813732385635376, loss=0.3441403806209564, param_norm=1887.1243896484375
12:02:57.436 [I] Progress on: 921it/1.00kit rate:8.8s/it remaining:11:32 elapsed:2:15:47 postfix:- (511844:tqdm_logging.py:145)
Step 922: grad_norm=4.995210647583008, loss=0.3782896399497986, param_norm=1887.12451171875
Step 923: grad_norm=3.812002420425415, loss=0.3686308264732361, param_norm=1887.12451171875
12:03:14.964 [I] Progress on: 923it/1.00kit rate:8.8s/it remaining:11:14 elapsed:2:16:04 postfix:- (511844:tqdm_logging.py:145)
Step 924: grad_norm=3.6174161434173584, loss=0.4069668650627136, param_norm=1887.12451171875
12:03:26.377 [I] Progress on: 924it/1.00kit rate:9.6s/it remaining:12:06 elapsed:2:16:16 postfix:- (511844:tqdm_logging.py:145)
Step 925: grad_norm=2.8394994735717773, loss=0.36836695671081543, param_norm=1887.12451171875
Step 926: grad_norm=3.356580972671509, loss=0.3336855173110962, param_norm=1887.12451171875
12:03:43.887 [I] Progress on: 926it/1.00kit rate:9.2s/it remaining:11:17 elapsed:2:16:33 postfix:- (511844:tqdm_logging.py:145)
Step 927: grad_norm=2.562701463699341, loss=0.3310915529727936, param_norm=1887.12451171875
Step 928: grad_norm=3.3544256687164307, loss=0.3488047122955322, param_norm=1887.1246337890625
12:04:01.390 [I] Progress on: 928it/1.00kit rate:9.0s/it remaining:10:44 elapsed:2:16:51 postfix:- (511844:tqdm_logging.py:145)
Step 929: grad_norm=3.1792006492614746, loss=0.354570209980011, param_norm=1887.1246337890625
Step 930: grad_norm=2.9385390281677246, loss=0.3894592821598053, param_norm=1887.1246337890625
12:04:18.982 [I] Progress on: 930it/1.00kit rate:8.9s/it remaining:10:21 elapsed:2:17:08 postfix:- (511844:tqdm_logging.py:145)
Step 931: grad_norm=3.27681040763855, loss=0.38023823499679565, param_norm=1887.1246337890625
Step 932: grad_norm=3.195324420928955, loss=0.35218578577041626, param_norm=1887.1246337890625
12:04:36.497 [I] Progress on: 932it/1.00kit rate:8.8s/it remaining:09:59 elapsed:2:17:26 postfix:- (511844:tqdm_logging.py:145)
Step 933: grad_norm=2.8481664657592773, loss=0.32969987392425537, param_norm=1887.124755859375
Step 934: grad_norm=2.861454486846924, loss=0.3472159802913666, param_norm=1887.124755859375
12:04:54.026 [I] Progress on: 934it/1.00kit rate:8.8s/it remaining:09:40 elapsed:2:17:43 postfix:- (511844:tqdm_logging.py:145)
Step 935: grad_norm=3.2999267578125, loss=0.3214157819747925, param_norm=1887.124755859375
Step 936: grad_norm=3.584522247314453, loss=0.3278525173664093, param_norm=1887.124755859375
12:05:11.558 [I] Progress on: 936it/1.00kit rate:8.8s/it remaining:09:22 elapsed:2:18:01 postfix:- (511844:tqdm_logging.py:145)
Step 937: grad_norm=3.4924914836883545, loss=0.31989243626594543, param_norm=1887.124755859375
Step 938: grad_norm=3.113833427429199, loss=0.29824936389923096, param_norm=1887.124755859375
12:05:29.100 [I] Progress on: 938it/1.00kit rate:8.8s/it remaining:09:04 elapsed:2:18:18 postfix:- (511844:tqdm_logging.py:145)
Step 939: grad_norm=2.933936357498169, loss=0.39300736784935, param_norm=1887.124755859375
Step 940: grad_norm=3.045828104019165, loss=0.3646390736103058, param_norm=1887.1248779296875
12:05:46.643 [I] Progress on: 940it/1.00kit rate:8.8s/it remaining:08:46 elapsed:2:18:36 postfix:- (511844:tqdm_logging.py:145)
Step 941: grad_norm=3.576415777206421, loss=0.39548325538635254, param_norm=1887.1248779296875
Step 942: grad_norm=2.6131844520568848, loss=0.2845500707626343, param_norm=1887.1248779296875
12:06:04.196 [I] Progress on: 942it/1.00kit rate:8.8s/it remaining:08:29 elapsed:2:18:53 postfix:- (511844:tqdm_logging.py:145)
Step 943: grad_norm=3.0886404514312744, loss=0.3601425886154175, param_norm=1887.1248779296875
Step 944: grad_norm=2.6245386600494385, loss=0.33347848057746887, param_norm=1887.1248779296875
12:06:21.735 [I] Progress on: 944it/1.00kit rate:8.8s/it remaining:08:11 elapsed:2:19:11 postfix:- (511844:tqdm_logging.py:145)
Step 945: grad_norm=2.5260188579559326, loss=0.2941781282424927, param_norm=1887.1248779296875
Step 946: grad_norm=3.404026985168457, loss=0.3582499325275421, param_norm=1887.1248779296875
12:06:39.296 [I] Progress on: 946it/1.00kit rate:8.8s/it remaining:07:54 elapsed:2:19:28 postfix:- (511844:tqdm_logging.py:145)
Step 947: grad_norm=2.641587495803833, loss=0.3379901051521301, param_norm=1887.1248779296875
Step 948: grad_norm=3.2138850688934326, loss=0.32659053802490234, param_norm=1887.1248779296875
12:06:56.858 [I] Progress on: 948it/1.00kit rate:8.8s/it remaining:07:36 elapsed:2:19:46 postfix:- (511844:tqdm_logging.py:145)
Step 949: grad_norm=2.955217123031616, loss=0.31538689136505127, param_norm=1887.125
Step 950: grad_norm=3.225240468978882, loss=0.36336585879325867, param_norm=1887.125
12:07:14.422 [I] Progress on: 950it/1.00kit rate:8.8s/it remaining:07:19 elapsed:2:20:04 postfix:- (511844:tqdm_logging.py:145)
Step 951: grad_norm=2.6608119010925293, loss=0.2566709816455841, param_norm=1887.125
Step 952: grad_norm=2.8384456634521484, loss=0.2900125980377197, param_norm=1887.125
12:07:31.977 [I] Progress on: 952it/1.00kit rate:8.8s/it remaining:07:01 elapsed:2:20:21 postfix:- (511844:tqdm_logging.py:145)
Step 953: grad_norm=2.8045952320098877, loss=0.29612112045288086, param_norm=1887.125
Step 954: grad_norm=4.519107341766357, loss=0.3879442512989044, param_norm=1887.125
12:07:49.544 [I] Progress on: 954it/1.00kit rate:8.8s/it remaining:06:44 elapsed:2:20:39 postfix:- (511844:tqdm_logging.py:145)
Step 955: grad_norm=2.551020383834839, loss=0.30629152059555054, param_norm=1887.125
Step 956: grad_norm=3.253293514251709, loss=0.3884066343307495, param_norm=1887.125
12:08:07.098 [I] Progress on: 956it/1.00kit rate:8.8s/it remaining:06:26 elapsed:2:20:56 postfix:- (511844:tqdm_logging.py:145)
Step 957: grad_norm=3.076437473297119, loss=0.3215906023979187, param_norm=1887.125
Step 958: grad_norm=3.0818212032318115, loss=0.2894887924194336, param_norm=1887.125
12:08:24.653 [I] Progress on: 958it/1.00kit rate:8.8s/it remaining:06:09 elapsed:2:21:14 postfix:- (511844:tqdm_logging.py:145)
Step 959: grad_norm=3.1448323726654053, loss=0.3123083710670471, param_norm=1887.125244140625
Step 960: grad_norm=2.5988168716430664, loss=0.3085517883300781, param_norm=1887.125244140625
12:08:42.196 [I] Progress on: 960it/1.00kit rate:8.8s/it remaining:05:51 elapsed:2:21:31 postfix:- (511844:tqdm_logging.py:145)
Step 961: grad_norm=3.542616367340088, loss=0.34737205505371094, param_norm=1887.125244140625
Step 962: grad_norm=3.001363515853882, loss=0.3895648717880249, param_norm=1887.125244140625
12:08:59.757 [I] Progress on: 962it/1.00kit rate:8.8s/it remaining:05:33 elapsed:2:21:49 postfix:- (511844:tqdm_logging.py:145)
Step 963: grad_norm=3.5652945041656494, loss=0.3719691038131714, param_norm=1887.125244140625
Step 964: grad_norm=2.932584285736084, loss=0.32599422335624695, param_norm=1887.125244140625
12:09:17.310 [I] Progress on: 964it/1.00kit rate:8.8s/it remaining:05:16 elapsed:2:22:06 postfix:- (511844:tqdm_logging.py:145)
Step 965: grad_norm=3.353660821914673, loss=0.4020218253135681, param_norm=1887.125244140625
Step 966: grad_norm=2.8211472034454346, loss=0.31592652201652527, param_norm=1887.1253662109375
12:09:34.883 [I] Progress on: 966it/1.00kit rate:8.8s/it remaining:04:58 elapsed:2:22:24 postfix:- (511844:tqdm_logging.py:145)
Step 967: grad_norm=3.069498062133789, loss=0.30260345339775085, param_norm=1887.1253662109375
Step 968: grad_norm=2.7797350883483887, loss=0.3548627197742462, param_norm=1887.1253662109375
12:09:52.420 [I] Progress on: 968it/1.00kit rate:8.8s/it remaining:04:41 elapsed:2:22:42 postfix:- (511844:tqdm_logging.py:145)
Step 969: grad_norm=2.9982526302337646, loss=0.3732661008834839, param_norm=1887.1253662109375
Step 970: grad_norm=3.0080363750457764, loss=0.33067694306373596, param_norm=1887.1253662109375
12:10:09.973 [I] Progress on: 970it/1.00kit rate:8.8s/it remaining:04:23 elapsed:2:22:59 postfix:- (511844:tqdm_logging.py:145)
Step 971: grad_norm=3.168097496032715, loss=0.3373361825942993, param_norm=1887.1253662109375
Step 972: grad_norm=3.0012900829315186, loss=0.3382894992828369, param_norm=1887.1253662109375
12:10:27.534 [I] Progress on: 972it/1.00kit rate:8.8s/it remaining:04:05 elapsed:2:23:17 postfix:- (511844:tqdm_logging.py:145)
Step 973: grad_norm=2.6767289638519287, loss=0.31758952140808105, param_norm=1887.1253662109375
Step 974: grad_norm=3.1907894611358643, loss=0.3766242265701294, param_norm=1887.1253662109375
12:10:45.103 [I] Progress on: 974it/1.00kit rate:8.8s/it remaining:03:48 elapsed:2:23:34 postfix:- (511844:tqdm_logging.py:145)
Step 975: grad_norm=3.0824503898620605, loss=0.3387375771999359, param_norm=1887.1253662109375
Step 976: grad_norm=3.1538584232330322, loss=0.3591521680355072, param_norm=1887.1253662109375
12:11:02.652 [I] Progress on: 976it/1.00kit rate:8.8s/it remaining:03:30 elapsed:2:23:52 postfix:- (511844:tqdm_logging.py:145)
Step 977: grad_norm=3.3652195930480957, loss=0.364482045173645, param_norm=1887.1253662109375
Step 978: grad_norm=3.620479106903076, loss=0.3606850504875183, param_norm=1887.1253662109375
12:11:20.215 [I] Progress on: 978it/1.00kit rate:8.8s/it remaining:03:13 elapsed:2:24:09 postfix:- (511844:tqdm_logging.py:145)
Step 979: grad_norm=3.652463912963867, loss=0.34619706869125366, param_norm=1887.1253662109375
Step 980: grad_norm=3.073033332824707, loss=0.3144877552986145, param_norm=1887.1253662109375
12:11:37.761 [I] Progress on: 980it/1.00kit rate:8.8s/it remaining:02:55 elapsed:2:24:27 postfix:- (511844:tqdm_logging.py:145)
Step 981: grad_norm=2.875674247741699, loss=0.35149285197257996, param_norm=1887.1253662109375
Step 982: grad_norm=3.049356698989868, loss=0.29888972640037537, param_norm=1887.1253662109375
12:11:55.324 [I] Progress on: 982it/1.00kit rate:8.8s/it remaining:02:38 elapsed:2:24:44 postfix:- (511844:tqdm_logging.py:145)
Step 983: grad_norm=2.8236746788024902, loss=0.35719871520996094, param_norm=1887.1253662109375
Step 984: grad_norm=2.8657283782958984, loss=0.2813764214515686, param_norm=1887.12548828125
12:12:12.852 [I] Progress on: 984it/1.00kit rate:8.8s/it remaining:02:20 elapsed:2:25:02 postfix:- (511844:tqdm_logging.py:145)
Step 985: grad_norm=3.292504072189331, loss=0.37748008966445923, param_norm=1887.12548828125
Step 986: grad_norm=3.013150215148926, loss=0.33789512515068054, param_norm=1887.12548828125
12:12:30.406 [I] Progress on: 986it/1.00kit rate:8.8s/it remaining:02:02 elapsed:2:25:20 postfix:- (511844:tqdm_logging.py:145)
Step 987: grad_norm=3.161478281021118, loss=0.3069995045661926, param_norm=1887.12548828125
Step 988: grad_norm=3.4130449295043945, loss=0.338495135307312, param_norm=1887.12548828125
12:12:47.954 [I] Progress on: 988it/1.00kit rate:8.8s/it remaining:01:45 elapsed:2:25:37 postfix:- (511844:tqdm_logging.py:145)
Step 989: grad_norm=2.809859037399292, loss=0.31095191836357117, param_norm=1887.12548828125
Step 990: grad_norm=3.7432453632354736, loss=0.4380185604095459, param_norm=1887.1256103515625
12:13:05.502 [I] Progress on: 990it/1.00kit rate:8.8s/it remaining:01:27 elapsed:2:25:55 postfix:- (511844:tqdm_logging.py:145)
Step 991: grad_norm=3.1758623123168945, loss=0.340600848197937, param_norm=1887.1256103515625
Step 992: grad_norm=3.029381275177002, loss=0.35581350326538086, param_norm=1887.1256103515625
12:13:23.042 [I] Progress on: 992it/1.00kit rate:8.8s/it remaining:01:10 elapsed:2:26:12 postfix:- (511844:tqdm_logging.py:145)
Step 993: grad_norm=3.2018754482269287, loss=0.35729867219924927, param_norm=1887.1256103515625
Step 994: grad_norm=2.7493863105773926, loss=0.33804959058761597, param_norm=1887.1256103515625
12:13:40.597 [I] Progress on: 994it/1.00kit rate:8.8s/it remaining:00:52 elapsed:2:26:30 postfix:- (511844:tqdm_logging.py:145)
Step 995: grad_norm=3.47942852973938, loss=0.32212698459625244, param_norm=1887.1256103515625
Step 996: grad_norm=3.1922523975372314, loss=0.3426738381385803, param_norm=1887.1256103515625
12:13:58.173 [I] Progress on: 996it/1.00kit rate:8.8s/it remaining:00:35 elapsed:2:26:47 postfix:- (511844:tqdm_logging.py:145)
Step 997: grad_norm=3.5320746898651123, loss=0.38418257236480713, param_norm=1887.1256103515625
Step 998: grad_norm=3.219623565673828, loss=0.36547207832336426, param_norm=1887.1256103515625
12:14:15.745 [I] Progress on: 998it/1.00kit rate:8.8s/it remaining:00:17 elapsed:2:27:05 postfix:- (511844:tqdm_logging.py:145)
Step 999: grad_norm=3.079808235168457, loss=0.35862505435943604, param_norm=1887.1256103515625
12:14:24.688 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
12:14:24.688 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
12:14:24.688 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (511844:checkpoint_manager.py:1786)
12:14:24.688 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (511844:checkpoint_manager.py:1817)
12:14:24.688 [I] [process=0] Saving checkpoint at step 999                                        (511844:checkpoint_manager.py:1286)
12:14:24.689 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999. (511844:async_checkpointer.py:358)
12:14:24.690 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
12:14:24.690 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27 (511844:atomicity.py:144)
12:14:24.691 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
12:14:24.692 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511844:multihost.py:293)
12:14:24.692 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (511844:atomicity.py:144)
12:14:24.693 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (511844:atomicity.py:144)
12:14:24.693 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511844:multihost.py:293)
12:14:24.697 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511844:replica_slices.py:419)
12:14:28.293 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511844:tensorstore_utils.py:371)
12:14:28.294 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
12:14:28.295 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511844:tensorstore_utils.py:371)
12:14:28.297 [I] [process=0][thread=async_save] Background save thread started.                   (511844:async_checkpointer.py:121)
12:14:28.322 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:13.972671+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.325 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:01.493590+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.327 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:31:41.922257+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.331 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:22.396378+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.332 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:03.323498+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.332 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:15:46.456779+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.333 [I] Preserving Checkpoint[step=700 | time=2025-04-08 15:30:27.249410+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.333 [I] Preserving Checkpoint[step=800 | time=2025-04-08 15:45:10.039651+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.333 [I] Preserving Checkpoint[step=900 | time=2025-04-08 15:59:53.584688+00:00 | is_locked=None]: (Reason: on keep_period=100). (511844:checkpoint_manager.py:1734)
12:14:28.333 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511844:multihost.py:293)
12:14:28.333 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (511844:checkpoint_manager.py:1328)
12:14:28.334 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511844:async_checkpointer.py:231)
12:14:28.334 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744128864.6881132, 'wait_for_prev_duration_secs': 0.0005838871002197266, 'checkpointer_blocking_start_time': 1744128864.6891093, 'checkpointer_blocking_duration_secs': 3.6329445838928223, 'get_old_steps_start_time': 1744128868.3220909, 'get_old_steps_duration_secs': 0.01152801513671875, 'checkpoint_manager_blocking_start_time': 1744128864.6880515, 'checkpoint_manager_blocking_duration_secs': 3.6466481685638428} (511844:standard_logger.py:34)
12:14:28.337 [I] Progress on: 1.00kit/1.00kit rate:9.9s/it remaining:00:00 elapsed:2:27:17 postfix:- (511844:tqdm_logging.py:145)
12:14:28.338 [I] Progress on: 1.00kit/1.00kit rate:9.9s/it remaining:00:00 elapsed:2:27:17 postfix:- (511844:tqdm_logging.py:145)
12:14:28.339 [I] Waiting for checkpoint manager to finish                                         (511844:train_pi0_fast_regent.py:301)
12:14:28.341 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511844:checkpoint_manager.py:1759)
12:14:28.341 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511844:checkpoint_manager.py:1777)
12:14:36.381 [I] ChainedFuture completed 1/1 futures in 8.08 seconds.                             (511844:future.py:137)
12:14:36.382 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 886.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511844:base_pytree_checkpoint_handler.py:113)
12:14:36.382 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511844:async_checkpointer.py:131)
12:14:36.382 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f00c88ca890> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27 (511844:async_checkpointer.py:406)
12:14:36.383 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27/assets (511844:atomicity.py:287)
12:14:36.390 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27/params (511844:atomicity.py:287)
12:14:36.391 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999 (511844:async_checkpointer.py:416)
12:14:36.391 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27 (511844:async_checkpointer.py:426)
12:14:36.391 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999 (511844:atomicity.py:287)
12:14:36.392 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_bagel/1st_try_regent_bagel/999`. (511844:atomicity.py:548)
12:14:36.392 [I] [process=0][thread=async_save] Background save thread done.                      (511844:async_checkpointer.py:183)
12:14:36.393 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511844:async_checkpointer.py:239)
12:14:36.393 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511844:async_checkpointer.py:249)
12:14:36.393 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (511844:checkpoint_manager.py:1890)
12:14:36.393 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (511844:checkpoint_manager.py:1905)
12:14:36.394 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (511844:checkpoint_manager.py:1786)
12:14:36.395 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (511844:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_regent_bagel[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/jry3e5l1[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250408_094628-jry3e5l1/logs[0m
