nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
23:38:27.833 [I] Running on: ivy                                                                  (303899:train_pi0_fast_regent.py:226)
INFO:2025-03-24 23:38:28,736:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
23:38:28.736 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (303899:xla_bridge.py:945)
INFO:2025-03-24 23:38:28,741:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
23:38:28.741 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (303899:xla_bridge.py:945)
23:38:29.718 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (303899:base_pytree_checkpoint_handler.py:332)
23:38:29.718 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (303899:base_pytree_checkpoint_handler.py:332)
23:38:29.718 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (303899:multihost.py:375)
23:38:29.719 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7f34b4f2ce50>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b52fef90>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b4ee7250>}, handler_registry=None (303899:checkpoint_manager.py:622)
23:38:29.719 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7f34b4f2ce50>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (303899:composite_checkpoint_handler.py:239)
23:38:29.719 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b52fef90>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (303899:composite_checkpoint_handler.py:239)
23:38:29.719 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b4ee7250>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (303899:composite_checkpoint_handler.py:239)
23:38:29.720 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f34b4e66510>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (303899:composite_checkpoint_handler.py:239)
23:38:29.720 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f34b4f2ce50>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f34b4f2ce50>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b52fef90>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b52fef90>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b4ee7250>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f34b4ee7250>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f34b4e66510>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f34b4e66510>}). (303899:composite_checkpoint_handler.py:508)
23:38:29.720 [I] orbax-checkpoint version: 0.11.1                                                 (303899:abstract_checkpointer.py:35)
23:38:29.720 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f34b50abc40> timeout: 7200 secs and primary_host=0 for async checkpoint writes (303899:async_checkpointer.py:80)
23:38:29.720 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10 (303899:checkpoint_manager.py:1528)
23:38:29.721 [I] Saving root metadata                                                             (303899:checkpoint_manager.py:1569)
23:38:29.721 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (303899:multihost.py:293)
23:38:29.721 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f34b52ffd50> (303899:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250324_233830-i0et0wd8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_regent_idli_plate_10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/i0et0wd8
Some kwargs in processor config are unused and will not have any effect: vocab_size, time_horizon, scale, action_dim, min_token. 
Some kwargs in processor config are unused and will not have any effect: vocab_size, time_horizon, scale, action_dim, min_token. 
23:38:31.881 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/droid (303899:config.py:167)
count_droid: 0, count_collected_demos: 632
len_dataset: 632
all 10 episode prompts are the same: move the idli plate to the right
23:38:53.341 [I] Initialized data loader:
[0].query_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].query_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].query_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].query_image_masks['base_0_rgb']: (16,)@bool
[0].query_image_masks['base_1_rgb']: (16,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].exp_lamda_distances: (16, 5, 1)@float32
[0].query_state: (16, 8)@float32
[0].retrieved_0_state: (16, 8)@float32
[0].retrieved_1_state: (16, 8)@float32
[0].retrieved_2_state: (16, 8)@float32
[0].retrieved_3_state: (16, 8)@float32
[0].query_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_prefix: (16, 125)@int32
[0].query_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_postfix: (16, 125)@int32
[0].query_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_0_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_1_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_2_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_3_tokenized_prompt_mask: (16, 250)@bool
[0].query_token_ar_mask: (16, 250)@int32
[0].retrieved_0_token_ar_mask: (16, 250)@int32
[0].retrieved_1_token_ar_mask: (16, 250)@int32
[0].retrieved_2_token_ar_mask: (16, 250)@int32
[0].retrieved_3_token_ar_mask: (16, 250)@int32
[0].query_token_loss_mask: (16, 250)@bool
[0].retrieved_0_token_loss_mask: (16, 250)@bool
[0].retrieved_1_token_loss_mask: (16, 250)@bool
[0].retrieved_2_token_loss_mask: (16, 250)@bool
[0].retrieved_3_token_loss_mask: (16, 250)@bool
[1]: (16, 15, 8)@float32 (303899:train_pi0_fast_regent.py:258)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
23:38:54.496 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (303899:base_pytree_checkpoint_handler.py:332)
23:38:54.523 [I] Restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (303899:checkpointer.py:256)
23:39:09.618 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 686.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 15 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
23:39:09.619 [I] Finished restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (303899:checkpointer.py:259)
23:39:09.620 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (303899:multihost.py:293)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
2025-03-24 23:39:19.516265: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 30.69GiB (32957682654 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
23:39:21.535 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (303899:train_pi0_fast_regent.py:262)
decode_indices shape: (1245,)
23:39:21.633 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (303899:tqdm_logging.py:145)
first_targets shape: (16, 125, 257152)
input_token_embeddings shape: (16, 5090, 2048)
attn_mask shape: (16, 5090, 5090)
loss_mask shape: (16, 249)
targets shape: (16, 249, 257152)
pre_logits shape: (16, 5089, 2048)
logits shape: (16, 249, 257152)
new_logits shape: (16, 249, 257152)
logp shape: (16, 249, 257152)
token_pplx shape: (16, 249)
loss shape: (16,)
Step 0: grad_norm=13.865391731262207, loss=4.156424522399902, param_norm=1886.9476318359375
23:39:39.311 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:17 postfix:-                   (303899:tqdm_logging.py:145)
Step 1: grad_norm=15.366341590881348, loss=4.1528425216674805, param_norm=1886.9476318359375
Step 2: grad_norm=13.671274185180664, loss=3.7955093383789062, param_norm=1886.9476318359375
23:39:56.461 [I] Progress on: 2.00it/1.00kit rate:12.4s/it remaining:3:26:18 elapsed:00:34 postfix:- (303899:tqdm_logging.py:145)
Step 3: grad_norm=12.524398803710938, loss=4.115728378295898, param_norm=1886.9476318359375
Step 4: grad_norm=12.848243713378906, loss=3.476278781890869, param_norm=1886.9476318359375
23:40:13.638 [I] Progress on: 4.00it/1.00kit rate:9.8s/it remaining:2:43:20 elapsed:00:52 postfix:- (303899:tqdm_logging.py:145)
Step 5: grad_norm=12.210912704467773, loss=3.920060873031616, param_norm=1886.947509765625
Step 6: grad_norm=10.129368782043457, loss=3.528000831604004, param_norm=1886.947509765625
23:40:30.900 [I] Progress on: 6.00it/1.00kit rate:9.1s/it remaining:2:31:22 elapsed:01:09 postfix:- (303899:tqdm_logging.py:145)
Step 7: grad_norm=10.396162033081055, loss=3.7298059463500977, param_norm=1886.947509765625
Step 8: grad_norm=7.4147491455078125, loss=3.37300443649292, param_norm=1886.9473876953125
23:40:48.184 [I] Progress on: 8.00it/1.00kit rate:8.9s/it remaining:2:26:41 elapsed:01:26 postfix:- (303899:tqdm_logging.py:145)
Step 9: grad_norm=8.625410079956055, loss=3.2690377235412598, param_norm=1886.9473876953125
Step 10: grad_norm=17.218975067138672, loss=3.504652500152588, param_norm=1886.9473876953125
23:41:05.485 [I] Progress on: 10.0it/1.00kit rate:8.8s/it remaining:2:24:30 elapsed:01:43 postfix:- (303899:tqdm_logging.py:145)
Step 11: grad_norm=10.392746925354004, loss=3.3718984127044678, param_norm=1886.947265625
Step 12: grad_norm=8.021811485290527, loss=3.0723581314086914, param_norm=1886.947265625
23:41:22.789 [I] Progress on: 12.0it/1.00kit rate:8.7s/it remaining:2:23:16 elapsed:02:01 postfix:- (303899:tqdm_logging.py:145)
Step 13: grad_norm=10.61945915222168, loss=2.929440498352051, param_norm=1886.9471435546875
Step 14: grad_norm=9.906007766723633, loss=3.3048481941223145, param_norm=1886.9471435546875
23:41:40.158 [I] Progress on: 14.0it/1.00kit rate:8.7s/it remaining:2:22:53 elapsed:02:18 postfix:- (303899:tqdm_logging.py:145)
Step 15: grad_norm=7.568904399871826, loss=3.4526848793029785, param_norm=1886.9471435546875
Step 16: grad_norm=5.0488786697387695, loss=2.7692489624023438, param_norm=1886.9471435546875
23:41:57.562 [I] Progress on: 16.0it/1.00kit rate:8.7s/it remaining:2:22:37 elapsed:02:35 postfix:- (303899:tqdm_logging.py:145)
Step 17: grad_norm=12.450909614562988, loss=2.9517898559570312, param_norm=1886.9471435546875
Step 18: grad_norm=11.131779670715332, loss=3.001253128051758, param_norm=1886.9471435546875
23:42:14.973 [I] Progress on: 18.0it/1.00kit rate:8.7s/it remaining:2:22:28 elapsed:02:53 postfix:- (303899:tqdm_logging.py:145)
Step 19: grad_norm=13.067919731140137, loss=2.959683418273926, param_norm=1886.9471435546875
Step 20: grad_norm=7.969117641448975, loss=2.7532241344451904, param_norm=1886.9471435546875
23:42:32.394 [I] Progress on: 20.0it/1.00kit rate:8.7s/it remaining:2:22:16 elapsed:03:10 postfix:- (303899:tqdm_logging.py:145)
Step 21: grad_norm=8.170004844665527, loss=3.01646089553833, param_norm=1886.9471435546875
Step 22: grad_norm=14.169868469238281, loss=3.109778881072998, param_norm=1886.9471435546875
23:42:49.834 [I] Progress on: 22.0it/1.00kit rate:8.7s/it remaining:2:22:07 elapsed:03:28 postfix:- (303899:tqdm_logging.py:145)
Step 23: grad_norm=7.888940334320068, loss=2.7212107181549072, param_norm=1886.947265625
Step 24: grad_norm=11.224505424499512, loss=3.0442991256713867, param_norm=1886.9473876953125
23:43:07.236 [I] Progress on: 24.0it/1.00kit rate:8.7s/it remaining:2:21:47 elapsed:03:45 postfix:- (303899:tqdm_logging.py:145)
Step 25: grad_norm=13.624995231628418, loss=2.9646129608154297, param_norm=1886.9473876953125
Step 26: grad_norm=18.389686584472656, loss=2.9321601390838623, param_norm=1886.9473876953125
23:43:24.664 [I] Progress on: 26.0it/1.00kit rate:8.7s/it remaining:2:21:32 elapsed:04:03 postfix:- (303899:tqdm_logging.py:145)
Step 27: grad_norm=8.46095085144043, loss=2.983245849609375, param_norm=1886.947509765625
Step 28: grad_norm=4.394023418426514, loss=2.909608840942383, param_norm=1886.947509765625
23:43:42.087 [I] Progress on: 28.0it/1.00kit rate:8.7s/it remaining:2:21:14 elapsed:04:20 postfix:- (303899:tqdm_logging.py:145)
Step 29: grad_norm=5.2844390869140625, loss=2.836160659790039, param_norm=1886.9476318359375
Step 30: grad_norm=12.618855476379395, loss=2.8189125061035156, param_norm=1886.94775390625
23:43:59.509 [I] Progress on: 30.0it/1.00kit rate:8.7s/it remaining:2:20:54 elapsed:04:37 postfix:- (303899:tqdm_logging.py:145)
Step 31: grad_norm=4.5145416259765625, loss=2.722097635269165, param_norm=1886.9478759765625
Step 32: grad_norm=8.078158378601074, loss=2.541443347930908, param_norm=1886.947998046875
23:44:16.924 [I] Progress on: 32.0it/1.00kit rate:8.7s/it remaining:2:20:33 elapsed:04:55 postfix:- (303899:tqdm_logging.py:145)
Step 33: grad_norm=14.537460327148438, loss=2.640082359313965, param_norm=1886.9481201171875
Step 34: grad_norm=10.66529655456543, loss=2.4224369525909424, param_norm=1886.9482421875
23:44:34.467 [I] Progress on: 34.0it/1.00kit rate:8.7s/it remaining:2:20:46 elapsed:05:12 postfix:- (303899:tqdm_logging.py:145)
Step 35: grad_norm=5.4338603019714355, loss=2.9436793327331543, param_norm=1886.948486328125
Step 36: grad_norm=5.524121284484863, loss=2.870734930038452, param_norm=1886.9486083984375
23:44:51.930 [I] Progress on: 36.0it/1.00kit rate:8.7s/it remaining:2:20:27 elapsed:05:30 postfix:- (303899:tqdm_logging.py:145)
Step 37: grad_norm=5.615302085876465, loss=2.566932439804077, param_norm=1886.94873046875
Step 38: grad_norm=4.847408771514893, loss=2.710458755493164, param_norm=1886.9490966796875
23:45:09.374 [I] Progress on: 38.0it/1.00kit rate:8.7s/it remaining:2:20:03 elapsed:05:47 postfix:- (303899:tqdm_logging.py:145)
Step 39: grad_norm=6.0121941566467285, loss=2.5251049995422363, param_norm=1886.9493408203125
23:45:20.267 [I] Progress on: 39.0it/1.00kit rate:9.4s/it remaining:2:30:18 elapsed:05:58 postfix:- (303899:tqdm_logging.py:145)
Step 40: grad_norm=11.475044250488281, loss=2.5737273693084717, param_norm=1886.949462890625
Step 41: grad_norm=6.595273971557617, loss=2.471280097961426, param_norm=1886.949951171875
23:45:37.711 [I] Progress on: 41.0it/1.00kit rate:9.0s/it remaining:2:24:35 elapsed:06:16 postfix:- (303899:tqdm_logging.py:145)
Step 42: grad_norm=6.258905410766602, loss=2.5907058715820312, param_norm=1886.9501953125
Step 43: grad_norm=9.642733573913574, loss=2.44435453414917, param_norm=1886.9505615234375
23:45:55.146 [I] Progress on: 43.0it/1.00kit rate:8.9s/it remaining:2:21:35 elapsed:06:33 postfix:- (303899:tqdm_logging.py:145)
Step 44: grad_norm=7.187546253204346, loss=2.5059962272644043, param_norm=1886.9508056640625
Step 45: grad_norm=27.663835525512695, loss=2.3489809036254883, param_norm=1886.9512939453125
23:46:12.633 [I] Progress on: 45.0it/1.00kit rate:8.8s/it remaining:2:20:10 elapsed:06:50 postfix:- (303899:tqdm_logging.py:145)
Step 46: grad_norm=6.696739673614502, loss=2.544220447540283, param_norm=1886.9515380859375
Step 47: grad_norm=18.223342895507812, loss=2.4614880084991455, param_norm=1886.9520263671875
23:46:30.097 [I] Progress on: 47.0it/1.00kit rate:8.8s/it remaining:2:19:15 elapsed:07:08 postfix:- (303899:tqdm_logging.py:145)
Step 48: grad_norm=15.540059089660645, loss=2.455871343612671, param_norm=1886.952392578125
Step 49: grad_norm=14.677031517028809, loss=2.3516335487365723, param_norm=1886.952880859375
23:46:47.581 [I] Progress on: 49.0it/1.00kit rate:8.8s/it remaining:2:18:45 elapsed:07:25 postfix:- (303899:tqdm_logging.py:145)
Step 50: grad_norm=8.13791275024414, loss=2.4809720516204834, param_norm=1886.953125
Step 51: grad_norm=13.326042175292969, loss=2.3863086700439453, param_norm=1886.9534912109375
23:47:05.064 [I] Progress on: 51.0it/1.00kit rate:8.7s/it remaining:2:18:20 elapsed:07:43 postfix:- (303899:tqdm_logging.py:145)
Step 52: grad_norm=10.672404289245605, loss=2.3204689025878906, param_norm=1886.953857421875
Step 53: grad_norm=10.649569511413574, loss=2.0958075523376465, param_norm=1886.9542236328125
23:47:22.522 [I] Progress on: 53.0it/1.00kit rate:8.7s/it remaining:2:17:51 elapsed:08:00 postfix:- (303899:tqdm_logging.py:145)
Step 54: grad_norm=6.215729713439941, loss=2.4581549167633057, param_norm=1886.95458984375
Step 55: grad_norm=9.912718772888184, loss=2.1933810710906982, param_norm=1886.954833984375
23:47:40.009 [I] Progress on: 55.0it/1.00kit rate:8.7s/it remaining:2:17:36 elapsed:08:18 postfix:- (303899:tqdm_logging.py:145)
Step 56: grad_norm=6.728669166564941, loss=2.362386703491211, param_norm=1886.9552001953125
Step 57: grad_norm=9.612263679504395, loss=2.361142158508301, param_norm=1886.9554443359375
23:47:57.469 [I] Progress on: 57.0it/1.00kit rate:8.7s/it remaining:2:17:16 elapsed:08:35 postfix:- (303899:tqdm_logging.py:145)
Step 58: grad_norm=10.792821884155273, loss=2.5446650981903076, param_norm=1886.9559326171875
Step 59: grad_norm=18.736970901489258, loss=2.2786967754364014, param_norm=1886.9561767578125
23:48:14.951 [I] Progress on: 59.0it/1.00kit rate:8.7s/it remaining:2:16:59 elapsed:08:53 postfix:- (303899:tqdm_logging.py:145)
Step 60: grad_norm=6.2953948974609375, loss=2.0723626613616943, param_norm=1886.9564208984375
Step 61: grad_norm=12.220597267150879, loss=2.4828267097473145, param_norm=1886.956787109375
23:48:32.419 [I] Progress on: 61.0it/1.00kit rate:8.7s/it remaining:2:16:42 elapsed:09:10 postfix:- (303899:tqdm_logging.py:145)
Step 62: grad_norm=6.64495325088501, loss=2.3279404640197754, param_norm=1886.95703125
Step 63: grad_norm=7.686412334442139, loss=2.3405139446258545, param_norm=1886.9573974609375
23:48:49.896 [I] Progress on: 63.0it/1.00kit rate:8.7s/it remaining:2:16:24 elapsed:09:28 postfix:- (303899:tqdm_logging.py:145)
Step 64: grad_norm=9.955411911010742, loss=2.3494997024536133, param_norm=1886.957763671875
Step 65: grad_norm=9.22457218170166, loss=1.982133150100708, param_norm=1886.9581298828125
23:49:07.373 [I] Progress on: 65.0it/1.00kit rate:8.7s/it remaining:2:16:11 elapsed:09:45 postfix:- (303899:tqdm_logging.py:145)
Step 66: grad_norm=6.861270904541016, loss=2.126776933670044, param_norm=1886.95849609375
Step 67: grad_norm=13.513110160827637, loss=2.3985238075256348, param_norm=1886.9588623046875
23:49:24.884 [I] Progress on: 67.0it/1.00kit rate:8.7s/it remaining:2:16:00 elapsed:10:03 postfix:- (303899:tqdm_logging.py:145)
Step 68: grad_norm=6.342822551727295, loss=2.106172800064087, param_norm=1886.9593505859375
Step 69: grad_norm=11.06917667388916, loss=2.2746150493621826, param_norm=1886.959716796875
23:49:42.376 [I] Progress on: 69.0it/1.00kit rate:8.7s/it remaining:2:15:40 elapsed:10:20 postfix:- (303899:tqdm_logging.py:145)
Step 70: grad_norm=5.063159465789795, loss=2.1580755710601807, param_norm=1886.9599609375
Step 71: grad_norm=5.612631797790527, loss=2.288403034210205, param_norm=1886.9603271484375
23:49:59.896 [I] Progress on: 71.0it/1.00kit rate:8.8s/it remaining:2:15:29 elapsed:10:38 postfix:- (303899:tqdm_logging.py:145)
Step 72: grad_norm=6.166495323181152, loss=2.098952531814575, param_norm=1886.960693359375
Step 73: grad_norm=13.379403114318848, loss=2.1135871410369873, param_norm=1886.961181640625
23:50:17.351 [I] Progress on: 73.0it/1.00kit rate:8.7s/it remaining:2:15:00 elapsed:10:55 postfix:- (303899:tqdm_logging.py:145)
Step 74: grad_norm=22.338462829589844, loss=2.074276924133301, param_norm=1886.9615478515625
Step 75: grad_norm=7.742990970611572, loss=2.547294855117798, param_norm=1886.9619140625
23:50:34.806 [I] Progress on: 75.0it/1.00kit rate:8.7s/it remaining:2:14:37 elapsed:11:13 postfix:- (303899:tqdm_logging.py:145)
Step 76: grad_norm=5.474956512451172, loss=2.2558562755584717, param_norm=1886.9622802734375
Step 77: grad_norm=7.241878509521484, loss=2.223843812942505, param_norm=1886.962646484375
23:50:52.256 [I] Progress on: 77.0it/1.00kit rate:8.7s/it remaining:2:14:14 elapsed:11:30 postfix:- (303899:tqdm_logging.py:145)
Step 78: grad_norm=21.335054397583008, loss=2.1208484172821045, param_norm=1886.9630126953125
23:51:03.320 [I] Progress on: 78.0it/1.00kit rate:9.4s/it remaining:2:24:54 elapsed:11:41 postfix:- (303899:tqdm_logging.py:145)
Step 79: grad_norm=16.618408203125, loss=1.783069133758545, param_norm=1886.96337890625
Step 80: grad_norm=4.9548845291137695, loss=1.9648323059082031, param_norm=1886.9638671875
23:51:20.712 [I] Progress on: 80.0it/1.00kit rate:9.1s/it remaining:2:18:54 elapsed:11:59 postfix:- (303899:tqdm_logging.py:145)
Step 81: grad_norm=6.355602741241455, loss=2.1055870056152344, param_norm=1886.9642333984375
Step 82: grad_norm=4.951281547546387, loss=1.9095641374588013, param_norm=1886.9647216796875
23:51:38.159 [I] Progress on: 82.0it/1.00kit rate:8.9s/it remaining:2:15:57 elapsed:12:16 postfix:- (303899:tqdm_logging.py:145)
Step 83: grad_norm=6.590163230895996, loss=1.930656909942627, param_norm=1886.9652099609375
Step 84: grad_norm=7.084397315979004, loss=1.8604124784469604, param_norm=1886.9656982421875
23:51:55.643 [I] Progress on: 84.0it/1.00kit rate:8.8s/it remaining:2:14:29 elapsed:12:34 postfix:- (303899:tqdm_logging.py:145)
Step 85: grad_norm=6.982616901397705, loss=2.1162242889404297, param_norm=1886.966064453125
Step 86: grad_norm=5.376754283905029, loss=2.015169143676758, param_norm=1886.96630859375
23:52:13.194 [I] Progress on: 86.0it/1.00kit rate:8.8s/it remaining:2:13:50 elapsed:12:51 postfix:- (303899:tqdm_logging.py:145)
Step 87: grad_norm=6.806673049926758, loss=1.7995368242263794, param_norm=1886.966796875
Step 88: grad_norm=10.33381175994873, loss=1.9398515224456787, param_norm=1886.9671630859375
23:52:30.622 [I] Progress on: 88.0it/1.00kit rate:8.7s/it remaining:2:12:58 elapsed:13:08 postfix:- (303899:tqdm_logging.py:145)
Step 89: grad_norm=9.776752471923828, loss=1.9375927448272705, param_norm=1886.9676513671875
Step 90: grad_norm=10.281718254089355, loss=2.0305681228637695, param_norm=1886.968017578125
23:52:48.061 [I] Progress on: 90.0it/1.00kit rate:8.7s/it remaining:2:12:27 elapsed:13:26 postfix:- (303899:tqdm_logging.py:145)
Step 91: grad_norm=17.02208137512207, loss=2.1955044269561768, param_norm=1886.9683837890625
Step 92: grad_norm=10.378958702087402, loss=2.1333892345428467, param_norm=1886.96875
23:53:05.533 [I] Progress on: 92.0it/1.00kit rate:8.7s/it remaining:2:12:07 elapsed:13:43 postfix:- (303899:tqdm_logging.py:145)
Step 93: grad_norm=13.189537048339844, loss=1.9629335403442383, param_norm=1886.96923828125
Step 94: grad_norm=7.394477844238281, loss=1.7384374141693115, param_norm=1886.9696044921875
23:53:22.984 [I] Progress on: 94.0it/1.00kit rate:8.7s/it remaining:2:11:49 elapsed:14:01 postfix:- (303899:tqdm_logging.py:145)
Step 95: grad_norm=5.34810733795166, loss=1.8625502586364746, param_norm=1886.969970703125
Step 96: grad_norm=7.424908638000488, loss=1.750481128692627, param_norm=1886.9703369140625
23:53:40.440 [I] Progress on: 96.0it/1.00kit rate:8.7s/it remaining:2:11:30 elapsed:14:18 postfix:- (303899:tqdm_logging.py:145)
Step 97: grad_norm=11.309605598449707, loss=1.9563817977905273, param_norm=1886.9708251953125
Step 98: grad_norm=9.252091407775879, loss=2.04032564163208, param_norm=1886.9710693359375
23:53:57.879 [I] Progress on: 98.0it/1.00kit rate:8.7s/it remaining:2:11:07 elapsed:14:36 postfix:- (303899:tqdm_logging.py:145)
Step 99: grad_norm=8.020831108093262, loss=1.9400800466537476, param_norm=1886.9715576171875
Step 100: grad_norm=7.210809230804443, loss=2.0290589332580566, param_norm=1886.971923828125
23:54:15.372 [I] Progress on: 100it/1.00kit rate:8.7s/it remaining:2:10:57 elapsed:14:53 postfix:- (303899:tqdm_logging.py:145)
23:54:15.555 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
23:54:15.555 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (303899:checkpoint_manager.py:1767)
23:54:15.556 [I] [process=0] Saving checkpoint at step 100                                        (303899:checkpoint_manager.py:1286)
23:54:15.557 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100. (303899:async_checkpointer.py:358)
23:54:15.558 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
23:54:15.559 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0 (303899:atomicity.py:144)
23:54:15.560 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
23:54:15.561 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
23:54:15.561 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742874855559898485, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742874855559898485, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (303899:checkpoint.py:185)
23:54:15.562 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (303899:atomicity.py:144)
23:54:15.562 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (303899:atomicity.py:144)
23:54:15.563 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
23:54:15.574 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
23:54:19.339 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
23:54:19.345 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
23:54:19.346 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
23:54:19.347 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
23:54:19.348 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
23:54:19.352 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
23:54:19.354 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
23:54:19.359 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742874855.5550287, 'wait_for_prev_duration_secs': 0.0004792213439941406, 'checkpointer_blocking_start_time': 1742874855.5563612, 'checkpointer_blocking_duration_secs': 3.792348861694336, 'get_old_steps_start_time': 1742874859.3487632, 'get_old_steps_duration_secs': 7.152557373046875e-06, 'checkpoint_manager_blocking_start_time': 1742874855.554798, 'checkpoint_manager_blocking_duration_secs': 3.8044991493225098} (303899:standard_logger.py:34)
Step 101: grad_norm=5.927998065948486, loss=1.8342173099517822, param_norm=1886.9722900390625
23:54:27.942 [I] Progress on: 101it/1.00kit rate:9.9s/it remaining:2:28:07 elapsed:15:06 postfix:- (303899:tqdm_logging.py:145)
23:54:28.084 [I] ChainedFuture completed 1/1 futures in 8.74 seconds.                             (303899:future.py:137)
23:54:28.085 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 827.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
23:54:28.085 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
23:54:28.087 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742874855559898485, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (303899:checkpoint.py:225)
23:54:28.089 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0 (303899:async_checkpointer.py:406)
23:54:28.090 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/assets (303899:atomicity.py:287)
23:54:28.094 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742874855559898485, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (303899:checkpoint.py:244)
23:54:28.104 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0/params (303899:atomicity.py:287)
23:54:28.105 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100 (303899:async_checkpointer.py:416)
23:54:28.105 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0 (303899:async_checkpointer.py:426)
23:54:28.106 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100 (303899:atomicity.py:287)
23:54:28.109 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/100`. (303899:atomicity.py:548)
23:54:28.109 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
23:54:28.110 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
23:54:28.110 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
23:54:28.111 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
23:54:28.111 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 102: grad_norm=9.806083679199219, loss=1.7900484800338745, param_norm=1886.97265625
Step 103: grad_norm=5.981044292449951, loss=1.84626042842865, param_norm=1886.97314453125
23:54:45.589 [I] Progress on: 103it/1.00kit rate:9.3s/it remaining:2:19:36 elapsed:15:23 postfix:- (303899:tqdm_logging.py:145)
Step 104: grad_norm=9.660456657409668, loss=1.9931551218032837, param_norm=1886.9736328125
Step 105: grad_norm=6.296871185302734, loss=1.8875138759613037, param_norm=1886.9739990234375
23:55:03.089 [I] Progress on: 105it/1.00kit rate:9.0s/it remaining:2:14:50 elapsed:15:41 postfix:- (303899:tqdm_logging.py:145)
Step 106: grad_norm=6.557227611541748, loss=1.8878684043884277, param_norm=1886.974365234375
Step 107: grad_norm=7.963056564331055, loss=2.020446538925171, param_norm=1886.974853515625
23:55:20.593 [I] Progress on: 107it/1.00kit rate:8.9s/it remaining:2:12:21 elapsed:15:58 postfix:- (303899:tqdm_logging.py:145)
Step 108: grad_norm=8.042360305786133, loss=2.105836868286133, param_norm=1886.9752197265625
Step 109: grad_norm=6.9152350425720215, loss=1.8641672134399414, param_norm=1886.9755859375
23:55:38.101 [I] Progress on: 109it/1.00kit rate:8.8s/it remaining:2:11:01 elapsed:16:16 postfix:- (303899:tqdm_logging.py:145)
Step 110: grad_norm=8.841716766357422, loss=1.9808037281036377, param_norm=1886.97607421875
Step 111: grad_norm=8.138908386230469, loss=1.7883548736572266, param_norm=1886.9764404296875
23:55:55.613 [I] Progress on: 111it/1.00kit rate:8.8s/it remaining:2:10:16 elapsed:16:33 postfix:- (303899:tqdm_logging.py:145)
Step 112: grad_norm=11.334434509277344, loss=1.9563298225402832, param_norm=1886.9769287109375
Step 113: grad_norm=7.7778520584106445, loss=1.9466004371643066, param_norm=1886.977294921875
23:56:13.146 [I] Progress on: 113it/1.00kit rate:8.8s/it remaining:2:09:45 elapsed:16:51 postfix:- (303899:tqdm_logging.py:145)
Step 114: grad_norm=12.738029479980469, loss=1.783463478088379, param_norm=1886.9779052734375
Step 115: grad_norm=14.45601749420166, loss=2.141538143157959, param_norm=1886.978271484375
23:56:30.631 [I] Progress on: 115it/1.00kit rate:8.8s/it remaining:2:09:14 elapsed:17:08 postfix:- (303899:tqdm_logging.py:145)
Step 116: grad_norm=12.707387924194336, loss=2.0031824111938477, param_norm=1886.9786376953125
23:56:41.412 [I] Progress on: 117it/1.00kit rate:9.3s/it remaining:2:17:05 elapsed:17:19 postfix:- (303899:tqdm_logging.py:145)
Step 117: grad_norm=5.801011085510254, loss=1.74974524974823, param_norm=1886.97900390625
Step 118: grad_norm=7.260053634643555, loss=1.6381548643112183, param_norm=1886.9793701171875
23:56:58.713 [I] Progress on: 118it/1.00kit rate:9.1s/it remaining:2:14:19 elapsed:17:37 postfix:- (303899:tqdm_logging.py:145)
Step 119: grad_norm=5.8864665031433105, loss=1.9685513973236084, param_norm=1886.979736328125
Step 120: grad_norm=8.699127197265625, loss=1.6512341499328613, param_norm=1886.9801025390625
23:57:16.170 [I] Progress on: 120it/1.00kit rate:8.9s/it remaining:2:10:56 elapsed:17:54 postfix:- (303899:tqdm_logging.py:145)
Step 121: grad_norm=7.3678083419799805, loss=1.7418818473815918, param_norm=1886.98046875
Step 122: grad_norm=5.774753093719482, loss=1.6905522346496582, param_norm=1886.98095703125
23:57:33.650 [I] Progress on: 122it/1.00kit rate:8.8s/it remaining:2:09:13 elapsed:18:12 postfix:- (303899:tqdm_logging.py:145)
Step 123: grad_norm=13.408884048461914, loss=1.782301425933838, param_norm=1886.9813232421875
Step 124: grad_norm=5.888496398925781, loss=1.5923130512237549, param_norm=1886.9818115234375
23:57:51.151 [I] Progress on: 124it/1.00kit rate:8.8s/it remaining:2:08:17 elapsed:18:29 postfix:- (303899:tqdm_logging.py:145)
Step 125: grad_norm=7.221482276916504, loss=1.6852798461914062, param_norm=1886.9822998046875
Step 126: grad_norm=12.719801902770996, loss=1.7281025648117065, param_norm=1886.9827880859375
23:58:08.695 [I] Progress on: 126it/1.00kit rate:8.8s/it remaining:2:07:54 elapsed:18:47 postfix:- (303899:tqdm_logging.py:145)
Step 127: grad_norm=9.209770202636719, loss=1.712307095527649, param_norm=1886.983154296875
Step 128: grad_norm=6.170481204986572, loss=1.7814799547195435, param_norm=1886.983642578125
23:58:26.184 [I] Progress on: 128it/1.00kit rate:8.8s/it remaining:2:07:18 elapsed:19:04 postfix:- (303899:tqdm_logging.py:145)
Step 129: grad_norm=10.880472183227539, loss=1.6239792108535767, param_norm=1886.9842529296875
Step 130: grad_norm=10.73802375793457, loss=1.5688538551330566, param_norm=1886.984619140625
23:58:43.659 [I] Progress on: 130it/1.00kit rate:8.7s/it remaining:2:06:49 elapsed:19:22 postfix:- (303899:tqdm_logging.py:145)
Step 131: grad_norm=7.900673866271973, loss=1.737824559211731, param_norm=1886.985107421875
Step 132: grad_norm=9.425307273864746, loss=1.6177563667297363, param_norm=1886.9857177734375
23:59:01.138 [I] Progress on: 132it/1.00kit rate:8.7s/it remaining:2:06:29 elapsed:19:39 postfix:- (303899:tqdm_logging.py:145)
Step 133: grad_norm=6.06142520904541, loss=1.4972809553146362, param_norm=1886.986083984375
Step 134: grad_norm=8.102835655212402, loss=1.4834625720977783, param_norm=1886.9864501953125
23:59:18.613 [I] Progress on: 134it/1.00kit rate:8.7s/it remaining:2:06:07 elapsed:19:56 postfix:- (303899:tqdm_logging.py:145)
Step 135: grad_norm=6.0761518478393555, loss=1.5020928382873535, param_norm=1886.9869384765625
Step 136: grad_norm=8.809810638427734, loss=1.7449543476104736, param_norm=1886.9873046875
23:59:36.101 [I] Progress on: 136it/1.00kit rate:8.7s/it remaining:2:05:52 elapsed:20:14 postfix:- (303899:tqdm_logging.py:145)
Step 137: grad_norm=11.848105430603027, loss=1.6378306150436401, param_norm=1886.98779296875
Step 138: grad_norm=6.383279800415039, loss=1.6557427644729614, param_norm=1886.9881591796875
23:59:53.594 [I] Progress on: 138it/1.00kit rate:8.7s/it remaining:2:05:35 elapsed:20:31 postfix:- (303899:tqdm_logging.py:145)
Step 139: grad_norm=6.3844404220581055, loss=1.7717303037643433, param_norm=1886.9886474609375
Step 140: grad_norm=10.341450691223145, loss=1.6400063037872314, param_norm=1886.9891357421875
00:00:11.065 [I] Progress on: 140it/1.00kit rate:8.7s/it remaining:2:05:14 elapsed:20:49 postfix:- (303899:tqdm_logging.py:145)
Step 141: grad_norm=17.817094802856445, loss=1.5550553798675537, param_norm=1886.9896240234375
Step 142: grad_norm=6.934912204742432, loss=1.5449838638305664, param_norm=1886.9901123046875
00:00:28.549 [I] Progress on: 142it/1.00kit rate:8.7s/it remaining:2:04:57 elapsed:21:06 postfix:- (303899:tqdm_logging.py:145)
Step 143: grad_norm=8.006590843200684, loss=1.569563865661621, param_norm=1886.990478515625
Step 144: grad_norm=9.11251163482666, loss=1.7517290115356445, param_norm=1886.9910888671875
00:00:46.034 [I] Progress on: 144it/1.00kit rate:8.7s/it remaining:2:04:41 elapsed:21:24 postfix:- (303899:tqdm_logging.py:145)
Step 145: grad_norm=11.338685035705566, loss=1.5199506282806396, param_norm=1886.991455078125
Step 146: grad_norm=6.240157127380371, loss=1.601239800453186, param_norm=1886.9918212890625
00:01:03.598 [I] Progress on: 146it/1.00kit rate:8.8s/it remaining:2:04:42 elapsed:21:41 postfix:- (303899:tqdm_logging.py:145)
Step 147: grad_norm=9.644269943237305, loss=1.64493989944458, param_norm=1886.9921875
Step 148: grad_norm=15.282816886901855, loss=1.6328799724578857, param_norm=1886.99267578125
00:01:21.141 [I] Progress on: 148it/1.00kit rate:8.8s/it remaining:2:04:28 elapsed:21:59 postfix:- (303899:tqdm_logging.py:145)
Step 149: grad_norm=24.765771865844727, loss=1.6940808296203613, param_norm=1886.9930419921875
Step 150: grad_norm=26.076387405395508, loss=1.6740713119506836, param_norm=1886.993408203125
00:01:38.691 [I] Progress on: 150it/1.00kit rate:8.8s/it remaining:2:04:13 elapsed:22:17 postfix:- (303899:tqdm_logging.py:145)
Step 151: grad_norm=25.434253692626953, loss=1.5690202713012695, param_norm=1886.9937744140625
Step 152: grad_norm=9.610152244567871, loss=1.7555465698242188, param_norm=1886.994140625
00:01:56.250 [I] Progress on: 152it/1.00kit rate:8.8s/it remaining:2:03:58 elapsed:22:34 postfix:- (303899:tqdm_logging.py:145)
Step 153: grad_norm=15.584990501403809, loss=1.9035066366195679, param_norm=1886.9945068359375
Step 154: grad_norm=20.1268367767334, loss=1.8944988250732422, param_norm=1886.994873046875
00:02:13.721 [I] Progress on: 154it/1.00kit rate:8.8s/it remaining:2:03:25 elapsed:22:52 postfix:- (303899:tqdm_logging.py:145)
Step 155: grad_norm=21.243831634521484, loss=1.5555236339569092, param_norm=1886.9952392578125
00:02:25.092 [I] Progress on: 156it/1.00kit rate:9.5s/it remaining:2:13:27 elapsed:23:03 postfix:- (303899:tqdm_logging.py:145)
Step 156: grad_norm=15.571743965148926, loss=1.3216893672943115, param_norm=1886.99560546875
Step 157: grad_norm=8.448857307434082, loss=1.385500431060791, param_norm=1886.9959716796875
00:02:42.386 [I] Progress on: 157it/1.00kit rate:9.3s/it remaining:2:09:59 elapsed:23:20 postfix:- (303899:tqdm_logging.py:145)
Step 158: grad_norm=11.380318641662598, loss=1.4406392574310303, param_norm=1886.996337890625
Step 159: grad_norm=6.96160888671875, loss=1.4694206714630127, param_norm=1886.9967041015625
00:02:59.963 [I] Progress on: 159it/1.00kit rate:9.0s/it remaining:2:06:14 elapsed:23:38 postfix:- (303899:tqdm_logging.py:145)
Step 160: grad_norm=21.36919593811035, loss=1.5641648769378662, param_norm=1886.9970703125
Step 161: grad_norm=22.652843475341797, loss=1.553655982017517, param_norm=1886.997314453125
00:03:17.488 [I] Progress on: 161it/1.00kit rate:8.9s/it remaining:2:04:08 elapsed:23:55 postfix:- (303899:tqdm_logging.py:145)
Step 162: grad_norm=6.405803203582764, loss=1.500394582748413, param_norm=1886.997802734375
Step 163: grad_norm=6.116301536560059, loss=1.6500797271728516, param_norm=1886.9981689453125
00:03:35.051 [I] Progress on: 163it/1.00kit rate:8.8s/it remaining:2:03:05 elapsed:24:13 postfix:- (303899:tqdm_logging.py:145)
Step 164: grad_norm=9.163142204284668, loss=1.5373657941818237, param_norm=1886.9984130859375
Step 165: grad_norm=19.308338165283203, loss=1.5151100158691406, param_norm=1886.998779296875
00:03:52.596 [I] Progress on: 165it/1.00kit rate:8.8s/it remaining:2:02:18 elapsed:24:30 postfix:- (303899:tqdm_logging.py:145)
Step 166: grad_norm=8.734792709350586, loss=1.4794807434082031, param_norm=1886.9991455078125
Step 167: grad_norm=10.953584671020508, loss=1.5600398778915405, param_norm=1886.9996337890625
00:04:10.208 [I] Progress on: 167it/1.00kit rate:8.8s/it remaining:2:02:02 elapsed:24:48 postfix:- (303899:tqdm_logging.py:145)
Step 168: grad_norm=11.970956802368164, loss=1.2479591369628906, param_norm=1887.0
Step 169: grad_norm=9.403451919555664, loss=1.5107433795928955, param_norm=1887.0003662109375
00:04:27.735 [I] Progress on: 169it/1.00kit rate:8.8s/it remaining:2:01:29 elapsed:25:06 postfix:- (303899:tqdm_logging.py:145)
Step 170: grad_norm=12.834903717041016, loss=1.5154874324798584, param_norm=1887.000732421875
Step 171: grad_norm=5.713535785675049, loss=1.4171268939971924, param_norm=1887.001220703125
00:04:45.352 [I] Progress on: 171it/1.00kit rate:8.8s/it remaining:2:01:23 elapsed:25:23 postfix:- (303899:tqdm_logging.py:145)
Step 172: grad_norm=11.197011947631836, loss=1.4154174327850342, param_norm=1887.0015869140625
Step 173: grad_norm=11.595904350280762, loss=1.3765711784362793, param_norm=1887.001953125
00:05:02.905 [I] Progress on: 173it/1.00kit rate:8.8s/it remaining:2:00:55 elapsed:25:41 postfix:- (303899:tqdm_logging.py:145)
Step 174: grad_norm=10.282206535339355, loss=1.451584815979004, param_norm=1887.0023193359375
Step 175: grad_norm=7.81541633605957, loss=1.4185843467712402, param_norm=1887.0028076171875
00:05:20.645 [I] Progress on: 175it/1.00kit rate:8.8s/it remaining:2:00:41 elapsed:25:59 postfix:- (303899:tqdm_logging.py:145)
Step 176: grad_norm=7.217141628265381, loss=1.3215241432189941, param_norm=1887.0032958984375
Step 177: grad_norm=6.0688300132751465, loss=1.3949425220489502, param_norm=1887.0035400390625
00:05:38.199 [I] Progress on: 177it/1.00kit rate:8.8s/it remaining:2:00:44 elapsed:26:16 postfix:- (303899:tqdm_logging.py:145)
Step 178: grad_norm=6.080413341522217, loss=1.2170186042785645, param_norm=1887.0040283203125
Step 179: grad_norm=8.162276268005371, loss=1.4970424175262451, param_norm=1887.00439453125
00:05:55.784 [I] Progress on: 179it/1.00kit rate:8.8s/it remaining:2:00:15 elapsed:26:34 postfix:- (303899:tqdm_logging.py:145)
Step 180: grad_norm=9.402397155761719, loss=1.346785545349121, param_norm=1887.004638671875
Step 181: grad_norm=8.968853950500488, loss=1.549185037612915, param_norm=1887.005126953125
00:06:13.324 [I] Progress on: 181it/1.00kit rate:8.8s/it remaining:1:59:46 elapsed:26:51 postfix:- (303899:tqdm_logging.py:145)
Step 182: grad_norm=6.635161876678467, loss=1.5287928581237793, param_norm=1887.0054931640625
Step 183: grad_norm=8.874021530151367, loss=1.4616408348083496, param_norm=1887.0059814453125
00:06:30.906 [I] Progress on: 183it/1.00kit rate:8.8s/it remaining:1:59:29 elapsed:27:09 postfix:- (303899:tqdm_logging.py:145)
Step 184: grad_norm=5.916449546813965, loss=1.4282584190368652, param_norm=1887.00634765625
Step 185: grad_norm=10.403164863586426, loss=1.4183270931243896, param_norm=1887.0068359375
00:06:48.441 [I] Progress on: 185it/1.00kit rate:8.8s/it remaining:1:59:06 elapsed:27:26 postfix:- (303899:tqdm_logging.py:145)
Step 186: grad_norm=11.547024726867676, loss=1.3959873914718628, param_norm=1887.00732421875
Step 187: grad_norm=6.894984245300293, loss=1.1854475736618042, param_norm=1887.0076904296875
00:07:06.022 [I] Progress on: 187it/1.00kit rate:8.8s/it remaining:1:58:51 elapsed:27:44 postfix:- (303899:tqdm_logging.py:145)
Step 188: grad_norm=17.65721321105957, loss=1.44443941116333, param_norm=1887.0081787109375
Step 189: grad_norm=9.428314208984375, loss=1.5115551948547363, param_norm=1887.0086669921875
00:07:23.557 [I] Progress on: 189it/1.00kit rate:8.8s/it remaining:1:58:27 elapsed:28:01 postfix:- (303899:tqdm_logging.py:145)
Step 190: grad_norm=9.449950218200684, loss=1.4588820934295654, param_norm=1887.009033203125
Step 191: grad_norm=6.790902614593506, loss=1.4175751209259033, param_norm=1887.0093994140625
00:07:41.152 [I] Progress on: 191it/1.00kit rate:8.8s/it remaining:1:58:17 elapsed:28:19 postfix:- (303899:tqdm_logging.py:145)
Step 192: grad_norm=21.07402229309082, loss=1.3394137620925903, param_norm=1887.009765625
Step 193: grad_norm=21.499961853027344, loss=1.4203131198883057, param_norm=1887.01025390625
00:07:58.705 [I] Progress on: 193it/1.00kit rate:8.8s/it remaining:1:57:57 elapsed:28:37 postfix:- (303899:tqdm_logging.py:145)
Step 194: grad_norm=22.959674835205078, loss=1.3269994258880615, param_norm=1887.0106201171875
00:08:10.007 [I] Progress on: 195it/1.00kit rate:9.5s/it remaining:2:07:08 elapsed:28:48 postfix:- (303899:tqdm_logging.py:145)
Step 195: grad_norm=14.038992881774902, loss=1.255262017250061, param_norm=1887.0108642578125
Step 196: grad_norm=9.083051681518555, loss=1.4407482147216797, param_norm=1887.0113525390625
00:08:27.332 [I] Progress on: 196it/1.00kit rate:9.2s/it remaining:2:03:55 elapsed:29:05 postfix:- (303899:tqdm_logging.py:145)
Step 197: grad_norm=16.928287506103516, loss=1.4094151258468628, param_norm=1887.0115966796875
Step 198: grad_norm=21.229394912719727, loss=1.2597036361694336, param_norm=1887.011962890625
00:08:44.920 [I] Progress on: 198it/1.00kit rate:9.0s/it remaining:2:00:26 elapsed:29:23 postfix:- (303899:tqdm_logging.py:145)
Step 199: grad_norm=20.16468048095703, loss=1.1778203248977661, param_norm=1887.0123291015625
Step 200: grad_norm=14.890389442443848, loss=1.281097412109375, param_norm=1887.0126953125
00:09:02.498 [I] Progress on: 200it/1.00kit rate:8.9s/it remaining:1:58:34 elapsed:29:40 postfix:- (303899:tqdm_logging.py:145)
00:09:02.770 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
00:09:02.770 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
00:09:02.770 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (303899:checkpoint_manager.py:1786)
00:09:02.770 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (303899:checkpoint_manager.py:1817)
00:09:02.771 [I] [process=0] Saving checkpoint at step 200                                        (303899:checkpoint_manager.py:1286)
00:09:02.772 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200. (303899:async_checkpointer.py:358)
00:09:02.773 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:09:02.773 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3 (303899:atomicity.py:144)
00:09:02.788 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:09:02.788 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:09:02.789 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (303899:atomicity.py:144)
00:09:02.789 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (303899:atomicity.py:144)
00:09:02.790 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:09:02.795 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
00:09:06.493 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:09:06.497 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
00:09:06.499 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
00:09:06.502 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:09:06.500 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
00:09:06.502 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
00:09:06.506 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
00:09:06.511 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
00:09:06.518 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742875742.7703767, 'wait_for_prev_duration_secs': 0.0006690025329589844, 'checkpointer_blocking_start_time': 1742875742.7716951, 'checkpointer_blocking_duration_secs': 3.730138063430786, 'get_old_steps_start_time': 1742875746.501898, 'get_old_steps_duration_secs': 0.0005106925964355469, 'checkpoint_manager_blocking_start_time': 1742875742.770209, 'checkpoint_manager_blocking_duration_secs': 3.7478020191192627} (303899:standard_logger.py:34)
00:09:13.765 [I] ChainedFuture completed 1/1 futures in 7.26 seconds.                             (303899:future.py:137)
00:09:13.766 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 943.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:09:13.767 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
00:09:13.768 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3 (303899:async_checkpointer.py:406)
00:09:13.769 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3/assets (303899:atomicity.py:287)
00:09:13.779 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3/params (303899:atomicity.py:287)
00:09:13.780 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200 (303899:async_checkpointer.py:416)
00:09:13.780 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3 (303899:async_checkpointer.py:426)
00:09:13.781 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200 (303899:atomicity.py:287)
00:09:13.782 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/200`. (303899:atomicity.py:548)
00:09:13.782 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
00:09:13.783 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
00:09:13.783 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
00:09:13.784 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
00:09:13.784 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 201: grad_norm=9.014001846313477, loss=1.3577635288238525, param_norm=1887.012939453125
00:09:15.117 [I] Progress on: 201it/1.00kit rate:10.0s/it remaining:2:13:23 elapsed:29:53 postfix:- (303899:tqdm_logging.py:145)
Step 202: grad_norm=5.980220317840576, loss=1.2976624965667725, param_norm=1887.013427734375
Step 203: grad_norm=9.349708557128906, loss=1.342586636543274, param_norm=1887.0137939453125
00:09:32.617 [I] Progress on: 203it/1.00kit rate:9.4s/it remaining:2:04:31 elapsed:30:10 postfix:- (303899:tqdm_logging.py:145)
Step 204: grad_norm=21.20881462097168, loss=1.360637903213501, param_norm=1887.0142822265625
Step 205: grad_norm=15.303502082824707, loss=1.1664403676986694, param_norm=1887.0146484375
00:09:50.207 [I] Progress on: 205it/1.00kit rate:9.1s/it remaining:2:00:23 elapsed:30:28 postfix:- (303899:tqdm_logging.py:145)
Step 206: grad_norm=12.669111251831055, loss=1.201645016670227, param_norm=1887.01513671875
Step 207: grad_norm=7.19557523727417, loss=1.364493489265442, param_norm=1887.0155029296875
00:10:07.740 [I] Progress on: 207it/1.00kit rate:8.9s/it remaining:1:57:59 elapsed:30:46 postfix:- (303899:tqdm_logging.py:145)
Step 208: grad_norm=9.97001838684082, loss=1.3791491985321045, param_norm=1887.015869140625
Step 209: grad_norm=15.600485801696777, loss=1.0348646640777588, param_norm=1887.0162353515625
00:10:25.305 [I] Progress on: 209it/1.00kit rate:8.9s/it remaining:1:56:48 elapsed:31:03 postfix:- (303899:tqdm_logging.py:145)
Step 210: grad_norm=6.915574550628662, loss=1.2645190954208374, param_norm=1887.0166015625
Step 211: grad_norm=11.72983169555664, loss=1.288503885269165, param_norm=1887.0169677734375
00:10:42.830 [I] Progress on: 211it/1.00kit rate:8.8s/it remaining:1:55:53 elapsed:31:21 postfix:- (303899:tqdm_logging.py:145)
Step 212: grad_norm=8.105586051940918, loss=1.2044070959091187, param_norm=1887.017333984375
Step 213: grad_norm=6.25105619430542, loss=1.2158946990966797, param_norm=1887.0177001953125
00:11:00.537 [I] Progress on: 213it/1.00kit rate:8.8s/it remaining:1:55:52 elapsed:31:38 postfix:- (303899:tqdm_logging.py:145)
Step 214: grad_norm=6.932722568511963, loss=1.2765932083129883, param_norm=1887.01806640625
Step 215: grad_norm=24.672990798950195, loss=1.2647137641906738, param_norm=1887.0185546875
00:11:18.076 [I] Progress on: 215it/1.00kit rate:8.8s/it remaining:1:55:12 elapsed:31:56 postfix:- (303899:tqdm_logging.py:145)
Step 216: grad_norm=15.387948989868164, loss=1.3628153800964355, param_norm=1887.0189208984375
Step 217: grad_norm=14.288833618164062, loss=1.3620870113372803, param_norm=1887.0191650390625
00:11:35.651 [I] Progress on: 217it/1.00kit rate:8.8s/it remaining:1:54:53 elapsed:32:14 postfix:- (303899:tqdm_logging.py:145)
Step 218: grad_norm=10.694000244140625, loss=1.2378489971160889, param_norm=1887.0196533203125
Step 219: grad_norm=12.367788314819336, loss=1.21626615524292, param_norm=1887.0198974609375
00:11:53.188 [I] Progress on: 219it/1.00kit rate:8.8s/it remaining:1:54:23 elapsed:32:31 postfix:- (303899:tqdm_logging.py:145)
Step 220: grad_norm=11.94662094116211, loss=1.0008618831634521, param_norm=1887.0203857421875
Step 221: grad_norm=9.294889450073242, loss=1.3375564813613892, param_norm=1887.020751953125
00:12:10.777 [I] Progress on: 221it/1.00kit rate:8.8s/it remaining:1:54:13 elapsed:32:49 postfix:- (303899:tqdm_logging.py:145)
Step 222: grad_norm=9.31128215789795, loss=1.1912682056427002, param_norm=1887.0211181640625
Step 223: grad_norm=15.901140213012695, loss=1.41243314743042, param_norm=1887.0216064453125
00:12:28.306 [I] Progress on: 223it/1.00kit rate:8.8s/it remaining:1:53:47 elapsed:33:06 postfix:- (303899:tqdm_logging.py:145)
Step 224: grad_norm=6.249353885650635, loss=1.3012573719024658, param_norm=1887.02197265625
Step 225: grad_norm=15.853151321411133, loss=1.2278516292572021, param_norm=1887.0224609375
00:12:45.881 [I] Progress on: 225it/1.00kit rate:8.8s/it remaining:1:53:34 elapsed:33:24 postfix:- (303899:tqdm_logging.py:145)
Step 226: grad_norm=8.850065231323242, loss=1.263843059539795, param_norm=1887.02294921875
Step 227: grad_norm=7.506428241729736, loss=1.2594139575958252, param_norm=1887.0233154296875
00:13:03.443 [I] Progress on: 227it/1.00kit rate:8.8s/it remaining:1:53:12 elapsed:33:41 postfix:- (303899:tqdm_logging.py:145)
Step 228: grad_norm=9.099212646484375, loss=1.3052476644515991, param_norm=1887.023681640625
Step 229: grad_norm=7.6955485343933105, loss=1.1722370386123657, param_norm=1887.0240478515625
00:13:20.971 [I] Progress on: 229it/1.00kit rate:8.8s/it remaining:1:52:49 elapsed:33:59 postfix:- (303899:tqdm_logging.py:145)
Step 230: grad_norm=5.118692398071289, loss=1.0668079853057861, param_norm=1887.024658203125
Step 231: grad_norm=7.439823150634766, loss=1.087011456489563, param_norm=1887.0250244140625
00:13:38.482 [I] Progress on: 231it/1.00kit rate:8.8s/it remaining:1:52:25 elapsed:34:16 postfix:- (303899:tqdm_logging.py:145)
Step 232: grad_norm=9.982809066772461, loss=1.1778852939605713, param_norm=1887.025390625
Step 233: grad_norm=9.247077941894531, loss=1.3995113372802734, param_norm=1887.02587890625
00:13:56.030 [I] Progress on: 233it/1.00kit rate:8.8s/it remaining:1:52:12 elapsed:34:34 postfix:- (303899:tqdm_logging.py:145)
Step 234: grad_norm=11.981010437011719, loss=1.0472049713134766, param_norm=1887.026123046875
00:14:06.987 [I] Progress on: 234it/1.00kit rate:9.4s/it remaining:2:00:27 elapsed:34:45 postfix:- (303899:tqdm_logging.py:145)
Step 235: grad_norm=9.437999725341797, loss=0.9797122478485107, param_norm=1887.026611328125
Step 236: grad_norm=6.76935338973999, loss=0.9696860909461975, param_norm=1887.0269775390625
00:14:24.557 [I] Progress on: 236it/1.00kit rate:9.1s/it remaining:1:55:51 elapsed:35:02 postfix:- (303899:tqdm_logging.py:145)
Step 237: grad_norm=8.759720802307129, loss=1.0344791412353516, param_norm=1887.02734375
Step 238: grad_norm=12.527055740356445, loss=1.000537633895874, param_norm=1887.0277099609375
00:14:42.136 [I] Progress on: 238it/1.00kit rate:8.9s/it remaining:1:53:31 elapsed:35:20 postfix:- (303899:tqdm_logging.py:145)
Step 239: grad_norm=10.943031311035156, loss=1.1028074026107788, param_norm=1887.0281982421875
Step 240: grad_norm=7.9166741371154785, loss=1.0270812511444092, param_norm=1887.028564453125
00:14:59.699 [I] Progress on: 240it/1.00kit rate:8.9s/it remaining:1:52:12 elapsed:35:38 postfix:- (303899:tqdm_logging.py:145)
Step 241: grad_norm=10.740599632263184, loss=1.1006237268447876, param_norm=1887.029052734375
Step 242: grad_norm=14.819396018981934, loss=1.0899147987365723, param_norm=1887.029541015625
00:15:17.258 [I] Progress on: 242it/1.00kit rate:8.8s/it remaining:1:51:22 elapsed:35:55 postfix:- (303899:tqdm_logging.py:145)
Step 243: grad_norm=13.265007019042969, loss=1.048322319984436, param_norm=1887.0299072265625
Step 244: grad_norm=17.57646369934082, loss=1.2126216888427734, param_norm=1887.0303955078125
00:15:34.769 [I] Progress on: 244it/1.00kit rate:8.8s/it remaining:1:50:45 elapsed:36:13 postfix:- (303899:tqdm_logging.py:145)
Step 245: grad_norm=6.86895227432251, loss=1.0637035369873047, param_norm=1887.0306396484375
Step 246: grad_norm=9.063040733337402, loss=1.0083894729614258, param_norm=1887.031005859375
00:15:52.292 [I] Progress on: 246it/1.00kit rate:8.8s/it remaining:1:50:18 elapsed:36:30 postfix:- (303899:tqdm_logging.py:145)
Step 247: grad_norm=17.709911346435547, loss=1.0696444511413574, param_norm=1887.0313720703125
Step 248: grad_norm=10.726222038269043, loss=1.0831750631332397, param_norm=1887.03173828125
00:16:09.780 [I] Progress on: 248it/1.00kit rate:8.8s/it remaining:1:49:46 elapsed:36:48 postfix:- (303899:tqdm_logging.py:145)
Step 249: grad_norm=11.85402774810791, loss=1.015139102935791, param_norm=1887.0321044921875
Step 250: grad_norm=10.106146812438965, loss=1.0942586660385132, param_norm=1887.032470703125
00:16:27.282 [I] Progress on: 250it/1.00kit rate:8.8s/it remaining:1:49:23 elapsed:37:05 postfix:- (303899:tqdm_logging.py:145)
Step 251: grad_norm=7.040125370025635, loss=1.0327517986297607, param_norm=1887.0328369140625
Step 252: grad_norm=6.298152446746826, loss=1.0987722873687744, param_norm=1887.0333251953125
00:16:44.838 [I] Progress on: 252it/1.00kit rate:8.8s/it remaining:1:49:09 elapsed:37:23 postfix:- (303899:tqdm_logging.py:145)
Step 253: grad_norm=25.940649032592773, loss=1.1400460004806519, param_norm=1887.03369140625
Step 254: grad_norm=18.242082595825195, loss=1.091660737991333, param_norm=1887.0340576171875
00:17:02.387 [I] Progress on: 254it/1.00kit rate:8.8s/it remaining:1:48:55 elapsed:37:40 postfix:- (303899:tqdm_logging.py:145)
Step 255: grad_norm=17.262928009033203, loss=1.0803284645080566, param_norm=1887.034423828125
Step 256: grad_norm=9.754611015319824, loss=1.0552635192871094, param_norm=1887.0347900390625
00:17:19.968 [I] Progress on: 256it/1.00kit rate:8.8s/it remaining:1:48:45 elapsed:37:58 postfix:- (303899:tqdm_logging.py:145)
Step 257: grad_norm=6.061725616455078, loss=1.152694821357727, param_norm=1887.0352783203125
Step 258: grad_norm=7.087112903594971, loss=1.1626702547073364, param_norm=1887.0355224609375
00:17:37.571 [I] Progress on: 258it/1.00kit rate:8.8s/it remaining:1:48:37 elapsed:38:15 postfix:- (303899:tqdm_logging.py:145)
Step 259: grad_norm=20.57259178161621, loss=1.0277384519577026, param_norm=1887.0360107421875
Step 260: grad_norm=13.163579940795898, loss=1.1657464504241943, param_norm=1887.0362548828125
00:17:55.184 [I] Progress on: 260it/1.00kit rate:8.8s/it remaining:1:48:26 elapsed:38:33 postfix:- (303899:tqdm_logging.py:145)
Step 261: grad_norm=10.203280448913574, loss=1.0546562671661377, param_norm=1887.0367431640625
Step 262: grad_norm=7.574260711669922, loss=1.0181138515472412, param_norm=1887.0369873046875
00:18:12.791 [I] Progress on: 262it/1.00kit rate:8.8s/it remaining:1:48:09 elapsed:38:51 postfix:- (303899:tqdm_logging.py:145)
Step 263: grad_norm=7.805873870849609, loss=1.0556118488311768, param_norm=1887.037353515625
Step 264: grad_norm=5.666090965270996, loss=1.0882973670959473, param_norm=1887.03759765625
00:18:30.428 [I] Progress on: 264it/1.00kit rate:8.8s/it remaining:1:47:57 elapsed:39:08 postfix:- (303899:tqdm_logging.py:145)
Step 265: grad_norm=13.101223945617676, loss=1.1036345958709717, param_norm=1887.0379638671875
Step 266: grad_norm=15.377729415893555, loss=1.2093095779418945, param_norm=1887.038330078125
00:18:48.155 [I] Progress on: 266it/1.00kit rate:8.8s/it remaining:1:47:45 elapsed:39:26 postfix:- (303899:tqdm_logging.py:145)
Step 267: grad_norm=8.418133735656738, loss=1.0932625532150269, param_norm=1887.0386962890625
Step 268: grad_norm=10.254738807678223, loss=1.0462905168533325, param_norm=1887.0390625
00:19:05.862 [I] Progress on: 268it/1.00kit rate:8.8s/it remaining:1:47:56 elapsed:39:44 postfix:- (303899:tqdm_logging.py:145)
Step 269: grad_norm=7.585623741149902, loss=1.2060472965240479, param_norm=1887.0394287109375
Step 270: grad_norm=7.340352535247803, loss=1.0033705234527588, param_norm=1887.0399169921875
00:19:23.540 [I] Progress on: 270it/1.00kit rate:8.8s/it remaining:1:47:31 elapsed:40:01 postfix:- (303899:tqdm_logging.py:145)
Step 271: grad_norm=14.576475143432617, loss=0.988564670085907, param_norm=1887.0401611328125
Step 272: grad_norm=6.8952226638793945, loss=1.0408533811569214, param_norm=1887.04052734375
00:19:41.226 [I] Progress on: 272it/1.00kit rate:8.8s/it remaining:1:47:11 elapsed:40:19 postfix:- (303899:tqdm_logging.py:145)
Step 273: grad_norm=6.036710739135742, loss=0.8622622489929199, param_norm=1887.0408935546875
00:19:52.274 [I] Progress on: 273it/1.00kit rate:9.5s/it remaining:1:55:09 elapsed:40:30 postfix:- (303899:tqdm_logging.py:145)
Step 274: grad_norm=7.5183234214782715, loss=0.8289037942886353, param_norm=1887.041259765625
Step 275: grad_norm=5.596288204193115, loss=0.932892918586731, param_norm=1887.0416259765625
00:20:09.879 [I] Progress on: 275it/1.00kit rate:9.1s/it remaining:1:50:31 elapsed:40:48 postfix:- (303899:tqdm_logging.py:145)
Step 276: grad_norm=14.190288543701172, loss=0.9311647415161133, param_norm=1887.0419921875
Step 277: grad_norm=12.071678161621094, loss=0.9455376267433167, param_norm=1887.042236328125
00:20:27.580 [I] Progress on: 277it/1.00kit rate:9.0s/it remaining:1:48:22 elapsed:41:05 postfix:- (303899:tqdm_logging.py:145)
Step 278: grad_norm=7.546536922454834, loss=0.9845618009567261, param_norm=1887.0426025390625
Step 279: grad_norm=10.343701362609863, loss=1.0103439092636108, param_norm=1887.04296875
00:20:45.286 [I] Progress on: 279it/1.00kit rate:8.9s/it remaining:1:47:12 elapsed:41:23 postfix:- (303899:tqdm_logging.py:145)
Step 280: grad_norm=8.477198600769043, loss=0.8374130725860596, param_norm=1887.04345703125
Step 281: grad_norm=5.749992847442627, loss=0.8971415162086487, param_norm=1887.043701171875
00:21:03.016 [I] Progress on: 281it/1.00kit rate:8.9s/it remaining:1:46:35 elapsed:41:41 postfix:- (303899:tqdm_logging.py:145)
Step 282: grad_norm=8.63412857055664, loss=0.9351745247840881, param_norm=1887.0440673828125
Step 283: grad_norm=12.51019287109375, loss=0.9155080318450928, param_norm=1887.04443359375
00:21:20.729 [I] Progress on: 283it/1.00kit rate:8.9s/it remaining:1:46:07 elapsed:41:59 postfix:- (303899:tqdm_logging.py:145)
Step 284: grad_norm=6.470760822296143, loss=0.8657945394515991, param_norm=1887.0447998046875
Step 285: grad_norm=12.153205871582031, loss=1.038804292678833, param_norm=1887.045166015625
00:21:38.441 [I] Progress on: 285it/1.00kit rate:8.9s/it remaining:1:45:40 elapsed:42:16 postfix:- (303899:tqdm_logging.py:145)
Step 286: grad_norm=6.277729511260986, loss=0.9589707851409912, param_norm=1887.0455322265625
Step 287: grad_norm=8.325654983520508, loss=0.9175989627838135, param_norm=1887.0457763671875
00:21:56.133 [I] Progress on: 287it/1.00kit rate:8.9s/it remaining:1:45:17 elapsed:42:34 postfix:- (303899:tqdm_logging.py:145)
Step 288: grad_norm=7.478527069091797, loss=0.9877325296401978, param_norm=1887.0462646484375
Step 289: grad_norm=16.309181213378906, loss=0.9092668294906616, param_norm=1887.0465087890625
00:22:13.836 [I] Progress on: 289it/1.00kit rate:8.9s/it remaining:1:44:58 elapsed:42:52 postfix:- (303899:tqdm_logging.py:145)
Step 290: grad_norm=14.211885452270508, loss=1.138972520828247, param_norm=1887.046875
Step 291: grad_norm=16.52545928955078, loss=0.8740423321723938, param_norm=1887.0472412109375
00:22:31.526 [I] Progress on: 291it/1.00kit rate:8.9s/it remaining:1:44:37 elapsed:43:09 postfix:- (303899:tqdm_logging.py:145)
Step 292: grad_norm=5.672420024871826, loss=0.9535065293312073, param_norm=1887.047607421875
Step 293: grad_norm=10.201679229736328, loss=0.9614425897598267, param_norm=1887.0479736328125
00:22:49.187 [I] Progress on: 293it/1.00kit rate:8.8s/it remaining:1:44:13 elapsed:43:27 postfix:- (303899:tqdm_logging.py:145)
Step 294: grad_norm=9.953736305236816, loss=0.9066540002822876, param_norm=1887.04833984375
Step 295: grad_norm=7.077638626098633, loss=0.8802201747894287, param_norm=1887.0487060546875
00:23:06.862 [I] Progress on: 295it/1.00kit rate:8.8s/it remaining:1:43:55 elapsed:43:45 postfix:- (303899:tqdm_logging.py:145)
Step 296: grad_norm=10.69229507446289, loss=0.8648254871368408, param_norm=1887.049072265625
Step 297: grad_norm=5.189295768737793, loss=0.9022431969642639, param_norm=1887.04931640625
00:23:24.505 [I] Progress on: 297it/1.00kit rate:8.8s/it remaining:1:43:30 elapsed:44:02 postfix:- (303899:tqdm_logging.py:145)
Step 298: grad_norm=14.536502838134766, loss=0.9011430144309998, param_norm=1887.0496826171875
Step 299: grad_norm=13.018404006958008, loss=1.0148690938949585, param_norm=1887.0499267578125
00:23:42.103 [I] Progress on: 299it/1.00kit rate:8.8s/it remaining:1:43:00 elapsed:44:20 postfix:- (303899:tqdm_logging.py:145)
Step 300: grad_norm=20.164562225341797, loss=1.0314183235168457, param_norm=1887.05029296875
00:23:51.106 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
00:23:51.106 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
00:23:51.106 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (303899:checkpoint_manager.py:1786)
00:23:51.106 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (303899:checkpoint_manager.py:1817)
00:23:51.107 [I] [process=0] Saving checkpoint at step 300                                        (303899:checkpoint_manager.py:1286)
00:23:51.107 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300. (303899:async_checkpointer.py:358)
00:23:51.108 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:23:51.109 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6 (303899:atomicity.py:144)
00:23:51.109 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:23:51.110 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:23:51.111 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (303899:atomicity.py:144)
00:23:51.112 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (303899:atomicity.py:144)
00:23:51.113 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:23:51.126 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
00:23:54.724 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
00:23:54.725 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:23:54.727 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
00:23:54.728 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
00:23:54.735 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:23:54.736 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:23:54.743 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
00:23:54.747 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
00:23:54.752 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
00:23:54.755 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742876631.1059568, 'wait_for_prev_duration_secs': 0.0006701946258544922, 'checkpointer_blocking_start_time': 1742876631.1071832, 'checkpointer_blocking_duration_secs': 3.6284148693084717, 'get_old_steps_start_time': 1742876634.7356577, 'get_old_steps_duration_secs': 0.00757288932800293, 'checkpoint_manager_blocking_start_time': 1742876631.1058047, 'checkpoint_manager_blocking_duration_secs': 3.64998459815979} (303899:standard_logger.py:34)
00:23:54.762 [I] Progress on: 301it/1.00kit rate:9.9s/it remaining:1:55:31 elapsed:44:33 postfix:- (303899:tqdm_logging.py:145)
00:24:02.259 [I] ChainedFuture completed 1/1 futures in 7.53 seconds.                             (303899:future.py:137)
00:24:02.260 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 929.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:24:02.260 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
00:24:02.261 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6 (303899:async_checkpointer.py:406)
00:24:02.262 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6/assets (303899:atomicity.py:287)
00:24:02.272 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6/params (303899:atomicity.py:287)
00:24:02.272 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300 (303899:async_checkpointer.py:416)
00:24:02.273 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6 (303899:async_checkpointer.py:426)
00:24:02.273 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300 (303899:atomicity.py:287)
00:24:02.274 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/300`. (303899:atomicity.py:548)
00:24:02.275 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
00:24:02.275 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
00:24:02.276 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
00:24:02.276 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
00:24:02.276 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 301: grad_norm=6.634990692138672, loss=0.9416258335113525, param_norm=1887.0506591796875
Step 302: grad_norm=5.568631172180176, loss=0.9271477460861206, param_norm=1887.0509033203125
00:24:12.165 [I] Progress on: 302it/1.00kit rate:9.6s/it remaining:1:51:23 elapsed:44:50 postfix:- (303899:tqdm_logging.py:145)
Step 303: grad_norm=6.037137985229492, loss=0.9637424945831299, param_norm=1887.0511474609375
Step 304: grad_norm=6.3889994621276855, loss=0.8071354031562805, param_norm=1887.0513916015625
00:24:29.776 [I] Progress on: 304it/1.00kit rate:9.2s/it remaining:1:46:31 elapsed:45:08 postfix:- (303899:tqdm_logging.py:145)
Step 305: grad_norm=5.76265287399292, loss=0.8537326455116272, param_norm=1887.0517578125
Step 306: grad_norm=7.218953609466553, loss=0.9095637798309326, param_norm=1887.052001953125
00:24:47.386 [I] Progress on: 306it/1.00kit rate:9.0s/it remaining:1:43:57 elapsed:45:25 postfix:- (303899:tqdm_logging.py:145)
Step 307: grad_norm=6.910623073577881, loss=0.9852639436721802, param_norm=1887.0523681640625
Step 308: grad_norm=5.451233863830566, loss=1.0086028575897217, param_norm=1887.0526123046875
00:25:04.989 [I] Progress on: 308it/1.00kit rate:8.9s/it remaining:1:42:31 elapsed:45:43 postfix:- (303899:tqdm_logging.py:145)
Step 309: grad_norm=7.4865946769714355, loss=0.8733916282653809, param_norm=1887.0531005859375
Step 310: grad_norm=6.614896774291992, loss=0.8666268587112427, param_norm=1887.0533447265625
00:25:22.598 [I] Progress on: 310it/1.00kit rate:8.8s/it remaining:1:41:42 elapsed:46:00 postfix:- (303899:tqdm_logging.py:145)
Step 311: grad_norm=8.118632316589355, loss=0.9333256483078003, param_norm=1887.0538330078125
00:25:33.857 [I] Progress on: 312it/1.00kit rate:9.5s/it remaining:1:48:56 elapsed:46:12 postfix:- (303899:tqdm_logging.py:145)
Step 312: grad_norm=9.847062110900879, loss=0.7868093252182007, param_norm=1887.0540771484375
Step 313: grad_norm=6.2148027420043945, loss=0.7482929229736328, param_norm=1887.054443359375
00:25:51.304 [I] Progress on: 313it/1.00kit rate:9.3s/it remaining:1:46:27 elapsed:46:29 postfix:- (303899:tqdm_logging.py:145)
Step 314: grad_norm=6.908979415893555, loss=0.877399206161499, param_norm=1887.0546875
Step 315: grad_norm=11.842466354370117, loss=0.8815988898277283, param_norm=1887.0550537109375
00:26:08.925 [I] Progress on: 315it/1.00kit rate:9.1s/it remaining:1:43:19 elapsed:46:47 postfix:- (303899:tqdm_logging.py:145)
Step 316: grad_norm=4.794005870819092, loss=0.8013448119163513, param_norm=1887.055419921875
Step 317: grad_norm=7.734195232391357, loss=0.808109700679779, param_norm=1887.0556640625
00:26:26.526 [I] Progress on: 317it/1.00kit rate:8.9s/it remaining:1:41:37 elapsed:47:04 postfix:- (303899:tqdm_logging.py:145)
Step 318: grad_norm=8.302851676940918, loss=0.8412385582923889, param_norm=1887.055908203125
Step 319: grad_norm=6.184624195098877, loss=0.8404253721237183, param_norm=1887.0562744140625
00:26:44.137 [I] Progress on: 319it/1.00kit rate:8.9s/it remaining:1:40:38 elapsed:47:22 postfix:- (303899:tqdm_logging.py:145)
Step 320: grad_norm=6.958465099334717, loss=0.881437361240387, param_norm=1887.056640625
Step 321: grad_norm=5.673343658447266, loss=0.7866921424865723, param_norm=1887.0570068359375
00:27:01.746 [I] Progress on: 321it/1.00kit rate:8.8s/it remaining:1:40:00 elapsed:47:40 postfix:- (303899:tqdm_logging.py:145)
Step 322: grad_norm=8.127359390258789, loss=0.9835736751556396, param_norm=1887.0572509765625
Step 323: grad_norm=10.136801719665527, loss=0.8161106109619141, param_norm=1887.0576171875
00:27:19.368 [I] Progress on: 323it/1.00kit rate:8.8s/it remaining:1:39:34 elapsed:47:57 postfix:- (303899:tqdm_logging.py:145)
Step 324: grad_norm=7.974358558654785, loss=0.8721826076507568, param_norm=1887.057861328125
Step 325: grad_norm=5.226910591125488, loss=0.8945462107658386, param_norm=1887.0582275390625
00:27:37.040 [I] Progress on: 325it/1.00kit rate:8.8s/it remaining:1:39:23 elapsed:48:15 postfix:- (303899:tqdm_logging.py:145)
Step 326: grad_norm=9.028512001037598, loss=0.8455842137336731, param_norm=1887.05859375
Step 327: grad_norm=8.777753829956055, loss=0.7839139103889465, param_norm=1887.058837890625
00:27:54.654 [I] Progress on: 327it/1.00kit rate:8.8s/it remaining:1:38:57 elapsed:48:33 postfix:- (303899:tqdm_logging.py:145)
Step 328: grad_norm=7.023128509521484, loss=0.9149022102355957, param_norm=1887.0592041015625
Step 329: grad_norm=6.137065887451172, loss=0.8057136535644531, param_norm=1887.0595703125
00:28:12.283 [I] Progress on: 329it/1.00kit rate:8.8s/it remaining:1:38:38 elapsed:48:50 postfix:- (303899:tqdm_logging.py:145)
Step 330: grad_norm=4.961949825286865, loss=0.8450908064842224, param_norm=1887.059814453125
Step 331: grad_norm=5.610584735870361, loss=0.8306006193161011, param_norm=1887.06005859375
00:28:29.912 [I] Progress on: 331it/1.00kit rate:8.8s/it remaining:1:38:21 elapsed:49:08 postfix:- (303899:tqdm_logging.py:145)
Step 332: grad_norm=8.34099292755127, loss=0.9209351539611816, param_norm=1887.0604248046875
Step 333: grad_norm=5.578239917755127, loss=0.8200005888938904, param_norm=1887.060791015625
00:28:47.534 [I] Progress on: 333it/1.00kit rate:8.8s/it remaining:1:38:01 elapsed:49:25 postfix:- (303899:tqdm_logging.py:145)
Step 334: grad_norm=4.861242771148682, loss=0.7137446999549866, param_norm=1887.06103515625
Step 335: grad_norm=5.101597309112549, loss=0.809418261051178, param_norm=1887.0615234375
00:29:05.138 [I] Progress on: 335it/1.00kit rate:8.8s/it remaining:1:37:39 elapsed:49:43 postfix:- (303899:tqdm_logging.py:145)
Step 336: grad_norm=5.920572280883789, loss=0.7289208173751831, param_norm=1887.0618896484375
Step 337: grad_norm=6.300127029418945, loss=0.8614882230758667, param_norm=1887.062255859375
00:29:22.725 [I] Progress on: 337it/1.00kit rate:8.8s/it remaining:1:37:18 elapsed:50:01 postfix:- (303899:tqdm_logging.py:145)
Step 338: grad_norm=6.371543884277344, loss=0.9248396754264832, param_norm=1887.0625
Step 339: grad_norm=9.794269561767578, loss=0.8111125230789185, param_norm=1887.0628662109375
00:29:40.329 [I] Progress on: 339it/1.00kit rate:8.8s/it remaining:1:36:59 elapsed:50:18 postfix:- (303899:tqdm_logging.py:145)
Step 340: grad_norm=5.517642021179199, loss=0.8210185170173645, param_norm=1887.063232421875
Step 341: grad_norm=6.4721550941467285, loss=0.9137172698974609, param_norm=1887.0635986328125
00:29:57.931 [I] Progress on: 341it/1.00kit rate:8.8s/it remaining:1:36:42 elapsed:50:36 postfix:- (303899:tqdm_logging.py:145)
Step 342: grad_norm=5.33621072769165, loss=0.7402207255363464, param_norm=1887.0638427734375
Step 343: grad_norm=10.62236499786377, loss=0.9079391956329346, param_norm=1887.0640869140625
00:30:15.570 [I] Progress on: 343it/1.00kit rate:8.8s/it remaining:1:36:31 elapsed:50:53 postfix:- (303899:tqdm_logging.py:145)
Step 344: grad_norm=9.555268287658691, loss=0.8496984839439392, param_norm=1887.0643310546875
Step 345: grad_norm=4.830169677734375, loss=0.8545887470245361, param_norm=1887.064697265625
00:30:33.165 [I] Progress on: 345it/1.00kit rate:8.8s/it remaining:1:36:10 elapsed:51:11 postfix:- (303899:tqdm_logging.py:145)
Step 346: grad_norm=5.008080005645752, loss=0.7625758647918701, param_norm=1887.0650634765625
Step 347: grad_norm=5.075969696044922, loss=0.7595481872558594, param_norm=1887.0653076171875
00:30:50.802 [I] Progress on: 347it/1.00kit rate:8.8s/it remaining:1:35:56 elapsed:51:29 postfix:- (303899:tqdm_logging.py:145)
Step 348: grad_norm=5.87269926071167, loss=0.8362929821014404, param_norm=1887.065673828125
Step 349: grad_norm=6.3026251792907715, loss=0.9045970439910889, param_norm=1887.066162109375
00:31:08.398 [I] Progress on: 349it/1.00kit rate:8.8s/it remaining:1:35:35 elapsed:51:46 postfix:- (303899:tqdm_logging.py:145)
Step 350: grad_norm=4.821523189544678, loss=0.7572306394577026, param_norm=1887.06640625
00:31:19.678 [I] Progress on: 351it/1.00kit rate:9.5s/it remaining:1:42:42 elapsed:51:58 postfix:- (303899:tqdm_logging.py:145)
Step 351: grad_norm=6.370706558227539, loss=0.7096520066261292, param_norm=1887.066650390625
Step 352: grad_norm=4.811278820037842, loss=0.7125177383422852, param_norm=1887.0670166015625
00:31:37.076 [I] Progress on: 352it/1.00kit rate:9.3s/it remaining:1:40:14 elapsed:52:15 postfix:- (303899:tqdm_logging.py:145)
Step 353: grad_norm=4.086113452911377, loss=0.5981498956680298, param_norm=1887.0672607421875
Step 354: grad_norm=15.724371910095215, loss=0.7621585130691528, param_norm=1887.0675048828125
00:31:54.684 [I] Progress on: 354it/1.00kit rate:9.0s/it remaining:1:37:15 elapsed:52:33 postfix:- (303899:tqdm_logging.py:145)
Step 355: grad_norm=8.434113502502441, loss=0.6278984546661377, param_norm=1887.06787109375
Step 356: grad_norm=6.011788845062256, loss=0.7862820625305176, param_norm=1887.0682373046875
00:32:12.432 [I] Progress on: 356it/1.00kit rate:8.9s/it remaining:1:35:40 elapsed:52:50 postfix:- (303899:tqdm_logging.py:145)
Step 357: grad_norm=5.846161365509033, loss=0.6587011814117432, param_norm=1887.0684814453125
Step 358: grad_norm=4.653446197509766, loss=0.7257782220840454, param_norm=1887.06884765625
00:32:30.056 [I] Progress on: 358it/1.00kit rate:8.9s/it remaining:1:35:07 elapsed:53:08 postfix:- (303899:tqdm_logging.py:145)
Step 359: grad_norm=8.826621055603027, loss=0.8154019713401794, param_norm=1887.069091796875
Step 360: grad_norm=8.239066123962402, loss=0.7928587794303894, param_norm=1887.0694580078125
00:32:47.660 [I] Progress on: 360it/1.00kit rate:8.8s/it remaining:1:34:19 elapsed:53:26 postfix:- (303899:tqdm_logging.py:145)
Step 361: grad_norm=6.0731425285339355, loss=0.704073965549469, param_norm=1887.0697021484375
Step 362: grad_norm=8.873913764953613, loss=0.747962474822998, param_norm=1887.070068359375
00:33:05.266 [I] Progress on: 362it/1.00kit rate:8.8s/it remaining:1:33:47 elapsed:53:43 postfix:- (303899:tqdm_logging.py:145)
Step 363: grad_norm=7.2474799156188965, loss=0.7323801517486572, param_norm=1887.0704345703125
Step 364: grad_norm=8.135765075683594, loss=0.874640166759491, param_norm=1887.07080078125
00:33:22.880 [I] Progress on: 364it/1.00kit rate:8.8s/it remaining:1:33:23 elapsed:54:01 postfix:- (303899:tqdm_logging.py:145)
Step 365: grad_norm=9.848830223083496, loss=0.7669210433959961, param_norm=1887.071044921875
Step 366: grad_norm=9.175015449523926, loss=0.8250876665115356, param_norm=1887.0712890625
00:33:40.493 [I] Progress on: 366it/1.00kit rate:8.8s/it remaining:1:33:03 elapsed:54:18 postfix:- (303899:tqdm_logging.py:145)
Step 367: grad_norm=6.266744613647461, loss=0.7393001914024353, param_norm=1887.071533203125
Step 368: grad_norm=6.038652420043945, loss=0.929286003112793, param_norm=1887.0718994140625
00:33:58.116 [I] Progress on: 368it/1.00kit rate:8.8s/it remaining:1:32:47 elapsed:54:36 postfix:- (303899:tqdm_logging.py:145)
Step 369: grad_norm=10.934158325195312, loss=0.7914596796035767, param_norm=1887.072021484375
Step 370: grad_norm=10.00537395477295, loss=0.7886024713516235, param_norm=1887.0723876953125
00:34:15.732 [I] Progress on: 370it/1.00kit rate:8.8s/it remaining:1:32:26 elapsed:54:54 postfix:- (303899:tqdm_logging.py:145)
Step 371: grad_norm=15.484064102172852, loss=0.8963191509246826, param_norm=1887.0726318359375
Step 372: grad_norm=9.469035148620605, loss=0.8425970673561096, param_norm=1887.0731201171875
00:34:33.366 [I] Progress on: 372it/1.00kit rate:8.8s/it remaining:1:32:11 elapsed:55:11 postfix:- (303899:tqdm_logging.py:145)
Step 373: grad_norm=4.828790187835693, loss=0.7541202306747437, param_norm=1887.0733642578125
Step 374: grad_norm=6.037394046783447, loss=0.7252709865570068, param_norm=1887.0736083984375
00:34:51.000 [I] Progress on: 374it/1.00kit rate:8.8s/it remaining:1:31:56 elapsed:55:29 postfix:- (303899:tqdm_logging.py:145)
Step 375: grad_norm=4.897964000701904, loss=0.7104260921478271, param_norm=1887.073974609375
Step 376: grad_norm=12.497335433959961, loss=0.7312477827072144, param_norm=1887.07421875
00:35:08.631 [I] Progress on: 376it/1.00kit rate:8.8s/it remaining:1:31:37 elapsed:55:46 postfix:- (303899:tqdm_logging.py:145)
Step 377: grad_norm=7.872070789337158, loss=0.7079726457595825, param_norm=1887.074462890625
Step 378: grad_norm=6.847994804382324, loss=0.7606979608535767, param_norm=1887.0748291015625
00:35:26.226 [I] Progress on: 378it/1.00kit rate:8.8s/it remaining:1:31:17 elapsed:56:04 postfix:- (303899:tqdm_logging.py:145)
Step 379: grad_norm=7.139174461364746, loss=0.7655143737792969, param_norm=1887.074951171875
Step 380: grad_norm=5.011167049407959, loss=0.7471780180931091, param_norm=1887.0750732421875
00:35:43.833 [I] Progress on: 380it/1.00kit rate:8.8s/it remaining:1:30:55 elapsed:56:22 postfix:- (303899:tqdm_logging.py:145)
Step 381: grad_norm=10.730879783630371, loss=0.7059018611907959, param_norm=1887.075439453125
Step 382: grad_norm=5.419874668121338, loss=0.7841371297836304, param_norm=1887.0755615234375
00:36:01.442 [I] Progress on: 382it/1.00kit rate:8.8s/it remaining:1:30:38 elapsed:56:39 postfix:- (303899:tqdm_logging.py:145)
Step 383: grad_norm=9.317479133605957, loss=0.892341136932373, param_norm=1887.0758056640625
Step 384: grad_norm=8.23013687133789, loss=0.7034611701965332, param_norm=1887.0760498046875
00:36:19.034 [I] Progress on: 384it/1.00kit rate:8.8s/it remaining:1:30:18 elapsed:56:57 postfix:- (303899:tqdm_logging.py:145)
Step 385: grad_norm=4.988026142120361, loss=0.7716892957687378, param_norm=1887.0762939453125
Step 386: grad_norm=7.98690938949585, loss=0.76902174949646, param_norm=1887.0765380859375
00:36:36.626 [I] Progress on: 386it/1.00kit rate:8.8s/it remaining:1:29:59 elapsed:57:14 postfix:- (303899:tqdm_logging.py:145)
Step 387: grad_norm=11.341179847717285, loss=0.6864490509033203, param_norm=1887.0767822265625
Step 388: grad_norm=14.883485794067383, loss=0.7890589237213135, param_norm=1887.0770263671875
00:36:54.237 [I] Progress on: 388it/1.00kit rate:8.8s/it remaining:1:29:44 elapsed:57:32 postfix:- (303899:tqdm_logging.py:145)
Step 389: grad_norm=4.930004119873047, loss=0.7177290320396423, param_norm=1887.0772705078125
00:37:05.427 [I] Progress on: 390it/1.00kit rate:9.5s/it remaining:1:36:09 elapsed:57:43 postfix:- (303899:tqdm_logging.py:145)
Step 390: grad_norm=4.623447418212891, loss=0.5867239236831665, param_norm=1887.077392578125
Step 391: grad_norm=6.065523624420166, loss=0.5510058403015137, param_norm=1887.07763671875
00:37:22.876 [I] Progress on: 391it/1.00kit rate:9.3s/it remaining:1:34:05 elapsed:58:01 postfix:- (303899:tqdm_logging.py:145)
Step 392: grad_norm=4.556766033172607, loss=0.7371193766593933, param_norm=1887.077880859375
Step 393: grad_norm=5.422396183013916, loss=0.6455168724060059, param_norm=1887.078125
00:37:40.496 [I] Progress on: 393it/1.00kit rate:9.0s/it remaining:1:31:26 elapsed:58:18 postfix:- (303899:tqdm_logging.py:145)
Step 394: grad_norm=4.747532367706299, loss=0.6359055042266846, param_norm=1887.078369140625
Step 395: grad_norm=5.4522247314453125, loss=0.7150249481201172, param_norm=1887.0787353515625
00:37:58.137 [I] Progress on: 395it/1.00kit rate:8.9s/it remaining:1:30:00 elapsed:58:36 postfix:- (303899:tqdm_logging.py:145)
Step 396: grad_norm=8.57799243927002, loss=0.6641676425933838, param_norm=1887.0789794921875
Step 397: grad_norm=5.647119045257568, loss=0.657543420791626, param_norm=1887.0792236328125
00:38:15.789 [I] Progress on: 397it/1.00kit rate:8.9s/it remaining:1:29:13 elapsed:58:54 postfix:- (303899:tqdm_logging.py:145)
Step 398: grad_norm=5.225387096405029, loss=0.6898163557052612, param_norm=1887.0794677734375
Step 399: grad_norm=3.8146588802337646, loss=0.6111115217208862, param_norm=1887.07958984375
00:38:33.393 [I] Progress on: 399it/1.00kit rate:8.8s/it remaining:1:28:34 elapsed:59:11 postfix:- (303899:tqdm_logging.py:145)
Step 400: grad_norm=8.358445167541504, loss=0.7523757219314575, param_norm=1887.079833984375
00:38:42.401 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
00:38:42.401 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
00:38:42.401 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (303899:checkpoint_manager.py:1786)
00:38:42.401 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (303899:checkpoint_manager.py:1817)
00:38:42.402 [I] [process=0] Saving checkpoint at step 400                                        (303899:checkpoint_manager.py:1286)
00:38:42.402 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400. (303899:async_checkpointer.py:358)
00:38:42.404 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:38:42.404 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9 (303899:atomicity.py:144)
00:38:42.405 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:38:42.405 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:38:42.406 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (303899:atomicity.py:144)
00:38:42.407 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (303899:atomicity.py:144)
00:38:42.407 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:38:42.412 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
00:38:45.959 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
00:38:45.960 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:38:45.962 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
00:38:45.963 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
00:38:45.986 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:38:45.987 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:38:45.995 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:38:45.998 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
00:38:45.998 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
00:38:46.000 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
00:38:46.000 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742877522.4011543, 'wait_for_prev_duration_secs': 0.0006756782531738281, 'checkpointer_blocking_start_time': 1742877522.4023762, 'checkpointer_blocking_duration_secs': 3.5839483737945557, 'get_old_steps_start_time': 1742877525.9863787, 'get_old_steps_duration_secs': 0.011958837509155273, 'checkpoint_manager_blocking_start_time': 1742877522.4009953, 'checkpoint_manager_blocking_duration_secs': 3.5992846488952637} (303899:standard_logger.py:34)
00:38:46.001 [I] Progress on: 401it/1.00kit rate:9.9s/it remaining:1:38:55 elapsed:59:24 postfix:- (303899:tqdm_logging.py:145)
00:38:53.542 [I] ChainedFuture completed 1/1 futures in 7.57 seconds.                             (303899:future.py:137)
00:38:53.543 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 930.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:38:53.543 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
00:38:53.544 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9 (303899:async_checkpointer.py:406)
00:38:53.545 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9/assets (303899:atomicity.py:287)
00:38:53.555 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9/params (303899:atomicity.py:287)
00:38:53.556 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400 (303899:async_checkpointer.py:416)
00:38:53.556 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9 (303899:async_checkpointer.py:426)
00:38:53.556 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400 (303899:atomicity.py:287)
00:38:53.558 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/400`. (303899:atomicity.py:548)
00:38:53.558 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
00:38:53.558 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
00:38:53.559 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
00:38:53.559 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
00:38:53.559 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 401: grad_norm=6.102365970611572, loss=0.6005225777626038, param_norm=1887.0802001953125
Step 402: grad_norm=9.144036293029785, loss=0.6603604555130005, param_norm=1887.080322265625
00:39:03.385 [I] Progress on: 402it/1.00kit rate:9.6s/it remaining:1:35:20 elapsed:59:41 postfix:- (303899:tqdm_logging.py:145)
Step 403: grad_norm=5.006418228149414, loss=0.7029123306274414, param_norm=1887.08056640625
Step 404: grad_norm=7.0809221267700195, loss=0.6561896800994873, param_norm=1887.0806884765625
00:39:20.980 [I] Progress on: 404it/1.00kit rate:9.2s/it remaining:1:31:07 elapsed:59:59 postfix:- (303899:tqdm_logging.py:145)
Step 405: grad_norm=5.894532203674316, loss=0.7342033386230469, param_norm=1887.0810546875
Step 406: grad_norm=6.075765132904053, loss=0.6262702941894531, param_norm=1887.081298828125
00:39:38.580 [I] Progress on: 406it/1.00kit rate:9.0s/it remaining:1:28:53 elapsed:1:00:16 postfix:- (303899:tqdm_logging.py:145)
Step 407: grad_norm=4.197007656097412, loss=0.5647953152656555, param_norm=1887.08154296875
Step 408: grad_norm=6.970732688903809, loss=0.6271252036094666, param_norm=1887.0819091796875
00:39:56.201 [I] Progress on: 408it/1.00kit rate:8.9s/it remaining:1:27:43 elapsed:1:00:34 postfix:- (303899:tqdm_logging.py:145)
Step 409: grad_norm=4.759964942932129, loss=0.6843512058258057, param_norm=1887.0821533203125
Step 410: grad_norm=3.794809579849243, loss=0.5989261865615845, param_norm=1887.082275390625
00:40:13.811 [I] Progress on: 410it/1.00kit rate:8.8s/it remaining:1:26:57 elapsed:1:00:52 postfix:- (303899:tqdm_logging.py:145)
Step 411: grad_norm=5.720523834228516, loss=0.6453319191932678, param_norm=1887.0826416015625
Step 412: grad_norm=4.737666130065918, loss=0.6647045612335205, param_norm=1887.0828857421875
00:40:31.414 [I] Progress on: 412it/1.00kit rate:8.8s/it remaining:1:26:27 elapsed:1:01:09 postfix:- (303899:tqdm_logging.py:145)
Step 413: grad_norm=5.642942428588867, loss=0.696205735206604, param_norm=1887.0830078125
Step 414: grad_norm=6.43037223815918, loss=0.7181462049484253, param_norm=1887.0833740234375
00:40:49.013 [I] Progress on: 414it/1.00kit rate:8.8s/it remaining:1:26:01 elapsed:1:01:27 postfix:- (303899:tqdm_logging.py:145)
Step 415: grad_norm=9.197504997253418, loss=0.6723856925964355, param_norm=1887.083740234375
Step 416: grad_norm=8.963292121887207, loss=0.6160398721694946, param_norm=1887.083984375
00:41:06.620 [I] Progress on: 416it/1.00kit rate:8.8s/it remaining:1:25:41 elapsed:1:01:44 postfix:- (303899:tqdm_logging.py:145)
Step 417: grad_norm=5.503324031829834, loss=0.751891016960144, param_norm=1887.084228515625
Step 418: grad_norm=4.607800483703613, loss=0.7434289455413818, param_norm=1887.08447265625
00:41:24.222 [I] Progress on: 418it/1.00kit rate:8.8s/it remaining:1:25:20 elapsed:1:02:02 postfix:- (303899:tqdm_logging.py:145)
Step 419: grad_norm=4.358079433441162, loss=0.6744145154953003, param_norm=1887.0849609375
Step 420: grad_norm=6.008823871612549, loss=0.6305323243141174, param_norm=1887.0850830078125
00:41:41.840 [I] Progress on: 420it/1.00kit rate:8.8s/it remaining:1:25:06 elapsed:1:02:20 postfix:- (303899:tqdm_logging.py:145)
Step 421: grad_norm=5.246836185455322, loss=0.7099199295043945, param_norm=1887.0853271484375
Step 422: grad_norm=7.060510635375977, loss=0.6913717985153198, param_norm=1887.085693359375
00:41:59.467 [I] Progress on: 422it/1.00kit rate:8.8s/it remaining:1:24:48 elapsed:1:02:37 postfix:- (303899:tqdm_logging.py:145)
Step 423: grad_norm=5.691810607910156, loss=0.7117351293563843, param_norm=1887.0859375
Step 424: grad_norm=4.765685081481934, loss=0.6920346021652222, param_norm=1887.086181640625
00:42:17.086 [I] Progress on: 424it/1.00kit rate:8.8s/it remaining:1:24:31 elapsed:1:02:55 postfix:- (303899:tqdm_logging.py:145)
Step 425: grad_norm=6.992810249328613, loss=0.702513575553894, param_norm=1887.08642578125
Step 426: grad_norm=4.788971900939941, loss=0.6606543064117432, param_norm=1887.086669921875
00:42:34.731 [I] Progress on: 426it/1.00kit rate:8.8s/it remaining:1:24:18 elapsed:1:03:13 postfix:- (303899:tqdm_logging.py:145)
Step 427: grad_norm=6.2207932472229, loss=0.702023983001709, param_norm=1887.0869140625
Step 428: grad_norm=7.195441722869873, loss=0.6882390975952148, param_norm=1887.087158203125
00:42:52.309 [I] Progress on: 428it/1.00kit rate:8.8s/it remaining:1:23:52 elapsed:1:03:30 postfix:- (303899:tqdm_logging.py:145)
Step 429: grad_norm=4.435175895690918, loss=0.6243839859962463, param_norm=1887.08740234375
00:43:03.358 [I] Progress on: 429it/1.00kit rate:9.5s/it remaining:1:30:10 elapsed:1:03:41 postfix:- (303899:tqdm_logging.py:145)
Step 430: grad_norm=4.00295877456665, loss=0.6285361647605896, param_norm=1887.0875244140625
Step 431: grad_norm=3.8274779319763184, loss=0.6148934364318848, param_norm=1887.0877685546875
00:43:20.962 [I] Progress on: 431it/1.00kit rate:9.1s/it remaining:1:26:35 elapsed:1:03:59 postfix:- (303899:tqdm_logging.py:145)
Step 432: grad_norm=4.600597858428955, loss=0.619045615196228, param_norm=1887.088134765625
Step 433: grad_norm=5.606734752655029, loss=0.7349239587783813, param_norm=1887.0882568359375
00:43:38.581 [I] Progress on: 433it/1.00kit rate:9.0s/it remaining:1:24:45 elapsed:1:04:16 postfix:- (303899:tqdm_logging.py:145)
Step 434: grad_norm=3.894270896911621, loss=0.6215468645095825, param_norm=1887.0885009765625
Step 435: grad_norm=4.028751373291016, loss=0.5606566667556763, param_norm=1887.0887451171875
00:43:56.222 [I] Progress on: 435it/1.00kit rate:8.9s/it remaining:1:23:45 elapsed:1:04:34 postfix:- (303899:tqdm_logging.py:145)
Step 436: grad_norm=4.138302326202393, loss=0.5814694762229919, param_norm=1887.0889892578125
Step 437: grad_norm=4.818880081176758, loss=0.7100613117218018, param_norm=1887.0892333984375
00:44:13.847 [I] Progress on: 437it/1.00kit rate:8.9s/it remaining:1:23:05 elapsed:1:04:52 postfix:- (303899:tqdm_logging.py:145)
Step 438: grad_norm=6.682466983795166, loss=0.6872459650039673, param_norm=1887.089599609375
Step 439: grad_norm=4.194381237030029, loss=0.5193765759468079, param_norm=1887.08984375
00:44:31.494 [I] Progress on: 439it/1.00kit rate:8.8s/it remaining:1:22:39 elapsed:1:05:09 postfix:- (303899:tqdm_logging.py:145)
Step 440: grad_norm=4.770770072937012, loss=0.6112021207809448, param_norm=1887.090087890625
Step 441: grad_norm=3.6380116939544678, loss=0.5252254009246826, param_norm=1887.09033203125
00:44:49.115 [I] Progress on: 441it/1.00kit rate:8.8s/it remaining:1:22:13 elapsed:1:05:27 postfix:- (303899:tqdm_logging.py:145)
Step 442: grad_norm=5.3528900146484375, loss=0.6345930099487305, param_norm=1887.090576171875
Step 443: grad_norm=4.617209434509277, loss=0.6100277900695801, param_norm=1887.0906982421875
00:45:06.746 [I] Progress on: 443it/1.00kit rate:8.8s/it remaining:1:21:54 elapsed:1:05:45 postfix:- (303899:tqdm_logging.py:145)
Step 444: grad_norm=3.9150328636169434, loss=0.6380636096000671, param_norm=1887.091064453125
Step 445: grad_norm=22.65673828125, loss=0.6574867963790894, param_norm=1887.09130859375
00:45:24.383 [I] Progress on: 445it/1.00kit rate:8.8s/it remaining:1:21:35 elapsed:1:06:02 postfix:- (303899:tqdm_logging.py:145)
Step 446: grad_norm=3.735488176345825, loss=0.5626998543739319, param_norm=1887.091552734375
Step 447: grad_norm=5.1785759925842285, loss=0.5936092734336853, param_norm=1887.091796875
00:45:42.211 [I] Progress on: 447it/1.00kit rate:8.8s/it remaining:1:21:19 elapsed:1:06:20 postfix:- (303899:tqdm_logging.py:145)
Step 448: grad_norm=5.51708984375, loss=0.5580225586891174, param_norm=1887.092041015625
Step 449: grad_norm=3.7390403747558594, loss=0.6601471900939941, param_norm=1887.09228515625
00:45:59.885 [I] Progress on: 449it/1.00kit rate:8.9s/it remaining:1:21:26 elapsed:1:06:38 postfix:- (303899:tqdm_logging.py:145)
Step 450: grad_norm=6.381740570068359, loss=0.637040376663208, param_norm=1887.092529296875
Step 451: grad_norm=5.802102088928223, loss=0.5816195011138916, param_norm=1887.0926513671875
00:46:17.517 [I] Progress on: 451it/1.00kit rate:8.8s/it remaining:1:20:56 elapsed:1:06:55 postfix:- (303899:tqdm_logging.py:145)
Step 452: grad_norm=5.436399936676025, loss=0.5958820581436157, param_norm=1887.0928955078125
Step 453: grad_norm=5.282412528991699, loss=0.5708895325660706, param_norm=1887.093017578125
00:46:35.164 [I] Progress on: 453it/1.00kit rate:8.8s/it remaining:1:20:34 elapsed:1:07:13 postfix:- (303899:tqdm_logging.py:145)
Step 454: grad_norm=5.827518463134766, loss=0.5936115980148315, param_norm=1887.0931396484375
Step 455: grad_norm=7.208853721618652, loss=0.5558702349662781, param_norm=1887.093505859375
00:46:52.805 [I] Progress on: 455it/1.00kit rate:8.8s/it remaining:1:20:11 elapsed:1:07:31 postfix:- (303899:tqdm_logging.py:145)
Step 456: grad_norm=4.067971229553223, loss=0.6084076166152954, param_norm=1887.0936279296875
Step 457: grad_norm=5.218451499938965, loss=0.5947278738021851, param_norm=1887.0938720703125
00:47:10.439 [I] Progress on: 457it/1.00kit rate:8.8s/it remaining:1:19:53 elapsed:1:07:48 postfix:- (303899:tqdm_logging.py:145)
Step 458: grad_norm=7.499464511871338, loss=0.5514661073684692, param_norm=1887.0941162109375
Step 459: grad_norm=4.88584041595459, loss=0.5237826108932495, param_norm=1887.0943603515625
00:47:28.074 [I] Progress on: 459it/1.00kit rate:8.8s/it remaining:1:19:32 elapsed:1:08:06 postfix:- (303899:tqdm_logging.py:145)
Step 460: grad_norm=4.877559661865234, loss=0.6155214309692383, param_norm=1887.094482421875
Step 461: grad_norm=4.114433288574219, loss=0.5676032900810242, param_norm=1887.0947265625
00:47:45.701 [I] Progress on: 461it/1.00kit rate:8.8s/it remaining:1:19:14 elapsed:1:08:24 postfix:- (303899:tqdm_logging.py:145)
Step 462: grad_norm=4.229281902313232, loss=0.5472853183746338, param_norm=1887.094970703125
Step 463: grad_norm=6.412354946136475, loss=0.6417402029037476, param_norm=1887.09521484375
00:48:03.338 [I] Progress on: 463it/1.00kit rate:8.8s/it remaining:1:18:56 elapsed:1:08:41 postfix:- (303899:tqdm_logging.py:145)
Step 464: grad_norm=4.5368781089782715, loss=0.683229923248291, param_norm=1887.0953369140625
Step 465: grad_norm=8.633012771606445, loss=0.6656011343002319, param_norm=1887.0955810546875
00:48:20.975 [I] Progress on: 465it/1.00kit rate:8.8s/it remaining:1:18:40 elapsed:1:08:59 postfix:- (303899:tqdm_logging.py:145)
Step 466: grad_norm=4.594079494476318, loss=0.6707156896591187, param_norm=1887.0958251953125
Step 467: grad_norm=4.073460102081299, loss=0.6072496175765991, param_norm=1887.095947265625
00:48:38.611 [I] Progress on: 467it/1.00kit rate:8.8s/it remaining:1:18:21 elapsed:1:09:16 postfix:- (303899:tqdm_logging.py:145)
Step 468: grad_norm=19.28816795349121, loss=0.6213996410369873, param_norm=1887.09619140625
00:48:49.600 [I] Progress on: 468it/1.00kit rate:9.5s/it remaining:1:24:02 elapsed:1:09:27 postfix:- (303899:tqdm_logging.py:145)
Step 469: grad_norm=4.494637966156006, loss=0.5641899108886719, param_norm=1887.096435546875
Step 470: grad_norm=4.195965766906738, loss=0.5693062543869019, param_norm=1887.0965576171875
00:49:07.204 [I] Progress on: 470it/1.00kit rate:9.1s/it remaining:1:20:38 elapsed:1:09:45 postfix:- (303899:tqdm_logging.py:145)
Step 471: grad_norm=4.833089351654053, loss=0.5789401531219482, param_norm=1887.0968017578125
Step 472: grad_norm=3.7283060550689697, loss=0.5114126801490784, param_norm=1887.0970458984375
00:49:24.813 [I] Progress on: 472it/1.00kit rate:9.0s/it remaining:1:18:51 elapsed:1:10:03 postfix:- (303899:tqdm_logging.py:145)
Step 473: grad_norm=3.726069450378418, loss=0.5599304437637329, param_norm=1887.097412109375
Step 474: grad_norm=5.943726062774658, loss=0.49089929461479187, param_norm=1887.0975341796875
00:49:42.431 [I] Progress on: 474it/1.00kit rate:8.9s/it remaining:1:17:50 elapsed:1:10:20 postfix:- (303899:tqdm_logging.py:145)
Step 475: grad_norm=4.152434349060059, loss=0.6029850840568542, param_norm=1887.0977783203125
Step 476: grad_norm=4.088358402252197, loss=0.5572508573532104, param_norm=1887.0980224609375
00:50:00.044 [I] Progress on: 476it/1.00kit rate:8.8s/it remaining:1:17:12 elapsed:1:10:38 postfix:- (303899:tqdm_logging.py:145)
Step 477: grad_norm=4.500555038452148, loss=0.5083079934120178, param_norm=1887.09814453125
Step 478: grad_norm=6.156832695007324, loss=0.5298467874526978, param_norm=1887.0982666015625
00:50:17.650 [I] Progress on: 478it/1.00kit rate:8.8s/it remaining:1:16:44 elapsed:1:10:56 postfix:- (303899:tqdm_logging.py:145)
Step 479: grad_norm=5.6446852684021, loss=0.569378137588501, param_norm=1887.0985107421875
Step 480: grad_norm=4.243094444274902, loss=0.5450153946876526, param_norm=1887.0986328125
00:50:35.255 [I] Progress on: 480it/1.00kit rate:8.8s/it remaining:1:16:20 elapsed:1:11:13 postfix:- (303899:tqdm_logging.py:145)
Step 481: grad_norm=7.230855464935303, loss=0.5534271001815796, param_norm=1887.098876953125
Step 482: grad_norm=5.491978645324707, loss=0.5622167587280273, param_norm=1887.09912109375
00:50:52.851 [I] Progress on: 482it/1.00kit rate:8.8s/it remaining:1:15:59 elapsed:1:11:31 postfix:- (303899:tqdm_logging.py:145)
Step 483: grad_norm=5.861418724060059, loss=0.5285836458206177, param_norm=1887.099365234375
Step 484: grad_norm=3.32210373878479, loss=0.5116220712661743, param_norm=1887.0994873046875
00:51:10.462 [I] Progress on: 484it/1.00kit rate:8.8s/it remaining:1:15:41 elapsed:1:11:48 postfix:- (303899:tqdm_logging.py:145)
Step 485: grad_norm=5.138678073883057, loss=0.5078165531158447, param_norm=1887.0997314453125
Step 486: grad_norm=4.056970596313477, loss=0.5595162510871887, param_norm=1887.0999755859375
00:51:28.068 [I] Progress on: 486it/1.00kit rate:8.8s/it remaining:1:15:23 elapsed:1:12:06 postfix:- (303899:tqdm_logging.py:145)
Step 487: grad_norm=7.199471950531006, loss=0.5917395353317261, param_norm=1887.10009765625
Step 488: grad_norm=4.461172580718994, loss=0.5818614959716797, param_norm=1887.100341796875
00:51:45.688 [I] Progress on: 488it/1.00kit rate:8.8s/it remaining:1:15:06 elapsed:1:12:24 postfix:- (303899:tqdm_logging.py:145)
Step 489: grad_norm=3.1249232292175293, loss=0.47033166885375977, param_norm=1887.1004638671875
Step 490: grad_norm=4.606208801269531, loss=0.5119419097900391, param_norm=1887.1005859375
00:52:03.284 [I] Progress on: 490it/1.00kit rate:8.8s/it remaining:1:14:46 elapsed:1:12:41 postfix:- (303899:tqdm_logging.py:145)
Step 491: grad_norm=3.64032244682312, loss=0.5381932258605957, param_norm=1887.100830078125
Step 492: grad_norm=8.296504020690918, loss=0.6161516308784485, param_norm=1887.1009521484375
00:52:20.885 [I] Progress on: 492it/1.00kit rate:8.8s/it remaining:1:14:29 elapsed:1:12:59 postfix:- (303899:tqdm_logging.py:145)
Step 493: grad_norm=3.897526741027832, loss=0.4244542717933655, param_norm=1887.10107421875
Step 494: grad_norm=8.892329216003418, loss=0.5731184482574463, param_norm=1887.101318359375
00:52:38.496 [I] Progress on: 494it/1.00kit rate:8.8s/it remaining:1:14:11 elapsed:1:13:16 postfix:- (303899:tqdm_logging.py:145)
Step 495: grad_norm=5.172595024108887, loss=0.5335832834243774, param_norm=1887.1014404296875
Step 496: grad_norm=5.655971527099609, loss=0.5543287992477417, param_norm=1887.101806640625
00:52:56.103 [I] Progress on: 496it/1.00kit rate:8.8s/it remaining:1:13:55 elapsed:1:13:34 postfix:- (303899:tqdm_logging.py:145)
Step 497: grad_norm=3.905341148376465, loss=0.4707814157009125, param_norm=1887.1019287109375
Step 498: grad_norm=3.984204053878784, loss=0.574761688709259, param_norm=1887.1021728515625
00:53:13.726 [I] Progress on: 498it/1.00kit rate:8.8s/it remaining:1:13:38 elapsed:1:13:52 postfix:- (303899:tqdm_logging.py:145)
Step 499: grad_norm=4.111112594604492, loss=0.5706871747970581, param_norm=1887.1024169921875
Step 500: grad_norm=4.824149131774902, loss=0.5273359417915344, param_norm=1887.1026611328125
00:53:31.331 [I] Progress on: 500it/1.00kit rate:8.8s/it remaining:1:13:20 elapsed:1:14:09 postfix:- (303899:tqdm_logging.py:145)
00:53:31.542 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
00:53:31.543 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
00:53:31.543 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (303899:checkpoint_manager.py:1786)
00:53:31.543 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (303899:checkpoint_manager.py:1817)
00:53:31.544 [I] [process=0] Saving checkpoint at step 500                                        (303899:checkpoint_manager.py:1286)
00:53:31.544 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500. (303899:async_checkpointer.py:358)
00:53:31.545 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:53:31.546 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12 (303899:atomicity.py:144)
00:53:31.546 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:53:31.547 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
00:53:31.548 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (303899:atomicity.py:144)
00:53:31.548 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (303899:atomicity.py:144)
00:53:31.549 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
00:53:31.553 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
00:53:35.299 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
00:53:35.300 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:53:35.301 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
00:53:35.303 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
00:53:35.326 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:53:35.328 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:53:35.334 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:53:35.335 [I] Preserving Checkpoint[step=400 | time=2025-03-25 04:38:45.986340+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
00:53:35.336 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
00:53:35.337 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
00:53:35.339 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
00:53:35.340 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742878411.542936, 'wait_for_prev_duration_secs': 0.0007143020629882812, 'checkpointer_blocking_start_time': 1742878411.5441935, 'checkpointer_blocking_duration_secs': 3.781964063644409, 'get_old_steps_start_time': 1742878415.3262274, 'get_old_steps_duration_secs': 0.009956598281860352, 'checkpoint_manager_blocking_start_time': 1742878411.54277, 'checkpoint_manager_blocking_duration_secs': 3.7971365451812744} (303899:standard_logger.py:34)
00:53:42.864 [I] ChainedFuture completed 1/1 futures in 7.55 seconds.                             (303899:future.py:137)
00:53:42.864 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 915.6 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
00:53:42.864 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
00:53:42.866 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12 (303899:async_checkpointer.py:406)
00:53:42.866 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12/assets (303899:atomicity.py:287)
00:53:42.876 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12/params (303899:atomicity.py:287)
00:53:42.877 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500 (303899:async_checkpointer.py:416)
00:53:42.877 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12 (303899:async_checkpointer.py:426)
00:53:42.878 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500 (303899:atomicity.py:287)
00:53:42.879 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/500`. (303899:atomicity.py:548)
00:53:42.879 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
00:53:42.880 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
00:53:42.880 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
00:53:42.880 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
00:53:42.881 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 501: grad_norm=4.20328950881958, loss=0.45931631326675415, param_norm=1887.102783203125
00:53:43.949 [I] Progress on: 501it/1.00kit rate:9.9s/it remaining:1:22:44 elapsed:1:14:22 postfix:- (303899:tqdm_logging.py:145)
Step 502: grad_norm=5.811219215393066, loss=0.548851728439331, param_norm=1887.10302734375
Step 503: grad_norm=5.88718318939209, loss=0.6229037046432495, param_norm=1887.1031494140625
00:54:01.589 [I] Progress on: 503it/1.00kit rate:9.4s/it remaining:1:17:38 elapsed:1:14:39 postfix:- (303899:tqdm_logging.py:145)
Step 504: grad_norm=4.054658889770508, loss=0.5574096441268921, param_norm=1887.1033935546875
Step 505: grad_norm=4.058975696563721, loss=0.5769397616386414, param_norm=1887.103515625
00:54:19.229 [I] Progress on: 505it/1.00kit rate:9.1s/it remaining:1:15:00 elapsed:1:14:57 postfix:- (303899:tqdm_logging.py:145)
Step 506: grad_norm=5.763072490692139, loss=0.5513351559638977, param_norm=1887.1036376953125
00:54:30.560 [I] Progress on: 507it/1.00kit rate:9.6s/it remaining:1:19:16 elapsed:1:15:08 postfix:- (303899:tqdm_logging.py:145)
Step 507: grad_norm=4.534054279327393, loss=0.49116939306259155, param_norm=1887.103759765625
Step 508: grad_norm=6.399028778076172, loss=0.5122917890548706, param_norm=1887.1038818359375
00:54:47.948 [I] Progress on: 508it/1.00kit rate:9.4s/it remaining:1:16:58 elapsed:1:15:26 postfix:- (303899:tqdm_logging.py:145)
Step 509: grad_norm=3.985929250717163, loss=0.45771750807762146, param_norm=1887.10400390625
Step 510: grad_norm=5.125572204589844, loss=0.5327127575874329, param_norm=1887.104248046875
00:55:05.561 [I] Progress on: 510it/1.00kit rate:9.1s/it remaining:1:14:13 elapsed:1:15:43 postfix:- (303899:tqdm_logging.py:145)
Step 511: grad_norm=3.768965005874634, loss=0.512331485748291, param_norm=1887.1043701171875
Step 512: grad_norm=6.091665267944336, loss=0.5664874911308289, param_norm=1887.1046142578125
00:55:23.164 [I] Progress on: 512it/1.00kit rate:8.9s/it remaining:1:12:44 elapsed:1:16:01 postfix:- (303899:tqdm_logging.py:145)
Step 513: grad_norm=4.1131672859191895, loss=0.505946159362793, param_norm=1887.104736328125
Step 514: grad_norm=3.6886074542999268, loss=0.4679739475250244, param_norm=1887.10498046875
00:55:40.804 [I] Progress on: 514it/1.00kit rate:8.9s/it remaining:1:11:52 elapsed:1:16:19 postfix:- (303899:tqdm_logging.py:145)
Step 515: grad_norm=4.160088539123535, loss=0.5455020070075989, param_norm=1887.1051025390625
Step 516: grad_norm=4.4153313636779785, loss=0.4379715919494629, param_norm=1887.1053466796875
00:55:58.455 [I] Progress on: 516it/1.00kit rate:8.8s/it remaining:1:11:20 elapsed:1:16:36 postfix:- (303899:tqdm_logging.py:145)
Step 517: grad_norm=3.995863676071167, loss=0.4473101794719696, param_norm=1887.10546875
Step 518: grad_norm=3.830894947052002, loss=0.5187809467315674, param_norm=1887.1055908203125
00:56:16.107 [I] Progress on: 518it/1.00kit rate:8.8s/it remaining:1:10:57 elapsed:1:16:54 postfix:- (303899:tqdm_logging.py:145)
Step 519: grad_norm=3.951885938644409, loss=0.46518993377685547, param_norm=1887.105712890625
Step 520: grad_norm=4.4207444190979, loss=0.4189903736114502, param_norm=1887.10595703125
00:56:33.743 [I] Progress on: 520it/1.00kit rate:8.8s/it remaining:1:10:34 elapsed:1:17:12 postfix:- (303899:tqdm_logging.py:145)
Step 521: grad_norm=4.178702354431152, loss=0.38339829444885254, param_norm=1887.10595703125
Step 522: grad_norm=3.6972451210021973, loss=0.5319103002548218, param_norm=1887.1060791015625
00:56:51.341 [I] Progress on: 522it/1.00kit rate:8.8s/it remaining:1:10:10 elapsed:1:17:29 postfix:- (303899:tqdm_logging.py:145)
Step 523: grad_norm=5.501950740814209, loss=0.5719588398933411, param_norm=1887.1063232421875
Step 524: grad_norm=6.365593910217285, loss=0.4486731290817261, param_norm=1887.1065673828125
00:57:08.944 [I] Progress on: 524it/1.00kit rate:8.8s/it remaining:1:09:48 elapsed:1:17:47 postfix:- (303899:tqdm_logging.py:145)
Step 525: grad_norm=5.89457893371582, loss=0.4849739670753479, param_norm=1887.106689453125
Step 526: grad_norm=3.6027395725250244, loss=0.4450259208679199, param_norm=1887.1068115234375
00:57:26.539 [I] Progress on: 526it/1.00kit rate:8.8s/it remaining:1:09:31 elapsed:1:18:04 postfix:- (303899:tqdm_logging.py:145)
Step 527: grad_norm=5.235108375549316, loss=0.5603174567222595, param_norm=1887.10693359375
Step 528: grad_norm=5.683099746704102, loss=0.5721511840820312, param_norm=1887.1070556640625
00:57:44.141 [I] Progress on: 528it/1.00kit rate:8.8s/it remaining:1:09:10 elapsed:1:18:22 postfix:- (303899:tqdm_logging.py:145)
Step 529: grad_norm=8.274399757385254, loss=0.4870075285434723, param_norm=1887.1072998046875
Step 530: grad_norm=5.373871326446533, loss=0.45424598455429077, param_norm=1887.107421875
00:58:01.763 [I] Progress on: 530it/1.00kit rate:8.8s/it remaining:1:08:56 elapsed:1:18:40 postfix:- (303899:tqdm_logging.py:145)
Step 531: grad_norm=7.1706976890563965, loss=0.5528608560562134, param_norm=1887.1075439453125
Step 532: grad_norm=5.220586776733398, loss=0.5012155771255493, param_norm=1887.107666015625
00:58:19.382 [I] Progress on: 532it/1.00kit rate:8.8s/it remaining:1:08:40 elapsed:1:18:57 postfix:- (303899:tqdm_logging.py:145)
Step 533: grad_norm=5.55936336517334, loss=0.4674904942512512, param_norm=1887.1077880859375
Step 534: grad_norm=3.3867616653442383, loss=0.4442630708217621, param_norm=1887.1080322265625
00:58:36.985 [I] Progress on: 534it/1.00kit rate:8.8s/it remaining:1:08:21 elapsed:1:19:15 postfix:- (303899:tqdm_logging.py:145)
Step 535: grad_norm=4.208025932312012, loss=0.4472946524620056, param_norm=1887.1082763671875
Step 536: grad_norm=3.8752119541168213, loss=0.4821733236312866, param_norm=1887.1083984375
00:58:54.604 [I] Progress on: 536it/1.00kit rate:8.8s/it remaining:1:08:04 elapsed:1:19:32 postfix:- (303899:tqdm_logging.py:145)
Step 537: grad_norm=4.419421672821045, loss=0.48733586072921753, param_norm=1887.1085205078125
Step 538: grad_norm=4.070503234863281, loss=0.4792625606060028, param_norm=1887.108642578125
00:59:12.340 [I] Progress on: 538it/1.00kit rate:8.8s/it remaining:1:08:04 elapsed:1:19:50 postfix:- (303899:tqdm_logging.py:145)
Step 539: grad_norm=4.763343811035156, loss=0.44861215353012085, param_norm=1887.10888671875
Step 540: grad_norm=5.330085754394531, loss=0.5055578351020813, param_norm=1887.109130859375
00:59:29.991 [I] Progress on: 540it/1.00kit rate:8.8s/it remaining:1:07:40 elapsed:1:20:08 postfix:- (303899:tqdm_logging.py:145)
Step 541: grad_norm=4.283504486083984, loss=0.43824970722198486, param_norm=1887.109130859375
Step 542: grad_norm=3.9135522842407227, loss=0.4631604552268982, param_norm=1887.1092529296875
00:59:47.610 [I] Progress on: 542it/1.00kit rate:8.8s/it remaining:1:07:18 elapsed:1:20:25 postfix:- (303899:tqdm_logging.py:145)
Step 543: grad_norm=3.894476890563965, loss=0.4312637746334076, param_norm=1887.109619140625
Step 544: grad_norm=4.069465637207031, loss=0.5018336176872253, param_norm=1887.109619140625
01:00:05.215 [I] Progress on: 544it/1.00kit rate:8.8s/it remaining:1:06:56 elapsed:1:20:43 postfix:- (303899:tqdm_logging.py:145)
Step 545: grad_norm=3.7579867839813232, loss=0.4686790704727173, param_norm=1887.1097412109375
01:00:16.495 [I] Progress on: 546it/1.00kit rate:9.5s/it remaining:1:11:49 elapsed:1:20:54 postfix:- (303899:tqdm_logging.py:145)
Step 546: grad_norm=4.063598155975342, loss=0.4361509680747986, param_norm=1887.1099853515625
Step 547: grad_norm=3.048283815383911, loss=0.43558305501937866, param_norm=1887.1102294921875
01:00:33.933 [I] Progress on: 547it/1.00kit rate:9.3s/it remaining:1:10:08 elapsed:1:21:12 postfix:- (303899:tqdm_logging.py:145)
Step 548: grad_norm=4.583854675292969, loss=0.47214141488075256, param_norm=1887.1103515625
Step 549: grad_norm=3.342522382736206, loss=0.42451468110084534, param_norm=1887.110595703125
01:00:51.535 [I] Progress on: 549it/1.00kit rate:9.0s/it remaining:1:07:58 elapsed:1:21:29 postfix:- (303899:tqdm_logging.py:145)
Step 550: grad_norm=4.61308479309082, loss=0.5498955845832825, param_norm=1887.1107177734375
Step 551: grad_norm=3.1412150859832764, loss=0.35350501537323, param_norm=1887.11083984375
01:01:09.127 [I] Progress on: 551it/1.00kit rate:8.9s/it remaining:1:06:45 elapsed:1:21:47 postfix:- (303899:tqdm_logging.py:145)
Step 552: grad_norm=5.090514659881592, loss=0.42030543088912964, param_norm=1887.1109619140625
Step 553: grad_norm=3.262057065963745, loss=0.41755712032318115, param_norm=1887.111083984375
01:01:26.706 [I] Progress on: 553it/1.00kit rate:8.9s/it remaining:1:05:58 elapsed:1:22:05 postfix:- (303899:tqdm_logging.py:145)
Step 554: grad_norm=3.906966209411621, loss=0.5104289054870605, param_norm=1887.111328125
Step 555: grad_norm=3.9870433807373047, loss=0.4490651488304138, param_norm=1887.1114501953125
01:01:44.316 [I] Progress on: 555it/1.00kit rate:8.8s/it remaining:1:05:30 elapsed:1:22:22 postfix:- (303899:tqdm_logging.py:145)
Step 556: grad_norm=2.9980247020721436, loss=0.35680675506591797, param_norm=1887.111572265625
Step 557: grad_norm=2.8134894371032715, loss=0.4110097885131836, param_norm=1887.11181640625
01:02:01.870 [I] Progress on: 557it/1.00kit rate:8.8s/it remaining:1:05:02 elapsed:1:22:40 postfix:- (303899:tqdm_logging.py:145)
Step 558: grad_norm=3.784224033355713, loss=0.4247285723686218, param_norm=1887.11181640625
Step 559: grad_norm=3.133641242980957, loss=0.44711220264434814, param_norm=1887.112060546875
01:02:19.469 [I] Progress on: 559it/1.00kit rate:8.8s/it remaining:1:04:42 elapsed:1:22:57 postfix:- (303899:tqdm_logging.py:145)
Step 560: grad_norm=3.0718448162078857, loss=0.39442571997642517, param_norm=1887.1121826171875
Step 561: grad_norm=3.135697364807129, loss=0.4316357374191284, param_norm=1887.1123046875
01:02:37.077 [I] Progress on: 561it/1.00kit rate:8.8s/it remaining:1:04:25 elapsed:1:23:15 postfix:- (303899:tqdm_logging.py:145)
Step 562: grad_norm=4.734333038330078, loss=0.4454907774925232, param_norm=1887.1124267578125
Step 563: grad_norm=4.207919120788574, loss=0.42222845554351807, param_norm=1887.1126708984375
01:02:54.685 [I] Progress on: 563it/1.00kit rate:8.8s/it remaining:1:04:10 elapsed:1:23:33 postfix:- (303899:tqdm_logging.py:145)
Step 564: grad_norm=3.282802104949951, loss=0.4815870523452759, param_norm=1887.11279296875
Step 565: grad_norm=4.486061096191406, loss=0.47441887855529785, param_norm=1887.1129150390625
01:03:12.286 [I] Progress on: 565it/1.00kit rate:8.8s/it remaining:1:03:50 elapsed:1:23:50 postfix:- (303899:tqdm_logging.py:145)
Step 566: grad_norm=4.743411540985107, loss=0.47794783115386963, param_norm=1887.113037109375
Step 567: grad_norm=3.3418569564819336, loss=0.36651360988616943, param_norm=1887.1131591796875
01:03:29.889 [I] Progress on: 567it/1.00kit rate:8.8s/it remaining:1:03:32 elapsed:1:24:08 postfix:- (303899:tqdm_logging.py:145)
Step 568: grad_norm=4.277774333953857, loss=0.4313505291938782, param_norm=1887.11328125
Step 569: grad_norm=3.582470655441284, loss=0.45930173993110657, param_norm=1887.1134033203125
01:03:47.500 [I] Progress on: 569it/1.00kit rate:8.8s/it remaining:1:03:15 elapsed:1:24:25 postfix:- (303899:tqdm_logging.py:145)
Step 570: grad_norm=3.2882063388824463, loss=0.4271160364151001, param_norm=1887.113525390625
Step 571: grad_norm=3.4931976795196533, loss=0.46554988622665405, param_norm=1887.113525390625
01:04:05.106 [I] Progress on: 571it/1.00kit rate:8.8s/it remaining:1:02:58 elapsed:1:24:43 postfix:- (303899:tqdm_logging.py:145)
Step 572: grad_norm=3.287317991256714, loss=0.4419229030609131, param_norm=1887.1136474609375
Step 573: grad_norm=3.3942270278930664, loss=0.446167528629303, param_norm=1887.11376953125
01:04:22.718 [I] Progress on: 573it/1.00kit rate:8.8s/it remaining:1:02:40 elapsed:1:25:01 postfix:- (303899:tqdm_logging.py:145)
Step 574: grad_norm=3.3270576000213623, loss=0.41358044743537903, param_norm=1887.1138916015625
Step 575: grad_norm=3.0431840419769287, loss=0.4217149317264557, param_norm=1887.114013671875
01:04:40.336 [I] Progress on: 575it/1.00kit rate:8.8s/it remaining:1:02:23 elapsed:1:25:18 postfix:- (303899:tqdm_logging.py:145)
Step 576: grad_norm=3.4618606567382812, loss=0.4133473038673401, param_norm=1887.1141357421875
Step 577: grad_norm=3.9379220008850098, loss=0.3837083578109741, param_norm=1887.1143798828125
01:04:57.956 [I] Progress on: 577it/1.00kit rate:8.8s/it remaining:1:02:07 elapsed:1:25:36 postfix:- (303899:tqdm_logging.py:145)
Step 578: grad_norm=4.21439266204834, loss=0.3883075714111328, param_norm=1887.114501953125
Step 579: grad_norm=3.491501808166504, loss=0.4281451106071472, param_norm=1887.1146240234375
01:05:15.568 [I] Progress on: 579it/1.00kit rate:8.8s/it remaining:1:01:49 elapsed:1:25:53 postfix:- (303899:tqdm_logging.py:145)
Step 580: grad_norm=3.026212692260742, loss=0.3671877980232239, param_norm=1887.1148681640625
Step 581: grad_norm=3.4732635021209717, loss=0.44677209854125977, param_norm=1887.114990234375
01:05:33.187 [I] Progress on: 581it/1.00kit rate:8.8s/it remaining:1:01:33 elapsed:1:26:11 postfix:- (303899:tqdm_logging.py:145)
Step 582: grad_norm=3.4051480293273926, loss=0.4003604054450989, param_norm=1887.1151123046875
Step 583: grad_norm=5.398845672607422, loss=0.4148831367492676, param_norm=1887.1153564453125
01:05:50.796 [I] Progress on: 583it/1.00kit rate:8.8s/it remaining:1:01:13 elapsed:1:26:29 postfix:- (303899:tqdm_logging.py:145)
Step 584: grad_norm=3.6924681663513184, loss=0.4311763048171997, param_norm=1887.115478515625
01:06:02.114 [I] Progress on: 585it/1.00kit rate:9.5s/it remaining:1:05:46 elapsed:1:26:40 postfix:- (303899:tqdm_logging.py:145)
Step 585: grad_norm=2.6182761192321777, loss=0.3130740523338318, param_norm=1887.115478515625
Step 586: grad_norm=2.929405689239502, loss=0.32131385803222656, param_norm=1887.1156005859375
01:06:19.463 [I] Progress on: 586it/1.00kit rate:9.3s/it remaining:1:03:59 elapsed:1:26:57 postfix:- (303899:tqdm_logging.py:145)
Step 587: grad_norm=2.952511787414551, loss=0.3781016767024994, param_norm=1887.1158447265625
Step 588: grad_norm=2.8594517707824707, loss=0.35665011405944824, param_norm=1887.115966796875
01:06:37.031 [I] Progress on: 588it/1.00kit rate:9.0s/it remaining:1:01:56 elapsed:1:27:15 postfix:- (303899:tqdm_logging.py:145)
Step 589: grad_norm=3.8789281845092773, loss=0.4229179918766022, param_norm=1887.1160888671875
Step 590: grad_norm=3.3359158039093018, loss=0.4732505679130554, param_norm=1887.1162109375
01:06:54.642 [I] Progress on: 590it/1.00kit rate:8.9s/it remaining:1:00:50 elapsed:1:27:33 postfix:- (303899:tqdm_logging.py:145)
Step 591: grad_norm=3.897547483444214, loss=0.4773823022842407, param_norm=1887.1163330078125
Step 592: grad_norm=3.2796051502227783, loss=0.4277113378047943, param_norm=1887.116455078125
01:07:12.204 [I] Progress on: 592it/1.00kit rate:8.8s/it remaining:1:00:05 elapsed:1:27:50 postfix:- (303899:tqdm_logging.py:145)
Step 593: grad_norm=3.3703668117523193, loss=0.36996954679489136, param_norm=1887.1165771484375
Step 594: grad_norm=3.6702568531036377, loss=0.41420653462409973, param_norm=1887.11669921875
01:07:29.829 [I] Progress on: 594it/1.00kit rate:8.8s/it remaining:59:39 elapsed:1:28:08 postfix:- (303899:tqdm_logging.py:145)
Step 595: grad_norm=4.044650077819824, loss=0.4423680603504181, param_norm=1887.1168212890625
Step 596: grad_norm=4.253693103790283, loss=0.39632105827331543, param_norm=1887.116943359375
01:07:47.382 [I] Progress on: 596it/1.00kit rate:8.8s/it remaining:59:11 elapsed:1:28:25 postfix:- (303899:tqdm_logging.py:145)
Step 597: grad_norm=3.521080493927002, loss=0.38766440749168396, param_norm=1887.1170654296875
Step 598: grad_norm=3.8101449012756348, loss=0.4093239903450012, param_norm=1887.1170654296875
01:08:05.005 [I] Progress on: 598it/1.00kit rate:8.8s/it remaining:58:55 elapsed:1:28:43 postfix:- (303899:tqdm_logging.py:145)
Step 599: grad_norm=3.14052152633667, loss=0.36315637826919556, param_norm=1887.1171875
Step 600: grad_norm=4.366392612457275, loss=0.4488624334335327, param_norm=1887.117431640625
01:08:22.574 [I] Progress on: 600it/1.00kit rate:8.8s/it remaining:58:33 elapsed:1:29:00 postfix:- (303899:tqdm_logging.py:145)
01:08:22.865 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
01:08:22.865 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
01:08:22.865 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (303899:checkpoint_manager.py:1786)
01:08:22.866 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (303899:checkpoint_manager.py:1817)
01:08:22.866 [I] [process=0] Saving checkpoint at step 600                                        (303899:checkpoint_manager.py:1286)
01:08:22.867 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600. (303899:async_checkpointer.py:358)
01:08:22.868 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:08:22.868 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15 (303899:atomicity.py:144)
01:08:22.869 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:08:22.869 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:08:22.870 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (303899:atomicity.py:144)
01:08:22.871 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (303899:atomicity.py:144)
01:08:22.871 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:08:22.876 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
01:08:26.484 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
01:08:26.485 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:08:26.486 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
01:08:26.488 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
01:08:26.511 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:08:26.515 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:08:26.516 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:08:26.517 [I] Preserving Checkpoint[step=400 | time=2025-03-25 04:38:45.986340+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:08:26.519 [I] Preserving Checkpoint[step=500 | time=2025-03-25 04:53:35.326173+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:08:26.524 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
01:08:26.525 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
01:08:26.529 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
01:08:26.531 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742879302.8654037, 'wait_for_prev_duration_secs': 0.0007073879241943359, 'checkpointer_blocking_start_time': 1742879302.8666594, 'checkpointer_blocking_duration_secs': 3.6445934772491455, 'get_old_steps_start_time': 1742879306.5113113, 'get_old_steps_duration_secs': 0.012781620025634766, 'checkpoint_manager_blocking_start_time': 1742879302.8652484, 'checkpoint_manager_blocking_duration_secs': 3.6660971641540527} (303899:standard_logger.py:34)
01:08:33.494 [I] ChainedFuture completed 1/1 futures in 7.00 seconds.                             (303899:future.py:137)
01:08:33.495 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 975.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:08:33.495 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
01:08:33.496 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15 (303899:async_checkpointer.py:406)
01:08:33.497 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15/assets (303899:atomicity.py:287)
01:08:33.507 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15/params (303899:atomicity.py:287)
01:08:33.508 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600 (303899:async_checkpointer.py:416)
01:08:33.508 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15 (303899:async_checkpointer.py:426)
01:08:33.509 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600 (303899:atomicity.py:287)
01:08:33.510 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/600`. (303899:atomicity.py:548)
01:08:33.510 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
01:08:33.511 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
01:08:33.511 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
01:08:33.512 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
01:08:33.512 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 601: grad_norm=3.093702793121338, loss=0.3807199001312256, param_norm=1887.1175537109375
01:08:35.162 [I] Progress on: 601it/1.00kit rate:9.9s/it remaining:1:06:00 elapsed:1:29:13 postfix:- (303899:tqdm_logging.py:145)
Step 602: grad_norm=2.7502994537353516, loss=0.34392717480659485, param_norm=1887.11767578125
Step 603: grad_norm=3.01094913482666, loss=0.38516587018966675, param_norm=1887.1177978515625
01:08:52.712 [I] Progress on: 603it/1.00kit rate:9.3s/it remaining:1:01:51 elapsed:1:29:31 postfix:- (303899:tqdm_logging.py:145)
Step 604: grad_norm=4.076918601989746, loss=0.40300413966178894, param_norm=1887.117919921875
Step 605: grad_norm=4.249997615814209, loss=0.3812446594238281, param_norm=1887.1180419921875
01:09:10.389 [I] Progress on: 605it/1.00kit rate:9.1s/it remaining:59:51 elapsed:1:29:48 postfix:- (303899:tqdm_logging.py:145)
Step 606: grad_norm=3.965245246887207, loss=0.3532204031944275, param_norm=1887.1182861328125
Step 607: grad_norm=3.6951184272766113, loss=0.4414932131767273, param_norm=1887.118408203125
01:09:27.961 [I] Progress on: 607it/1.00kit rate:8.9s/it remaining:58:33 elapsed:1:30:06 postfix:- (303899:tqdm_logging.py:145)
Step 608: grad_norm=3.3136234283447266, loss=0.3989889323711395, param_norm=1887.118408203125
Step 609: grad_norm=4.179981231689453, loss=0.40407443046569824, param_norm=1887.11865234375
01:09:45.568 [I] Progress on: 609it/1.00kit rate:8.9s/it remaining:57:51 elapsed:1:30:23 postfix:- (303899:tqdm_logging.py:145)
Step 610: grad_norm=3.902662992477417, loss=0.3900633454322815, param_norm=1887.11865234375
Step 611: grad_norm=4.224700927734375, loss=0.4115943908691406, param_norm=1887.1187744140625
01:10:03.130 [I] Progress on: 611it/1.00kit rate:8.8s/it remaining:57:15 elapsed:1:30:41 postfix:- (303899:tqdm_logging.py:145)
Step 612: grad_norm=5.0459418296813965, loss=0.3918007016181946, param_norm=1887.1187744140625
Step 613: grad_norm=3.1723201274871826, loss=0.4191190004348755, param_norm=1887.118896484375
01:10:20.761 [I] Progress on: 613it/1.00kit rate:8.8s/it remaining:56:57 elapsed:1:30:59 postfix:- (303899:tqdm_logging.py:145)
Step 614: grad_norm=3.300908088684082, loss=0.38500943779945374, param_norm=1887.1190185546875
Step 615: grad_norm=4.073081970214844, loss=0.414139986038208, param_norm=1887.119140625
01:10:38.327 [I] Progress on: 615it/1.00kit rate:8.8s/it remaining:56:32 elapsed:1:31:16 postfix:- (303899:tqdm_logging.py:145)
Step 616: grad_norm=3.80362606048584, loss=0.42544060945510864, param_norm=1887.119140625
Step 617: grad_norm=3.6140570640563965, loss=0.3920515775680542, param_norm=1887.1192626953125
01:10:55.936 [I] Progress on: 617it/1.00kit rate:8.8s/it remaining:56:16 elapsed:1:31:34 postfix:- (303899:tqdm_logging.py:145)
Step 618: grad_norm=2.9884300231933594, loss=0.37138092517852783, param_norm=1887.1192626953125
Step 619: grad_norm=2.9852921962738037, loss=0.36500322818756104, param_norm=1887.1195068359375
01:11:13.499 [I] Progress on: 619it/1.00kit rate:8.8s/it remaining:55:53 elapsed:1:31:51 postfix:- (303899:tqdm_logging.py:145)
Step 620: grad_norm=3.401944160461426, loss=0.3620540201663971, param_norm=1887.1195068359375
Step 621: grad_norm=3.3387415409088135, loss=0.3575352430343628, param_norm=1887.11962890625
01:11:31.119 [I] Progress on: 621it/1.00kit rate:8.8s/it remaining:55:39 elapsed:1:32:09 postfix:- (303899:tqdm_logging.py:145)
Step 622: grad_norm=4.041097640991211, loss=0.34600141644477844, param_norm=1887.1197509765625
Step 623: grad_norm=4.126602649688721, loss=0.4060271382331848, param_norm=1887.1197509765625
01:11:48.627 [I] Progress on: 623it/1.00kit rate:8.8s/it remaining:55:12 elapsed:1:32:26 postfix:- (303899:tqdm_logging.py:145)
Step 624: grad_norm=2.845262050628662, loss=0.32091856002807617, param_norm=1887.119873046875
01:11:59.711 [I] Progress on: 624it/1.00kit rate:9.5s/it remaining:59:23 elapsed:1:32:38 postfix:- (303899:tqdm_logging.py:145)
Step 625: grad_norm=3.3803551197052, loss=0.3335471749305725, param_norm=1887.1199951171875
Step 626: grad_norm=3.2964890003204346, loss=0.3669273853302002, param_norm=1887.1201171875
01:12:17.297 [I] Progress on: 626it/1.00kit rate:9.1s/it remaining:56:54 elapsed:1:32:55 postfix:- (303899:tqdm_logging.py:145)
Step 627: grad_norm=2.8335044384002686, loss=0.3344627618789673, param_norm=1887.120361328125
Step 628: grad_norm=3.016392946243286, loss=0.34175658226013184, param_norm=1887.120361328125
01:12:34.887 [I] Progress on: 628it/1.00kit rate:9.0s/it remaining:55:33 elapsed:1:33:13 postfix:- (303899:tqdm_logging.py:145)
Step 629: grad_norm=3.246636390686035, loss=0.4001529812812805, param_norm=1887.12060546875
Step 630: grad_norm=2.8036270141601562, loss=0.34939587116241455, param_norm=1887.1207275390625
01:12:52.536 [I] Progress on: 630it/1.00kit rate:8.9s/it remaining:54:48 elapsed:1:33:30 postfix:- (303899:tqdm_logging.py:145)
Step 631: grad_norm=2.046191692352295, loss=0.24006906151771545, param_norm=1887.1207275390625
Step 632: grad_norm=2.898836851119995, loss=0.30538755655288696, param_norm=1887.120849609375
01:13:10.148 [I] Progress on: 632it/1.00kit rate:8.8s/it remaining:54:16 elapsed:1:33:48 postfix:- (303899:tqdm_logging.py:145)
Step 633: grad_norm=2.796313762664795, loss=0.31561142206192017, param_norm=1887.1209716796875
Step 634: grad_norm=2.8559584617614746, loss=0.31486353278160095, param_norm=1887.1209716796875
01:13:27.750 [I] Progress on: 634it/1.00kit rate:8.8s/it remaining:53:51 elapsed:1:34:06 postfix:- (303899:tqdm_logging.py:145)
Step 635: grad_norm=3.4573309421539307, loss=0.3715370297431946, param_norm=1887.1212158203125
Step 636: grad_norm=4.121117115020752, loss=0.33868712186813354, param_norm=1887.1212158203125
01:13:45.351 [I] Progress on: 636it/1.00kit rate:8.8s/it remaining:53:29 elapsed:1:34:23 postfix:- (303899:tqdm_logging.py:145)
Step 637: grad_norm=3.915675163269043, loss=0.35221046209335327, param_norm=1887.121337890625
Step 638: grad_norm=3.3210551738739014, loss=0.3950483798980713, param_norm=1887.1214599609375
01:14:02.959 [I] Progress on: 638it/1.00kit rate:8.8s/it remaining:53:09 elapsed:1:34:41 postfix:- (303899:tqdm_logging.py:145)
Step 639: grad_norm=3.2251248359680176, loss=0.32531070709228516, param_norm=1887.12158203125
Step 640: grad_norm=3.285064697265625, loss=0.32029104232788086, param_norm=1887.12158203125
01:14:20.537 [I] Progress on: 640it/1.00kit rate:8.8s/it remaining:52:48 elapsed:1:34:58 postfix:- (303899:tqdm_logging.py:145)
Step 641: grad_norm=2.4147629737854004, loss=0.33067917823791504, param_norm=1887.1217041015625
Step 642: grad_norm=2.365854024887085, loss=0.3259200155735016, param_norm=1887.121826171875
01:14:38.157 [I] Progress on: 642it/1.00kit rate:8.8s/it remaining:52:32 elapsed:1:35:16 postfix:- (303899:tqdm_logging.py:145)
Step 643: grad_norm=3.661499261856079, loss=0.34293967485427856, param_norm=1887.1219482421875
Step 644: grad_norm=2.467956781387329, loss=0.3043243885040283, param_norm=1887.1220703125
01:14:55.778 [I] Progress on: 644it/1.00kit rate:8.8s/it remaining:52:16 elapsed:1:35:34 postfix:- (303899:tqdm_logging.py:145)
Step 645: grad_norm=3.1205992698669434, loss=0.3317946195602417, param_norm=1887.1220703125
Step 646: grad_norm=2.5974316596984863, loss=0.283636212348938, param_norm=1887.1221923828125
01:15:13.397 [I] Progress on: 646it/1.00kit rate:8.8s/it remaining:52:00 elapsed:1:35:51 postfix:- (303899:tqdm_logging.py:145)
Step 647: grad_norm=2.9214868545532227, loss=0.33663585782051086, param_norm=1887.122314453125
Step 648: grad_norm=2.881847858428955, loss=0.27791160345077515, param_norm=1887.1224365234375
01:15:31.018 [I] Progress on: 648it/1.00kit rate:8.8s/it remaining:51:42 elapsed:1:36:09 postfix:- (303899:tqdm_logging.py:145)
Step 649: grad_norm=3.2737181186676025, loss=0.3519268035888672, param_norm=1887.12255859375
Step 650: grad_norm=4.742673397064209, loss=0.35582906007766724, param_norm=1887.12255859375
01:15:48.651 [I] Progress on: 650it/1.00kit rate:8.8s/it remaining:51:26 elapsed:1:36:27 postfix:- (303899:tqdm_logging.py:145)
Step 651: grad_norm=3.2482261657714844, loss=0.3211756944656372, param_norm=1887.1226806640625
Step 652: grad_norm=2.5415470600128174, loss=0.28693127632141113, param_norm=1887.1229248046875
01:16:06.302 [I] Progress on: 652it/1.00kit rate:8.8s/it remaining:51:11 elapsed:1:36:44 postfix:- (303899:tqdm_logging.py:145)
Step 653: grad_norm=2.9804887771606445, loss=0.320478618144989, param_norm=1887.1229248046875
Step 654: grad_norm=2.5900399684906006, loss=0.32473042607307434, param_norm=1887.1229248046875
01:16:23.908 [I] Progress on: 654it/1.00kit rate:8.8s/it remaining:50:50 elapsed:1:37:02 postfix:- (303899:tqdm_logging.py:145)
Step 655: grad_norm=3.2689452171325684, loss=0.3461281359195709, param_norm=1887.123046875
Step 656: grad_norm=3.535184860229492, loss=0.35784077644348145, param_norm=1887.1231689453125
01:16:41.515 [I] Progress on: 656it/1.00kit rate:8.8s/it remaining:50:31 elapsed:1:37:19 postfix:- (303899:tqdm_logging.py:145)
Step 657: grad_norm=3.179593324661255, loss=0.3303961157798767, param_norm=1887.1231689453125
Step 658: grad_norm=2.8667330741882324, loss=0.27029910683631897, param_norm=1887.123291015625
01:16:59.116 [I] Progress on: 658it/1.00kit rate:8.8s/it remaining:50:12 elapsed:1:37:37 postfix:- (303899:tqdm_logging.py:145)
Step 659: grad_norm=3.2669320106506348, loss=0.2971932291984558, param_norm=1887.123291015625
Step 660: grad_norm=2.7682363986968994, loss=0.37684351205825806, param_norm=1887.123291015625
01:17:16.715 [I] Progress on: 660it/1.00kit rate:8.8s/it remaining:49:53 elapsed:1:37:55 postfix:- (303899:tqdm_logging.py:145)
Step 661: grad_norm=3.1761884689331055, loss=0.3886478543281555, param_norm=1887.1234130859375
Step 662: grad_norm=3.1608870029449463, loss=0.3010977804660797, param_norm=1887.1236572265625
01:17:34.331 [I] Progress on: 662it/1.00kit rate:8.8s/it remaining:49:38 elapsed:1:38:12 postfix:- (303899:tqdm_logging.py:145)
Step 663: grad_norm=2.20904803276062, loss=0.2769627571105957, param_norm=1887.1236572265625
01:17:45.329 [I] Progress on: 663it/1.00kit rate:9.5s/it remaining:53:10 elapsed:1:38:23 postfix:- (303899:tqdm_logging.py:145)
Step 664: grad_norm=2.6679844856262207, loss=0.31946027278900146, param_norm=1887.123779296875
Step 665: grad_norm=2.365583896636963, loss=0.28631478548049927, param_norm=1887.123779296875
01:18:02.925 [I] Progress on: 665it/1.00kit rate:9.1s/it remaining:50:56 elapsed:1:38:41 postfix:- (303899:tqdm_logging.py:145)
Step 666: grad_norm=3.437748432159424, loss=0.3195748031139374, param_norm=1887.123779296875
Step 667: grad_norm=3.014312744140625, loss=0.3208377957344055, param_norm=1887.1240234375
01:18:20.542 [I] Progress on: 667it/1.00kit rate:9.0s/it remaining:49:43 elapsed:1:38:58 postfix:- (303899:tqdm_logging.py:145)
Step 668: grad_norm=3.001278877258301, loss=0.26776403188705444, param_norm=1887.1240234375
Step 669: grad_norm=2.4825637340545654, loss=0.29574382305145264, param_norm=1887.1241455078125
01:18:38.159 [I] Progress on: 669it/1.00kit rate:8.9s/it remaining:48:59 elapsed:1:39:16 postfix:- (303899:tqdm_logging.py:145)
Step 670: grad_norm=2.8526206016540527, loss=0.3197469115257263, param_norm=1887.1241455078125
Step 671: grad_norm=3.1934828758239746, loss=0.33424854278564453, param_norm=1887.1243896484375
01:18:55.774 [I] Progress on: 671it/1.00kit rate:8.8s/it remaining:48:28 elapsed:1:39:34 postfix:- (303899:tqdm_logging.py:145)
Step 672: grad_norm=2.4621622562408447, loss=0.3076930046081543, param_norm=1887.1243896484375
Step 673: grad_norm=2.3246214389801025, loss=0.30194899439811707, param_norm=1887.1243896484375
01:19:13.406 [I] Progress on: 673it/1.00kit rate:8.8s/it remaining:48:05 elapsed:1:39:51 postfix:- (303899:tqdm_logging.py:145)
Step 674: grad_norm=2.3986504077911377, loss=0.26329633593559265, param_norm=1887.12451171875
Step 675: grad_norm=2.9349124431610107, loss=0.3148285150527954, param_norm=1887.1246337890625
01:19:31.011 [I] Progress on: 675it/1.00kit rate:8.8s/it remaining:47:44 elapsed:1:40:09 postfix:- (303899:tqdm_logging.py:145)
Step 676: grad_norm=2.9561760425567627, loss=0.36822310090065, param_norm=1887.1246337890625
Step 677: grad_norm=3.047062397003174, loss=0.2696576416492462, param_norm=1887.124755859375
01:19:48.614 [I] Progress on: 677it/1.00kit rate:8.8s/it remaining:47:23 elapsed:1:40:26 postfix:- (303899:tqdm_logging.py:145)
Step 678: grad_norm=2.6627938747406006, loss=0.24448004364967346, param_norm=1887.124755859375
Step 679: grad_norm=2.724526882171631, loss=0.2755379378795624, param_norm=1887.1248779296875
01:20:06.189 [I] Progress on: 679it/1.00kit rate:8.8s/it remaining:47:02 elapsed:1:40:44 postfix:- (303899:tqdm_logging.py:145)
Step 680: grad_norm=2.7861671447753906, loss=0.33809706568717957, param_norm=1887.1248779296875
Step 681: grad_norm=3.2711539268493652, loss=0.3483055830001831, param_norm=1887.125
01:20:23.838 [I] Progress on: 681it/1.00kit rate:8.8s/it remaining:46:48 elapsed:1:41:02 postfix:- (303899:tqdm_logging.py:145)
Step 682: grad_norm=2.662951946258545, loss=0.3112930655479431, param_norm=1887.125
Step 683: grad_norm=3.0268428325653076, loss=0.2847142219543457, param_norm=1887.1251220703125
01:20:41.446 [I] Progress on: 683it/1.00kit rate:8.8s/it remaining:46:30 elapsed:1:41:19 postfix:- (303899:tqdm_logging.py:145)
Step 684: grad_norm=2.543654203414917, loss=0.2765654921531677, param_norm=1887.125244140625
Step 685: grad_norm=2.9587197303771973, loss=0.3154648542404175, param_norm=1887.1253662109375
01:20:59.067 [I] Progress on: 685it/1.00kit rate:8.8s/it remaining:46:12 elapsed:1:41:37 postfix:- (303899:tqdm_logging.py:145)
Step 686: grad_norm=2.5026328563690186, loss=0.2969791889190674, param_norm=1887.1253662109375
Step 687: grad_norm=2.810899019241333, loss=0.3152998089790344, param_norm=1887.1253662109375
01:21:16.681 [I] Progress on: 687it/1.00kit rate:8.8s/it remaining:45:55 elapsed:1:41:55 postfix:- (303899:tqdm_logging.py:145)
Step 688: grad_norm=2.8160288333892822, loss=0.2654111087322235, param_norm=1887.12548828125
Step 689: grad_norm=2.6082727909088135, loss=0.2987681031227112, param_norm=1887.1256103515625
01:21:34.286 [I] Progress on: 689it/1.00kit rate:8.8s/it remaining:45:37 elapsed:1:42:12 postfix:- (303899:tqdm_logging.py:145)
Step 690: grad_norm=2.5008368492126465, loss=0.27968692779541016, param_norm=1887.125732421875
Step 691: grad_norm=2.6993322372436523, loss=0.3155122995376587, param_norm=1887.125732421875
01:21:51.945 [I] Progress on: 691it/1.00kit rate:8.8s/it remaining:45:22 elapsed:1:42:30 postfix:- (303899:tqdm_logging.py:145)
Step 692: grad_norm=4.051819324493408, loss=0.3182433247566223, param_norm=1887.125732421875
Step 693: grad_norm=2.9687182903289795, loss=0.2785956561565399, param_norm=1887.1259765625
01:22:09.557 [I] Progress on: 693it/1.00kit rate:8.8s/it remaining:45:04 elapsed:1:42:47 postfix:- (303899:tqdm_logging.py:145)
Step 694: grad_norm=2.720196008682251, loss=0.29445481300354004, param_norm=1887.1259765625
Step 695: grad_norm=3.017653465270996, loss=0.3218953311443329, param_norm=1887.1259765625
01:22:27.177 [I] Progress on: 695it/1.00kit rate:8.8s/it remaining:44:46 elapsed:1:43:05 postfix:- (303899:tqdm_logging.py:145)
Step 696: grad_norm=2.8997833728790283, loss=0.3348928391933441, param_norm=1887.1260986328125
Step 697: grad_norm=3.0140836238861084, loss=0.3095562756061554, param_norm=1887.1260986328125
01:22:44.847 [I] Progress on: 697it/1.00kit rate:8.8s/it remaining:44:31 elapsed:1:43:23 postfix:- (303899:tqdm_logging.py:145)
Step 698: grad_norm=2.8642799854278564, loss=0.28905215859413147, param_norm=1887.126220703125
Step 699: grad_norm=2.6509459018707275, loss=0.2756326198577881, param_norm=1887.126220703125
01:23:02.478 [I] Progress on: 699it/1.00kit rate:8.8s/it remaining:44:13 elapsed:1:43:40 postfix:- (303899:tqdm_logging.py:145)
Step 700: grad_norm=2.9360475540161133, loss=0.32332560420036316, param_norm=1887.126220703125
01:23:11.484 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
01:23:11.484 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
01:23:11.484 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (303899:checkpoint_manager.py:1786)
01:23:11.485 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (303899:checkpoint_manager.py:1817)
01:23:11.485 [I] [process=0] Saving checkpoint at step 700                                        (303899:checkpoint_manager.py:1286)
01:23:11.486 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700. (303899:async_checkpointer.py:358)
01:23:11.487 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:23:11.488 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18 (303899:atomicity.py:144)
01:23:11.488 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:23:11.489 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:23:11.490 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (303899:atomicity.py:144)
01:23:11.490 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (303899:atomicity.py:144)
01:23:11.491 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:23:11.495 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
01:23:15.036 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
01:23:15.037 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.9 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:23:15.038 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
01:23:15.039 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
01:23:15.063 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:23:15.074 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:23:15.075 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:23:15.076 [I] Preserving Checkpoint[step=400 | time=2025-03-25 04:38:45.986340+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:23:15.078 [I] Preserving Checkpoint[step=500 | time=2025-03-25 04:53:35.326173+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:23:15.082 [I] Preserving Checkpoint[step=600 | time=2025-03-25 05:08:26.511268+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:23:15.084 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
01:23:15.085 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
01:23:15.089 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
01:23:15.090 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742880191.4844544, 'wait_for_prev_duration_secs': 0.0007457733154296875, 'checkpointer_blocking_start_time': 1742880191.4859166, 'checkpointer_blocking_duration_secs': 3.577422857284546, 'get_old_steps_start_time': 1742880195.0633984, 'get_old_steps_duration_secs': 0.0210115909576416, 'checkpoint_manager_blocking_start_time': 1742880191.4843087, 'checkpoint_manager_blocking_duration_secs': 3.605849266052246} (303899:standard_logger.py:34)
01:23:15.094 [I] Progress on: 701it/1.00kit rate:9.9s/it remaining:49:19 elapsed:1:43:53 postfix:- (303899:tqdm_logging.py:145)
01:23:22.686 [I] ChainedFuture completed 1/1 futures in 7.63 seconds.                             (303899:future.py:137)
01:23:22.687 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 925.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:23:22.687 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
01:23:22.688 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18 (303899:async_checkpointer.py:406)
01:23:22.689 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18/assets (303899:atomicity.py:287)
01:23:22.699 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18/params (303899:atomicity.py:287)
01:23:22.700 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700 (303899:async_checkpointer.py:416)
01:23:22.700 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18 (303899:async_checkpointer.py:426)
01:23:22.700 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700 (303899:atomicity.py:287)
01:23:22.702 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/700`. (303899:atomicity.py:548)
01:23:22.702 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
01:23:22.702 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
01:23:22.703 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
01:23:22.703 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
01:23:22.703 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 701: grad_norm=2.92452335357666, loss=0.299782395362854, param_norm=1887.1263427734375
01:23:26.316 [I] Progress on: 702it/1.00kit rate:10.3s/it remaining:51:07 elapsed:1:44:04 postfix:- (303899:tqdm_logging.py:145)
Step 702: grad_norm=2.415498971939087, loss=0.2653273046016693, param_norm=1887.1263427734375
Step 703: grad_norm=2.797969341278076, loss=0.27520889043807983, param_norm=1887.1263427734375
01:23:43.703 [I] Progress on: 703it/1.00kit rate:9.8s/it remaining:48:42 elapsed:1:44:22 postfix:- (303899:tqdm_logging.py:145)
Step 704: grad_norm=2.5943150520324707, loss=0.2483074963092804, param_norm=1887.12646484375
Step 705: grad_norm=2.788694381713867, loss=0.28595787286758423, param_norm=1887.126708984375
01:24:01.307 [I] Progress on: 705it/1.00kit rate:9.3s/it remaining:45:45 elapsed:1:44:39 postfix:- (303899:tqdm_logging.py:145)
Step 706: grad_norm=2.3760275840759277, loss=0.2502918541431427, param_norm=1887.126708984375
Step 707: grad_norm=2.5204217433929443, loss=0.22433263063430786, param_norm=1887.1268310546875
01:24:18.917 [I] Progress on: 707it/1.00kit rate:9.0s/it remaining:44:11 elapsed:1:44:57 postfix:- (303899:tqdm_logging.py:145)
Step 708: grad_norm=2.7361996173858643, loss=0.3168744146823883, param_norm=1887.1268310546875
Step 709: grad_norm=2.9185285568237305, loss=0.29473555088043213, param_norm=1887.1268310546875
01:24:36.532 [I] Progress on: 709it/1.00kit rate:8.9s/it remaining:43:15 elapsed:1:45:14 postfix:- (303899:tqdm_logging.py:145)
Step 710: grad_norm=2.9587645530700684, loss=0.30872872471809387, param_norm=1887.126953125
Step 711: grad_norm=2.140568971633911, loss=0.2260405421257019, param_norm=1887.126953125
01:24:54.140 [I] Progress on: 711it/1.00kit rate:8.9s/it remaining:42:40 elapsed:1:45:32 postfix:- (303899:tqdm_logging.py:145)
Step 712: grad_norm=2.4095406532287598, loss=0.2248605191707611, param_norm=1887.126953125
Step 713: grad_norm=2.142965316772461, loss=0.22822977602481842, param_norm=1887.1270751953125
01:25:11.762 [I] Progress on: 713it/1.00kit rate:8.8s/it remaining:42:14 elapsed:1:45:50 postfix:- (303899:tqdm_logging.py:145)
Step 714: grad_norm=2.6339144706726074, loss=0.28151315450668335, param_norm=1887.1270751953125
Step 715: grad_norm=2.552177667617798, loss=0.2670343518257141, param_norm=1887.1270751953125
01:25:29.378 [I] Progress on: 715it/1.00kit rate:8.8s/it remaining:41:53 elapsed:1:46:07 postfix:- (303899:tqdm_logging.py:145)
Step 716: grad_norm=2.622619152069092, loss=0.2728310823440552, param_norm=1887.127197265625
Step 717: grad_norm=2.617434024810791, loss=0.2757312059402466, param_norm=1887.127197265625
01:25:47.002 [I] Progress on: 717it/1.00kit rate:8.8s/it remaining:41:33 elapsed:1:46:25 postfix:- (303899:tqdm_logging.py:145)
Step 718: grad_norm=4.50836706161499, loss=0.28162404894828796, param_norm=1887.1273193359375
Step 719: grad_norm=3.1892735958099365, loss=0.3069571852684021, param_norm=1887.1273193359375
01:26:04.934 [I] Progress on: 719it/1.00kit rate:8.9s/it remaining:41:40 elapsed:1:46:43 postfix:- (303899:tqdm_logging.py:145)
Step 720: grad_norm=2.408524513244629, loss=0.2824111878871918, param_norm=1887.12744140625
Step 721: grad_norm=2.835272789001465, loss=0.29888916015625, param_norm=1887.1275634765625
01:26:22.577 [I] Progress on: 721it/1.00kit rate:8.9s/it remaining:41:11 elapsed:1:47:00 postfix:- (303899:tqdm_logging.py:145)
Step 722: grad_norm=2.750206232070923, loss=0.28736263513565063, param_norm=1887.1275634765625
Step 723: grad_norm=2.5012688636779785, loss=0.26504212617874146, param_norm=1887.127685546875
01:26:40.190 [I] Progress on: 723it/1.00kit rate:8.8s/it remaining:40:46 elapsed:1:47:18 postfix:- (303899:tqdm_logging.py:145)
Step 724: grad_norm=2.7045929431915283, loss=0.25698983669281006, param_norm=1887.127685546875
Step 725: grad_norm=2.296482801437378, loss=0.23188021779060364, param_norm=1887.127685546875
01:26:57.818 [I] Progress on: 725it/1.00kit rate:8.8s/it remaining:40:25 elapsed:1:47:36 postfix:- (303899:tqdm_logging.py:145)
Step 726: grad_norm=1.8441320657730103, loss=0.20514675974845886, param_norm=1887.1278076171875
Step 727: grad_norm=2.520385503768921, loss=0.2881489396095276, param_norm=1887.1278076171875
01:27:15.457 [I] Progress on: 727it/1.00kit rate:8.8s/it remaining:40:06 elapsed:1:47:53 postfix:- (303899:tqdm_logging.py:145)
Step 728: grad_norm=2.4813761711120605, loss=0.25260889530181885, param_norm=1887.1279296875
Step 729: grad_norm=2.283627986907959, loss=0.259431928396225, param_norm=1887.1279296875
01:27:33.080 [I] Progress on: 729it/1.00kit rate:8.8s/it remaining:39:48 elapsed:1:48:11 postfix:- (303899:tqdm_logging.py:145)
Step 730: grad_norm=2.067972421646118, loss=0.23724746704101562, param_norm=1887.1280517578125
Step 731: grad_norm=2.8288838863372803, loss=0.28349941968917847, param_norm=1887.1280517578125
01:27:50.714 [I] Progress on: 731it/1.00kit rate:8.8s/it remaining:39:29 elapsed:1:48:29 postfix:- (303899:tqdm_logging.py:145)
Step 732: grad_norm=2.8217196464538574, loss=0.23143011331558228, param_norm=1887.1280517578125
Step 733: grad_norm=3.0694870948791504, loss=0.2889074981212616, param_norm=1887.128173828125
01:28:08.363 [I] Progress on: 733it/1.00kit rate:8.8s/it remaining:39:14 elapsed:1:48:46 postfix:- (303899:tqdm_logging.py:145)
Step 734: grad_norm=2.177821636199951, loss=0.2522629499435425, param_norm=1887.1282958984375
Step 735: grad_norm=2.702072858810425, loss=0.2156011462211609, param_norm=1887.1282958984375
01:28:26.000 [I] Progress on: 735it/1.00kit rate:8.8s/it remaining:38:56 elapsed:1:49:04 postfix:- (303899:tqdm_logging.py:145)
Step 736: grad_norm=3.959035873413086, loss=0.28883296251296997, param_norm=1887.12841796875
Step 737: grad_norm=2.76111102104187, loss=0.29790470004081726, param_norm=1887.12841796875
01:28:43.630 [I] Progress on: 737it/1.00kit rate:8.8s/it remaining:38:38 elapsed:1:49:21 postfix:- (303899:tqdm_logging.py:145)
Step 738: grad_norm=2.5748915672302246, loss=0.306199312210083, param_norm=1887.12841796875
Step 739: grad_norm=2.9205594062805176, loss=0.31050631403923035, param_norm=1887.1285400390625
01:29:01.242 [I] Progress on: 739it/1.00kit rate:8.8s/it remaining:38:18 elapsed:1:49:39 postfix:- (303899:tqdm_logging.py:145)
Step 740: grad_norm=2.801173448562622, loss=0.2545150816440582, param_norm=1887.1285400390625
01:29:12.470 [I] Progress on: 741it/1.00kit rate:9.5s/it remaining:40:54 elapsed:1:49:50 postfix:- (303899:tqdm_logging.py:145)
Step 741: grad_norm=2.277465581893921, loss=0.24678799510002136, param_norm=1887.1285400390625
Step 742: grad_norm=2.5073177814483643, loss=0.28179845213890076, param_norm=1887.128662109375
01:29:29.853 [I] Progress on: 742it/1.00kit rate:9.3s/it remaining:39:49 elapsed:1:50:08 postfix:- (303899:tqdm_logging.py:145)
Step 743: grad_norm=2.069720983505249, loss=0.2426086813211441, param_norm=1887.128662109375
Step 744: grad_norm=2.5220303535461426, loss=0.24618768692016602, param_norm=1887.128662109375
01:29:47.466 [I] Progress on: 744it/1.00kit rate:9.0s/it remaining:38:29 elapsed:1:50:25 postfix:- (303899:tqdm_logging.py:145)
Step 745: grad_norm=2.6123580932617188, loss=0.22522777318954468, param_norm=1887.128662109375
Step 746: grad_norm=2.328232526779175, loss=0.26021814346313477, param_norm=1887.1287841796875
01:30:05.030 [I] Progress on: 746it/1.00kit rate:8.9s/it remaining:37:39 elapsed:1:50:43 postfix:- (303899:tqdm_logging.py:145)
Step 747: grad_norm=2.6417486667633057, loss=0.2460053563117981, param_norm=1887.1287841796875
Step 748: grad_norm=2.0176351070404053, loss=0.2354285567998886, param_norm=1887.1287841796875
01:30:22.645 [I] Progress on: 748it/1.00kit rate:8.8s/it remaining:37:08 elapsed:1:51:01 postfix:- (303899:tqdm_logging.py:145)
Step 749: grad_norm=2.642075300216675, loss=0.2257063239812851, param_norm=1887.1287841796875
Step 750: grad_norm=2.5576820373535156, loss=0.264396995306015, param_norm=1887.12890625
01:30:40.240 [I] Progress on: 750it/1.00kit rate:8.8s/it remaining:36:43 elapsed:1:51:18 postfix:- (303899:tqdm_logging.py:145)
Step 751: grad_norm=2.451402425765991, loss=0.2142384648323059, param_norm=1887.12890625
Step 752: grad_norm=2.9891393184661865, loss=0.20989671349525452, param_norm=1887.12890625
01:30:57.851 [I] Progress on: 752it/1.00kit rate:8.8s/it remaining:36:23 elapsed:1:51:36 postfix:- (303899:tqdm_logging.py:145)
Step 753: grad_norm=2.2463185787200928, loss=0.2491077482700348, param_norm=1887.1290283203125
Step 754: grad_norm=2.183324098587036, loss=0.24527037143707275, param_norm=1887.129150390625
01:31:15.421 [I] Progress on: 754it/1.00kit rate:8.8s/it remaining:36:02 elapsed:1:51:53 postfix:- (303899:tqdm_logging.py:145)
Step 755: grad_norm=2.878734827041626, loss=0.23445285856723785, param_norm=1887.129150390625
Step 756: grad_norm=2.680021286010742, loss=0.24252918362617493, param_norm=1887.129150390625
01:31:33.054 [I] Progress on: 756it/1.00kit rate:8.8s/it remaining:35:45 elapsed:1:52:11 postfix:- (303899:tqdm_logging.py:145)
Step 757: grad_norm=2.798848867416382, loss=0.2652354836463928, param_norm=1887.1292724609375
Step 758: grad_norm=2.0333473682403564, loss=0.22869229316711426, param_norm=1887.1292724609375
01:31:50.665 [I] Progress on: 758it/1.00kit rate:8.8s/it remaining:35:28 elapsed:1:52:29 postfix:- (303899:tqdm_logging.py:145)
Step 759: grad_norm=2.327911853790283, loss=0.22438104450702667, param_norm=1887.1292724609375
Step 760: grad_norm=2.225553512573242, loss=0.23924802243709564, param_norm=1887.12939453125
01:32:08.300 [I] Progress on: 760it/1.00kit rate:8.8s/it remaining:35:12 elapsed:1:52:46 postfix:- (303899:tqdm_logging.py:145)
Step 761: grad_norm=2.68537974357605, loss=0.2206035852432251, param_norm=1887.12939453125
Step 762: grad_norm=1.942822813987732, loss=0.22158479690551758, param_norm=1887.1295166015625
01:32:25.875 [I] Progress on: 762it/1.00kit rate:8.8s/it remaining:34:52 elapsed:1:53:04 postfix:- (303899:tqdm_logging.py:145)
Step 763: grad_norm=2.6730918884277344, loss=0.24090051651000977, param_norm=1887.1295166015625
Step 764: grad_norm=2.353177785873413, loss=0.22832182049751282, param_norm=1887.1295166015625
01:32:43.494 [I] Progress on: 764it/1.00kit rate:8.8s/it remaining:34:34 elapsed:1:53:21 postfix:- (303899:tqdm_logging.py:145)
Step 765: grad_norm=2.1985316276550293, loss=0.24296902120113373, param_norm=1887.129638671875
Step 766: grad_norm=2.7052247524261475, loss=0.2538619041442871, param_norm=1887.129638671875
01:33:01.084 [I] Progress on: 766it/1.00kit rate:8.8s/it remaining:34:16 elapsed:1:53:39 postfix:- (303899:tqdm_logging.py:145)
Step 767: grad_norm=2.6793181896209717, loss=0.24187737703323364, param_norm=1887.129638671875
Step 768: grad_norm=2.2858119010925293, loss=0.30945491790771484, param_norm=1887.1298828125
01:33:18.698 [I] Progress on: 768it/1.00kit rate:8.8s/it remaining:34:00 elapsed:1:53:57 postfix:- (303899:tqdm_logging.py:145)
Step 769: grad_norm=2.347738027572632, loss=0.20832088589668274, param_norm=1887.1298828125
Step 770: grad_norm=2.521088123321533, loss=0.23496006429195404, param_norm=1887.1298828125
01:33:36.266 [I] Progress on: 770it/1.00kit rate:8.8s/it remaining:33:40 elapsed:1:54:14 postfix:- (303899:tqdm_logging.py:145)
Step 771: grad_norm=2.1541903018951416, loss=0.22567379474639893, param_norm=1887.1298828125
Step 772: grad_norm=2.697340965270996, loss=0.2809300422668457, param_norm=1887.1298828125
01:33:53.853 [I] Progress on: 772it/1.00kit rate:8.8s/it remaining:33:22 elapsed:1:54:32 postfix:- (303899:tqdm_logging.py:145)
Step 773: grad_norm=2.588345766067505, loss=0.2734028995037079, param_norm=1887.1300048828125
Step 774: grad_norm=2.859459161758423, loss=0.2789924740791321, param_norm=1887.1300048828125
01:34:11.402 [I] Progress on: 774it/1.00kit rate:8.8s/it remaining:33:02 elapsed:1:54:49 postfix:- (303899:tqdm_logging.py:145)
Step 775: grad_norm=2.76362681388855, loss=0.2792283892631531, param_norm=1887.1300048828125
Step 776: grad_norm=2.0748136043548584, loss=0.22213518619537354, param_norm=1887.1300048828125
01:34:28.999 [I] Progress on: 776it/1.00kit rate:8.8s/it remaining:32:46 elapsed:1:55:07 postfix:- (303899:tqdm_logging.py:145)
Step 777: grad_norm=2.0970115661621094, loss=0.2053162157535553, param_norm=1887.130126953125
Step 778: grad_norm=2.00312876701355, loss=0.2417505830526352, param_norm=1887.130126953125
01:34:46.575 [I] Progress on: 778it/1.00kit rate:8.8s/it remaining:32:28 elapsed:1:55:24 postfix:- (303899:tqdm_logging.py:145)
Step 779: grad_norm=1.8203942775726318, loss=0.20549488067626953, param_norm=1887.130126953125
01:34:57.848 [I] Progress on: 780it/1.00kit rate:9.5s/it remaining:34:43 elapsed:1:55:36 postfix:- (303899:tqdm_logging.py:145)
Step 780: grad_norm=2.3170437812805176, loss=0.1861056685447693, param_norm=1887.1302490234375
Step 781: grad_norm=2.2499780654907227, loss=0.21362623572349548, param_norm=1887.1302490234375
01:35:15.172 [I] Progress on: 781it/1.00kit rate:9.2s/it remaining:33:44 elapsed:1:55:53 postfix:- (303899:tqdm_logging.py:145)
Step 782: grad_norm=2.7836146354675293, loss=0.2660742402076721, param_norm=1887.13037109375
Step 783: grad_norm=1.706156849861145, loss=0.19461990892887115, param_norm=1887.13037109375
01:35:32.763 [I] Progress on: 783it/1.00kit rate:9.0s/it remaining:32:35 elapsed:1:56:11 postfix:- (303899:tqdm_logging.py:145)
Step 784: grad_norm=1.8503687381744385, loss=0.22498753666877747, param_norm=1887.13037109375
Step 785: grad_norm=2.4854846000671387, loss=0.249664306640625, param_norm=1887.1304931640625
01:35:50.313 [I] Progress on: 785it/1.00kit rate:8.9s/it remaining:31:49 elapsed:1:56:28 postfix:- (303899:tqdm_logging.py:145)
Step 786: grad_norm=2.190413475036621, loss=0.2056499421596527, param_norm=1887.130615234375
Step 787: grad_norm=1.9794682264328003, loss=0.2125856578350067, param_norm=1887.130615234375
01:36:07.946 [I] Progress on: 787it/1.00kit rate:8.8s/it remaining:31:23 elapsed:1:56:46 postfix:- (303899:tqdm_logging.py:145)
Step 788: grad_norm=1.8222782611846924, loss=0.18292120099067688, param_norm=1887.130615234375
Step 789: grad_norm=2.5561680793762207, loss=0.2132250964641571, param_norm=1887.130615234375
01:36:25.520 [I] Progress on: 789it/1.00kit rate:8.8s/it remaining:30:57 elapsed:1:57:03 postfix:- (303899:tqdm_logging.py:145)
Step 790: grad_norm=1.8203119039535522, loss=0.21666252613067627, param_norm=1887.1307373046875
Step 791: grad_norm=2.131667137145996, loss=0.2244468331336975, param_norm=1887.1307373046875
01:36:43.129 [I] Progress on: 791it/1.00kit rate:8.8s/it remaining:30:39 elapsed:1:57:21 postfix:- (303899:tqdm_logging.py:145)
Step 792: grad_norm=2.4436168670654297, loss=0.19462308287620544, param_norm=1887.1307373046875
Step 793: grad_norm=1.8567249774932861, loss=0.2108319103717804, param_norm=1887.1307373046875
01:37:00.722 [I] Progress on: 793it/1.00kit rate:8.8s/it remaining:30:19 elapsed:1:57:39 postfix:- (303899:tqdm_logging.py:145)
Step 794: grad_norm=1.7301685810089111, loss=0.1783640831708908, param_norm=1887.130859375
Step 795: grad_norm=2.0560595989227295, loss=0.204593688249588, param_norm=1887.130859375
01:37:18.353 [I] Progress on: 795it/1.00kit rate:8.8s/it remaining:30:03 elapsed:1:57:56 postfix:- (303899:tqdm_logging.py:145)
Step 796: grad_norm=2.2900137901306152, loss=0.2267899215221405, param_norm=1887.130859375
Step 797: grad_norm=2.5451595783233643, loss=0.2545121908187866, param_norm=1887.1309814453125
01:37:35.962 [I] Progress on: 797it/1.00kit rate:8.8s/it remaining:29:45 elapsed:1:58:14 postfix:- (303899:tqdm_logging.py:145)
Step 798: grad_norm=1.7714561223983765, loss=0.20126274228096008, param_norm=1887.1309814453125
Step 799: grad_norm=2.955644130706787, loss=0.24736502766609192, param_norm=1887.1309814453125
01:37:53.608 [I] Progress on: 799it/1.00kit rate:8.8s/it remaining:29:29 elapsed:1:58:31 postfix:- (303899:tqdm_logging.py:145)
Step 800: grad_norm=1.8518915176391602, loss=0.18941012024879456, param_norm=1887.1309814453125
01:38:02.562 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
01:38:02.562 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
01:38:02.562 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (303899:checkpoint_manager.py:1786)
01:38:02.562 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (303899:checkpoint_manager.py:1817)
01:38:02.563 [I] [process=0] Saving checkpoint at step 800                                        (303899:checkpoint_manager.py:1286)
01:38:02.564 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800. (303899:async_checkpointer.py:358)
01:38:02.565 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:38:02.566 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21 (303899:atomicity.py:144)
01:38:02.566 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:38:02.567 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:38:02.568 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (303899:atomicity.py:144)
01:38:02.568 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (303899:atomicity.py:144)
01:38:02.569 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:38:02.574 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
01:38:06.125 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
01:38:06.127 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:38:06.128 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
01:38:06.130 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
01:38:06.150 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.152 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.154 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.155 [I] Preserving Checkpoint[step=400 | time=2025-03-25 04:38:45.986340+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.157 [I] Preserving Checkpoint[step=500 | time=2025-03-25 04:53:35.326173+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.160 [I] Preserving Checkpoint[step=600 | time=2025-03-25 05:08:26.511268+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.162 [I] Preserving Checkpoint[step=700 | time=2025-03-25 05:23:15.063355+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:38:06.162 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
01:38:06.164 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
01:38:06.175 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
01:38:06.177 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742881082.562354, 'wait_for_prev_duration_secs': 0.0007596015930175781, 'checkpointer_blocking_start_time': 1742881082.5637443, 'checkpointer_blocking_duration_secs': 3.5868489742279053, 'get_old_steps_start_time': 1742881086.1506767, 'get_old_steps_duration_secs': 0.012176275253295898, 'checkpoint_manager_blocking_start_time': 1742881082.562173, 'checkpoint_manager_blocking_duration_secs': 3.6149039268493652} (303899:standard_logger.py:34)
01:38:06.182 [I] Progress on: 801it/1.00kit rate:9.9s/it remaining:32:44 elapsed:1:58:44 postfix:- (303899:tqdm_logging.py:145)
01:38:13.543 [I] ChainedFuture completed 1/1 futures in 7.40 seconds.                             (303899:future.py:137)
01:38:13.544 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 944.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:38:13.544 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
01:38:13.546 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21 (303899:async_checkpointer.py:406)
01:38:13.546 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21/assets (303899:atomicity.py:287)
01:38:13.557 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21/params (303899:atomicity.py:287)
01:38:13.558 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800 (303899:async_checkpointer.py:416)
01:38:13.558 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21 (303899:async_checkpointer.py:426)
01:38:13.558 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800 (303899:atomicity.py:287)
01:38:13.560 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/800`. (303899:atomicity.py:548)
01:38:13.560 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
01:38:13.561 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
01:38:13.561 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
01:38:13.561 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
01:38:13.562 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 801: grad_norm=2.586254596710205, loss=0.2543753981590271, param_norm=1887.131103515625
Step 802: grad_norm=2.0626838207244873, loss=0.20833930373191833, param_norm=1887.131103515625
01:38:23.729 [I] Progress on: 802it/1.00kit rate:9.6s/it remaining:31:39 elapsed:1:59:02 postfix:- (303899:tqdm_logging.py:145)
Step 803: grad_norm=2.1336348056793213, loss=0.21327513456344604, param_norm=1887.131103515625
Step 804: grad_norm=2.869168996810913, loss=0.21010635793209076, param_norm=1887.131103515625
01:38:41.311 [I] Progress on: 804it/1.00kit rate:9.2s/it remaining:30:00 elapsed:1:59:19 postfix:- (303899:tqdm_logging.py:145)
Step 805: grad_norm=1.9339696168899536, loss=0.19412755966186523, param_norm=1887.131103515625
Step 806: grad_norm=2.2828969955444336, loss=0.24071477353572845, param_norm=1887.1312255859375
01:38:58.952 [I] Progress on: 806it/1.00kit rate:9.0s/it remaining:29:07 elapsed:1:59:37 postfix:- (303899:tqdm_logging.py:145)
Step 807: grad_norm=2.0823612213134766, loss=0.24123290181159973, param_norm=1887.1312255859375
Step 808: grad_norm=2.484630823135376, loss=0.20864392817020416, param_norm=1887.1312255859375
01:39:16.883 [I] Progress on: 808it/1.00kit rate:9.0s/it remaining:28:49 elapsed:1:59:55 postfix:- (303899:tqdm_logging.py:145)
Step 809: grad_norm=2.154456615447998, loss=0.24169428646564484, param_norm=1887.1312255859375
Step 810: grad_norm=2.0837197303771973, loss=0.22126784920692444, param_norm=1887.13134765625
01:39:34.512 [I] Progress on: 810it/1.00kit rate:8.9s/it remaining:28:14 elapsed:2:00:12 postfix:- (303899:tqdm_logging.py:145)
Step 811: grad_norm=2.21469783782959, loss=0.20104676485061646, param_norm=1887.13134765625
Step 812: grad_norm=2.18890643119812, loss=0.19300854206085205, param_norm=1887.1314697265625
01:39:52.144 [I] Progress on: 812it/1.00kit rate:8.9s/it remaining:27:47 elapsed:2:00:30 postfix:- (303899:tqdm_logging.py:145)
Step 813: grad_norm=2.2926549911499023, loss=0.2130061835050583, param_norm=1887.1314697265625
Step 814: grad_norm=2.1953494548797607, loss=0.2537892758846283, param_norm=1887.1314697265625
01:40:09.838 [I] Progress on: 814it/1.00kit rate:8.9s/it remaining:27:28 elapsed:2:00:48 postfix:- (303899:tqdm_logging.py:145)
Step 815: grad_norm=3.002777576446533, loss=0.23329131305217743, param_norm=1887.1314697265625
Step 816: grad_norm=2.6355502605438232, loss=0.1989518105983734, param_norm=1887.1314697265625
01:40:27.413 [I] Progress on: 816it/1.00kit rate:8.8s/it remaining:27:04 elapsed:2:01:05 postfix:- (303899:tqdm_logging.py:145)
Step 817: grad_norm=1.935991883277893, loss=0.20397773385047913, param_norm=1887.1314697265625
Step 818: grad_norm=2.409057855606079, loss=0.2042354941368103, param_norm=1887.131591796875
01:40:44.987 [I] Progress on: 818it/1.00kit rate:8.8s/it remaining:26:43 elapsed:2:01:23 postfix:- (303899:tqdm_logging.py:145)
Step 819: grad_norm=1.8239625692367554, loss=0.17421448230743408, param_norm=1887.131591796875
01:40:56.136 [I] Progress on: 819it/1.00kit rate:9.5s/it remaining:28:41 elapsed:2:01:34 postfix:- (303899:tqdm_logging.py:145)
Step 820: grad_norm=1.8354113101959229, loss=0.19369056820869446, param_norm=1887.131591796875
Step 821: grad_norm=1.9325106143951416, loss=0.20682856440544128, param_norm=1887.131591796875
01:41:13.775 [I] Progress on: 821it/1.00kit rate:9.2s/it remaining:27:21 elapsed:2:01:52 postfix:- (303899:tqdm_logging.py:145)
Step 822: grad_norm=1.6786695718765259, loss=0.18915006518363953, param_norm=1887.131591796875
Step 823: grad_norm=2.5238494873046875, loss=0.22934570908546448, param_norm=1887.1317138671875
01:41:31.369 [I] Progress on: 823it/1.00kit rate:9.0s/it remaining:26:29 elapsed:2:02:09 postfix:- (303899:tqdm_logging.py:145)
Step 824: grad_norm=1.585890293121338, loss=0.1710997074842453, param_norm=1887.1317138671875
Step 825: grad_norm=1.6878570318222046, loss=0.16768217086791992, param_norm=1887.1317138671875
01:41:49.000 [I] Progress on: 825it/1.00kit rate:8.9s/it remaining:25:58 elapsed:2:02:27 postfix:- (303899:tqdm_logging.py:145)
Step 826: grad_norm=2.1401045322418213, loss=0.18062695860862732, param_norm=1887.1317138671875
Step 827: grad_norm=2.075420618057251, loss=0.19959613680839539, param_norm=1887.1317138671875
01:42:06.606 [I] Progress on: 827it/1.00kit rate:8.9s/it remaining:25:32 elapsed:2:02:44 postfix:- (303899:tqdm_logging.py:145)
Step 828: grad_norm=1.8699116706848145, loss=0.18362362682819366, param_norm=1887.1317138671875
Step 829: grad_norm=2.0600168704986572, loss=0.18965482711791992, param_norm=1887.1317138671875
01:42:24.239 [I] Progress on: 829it/1.00kit rate:8.8s/it remaining:25:12 elapsed:2:03:02 postfix:- (303899:tqdm_logging.py:145)
Step 830: grad_norm=3.2326242923736572, loss=0.2512730062007904, param_norm=1887.1318359375
Step 831: grad_norm=2.0326099395751953, loss=0.19886960089206696, param_norm=1887.1318359375
01:42:41.882 [I] Progress on: 831it/1.00kit rate:8.8s/it remaining:24:53 elapsed:2:03:20 postfix:- (303899:tqdm_logging.py:145)
Step 832: grad_norm=1.8388330936431885, loss=0.1785198599100113, param_norm=1887.1318359375
Step 833: grad_norm=1.82699716091156, loss=0.18113061785697937, param_norm=1887.1318359375
01:42:59.591 [I] Progress on: 833it/1.00kit rate:8.9s/it remaining:24:38 elapsed:2:03:37 postfix:- (303899:tqdm_logging.py:145)
Step 834: grad_norm=2.752734899520874, loss=0.25275689363479614, param_norm=1887.1318359375
Step 835: grad_norm=2.470289945602417, loss=0.21851366758346558, param_norm=1887.1318359375
01:43:17.219 [I] Progress on: 835it/1.00kit rate:8.8s/it remaining:24:18 elapsed:2:03:55 postfix:- (303899:tqdm_logging.py:145)
Step 836: grad_norm=2.3113913536071777, loss=0.20919173955917358, param_norm=1887.1319580078125
Step 837: grad_norm=2.0236599445343018, loss=0.22403985261917114, param_norm=1887.1319580078125
01:43:34.851 [I] Progress on: 837it/1.00kit rate:8.8s/it remaining:24:00 elapsed:2:04:13 postfix:- (303899:tqdm_logging.py:145)
Step 838: grad_norm=2.288653612136841, loss=0.19690601527690887, param_norm=1887.1319580078125
Step 839: grad_norm=1.9254992008209229, loss=0.20795860886573792, param_norm=1887.1319580078125
01:43:52.433 [I] Progress on: 839it/1.00kit rate:8.8s/it remaining:23:39 elapsed:2:04:30 postfix:- (303899:tqdm_logging.py:145)
Step 840: grad_norm=1.9322792291641235, loss=0.2067171335220337, param_norm=1887.1319580078125
Step 841: grad_norm=1.7790559530258179, loss=0.1698428988456726, param_norm=1887.132080078125
01:44:10.063 [I] Progress on: 841it/1.00kit rate:8.8s/it remaining:23:23 elapsed:2:04:48 postfix:- (303899:tqdm_logging.py:145)
Step 842: grad_norm=2.0974161624908447, loss=0.21626369655132294, param_norm=1887.132080078125
Step 843: grad_norm=1.8571455478668213, loss=0.19595086574554443, param_norm=1887.132080078125
01:44:27.685 [I] Progress on: 843it/1.00kit rate:8.8s/it remaining:23:05 elapsed:2:05:06 postfix:- (303899:tqdm_logging.py:145)
Step 844: grad_norm=1.9274623394012451, loss=0.1791502833366394, param_norm=1887.1322021484375
Step 845: grad_norm=2.038188934326172, loss=0.1748472899198532, param_norm=1887.1322021484375
01:44:45.329 [I] Progress on: 845it/1.00kit rate:8.8s/it remaining:22:48 elapsed:2:05:23 postfix:- (303899:tqdm_logging.py:145)
Step 846: grad_norm=1.761167049407959, loss=0.2189941108226776, param_norm=1887.1322021484375
Step 847: grad_norm=1.7192665338516235, loss=0.18962684273719788, param_norm=1887.1322021484375
01:45:02.982 [I] Progress on: 847it/1.00kit rate:8.8s/it remaining:22:30 elapsed:2:05:41 postfix:- (303899:tqdm_logging.py:145)
Step 848: grad_norm=1.9854308366775513, loss=0.2212754786014557, param_norm=1887.1322021484375
Step 849: grad_norm=2.03749418258667, loss=0.1771504133939743, param_norm=1887.1322021484375
01:45:20.732 [I] Progress on: 849it/1.00kit rate:8.9s/it remaining:22:16 elapsed:2:05:59 postfix:- (303899:tqdm_logging.py:145)
Step 850: grad_norm=1.6669535636901855, loss=0.1750079244375229, param_norm=1887.13232421875
Step 851: grad_norm=2.1855556964874268, loss=0.2275836169719696, param_norm=1887.13232421875
01:45:38.354 [I] Progress on: 851it/1.00kit rate:8.8s/it remaining:21:56 elapsed:2:06:16 postfix:- (303899:tqdm_logging.py:145)
Step 852: grad_norm=1.9998489618301392, loss=0.18903690576553345, param_norm=1887.13232421875
Step 853: grad_norm=1.7152413129806519, loss=0.18311190605163574, param_norm=1887.13232421875
01:45:56.098 [I] Progress on: 853it/1.00kit rate:8.9s/it remaining:21:42 elapsed:2:06:34 postfix:- (303899:tqdm_logging.py:145)
Step 854: grad_norm=1.818207859992981, loss=0.1676185131072998, param_norm=1887.13232421875
Step 855: grad_norm=1.7660820484161377, loss=0.1803542673587799, param_norm=1887.13232421875
01:46:13.741 [I] Progress on: 855it/1.00kit rate:8.8s/it remaining:21:22 elapsed:2:06:52 postfix:- (303899:tqdm_logging.py:145)
Step 856: grad_norm=2.583617925643921, loss=0.23075413703918457, param_norm=1887.13232421875
Step 857: grad_norm=1.8408082723617554, loss=0.1771594136953354, param_norm=1887.1324462890625
01:46:31.310 [I] Progress on: 857it/1.00kit rate:8.8s/it remaining:21:00 elapsed:2:07:09 postfix:- (303899:tqdm_logging.py:145)
Step 858: grad_norm=1.759324550628662, loss=0.17451386153697968, param_norm=1887.1324462890625
01:46:42.494 [I] Progress on: 858it/1.00kit rate:9.5s/it remaining:22:33 elapsed:2:07:20 postfix:- (303899:tqdm_logging.py:145)
Step 859: grad_norm=1.8687137365341187, loss=0.1759626269340515, param_norm=1887.1324462890625
Step 860: grad_norm=1.6324042081832886, loss=0.17923188209533691, param_norm=1887.1324462890625
01:47:00.156 [I] Progress on: 860it/1.00kit rate:9.2s/it remaining:21:25 elapsed:2:07:38 postfix:- (303899:tqdm_logging.py:145)
Step 861: grad_norm=1.9825870990753174, loss=0.18503446877002716, param_norm=1887.1324462890625
Step 862: grad_norm=1.8345704078674316, loss=0.18320927023887634, param_norm=1887.1324462890625
01:47:17.824 [I] Progress on: 862it/1.00kit rate:9.0s/it remaining:20:43 elapsed:2:07:56 postfix:- (303899:tqdm_logging.py:145)
Step 863: grad_norm=1.9282840490341187, loss=0.19694894552230835, param_norm=1887.132568359375
Step 864: grad_norm=2.0649027824401855, loss=0.18697577714920044, param_norm=1887.132568359375
01:47:35.493 [I] Progress on: 864it/1.00kit rate:8.9s/it remaining:20:14 elapsed:2:08:13 postfix:- (303899:tqdm_logging.py:145)
Step 865: grad_norm=1.8692830801010132, loss=0.1477908045053482, param_norm=1887.132568359375
Step 866: grad_norm=1.921630620956421, loss=0.1712580919265747, param_norm=1887.132568359375
01:47:53.125 [I] Progress on: 866it/1.00kit rate:8.9s/it remaining:19:50 elapsed:2:08:31 postfix:- (303899:tqdm_logging.py:145)
Step 867: grad_norm=1.4632699489593506, loss=0.1503250002861023, param_norm=1887.132568359375
Step 868: grad_norm=1.8390156030654907, loss=0.2072216123342514, param_norm=1887.132568359375
01:48:10.786 [I] Progress on: 868it/1.00kit rate:8.9s/it remaining:19:29 elapsed:2:08:49 postfix:- (303899:tqdm_logging.py:145)
Step 869: grad_norm=1.8165475130081177, loss=0.15664947032928467, param_norm=1887.1326904296875
Step 870: grad_norm=1.8161007165908813, loss=0.17952761054039001, param_norm=1887.1326904296875
01:48:28.387 [I] Progress on: 870it/1.00kit rate:8.8s/it remaining:19:08 elapsed:2:09:06 postfix:- (303899:tqdm_logging.py:145)
Step 871: grad_norm=1.8639845848083496, loss=0.19160360097885132, param_norm=1887.1326904296875
Step 872: grad_norm=1.5941318273544312, loss=0.18934831023216248, param_norm=1887.1326904296875
01:48:46.038 [I] Progress on: 872it/1.00kit rate:8.8s/it remaining:18:51 elapsed:2:09:24 postfix:- (303899:tqdm_logging.py:145)
Step 873: grad_norm=1.7574409246444702, loss=0.19460168480873108, param_norm=1887.1326904296875
Step 874: grad_norm=1.531399130821228, loss=0.16573216021060944, param_norm=1887.1326904296875
01:49:03.710 [I] Progress on: 874it/1.00kit rate:8.8s/it remaining:18:34 elapsed:2:09:42 postfix:- (303899:tqdm_logging.py:145)
Step 875: grad_norm=1.6972278356552124, loss=0.1893344521522522, param_norm=1887.1328125
Step 876: grad_norm=1.746970295906067, loss=0.19026273488998413, param_norm=1887.1328125
01:49:21.387 [I] Progress on: 876it/1.00kit rate:8.8s/it remaining:18:17 elapsed:2:09:59 postfix:- (303899:tqdm_logging.py:145)
Step 877: grad_norm=1.8825602531433105, loss=0.20348802208900452, param_norm=1887.1328125
Step 878: grad_norm=2.095085382461548, loss=0.17396393418312073, param_norm=1887.1329345703125
01:49:39.035 [I] Progress on: 878it/1.00kit rate:8.8s/it remaining:17:58 elapsed:2:10:17 postfix:- (303899:tqdm_logging.py:145)
Step 879: grad_norm=1.6620969772338867, loss=0.16233539581298828, param_norm=1887.1329345703125
Step 880: grad_norm=1.78209388256073, loss=0.17138159275054932, param_norm=1887.1329345703125
01:49:56.691 [I] Progress on: 880it/1.00kit rate:8.8s/it remaining:17:41 elapsed:2:10:35 postfix:- (303899:tqdm_logging.py:145)
Step 881: grad_norm=1.470930814743042, loss=0.1393658071756363, param_norm=1887.1329345703125
Step 882: grad_norm=1.5128456354141235, loss=0.1754230558872223, param_norm=1887.1329345703125
01:50:14.337 [I] Progress on: 882it/1.00kit rate:8.8s/it remaining:17:23 elapsed:2:10:52 postfix:- (303899:tqdm_logging.py:145)
Step 883: grad_norm=1.989650845527649, loss=0.20628803968429565, param_norm=1887.1329345703125
Step 884: grad_norm=1.5419062376022339, loss=0.21225179731845856, param_norm=1887.1329345703125
01:50:32.025 [I] Progress on: 884it/1.00kit rate:8.9s/it remaining:17:06 elapsed:2:11:10 postfix:- (303899:tqdm_logging.py:145)
Step 885: grad_norm=1.9258981943130493, loss=0.16584128141403198, param_norm=1887.1329345703125
Step 886: grad_norm=2.388984203338623, loss=0.20022374391555786, param_norm=1887.1329345703125
01:50:49.700 [I] Progress on: 886it/1.00kit rate:8.9s/it remaining:16:48 elapsed:2:11:28 postfix:- (303899:tqdm_logging.py:145)
Step 887: grad_norm=1.5660881996154785, loss=0.16623499989509583, param_norm=1887.133056640625
Step 888: grad_norm=1.6430554389953613, loss=0.1601743996143341, param_norm=1887.133056640625
01:51:07.360 [I] Progress on: 888it/1.00kit rate:8.8s/it remaining:16:31 elapsed:2:11:45 postfix:- (303899:tqdm_logging.py:145)
Step 889: grad_norm=1.9777549505233765, loss=0.1824837476015091, param_norm=1887.133056640625
Step 890: grad_norm=1.8584035634994507, loss=0.2029249519109726, param_norm=1887.133056640625
01:51:24.994 [I] Progress on: 890it/1.00kit rate:8.8s/it remaining:16:12 elapsed:2:12:03 postfix:- (303899:tqdm_logging.py:145)
Step 891: grad_norm=1.5491372346878052, loss=0.1635875701904297, param_norm=1887.133056640625
Step 892: grad_norm=1.7703031301498413, loss=0.16917583346366882, param_norm=1887.133056640625
01:51:42.634 [I] Progress on: 892it/1.00kit rate:8.8s/it remaining:15:54 elapsed:2:12:20 postfix:- (303899:tqdm_logging.py:145)
Step 893: grad_norm=2.0799617767333984, loss=0.18746571242809296, param_norm=1887.133056640625
Step 894: grad_norm=2.1572108268737793, loss=0.19177395105361938, param_norm=1887.133056640625
01:52:00.283 [I] Progress on: 894it/1.00kit rate:8.8s/it remaining:15:36 elapsed:2:12:38 postfix:- (303899:tqdm_logging.py:145)
Step 895: grad_norm=1.6519789695739746, loss=0.1694568246603012, param_norm=1887.133056640625
Step 896: grad_norm=1.4578214883804321, loss=0.14345288276672363, param_norm=1887.133056640625
01:52:17.832 [I] Progress on: 896it/1.00kit rate:8.8s/it remaining:15:16 elapsed:2:12:56 postfix:- (303899:tqdm_logging.py:145)
Step 897: grad_norm=1.569525957107544, loss=0.16116070747375488, param_norm=1887.1331787109375
01:52:28.935 [I] Progress on: 897it/1.00kit rate:9.5s/it remaining:16:18 elapsed:2:13:07 postfix:- (303899:tqdm_logging.py:145)
Step 898: grad_norm=1.9164395332336426, loss=0.16125941276550293, param_norm=1887.1331787109375
Step 899: grad_norm=1.598202109336853, loss=0.14549407362937927, param_norm=1887.1331787109375
01:52:46.601 [I] Progress on: 899it/1.00kit rate:9.2s/it remaining:15:25 elapsed:2:13:24 postfix:- (303899:tqdm_logging.py:145)
Step 900: grad_norm=1.9254742860794067, loss=0.1803404986858368, param_norm=1887.1331787109375
01:52:55.607 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
01:52:55.607 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
01:52:55.608 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (303899:checkpoint_manager.py:1786)
01:52:55.608 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (303899:checkpoint_manager.py:1817)
01:52:55.608 [I] [process=0] Saving checkpoint at step 900                                        (303899:checkpoint_manager.py:1286)
01:52:55.609 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900. (303899:async_checkpointer.py:358)
01:52:55.610 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:52:55.610 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24 (303899:atomicity.py:144)
01:52:55.611 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:52:55.612 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
01:52:55.613 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (303899:atomicity.py:144)
01:52:55.613 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (303899:atomicity.py:144)
01:52:55.613 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
01:52:55.618 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
01:52:59.216 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:52:59.221 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
01:52:59.222 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
01:52:59.224 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
01:52:59.229 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.232 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.239 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.240 [I] Preserving Checkpoint[step=400 | time=2025-03-25 04:38:45.986340+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.247 [I] Preserving Checkpoint[step=500 | time=2025-03-25 04:53:35.326173+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.249 [I] Preserving Checkpoint[step=600 | time=2025-03-25 05:08:26.511268+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.250 [I] Preserving Checkpoint[step=700 | time=2025-03-25 05:23:15.063355+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.252 [I] Preserving Checkpoint[step=800 | time=2025-03-25 05:38:06.150621+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
01:52:59.253 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
01:52:59.257 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
01:52:59.260 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
01:52:59.260 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742881975.6075888, 'wait_for_prev_duration_secs': 0.0007090568542480469, 'checkpointer_blocking_start_time': 1742881975.608838, 'checkpointer_blocking_duration_secs': 3.620784044265747, 'get_old_steps_start_time': 1742881979.2296698, 'get_old_steps_duration_secs': 0.023413658142089844, 'checkpoint_manager_blocking_start_time': 1742881975.6074488, 'checkpoint_manager_blocking_duration_secs': 3.653329372406006} (303899:standard_logger.py:34)
01:52:59.263 [I] Progress on: 901it/1.00kit rate:10.1s/it remaining:16:39 elapsed:2:13:37 postfix:- (303899:tqdm_logging.py:145)
01:53:06.361 [I] ChainedFuture completed 1/1 futures in 7.14 seconds.                             (303899:future.py:137)
01:53:06.362 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 964.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
01:53:06.362 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
01:53:06.363 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24 (303899:async_checkpointer.py:406)
01:53:06.364 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24/assets (303899:atomicity.py:287)
01:53:06.374 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24/params (303899:atomicity.py:287)
01:53:06.375 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900 (303899:async_checkpointer.py:416)
01:53:06.375 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24 (303899:async_checkpointer.py:426)
01:53:06.375 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900 (303899:atomicity.py:287)
01:53:06.377 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/900`. (303899:atomicity.py:548)
01:53:06.377 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
01:53:06.378 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
01:53:06.378 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
01:53:06.379 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
01:53:06.379 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
Step 901: grad_norm=2.429690361022949, loss=0.1911856234073639, param_norm=1887.1331787109375
Step 902: grad_norm=1.8114843368530273, loss=0.18599113821983337, param_norm=1887.1331787109375
01:53:16.597 [I] Progress on: 902it/1.00kit rate:9.7s/it remaining:15:48 elapsed:2:13:54 postfix:- (303899:tqdm_logging.py:145)
Step 903: grad_norm=1.8582931756973267, loss=0.17307361960411072, param_norm=1887.1331787109375
Step 904: grad_norm=1.9326293468475342, loss=0.14813435077667236, param_norm=1887.1331787109375
01:53:34.243 [I] Progress on: 904it/1.00kit rate:9.2s/it remaining:14:46 elapsed:2:14:12 postfix:- (303899:tqdm_logging.py:145)
Step 905: grad_norm=1.7506319284439087, loss=0.16201671957969666, param_norm=1887.1331787109375
Step 906: grad_norm=1.3845951557159424, loss=0.14541271328926086, param_norm=1887.13330078125
01:53:51.862 [I] Progress on: 906it/1.00kit rate:9.0s/it remaining:14:06 elapsed:2:14:30 postfix:- (303899:tqdm_logging.py:145)
Step 907: grad_norm=1.5847777128219604, loss=0.14735755324363708, param_norm=1887.13330078125
Step 908: grad_norm=1.4096423387527466, loss=0.1510930061340332, param_norm=1887.13330078125
01:54:09.515 [I] Progress on: 908it/1.00kit rate:8.9s/it remaining:13:39 elapsed:2:14:47 postfix:- (303899:tqdm_logging.py:145)
Step 909: grad_norm=1.3430768251419067, loss=0.14645931124687195, param_norm=1887.13330078125
Step 910: grad_norm=1.5673201084136963, loss=0.15408140420913696, param_norm=1887.1334228515625
01:54:27.161 [I] Progress on: 910it/1.00kit rate:8.9s/it remaining:13:17 elapsed:2:15:05 postfix:- (303899:tqdm_logging.py:145)
Step 911: grad_norm=1.527337908744812, loss=0.16615960001945496, param_norm=1887.1334228515625
Step 912: grad_norm=1.738083839416504, loss=0.19033363461494446, param_norm=1887.1334228515625
01:54:44.783 [I] Progress on: 912it/1.00kit rate:8.8s/it remaining:12:56 elapsed:2:15:23 postfix:- (303899:tqdm_logging.py:145)
Step 913: grad_norm=1.8131834268569946, loss=0.17851462960243225, param_norm=1887.13330078125
Step 914: grad_norm=2.045196294784546, loss=0.20203033089637756, param_norm=1887.13330078125
01:55:02.415 [I] Progress on: 914it/1.00kit rate:8.8s/it remaining:12:37 elapsed:2:15:40 postfix:- (303899:tqdm_logging.py:145)
Step 915: grad_norm=1.785178780555725, loss=0.18303035199642181, param_norm=1887.13330078125
Step 916: grad_norm=2.1375956535339355, loss=0.14993122220039368, param_norm=1887.1334228515625
01:55:20.064 [I] Progress on: 916it/1.00kit rate:8.8s/it remaining:12:20 elapsed:2:15:58 postfix:- (303899:tqdm_logging.py:145)
Step 917: grad_norm=1.9432814121246338, loss=0.1974945217370987, param_norm=1887.13330078125
Step 918: grad_norm=1.7417951822280884, loss=0.1754954755306244, param_norm=1887.13330078125
01:55:37.744 [I] Progress on: 918it/1.00kit rate:8.8s/it remaining:12:02 elapsed:2:16:16 postfix:- (303899:tqdm_logging.py:145)
Step 919: grad_norm=1.9719942808151245, loss=0.15818166732788086, param_norm=1887.1334228515625
Step 920: grad_norm=1.9280896186828613, loss=0.18124330043792725, param_norm=1887.1334228515625
01:55:55.428 [I] Progress on: 920it/1.00kit rate:8.8s/it remaining:11:45 elapsed:2:16:33 postfix:- (303899:tqdm_logging.py:145)
Step 921: grad_norm=1.7017513513565063, loss=0.14543317258358002, param_norm=1887.1334228515625
Step 922: grad_norm=1.595563530921936, loss=0.1654023826122284, param_norm=1887.1334228515625
01:56:13.075 [I] Progress on: 922it/1.00kit rate:8.8s/it remaining:11:27 elapsed:2:16:51 postfix:- (303899:tqdm_logging.py:145)
Step 923: grad_norm=1.2722201347351074, loss=0.13737687468528748, param_norm=1887.1334228515625
Step 924: grad_norm=2.0372579097747803, loss=0.20205995440483093, param_norm=1887.1334228515625
01:56:30.754 [I] Progress on: 924it/1.00kit rate:8.8s/it remaining:11:10 elapsed:2:17:09 postfix:- (303899:tqdm_logging.py:145)
Step 925: grad_norm=1.9179253578186035, loss=0.160798579454422, param_norm=1887.1334228515625
Step 926: grad_norm=1.5478335618972778, loss=0.16210797429084778, param_norm=1887.1334228515625
01:56:48.401 [I] Progress on: 926it/1.00kit rate:8.8s/it remaining:10:52 elapsed:2:17:26 postfix:- (303899:tqdm_logging.py:145)
Step 927: grad_norm=1.6520276069641113, loss=0.1688476800918579, param_norm=1887.1334228515625
Step 928: grad_norm=1.4827075004577637, loss=0.13719621300697327, param_norm=1887.133544921875
01:57:06.059 [I] Progress on: 928it/1.00kit rate:8.8s/it remaining:10:34 elapsed:2:17:44 postfix:- (303899:tqdm_logging.py:145)
Step 929: grad_norm=1.6028833389282227, loss=0.1603461056947708, param_norm=1887.133544921875
Step 930: grad_norm=1.3145384788513184, loss=0.16368520259857178, param_norm=1887.133544921875
01:57:23.698 [I] Progress on: 930it/1.00kit rate:8.8s/it remaining:10:16 elapsed:2:18:02 postfix:- (303899:tqdm_logging.py:145)
Step 931: grad_norm=1.066454529762268, loss=0.13112735748291016, param_norm=1887.133544921875
Step 932: grad_norm=1.8248186111450195, loss=0.19046717882156372, param_norm=1887.133544921875
01:57:41.338 [I] Progress on: 932it/1.00kit rate:8.8s/it remaining:09:58 elapsed:2:18:19 postfix:- (303899:tqdm_logging.py:145)
Step 933: grad_norm=1.407915472984314, loss=0.1595674306154251, param_norm=1887.133544921875
Step 934: grad_norm=1.8308134078979492, loss=0.2060486227273941, param_norm=1887.133544921875
01:57:58.955 [I] Progress on: 934it/1.00kit rate:8.8s/it remaining:09:41 elapsed:2:18:37 postfix:- (303899:tqdm_logging.py:145)
Step 935: grad_norm=1.4823989868164062, loss=0.14252054691314697, param_norm=1887.1336669921875
01:58:10.294 [I] Progress on: 936it/1.00kit rate:9.5s/it remaining:10:08 elapsed:2:18:48 postfix:- (303899:tqdm_logging.py:145)
Step 936: grad_norm=1.218932867050171, loss=0.13049261271953583, param_norm=1887.1336669921875
Step 937: grad_norm=1.7057316303253174, loss=0.1495547592639923, param_norm=1887.1336669921875
01:58:27.649 [I] Progress on: 937it/1.00kit rate:9.3s/it remaining:09:44 elapsed:2:19:06 postfix:- (303899:tqdm_logging.py:145)
Step 938: grad_norm=1.441950798034668, loss=0.14712569117546082, param_norm=1887.1337890625
Step 939: grad_norm=1.7167996168136597, loss=0.15634962916374207, param_norm=1887.1337890625
01:58:45.286 [I] Progress on: 939it/1.00kit rate:9.0s/it remaining:09:11 elapsed:2:19:23 postfix:- (303899:tqdm_logging.py:145)
Step 940: grad_norm=1.6247507333755493, loss=0.16927890479564667, param_norm=1887.1337890625
Step 941: grad_norm=1.2432200908660889, loss=0.14294779300689697, param_norm=1887.1337890625
01:59:02.942 [I] Progress on: 941it/1.00kit rate:8.9s/it remaining:08:46 elapsed:2:19:41 postfix:- (303899:tqdm_logging.py:145)
Step 942: grad_norm=2.005953073501587, loss=0.16885162889957428, param_norm=1887.1337890625
Step 943: grad_norm=1.5823060274124146, loss=0.1353158950805664, param_norm=1887.1337890625
01:59:20.612 [I] Progress on: 943it/1.00kit rate:8.9s/it remaining:08:25 elapsed:2:19:58 postfix:- (303899:tqdm_logging.py:145)
Step 944: grad_norm=1.6957299709320068, loss=0.16062305867671967, param_norm=1887.1337890625
Step 945: grad_norm=1.3904656171798706, loss=0.1486310511827469, param_norm=1887.1337890625
01:59:38.221 [I] Progress on: 945it/1.00kit rate:8.8s/it remaining:08:05 elapsed:2:20:16 postfix:- (303899:tqdm_logging.py:145)
Step 946: grad_norm=1.5272620916366577, loss=0.16345758736133575, param_norm=1887.1337890625
Step 947: grad_norm=1.6898194551467896, loss=0.1770850121974945, param_norm=1887.1337890625
01:59:55.863 [I] Progress on: 947it/1.00kit rate:8.8s/it remaining:07:47 elapsed:2:20:34 postfix:- (303899:tqdm_logging.py:145)
Step 948: grad_norm=1.7969412803649902, loss=0.16653364896774292, param_norm=1887.1337890625
Step 949: grad_norm=2.2261593341827393, loss=0.16096729040145874, param_norm=1887.1337890625
02:00:13.509 [I] Progress on: 949it/1.00kit rate:8.8s/it remaining:07:29 elapsed:2:20:51 postfix:- (303899:tqdm_logging.py:145)
Step 950: grad_norm=1.5586622953414917, loss=0.14273589849472046, param_norm=1887.1337890625
Step 951: grad_norm=1.3082306385040283, loss=0.18137897551059723, param_norm=1887.1337890625
02:00:31.155 [I] Progress on: 951it/1.00kit rate:8.8s/it remaining:07:11 elapsed:2:21:09 postfix:- (303899:tqdm_logging.py:145)
Step 952: grad_norm=1.3276236057281494, loss=0.14360812306404114, param_norm=1887.1337890625
Step 953: grad_norm=2.005237102508545, loss=0.1735662817955017, param_norm=1887.1337890625
02:00:48.925 [I] Progress on: 953it/1.00kit rate:8.8s/it remaining:06:55 elapsed:2:21:27 postfix:- (303899:tqdm_logging.py:145)
Step 954: grad_norm=1.642279028892517, loss=0.13463129103183746, param_norm=1887.1337890625
Step 955: grad_norm=1.6904287338256836, loss=0.14792008697986603, param_norm=1887.1337890625
02:01:06.592 [I] Progress on: 955it/1.00kit rate:8.8s/it remaining:06:37 elapsed:2:21:44 postfix:- (303899:tqdm_logging.py:145)
Step 956: grad_norm=1.6377822160720825, loss=0.17557230591773987, param_norm=1887.1339111328125
Step 957: grad_norm=1.6223171949386597, loss=0.1572459638118744, param_norm=1887.1339111328125
02:01:24.267 [I] Progress on: 957it/1.00kit rate:8.8s/it remaining:06:19 elapsed:2:22:02 postfix:- (303899:tqdm_logging.py:145)
Step 958: grad_norm=1.5828285217285156, loss=0.15440145134925842, param_norm=1887.1339111328125
Step 959: grad_norm=1.6200741529464722, loss=0.14703626930713654, param_norm=1887.1339111328125
02:01:41.947 [I] Progress on: 959it/1.00kit rate:8.8s/it remaining:06:01 elapsed:2:22:20 postfix:- (303899:tqdm_logging.py:145)
Step 960: grad_norm=1.6244182586669922, loss=0.15333391726016998, param_norm=1887.1339111328125
Step 961: grad_norm=1.3463382720947266, loss=0.14366890490055084, param_norm=1887.1339111328125
02:01:59.618 [I] Progress on: 961it/1.00kit rate:8.8s/it remaining:05:44 elapsed:2:22:37 postfix:- (303899:tqdm_logging.py:145)
Step 962: grad_norm=1.4136861562728882, loss=0.1906798928976059, param_norm=1887.1339111328125
Step 963: grad_norm=1.6281440258026123, loss=0.15055006742477417, param_norm=1887.1339111328125
02:02:17.281 [I] Progress on: 963it/1.00kit rate:8.8s/it remaining:05:26 elapsed:2:22:55 postfix:- (303899:tqdm_logging.py:145)
Step 964: grad_norm=1.6177423000335693, loss=0.13004256784915924, param_norm=1887.1339111328125
Step 965: grad_norm=1.6307637691497803, loss=0.1590125858783722, param_norm=1887.1339111328125
02:02:34.971 [I] Progress on: 965it/1.00kit rate:8.8s/it remaining:05:08 elapsed:2:23:13 postfix:- (303899:tqdm_logging.py:145)
Step 966: grad_norm=1.58774733543396, loss=0.152830570936203, param_norm=1887.134033203125
Step 967: grad_norm=1.3394397497177124, loss=0.13161322474479675, param_norm=1887.1339111328125
02:02:52.646 [I] Progress on: 967it/1.00kit rate:8.8s/it remaining:04:51 elapsed:2:23:31 postfix:- (303899:tqdm_logging.py:145)
Step 968: grad_norm=1.6238734722137451, loss=0.1637915074825287, param_norm=1887.1339111328125
Step 969: grad_norm=1.434538722038269, loss=0.1650789976119995, param_norm=1887.134033203125
02:03:10.308 [I] Progress on: 969it/1.00kit rate:8.8s/it remaining:04:33 elapsed:2:23:48 postfix:- (303899:tqdm_logging.py:145)
Step 970: grad_norm=1.698609471321106, loss=0.16449975967407227, param_norm=1887.134033203125
Step 971: grad_norm=1.6175307035446167, loss=0.17381440103054047, param_norm=1887.134033203125
02:03:27.986 [I] Progress on: 971it/1.00kit rate:8.8s/it remaining:04:15 elapsed:2:24:06 postfix:- (303899:tqdm_logging.py:145)
Step 972: grad_norm=1.76746666431427, loss=0.16269105672836304, param_norm=1887.134033203125
Step 973: grad_norm=1.252683162689209, loss=0.14351513981819153, param_norm=1887.134033203125
02:03:45.644 [I] Progress on: 973it/1.00kit rate:8.8s/it remaining:03:58 elapsed:2:24:24 postfix:- (303899:tqdm_logging.py:145)
Step 974: grad_norm=1.5639512538909912, loss=0.13915450870990753, param_norm=1887.134033203125
02:03:57.020 [I] Progress on: 975it/1.00kit rate:9.5s/it remaining:03:58 elapsed:2:24:35 postfix:- (303899:tqdm_logging.py:145)
Step 975: grad_norm=1.4029936790466309, loss=0.1655547320842743, param_norm=1887.134033203125
Step 976: grad_norm=1.281834602355957, loss=0.14459353685379028, param_norm=1887.134033203125
02:04:14.384 [I] Progress on: 976it/1.00kit rate:9.3s/it remaining:03:42 elapsed:2:24:52 postfix:- (303899:tqdm_logging.py:145)
Step 977: grad_norm=1.6738464832305908, loss=0.15941119194030762, param_norm=1887.134033203125
Step 978: grad_norm=1.791260838508606, loss=0.14691653847694397, param_norm=1887.134033203125
02:04:32.037 [I] Progress on: 978it/1.00kit rate:9.0s/it remaining:03:18 elapsed:2:25:10 postfix:- (303899:tqdm_logging.py:145)
Step 979: grad_norm=1.3153218030929565, loss=0.14302656054496765, param_norm=1887.1341552734375
Step 980: grad_norm=1.3618128299713135, loss=0.14484265446662903, param_norm=1887.1341552734375
02:04:49.690 [I] Progress on: 980it/1.00kit rate:8.9s/it remaining:02:58 elapsed:2:25:28 postfix:- (303899:tqdm_logging.py:145)
Step 981: grad_norm=1.7352160215377808, loss=0.14257144927978516, param_norm=1887.1341552734375
Step 982: grad_norm=1.532570719718933, loss=0.1654168963432312, param_norm=1887.1341552734375
02:05:07.357 [I] Progress on: 982it/1.00kit rate:8.9s/it remaining:02:39 elapsed:2:25:45 postfix:- (303899:tqdm_logging.py:145)
Step 983: grad_norm=1.0270304679870605, loss=0.11624296009540558, param_norm=1887.1341552734375
Step 984: grad_norm=1.3723626136779785, loss=0.13463693857192993, param_norm=1887.1341552734375
02:05:25.019 [I] Progress on: 984it/1.00kit rate:8.8s/it remaining:02:21 elapsed:2:26:03 postfix:- (303899:tqdm_logging.py:145)
Step 985: grad_norm=1.2862792015075684, loss=0.12876571714878082, param_norm=1887.1341552734375
Step 986: grad_norm=1.92434561252594, loss=0.1612117439508438, param_norm=1887.1341552734375
02:05:42.726 [I] Progress on: 986it/1.00kit rate:8.8s/it remaining:02:03 elapsed:2:26:21 postfix:- (303899:tqdm_logging.py:145)
Step 987: grad_norm=1.622552514076233, loss=0.15831470489501953, param_norm=1887.1341552734375
Step 988: grad_norm=1.3168959617614746, loss=0.12134459614753723, param_norm=1887.1341552734375
02:06:00.389 [I] Progress on: 988it/1.00kit rate:8.8s/it remaining:01:45 elapsed:2:26:38 postfix:- (303899:tqdm_logging.py:145)
Step 989: grad_norm=1.2958844900131226, loss=0.14704065024852753, param_norm=1887.1341552734375
Step 990: grad_norm=1.395472526550293, loss=0.14524585008621216, param_norm=1887.1341552734375
02:06:18.051 [I] Progress on: 990it/1.00kit rate:8.8s/it remaining:01:28 elapsed:2:26:56 postfix:- (303899:tqdm_logging.py:145)
Step 991: grad_norm=1.4795292615890503, loss=0.17863713204860687, param_norm=1887.1341552734375
Step 992: grad_norm=1.6359282732009888, loss=0.15960745513439178, param_norm=1887.1341552734375
02:06:35.817 [I] Progress on: 992it/1.00kit rate:8.8s/it remaining:01:10 elapsed:2:27:14 postfix:- (303899:tqdm_logging.py:145)
Step 993: grad_norm=1.3301639556884766, loss=0.1448972523212433, param_norm=1887.1341552734375
Step 994: grad_norm=1.5058422088623047, loss=0.155216783285141, param_norm=1887.13427734375
02:06:53.520 [I] Progress on: 994it/1.00kit rate:8.8s/it remaining:00:53 elapsed:2:27:31 postfix:- (303899:tqdm_logging.py:145)
Step 995: grad_norm=1.309249997138977, loss=0.16422498226165771, param_norm=1887.13427734375
Step 996: grad_norm=1.446401834487915, loss=0.17548546195030212, param_norm=1887.13427734375
02:07:11.155 [I] Progress on: 996it/1.00kit rate:8.8s/it remaining:00:35 elapsed:2:27:49 postfix:- (303899:tqdm_logging.py:145)
Step 997: grad_norm=1.679012417793274, loss=0.1485876441001892, param_norm=1887.13427734375
Step 998: grad_norm=1.4727352857589722, loss=0.14271888136863708, param_norm=1887.13427734375
02:07:28.845 [I] Progress on: 998it/1.00kit rate:8.8s/it remaining:00:17 elapsed:2:28:07 postfix:- (303899:tqdm_logging.py:145)
Step 999: grad_norm=1.6792032718658447, loss=0.15351726114749908, param_norm=1887.13427734375
02:07:37.876 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
02:07:37.876 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
02:07:37.876 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (303899:checkpoint_manager.py:1786)
02:07:37.876 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (303899:checkpoint_manager.py:1817)
02:07:37.877 [I] [process=0] Saving checkpoint at step 999                                        (303899:checkpoint_manager.py:1286)
02:07:37.878 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999. (303899:async_checkpointer.py:358)
02:07:37.879 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
02:07:37.879 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27 (303899:atomicity.py:144)
02:07:37.880 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
02:07:37.880 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (303899:multihost.py:293)
02:07:37.881 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (303899:atomicity.py:144)
02:07:37.882 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (303899:atomicity.py:144)
02:07:37.882 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (303899:multihost.py:293)
02:07:37.887 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (303899:replica_slices.py:419)
02:07:41.669 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (303899:tensorstore_utils.py:371)
02:07:41.670 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
02:07:41.672 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (303899:tensorstore_utils.py:371)
02:07:41.673 [I] [process=0][thread=async_save] Background save thread started.                   (303899:async_checkpointer.py:121)
02:07:41.680 [I] Preserving Checkpoint[step=100 | time=2025-03-25 03:54:19.348729+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.681 [I] Preserving Checkpoint[step=200 | time=2025-03-25 04:09:06.501855+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.682 [I] Preserving Checkpoint[step=300 | time=2025-03-25 04:23:54.735619+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.683 [I] Preserving Checkpoint[step=400 | time=2025-03-25 04:38:45.986340+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.686 [I] Preserving Checkpoint[step=500 | time=2025-03-25 04:53:35.326173+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.692 [I] Preserving Checkpoint[step=600 | time=2025-03-25 05:08:26.511268+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.696 [I] Preserving Checkpoint[step=700 | time=2025-03-25 05:23:15.063355+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.702 [I] Preserving Checkpoint[step=800 | time=2025-03-25 05:38:06.150621+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.702 [I] Preserving Checkpoint[step=900 | time=2025-03-25 05:52:59.229632+00:00 | is_locked=None]: (Reason: on keep_period=100). (303899:checkpoint_manager.py:1734)
02:07:41.703 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (303899:multihost.py:293)
02:07:41.705 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (303899:checkpoint_manager.py:1328)
02:07:41.707 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (303899:async_checkpointer.py:231)
02:07:41.708 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742882857.8763745, 'wait_for_prev_duration_secs': 0.0006558895111083984, 'checkpointer_blocking_start_time': 1742882857.8775542, 'checkpointer_blocking_duration_secs': 3.802701711654663, 'get_old_steps_start_time': 1742882861.6803024, 'get_old_steps_duration_secs': 0.022881507873535156, 'checkpoint_manager_blocking_start_time': 1742882857.8762314, 'checkpoint_manager_blocking_duration_secs': 3.831857204437256} (303899:standard_logger.py:34)
02:07:41.713 [I] Progress on: 1.00kit/1.00kit rate:10.0s/it remaining:00:00 elapsed:2:28:20 postfix:- (303899:tqdm_logging.py:145)
02:07:41.715 [I] Progress on: 1.00kit/1.00kit rate:10.0s/it remaining:00:00 elapsed:2:28:20 postfix:- (303899:tqdm_logging.py:145)
02:07:41.718 [I] Waiting for checkpoint manager to finish                                         (303899:train_pi0_fast_regent.py:301)
02:07:41.719 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (303899:checkpoint_manager.py:1759)
02:07:41.722 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (303899:checkpoint_manager.py:1777)
02:07:48.520 [I] ChainedFuture completed 1/1 futures in 6.84 seconds.                             (303899:future.py:137)
02:07:48.520 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 974.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (303899:base_pytree_checkpoint_handler.py:113)
02:07:48.520 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (303899:async_checkpointer.py:131)
02:07:48.522 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f34b5eb2650> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27 (303899:async_checkpointer.py:406)
02:07:48.522 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27/assets (303899:atomicity.py:287)
02:07:48.532 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27/params (303899:atomicity.py:287)
02:07:48.532 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999 (303899:async_checkpointer.py:416)
02:07:48.533 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27 (303899:async_checkpointer.py:426)
02:07:48.533 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999 (303899:atomicity.py:287)
02:07:48.535 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_10/999`. (303899:atomicity.py:548)
02:07:48.535 [I] [process=0][thread=async_save] Background save thread done.                      (303899:async_checkpointer.py:183)
02:07:48.535 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (303899:async_checkpointer.py:239)
02:07:48.535 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (303899:async_checkpointer.py:249)
02:07:48.536 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (303899:checkpoint_manager.py:1890)
02:07:48.536 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (303899:checkpoint_manager.py:1905)
02:07:48.536 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (303899:checkpoint_manager.py:1786)
02:07:48.536 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (303899:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_regent_idli_plate_10[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/i0et0wd8[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250324_233830-i0et0wd8/logs[0m
