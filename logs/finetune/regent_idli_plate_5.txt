nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
21:38:59.039 [I] Running on: ivy                                                                  (286571:train_pi0_fast_regent.py:226)
INFO:2025-03-24 21:38:59,820:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
21:38:59.820 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (286571:xla_bridge.py:945)
INFO:2025-03-24 21:38:59,821:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
21:38:59.821 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (286571:xla_bridge.py:945)
21:39:00.769 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (286571:base_pytree_checkpoint_handler.py:332)
21:39:00.770 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (286571:base_pytree_checkpoint_handler.py:332)
21:39:00.770 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (286571:multihost.py:375)
21:39:00.770 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7f3143314150>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f31431e8d10>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f314327a050>}, handler_registry=None (286571:checkpoint_manager.py:622)
21:39:00.771 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7f3143314150>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (286571:composite_checkpoint_handler.py:239)
21:39:00.771 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f31431e8d10>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (286571:composite_checkpoint_handler.py:239)
21:39:00.771 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f314327a050>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (286571:composite_checkpoint_handler.py:239)
21:39:00.771 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f314333bc90>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (286571:composite_checkpoint_handler.py:239)
21:39:00.771 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f3143314150>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f3143314150>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f31431e8d10>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f31431e8d10>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f314327a050>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f314327a050>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f314333bc90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f314333bc90>}). (286571:composite_checkpoint_handler.py:508)
21:39:00.771 [I] orbax-checkpoint version: 0.11.1                                                 (286571:abstract_checkpointer.py:35)
21:39:00.772 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f31434dbc40> timeout: 7200 secs and primary_host=0 for async checkpoint writes (286571:async_checkpointer.py:80)
21:39:00.772 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5 (286571:checkpoint_manager.py:1528)
21:39:00.772 [I] Saving root metadata                                                             (286571:checkpoint_manager.py:1569)
21:39:00.772 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (286571:multihost.py:293)
21:39:00.772 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f3144cac790> (286571:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250324_213901-phisfxlu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_regent_idli_plate_5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/phisfxlu
Some kwargs in processor config are unused and will not have any effect: time_horizon, vocab_size, action_dim, min_token, scale. 
Some kwargs in processor config are unused and will not have any effect: time_horizon, vocab_size, action_dim, min_token, scale. 
21:39:02.602 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/droid (286571:config.py:167)
count_droid: 0, count_collected_demos: 340
len_dataset: 340
all 5 episode prompts are the same: move the idli plate to the right
21:39:24.664 [I] Initialized data loader:
[0].query_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].query_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].query_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].query_image_masks['base_0_rgb']: (16,)@bool
[0].query_image_masks['base_1_rgb']: (16,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].exp_lamda_distances: (16, 5, 1)@float32
[0].query_state: (16, 8)@float32
[0].retrieved_0_state: (16, 8)@float32
[0].retrieved_1_state: (16, 8)@float32
[0].retrieved_2_state: (16, 8)@float32
[0].retrieved_3_state: (16, 8)@float32
[0].query_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_prefix: (16, 125)@int32
[0].query_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_postfix: (16, 125)@int32
[0].query_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_0_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_1_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_2_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_3_tokenized_prompt_mask: (16, 250)@bool
[0].query_token_ar_mask: (16, 250)@int32
[0].retrieved_0_token_ar_mask: (16, 250)@int32
[0].retrieved_1_token_ar_mask: (16, 250)@int32
[0].retrieved_2_token_ar_mask: (16, 250)@int32
[0].retrieved_3_token_ar_mask: (16, 250)@int32
[0].query_token_loss_mask: (16, 250)@bool
[0].retrieved_0_token_loss_mask: (16, 250)@bool
[0].retrieved_1_token_loss_mask: (16, 250)@bool
[0].retrieved_2_token_loss_mask: (16, 250)@bool
[0].retrieved_3_token_loss_mask: (16, 250)@bool
[1]: (16, 15, 8)@float32 (286571:train_pi0_fast_regent.py:258)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
21:39:25.731 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (286571:base_pytree_checkpoint_handler.py:332)
21:39:25.763 [I] Restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (286571:checkpointer.py:256)
21:39:44.397 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 556.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 18 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
21:39:44.398 [I] Finished restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (286571:checkpointer.py:259)
21:39:44.398 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (286571:multihost.py:293)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
2025-03-24 21:45:18.156134: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 30.69GiB (32957682654 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
21:45:20.700 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (286571:train_pi0_fast_regent.py:262)
decode_indices shape: (1245,)
21:45:20.802 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (286571:tqdm_logging.py:145)
first_targets shape: (16, 125, 257152)
input_token_embeddings shape: (16, 5090, 2048)
attn_mask shape: (16, 5090, 5090)
loss_mask shape: (16, 249)
targets shape: (16, 249, 257152)
pre_logits shape: (16, 5089, 2048)
logits shape: (16, 249, 257152)
new_logits shape: (16, 249, 257152)
logp shape: (16, 249, 257152)
token_pplx shape: (16, 249)
loss shape: (16,)
Step 0: grad_norm=13.189373016357422, loss=4.107996940612793, param_norm=1886.9476318359375
21:45:39.048 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:18 postfix:-                   (286571:tqdm_logging.py:145)
Step 1: grad_norm=14.251412391662598, loss=3.988218307495117, param_norm=1886.9476318359375
Step 2: grad_norm=13.991721153259277, loss=4.349886417388916, param_norm=1886.9476318359375
21:45:56.365 [I] Progress on: 2.00it/1.00kit rate:12.7s/it remaining:3:31:00 elapsed:00:35 postfix:- (286571:tqdm_logging.py:145)
Step 3: grad_norm=18.348133087158203, loss=3.93695068359375, param_norm=1886.9476318359375
Step 4: grad_norm=11.10318374633789, loss=4.051342487335205, param_norm=1886.9476318359375
21:46:13.712 [I] Progress on: 4.00it/1.00kit rate:10.0s/it remaining:2:45:33 elapsed:00:52 postfix:- (286571:tqdm_logging.py:145)
Step 5: grad_norm=12.002453804016113, loss=3.8396108150482178, param_norm=1886.947509765625
Step 6: grad_norm=13.271851539611816, loss=3.5910253524780273, param_norm=1886.947509765625
21:46:31.165 [I] Progress on: 6.00it/1.00kit rate:9.2s/it remaining:2:33:00 elapsed:01:10 postfix:- (286571:tqdm_logging.py:145)
Step 7: grad_norm=9.128800392150879, loss=3.715247869491577, param_norm=1886.947509765625
Step 8: grad_norm=8.458730697631836, loss=3.4270739555358887, param_norm=1886.9473876953125
21:46:48.698 [I] Progress on: 8.00it/1.00kit rate:9.0s/it remaining:2:28:17 elapsed:01:27 postfix:- (286571:tqdm_logging.py:145)
Step 9: grad_norm=9.625638008117676, loss=3.430967092514038, param_norm=1886.9473876953125
Step 10: grad_norm=6.930309295654297, loss=3.3549485206604004, param_norm=1886.9473876953125
21:47:06.306 [I] Progress on: 10.0it/1.00kit rate:8.9s/it remaining:2:26:21 elapsed:01:45 postfix:- (286571:tqdm_logging.py:145)
Step 11: grad_norm=6.764164447784424, loss=3.2247719764709473, param_norm=1886.9473876953125
Step 12: grad_norm=9.926876068115234, loss=3.2587687969207764, param_norm=1886.9473876953125
21:47:24.010 [I] Progress on: 12.0it/1.00kit rate:8.8s/it remaining:2:25:41 elapsed:02:03 postfix:- (286571:tqdm_logging.py:145)
Step 13: grad_norm=8.809409141540527, loss=2.9275870323181152, param_norm=1886.947265625
Step 14: grad_norm=10.327493667602539, loss=2.8750624656677246, param_norm=1886.947265625
21:47:41.784 [I] Progress on: 14.0it/1.00kit rate:8.9s/it remaining:2:25:32 elapsed:02:20 postfix:- (286571:tqdm_logging.py:145)
Step 15: grad_norm=5.094850063323975, loss=2.971407413482666, param_norm=1886.947265625
Step 16: grad_norm=6.22109842300415, loss=3.1431760787963867, param_norm=1886.947265625
21:47:59.581 [I] Progress on: 16.0it/1.00kit rate:8.9s/it remaining:2:25:28 elapsed:02:38 postfix:- (286571:tqdm_logging.py:145)
Step 17: grad_norm=6.04323673248291, loss=2.964948892593384, param_norm=1886.9471435546875
Step 18: grad_norm=12.306971549987793, loss=3.2412028312683105, param_norm=1886.9471435546875
21:48:17.345 [I] Progress on: 18.0it/1.00kit rate:8.9s/it remaining:2:25:19 elapsed:02:56 postfix:- (286571:tqdm_logging.py:145)
Step 19: grad_norm=6.452450752258301, loss=2.6082589626312256, param_norm=1886.947265625
Step 20: grad_norm=20.78792953491211, loss=2.8914365768432617, param_norm=1886.947265625
21:48:35.073 [I] Progress on: 20.0it/1.00kit rate:8.9s/it remaining:2:24:53 elapsed:03:14 postfix:- (286571:tqdm_logging.py:145)
Step 21: grad_norm=13.334724426269531, loss=2.8077170848846436, param_norm=1886.947265625
21:48:46.230 [I] Progress on: 21.0it/1.00kit rate:9.6s/it remaining:2:36:03 elapsed:03:25 postfix:- (286571:tqdm_logging.py:145)
Step 22: grad_norm=8.712932586669922, loss=2.705298900604248, param_norm=1886.9473876953125
Step 23: grad_norm=10.188233375549316, loss=2.8392205238342285, param_norm=1886.9473876953125
21:49:03.868 [I] Progress on: 23.0it/1.00kit rate:9.2s/it remaining:2:29:41 elapsed:03:43 postfix:- (286571:tqdm_logging.py:145)
Step 24: grad_norm=10.557209014892578, loss=2.7637903690338135, param_norm=1886.9473876953125
Step 25: grad_norm=16.29922866821289, loss=2.6176671981811523, param_norm=1886.947509765625
21:49:21.485 [I] Progress on: 25.0it/1.00kit rate:9.0s/it remaining:2:26:18 elapsed:04:00 postfix:- (286571:tqdm_logging.py:145)
Step 26: grad_norm=17.35967445373535, loss=2.6201138496398926, param_norm=1886.947509765625
Step 27: grad_norm=14.656835556030273, loss=2.6288070678710938, param_norm=1886.9476318359375
21:49:39.167 [I] Progress on: 27.0it/1.00kit rate:8.9s/it remaining:2:24:40 elapsed:04:18 postfix:- (286571:tqdm_logging.py:145)
Step 28: grad_norm=17.853456497192383, loss=2.5337204933166504, param_norm=1886.94775390625
Step 29: grad_norm=5.034654140472412, loss=2.4449596405029297, param_norm=1886.9478759765625
21:49:56.773 [I] Progress on: 29.0it/1.00kit rate:8.9s/it remaining:2:23:29 elapsed:04:35 postfix:- (286571:tqdm_logging.py:145)
Step 30: grad_norm=8.519968032836914, loss=2.515970468521118, param_norm=1886.947998046875
Step 31: grad_norm=7.829897880554199, loss=2.5106897354125977, param_norm=1886.9482421875
21:50:14.347 [I] Progress on: 31.0it/1.00kit rate:8.8s/it remaining:2:22:36 elapsed:04:53 postfix:- (286571:tqdm_logging.py:145)
Step 32: grad_norm=5.839230537414551, loss=2.554205894470215, param_norm=1886.9483642578125
Step 33: grad_norm=10.373198509216309, loss=2.4865975379943848, param_norm=1886.9486083984375
21:50:31.925 [I] Progress on: 33.0it/1.00kit rate:8.8s/it remaining:2:22:02 elapsed:05:11 postfix:- (286571:tqdm_logging.py:145)
Step 34: grad_norm=7.547685146331787, loss=2.2476806640625, param_norm=1886.948974609375
Step 35: grad_norm=6.519881725311279, loss=2.4778189659118652, param_norm=1886.9490966796875
21:50:49.531 [I] Progress on: 35.0it/1.00kit rate:8.8s/it remaining:2:21:45 elapsed:05:28 postfix:- (286571:tqdm_logging.py:145)
Step 36: grad_norm=14.789826393127441, loss=2.3801217079162598, param_norm=1886.9493408203125
Step 37: grad_norm=11.032784461975098, loss=2.235995292663574, param_norm=1886.94970703125
21:51:07.083 [I] Progress on: 37.0it/1.00kit rate:8.8s/it remaining:2:21:12 elapsed:05:46 postfix:- (286571:tqdm_logging.py:145)
Step 38: grad_norm=9.065314292907715, loss=2.5040669441223145, param_norm=1886.949951171875
Step 39: grad_norm=8.308667182922363, loss=2.0300049781799316, param_norm=1886.9501953125
21:51:24.634 [I] Progress on: 39.0it/1.00kit rate:8.8s/it remaining:2:20:47 elapsed:06:03 postfix:- (286571:tqdm_logging.py:145)
Step 40: grad_norm=20.6879825592041, loss=2.219259262084961, param_norm=1886.950439453125
Step 41: grad_norm=7.745431423187256, loss=2.2034571170806885, param_norm=1886.95068359375
21:51:42.180 [I] Progress on: 41.0it/1.00kit rate:8.8s/it remaining:2:20:26 elapsed:06:21 postfix:- (286571:tqdm_logging.py:145)
Step 42: grad_norm=6.314414978027344, loss=2.005800724029541, param_norm=1886.950927734375
21:51:53.137 [I] Progress on: 42.0it/1.00kit rate:9.4s/it remaining:2:30:45 elapsed:06:32 postfix:- (286571:tqdm_logging.py:145)
Step 43: grad_norm=14.932625770568848, loss=2.1572601795196533, param_norm=1886.951171875
Step 44: grad_norm=14.419620513916016, loss=2.1245477199554443, param_norm=1886.951416015625
21:52:10.669 [I] Progress on: 44.0it/1.00kit rate:9.1s/it remaining:2:24:52 elapsed:06:49 postfix:- (286571:tqdm_logging.py:145)
Step 45: grad_norm=10.854631423950195, loss=2.013604164123535, param_norm=1886.9517822265625
Step 46: grad_norm=17.564971923828125, loss=1.8891241550445557, param_norm=1886.9521484375
21:52:28.220 [I] Progress on: 46.0it/1.00kit rate:8.9s/it remaining:2:21:54 elapsed:07:07 postfix:- (286571:tqdm_logging.py:145)
Step 47: grad_norm=7.819421768188477, loss=2.1676087379455566, param_norm=1886.952392578125
Step 48: grad_norm=8.526427268981934, loss=2.0111448764801025, param_norm=1886.952880859375
21:52:45.781 [I] Progress on: 48.0it/1.00kit rate:8.8s/it remaining:2:20:20 elapsed:07:24 postfix:- (286571:tqdm_logging.py:145)
Step 49: grad_norm=21.210973739624023, loss=2.065013885498047, param_norm=1886.9532470703125
Step 50: grad_norm=26.361209869384766, loss=1.9539494514465332, param_norm=1886.95361328125
21:53:03.347 [I] Progress on: 50.0it/1.00kit rate:8.8s/it remaining:2:19:34 elapsed:07:42 postfix:- (286571:tqdm_logging.py:145)
Step 51: grad_norm=21.420513153076172, loss=2.082632541656494, param_norm=1886.9539794921875
Step 52: grad_norm=26.182905197143555, loss=2.196824789047241, param_norm=1886.954345703125
21:53:20.902 [I] Progress on: 52.0it/1.00kit rate:8.8s/it remaining:2:18:51 elapsed:08:00 postfix:- (286571:tqdm_logging.py:145)
Step 53: grad_norm=8.329794883728027, loss=1.959003210067749, param_norm=1886.95458984375
Step 54: grad_norm=6.568888187408447, loss=2.044602870941162, param_norm=1886.9549560546875
21:53:38.460 [I] Progress on: 54.0it/1.00kit rate:8.8s/it remaining:2:18:23 elapsed:08:17 postfix:- (286571:tqdm_logging.py:145)
Step 55: grad_norm=8.72448444366455, loss=2.1740095615386963, param_norm=1886.955322265625
Step 56: grad_norm=12.6267671585083, loss=1.9686098098754883, param_norm=1886.95556640625
21:53:56.024 [I] Progress on: 56.0it/1.00kit rate:8.8s/it remaining:2:18:07 elapsed:08:35 postfix:- (286571:tqdm_logging.py:145)
Step 57: grad_norm=14.129706382751465, loss=2.086272954940796, param_norm=1886.9560546875
Step 58: grad_norm=13.771673202514648, loss=2.1175355911254883, param_norm=1886.9564208984375
21:54:13.581 [I] Progress on: 58.0it/1.00kit rate:8.8s/it remaining:2:17:42 elapsed:08:52 postfix:- (286571:tqdm_logging.py:145)
Step 59: grad_norm=17.652050018310547, loss=2.0600674152374268, param_norm=1886.956787109375
Step 60: grad_norm=5.7245330810546875, loss=2.1032357215881348, param_norm=1886.9571533203125
21:54:31.204 [I] Progress on: 60.0it/1.00kit rate:8.8s/it remaining:2:17:45 elapsed:09:10 postfix:- (286571:tqdm_logging.py:145)
Step 61: grad_norm=9.813712120056152, loss=2.158790349960327, param_norm=1886.9573974609375
Step 62: grad_norm=12.821382522583008, loss=1.9298818111419678, param_norm=1886.957763671875
21:54:48.758 [I] Progress on: 62.0it/1.00kit rate:8.8s/it remaining:2:17:16 elapsed:09:27 postfix:- (286571:tqdm_logging.py:145)
Step 63: grad_norm=12.109743118286133, loss=1.7239444255828857, param_norm=1886.9581298828125
21:55:00.097 [I] Progress on: 63.0it/1.00kit rate:9.6s/it remaining:2:29:12 elapsed:09:39 postfix:- (286571:tqdm_logging.py:145)
Step 64: grad_norm=7.160964488983154, loss=1.7776029109954834, param_norm=1886.9586181640625
Step 65: grad_norm=9.944807052612305, loss=1.8129175901412964, param_norm=1886.9591064453125
21:55:17.515 [I] Progress on: 65.0it/1.00kit rate:9.1s/it remaining:2:22:08 elapsed:09:56 postfix:- (286571:tqdm_logging.py:145)
Step 66: grad_norm=13.34262466430664, loss=1.9229998588562012, param_norm=1886.95947265625
Step 67: grad_norm=12.504205703735352, loss=1.855712652206421, param_norm=1886.9598388671875
21:55:35.076 [I] Progress on: 67.0it/1.00kit rate:8.9s/it remaining:2:19:04 elapsed:10:14 postfix:- (286571:tqdm_logging.py:145)
Step 68: grad_norm=13.209185600280762, loss=1.8440701961517334, param_norm=1886.9603271484375
Step 69: grad_norm=20.12726402282715, loss=1.85939359664917, param_norm=1886.960693359375
21:55:52.617 [I] Progress on: 69.0it/1.00kit rate:8.9s/it remaining:2:17:20 elapsed:10:31 postfix:- (286571:tqdm_logging.py:145)
Step 70: grad_norm=8.013199806213379, loss=1.6680173873901367, param_norm=1886.9610595703125
Step 71: grad_norm=5.931964874267578, loss=1.839120626449585, param_norm=1886.9615478515625
21:56:10.180 [I] Progress on: 71.0it/1.00kit rate:8.8s/it remaining:2:16:27 elapsed:10:49 postfix:- (286571:tqdm_logging.py:145)
Step 72: grad_norm=15.05774974822998, loss=1.8975012302398682, param_norm=1886.9617919921875
Step 73: grad_norm=21.823673248291016, loss=1.7832939624786377, param_norm=1886.96240234375
21:56:27.729 [I] Progress on: 73.0it/1.00kit rate:8.8s/it remaining:2:15:48 elapsed:11:06 postfix:- (286571:tqdm_logging.py:145)
Step 74: grad_norm=13.323392868041992, loss=1.6705329418182373, param_norm=1886.9627685546875
Step 75: grad_norm=17.511024475097656, loss=1.9007045030593872, param_norm=1886.9632568359375
21:56:45.302 [I] Progress on: 75.0it/1.00kit rate:8.8s/it remaining:2:15:25 elapsed:11:24 postfix:- (286571:tqdm_logging.py:145)
Step 76: grad_norm=11.150145530700684, loss=1.8181719779968262, param_norm=1886.9637451171875
Step 77: grad_norm=7.36489725112915, loss=1.6524232625961304, param_norm=1886.9642333984375
21:57:02.934 [I] Progress on: 77.0it/1.00kit rate:8.8s/it remaining:2:15:16 elapsed:11:42 postfix:- (286571:tqdm_logging.py:145)
Step 78: grad_norm=17.222816467285156, loss=1.5846948623657227, param_norm=1886.964599609375
Step 79: grad_norm=12.12568473815918, loss=1.7981317043304443, param_norm=1886.9649658203125
21:57:20.548 [I] Progress on: 79.0it/1.00kit rate:8.8s/it remaining:2:14:59 elapsed:11:59 postfix:- (286571:tqdm_logging.py:145)
Step 80: grad_norm=25.123355865478516, loss=1.8037508726119995, param_norm=1886.96533203125
Step 81: grad_norm=9.264294624328613, loss=1.6653382778167725, param_norm=1886.9656982421875
21:57:38.147 [I] Progress on: 81.0it/1.00kit rate:8.8s/it remaining:2:14:42 elapsed:12:17 postfix:- (286571:tqdm_logging.py:145)
Step 82: grad_norm=8.987682342529297, loss=1.909740686416626, param_norm=1886.966064453125
Step 83: grad_norm=12.976425170898438, loss=1.66280198097229, param_norm=1886.96630859375
21:57:55.699 [I] Progress on: 83.0it/1.00kit rate:8.8s/it remaining:2:14:13 elapsed:12:34 postfix:- (286571:tqdm_logging.py:145)
Step 84: grad_norm=18.231515884399414, loss=1.547768473625183, param_norm=1886.9666748046875
21:58:07.077 [I] Progress on: 84.0it/1.00kit rate:9.6s/it remaining:2:25:59 elapsed:12:46 postfix:- (286571:tqdm_logging.py:145)
Step 85: grad_norm=12.203595161437988, loss=1.5000638961791992, param_norm=1886.9671630859375
Step 86: grad_norm=17.910079956054688, loss=1.6287727355957031, param_norm=1886.967529296875
21:58:24.629 [I] Progress on: 86.0it/1.00kit rate:9.2s/it remaining:2:19:39 elapsed:13:03 postfix:- (286571:tqdm_logging.py:145)
Step 87: grad_norm=6.209261417388916, loss=1.6854569911956787, param_norm=1886.9678955078125
Step 88: grad_norm=8.522971153259277, loss=1.4930040836334229, param_norm=1886.96826171875
21:58:42.237 [I] Progress on: 88.0it/1.00kit rate:9.0s/it remaining:2:16:42 elapsed:13:21 postfix:- (286571:tqdm_logging.py:145)
Step 89: grad_norm=15.400527954101562, loss=1.4962104558944702, param_norm=1886.96875
Step 90: grad_norm=6.618750095367432, loss=1.5651118755340576, param_norm=1886.96923828125
21:58:59.795 [I] Progress on: 90.0it/1.00kit rate:8.9s/it remaining:2:14:51 elapsed:13:38 postfix:- (286571:tqdm_logging.py:145)
Step 91: grad_norm=13.292010307312012, loss=1.483323097229004, param_norm=1886.9696044921875
Step 92: grad_norm=7.470506191253662, loss=1.6033893823623657, param_norm=1886.9700927734375
21:59:17.447 [I] Progress on: 92.0it/1.00kit rate:8.9s/it remaining:2:14:10 elapsed:13:56 postfix:- (286571:tqdm_logging.py:145)
Step 93: grad_norm=6.018866539001465, loss=1.6267192363739014, param_norm=1886.970458984375
Step 94: grad_norm=6.600002288818359, loss=1.7024636268615723, param_norm=1886.9708251953125
21:59:34.996 [I] Progress on: 94.0it/1.00kit rate:8.8s/it remaining:2:13:19 elapsed:14:14 postfix:- (286571:tqdm_logging.py:145)
Step 95: grad_norm=6.109842777252197, loss=1.5120160579681396, param_norm=1886.97119140625
Step 96: grad_norm=9.042974472045898, loss=1.4558238983154297, param_norm=1886.9718017578125
21:59:52.635 [I] Progress on: 96.0it/1.00kit rate:8.8s/it remaining:2:13:05 elapsed:14:31 postfix:- (286571:tqdm_logging.py:145)
Step 97: grad_norm=11.031132698059082, loss=1.6110942363739014, param_norm=1886.9722900390625
Step 98: grad_norm=6.806958198547363, loss=1.5201153755187988, param_norm=1886.97265625
22:00:10.247 [I] Progress on: 98.0it/1.00kit rate:8.8s/it remaining:2:12:43 elapsed:14:49 postfix:- (286571:tqdm_logging.py:145)
Step 99: grad_norm=6.620977878570557, loss=1.6497619152069092, param_norm=1886.9732666015625
Step 100: grad_norm=15.280099868774414, loss=1.5018929243087769, param_norm=1886.9737548828125
22:00:27.913 [I] Progress on: 100it/1.00kit rate:8.8s/it remaining:2:12:38 elapsed:15:07 postfix:- (286571:tqdm_logging.py:145)
22:00:28.029 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
22:00:28.030 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (286571:checkpoint_manager.py:1767)
22:00:28.030 [I] [process=0] Saving checkpoint at step 100                                        (286571:checkpoint_manager.py:1286)
22:00:28.031 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100. (286571:async_checkpointer.py:358)
22:00:28.033 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:00:28.033 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0 (286571:atomicity.py:144)
22:00:28.034 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:00:28.035 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:00:28.036 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742868028034313775, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742868028034313775, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (286571:checkpoint.py:185)
22:00:28.037 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (286571:atomicity.py:144)
22:00:28.037 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (286571:atomicity.py:144)
22:00:28.038 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:00:28.048 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
22:00:31.635 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
22:00:31.636 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:00:31.637 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
22:00:31.639 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
22:00:31.645 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
22:00:31.646 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
22:00:31.648 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
22:00:31.658 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742868028.0297432, 'wait_for_prev_duration_secs': 0.00046539306640625, 'checkpointer_blocking_start_time': 1742868028.0309854, 'checkpointer_blocking_duration_secs': 3.6145830154418945, 'get_old_steps_start_time': 1742868031.6456602, 'get_old_steps_duration_secs': 1.621246337890625e-05, 'checkpoint_manager_blocking_start_time': 1742868028.0295126, 'checkpoint_manager_blocking_duration_secs': 3.628459930419922} (286571:standard_logger.py:34)
22:00:39.907 [I] ChainedFuture completed 1/1 futures in 8.26 seconds.                             (286571:future.py:137)
22:00:39.907 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 873.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:00:39.908 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
22:00:39.908 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742868028034313775, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (286571:checkpoint.py:225)
22:00:39.911 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0 (286571:async_checkpointer.py:406)
22:00:39.911 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/assets (286571:atomicity.py:287)
22:00:39.914 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742868028034313775, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (286571:checkpoint.py:244)
22:00:39.923 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0/params (286571:atomicity.py:287)
22:00:39.923 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100 (286571:async_checkpointer.py:416)
22:00:39.924 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0 (286571:async_checkpointer.py:426)
22:00:39.924 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100 (286571:atomicity.py:287)
22:00:39.926 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/100`. (286571:atomicity.py:548)
22:00:39.926 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
22:00:39.927 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
22:00:39.927 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
22:00:39.927 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
22:00:39.928 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 101: grad_norm=17.67339324951172, loss=1.4457370042800903, param_norm=1886.9742431640625
22:00:40.238 [I] Progress on: 101it/1.00kit rate:9.9s/it remaining:2:28:12 elapsed:15:19 postfix:- (286571:tqdm_logging.py:145)
Step 102: grad_norm=11.667089462280273, loss=1.5906031131744385, param_norm=1886.9747314453125
Step 103: grad_norm=11.349923133850098, loss=1.5565886497497559, param_norm=1886.9752197265625
22:00:57.807 [I] Progress on: 103it/1.00kit rate:9.3s/it remaining:2:19:18 elapsed:15:37 postfix:- (286571:tqdm_logging.py:145)
Step 104: grad_norm=6.483226776123047, loss=1.5506932735443115, param_norm=1886.9757080078125
22:01:09.175 [I] Progress on: 105it/1.00kit rate:9.8s/it remaining:2:25:28 elapsed:15:48 postfix:- (286571:tqdm_logging.py:145)
Step 105: grad_norm=12.548662185668945, loss=1.5403821468353271, param_norm=1886.9761962890625
Step 106: grad_norm=10.663089752197266, loss=1.3078049421310425, param_norm=1886.9765625
22:01:26.532 [I] Progress on: 106it/1.00kit rate:9.5s/it remaining:2:20:59 elapsed:16:05 postfix:- (286571:tqdm_logging.py:145)
Step 107: grad_norm=5.795936107635498, loss=1.3329834938049316, param_norm=1886.9769287109375
Step 108: grad_norm=14.836636543273926, loss=1.2849613428115845, param_norm=1886.9774169921875
22:01:44.083 [I] Progress on: 108it/1.00kit rate:9.1s/it remaining:2:15:28 elapsed:16:23 postfix:- (286571:tqdm_logging.py:145)
Step 109: grad_norm=5.382784366607666, loss=1.4635580778121948, param_norm=1886.977783203125
Step 110: grad_norm=9.286931037902832, loss=1.216929316520691, param_norm=1886.978271484375
22:02:01.653 [I] Progress on: 110it/1.00kit rate:8.9s/it remaining:2:12:43 elapsed:16:40 postfix:- (286571:tqdm_logging.py:145)
Step 111: grad_norm=13.832818031311035, loss=1.3224596977233887, param_norm=1886.978759765625
Step 112: grad_norm=8.442586898803711, loss=1.368105411529541, param_norm=1886.9793701171875
22:02:19.208 [I] Progress on: 112it/1.00kit rate:8.9s/it remaining:2:11:08 elapsed:16:58 postfix:- (286571:tqdm_logging.py:145)
Step 113: grad_norm=10.16846752166748, loss=1.3548476696014404, param_norm=1886.9798583984375
Step 114: grad_norm=10.847689628601074, loss=1.3475193977355957, param_norm=1886.9803466796875
22:02:36.752 [I] Progress on: 114it/1.00kit rate:8.8s/it remaining:2:10:15 elapsed:17:15 postfix:- (286571:tqdm_logging.py:145)
Step 115: grad_norm=6.945526123046875, loss=1.3394526243209839, param_norm=1886.9808349609375
Step 116: grad_norm=7.209680557250977, loss=1.328536033630371, param_norm=1886.9814453125
22:02:54.338 [I] Progress on: 116it/1.00kit rate:8.8s/it remaining:2:09:46 elapsed:17:33 postfix:- (286571:tqdm_logging.py:145)
Step 117: grad_norm=7.220470428466797, loss=1.3071999549865723, param_norm=1886.9818115234375
Step 118: grad_norm=8.605142593383789, loss=1.2971000671386719, param_norm=1886.982421875
22:03:11.914 [I] Progress on: 118it/1.00kit rate:8.8s/it remaining:2:09:24 elapsed:17:51 postfix:- (286571:tqdm_logging.py:145)
Step 119: grad_norm=6.877408027648926, loss=1.5149829387664795, param_norm=1886.9827880859375
Step 120: grad_norm=5.690934181213379, loss=1.2778631448745728, param_norm=1886.9832763671875
22:03:29.466 [I] Progress on: 120it/1.00kit rate:8.8s/it remaining:2:08:55 elapsed:18:08 postfix:- (286571:tqdm_logging.py:145)
Step 121: grad_norm=10.51464557647705, loss=1.4414572715759277, param_norm=1886.9837646484375
Step 122: grad_norm=12.981948852539062, loss=1.2820522785186768, param_norm=1886.9842529296875
22:03:47.026 [I] Progress on: 122it/1.00kit rate:8.8s/it remaining:2:08:36 elapsed:18:26 postfix:- (286571:tqdm_logging.py:145)
Step 123: grad_norm=15.131977081298828, loss=1.3612207174301147, param_norm=1886.9847412109375
Step 124: grad_norm=11.738858222961426, loss=1.2257332801818848, param_norm=1886.9852294921875
22:04:04.613 [I] Progress on: 124it/1.00kit rate:8.8s/it remaining:2:08:20 elapsed:18:43 postfix:- (286571:tqdm_logging.py:145)
Step 125: grad_norm=7.716494083404541, loss=1.3238821029663086, param_norm=1886.9857177734375
22:04:15.897 [I] Progress on: 126it/1.00kit rate:9.5s/it remaining:2:18:09 elapsed:18:55 postfix:- (286571:tqdm_logging.py:145)
Step 126: grad_norm=7.300778388977051, loss=1.2158132791519165, param_norm=1886.9862060546875
Step 127: grad_norm=10.841991424560547, loss=1.253443717956543, param_norm=1886.9866943359375
22:04:33.242 [I] Progress on: 127it/1.00kit rate:9.3s/it remaining:2:14:49 elapsed:19:12 postfix:- (286571:tqdm_logging.py:145)
Step 128: grad_norm=13.811145782470703, loss=1.023706078529358, param_norm=1886.9871826171875
Step 129: grad_norm=11.623948097229004, loss=1.1711370944976807, param_norm=1886.987548828125
22:04:50.799 [I] Progress on: 129it/1.00kit rate:9.0s/it remaining:2:10:49 elapsed:19:29 postfix:- (286571:tqdm_logging.py:145)
Step 130: grad_norm=10.406105995178223, loss=1.0725266933441162, param_norm=1886.9881591796875
Step 131: grad_norm=6.863949298858643, loss=0.9991180896759033, param_norm=1886.988525390625
22:05:08.442 [I] Progress on: 131it/1.00kit rate:8.9s/it remaining:2:09:09 elapsed:19:47 postfix:- (286571:tqdm_logging.py:145)
Step 132: grad_norm=11.613475799560547, loss=1.048882007598877, param_norm=1886.989013671875
Step 133: grad_norm=6.266249656677246, loss=1.2001774311065674, param_norm=1886.989501953125
22:05:25.998 [I] Progress on: 133it/1.00kit rate:8.8s/it remaining:2:07:47 elapsed:20:05 postfix:- (286571:tqdm_logging.py:145)
Step 134: grad_norm=9.155121803283691, loss=1.098069667816162, param_norm=1886.98974609375
Step 135: grad_norm=5.634613513946533, loss=1.1012156009674072, param_norm=1886.9903564453125
22:05:43.563 [I] Progress on: 135it/1.00kit rate:8.8s/it remaining:2:07:01 elapsed:20:22 postfix:- (286571:tqdm_logging.py:145)
Step 136: grad_norm=8.79688549041748, loss=1.2442922592163086, param_norm=1886.99072265625
Step 137: grad_norm=9.66324520111084, loss=1.17690110206604, param_norm=1886.9912109375
22:06:01.137 [I] Progress on: 137it/1.00kit rate:8.8s/it remaining:2:06:29 elapsed:20:40 postfix:- (286571:tqdm_logging.py:145)
Step 138: grad_norm=8.341975212097168, loss=1.1498687267303467, param_norm=1886.99169921875
Step 139: grad_norm=6.373127460479736, loss=1.1782219409942627, param_norm=1886.9921875
22:06:18.710 [I] Progress on: 139it/1.00kit rate:8.8s/it remaining:2:06:06 elapsed:20:57 postfix:- (286571:tqdm_logging.py:145)
Step 140: grad_norm=17.46544647216797, loss=1.1599745750427246, param_norm=1886.9925537109375
Step 141: grad_norm=7.795068740844727, loss=1.0887374877929688, param_norm=1886.9931640625
22:06:36.272 [I] Progress on: 141it/1.00kit rate:8.8s/it remaining:2:05:43 elapsed:21:15 postfix:- (286571:tqdm_logging.py:145)
Step 142: grad_norm=15.968576431274414, loss=1.1492691040039062, param_norm=1886.99365234375
Step 143: grad_norm=8.837483406066895, loss=1.1746037006378174, param_norm=1886.994140625
22:06:53.849 [I] Progress on: 143it/1.00kit rate:8.8s/it remaining:2:05:27 elapsed:21:33 postfix:- (286571:tqdm_logging.py:145)
Step 144: grad_norm=7.562184810638428, loss=1.180890440940857, param_norm=1886.9945068359375
Step 145: grad_norm=6.895069599151611, loss=1.2250432968139648, param_norm=1886.9951171875
22:07:11.416 [I] Progress on: 145it/1.00kit rate:8.8s/it remaining:2:05:08 elapsed:21:50 postfix:- (286571:tqdm_logging.py:145)
Step 146: grad_norm=6.782510757446289, loss=1.2002339363098145, param_norm=1886.9954833984375
22:07:22.633 [I] Progress on: 147it/1.00kit rate:9.5s/it remaining:2:14:23 elapsed:22:01 postfix:- (286571:tqdm_logging.py:145)
Step 147: grad_norm=11.525928497314453, loss=0.9928169250488281, param_norm=1886.9959716796875
Step 148: grad_norm=7.696363925933838, loss=0.9770805835723877, param_norm=1886.996337890625
22:07:40.025 [I] Progress on: 148it/1.00kit rate:9.3s/it remaining:2:11:28 elapsed:22:19 postfix:- (286571:tqdm_logging.py:145)
Step 149: grad_norm=10.950008392333984, loss=0.9336907863616943, param_norm=1886.996826171875
Step 150: grad_norm=6.421950340270996, loss=1.0629160404205322, param_norm=1886.9971923828125
22:07:57.669 [I] Progress on: 150it/1.00kit rate:9.0s/it remaining:2:07:58 elapsed:22:36 postfix:- (286571:tqdm_logging.py:145)
Step 151: grad_norm=6.782487869262695, loss=0.9964909553527832, param_norm=1886.997802734375
Step 152: grad_norm=5.054891586303711, loss=0.8340450525283813, param_norm=1886.9981689453125
22:08:15.341 [I] Progress on: 152it/1.00kit rate:8.9s/it remaining:2:06:12 elapsed:22:54 postfix:- (286571:tqdm_logging.py:145)
Step 153: grad_norm=6.089975357055664, loss=0.8491421937942505, param_norm=1886.9986572265625
Step 154: grad_norm=7.278520107269287, loss=1.0616767406463623, param_norm=1886.9990234375
22:08:32.992 [I] Progress on: 154it/1.00kit rate:8.9s/it remaining:2:05:12 elapsed:23:12 postfix:- (286571:tqdm_logging.py:145)
Step 155: grad_norm=8.722552299499512, loss=1.0141806602478027, param_norm=1886.9996337890625
Step 156: grad_norm=6.723196506500244, loss=1.0586352348327637, param_norm=1887.0
22:08:50.641 [I] Progress on: 156it/1.00kit rate:8.9s/it remaining:2:04:32 elapsed:23:29 postfix:- (286571:tqdm_logging.py:145)
Step 157: grad_norm=6.510592937469482, loss=1.0338891744613647, param_norm=1887.00048828125
Step 158: grad_norm=5.9289655685424805, loss=1.0120432376861572, param_norm=1887.0010986328125
22:09:08.305 [I] Progress on: 158it/1.00kit rate:8.8s/it remaining:2:04:05 elapsed:23:47 postfix:- (286571:tqdm_logging.py:145)
Step 159: grad_norm=6.301335334777832, loss=0.924943745136261, param_norm=1887.0015869140625
Step 160: grad_norm=7.8047075271606445, loss=0.9237483739852905, param_norm=1887.0020751953125
22:09:25.988 [I] Progress on: 160it/1.00kit rate:8.8s/it remaining:2:03:46 elapsed:24:05 postfix:- (286571:tqdm_logging.py:145)
Step 161: grad_norm=9.624283790588379, loss=1.0589373111724854, param_norm=1887.0025634765625
Step 162: grad_norm=11.489530563354492, loss=1.0462133884429932, param_norm=1887.0030517578125
22:09:43.679 [I] Progress on: 162it/1.00kit rate:8.8s/it remaining:2:03:31 elapsed:24:22 postfix:- (286571:tqdm_logging.py:145)
Step 163: grad_norm=6.993255138397217, loss=1.0804705619812012, param_norm=1887.0035400390625
Step 164: grad_norm=10.94675064086914, loss=1.0244789123535156, param_norm=1887.00390625
22:10:01.371 [I] Progress on: 164it/1.00kit rate:8.8s/it remaining:2:03:14 elapsed:24:40 postfix:- (286571:tqdm_logging.py:145)
Step 165: grad_norm=7.5609049797058105, loss=0.9829308986663818, param_norm=1887.00439453125
Step 166: grad_norm=14.806753158569336, loss=1.023964285850525, param_norm=1887.0047607421875
22:10:19.098 [I] Progress on: 166it/1.00kit rate:8.8s/it remaining:2:02:57 elapsed:24:58 postfix:- (286571:tqdm_logging.py:145)
Step 167: grad_norm=17.359670639038086, loss=1.0135085582733154, param_norm=1887.005126953125
22:10:30.426 [I] Progress on: 168it/1.00kit rate:9.5s/it remaining:2:12:08 elapsed:25:09 postfix:- (286571:tqdm_logging.py:145)
Step 168: grad_norm=5.78272819519043, loss=0.8802763223648071, param_norm=1887.005615234375
Step 169: grad_norm=9.211795806884766, loss=0.9128472805023193, param_norm=1887.0059814453125
22:10:47.893 [I] Progress on: 169it/1.00kit rate:9.3s/it remaining:2:09:08 elapsed:25:27 postfix:- (286571:tqdm_logging.py:145)
Step 170: grad_norm=8.299220085144043, loss=1.0468498468399048, param_norm=1887.00634765625
Step 171: grad_norm=16.45566749572754, loss=0.9436321258544922, param_norm=1887.0067138671875
22:11:05.593 [I] Progress on: 171it/1.00kit rate:9.1s/it remaining:2:05:27 elapsed:25:44 postfix:- (286571:tqdm_logging.py:145)
Step 172: grad_norm=21.00124168395996, loss=0.8880108594894409, param_norm=1887.0069580078125
Step 173: grad_norm=13.012419700622559, loss=0.924003541469574, param_norm=1887.0074462890625
22:11:23.288 [I] Progress on: 173it/1.00kit rate:9.0s/it remaining:2:03:31 elapsed:26:02 postfix:- (286571:tqdm_logging.py:145)
Step 174: grad_norm=5.461578369140625, loss=0.9967321753501892, param_norm=1887.0076904296875
Step 175: grad_norm=6.086115837097168, loss=0.9827902317047119, param_norm=1887.008056640625
22:11:40.988 [I] Progress on: 175it/1.00kit rate:8.9s/it remaining:2:02:23 elapsed:26:20 postfix:- (286571:tqdm_logging.py:145)
Step 176: grad_norm=9.88062858581543, loss=1.0098240375518799, param_norm=1887.0084228515625
Step 177: grad_norm=5.197757244110107, loss=0.8629004955291748, param_norm=1887.0087890625
22:11:58.702 [I] Progress on: 177it/1.00kit rate:8.9s/it remaining:2:01:46 elapsed:26:37 postfix:- (286571:tqdm_logging.py:145)
Step 178: grad_norm=7.3072004318237305, loss=0.8847219347953796, param_norm=1887.0091552734375
Step 179: grad_norm=10.474553108215332, loss=0.9208386540412903, param_norm=1887.0096435546875
22:12:16.412 [I] Progress on: 179it/1.00kit rate:8.9s/it remaining:2:01:18 elapsed:26:55 postfix:- (286571:tqdm_logging.py:145)
Step 180: grad_norm=9.127665519714355, loss=0.7197104692459106, param_norm=1887.0101318359375
Step 181: grad_norm=8.880584716796875, loss=0.946560263633728, param_norm=1887.010498046875
22:12:34.122 [I] Progress on: 181it/1.00kit rate:8.9s/it remaining:2:00:55 elapsed:27:13 postfix:- (286571:tqdm_logging.py:145)
Step 182: grad_norm=9.847076416015625, loss=1.0280115604400635, param_norm=1887.0108642578125
Step 183: grad_norm=5.598395824432373, loss=0.8775728940963745, param_norm=1887.01123046875
22:12:51.849 [I] Progress on: 183it/1.00kit rate:8.9s/it remaining:2:00:37 elapsed:27:31 postfix:- (286571:tqdm_logging.py:145)
Step 184: grad_norm=8.659664154052734, loss=0.9457435011863708, param_norm=1887.011474609375
Step 185: grad_norm=7.658890724182129, loss=0.9434682726860046, param_norm=1887.011962890625
22:13:09.603 [I] Progress on: 185it/1.00kit rate:8.9s/it remaining:2:00:29 elapsed:27:48 postfix:- (286571:tqdm_logging.py:145)
Step 186: grad_norm=8.7498197555542, loss=0.8841198682785034, param_norm=1887.01220703125
Step 187: grad_norm=8.307875633239746, loss=0.8104921579360962, param_norm=1887.0126953125
22:13:27.331 [I] Progress on: 187it/1.00kit rate:8.9s/it remaining:2:00:07 elapsed:28:06 postfix:- (286571:tqdm_logging.py:145)
Step 188: grad_norm=5.620304584503174, loss=0.9069855809211731, param_norm=1887.0130615234375
22:13:38.250 [I] Progress on: 189it/1.00kit rate:9.4s/it remaining:2:07:13 elapsed:28:17 postfix:- (286571:tqdm_logging.py:145)
Step 189: grad_norm=7.754982948303223, loss=0.7759175300598145, param_norm=1887.0135498046875
Step 190: grad_norm=7.011074542999268, loss=0.9021905660629272, param_norm=1887.0140380859375
22:13:55.766 [I] Progress on: 190it/1.00kit rate:9.3s/it remaining:2:04:52 elapsed:28:34 postfix:- (286571:tqdm_logging.py:145)
Step 191: grad_norm=4.39695930480957, loss=0.7039858102798462, param_norm=1887.014404296875
Step 192: grad_norm=6.334095001220703, loss=0.836819052696228, param_norm=1887.014892578125
22:14:13.497 [I] Progress on: 192it/1.00kit rate:9.1s/it remaining:2:01:57 elapsed:28:52 postfix:- (286571:tqdm_logging.py:145)
Step 193: grad_norm=6.454408168792725, loss=0.8069195747375488, param_norm=1887.0152587890625
Step 194: grad_norm=12.35228157043457, loss=0.8257478475570679, param_norm=1887.0157470703125
22:14:31.241 [I] Progress on: 194it/1.00kit rate:9.0s/it remaining:2:00:24 elapsed:29:10 postfix:- (286571:tqdm_logging.py:145)
Step 195: grad_norm=6.278489589691162, loss=0.7988591194152832, param_norm=1887.0159912109375
Step 196: grad_norm=8.787540435791016, loss=0.873100221157074, param_norm=1887.0164794921875
22:14:49.019 [I] Progress on: 196it/1.00kit rate:8.9s/it remaining:1:59:35 elapsed:29:28 postfix:- (286571:tqdm_logging.py:145)
Step 197: grad_norm=8.195548057556152, loss=0.9066946506500244, param_norm=1887.0169677734375
Step 198: grad_norm=9.4674711227417, loss=0.9529638290405273, param_norm=1887.0174560546875
22:15:06.759 [I] Progress on: 198it/1.00kit rate:8.9s/it remaining:1:58:56 elapsed:29:45 postfix:- (286571:tqdm_logging.py:145)
Step 199: grad_norm=6.845713138580322, loss=0.792811393737793, param_norm=1887.017822265625
Step 200: grad_norm=7.579988479614258, loss=0.8068583607673645, param_norm=1887.018310546875
22:15:24.493 [I] Progress on: 200it/1.00kit rate:8.9s/it remaining:1:58:26 elapsed:30:03 postfix:- (286571:tqdm_logging.py:145)
22:15:24.713 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
22:15:24.713 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
22:15:24.713 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (286571:checkpoint_manager.py:1786)
22:15:24.714 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (286571:checkpoint_manager.py:1817)
22:15:24.714 [I] [process=0] Saving checkpoint at step 200                                        (286571:checkpoint_manager.py:1286)
22:15:24.715 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200. (286571:async_checkpointer.py:358)
22:15:24.716 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:15:24.717 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3 (286571:atomicity.py:144)
22:15:24.717 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:15:24.718 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:15:24.719 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (286571:atomicity.py:144)
22:15:24.719 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (286571:atomicity.py:144)
22:15:24.719 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:15:24.725 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
22:15:28.323 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
22:15:28.325 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:15:28.326 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
22:15:28.327 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
22:15:28.355 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
22:15:28.359 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
22:15:28.362 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
22:15:28.364 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
22:15:28.364 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742868924.7133904, 'wait_for_prev_duration_secs': 0.0007143020629882812, 'checkpointer_blocking_start_time': 1742868924.714746, 'checkpointer_blocking_duration_secs': 3.6403188705444336, 'get_old_steps_start_time': 1742868928.3551273, 'get_old_steps_duration_secs': 0.004319906234741211, 'checkpoint_manager_blocking_start_time': 1742868924.7131991, 'checkpoint_manager_blocking_duration_secs': 3.651291608810425} (286571:standard_logger.py:34)
22:15:35.289 [I] ChainedFuture completed 1/1 futures in 6.95 seconds.                             (286571:future.py:137)
22:15:35.290 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 980.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:15:35.291 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
22:15:35.292 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3 (286571:async_checkpointer.py:406)
22:15:35.293 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3/assets (286571:atomicity.py:287)
22:15:35.304 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3/params (286571:atomicity.py:287)
22:15:35.304 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200 (286571:async_checkpointer.py:416)
22:15:35.305 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3 (286571:async_checkpointer.py:426)
22:15:35.305 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200 (286571:atomicity.py:287)
22:15:35.306 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/200`. (286571:atomicity.py:548)
22:15:35.306 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
22:15:35.307 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
22:15:35.307 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
22:15:35.308 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
22:15:35.308 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 201: grad_norm=9.819931030273438, loss=0.8471335768699646, param_norm=1887.018798828125
22:15:36.996 [I] Progress on: 201it/1.00kit rate:10.0s/it remaining:2:12:47 elapsed:30:16 postfix:- (286571:tqdm_logging.py:145)
Step 202: grad_norm=4.620934963226318, loss=0.8010410070419312, param_norm=1887.019287109375
Step 203: grad_norm=10.685925483703613, loss=0.985302746295929, param_norm=1887.0196533203125
22:15:54.840 [I] Progress on: 203it/1.00kit rate:9.4s/it remaining:2:05:18 elapsed:30:34 postfix:- (286571:tqdm_logging.py:145)
Step 204: grad_norm=5.140300750732422, loss=0.8040118217468262, param_norm=1887.02001953125
Step 205: grad_norm=7.2598419189453125, loss=0.8073450922966003, param_norm=1887.0205078125
22:16:12.610 [I] Progress on: 205it/1.00kit rate:9.2s/it remaining:2:01:15 elapsed:30:51 postfix:- (286571:tqdm_logging.py:145)
Step 206: grad_norm=6.119839191436768, loss=0.8756765127182007, param_norm=1887.0211181640625
Step 207: grad_norm=11.077975273132324, loss=0.7484961748123169, param_norm=1887.021484375
22:16:30.377 [I] Progress on: 207it/1.00kit rate:9.0s/it remaining:1:59:09 elapsed:31:09 postfix:- (286571:tqdm_logging.py:145)
Step 208: grad_norm=8.127999305725098, loss=0.7845308780670166, param_norm=1887.0218505859375
Step 209: grad_norm=5.320024490356445, loss=0.8154568076133728, param_norm=1887.022216796875
22:16:48.137 [I] Progress on: 209it/1.00kit rate:8.9s/it remaining:1:57:57 elapsed:31:27 postfix:- (286571:tqdm_logging.py:145)
Step 210: grad_norm=6.921377182006836, loss=0.7149496078491211, param_norm=1887.0225830078125
22:16:59.446 [I] Progress on: 210it/1.00kit rate:9.7s/it remaining:2:07:12 elapsed:31:38 postfix:- (286571:tqdm_logging.py:145)
Step 211: grad_norm=9.103714942932129, loss=0.8226726651191711, param_norm=1887.02294921875
Step 212: grad_norm=5.075764179229736, loss=0.7271109819412231, param_norm=1887.0234375
22:17:17.198 [I] Progress on: 212it/1.00kit rate:9.3s/it remaining:2:01:45 elapsed:31:56 postfix:- (286571:tqdm_logging.py:145)
Step 213: grad_norm=18.444847106933594, loss=0.9009979367256165, param_norm=1887.023681640625
Step 214: grad_norm=5.705145835876465, loss=0.7660962343215942, param_norm=1887.0242919921875
22:17:34.969 [I] Progress on: 214it/1.00kit rate:9.1s/it remaining:1:59:02 elapsed:32:14 postfix:- (286571:tqdm_logging.py:145)
Step 215: grad_norm=6.294088840484619, loss=0.8351510167121887, param_norm=1887.024658203125
Step 216: grad_norm=4.825020790100098, loss=0.7666258215904236, param_norm=1887.0250244140625
22:17:52.745 [I] Progress on: 216it/1.00kit rate:9.0s/it remaining:1:57:33 elapsed:32:31 postfix:- (286571:tqdm_logging.py:145)
Step 217: grad_norm=5.581448078155518, loss=0.7681116461753845, param_norm=1887.0255126953125
Step 218: grad_norm=8.463126182556152, loss=0.7742044925689697, param_norm=1887.02587890625
22:18:10.523 [I] Progress on: 218it/1.00kit rate:9.0s/it remaining:1:56:43 elapsed:32:49 postfix:- (286571:tqdm_logging.py:145)
Step 219: grad_norm=4.681196689605713, loss=0.7050063610076904, param_norm=1887.0262451171875
Step 220: grad_norm=5.445631504058838, loss=0.6997480392456055, param_norm=1887.0267333984375
22:18:28.288 [I] Progress on: 220it/1.00kit rate:8.9s/it remaining:1:56:07 elapsed:33:07 postfix:- (286571:tqdm_logging.py:145)
Step 221: grad_norm=6.589702129364014, loss=0.8112024068832397, param_norm=1887.0269775390625
Step 222: grad_norm=8.218441009521484, loss=0.8414705395698547, param_norm=1887.02734375
22:18:46.070 [I] Progress on: 222it/1.00kit rate:8.9s/it remaining:1:55:40 elapsed:33:25 postfix:- (286571:tqdm_logging.py:145)
Step 223: grad_norm=9.917193412780762, loss=0.8660600781440735, param_norm=1887.0277099609375
Step 224: grad_norm=5.983428478240967, loss=0.8312544226646423, param_norm=1887.028076171875
22:19:03.841 [I] Progress on: 224it/1.00kit rate:8.9s/it remaining:1:55:19 elapsed:33:43 postfix:- (286571:tqdm_logging.py:145)
Step 225: grad_norm=13.664294242858887, loss=0.7962585687637329, param_norm=1887.0284423828125
Step 226: grad_norm=12.217658996582031, loss=0.756630003452301, param_norm=1887.0289306640625
22:19:21.622 [I] Progress on: 226it/1.00kit rate:8.9s/it remaining:1:55:00 elapsed:34:00 postfix:- (286571:tqdm_logging.py:145)
Step 227: grad_norm=6.12748384475708, loss=0.7018414735794067, param_norm=1887.029296875
Step 228: grad_norm=7.419896602630615, loss=0.7943431735038757, param_norm=1887.0296630859375
22:19:39.401 [I] Progress on: 228it/1.00kit rate:8.9s/it remaining:1:54:42 elapsed:34:18 postfix:- (286571:tqdm_logging.py:145)
Step 229: grad_norm=6.3381667137146, loss=0.6928673982620239, param_norm=1887.0299072265625
Step 230: grad_norm=4.085350513458252, loss=0.6450567841529846, param_norm=1887.0303955078125
22:19:57.042 [I] Progress on: 230it/1.00kit rate:8.9s/it remaining:1:53:50 elapsed:34:36 postfix:- (286571:tqdm_logging.py:145)
Step 231: grad_norm=8.24124526977539, loss=0.6315692663192749, param_norm=1887.0306396484375
22:20:08.131 [I] Progress on: 231it/1.00kit rate:9.5s/it remaining:2:02:16 elapsed:34:47 postfix:- (286571:tqdm_logging.py:145)
Step 232: grad_norm=12.862385749816895, loss=0.7474079132080078, param_norm=1887.0308837890625
Step 233: grad_norm=11.42943000793457, loss=0.751575231552124, param_norm=1887.0311279296875
22:20:25.911 [I] Progress on: 233it/1.00kit rate:9.2s/it remaining:1:57:43 elapsed:35:05 postfix:- (286571:tqdm_logging.py:145)
Step 234: grad_norm=6.870401382446289, loss=0.6824196577072144, param_norm=1887.031494140625
Step 235: grad_norm=6.364802360534668, loss=0.7251664996147156, param_norm=1887.0316162109375
22:20:43.706 [I] Progress on: 235it/1.00kit rate:9.1s/it remaining:1:55:23 elapsed:35:22 postfix:- (286571:tqdm_logging.py:145)
Step 236: grad_norm=10.781009674072266, loss=0.7653376460075378, param_norm=1887.0321044921875
Step 237: grad_norm=6.444928169250488, loss=0.6626302003860474, param_norm=1887.0323486328125
22:21:01.488 [I] Progress on: 237it/1.00kit rate:9.0s/it remaining:1:54:03 elapsed:35:40 postfix:- (286571:tqdm_logging.py:145)
Step 238: grad_norm=4.612607955932617, loss=0.8025944828987122, param_norm=1887.0325927734375
Step 239: grad_norm=6.229160785675049, loss=0.685569703578949, param_norm=1887.032958984375
22:21:19.256 [I] Progress on: 239it/1.00kit rate:8.9s/it remaining:1:53:10 elapsed:35:58 postfix:- (286571:tqdm_logging.py:145)
Step 240: grad_norm=4.383265495300293, loss=0.7602127194404602, param_norm=1887.033203125
Step 241: grad_norm=5.815593719482422, loss=0.7378993630409241, param_norm=1887.0335693359375
22:21:37.012 [I] Progress on: 241it/1.00kit rate:8.9s/it remaining:1:52:35 elapsed:36:16 postfix:- (286571:tqdm_logging.py:145)
Step 242: grad_norm=5.616775035858154, loss=0.7166436910629272, param_norm=1887.033935546875
Step 243: grad_norm=6.406033515930176, loss=0.6493282318115234, param_norm=1887.0343017578125
22:21:54.768 [I] Progress on: 243it/1.00kit rate:8.9s/it remaining:1:52:08 elapsed:36:33 postfix:- (286571:tqdm_logging.py:145)
Step 244: grad_norm=4.547516822814941, loss=0.701532781124115, param_norm=1887.03466796875
Step 245: grad_norm=14.353248596191406, loss=0.6497507095336914, param_norm=1887.0350341796875
22:22:12.525 [I] Progress on: 245it/1.00kit rate:8.9s/it remaining:1:51:47 elapsed:36:51 postfix:- (286571:tqdm_logging.py:145)
Step 246: grad_norm=8.856919288635254, loss=0.8368226289749146, param_norm=1887.035400390625
Step 247: grad_norm=6.749025821685791, loss=0.653314471244812, param_norm=1887.03564453125
22:22:30.280 [I] Progress on: 247it/1.00kit rate:8.9s/it remaining:1:51:26 elapsed:37:09 postfix:- (286571:tqdm_logging.py:145)
Step 248: grad_norm=6.29834508895874, loss=0.7255393266677856, param_norm=1887.0360107421875
Step 249: grad_norm=6.890755653381348, loss=0.6943732500076294, param_norm=1887.036376953125
22:22:48.040 [I] Progress on: 249it/1.00kit rate:8.9s/it remaining:1:51:07 elapsed:37:27 postfix:- (286571:tqdm_logging.py:145)
Step 250: grad_norm=6.1791768074035645, loss=0.725784420967102, param_norm=1887.036865234375
Step 251: grad_norm=5.529123783111572, loss=0.6997800469398499, param_norm=1887.037109375
22:23:05.791 [I] Progress on: 251it/1.00kit rate:8.9s/it remaining:1:50:49 elapsed:37:44 postfix:- (286571:tqdm_logging.py:145)
Step 252: grad_norm=3.5086441040039062, loss=0.5928641557693481, param_norm=1887.03759765625
22:23:16.643 [I] Progress on: 252it/1.00kit rate:9.5s/it remaining:1:58:07 elapsed:37:55 postfix:- (286571:tqdm_logging.py:145)
Step 253: grad_norm=4.285004615783691, loss=0.5794904828071594, param_norm=1887.0379638671875
Step 254: grad_norm=6.409744739532471, loss=0.5668085813522339, param_norm=1887.0384521484375
22:23:34.392 [I] Progress on: 254it/1.00kit rate:9.2s/it remaining:1:53:57 elapsed:38:13 postfix:- (286571:tqdm_logging.py:145)
Step 255: grad_norm=10.192684173583984, loss=0.7782055139541626, param_norm=1887.038818359375
Step 256: grad_norm=7.209238052368164, loss=0.6749911904335022, param_norm=1887.0390625
22:23:52.203 [I] Progress on: 256it/1.00kit rate:9.0s/it remaining:1:51:59 elapsed:38:31 postfix:- (286571:tqdm_logging.py:145)
Step 257: grad_norm=4.3246750831604, loss=0.6485316753387451, param_norm=1887.0394287109375
Step 258: grad_norm=6.460813522338867, loss=0.6694875955581665, param_norm=1887.0399169921875
22:24:09.996 [I] Progress on: 258it/1.00kit rate:9.0s/it remaining:1:50:50 elapsed:38:49 postfix:- (286571:tqdm_logging.py:145)
Step 259: grad_norm=9.85622501373291, loss=0.6462904214859009, param_norm=1887.0401611328125
Step 260: grad_norm=9.794341087341309, loss=0.6102176904678345, param_norm=1887.04052734375
22:24:27.776 [I] Progress on: 260it/1.00kit rate:8.9s/it remaining:1:50:04 elapsed:39:06 postfix:- (286571:tqdm_logging.py:145)
Step 261: grad_norm=15.725825309753418, loss=0.7126295566558838, param_norm=1887.0408935546875
Step 262: grad_norm=11.056724548339844, loss=0.5827370882034302, param_norm=1887.0411376953125
22:24:45.548 [I] Progress on: 262it/1.00kit rate:8.9s/it remaining:1:49:29 elapsed:39:24 postfix:- (286571:tqdm_logging.py:145)
Step 263: grad_norm=14.660120964050293, loss=0.85591059923172, param_norm=1887.0416259765625
Step 264: grad_norm=9.36679744720459, loss=0.8677462339401245, param_norm=1887.0419921875
22:25:03.290 [I] Progress on: 264it/1.00kit rate:8.9s/it remaining:1:49:03 elapsed:39:42 postfix:- (286571:tqdm_logging.py:145)
Step 265: grad_norm=5.558258056640625, loss=0.687272310256958, param_norm=1887.042236328125
Step 266: grad_norm=12.122627258300781, loss=0.8032771348953247, param_norm=1887.0426025390625
22:25:21.086 [I] Progress on: 266it/1.00kit rate:8.9s/it remaining:1:48:48 elapsed:40:00 postfix:- (286571:tqdm_logging.py:145)
Step 267: grad_norm=11.366067886352539, loss=0.6753539443016052, param_norm=1887.04296875
Step 268: grad_norm=7.791186809539795, loss=0.5805673599243164, param_norm=1887.0433349609375
22:25:38.864 [I] Progress on: 268it/1.00kit rate:8.9s/it remaining:1:48:30 elapsed:40:18 postfix:- (286571:tqdm_logging.py:145)
Step 269: grad_norm=10.722295761108398, loss=0.6692993640899658, param_norm=1887.0435791015625
Step 270: grad_norm=9.637022018432617, loss=0.7014256715774536, param_norm=1887.0438232421875
22:25:56.674 [I] Progress on: 270it/1.00kit rate:8.9s/it remaining:1:48:13 elapsed:40:35 postfix:- (286571:tqdm_logging.py:145)
Step 271: grad_norm=5.050324440002441, loss=0.6378943920135498, param_norm=1887.044189453125
Step 272: grad_norm=11.551618576049805, loss=0.6284524202346802, param_norm=1887.0445556640625
22:26:14.480 [I] Progress on: 272it/1.00kit rate:8.9s/it remaining:1:47:58 elapsed:40:53 postfix:- (286571:tqdm_logging.py:145)
Step 273: grad_norm=6.870384693145752, loss=0.5932140350341797, param_norm=1887.044921875
22:26:25.646 [I] Progress on: 273it/1.00kit rate:9.6s/it remaining:1:56:07 elapsed:41:04 postfix:- (286571:tqdm_logging.py:145)
Step 274: grad_norm=10.93122673034668, loss=0.5581263899803162, param_norm=1887.045166015625
Step 275: grad_norm=9.603354454040527, loss=0.5597267150878906, param_norm=1887.0455322265625
22:26:43.425 [I] Progress on: 275it/1.00kit rate:9.2s/it remaining:1:51:31 elapsed:41:22 postfix:- (286571:tqdm_logging.py:145)
Step 276: grad_norm=9.5353422164917, loss=0.6561421155929565, param_norm=1887.0458984375
Step 277: grad_norm=4.5603508949279785, loss=0.6220513582229614, param_norm=1887.0462646484375
22:27:01.217 [I] Progress on: 277it/1.00kit rate:9.1s/it remaining:1:49:08 elapsed:41:40 postfix:- (286571:tqdm_logging.py:145)
Step 278: grad_norm=6.0113749504089355, loss=0.550086259841919, param_norm=1887.046630859375
Step 279: grad_norm=7.03164005279541, loss=0.7253619432449341, param_norm=1887.0469970703125
22:27:19.026 [I] Progress on: 279it/1.00kit rate:9.0s/it remaining:1:47:53 elapsed:41:58 postfix:- (286571:tqdm_logging.py:145)
Step 280: grad_norm=8.645496368408203, loss=0.5846948623657227, param_norm=1887.0474853515625
Step 281: grad_norm=9.896875381469727, loss=0.5886176824569702, param_norm=1887.0477294921875
22:27:36.815 [I] Progress on: 281it/1.00kit rate:8.9s/it remaining:1:47:04 elapsed:42:16 postfix:- (286571:tqdm_logging.py:145)
Step 282: grad_norm=5.565791130065918, loss=0.5968581438064575, param_norm=1887.048095703125
Step 283: grad_norm=4.831237316131592, loss=0.6023941040039062, param_norm=1887.04833984375
22:27:54.609 [I] Progress on: 283it/1.00kit rate:8.9s/it remaining:1:46:31 elapsed:42:33 postfix:- (286571:tqdm_logging.py:145)
Step 284: grad_norm=5.891660213470459, loss=0.5600526332855225, param_norm=1887.0487060546875
Step 285: grad_norm=4.9825215339660645, loss=0.5672000050544739, param_norm=1887.049072265625
22:28:12.430 [I] Progress on: 285it/1.00kit rate:8.9s/it remaining:1:46:11 elapsed:42:51 postfix:- (286571:tqdm_logging.py:145)
Step 286: grad_norm=5.118019104003906, loss=0.5590090751647949, param_norm=1887.049560546875
Step 287: grad_norm=9.31544303894043, loss=0.5471035242080688, param_norm=1887.0498046875
22:28:30.249 [I] Progress on: 287it/1.00kit rate:8.9s/it remaining:1:45:54 elapsed:43:09 postfix:- (286571:tqdm_logging.py:145)
Step 288: grad_norm=8.854325294494629, loss=0.6038699150085449, param_norm=1887.05029296875
Step 289: grad_norm=6.0854172706604, loss=0.6318036317825317, param_norm=1887.050537109375
22:28:48.076 [I] Progress on: 289it/1.00kit rate:8.9s/it remaining:1:45:37 elapsed:43:27 postfix:- (286571:tqdm_logging.py:145)
Step 290: grad_norm=4.966127872467041, loss=0.4978654682636261, param_norm=1887.051025390625
Step 291: grad_norm=8.247057914733887, loss=0.619853675365448, param_norm=1887.05126953125
22:29:05.900 [I] Progress on: 291it/1.00kit rate:8.9s/it remaining:1:45:18 elapsed:43:45 postfix:- (286571:tqdm_logging.py:145)
Step 292: grad_norm=8.618911743164062, loss=0.511284589767456, param_norm=1887.0516357421875
Step 293: grad_norm=9.691400527954102, loss=0.6425117254257202, param_norm=1887.0518798828125
22:29:23.729 [I] Progress on: 293it/1.00kit rate:8.9s/it remaining:1:45:00 elapsed:44:02 postfix:- (286571:tqdm_logging.py:145)
Step 294: grad_norm=4.807779788970947, loss=0.4881784915924072, param_norm=1887.05224609375
22:29:34.902 [I] Progress on: 294it/1.00kit rate:9.6s/it remaining:1:52:56 elapsed:44:14 postfix:- (286571:tqdm_logging.py:145)
Step 295: grad_norm=4.440433025360107, loss=0.46765732765197754, param_norm=1887.052490234375
Step 296: grad_norm=6.945769309997559, loss=0.7192552089691162, param_norm=1887.052734375
22:29:52.697 [I] Progress on: 296it/1.00kit rate:9.2s/it remaining:1:48:23 elapsed:44:31 postfix:- (286571:tqdm_logging.py:145)
Step 297: grad_norm=3.9176759719848633, loss=0.5078203678131104, param_norm=1887.052978515625
Step 298: grad_norm=4.541993618011475, loss=0.5421922206878662, param_norm=1887.05322265625
22:30:10.504 [I] Progress on: 298it/1.00kit rate:9.1s/it remaining:1:46:04 elapsed:44:49 postfix:- (286571:tqdm_logging.py:145)
Step 299: grad_norm=8.154818534851074, loss=0.5727388858795166, param_norm=1887.0535888671875
Step 300: grad_norm=5.464354991912842, loss=0.4954187870025635, param_norm=1887.053955078125
22:30:28.302 [I] Progress on: 300it/1.00kit rate:9.0s/it remaining:1:44:48 elapsed:45:07 postfix:- (286571:tqdm_logging.py:145)
22:30:28.548 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
22:30:28.548 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
22:30:28.548 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (286571:checkpoint_manager.py:1786)
22:30:28.548 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (286571:checkpoint_manager.py:1817)
22:30:28.549 [I] [process=0] Saving checkpoint at step 300                                        (286571:checkpoint_manager.py:1286)
22:30:28.550 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300. (286571:async_checkpointer.py:358)
22:30:28.551 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:30:28.552 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6 (286571:atomicity.py:144)
22:30:28.552 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:30:28.553 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:30:28.554 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (286571:atomicity.py:144)
22:30:28.554 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (286571:atomicity.py:144)
22:30:28.555 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:30:28.560 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
22:30:32.164 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
22:30:32.166 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:30:32.168 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
22:30:32.172 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
22:30:32.197 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
22:30:32.200 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
22:30:32.202 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
22:30:32.204 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
22:30:32.207 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
22:30:32.208 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742869828.5481114, 'wait_for_prev_duration_secs': 0.0007569789886474609, 'checkpointer_blocking_start_time': 1742869828.5496292, 'checkpointer_blocking_duration_secs': 3.648016929626465, 'get_old_steps_start_time': 1742869832.1977248, 'get_old_steps_duration_secs': 0.0044400691986083984, 'checkpoint_manager_blocking_start_time': 1742869828.547921, 'checkpoint_manager_blocking_duration_secs': 3.66084885597229} (286571:standard_logger.py:34)
22:30:39.928 [I] ChainedFuture completed 1/1 futures in 7.75 seconds.                             (286571:future.py:137)
22:30:39.929 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 910.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:30:39.929 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
22:30:39.931 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6 (286571:async_checkpointer.py:406)
22:30:39.932 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6/assets (286571:atomicity.py:287)
22:30:39.942 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6/params (286571:atomicity.py:287)
22:30:39.943 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300 (286571:async_checkpointer.py:416)
22:30:39.944 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6 (286571:async_checkpointer.py:426)
22:30:39.944 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300 (286571:atomicity.py:287)
22:30:39.945 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/300`. (286571:atomicity.py:548)
22:30:39.946 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
22:30:39.946 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
22:30:39.947 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
22:30:39.947 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
22:30:39.947 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 301: grad_norm=4.394721984863281, loss=0.5317058563232422, param_norm=1887.05419921875
22:30:40.861 [I] Progress on: 301it/1.00kit rate:10.1s/it remaining:1:57:09 elapsed:45:20 postfix:- (286571:tqdm_logging.py:145)
Step 302: grad_norm=13.359232902526855, loss=0.6150482892990112, param_norm=1887.0545654296875
Step 303: grad_norm=11.77397632598877, loss=0.569433867931366, param_norm=1887.054931640625
22:30:58.603 [I] Progress on: 303it/1.00kit rate:9.5s/it remaining:1:49:50 elapsed:45:37 postfix:- (286571:tqdm_logging.py:145)
Step 304: grad_norm=9.35644817352295, loss=0.5142471790313721, param_norm=1887.0552978515625
Step 305: grad_norm=8.246371269226074, loss=0.6251591444015503, param_norm=1887.0555419921875
22:31:16.447 [I] Progress on: 305it/1.00kit rate:9.2s/it remaining:1:46:18 elapsed:45:55 postfix:- (286571:tqdm_logging.py:145)
Step 306: grad_norm=9.869390487670898, loss=0.4886438846588135, param_norm=1887.0557861328125
Step 307: grad_norm=4.615816593170166, loss=0.5704467296600342, param_norm=1887.05615234375
22:31:34.207 [I] Progress on: 307it/1.00kit rate:9.0s/it remaining:1:44:12 elapsed:46:13 postfix:- (286571:tqdm_logging.py:145)
Step 308: grad_norm=4.073406219482422, loss=0.5356115102767944, param_norm=1887.056396484375
Step 309: grad_norm=6.047362804412842, loss=0.5690752267837524, param_norm=1887.056640625
22:31:51.954 [I] Progress on: 309it/1.00kit rate:8.9s/it remaining:1:42:59 elapsed:46:31 postfix:- (286571:tqdm_logging.py:145)
Step 310: grad_norm=3.3799266815185547, loss=0.5000863075256348, param_norm=1887.056884765625
Step 311: grad_norm=5.942418098449707, loss=0.5445252656936646, param_norm=1887.05712890625
22:32:09.687 [I] Progress on: 311it/1.00kit rate:8.9s/it remaining:1:42:15 elapsed:46:48 postfix:- (286571:tqdm_logging.py:145)
Step 312: grad_norm=5.6923747062683105, loss=0.5758206844329834, param_norm=1887.0574951171875
Step 313: grad_norm=5.29884672164917, loss=0.5566033124923706, param_norm=1887.0577392578125
22:32:27.422 [I] Progress on: 313it/1.00kit rate:8.9s/it remaining:1:41:44 elapsed:47:06 postfix:- (286571:tqdm_logging.py:145)
Step 314: grad_norm=5.147870063781738, loss=0.5279132127761841, param_norm=1887.05810546875
22:32:38.816 [I] Progress on: 315it/1.00kit rate:9.6s/it remaining:1:49:14 elapsed:47:18 postfix:- (286571:tqdm_logging.py:145)
Step 315: grad_norm=4.748939514160156, loss=0.6063791513442993, param_norm=1887.0584716796875
Step 316: grad_norm=5.2514472007751465, loss=0.408409982919693, param_norm=1887.0587158203125
22:32:56.337 [I] Progress on: 316it/1.00kit rate:9.4s/it remaining:1:46:42 elapsed:47:35 postfix:- (286571:tqdm_logging.py:145)
Step 317: grad_norm=7.466317653656006, loss=0.6327264904975891, param_norm=1887.05908203125
Step 318: grad_norm=7.522667407989502, loss=0.5581644773483276, param_norm=1887.059326171875
22:33:14.085 [I] Progress on: 318it/1.00kit rate:9.1s/it remaining:1:43:35 elapsed:47:53 postfix:- (286571:tqdm_logging.py:145)
Step 319: grad_norm=8.677042961120605, loss=0.536806583404541, param_norm=1887.0596923828125
Step 320: grad_norm=8.510608673095703, loss=0.5635479092597961, param_norm=1887.0599365234375
22:33:31.840 [I] Progress on: 320it/1.00kit rate:9.0s/it remaining:1:41:55 elapsed:48:11 postfix:- (286571:tqdm_logging.py:145)
Step 321: grad_norm=6.548637390136719, loss=0.5529525279998779, param_norm=1887.060302734375
Step 322: grad_norm=7.041356086730957, loss=0.5501563549041748, param_norm=1887.060546875
22:33:49.592 [I] Progress on: 322it/1.00kit rate:8.9s/it remaining:1:40:57 elapsed:48:28 postfix:- (286571:tqdm_logging.py:145)
Step 323: grad_norm=5.536098003387451, loss=0.4986499845981598, param_norm=1887.0609130859375
Step 324: grad_norm=13.493678092956543, loss=0.511876106262207, param_norm=1887.0611572265625
22:34:07.375 [I] Progress on: 324it/1.00kit rate:8.9s/it remaining:1:40:23 elapsed:48:46 postfix:- (286571:tqdm_logging.py:145)
Step 325: grad_norm=4.440613746643066, loss=0.5709416270256042, param_norm=1887.0615234375
Step 326: grad_norm=11.301993370056152, loss=0.6037389636039734, param_norm=1887.061767578125
22:34:25.203 [I] Progress on: 326it/1.00kit rate:8.9s/it remaining:1:40:05 elapsed:49:04 postfix:- (286571:tqdm_logging.py:145)
Step 327: grad_norm=12.118653297424316, loss=0.5957939028739929, param_norm=1887.06201171875
Step 328: grad_norm=5.263272762298584, loss=0.4437558054924011, param_norm=1887.0623779296875
22:34:42.972 [I] Progress on: 328it/1.00kit rate:8.9s/it remaining:1:39:38 elapsed:49:22 postfix:- (286571:tqdm_logging.py:145)
Step 329: grad_norm=5.030190944671631, loss=0.5346695780754089, param_norm=1887.062744140625
Step 330: grad_norm=5.814097881317139, loss=0.535170316696167, param_norm=1887.0631103515625
22:35:00.728 [I] Progress on: 330it/1.00kit rate:8.9s/it remaining:1:39:15 elapsed:49:39 postfix:- (286571:tqdm_logging.py:145)
Step 331: grad_norm=5.5874223709106445, loss=0.5158689618110657, param_norm=1887.0633544921875
Step 332: grad_norm=4.239387035369873, loss=0.3971598148345947, param_norm=1887.0635986328125
22:35:18.505 [I] Progress on: 332it/1.00kit rate:8.9s/it remaining:1:38:55 elapsed:49:57 postfix:- (286571:tqdm_logging.py:145)
Step 333: grad_norm=3.958522081375122, loss=0.578620433807373, param_norm=1887.0638427734375
Step 334: grad_norm=6.880865573883057, loss=0.5602968335151672, param_norm=1887.064208984375
22:35:36.277 [I] Progress on: 334it/1.00kit rate:8.9s/it remaining:1:38:38 elapsed:50:15 postfix:- (286571:tqdm_logging.py:145)
Step 335: grad_norm=8.859057426452637, loss=0.5668274164199829, param_norm=1887.0645751953125
22:35:47.790 [I] Progress on: 336it/1.00kit rate:9.6s/it remaining:1:46:20 elapsed:50:26 postfix:- (286571:tqdm_logging.py:145)
Step 336: grad_norm=6.712621688842773, loss=0.4559820890426636, param_norm=1887.0648193359375
Step 337: grad_norm=4.757777690887451, loss=0.5448031425476074, param_norm=1887.065185546875
22:36:05.214 [I] Progress on: 337it/1.00kit rate:9.4s/it remaining:1:43:22 elapsed:50:44 postfix:- (286571:tqdm_logging.py:145)
Step 338: grad_norm=3.4594955444335938, loss=0.5000841021537781, param_norm=1887.0655517578125
Step 339: grad_norm=5.8804121017456055, loss=0.4742696285247803, param_norm=1887.06591796875
22:36:22.982 [I] Progress on: 339it/1.00kit rate:9.1s/it remaining:1:40:26 elapsed:51:02 postfix:- (286571:tqdm_logging.py:145)
Step 340: grad_norm=8.699881553649902, loss=0.45446571707725525, param_norm=1887.0662841796875
Step 341: grad_norm=8.086055755615234, loss=0.46409833431243896, param_norm=1887.066650390625
22:36:40.765 [I] Progress on: 341it/1.00kit rate:9.0s/it remaining:1:38:51 elapsed:51:19 postfix:- (286571:tqdm_logging.py:145)
Step 342: grad_norm=7.694575309753418, loss=0.5817293524742126, param_norm=1887.0670166015625
Step 343: grad_norm=4.642276763916016, loss=0.4334930181503296, param_norm=1887.0672607421875
22:36:58.540 [I] Progress on: 343it/1.00kit rate:8.9s/it remaining:1:37:56 elapsed:51:37 postfix:- (286571:tqdm_logging.py:145)
Step 344: grad_norm=4.397140026092529, loss=0.4554043412208557, param_norm=1887.067626953125
Step 345: grad_norm=4.627098083496094, loss=0.5075737237930298, param_norm=1887.0679931640625
22:37:16.324 [I] Progress on: 345it/1.00kit rate:8.9s/it remaining:1:37:21 elapsed:51:55 postfix:- (286571:tqdm_logging.py:145)
Step 346: grad_norm=9.707215309143066, loss=0.45925015211105347, param_norm=1887.0682373046875
Step 347: grad_norm=7.542146682739258, loss=0.479380339384079, param_norm=1887.068603515625
22:37:34.156 [I] Progress on: 347it/1.00kit rate:8.9s/it remaining:1:37:04 elapsed:52:13 postfix:- (286571:tqdm_logging.py:145)
Step 348: grad_norm=4.4958038330078125, loss=0.49672651290893555, param_norm=1887.0689697265625
Step 349: grad_norm=5.486369609832764, loss=0.4740114212036133, param_norm=1887.0693359375
22:37:51.958 [I] Progress on: 349it/1.00kit rate:8.9s/it remaining:1:36:41 elapsed:52:31 postfix:- (286571:tqdm_logging.py:145)
Step 350: grad_norm=5.514807224273682, loss=0.458592027425766, param_norm=1887.0697021484375
Step 351: grad_norm=4.4575958251953125, loss=0.4131860136985779, param_norm=1887.0699462890625
22:38:09.739 [I] Progress on: 351it/1.00kit rate:8.9s/it remaining:1:36:17 elapsed:52:48 postfix:- (286571:tqdm_logging.py:145)
Step 352: grad_norm=4.550327777862549, loss=0.4581250846385956, param_norm=1887.0703125
Step 353: grad_norm=3.2681057453155518, loss=0.4384244978427887, param_norm=1887.0706787109375
22:38:27.530 [I] Progress on: 353it/1.00kit rate:8.9s/it remaining:1:35:58 elapsed:53:06 postfix:- (286571:tqdm_logging.py:145)
Step 354: grad_norm=6.484788417816162, loss=0.4533856213092804, param_norm=1887.071044921875
Step 355: grad_norm=7.670326232910156, loss=0.5367398262023926, param_norm=1887.0714111328125
22:38:45.325 [I] Progress on: 355it/1.00kit rate:8.9s/it remaining:1:35:40 elapsed:53:24 postfix:- (286571:tqdm_logging.py:145)
Step 356: grad_norm=8.447720527648926, loss=0.5880841016769409, param_norm=1887.0716552734375
22:38:56.629 [I] Progress on: 357it/1.00kit rate:9.6s/it remaining:1:42:21 elapsed:53:35 postfix:- (286571:tqdm_logging.py:145)
Step 357: grad_norm=3.989034652709961, loss=0.4123484194278717, param_norm=1887.0718994140625
Step 358: grad_norm=4.017704963684082, loss=0.4261136054992676, param_norm=1887.072265625
22:39:14.131 [I] Progress on: 358it/1.00kit rate:9.3s/it remaining:1:39:59 elapsed:53:53 postfix:- (286571:tqdm_logging.py:145)
Step 359: grad_norm=4.034832000732422, loss=0.44953569769859314, param_norm=1887.072509765625
Step 360: grad_norm=3.9159467220306396, loss=0.43518170714378357, param_norm=1887.0728759765625
22:39:31.866 [I] Progress on: 360it/1.00kit rate:9.1s/it remaining:1:37:03 elapsed:54:11 postfix:- (286571:tqdm_logging.py:145)
Step 361: grad_norm=3.393242359161377, loss=0.401966392993927, param_norm=1887.0731201171875
Step 362: grad_norm=5.023910999298096, loss=0.5061529874801636, param_norm=1887.073486328125
22:39:49.631 [I] Progress on: 362it/1.00kit rate:9.0s/it remaining:1:35:32 elapsed:54:28 postfix:- (286571:tqdm_logging.py:145)
Step 363: grad_norm=5.396457195281982, loss=0.537530243396759, param_norm=1887.0738525390625
Step 364: grad_norm=5.687321662902832, loss=0.4775621294975281, param_norm=1887.07421875
22:40:07.385 [I] Progress on: 364it/1.00kit rate:8.9s/it remaining:1:34:40 elapsed:54:46 postfix:- (286571:tqdm_logging.py:145)
Step 365: grad_norm=4.024698257446289, loss=0.41734081506729126, param_norm=1887.074462890625
Step 366: grad_norm=4.593572616577148, loss=0.5365915298461914, param_norm=1887.07470703125
22:40:25.144 [I] Progress on: 366it/1.00kit rate:8.9s/it remaining:1:34:04 elapsed:55:04 postfix:- (286571:tqdm_logging.py:145)
Step 367: grad_norm=4.296411514282227, loss=0.4579741060733795, param_norm=1887.0750732421875
Step 368: grad_norm=9.61024284362793, loss=0.4890417158603668, param_norm=1887.0753173828125
22:40:42.898 [I] Progress on: 368it/1.00kit rate:8.9s/it remaining:1:33:37 elapsed:55:22 postfix:- (286571:tqdm_logging.py:145)
Step 369: grad_norm=4.377206802368164, loss=0.48293226957321167, param_norm=1887.0755615234375
Step 370: grad_norm=6.014928817749023, loss=0.5375713109970093, param_norm=1887.0758056640625
22:41:00.642 [I] Progress on: 370it/1.00kit rate:8.9s/it remaining:1:33:15 elapsed:55:39 postfix:- (286571:tqdm_logging.py:145)
Step 371: grad_norm=3.3152410984039307, loss=0.37820175290107727, param_norm=1887.076171875
Step 372: grad_norm=3.611039400100708, loss=0.46260619163513184, param_norm=1887.076416015625
22:41:18.401 [I] Progress on: 372it/1.00kit rate:8.9s/it remaining:1:32:55 elapsed:55:57 postfix:- (286571:tqdm_logging.py:145)
Step 373: grad_norm=4.2359209060668945, loss=0.4334612488746643, param_norm=1887.07666015625
Step 374: grad_norm=3.8041510581970215, loss=0.38096898794174194, param_norm=1887.0770263671875
22:41:36.164 [I] Progress on: 374it/1.00kit rate:8.9s/it remaining:1:32:38 elapsed:56:15 postfix:- (286571:tqdm_logging.py:145)
Step 375: grad_norm=5.502957820892334, loss=0.5107535719871521, param_norm=1887.0772705078125
Step 376: grad_norm=5.575774669647217, loss=0.4687560796737671, param_norm=1887.0775146484375
22:41:53.939 [I] Progress on: 376it/1.00kit rate:8.9s/it remaining:1:32:20 elapsed:56:33 postfix:- (286571:tqdm_logging.py:145)
Step 377: grad_norm=4.93787956237793, loss=0.4191272258758545, param_norm=1887.077880859375
22:42:05.511 [I] Progress on: 378it/1.00kit rate:9.6s/it remaining:1:39:45 elapsed:56:44 postfix:- (286571:tqdm_logging.py:145)
Step 378: grad_norm=8.09987735748291, loss=0.4205790162086487, param_norm=1887.078125
Step 379: grad_norm=6.435965538024902, loss=0.575760006904602, param_norm=1887.078369140625
22:42:22.907 [I] Progress on: 379it/1.00kit rate:9.4s/it remaining:1:36:54 elapsed:57:02 postfix:- (286571:tqdm_logging.py:145)
Step 380: grad_norm=6.1348137855529785, loss=0.47319087386131287, param_norm=1887.0787353515625
Step 381: grad_norm=8.385825157165527, loss=0.4698280692100525, param_norm=1887.0789794921875
22:42:40.654 [I] Progress on: 381it/1.00kit rate:9.1s/it remaining:1:33:57 elapsed:57:19 postfix:- (286571:tqdm_logging.py:145)
Step 382: grad_norm=4.655933380126953, loss=0.45261532068252563, param_norm=1887.0792236328125
Step 383: grad_norm=3.0288593769073486, loss=0.3662317395210266, param_norm=1887.07958984375
22:42:58.400 [I] Progress on: 383it/1.00kit rate:9.0s/it remaining:1:32:25 elapsed:57:37 postfix:- (286571:tqdm_logging.py:145)
Step 384: grad_norm=4.580888271331787, loss=0.5260800123214722, param_norm=1887.079833984375
Step 385: grad_norm=4.3427510261535645, loss=0.37880420684814453, param_norm=1887.0802001953125
22:43:16.155 [I] Progress on: 385it/1.00kit rate:8.9s/it remaining:1:31:32 elapsed:57:55 postfix:- (286571:tqdm_logging.py:145)
Step 386: grad_norm=5.126067161560059, loss=0.4807652235031128, param_norm=1887.0804443359375
Step 387: grad_norm=2.9240410327911377, loss=0.40860074758529663, param_norm=1887.0806884765625
22:43:33.926 [I] Progress on: 387it/1.00kit rate:8.9s/it remaining:1:30:58 elapsed:58:13 postfix:- (286571:tqdm_logging.py:145)
Step 388: grad_norm=4.131545543670654, loss=0.3994433581829071, param_norm=1887.0809326171875
Step 389: grad_norm=4.261782646179199, loss=0.46141424775123596, param_norm=1887.0810546875
22:43:51.691 [I] Progress on: 389it/1.00kit rate:8.9s/it remaining:1:30:34 elapsed:58:30 postfix:- (286571:tqdm_logging.py:145)
Step 390: grad_norm=3.597299337387085, loss=0.39144137501716614, param_norm=1887.0814208984375
Step 391: grad_norm=3.189500093460083, loss=0.36793866753578186, param_norm=1887.0816650390625
22:44:09.465 [I] Progress on: 391it/1.00kit rate:8.9s/it remaining:1:30:13 elapsed:58:48 postfix:- (286571:tqdm_logging.py:145)
Step 392: grad_norm=4.3163161277771, loss=0.47698667645454407, param_norm=1887.0819091796875
Step 393: grad_norm=4.637659072875977, loss=0.4567909836769104, param_norm=1887.0821533203125
22:44:27.250 [I] Progress on: 393it/1.00kit rate:8.9s/it remaining:1:29:55 elapsed:59:06 postfix:- (286571:tqdm_logging.py:145)
Step 394: grad_norm=4.51304292678833, loss=0.4765280783176422, param_norm=1887.082275390625
Step 395: grad_norm=5.815301895141602, loss=0.4740526080131531, param_norm=1887.08251953125
22:44:45.028 [I] Progress on: 395it/1.00kit rate:8.9s/it remaining:1:29:38 elapsed:59:24 postfix:- (286571:tqdm_logging.py:145)
Step 396: grad_norm=4.349690914154053, loss=0.4537953734397888, param_norm=1887.082763671875
Step 397: grad_norm=4.270462512969971, loss=0.42379486560821533, param_norm=1887.0830078125
22:45:02.814 [I] Progress on: 397it/1.00kit rate:8.9s/it remaining:1:29:19 elapsed:59:42 postfix:- (286571:tqdm_logging.py:145)
Step 398: grad_norm=3.288815498352051, loss=0.408721387386322, param_norm=1887.0833740234375
22:45:14.128 [I] Progress on: 399it/1.00kit rate:9.6s/it remaining:1:35:39 elapsed:59:53 postfix:- (286571:tqdm_logging.py:145)
Step 399: grad_norm=3.6127240657806396, loss=0.4319092929363251, param_norm=1887.083740234375
Step 400: grad_norm=3.411806106567383, loss=0.39005059003829956, param_norm=1887.083984375
22:45:31.664 [I] Progress on: 400it/1.00kit rate:9.4s/it remaining:1:33:30 elapsed:1:00:10 postfix:- (286571:tqdm_logging.py:145)
22:45:31.881 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
22:45:31.882 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
22:45:31.882 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (286571:checkpoint_manager.py:1786)
22:45:31.882 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (286571:checkpoint_manager.py:1817)
22:45:31.882 [I] [process=0] Saving checkpoint at step 400                                        (286571:checkpoint_manager.py:1286)
22:45:31.883 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400. (286571:async_checkpointer.py:358)
22:45:31.884 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:45:31.885 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9 (286571:atomicity.py:144)
22:45:31.885 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:45:31.885 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
22:45:31.886 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (286571:atomicity.py:144)
22:45:31.887 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (286571:atomicity.py:144)
22:45:31.887 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
22:45:31.892 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
22:45:39.147 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
22:45:39.148 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 7 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:45:39.151 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
22:45:39.154 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
22:45:39.182 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
22:45:39.184 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
22:45:39.185 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
22:45:39.186 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
22:45:39.188 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
22:45:39.196 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
22:45:39.198 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742870731.8816786, 'wait_for_prev_duration_secs': 0.0006198883056640625, 'checkpointer_blocking_start_time': 1742870731.882868, 'checkpointer_blocking_duration_secs': 7.2995054721832275, 'get_old_steps_start_time': 1742870739.1825457, 'get_old_steps_duration_secs': 0.0037994384765625, 'checkpoint_manager_blocking_start_time': 1742870731.881481, 'checkpoint_manager_blocking_duration_secs': 7.317237615585327} (286571:standard_logger.py:34)
22:45:47.609 [I] ChainedFuture completed 1/1 futures in 8.43 seconds.                             (286571:future.py:137)
22:45:47.610 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 659.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 15 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
22:45:47.610 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
22:45:47.611 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9 (286571:async_checkpointer.py:406)
22:45:47.612 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9/assets (286571:atomicity.py:287)
Step 401: grad_norm=3.2398335933685303, loss=0.3738240599632263, param_norm=1887.084228515625
22:45:47.830 [I] Progress on: 401it/1.00kit rate:11.4s/it remaining:1:53:50 elapsed:1:00:27 postfix:- (286571:tqdm_logging.py:145)
22:45:47.908 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9/params (286571:atomicity.py:287)
22:45:47.911 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400 (286571:async_checkpointer.py:416)
22:45:47.911 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9 (286571:async_checkpointer.py:426)
22:45:47.912 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400 (286571:atomicity.py:287)
22:45:47.918 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/400`. (286571:atomicity.py:548)
22:45:47.919 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
22:45:47.920 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
22:45:47.922 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
22:45:47.923 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
22:45:47.923 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 402: grad_norm=3.579284429550171, loss=0.4135434031486511, param_norm=1887.0845947265625
Step 403: grad_norm=3.6570138931274414, loss=0.3898064196109772, param_norm=1887.0848388671875
22:46:05.569 [I] Progress on: 403it/1.00kit rate:10.1s/it remaining:1:40:29 elapsed:1:00:44 postfix:- (286571:tqdm_logging.py:145)
Step 404: grad_norm=5.805835247039795, loss=0.4577578902244568, param_norm=1887.0850830078125
Step 405: grad_norm=3.293886184692383, loss=0.37300801277160645, param_norm=1887.0853271484375
22:46:23.318 [I] Progress on: 405it/1.00kit rate:9.5s/it remaining:1:33:58 elapsed:1:01:02 postfix:- (286571:tqdm_logging.py:145)
Step 406: grad_norm=3.4359655380249023, loss=0.31035396456718445, param_norm=1887.0855712890625
Step 407: grad_norm=3.5334630012512207, loss=0.41690027713775635, param_norm=1887.0858154296875
22:46:41.084 [I] Progress on: 407it/1.00kit rate:9.2s/it remaining:1:30:39 elapsed:1:01:20 postfix:- (286571:tqdm_logging.py:145)
Step 408: grad_norm=3.3028523921966553, loss=0.37344199419021606, param_norm=1887.086181640625
Step 409: grad_norm=4.391269207000732, loss=0.3367501497268677, param_norm=1887.0865478515625
22:46:58.863 [I] Progress on: 409it/1.00kit rate:9.0s/it remaining:1:28:55 elapsed:1:01:38 postfix:- (286571:tqdm_logging.py:145)
Step 410: grad_norm=3.164729595184326, loss=0.3793431520462036, param_norm=1887.0867919921875
Step 411: grad_norm=4.807602405548096, loss=0.3580464720726013, param_norm=1887.087158203125
22:47:16.650 [I] Progress on: 411it/1.00kit rate:9.0s/it remaining:1:27:55 elapsed:1:01:55 postfix:- (286571:tqdm_logging.py:145)
Step 412: grad_norm=4.240525722503662, loss=0.4145287573337555, param_norm=1887.08740234375
Step 413: grad_norm=3.057661533355713, loss=0.37248754501342773, param_norm=1887.087646484375
22:47:34.447 [I] Progress on: 413it/1.00kit rate:8.9s/it remaining:1:27:18 elapsed:1:02:13 postfix:- (286571:tqdm_logging.py:145)
Step 414: grad_norm=4.2838592529296875, loss=0.4229201674461365, param_norm=1887.087890625
Step 415: grad_norm=4.089329719543457, loss=0.3891504406929016, param_norm=1887.088134765625
22:47:52.249 [I] Progress on: 415it/1.00kit rate:8.9s/it remaining:1:26:53 elapsed:1:02:31 postfix:- (286571:tqdm_logging.py:145)
Step 416: grad_norm=3.447162628173828, loss=0.4087545871734619, param_norm=1887.0885009765625
Step 417: grad_norm=4.289654731750488, loss=0.3712807297706604, param_norm=1887.0887451171875
22:48:10.048 [I] Progress on: 417it/1.00kit rate:8.9s/it remaining:1:26:33 elapsed:1:02:49 postfix:- (286571:tqdm_logging.py:145)
Step 418: grad_norm=3.926633596420288, loss=0.4426347613334656, param_norm=1887.0888671875
Step 419: grad_norm=3.3289220333099365, loss=0.4601542353630066, param_norm=1887.089111328125
22:48:27.837 [I] Progress on: 419it/1.00kit rate:8.9s/it remaining:1:26:09 elapsed:1:03:07 postfix:- (286571:tqdm_logging.py:145)
Step 420: grad_norm=3.176189422607422, loss=0.3873363137245178, param_norm=1887.0894775390625
22:48:38.929 [I] Progress on: 420it/1.00kit rate:9.6s/it remaining:1:32:24 elapsed:1:03:18 postfix:- (286571:tqdm_logging.py:145)
Step 421: grad_norm=2.6456708908081055, loss=0.346219927072525, param_norm=1887.08984375
Step 422: grad_norm=2.8402509689331055, loss=0.30177444219589233, param_norm=1887.090087890625
22:48:56.702 [I] Progress on: 422it/1.00kit rate:9.2s/it remaining:1:28:47 elapsed:1:03:35 postfix:- (286571:tqdm_logging.py:145)
Step 423: grad_norm=3.418468475341797, loss=0.3620762825012207, param_norm=1887.0904541015625
Step 424: grad_norm=4.267915725708008, loss=0.33977845311164856, param_norm=1887.0906982421875
22:49:14.490 [I] Progress on: 424it/1.00kit rate:9.0s/it remaining:1:26:52 elapsed:1:03:53 postfix:- (286571:tqdm_logging.py:145)
Step 425: grad_norm=3.1336042881011963, loss=0.34228941798210144, param_norm=1887.091064453125
Step 426: grad_norm=4.0869526863098145, loss=0.46476882696151733, param_norm=1887.09130859375
22:49:32.251 [I] Progress on: 426it/1.00kit rate:9.0s/it remaining:1:25:47 elapsed:1:04:11 postfix:- (286571:tqdm_logging.py:145)
Step 427: grad_norm=3.6721389293670654, loss=0.44653457403182983, param_norm=1887.091552734375
Step 428: grad_norm=3.44106125831604, loss=0.3613877594470978, param_norm=1887.091796875
22:49:50.072 [I] Progress on: 428it/1.00kit rate:8.9s/it remaining:1:25:15 elapsed:1:04:29 postfix:- (286571:tqdm_logging.py:145)
Step 429: grad_norm=2.6392083168029785, loss=0.3249403238296509, param_norm=1887.092041015625
Step 430: grad_norm=5.924880027770996, loss=0.3213704824447632, param_norm=1887.09228515625
22:50:07.886 [I] Progress on: 430it/1.00kit rate:8.9s/it remaining:1:24:46 elapsed:1:04:47 postfix:- (286571:tqdm_logging.py:145)
Step 431: grad_norm=5.2545013427734375, loss=0.40769922733306885, param_norm=1887.0926513671875
Step 432: grad_norm=4.838325023651123, loss=0.39087170362472534, param_norm=1887.0927734375
22:50:25.700 [I] Progress on: 432it/1.00kit rate:8.9s/it remaining:1:24:24 elapsed:1:05:04 postfix:- (286571:tqdm_logging.py:145)
Step 433: grad_norm=6.175699234008789, loss=0.4809397757053375, param_norm=1887.093017578125
Step 434: grad_norm=3.1237142086029053, loss=0.33063530921936035, param_norm=1887.0931396484375
22:50:43.509 [I] Progress on: 434it/1.00kit rate:8.9s/it remaining:1:24:06 elapsed:1:05:22 postfix:- (286571:tqdm_logging.py:145)
Step 435: grad_norm=3.7092106342315674, loss=0.43047571182250977, param_norm=1887.0933837890625
Step 436: grad_norm=4.003225803375244, loss=0.34757518768310547, param_norm=1887.0936279296875
22:51:01.289 [I] Progress on: 436it/1.00kit rate:8.9s/it remaining:1:23:41 elapsed:1:05:40 postfix:- (286571:tqdm_logging.py:145)
Step 437: grad_norm=3.490679979324341, loss=0.3956361413002014, param_norm=1887.0938720703125
Step 438: grad_norm=3.5883467197418213, loss=0.3651650547981262, param_norm=1887.0941162109375
22:51:19.166 [I] Progress on: 438it/1.00kit rate:8.9s/it remaining:1:23:30 elapsed:1:05:58 postfix:- (286571:tqdm_logging.py:145)
Step 439: grad_norm=4.769776821136475, loss=0.4139811396598816, param_norm=1887.09423828125
Step 440: grad_norm=4.371042251586914, loss=0.2820040285587311, param_norm=1887.094482421875
22:51:36.971 [I] Progress on: 440it/1.00kit rate:8.9s/it remaining:1:23:11 elapsed:1:06:16 postfix:- (286571:tqdm_logging.py:145)
Step 441: grad_norm=3.3979177474975586, loss=0.27005213499069214, param_norm=1887.0947265625
22:51:47.871 [I] Progress on: 441it/1.00kit rate:9.5s/it remaining:1:28:35 elapsed:1:06:27 postfix:- (286571:tqdm_logging.py:145)
Step 442: grad_norm=2.955002546310425, loss=0.3478415012359619, param_norm=1887.0950927734375
Step 443: grad_norm=2.6814074516296387, loss=0.3546755313873291, param_norm=1887.0953369140625
22:52:05.657 [I] Progress on: 443it/1.00kit rate:9.2s/it remaining:1:25:20 elapsed:1:06:44 postfix:- (286571:tqdm_logging.py:145)
Step 444: grad_norm=2.628099203109741, loss=0.293135404586792, param_norm=1887.095458984375
Step 445: grad_norm=3.9357545375823975, loss=0.36743026971817017, param_norm=1887.0958251953125
22:52:23.485 [I] Progress on: 445it/1.00kit rate:9.1s/it remaining:1:23:43 elapsed:1:07:02 postfix:- (286571:tqdm_logging.py:145)
Step 446: grad_norm=3.9233245849609375, loss=0.3762354552745819, param_norm=1887.095947265625
Step 447: grad_norm=2.895750045776367, loss=0.3285630941390991, param_norm=1887.09619140625
22:52:41.299 [I] Progress on: 447it/1.00kit rate:9.0s/it remaining:1:22:45 elapsed:1:07:20 postfix:- (286571:tqdm_logging.py:145)
Step 448: grad_norm=5.3578877449035645, loss=0.3398454189300537, param_norm=1887.096435546875
Step 449: grad_norm=3.2696897983551025, loss=0.3436596393585205, param_norm=1887.0965576171875
22:52:59.063 [I] Progress on: 449it/1.00kit rate:8.9s/it remaining:1:21:59 elapsed:1:07:38 postfix:- (286571:tqdm_logging.py:145)
Step 450: grad_norm=2.727987289428711, loss=0.3271867036819458, param_norm=1887.0966796875
Step 451: grad_norm=2.5985665321350098, loss=0.30279454588890076, param_norm=1887.096923828125
22:53:16.859 [I] Progress on: 451it/1.00kit rate:8.9s/it remaining:1:21:30 elapsed:1:07:56 postfix:- (286571:tqdm_logging.py:145)
Step 452: grad_norm=4.249638557434082, loss=0.42081528902053833, param_norm=1887.0972900390625
Step 453: grad_norm=3.848867654800415, loss=0.32832640409469604, param_norm=1887.0975341796875
22:53:34.661 [I] Progress on: 453it/1.00kit rate:8.9s/it remaining:1:21:11 elapsed:1:08:13 postfix:- (286571:tqdm_logging.py:145)
Step 454: grad_norm=3.0464282035827637, loss=0.32752931118011475, param_norm=1887.09765625
Step 455: grad_norm=3.661440849304199, loss=0.3410157263278961, param_norm=1887.0980224609375
22:53:52.446 [I] Progress on: 455it/1.00kit rate:8.9s/it remaining:1:20:48 elapsed:1:08:31 postfix:- (286571:tqdm_logging.py:145)
Step 456: grad_norm=2.8726580142974854, loss=0.3315514028072357, param_norm=1887.0982666015625
Step 457: grad_norm=3.5748097896575928, loss=0.32811757922172546, param_norm=1887.0985107421875
22:54:10.239 [I] Progress on: 457it/1.00kit rate:8.9s/it remaining:1:20:31 elapsed:1:08:49 postfix:- (286571:tqdm_logging.py:145)
Step 458: grad_norm=3.0284628868103027, loss=0.32687652111053467, param_norm=1887.0987548828125
Step 459: grad_norm=4.247064590454102, loss=0.3511580228805542, param_norm=1887.0989990234375
22:54:28.028 [I] Progress on: 459it/1.00kit rate:8.9s/it remaining:1:20:10 elapsed:1:09:07 postfix:- (286571:tqdm_logging.py:145)
Step 460: grad_norm=3.340237617492676, loss=0.30801165103912354, param_norm=1887.09912109375
Step 461: grad_norm=3.9306302070617676, loss=0.3505304157733917, param_norm=1887.099365234375
22:54:45.832 [I] Progress on: 461it/1.00kit rate:8.9s/it remaining:1:19:55 elapsed:1:09:25 postfix:- (286571:tqdm_logging.py:145)
Step 462: grad_norm=3.07698655128479, loss=0.31939762830734253, param_norm=1887.0994873046875
22:54:57.243 [I] Progress on: 462it/1.00kit rate:9.7s/it remaining:1:26:34 elapsed:1:09:36 postfix:- (286571:tqdm_logging.py:145)
Step 463: grad_norm=2.974005937576294, loss=0.30346059799194336, param_norm=1887.0997314453125
Step 464: grad_norm=2.7850000858306885, loss=0.29982733726501465, param_norm=1887.0999755859375
22:55:15.041 [I] Progress on: 464it/1.00kit rate:9.3s/it remaining:1:22:54 elapsed:1:09:54 postfix:- (286571:tqdm_logging.py:145)
Step 465: grad_norm=2.3836865425109863, loss=0.29278022050857544, param_norm=1887.10009765625
Step 466: grad_norm=2.549713611602783, loss=0.3026124835014343, param_norm=1887.100341796875
22:55:32.901 [I] Progress on: 466it/1.00kit rate:9.1s/it remaining:1:21:06 elapsed:1:10:12 postfix:- (286571:tqdm_logging.py:145)
Step 467: grad_norm=2.2463083267211914, loss=0.2536413073539734, param_norm=1887.1005859375
Step 468: grad_norm=3.069056987762451, loss=0.3308636546134949, param_norm=1887.100830078125
22:55:50.723 [I] Progress on: 468it/1.00kit rate:9.0s/it remaining:1:19:58 elapsed:1:10:29 postfix:- (286571:tqdm_logging.py:145)
Step 469: grad_norm=2.9475772380828857, loss=0.2669064402580261, param_norm=1887.10107421875
Step 470: grad_norm=3.896873950958252, loss=0.3383011519908905, param_norm=1887.101318359375
22:56:08.568 [I] Progress on: 470it/1.00kit rate:9.0s/it remaining:1:19:20 elapsed:1:10:47 postfix:- (286571:tqdm_logging.py:145)
Step 471: grad_norm=4.428165435791016, loss=0.3347806930541992, param_norm=1887.1015625
Step 472: grad_norm=3.0959019660949707, loss=0.29567253589630127, param_norm=1887.1016845703125
22:56:26.395 [I] Progress on: 472it/1.00kit rate:9.0s/it remaining:1:18:50 elapsed:1:11:05 postfix:- (286571:tqdm_logging.py:145)
Step 473: grad_norm=3.2824230194091797, loss=0.3303564786911011, param_norm=1887.1019287109375
Step 474: grad_norm=3.746971845626831, loss=0.32395726442337036, param_norm=1887.1021728515625
22:56:44.286 [I] Progress on: 474it/1.00kit rate:9.0s/it remaining:1:18:32 elapsed:1:11:23 postfix:- (286571:tqdm_logging.py:145)
Step 475: grad_norm=3.5870165824890137, loss=0.32527828216552734, param_norm=1887.1024169921875
Step 476: grad_norm=5.985030651092529, loss=0.2995731830596924, param_norm=1887.1025390625
22:57:02.152 [I] Progress on: 476it/1.00kit rate:9.0s/it remaining:1:18:16 elapsed:1:11:41 postfix:- (286571:tqdm_logging.py:145)
Step 477: grad_norm=2.7866907119750977, loss=0.3078228831291199, param_norm=1887.1026611328125
Step 478: grad_norm=2.9767837524414062, loss=0.32167261838912964, param_norm=1887.1029052734375
22:57:19.978 [I] Progress on: 478it/1.00kit rate:9.0s/it remaining:1:17:52 elapsed:1:11:59 postfix:- (286571:tqdm_logging.py:145)
Step 479: grad_norm=3.038733720779419, loss=0.28860461711883545, param_norm=1887.10302734375
Step 480: grad_norm=2.3545899391174316, loss=0.2793983221054077, param_norm=1887.1031494140625
22:57:37.756 [I] Progress on: 480it/1.00kit rate:8.9s/it remaining:1:17:28 elapsed:1:12:16 postfix:- (286571:tqdm_logging.py:145)
Step 481: grad_norm=3.6741747856140137, loss=0.31750625371932983, param_norm=1887.1033935546875
Step 482: grad_norm=7.993873596191406, loss=0.3398328721523285, param_norm=1887.1036376953125
22:57:55.352 [I] Progress on: 482it/1.00kit rate:8.9s/it remaining:1:16:38 elapsed:1:12:34 postfix:- (286571:tqdm_logging.py:145)
Step 483: grad_norm=2.7421815395355225, loss=0.3482908010482788, param_norm=1887.103759765625
22:58:07.242 [I] Progress on: 483it/1.00kit rate:9.8s/it remaining:1:24:20 elapsed:1:12:46 postfix:- (286571:tqdm_logging.py:145)
Step 484: grad_norm=2.560350179672241, loss=0.2845000624656677, param_norm=1887.10400390625
Step 485: grad_norm=3.054252862930298, loss=0.3102020025253296, param_norm=1887.1041259765625
22:58:24.913 [I] Progress on: 485it/1.00kit rate:9.3s/it remaining:1:19:56 elapsed:1:13:04 postfix:- (286571:tqdm_logging.py:145)
Step 486: grad_norm=3.1146979331970215, loss=0.2566041052341461, param_norm=1887.1043701171875
Step 487: grad_norm=2.5282537937164307, loss=0.2593560516834259, param_norm=1887.1044921875
22:58:42.553 [I] Progress on: 487it/1.00kit rate:9.1s/it remaining:1:17:37 elapsed:1:13:21 postfix:- (286571:tqdm_logging.py:145)
Step 488: grad_norm=3.991515874862671, loss=0.25774261355400085, param_norm=1887.1046142578125
Step 489: grad_norm=2.6819040775299072, loss=0.29380062222480774, param_norm=1887.104736328125
22:59:00.196 [I] Progress on: 489it/1.00kit rate:9.0s/it remaining:1:16:18 elapsed:1:13:39 postfix:- (286571:tqdm_logging.py:145)
Step 490: grad_norm=3.7169883251190186, loss=0.32441601157188416, param_norm=1887.1051025390625
Step 491: grad_norm=2.4754393100738525, loss=0.261405348777771, param_norm=1887.105224609375
22:59:17.810 [I] Progress on: 491it/1.00kit rate:8.9s/it remaining:1:15:28 elapsed:1:13:57 postfix:- (286571:tqdm_logging.py:145)
Step 492: grad_norm=4.674363136291504, loss=0.31464648246765137, param_norm=1887.10546875
Step 493: grad_norm=4.237175941467285, loss=0.30885928869247437, param_norm=1887.1055908203125
22:59:35.435 [I] Progress on: 493it/1.00kit rate:8.9s/it remaining:1:14:54 elapsed:1:14:14 postfix:- (286571:tqdm_logging.py:145)
Step 494: grad_norm=4.453124046325684, loss=0.3834347128868103, param_norm=1887.1058349609375
Step 495: grad_norm=2.753506898880005, loss=0.2860710918903351, param_norm=1887.1060791015625
22:59:53.073 [I] Progress on: 495it/1.00kit rate:8.9s/it remaining:1:14:32 elapsed:1:14:32 postfix:- (286571:tqdm_logging.py:145)
Step 496: grad_norm=5.683416843414307, loss=0.3180083632469177, param_norm=1887.1060791015625
Step 497: grad_norm=2.84689998626709, loss=0.31705427169799805, param_norm=1887.106201171875
23:00:10.684 [I] Progress on: 497it/1.00kit rate:8.8s/it remaining:1:14:07 elapsed:1:14:49 postfix:- (286571:tqdm_logging.py:145)
Step 498: grad_norm=8.247314453125, loss=0.33628785610198975, param_norm=1887.1065673828125
Step 499: grad_norm=2.529890775680542, loss=0.2822032570838928, param_norm=1887.1068115234375
23:00:28.279 [I] Progress on: 499it/1.00kit rate:8.8s/it remaining:1:13:45 elapsed:1:15:07 postfix:- (286571:tqdm_logging.py:145)
Step 500: grad_norm=3.042961597442627, loss=0.3309877812862396, param_norm=1887.10693359375
23:00:37.336 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
23:00:37.336 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
23:00:37.336 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (286571:checkpoint_manager.py:1786)
23:00:37.336 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (286571:checkpoint_manager.py:1817)
23:00:37.337 [I] [process=0] Saving checkpoint at step 500                                        (286571:checkpoint_manager.py:1286)
23:00:37.338 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500. (286571:async_checkpointer.py:358)
23:00:37.339 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:00:37.339 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12 (286571:atomicity.py:144)
23:00:37.340 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:00:37.340 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:00:37.341 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (286571:atomicity.py:144)
23:00:37.342 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (286571:atomicity.py:144)
23:00:37.342 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:00:37.347 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
23:00:40.894 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
23:00:40.895 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:00:40.897 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
23:00:40.899 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
23:00:40.924 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:00:40.925 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:00:40.929 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:00:40.929 [I] Preserving Checkpoint[step=400 | time=2025-03-25 02:45:39.182429+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:00:40.931 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
23:00:40.933 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
23:00:40.935 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
23:00:40.936 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742871637.336155, 'wait_for_prev_duration_secs': 0.0007052421569824219, 'checkpointer_blocking_start_time': 1742871637.3374562, 'checkpointer_blocking_duration_secs': 3.5871918201446533, 'get_old_steps_start_time': 1742871640.9247055, 'get_old_steps_duration_secs': 0.007035493850708008, 'checkpoint_manager_blocking_start_time': 1742871637.3359706, 'checkpoint_manager_blocking_duration_secs': 3.5999093055725098} (286571:standard_logger.py:34)
23:00:40.937 [I] Progress on: 501it/1.00kit rate:9.9s/it remaining:1:22:25 elapsed:1:15:20 postfix:- (286571:tqdm_logging.py:145)
23:00:47.500 [I] ChainedFuture completed 1/1 futures in 6.59 seconds.                             (286571:future.py:137)
23:00:47.501 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 1019.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:00:47.501 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
23:00:47.503 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12 (286571:async_checkpointer.py:406)
23:00:47.503 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12/assets (286571:atomicity.py:287)
23:00:47.514 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12/params (286571:atomicity.py:287)
23:00:47.514 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500 (286571:async_checkpointer.py:416)
23:00:47.514 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12 (286571:async_checkpointer.py:426)
23:00:47.515 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500 (286571:atomicity.py:287)
23:00:47.516 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/500`. (286571:atomicity.py:548)
23:00:47.516 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
23:00:47.517 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
23:00:47.517 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
23:00:47.518 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
23:00:47.518 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 501: grad_norm=2.7336699962615967, loss=0.2737765610218048, param_norm=1887.107177734375
Step 502: grad_norm=3.1306607723236084, loss=0.30920103192329407, param_norm=1887.1072998046875
23:00:58.123 [I] Progress on: 502it/1.00kit rate:9.5s/it remaining:1:19:07 elapsed:1:15:37 postfix:- (286571:tqdm_logging.py:145)
Step 503: grad_norm=2.3655941486358643, loss=0.2503318190574646, param_norm=1887.1075439453125
23:01:09.662 [I] Progress on: 504it/1.00kit rate:9.9s/it remaining:1:21:50 elapsed:1:15:48 postfix:- (286571:tqdm_logging.py:145)
Step 504: grad_norm=3.0837433338165283, loss=0.27470317482948303, param_norm=1887.1077880859375
Step 505: grad_norm=2.4121243953704834, loss=0.2741223871707916, param_norm=1887.10791015625
23:01:26.841 [I] Progress on: 505it/1.00kit rate:9.5s/it remaining:1:18:31 elapsed:1:16:06 postfix:- (286571:tqdm_logging.py:145)
Step 506: grad_norm=1.9740674495697021, loss=0.23573589324951172, param_norm=1887.108154296875
Step 507: grad_norm=3.3197147846221924, loss=0.24039041996002197, param_norm=1887.1083984375
23:01:44.423 [I] Progress on: 507it/1.00kit rate:9.1s/it remaining:1:15:08 elapsed:1:16:23 postfix:- (286571:tqdm_logging.py:145)
Step 508: grad_norm=2.2018885612487793, loss=0.26932716369628906, param_norm=1887.1085205078125
Step 509: grad_norm=2.348461389541626, loss=0.251723051071167, param_norm=1887.1087646484375
23:02:02.042 [I] Progress on: 509it/1.00kit rate:9.0s/it remaining:1:13:23 elapsed:1:16:41 postfix:- (286571:tqdm_logging.py:145)
Step 510: grad_norm=13.525982856750488, loss=0.38397830724716187, param_norm=1887.10888671875
Step 511: grad_norm=2.5882184505462646, loss=0.28514575958251953, param_norm=1887.1090087890625
23:02:19.708 [I] Progress on: 511it/1.00kit rate:8.9s/it remaining:1:12:29 elapsed:1:16:58 postfix:- (286571:tqdm_logging.py:145)
Step 512: grad_norm=3.2010250091552734, loss=0.2587548792362213, param_norm=1887.1092529296875
Step 513: grad_norm=3.000760793685913, loss=0.27585774660110474, param_norm=1887.109375
23:02:37.382 [I] Progress on: 513it/1.00kit rate:8.9s/it remaining:1:11:57 elapsed:1:17:16 postfix:- (286571:tqdm_logging.py:145)
Step 514: grad_norm=3.181410789489746, loss=0.2204144150018692, param_norm=1887.109619140625
Step 515: grad_norm=2.44244122505188, loss=0.2489144206047058, param_norm=1887.1097412109375
23:02:55.049 [I] Progress on: 515it/1.00kit rate:8.8s/it remaining:1:11:31 elapsed:1:17:34 postfix:- (286571:tqdm_logging.py:145)
Step 516: grad_norm=3.738334894180298, loss=0.29337048530578613, param_norm=1887.10986328125
Step 517: grad_norm=3.331321954727173, loss=0.2861725091934204, param_norm=1887.1099853515625
23:03:12.750 [I] Progress on: 517it/1.00kit rate:8.8s/it remaining:1:11:13 elapsed:1:17:51 postfix:- (286571:tqdm_logging.py:145)
Step 518: grad_norm=3.079969644546509, loss=0.25990578532218933, param_norm=1887.110107421875
Step 519: grad_norm=2.861901044845581, loss=0.24098871648311615, param_norm=1887.1102294921875
23:03:30.434 [I] Progress on: 519it/1.00kit rate:8.8s/it remaining:1:10:55 elapsed:1:18:09 postfix:- (286571:tqdm_logging.py:145)
Step 520: grad_norm=2.292158365249634, loss=0.2807878255844116, param_norm=1887.1104736328125
Step 521: grad_norm=2.9494237899780273, loss=0.2598603665828705, param_norm=1887.110595703125
23:03:48.139 [I] Progress on: 521it/1.00kit rate:8.8s/it remaining:1:10:39 elapsed:1:18:27 postfix:- (286571:tqdm_logging.py:145)
Step 522: grad_norm=6.725709915161133, loss=0.31236255168914795, param_norm=1887.110595703125
Step 523: grad_norm=5.507608413696289, loss=0.28363901376724243, param_norm=1887.1107177734375
23:04:05.826 [I] Progress on: 523it/1.00kit rate:8.8s/it remaining:1:10:19 elapsed:1:18:45 postfix:- (286571:tqdm_logging.py:145)
Step 524: grad_norm=2.8154194355010986, loss=0.28402018547058105, param_norm=1887.1109619140625
23:04:17.306 [I] Progress on: 525it/1.00kit rate:9.6s/it remaining:1:15:45 elapsed:1:18:56 postfix:- (286571:tqdm_logging.py:145)
Step 525: grad_norm=2.208707571029663, loss=0.21815350651741028, param_norm=1887.1112060546875
Step 526: grad_norm=2.336038112640381, loss=0.27196288108825684, param_norm=1887.111328125
23:04:34.732 [I] Progress on: 526it/1.00kit rate:9.3s/it remaining:1:13:36 elapsed:1:19:13 postfix:- (286571:tqdm_logging.py:145)
Step 527: grad_norm=2.178744316101074, loss=0.23444142937660217, param_norm=1887.111328125
Step 528: grad_norm=2.636843204498291, loss=0.24111169576644897, param_norm=1887.111572265625
23:04:52.476 [I] Progress on: 528it/1.00kit rate:9.1s/it remaining:1:11:31 elapsed:1:19:31 postfix:- (286571:tqdm_logging.py:145)
Step 529: grad_norm=2.5319347381591797, loss=0.24509590864181519, param_norm=1887.1116943359375
Step 530: grad_norm=2.469081401824951, loss=0.2251967340707779, param_norm=1887.11181640625
23:05:10.223 [I] Progress on: 530it/1.00kit rate:9.0s/it remaining:1:10:14 elapsed:1:19:49 postfix:- (286571:tqdm_logging.py:145)
Step 531: grad_norm=2.315413236618042, loss=0.24360224604606628, param_norm=1887.112060546875
Step 532: grad_norm=3.3740100860595703, loss=0.2001899778842926, param_norm=1887.1121826171875
23:05:27.982 [I] Progress on: 532it/1.00kit rate:8.9s/it remaining:1:09:29 elapsed:1:20:07 postfix:- (286571:tqdm_logging.py:145)
Step 533: grad_norm=2.9517552852630615, loss=0.2532276511192322, param_norm=1887.1123046875
Step 534: grad_norm=2.5203611850738525, loss=0.24845777451992035, param_norm=1887.1124267578125
23:05:45.770 [I] Progress on: 534it/1.00kit rate:8.9s/it remaining:1:09:00 elapsed:1:20:24 postfix:- (286571:tqdm_logging.py:145)
Step 535: grad_norm=2.0218019485473633, loss=0.21939262747764587, param_norm=1887.112548828125
Step 536: grad_norm=3.3085808753967285, loss=0.30477264523506165, param_norm=1887.11279296875
23:06:03.538 [I] Progress on: 536it/1.00kit rate:8.9s/it remaining:1:08:38 elapsed:1:20:42 postfix:- (286571:tqdm_logging.py:145)
Step 537: grad_norm=3.499723434448242, loss=0.26858794689178467, param_norm=1887.1129150390625
Step 538: grad_norm=3.96760630607605, loss=0.30290815234184265, param_norm=1887.113037109375
23:06:21.363 [I] Progress on: 538it/1.00kit rate:8.9s/it remaining:1:08:22 elapsed:1:21:00 postfix:- (286571:tqdm_logging.py:145)
Step 539: grad_norm=2.88055157661438, loss=0.2569166123867035, param_norm=1887.11328125
Step 540: grad_norm=2.446780204772949, loss=0.27146515250205994, param_norm=1887.11328125
23:06:39.173 [I] Progress on: 540it/1.00kit rate:8.9s/it remaining:1:08:04 elapsed:1:21:18 postfix:- (286571:tqdm_logging.py:145)
Step 541: grad_norm=2.6012659072875977, loss=0.26680564880371094, param_norm=1887.113525390625
Step 542: grad_norm=2.936021566390991, loss=0.24178127944469452, param_norm=1887.1136474609375
23:06:57.023 [I] Progress on: 542it/1.00kit rate:8.9s/it remaining:1:07:51 elapsed:1:21:36 postfix:- (286571:tqdm_logging.py:145)
Step 543: grad_norm=2.3964576721191406, loss=0.26295599341392517, param_norm=1887.1138916015625
Step 544: grad_norm=2.06201171875, loss=0.24451273679733276, param_norm=1887.114013671875
23:07:14.840 [I] Progress on: 544it/1.00kit rate:8.9s/it remaining:1:07:33 elapsed:1:21:54 postfix:- (286571:tqdm_logging.py:145)
Step 545: grad_norm=4.180336952209473, loss=0.3151659071445465, param_norm=1887.1142578125
23:07:27.095 [I] Progress on: 546it/1.00kit rate:9.8s/it remaining:1:14:22 elapsed:1:22:06 postfix:- (286571:tqdm_logging.py:145)
Step 546: grad_norm=1.874341368675232, loss=0.19896936416625977, param_norm=1887.1143798828125
Step 547: grad_norm=3.0770890712738037, loss=0.21780773997306824, param_norm=1887.1146240234375
23:07:44.551 [I] Progress on: 547it/1.00kit rate:9.5s/it remaining:1:11:51 elapsed:1:22:23 postfix:- (286571:tqdm_logging.py:145)
Step 548: grad_norm=3.242070436477661, loss=0.27085304260253906, param_norm=1887.11474609375
Step 549: grad_norm=1.9514663219451904, loss=0.19577912986278534, param_norm=1887.1148681640625
23:08:02.403 [I] Progress on: 549it/1.00kit rate:9.2s/it remaining:1:09:11 elapsed:1:22:41 postfix:- (286571:tqdm_logging.py:145)
Step 550: grad_norm=1.5838145017623901, loss=0.2112521380186081, param_norm=1887.1151123046875
Step 551: grad_norm=1.9688990116119385, loss=0.22235555946826935, param_norm=1887.115234375
23:08:20.222 [I] Progress on: 551it/1.00kit rate:9.0s/it remaining:1:07:39 elapsed:1:22:59 postfix:- (286571:tqdm_logging.py:145)
Step 552: grad_norm=2.4306156635284424, loss=0.23471471667289734, param_norm=1887.1153564453125
Step 553: grad_norm=1.6643052101135254, loss=0.1761002242565155, param_norm=1887.115478515625
23:08:38.081 [I] Progress on: 553it/1.00kit rate:9.0s/it remaining:1:06:49 elapsed:1:23:17 postfix:- (286571:tqdm_logging.py:145)
Step 554: grad_norm=1.76971435546875, loss=0.2094804346561432, param_norm=1887.1156005859375
Step 555: grad_norm=2.2808315753936768, loss=0.25067242980003357, param_norm=1887.11572265625
23:08:55.909 [I] Progress on: 555it/1.00kit rate:8.9s/it remaining:1:06:14 elapsed:1:23:35 postfix:- (286571:tqdm_logging.py:145)
Step 556: grad_norm=1.9528027772903442, loss=0.20581412315368652, param_norm=1887.115966796875
Step 557: grad_norm=2.553602457046509, loss=0.22534535825252533, param_norm=1887.115966796875
23:09:13.788 [I] Progress on: 557it/1.00kit rate:8.9s/it remaining:1:05:50 elapsed:1:23:52 postfix:- (286571:tqdm_logging.py:145)
Step 558: grad_norm=2.7964928150177, loss=0.27738434076309204, param_norm=1887.1162109375
Step 559: grad_norm=2.4541733264923096, loss=0.2507781386375427, param_norm=1887.1163330078125
23:09:31.638 [I] Progress on: 559it/1.00kit rate:8.9s/it remaining:1:05:28 elapsed:1:24:10 postfix:- (286571:tqdm_logging.py:145)
Step 560: grad_norm=2.4098868370056152, loss=0.2603585124015808, param_norm=1887.116455078125
Step 561: grad_norm=2.711721897125244, loss=0.22202926874160767, param_norm=1887.1165771484375
23:09:49.531 [I] Progress on: 561it/1.00kit rate:8.9s/it remaining:1:05:13 elapsed:1:24:28 postfix:- (286571:tqdm_logging.py:145)
Step 562: grad_norm=3.0479133129119873, loss=0.2575910687446594, param_norm=1887.11669921875
Step 563: grad_norm=2.2378556728363037, loss=0.22837133705615997, param_norm=1887.1168212890625
23:10:07.395 [I] Progress on: 563it/1.00kit rate:8.9s/it remaining:1:04:53 elapsed:1:24:46 postfix:- (286571:tqdm_logging.py:145)
Step 564: grad_norm=3.253336191177368, loss=0.2747575342655182, param_norm=1887.1170654296875
Step 565: grad_norm=3.461237907409668, loss=0.23828259110450745, param_norm=1887.1170654296875
23:10:25.246 [I] Progress on: 565it/1.00kit rate:8.9s/it remaining:1:04:32 elapsed:1:25:04 postfix:- (286571:tqdm_logging.py:145)
Step 566: grad_norm=2.196047782897949, loss=0.2535998821258545, param_norm=1887.1171875
23:10:37.052 [I] Progress on: 567it/1.00kit rate:9.7s/it remaining:1:10:00 elapsed:1:25:16 postfix:- (286571:tqdm_logging.py:145)
Step 567: grad_norm=2.389796257019043, loss=0.23181670904159546, param_norm=1887.117431640625
Step 568: grad_norm=2.933136463165283, loss=0.19375690817832947, param_norm=1887.11767578125
23:10:54.431 [I] Progress on: 568it/1.00kit rate:9.4s/it remaining:1:07:47 elapsed:1:25:33 postfix:- (286571:tqdm_logging.py:145)
Step 569: grad_norm=2.282579183578491, loss=0.2317817658185959, param_norm=1887.11767578125
Step 570: grad_norm=2.965812921524048, loss=0.2270188331604004, param_norm=1887.1177978515625
23:11:12.127 [I] Progress on: 570it/1.00kit rate:9.1s/it remaining:1:05:18 elapsed:1:25:51 postfix:- (286571:tqdm_logging.py:145)
Step 571: grad_norm=2.2317965030670166, loss=0.19170069694519043, param_norm=1887.117919921875
Step 572: grad_norm=2.249366044998169, loss=0.23779812455177307, param_norm=1887.1181640625
23:11:29.939 [I] Progress on: 572it/1.00kit rate:9.0s/it remaining:1:04:10 elapsed:1:26:09 postfix:- (286571:tqdm_logging.py:145)
Step 573: grad_norm=2.289827585220337, loss=0.17553016543388367, param_norm=1887.1182861328125
Step 574: grad_norm=2.125372886657715, loss=0.24737653136253357, param_norm=1887.118408203125
23:11:47.735 [I] Progress on: 574it/1.00kit rate:8.9s/it remaining:1:03:25 elapsed:1:26:26 postfix:- (286571:tqdm_logging.py:145)
Step 575: grad_norm=2.0453197956085205, loss=0.20373810827732086, param_norm=1887.1185302734375
Step 576: grad_norm=3.962376832962036, loss=0.23588353395462036, param_norm=1887.1187744140625
23:12:05.522 [I] Progress on: 576it/1.00kit rate:8.9s/it remaining:1:02:54 elapsed:1:26:44 postfix:- (286571:tqdm_logging.py:145)
Step 577: grad_norm=2.7375943660736084, loss=0.23349756002426147, param_norm=1887.118896484375
Step 578: grad_norm=3.0589239597320557, loss=0.23522122204303741, param_norm=1887.1190185546875
23:12:23.323 [I] Progress on: 578it/1.00kit rate:8.9s/it remaining:1:02:30 elapsed:1:27:02 postfix:- (286571:tqdm_logging.py:145)
Step 579: grad_norm=2.2007288932800293, loss=0.2054794728755951, param_norm=1887.119140625
Step 580: grad_norm=2.377190351486206, loss=0.21749338507652283, param_norm=1887.1192626953125
23:12:41.146 [I] Progress on: 580it/1.00kit rate:8.9s/it remaining:1:02:11 elapsed:1:27:20 postfix:- (286571:tqdm_logging.py:145)
Step 581: grad_norm=2.171424150466919, loss=0.23327142000198364, param_norm=1887.119384765625
Step 582: grad_norm=2.566866159439087, loss=0.23059970140457153, param_norm=1887.1195068359375
23:12:58.940 [I] Progress on: 582it/1.00kit rate:8.9s/it remaining:1:01:52 elapsed:1:27:38 postfix:- (286571:tqdm_logging.py:145)
Step 583: grad_norm=2.3574278354644775, loss=0.19314080476760864, param_norm=1887.11962890625
Step 584: grad_norm=2.3046481609344482, loss=0.23708811402320862, param_norm=1887.1197509765625
23:13:16.743 [I] Progress on: 584it/1.00kit rate:8.9s/it remaining:1:01:33 elapsed:1:27:55 postfix:- (286571:tqdm_logging.py:145)
Step 585: grad_norm=1.768851637840271, loss=0.19434896111488342, param_norm=1887.119873046875
Step 586: grad_norm=2.065584659576416, loss=0.19583596289157867, param_norm=1887.119873046875
23:13:34.518 [I] Progress on: 586it/1.00kit rate:8.9s/it remaining:1:01:12 elapsed:1:28:13 postfix:- (286571:tqdm_logging.py:145)
Step 587: grad_norm=2.243439197540283, loss=0.2234278917312622, param_norm=1887.1199951171875
23:13:46.122 [I] Progress on: 588it/1.00kit rate:9.6s/it remaining:1:06:04 elapsed:1:28:25 postfix:- (286571:tqdm_logging.py:145)
Step 588: grad_norm=2.0138182640075684, loss=0.19666634500026703, param_norm=1887.1201171875
Step 589: grad_norm=2.1798760890960693, loss=0.18936419486999512, param_norm=1887.1202392578125
23:14:03.503 [I] Progress on: 589it/1.00kit rate:9.4s/it remaining:1:04:07 elapsed:1:28:42 postfix:- (286571:tqdm_logging.py:145)
Step 590: grad_norm=2.5459604263305664, loss=0.22845576703548431, param_norm=1887.120361328125
Step 591: grad_norm=2.0644431114196777, loss=0.20395256578922272, param_norm=1887.1204833984375
23:14:21.325 [I] Progress on: 591it/1.00kit rate:9.1s/it remaining:1:02:09 elapsed:1:29:00 postfix:- (286571:tqdm_logging.py:145)
Step 592: grad_norm=2.2203526496887207, loss=0.18265500664710999, param_norm=1887.12060546875
Step 593: grad_norm=1.7837458848953247, loss=0.17164203524589539, param_norm=1887.120849609375
23:14:39.090 [I] Progress on: 593it/1.00kit rate:9.0s/it remaining:1:00:56 elapsed:1:29:18 postfix:- (286571:tqdm_logging.py:145)
Step 594: grad_norm=2.1059956550598145, loss=0.19294671714305878, param_norm=1887.1209716796875
Step 595: grad_norm=1.8286752700805664, loss=0.19612352550029755, param_norm=1887.1209716796875
23:14:56.892 [I] Progress on: 595it/1.00kit rate:8.9s/it remaining:1:00:15 elapsed:1:29:36 postfix:- (286571:tqdm_logging.py:145)
Step 596: grad_norm=2.26680064201355, loss=0.22455841302871704, param_norm=1887.12109375
Step 597: grad_norm=2.7105610370635986, loss=0.2133866399526596, param_norm=1887.1212158203125
23:15:14.675 [I] Progress on: 597it/1.00kit rate:8.9s/it remaining:59:45 elapsed:1:29:53 postfix:- (286571:tqdm_logging.py:145)
Step 598: grad_norm=2.491717576980591, loss=0.18008151650428772, param_norm=1887.1214599609375
Step 599: grad_norm=1.7790842056274414, loss=0.20359522104263306, param_norm=1887.12158203125
23:15:32.467 [I] Progress on: 599it/1.00kit rate:8.9s/it remaining:59:23 elapsed:1:30:11 postfix:- (286571:tqdm_logging.py:145)
Step 600: grad_norm=2.041490077972412, loss=0.22311818599700928, param_norm=1887.1217041015625
23:15:41.612 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
23:15:41.612 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
23:15:41.613 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (286571:checkpoint_manager.py:1786)
23:15:41.613 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (286571:checkpoint_manager.py:1817)
23:15:41.613 [I] [process=0] Saving checkpoint at step 600                                        (286571:checkpoint_manager.py:1286)
23:15:41.614 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600. (286571:async_checkpointer.py:358)
23:15:41.615 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:15:41.616 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15 (286571:atomicity.py:144)
23:15:41.617 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:15:41.617 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:15:41.618 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (286571:atomicity.py:144)
23:15:41.618 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (286571:atomicity.py:144)
23:15:41.619 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:15:41.628 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
23:15:45.157 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
23:15:45.158 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.9 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:15:45.160 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
23:15:45.164 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
23:15:45.188 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:15:45.189 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:15:45.195 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:15:45.197 [I] Preserving Checkpoint[step=400 | time=2025-03-25 02:45:39.182429+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:15:45.199 [I] Preserving Checkpoint[step=500 | time=2025-03-25 03:00:40.924660+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:15:45.202 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
23:15:45.202 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
23:15:45.206 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
23:15:45.207 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742872541.6126177, 'wait_for_prev_duration_secs': 0.0007035732269287109, 'checkpointer_blocking_start_time': 1742872541.6139197, 'checkpointer_blocking_duration_secs': 3.57405948638916, 'get_old_steps_start_time': 1742872545.1880403, 'get_old_steps_duration_secs': 0.014225006103515625, 'checkpoint_manager_blocking_start_time': 1742872541.612426, 'checkpoint_manager_blocking_duration_secs': 3.5944559574127197} (286571:standard_logger.py:34)
23:15:45.216 [I] Progress on: 601it/1.00kit rate:10.0s/it remaining:1:06:13 elapsed:1:30:24 postfix:- (286571:tqdm_logging.py:145)
23:15:52.691 [I] ChainedFuture completed 1/1 futures in 7.52 seconds.                             (286571:future.py:137)
23:15:52.692 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 935.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:15:52.692 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
23:15:52.693 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15 (286571:async_checkpointer.py:406)
23:15:52.694 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15/assets (286571:atomicity.py:287)
23:15:52.704 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15/params (286571:atomicity.py:287)
23:15:52.704 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600 (286571:async_checkpointer.py:416)
23:15:52.705 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15 (286571:async_checkpointer.py:426)
23:15:52.705 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600 (286571:atomicity.py:287)
23:15:52.706 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/600`. (286571:atomicity.py:548)
23:15:52.707 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
23:15:52.707 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
23:15:52.708 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
23:15:52.708 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
23:15:52.708 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 601: grad_norm=1.9417948722839355, loss=0.19797268509864807, param_norm=1887.1217041015625
Step 602: grad_norm=2.4509596824645996, loss=0.21324852108955383, param_norm=1887.1219482421875
23:16:02.821 [I] Progress on: 602it/1.00kit rate:9.7s/it remaining:1:04:06 elapsed:1:30:42 postfix:- (286571:tqdm_logging.py:145)
Step 603: grad_norm=2.391892671585083, loss=0.24576976895332336, param_norm=1887.1220703125
Step 604: grad_norm=1.8476425409317017, loss=0.17379894852638245, param_norm=1887.1221923828125
23:16:20.665 [I] Progress on: 604it/1.00kit rate:9.3s/it remaining:1:01:21 elapsed:1:30:59 postfix:- (286571:tqdm_logging.py:145)
Step 605: grad_norm=2.1812567710876465, loss=0.20053762197494507, param_norm=1887.122314453125
Step 606: grad_norm=2.0175576210021973, loss=0.18937933444976807, param_norm=1887.1224365234375
23:16:38.406 [I] Progress on: 606it/1.00kit rate:9.1s/it remaining:59:42 elapsed:1:31:17 postfix:- (286571:tqdm_logging.py:145)
Step 607: grad_norm=1.7988059520721436, loss=0.18734556436538696, param_norm=1887.12255859375
Step 608: grad_norm=1.8803812265396118, loss=0.20648014545440674, param_norm=1887.1226806640625
23:16:56.021 [I] Progress on: 608it/1.00kit rate:8.9s/it remaining:58:27 elapsed:1:31:35 postfix:- (286571:tqdm_logging.py:145)
Step 609: grad_norm=1.786588430404663, loss=0.17170673608779907, param_norm=1887.1229248046875
23:17:07.224 [I] Progress on: 609it/1.00kit rate:9.6s/it remaining:1:02:46 elapsed:1:31:46 postfix:- (286571:tqdm_logging.py:145)
Step 610: grad_norm=2.6090011596679688, loss=0.19258038699626923, param_norm=1887.1229248046875
Step 611: grad_norm=1.3340396881103516, loss=0.16692155599594116, param_norm=1887.123046875
23:17:24.947 [I] Progress on: 611it/1.00kit rate:9.2s/it remaining:59:54 elapsed:1:32:04 postfix:- (286571:tqdm_logging.py:145)
Step 612: grad_norm=1.7397481203079224, loss=0.16272921860218048, param_norm=1887.1231689453125
Step 613: grad_norm=2.1740493774414062, loss=0.20608408749103546, param_norm=1887.123291015625
23:17:42.677 [I] Progress on: 613it/1.00kit rate:9.0s/it remaining:58:21 elapsed:1:32:21 postfix:- (286571:tqdm_logging.py:145)
Step 614: grad_norm=1.890379548072815, loss=0.19414444267749786, param_norm=1887.1234130859375
Step 615: grad_norm=1.7465555667877197, loss=0.18123112618923187, param_norm=1887.1234130859375
23:18:00.466 [I] Progress on: 615it/1.00kit rate:9.0s/it remaining:57:32 elapsed:1:32:39 postfix:- (286571:tqdm_logging.py:145)
Step 616: grad_norm=2.491452217102051, loss=0.17470428347587585, param_norm=1887.1236572265625
Step 617: grad_norm=1.884697675704956, loss=0.1773369163274765, param_norm=1887.123779296875
23:18:18.437 [I] Progress on: 617it/1.00kit rate:9.0s/it remaining:57:22 elapsed:1:32:57 postfix:- (286571:tqdm_logging.py:145)
Step 618: grad_norm=1.7662231922149658, loss=0.18828517198562622, param_norm=1887.1239013671875
Step 619: grad_norm=1.8874504566192627, loss=0.1708420217037201, param_norm=1887.1240234375
23:18:36.174 [I] Progress on: 619it/1.00kit rate:8.9s/it remaining:56:41 elapsed:1:33:15 postfix:- (286571:tqdm_logging.py:145)
Step 620: grad_norm=1.7371666431427002, loss=0.16635066270828247, param_norm=1887.1241455078125
Step 621: grad_norm=1.9724993705749512, loss=0.18431340157985687, param_norm=1887.1241455078125
23:18:53.926 [I] Progress on: 621it/1.00kit rate:8.9s/it remaining:56:13 elapsed:1:33:33 postfix:- (286571:tqdm_logging.py:145)
Step 622: grad_norm=1.9665108919143677, loss=0.17251813411712646, param_norm=1887.124267578125
Step 623: grad_norm=1.9693907499313354, loss=0.18943651020526886, param_norm=1887.1243896484375
23:19:11.667 [I] Progress on: 623it/1.00kit rate:8.9s/it remaining:55:49 elapsed:1:33:50 postfix:- (286571:tqdm_logging.py:145)
Step 624: grad_norm=2.1226015090942383, loss=0.18704907596111298, param_norm=1887.12451171875
Step 625: grad_norm=1.8387404680252075, loss=0.16936606168746948, param_norm=1887.12451171875
23:19:29.410 [I] Progress on: 625it/1.00kit rate:8.9s/it remaining:55:30 elapsed:1:34:08 postfix:- (286571:tqdm_logging.py:145)
Step 626: grad_norm=2.0172183513641357, loss=0.1850881576538086, param_norm=1887.1246337890625
Step 627: grad_norm=1.61322820186615, loss=0.179273322224617, param_norm=1887.124755859375
23:19:47.167 [I] Progress on: 627it/1.00kit rate:8.9s/it remaining:55:11 elapsed:1:34:26 postfix:- (286571:tqdm_logging.py:145)
Step 628: grad_norm=1.5371854305267334, loss=0.16183331608772278, param_norm=1887.124755859375
Step 629: grad_norm=1.9676581621170044, loss=0.2039356827735901, param_norm=1887.125
23:20:04.926 [I] Progress on: 629it/1.00kit rate:8.9s/it remaining:54:54 elapsed:1:34:44 postfix:- (286571:tqdm_logging.py:145)
Step 630: grad_norm=1.8803834915161133, loss=0.20562735199928284, param_norm=1887.125
23:20:16.365 [I] Progress on: 630it/1.00kit rate:9.7s/it remaining:59:32 elapsed:1:34:55 postfix:- (286571:tqdm_logging.py:145)
Step 631: grad_norm=1.8823304176330566, loss=0.1703844666481018, param_norm=1887.125244140625
Step 632: grad_norm=2.058037757873535, loss=0.1703500598669052, param_norm=1887.1253662109375
23:20:34.114 [I] Progress on: 632it/1.00kit rate:9.3s/it remaining:56:50 elapsed:1:35:13 postfix:- (286571:tqdm_logging.py:145)
Step 633: grad_norm=1.8469229936599731, loss=0.16955523192882538, param_norm=1887.12548828125
Step 634: grad_norm=2.342114210128784, loss=0.18281883001327515, param_norm=1887.1256103515625
23:20:51.858 [I] Progress on: 634it/1.00kit rate:9.1s/it remaining:55:21 elapsed:1:35:31 postfix:- (286571:tqdm_logging.py:145)
Step 635: grad_norm=1.8666986227035522, loss=0.16729721426963806, param_norm=1887.125732421875
Step 636: grad_norm=1.8057200908660889, loss=0.19050300121307373, param_norm=1887.125732421875
23:21:09.615 [I] Progress on: 636it/1.00kit rate:9.0s/it remaining:54:31 elapsed:1:35:48 postfix:- (286571:tqdm_logging.py:145)
Step 637: grad_norm=2.4843289852142334, loss=0.21711307764053345, param_norm=1887.1258544921875
Step 638: grad_norm=1.5627760887145996, loss=0.15832073986530304, param_norm=1887.1259765625
23:21:27.364 [I] Progress on: 638it/1.00kit rate:8.9s/it remaining:53:57 elapsed:1:36:06 postfix:- (286571:tqdm_logging.py:145)
Step 639: grad_norm=1.9933964014053345, loss=0.142334446310997, param_norm=1887.1260986328125
Step 640: grad_norm=1.7831257581710815, loss=0.1671542525291443, param_norm=1887.126220703125
23:21:45.093 [I] Progress on: 640it/1.00kit rate:8.9s/it remaining:53:30 elapsed:1:36:24 postfix:- (286571:tqdm_logging.py:145)
Step 641: grad_norm=1.7994868755340576, loss=0.18089304864406586, param_norm=1887.126220703125
Step 642: grad_norm=1.7461140155792236, loss=0.17108166217803955, param_norm=1887.1263427734375
23:22:02.822 [I] Progress on: 642it/1.00kit rate:8.9s/it remaining:53:05 elapsed:1:36:42 postfix:- (286571:tqdm_logging.py:145)
Step 643: grad_norm=1.407168984413147, loss=0.1727805882692337, param_norm=1887.12646484375
Step 644: grad_norm=1.5251704454421997, loss=0.15164625644683838, param_norm=1887.12646484375
23:22:20.557 [I] Progress on: 644it/1.00kit rate:8.9s/it remaining:52:47 elapsed:1:36:59 postfix:- (286571:tqdm_logging.py:145)
Step 645: grad_norm=2.3517720699310303, loss=0.20141619443893433, param_norm=1887.126708984375
Step 646: grad_norm=1.8428598642349243, loss=0.15298211574554443, param_norm=1887.126708984375
23:22:38.286 [I] Progress on: 646it/1.00kit rate:8.9s/it remaining:52:27 elapsed:1:37:17 postfix:- (286571:tqdm_logging.py:145)
Step 647: grad_norm=1.7006250619888306, loss=0.1584937572479248, param_norm=1887.1268310546875
Step 648: grad_norm=1.8342558145523071, loss=0.17840158939361572, param_norm=1887.126953125
23:22:56.021 [I] Progress on: 648it/1.00kit rate:8.9s/it remaining:52:10 elapsed:1:37:35 postfix:- (286571:tqdm_logging.py:145)
Step 649: grad_norm=2.027456283569336, loss=0.19543947279453278, param_norm=1887.126953125
Step 650: grad_norm=1.9663186073303223, loss=0.15299049019813538, param_norm=1887.1270751953125
23:23:13.608 [I] Progress on: 650it/1.00kit rate:8.8s/it remaining:51:36 elapsed:1:37:52 postfix:- (286571:tqdm_logging.py:145)
Step 651: grad_norm=1.8569029569625854, loss=0.16878414154052734, param_norm=1887.127197265625
23:23:24.725 [I] Progress on: 651it/1.00kit rate:9.5s/it remaining:55:25 elapsed:1:38:03 postfix:- (286571:tqdm_logging.py:145)
Step 652: grad_norm=1.7437695264816284, loss=0.16336385905742645, param_norm=1887.1273193359375
Step 653: grad_norm=1.8739674091339111, loss=0.17202849686145782, param_norm=1887.1273193359375
23:23:42.419 [I] Progress on: 653it/1.00kit rate:9.2s/it remaining:53:06 elapsed:1:38:21 postfix:- (286571:tqdm_logging.py:145)
Step 654: grad_norm=1.5051583051681519, loss=0.12816323339939117, param_norm=1887.12744140625
Step 655: grad_norm=1.687932014465332, loss=0.16489043831825256, param_norm=1887.1275634765625
23:24:00.169 [I] Progress on: 655it/1.00kit rate:9.0s/it remaining:51:52 elapsed:1:38:39 postfix:- (286571:tqdm_logging.py:145)
Step 656: grad_norm=1.51583993434906, loss=0.14734679460525513, param_norm=1887.127685546875
Step 657: grad_norm=1.8084678649902344, loss=0.14622646570205688, param_norm=1887.127685546875
23:24:17.901 [I] Progress on: 657it/1.00kit rate:8.9s/it remaining:51:06 elapsed:1:38:57 postfix:- (286571:tqdm_logging.py:145)
Step 658: grad_norm=2.116631031036377, loss=0.16792082786560059, param_norm=1887.1278076171875
Step 659: grad_norm=2.6405489444732666, loss=0.18496687710285187, param_norm=1887.1279296875
23:24:35.614 [I] Progress on: 659it/1.00kit rate:8.9s/it remaining:50:34 elapsed:1:39:14 postfix:- (286571:tqdm_logging.py:145)
Step 660: grad_norm=1.7347441911697388, loss=0.17747360467910767, param_norm=1887.1279296875
Step 661: grad_norm=1.2188204526901245, loss=0.14026696979999542, param_norm=1887.1280517578125
23:24:53.346 [I] Progress on: 661it/1.00kit rate:8.9s/it remaining:50:10 elapsed:1:39:32 postfix:- (286571:tqdm_logging.py:145)
Step 662: grad_norm=1.5420827865600586, loss=0.1501692533493042, param_norm=1887.1282958984375
Step 663: grad_norm=1.749106764793396, loss=0.1865684539079666, param_norm=1887.1282958984375
23:25:11.022 [I] Progress on: 663it/1.00kit rate:8.9s/it remaining:49:44 elapsed:1:39:50 postfix:- (286571:tqdm_logging.py:145)
Step 664: grad_norm=1.4159748554229736, loss=0.1213466003537178, param_norm=1887.12841796875
Step 665: grad_norm=1.9784879684448242, loss=0.18094682693481445, param_norm=1887.12841796875
23:25:28.713 [I] Progress on: 665it/1.00kit rate:8.9s/it remaining:49:25 elapsed:1:40:07 postfix:- (286571:tqdm_logging.py:145)
Step 666: grad_norm=1.4287762641906738, loss=0.14003519713878632, param_norm=1887.1285400390625
Step 667: grad_norm=1.8407814502716064, loss=0.15678095817565918, param_norm=1887.128662109375
23:25:46.443 [I] Progress on: 667it/1.00kit rate:8.9s/it remaining:49:10 elapsed:1:40:25 postfix:- (286571:tqdm_logging.py:145)
Step 668: grad_norm=1.7973500490188599, loss=0.15005268156528473, param_norm=1887.128662109375
Step 669: grad_norm=1.91775381565094, loss=0.12934339046478271, param_norm=1887.1287841796875
23:26:04.138 [I] Progress on: 669it/1.00kit rate:8.9s/it remaining:48:50 elapsed:1:40:43 postfix:- (286571:tqdm_logging.py:145)
Step 670: grad_norm=1.2054363489151, loss=0.13845942914485931, param_norm=1887.12890625
Step 671: grad_norm=1.3591407537460327, loss=0.13473550975322723, param_norm=1887.12890625
23:26:21.895 [I] Progress on: 671it/1.00kit rate:8.9s/it remaining:48:37 elapsed:1:41:01 postfix:- (286571:tqdm_logging.py:145)
Step 672: grad_norm=1.528520941734314, loss=0.15021075308322906, param_norm=1887.12890625
23:26:34.907 [I] Progress on: 672it/1.00kit rate:10.1s/it remaining:55:19 elapsed:1:41:14 postfix:- (286571:tqdm_logging.py:145)
Step 673: grad_norm=1.4888437986373901, loss=0.1657983362674713, param_norm=1887.129150390625
Step 674: grad_norm=1.740999460220337, loss=0.13451650738716125, param_norm=1887.1292724609375
23:26:52.495 [I] Progress on: 674it/1.00kit rate:9.4s/it remaining:51:19 elapsed:1:41:31 postfix:- (286571:tqdm_logging.py:145)
Step 675: grad_norm=1.321612000465393, loss=0.13199788331985474, param_norm=1887.1292724609375
Step 676: grad_norm=1.5192703008651733, loss=0.14354605972766876, param_norm=1887.12939453125
23:27:10.218 [I] Progress on: 676it/1.00kit rate:9.1s/it remaining:49:23 elapsed:1:41:49 postfix:- (286571:tqdm_logging.py:145)
Step 677: grad_norm=1.7113820314407349, loss=0.15956449508666992, param_norm=1887.1295166015625
Step 678: grad_norm=1.0849741697311401, loss=0.11866407096385956, param_norm=1887.1295166015625
23:27:27.966 [I] Progress on: 678it/1.00kit rate:9.0s/it remaining:48:20 elapsed:1:42:07 postfix:- (286571:tqdm_logging.py:145)
Step 679: grad_norm=1.7287713289260864, loss=0.15869352221488953, param_norm=1887.129638671875
Step 680: grad_norm=2.5186707973480225, loss=0.1812528520822525, param_norm=1887.1297607421875
23:27:45.706 [I] Progress on: 680it/1.00kit rate:8.9s/it remaining:47:40 elapsed:1:42:24 postfix:- (286571:tqdm_logging.py:145)
Step 681: grad_norm=1.9456658363342285, loss=0.159434974193573, param_norm=1887.1298828125
Step 682: grad_norm=1.3974021673202515, loss=0.11553673446178436, param_norm=1887.1298828125
23:28:03.460 [I] Progress on: 682it/1.00kit rate:8.9s/it remaining:47:12 elapsed:1:42:42 postfix:- (286571:tqdm_logging.py:145)
Step 683: grad_norm=2.3129358291625977, loss=0.16975301504135132, param_norm=1887.1300048828125
Step 684: grad_norm=1.5416702032089233, loss=0.14658384025096893, param_norm=1887.1300048828125
23:28:21.182 [I] Progress on: 684it/1.00kit rate:8.9s/it remaining:46:47 elapsed:1:43:00 postfix:- (286571:tqdm_logging.py:145)
Step 685: grad_norm=1.8333914279937744, loss=0.1586083322763443, param_norm=1887.130126953125
Step 686: grad_norm=2.33719801902771, loss=0.17076313495635986, param_norm=1887.1302490234375
23:28:38.905 [I] Progress on: 686it/1.00kit rate:8.9s/it remaining:46:26 elapsed:1:43:18 postfix:- (286571:tqdm_logging.py:145)
Step 687: grad_norm=1.3966163396835327, loss=0.13557305932044983, param_norm=1887.1302490234375
Step 688: grad_norm=1.3367056846618652, loss=0.1159413754940033, param_norm=1887.13037109375
23:28:56.606 [I] Progress on: 688it/1.00kit rate:8.9s/it remaining:46:03 elapsed:1:43:35 postfix:- (286571:tqdm_logging.py:145)
Step 689: grad_norm=2.078545331954956, loss=0.12874436378479004, param_norm=1887.1304931640625
Step 690: grad_norm=1.9751745462417603, loss=0.14679037034511566, param_norm=1887.1304931640625
23:29:14.323 [I] Progress on: 690it/1.00kit rate:8.9s/it remaining:45:46 elapsed:1:43:53 postfix:- (286571:tqdm_logging.py:145)
Step 691: grad_norm=1.3792269229888916, loss=0.11563102900981903, param_norm=1887.1304931640625
Step 692: grad_norm=1.7240550518035889, loss=0.16022196412086487, param_norm=1887.1304931640625
23:29:32.071 [I] Progress on: 692it/1.00kit rate:8.9s/it remaining:45:29 elapsed:1:44:11 postfix:- (286571:tqdm_logging.py:145)
Step 693: grad_norm=1.2705386877059937, loss=0.10218581557273865, param_norm=1887.1307373046875
23:29:44.594 [I] Progress on: 693it/1.00kit rate:10.0s/it remaining:51:01 elapsed:1:44:23 postfix:- (286571:tqdm_logging.py:145)
Step 694: grad_norm=2.110731363296509, loss=0.13322442770004272, param_norm=1887.1307373046875
Step 695: grad_norm=1.7566447257995605, loss=0.14315158128738403, param_norm=1887.1307373046875
23:30:02.335 [I] Progress on: 695it/1.00kit rate:9.4s/it remaining:47:53 elapsed:1:44:41 postfix:- (286571:tqdm_logging.py:145)
Step 696: grad_norm=1.8397983312606812, loss=0.15437394380569458, param_norm=1887.130859375
Step 697: grad_norm=1.6911671161651611, loss=0.16137094795703888, param_norm=1887.1309814453125
23:30:20.062 [I] Progress on: 697it/1.00kit rate:9.1s/it remaining:46:11 elapsed:1:44:59 postfix:- (286571:tqdm_logging.py:145)
Step 698: grad_norm=1.6447252035140991, loss=0.12722113728523254, param_norm=1887.1309814453125
Step 699: grad_norm=1.6161258220672607, loss=0.15367798507213593, param_norm=1887.131103515625
23:30:37.800 [I] Progress on: 699it/1.00kit rate:9.0s/it remaining:45:14 elapsed:1:45:16 postfix:- (286571:tqdm_logging.py:145)
Step 700: grad_norm=1.4855748414993286, loss=0.15451580286026, param_norm=1887.131103515625
23:30:46.910 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
23:30:46.911 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
23:30:46.911 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (286571:checkpoint_manager.py:1786)
23:30:46.911 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (286571:checkpoint_manager.py:1817)
23:30:46.911 [I] [process=0] Saving checkpoint at step 700                                        (286571:checkpoint_manager.py:1286)
23:30:46.912 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700. (286571:async_checkpointer.py:358)
23:30:46.913 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:30:46.914 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18 (286571:atomicity.py:144)
23:30:46.914 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:30:46.915 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:30:46.916 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (286571:atomicity.py:144)
23:30:46.916 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (286571:atomicity.py:144)
23:30:46.917 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:30:46.922 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
23:30:57.593 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 970.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:30:57.600 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
23:30:57.603 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
23:30:57.604 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
23:30:57.606 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:30:57.610 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:30:57.611 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:30:57.611 [I] Preserving Checkpoint[step=400 | time=2025-03-25 02:45:39.182429+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:30:57.613 [I] Preserving Checkpoint[step=500 | time=2025-03-25 03:00:40.924660+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:30:57.614 [I] Preserving Checkpoint[step=600 | time=2025-03-25 03:15:45.187992+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:30:57.615 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
23:30:57.616 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
23:30:57.624 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
23:30:57.626 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742873446.9106479, 'wait_for_prev_duration_secs': 0.0007367134094238281, 'checkpointer_blocking_start_time': 1742873446.911992, 'checkpointer_blocking_duration_secs': 10.69454550743103, 'get_old_steps_start_time': 1742873457.6067102, 'get_old_steps_duration_secs': 0.008504390716552734, 'checkpoint_manager_blocking_start_time': 1742873446.910452, 'checkpoint_manager_blocking_duration_secs': 10.71598219871521} (286571:standard_logger.py:34)
23:30:57.635 [I] Progress on: 701it/1.00kit rate:12.2s/it remaining:1:00:38 elapsed:1:45:36 postfix:- (286571:tqdm_logging.py:145)
23:31:05.054 [I] ChainedFuture completed 1/1 futures in 7.45 seconds.                             (286571:future.py:137)
23:31:05.055 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 571.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 18 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:31:05.055 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
23:31:05.056 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18 (286571:async_checkpointer.py:406)
23:31:05.057 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18/assets (286571:atomicity.py:287)
23:31:05.067 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18/params (286571:atomicity.py:287)
23:31:05.067 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700 (286571:async_checkpointer.py:416)
23:31:05.067 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18 (286571:async_checkpointer.py:426)
23:31:05.068 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700 (286571:atomicity.py:287)
23:31:05.069 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/700`. (286571:atomicity.py:548)
23:31:05.069 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
23:31:05.070 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
23:31:05.071 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
23:31:05.071 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
23:31:05.071 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 701: grad_norm=1.2646743059158325, loss=0.13000905513763428, param_norm=1887.1312255859375
Step 702: grad_norm=1.319801926612854, loss=0.10881781578063965, param_norm=1887.1312255859375
23:31:14.937 [I] Progress on: 702it/1.00kit rate:11.1s/it remaining:55:17 elapsed:1:45:54 postfix:- (286571:tqdm_logging.py:145)
Step 703: grad_norm=1.0822300910949707, loss=0.10712838172912598, param_norm=1887.13134765625
Step 704: grad_norm=4.384545803070068, loss=0.1446014642715454, param_norm=1887.1314697265625
23:31:32.829 [I] Progress on: 704it/1.00kit rate:10.0s/it remaining:49:22 elapsed:1:46:12 postfix:- (286571:tqdm_logging.py:145)
Step 705: grad_norm=1.6866611242294312, loss=0.1396399587392807, param_norm=1887.1314697265625
Step 706: grad_norm=1.6002326011657715, loss=0.14563463628292084, param_norm=1887.1314697265625
23:31:50.734 [I] Progress on: 706it/1.00kit rate:9.4s/it remaining:46:05 elapsed:1:46:29 postfix:- (286571:tqdm_logging.py:145)
Step 707: grad_norm=1.8046830892562866, loss=0.15498988330364227, param_norm=1887.131591796875
Step 708: grad_norm=1.789217472076416, loss=0.14376506209373474, param_norm=1887.131591796875
23:32:08.541 [I] Progress on: 708it/1.00kit rate:9.2s/it remaining:44:38 elapsed:1:46:47 postfix:- (286571:tqdm_logging.py:145)
Step 709: grad_norm=1.3707032203674316, loss=0.12443040311336517, param_norm=1887.1317138671875
Step 710: grad_norm=2.1295201778411865, loss=0.13087376952171326, param_norm=1887.1318359375
23:32:26.332 [I] Progress on: 710it/1.00kit rate:9.0s/it remaining:43:34 elapsed:1:47:05 postfix:- (286571:tqdm_logging.py:145)
Step 711: grad_norm=1.6402928829193115, loss=0.14643441140651703, param_norm=1887.1318359375
Step 712: grad_norm=1.393174409866333, loss=0.12062343955039978, param_norm=1887.1319580078125
23:32:44.156 [I] Progress on: 712it/1.00kit rate:8.9s/it remaining:42:57 elapsed:1:47:23 postfix:- (286571:tqdm_logging.py:145)
Step 713: grad_norm=2.7099201679229736, loss=0.16751237213611603, param_norm=1887.1319580078125
23:32:55.520 [I] Progress on: 714it/1.00kit rate:9.6s/it remaining:45:44 elapsed:1:47:34 postfix:- (286571:tqdm_logging.py:145)
Step 714: grad_norm=0.9259640574455261, loss=0.11317227780818939, param_norm=1887.132080078125
Step 715: grad_norm=1.4032613039016724, loss=0.1262107640504837, param_norm=1887.1322021484375
23:33:13.123 [I] Progress on: 715it/1.00kit rate:9.4s/it remaining:44:36 elapsed:1:47:52 postfix:- (286571:tqdm_logging.py:145)
Step 716: grad_norm=1.6042853593826294, loss=0.1235046312212944, param_norm=1887.1322021484375
Step 717: grad_norm=1.4896297454833984, loss=0.13693535327911377, param_norm=1887.13232421875
23:33:30.949 [I] Progress on: 717it/1.00kit rate:9.2s/it remaining:43:09 elapsed:1:48:10 postfix:- (286571:tqdm_logging.py:145)
Step 718: grad_norm=1.7376313209533691, loss=0.13672968745231628, param_norm=1887.1324462890625
Step 719: grad_norm=1.5340027809143066, loss=0.12964031100273132, param_norm=1887.1324462890625
23:33:48.757 [I] Progress on: 719it/1.00kit rate:9.0s/it remaining:42:16 elapsed:1:48:27 postfix:- (286571:tqdm_logging.py:145)
Step 720: grad_norm=1.7349785566329956, loss=0.14883315563201904, param_norm=1887.132568359375
Step 721: grad_norm=1.61614990234375, loss=0.135605126619339, param_norm=1887.132568359375
23:34:06.554 [I] Progress on: 721it/1.00kit rate:9.0s/it remaining:41:40 elapsed:1:48:45 postfix:- (286571:tqdm_logging.py:145)
Step 722: grad_norm=1.1203216314315796, loss=0.10339409857988358, param_norm=1887.1326904296875
Step 723: grad_norm=1.8144853115081787, loss=0.15047511458396912, param_norm=1887.1328125
23:34:24.349 [I] Progress on: 723it/1.00kit rate:8.9s/it remaining:41:14 elapsed:1:49:03 postfix:- (286571:tqdm_logging.py:145)
Step 724: grad_norm=1.2885867357254028, loss=0.11672182381153107, param_norm=1887.1329345703125
Step 725: grad_norm=1.4327212572097778, loss=0.12263686954975128, param_norm=1887.1329345703125
23:34:42.083 [I] Progress on: 725it/1.00kit rate:8.9s/it remaining:40:47 elapsed:1:49:21 postfix:- (286571:tqdm_logging.py:145)
Step 726: grad_norm=1.3703348636627197, loss=0.14810027182102203, param_norm=1887.133056640625
Step 727: grad_norm=1.8763532638549805, loss=0.1255868673324585, param_norm=1887.133056640625
23:34:59.810 [I] Progress on: 727it/1.00kit rate:8.9s/it remaining:40:25 elapsed:1:49:39 postfix:- (286571:tqdm_logging.py:145)
Step 728: grad_norm=1.7695051431655884, loss=0.1533820927143097, param_norm=1887.1331787109375
Step 729: grad_norm=1.4868576526641846, loss=0.12351425737142563, param_norm=1887.13330078125
23:35:17.494 [I] Progress on: 729it/1.00kit rate:8.9s/it remaining:40:02 elapsed:1:49:56 postfix:- (286571:tqdm_logging.py:145)
Step 730: grad_norm=1.4070124626159668, loss=0.11663421988487244, param_norm=1887.13330078125
Step 731: grad_norm=1.2562437057495117, loss=0.12016941606998444, param_norm=1887.1334228515625
23:35:35.168 [I] Progress on: 731it/1.00kit rate:8.9s/it remaining:39:40 elapsed:1:50:14 postfix:- (286571:tqdm_logging.py:145)
Step 732: grad_norm=1.1727890968322754, loss=0.11332837492227554, param_norm=1887.1334228515625
Step 733: grad_norm=1.8624236583709717, loss=0.13611216843128204, param_norm=1887.133544921875
23:35:52.856 [I] Progress on: 733it/1.00kit rate:8.8s/it remaining:39:22 elapsed:1:50:32 postfix:- (286571:tqdm_logging.py:145)
Step 734: grad_norm=1.840246319770813, loss=0.14259323477745056, param_norm=1887.133544921875
23:36:04.192 [I] Progress on: 735it/1.00kit rate:9.5s/it remaining:42:02 elapsed:1:50:43 postfix:- (286571:tqdm_logging.py:145)
Step 735: grad_norm=1.191120982170105, loss=0.12904317677021027, param_norm=1887.1336669921875
Step 736: grad_norm=1.2966673374176025, loss=0.11653512716293335, param_norm=1887.1336669921875
23:36:21.593 [I] Progress on: 736it/1.00kit rate:9.3s/it remaining:40:57 elapsed:1:51:00 postfix:- (286571:tqdm_logging.py:145)
Step 737: grad_norm=1.3324390649795532, loss=0.13629470765590668, param_norm=1887.1337890625
Step 738: grad_norm=1.3408679962158203, loss=0.12865202128887177, param_norm=1887.1339111328125
23:36:39.234 [I] Progress on: 738it/1.00kit rate:9.1s/it remaining:39:33 elapsed:1:51:18 postfix:- (286571:tqdm_logging.py:145)
Step 739: grad_norm=1.2540390491485596, loss=0.1180010437965393, param_norm=1887.1339111328125
Step 740: grad_norm=1.162356972694397, loss=0.10620825737714767, param_norm=1887.1339111328125
23:36:56.880 [I] Progress on: 740it/1.00kit rate:8.9s/it remaining:38:43 elapsed:1:51:36 postfix:- (286571:tqdm_logging.py:145)
Step 741: grad_norm=1.1056841611862183, loss=0.09769691526889801, param_norm=1887.1339111328125
Step 742: grad_norm=1.2768586874008179, loss=0.11417044699192047, param_norm=1887.134033203125
23:37:14.503 [I] Progress on: 742it/1.00kit rate:8.9s/it remaining:38:10 elapsed:1:51:53 postfix:- (286571:tqdm_logging.py:145)
Step 743: grad_norm=1.1836389303207397, loss=0.1247539147734642, param_norm=1887.134033203125
Step 744: grad_norm=1.362216591835022, loss=0.11541509628295898, param_norm=1887.1341552734375
23:37:32.135 [I] Progress on: 744it/1.00kit rate:8.8s/it remaining:37:44 elapsed:1:52:11 postfix:- (286571:tqdm_logging.py:145)
Step 745: grad_norm=1.3561069965362549, loss=0.12107504904270172, param_norm=1887.1341552734375
Step 746: grad_norm=1.1256047487258911, loss=0.11262005567550659, param_norm=1887.1341552734375
23:37:49.790 [I] Progress on: 746it/1.00kit rate:8.8s/it remaining:37:24 elapsed:1:52:28 postfix:- (286571:tqdm_logging.py:145)
Step 747: grad_norm=1.5698131322860718, loss=0.12895946204662323, param_norm=1887.13427734375
Step 748: grad_norm=1.0539706945419312, loss=0.124274343252182, param_norm=1887.13427734375
23:38:07.422 [I] Progress on: 748it/1.00kit rate:8.8s/it remaining:37:04 elapsed:1:52:46 postfix:- (286571:tqdm_logging.py:145)
Step 749: grad_norm=1.1484588384628296, loss=0.09114407747983932, param_norm=1887.13427734375
Step 750: grad_norm=1.225904107093811, loss=0.11685578525066376, param_norm=1887.134521484375
23:38:25.056 [I] Progress on: 750it/1.00kit rate:8.8s/it remaining:36:45 elapsed:1:53:04 postfix:- (286571:tqdm_logging.py:145)
Step 751: grad_norm=1.0413106679916382, loss=0.10419024527072906, param_norm=1887.134521484375
Step 752: grad_norm=1.2416716814041138, loss=0.11247944086790085, param_norm=1887.134521484375
23:38:42.721 [I] Progress on: 752it/1.00kit rate:8.8s/it remaining:36:29 elapsed:1:53:21 postfix:- (286571:tqdm_logging.py:145)
Step 753: grad_norm=2.15004825592041, loss=0.13099953532218933, param_norm=1887.1346435546875
Step 754: grad_norm=1.199448585510254, loss=0.1084790751338005, param_norm=1887.1346435546875
23:39:00.426 [I] Progress on: 754it/1.00kit rate:8.8s/it remaining:36:14 elapsed:1:53:39 postfix:- (286571:tqdm_logging.py:145)
Step 755: grad_norm=1.1115257740020752, loss=0.09105648100376129, param_norm=1887.134765625
23:39:14.558 [I] Progress on: 756it/1.00kit rate:10.4s/it remaining:42:06 elapsed:1:53:53 postfix:- (286571:tqdm_logging.py:145)
Step 756: grad_norm=1.047062873840332, loss=0.10327054560184479, param_norm=1887.134765625
Step 757: grad_norm=0.8776265382766724, loss=0.10275950282812119, param_norm=1887.134765625
23:39:31.808 [I] Progress on: 757it/1.00kit rate:9.9s/it remaining:39:54 elapsed:1:54:11 postfix:- (286571:tqdm_logging.py:145)
Step 758: grad_norm=0.8654431104660034, loss=0.10248300433158875, param_norm=1887.1348876953125
Step 759: grad_norm=1.2756845951080322, loss=0.11083361506462097, param_norm=1887.1348876953125
23:39:49.430 [I] Progress on: 759it/1.00kit rate:9.3s/it remaining:37:25 elapsed:1:54:28 postfix:- (286571:tqdm_logging.py:145)
Step 760: grad_norm=1.2593615055084229, loss=0.1171211302280426, param_norm=1887.1348876953125
Step 761: grad_norm=0.978547990322113, loss=0.1074725016951561, param_norm=1887.135009765625
23:40:07.085 [I] Progress on: 761it/1.00kit rate:9.1s/it remaining:36:06 elapsed:1:54:46 postfix:- (286571:tqdm_logging.py:145)
Step 762: grad_norm=1.8479394912719727, loss=0.12430981546640396, param_norm=1887.135009765625
Step 763: grad_norm=1.2563202381134033, loss=0.11744297295808792, param_norm=1887.135009765625
23:40:24.761 [I] Progress on: 763it/1.00kit rate:9.0s/it remaining:35:21 elapsed:1:55:03 postfix:- (286571:tqdm_logging.py:145)
Step 764: grad_norm=1.0661227703094482, loss=0.1032961755990982, param_norm=1887.1351318359375
Step 765: grad_norm=1.7149226665496826, loss=0.1416834592819214, param_norm=1887.1351318359375
23:40:42.426 [I] Progress on: 765it/1.00kit rate:8.9s/it remaining:34:49 elapsed:1:55:21 postfix:- (286571:tqdm_logging.py:145)
Step 766: grad_norm=1.3708243370056152, loss=0.11221875995397568, param_norm=1887.13525390625
Step 767: grad_norm=2.0296740531921387, loss=0.13857777416706085, param_norm=1887.13525390625
23:41:00.067 [I] Progress on: 767it/1.00kit rate:8.9s/it remaining:34:23 elapsed:1:55:39 postfix:- (286571:tqdm_logging.py:145)
Step 768: grad_norm=1.1288961172103882, loss=0.10017386823892593, param_norm=1887.1353759765625
Step 769: grad_norm=1.5252182483673096, loss=0.12090720236301422, param_norm=1887.1353759765625
23:41:17.715 [I] Progress on: 769it/1.00kit rate:8.8s/it remaining:34:01 elapsed:1:55:56 postfix:- (286571:tqdm_logging.py:145)
Step 770: grad_norm=1.1931184530258179, loss=0.10570813715457916, param_norm=1887.1353759765625
Step 771: grad_norm=1.23738431930542, loss=0.11144401133060455, param_norm=1887.135498046875
23:41:35.372 [I] Progress on: 771it/1.00kit rate:8.8s/it remaining:33:43 elapsed:1:56:14 postfix:- (286571:tqdm_logging.py:145)
Step 772: grad_norm=3.886894702911377, loss=0.13413280248641968, param_norm=1887.135498046875
Step 773: grad_norm=1.1361944675445557, loss=0.09668269753456116, param_norm=1887.1356201171875
23:41:53.042 [I] Progress on: 773it/1.00kit rate:8.8s/it remaining:33:25 elapsed:1:56:32 postfix:- (286571:tqdm_logging.py:145)
Step 774: grad_norm=1.6186449527740479, loss=0.10433291643857956, param_norm=1887.1356201171875
Step 775: grad_norm=1.3807165622711182, loss=0.10213329643011093, param_norm=1887.1357421875
23:42:10.721 [I] Progress on: 775it/1.00kit rate:8.8s/it remaining:33:08 elapsed:1:56:49 postfix:- (286571:tqdm_logging.py:145)
Step 776: grad_norm=1.5703762769699097, loss=0.11912441998720169, param_norm=1887.1357421875
23:42:21.991 [I] Progress on: 777it/1.00kit rate:9.5s/it remaining:35:17 elapsed:1:57:01 postfix:- (286571:tqdm_logging.py:145)
Step 777: grad_norm=1.5845682621002197, loss=0.09606073796749115, param_norm=1887.1357421875
Step 778: grad_norm=0.7223562002182007, loss=0.09020460397005081, param_norm=1887.1357421875
23:42:39.382 [I] Progress on: 778it/1.00kit rate:9.3s/it remaining:34:22 elapsed:1:57:18 postfix:- (286571:tqdm_logging.py:145)
Step 779: grad_norm=0.723014771938324, loss=0.08369231224060059, param_norm=1887.1358642578125
Step 780: grad_norm=0.9321070313453674, loss=0.08008988201618195, param_norm=1887.1358642578125
23:42:57.024 [I] Progress on: 780it/1.00kit rate:9.0s/it remaining:33:10 elapsed:1:57:36 postfix:- (286571:tqdm_logging.py:145)
Step 781: grad_norm=0.8432783484458923, loss=0.08949825167655945, param_norm=1887.1358642578125
Step 782: grad_norm=1.3683240413665771, loss=0.10980452597141266, param_norm=1887.1361083984375
23:43:14.663 [I] Progress on: 782it/1.00kit rate:8.9s/it remaining:32:27 elapsed:1:57:53 postfix:- (286571:tqdm_logging.py:145)
Step 783: grad_norm=1.5847079753875732, loss=0.11682068556547165, param_norm=1887.1361083984375
Step 784: grad_norm=1.9736411571502686, loss=0.10600338131189346, param_norm=1887.1361083984375
23:43:32.351 [I] Progress on: 784it/1.00kit rate:8.9s/it remaining:31:59 elapsed:1:58:11 postfix:- (286571:tqdm_logging.py:145)
Step 785: grad_norm=0.9397321939468384, loss=0.10556978732347488, param_norm=1887.13623046875
Step 786: grad_norm=1.4276798963546753, loss=0.13831548392772675, param_norm=1887.13623046875
23:43:50.010 [I] Progress on: 786it/1.00kit rate:8.9s/it remaining:31:34 elapsed:1:58:29 postfix:- (286571:tqdm_logging.py:145)
Step 787: grad_norm=0.9385546445846558, loss=0.09603051841259003, param_norm=1887.1363525390625
Step 788: grad_norm=0.8715175986289978, loss=0.08601099252700806, param_norm=1887.1363525390625
23:44:07.662 [I] Progress on: 788it/1.00kit rate:8.8s/it remaining:31:13 elapsed:1:58:46 postfix:- (286571:tqdm_logging.py:145)
Step 789: grad_norm=1.5288796424865723, loss=0.09770116955041885, param_norm=1887.1363525390625
Step 790: grad_norm=1.0434622764587402, loss=0.10353417694568634, param_norm=1887.1363525390625
23:44:25.324 [I] Progress on: 790it/1.00kit rate:8.8s/it remaining:30:55 elapsed:1:59:04 postfix:- (286571:tqdm_logging.py:145)
Step 791: grad_norm=1.3510420322418213, loss=0.10855706036090851, param_norm=1887.136474609375
Step 792: grad_norm=1.7780206203460693, loss=0.11142674088478088, param_norm=1887.136474609375
23:44:42.976 [I] Progress on: 792it/1.00kit rate:8.8s/it remaining:30:36 elapsed:1:59:22 postfix:- (286571:tqdm_logging.py:145)
Step 793: grad_norm=1.4915505647659302, loss=0.10836438834667206, param_norm=1887.136474609375
Step 794: grad_norm=0.7833884954452515, loss=0.09771396219730377, param_norm=1887.136474609375
23:45:00.637 [I] Progress on: 794it/1.00kit rate:8.8s/it remaining:30:19 elapsed:1:59:39 postfix:- (286571:tqdm_logging.py:145)
Step 795: grad_norm=1.0912834405899048, loss=0.10978668928146362, param_norm=1887.1365966796875
Step 796: grad_norm=1.1481385231018066, loss=0.10638780891895294, param_norm=1887.1365966796875
23:45:18.325 [I] Progress on: 796it/1.00kit rate:8.8s/it remaining:30:02 elapsed:1:59:57 postfix:- (286571:tqdm_logging.py:145)
Step 797: grad_norm=1.4026648998260498, loss=0.11185185611248016, param_norm=1887.1365966796875
23:45:29.684 [I] Progress on: 798it/1.00kit rate:9.5s/it remaining:32:03 elapsed:2:00:08 postfix:- (286571:tqdm_logging.py:145)
Step 798: grad_norm=0.8558558225631714, loss=0.11133822053670883, param_norm=1887.1365966796875
Step 799: grad_norm=0.8334817886352539, loss=0.09294726699590683, param_norm=1887.1365966796875
23:45:47.099 [I] Progress on: 799it/1.00kit rate:9.3s/it remaining:31:11 elapsed:2:00:26 postfix:- (286571:tqdm_logging.py:145)
Step 800: grad_norm=1.0258595943450928, loss=0.09479570388793945, param_norm=1887.13671875
23:45:56.214 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
23:45:56.215 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
23:45:56.215 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (286571:checkpoint_manager.py:1786)
23:45:56.215 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (286571:checkpoint_manager.py:1817)
23:45:56.215 [I] [process=0] Saving checkpoint at step 800                                        (286571:checkpoint_manager.py:1286)
23:45:56.216 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800. (286571:async_checkpointer.py:358)
23:45:56.217 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:45:56.218 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21 (286571:atomicity.py:144)
23:45:56.219 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:45:56.219 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
23:45:56.220 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (286571:atomicity.py:144)
23:45:56.220 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (286571:atomicity.py:144)
23:45:56.221 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
23:45:56.226 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
23:45:59.788 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:45:59.795 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
23:45:59.797 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
23:45:59.799 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
23:45:59.801 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.806 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.809 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.810 [I] Preserving Checkpoint[step=400 | time=2025-03-25 02:45:39.182429+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.814 [I] Preserving Checkpoint[step=500 | time=2025-03-25 03:00:40.924660+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.815 [I] Preserving Checkpoint[step=600 | time=2025-03-25 03:15:45.187992+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.816 [I] Preserving Checkpoint[step=700 | time=2025-03-25 03:30:57.606600+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
23:45:59.818 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
23:45:59.823 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
23:45:59.828 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
23:45:59.831 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742874356.2147515, 'wait_for_prev_duration_secs': 0.0007288455963134766, 'checkpointer_blocking_start_time': 1742874356.2160864, 'checkpointer_blocking_duration_secs': 3.5852322578430176, 'get_old_steps_start_time': 1742874359.8015063, 'get_old_steps_duration_secs': 0.01679539680480957, 'checkpoint_manager_blocking_start_time': 1742874356.2145534, 'checkpoint_manager_blocking_duration_secs': 3.6167800426483154} (286571:standard_logger.py:34)
23:45:59.839 [I] Progress on: 801it/1.00kit rate:10.2s/it remaining:33:42 elapsed:2:00:39 postfix:- (286571:tqdm_logging.py:145)
23:46:07.616 [I] ChainedFuture completed 1/1 futures in 7.82 seconds.                             (286571:future.py:137)
23:46:07.617 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 909.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
23:46:07.618 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
23:46:07.619 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21 (286571:async_checkpointer.py:406)
23:46:07.620 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21/assets (286571:atomicity.py:287)
23:46:07.631 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21/params (286571:atomicity.py:287)
23:46:07.632 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800 (286571:async_checkpointer.py:416)
23:46:07.632 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21 (286571:async_checkpointer.py:426)
23:46:07.633 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800 (286571:atomicity.py:287)
23:46:07.635 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/800`. (286571:atomicity.py:548)
23:46:07.635 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
23:46:07.636 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
23:46:07.636 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
23:46:07.637 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
23:46:07.637 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 801: grad_norm=1.1360533237457275, loss=0.10729587078094482, param_norm=1887.13671875
Step 802: grad_norm=1.0910831689834595, loss=0.10003448277711868, param_norm=1887.13671875
23:46:17.295 [I] Progress on: 802it/1.00kit rate:9.8s/it remaining:32:15 elapsed:2:00:56 postfix:- (286571:tqdm_logging.py:145)
Step 803: grad_norm=0.9095938801765442, loss=0.10567016899585724, param_norm=1887.13671875
Step 804: grad_norm=1.600010633468628, loss=0.09491270035505295, param_norm=1887.1368408203125
23:46:34.970 [I] Progress on: 804it/1.00kit rate:9.3s/it remaining:30:21 elapsed:2:01:14 postfix:- (286571:tqdm_logging.py:145)
Step 805: grad_norm=1.0304350852966309, loss=0.09150377660989761, param_norm=1887.1368408203125
Step 806: grad_norm=0.9609646201133728, loss=0.09643241763114929, param_norm=1887.1368408203125
23:46:52.619 [I] Progress on: 806it/1.00kit rate:9.1s/it remaining:29:16 elapsed:2:01:31 postfix:- (286571:tqdm_logging.py:145)
Step 807: grad_norm=1.098961591720581, loss=0.0967266857624054, param_norm=1887.1368408203125
Step 808: grad_norm=1.1130270957946777, loss=0.09774292260408401, param_norm=1887.1368408203125
23:47:10.286 [I] Progress on: 808it/1.00kit rate:8.9s/it remaining:28:36 elapsed:2:01:49 postfix:- (286571:tqdm_logging.py:145)
Step 809: grad_norm=0.8705167770385742, loss=0.09357553720474243, param_norm=1887.136962890625
Step 810: grad_norm=0.8924460411071777, loss=0.09086398780345917, param_norm=1887.136962890625
23:47:27.937 [I] Progress on: 810it/1.00kit rate:8.9s/it remaining:28:07 elapsed:2:02:07 postfix:- (286571:tqdm_logging.py:145)
Step 811: grad_norm=0.916221559047699, loss=0.09326484799385071, param_norm=1887.1370849609375
Step 812: grad_norm=1.9757258892059326, loss=0.10114146023988724, param_norm=1887.1370849609375
23:47:45.594 [I] Progress on: 812it/1.00kit rate:8.9s/it remaining:27:44 elapsed:2:02:24 postfix:- (286571:tqdm_logging.py:145)
Step 813: grad_norm=0.8677831888198853, loss=0.08528293669223785, param_norm=1887.1370849609375
Step 814: grad_norm=1.2450464963912964, loss=0.10091540217399597, param_norm=1887.13720703125
23:48:03.256 [I] Progress on: 814it/1.00kit rate:8.8s/it remaining:27:24 elapsed:2:02:42 postfix:- (286571:tqdm_logging.py:145)
Step 815: grad_norm=0.9255072474479675, loss=0.09190124273300171, param_norm=1887.13720703125
Step 816: grad_norm=1.3676968812942505, loss=0.10474912077188492, param_norm=1887.1373291015625
23:48:20.924 [I] Progress on: 816it/1.00kit rate:8.8s/it remaining:27:06 elapsed:2:03:00 postfix:- (286571:tqdm_logging.py:145)
Step 817: grad_norm=0.8778876066207886, loss=0.09044723957777023, param_norm=1887.1373291015625
Step 818: grad_norm=0.9268956780433655, loss=0.08587778359651566, param_norm=1887.1373291015625
23:48:38.587 [I] Progress on: 818it/1.00kit rate:8.8s/it remaining:26:47 elapsed:2:03:17 postfix:- (286571:tqdm_logging.py:145)
Step 819: grad_norm=0.9736127257347107, loss=0.1019405946135521, param_norm=1887.1373291015625
23:48:49.679 [I] Progress on: 819it/1.00kit rate:9.5s/it remaining:28:42 elapsed:2:03:28 postfix:- (286571:tqdm_logging.py:145)
Step 820: grad_norm=1.0556347370147705, loss=0.0800892785191536, param_norm=1887.137451171875
Step 821: grad_norm=0.9931703805923462, loss=0.08954747021198273, param_norm=1887.137451171875
23:49:07.315 [I] Progress on: 821it/1.00kit rate:9.2s/it remaining:27:19 elapsed:2:03:46 postfix:- (286571:tqdm_logging.py:145)
Step 822: grad_norm=1.0591965913772583, loss=0.08841924369335175, param_norm=1887.137451171875
Step 823: grad_norm=1.1301876306533813, loss=0.09643581509590149, param_norm=1887.1375732421875
23:49:24.972 [I] Progress on: 823it/1.00kit rate:9.0s/it remaining:26:31 elapsed:2:04:04 postfix:- (286571:tqdm_logging.py:145)
Step 824: grad_norm=0.7649887204170227, loss=0.08212843537330627, param_norm=1887.1375732421875
Step 825: grad_norm=0.8888062238693237, loss=0.10432448983192444, param_norm=1887.1375732421875
23:49:42.619 [I] Progress on: 825it/1.00kit rate:8.9s/it remaining:25:58 elapsed:2:04:21 postfix:- (286571:tqdm_logging.py:145)
Step 826: grad_norm=1.1814649105072021, loss=0.09495087713003159, param_norm=1887.1376953125
Step 827: grad_norm=1.0855982303619385, loss=0.09680914878845215, param_norm=1887.1378173828125
23:50:00.271 [I] Progress on: 827it/1.00kit rate:8.9s/it remaining:25:33 elapsed:2:04:39 postfix:- (286571:tqdm_logging.py:145)
Step 828: grad_norm=0.7849907279014587, loss=0.08503693342208862, param_norm=1887.1378173828125
Step 829: grad_norm=0.8469821810722351, loss=0.08730913698673248, param_norm=1887.1378173828125
23:50:17.931 [I] Progress on: 829it/1.00kit rate:8.8s/it remaining:25:12 elapsed:2:04:57 postfix:- (286571:tqdm_logging.py:145)
Step 830: grad_norm=1.195630431175232, loss=0.10197682678699493, param_norm=1887.1378173828125
Step 831: grad_norm=1.0484366416931152, loss=0.10203611850738525, param_norm=1887.137939453125
23:50:35.583 [I] Progress on: 831it/1.00kit rate:8.8s/it remaining:24:53 elapsed:2:05:14 postfix:- (286571:tqdm_logging.py:145)
Step 832: grad_norm=0.9911931157112122, loss=0.09228350222110748, param_norm=1887.137939453125
Step 833: grad_norm=0.6976746916770935, loss=0.07138022035360336, param_norm=1887.137939453125
23:50:53.245 [I] Progress on: 833it/1.00kit rate:8.8s/it remaining:24:35 elapsed:2:05:32 postfix:- (286571:tqdm_logging.py:145)
Step 834: grad_norm=0.6857234239578247, loss=0.08323249965906143, param_norm=1887.137939453125
Step 835: grad_norm=0.9538482427597046, loss=0.09245660156011581, param_norm=1887.1380615234375
23:51:10.894 [I] Progress on: 835it/1.00kit rate:8.8s/it remaining:24:17 elapsed:2:05:50 postfix:- (286571:tqdm_logging.py:145)
Step 836: grad_norm=1.5648053884506226, loss=0.10736346244812012, param_norm=1887.1380615234375
Step 837: grad_norm=0.989791989326477, loss=0.0766381025314331, param_norm=1887.1380615234375
23:51:28.540 [I] Progress on: 837it/1.00kit rate:8.8s/it remaining:23:58 elapsed:2:06:07 postfix:- (286571:tqdm_logging.py:145)
Step 838: grad_norm=1.4066753387451172, loss=0.11171379685401917, param_norm=1887.1380615234375
Step 839: grad_norm=0.7176008820533752, loss=0.08077244460582733, param_norm=1887.1380615234375
23:51:46.231 [I] Progress on: 839it/1.00kit rate:8.8s/it remaining:23:42 elapsed:2:06:25 postfix:- (286571:tqdm_logging.py:145)
Step 840: grad_norm=0.7428736686706543, loss=0.0807444155216217, param_norm=1887.1380615234375
23:51:57.502 [I] Progress on: 840it/1.00kit rate:9.6s/it remaining:25:31 elapsed:2:06:36 postfix:- (286571:tqdm_logging.py:145)
Step 841: grad_norm=0.8613502383232117, loss=0.07227067649364471, param_norm=1887.13818359375
Step 842: grad_norm=0.7650400996208191, loss=0.09621864557266235, param_norm=1887.13818359375
23:52:15.046 [I] Progress on: 842it/1.00kit rate:9.2s/it remaining:24:09 elapsed:2:06:54 postfix:- (286571:tqdm_logging.py:145)
Step 843: grad_norm=0.862200915813446, loss=0.09657281637191772, param_norm=1887.13818359375
Step 844: grad_norm=0.78397136926651, loss=0.07982395589351654, param_norm=1887.13818359375
23:52:32.693 [I] Progress on: 844it/1.00kit rate:9.0s/it remaining:23:24 elapsed:2:07:11 postfix:- (286571:tqdm_logging.py:145)
Step 845: grad_norm=0.8934720754623413, loss=0.08867020905017853, param_norm=1887.1383056640625
Step 846: grad_norm=0.5872147679328918, loss=0.07510840147733688, param_norm=1887.1383056640625
23:52:50.363 [I] Progress on: 846it/1.00kit rate:8.9s/it remaining:22:55 elapsed:2:07:29 postfix:- (286571:tqdm_logging.py:145)
Step 847: grad_norm=0.5483896732330322, loss=0.10110089182853699, param_norm=1887.1383056640625
Step 848: grad_norm=1.0282371044158936, loss=0.09920668601989746, param_norm=1887.138427734375
23:53:08.066 [I] Progress on: 848it/1.00kit rate:8.9s/it remaining:22:32 elapsed:2:07:47 postfix:- (286571:tqdm_logging.py:145)
Step 849: grad_norm=0.621884286403656, loss=0.07771401852369308, param_norm=1887.138427734375
Step 850: grad_norm=0.5007538199424744, loss=0.06205163896083832, param_norm=1887.138427734375
23:53:25.709 [I] Progress on: 850it/1.00kit rate:8.9s/it remaining:22:10 elapsed:2:08:04 postfix:- (286571:tqdm_logging.py:145)
Step 851: grad_norm=0.6453964114189148, loss=0.08437256515026093, param_norm=1887.1385498046875
Step 852: grad_norm=0.9434036612510681, loss=0.09100702404975891, param_norm=1887.1385498046875
23:53:43.278 [I] Progress on: 852it/1.00kit rate:8.8s/it remaining:21:47 elapsed:2:08:22 postfix:- (286571:tqdm_logging.py:145)
Step 853: grad_norm=0.9236270785331726, loss=0.08665381371974945, param_norm=1887.1385498046875
Step 854: grad_norm=1.4218294620513916, loss=0.10235708951950073, param_norm=1887.1385498046875
23:54:00.938 [I] Progress on: 854it/1.00kit rate:8.8s/it remaining:21:31 elapsed:2:08:40 postfix:- (286571:tqdm_logging.py:145)
Step 855: grad_norm=0.7092873454093933, loss=0.06970080733299255, param_norm=1887.1385498046875
Step 856: grad_norm=0.9058041572570801, loss=0.07691772282123566, param_norm=1887.1385498046875
23:54:18.525 [I] Progress on: 856it/1.00kit rate:8.8s/it remaining:21:10 elapsed:2:08:57 postfix:- (286571:tqdm_logging.py:145)
Step 857: grad_norm=1.007309913635254, loss=0.0969163179397583, param_norm=1887.1385498046875
Step 858: grad_norm=0.883578360080719, loss=0.09517273306846619, param_norm=1887.138671875
23:54:36.188 [I] Progress on: 858it/1.00kit rate:8.8s/it remaining:20:54 elapsed:2:09:15 postfix:- (286571:tqdm_logging.py:145)
Step 859: grad_norm=0.8929410576820374, loss=0.08764048665761948, param_norm=1887.138671875
Step 860: grad_norm=0.907406210899353, loss=0.08537308871746063, param_norm=1887.138671875
23:54:53.660 [I] Progress on: 860it/1.00kit rate:8.8s/it remaining:20:30 elapsed:2:09:32 postfix:- (286571:tqdm_logging.py:145)
Step 861: grad_norm=0.5147424340248108, loss=0.07026121765375137, param_norm=1887.138671875
23:55:04.819 [I] Progress on: 861it/1.00kit rate:9.5s/it remaining:22:00 elapsed:2:09:44 postfix:- (286571:tqdm_logging.py:145)
Step 862: grad_norm=0.9588030576705933, loss=0.08506560325622559, param_norm=1887.138671875
Step 863: grad_norm=0.420306533575058, loss=0.07011274993419647, param_norm=1887.138671875
23:55:22.412 [I] Progress on: 863it/1.00kit rate:9.1s/it remaining:20:53 elapsed:2:10:01 postfix:- (286571:tqdm_logging.py:145)
Step 864: grad_norm=1.047466516494751, loss=0.08639593422412872, param_norm=1887.1387939453125
Step 865: grad_norm=0.9928756356239319, loss=0.08128826320171356, param_norm=1887.1387939453125
23:55:40.008 [I] Progress on: 865it/1.00kit rate:9.0s/it remaining:20:11 elapsed:2:10:19 postfix:- (286571:tqdm_logging.py:145)
Step 866: grad_norm=0.6532673835754395, loss=0.0841435119509697, param_norm=1887.1387939453125
Step 867: grad_norm=0.693416178226471, loss=0.09051331877708435, param_norm=1887.1387939453125
23:55:57.598 [I] Progress on: 867it/1.00kit rate:8.9s/it remaining:19:41 elapsed:2:10:36 postfix:- (286571:tqdm_logging.py:145)
Step 868: grad_norm=0.6478301286697388, loss=0.06917537748813629, param_norm=1887.138916015625
Step 869: grad_norm=0.8347600102424622, loss=0.07483118772506714, param_norm=1887.138916015625
23:56:15.193 [I] Progress on: 869it/1.00kit rate:8.8s/it remaining:19:18 elapsed:2:10:54 postfix:- (286571:tqdm_logging.py:145)
Step 870: grad_norm=0.8417797088623047, loss=0.07821503281593323, param_norm=1887.138916015625
Step 871: grad_norm=0.638749361038208, loss=0.08853137493133545, param_norm=1887.138916015625
23:56:32.783 [I] Progress on: 871it/1.00kit rate:8.8s/it remaining:18:57 elapsed:2:11:11 postfix:- (286571:tqdm_logging.py:145)
Step 872: grad_norm=0.6595633625984192, loss=0.07897621393203735, param_norm=1887.138916015625
Step 873: grad_norm=1.1216732263565063, loss=0.084123395383358, param_norm=1887.138916015625
23:56:50.382 [I] Progress on: 873it/1.00kit rate:8.8s/it remaining:18:39 elapsed:2:11:29 postfix:- (286571:tqdm_logging.py:145)
Step 874: grad_norm=0.870319128036499, loss=0.10019990056753159, param_norm=1887.13916015625
Step 875: grad_norm=1.0255564451217651, loss=0.07828497141599655, param_norm=1887.13916015625
23:57:07.985 [I] Progress on: 875it/1.00kit rate:8.8s/it remaining:18:21 elapsed:2:11:47 postfix:- (286571:tqdm_logging.py:145)
Step 876: grad_norm=0.9348868131637573, loss=0.08968925476074219, param_norm=1887.13916015625
Step 877: grad_norm=0.7683998942375183, loss=0.08055122196674347, param_norm=1887.13916015625
23:57:25.588 [I] Progress on: 877it/1.00kit rate:8.8s/it remaining:18:03 elapsed:2:12:04 postfix:- (286571:tqdm_logging.py:145)
Step 878: grad_norm=0.44485387206077576, loss=0.06032896786928177, param_norm=1887.1392822265625
Step 879: grad_norm=0.5548458099365234, loss=0.08833488076925278, param_norm=1887.1392822265625
23:57:43.249 [I] Progress on: 879it/1.00kit rate:8.8s/it remaining:17:47 elapsed:2:12:22 postfix:- (286571:tqdm_logging.py:145)
Step 880: grad_norm=1.2955554723739624, loss=0.08161051571369171, param_norm=1887.1392822265625
Step 881: grad_norm=0.7488887906074524, loss=0.08722038567066193, param_norm=1887.1392822265625
23:58:00.838 [I] Progress on: 881it/1.00kit rate:8.8s/it remaining:17:28 elapsed:2:12:40 postfix:- (286571:tqdm_logging.py:145)
Step 882: grad_norm=0.8393747806549072, loss=0.07335512340068817, param_norm=1887.1392822265625
23:58:11.946 [I] Progress on: 882it/1.00kit rate:9.5s/it remaining:18:41 elapsed:2:12:51 postfix:- (286571:tqdm_logging.py:145)
Step 883: grad_norm=0.4642660617828369, loss=0.06372736394405365, param_norm=1887.1392822265625
Step 884: grad_norm=0.5913757085800171, loss=0.08880135416984558, param_norm=1887.1392822265625
23:58:29.531 [I] Progress on: 884it/1.00kit rate:9.1s/it remaining:17:40 elapsed:2:13:08 postfix:- (286571:tqdm_logging.py:145)
Step 885: grad_norm=0.8384209871292114, loss=0.08750079572200775, param_norm=1887.139404296875
Step 886: grad_norm=0.7060756683349609, loss=0.084564208984375, param_norm=1887.139404296875
23:58:47.107 [I] Progress on: 886it/1.00kit rate:9.0s/it remaining:17:01 elapsed:2:13:26 postfix:- (286571:tqdm_logging.py:145)
Step 887: grad_norm=0.6090119481086731, loss=0.06911017000675201, param_norm=1887.139404296875
Step 888: grad_norm=0.6738690137863159, loss=0.07860969007015228, param_norm=1887.139404296875
23:59:04.689 [I] Progress on: 888it/1.00kit rate:8.9s/it remaining:16:33 elapsed:2:13:43 postfix:- (286571:tqdm_logging.py:145)
Step 889: grad_norm=0.6305133104324341, loss=0.07254667580127716, param_norm=1887.139404296875
Step 890: grad_norm=0.8136036992073059, loss=0.07299993932247162, param_norm=1887.1395263671875
23:59:22.516 [I] Progress on: 890it/1.00kit rate:8.9s/it remaining:16:18 elapsed:2:14:01 postfix:- (286571:tqdm_logging.py:145)
Step 891: grad_norm=0.8419085144996643, loss=0.08652161806821823, param_norm=1887.1395263671875
Step 892: grad_norm=0.84815913438797, loss=0.08436018228530884, param_norm=1887.1395263671875
23:59:40.151 [I] Progress on: 892it/1.00kit rate:8.9s/it remaining:15:56 elapsed:2:14:19 postfix:- (286571:tqdm_logging.py:145)
Step 893: grad_norm=1.0614590644836426, loss=0.08432020992040634, param_norm=1887.1395263671875
Step 894: grad_norm=0.7535565495491028, loss=0.08516795933246613, param_norm=1887.1395263671875
23:59:57.745 [I] Progress on: 894it/1.00kit rate:8.8s/it remaining:15:35 elapsed:2:14:36 postfix:- (286571:tqdm_logging.py:145)
Step 895: grad_norm=0.5905134081840515, loss=0.08254054933786392, param_norm=1887.1395263671875
Step 896: grad_norm=0.5609235763549805, loss=0.07553351670503616, param_norm=1887.1395263671875
00:00:15.352 [I] Progress on: 896it/1.00kit rate:8.8s/it remaining:15:16 elapsed:2:14:54 postfix:- (286571:tqdm_logging.py:145)
Step 897: grad_norm=0.6481062173843384, loss=0.06828538328409195, param_norm=1887.1395263671875
Step 898: grad_norm=0.9812057018280029, loss=0.07285155355930328, param_norm=1887.1395263671875
00:00:32.946 [I] Progress on: 898it/1.00kit rate:8.8s/it remaining:14:57 elapsed:2:15:12 postfix:- (286571:tqdm_logging.py:145)
Step 899: grad_norm=1.3196858167648315, loss=0.10209202021360397, param_norm=1887.1395263671875
Step 900: grad_norm=0.7723121643066406, loss=0.07546219974756241, param_norm=1887.1395263671875
00:00:50.556 [I] Progress on: 900it/1.00kit rate:8.8s/it remaining:14:39 elapsed:2:15:29 postfix:- (286571:tqdm_logging.py:145)
00:00:50.807 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
00:00:50.807 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
00:00:50.807 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (286571:checkpoint_manager.py:1786)
00:00:50.807 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (286571:checkpoint_manager.py:1817)
00:00:50.808 [I] [process=0] Saving checkpoint at step 900                                        (286571:checkpoint_manager.py:1286)
00:00:50.809 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900. (286571:async_checkpointer.py:358)
00:00:50.810 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
00:00:50.810 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24 (286571:atomicity.py:144)
00:00:50.811 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
00:00:50.811 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
00:00:50.812 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (286571:atomicity.py:144)
00:00:50.813 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (286571:atomicity.py:144)
00:00:50.813 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
00:00:50.818 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
00:00:54.502 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
00:00:54.504 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
00:00:54.504 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
00:00:54.507 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
00:00:54.524 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.529 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.533 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.536 [I] Preserving Checkpoint[step=400 | time=2025-03-25 02:45:39.182429+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.538 [I] Preserving Checkpoint[step=500 | time=2025-03-25 03:00:40.924660+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.541 [I] Preserving Checkpoint[step=600 | time=2025-03-25 03:15:45.187992+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.542 [I] Preserving Checkpoint[step=700 | time=2025-03-25 03:30:57.606600+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.543 [I] Preserving Checkpoint[step=800 | time=2025-03-25 03:45:59.801388+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:00:54.545 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
00:00:54.548 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
00:00:54.555 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
00:00:54.565 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742875250.807398, 'wait_for_prev_duration_secs': 0.0006453990936279297, 'checkpointer_blocking_start_time': 1742875250.8085425, 'checkpointer_blocking_duration_secs': 3.716262102127075, 'get_old_steps_start_time': 1742875254.5248563, 'get_old_steps_duration_secs': 0.02085423469543457, 'checkpoint_manager_blocking_start_time': 1742875250.8072631, 'checkpoint_manager_blocking_duration_secs': 3.7576651573181152} (286571:standard_logger.py:34)
00:01:01.785 [I] ChainedFuture completed 1/1 futures in 7.26 seconds.                             (286571:future.py:137)
00:01:01.786 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 944.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
00:01:01.786 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
00:01:01.788 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24 (286571:async_checkpointer.py:406)
00:01:01.788 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24/assets (286571:atomicity.py:287)
00:01:01.798 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24/params (286571:atomicity.py:287)
00:01:01.799 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900 (286571:async_checkpointer.py:416)
00:01:01.799 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24 (286571:async_checkpointer.py:426)
00:01:01.800 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900 (286571:atomicity.py:287)
00:01:01.801 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/900`. (286571:atomicity.py:548)
00:01:01.801 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
00:01:01.802 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
00:01:01.802 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
00:01:01.803 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
00:01:01.803 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
Step 901: grad_norm=1.1790266036987305, loss=0.0740073174238205, param_norm=1887.1395263671875
00:01:03.163 [I] Progress on: 901it/1.00kit rate:9.9s/it remaining:16:24 elapsed:2:15:42 postfix:- (286571:tqdm_logging.py:145)
Step 902: grad_norm=0.5805844068527222, loss=0.07929465174674988, param_norm=1887.1396484375
00:01:14.527 [I] Progress on: 903it/1.00kit rate:10.1s/it remaining:16:17 elapsed:2:15:53 postfix:- (286571:tqdm_logging.py:145)
Step 903: grad_norm=0.5980891585350037, loss=0.06389850378036499, param_norm=1887.1396484375
Step 904: grad_norm=0.49196717143058777, loss=0.06936632096767426, param_norm=1887.1396484375
00:01:31.823 [I] Progress on: 904it/1.00kit rate:9.7s/it remaining:15:27 elapsed:2:16:11 postfix:- (286571:tqdm_logging.py:145)
Step 905: grad_norm=0.5585371851921082, loss=0.06844018399715424, param_norm=1887.1396484375
Step 906: grad_norm=0.5719171166419983, loss=0.07137677818536758, param_norm=1887.1396484375
00:01:49.394 [I] Progress on: 906it/1.00kit rate:9.2s/it remaining:14:25 elapsed:2:16:28 postfix:- (286571:tqdm_logging.py:145)
Step 907: grad_norm=0.7821264266967773, loss=0.0802789181470871, param_norm=1887.1396484375
Step 908: grad_norm=0.8631638884544373, loss=0.08678321540355682, param_norm=1887.1396484375
00:02:07.049 [I] Progress on: 908it/1.00kit rate:9.0s/it remaining:13:48 elapsed:2:16:46 postfix:- (286571:tqdm_logging.py:145)
Step 909: grad_norm=0.595441460609436, loss=0.06462669372558594, param_norm=1887.1397705078125
Step 910: grad_norm=0.5845641493797302, loss=0.07583776861429214, param_norm=1887.1397705078125
00:02:24.672 [I] Progress on: 910it/1.00kit rate:8.9s/it remaining:13:20 elapsed:2:17:03 postfix:- (286571:tqdm_logging.py:145)
Step 911: grad_norm=0.5825147032737732, loss=0.07213908433914185, param_norm=1887.1397705078125
Step 912: grad_norm=0.5471096038818359, loss=0.08574487268924713, param_norm=1887.1397705078125
00:02:42.361 [I] Progress on: 912it/1.00kit rate:8.9s/it remaining:12:59 elapsed:2:17:21 postfix:- (286571:tqdm_logging.py:145)
Step 913: grad_norm=0.3994380831718445, loss=0.07705394923686981, param_norm=1887.139892578125
Step 914: grad_norm=0.5995102524757385, loss=0.07009254395961761, param_norm=1887.1397705078125
00:02:59.985 [I] Progress on: 914it/1.00kit rate:8.8s/it remaining:12:38 elapsed:2:17:39 postfix:- (286571:tqdm_logging.py:145)
Step 915: grad_norm=0.5007278919219971, loss=0.078224778175354, param_norm=1887.1397705078125
Step 916: grad_norm=0.6080964207649231, loss=0.06357766687870026, param_norm=1887.139892578125
00:03:17.670 [I] Progress on: 916it/1.00kit rate:8.8s/it remaining:12:21 elapsed:2:17:56 postfix:- (286571:tqdm_logging.py:145)
Step 917: grad_norm=0.5618452429771423, loss=0.08653721213340759, param_norm=1887.139892578125
Step 918: grad_norm=0.6800118088722229, loss=0.0822553038597107, param_norm=1887.139892578125
00:03:35.286 [I] Progress on: 918it/1.00kit rate:8.8s/it remaining:12:02 elapsed:2:18:14 postfix:- (286571:tqdm_logging.py:145)
Step 919: grad_norm=0.617096483707428, loss=0.07120662927627563, param_norm=1887.1400146484375
Step 920: grad_norm=1.2900640964508057, loss=0.08107710629701614, param_norm=1887.1400146484375
00:03:52.977 [I] Progress on: 920it/1.00kit rate:8.8s/it remaining:11:45 elapsed:2:18:32 postfix:- (286571:tqdm_logging.py:145)
Step 921: grad_norm=1.5057562589645386, loss=0.09022779762744904, param_norm=1887.1400146484375
Step 922: grad_norm=0.7597222328186035, loss=0.07466229051351547, param_norm=1887.1400146484375
00:04:10.594 [I] Progress on: 922it/1.00kit rate:8.8s/it remaining:11:26 elapsed:2:18:49 postfix:- (286571:tqdm_logging.py:145)
Step 923: grad_norm=0.7341969609260559, loss=0.07779939472675323, param_norm=1887.1400146484375
00:04:22.296 [I] Progress on: 924it/1.00kit rate:9.6s/it remaining:12:10 elapsed:2:19:01 postfix:- (286571:tqdm_logging.py:145)
Step 924: grad_norm=0.6266093850135803, loss=0.07798649370670319, param_norm=1887.1400146484375
Step 925: grad_norm=0.4375895857810974, loss=0.07196813076734543, param_norm=1887.1400146484375
00:04:39.623 [I] Progress on: 925it/1.00kit rate:9.3s/it remaining:11:40 elapsed:2:19:18 postfix:- (286571:tqdm_logging.py:145)
Step 926: grad_norm=0.5878092050552368, loss=0.07463502883911133, param_norm=1887.1400146484375
Step 927: grad_norm=0.5926986932754517, loss=0.06621836870908737, param_norm=1887.14013671875
00:04:57.303 [I] Progress on: 927it/1.00kit rate:9.1s/it remaining:11:02 elapsed:2:19:36 postfix:- (286571:tqdm_logging.py:145)
Step 928: grad_norm=0.7568604350090027, loss=0.07669384777545929, param_norm=1887.14013671875
Step 929: grad_norm=0.9442626237869263, loss=0.07979902625083923, param_norm=1887.14013671875
00:05:14.914 [I] Progress on: 929it/1.00kit rate:8.9s/it remaining:10:34 elapsed:2:19:54 postfix:- (286571:tqdm_logging.py:145)
Step 930: grad_norm=0.5668531060218811, loss=0.05798470601439476, param_norm=1887.14013671875
Step 931: grad_norm=0.4659424424171448, loss=0.06742130219936371, param_norm=1887.14013671875
00:05:32.586 [I] Progress on: 931it/1.00kit rate:8.9s/it remaining:10:12 elapsed:2:20:11 postfix:- (286571:tqdm_logging.py:145)
Step 932: grad_norm=0.48663192987442017, loss=0.06977543234825134, param_norm=1887.14013671875
Step 933: grad_norm=0.4185013771057129, loss=0.06132133677601814, param_norm=1887.14013671875
00:05:50.189 [I] Progress on: 933it/1.00kit rate:8.8s/it remaining:09:51 elapsed:2:20:29 postfix:- (286571:tqdm_logging.py:145)
Step 934: grad_norm=1.8872443437576294, loss=0.08588701486587524, param_norm=1887.1402587890625
Step 935: grad_norm=0.5360747575759888, loss=0.071387380361557, param_norm=1887.1402587890625
00:06:07.858 [I] Progress on: 935it/1.00kit rate:8.8s/it remaining:09:33 elapsed:2:20:47 postfix:- (286571:tqdm_logging.py:145)
Step 936: grad_norm=0.8605260848999023, loss=0.07255050539970398, param_norm=1887.1402587890625
Step 937: grad_norm=0.5019012093544006, loss=0.06136305257678032, param_norm=1887.1402587890625
00:06:25.486 [I] Progress on: 937it/1.00kit rate:8.8s/it remaining:09:14 elapsed:2:21:04 postfix:- (286571:tqdm_logging.py:145)
Step 938: grad_norm=0.8001900911331177, loss=0.06107800081372261, param_norm=1887.1402587890625
Step 939: grad_norm=0.5559840798377991, loss=0.09154316782951355, param_norm=1887.1402587890625
00:06:43.170 [I] Progress on: 939it/1.00kit rate:8.8s/it remaining:08:57 elapsed:2:21:22 postfix:- (286571:tqdm_logging.py:145)
Step 940: grad_norm=0.518094003200531, loss=0.0811590701341629, param_norm=1887.1402587890625
Step 941: grad_norm=0.6611223220825195, loss=0.08508292585611343, param_norm=1887.1402587890625
00:07:00.794 [I] Progress on: 941it/1.00kit rate:8.8s/it remaining:08:39 elapsed:2:21:39 postfix:- (286571:tqdm_logging.py:145)
Step 942: grad_norm=0.5043730735778809, loss=0.08555115759372711, param_norm=1887.140380859375
Step 943: grad_norm=0.8014001846313477, loss=0.06847210228443146, param_norm=1887.140380859375
00:07:18.482 [I] Progress on: 943it/1.00kit rate:8.8s/it remaining:08:22 elapsed:2:21:57 postfix:- (286571:tqdm_logging.py:145)
Step 944: grad_norm=0.5990856885910034, loss=0.07418026775121689, param_norm=1887.140380859375
00:07:29.701 [I] Progress on: 945it/1.00kit rate:9.5s/it remaining:08:41 elapsed:2:22:08 postfix:- (286571:tqdm_logging.py:145)
Step 945: grad_norm=0.5918892025947571, loss=0.06333538144826889, param_norm=1887.140380859375
Step 946: grad_norm=0.47192198038101196, loss=0.07057762145996094, param_norm=1887.140380859375
00:07:47.089 [I] Progress on: 946it/1.00kit rate:9.3s/it remaining:08:20 elapsed:2:22:26 postfix:- (286571:tqdm_logging.py:145)
Step 947: grad_norm=0.6516366004943848, loss=0.08217423409223557, param_norm=1887.140380859375
Step 948: grad_norm=0.5463544130325317, loss=0.07717250287532806, param_norm=1887.140380859375
00:08:04.722 [I] Progress on: 948it/1.00kit rate:9.0s/it remaining:07:49 elapsed:2:22:43 postfix:- (286571:tqdm_logging.py:145)
Step 949: grad_norm=0.42520391941070557, loss=0.0496743768453598, param_norm=1887.1405029296875
Step 950: grad_norm=0.4626677930355072, loss=0.07428772747516632, param_norm=1887.1405029296875
00:08:22.342 [I] Progress on: 950it/1.00kit rate:8.9s/it remaining:07:25 elapsed:2:23:01 postfix:- (286571:tqdm_logging.py:145)
Step 951: grad_norm=1.6246076822280884, loss=0.07402221858501434, param_norm=1887.1405029296875
Step 952: grad_norm=0.4642617404460907, loss=0.07008768618106842, param_norm=1887.1405029296875
00:08:39.962 [I] Progress on: 952it/1.00kit rate:8.9s/it remaining:07:05 elapsed:2:23:19 postfix:- (286571:tqdm_logging.py:145)
Step 953: grad_norm=0.5604801774024963, loss=0.0704621747136116, param_norm=1887.1405029296875
Step 954: grad_norm=0.41427040100097656, loss=0.06951233744621277, param_norm=1887.1407470703125
00:08:57.586 [I] Progress on: 954it/1.00kit rate:8.8s/it remaining:06:46 elapsed:2:23:36 postfix:- (286571:tqdm_logging.py:145)
Step 955: grad_norm=0.6517478823661804, loss=0.0673360526561737, param_norm=1887.1407470703125
Step 956: grad_norm=0.5434449315071106, loss=0.058084432035684586, param_norm=1887.1407470703125
00:09:15.224 [I] Progress on: 956it/1.00kit rate:8.8s/it remaining:06:28 elapsed:2:23:54 postfix:- (286571:tqdm_logging.py:145)
Step 957: grad_norm=0.5936152935028076, loss=0.0724157840013504, param_norm=1887.1407470703125
Step 958: grad_norm=0.6573745012283325, loss=0.0855698511004448, param_norm=1887.1407470703125
00:09:32.860 [I] Progress on: 958it/1.00kit rate:8.8s/it remaining:06:10 elapsed:2:24:12 postfix:- (286571:tqdm_logging.py:145)
Step 959: grad_norm=0.5443851351737976, loss=0.08156026154756546, param_norm=1887.1407470703125
Step 960: grad_norm=0.6856707334518433, loss=0.07407447695732117, param_norm=1887.1407470703125
00:09:50.481 [I] Progress on: 960it/1.00kit rate:8.8s/it remaining:05:52 elapsed:2:24:29 postfix:- (286571:tqdm_logging.py:145)
Step 961: grad_norm=0.6032253503799438, loss=0.06417891383171082, param_norm=1887.1407470703125
Step 962: grad_norm=0.6474030017852783, loss=0.0602874830365181, param_norm=1887.1407470703125
00:10:08.077 [I] Progress on: 962it/1.00kit rate:8.8s/it remaining:05:34 elapsed:2:24:47 postfix:- (286571:tqdm_logging.py:145)
Step 963: grad_norm=0.8210999369621277, loss=0.0861419066786766, param_norm=1887.140869140625
Step 964: grad_norm=0.37150898575782776, loss=0.07078363001346588, param_norm=1887.140869140625
00:10:25.725 [I] Progress on: 964it/1.00kit rate:8.8s/it remaining:05:17 elapsed:2:25:04 postfix:- (286571:tqdm_logging.py:145)
Step 965: grad_norm=0.6551041007041931, loss=0.07664091885089874, param_norm=1887.140869140625
00:10:37.110 [I] Progress on: 966it/1.00kit rate:9.5s/it remaining:05:23 elapsed:2:25:16 postfix:- (286571:tqdm_logging.py:145)
Step 966: grad_norm=0.5155678391456604, loss=0.07167227566242218, param_norm=1887.140869140625
Step 967: grad_norm=0.3580285906791687, loss=0.05034177005290985, param_norm=1887.140869140625
00:10:54.455 [I] Progress on: 967it/1.00kit rate:9.3s/it remaining:05:06 elapsed:2:25:33 postfix:- (286571:tqdm_logging.py:145)
Step 968: grad_norm=0.8909233808517456, loss=0.0714312195777893, param_norm=1887.140869140625
Step 969: grad_norm=0.7440364360809326, loss=0.0841633528470993, param_norm=1887.140869140625
00:11:12.118 [I] Progress on: 969it/1.00kit rate:9.0s/it remaining:04:40 elapsed:2:25:51 postfix:- (286571:tqdm_logging.py:145)
Step 970: grad_norm=0.6268394589424133, loss=0.067231684923172, param_norm=1887.140869140625
Step 971: grad_norm=2.3486011028289795, loss=0.07938295602798462, param_norm=1887.140869140625
00:11:29.702 [I] Progress on: 971it/1.00kit rate:8.9s/it remaining:04:18 elapsed:2:26:08 postfix:- (286571:tqdm_logging.py:145)
Step 972: grad_norm=0.7229226231575012, loss=0.06618162989616394, param_norm=1887.1409912109375
Step 973: grad_norm=0.3645132780075073, loss=0.06227850541472435, param_norm=1887.1409912109375
00:11:47.373 [I] Progress on: 973it/1.00kit rate:8.9s/it remaining:03:59 elapsed:2:26:26 postfix:- (286571:tqdm_logging.py:145)
Step 974: grad_norm=0.5734176635742188, loss=0.06537295877933502, param_norm=1887.1409912109375
Step 975: grad_norm=0.5904221534729004, loss=0.07288125157356262, param_norm=1887.1409912109375
00:12:04.964 [I] Progress on: 975it/1.00kit rate:8.8s/it remaining:03:40 elapsed:2:26:44 postfix:- (286571:tqdm_logging.py:145)
Step 976: grad_norm=0.8000667095184326, loss=0.07477237284183502, param_norm=1887.1409912109375
Step 977: grad_norm=0.45695069432258606, loss=0.06503608822822571, param_norm=1887.1409912109375
00:12:22.630 [I] Progress on: 977it/1.00kit rate:8.8s/it remaining:03:22 elapsed:2:27:01 postfix:- (286571:tqdm_logging.py:145)
Step 978: grad_norm=0.6059024333953857, loss=0.06844668090343475, param_norm=1887.1409912109375
Step 979: grad_norm=0.5680018067359924, loss=0.06881390511989594, param_norm=1887.1409912109375
00:12:40.387 [I] Progress on: 979it/1.00kit rate:8.8s/it remaining:03:04 elapsed:2:27:19 postfix:- (286571:tqdm_logging.py:145)
Step 980: grad_norm=2.3459696769714355, loss=0.07565920054912567, param_norm=1887.1409912109375
Step 981: grad_norm=0.5438371896743774, loss=0.06652311980724335, param_norm=1887.1409912109375
00:12:58.063 [I] Progress on: 981it/1.00kit rate:8.8s/it remaining:02:47 elapsed:2:27:37 postfix:- (286571:tqdm_logging.py:145)
Step 982: grad_norm=1.1429617404937744, loss=0.08378203213214874, param_norm=1887.1409912109375
Step 983: grad_norm=0.41252508759498596, loss=0.0639575868844986, param_norm=1887.14111328125
00:13:15.678 [I] Progress on: 983it/1.00kit rate:8.8s/it remaining:02:29 elapsed:2:27:54 postfix:- (286571:tqdm_logging.py:145)
Step 984: grad_norm=0.5594007968902588, loss=0.06917360424995422, param_norm=1887.14111328125
Step 985: grad_norm=0.65870600938797, loss=0.08458136767148972, param_norm=1887.14111328125
00:13:33.352 [I] Progress on: 985it/1.00kit rate:8.8s/it remaining:02:12 elapsed:2:28:12 postfix:- (286571:tqdm_logging.py:145)
Step 986: grad_norm=0.688556969165802, loss=0.06744098663330078, param_norm=1887.14111328125
00:13:44.610 [I] Progress on: 987it/1.00kit rate:9.5s/it remaining:02:03 elapsed:2:28:23 postfix:- (286571:tqdm_logging.py:145)
Step 987: grad_norm=0.6227295994758606, loss=0.07282904535531998, param_norm=1887.14111328125
Step 988: grad_norm=0.552585780620575, loss=0.07014724612236023, param_norm=1887.14111328125
00:14:01.923 [I] Progress on: 988it/1.00kit rate:9.3s/it remaining:01:51 elapsed:2:28:41 postfix:- (286571:tqdm_logging.py:145)
Step 989: grad_norm=0.31178319454193115, loss=0.057029739022254944, param_norm=1887.1412353515625
Step 990: grad_norm=0.5886476635932922, loss=0.07933971285820007, param_norm=1887.1412353515625
00:14:19.516 [I] Progress on: 990it/1.00kit rate:9.0s/it remaining:01:30 elapsed:2:28:58 postfix:- (286571:tqdm_logging.py:145)
Step 991: grad_norm=0.541898787021637, loss=0.07810616493225098, param_norm=1887.1412353515625
Step 992: grad_norm=0.4575769305229187, loss=0.06190791353583336, param_norm=1887.1412353515625
00:14:37.198 [I] Progress on: 992it/1.00kit rate:8.9s/it remaining:01:11 elapsed:2:29:16 postfix:- (286571:tqdm_logging.py:145)
Step 993: grad_norm=0.5492079257965088, loss=0.058668531477451324, param_norm=1887.1412353515625
Step 994: grad_norm=0.9159075617790222, loss=0.08478392660617828, param_norm=1887.1412353515625
00:14:54.797 [I] Progress on: 994it/1.00kit rate:8.8s/it remaining:00:53 elapsed:2:29:33 postfix:- (286571:tqdm_logging.py:145)
Step 995: grad_norm=0.5376683473587036, loss=0.07316054403781891, param_norm=1887.1412353515625
Step 996: grad_norm=0.5494145750999451, loss=0.07901695370674133, param_norm=1887.141357421875
00:15:12.459 [I] Progress on: 996it/1.00kit rate:8.8s/it remaining:00:35 elapsed:2:29:51 postfix:- (286571:tqdm_logging.py:145)
Step 997: grad_norm=0.46462076902389526, loss=0.07740664482116699, param_norm=1887.141357421875
Step 998: grad_norm=0.9754778146743774, loss=0.07119666039943695, param_norm=1887.1414794921875
00:15:30.041 [I] Progress on: 998it/1.00kit rate:8.8s/it remaining:00:17 elapsed:2:30:09 postfix:- (286571:tqdm_logging.py:145)
Step 999: grad_norm=0.38559526205062866, loss=0.06498681008815765, param_norm=1887.141357421875
00:15:39.062 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
00:15:39.063 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
00:15:39.063 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (286571:checkpoint_manager.py:1786)
00:15:39.063 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (286571:checkpoint_manager.py:1817)
00:15:39.063 [I] [process=0] Saving checkpoint at step 999                                        (286571:checkpoint_manager.py:1286)
00:15:39.064 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999. (286571:async_checkpointer.py:358)
00:15:39.065 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
00:15:39.066 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27 (286571:atomicity.py:144)
00:15:39.066 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
00:15:39.067 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (286571:multihost.py:293)
00:15:39.068 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (286571:atomicity.py:144)
00:15:39.068 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (286571:atomicity.py:144)
00:15:39.069 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (286571:multihost.py:293)
00:15:39.074 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (286571:replica_slices.py:419)
00:15:42.765 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (286571:tensorstore_utils.py:371)
00:15:42.766 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
00:15:42.768 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (286571:tensorstore_utils.py:371)
00:15:42.771 [I] [process=0][thread=async_save] Background save thread started.                   (286571:async_checkpointer.py:121)
00:15:42.793 [I] Preserving Checkpoint[step=100 | time=2025-03-25 02:00:31.645601+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.794 [I] Preserving Checkpoint[step=200 | time=2025-03-25 02:15:28.355085+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.795 [I] Preserving Checkpoint[step=300 | time=2025-03-25 02:30:32.197680+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.796 [I] Preserving Checkpoint[step=400 | time=2025-03-25 02:45:39.182429+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.797 [I] Preserving Checkpoint[step=500 | time=2025-03-25 03:00:40.924660+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.797 [I] Preserving Checkpoint[step=600 | time=2025-03-25 03:15:45.187992+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.797 [I] Preserving Checkpoint[step=700 | time=2025-03-25 03:30:57.606600+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.798 [I] Preserving Checkpoint[step=800 | time=2025-03-25 03:45:59.801388+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.798 [I] Preserving Checkpoint[step=900 | time=2025-03-25 04:00:54.524819+00:00 | is_locked=None]: (Reason: on keep_period=100). (286571:checkpoint_manager.py:1734)
00:15:42.798 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (286571:multihost.py:293)
00:15:42.798 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (286571:checkpoint_manager.py:1328)
00:15:42.799 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (286571:async_checkpointer.py:231)
00:15:42.799 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742876139.0628083, 'wait_for_prev_duration_secs': 0.0006744861602783203, 'checkpointer_blocking_start_time': 1742876139.063995, 'checkpointer_blocking_duration_secs': 3.72890305519104, 'get_old_steps_start_time': 1742876142.792947, 'get_old_steps_duration_secs': 0.005487203598022461, 'checkpoint_manager_blocking_start_time': 1742876139.0626695, 'checkpoint_manager_blocking_duration_secs': 3.737006664276123} (286571:standard_logger.py:34)
00:15:42.801 [I] Progress on: 1.00kit/1.00kit rate:9.9s/it remaining:00:00 elapsed:2:30:21 postfix:- (286571:tqdm_logging.py:145)
00:15:42.803 [I] Progress on: 1.00kit/1.00kit rate:9.9s/it remaining:00:00 elapsed:2:30:22 postfix:- (286571:tqdm_logging.py:145)
00:15:42.813 [I] Waiting for checkpoint manager to finish                                         (286571:train_pi0_fast_regent.py:301)
00:15:42.816 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (286571:checkpoint_manager.py:1759)
00:15:42.820 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (286571:checkpoint_manager.py:1777)
00:15:49.579 [I] ChainedFuture completed 1/1 futures in 6.80 seconds.                             (286571:future.py:137)
00:15:49.579 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 985.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (286571:base_pytree_checkpoint_handler.py:113)
00:15:49.580 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (286571:async_checkpointer.py:131)
00:15:49.581 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f31436f3410> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27 (286571:async_checkpointer.py:406)
00:15:49.581 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27/assets (286571:atomicity.py:287)
00:15:49.592 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27/params (286571:atomicity.py:287)
00:15:49.592 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999 (286571:async_checkpointer.py:416)
00:15:49.593 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27 (286571:async_checkpointer.py:426)
00:15:49.593 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999 (286571:atomicity.py:287)
00:15:49.595 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_idli_plate/1st_try_regent_idli_plate_5/999`. (286571:atomicity.py:548)
00:15:49.595 [I] [process=0][thread=async_save] Background save thread done.                      (286571:async_checkpointer.py:183)
00:15:49.596 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (286571:async_checkpointer.py:239)
00:15:49.596 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (286571:async_checkpointer.py:249)
00:15:49.596 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (286571:checkpoint_manager.py:1890)
00:15:49.596 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (286571:checkpoint_manager.py:1905)
00:15:49.597 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (286571:checkpoint_manager.py:1786)
00:15:49.597 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (286571:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_regent_idli_plate_5[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/phisfxlu[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250324_213901-phisfxlu/logs[0m
