nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
09:46:29.740 [I] Running on: ivy                                                                  (511966:train_pi0_fast_regent.py:226)
INFO:2025-04-08 09:46:30,542:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
09:46:30.542 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (511966:xla_bridge.py:945)
INFO:2025-04-08 09:46:30,543:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
09:46:30.543 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (511966:xla_bridge.py:945)
09:46:31.879 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (511966:base_pytree_checkpoint_handler.py:332)
09:46:31.879 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (511966:base_pytree_checkpoint_handler.py:332)
09:46:31.879 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (511966:multihost.py:375)
09:46:31.880 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7f01265432d0>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f0125628550>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f01257db350>}, handler_registry=None (511966:checkpoint_manager.py:622)
09:46:31.880 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7f01265432d0>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (511966:composite_checkpoint_handler.py:239)
09:46:31.880 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f0125628550>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (511966:composite_checkpoint_handler.py:239)
09:46:31.880 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f01257db350>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (511966:composite_checkpoint_handler.py:239)
09:46:31.880 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f01255e5ad0>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (511966:composite_checkpoint_handler.py:239)
09:46:31.880 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f01265432d0>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f01265432d0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f0125628550>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f0125628550>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f01257db350>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f01257db350>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f01255e5ad0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f01255e5ad0>}). (511966:composite_checkpoint_handler.py:508)
09:46:31.880 [I] orbax-checkpoint version: 0.11.1                                                 (511966:abstract_checkpointer.py:35)
09:46:31.881 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f01253ef560> timeout: 7200 secs and primary_host=0 for async checkpoint writes (511966:async_checkpointer.py:80)
09:46:31.881 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever (511966:checkpoint_manager.py:1528)
09:46:31.881 [I] Saving root metadata                                                             (511966:checkpoint_manager.py:1569)
09:46:31.881 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (511966:multihost.py:293)
09:46:31.881 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f01256e5c10> (511966:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250408_094632-0sr7xknk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_regent_lever
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/0sr7xknk
Some kwargs in processor config are unused and will not have any effect: vocab_size, action_dim, min_token, time_horizon, scale. 
Some kwargs in processor config are unused and will not have any effect: vocab_size, action_dim, min_token, time_horizon, scale. 
09:46:35.398 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/droid (511966:config.py:167)
count_droid: 0, count_collected_demos: 1036
len_dataset: 1036
all 21 episode prompts are the same: push the lever on the toaster
09:46:56.439 [I] Initialized data loader:
[0].query_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].query_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].query_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].query_image_masks['base_0_rgb']: (16,)@bool
[0].query_image_masks['base_1_rgb']: (16,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].exp_lamda_distances: (16, 5, 1)@float32
[0].query_state: (16, 8)@float32
[0].retrieved_0_state: (16, 8)@float32
[0].retrieved_1_state: (16, 8)@float32
[0].retrieved_2_state: (16, 8)@float32
[0].retrieved_3_state: (16, 8)@float32
[0].query_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_prefix: (16, 125)@int32
[0].query_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_postfix: (16, 125)@int32
[0].query_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_0_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_1_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_2_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_3_tokenized_prompt_mask: (16, 250)@bool
[0].query_token_ar_mask: (16, 250)@int32
[0].retrieved_0_token_ar_mask: (16, 250)@int32
[0].retrieved_1_token_ar_mask: (16, 250)@int32
[0].retrieved_2_token_ar_mask: (16, 250)@int32
[0].retrieved_3_token_ar_mask: (16, 250)@int32
[0].query_token_loss_mask: (16, 250)@bool
[0].retrieved_0_token_loss_mask: (16, 250)@bool
[0].retrieved_1_token_loss_mask: (16, 250)@bool
[0].retrieved_2_token_loss_mask: (16, 250)@bool
[0].retrieved_3_token_loss_mask: (16, 250)@bool
[1]: (16, 15, 8)@float32 (511966:train_pi0_fast_regent.py:258)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
09:46:57.199 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (511966:base_pytree_checkpoint_handler.py:332)
09:46:57.227 [I] Restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (511966:checkpointer.py:256)
09:47:14.501 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 599.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 17 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
09:47:14.502 [I] Finished restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (511966:checkpointer.py:259)
09:47:14.503 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (511966:multihost.py:293)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
2025-04-08 09:47:19.348005: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 30.69GiB (32957682654 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
09:47:23.697 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (511966:train_pi0_fast_regent.py:262)
decode_indices shape: (1245,)
09:47:23.792 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (511966:tqdm_logging.py:145)
first_targets shape: (16, 125, 257152)
input_token_embeddings shape: (16, 5090, 2048)
attn_mask shape: (16, 5090, 5090)
loss_mask shape: (16, 249)
targets shape: (16, 249, 257152)
pre_logits shape: (16, 5089, 2048)
logits shape: (16, 249, 257152)
new_logits shape: (16, 249, 257152)
logp shape: (16, 249, 257152)
token_pplx shape: (16, 249)
loss shape: (16,)
Step 0: grad_norm=11.718668937683105, loss=3.863917827606201, param_norm=1886.9476318359375
09:47:44.526 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:20 postfix:-                   (511966:tqdm_logging.py:145)
Step 1: grad_norm=15.388931274414062, loss=4.301990985870361, param_norm=1886.9476318359375
Step 2: grad_norm=13.8898286819458, loss=4.050589561462402, param_norm=1886.9476318359375
09:48:01.696 [I] Progress on: 2.00it/1.00kit rate:13.7s/it remaining:3:47:28 elapsed:00:37 postfix:- (511966:tqdm_logging.py:145)
Step 3: grad_norm=13.69491958618164, loss=3.7530741691589355, param_norm=1886.9476318359375
Step 4: grad_norm=12.925990104675293, loss=3.691779375076294, param_norm=1886.9476318359375
09:48:18.868 [I] Progress on: 4.00it/1.00kit rate:10.3s/it remaining:2:50:17 elapsed:00:55 postfix:- (511966:tqdm_logging.py:145)
Step 5: grad_norm=9.592453956604004, loss=3.467236280441284, param_norm=1886.9476318359375
Step 6: grad_norm=10.337254524230957, loss=3.241218090057373, param_norm=1886.9476318359375
09:48:36.104 [I] Progress on: 6.00it/1.00kit rate:9.3s/it remaining:2:34:13 elapsed:01:12 postfix:- (511966:tqdm_logging.py:145)
Step 7: grad_norm=10.389142990112305, loss=3.331825017929077, param_norm=1886.9476318359375
Step 8: grad_norm=10.227508544921875, loss=3.312145709991455, param_norm=1886.947509765625
09:48:53.381 [I] Progress on: 8.00it/1.00kit rate:8.9s/it remaining:2:27:51 elapsed:01:29 postfix:- (511966:tqdm_logging.py:145)
Step 9: grad_norm=10.719758987426758, loss=3.3915324211120605, param_norm=1886.9476318359375
Step 10: grad_norm=8.733644485473633, loss=3.2372021675109863, param_norm=1886.947509765625
09:49:10.728 [I] Progress on: 10.0it/1.00kit rate:8.8s/it remaining:2:25:11 elapsed:01:46 postfix:- (511966:tqdm_logging.py:145)
Step 11: grad_norm=9.09846019744873, loss=3.200921058654785, param_norm=1886.947509765625
Step 12: grad_norm=7.196928024291992, loss=3.4456934928894043, param_norm=1886.947509765625
09:49:28.122 [I] Progress on: 12.0it/1.00kit rate:8.7s/it remaining:2:24:02 elapsed:02:04 postfix:- (511966:tqdm_logging.py:145)
Step 13: grad_norm=6.668793678283691, loss=3.101271867752075, param_norm=1886.947509765625
Step 14: grad_norm=6.373726844787598, loss=3.4484195709228516, param_norm=1886.9473876953125
09:49:45.548 [I] Progress on: 14.0it/1.00kit rate:8.7s/it remaining:2:23:27 elapsed:02:21 postfix:- (511966:tqdm_logging.py:145)
Step 15: grad_norm=6.369287490844727, loss=3.263242483139038, param_norm=1886.9473876953125
Step 16: grad_norm=15.781070709228516, loss=3.0956597328186035, param_norm=1886.9473876953125
09:50:03.019 [I] Progress on: 16.0it/1.00kit rate:8.7s/it remaining:2:23:14 elapsed:02:39 postfix:- (511966:tqdm_logging.py:145)
Step 17: grad_norm=8.821596145629883, loss=2.8721964359283447, param_norm=1886.9473876953125
Step 18: grad_norm=6.398336887359619, loss=3.0076277256011963, param_norm=1886.9473876953125
09:50:20.487 [I] Progress on: 18.0it/1.00kit rate:8.7s/it remaining:2:22:56 elapsed:02:56 postfix:- (511966:tqdm_logging.py:145)
Step 19: grad_norm=7.434732913970947, loss=3.133145809173584, param_norm=1886.947265625
Step 20: grad_norm=8.995948791503906, loss=2.8961181640625, param_norm=1886.9471435546875
09:50:37.963 [I] Progress on: 20.0it/1.00kit rate:8.7s/it remaining:2:22:44 elapsed:03:14 postfix:- (511966:tqdm_logging.py:145)
Step 21: grad_norm=15.767229080200195, loss=3.100734233856201, param_norm=1886.9471435546875
Step 22: grad_norm=12.745683670043945, loss=3.031359910964966, param_norm=1886.947265625
09:50:55.494 [I] Progress on: 22.0it/1.00kit rate:8.8s/it remaining:2:22:43 elapsed:03:31 postfix:- (511966:tqdm_logging.py:145)
Step 23: grad_norm=5.895339012145996, loss=2.88930606842041, param_norm=1886.947265625
Step 24: grad_norm=8.572896003723145, loss=2.811328887939453, param_norm=1886.9473876953125
09:51:13.026 [I] Progress on: 24.0it/1.00kit rate:8.8s/it remaining:2:22:32 elapsed:03:49 postfix:- (511966:tqdm_logging.py:145)
Step 25: grad_norm=6.1637372970581055, loss=2.8148109912872314, param_norm=1886.9473876953125
Step 26: grad_norm=5.621458530426025, loss=2.652056932449341, param_norm=1886.947509765625
09:51:30.574 [I] Progress on: 26.0it/1.00kit rate:8.8s/it remaining:2:22:26 elapsed:04:06 postfix:- (511966:tqdm_logging.py:145)
Step 27: grad_norm=18.00847625732422, loss=3.044556140899658, param_norm=1886.947509765625
Step 28: grad_norm=7.208469390869141, loss=2.8801732063293457, param_norm=1886.94775390625
09:51:48.133 [I] Progress on: 28.0it/1.00kit rate:8.8s/it remaining:2:22:11 elapsed:04:24 postfix:- (511966:tqdm_logging.py:145)
Step 29: grad_norm=11.99521255493164, loss=2.8300931453704834, param_norm=1886.94775390625
Step 30: grad_norm=9.635682106018066, loss=2.7572402954101562, param_norm=1886.9478759765625
09:52:05.725 [I] Progress on: 30.0it/1.00kit rate:8.8s/it remaining:2:22:07 elapsed:04:41 postfix:- (511966:tqdm_logging.py:145)
Step 31: grad_norm=6.647874355316162, loss=2.934145212173462, param_norm=1886.947998046875
Step 32: grad_norm=11.898609161376953, loss=2.724915027618408, param_norm=1886.9482421875
09:52:23.267 [I] Progress on: 32.0it/1.00kit rate:8.8s/it remaining:2:21:49 elapsed:04:59 postfix:- (511966:tqdm_logging.py:145)
Step 33: grad_norm=10.441914558410645, loss=2.7947256565093994, param_norm=1886.948486328125
Step 34: grad_norm=5.886825084686279, loss=2.580906867980957, param_norm=1886.9486083984375
09:52:40.821 [I] Progress on: 34.0it/1.00kit rate:8.8s/it remaining:2:21:28 elapsed:05:17 postfix:- (511966:tqdm_logging.py:145)
Step 35: grad_norm=6.061596393585205, loss=2.847607135772705, param_norm=1886.9488525390625
Step 36: grad_norm=7.453521251678467, loss=2.6835718154907227, param_norm=1886.948974609375
09:52:58.384 [I] Progress on: 36.0it/1.00kit rate:8.8s/it remaining:2:21:11 elapsed:05:34 postfix:- (511966:tqdm_logging.py:145)
Step 37: grad_norm=5.337172031402588, loss=2.7094523906707764, param_norm=1886.94921875
Step 38: grad_norm=6.416982650756836, loss=2.2858641147613525, param_norm=1886.9493408203125
09:53:15.992 [I] Progress on: 38.0it/1.00kit rate:8.8s/it remaining:2:21:06 elapsed:05:52 postfix:- (511966:tqdm_logging.py:145)
Step 39: grad_norm=11.429418563842773, loss=2.3423221111297607, param_norm=1886.94970703125
Step 40: grad_norm=10.034845352172852, loss=2.8117876052856445, param_norm=1886.9498291015625
09:53:33.565 [I] Progress on: 40.0it/1.00kit rate:8.8s/it remaining:2:20:45 elapsed:06:09 postfix:- (511966:tqdm_logging.py:145)
Step 41: grad_norm=8.222370147705078, loss=2.712268829345703, param_norm=1886.9500732421875
Step 42: grad_norm=19.11927032470703, loss=2.86687970161438, param_norm=1886.9501953125
09:53:51.140 [I] Progress on: 42.0it/1.00kit rate:8.8s/it remaining:2:20:29 elapsed:06:27 postfix:- (511966:tqdm_logging.py:145)
Step 43: grad_norm=19.372997283935547, loss=2.7968034744262695, param_norm=1886.9505615234375
Step 44: grad_norm=12.281612396240234, loss=2.650085210800171, param_norm=1886.95068359375
09:54:08.717 [I] Progress on: 44.0it/1.00kit rate:8.8s/it remaining:2:20:10 elapsed:06:44 postfix:- (511966:tqdm_logging.py:145)
Step 45: grad_norm=6.673986434936523, loss=2.7107138633728027, param_norm=1886.950927734375
Step 46: grad_norm=9.880169868469238, loss=2.816380023956299, param_norm=1886.9510498046875
09:54:26.307 [I] Progress on: 46.0it/1.00kit rate:8.8s/it remaining:2:19:54 elapsed:07:02 postfix:- (511966:tqdm_logging.py:145)
Step 47: grad_norm=7.878515720367432, loss=2.6562535762786865, param_norm=1886.951416015625
Step 48: grad_norm=20.30534553527832, loss=2.5646257400512695, param_norm=1886.95166015625
09:54:43.884 [I] Progress on: 48.0it/1.00kit rate:8.8s/it remaining:2:19:36 elapsed:07:20 postfix:- (511966:tqdm_logging.py:145)
Step 49: grad_norm=7.696352005004883, loss=2.7101635932922363, param_norm=1886.951904296875
Step 50: grad_norm=9.748224258422852, loss=2.441150665283203, param_norm=1886.9521484375
09:55:01.505 [I] Progress on: 50.0it/1.00kit rate:8.8s/it remaining:2:19:27 elapsed:07:37 postfix:- (511966:tqdm_logging.py:145)
Step 51: grad_norm=10.921338081359863, loss=2.4692435264587402, param_norm=1886.952392578125
Step 52: grad_norm=11.710786819458008, loss=2.6715078353881836, param_norm=1886.952880859375
09:55:19.091 [I] Progress on: 52.0it/1.00kit rate:8.8s/it remaining:2:19:08 elapsed:07:55 postfix:- (511966:tqdm_logging.py:145)
Step 53: grad_norm=5.7731804847717285, loss=2.581495761871338, param_norm=1886.953125
Step 54: grad_norm=12.902779579162598, loss=2.623845100402832, param_norm=1886.9534912109375
09:55:36.726 [I] Progress on: 54.0it/1.00kit rate:8.8s/it remaining:2:19:01 elapsed:08:12 postfix:- (511966:tqdm_logging.py:145)
Step 55: grad_norm=7.462740898132324, loss=2.578061580657959, param_norm=1886.9537353515625
Step 56: grad_norm=8.020403861999512, loss=2.430851936340332, param_norm=1886.9541015625
09:55:54.320 [I] Progress on: 56.0it/1.00kit rate:8.8s/it remaining:2:18:37 elapsed:08:30 postfix:- (511966:tqdm_logging.py:145)
Step 57: grad_norm=17.657243728637695, loss=2.4953410625457764, param_norm=1886.954345703125
Step 58: grad_norm=7.613619804382324, loss=2.4821903705596924, param_norm=1886.95458984375
09:56:11.918 [I] Progress on: 58.0it/1.00kit rate:8.8s/it remaining:2:18:19 elapsed:08:48 postfix:- (511966:tqdm_logging.py:145)
Step 59: grad_norm=9.584161758422852, loss=2.649364948272705, param_norm=1886.954833984375
Step 60: grad_norm=10.10226058959961, loss=2.610156536102295, param_norm=1886.9552001953125
09:56:29.482 [I] Progress on: 60.0it/1.00kit rate:8.8s/it remaining:2:17:52 elapsed:09:05 postfix:- (511966:tqdm_logging.py:145)
Step 61: grad_norm=9.268457412719727, loss=2.534353733062744, param_norm=1886.9554443359375
Step 62: grad_norm=9.546454429626465, loss=2.272094249725342, param_norm=1886.9556884765625
09:56:47.077 [I] Progress on: 62.0it/1.00kit rate:8.8s/it remaining:2:17:37 elapsed:09:23 postfix:- (511966:tqdm_logging.py:145)
Step 63: grad_norm=12.176789283752441, loss=2.3488776683807373, param_norm=1886.9560546875
09:56:57.888 [I] Progress on: 64.0it/1.00kit rate:9.4s/it remaining:2:26:00 elapsed:09:34 postfix:- (511966:tqdm_logging.py:145)
Step 64: grad_norm=11.535924911499023, loss=2.1716041564941406, param_norm=1886.956298828125
Step 65: grad_norm=20.346511840820312, loss=2.164280414581299, param_norm=1886.9566650390625
09:57:15.293 [I] Progress on: 65.0it/1.00kit rate:9.2s/it remaining:2:23:09 elapsed:09:51 postfix:- (511966:tqdm_logging.py:145)
Step 66: grad_norm=16.271053314208984, loss=2.243544816970825, param_norm=1886.9569091796875
Step 67: grad_norm=8.961017608642578, loss=2.2531940937042236, param_norm=1886.9571533203125
09:57:32.880 [I] Progress on: 67.0it/1.00kit rate:9.0s/it remaining:2:19:42 elapsed:10:09 postfix:- (511966:tqdm_logging.py:145)
Step 68: grad_norm=8.124173164367676, loss=2.2497661113739014, param_norm=1886.95751953125
Step 69: grad_norm=18.819366455078125, loss=2.2228307723999023, param_norm=1886.9578857421875
09:57:50.468 [I] Progress on: 69.0it/1.00kit rate:8.9s/it remaining:2:17:55 elapsed:10:26 postfix:- (511966:tqdm_logging.py:145)
Step 70: grad_norm=19.048734664916992, loss=2.357238531112671, param_norm=1886.9581298828125
Step 71: grad_norm=12.27624225616455, loss=2.0369439125061035, param_norm=1886.95849609375
09:58:08.039 [I] Progress on: 71.0it/1.00kit rate:8.8s/it remaining:2:16:49 elapsed:10:44 postfix:- (511966:tqdm_logging.py:145)
Step 72: grad_norm=23.969600677490234, loss=2.249985933303833, param_norm=1886.9588623046875
Step 73: grad_norm=14.085394859313965, loss=2.328003406524658, param_norm=1886.9593505859375
09:58:25.611 [I] Progress on: 73.0it/1.00kit rate:8.8s/it remaining:2:16:09 elapsed:11:01 postfix:- (511966:tqdm_logging.py:145)
Step 74: grad_norm=8.449321746826172, loss=2.115551471710205, param_norm=1886.9595947265625
Step 75: grad_norm=5.398278713226318, loss=2.234786033630371, param_norm=1886.9600830078125
09:58:43.192 [I] Progress on: 75.0it/1.00kit rate:8.8s/it remaining:2:15:40 elapsed:11:19 postfix:- (511966:tqdm_logging.py:145)
Step 76: grad_norm=18.783367156982422, loss=2.061645269393921, param_norm=1886.9603271484375
Step 77: grad_norm=12.750370025634766, loss=2.2486720085144043, param_norm=1886.9608154296875
09:59:00.785 [I] Progress on: 77.0it/1.00kit rate:8.8s/it remaining:2:15:20 elapsed:11:36 postfix:- (511966:tqdm_logging.py:145)
Step 78: grad_norm=21.855506896972656, loss=2.169663906097412, param_norm=1886.961181640625
Step 79: grad_norm=19.693899154663086, loss=2.3435473442077637, param_norm=1886.9615478515625
09:59:18.363 [I] Progress on: 79.0it/1.00kit rate:8.8s/it remaining:2:14:59 elapsed:11:54 postfix:- (511966:tqdm_logging.py:145)
Step 80: grad_norm=16.514333724975586, loss=2.1591744422912598, param_norm=1886.9619140625
Step 81: grad_norm=12.949807167053223, loss=2.0930323600769043, param_norm=1886.96240234375
09:59:35.967 [I] Progress on: 81.0it/1.00kit rate:8.8s/it remaining:2:14:45 elapsed:12:12 postfix:- (511966:tqdm_logging.py:145)
Step 82: grad_norm=15.36042594909668, loss=2.5504276752471924, param_norm=1886.962646484375
Step 83: grad_norm=12.923161506652832, loss=2.3314411640167236, param_norm=1886.9630126953125
09:59:53.551 [I] Progress on: 83.0it/1.00kit rate:8.8s/it remaining:2:14:26 elapsed:12:29 postfix:- (511966:tqdm_logging.py:145)
Step 84: grad_norm=13.008430480957031, loss=2.2257888317108154, param_norm=1886.9635009765625
Step 85: grad_norm=15.291435241699219, loss=2.328641414642334, param_norm=1886.9638671875
10:00:11.215 [I] Progress on: 85.0it/1.00kit rate:8.8s/it remaining:2:14:25 elapsed:12:47 postfix:- (511966:tqdm_logging.py:145)
Step 86: grad_norm=15.70722484588623, loss=2.086611747741699, param_norm=1886.964111328125
Step 87: grad_norm=7.767071723937988, loss=2.0421767234802246, param_norm=1886.964599609375
10:00:28.812 [I] Progress on: 87.0it/1.00kit rate:8.8s/it remaining:2:14:01 elapsed:13:05 postfix:- (511966:tqdm_logging.py:145)
Step 88: grad_norm=7.3360795974731445, loss=2.0761778354644775, param_norm=1886.9649658203125
Step 89: grad_norm=21.23823356628418, loss=2.1866064071655273, param_norm=1886.96533203125
10:00:46.399 [I] Progress on: 89.0it/1.00kit rate:8.8s/it remaining:2:13:38 elapsed:13:22 postfix:- (511966:tqdm_logging.py:145)
Step 90: grad_norm=24.760160446166992, loss=2.1517629623413086, param_norm=1886.9656982421875
Step 91: grad_norm=20.306583404541016, loss=2.278611660003662, param_norm=1886.966064453125
10:01:03.994 [I] Progress on: 91.0it/1.00kit rate:8.8s/it remaining:2:13:19 elapsed:13:40 postfix:- (511966:tqdm_logging.py:145)
Step 92: grad_norm=19.956222534179688, loss=1.9633138179779053, param_norm=1886.9664306640625
Step 93: grad_norm=11.616613388061523, loss=2.301964282989502, param_norm=1886.966796875
10:01:21.594 [I] Progress on: 93.0it/1.00kit rate:8.8s/it remaining:2:13:02 elapsed:13:57 postfix:- (511966:tqdm_logging.py:145)
Step 94: grad_norm=5.6861371994018555, loss=2.2320127487182617, param_norm=1886.967041015625
Step 95: grad_norm=16.647579193115234, loss=2.2277822494506836, param_norm=1886.96728515625
10:01:39.184 [I] Progress on: 95.0it/1.00kit rate:8.8s/it remaining:2:12:43 elapsed:14:15 postfix:- (511966:tqdm_logging.py:145)
Step 96: grad_norm=13.654825210571289, loss=2.174748420715332, param_norm=1886.9677734375
Step 97: grad_norm=7.028392314910889, loss=2.1860928535461426, param_norm=1886.968017578125
10:01:56.792 [I] Progress on: 97.0it/1.00kit rate:8.8s/it remaining:2:12:26 elapsed:14:32 postfix:- (511966:tqdm_logging.py:145)
Step 98: grad_norm=13.861859321594238, loss=1.8945221900939941, param_norm=1886.9683837890625
Step 99: grad_norm=13.15915298461914, loss=2.0715742111206055, param_norm=1886.96875
10:02:14.410 [I] Progress on: 99.0it/1.00kit rate:8.8s/it remaining:2:12:14 elapsed:14:50 postfix:- (511966:tqdm_logging.py:145)
Step 100: grad_norm=9.925996780395508, loss=2.1957037448883057, param_norm=1886.96923828125
10:02:23.438 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
10:02:23.438 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (511966:checkpoint_manager.py:1767)
10:02:23.439 [I] [process=0] Saving checkpoint at step 100                                        (511966:checkpoint_manager.py:1286)
10:02:23.440 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100. (511966:async_checkpointer.py:358)
10:02:23.441 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:02:23.442 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0 (511966:atomicity.py:144)
10:02:23.443 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:02:23.444 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:02:23.444 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744120943442789265, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1744120943442789265, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (511966:checkpoint.py:185)
10:02:23.445 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (511966:atomicity.py:144)
10:02:23.445 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (511966:atomicity.py:144)
10:02:23.446 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:02:23.457 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
10:02:27.064 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
10:02:27.065 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:02:27.065 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
10:02:27.067 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
10:02:27.082 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
10:02:27.083 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
10:02:27.086 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
10:02:27.087 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744120943.4382594, 'wait_for_prev_duration_secs': 0.0005104541778564453, 'checkpointer_blocking_start_time': 1744120943.4395092, 'checkpointer_blocking_duration_secs': 3.642557382583618, 'get_old_steps_start_time': 1744120947.082158, 'get_old_steps_duration_secs': 9.775161743164062e-06, 'checkpoint_manager_blocking_start_time': 1744120943.4380407, 'checkpoint_manager_blocking_duration_secs': 3.649641990661621} (511966:standard_logger.py:34)
10:02:27.088 [I] Progress on: 101it/1.00kit rate:9.9s/it remaining:2:28:35 elapsed:15:03 postfix:- (511966:tqdm_logging.py:145)
10:02:34.909 [I] ChainedFuture completed 1/1 futures in 7.83 seconds.                             (511966:future.py:137)
10:02:34.909 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 903.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:02:34.909 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
10:02:34.910 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744120943442789265, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (511966:checkpoint.py:225)
10:02:34.912 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0 (511966:async_checkpointer.py:406)
10:02:34.913 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/assets (511966:atomicity.py:287)
10:02:34.916 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1744120943442789265, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (511966:checkpoint.py:244)
10:02:34.925 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0/params (511966:atomicity.py:287)
10:02:34.926 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100 (511966:async_checkpointer.py:416)
10:02:34.926 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0 (511966:async_checkpointer.py:426)
10:02:34.926 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100 (511966:atomicity.py:287)
10:02:34.928 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/100`. (511966:atomicity.py:548)
10:02:34.928 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
10:02:34.928 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
10:02:34.929 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
10:02:34.929 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
10:02:34.929 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 101: grad_norm=12.749719619750977, loss=2.269162654876709, param_norm=1886.969482421875
Step 102: grad_norm=13.536307334899902, loss=2.1795473098754883, param_norm=1886.969970703125
10:02:44.490 [I] Progress on: 102it/1.00kit rate:9.6s/it remaining:2:23:17 elapsed:15:20 postfix:- (511966:tqdm_logging.py:145)
Step 103: grad_norm=5.92688512802124, loss=2.1390380859375, param_norm=1886.97021484375
Step 104: grad_norm=20.411651611328125, loss=2.4173998832702637, param_norm=1886.970458984375
10:03:02.058 [I] Progress on: 104it/1.00kit rate:9.2s/it remaining:2:16:56 elapsed:15:38 postfix:- (511966:tqdm_logging.py:145)
Step 105: grad_norm=17.156455993652344, loss=2.187419891357422, param_norm=1886.9708251953125
Step 106: grad_norm=15.070677757263184, loss=2.156057834625244, param_norm=1886.97119140625
10:03:19.655 [I] Progress on: 106it/1.00kit rate:9.0s/it remaining:2:13:44 elapsed:15:55 postfix:- (511966:tqdm_logging.py:145)
Step 107: grad_norm=11.588468551635742, loss=2.1268506050109863, param_norm=1886.9715576171875
Step 108: grad_norm=15.210793495178223, loss=2.138256549835205, param_norm=1886.9718017578125
10:03:37.246 [I] Progress on: 108it/1.00kit rate:8.9s/it remaining:2:12:04 elapsed:16:13 postfix:- (511966:tqdm_logging.py:145)
Step 109: grad_norm=15.20511531829834, loss=2.1610090732574463, param_norm=1886.97216796875
Step 110: grad_norm=15.404878616333008, loss=2.0847434997558594, param_norm=1886.972412109375
10:03:54.856 [I] Progress on: 110it/1.00kit rate:8.8s/it remaining:2:11:09 elapsed:16:31 postfix:- (511966:tqdm_logging.py:145)
Step 111: grad_norm=6.5196027755737305, loss=2.114494800567627, param_norm=1886.97265625
Step 112: grad_norm=9.214262008666992, loss=2.067567825317383, param_norm=1886.9730224609375
10:04:12.463 [I] Progress on: 112it/1.00kit rate:8.8s/it remaining:2:10:33 elapsed:16:48 postfix:- (511966:tqdm_logging.py:145)
Step 113: grad_norm=8.05162525177002, loss=2.100353240966797, param_norm=1886.973388671875
Step 114: grad_norm=18.80425262451172, loss=2.205066680908203, param_norm=1886.9737548828125
10:04:30.077 [I] Progress on: 114it/1.00kit rate:8.8s/it remaining:2:10:08 elapsed:17:06 postfix:- (511966:tqdm_logging.py:145)
Step 115: grad_norm=7.428071022033691, loss=2.192904472351074, param_norm=1886.97412109375
Step 116: grad_norm=7.946408271789551, loss=1.9968491792678833, param_norm=1886.974365234375
10:04:47.686 [I] Progress on: 116it/1.00kit rate:8.8s/it remaining:2:09:46 elapsed:17:23 postfix:- (511966:tqdm_logging.py:145)
Step 117: grad_norm=5.67329216003418, loss=1.9864513874053955, param_norm=1886.9747314453125
Step 118: grad_norm=5.735433101654053, loss=1.9375836849212646, param_norm=1886.9749755859375
10:05:05.302 [I] Progress on: 118it/1.00kit rate:8.8s/it remaining:2:09:28 elapsed:17:41 postfix:- (511966:tqdm_logging.py:145)
Step 119: grad_norm=13.311558723449707, loss=2.138461112976074, param_norm=1886.9752197265625
Step 120: grad_norm=11.001534461975098, loss=2.187472105026245, param_norm=1886.9755859375
10:05:22.931 [I] Progress on: 120it/1.00kit rate:8.8s/it remaining:2:09:11 elapsed:17:59 postfix:- (511966:tqdm_logging.py:145)
Step 121: grad_norm=7.674004077911377, loss=2.108816146850586, param_norm=1886.97607421875
Step 122: grad_norm=5.920435428619385, loss=2.23274564743042, param_norm=1886.9764404296875
10:05:40.559 [I] Progress on: 122it/1.00kit rate:8.8s/it remaining:2:08:57 elapsed:18:16 postfix:- (511966:tqdm_logging.py:145)
Step 123: grad_norm=16.53131103515625, loss=1.9590890407562256, param_norm=1886.976806640625
Step 124: grad_norm=20.657747268676758, loss=1.979799509048462, param_norm=1886.977294921875
10:05:58.190 [I] Progress on: 124it/1.00kit rate:8.8s/it remaining:2:08:36 elapsed:18:34 postfix:- (511966:tqdm_logging.py:145)
Step 125: grad_norm=5.388355731964111, loss=1.917130708694458, param_norm=1886.9776611328125
Step 126: grad_norm=7.113495349884033, loss=2.111082077026367, param_norm=1886.97802734375
10:06:15.804 [I] Progress on: 126it/1.00kit rate:8.8s/it remaining:2:08:20 elapsed:18:52 postfix:- (511966:tqdm_logging.py:145)
Step 127: grad_norm=10.313743591308594, loss=2.228461742401123, param_norm=1886.9783935546875
10:06:26.228 [I] Progress on: 128it/1.00kit rate:9.2s/it remaining:2:14:22 elapsed:19:02 postfix:- (511966:tqdm_logging.py:145)
Step 128: grad_norm=9.104058265686035, loss=1.7336347103118896, param_norm=1886.9788818359375
Step 129: grad_norm=11.559154510498047, loss=1.8200424909591675, param_norm=1886.979248046875
10:06:43.691 [I] Progress on: 129it/1.00kit rate:9.1s/it remaining:2:12:19 elapsed:19:19 postfix:- (511966:tqdm_logging.py:145)
Step 130: grad_norm=6.606584548950195, loss=1.686269760131836, param_norm=1886.9796142578125
Step 131: grad_norm=16.0107364654541, loss=1.823655366897583, param_norm=1886.9801025390625
10:07:01.292 [I] Progress on: 131it/1.00kit rate:9.0s/it remaining:2:09:41 elapsed:19:37 postfix:- (511966:tqdm_logging.py:145)
Step 132: grad_norm=10.405156135559082, loss=1.7184665203094482, param_norm=1886.98046875
Step 133: grad_norm=7.978423595428467, loss=1.9251207113265991, param_norm=1886.9808349609375
10:07:18.906 [I] Progress on: 133it/1.00kit rate:8.9s/it remaining:2:08:20 elapsed:19:55 postfix:- (511966:tqdm_logging.py:145)
Step 134: grad_norm=11.074482917785645, loss=1.8371994495391846, param_norm=1886.9813232421875
Step 135: grad_norm=7.563469409942627, loss=1.6899381875991821, param_norm=1886.981689453125
10:07:36.523 [I] Progress on: 135it/1.00kit rate:8.8s/it remaining:2:07:29 elapsed:20:12 postfix:- (511966:tqdm_logging.py:145)
Step 136: grad_norm=15.781644821166992, loss=1.8220148086547852, param_norm=1886.9820556640625
Step 137: grad_norm=12.766592025756836, loss=1.8790709972381592, param_norm=1886.9825439453125
10:07:54.134 [I] Progress on: 137it/1.00kit rate:8.8s/it remaining:2:06:55 elapsed:20:30 postfix:- (511966:tqdm_logging.py:145)
Step 138: grad_norm=11.214948654174805, loss=1.9957505464553833, param_norm=1886.98291015625
Step 139: grad_norm=10.770012855529785, loss=1.9655523300170898, param_norm=1886.9833984375
10:08:11.753 [I] Progress on: 139it/1.00kit rate:8.8s/it remaining:2:06:30 elapsed:20:47 postfix:- (511966:tqdm_logging.py:145)
Step 140: grad_norm=11.949992179870605, loss=2.021803855895996, param_norm=1886.9837646484375
Step 141: grad_norm=9.414255142211914, loss=1.9284827709197998, param_norm=1886.984130859375
10:08:29.375 [I] Progress on: 141it/1.00kit rate:8.8s/it remaining:2:06:12 elapsed:21:05 postfix:- (511966:tqdm_logging.py:145)
Step 142: grad_norm=9.528388977050781, loss=1.9912556409835815, param_norm=1886.9844970703125
Step 143: grad_norm=10.93297290802002, loss=1.9437559843063354, param_norm=1886.98486328125
10:08:46.993 [I] Progress on: 143it/1.00kit rate:8.8s/it remaining:2:05:51 elapsed:21:23 postfix:- (511966:tqdm_logging.py:145)
Step 144: grad_norm=7.560793876647949, loss=1.780759572982788, param_norm=1886.985107421875
Step 145: grad_norm=10.411951065063477, loss=1.6838481426239014, param_norm=1886.985595703125
10:09:04.606 [I] Progress on: 145it/1.00kit rate:8.8s/it remaining:2:05:32 elapsed:21:40 postfix:- (511966:tqdm_logging.py:145)
Step 146: grad_norm=16.30520248413086, loss=1.6396222114562988, param_norm=1886.986083984375
Step 147: grad_norm=19.016088485717773, loss=1.883193016052246, param_norm=1886.9864501953125
10:09:22.245 [I] Progress on: 147it/1.00kit rate:8.8s/it remaining:2:05:21 elapsed:21:58 postfix:- (511966:tqdm_logging.py:145)
Step 148: grad_norm=7.246915340423584, loss=1.8601832389831543, param_norm=1886.9869384765625
Step 149: grad_norm=13.09512710571289, loss=1.808037281036377, param_norm=1886.9873046875
10:09:39.910 [I] Progress on: 149it/1.00kit rate:8.8s/it remaining:2:05:11 elapsed:22:16 postfix:- (511966:tqdm_logging.py:145)
Step 150: grad_norm=26.208858489990234, loss=2.029240131378174, param_norm=1886.9876708984375
Step 151: grad_norm=21.112512588500977, loss=1.9373723268508911, param_norm=1886.988037109375
10:09:57.566 [I] Progress on: 151it/1.00kit rate:8.8s/it remaining:2:04:58 elapsed:22:33 postfix:- (511966:tqdm_logging.py:145)
Step 152: grad_norm=17.33033561706543, loss=1.785677433013916, param_norm=1886.988525390625
Step 153: grad_norm=9.050294876098633, loss=1.781888484954834, param_norm=1886.9888916015625
10:10:15.226 [I] Progress on: 153it/1.00kit rate:8.8s/it remaining:2:04:40 elapsed:22:51 postfix:- (511966:tqdm_logging.py:145)
Step 154: grad_norm=19.01837730407715, loss=2.0041251182556152, param_norm=1886.9891357421875
Step 155: grad_norm=8.527079582214355, loss=1.5731006860733032, param_norm=1886.989501953125
10:10:32.898 [I] Progress on: 155it/1.00kit rate:8.8s/it remaining:2:04:27 elapsed:23:09 postfix:- (511966:tqdm_logging.py:145)
Step 156: grad_norm=20.345632553100586, loss=2.0860543251037598, param_norm=1886.9898681640625
Step 157: grad_norm=24.51006507873535, loss=1.9544423818588257, param_norm=1886.9903564453125
10:10:50.563 [I] Progress on: 157it/1.00kit rate:8.8s/it remaining:2:04:09 elapsed:23:26 postfix:- (511966:tqdm_logging.py:145)
Step 158: grad_norm=28.107065200805664, loss=2.0139851570129395, param_norm=1886.99072265625
Step 159: grad_norm=10.765664100646973, loss=1.631828784942627, param_norm=1886.9910888671875
10:11:08.237 [I] Progress on: 159it/1.00kit rate:8.8s/it remaining:2:03:54 elapsed:23:44 postfix:- (511966:tqdm_logging.py:145)
Step 160: grad_norm=8.06303882598877, loss=1.770383596420288, param_norm=1886.991455078125
Step 161: grad_norm=5.8083815574646, loss=1.815521240234375, param_norm=1886.991943359375
10:11:25.913 [I] Progress on: 161it/1.00kit rate:8.8s/it remaining:2:03:37 elapsed:24:02 postfix:- (511966:tqdm_logging.py:145)
Step 162: grad_norm=18.300373077392578, loss=1.7907958030700684, param_norm=1886.9923095703125
Step 163: grad_norm=16.721710205078125, loss=1.9731218814849854, param_norm=1886.99267578125
10:11:43.588 [I] Progress on: 163it/1.00kit rate:8.8s/it remaining:2:03:20 elapsed:24:19 postfix:- (511966:tqdm_logging.py:145)
Step 164: grad_norm=29.109832763671875, loss=2.1291580200195312, param_norm=1886.9931640625
Step 165: grad_norm=14.769309043884277, loss=1.8706772327423096, param_norm=1886.9935302734375
10:12:01.252 [I] Progress on: 165it/1.00kit rate:8.8s/it remaining:2:03:00 elapsed:24:37 postfix:- (511966:tqdm_logging.py:145)
Step 166: grad_norm=11.183601379394531, loss=1.8087687492370605, param_norm=1886.9940185546875
Step 167: grad_norm=7.694498062133789, loss=1.6758288145065308, param_norm=1886.994384765625
10:12:18.951 [I] Progress on: 167it/1.00kit rate:8.8s/it remaining:2:02:51 elapsed:24:55 postfix:- (511966:tqdm_logging.py:145)
Step 168: grad_norm=5.585724830627441, loss=1.9310600757598877, param_norm=1886.9947509765625
Step 169: grad_norm=18.754514694213867, loss=1.773918628692627, param_norm=1886.9951171875
10:12:36.625 [I] Progress on: 169it/1.00kit rate:8.8s/it remaining:2:02:31 elapsed:25:12 postfix:- (511966:tqdm_logging.py:145)
Step 170: grad_norm=23.163654327392578, loss=1.9534084796905518, param_norm=1886.9954833984375
Step 171: grad_norm=15.899572372436523, loss=1.9404702186584473, param_norm=1886.9957275390625
10:12:54.300 [I] Progress on: 171it/1.00kit rate:8.8s/it remaining:2:02:09 elapsed:25:30 postfix:- (511966:tqdm_logging.py:145)
Step 172: grad_norm=6.753240585327148, loss=1.791020393371582, param_norm=1886.99609375
Step 173: grad_norm=5.754397392272949, loss=1.6725391149520874, param_norm=1886.99658203125
10:13:11.965 [I] Progress on: 173it/1.00kit rate:8.8s/it remaining:2:01:50 elapsed:25:48 postfix:- (511966:tqdm_logging.py:145)
Step 174: grad_norm=11.33875846862793, loss=1.749950885772705, param_norm=1886.9969482421875
Step 175: grad_norm=13.908440589904785, loss=1.7760666608810425, param_norm=1886.997314453125
10:13:29.797 [I] Progress on: 175it/1.00kit rate:8.8s/it remaining:2:01:33 elapsed:26:06 postfix:- (511966:tqdm_logging.py:145)
Step 176: grad_norm=24.451133728027344, loss=1.8853442668914795, param_norm=1886.9976806640625
Step 177: grad_norm=13.296091079711914, loss=2.1482088565826416, param_norm=1886.998046875
10:13:47.504 [I] Progress on: 177it/1.00kit rate:8.9s/it remaining:2:01:50 elapsed:26:23 postfix:- (511966:tqdm_logging.py:145)
Step 178: grad_norm=5.67108678817749, loss=1.6055580377578735, param_norm=1886.9984130859375
Step 179: grad_norm=13.720009803771973, loss=1.6825580596923828, param_norm=1886.9989013671875
10:14:05.168 [I] Progress on: 179it/1.00kit rate:8.9s/it remaining:2:01:14 elapsed:26:41 postfix:- (511966:tqdm_logging.py:145)
Step 180: grad_norm=7.3947649002075195, loss=1.766044020652771, param_norm=1886.999267578125
Step 181: grad_norm=8.956068992614746, loss=1.7303597927093506, param_norm=1886.9996337890625
10:14:22.834 [I] Progress on: 181it/1.00kit rate:8.8s/it remaining:2:00:45 elapsed:26:59 postfix:- (511966:tqdm_logging.py:145)
Step 182: grad_norm=9.42708969116211, loss=1.723096489906311, param_norm=1886.9998779296875
Step 183: grad_norm=14.846583366394043, loss=1.478379726409912, param_norm=1887.000244140625
10:14:40.493 [I] Progress on: 183it/1.00kit rate:8.8s/it remaining:2:00:25 elapsed:27:16 postfix:- (511966:tqdm_logging.py:145)
Step 184: grad_norm=8.507079124450684, loss=1.8742114305496216, param_norm=1887.0006103515625
Step 185: grad_norm=16.41511344909668, loss=2.0368247032165527, param_norm=1887.0009765625
10:14:58.165 [I] Progress on: 185it/1.00kit rate:8.8s/it remaining:2:00:03 elapsed:27:34 postfix:- (511966:tqdm_logging.py:145)
Step 186: grad_norm=6.980269908905029, loss=1.6757264137268066, param_norm=1887.0013427734375
Step 187: grad_norm=7.35902738571167, loss=1.6094567775726318, param_norm=1887.0018310546875
10:15:15.843 [I] Progress on: 187it/1.00kit rate:8.8s/it remaining:1:59:48 elapsed:27:52 postfix:- (511966:tqdm_logging.py:145)
Step 188: grad_norm=14.841856002807617, loss=1.7152440547943115, param_norm=1887.002197265625
Step 189: grad_norm=13.464009284973145, loss=1.7092278003692627, param_norm=1887.002685546875
10:15:33.584 [I] Progress on: 189it/1.00kit rate:8.8s/it remaining:1:59:34 elapsed:28:09 postfix:- (511966:tqdm_logging.py:145)
Step 190: grad_norm=7.455964088439941, loss=1.818034052848816, param_norm=1887.0029296875
Step 191: grad_norm=16.366846084594727, loss=1.5727853775024414, param_norm=1887.00341796875
10:15:51.357 [I] Progress on: 191it/1.00kit rate:8.9s/it remaining:1:59:36 elapsed:28:27 postfix:- (511966:tqdm_logging.py:145)
Step 192: grad_norm=9.591506004333496, loss=1.6216259002685547, param_norm=1887.003662109375
10:16:02.173 [I] Progress on: 192it/1.00kit rate:9.5s/it remaining:2:07:33 elapsed:28:38 postfix:- (511966:tqdm_logging.py:145)
Step 193: grad_norm=13.336773872375488, loss=1.6731723546981812, param_norm=1887.004150390625
Step 194: grad_norm=12.21677017211914, loss=1.6550843715667725, param_norm=1887.0045166015625
10:16:19.823 [I] Progress on: 194it/1.00kit rate:9.2s/it remaining:2:03:06 elapsed:28:56 postfix:- (511966:tqdm_logging.py:145)
Step 195: grad_norm=6.937161922454834, loss=1.4749648571014404, param_norm=1887.0048828125
Step 196: grad_norm=13.445565223693848, loss=1.677397608757019, param_norm=1887.0052490234375
10:16:37.364 [I] Progress on: 196it/1.00kit rate:9.0s/it remaining:2:00:11 elapsed:29:13 postfix:- (511966:tqdm_logging.py:145)
Step 197: grad_norm=19.238601684570312, loss=1.4399222135543823, param_norm=1887.005615234375
Step 198: grad_norm=10.665319442749023, loss=1.5708177089691162, param_norm=1887.0059814453125
10:16:54.934 [I] Progress on: 198it/1.00kit rate:8.9s/it remaining:1:58:51 elapsed:29:31 postfix:- (511966:tqdm_logging.py:145)
Step 199: grad_norm=15.030373573303223, loss=1.389387845993042, param_norm=1887.00634765625
Step 200: grad_norm=5.972855091094971, loss=1.5313475131988525, param_norm=1887.0067138671875
10:17:12.359 [I] Progress on: 200it/1.00kit rate:8.8s/it remaining:1:57:22 elapsed:29:48 postfix:- (511966:tqdm_logging.py:145)
10:17:12.476 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
10:17:12.477 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
10:17:12.477 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (511966:checkpoint_manager.py:1786)
10:17:12.477 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (511966:checkpoint_manager.py:1817)
10:17:12.478 [I] [process=0] Saving checkpoint at step 200                                        (511966:checkpoint_manager.py:1286)
10:17:12.478 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200. (511966:async_checkpointer.py:358)
10:17:12.480 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:17:12.480 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3 (511966:atomicity.py:144)
10:17:12.481 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:17:12.482 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:17:12.483 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (511966:atomicity.py:144)
10:17:12.483 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (511966:atomicity.py:144)
10:17:12.484 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:17:12.489 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
10:17:16.463 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
10:17:16.464 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:17:16.465 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
10:17:16.469 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
10:17:16.495 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
10:17:16.498 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
10:17:16.501 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
10:17:16.516 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
10:17:16.519 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744121832.476855, 'wait_for_prev_duration_secs': 0.0008411407470703125, 'checkpointer_blocking_start_time': 1744121832.4783628, 'checkpointer_blocking_duration_secs': 4.016977310180664, 'get_old_steps_start_time': 1744121836.4954, 'get_old_steps_duration_secs': 0.003033161163330078, 'checkpoint_manager_blocking_start_time': 1744121832.4766655, 'checkpoint_manager_blocking_duration_secs': 4.042279481887817} (511966:standard_logger.py:34)
10:17:24.238 [I] ChainedFuture completed 1/1 futures in 7.75 seconds.                             (511966:future.py:137)
10:17:24.239 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 881.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:17:24.239 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
10:17:24.241 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3 (511966:async_checkpointer.py:406)
10:17:24.241 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3/assets (511966:atomicity.py:287)
10:17:24.338 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3/params (511966:atomicity.py:287)
10:17:24.339 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200 (511966:async_checkpointer.py:416)
10:17:24.339 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3 (511966:async_checkpointer.py:426)
10:17:24.339 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200 (511966:atomicity.py:287)
10:17:24.341 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/200`. (511966:atomicity.py:548)
10:17:24.341 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
10:17:24.342 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
10:17:24.342 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
10:17:24.343 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
10:17:24.343 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 201: grad_norm=21.239564895629883, loss=1.6499334573745728, param_norm=1887.0072021484375
10:17:25.061 [I] Progress on: 201it/1.00kit rate:10.0s/it remaining:2:12:54 elapsed:30:01 postfix:- (511966:tqdm_logging.py:145)
Step 202: grad_norm=19.068134307861328, loss=1.345426321029663, param_norm=1887.007568359375
Step 203: grad_norm=25.55583953857422, loss=1.5561425685882568, param_norm=1887.008056640625
10:17:42.558 [I] Progress on: 203it/1.00kit rate:9.3s/it remaining:2:04:06 elapsed:30:18 postfix:- (511966:tqdm_logging.py:145)
Step 204: grad_norm=14.66114330291748, loss=1.562840461730957, param_norm=1887.0084228515625
Step 205: grad_norm=5.436227798461914, loss=1.5711266994476318, param_norm=1887.0089111328125
10:18:00.011 [I] Progress on: 205it/1.00kit rate:9.0s/it remaining:1:59:31 elapsed:30:36 postfix:- (511966:tqdm_logging.py:145)
Step 206: grad_norm=8.048398971557617, loss=1.4400835037231445, param_norm=1887.00927734375
Step 207: grad_norm=17.80133628845215, loss=1.6370574235916138, param_norm=1887.0096435546875
10:18:17.548 [I] Progress on: 207it/1.00kit rate:8.9s/it remaining:1:57:22 elapsed:30:53 postfix:- (511966:tqdm_logging.py:145)
Step 208: grad_norm=8.710029602050781, loss=1.404707431793213, param_norm=1887.010009765625
Step 209: grad_norm=6.735716342926025, loss=1.4928392171859741, param_norm=1887.010498046875
10:18:35.030 [I] Progress on: 209it/1.00kit rate:8.8s/it remaining:1:56:01 elapsed:31:11 postfix:- (511966:tqdm_logging.py:145)
Step 210: grad_norm=6.498092174530029, loss=1.4640684127807617, param_norm=1887.0108642578125
Step 211: grad_norm=13.675044059753418, loss=1.496157169342041, param_norm=1887.01123046875
10:18:52.586 [I] Progress on: 211it/1.00kit rate:8.8s/it remaining:1:55:24 elapsed:31:28 postfix:- (511966:tqdm_logging.py:145)
Step 212: grad_norm=7.84135627746582, loss=1.3417317867279053, param_norm=1887.0115966796875
Step 213: grad_norm=7.671772480010986, loss=1.4286961555480957, param_norm=1887.0120849609375
10:19:10.083 [I] Progress on: 213it/1.00kit rate:8.8s/it remaining:1:54:51 elapsed:31:46 postfix:- (511966:tqdm_logging.py:145)
Step 214: grad_norm=10.512212753295898, loss=1.6499671936035156, param_norm=1887.012451171875
Step 215: grad_norm=16.50726318359375, loss=1.6343053579330444, param_norm=1887.012939453125
10:19:27.655 [I] Progress on: 215it/1.00kit rate:8.8s/it remaining:1:54:37 elapsed:32:03 postfix:- (511966:tqdm_logging.py:145)
Step 216: grad_norm=11.949725151062012, loss=1.4692857265472412, param_norm=1887.01318359375
Step 217: grad_norm=7.879197597503662, loss=1.5080549716949463, param_norm=1887.013671875
10:19:45.169 [I] Progress on: 217it/1.00kit rate:8.8s/it remaining:1:54:14 elapsed:32:21 postfix:- (511966:tqdm_logging.py:145)
Step 218: grad_norm=5.975623607635498, loss=1.5748536586761475, param_norm=1887.0140380859375
Step 219: grad_norm=6.575460433959961, loss=1.5248425006866455, param_norm=1887.014404296875
10:20:02.742 [I] Progress on: 219it/1.00kit rate:8.8s/it remaining:1:54:02 elapsed:32:38 postfix:- (511966:tqdm_logging.py:145)
Step 220: grad_norm=16.181859970092773, loss=1.2871284484863281, param_norm=1887.014892578125
Step 221: grad_norm=24.608434677124023, loss=1.6186537742614746, param_norm=1887.0152587890625
10:20:20.274 [I] Progress on: 221it/1.00kit rate:8.8s/it remaining:1:53:40 elapsed:32:56 postfix:- (511966:tqdm_logging.py:145)
Step 222: grad_norm=17.885997772216797, loss=1.5122944116592407, param_norm=1887.015625
Step 223: grad_norm=11.747495651245117, loss=1.452648639678955, param_norm=1887.0159912109375
10:20:37.862 [I] Progress on: 223it/1.00kit rate:8.8s/it remaining:1:53:32 elapsed:33:14 postfix:- (511966:tqdm_logging.py:145)
Step 224: grad_norm=11.501026153564453, loss=1.6084225177764893, param_norm=1887.0164794921875
Step 225: grad_norm=6.266736030578613, loss=1.6636710166931152, param_norm=1887.016845703125
10:20:55.387 [I] Progress on: 225it/1.00kit rate:8.8s/it remaining:1:53:09 elapsed:33:31 postfix:- (511966:tqdm_logging.py:145)
Step 226: grad_norm=17.240049362182617, loss=1.5804266929626465, param_norm=1887.0172119140625
Step 227: grad_norm=18.788345336914062, loss=1.5644696950912476, param_norm=1887.0177001953125
10:21:12.985 [I] Progress on: 227it/1.00kit rate:8.8s/it remaining:1:52:57 elapsed:33:49 postfix:- (511966:tqdm_logging.py:145)
Step 228: grad_norm=23.01964569091797, loss=1.5016489028930664, param_norm=1887.01806640625
Step 229: grad_norm=17.97309684753418, loss=1.6993117332458496, param_norm=1887.0184326171875
10:21:30.538 [I] Progress on: 229it/1.00kit rate:8.8s/it remaining:1:52:36 elapsed:34:06 postfix:- (511966:tqdm_logging.py:145)
Step 230: grad_norm=7.887940883636475, loss=1.6013184785842896, param_norm=1887.0185546875
Step 231: grad_norm=5.929987907409668, loss=1.3891589641571045, param_norm=1887.0189208984375
10:21:48.139 [I] Progress on: 231it/1.00kit rate:8.8s/it remaining:1:52:27 elapsed:34:24 postfix:- (511966:tqdm_logging.py:145)
Step 232: grad_norm=11.596234321594238, loss=1.5357351303100586, param_norm=1887.0191650390625
Step 233: grad_norm=16.386974334716797, loss=1.6970328092575073, param_norm=1887.01953125
10:22:05.687 [I] Progress on: 233it/1.00kit rate:8.8s/it remaining:1:52:05 elapsed:34:41 postfix:- (511966:tqdm_logging.py:145)
Step 234: grad_norm=16.406211853027344, loss=1.3462101221084595, param_norm=1887.019775390625
Step 235: grad_norm=8.651885986328125, loss=1.4784663915634155, param_norm=1887.02001953125
10:22:23.288 [I] Progress on: 235it/1.00kit rate:8.8s/it remaining:1:51:53 elapsed:34:59 postfix:- (511966:tqdm_logging.py:145)
Step 236: grad_norm=15.724416732788086, loss=1.8015618324279785, param_norm=1887.0203857421875
Step 237: grad_norm=12.285737037658691, loss=1.6380292177200317, param_norm=1887.0206298828125
10:22:40.858 [I] Progress on: 237it/1.00kit rate:8.8s/it remaining:1:51:32 elapsed:35:17 postfix:- (511966:tqdm_logging.py:145)
Step 238: grad_norm=9.867121696472168, loss=1.576448678970337, param_norm=1887.0211181640625
Step 239: grad_norm=12.284546852111816, loss=1.4683666229248047, param_norm=1887.0213623046875
10:22:58.476 [I] Progress on: 239it/1.00kit rate:8.8s/it remaining:1:51:22 elapsed:35:34 postfix:- (511966:tqdm_logging.py:145)
Step 240: grad_norm=11.945282936096191, loss=1.547236442565918, param_norm=1887.021728515625
Step 241: grad_norm=10.927583694458008, loss=1.507373332977295, param_norm=1887.0220947265625
10:23:16.009 [I] Progress on: 241it/1.00kit rate:8.8s/it remaining:1:50:54 elapsed:35:52 postfix:- (511966:tqdm_logging.py:145)
Step 242: grad_norm=9.633135795593262, loss=1.4987473487854004, param_norm=1887.0223388671875
Step 243: grad_norm=6.170901775360107, loss=1.4628005027770996, param_norm=1887.022705078125
10:23:33.601 [I] Progress on: 243it/1.00kit rate:8.8s/it remaining:1:50:42 elapsed:36:09 postfix:- (511966:tqdm_logging.py:145)
Step 244: grad_norm=7.683186054229736, loss=1.7902729511260986, param_norm=1887.0230712890625
Step 245: grad_norm=9.86037540435791, loss=1.4629437923431396, param_norm=1887.0234375
10:23:51.145 [I] Progress on: 245it/1.00kit rate:8.8s/it remaining:1:50:17 elapsed:36:27 postfix:- (511966:tqdm_logging.py:145)
Step 246: grad_norm=10.010069847106934, loss=1.4672141075134277, param_norm=1887.023681640625
Step 247: grad_norm=13.29472827911377, loss=1.5404722690582275, param_norm=1887.0240478515625
10:24:08.721 [I] Progress on: 247it/1.00kit rate:8.8s/it remaining:1:50:03 elapsed:36:44 postfix:- (511966:tqdm_logging.py:145)
Step 248: grad_norm=10.305848121643066, loss=1.658848524093628, param_norm=1887.0244140625
Step 249: grad_norm=9.19909381866455, loss=1.4355599880218506, param_norm=1887.0247802734375
10:24:26.258 [I] Progress on: 249it/1.00kit rate:8.8s/it remaining:1:49:40 elapsed:37:02 postfix:- (511966:tqdm_logging.py:145)
Step 250: grad_norm=10.709535598754883, loss=1.6650145053863525, param_norm=1887.025146484375
Step 251: grad_norm=7.401546478271484, loss=1.480800986289978, param_norm=1887.025390625
10:24:43.881 [I] Progress on: 251it/1.00kit rate:8.8s/it remaining:1:49:31 elapsed:37:20 postfix:- (511966:tqdm_logging.py:145)
Step 252: grad_norm=9.437641143798828, loss=1.5308899879455566, param_norm=1887.02587890625
Step 253: grad_norm=6.679616451263428, loss=1.4991567134857178, param_norm=1887.026123046875
10:25:01.389 [I] Progress on: 253it/1.00kit rate:8.8s/it remaining:1:49:04 elapsed:37:37 postfix:- (511966:tqdm_logging.py:145)
Step 254: grad_norm=10.374146461486816, loss=1.4306104183197021, param_norm=1887.0264892578125
Step 255: grad_norm=9.19182014465332, loss=1.3934326171875, param_norm=1887.02685546875
10:25:18.994 [I] Progress on: 255it/1.00kit rate:8.8s/it remaining:1:48:56 elapsed:37:55 postfix:- (511966:tqdm_logging.py:145)
Step 256: grad_norm=11.059686660766602, loss=1.3628442287445068, param_norm=1887.0272216796875
10:25:29.697 [I] Progress on: 256it/1.00kit rate:9.4s/it remaining:1:55:59 elapsed:38:05 postfix:- (511966:tqdm_logging.py:145)
Step 257: grad_norm=7.227763652801514, loss=1.1476236581802368, param_norm=1887.027587890625
Step 258: grad_norm=11.037081718444824, loss=1.2465689182281494, param_norm=1887.02783203125
10:25:47.341 [I] Progress on: 258it/1.00kit rate:9.1s/it remaining:1:52:27 elapsed:38:23 postfix:- (511966:tqdm_logging.py:145)
Step 259: grad_norm=10.104779243469238, loss=1.1585702896118164, param_norm=1887.0283203125
Step 260: grad_norm=12.850234031677246, loss=1.322321891784668, param_norm=1887.0286865234375
10:26:04.886 [I] Progress on: 260it/1.00kit rate:8.9s/it remaining:1:50:12 elapsed:38:41 postfix:- (511966:tqdm_logging.py:145)
Step 261: grad_norm=13.984821319580078, loss=1.1478979587554932, param_norm=1887.029052734375
Step 262: grad_norm=9.802055358886719, loss=1.2345545291900635, param_norm=1887.0294189453125
10:26:22.487 [I] Progress on: 262it/1.00kit rate:8.9s/it remaining:1:49:09 elapsed:38:58 postfix:- (511966:tqdm_logging.py:145)
Step 263: grad_norm=18.02155876159668, loss=1.1954878568649292, param_norm=1887.02978515625
Step 264: grad_norm=16.49301528930664, loss=1.4117121696472168, param_norm=1887.0301513671875
10:26:40.040 [I] Progress on: 264it/1.00kit rate:8.8s/it remaining:1:48:19 elapsed:39:16 postfix:- (511966:tqdm_logging.py:145)
Step 265: grad_norm=8.206692695617676, loss=1.1795053482055664, param_norm=1887.030517578125
Step 266: grad_norm=9.470515251159668, loss=1.3170149326324463, param_norm=1887.0308837890625
10:26:57.714 [I] Progress on: 266it/1.00kit rate:8.8s/it remaining:1:47:57 elapsed:39:33 postfix:- (511966:tqdm_logging.py:145)
Step 267: grad_norm=6.443426609039307, loss=1.276076316833496, param_norm=1887.0311279296875
Step 268: grad_norm=11.17949390411377, loss=1.3487200736999512, param_norm=1887.031494140625
10:27:15.304 [I] Progress on: 268it/1.00kit rate:8.8s/it remaining:1:47:45 elapsed:39:51 postfix:- (511966:tqdm_logging.py:145)
Step 269: grad_norm=8.701017379760742, loss=1.1665436029434204, param_norm=1887.0318603515625
Step 270: grad_norm=9.593547821044922, loss=1.2129310369491577, param_norm=1887.0322265625
10:27:32.954 [I] Progress on: 270it/1.00kit rate:8.8s/it remaining:1:47:30 elapsed:40:09 postfix:- (511966:tqdm_logging.py:145)
Step 271: grad_norm=11.760918617248535, loss=1.3446376323699951, param_norm=1887.032470703125
Step 272: grad_norm=11.511069297790527, loss=1.3202967643737793, param_norm=1887.0328369140625
10:27:50.516 [I] Progress on: 272it/1.00kit rate:8.8s/it remaining:1:46:58 elapsed:40:26 postfix:- (511966:tqdm_logging.py:145)
Step 273: grad_norm=12.904379844665527, loss=1.1694296598434448, param_norm=1887.033203125
Step 274: grad_norm=11.506635665893555, loss=1.3462347984313965, param_norm=1887.0335693359375
10:28:08.162 [I] Progress on: 274it/1.00kit rate:8.8s/it remaining:1:46:48 elapsed:40:44 postfix:- (511966:tqdm_logging.py:145)
Step 275: grad_norm=12.62805461883545, loss=1.1840065717697144, param_norm=1887.0338134765625
Step 276: grad_norm=9.287277221679688, loss=1.3129489421844482, param_norm=1887.0341796875
10:28:25.732 [I] Progress on: 276it/1.00kit rate:8.8s/it remaining:1:46:21 elapsed:41:01 postfix:- (511966:tqdm_logging.py:145)
Step 277: grad_norm=10.086886405944824, loss=1.4181572198867798, param_norm=1887.0345458984375
Step 278: grad_norm=8.388501167297363, loss=1.1844234466552734, param_norm=1887.034912109375
10:28:43.364 [I] Progress on: 278it/1.00kit rate:8.8s/it remaining:1:46:10 elapsed:41:19 postfix:- (511966:tqdm_logging.py:145)
Step 279: grad_norm=7.45836877822876, loss=1.2405897378921509, param_norm=1887.0352783203125
Step 280: grad_norm=14.771742820739746, loss=1.4603464603424072, param_norm=1887.03564453125
10:29:00.926 [I] Progress on: 280it/1.00kit rate:8.8s/it remaining:1:45:42 elapsed:41:37 postfix:- (511966:tqdm_logging.py:145)
Step 281: grad_norm=8.473422050476074, loss=1.3333535194396973, param_norm=1887.0360107421875
Step 282: grad_norm=11.53287410736084, loss=1.3688137531280518, param_norm=1887.036376953125
10:29:18.560 [I] Progress on: 282it/1.00kit rate:8.8s/it remaining:1:45:34 elapsed:41:54 postfix:- (511966:tqdm_logging.py:145)
Step 283: grad_norm=13.42298698425293, loss=1.2565072774887085, param_norm=1887.0367431640625
Step 284: grad_norm=6.551040172576904, loss=1.161250352859497, param_norm=1887.037109375
10:29:36.134 [I] Progress on: 284it/1.00kit rate:8.8s/it remaining:1:45:08 elapsed:42:12 postfix:- (511966:tqdm_logging.py:145)
Step 285: grad_norm=17.245529174804688, loss=1.3847101926803589, param_norm=1887.037353515625
Step 286: grad_norm=13.907371520996094, loss=1.167563796043396, param_norm=1887.0377197265625
10:29:53.772 [I] Progress on: 286it/1.00kit rate:8.8s/it remaining:1:44:59 elapsed:42:29 postfix:- (511966:tqdm_logging.py:145)
Step 287: grad_norm=9.074891090393066, loss=1.2401416301727295, param_norm=1887.0379638671875
Step 288: grad_norm=11.739975929260254, loss=1.482880711555481, param_norm=1887.038330078125
10:30:11.362 [I] Progress on: 288it/1.00kit rate:8.8s/it remaining:1:44:38 elapsed:42:47 postfix:- (511966:tqdm_logging.py:145)
Step 289: grad_norm=12.627035140991211, loss=1.4020438194274902, param_norm=1887.03857421875
Step 290: grad_norm=12.28748893737793, loss=1.3574600219726562, param_norm=1887.0389404296875
10:30:28.988 [I] Progress on: 290it/1.00kit rate:8.8s/it remaining:1:44:28 elapsed:43:05 postfix:- (511966:tqdm_logging.py:145)
Step 291: grad_norm=8.82386589050293, loss=1.2512215375900269, param_norm=1887.0391845703125
Step 292: grad_norm=13.503170013427734, loss=1.0696310997009277, param_norm=1887.0394287109375
10:30:46.536 [I] Progress on: 292it/1.00kit rate:8.8s/it remaining:1:43:54 elapsed:43:22 postfix:- (511966:tqdm_logging.py:145)
Step 293: grad_norm=7.1313347816467285, loss=1.2171038389205933, param_norm=1887.0399169921875
Step 294: grad_norm=8.207653045654297, loss=1.3375537395477295, param_norm=1887.0401611328125
10:31:04.136 [I] Progress on: 294it/1.00kit rate:8.8s/it remaining:1:43:43 elapsed:43:40 postfix:- (511966:tqdm_logging.py:145)
Step 295: grad_norm=5.986806392669678, loss=1.2922186851501465, param_norm=1887.0406494140625
Step 296: grad_norm=10.351420402526855, loss=1.1809355020523071, param_norm=1887.0408935546875
10:31:21.703 [I] Progress on: 296it/1.00kit rate:8.8s/it remaining:1:43:16 elapsed:43:57 postfix:- (511966:tqdm_logging.py:145)
Step 297: grad_norm=12.041459083557129, loss=1.2429250478744507, param_norm=1887.0413818359375
Step 298: grad_norm=17.68168067932129, loss=1.2514455318450928, param_norm=1887.041748046875
10:31:39.323 [I] Progress on: 298it/1.00kit rate:8.8s/it remaining:1:43:08 elapsed:44:15 postfix:- (511966:tqdm_logging.py:145)
Step 299: grad_norm=7.926491737365723, loss=1.1989140510559082, param_norm=1887.0421142578125
Step 300: grad_norm=13.462414741516113, loss=1.1394054889678955, param_norm=1887.0423583984375
10:31:56.894 [I] Progress on: 300it/1.00kit rate:8.8s/it remaining:1:42:43 elapsed:44:33 postfix:- (511966:tqdm_logging.py:145)
10:31:57.014 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
10:31:57.014 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
10:31:57.014 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (511966:checkpoint_manager.py:1786)
10:31:57.014 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (511966:checkpoint_manager.py:1817)
10:31:57.015 [I] [process=0] Saving checkpoint at step 300                                        (511966:checkpoint_manager.py:1286)
10:31:57.016 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300. (511966:async_checkpointer.py:358)
10:31:57.017 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:31:57.018 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6 (511966:atomicity.py:144)
10:31:57.018 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:31:57.019 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:31:57.020 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (511966:atomicity.py:144)
10:31:57.020 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (511966:atomicity.py:144)
10:31:57.021 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:31:57.026 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
10:32:00.445 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
10:32:00.445 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.0 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:32:00.447 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
10:32:00.448 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
10:32:00.472 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
10:32:00.474 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
10:32:00.477 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
10:32:00.482 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
10:32:00.485 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
10:32:00.486 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744122717.014383, 'wait_for_prev_duration_secs': 0.0006935596466064453, 'checkpointer_blocking_start_time': 1744122717.0157046, 'checkpointer_blocking_duration_secs': 3.456465005874634, 'get_old_steps_start_time': 1744122720.472233, 'get_old_steps_duration_secs': 0.005028724670410156, 'checkpoint_manager_blocking_start_time': 1744122717.0141892, 'checkpoint_manager_blocking_duration_secs': 3.4719202518463135} (511966:standard_logger.py:34)
10:32:08.464 [I] ChainedFuture completed 1/1 futures in 8.01 seconds.                             (511966:future.py:137)
10:32:08.464 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 905.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:32:08.464 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
10:32:08.465 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6 (511966:async_checkpointer.py:406)
10:32:08.465 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6/assets (511966:atomicity.py:287)
10:32:08.474 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6/params (511966:atomicity.py:287)
10:32:08.474 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300 (511966:async_checkpointer.py:416)
10:32:08.474 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6 (511966:async_checkpointer.py:426)
10:32:08.474 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300 (511966:atomicity.py:287)
10:32:08.476 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/300`. (511966:atomicity.py:548)
10:32:08.476 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
10:32:08.476 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
10:32:08.476 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
10:32:08.477 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
10:32:08.477 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 301: grad_norm=17.398427963256836, loss=1.4418689012527466, param_norm=1887.042724609375
10:32:09.069 [I] Progress on: 301it/1.00kit rate:9.8s/it remaining:1:54:26 elapsed:44:45 postfix:- (511966:tqdm_logging.py:145)
Step 302: grad_norm=15.754288673400879, loss=1.2633941173553467, param_norm=1887.0430908203125
Step 303: grad_norm=10.925729751586914, loss=1.2308859825134277, param_norm=1887.0433349609375
10:32:26.726 [I] Progress on: 303it/1.00kit rate:9.3s/it remaining:1:48:03 elapsed:45:02 postfix:- (511966:tqdm_logging.py:145)
Step 304: grad_norm=27.467641830444336, loss=1.4699530601501465, param_norm=1887.0435791015625
Step 305: grad_norm=12.654600143432617, loss=1.2859771251678467, param_norm=1887.0439453125
10:32:44.279 [I] Progress on: 305it/1.00kit rate:9.0s/it remaining:1:44:33 elapsed:45:20 postfix:- (511966:tqdm_logging.py:145)
Step 306: grad_norm=11.296040534973145, loss=1.5248987674713135, param_norm=1887.044189453125
Step 307: grad_norm=10.827215194702148, loss=1.306217074394226, param_norm=1887.04443359375
10:33:01.887 [I] Progress on: 307it/1.00kit rate:8.9s/it remaining:1:42:50 elapsed:45:38 postfix:- (511966:tqdm_logging.py:145)
Step 308: grad_norm=20.170089721679688, loss=1.2015957832336426, param_norm=1887.044677734375
Step 309: grad_norm=16.217796325683594, loss=1.2535171508789062, param_norm=1887.0450439453125
10:33:19.438 [I] Progress on: 309it/1.00kit rate:8.8s/it remaining:1:41:41 elapsed:45:55 postfix:- (511966:tqdm_logging.py:145)
Step 310: grad_norm=14.67509937286377, loss=1.1324357986450195, param_norm=1887.0452880859375
Step 311: grad_norm=16.243083953857422, loss=1.3327240943908691, param_norm=1887.0455322265625
10:33:37.034 [I] Progress on: 311it/1.00kit rate:8.8s/it remaining:1:41:06 elapsed:46:13 postfix:- (511966:tqdm_logging.py:145)
Step 312: grad_norm=13.834009170532227, loss=1.1688255071640015, param_norm=1887.0457763671875
Step 313: grad_norm=15.005500793457031, loss=1.2251558303833008, param_norm=1887.0460205078125
10:33:54.595 [I] Progress on: 313it/1.00kit rate:8.8s/it remaining:1:40:33 elapsed:46:30 postfix:- (511966:tqdm_logging.py:145)
Step 314: grad_norm=13.033746719360352, loss=1.0921249389648438, param_norm=1887.0462646484375
Step 315: grad_norm=20.671981811523438, loss=1.141291618347168, param_norm=1887.0465087890625
10:34:12.226 [I] Progress on: 315it/1.00kit rate:8.8s/it remaining:1:40:21 elapsed:46:48 postfix:- (511966:tqdm_logging.py:145)
Step 316: grad_norm=12.665626525878906, loss=1.143979549407959, param_norm=1887.0467529296875
Step 317: grad_norm=16.612728118896484, loss=1.385340690612793, param_norm=1887.0469970703125
10:34:29.781 [I] Progress on: 317it/1.00kit rate:8.8s/it remaining:1:39:56 elapsed:47:05 postfix:- (511966:tqdm_logging.py:145)
Step 318: grad_norm=6.402924537658691, loss=1.2470933198928833, param_norm=1887.047119140625
Step 319: grad_norm=22.908172607421875, loss=1.2285007238388062, param_norm=1887.0474853515625
10:34:47.448 [I] Progress on: 319it/1.00kit rate:8.8s/it remaining:1:39:47 elapsed:47:23 postfix:- (511966:tqdm_logging.py:145)
Step 320: grad_norm=16.218284606933594, loss=1.0215351581573486, param_norm=1887.0477294921875
10:34:58.081 [I] Progress on: 320it/1.00kit rate:9.4s/it remaining:1:45:58 elapsed:47:34 postfix:- (511966:tqdm_logging.py:145)
Step 321: grad_norm=10.944352149963379, loss=1.205587387084961, param_norm=1887.0479736328125
Step 322: grad_norm=10.69677448272705, loss=0.963517427444458, param_norm=1887.04833984375
10:35:15.642 [I] Progress on: 322it/1.00kit rate:9.1s/it remaining:1:42:17 elapsed:47:51 postfix:- (511966:tqdm_logging.py:145)
Step 323: grad_norm=10.481165885925293, loss=0.9856501221656799, param_norm=1887.0487060546875
Step 324: grad_norm=9.405904769897461, loss=1.042853593826294, param_norm=1887.049072265625
10:35:33.184 [I] Progress on: 324it/1.00kit rate:8.9s/it remaining:1:40:22 elapsed:48:09 postfix:- (511966:tqdm_logging.py:145)
Step 325: grad_norm=23.092329025268555, loss=1.1243383884429932, param_norm=1887.04931640625
Step 326: grad_norm=11.968430519104004, loss=0.9998226165771484, param_norm=1887.0496826171875
10:35:50.731 [I] Progress on: 326it/1.00kit rate:8.8s/it remaining:1:39:15 elapsed:48:26 postfix:- (511966:tqdm_logging.py:145)
Step 327: grad_norm=12.772208213806152, loss=0.9227486848831177, param_norm=1887.050048828125
Step 328: grad_norm=14.82138442993164, loss=0.9351710677146912, param_norm=1887.0504150390625
10:36:08.302 [I] Progress on: 328it/1.00kit rate:8.8s/it remaining:1:38:37 elapsed:48:44 postfix:- (511966:tqdm_logging.py:145)
Step 329: grad_norm=6.467891216278076, loss=0.9680355787277222, param_norm=1887.05078125
Step 330: grad_norm=6.519821643829346, loss=1.0332703590393066, param_norm=1887.051025390625
10:36:25.883 [I] Progress on: 330it/1.00kit rate:8.8s/it remaining:1:38:11 elapsed:49:02 postfix:- (511966:tqdm_logging.py:145)
Step 331: grad_norm=5.028793811798096, loss=0.9855225086212158, param_norm=1887.0513916015625
Step 332: grad_norm=6.755542278289795, loss=0.8611679077148438, param_norm=1887.0517578125
10:36:43.461 [I] Progress on: 332it/1.00kit rate:8.8s/it remaining:1:37:51 elapsed:49:19 postfix:- (511966:tqdm_logging.py:145)
Step 333: grad_norm=14.103408813476562, loss=0.9933046102523804, param_norm=1887.052001953125
Step 334: grad_norm=6.880593299865723, loss=1.060014009475708, param_norm=1887.0523681640625
10:37:01.034 [I] Progress on: 334it/1.00kit rate:8.8s/it remaining:1:37:30 elapsed:49:37 postfix:- (511966:tqdm_logging.py:145)
Step 335: grad_norm=6.867897033691406, loss=1.1151522397994995, param_norm=1887.0528564453125
Step 336: grad_norm=14.25400161743164, loss=0.8866982460021973, param_norm=1887.0531005859375
10:37:18.619 [I] Progress on: 336it/1.00kit rate:8.8s/it remaining:1:37:13 elapsed:49:54 postfix:- (511966:tqdm_logging.py:145)
Step 337: grad_norm=13.755593299865723, loss=1.020355463027954, param_norm=1887.053466796875
Step 338: grad_norm=5.111880302429199, loss=0.7368372678756714, param_norm=1887.0538330078125
10:37:36.187 [I] Progress on: 338it/1.00kit rate:8.8s/it remaining:1:36:54 elapsed:50:12 postfix:- (511966:tqdm_logging.py:145)
Step 339: grad_norm=5.167901039123535, loss=0.8817287087440491, param_norm=1887.0540771484375
Step 340: grad_norm=7.762641429901123, loss=1.0000122785568237, param_norm=1887.054443359375
10:37:53.741 [I] Progress on: 340it/1.00kit rate:8.8s/it remaining:1:36:34 elapsed:50:29 postfix:- (511966:tqdm_logging.py:145)
Step 341: grad_norm=8.321319580078125, loss=1.1375164985656738, param_norm=1887.0546875
Step 342: grad_norm=7.4316253662109375, loss=1.1396156549453735, param_norm=1887.054931640625
10:38:11.327 [I] Progress on: 342it/1.00kit rate:8.8s/it remaining:1:36:18 elapsed:50:47 postfix:- (511966:tqdm_logging.py:145)
Step 343: grad_norm=7.876341342926025, loss=1.1313791275024414, param_norm=1887.055419921875
Step 344: grad_norm=9.723759651184082, loss=0.9304860830307007, param_norm=1887.0557861328125
10:38:28.885 [I] Progress on: 344it/1.00kit rate:8.8s/it remaining:1:35:58 elapsed:51:05 postfix:- (511966:tqdm_logging.py:145)
Step 345: grad_norm=9.374551773071289, loss=0.9841101169586182, param_norm=1887.0560302734375
Step 346: grad_norm=8.50135612487793, loss=1.1162258386611938, param_norm=1887.0562744140625
10:38:46.453 [I] Progress on: 346it/1.00kit rate:8.8s/it remaining:1:35:41 elapsed:51:22 postfix:- (511966:tqdm_logging.py:145)
Step 347: grad_norm=8.00887680053711, loss=1.158676266670227, param_norm=1887.056640625
Step 348: grad_norm=7.596697807312012, loss=1.0881261825561523, param_norm=1887.0570068359375
10:39:04.006 [I] Progress on: 348it/1.00kit rate:8.8s/it remaining:1:35:21 elapsed:51:40 postfix:- (511966:tqdm_logging.py:145)
Step 349: grad_norm=8.316611289978027, loss=0.964860200881958, param_norm=1887.0572509765625
Step 350: grad_norm=11.75489616394043, loss=1.0385187864303589, param_norm=1887.0576171875
10:39:21.556 [I] Progress on: 350it/1.00kit rate:8.8s/it remaining:1:35:03 elapsed:51:57 postfix:- (511966:tqdm_logging.py:145)
Step 351: grad_norm=5.950482368469238, loss=1.1485587358474731, param_norm=1887.0579833984375
Step 352: grad_norm=13.460338592529297, loss=1.0308388471603394, param_norm=1887.0582275390625
10:39:39.102 [I] Progress on: 352it/1.00kit rate:8.8s/it remaining:1:34:44 elapsed:52:15 postfix:- (511966:tqdm_logging.py:145)
Step 353: grad_norm=12.14637565612793, loss=1.1674864292144775, param_norm=1887.05859375
Step 354: grad_norm=6.669754981994629, loss=0.9248366355895996, param_norm=1887.0589599609375
10:39:56.631 [I] Progress on: 354it/1.00kit rate:8.8s/it remaining:1:34:23 elapsed:52:32 postfix:- (511966:tqdm_logging.py:145)
Step 355: grad_norm=6.708836555480957, loss=0.974032998085022, param_norm=1887.059326171875
Step 356: grad_norm=9.13853645324707, loss=0.9825460910797119, param_norm=1887.0595703125
10:40:14.210 [I] Progress on: 356it/1.00kit rate:8.8s/it remaining:1:34:10 elapsed:52:50 postfix:- (511966:tqdm_logging.py:145)
Step 357: grad_norm=11.635401725769043, loss=1.148068904876709, param_norm=1887.06005859375
Step 358: grad_norm=7.503077030181885, loss=1.1196701526641846, param_norm=1887.060302734375
10:40:31.975 [I] Progress on: 358it/1.00kit rate:8.8s/it remaining:1:34:32 elapsed:53:08 postfix:- (511966:tqdm_logging.py:145)
Step 359: grad_norm=7.908194065093994, loss=0.8852781653404236, param_norm=1887.060546875
Step 360: grad_norm=8.841014862060547, loss=1.0166186094284058, param_norm=1887.060791015625
10:40:49.517 [I] Progress on: 360it/1.00kit rate:8.8s/it remaining:1:33:51 elapsed:53:25 postfix:- (511966:tqdm_logging.py:145)
Step 361: grad_norm=12.949803352355957, loss=1.036536693572998, param_norm=1887.0611572265625
Step 362: grad_norm=5.720375061035156, loss=1.0337095260620117, param_norm=1887.0615234375
10:41:07.057 [I] Progress on: 362it/1.00kit rate:8.8s/it remaining:1:33:24 elapsed:53:43 postfix:- (511966:tqdm_logging.py:145)
Step 363: grad_norm=9.460907936096191, loss=1.0497756004333496, param_norm=1887.061767578125
Step 364: grad_norm=6.425159454345703, loss=0.926088809967041, param_norm=1887.062255859375
10:41:24.604 [I] Progress on: 364it/1.00kit rate:8.8s/it remaining:1:33:00 elapsed:54:00 postfix:- (511966:tqdm_logging.py:145)
Step 365: grad_norm=10.359294891357422, loss=1.1595182418823242, param_norm=1887.0625
Step 366: grad_norm=6.867102146148682, loss=1.0869300365447998, param_norm=1887.0628662109375
10:41:42.156 [I] Progress on: 366it/1.00kit rate:8.8s/it remaining:1:32:41 elapsed:54:18 postfix:- (511966:tqdm_logging.py:145)
Step 367: grad_norm=13.461005210876465, loss=1.1301968097686768, param_norm=1887.063232421875
Step 368: grad_norm=9.02448844909668, loss=1.0766847133636475, param_norm=1887.0633544921875
10:41:59.714 [I] Progress on: 368it/1.00kit rate:8.8s/it remaining:1:32:24 elapsed:54:35 postfix:- (511966:tqdm_logging.py:145)
Step 369: grad_norm=9.088013648986816, loss=0.912699282169342, param_norm=1887.063720703125
Step 370: grad_norm=7.6390380859375, loss=1.1423320770263672, param_norm=1887.06396484375
10:42:17.264 [I] Progress on: 370it/1.00kit rate:8.8s/it remaining:1:32:07 elapsed:54:53 postfix:- (511966:tqdm_logging.py:145)
Step 371: grad_norm=18.640485763549805, loss=1.0717391967773438, param_norm=1887.064208984375
Step 372: grad_norm=6.9405293464660645, loss=1.1231571435928345, param_norm=1887.064453125
10:42:34.868 [I] Progress on: 372it/1.00kit rate:8.8s/it remaining:1:31:55 elapsed:55:11 postfix:- (511966:tqdm_logging.py:145)
Step 373: grad_norm=7.056365013122559, loss=1.0377528667449951, param_norm=1887.064697265625
Step 374: grad_norm=8.457571029663086, loss=0.9738787412643433, param_norm=1887.06494140625
10:42:52.456 [I] Progress on: 374it/1.00kit rate:8.8s/it remaining:1:31:38 elapsed:55:28 postfix:- (511966:tqdm_logging.py:145)
Step 375: grad_norm=8.675943374633789, loss=1.0796043872833252, param_norm=1887.065185546875
Step 376: grad_norm=12.294597625732422, loss=0.9712314605712891, param_norm=1887.0654296875
10:43:10.020 [I] Progress on: 376it/1.00kit rate:8.8s/it remaining:1:31:17 elapsed:55:46 postfix:- (511966:tqdm_logging.py:145)
Step 377: grad_norm=8.122848510742188, loss=0.8900958895683289, param_norm=1887.065673828125
Step 378: grad_norm=12.772479057312012, loss=1.0996567010879517, param_norm=1887.06591796875
10:43:27.575 [I] Progress on: 378it/1.00kit rate:8.8s/it remaining:1:31:00 elapsed:56:03 postfix:- (511966:tqdm_logging.py:145)
Step 379: grad_norm=9.26821517944336, loss=1.047505497932434, param_norm=1887.066162109375
Step 380: grad_norm=6.986279010772705, loss=0.9743286371231079, param_norm=1887.06640625
10:43:45.139 [I] Progress on: 380it/1.00kit rate:8.8s/it remaining:1:30:41 elapsed:56:21 postfix:- (511966:tqdm_logging.py:145)
Step 381: grad_norm=13.567756652832031, loss=1.143026351928711, param_norm=1887.0665283203125
Step 382: grad_norm=16.023664474487305, loss=1.0459299087524414, param_norm=1887.06689453125
10:44:02.704 [I] Progress on: 382it/1.00kit rate:8.8s/it remaining:1:30:24 elapsed:56:38 postfix:- (511966:tqdm_logging.py:145)
Step 383: grad_norm=8.591144561767578, loss=1.0314009189605713, param_norm=1887.0670166015625
10:44:13.668 [I] Progress on: 384it/1.00kit rate:9.4s/it remaining:1:36:16 elapsed:56:49 postfix:- (511966:tqdm_logging.py:145)
Step 384: grad_norm=6.001415729522705, loss=0.9204128384590149, param_norm=1887.0672607421875
Step 385: grad_norm=9.120216369628906, loss=0.803941011428833, param_norm=1887.0673828125
10:44:30.947 [I] Progress on: 385it/1.00kit rate:9.2s/it remaining:1:34:00 elapsed:57:07 postfix:- (511966:tqdm_logging.py:145)
Step 386: grad_norm=5.101595401763916, loss=0.7306762933731079, param_norm=1887.0677490234375
Step 387: grad_norm=11.97445011138916, loss=0.8699662685394287, param_norm=1887.0679931640625
10:44:48.561 [I] Progress on: 387it/1.00kit rate:9.0s/it remaining:1:31:40 elapsed:57:24 postfix:- (511966:tqdm_logging.py:145)
Step 388: grad_norm=10.581279754638672, loss=0.9726532697677612, param_norm=1887.068115234375
Step 389: grad_norm=18.049943923950195, loss=0.8227022886276245, param_norm=1887.0684814453125
10:45:06.126 [I] Progress on: 389it/1.00kit rate:8.9s/it remaining:1:30:19 elapsed:57:42 postfix:- (511966:tqdm_logging.py:145)
Step 390: grad_norm=10.007509231567383, loss=0.838135302066803, param_norm=1887.068603515625
Step 391: grad_norm=5.601825714111328, loss=0.8423237800598145, param_norm=1887.06884765625
10:45:23.752 [I] Progress on: 391it/1.00kit rate:8.8s/it remaining:1:29:37 elapsed:57:59 postfix:- (511966:tqdm_logging.py:145)
Step 392: grad_norm=12.824593544006348, loss=0.8008137941360474, param_norm=1887.069091796875
Step 393: grad_norm=12.640223503112793, loss=0.9704169034957886, param_norm=1887.0693359375
10:45:41.328 [I] Progress on: 393it/1.00kit rate:8.8s/it remaining:1:29:03 elapsed:58:17 postfix:- (511966:tqdm_logging.py:145)
Step 394: grad_norm=10.744444847106934, loss=0.817895770072937, param_norm=1887.069580078125
Step 395: grad_norm=6.266765594482422, loss=0.8909128308296204, param_norm=1887.06982421875
10:45:58.954 [I] Progress on: 395it/1.00kit rate:8.8s/it remaining:1:28:42 elapsed:58:35 postfix:- (511966:tqdm_logging.py:145)
Step 396: grad_norm=7.511111259460449, loss=0.7267295122146606, param_norm=1887.070068359375
Step 397: grad_norm=18.590593338012695, loss=0.9482096433639526, param_norm=1887.0703125
10:46:16.530 [I] Progress on: 397it/1.00kit rate:8.8s/it remaining:1:28:18 elapsed:58:52 postfix:- (511966:tqdm_logging.py:145)
Step 398: grad_norm=6.038494110107422, loss=0.7153220176696777, param_norm=1887.070556640625
Step 399: grad_norm=10.819618225097656, loss=0.8502890467643738, param_norm=1887.0709228515625
10:46:34.159 [I] Progress on: 399it/1.00kit rate:8.8s/it remaining:1:28:03 elapsed:59:10 postfix:- (511966:tqdm_logging.py:145)
Step 400: grad_norm=8.0481538772583, loss=0.7898433208465576, param_norm=1887.0711669921875
10:46:43.138 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
10:46:43.138 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
10:46:43.138 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (511966:checkpoint_manager.py:1786)
10:46:43.138 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (511966:checkpoint_manager.py:1817)
10:46:43.139 [I] [process=0] Saving checkpoint at step 400                                        (511966:checkpoint_manager.py:1286)
10:46:43.140 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400. (511966:async_checkpointer.py:358)
10:46:43.141 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:46:43.141 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9 (511966:atomicity.py:144)
10:46:43.142 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:46:43.142 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
10:46:43.143 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (511966:atomicity.py:144)
10:46:43.144 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (511966:atomicity.py:144)
10:46:43.144 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
10:46:43.149 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
10:46:46.730 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
10:46:46.731 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:46:46.733 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
10:46:46.737 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
10:46:46.766 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
10:46:46.775 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
10:46:46.778 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
10:46:46.779 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
10:46:46.780 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
10:46:46.781 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
10:46:46.781 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744123603.1382568, 'wait_for_prev_duration_secs': 0.0006434917449951172, 'checkpointer_blocking_start_time': 1744123603.1395006, 'checkpointer_blocking_duration_secs': 3.626227855682373, 'get_old_steps_start_time': 1744123606.7658737, 'get_old_steps_duration_secs': 0.013963937759399414, 'checkpoint_manager_blocking_start_time': 1744123603.138068, 'checkpoint_manager_blocking_duration_secs': 3.6432881355285645} (511966:standard_logger.py:34)
10:46:46.782 [I] Progress on: 401it/1.00kit rate:9.9s/it remaining:1:38:36 elapsed:59:22 postfix:- (511966:tqdm_logging.py:145)
10:46:54.405 [I] ChainedFuture completed 1/1 futures in 7.66 seconds.                             (511966:future.py:137)
10:46:54.406 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 920.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
10:46:54.406 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
10:46:54.408 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9 (511966:async_checkpointer.py:406)
10:46:54.409 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9/assets (511966:atomicity.py:287)
10:46:54.419 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9/params (511966:atomicity.py:287)
10:46:54.420 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400 (511966:async_checkpointer.py:416)
10:46:54.420 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9 (511966:async_checkpointer.py:426)
10:46:54.420 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400 (511966:atomicity.py:287)
10:46:54.422 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/400`. (511966:atomicity.py:548)
10:46:54.422 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
10:46:54.423 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
10:46:54.423 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
10:46:54.423 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
10:46:54.424 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 401: grad_norm=9.860478401184082, loss=0.9459330439567566, param_norm=1887.0712890625
Step 402: grad_norm=6.444891929626465, loss=0.8933480978012085, param_norm=1887.0716552734375
10:47:04.303 [I] Progress on: 402it/1.00kit rate:9.6s/it remaining:1:35:38 elapsed:59:40 postfix:- (511966:tqdm_logging.py:145)
Step 403: grad_norm=6.118673324584961, loss=0.819267988204956, param_norm=1887.0718994140625
Step 404: grad_norm=8.617968559265137, loss=0.9377449750900269, param_norm=1887.0721435546875
10:47:21.879 [I] Progress on: 404it/1.00kit rate:9.2s/it remaining:1:31:17 elapsed:59:58 postfix:- (511966:tqdm_logging.py:145)
Step 405: grad_norm=5.968976974487305, loss=0.9395394325256348, param_norm=1887.0723876953125
Step 406: grad_norm=7.595799922943115, loss=0.7731990814208984, param_norm=1887.07275390625
10:47:39.499 [I] Progress on: 406it/1.00kit rate:9.0s/it remaining:1:29:08 elapsed:1:00:15 postfix:- (511966:tqdm_logging.py:145)
Step 407: grad_norm=8.176721572875977, loss=0.8346855640411377, param_norm=1887.072998046875
Step 408: grad_norm=10.801861763000488, loss=0.798999547958374, param_norm=1887.0732421875
10:47:57.062 [I] Progress on: 408it/1.00kit rate:8.9s/it remaining:1:27:47 elapsed:1:00:33 postfix:- (511966:tqdm_logging.py:145)
Step 409: grad_norm=6.8278021812438965, loss=0.7376738786697388, param_norm=1887.0736083984375
Step 410: grad_norm=6.170801639556885, loss=0.9259989261627197, param_norm=1887.0738525390625
10:48:14.666 [I] Progress on: 410it/1.00kit rate:8.9s/it remaining:1:27:05 elapsed:1:00:50 postfix:- (511966:tqdm_logging.py:145)
Step 411: grad_norm=7.882381916046143, loss=0.8496800661087036, param_norm=1887.0740966796875
Step 412: grad_norm=5.694756984710693, loss=0.7575658559799194, param_norm=1887.074462890625
10:48:32.237 [I] Progress on: 412it/1.00kit rate:8.8s/it remaining:1:26:31 elapsed:1:01:08 postfix:- (511966:tqdm_logging.py:145)
Step 413: grad_norm=6.714706897735596, loss=0.8603370189666748, param_norm=1887.0745849609375
Step 414: grad_norm=6.065081596374512, loss=0.8671554327011108, param_norm=1887.0748291015625
10:48:49.860 [I] Progress on: 414it/1.00kit rate:8.8s/it remaining:1:26:13 elapsed:1:01:26 postfix:- (511966:tqdm_logging.py:145)
Step 415: grad_norm=11.068321228027344, loss=0.9996118545532227, param_norm=1887.0750732421875
Step 416: grad_norm=9.589570045471191, loss=0.7570476531982422, param_norm=1887.075439453125
10:49:07.427 [I] Progress on: 416it/1.00kit rate:8.8s/it remaining:1:25:46 elapsed:1:01:43 postfix:- (511966:tqdm_logging.py:145)
Step 417: grad_norm=7.637282848358154, loss=0.7290140390396118, param_norm=1887.0755615234375
Step 418: grad_norm=5.6664862632751465, loss=0.7436320781707764, param_norm=1887.0758056640625
10:49:25.052 [I] Progress on: 418it/1.00kit rate:8.8s/it remaining:1:25:35 elapsed:1:02:01 postfix:- (511966:tqdm_logging.py:145)
Step 419: grad_norm=9.71241569519043, loss=0.9034996628761292, param_norm=1887.075927734375
Step 420: grad_norm=10.336791038513184, loss=0.9603747129440308, param_norm=1887.0762939453125
10:49:42.623 [I] Progress on: 420it/1.00kit rate:8.8s/it remaining:1:25:09 elapsed:1:02:18 postfix:- (511966:tqdm_logging.py:145)
Step 421: grad_norm=10.032135963439941, loss=0.7860349416732788, param_norm=1887.0765380859375
Step 422: grad_norm=7.5715837478637695, loss=0.8742718696594238, param_norm=1887.0767822265625
10:50:00.269 [I] Progress on: 422it/1.00kit rate:8.8s/it remaining:1:24:59 elapsed:1:02:36 postfix:- (511966:tqdm_logging.py:145)
Step 423: grad_norm=5.281642436981201, loss=0.7204058766365051, param_norm=1887.0770263671875
Step 424: grad_norm=8.472832679748535, loss=0.9672828912734985, param_norm=1887.0772705078125
10:50:17.838 [I] Progress on: 424it/1.00kit rate:8.8s/it remaining:1:24:35 elapsed:1:02:54 postfix:- (511966:tqdm_logging.py:145)
Step 425: grad_norm=9.706937789916992, loss=0.8918217420578003, param_norm=1887.077392578125
Step 426: grad_norm=8.481999397277832, loss=0.7473065853118896, param_norm=1887.07763671875
10:50:35.480 [I] Progress on: 426it/1.00kit rate:8.8s/it remaining:1:24:25 elapsed:1:03:11 postfix:- (511966:tqdm_logging.py:145)
Step 427: grad_norm=9.407920837402344, loss=0.9383974075317383, param_norm=1887.077880859375
Step 428: grad_norm=11.759866714477539, loss=0.8158446550369263, param_norm=1887.078125
10:50:53.077 [I] Progress on: 428it/1.00kit rate:8.8s/it remaining:1:24:03 elapsed:1:03:29 postfix:- (511966:tqdm_logging.py:145)
Step 429: grad_norm=6.142922878265381, loss=0.8393481373786926, param_norm=1887.0782470703125
Step 430: grad_norm=14.9224214553833, loss=0.8197656869888306, param_norm=1887.0784912109375
10:51:10.741 [I] Progress on: 430it/1.00kit rate:8.8s/it remaining:1:23:56 elapsed:1:03:46 postfix:- (511966:tqdm_logging.py:145)
Step 431: grad_norm=9.668989181518555, loss=0.8317142724990845, param_norm=1887.0787353515625
Step 432: grad_norm=6.357995510101318, loss=0.7770265936851501, param_norm=1887.078857421875
10:51:28.301 [I] Progress on: 432it/1.00kit rate:8.8s/it remaining:1:23:27 elapsed:1:04:04 postfix:- (511966:tqdm_logging.py:145)
Step 433: grad_norm=9.237117767333984, loss=0.947004497051239, param_norm=1887.0791015625
Step 434: grad_norm=12.729540824890137, loss=0.8175082802772522, param_norm=1887.079345703125
10:51:45.925 [I] Progress on: 434it/1.00kit rate:8.8s/it remaining:1:23:13 elapsed:1:04:22 postfix:- (511966:tqdm_logging.py:145)
Step 435: grad_norm=12.686881065368652, loss=0.9271402359008789, param_norm=1887.0794677734375
Step 436: grad_norm=5.814854145050049, loss=0.9603683948516846, param_norm=1887.07958984375
10:52:03.503 [I] Progress on: 436it/1.00kit rate:8.8s/it remaining:1:22:50 elapsed:1:04:39 postfix:- (511966:tqdm_logging.py:145)
Step 437: grad_norm=8.337636947631836, loss=0.8744953274726868, param_norm=1887.079833984375
Step 438: grad_norm=6.01551628112793, loss=0.7690256237983704, param_norm=1887.0799560546875
10:52:21.227 [I] Progress on: 438it/1.00kit rate:8.8s/it remaining:1:22:50 elapsed:1:04:57 postfix:- (511966:tqdm_logging.py:145)
Step 439: grad_norm=10.442699432373047, loss=0.8380447626113892, param_norm=1887.0802001953125
Step 440: grad_norm=6.154338359832764, loss=0.8178946375846863, param_norm=1887.0804443359375
10:52:38.808 [I] Progress on: 440it/1.00kit rate:8.8s/it remaining:1:22:21 elapsed:1:05:15 postfix:- (511966:tqdm_logging.py:145)
Step 441: grad_norm=6.885803699493408, loss=0.756803035736084, param_norm=1887.0806884765625
Step 442: grad_norm=5.367650508880615, loss=0.719899594783783, param_norm=1887.0809326171875
10:52:56.447 [I] Progress on: 442it/1.00kit rate:8.8s/it remaining:1:22:07 elapsed:1:05:32 postfix:- (511966:tqdm_logging.py:145)
Step 443: grad_norm=6.156620979309082, loss=0.8506618142127991, param_norm=1887.0810546875
Step 444: grad_norm=8.813773155212402, loss=0.9176971912384033, param_norm=1887.081298828125
10:53:14.112 [I] Progress on: 444it/1.00kit rate:8.8s/it remaining:1:21:54 elapsed:1:05:50 postfix:- (511966:tqdm_logging.py:145)
Step 445: grad_norm=7.3174262046813965, loss=0.7145826816558838, param_norm=1887.08154296875
Step 446: grad_norm=6.854989528656006, loss=0.8401402235031128, param_norm=1887.081787109375
10:53:31.811 [I] Progress on: 446it/1.00kit rate:8.9s/it remaining:1:21:48 elapsed:1:06:08 postfix:- (511966:tqdm_logging.py:145)
Step 447: grad_norm=6.066999435424805, loss=0.8245363235473633, param_norm=1887.0819091796875
10:53:42.653 [I] Progress on: 448it/1.00kit rate:9.4s/it remaining:1:26:22 elapsed:1:06:18 postfix:- (511966:tqdm_logging.py:145)
Step 448: grad_norm=5.048459529876709, loss=0.7207207679748535, param_norm=1887.0821533203125
Step 449: grad_norm=9.674942970275879, loss=0.6726662516593933, param_norm=1887.0823974609375
10:53:59.953 [I] Progress on: 449it/1.00kit rate:9.2s/it remaining:1:24:19 elapsed:1:06:36 postfix:- (511966:tqdm_logging.py:145)
Step 450: grad_norm=9.584280014038086, loss=0.7094348669052124, param_norm=1887.0826416015625
Step 451: grad_norm=6.818601131439209, loss=0.7249124646186829, param_norm=1887.0828857421875
10:54:17.581 [I] Progress on: 451it/1.00kit rate:9.0s/it remaining:1:22:12 elapsed:1:06:53 postfix:- (511966:tqdm_logging.py:145)
Step 452: grad_norm=6.817606449127197, loss=0.7090046405792236, param_norm=1887.083251953125
Step 453: grad_norm=15.563697814941406, loss=0.6554765701293945, param_norm=1887.08349609375
10:54:35.157 [I] Progress on: 453it/1.00kit rate:8.9s/it remaining:1:20:56 elapsed:1:07:11 postfix:- (511966:tqdm_logging.py:145)
Step 454: grad_norm=5.158591270446777, loss=0.7050793170928955, param_norm=1887.083740234375
Step 455: grad_norm=5.43858003616333, loss=0.7377681732177734, param_norm=1887.083984375
10:54:52.796 [I] Progress on: 455it/1.00kit rate:8.8s/it remaining:1:20:15 elapsed:1:07:29 postfix:- (511966:tqdm_logging.py:145)
Step 456: grad_norm=11.376168251037598, loss=0.6639516353607178, param_norm=1887.084228515625
Step 457: grad_norm=4.624238967895508, loss=0.6711008548736572, param_norm=1887.08447265625
10:55:10.375 [I] Progress on: 457it/1.00kit rate:8.8s/it remaining:1:19:41 elapsed:1:07:46 postfix:- (511966:tqdm_logging.py:145)
Step 458: grad_norm=8.819396018981934, loss=0.6053928136825562, param_norm=1887.084716796875
Step 459: grad_norm=11.588308334350586, loss=0.7710864543914795, param_norm=1887.0849609375
10:55:28.017 [I] Progress on: 459it/1.00kit rate:8.8s/it remaining:1:19:22 elapsed:1:08:04 postfix:- (511966:tqdm_logging.py:145)
Step 460: grad_norm=6.160161972045898, loss=0.6995676755905151, param_norm=1887.0850830078125
Step 461: grad_norm=9.77908706665039, loss=0.7030327320098877, param_norm=1887.0853271484375
10:55:45.574 [I] Progress on: 461it/1.00kit rate:8.8s/it remaining:1:18:55 elapsed:1:08:21 postfix:- (511966:tqdm_logging.py:145)
Step 462: grad_norm=6.7776103019714355, loss=0.7652139663696289, param_norm=1887.0855712890625
Step 463: grad_norm=6.3043670654296875, loss=0.6749738454818726, param_norm=1887.0858154296875
10:56:03.233 [I] Progress on: 463it/1.00kit rate:8.8s/it remaining:1:18:44 elapsed:1:08:39 postfix:- (511966:tqdm_logging.py:145)
Step 464: grad_norm=6.054572582244873, loss=0.6651313304901123, param_norm=1887.0860595703125
Step 465: grad_norm=4.832039833068848, loss=0.6125545501708984, param_norm=1887.086181640625
10:56:20.824 [I] Progress on: 465it/1.00kit rate:8.8s/it remaining:1:18:21 elapsed:1:08:57 postfix:- (511966:tqdm_logging.py:145)
Step 466: grad_norm=10.345236778259277, loss=0.5913400053977966, param_norm=1887.086669921875
Step 467: grad_norm=7.2881975173950195, loss=0.6671441793441772, param_norm=1887.0867919921875
10:56:38.468 [I] Progress on: 467it/1.00kit rate:8.8s/it remaining:1:18:08 elapsed:1:09:14 postfix:- (511966:tqdm_logging.py:145)
Step 468: grad_norm=7.420724391937256, loss=0.7083956003189087, param_norm=1887.0870361328125
Step 469: grad_norm=5.759143829345703, loss=0.6316656470298767, param_norm=1887.0872802734375
10:56:56.036 [I] Progress on: 469it/1.00kit rate:8.8s/it remaining:1:17:44 elapsed:1:09:32 postfix:- (511966:tqdm_logging.py:145)
Step 470: grad_norm=6.249361991882324, loss=0.8006525635719299, param_norm=1887.08740234375
Step 471: grad_norm=6.362940311431885, loss=0.6133757829666138, param_norm=1887.087646484375
10:57:13.691 [I] Progress on: 471it/1.00kit rate:8.8s/it remaining:1:17:31 elapsed:1:09:49 postfix:- (511966:tqdm_logging.py:145)
Step 472: grad_norm=5.97925329208374, loss=0.657268762588501, param_norm=1887.0880126953125
Step 473: grad_norm=7.646489143371582, loss=0.6632003784179688, param_norm=1887.088134765625
10:57:31.270 [I] Progress on: 473it/1.00kit rate:8.8s/it remaining:1:17:09 elapsed:1:10:07 postfix:- (511966:tqdm_logging.py:145)
Step 474: grad_norm=4.97940731048584, loss=0.7329691052436829, param_norm=1887.0882568359375
Step 475: grad_norm=10.39852523803711, loss=0.6837334036827087, param_norm=1887.0885009765625
10:57:48.926 [I] Progress on: 475it/1.00kit rate:8.8s/it remaining:1:16:58 elapsed:1:10:25 postfix:- (511966:tqdm_logging.py:145)
Step 476: grad_norm=14.90402889251709, loss=0.7268667221069336, param_norm=1887.0887451171875
Step 477: grad_norm=5.7704315185546875, loss=0.6304122805595398, param_norm=1887.0889892578125
10:58:06.507 [I] Progress on: 477it/1.00kit rate:8.8s/it remaining:1:16:35 elapsed:1:10:42 postfix:- (511966:tqdm_logging.py:145)
Step 478: grad_norm=5.347155570983887, loss=0.6758774518966675, param_norm=1887.089111328125
Step 479: grad_norm=7.108941078186035, loss=0.694746196269989, param_norm=1887.0892333984375
10:58:24.161 [I] Progress on: 479it/1.00kit rate:8.8s/it remaining:1:16:23 elapsed:1:11:00 postfix:- (511966:tqdm_logging.py:145)
Step 480: grad_norm=10.142353057861328, loss=0.7589918375015259, param_norm=1887.0894775390625
Step 481: grad_norm=4.70184850692749, loss=0.6701126098632812, param_norm=1887.089599609375
10:58:41.747 [I] Progress on: 481it/1.00kit rate:8.8s/it remaining:1:16:02 elapsed:1:11:17 postfix:- (511966:tqdm_logging.py:145)
Step 482: grad_norm=5.080455303192139, loss=0.6250053644180298, param_norm=1887.08984375
Step 483: grad_norm=11.105147361755371, loss=0.7778034210205078, param_norm=1887.0899658203125
10:58:59.397 [I] Progress on: 483it/1.00kit rate:8.8s/it remaining:1:15:48 elapsed:1:11:35 postfix:- (511966:tqdm_logging.py:145)
Step 484: grad_norm=5.2499284744262695, loss=0.6700812578201294, param_norm=1887.090087890625
Step 485: grad_norm=5.539509296417236, loss=0.7633408904075623, param_norm=1887.09033203125
10:59:16.965 [I] Progress on: 485it/1.00kit rate:8.8s/it remaining:1:15:24 elapsed:1:11:53 postfix:- (511966:tqdm_logging.py:145)
Step 486: grad_norm=5.1188225746154785, loss=0.6755393743515015, param_norm=1887.0904541015625
Step 487: grad_norm=10.87420654296875, loss=0.7150396108627319, param_norm=1887.0906982421875
10:59:34.611 [I] Progress on: 487it/1.00kit rate:8.8s/it remaining:1:15:10 elapsed:1:12:10 postfix:- (511966:tqdm_logging.py:145)
Step 488: grad_norm=5.00126838684082, loss=0.6787105798721313, param_norm=1887.0908203125
Step 489: grad_norm=4.544651508331299, loss=0.587934672832489, param_norm=1887.0911865234375
10:59:52.188 [I] Progress on: 489it/1.00kit rate:8.8s/it remaining:1:14:48 elapsed:1:12:28 postfix:- (511966:tqdm_logging.py:145)
Step 490: grad_norm=10.041025161743164, loss=0.6603758335113525, param_norm=1887.09130859375
Step 491: grad_norm=9.63764762878418, loss=0.7668964862823486, param_norm=1887.091552734375
11:00:09.841 [I] Progress on: 491it/1.00kit rate:8.8s/it remaining:1:14:36 elapsed:1:12:46 postfix:- (511966:tqdm_logging.py:145)
Step 492: grad_norm=7.542446136474609, loss=0.9980579614639282, param_norm=1887.0916748046875
Step 493: grad_norm=7.878230571746826, loss=0.7666399478912354, param_norm=1887.0919189453125
11:00:27.427 [I] Progress on: 493it/1.00kit rate:8.8s/it remaining:1:14:16 elapsed:1:13:03 postfix:- (511966:tqdm_logging.py:145)
Step 494: grad_norm=7.17548131942749, loss=0.7913804054260254, param_norm=1887.092041015625
Step 495: grad_norm=13.284026145935059, loss=0.8249015808105469, param_norm=1887.0921630859375
11:00:45.075 [I] Progress on: 495it/1.00kit rate:8.8s/it remaining:1:14:03 elapsed:1:13:21 postfix:- (511966:tqdm_logging.py:145)
Step 496: grad_norm=14.092205047607422, loss=0.6117660999298096, param_norm=1887.092529296875
Step 497: grad_norm=24.59159278869629, loss=0.7680843472480774, param_norm=1887.0926513671875
11:01:02.670 [I] Progress on: 497it/1.00kit rate:8.8s/it remaining:1:13:41 elapsed:1:13:38 postfix:- (511966:tqdm_logging.py:145)
Step 498: grad_norm=13.38909912109375, loss=0.6336270570755005, param_norm=1887.0927734375
Step 499: grad_norm=8.180644035339355, loss=0.7040525674819946, param_norm=1887.0928955078125
11:01:20.315 [I] Progress on: 499it/1.00kit rate:8.8s/it remaining:1:13:27 elapsed:1:13:56 postfix:- (511966:tqdm_logging.py:145)
Step 500: grad_norm=5.377257347106934, loss=0.743614912033081, param_norm=1887.093017578125
11:01:29.295 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
11:01:29.295 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
11:01:29.295 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (511966:checkpoint_manager.py:1786)
11:01:29.295 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (511966:checkpoint_manager.py:1817)
11:01:29.296 [I] [process=0] Saving checkpoint at step 500                                        (511966:checkpoint_manager.py:1286)
11:01:29.297 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500. (511966:async_checkpointer.py:358)
11:01:29.298 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:01:29.298 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12 (511966:atomicity.py:144)
11:01:29.299 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:01:29.300 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:01:29.301 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (511966:atomicity.py:144)
11:01:29.301 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (511966:atomicity.py:144)
11:01:29.301 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:01:29.307 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
11:01:33.622 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
11:01:33.624 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.3 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:01:33.625 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
11:01:33.629 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
11:01:33.643 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:01:33.647 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:01:33.650 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:01:33.652 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:46.765787+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:01:33.653 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
11:01:33.655 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
11:01:33.658 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
11:01:33.661 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744124489.2950566, 'wait_for_prev_duration_secs': 0.00087738037109375, 'checkpointer_blocking_start_time': 1744124489.2965229, 'checkpointer_blocking_duration_secs': 4.346897840499878, 'get_old_steps_start_time': 1744124493.6435118, 'get_old_steps_duration_secs': 0.009581804275512695, 'checkpoint_manager_blocking_start_time': 1744124489.2948523, 'checkpoint_manager_blocking_duration_secs': 4.366080284118652} (511966:standard_logger.py:34)
11:01:33.664 [I] Progress on: 501it/1.00kit rate:10.1s/it remaining:1:24:00 elapsed:1:14:09 postfix:- (511966:tqdm_logging.py:145)
11:01:41.629 [I] ChainedFuture completed 1/1 futures in 8.00 seconds.                             (511966:future.py:137)
11:01:41.630 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 840.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:01:41.630 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
11:01:41.631 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12 (511966:async_checkpointer.py:406)
11:01:41.632 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12/assets (511966:atomicity.py:287)
11:01:41.642 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12/params (511966:atomicity.py:287)
11:01:41.643 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500 (511966:async_checkpointer.py:416)
11:01:41.643 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12 (511966:async_checkpointer.py:426)
11:01:41.643 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500 (511966:atomicity.py:287)
11:01:41.644 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/500`. (511966:atomicity.py:548)
11:01:41.645 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
11:01:41.645 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
11:01:41.646 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
11:01:41.646 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
11:01:41.646 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 501: grad_norm=7.137155055999756, loss=0.709277868270874, param_norm=1887.09326171875
Step 502: grad_norm=9.355119705200195, loss=0.7066771984100342, param_norm=1887.0933837890625
11:01:51.195 [I] Progress on: 502it/1.00kit rate:9.8s/it remaining:1:20:58 elapsed:1:14:27 postfix:- (511966:tqdm_logging.py:145)
Step 503: grad_norm=5.542321681976318, loss=0.5915247201919556, param_norm=1887.093505859375
Step 504: grad_norm=7.764474868774414, loss=0.5846778750419617, param_norm=1887.0936279296875
11:02:08.754 [I] Progress on: 504it/1.00kit rate:9.3s/it remaining:1:16:34 elapsed:1:14:44 postfix:- (511966:tqdm_logging.py:145)
Step 505: grad_norm=4.812090873718262, loss=0.7435287237167358, param_norm=1887.09375
Step 506: grad_norm=8.667003631591797, loss=0.692924976348877, param_norm=1887.0938720703125
11:02:26.364 [I] Progress on: 506it/1.00kit rate:9.0s/it remaining:1:14:24 elapsed:1:15:02 postfix:- (511966:tqdm_logging.py:145)
Step 507: grad_norm=4.760978698730469, loss=0.610004723072052, param_norm=1887.0941162109375
Step 508: grad_norm=5.592564582824707, loss=0.6694797873497009, param_norm=1887.09423828125
11:02:43.920 [I] Progress on: 508it/1.00kit rate:8.9s/it remaining:1:13:04 elapsed:1:15:20 postfix:- (511966:tqdm_logging.py:145)
Step 509: grad_norm=8.840958595275879, loss=0.7150602340698242, param_norm=1887.0943603515625
Step 510: grad_norm=7.751322269439697, loss=0.6229397654533386, param_norm=1887.094482421875
11:03:01.531 [I] Progress on: 510it/1.00kit rate:8.9s/it remaining:1:12:25 elapsed:1:15:37 postfix:- (511966:tqdm_logging.py:145)
Step 511: grad_norm=5.297311305999756, loss=0.6212120652198792, param_norm=1887.0946044921875
11:03:11.840 [I] Progress on: 512it/1.00kit rate:9.2s/it remaining:1:15:04 elapsed:1:15:48 postfix:- (511966:tqdm_logging.py:145)
Step 512: grad_norm=4.368712425231934, loss=0.542344331741333, param_norm=1887.0947265625
Step 513: grad_norm=7.0133161544799805, loss=0.5095916986465454, param_norm=1887.094970703125
11:03:29.215 [I] Progress on: 513it/1.00kit rate:9.1s/it remaining:1:13:52 elapsed:1:16:05 postfix:- (511966:tqdm_logging.py:145)
Step 514: grad_norm=4.683530807495117, loss=0.5711963772773743, param_norm=1887.0950927734375
Step 515: grad_norm=5.431522369384766, loss=0.5145140290260315, param_norm=1887.09521484375
11:03:46.752 [I] Progress on: 515it/1.00kit rate:8.9s/it remaining:1:12:12 elapsed:1:16:22 postfix:- (511966:tqdm_logging.py:145)
Step 516: grad_norm=5.102198123931885, loss=0.5731623768806458, param_norm=1887.095458984375
Step 517: grad_norm=4.620614051818848, loss=0.5466486215591431, param_norm=1887.095703125
11:04:04.280 [I] Progress on: 517it/1.00kit rate:8.9s/it remaining:1:11:15 elapsed:1:16:40 postfix:- (511966:tqdm_logging.py:145)
Step 518: grad_norm=9.959333419799805, loss=0.6552411317825317, param_norm=1887.0958251953125
Step 519: grad_norm=7.452805995941162, loss=0.6233794689178467, param_norm=1887.095947265625
11:04:21.824 [I] Progress on: 519it/1.00kit rate:8.8s/it remaining:1:10:37 elapsed:1:16:58 postfix:- (511966:tqdm_logging.py:145)
Step 520: grad_norm=5.5687360763549805, loss=0.6040728092193604, param_norm=1887.09619140625
Step 521: grad_norm=4.749903678894043, loss=0.6725016236305237, param_norm=1887.096435546875
11:04:39.370 [I] Progress on: 521it/1.00kit rate:8.8s/it remaining:1:10:12 elapsed:1:17:15 postfix:- (511966:tqdm_logging.py:145)
Step 522: grad_norm=5.441009521484375, loss=0.5374680161476135, param_norm=1887.0965576171875
Step 523: grad_norm=4.8803887367248535, loss=0.573085367679596, param_norm=1887.0968017578125
11:04:56.892 [I] Progress on: 523it/1.00kit rate:8.8s/it remaining:1:09:48 elapsed:1:17:33 postfix:- (511966:tqdm_logging.py:145)
Step 524: grad_norm=4.015339374542236, loss=0.4784734845161438, param_norm=1887.096923828125
Step 525: grad_norm=5.070826530456543, loss=0.5627192258834839, param_norm=1887.09716796875
11:05:14.430 [I] Progress on: 525it/1.00kit rate:8.8s/it remaining:1:09:28 elapsed:1:17:50 postfix:- (511966:tqdm_logging.py:145)
Step 526: grad_norm=5.3643293380737305, loss=0.5940489172935486, param_norm=1887.0972900390625
Step 527: grad_norm=6.320260047912598, loss=0.5886141061782837, param_norm=1887.097412109375
11:05:31.965 [I] Progress on: 527it/1.00kit rate:8.8s/it remaining:1:09:10 elapsed:1:18:08 postfix:- (511966:tqdm_logging.py:145)
Step 528: grad_norm=4.550954818725586, loss=0.5418162941932678, param_norm=1887.09765625
Step 529: grad_norm=4.609630107879639, loss=0.5371176600456238, param_norm=1887.0977783203125
11:05:49.504 [I] Progress on: 529it/1.00kit rate:8.8s/it remaining:1:08:52 elapsed:1:18:25 postfix:- (511966:tqdm_logging.py:145)
Step 530: grad_norm=5.342554092407227, loss=0.5514692068099976, param_norm=1887.0980224609375
Step 531: grad_norm=5.019459247589111, loss=0.5770848989486694, param_norm=1887.09814453125
11:06:07.033 [I] Progress on: 531it/1.00kit rate:8.8s/it remaining:1:08:33 elapsed:1:18:43 postfix:- (511966:tqdm_logging.py:145)
Step 532: grad_norm=6.179924488067627, loss=0.6403142809867859, param_norm=1887.098388671875
Step 533: grad_norm=9.597366333007812, loss=0.5610274076461792, param_norm=1887.0987548828125
11:06:24.570 [I] Progress on: 533it/1.00kit rate:8.8s/it remaining:1:08:16 elapsed:1:19:00 postfix:- (511966:tqdm_logging.py:145)
Step 534: grad_norm=4.499335765838623, loss=0.5020800828933716, param_norm=1887.098876953125
Step 535: grad_norm=4.934035301208496, loss=0.578084409236908, param_norm=1887.09912109375
11:06:42.122 [I] Progress on: 535it/1.00kit rate:8.8s/it remaining:1:07:59 elapsed:1:19:18 postfix:- (511966:tqdm_logging.py:145)
Step 536: grad_norm=7.92483377456665, loss=0.508368730545044, param_norm=1887.0992431640625
Step 537: grad_norm=5.695369720458984, loss=0.6454931497573853, param_norm=1887.0994873046875
11:06:59.923 [I] Progress on: 537it/1.00kit rate:8.9s/it remaining:1:08:20 elapsed:1:19:36 postfix:- (511966:tqdm_logging.py:145)
Step 538: grad_norm=6.2051682472229, loss=0.5266257524490356, param_norm=1887.0997314453125
Step 539: grad_norm=5.149514675140381, loss=0.598919153213501, param_norm=1887.099853515625
11:07:17.461 [I] Progress on: 539it/1.00kit rate:8.8s/it remaining:1:07:43 elapsed:1:19:53 postfix:- (511966:tqdm_logging.py:145)
Step 540: grad_norm=9.022770881652832, loss=0.6534801125526428, param_norm=1887.0999755859375
Step 541: grad_norm=10.131958961486816, loss=0.7546035051345825, param_norm=1887.10009765625
11:07:35.007 [I] Progress on: 541it/1.00kit rate:8.8s/it remaining:1:07:17 elapsed:1:20:11 postfix:- (511966:tqdm_logging.py:145)
Step 542: grad_norm=6.243739604949951, loss=0.6860644817352295, param_norm=1887.100341796875
Step 543: grad_norm=4.819967269897461, loss=0.6361039280891418, param_norm=1887.1004638671875
11:07:52.546 [I] Progress on: 543it/1.00kit rate:8.8s/it remaining:1:06:54 elapsed:1:20:28 postfix:- (511966:tqdm_logging.py:145)
Step 544: grad_norm=4.639598369598389, loss=0.565780520439148, param_norm=1887.1005859375
Step 545: grad_norm=9.402063369750977, loss=0.6055601835250854, param_norm=1887.1007080078125
11:08:10.113 [I] Progress on: 545it/1.00kit rate:8.8s/it remaining:1:06:37 elapsed:1:20:46 postfix:- (511966:tqdm_logging.py:145)
Step 546: grad_norm=15.150592803955078, loss=0.6165814399719238, param_norm=1887.100830078125
Step 547: grad_norm=4.968796730041504, loss=0.6060741543769836, param_norm=1887.100830078125
11:08:27.684 [I] Progress on: 547it/1.00kit rate:8.8s/it remaining:1:06:21 elapsed:1:21:03 postfix:- (511966:tqdm_logging.py:145)
Step 548: grad_norm=11.522547721862793, loss=0.5058417916297913, param_norm=1887.10107421875
Step 549: grad_norm=8.39992904663086, loss=0.5214285850524902, param_norm=1887.1011962890625
11:08:45.238 [I] Progress on: 549it/1.00kit rate:8.8s/it remaining:1:06:02 elapsed:1:21:21 postfix:- (511966:tqdm_logging.py:145)
Step 550: grad_norm=5.015142917633057, loss=0.6157287359237671, param_norm=1887.101318359375
Step 551: grad_norm=6.575251579284668, loss=0.5810906291007996, param_norm=1887.1014404296875
11:09:02.785 [I] Progress on: 551it/1.00kit rate:8.8s/it remaining:1:05:42 elapsed:1:21:38 postfix:- (511966:tqdm_logging.py:145)
Step 552: grad_norm=8.66103458404541, loss=0.7040560841560364, param_norm=1887.1014404296875
Step 553: grad_norm=5.220911026000977, loss=0.6327313184738159, param_norm=1887.1016845703125
11:09:20.336 [I] Progress on: 553it/1.00kit rate:8.8s/it remaining:1:05:24 elapsed:1:21:56 postfix:- (511966:tqdm_logging.py:145)
Step 554: grad_norm=4.676263332366943, loss=0.6185944676399231, param_norm=1887.101806640625
Step 555: grad_norm=10.059354782104492, loss=0.6703529357910156, param_norm=1887.1019287109375
11:09:37.885 [I] Progress on: 555it/1.00kit rate:8.8s/it remaining:1:05:06 elapsed:1:22:14 postfix:- (511966:tqdm_logging.py:145)
Step 556: grad_norm=4.9854841232299805, loss=0.5932050943374634, param_norm=1887.10205078125
Step 557: grad_norm=5.932339668273926, loss=0.6978594064712524, param_norm=1887.1021728515625
11:09:55.437 [I] Progress on: 557it/1.00kit rate:8.8s/it remaining:1:04:49 elapsed:1:22:31 postfix:- (511966:tqdm_logging.py:145)
Step 558: grad_norm=6.246713638305664, loss=0.589688241481781, param_norm=1887.102294921875
Step 559: grad_norm=4.711384296417236, loss=0.5853394269943237, param_norm=1887.1024169921875
11:10:12.986 [I] Progress on: 559it/1.00kit rate:8.8s/it remaining:1:04:32 elapsed:1:22:49 postfix:- (511966:tqdm_logging.py:145)
Step 560: grad_norm=4.417145252227783, loss=0.5519876480102539, param_norm=1887.1025390625
Step 561: grad_norm=4.514235019683838, loss=0.6014194488525391, param_norm=1887.1026611328125
11:10:30.527 [I] Progress on: 561it/1.00kit rate:8.8s/it remaining:1:04:14 elapsed:1:23:06 postfix:- (511966:tqdm_logging.py:145)
Step 562: grad_norm=4.090939521789551, loss=0.5070635080337524, param_norm=1887.102783203125
Step 563: grad_norm=4.8720197677612305, loss=0.5607433915138245, param_norm=1887.1029052734375
11:10:48.076 [I] Progress on: 563it/1.00kit rate:8.8s/it remaining:1:03:56 elapsed:1:23:24 postfix:- (511966:tqdm_logging.py:145)
Step 564: grad_norm=6.540937900543213, loss=0.5656915307044983, param_norm=1887.10302734375
Step 565: grad_norm=7.340933322906494, loss=0.6444876790046692, param_norm=1887.1031494140625
11:11:05.641 [I] Progress on: 565it/1.00kit rate:8.8s/it remaining:1:03:39 elapsed:1:23:41 postfix:- (511966:tqdm_logging.py:145)
Step 566: grad_norm=4.109494209289551, loss=0.5438606142997742, param_norm=1887.103271484375
Step 567: grad_norm=4.293787002563477, loss=0.549426794052124, param_norm=1887.1033935546875
11:11:23.197 [I] Progress on: 567it/1.00kit rate:8.8s/it remaining:1:03:22 elapsed:1:23:59 postfix:- (511966:tqdm_logging.py:145)
Step 568: grad_norm=4.155908107757568, loss=0.5941609144210815, param_norm=1887.103515625
Step 569: grad_norm=7.9736175537109375, loss=0.6021568179130554, param_norm=1887.1036376953125
11:11:40.765 [I] Progress on: 569it/1.00kit rate:8.8s/it remaining:1:03:05 elapsed:1:24:16 postfix:- (511966:tqdm_logging.py:145)
Step 570: grad_norm=4.993782043457031, loss=0.593228816986084, param_norm=1887.103759765625
Step 571: grad_norm=4.009228706359863, loss=0.49928879737854004, param_norm=1887.1038818359375
11:11:58.328 [I] Progress on: 571it/1.00kit rate:8.8s/it remaining:1:02:49 elapsed:1:24:34 postfix:- (511966:tqdm_logging.py:145)
Step 572: grad_norm=6.956108093261719, loss=0.5396406054496765, param_norm=1887.10400390625
Step 573: grad_norm=5.797482967376709, loss=0.5443660020828247, param_norm=1887.104248046875
11:12:15.897 [I] Progress on: 573it/1.00kit rate:8.8s/it remaining:1:02:32 elapsed:1:24:52 postfix:- (511966:tqdm_logging.py:145)
Step 574: grad_norm=4.884621620178223, loss=0.5222979784011841, param_norm=1887.104248046875
Step 575: grad_norm=7.03417444229126, loss=0.539787769317627, param_norm=1887.1043701171875
11:12:33.460 [I] Progress on: 575it/1.00kit rate:8.8s/it remaining:1:02:14 elapsed:1:25:09 postfix:- (511966:tqdm_logging.py:145)
Step 576: grad_norm=3.871277093887329, loss=0.4215320944786072, param_norm=1887.1046142578125
11:12:44.062 [I] Progress on: 576it/1.00kit rate:9.3s/it remaining:1:05:57 elapsed:1:25:20 postfix:- (511966:tqdm_logging.py:145)
Step 577: grad_norm=8.556084632873535, loss=0.5089492201805115, param_norm=1887.104736328125
Step 578: grad_norm=6.664328098297119, loss=0.555371880531311, param_norm=1887.10498046875
11:13:01.614 [I] Progress on: 578it/1.00kit rate:9.0s/it remaining:1:03:37 elapsed:1:25:37 postfix:- (511966:tqdm_logging.py:145)
Step 579: grad_norm=4.390040397644043, loss=0.514064371585846, param_norm=1887.10498046875
Step 580: grad_norm=5.962576389312744, loss=0.49512672424316406, param_norm=1887.105224609375
11:13:19.170 [I] Progress on: 580it/1.00kit rate:8.9s/it remaining:1:02:20 elapsed:1:25:55 postfix:- (511966:tqdm_logging.py:145)
Step 581: grad_norm=4.272477626800537, loss=0.498283326625824, param_norm=1887.105224609375
Step 582: grad_norm=5.676651477813721, loss=0.46688777208328247, param_norm=1887.10546875
11:13:36.737 [I] Progress on: 582it/1.00kit rate:8.8s/it remaining:1:01:34 elapsed:1:26:12 postfix:- (511966:tqdm_logging.py:145)
Step 583: grad_norm=5.291398048400879, loss=0.49234694242477417, param_norm=1887.1055908203125
Step 584: grad_norm=5.805879592895508, loss=0.5832776427268982, param_norm=1887.105712890625
11:13:54.303 [I] Progress on: 584it/1.00kit rate:8.8s/it remaining:1:01:05 elapsed:1:26:30 postfix:- (511966:tqdm_logging.py:145)
Step 585: grad_norm=5.866621971130371, loss=0.559008002281189, param_norm=1887.1058349609375
Step 586: grad_norm=4.356092929840088, loss=0.48677414655685425, param_norm=1887.10595703125
11:14:11.893 [I] Progress on: 586it/1.00kit rate:8.8s/it remaining:1:00:42 elapsed:1:26:48 postfix:- (511966:tqdm_logging.py:145)
Step 587: grad_norm=4.206985950469971, loss=0.5134494304656982, param_norm=1887.1060791015625
Step 588: grad_norm=7.438929557800293, loss=0.45944488048553467, param_norm=1887.106201171875
11:14:29.454 [I] Progress on: 588it/1.00kit rate:8.8s/it remaining:1:00:20 elapsed:1:27:05 postfix:- (511966:tqdm_logging.py:145)
Step 589: grad_norm=5.809981346130371, loss=0.4742889702320099, param_norm=1887.1063232421875
Step 590: grad_norm=5.666745185852051, loss=0.6112418174743652, param_norm=1887.1065673828125
11:14:47.037 [I] Progress on: 590it/1.00kit rate:8.8s/it remaining:1:00:02 elapsed:1:27:23 postfix:- (511966:tqdm_logging.py:145)
Step 591: grad_norm=4.202865123748779, loss=0.5626399517059326, param_norm=1887.106689453125
Step 592: grad_norm=4.631082057952881, loss=0.5642525553703308, param_norm=1887.106689453125
11:15:04.604 [I] Progress on: 592it/1.00kit rate:8.8s/it remaining:59:43 elapsed:1:27:40 postfix:- (511966:tqdm_logging.py:145)
Step 593: grad_norm=6.403153419494629, loss=0.6150367259979248, param_norm=1887.1068115234375
Step 594: grad_norm=4.47884464263916, loss=0.5117837190628052, param_norm=1887.10693359375
11:15:22.170 [I] Progress on: 594it/1.00kit rate:8.8s/it remaining:59:24 elapsed:1:27:58 postfix:- (511966:tqdm_logging.py:145)
Step 595: grad_norm=8.439820289611816, loss=0.5747072696685791, param_norm=1887.10693359375
Step 596: grad_norm=6.747640132904053, loss=0.5205154418945312, param_norm=1887.1070556640625
11:15:39.740 [I] Progress on: 596it/1.00kit rate:8.8s/it remaining:59:07 elapsed:1:28:15 postfix:- (511966:tqdm_logging.py:145)
Step 597: grad_norm=5.134753704071045, loss=0.44160425662994385, param_norm=1887.107177734375
Step 598: grad_norm=7.868630409240723, loss=0.3942129611968994, param_norm=1887.1072998046875
11:15:57.371 [I] Progress on: 598it/1.00kit rate:8.8s/it remaining:58:57 elapsed:1:28:33 postfix:- (511966:tqdm_logging.py:145)
Step 599: grad_norm=4.740655422210693, loss=0.46475932002067566, param_norm=1887.107421875
Step 600: grad_norm=6.098629951477051, loss=0.6080963611602783, param_norm=1887.107421875
11:16:14.936 [I] Progress on: 600it/1.00kit rate:8.8s/it remaining:58:36 elapsed:1:28:51 postfix:- (511966:tqdm_logging.py:145)
11:16:15.145 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
11:16:15.145 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
11:16:15.145 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (511966:checkpoint_manager.py:1786)
11:16:15.145 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (511966:checkpoint_manager.py:1817)
11:16:15.146 [I] [process=0] Saving checkpoint at step 600                                        (511966:checkpoint_manager.py:1286)
11:16:15.147 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600. (511966:async_checkpointer.py:358)
11:16:15.148 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:16:15.148 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15 (511966:atomicity.py:144)
11:16:15.149 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:16:15.150 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:16:15.151 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (511966:atomicity.py:144)
11:16:15.151 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (511966:atomicity.py:144)
11:16:15.152 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:16:15.157 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
11:16:18.675 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
11:16:18.677 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.9 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:16:18.679 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
11:16:18.680 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
11:16:18.713 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:16:18.713 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:16:18.718 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:16:18.720 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:46.765787+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:16:18.731 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:33.643456+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:16:18.732 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
11:16:18.735 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
11:16:18.739 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
11:16:18.740 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744125375.14505, 'wait_for_prev_duration_secs': 0.0009365081787109375, 'checkpointer_blocking_start_time': 1744125375.1466327, 'checkpointer_blocking_duration_secs': 3.5663130283355713, 'get_old_steps_start_time': 1744125378.7130086, 'get_old_steps_duration_secs': 0.019694089889526367, 'checkpoint_manager_blocking_start_time': 1744125375.1448572, 'checkpoint_manager_blocking_duration_secs': 3.595890522003174} (511966:standard_logger.py:34)
Step 601: grad_norm=4.044922351837158, loss=0.44581976532936096, param_norm=1887.1075439453125
11:16:27.333 [I] Progress on: 601it/1.00kit rate:9.9s/it remaining:1:05:39 elapsed:1:29:03 postfix:- (511966:tqdm_logging.py:145)
11:16:27.756 [I] ChainedFuture completed 1/1 futures in 9.05 seconds.                             (511966:future.py:137)
11:16:27.756 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 822.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:16:27.756 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
11:16:27.758 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15 (511966:async_checkpointer.py:406)
11:16:27.758 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15/assets (511966:atomicity.py:287)
11:16:27.791 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15/params (511966:atomicity.py:287)
11:16:27.792 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600 (511966:async_checkpointer.py:416)
11:16:27.792 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15 (511966:async_checkpointer.py:426)
11:16:27.792 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600 (511966:atomicity.py:287)
11:16:27.794 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/600`. (511966:atomicity.py:548)
11:16:27.794 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
11:16:27.795 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
11:16:27.796 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
11:16:27.796 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
11:16:27.796 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 602: grad_norm=4.927724838256836, loss=0.4525163769721985, param_norm=1887.107666015625
Step 603: grad_norm=5.846282958984375, loss=0.5103099346160889, param_norm=1887.1077880859375
11:16:44.886 [I] Progress on: 603it/1.00kit rate:9.3s/it remaining:1:01:37 elapsed:1:29:21 postfix:- (511966:tqdm_logging.py:145)
Step 604: grad_norm=4.542689323425293, loss=0.4168110191822052, param_norm=1887.10791015625
Step 605: grad_norm=5.866527080535889, loss=0.5433470010757446, param_norm=1887.108154296875
11:17:02.438 [I] Progress on: 605it/1.00kit rate:9.0s/it remaining:59:31 elapsed:1:29:38 postfix:- (511966:tqdm_logging.py:145)
Step 606: grad_norm=3.9168434143066406, loss=0.47490283846855164, param_norm=1887.108154296875
Step 607: grad_norm=3.9680840969085693, loss=0.4434230327606201, param_norm=1887.1083984375
11:17:19.989 [I] Progress on: 607it/1.00kit rate:8.9s/it remaining:58:20 elapsed:1:29:56 postfix:- (511966:tqdm_logging.py:145)
Step 608: grad_norm=3.5356457233428955, loss=0.434805303812027, param_norm=1887.1083984375
Step 609: grad_norm=4.580440521240234, loss=0.5229343175888062, param_norm=1887.108642578125
11:17:37.509 [I] Progress on: 609it/1.00kit rate:8.8s/it remaining:57:33 elapsed:1:30:13 postfix:- (511966:tqdm_logging.py:145)
Step 610: grad_norm=4.884091377258301, loss=0.4557669758796692, param_norm=1887.108642578125
Step 611: grad_norm=6.307991981506348, loss=0.5132099390029907, param_norm=1887.1087646484375
11:17:55.020 [I] Progress on: 611it/1.00kit rate:8.8s/it remaining:57:01 elapsed:1:30:31 postfix:- (511966:tqdm_logging.py:145)
Step 612: grad_norm=6.665740489959717, loss=0.34733325242996216, param_norm=1887.10888671875
Step 613: grad_norm=3.6466329097747803, loss=0.42441120743751526, param_norm=1887.1090087890625
11:18:12.532 [I] Progress on: 613it/1.00kit rate:8.8s/it remaining:56:37 elapsed:1:30:48 postfix:- (511966:tqdm_logging.py:145)
Step 614: grad_norm=6.692300319671631, loss=0.4856415390968323, param_norm=1887.109130859375
Step 615: grad_norm=4.308455944061279, loss=0.486011803150177, param_norm=1887.1092529296875
11:18:30.040 [I] Progress on: 615it/1.00kit rate:8.8s/it remaining:56:14 elapsed:1:31:06 postfix:- (511966:tqdm_logging.py:145)
Step 616: grad_norm=4.427552223205566, loss=0.5375036001205444, param_norm=1887.109375
Step 617: grad_norm=4.181230068206787, loss=0.43975135684013367, param_norm=1887.109619140625
11:18:47.551 [I] Progress on: 617it/1.00kit rate:8.8s/it remaining:55:54 elapsed:1:31:23 postfix:- (511966:tqdm_logging.py:145)
Step 618: grad_norm=7.323054790496826, loss=0.5268840789794922, param_norm=1887.109619140625
Step 619: grad_norm=4.280547142028809, loss=0.4571799039840698, param_norm=1887.1097412109375
11:19:05.070 [I] Progress on: 619it/1.00kit rate:8.8s/it remaining:55:37 elapsed:1:31:41 postfix:- (511966:tqdm_logging.py:145)
Step 620: grad_norm=4.474128723144531, loss=0.5546049475669861, param_norm=1887.10986328125
Step 621: grad_norm=6.820217132568359, loss=0.5548593997955322, param_norm=1887.1099853515625
11:19:22.572 [I] Progress on: 621it/1.00kit rate:8.8s/it remaining:55:19 elapsed:1:31:58 postfix:- (511966:tqdm_logging.py:145)
Step 622: grad_norm=4.56951904296875, loss=0.4606838822364807, param_norm=1887.1099853515625
Step 623: grad_norm=4.694854259490967, loss=0.4965391159057617, param_norm=1887.110107421875
11:19:40.075 [I] Progress on: 623it/1.00kit rate:8.8s/it remaining:55:00 elapsed:1:32:16 postfix:- (511966:tqdm_logging.py:145)
Step 624: grad_norm=5.2299275398254395, loss=0.4011692404747009, param_norm=1887.1102294921875
Step 625: grad_norm=4.362941741943359, loss=0.5184504985809326, param_norm=1887.1103515625
11:19:57.581 [I] Progress on: 625it/1.00kit rate:8.8s/it remaining:54:43 elapsed:1:32:33 postfix:- (511966:tqdm_logging.py:145)
Step 626: grad_norm=3.8553626537323, loss=0.46672508120536804, param_norm=1887.1104736328125
Step 627: grad_norm=4.615241527557373, loss=0.3888893723487854, param_norm=1887.1104736328125
11:20:15.305 [I] Progress on: 627it/1.00kit rate:8.8s/it remaining:54:50 elapsed:1:32:51 postfix:- (511966:tqdm_logging.py:145)
Step 628: grad_norm=4.965962886810303, loss=0.46448788046836853, param_norm=1887.110595703125
Step 629: grad_norm=4.770055770874023, loss=0.5462509989738464, param_norm=1887.1107177734375
11:20:32.803 [I] Progress on: 629it/1.00kit rate:8.8s/it remaining:54:18 elapsed:1:33:09 postfix:- (511966:tqdm_logging.py:145)
Step 630: grad_norm=4.371794700622559, loss=0.4872361421585083, param_norm=1887.11083984375
Step 631: grad_norm=5.685846328735352, loss=0.5567744970321655, param_norm=1887.11083984375
11:20:50.343 [I] Progress on: 631it/1.00kit rate:8.8s/it remaining:53:58 elapsed:1:33:26 postfix:- (511966:tqdm_logging.py:145)
Step 632: grad_norm=4.679502964019775, loss=0.5096828937530518, param_norm=1887.11083984375
Step 633: grad_norm=4.493862628936768, loss=0.5471988916397095, param_norm=1887.1109619140625
11:21:07.870 [I] Progress on: 633it/1.00kit rate:8.8s/it remaining:53:39 elapsed:1:33:44 postfix:- (511966:tqdm_logging.py:145)
Step 634: grad_norm=6.036437034606934, loss=0.498346745967865, param_norm=1887.1112060546875
Step 635: grad_norm=5.3750762939453125, loss=0.49311143159866333, param_norm=1887.1112060546875
11:21:25.378 [I] Progress on: 635it/1.00kit rate:8.8s/it remaining:53:19 elapsed:1:34:01 postfix:- (511966:tqdm_logging.py:145)
Step 636: grad_norm=4.017671585083008, loss=0.42915642261505127, param_norm=1887.1112060546875
Step 637: grad_norm=4.459934711456299, loss=0.4821278750896454, param_norm=1887.111328125
11:21:42.928 [I] Progress on: 637it/1.00kit rate:8.8s/it remaining:53:04 elapsed:1:34:19 postfix:- (511966:tqdm_logging.py:145)
Step 638: grad_norm=4.331160068511963, loss=0.450554221868515, param_norm=1887.111328125
Step 639: grad_norm=3.619605541229248, loss=0.3602954149246216, param_norm=1887.1114501953125
11:22:00.473 [I] Progress on: 639it/1.00kit rate:8.8s/it remaining:52:47 elapsed:1:34:36 postfix:- (511966:tqdm_logging.py:145)
Step 640: grad_norm=5.038207530975342, loss=0.427747517824173, param_norm=1887.1114501953125
11:22:11.179 [I] Progress on: 640it/1.00kit rate:9.4s/it remaining:56:07 elapsed:1:34:47 postfix:- (511966:tqdm_logging.py:145)
Step 641: grad_norm=5.647907257080078, loss=0.4533444046974182, param_norm=1887.1114501953125
Step 642: grad_norm=5.141635417938232, loss=0.4458984434604645, param_norm=1887.111572265625
11:22:28.690 [I] Progress on: 642it/1.00kit rate:9.1s/it remaining:54:01 elapsed:1:35:04 postfix:- (511966:tqdm_logging.py:145)
Step 643: grad_norm=4.021214008331299, loss=0.5212566256523132, param_norm=1887.1116943359375
Step 644: grad_norm=3.6853413581848145, loss=0.4175454080104828, param_norm=1887.1116943359375
11:22:46.185 [I] Progress on: 644it/1.00kit rate:8.9s/it remaining:52:49 elapsed:1:35:22 postfix:- (511966:tqdm_logging.py:145)
Step 645: grad_norm=4.5373358726501465, loss=0.36000049114227295, param_norm=1887.11181640625
Step 646: grad_norm=5.96934700012207, loss=0.4611027240753174, param_norm=1887.11181640625
11:23:03.759 [I] Progress on: 646it/1.00kit rate:8.8s/it remaining:52:12 elapsed:1:35:39 postfix:- (511966:tqdm_logging.py:145)
Step 647: grad_norm=3.7784945964813232, loss=0.4177887439727783, param_norm=1887.1119384765625
Step 648: grad_norm=3.691882610321045, loss=0.46750468015670776, param_norm=1887.112060546875
11:23:21.256 [I] Progress on: 648it/1.00kit rate:8.8s/it remaining:51:38 elapsed:1:35:57 postfix:- (511966:tqdm_logging.py:145)
Step 649: grad_norm=3.7897748947143555, loss=0.46432530879974365, param_norm=1887.112060546875
Step 650: grad_norm=2.8171989917755127, loss=0.3427473306655884, param_norm=1887.1121826171875
11:23:38.832 [I] Progress on: 650it/1.00kit rate:8.8s/it remaining:51:20 elapsed:1:36:15 postfix:- (511966:tqdm_logging.py:145)
Step 651: grad_norm=6.320261001586914, loss=0.3984479308128357, param_norm=1887.1123046875
Step 652: grad_norm=5.4003119468688965, loss=0.4402987062931061, param_norm=1887.1123046875
11:23:56.345 [I] Progress on: 652it/1.00kit rate:8.8s/it remaining:50:56 elapsed:1:36:32 postfix:- (511966:tqdm_logging.py:145)
Step 653: grad_norm=3.6713626384735107, loss=0.39461803436279297, param_norm=1887.1124267578125
Step 654: grad_norm=4.110249996185303, loss=0.442206472158432, param_norm=1887.112548828125
11:24:13.912 [I] Progress on: 654it/1.00kit rate:8.8s/it remaining:50:40 elapsed:1:36:50 postfix:- (511966:tqdm_logging.py:145)
Step 655: grad_norm=4.480863094329834, loss=0.4378744959831238, param_norm=1887.112548828125
Step 656: grad_norm=7.92218542098999, loss=0.3621724247932434, param_norm=1887.11279296875
11:24:31.434 [I] Progress on: 656it/1.00kit rate:8.8s/it remaining:50:20 elapsed:1:37:07 postfix:- (511966:tqdm_logging.py:145)
Step 657: grad_norm=4.734574794769287, loss=0.4423615634441376, param_norm=1887.11279296875
Step 658: grad_norm=8.668192863464355, loss=0.4396548867225647, param_norm=1887.1129150390625
11:24:49.013 [I] Progress on: 658it/1.00kit rate:8.8s/it remaining:50:06 elapsed:1:37:25 postfix:- (511966:tqdm_logging.py:145)
Step 659: grad_norm=7.3476762771606445, loss=0.4478813707828522, param_norm=1887.113037109375
Step 660: grad_norm=4.757755756378174, loss=0.43196937441825867, param_norm=1887.1131591796875
11:25:06.525 [I] Progress on: 660it/1.00kit rate:8.8s/it remaining:49:44 elapsed:1:37:42 postfix:- (511966:tqdm_logging.py:145)
Step 661: grad_norm=3.8462073802948, loss=0.392253577709198, param_norm=1887.1131591796875
Step 662: grad_norm=6.4781928062438965, loss=0.42039933800697327, param_norm=1887.11328125
11:25:24.056 [I] Progress on: 662it/1.00kit rate:8.8s/it remaining:49:26 elapsed:1:38:00 postfix:- (511966:tqdm_logging.py:145)
Step 663: grad_norm=6.156545639038086, loss=0.4298015832901001, param_norm=1887.11328125
Step 664: grad_norm=3.731379508972168, loss=0.5111615657806396, param_norm=1887.113525390625
11:25:41.572 [I] Progress on: 664it/1.00kit rate:8.8s/it remaining:49:07 elapsed:1:38:17 postfix:- (511966:tqdm_logging.py:145)
Step 665: grad_norm=4.734152793884277, loss=0.44309550523757935, param_norm=1887.113525390625
Step 666: grad_norm=4.315062046051025, loss=0.4138253927230835, param_norm=1887.113525390625
11:25:59.150 [I] Progress on: 666it/1.00kit rate:8.8s/it remaining:48:54 elapsed:1:38:35 postfix:- (511966:tqdm_logging.py:145)
Step 667: grad_norm=4.910868167877197, loss=0.3837246000766754, param_norm=1887.1136474609375
Step 668: grad_norm=4.834205150604248, loss=0.4067823886871338, param_norm=1887.11376953125
11:26:16.680 [I] Progress on: 668it/1.00kit rate:8.8s/it remaining:48:33 elapsed:1:38:52 postfix:- (511966:tqdm_logging.py:145)
Step 669: grad_norm=3.5072898864746094, loss=0.3792591094970703, param_norm=1887.11376953125
Step 670: grad_norm=3.6170146465301514, loss=0.4410189688205719, param_norm=1887.1138916015625
11:26:34.258 [I] Progress on: 670it/1.00kit rate:8.8s/it remaining:48:21 elapsed:1:39:10 postfix:- (511966:tqdm_logging.py:145)
Step 671: grad_norm=3.403947353363037, loss=0.41431236267089844, param_norm=1887.114013671875
Step 672: grad_norm=3.1160969734191895, loss=0.3012763261795044, param_norm=1887.1141357421875
11:26:51.774 [I] Progress on: 672it/1.00kit rate:8.8s/it remaining:48:00 elapsed:1:39:27 postfix:- (511966:tqdm_logging.py:145)
Step 673: grad_norm=5.359692096710205, loss=0.48969393968582153, param_norm=1887.1141357421875
Step 674: grad_norm=5.900576114654541, loss=0.43486911058425903, param_norm=1887.1143798828125
11:27:09.356 [I] Progress on: 674it/1.00kit rate:8.8s/it remaining:47:46 elapsed:1:39:45 postfix:- (511966:tqdm_logging.py:145)
Step 675: grad_norm=3.6175763607025146, loss=0.3930007219314575, param_norm=1887.114501953125
Step 676: grad_norm=4.429689407348633, loss=0.42301592230796814, param_norm=1887.114501953125
11:27:26.871 [I] Progress on: 676it/1.00kit rate:8.8s/it remaining:47:24 elapsed:1:40:03 postfix:- (511966:tqdm_logging.py:145)
Step 677: grad_norm=4.3644118309021, loss=0.43688490986824036, param_norm=1887.1146240234375
Step 678: grad_norm=3.608020067214966, loss=0.400291383266449, param_norm=1887.1146240234375
11:27:44.447 [I] Progress on: 678it/1.00kit rate:8.8s/it remaining:47:10 elapsed:1:40:20 postfix:- (511966:tqdm_logging.py:145)
Step 679: grad_norm=3.1281228065490723, loss=0.4177190363407135, param_norm=1887.11474609375
Step 680: grad_norm=3.4040980339050293, loss=0.3734285831451416, param_norm=1887.11474609375
11:28:01.973 [I] Progress on: 680it/1.00kit rate:8.8s/it remaining:46:50 elapsed:1:40:38 postfix:- (511966:tqdm_logging.py:145)
Step 681: grad_norm=3.4261255264282227, loss=0.45131242275238037, param_norm=1887.11474609375
Step 682: grad_norm=3.8343515396118164, loss=0.39384207129478455, param_norm=1887.1148681640625
11:28:19.560 [I] Progress on: 682it/1.00kit rate:8.8s/it remaining:46:37 elapsed:1:40:55 postfix:- (511966:tqdm_logging.py:145)
Step 683: grad_norm=3.843841075897217, loss=0.35593515634536743, param_norm=1887.114990234375
Step 684: grad_norm=3.7590324878692627, loss=0.37800222635269165, param_norm=1887.114990234375
11:28:37.073 [I] Progress on: 684it/1.00kit rate:8.8s/it remaining:46:13 elapsed:1:41:13 postfix:- (511966:tqdm_logging.py:145)
Step 685: grad_norm=4.117993354797363, loss=0.41437768936157227, param_norm=1887.1151123046875
Step 686: grad_norm=3.4765713214874268, loss=0.45368438959121704, param_norm=1887.1151123046875
11:28:54.663 [I] Progress on: 686it/1.00kit rate:8.8s/it remaining:46:00 elapsed:1:41:30 postfix:- (511966:tqdm_logging.py:145)
Step 687: grad_norm=3.42911958694458, loss=0.33262696862220764, param_norm=1887.115234375
Step 688: grad_norm=3.5719592571258545, loss=0.3257809281349182, param_norm=1887.1153564453125
11:29:12.196 [I] Progress on: 688it/1.00kit rate:8.8s/it remaining:45:40 elapsed:1:41:48 postfix:- (511966:tqdm_logging.py:145)
Step 689: grad_norm=2.9621708393096924, loss=0.353505939245224, param_norm=1887.1153564453125
Step 690: grad_norm=4.241300106048584, loss=0.4146626591682434, param_norm=1887.115478515625
11:29:29.792 [I] Progress on: 690it/1.00kit rate:8.8s/it remaining:45:27 elapsed:1:42:05 postfix:- (511966:tqdm_logging.py:145)
Step 691: grad_norm=5.094278812408447, loss=0.4425389766693115, param_norm=1887.1156005859375
Step 692: grad_norm=3.2469029426574707, loss=0.39053595066070557, param_norm=1887.1156005859375
11:29:47.308 [I] Progress on: 692it/1.00kit rate:8.8s/it remaining:45:04 elapsed:1:42:23 postfix:- (511966:tqdm_logging.py:145)
Step 693: grad_norm=3.3669323921203613, loss=0.3679776191711426, param_norm=1887.1158447265625
Step 694: grad_norm=3.5148181915283203, loss=0.3896014392375946, param_norm=1887.1158447265625
11:30:04.887 [I] Progress on: 694it/1.00kit rate:8.8s/it remaining:44:50 elapsed:1:42:41 postfix:- (511966:tqdm_logging.py:145)
Step 695: grad_norm=4.452129364013672, loss=0.4097293019294739, param_norm=1887.115966796875
Step 696: grad_norm=3.6389760971069336, loss=0.41839098930358887, param_norm=1887.1160888671875
11:30:22.395 [I] Progress on: 696it/1.00kit rate:8.8s/it remaining:44:29 elapsed:1:42:58 postfix:- (511966:tqdm_logging.py:145)
Step 697: grad_norm=6.149734973907471, loss=0.4340636730194092, param_norm=1887.1162109375
Step 698: grad_norm=7.570108890533447, loss=0.44459471106529236, param_norm=1887.1162109375
11:30:39.973 [I] Progress on: 698it/1.00kit rate:8.8s/it remaining:44:14 elapsed:1:43:16 postfix:- (511966:tqdm_logging.py:145)
Step 699: grad_norm=3.5844335556030273, loss=0.3514295816421509, param_norm=1887.1163330078125
Step 700: grad_norm=4.128112316131592, loss=0.37660545110702515, param_norm=1887.116455078125
11:30:57.501 [I] Progress on: 700it/1.00kit rate:8.8s/it remaining:43:54 elapsed:1:43:33 postfix:- (511966:tqdm_logging.py:145)
11:30:57.614 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
11:30:57.615 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
11:30:57.615 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (511966:checkpoint_manager.py:1786)
11:30:57.615 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (511966:checkpoint_manager.py:1817)
11:30:57.615 [I] [process=0] Saving checkpoint at step 700                                        (511966:checkpoint_manager.py:1286)
11:30:57.616 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700. (511966:async_checkpointer.py:358)
11:30:57.617 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:30:57.618 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18 (511966:atomicity.py:144)
11:30:57.618 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:30:57.619 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:30:57.620 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (511966:atomicity.py:144)
11:30:57.620 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (511966:atomicity.py:144)
11:30:57.621 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:30:57.626 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
11:31:01.213 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
11:31:01.214 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:31:01.215 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
11:31:01.217 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
11:31:01.239 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:31:01.241 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:31:01.242 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:31:01.244 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:46.765787+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:31:01.247 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:33.643456+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:31:01.250 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:16:18.712963+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:31:01.252 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
11:31:01.253 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
11:31:01.256 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
11:31:01.258 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744126257.6148217, 'wait_for_prev_duration_secs': 0.0006420612335205078, 'checkpointer_blocking_start_time': 1744126257.616049, 'checkpointer_blocking_duration_secs': 3.6237449645996094, 'get_old_steps_start_time': 1744126261.2398536, 'get_old_steps_duration_secs': 0.01237034797668457, 'checkpoint_manager_blocking_start_time': 1744126257.6146312, 'checkpoint_manager_blocking_duration_secs': 3.6438629627227783} (511966:standard_logger.py:34)
11:31:08.535 [I] ChainedFuture completed 1/1 futures in 7.31 seconds.                             (511966:future.py:137)
11:31:08.536 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 949.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:31:08.537 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
11:31:08.538 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18 (511966:async_checkpointer.py:406)
11:31:08.539 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18/assets (511966:atomicity.py:287)
11:31:08.550 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18/params (511966:atomicity.py:287)
11:31:08.550 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700 (511966:async_checkpointer.py:416)
11:31:08.550 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18 (511966:async_checkpointer.py:426)
11:31:08.551 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700 (511966:atomicity.py:287)
11:31:08.552 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/700`. (511966:atomicity.py:548)
11:31:08.552 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
11:31:08.553 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
11:31:08.553 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
11:31:08.553 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
11:31:08.553 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 701: grad_norm=3.5965521335601807, loss=0.4217677712440491, param_norm=1887.116455078125
11:31:09.852 [I] Progress on: 701it/1.00kit rate:9.9s/it remaining:49:06 elapsed:1:43:46 postfix:- (511966:tqdm_logging.py:145)
Step 702: grad_norm=4.032054424285889, loss=0.3790542781352997, param_norm=1887.116455078125
Step 703: grad_norm=3.2031068801879883, loss=0.4202457070350647, param_norm=1887.1165771484375
11:31:27.449 [I] Progress on: 703it/1.00kit rate:9.3s/it remaining:46:03 elapsed:1:44:03 postfix:- (511966:tqdm_logging.py:145)
Step 704: grad_norm=5.123589038848877, loss=0.3529692590236664, param_norm=1887.11669921875
11:31:38.154 [I] Progress on: 704it/1.00kit rate:9.7s/it remaining:48:00 elapsed:1:44:14 postfix:- (511966:tqdm_logging.py:145)
Step 705: grad_norm=3.926145553588867, loss=0.3414914608001709, param_norm=1887.11669921875
Step 706: grad_norm=3.0484797954559326, loss=0.34270066022872925, param_norm=1887.11669921875
11:31:55.718 [I] Progress on: 706it/1.00kit rate:9.2s/it remaining:45:19 elapsed:1:44:31 postfix:- (511966:tqdm_logging.py:145)
Step 707: grad_norm=5.319828987121582, loss=0.3938254117965698, param_norm=1887.1168212890625
Step 708: grad_norm=3.023837089538574, loss=0.3817567229270935, param_norm=1887.1168212890625
11:32:13.226 [I] Progress on: 708it/1.00kit rate:9.0s/it remaining:43:48 elapsed:1:44:49 postfix:- (511966:tqdm_logging.py:145)
Step 709: grad_norm=5.832773685455322, loss=0.361802339553833, param_norm=1887.116943359375
Step 710: grad_norm=4.018038749694824, loss=0.40923768281936646, param_norm=1887.116943359375
11:32:30.792 [I] Progress on: 710it/1.00kit rate:8.9s/it remaining:43:00 elapsed:1:45:06 postfix:- (511966:tqdm_logging.py:145)
Step 711: grad_norm=2.931490421295166, loss=0.3163231313228607, param_norm=1887.116943359375
Step 712: grad_norm=2.590425729751587, loss=0.31053292751312256, param_norm=1887.1170654296875
11:32:48.302 [I] Progress on: 712it/1.00kit rate:8.8s/it remaining:42:22 elapsed:1:45:24 postfix:- (511966:tqdm_logging.py:145)
Step 713: grad_norm=3.5127081871032715, loss=0.3446506857872009, param_norm=1887.1171875
Step 714: grad_norm=3.924093008041382, loss=0.3725280165672302, param_norm=1887.1171875
11:33:05.878 [I] Progress on: 714it/1.00kit rate:8.8s/it remaining:42:00 elapsed:1:45:42 postfix:- (511966:tqdm_logging.py:145)
Step 715: grad_norm=3.295206308364868, loss=0.3396930992603302, param_norm=1887.1171875
Step 716: grad_norm=3.90748929977417, loss=0.4546254277229309, param_norm=1887.1173095703125
11:33:23.369 [I] Progress on: 716it/1.00kit rate:8.8s/it remaining:41:34 elapsed:1:45:59 postfix:- (511966:tqdm_logging.py:145)
Step 717: grad_norm=3.97452974319458, loss=0.3237949311733246, param_norm=1887.117431640625
Step 718: grad_norm=3.7666478157043457, loss=0.3559146523475647, param_norm=1887.117431640625
11:33:41.055 [I] Progress on: 718it/1.00kit rate:8.8s/it remaining:41:28 elapsed:1:46:17 postfix:- (511966:tqdm_logging.py:145)
Step 719: grad_norm=3.5502381324768066, loss=0.3064613938331604, param_norm=1887.1175537109375
Step 720: grad_norm=2.7408738136291504, loss=0.31358301639556885, param_norm=1887.1175537109375
11:33:58.548 [I] Progress on: 720it/1.00kit rate:8.8s/it remaining:41:01 elapsed:1:46:34 postfix:- (511966:tqdm_logging.py:145)
Step 721: grad_norm=3.172945737838745, loss=0.3509296774864197, param_norm=1887.11767578125
Step 722: grad_norm=3.3131842613220215, loss=0.33193057775497437, param_norm=1887.11767578125
11:34:16.112 [I] Progress on: 722it/1.00kit rate:8.8s/it remaining:40:44 elapsed:1:46:52 postfix:- (511966:tqdm_logging.py:145)
Step 723: grad_norm=4.483898639678955, loss=0.32433515787124634, param_norm=1887.1177978515625
Step 724: grad_norm=4.458633899688721, loss=0.376443088054657, param_norm=1887.1177978515625
11:34:33.609 [I] Progress on: 724it/1.00kit rate:8.8s/it remaining:40:21 elapsed:1:47:09 postfix:- (511966:tqdm_logging.py:145)
Step 725: grad_norm=3.041126251220703, loss=0.3166924715042114, param_norm=1887.117919921875
Step 726: grad_norm=3.331204652786255, loss=0.4015796184539795, param_norm=1887.1180419921875
11:34:51.147 [I] Progress on: 726it/1.00kit rate:8.8s/it remaining:40:06 elapsed:1:47:27 postfix:- (511966:tqdm_logging.py:145)
Step 727: grad_norm=3.4253976345062256, loss=0.29950788617134094, param_norm=1887.117919921875
Step 728: grad_norm=3.8399431705474854, loss=0.42789021134376526, param_norm=1887.1180419921875
11:35:08.593 [I] Progress on: 728it/1.00kit rate:8.8s/it remaining:39:42 elapsed:1:47:44 postfix:- (511966:tqdm_logging.py:145)
Step 729: grad_norm=3.489670753479004, loss=0.30741003155708313, param_norm=1887.1181640625
Step 730: grad_norm=3.3467044830322266, loss=0.3866382837295532, param_norm=1887.1182861328125
11:35:26.113 [I] Progress on: 730it/1.00kit rate:8.8s/it remaining:39:26 elapsed:1:48:02 postfix:- (511966:tqdm_logging.py:145)
Step 731: grad_norm=4.007598400115967, loss=0.385743111371994, param_norm=1887.1182861328125
Step 732: grad_norm=3.6815996170043945, loss=0.34132376313209534, param_norm=1887.1182861328125
11:35:43.585 [I] Progress on: 732it/1.00kit rate:8.8s/it remaining:39:05 elapsed:1:48:19 postfix:- (511966:tqdm_logging.py:145)
Step 733: grad_norm=3.422271966934204, loss=0.36814969778060913, param_norm=1887.118408203125
Step 734: grad_norm=3.2975165843963623, loss=0.30460309982299805, param_norm=1887.118408203125
11:36:01.136 [I] Progress on: 734it/1.00kit rate:8.8s/it remaining:38:53 elapsed:1:48:37 postfix:- (511966:tqdm_logging.py:145)
Step 735: grad_norm=4.0599284172058105, loss=0.3752835988998413, param_norm=1887.1185302734375
Step 736: grad_norm=5.0785064697265625, loss=0.3422871530056, param_norm=1887.1185302734375
11:36:18.624 [I] Progress on: 736it/1.00kit rate:8.8s/it remaining:38:32 elapsed:1:48:54 postfix:- (511966:tqdm_logging.py:145)
Step 737: grad_norm=3.524322509765625, loss=0.3990948796272278, param_norm=1887.1185302734375
Step 738: grad_norm=3.60917329788208, loss=0.3541412353515625, param_norm=1887.11865234375
11:36:36.199 [I] Progress on: 738it/1.00kit rate:8.8s/it remaining:38:19 elapsed:1:49:12 postfix:- (511966:tqdm_logging.py:145)
Step 739: grad_norm=3.2170145511627197, loss=0.36609628796577454, param_norm=1887.11865234375
Step 740: grad_norm=4.067078590393066, loss=0.3813942074775696, param_norm=1887.11865234375
11:36:53.735 [I] Progress on: 740it/1.00kit rate:8.8s/it remaining:38:01 elapsed:1:49:29 postfix:- (511966:tqdm_logging.py:145)
Step 741: grad_norm=3.5217342376708984, loss=0.33003199100494385, param_norm=1887.1187744140625
Step 742: grad_norm=2.992586612701416, loss=0.3288424611091614, param_norm=1887.1187744140625
11:37:11.332 [I] Progress on: 742it/1.00kit rate:8.8s/it remaining:37:49 elapsed:1:49:47 postfix:- (511966:tqdm_logging.py:145)
Step 743: grad_norm=3.6932597160339355, loss=0.34513604640960693, param_norm=1887.1187744140625
Step 744: grad_norm=3.4445865154266357, loss=0.36548933386802673, param_norm=1887.1187744140625
11:37:28.870 [I] Progress on: 744it/1.00kit rate:8.8s/it remaining:37:29 elapsed:1:50:05 postfix:- (511966:tqdm_logging.py:145)
Step 745: grad_norm=3.4268057346343994, loss=0.3624570965766907, param_norm=1887.1190185546875
Step 746: grad_norm=2.700291633605957, loss=0.2942272424697876, param_norm=1887.1190185546875
11:37:46.494 [I] Progress on: 746it/1.00kit rate:8.8s/it remaining:37:15 elapsed:1:50:22 postfix:- (511966:tqdm_logging.py:145)
Step 747: grad_norm=3.1801669597625732, loss=0.3006431758403778, param_norm=1887.1190185546875
Step 748: grad_norm=3.679504871368408, loss=0.3438287377357483, param_norm=1887.119140625
11:38:04.052 [I] Progress on: 748it/1.00kit rate:8.8s/it remaining:36:57 elapsed:1:50:40 postfix:- (511966:tqdm_logging.py:145)
Step 749: grad_norm=4.786121368408203, loss=0.3666555881500244, param_norm=1887.119140625
Step 750: grad_norm=5.905706882476807, loss=0.3144901692867279, param_norm=1887.119140625
11:38:21.674 [I] Progress on: 750it/1.00kit rate:8.8s/it remaining:36:42 elapsed:1:50:57 postfix:- (511966:tqdm_logging.py:145)
Step 751: grad_norm=4.571677207946777, loss=0.3289395868778229, param_norm=1887.119140625
Step 752: grad_norm=3.332515239715576, loss=0.32753777503967285, param_norm=1887.119140625
11:38:39.247 [I] Progress on: 752it/1.00kit rate:8.8s/it remaining:36:23 elapsed:1:51:15 postfix:- (511966:tqdm_logging.py:145)
Step 753: grad_norm=3.353868007659912, loss=0.28936612606048584, param_norm=1887.1192626953125
Step 754: grad_norm=5.166394233703613, loss=0.4564911723136902, param_norm=1887.119384765625
11:38:56.885 [I] Progress on: 754it/1.00kit rate:8.8s/it remaining:36:08 elapsed:1:51:33 postfix:- (511966:tqdm_logging.py:145)
Step 755: grad_norm=4.543684482574463, loss=0.33416831493377686, param_norm=1887.119384765625
Step 756: grad_norm=6.310359954833984, loss=0.36977076530456543, param_norm=1887.119384765625
11:39:14.436 [I] Progress on: 756it/1.00kit rate:8.8s/it remaining:35:47 elapsed:1:51:50 postfix:- (511966:tqdm_logging.py:145)
Step 757: grad_norm=3.178798198699951, loss=0.31663089990615845, param_norm=1887.1195068359375
Step 758: grad_norm=3.1635305881500244, loss=0.33045297861099243, param_norm=1887.1195068359375
11:39:32.065 [I] Progress on: 758it/1.00kit rate:8.8s/it remaining:35:33 elapsed:1:52:08 postfix:- (511966:tqdm_logging.py:145)
Step 759: grad_norm=8.59897232055664, loss=0.33766674995422363, param_norm=1887.1195068359375
Step 760: grad_norm=3.848182201385498, loss=0.3086015284061432, param_norm=1887.11962890625
11:39:49.604 [I] Progress on: 760it/1.00kit rate:8.8s/it remaining:35:10 elapsed:1:52:25 postfix:- (511966:tqdm_logging.py:145)
Step 761: grad_norm=3.998988628387451, loss=0.3328489661216736, param_norm=1887.11962890625
Step 762: grad_norm=3.3322813510894775, loss=0.3345504701137543, param_norm=1887.1197509765625
11:40:07.203 [I] Progress on: 762it/1.00kit rate:8.8s/it remaining:34:56 elapsed:1:52:43 postfix:- (511966:tqdm_logging.py:145)
Step 763: grad_norm=7.631619930267334, loss=0.3470308184623718, param_norm=1887.1197509765625
Step 764: grad_norm=4.228691577911377, loss=0.37760791182518005, param_norm=1887.1197509765625
11:40:24.738 [I] Progress on: 764it/1.00kit rate:8.8s/it remaining:34:34 elapsed:1:53:00 postfix:- (511966:tqdm_logging.py:145)
Step 765: grad_norm=3.4762072563171387, loss=0.3060618042945862, param_norm=1887.1197509765625
Step 766: grad_norm=3.98665189743042, loss=0.29969170689582825, param_norm=1887.1197509765625
11:40:42.331 [I] Progress on: 766it/1.00kit rate:8.8s/it remaining:34:19 elapsed:1:53:18 postfix:- (511966:tqdm_logging.py:145)
Step 767: grad_norm=3.0258753299713135, loss=0.3142845630645752, param_norm=1887.1197509765625
11:40:53.160 [I] Progress on: 768it/1.00kit rate:9.4s/it remaining:36:11 elapsed:1:53:29 postfix:- (511966:tqdm_logging.py:145)
Step 768: grad_norm=2.8936798572540283, loss=0.2992757558822632, param_norm=1887.119873046875
Step 769: grad_norm=3.3034653663635254, loss=0.3228135108947754, param_norm=1887.119873046875
11:41:10.492 [I] Progress on: 769it/1.00kit rate:9.2s/it remaining:35:17 elapsed:1:53:46 postfix:- (511966:tqdm_logging.py:145)
Step 770: grad_norm=2.990535020828247, loss=0.3008444607257843, param_norm=1887.119873046875
Step 771: grad_norm=3.8070590496063232, loss=0.31848132610321045, param_norm=1887.119873046875
11:41:28.075 [I] Progress on: 771it/1.00kit rate:9.0s/it remaining:34:15 elapsed:1:54:04 postfix:- (511966:tqdm_logging.py:145)
Step 772: grad_norm=2.7546451091766357, loss=0.28389444947242737, param_norm=1887.119873046875
Step 773: grad_norm=3.7427594661712646, loss=0.28969883918762207, param_norm=1887.119873046875
11:41:45.677 [I] Progress on: 773it/1.00kit rate:8.9s/it remaining:33:36 elapsed:1:54:21 postfix:- (511966:tqdm_logging.py:145)
Step 774: grad_norm=2.5362870693206787, loss=0.2897967994213104, param_norm=1887.119873046875
Step 775: grad_norm=4.065047740936279, loss=0.23469208180904388, param_norm=1887.1199951171875
11:42:03.267 [I] Progress on: 775it/1.00kit rate:8.8s/it remaining:33:07 elapsed:1:54:39 postfix:- (511966:tqdm_logging.py:145)
Step 776: grad_norm=2.8079917430877686, loss=0.26564550399780273, param_norm=1887.1199951171875
Step 777: grad_norm=2.747257709503174, loss=0.2705678939819336, param_norm=1887.1199951171875
11:42:20.867 [I] Progress on: 777it/1.00kit rate:8.8s/it remaining:32:45 elapsed:1:54:57 postfix:- (511966:tqdm_logging.py:145)
Step 778: grad_norm=3.3971173763275146, loss=0.2922462821006775, param_norm=1887.1199951171875
Step 779: grad_norm=2.7051661014556885, loss=0.30516284704208374, param_norm=1887.1201171875
11:42:38.476 [I] Progress on: 779it/1.00kit rate:8.8s/it remaining:32:25 elapsed:1:55:14 postfix:- (511966:tqdm_logging.py:145)
Step 780: grad_norm=3.763030767440796, loss=0.3112633526325226, param_norm=1887.1201171875
Step 781: grad_norm=2.577228546142578, loss=0.272228866815567, param_norm=1887.1201171875
11:42:56.075 [I] Progress on: 781it/1.00kit rate:8.8s/it remaining:32:07 elapsed:1:55:32 postfix:- (511966:tqdm_logging.py:145)
Step 782: grad_norm=2.836434841156006, loss=0.28793078660964966, param_norm=1887.1202392578125
Step 783: grad_norm=3.029982328414917, loss=0.26444777846336365, param_norm=1887.1202392578125
11:43:13.679 [I] Progress on: 783it/1.00kit rate:8.8s/it remaining:31:48 elapsed:1:55:49 postfix:- (511966:tqdm_logging.py:145)
Step 784: grad_norm=3.3862249851226807, loss=0.3158630430698395, param_norm=1887.120361328125
Step 785: grad_norm=2.795531749725342, loss=0.3017732501029968, param_norm=1887.120361328125
11:43:31.296 [I] Progress on: 785it/1.00kit rate:8.8s/it remaining:31:31 elapsed:1:56:07 postfix:- (511966:tqdm_logging.py:145)
Step 786: grad_norm=2.981593132019043, loss=0.3018316328525543, param_norm=1887.120361328125
Step 787: grad_norm=3.3546810150146484, loss=0.30831634998321533, param_norm=1887.120361328125
11:43:48.911 [I] Progress on: 787it/1.00kit rate:8.8s/it remaining:31:14 elapsed:1:56:25 postfix:- (511966:tqdm_logging.py:145)
Step 788: grad_norm=2.5508646965026855, loss=0.2909722924232483, param_norm=1887.1204833984375
Step 789: grad_norm=2.48768949508667, loss=0.29195436835289, param_norm=1887.12060546875
11:44:06.549 [I] Progress on: 789it/1.00kit rate:8.8s/it remaining:30:58 elapsed:1:56:42 postfix:- (511966:tqdm_logging.py:145)
Step 790: grad_norm=2.6443397998809814, loss=0.28340819478034973, param_norm=1887.12060546875
Step 791: grad_norm=3.204075813293457, loss=0.2876338064670563, param_norm=1887.12060546875
11:44:24.175 [I] Progress on: 791it/1.00kit rate:8.8s/it remaining:30:40 elapsed:1:57:00 postfix:- (511966:tqdm_logging.py:145)
Step 792: grad_norm=2.9922492504119873, loss=0.3250044286251068, param_norm=1887.12060546875
Step 793: grad_norm=2.697340250015259, loss=0.27727746963500977, param_norm=1887.1207275390625
11:44:41.791 [I] Progress on: 793it/1.00kit rate:8.8s/it remaining:30:22 elapsed:1:57:17 postfix:- (511966:tqdm_logging.py:145)
Step 794: grad_norm=3.1583001613616943, loss=0.3154974579811096, param_norm=1887.1207275390625
Step 795: grad_norm=2.6558916568756104, loss=0.2969232201576233, param_norm=1887.120849609375
11:44:59.422 [I] Progress on: 795it/1.00kit rate:8.8s/it remaining:30:05 elapsed:1:57:35 postfix:- (511966:tqdm_logging.py:145)
Step 796: grad_norm=2.69289493560791, loss=0.26576822996139526, param_norm=1887.120849609375
Step 797: grad_norm=3.0528061389923096, loss=0.29258179664611816, param_norm=1887.120849609375
11:45:17.077 [I] Progress on: 797it/1.00kit rate:8.8s/it remaining:29:49 elapsed:1:57:53 postfix:- (511966:tqdm_logging.py:145)
Step 798: grad_norm=3.2630386352539062, loss=0.24473312497138977, param_norm=1887.1209716796875
Step 799: grad_norm=3.2397608757019043, loss=0.2541467249393463, param_norm=1887.1209716796875
11:45:34.669 [I] Progress on: 799it/1.00kit rate:8.8s/it remaining:29:30 elapsed:1:58:10 postfix:- (511966:tqdm_logging.py:145)
Step 800: grad_norm=3.962249994277954, loss=0.30822402238845825, param_norm=1887.1209716796875
11:45:43.649 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
11:45:43.649 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
11:45:43.649 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (511966:checkpoint_manager.py:1786)
11:45:43.649 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (511966:checkpoint_manager.py:1817)
11:45:43.650 [I] [process=0] Saving checkpoint at step 800                                        (511966:checkpoint_manager.py:1286)
11:45:43.650 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800. (511966:async_checkpointer.py:358)
11:45:43.652 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:45:43.652 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21 (511966:atomicity.py:144)
11:45:43.653 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:45:43.653 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
11:45:43.655 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (511966:atomicity.py:144)
11:45:43.655 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (511966:atomicity.py:144)
11:45:43.655 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
11:45:43.660 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
11:45:47.205 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.9 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:45:47.210 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
11:45:47.212 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
11:45:47.213 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
11:45:47.230 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.238 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.239 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.242 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:46.765787+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.244 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:33.643456+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.247 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:16:18.712963+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.247 [I] Preserving Checkpoint[step=700 | time=2025-04-08 15:31:01.239810+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
11:45:47.249 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
11:45:47.251 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
11:45:47.252 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
11:45:47.252 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744127143.6490757, 'wait_for_prev_duration_secs': 0.0006787776947021484, 'checkpointer_blocking_start_time': 1744127143.65035, 'checkpointer_blocking_duration_secs': 3.5799062252044678, 'get_old_steps_start_time': 1744127147.2303314, 'get_old_steps_duration_secs': 0.019023656845092773, 'checkpoint_manager_blocking_start_time': 1744127143.6488783, 'checkpoint_manager_blocking_duration_secs': 3.603851318359375} (511966:standard_logger.py:34)
11:45:47.253 [I] Progress on: 801it/1.00kit rate:9.9s/it remaining:32:45 elapsed:1:58:23 postfix:- (511966:tqdm_logging.py:145)
11:45:54.520 [I] ChainedFuture completed 1/1 futures in 7.31 seconds.                             (511966:future.py:137)
11:45:54.520 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 953.6 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
11:45:54.520 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
11:45:54.522 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21 (511966:async_checkpointer.py:406)
11:45:54.522 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21/assets (511966:atomicity.py:287)
11:45:54.533 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21/params (511966:atomicity.py:287)
11:45:54.533 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800 (511966:async_checkpointer.py:416)
11:45:54.534 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21 (511966:async_checkpointer.py:426)
11:45:54.534 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800 (511966:atomicity.py:287)
11:45:54.535 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/800`. (511966:atomicity.py:548)
11:45:54.536 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
11:45:54.536 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
11:45:54.537 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
11:45:54.537 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
11:45:54.537 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 801: grad_norm=3.421908140182495, loss=0.2877987027168274, param_norm=1887.1209716796875
Step 802: grad_norm=3.419396162033081, loss=0.3239915370941162, param_norm=1887.12109375
11:46:04.717 [I] Progress on: 802it/1.00kit rate:9.6s/it remaining:31:35 elapsed:1:58:40 postfix:- (511966:tqdm_logging.py:145)
Step 803: grad_norm=3.707456588745117, loss=0.28929635882377625, param_norm=1887.12109375
Step 804: grad_norm=4.620582580566406, loss=0.32135072350502014, param_norm=1887.12109375
11:46:22.323 [I] Progress on: 804it/1.00kit rate:9.2s/it remaining:29:59 elapsed:1:58:58 postfix:- (511966:tqdm_logging.py:145)
Step 805: grad_norm=2.7808449268341064, loss=0.29302698373794556, param_norm=1887.12109375
Step 806: grad_norm=2.8897268772125244, loss=0.29638832807540894, param_norm=1887.12109375
11:46:39.933 [I] Progress on: 806it/1.00kit rate:9.0s/it remaining:29:04 elapsed:1:59:16 postfix:- (511966:tqdm_logging.py:145)
Step 807: grad_norm=4.527002811431885, loss=0.2531733214855194, param_norm=1887.1212158203125
Step 808: grad_norm=4.918743133544922, loss=0.30486106872558594, param_norm=1887.1212158203125
11:46:57.875 [I] Progress on: 808it/1.00kit rate:9.0s/it remaining:28:47 elapsed:1:59:34 postfix:- (511966:tqdm_logging.py:145)
Step 809: grad_norm=3.3096728324890137, loss=0.2869799733161926, param_norm=1887.1212158203125
Step 810: grad_norm=6.046394348144531, loss=0.3120983839035034, param_norm=1887.121337890625
11:47:15.490 [I] Progress on: 810it/1.00kit rate:8.9s/it remaining:28:11 elapsed:1:59:51 postfix:- (511966:tqdm_logging.py:145)
Step 811: grad_norm=4.084705829620361, loss=0.29329872131347656, param_norm=1887.121337890625
Step 812: grad_norm=3.2015130519866943, loss=0.28234297037124634, param_norm=1887.1214599609375
11:47:33.069 [I] Progress on: 812it/1.00kit rate:8.8s/it remaining:27:43 elapsed:2:00:09 postfix:- (511966:tqdm_logging.py:145)
Step 813: grad_norm=3.647343397140503, loss=0.30703502893447876, param_norm=1887.1214599609375
Step 814: grad_norm=3.4606456756591797, loss=0.31065332889556885, param_norm=1887.1214599609375
11:47:50.645 [I] Progress on: 814it/1.00kit rate:8.8s/it remaining:27:20 elapsed:2:00:26 postfix:- (511966:tqdm_logging.py:145)
Step 815: grad_norm=2.9403879642486572, loss=0.2419722080230713, param_norm=1887.1214599609375
Step 816: grad_norm=2.9257304668426514, loss=0.2842177748680115, param_norm=1887.12158203125
11:48:08.265 [I] Progress on: 816it/1.00kit rate:8.8s/it remaining:27:02 elapsed:2:00:44 postfix:- (511966:tqdm_logging.py:145)
Step 817: grad_norm=3.4016623497009277, loss=0.2895546555519104, param_norm=1887.12158203125
Step 818: grad_norm=2.9128611087799072, loss=0.25338631868362427, param_norm=1887.12158203125
11:48:25.889 [I] Progress on: 818it/1.00kit rate:8.8s/it remaining:26:44 elapsed:2:01:02 postfix:- (511966:tqdm_logging.py:145)
Step 819: grad_norm=2.630221128463745, loss=0.30374473333358765, param_norm=1887.12158203125
Step 820: grad_norm=4.327764511108398, loss=0.3160986602306366, param_norm=1887.12158203125
11:48:43.491 [I] Progress on: 820it/1.00kit rate:8.8s/it remaining:26:26 elapsed:2:01:19 postfix:- (511966:tqdm_logging.py:145)
Step 821: grad_norm=3.725703477859497, loss=0.2781183123588562, param_norm=1887.12158203125
Step 822: grad_norm=3.461716890335083, loss=0.3144577741622925, param_norm=1887.1217041015625
11:49:01.085 [I] Progress on: 822it/1.00kit rate:8.8s/it remaining:26:07 elapsed:2:01:37 postfix:- (511966:tqdm_logging.py:145)
Step 823: grad_norm=3.400988817214966, loss=0.3483836352825165, param_norm=1887.1217041015625
Step 824: grad_norm=3.4725306034088135, loss=0.3084537982940674, param_norm=1887.1217041015625
11:49:18.676 [I] Progress on: 824it/1.00kit rate:8.8s/it remaining:25:49 elapsed:2:01:54 postfix:- (511966:tqdm_logging.py:145)
Step 825: grad_norm=2.941906213760376, loss=0.30078285932540894, param_norm=1887.1217041015625
Step 826: grad_norm=4.215261459350586, loss=0.32102805376052856, param_norm=1887.1217041015625
11:49:36.276 [I] Progress on: 826it/1.00kit rate:8.8s/it remaining:25:31 elapsed:2:02:12 postfix:- (511966:tqdm_logging.py:145)
Step 827: grad_norm=3.15468168258667, loss=0.30850750207901, param_norm=1887.1217041015625
Step 828: grad_norm=3.232292413711548, loss=0.3173516094684601, param_norm=1887.121826171875
11:49:53.860 [I] Progress on: 828it/1.00kit rate:8.8s/it remaining:25:13 elapsed:2:02:30 postfix:- (511966:tqdm_logging.py:145)
Step 829: grad_norm=2.794426441192627, loss=0.3142055869102478, param_norm=1887.121826171875
Step 830: grad_norm=2.9913170337677, loss=0.28902485966682434, param_norm=1887.121826171875
11:50:11.456 [I] Progress on: 830it/1.00kit rate:8.8s/it remaining:24:56 elapsed:2:02:47 postfix:- (511966:tqdm_logging.py:145)
Step 831: grad_norm=3.6967060565948486, loss=0.2876496911048889, param_norm=1887.121826171875
11:50:22.446 [I] Progress on: 832it/1.00kit rate:9.4s/it remaining:26:20 elapsed:2:02:58 postfix:- (511966:tqdm_logging.py:145)
Step 832: grad_norm=3.381747007369995, loss=0.2516062259674072, param_norm=1887.1219482421875
Step 833: grad_norm=3.003377676010132, loss=0.2915792167186737, param_norm=1887.1219482421875
11:50:39.812 [I] Progress on: 833it/1.00kit rate:9.2s/it remaining:25:36 elapsed:2:03:16 postfix:- (511966:tqdm_logging.py:145)
Step 834: grad_norm=2.62666654586792, loss=0.2460317611694336, param_norm=1887.1220703125
Step 835: grad_norm=2.4109771251678467, loss=0.2891935110092163, param_norm=1887.1220703125
11:50:57.369 [I] Progress on: 835it/1.00kit rate:9.0s/it remaining:24:42 elapsed:2:03:33 postfix:- (511966:tqdm_logging.py:145)
Step 836: grad_norm=3.6717288494110107, loss=0.2610777020454407, param_norm=1887.1220703125
Step 837: grad_norm=2.4668843746185303, loss=0.2589576542377472, param_norm=1887.1220703125
11:51:15.012 [I] Progress on: 837it/1.00kit rate:8.9s/it remaining:24:09 elapsed:2:03:51 postfix:- (511966:tqdm_logging.py:145)
Step 838: grad_norm=3.233309507369995, loss=0.2381269484758377, param_norm=1887.1220703125
Step 839: grad_norm=3.356506109237671, loss=0.23350366950035095, param_norm=1887.1220703125
11:51:32.582 [I] Progress on: 839it/1.00kit rate:8.8s/it remaining:23:42 elapsed:2:04:08 postfix:- (511966:tqdm_logging.py:145)
Step 840: grad_norm=2.507338047027588, loss=0.24635149538516998, param_norm=1887.1220703125
Step 841: grad_norm=2.785722255706787, loss=0.25953975319862366, param_norm=1887.1221923828125
11:51:50.212 [I] Progress on: 841it/1.00kit rate:8.8s/it remaining:23:21 elapsed:2:04:26 postfix:- (511966:tqdm_logging.py:145)
Step 842: grad_norm=2.440434455871582, loss=0.23524947464466095, param_norm=1887.1221923828125
Step 843: grad_norm=1.869024395942688, loss=0.2041073441505432, param_norm=1887.1221923828125
11:52:07.778 [I] Progress on: 843it/1.00kit rate:8.8s/it remaining:23:00 elapsed:2:04:43 postfix:- (511966:tqdm_logging.py:145)
Step 844: grad_norm=2.647702932357788, loss=0.2825416922569275, param_norm=1887.1221923828125
Step 845: grad_norm=2.717392683029175, loss=0.28250986337661743, param_norm=1887.1221923828125
11:52:25.391 [I] Progress on: 845it/1.00kit rate:8.8s/it remaining:22:43 elapsed:2:05:01 postfix:- (511966:tqdm_logging.py:145)
Step 846: grad_norm=3.082688570022583, loss=0.24581103026866913, param_norm=1887.122314453125
Step 847: grad_norm=3.2801215648651123, loss=0.2416977882385254, param_norm=1887.122314453125
11:52:42.952 [I] Progress on: 847it/1.00kit rate:8.8s/it remaining:22:24 elapsed:2:05:19 postfix:- (511966:tqdm_logging.py:145)
Step 848: grad_norm=2.7957658767700195, loss=0.2520456314086914, param_norm=1887.122314453125
Step 849: grad_norm=2.569856882095337, loss=0.2321164309978485, param_norm=1887.122314453125
11:53:00.607 [I] Progress on: 849it/1.00kit rate:8.8s/it remaining:22:08 elapsed:2:05:36 postfix:- (511966:tqdm_logging.py:145)
Step 850: grad_norm=3.753026247024536, loss=0.24524419009685516, param_norm=1887.122314453125
Step 851: grad_norm=2.821223020553589, loss=0.22459866106510162, param_norm=1887.122314453125
11:53:18.201 [I] Progress on: 851it/1.00kit rate:8.8s/it remaining:21:49 elapsed:2:05:54 postfix:- (511966:tqdm_logging.py:145)
Step 852: grad_norm=2.5772769451141357, loss=0.23571240901947021, param_norm=1887.122314453125
Step 853: grad_norm=4.0768208503723145, loss=0.24906966090202332, param_norm=1887.1224365234375
11:53:35.834 [I] Progress on: 853it/1.00kit rate:8.8s/it remaining:21:32 elapsed:2:06:12 postfix:- (511966:tqdm_logging.py:145)
Step 854: grad_norm=3.3475165367126465, loss=0.2736184895038605, param_norm=1887.1224365234375
Step 855: grad_norm=2.7190072536468506, loss=0.261099636554718, param_norm=1887.1224365234375
11:53:53.428 [I] Progress on: 855it/1.00kit rate:8.8s/it remaining:21:14 elapsed:2:06:29 postfix:- (511966:tqdm_logging.py:145)
Step 856: grad_norm=3.4423670768737793, loss=0.28181421756744385, param_norm=1887.1224365234375
Step 857: grad_norm=2.4460577964782715, loss=0.21262072026729584, param_norm=1887.12255859375
11:54:11.063 [I] Progress on: 857it/1.00kit rate:8.8s/it remaining:20:57 elapsed:2:06:47 postfix:- (511966:tqdm_logging.py:145)
Step 858: grad_norm=2.4819538593292236, loss=0.2409828007221222, param_norm=1887.1226806640625
Step 859: grad_norm=2.295764446258545, loss=0.2548452615737915, param_norm=1887.1226806640625
11:54:28.646 [I] Progress on: 859it/1.00kit rate:8.8s/it remaining:20:39 elapsed:2:07:04 postfix:- (511966:tqdm_logging.py:145)
Step 860: grad_norm=2.714514970779419, loss=0.2722395062446594, param_norm=1887.1226806640625
Step 861: grad_norm=3.7562754154205322, loss=0.26143884658813477, param_norm=1887.1226806640625
11:54:46.264 [I] Progress on: 861it/1.00kit rate:8.8s/it remaining:20:21 elapsed:2:07:22 postfix:- (511966:tqdm_logging.py:145)
Step 862: grad_norm=3.487079620361328, loss=0.2833606004714966, param_norm=1887.1226806640625
Step 863: grad_norm=2.8836631774902344, loss=0.2632194459438324, param_norm=1887.1226806640625
11:55:03.851 [I] Progress on: 863it/1.00kit rate:8.8s/it remaining:20:03 elapsed:2:07:40 postfix:- (511966:tqdm_logging.py:145)
Step 864: grad_norm=4.68465518951416, loss=0.2607342302799225, param_norm=1887.1226806640625
Step 865: grad_norm=3.3592751026153564, loss=0.26618441939353943, param_norm=1887.1226806640625
11:55:21.469 [I] Progress on: 865it/1.00kit rate:8.8s/it remaining:19:46 elapsed:2:07:57 postfix:- (511966:tqdm_logging.py:145)
Step 866: grad_norm=2.4771695137023926, loss=0.22764039039611816, param_norm=1887.1226806640625
Step 867: grad_norm=2.433420181274414, loss=0.2442033886909485, param_norm=1887.1226806640625
11:55:39.066 [I] Progress on: 867it/1.00kit rate:8.8s/it remaining:19:28 elapsed:2:08:15 postfix:- (511966:tqdm_logging.py:145)
Step 868: grad_norm=2.6903135776519775, loss=0.24405881762504578, param_norm=1887.1226806640625
Step 869: grad_norm=3.5141327381134033, loss=0.25720709562301636, param_norm=1887.122802734375
11:55:56.677 [I] Progress on: 869it/1.00kit rate:8.8s/it remaining:19:11 elapsed:2:08:32 postfix:- (511966:tqdm_logging.py:145)
Step 870: grad_norm=2.4558162689208984, loss=0.24729770421981812, param_norm=1887.122802734375
Step 871: grad_norm=2.797696113586426, loss=0.24280951917171478, param_norm=1887.122802734375
11:56:14.258 [I] Progress on: 871it/1.00kit rate:8.8s/it remaining:18:52 elapsed:2:08:50 postfix:- (511966:tqdm_logging.py:145)
Step 872: grad_norm=2.284202814102173, loss=0.2375619262456894, param_norm=1887.122802734375
Step 873: grad_norm=2.962719678878784, loss=0.3177443742752075, param_norm=1887.122802734375
11:56:31.849 [I] Progress on: 873it/1.00kit rate:8.8s/it remaining:18:35 elapsed:2:09:08 postfix:- (511966:tqdm_logging.py:145)
Step 874: grad_norm=2.6091623306274414, loss=0.22026591002941132, param_norm=1887.122802734375
Step 875: grad_norm=2.644829273223877, loss=0.28307944536209106, param_norm=1887.122802734375
11:56:49.446 [I] Progress on: 875it/1.00kit rate:8.8s/it remaining:18:17 elapsed:2:09:25 postfix:- (511966:tqdm_logging.py:145)
Step 876: grad_norm=2.8289058208465576, loss=0.2645915746688843, param_norm=1887.1229248046875
Step 877: grad_norm=2.8075110912323, loss=0.22756177186965942, param_norm=1887.1229248046875
11:57:07.037 [I] Progress on: 877it/1.00kit rate:8.8s/it remaining:18:00 elapsed:2:09:43 postfix:- (511966:tqdm_logging.py:145)
Step 878: grad_norm=2.4286117553710938, loss=0.22363443672657013, param_norm=1887.1229248046875
Step 879: grad_norm=2.3882558345794678, loss=0.20941251516342163, param_norm=1887.1229248046875
11:57:24.629 [I] Progress on: 879it/1.00kit rate:8.8s/it remaining:17:42 elapsed:2:10:00 postfix:- (511966:tqdm_logging.py:145)
Step 880: grad_norm=2.5250449180603027, loss=0.2594113051891327, param_norm=1887.1229248046875
Step 881: grad_norm=2.2337143421173096, loss=0.24134038388729095, param_norm=1887.1229248046875
11:57:42.235 [I] Progress on: 881it/1.00kit rate:8.8s/it remaining:17:25 elapsed:2:10:18 postfix:- (511966:tqdm_logging.py:145)
Step 882: grad_norm=3.4103174209594727, loss=0.2339116483926773, param_norm=1887.1229248046875
Step 883: grad_norm=2.845771074295044, loss=0.25425630807876587, param_norm=1887.1229248046875
11:57:59.830 [I] Progress on: 883it/1.00kit rate:8.8s/it remaining:17:07 elapsed:2:10:36 postfix:- (511966:tqdm_logging.py:145)
Step 884: grad_norm=3.4007463455200195, loss=0.2711642384529114, param_norm=1887.1229248046875
Step 885: grad_norm=3.6395487785339355, loss=0.28668805956840515, param_norm=1887.123046875
11:58:17.442 [I] Progress on: 885it/1.00kit rate:8.8s/it remaining:16:50 elapsed:2:10:53 postfix:- (511966:tqdm_logging.py:145)
Step 886: grad_norm=2.613248109817505, loss=0.23466533422470093, param_norm=1887.123046875
Step 887: grad_norm=2.737548828125, loss=0.24051780998706818, param_norm=1887.123046875
11:58:35.019 [I] Progress on: 887it/1.00kit rate:8.8s/it remaining:16:32 elapsed:2:11:11 postfix:- (511966:tqdm_logging.py:145)
Step 888: grad_norm=2.63093638420105, loss=0.27657172083854675, param_norm=1887.123046875
Step 889: grad_norm=3.0474355220794678, loss=0.2782059609889984, param_norm=1887.1231689453125
11:58:52.644 [I] Progress on: 889it/1.00kit rate:8.8s/it remaining:16:15 elapsed:2:11:28 postfix:- (511966:tqdm_logging.py:145)
Step 890: grad_norm=2.4933972358703613, loss=0.31105268001556396, param_norm=1887.1231689453125
Step 891: grad_norm=2.837887763977051, loss=0.25467759370803833, param_norm=1887.1231689453125
11:59:10.255 [I] Progress on: 891it/1.00kit rate:8.8s/it remaining:15:58 elapsed:2:11:46 postfix:- (511966:tqdm_logging.py:145)
Step 892: grad_norm=2.9802870750427246, loss=0.24567408859729767, param_norm=1887.1231689453125
Step 893: grad_norm=3.6749513149261475, loss=0.288074791431427, param_norm=1887.1231689453125
11:59:27.872 [I] Progress on: 893it/1.00kit rate:8.8s/it remaining:15:41 elapsed:2:12:04 postfix:- (511966:tqdm_logging.py:145)
Step 894: grad_norm=2.8462700843811035, loss=0.2550826668739319, param_norm=1887.1231689453125
Step 895: grad_norm=2.4440019130706787, loss=0.2821497619152069, param_norm=1887.123291015625
11:59:45.438 [I] Progress on: 895it/1.00kit rate:8.8s/it remaining:15:22 elapsed:2:12:21 postfix:- (511966:tqdm_logging.py:145)
Step 896: grad_norm=2.4772050380706787, loss=0.2448933720588684, param_norm=1887.123291015625
11:59:56.250 [I] Progress on: 896it/1.00kit rate:9.4s/it remaining:16:16 elapsed:2:12:32 postfix:- (511966:tqdm_logging.py:145)
Step 897: grad_norm=2.684730052947998, loss=0.23113524913787842, param_norm=1887.123291015625
Step 898: grad_norm=2.443209648132324, loss=0.2130046784877777, param_norm=1887.123291015625
12:00:13.871 [I] Progress on: 898it/1.00kit rate:9.1s/it remaining:15:28 elapsed:2:12:50 postfix:- (511966:tqdm_logging.py:145)
Step 899: grad_norm=2.584310293197632, loss=0.24907469749450684, param_norm=1887.123291015625
Step 900: grad_norm=2.4228413105010986, loss=0.23514427244663239, param_norm=1887.123291015625
12:00:31.506 [I] Progress on: 900it/1.00kit rate:9.0s/it remaining:14:55 elapsed:2:13:07 postfix:- (511966:tqdm_logging.py:145)
12:00:31.615 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
12:00:31.615 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
12:00:31.615 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (511966:checkpoint_manager.py:1786)
12:00:31.615 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (511966:checkpoint_manager.py:1817)
12:00:31.615 [I] [process=0] Saving checkpoint at step 900                                        (511966:checkpoint_manager.py:1286)
12:00:31.616 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900. (511966:async_checkpointer.py:358)
12:00:31.617 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
12:00:31.618 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24 (511966:atomicity.py:144)
12:00:31.618 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
12:00:31.619 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
12:00:31.620 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (511966:atomicity.py:144)
12:00:31.620 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (511966:atomicity.py:144)
12:00:31.621 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
12:00:31.625 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
12:00:35.486 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
12:00:35.500 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
12:00:35.501 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
12:00:35.508 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
12:00:35.510 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.520 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.526 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.535 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:46.765787+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.542 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:33.643456+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.545 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:16:18.712963+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.546 [I] Preserving Checkpoint[step=700 | time=2025-04-08 15:31:01.239810+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.547 [I] Preserving Checkpoint[step=800 | time=2025-04-08 15:45:47.230288+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:00:35.550 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
12:00:35.557 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
12:00:35.574 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
12:00:35.578 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744128031.6149457, 'wait_for_prev_duration_secs': 0.0006220340728759766, 'checkpointer_blocking_start_time': 1744128031.6160681, 'checkpointer_blocking_duration_secs': 3.8946645259857178, 'get_old_steps_start_time': 1744128035.5107787, 'get_old_steps_duration_secs': 0.03958487510681152, 'checkpoint_manager_blocking_start_time': 1744128031.6148217, 'checkpoint_manager_blocking_duration_secs': 3.9631059169769287} (511966:standard_logger.py:34)
12:00:43.855 [I] ChainedFuture completed 1/1 futures in 8.34 seconds.                             (511966:future.py:137)
12:00:43.856 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 846.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
12:00:43.856 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
12:00:43.858 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24 (511966:async_checkpointer.py:406)
12:00:43.858 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24/assets (511966:atomicity.py:287)
12:00:43.868 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24/params (511966:atomicity.py:287)
12:00:43.869 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900 (511966:async_checkpointer.py:416)
12:00:43.869 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24 (511966:async_checkpointer.py:426)
12:00:43.870 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900 (511966:atomicity.py:287)
12:00:43.871 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/900`. (511966:atomicity.py:548)
12:00:43.871 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
12:00:43.872 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
12:00:43.872 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
12:00:43.873 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
12:00:43.873 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
Step 901: grad_norm=2.35518741607666, loss=0.24872276186943054, param_norm=1887.123291015625
12:00:44.178 [I] Progress on: 901it/1.00kit rate:10.1s/it remaining:16:38 elapsed:2:13:20 postfix:- (511966:tqdm_logging.py:145)
Step 902: grad_norm=2.197343111038208, loss=0.22687090933322906, param_norm=1887.1234130859375
Step 903: grad_norm=2.0056722164154053, loss=0.20663601160049438, param_norm=1887.1234130859375
12:01:01.812 [I] Progress on: 903it/1.00kit rate:9.4s/it remaining:15:14 elapsed:2:13:38 postfix:- (511966:tqdm_logging.py:145)
Step 904: grad_norm=2.22886323928833, loss=0.22424237430095673, param_norm=1887.1234130859375
Step 905: grad_norm=2.4874186515808105, loss=0.256827175617218, param_norm=1887.1234130859375
12:01:19.443 [I] Progress on: 905it/1.00kit rate:9.1s/it remaining:14:25 elapsed:2:13:55 postfix:- (511966:tqdm_logging.py:145)
Step 906: grad_norm=2.19527006149292, loss=0.2158304899930954, param_norm=1887.1234130859375
Step 907: grad_norm=2.963909864425659, loss=0.2267926186323166, param_norm=1887.1234130859375
12:01:37.057 [I] Progress on: 907it/1.00kit rate:8.9s/it remaining:13:51 elapsed:2:14:13 postfix:- (511966:tqdm_logging.py:145)
Step 908: grad_norm=2.5198004245758057, loss=0.24146147072315216, param_norm=1887.1234130859375
Step 909: grad_norm=1.7540717124938965, loss=0.21066376566886902, param_norm=1887.12353515625
12:01:54.671 [I] Progress on: 909it/1.00kit rate:8.9s/it remaining:13:26 elapsed:2:14:30 postfix:- (511966:tqdm_logging.py:145)
Step 910: grad_norm=2.572249174118042, loss=0.24299687147140503, param_norm=1887.1236572265625
Step 911: grad_norm=3.497612714767456, loss=0.232218399643898, param_norm=1887.1236572265625
12:02:12.249 [I] Progress on: 911it/1.00kit rate:8.8s/it remaining:13:05 elapsed:2:14:48 postfix:- (511966:tqdm_logging.py:145)
Step 912: grad_norm=1.8337230682373047, loss=0.20542365312576294, param_norm=1887.1236572265625
Step 913: grad_norm=2.245121479034424, loss=0.2517260015010834, param_norm=1887.1236572265625
12:02:29.852 [I] Progress on: 913it/1.00kit rate:8.8s/it remaining:12:45 elapsed:2:15:06 postfix:- (511966:tqdm_logging.py:145)
Step 914: grad_norm=2.300224542617798, loss=0.19882400333881378, param_norm=1887.1236572265625
Step 915: grad_norm=2.207355260848999, loss=0.2380138337612152, param_norm=1887.1236572265625
12:02:47.429 [I] Progress on: 915it/1.00kit rate:8.8s/it remaining:12:27 elapsed:2:15:23 postfix:- (511966:tqdm_logging.py:145)
Step 916: grad_norm=2.5219571590423584, loss=0.22486113011837006, param_norm=1887.1236572265625
Step 917: grad_norm=2.4951629638671875, loss=0.2490912228822708, param_norm=1887.123779296875
12:03:05.041 [I] Progress on: 917it/1.00kit rate:8.8s/it remaining:12:09 elapsed:2:15:41 postfix:- (511966:tqdm_logging.py:145)
Step 918: grad_norm=2.4325945377349854, loss=0.24509984254837036, param_norm=1887.123779296875
Step 919: grad_norm=2.6515231132507324, loss=0.19852007925510406, param_norm=1887.123779296875
12:03:22.639 [I] Progress on: 919it/1.00kit rate:8.8s/it remaining:11:51 elapsed:2:15:58 postfix:- (511966:tqdm_logging.py:145)
Step 920: grad_norm=2.6469788551330566, loss=0.2225070297718048, param_norm=1887.123779296875
Step 921: grad_norm=3.2076916694641113, loss=0.19588527083396912, param_norm=1887.123779296875
12:03:40.290 [I] Progress on: 921it/1.00kit rate:8.8s/it remaining:11:34 elapsed:2:16:16 postfix:- (511966:tqdm_logging.py:145)
Step 922: grad_norm=2.3945229053497314, loss=0.2132045030593872, param_norm=1887.123779296875
Step 923: grad_norm=1.9952994585037231, loss=0.22799313068389893, param_norm=1887.123779296875
12:03:57.887 [I] Progress on: 923it/1.00kit rate:8.8s/it remaining:11:17 elapsed:2:16:34 postfix:- (511966:tqdm_logging.py:145)
Step 924: grad_norm=2.4859070777893066, loss=0.23391559720039368, param_norm=1887.123779296875
Step 925: grad_norm=2.0433897972106934, loss=0.19804024696350098, param_norm=1887.123779296875
12:04:15.502 [I] Progress on: 925it/1.00kit rate:8.8s/it remaining:10:59 elapsed:2:16:51 postfix:- (511966:tqdm_logging.py:145)
Step 926: grad_norm=2.733210325241089, loss=0.19052673876285553, param_norm=1887.123779296875
Step 927: grad_norm=2.0836453437805176, loss=0.18714213371276855, param_norm=1887.123779296875
12:04:33.089 [I] Progress on: 927it/1.00kit rate:8.8s/it remaining:10:41 elapsed:2:17:09 postfix:- (511966:tqdm_logging.py:145)
Step 928: grad_norm=3.4224295616149902, loss=0.22911041975021362, param_norm=1887.1239013671875
Step 929: grad_norm=2.386014938354492, loss=0.22648531198501587, param_norm=1887.1239013671875
12:04:50.710 [I] Progress on: 929it/1.00kit rate:8.8s/it remaining:10:24 elapsed:2:17:26 postfix:- (511966:tqdm_logging.py:145)
Step 930: grad_norm=2.5650346279144287, loss=0.21617531776428223, param_norm=1887.1239013671875
Step 931: grad_norm=2.509596347808838, loss=0.18075498938560486, param_norm=1887.1239013671875
12:05:08.326 [I] Progress on: 931it/1.00kit rate:8.8s/it remaining:10:06 elapsed:2:17:44 postfix:- (511966:tqdm_logging.py:145)
Step 932: grad_norm=1.7982375621795654, loss=0.16570541262626648, param_norm=1887.1239013671875
Step 933: grad_norm=2.5079360008239746, loss=0.24211251735687256, param_norm=1887.1239013671875
12:05:25.939 [I] Progress on: 933it/1.00kit rate:8.8s/it remaining:09:49 elapsed:2:18:02 postfix:- (511966:tqdm_logging.py:145)
Step 934: grad_norm=2.0873801708221436, loss=0.21092116832733154, param_norm=1887.1239013671875
Step 935: grad_norm=2.5655040740966797, loss=0.19846808910369873, param_norm=1887.1240234375
12:05:43.562 [I] Progress on: 935it/1.00kit rate:8.8s/it remaining:09:31 elapsed:2:18:19 postfix:- (511966:tqdm_logging.py:145)
Step 936: grad_norm=2.602886199951172, loss=0.23850250244140625, param_norm=1887.1240234375
Step 937: grad_norm=2.489161729812622, loss=0.2162778079509735, param_norm=1887.1240234375
12:06:01.213 [I] Progress on: 937it/1.00kit rate:8.8s/it remaining:09:14 elapsed:2:18:37 postfix:- (511966:tqdm_logging.py:145)
Step 938: grad_norm=2.6137351989746094, loss=0.25292640924453735, param_norm=1887.1240234375
Step 939: grad_norm=2.444065570831299, loss=0.22283980250358582, param_norm=1887.1240234375
12:06:18.798 [I] Progress on: 939it/1.00kit rate:8.8s/it remaining:08:56 elapsed:2:18:55 postfix:- (511966:tqdm_logging.py:145)
Step 940: grad_norm=3.161205530166626, loss=0.23074933886528015, param_norm=1887.1240234375
Step 941: grad_norm=2.3538897037506104, loss=0.2112700492143631, param_norm=1887.1240234375
12:06:36.401 [I] Progress on: 941it/1.00kit rate:8.8s/it remaining:08:38 elapsed:2:19:12 postfix:- (511966:tqdm_logging.py:145)
Step 942: grad_norm=2.551074504852295, loss=0.2394014149904251, param_norm=1887.1240234375
Step 943: grad_norm=2.5307183265686035, loss=0.20470207929611206, param_norm=1887.1240234375
12:06:53.975 [I] Progress on: 943it/1.00kit rate:8.8s/it remaining:08:20 elapsed:2:19:30 postfix:- (511966:tqdm_logging.py:145)
Step 944: grad_norm=2.4003353118896484, loss=0.21579816937446594, param_norm=1887.1241455078125
Step 945: grad_norm=2.1561179161071777, loss=0.20351524651050568, param_norm=1887.1240234375
12:07:11.601 [I] Progress on: 945it/1.00kit rate:8.8s/it remaining:08:03 elapsed:2:19:47 postfix:- (511966:tqdm_logging.py:145)
Step 946: grad_norm=2.2461352348327637, loss=0.20192787051200867, param_norm=1887.1241455078125
Step 947: grad_norm=2.4944400787353516, loss=0.22756820917129517, param_norm=1887.1241455078125
12:07:29.184 [I] Progress on: 947it/1.00kit rate:8.8s/it remaining:07:45 elapsed:2:20:05 postfix:- (511966:tqdm_logging.py:145)
Step 948: grad_norm=2.6097707748413086, loss=0.22121265530586243, param_norm=1887.1241455078125
Step 949: grad_norm=2.2882344722747803, loss=0.270058274269104, param_norm=1887.1241455078125
12:07:46.782 [I] Progress on: 949it/1.00kit rate:8.8s/it remaining:07:28 elapsed:2:20:22 postfix:- (511966:tqdm_logging.py:145)
Step 950: grad_norm=2.7696592807769775, loss=0.195298969745636, param_norm=1887.1241455078125
Step 951: grad_norm=2.309007167816162, loss=0.2671140432357788, param_norm=1887.1241455078125
12:08:04.385 [I] Progress on: 951it/1.00kit rate:8.8s/it remaining:07:10 elapsed:2:20:40 postfix:- (511966:tqdm_logging.py:145)
Step 952: grad_norm=2.4173686504364014, loss=0.2253878116607666, param_norm=1887.1241455078125
Step 953: grad_norm=2.4844255447387695, loss=0.23100662231445312, param_norm=1887.1241455078125
12:08:22.010 [I] Progress on: 953it/1.00kit rate:8.8s/it remaining:06:53 elapsed:2:20:58 postfix:- (511966:tqdm_logging.py:145)
Step 954: grad_norm=2.5714821815490723, loss=0.22826683521270752, param_norm=1887.124267578125
Step 955: grad_norm=3.8568623065948486, loss=0.22670915722846985, param_norm=1887.124267578125
12:08:39.597 [I] Progress on: 955it/1.00kit rate:8.8s/it remaining:06:35 elapsed:2:21:15 postfix:- (511966:tqdm_logging.py:145)
Step 956: grad_norm=2.56604266166687, loss=0.23125985264778137, param_norm=1887.124267578125
Step 957: grad_norm=4.194244384765625, loss=0.2312549352645874, param_norm=1887.124267578125
12:08:57.190 [I] Progress on: 957it/1.00kit rate:8.8s/it remaining:06:17 elapsed:2:21:33 postfix:- (511966:tqdm_logging.py:145)
Step 958: grad_norm=2.795060873031616, loss=0.22425371408462524, param_norm=1887.124267578125
Step 959: grad_norm=2.6912388801574707, loss=0.21101424098014832, param_norm=1887.124267578125
12:09:14.772 [I] Progress on: 959it/1.00kit rate:8.8s/it remaining:06:00 elapsed:2:21:50 postfix:- (511966:tqdm_logging.py:145)
Step 960: grad_norm=1.8077338933944702, loss=0.1878235787153244, param_norm=1887.124267578125
12:09:25.526 [I] Progress on: 960it/1.00kit rate:9.4s/it remaining:06:14 elapsed:2:22:01 postfix:- (511966:tqdm_logging.py:145)
Step 961: grad_norm=2.1063175201416016, loss=0.21871134638786316, param_norm=1887.1243896484375
Step 962: grad_norm=1.8886809349060059, loss=0.18086203932762146, param_norm=1887.1243896484375
12:09:43.195 [I] Progress on: 962it/1.00kit rate:9.1s/it remaining:05:45 elapsed:2:22:19 postfix:- (511966:tqdm_logging.py:145)
Step 963: grad_norm=3.124601125717163, loss=0.215889573097229, param_norm=1887.1243896484375
Step 964: grad_norm=3.0374555587768555, loss=0.19768521189689636, param_norm=1887.1243896484375
12:10:00.860 [I] Progress on: 964it/1.00kit rate:9.0s/it remaining:05:22 elapsed:2:22:37 postfix:- (511966:tqdm_logging.py:145)
Step 965: grad_norm=2.510498523712158, loss=0.21419760584831238, param_norm=1887.1243896484375
Step 966: grad_norm=2.9105567932128906, loss=0.20198610424995422, param_norm=1887.1243896484375
12:10:18.538 [I] Progress on: 966it/1.00kit rate:8.9s/it remaining:05:02 elapsed:2:22:54 postfix:- (511966:tqdm_logging.py:145)
Step 967: grad_norm=2.309401035308838, loss=0.1960633397102356, param_norm=1887.1243896484375
Step 968: grad_norm=2.6050360202789307, loss=0.24376490712165833, param_norm=1887.12451171875
12:10:36.195 [I] Progress on: 968it/1.00kit rate:8.9s/it remaining:04:43 elapsed:2:23:12 postfix:- (511966:tqdm_logging.py:145)
Step 969: grad_norm=2.248011350631714, loss=0.20892030000686646, param_norm=1887.12451171875
Step 970: grad_norm=1.821344017982483, loss=0.1791965216398239, param_norm=1887.12451171875
12:10:53.856 [I] Progress on: 970it/1.00kit rate:8.9s/it remaining:04:25 elapsed:2:23:30 postfix:- (511966:tqdm_logging.py:145)
Step 971: grad_norm=2.3643813133239746, loss=0.19710662961006165, param_norm=1887.12451171875
Step 972: grad_norm=2.0356802940368652, loss=0.196766197681427, param_norm=1887.12451171875
12:11:11.489 [I] Progress on: 972it/1.00kit rate:8.8s/it remaining:04:07 elapsed:2:23:47 postfix:- (511966:tqdm_logging.py:145)
Step 973: grad_norm=2.0626931190490723, loss=0.1878947764635086, param_norm=1887.12451171875
Step 974: grad_norm=2.296114683151245, loss=0.18321000039577484, param_norm=1887.12451171875
12:11:29.160 [I] Progress on: 974it/1.00kit rate:8.8s/it remaining:03:49 elapsed:2:24:05 postfix:- (511966:tqdm_logging.py:145)
Step 975: grad_norm=1.782971978187561, loss=0.1777050495147705, param_norm=1887.12451171875
Step 976: grad_norm=2.7037177085876465, loss=0.22247116267681122, param_norm=1887.12451171875
12:11:46.792 [I] Progress on: 976it/1.00kit rate:8.8s/it remaining:03:31 elapsed:2:24:22 postfix:- (511966:tqdm_logging.py:145)
Step 977: grad_norm=2.2417430877685547, loss=0.20676249265670776, param_norm=1887.12451171875
Step 978: grad_norm=1.944762945175171, loss=0.18361784517765045, param_norm=1887.12451171875
12:12:04.438 [I] Progress on: 978it/1.00kit rate:8.8s/it remaining:03:14 elapsed:2:24:40 postfix:- (511966:tqdm_logging.py:145)
Step 979: grad_norm=2.29533052444458, loss=0.19831286370754242, param_norm=1887.12451171875
Step 980: grad_norm=2.664379596710205, loss=0.20894643664360046, param_norm=1887.12451171875
12:12:22.082 [I] Progress on: 980it/1.00kit rate:8.8s/it remaining:02:56 elapsed:2:24:58 postfix:- (511966:tqdm_logging.py:145)
Step 981: grad_norm=2.2581562995910645, loss=0.20468752086162567, param_norm=1887.12451171875
Step 982: grad_norm=2.715245485305786, loss=0.19920796155929565, param_norm=1887.12451171875
12:12:39.715 [I] Progress on: 982it/1.00kit rate:8.8s/it remaining:02:38 elapsed:2:25:15 postfix:- (511966:tqdm_logging.py:145)
Step 983: grad_norm=2.2906320095062256, loss=0.18757957220077515, param_norm=1887.12451171875
Step 984: grad_norm=2.3030266761779785, loss=0.1926293969154358, param_norm=1887.12451171875
12:12:57.340 [I] Progress on: 984it/1.00kit rate:8.8s/it remaining:02:21 elapsed:2:25:33 postfix:- (511966:tqdm_logging.py:145)
Step 985: grad_norm=2.2948851585388184, loss=0.2173522710800171, param_norm=1887.12451171875
Step 986: grad_norm=2.378513813018799, loss=0.21803557872772217, param_norm=1887.1246337890625
12:13:14.966 [I] Progress on: 986it/1.00kit rate:8.8s/it remaining:02:03 elapsed:2:25:51 postfix:- (511966:tqdm_logging.py:145)
Step 987: grad_norm=1.740708589553833, loss=0.16616375744342804, param_norm=1887.1246337890625
Step 988: grad_norm=2.286665916442871, loss=0.16215431690216064, param_norm=1887.1246337890625
12:13:32.587 [I] Progress on: 988it/1.00kit rate:8.8s/it remaining:01:45 elapsed:2:26:08 postfix:- (511966:tqdm_logging.py:145)
Step 989: grad_norm=1.9291794300079346, loss=0.18557706475257874, param_norm=1887.1246337890625
Step 990: grad_norm=2.1937077045440674, loss=0.20778384804725647, param_norm=1887.1246337890625
12:13:50.360 [I] Progress on: 990it/1.00kit rate:8.8s/it remaining:01:28 elapsed:2:26:26 postfix:- (511966:tqdm_logging.py:145)
Step 991: grad_norm=2.0407724380493164, loss=0.20986178517341614, param_norm=1887.1246337890625
Step 992: grad_norm=2.197401762008667, loss=0.1959109753370285, param_norm=1887.1246337890625
12:14:08.025 [I] Progress on: 992it/1.00kit rate:8.8s/it remaining:01:10 elapsed:2:26:44 postfix:- (511966:tqdm_logging.py:145)
Step 993: grad_norm=1.9677315950393677, loss=0.19098186492919922, param_norm=1887.1246337890625
Step 994: grad_norm=1.8904250860214233, loss=0.22094260156154633, param_norm=1887.1246337890625
12:14:25.659 [I] Progress on: 994it/1.00kit rate:8.8s/it remaining:00:52 elapsed:2:27:01 postfix:- (511966:tqdm_logging.py:145)
Step 995: grad_norm=2.458338975906372, loss=0.23719212412834167, param_norm=1887.124755859375
Step 996: grad_norm=2.077159881591797, loss=0.19357562065124512, param_norm=1887.124755859375
12:14:43.277 [I] Progress on: 996it/1.00kit rate:8.8s/it remaining:00:35 elapsed:2:27:19 postfix:- (511966:tqdm_logging.py:145)
Step 997: grad_norm=2.5307586193084717, loss=0.24161045253276825, param_norm=1887.124755859375
Step 998: grad_norm=2.691288948059082, loss=0.233072429895401, param_norm=1887.124755859375
12:15:00.915 [I] Progress on: 998it/1.00kit rate:8.8s/it remaining:00:17 elapsed:2:27:37 postfix:- (511966:tqdm_logging.py:145)
Step 999: grad_norm=2.490582227706909, loss=0.1991977095603943, param_norm=1887.124755859375
12:15:09.939 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
12:15:09.940 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
12:15:09.940 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (511966:checkpoint_manager.py:1786)
12:15:09.940 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (511966:checkpoint_manager.py:1817)
12:15:09.940 [I] [process=0] Saving checkpoint at step 999                                        (511966:checkpoint_manager.py:1286)
12:15:09.941 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999. (511966:async_checkpointer.py:358)
12:15:09.942 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
12:15:09.943 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27 (511966:atomicity.py:144)
12:15:09.943 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
12:15:09.944 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (511966:multihost.py:293)
12:15:09.945 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (511966:atomicity.py:144)
12:15:09.945 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (511966:atomicity.py:144)
12:15:09.945 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (511966:multihost.py:293)
12:15:09.950 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (511966:replica_slices.py:419)
12:15:13.507 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (511966:tensorstore_utils.py:371)
12:15:13.508 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
12:15:13.509 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (511966:tensorstore_utils.py:371)
12:15:13.513 [I] [process=0][thread=async_save] Background save thread started.                   (511966:async_checkpointer.py:121)
12:15:13.535 [I] Preserving Checkpoint[step=100 | time=2025-04-08 14:02:27.082091+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.537 [I] Preserving Checkpoint[step=200 | time=2025-04-08 14:17:16.495359+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.541 [I] Preserving Checkpoint[step=300 | time=2025-04-08 14:32:00.472191+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.541 [I] Preserving Checkpoint[step=400 | time=2025-04-08 14:46:46.765787+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.543 [I] Preserving Checkpoint[step=500 | time=2025-04-08 15:01:33.643456+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.543 [I] Preserving Checkpoint[step=600 | time=2025-04-08 15:16:18.712963+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.545 [I] Preserving Checkpoint[step=700 | time=2025-04-08 15:31:01.239810+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.553 [I] Preserving Checkpoint[step=800 | time=2025-04-08 15:45:47.230288+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.553 [I] Preserving Checkpoint[step=900 | time=2025-04-08 16:00:35.510743+00:00 | is_locked=None]: (Reason: on keep_period=100). (511966:checkpoint_manager.py:1734)
12:15:13.556 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (511966:multihost.py:293)
12:15:13.558 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (511966:checkpoint_manager.py:1328)
12:15:13.560 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (511966:async_checkpointer.py:231)
12:15:13.561 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1744128909.9398437, 'wait_for_prev_duration_secs': 0.0007169246673583984, 'checkpointer_blocking_start_time': 1744128909.9410546, 'checkpointer_blocking_duration_secs': 3.5941011905670166, 'get_old_steps_start_time': 1744128913.5352092, 'get_old_steps_duration_secs': 0.021119356155395508, 'checkpoint_manager_blocking_start_time': 1744128909.939709, 'checkpoint_manager_blocking_duration_secs': 3.621494770050049} (511966:standard_logger.py:34)
12:15:13.574 [I] Progress on: 1.00kit/1.00kit rate:9.9s/it remaining:00:00 elapsed:2:27:49 postfix:- (511966:tqdm_logging.py:145)
12:15:13.575 [I] Progress on: 1.00kit/1.00kit rate:9.9s/it remaining:00:00 elapsed:2:27:49 postfix:- (511966:tqdm_logging.py:145)
12:15:13.576 [I] Waiting for checkpoint manager to finish                                         (511966:train_pi0_fast_regent.py:301)
12:15:13.578 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (511966:checkpoint_manager.py:1759)
12:15:13.580 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (511966:checkpoint_manager.py:1777)
12:15:20.341 [I] ChainedFuture completed 1/1 futures in 6.82 seconds.                             (511966:future.py:137)
12:15:20.342 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 996.6 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (511966:base_pytree_checkpoint_handler.py:113)
12:15:20.342 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (511966:async_checkpointer.py:131)
12:15:20.344 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f01253e7cd0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27 (511966:async_checkpointer.py:406)
12:15:20.344 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27/assets (511966:atomicity.py:287)
12:15:20.354 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27/params (511966:atomicity.py:287)
12:15:20.355 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999 (511966:async_checkpointer.py:416)
12:15:20.355 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27 (511966:async_checkpointer.py:426)
12:15:20.356 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999 (511966:atomicity.py:287)
12:15:20.357 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_lever/1st_try_regent_lever/999`. (511966:atomicity.py:548)
12:15:20.358 [I] [process=0][thread=async_save] Background save thread done.                      (511966:async_checkpointer.py:183)
12:15:20.358 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (511966:async_checkpointer.py:239)
12:15:20.359 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (511966:async_checkpointer.py:249)
12:15:20.359 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (511966:checkpoint_manager.py:1890)
12:15:20.359 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (511966:checkpoint_manager.py:1905)
12:15:20.360 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (511966:checkpoint_manager.py:1786)
12:15:20.360 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (511966:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_regent_lever[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/0sr7xknk[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250408_094632-0sr7xknk/logs[0m
