nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
22:15:46.299 [I] Running on: ivy                                                                  (3484008:train_pi0_fast_regent.py:226)
INFO:2025-03-23 22:15:47,066:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
22:15:47.066 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (3484008:xla_bridge.py:945)
INFO:2025-03-23 22:15:47,067:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
22:15:47.067 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (3484008:xla_bridge.py:945)
22:15:48.057 [I] Wiped checkpoint directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball (3484008:checkpoints.py:25)
22:15:48.058 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3484008:base_pytree_checkpoint_handler.py:332)
22:15:48.058 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3484008:base_pytree_checkpoint_handler.py:332)
22:15:48.058 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (3484008:multihost.py:375)
22:15:48.059 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7f7314b67190>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314900ad0>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314858f90>}, handler_registry=None (3484008:checkpoint_manager.py:622)
22:15:48.059 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7f7314b67190>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (3484008:composite_checkpoint_handler.py:239)
22:15:48.059 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314900ad0>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3484008:composite_checkpoint_handler.py:239)
22:15:48.059 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314858f90>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3484008:composite_checkpoint_handler.py:239)
22:15:48.059 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f73149fb290>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (3484008:composite_checkpoint_handler.py:239)
22:15:48.060 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f7314b67190>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7f7314b67190>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314900ad0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314900ad0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314858f90>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7f7314858f90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f73149fb290>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f73149fb290>}). (3484008:composite_checkpoint_handler.py:508)
22:15:48.060 [I] orbax-checkpoint version: 0.11.1                                                 (3484008:abstract_checkpointer.py:35)
22:15:48.060 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f7314b2efc0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (3484008:async_checkpointer.py:80)
22:15:48.061 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball (3484008:checkpoint_manager.py:1528)
22:15:48.061 [I] Saving root metadata                                                             (3484008:checkpoint_manager.py:1569)
22:15:48.061 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (3484008:multihost.py:293)
22:15:48.061 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f73149f9690> (3484008:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250323_221548-jaaidde2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 1st_try_regent_pokeball
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/jaaidde2
Some kwargs in processor config are unused and will not have any effect: min_token, scale, action_dim, vocab_size, time_horizon. 
Some kwargs in processor config are unused and will not have any effect: min_token, scale, action_dim, vocab_size, time_horizon. 
22:15:51.096 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/droid (3484008:config.py:167)
count_droid: 0, count_collected_demos: 1108
len_dataset: 1108
all 20 episode prompts are the same: pick up the poke ball and put it in the tray
22:16:15.046 [I] Initialized data loader:
[0].query_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].query_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].query_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].query_image_masks['base_0_rgb']: (16,)@bool
[0].query_image_masks['base_1_rgb']: (16,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].exp_lamda_distances: (16, 5, 1)@float32
[0].query_state: (16, 8)@float32
[0].retrieved_0_state: (16, 8)@float32
[0].retrieved_1_state: (16, 8)@float32
[0].retrieved_2_state: (16, 8)@float32
[0].retrieved_3_state: (16, 8)@float32
[0].query_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_prefix: (16, 125)@int32
[0].query_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_postfix: (16, 125)@int32
[0].query_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_0_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_1_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_2_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_3_tokenized_prompt_mask: (16, 250)@bool
[0].query_token_ar_mask: (16, 250)@int32
[0].retrieved_0_token_ar_mask: (16, 250)@int32
[0].retrieved_1_token_ar_mask: (16, 250)@int32
[0].retrieved_2_token_ar_mask: (16, 250)@int32
[0].retrieved_3_token_ar_mask: (16, 250)@int32
[0].query_token_loss_mask: (16, 250)@bool
[0].retrieved_0_token_loss_mask: (16, 250)@bool
[0].retrieved_1_token_loss_mask: (16, 250)@bool
[0].retrieved_2_token_loss_mask: (16, 250)@bool
[0].retrieved_3_token_loss_mask: (16, 250)@bool
[1]: (16, 15, 8)@float32 (3484008:train_pi0_fast_regent.py:258)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
22:16:16.390 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3484008:base_pytree_checkpoint_handler.py:332)
22:16:16.420 [I] Restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (3484008:checkpointer.py:256)
22:16:31.823 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 672.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 15 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
22:16:31.824 [I] Finished restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (3484008:checkpointer.py:259)
22:16:31.824 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (3484008:multihost.py:293)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
2025-03-23 22:16:35.427509: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 30.69GiB (32957682654 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
22:16:37.654 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (3484008:train_pi0_fast_regent.py:262)
decode_indices shape: (1245,)
22:16:37.747 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:00 postfix:-                   (3484008:tqdm_logging.py:145)
first_targets shape: (16, 125, 257152)
input_token_embeddings shape: (16, 5090, 2048)
attn_mask shape: (16, 5090, 5090)
loss_mask shape: (16, 249)
targets shape: (16, 249, 257152)
pre_logits shape: (16, 5089, 2048)
logits shape: (16, 249, 257152)
new_logits shape: (16, 249, 257152)
logp shape: (16, 249, 257152)
token_pplx shape: (16, 249)
loss shape: (16,)
Step 0: grad_norm=17.359312057495117, loss=4.503760814666748, param_norm=1886.9476318359375
22:16:56.345 [I] Progress on: -/1000 rate:- remaining:? elapsed:00:18 postfix:-                   (3484008:tqdm_logging.py:145)
Step 1: grad_norm=12.591771125793457, loss=3.7288219928741455, param_norm=1886.9476318359375
Step 2: grad_norm=10.91232967376709, loss=3.572413921356201, param_norm=1886.9476318359375
22:17:13.518 [I] Progress on: 2.00it/1.00kit rate:12.8s/it remaining:3:32:40 elapsed:00:35 postfix:- (3484008:tqdm_logging.py:145)
Step 3: grad_norm=10.12385082244873, loss=3.579873561859131, param_norm=1886.9476318359375
Step 4: grad_norm=14.463150978088379, loss=3.7384250164031982, param_norm=1886.947509765625
22:17:30.772 [I] Progress on: 4.00it/1.00kit rate:10.0s/it remaining:2:45:45 elapsed:00:53 postfix:- (3484008:tqdm_logging.py:145)
Step 5: grad_norm=12.474493980407715, loss=4.07280969619751, param_norm=1886.947509765625
Step 6: grad_norm=8.664877891540527, loss=3.6987273693084717, param_norm=1886.9473876953125
22:17:48.134 [I] Progress on: 6.00it/1.00kit rate:9.2s/it remaining:2:32:49 elapsed:01:10 postfix:- (3484008:tqdm_logging.py:145)
Step 7: grad_norm=10.479289054870605, loss=3.5206496715545654, param_norm=1886.9473876953125
Step 8: grad_norm=11.862122535705566, loss=3.092031478881836, param_norm=1886.947265625
22:18:05.589 [I] Progress on: 8.00it/1.00kit rate:9.0s/it remaining:2:28:02 elapsed:01:27 postfix:- (3484008:tqdm_logging.py:145)
Step 9: grad_norm=8.151997566223145, loss=3.678605079650879, param_norm=1886.947265625
Step 10: grad_norm=6.676815986633301, loss=3.472080707550049, param_norm=1886.9471435546875
22:18:23.140 [I] Progress on: 10.0it/1.00kit rate:8.9s/it remaining:2:26:04 elapsed:01:45 postfix:- (3484008:tqdm_logging.py:145)
Step 11: grad_norm=6.402171611785889, loss=3.0600857734680176, param_norm=1886.947021484375
Step 12: grad_norm=6.476511001586914, loss=3.1136436462402344, param_norm=1886.947021484375
22:18:40.768 [I] Progress on: 12.0it/1.00kit rate:8.8s/it remaining:2:25:23 elapsed:02:03 postfix:- (3484008:tqdm_logging.py:145)
Step 13: grad_norm=6.090893268585205, loss=3.0221710205078125, param_norm=1886.9468994140625
Step 14: grad_norm=7.419186592102051, loss=3.331929922103882, param_norm=1886.9468994140625
22:18:58.420 [I] Progress on: 14.0it/1.00kit rate:8.8s/it remaining:2:25:03 elapsed:02:20 postfix:- (3484008:tqdm_logging.py:145)
Step 15: grad_norm=9.230602264404297, loss=3.182802677154541, param_norm=1886.94677734375
Step 16: grad_norm=4.99884033203125, loss=3.1785378456115723, param_norm=1886.94677734375
22:19:16.139 [I] Progress on: 16.0it/1.00kit rate:8.8s/it remaining:2:25:04 elapsed:02:38 postfix:- (3484008:tqdm_logging.py:145)
Step 17: grad_norm=4.979180812835693, loss=3.0808024406433105, param_norm=1886.94677734375
Step 18: grad_norm=8.644203186035156, loss=3.1692190170288086, param_norm=1886.9466552734375
22:19:33.837 [I] Progress on: 18.0it/1.00kit rate:8.9s/it remaining:2:24:55 elapsed:02:56 postfix:- (3484008:tqdm_logging.py:145)
Step 19: grad_norm=13.922208786010742, loss=2.985393762588501, param_norm=1886.9466552734375
Step 20: grad_norm=6.9568867683410645, loss=2.9219045639038086, param_norm=1886.9466552734375
22:19:51.620 [I] Progress on: 20.0it/1.00kit rate:8.9s/it remaining:2:25:00 elapsed:03:13 postfix:- (3484008:tqdm_logging.py:145)
Step 21: grad_norm=9.392939567565918, loss=3.044787645339966, param_norm=1886.9466552734375
22:20:03.391 [I] Progress on: 22.0it/1.00kit rate:9.6s/it remaining:2:36:26 elapsed:03:25 postfix:- (3484008:tqdm_logging.py:145)
Step 22: grad_norm=4.937397003173828, loss=2.985551357269287, param_norm=1886.9466552734375
22:20:16.315 [I] Progress on: 23.0it/1.00kit rate:10.6s/it remaining:2:52:29 elapsed:03:38 postfix:- (3484008:tqdm_logging.py:145)
Step 23: grad_norm=4.566370964050293, loss=3.083221673965454, param_norm=1886.94677734375
22:20:27.673 [I] Progress on: 24.0it/1.00kit rate:10.8s/it remaining:2:56:05 elapsed:03:49 postfix:- (3484008:tqdm_logging.py:145)
Step 24: grad_norm=4.85029935836792, loss=3.074497938156128, param_norm=1886.94677734375
22:21:13.283 [I] Progress on: 25.0it/1.00kit rate:21.3s/it remaining:5:45:30 elapsed:04:35 postfix:- (3484008:tqdm_logging.py:145)
Step 25: grad_norm=16.362974166870117, loss=2.960707187652588, param_norm=1886.94677734375
Step 26: grad_norm=10.843670845031738, loss=2.9542369842529297, param_norm=1886.9468994140625
22:21:30.479 [I] Progress on: 26.0it/1.00kit rate:17.5s/it remaining:4:43:57 elapsed:04:52 postfix:- (3484008:tqdm_logging.py:145)
Step 27: grad_norm=10.773914337158203, loss=2.920409679412842, param_norm=1886.947021484375
Step 28: grad_norm=5.533844470977783, loss=2.707533836364746, param_norm=1886.947021484375
22:21:47.913 [I] Progress on: 28.0it/1.00kit rate:13.0s/it remaining:3:30:37 elapsed:05:10 postfix:- (3484008:tqdm_logging.py:145)
Step 29: grad_norm=4.133935451507568, loss=3.0214622020721436, param_norm=1886.9471435546875
Step 30: grad_norm=4.983226776123047, loss=2.9851293563842773, param_norm=1886.9471435546875
22:22:05.431 [I] Progress on: 30.0it/1.00kit rate:10.8s/it remaining:2:55:02 elapsed:05:27 postfix:- (3484008:tqdm_logging.py:145)
Step 31: grad_norm=7.636559009552002, loss=2.444149971008301, param_norm=1886.9471435546875
Step 32: grad_norm=12.535107612609863, loss=2.7969799041748047, param_norm=1886.947265625
22:22:23.072 [I] Progress on: 32.0it/1.00kit rate:9.8s/it remaining:2:38:00 elapsed:05:45 postfix:- (3484008:tqdm_logging.py:145)
Step 33: grad_norm=5.792048454284668, loss=2.9302632808685303, param_norm=1886.9473876953125
Step 34: grad_norm=7.4709320068359375, loss=2.7945663928985596, param_norm=1886.947509765625
22:22:40.735 [I] Progress on: 34.0it/1.00kit rate:9.3s/it remaining:2:29:40 elapsed:06:02 postfix:- (3484008:tqdm_logging.py:145)
Step 35: grad_norm=5.536972522735596, loss=2.9411091804504395, param_norm=1886.947509765625
Step 36: grad_norm=4.425167560577393, loss=3.001220226287842, param_norm=1886.9476318359375
22:22:58.495 [I] Progress on: 36.0it/1.00kit rate:9.1s/it remaining:2:25:45 elapsed:06:20 postfix:- (3484008:tqdm_logging.py:145)
Step 37: grad_norm=11.401235580444336, loss=2.4269466400146484, param_norm=1886.9478759765625
Step 38: grad_norm=12.984285354614258, loss=2.9998576641082764, param_norm=1886.9478759765625
22:23:16.290 [I] Progress on: 38.0it/1.00kit rate:9.0s/it remaining:2:24:09 elapsed:06:38 postfix:- (3484008:tqdm_logging.py:145)
Step 39: grad_norm=4.393791198730469, loss=2.548776626586914, param_norm=1886.9481201171875
Step 40: grad_norm=10.265318870544434, loss=2.379692554473877, param_norm=1886.9483642578125
22:23:33.979 [I] Progress on: 40.0it/1.00kit rate:8.9s/it remaining:2:22:45 elapsed:06:56 postfix:- (3484008:tqdm_logging.py:145)
Step 41: grad_norm=6.265693187713623, loss=2.7845497131347656, param_norm=1886.9486083984375
Step 42: grad_norm=9.770219802856445, loss=2.951164722442627, param_norm=1886.94873046875
22:23:51.648 [I] Progress on: 42.0it/1.00kit rate:8.9s/it remaining:2:21:47 elapsed:07:13 postfix:- (3484008:tqdm_logging.py:145)
Step 43: grad_norm=12.877503395080566, loss=2.665207624435425, param_norm=1886.948974609375
Step 44: grad_norm=5.717596054077148, loss=2.685786008834839, param_norm=1886.94921875
22:24:09.294 [I] Progress on: 44.0it/1.00kit rate:8.9s/it remaining:2:21:01 elapsed:07:31 postfix:- (3484008:tqdm_logging.py:145)
Step 45: grad_norm=8.701769828796387, loss=2.8291778564453125, param_norm=1886.9493408203125
Step 46: grad_norm=5.308974266052246, loss=2.5085997581481934, param_norm=1886.94970703125
22:24:26.851 [I] Progress on: 46.0it/1.00kit rate:8.8s/it remaining:2:20:12 elapsed:07:49 postfix:- (3484008:tqdm_logging.py:145)
Step 47: grad_norm=4.891666889190674, loss=2.5189716815948486, param_norm=1886.949951171875
Step 48: grad_norm=10.008408546447754, loss=2.800611972808838, param_norm=1886.9501953125
22:24:44.430 [I] Progress on: 48.0it/1.00kit rate:8.8s/it remaining:2:19:40 elapsed:08:06 postfix:- (3484008:tqdm_logging.py:145)
Step 49: grad_norm=4.614656925201416, loss=2.8229587078094482, param_norm=1886.9505615234375
Step 50: grad_norm=5.401963233947754, loss=2.732633113861084, param_norm=1886.9508056640625
22:25:01.972 [I] Progress on: 50.0it/1.00kit rate:8.8s/it remaining:2:19:10 elapsed:08:24 postfix:- (3484008:tqdm_logging.py:145)
Step 51: grad_norm=6.474575042724609, loss=2.8057966232299805, param_norm=1886.9510498046875
Step 52: grad_norm=5.47707986831665, loss=2.5814809799194336, param_norm=1886.951416015625
22:25:19.516 [I] Progress on: 52.0it/1.00kit rate:8.8s/it remaining:2:18:42 elapsed:08:41 postfix:- (3484008:tqdm_logging.py:145)
Step 53: grad_norm=6.046580791473389, loss=2.5497050285339355, param_norm=1886.9517822265625
Step 54: grad_norm=6.845953464508057, loss=2.8651299476623535, param_norm=1886.9521484375
22:25:37.147 [I] Progress on: 54.0it/1.00kit rate:8.8s/it remaining:2:18:42 elapsed:08:59 postfix:- (3484008:tqdm_logging.py:145)
Step 55: grad_norm=11.062042236328125, loss=2.465799331665039, param_norm=1886.9525146484375
Step 56: grad_norm=5.054062843322754, loss=2.908216953277588, param_norm=1886.9530029296875
22:25:54.648 [I] Progress on: 56.0it/1.00kit rate:8.8s/it remaining:2:18:04 elapsed:09:16 postfix:- (3484008:tqdm_logging.py:145)
Step 57: grad_norm=7.130034446716309, loss=2.624575138092041, param_norm=1886.9532470703125
Step 58: grad_norm=4.4616007804870605, loss=2.5257060527801514, param_norm=1886.95361328125
22:26:12.224 [I] Progress on: 58.0it/1.00kit rate:8.8s/it remaining:2:17:49 elapsed:09:34 postfix:- (3484008:tqdm_logging.py:145)
Step 59: grad_norm=11.36876392364502, loss=2.69952130317688, param_norm=1886.953857421875
Step 60: grad_norm=9.527119636535645, loss=2.8007724285125732, param_norm=1886.9542236328125
22:26:29.725 [I] Progress on: 60.0it/1.00kit rate:8.8s/it remaining:2:17:15 elapsed:09:51 postfix:- (3484008:tqdm_logging.py:145)
Step 61: grad_norm=9.09347915649414, loss=2.691546678543091, param_norm=1886.9547119140625
Step 62: grad_norm=5.985841274261475, loss=2.509396553039551, param_norm=1886.9549560546875
22:26:47.216 [I] Progress on: 62.0it/1.00kit rate:8.8s/it remaining:2:16:51 elapsed:10:09 postfix:- (3484008:tqdm_logging.py:145)
Step 63: grad_norm=8.878957748413086, loss=2.551461696624756, param_norm=1886.955322265625
Step 64: grad_norm=12.887675285339355, loss=2.775784492492676, param_norm=1886.95556640625
22:27:04.722 [I] Progress on: 64.0it/1.00kit rate:8.8s/it remaining:2:16:31 elapsed:10:26 postfix:- (3484008:tqdm_logging.py:145)
Step 65: grad_norm=11.270159721374512, loss=2.774474620819092, param_norm=1886.9559326171875
Step 66: grad_norm=6.690370082855225, loss=2.7507834434509277, param_norm=1886.9561767578125
22:27:22.197 [I] Progress on: 66.0it/1.00kit rate:8.7s/it remaining:2:16:08 elapsed:10:44 postfix:- (3484008:tqdm_logging.py:145)
Step 67: grad_norm=4.853825569152832, loss=2.618086814880371, param_norm=1886.9564208984375
Step 68: grad_norm=19.65361976623535, loss=2.3901848793029785, param_norm=1886.956787109375
22:27:39.660 [I] Progress on: 68.0it/1.00kit rate:8.7s/it remaining:2:15:43 elapsed:11:01 postfix:- (3484008:tqdm_logging.py:145)
Step 69: grad_norm=5.569466590881348, loss=2.0238540172576904, param_norm=1886.9571533203125
22:27:50.813 [I] Progress on: 69.0it/1.00kit rate:9.5s/it remaining:2:26:55 elapsed:11:13 postfix:- (3484008:tqdm_logging.py:145)
Step 70: grad_norm=4.545692443847656, loss=2.0611205101013184, param_norm=1886.9576416015625
Step 71: grad_norm=8.13385009765625, loss=2.34788179397583, param_norm=1886.9580078125
22:28:08.265 [I] Progress on: 71.0it/1.00kit rate:9.1s/it remaining:2:20:44 elapsed:11:30 postfix:- (3484008:tqdm_logging.py:145)
Step 72: grad_norm=12.54079818725586, loss=2.197627067565918, param_norm=1886.9583740234375
Step 73: grad_norm=6.327426910400391, loss=1.9892100095748901, param_norm=1886.958740234375
22:28:25.784 [I] Progress on: 73.0it/1.00kit rate:8.9s/it remaining:2:17:47 elapsed:11:48 postfix:- (3484008:tqdm_logging.py:145)
Step 74: grad_norm=9.327792167663574, loss=2.3556504249572754, param_norm=1886.9591064453125
Step 75: grad_norm=5.370891094207764, loss=2.520421028137207, param_norm=1886.95947265625
22:28:43.248 [I] Progress on: 75.0it/1.00kit rate:8.8s/it remaining:2:16:01 elapsed:12:05 postfix:- (3484008:tqdm_logging.py:145)
Step 76: grad_norm=8.858647346496582, loss=2.3410305976867676, param_norm=1886.9598388671875
Step 77: grad_norm=7.4541168212890625, loss=1.9687647819519043, param_norm=1886.960205078125
22:29:00.717 [I] Progress on: 77.0it/1.00kit rate:8.8s/it remaining:2:14:59 elapsed:12:22 postfix:- (3484008:tqdm_logging.py:145)
Step 78: grad_norm=5.610446453094482, loss=2.3176889419555664, param_norm=1886.960693359375
Step 79: grad_norm=7.023301601409912, loss=2.3303329944610596, param_norm=1886.9610595703125
22:29:18.335 [I] Progress on: 79.0it/1.00kit rate:8.8s/it remaining:2:14:57 elapsed:12:40 postfix:- (3484008:tqdm_logging.py:145)
Step 80: grad_norm=6.015970230102539, loss=2.2143616676330566, param_norm=1886.96142578125
Step 81: grad_norm=9.004823684692383, loss=1.8245233297348022, param_norm=1886.9617919921875
22:29:35.820 [I] Progress on: 81.0it/1.00kit rate:8.8s/it remaining:2:14:15 elapsed:12:58 postfix:- (3484008:tqdm_logging.py:145)
Step 82: grad_norm=5.22020959854126, loss=2.189696788787842, param_norm=1886.9622802734375
Step 83: grad_norm=6.065496444702148, loss=2.55765962600708, param_norm=1886.962646484375
22:29:53.430 [I] Progress on: 83.0it/1.00kit rate:8.8s/it remaining:2:13:53 elapsed:13:15 postfix:- (3484008:tqdm_logging.py:145)
Step 84: grad_norm=13.01015567779541, loss=2.2724180221557617, param_norm=1886.9630126953125
Step 85: grad_norm=10.08885383605957, loss=2.3235526084899902, param_norm=1886.9635009765625
22:30:10.923 [I] Progress on: 85.0it/1.00kit rate:8.8s/it remaining:2:13:47 elapsed:13:33 postfix:- (3484008:tqdm_logging.py:145)
Step 86: grad_norm=6.622470855712891, loss=2.2013444900512695, param_norm=1886.9639892578125
Step 87: grad_norm=7.928618431091309, loss=2.2170910835266113, param_norm=1886.9644775390625
22:30:28.440 [I] Progress on: 87.0it/1.00kit rate:8.8s/it remaining:2:13:23 elapsed:13:50 postfix:- (3484008:tqdm_logging.py:145)
Step 88: grad_norm=10.286297798156738, loss=2.51956844329834, param_norm=1886.9647216796875
Step 89: grad_norm=5.4674577713012695, loss=2.174790859222412, param_norm=1886.9652099609375
22:30:45.928 [I] Progress on: 89.0it/1.00kit rate:8.8s/it remaining:2:12:53 elapsed:14:08 postfix:- (3484008:tqdm_logging.py:145)
Step 90: grad_norm=5.3788743019104, loss=2.4691097736358643, param_norm=1886.965576171875
Step 91: grad_norm=5.510523319244385, loss=2.442023754119873, param_norm=1886.9659423828125
22:31:03.451 [I] Progress on: 91.0it/1.00kit rate:8.8s/it remaining:2:12:37 elapsed:14:25 postfix:- (3484008:tqdm_logging.py:145)
Step 92: grad_norm=7.980599880218506, loss=2.461304187774658, param_norm=1886.96630859375
Step 93: grad_norm=14.202614784240723, loss=2.339536190032959, param_norm=1886.966796875
22:31:21.005 [I] Progress on: 93.0it/1.00kit rate:8.8s/it remaining:2:12:30 elapsed:14:43 postfix:- (3484008:tqdm_logging.py:145)
Step 94: grad_norm=9.533355712890625, loss=2.18355655670166, param_norm=1886.9671630859375
Step 95: grad_norm=17.24617576599121, loss=2.108940839767456, param_norm=1886.9676513671875
22:31:38.568 [I] Progress on: 95.0it/1.00kit rate:8.8s/it remaining:2:12:23 elapsed:15:00 postfix:- (3484008:tqdm_logging.py:145)
Step 96: grad_norm=11.400224685668945, loss=2.434701442718506, param_norm=1886.968017578125
Step 97: grad_norm=6.743887424468994, loss=2.5747580528259277, param_norm=1886.9683837890625
22:31:56.118 [I] Progress on: 97.0it/1.00kit rate:8.8s/it remaining:2:12:02 elapsed:15:18 postfix:- (3484008:tqdm_logging.py:145)
Step 98: grad_norm=6.540090084075928, loss=2.199563980102539, param_norm=1886.96875
Step 99: grad_norm=6.703158855438232, loss=2.208010673522949, param_norm=1886.9691162109375
22:32:13.642 [I] Progress on: 99.0it/1.00kit rate:8.8s/it remaining:2:11:41 elapsed:15:35 postfix:- (3484008:tqdm_logging.py:145)
Step 100: grad_norm=11.877634048461914, loss=2.2669596672058105, param_norm=1886.969482421875
22:32:22.583 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
22:32:22.584 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (3484008:checkpoint_manager.py:1767)
22:32:22.585 [I] [process=0] Saving checkpoint at step 100                                        (3484008:checkpoint_manager.py:1286)
22:32:22.586 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100. (3484008:async_checkpointer.py:358)
22:32:22.589 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
22:32:22.590 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0 (3484008:atomicity.py:144)
22:32:22.592 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
22:32:22.593 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
22:32:22.594 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742783542591615936, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742783542591615936, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3484008:checkpoint.py:185)
22:32:22.595 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (3484008:atomicity.py:144)
22:32:22.596 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (3484008:atomicity.py:144)
22:32:22.597 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
22:32:22.612 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
22:32:29.625 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 7 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
22:32:29.637 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
22:32:29.640 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
22:32:29.641 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
22:32:29.653 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
22:32:29.657 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
22:32:29.664 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
22:32:29.671 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742783542.583872, 'wait_for_prev_duration_secs': 0.0006730556488037109, 'checkpointer_blocking_start_time': 1742783542.5858514, 'checkpointer_blocking_duration_secs': 7.0669286251068115, 'get_old_steps_start_time': 1742783549.6531181, 'get_old_steps_duration_secs': 5.936622619628906e-05, 'checkpoint_manager_blocking_start_time': 1742783542.5835297, 'checkpoint_manager_blocking_duration_secs': 7.0870585441589355} (3484008:standard_logger.py:34)
22:32:29.676 [I] Progress on: 101it/1.00kit rate:10.9s/it remaining:2:43:12 elapsed:15:51 postfix:- (3484008:tqdm_logging.py:145)
Step 101: grad_norm=8.153799057006836, loss=2.296898365020752, param_norm=1886.9698486328125
22:32:39.547 [I] ChainedFuture completed 1/1 futures in 9.90 seconds.                             (3484008:future.py:137)
22:32:39.548 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 611.3 MiB/s (total bytes: 10.1 GiB) (time elapsed: 16 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
22:32:39.548 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
22:32:39.549 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742783542591615936, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3484008:checkpoint.py:225)
22:32:39.551 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0 (3484008:async_checkpointer.py:406)
22:32:39.552 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/assets (3484008:atomicity.py:287)
22:32:39.556 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742783542591615936, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3484008:checkpoint.py:244)
22:32:39.566 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0/params (3484008:atomicity.py:287)
22:32:39.567 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100 (3484008:async_checkpointer.py:416)
22:32:39.567 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0 (3484008:async_checkpointer.py:426)
22:32:39.567 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100 (3484008:atomicity.py:287)
22:32:39.569 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/100`. (3484008:atomicity.py:548)
22:32:39.569 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
22:32:39.570 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
22:32:39.570 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
22:32:39.571 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
22:32:39.571 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 102: grad_norm=11.648715019226074, loss=2.3511438369750977, param_norm=1886.9703369140625
22:32:47.132 [I] Progress on: 102it/1.00kit rate:10.3s/it remaining:2:33:59 elapsed:16:09 postfix:- (3484008:tqdm_logging.py:145)
Step 103: grad_norm=5.8667311668396, loss=2.39473819732666, param_norm=1886.970703125
Step 104: grad_norm=15.804452896118164, loss=2.4076087474823, param_norm=1886.9710693359375
22:33:04.635 [I] Progress on: 104it/1.00kit rate:9.5s/it remaining:2:21:55 elapsed:16:26 postfix:- (3484008:tqdm_logging.py:145)
Step 105: grad_norm=8.563549995422363, loss=2.417499542236328, param_norm=1886.9715576171875
Step 106: grad_norm=11.312264442443848, loss=2.228987216949463, param_norm=1886.971923828125
22:33:22.157 [I] Progress on: 106it/1.00kit rate:9.1s/it remaining:2:15:57 elapsed:16:44 postfix:- (3484008:tqdm_logging.py:145)
Step 107: grad_norm=5.310613632202148, loss=2.203207015991211, param_norm=1886.9722900390625
Step 108: grad_norm=18.721717834472656, loss=2.4267003536224365, param_norm=1886.9727783203125
22:33:39.791 [I] Progress on: 108it/1.00kit rate:9.0s/it remaining:2:13:18 elapsed:17:02 postfix:- (3484008:tqdm_logging.py:145)
Step 109: grad_norm=18.98197364807129, loss=2.2538793087005615, param_norm=1886.97314453125
Step 110: grad_norm=12.47279167175293, loss=2.0638604164123535, param_norm=1886.9735107421875
22:33:57.279 [I] Progress on: 110it/1.00kit rate:8.9s/it remaining:2:11:22 elapsed:17:19 postfix:- (3484008:tqdm_logging.py:145)
Step 111: grad_norm=12.704532623291016, loss=2.336197853088379, param_norm=1886.973876953125
Step 112: grad_norm=6.09872579574585, loss=2.2111129760742188, param_norm=1886.97412109375
22:34:14.820 [I] Progress on: 112it/1.00kit rate:8.8s/it remaining:2:10:24 elapsed:17:37 postfix:- (3484008:tqdm_logging.py:145)
Step 113: grad_norm=7.337894916534424, loss=2.3123438358306885, param_norm=1886.9744873046875
Step 114: grad_norm=17.314077377319336, loss=2.158229351043701, param_norm=1886.974853515625
22:34:32.289 [I] Progress on: 114it/1.00kit rate:8.8s/it remaining:2:09:31 elapsed:17:54 postfix:- (3484008:tqdm_logging.py:145)
Step 115: grad_norm=10.997139930725098, loss=2.3132853507995605, param_norm=1886.97509765625
Step 116: grad_norm=7.569234848022461, loss=2.304029941558838, param_norm=1886.9755859375
22:34:49.830 [I] Progress on: 116it/1.00kit rate:8.8s/it remaining:2:09:12 elapsed:18:12 postfix:- (3484008:tqdm_logging.py:145)
Step 117: grad_norm=11.5630521774292, loss=2.414907455444336, param_norm=1886.97607421875
Step 118: grad_norm=11.480507850646973, loss=2.3472471237182617, param_norm=1886.9764404296875
22:35:07.362 [I] Progress on: 118it/1.00kit rate:8.8s/it remaining:2:08:53 elapsed:18:29 postfix:- (3484008:tqdm_logging.py:145)
Step 119: grad_norm=5.255356788635254, loss=2.1850087642669678, param_norm=1886.976806640625
Step 120: grad_norm=9.973114013671875, loss=2.0657529830932617, param_norm=1886.9771728515625
22:35:24.941 [I] Progress on: 120it/1.00kit rate:8.8s/it remaining:2:08:44 elapsed:18:47 postfix:- (3484008:tqdm_logging.py:145)
Step 121: grad_norm=9.843918800354004, loss=2.24007511138916, param_norm=1886.9776611328125
Step 122: grad_norm=14.587056159973145, loss=2.301846981048584, param_norm=1886.97802734375
22:35:42.465 [I] Progress on: 122it/1.00kit rate:8.8s/it remaining:2:08:19 elapsed:19:04 postfix:- (3484008:tqdm_logging.py:145)
Step 123: grad_norm=14.863260269165039, loss=2.232262372970581, param_norm=1886.9783935546875
Step 124: grad_norm=11.571775436401367, loss=2.3116977214813232, param_norm=1886.9786376953125
22:36:00.018 [I] Progress on: 124it/1.00kit rate:8.8s/it remaining:2:08:03 elapsed:19:22 postfix:- (3484008:tqdm_logging.py:145)
Step 125: grad_norm=7.295466899871826, loss=2.4319605827331543, param_norm=1886.97900390625
Step 126: grad_norm=16.14071273803711, loss=2.352046012878418, param_norm=1886.9793701171875
22:36:17.521 [I] Progress on: 126it/1.00kit rate:8.8s/it remaining:2:07:36 elapsed:19:39 postfix:- (3484008:tqdm_logging.py:145)
Step 127: grad_norm=12.891908645629883, loss=2.301654577255249, param_norm=1886.9796142578125
Step 128: grad_norm=6.559805870056152, loss=2.3511509895324707, param_norm=1886.979736328125
22:36:35.043 [I] Progress on: 128it/1.00kit rate:8.8s/it remaining:2:07:16 elapsed:19:57 postfix:- (3484008:tqdm_logging.py:145)
Step 129: grad_norm=6.103527545928955, loss=2.2285618782043457, param_norm=1886.9801025390625
Step 130: grad_norm=21.154922485351562, loss=2.552593946456909, param_norm=1886.9803466796875
22:36:52.557 [I] Progress on: 130it/1.00kit rate:8.8s/it remaining:2:07:00 elapsed:20:14 postfix:- (3484008:tqdm_logging.py:145)
Step 131: grad_norm=19.110437393188477, loss=2.153201103210449, param_norm=1886.980712890625
Step 132: grad_norm=19.423336029052734, loss=2.4754581451416016, param_norm=1886.9810791015625
22:37:10.140 [I] Progress on: 132it/1.00kit rate:8.8s/it remaining:2:06:56 elapsed:20:32 postfix:- (3484008:tqdm_logging.py:145)
Step 133: grad_norm=9.323885917663574, loss=2.18176531791687, param_norm=1886.9814453125
Step 134: grad_norm=6.6216535568237305, loss=2.434262275695801, param_norm=1886.981689453125
22:37:27.691 [I] Progress on: 134it/1.00kit rate:8.8s/it remaining:2:06:40 elapsed:20:49 postfix:- (3484008:tqdm_logging.py:145)
Step 135: grad_norm=7.022043704986572, loss=2.245525360107422, param_norm=1886.9820556640625
Step 136: grad_norm=6.360466957092285, loss=2.4107651710510254, param_norm=1886.982421875
22:37:45.309 [I] Progress on: 136it/1.00kit rate:8.8s/it remaining:2:06:40 elapsed:21:07 postfix:- (3484008:tqdm_logging.py:145)
Step 137: grad_norm=18.47829246520996, loss=2.4465954303741455, param_norm=1886.9827880859375
22:37:56.456 [I] Progress on: 138it/1.00kit rate:9.4s/it remaining:2:15:45 elapsed:21:18 postfix:- (3484008:tqdm_logging.py:145)
Step 138: grad_norm=24.07961082458496, loss=2.1416757106781006, param_norm=1886.9830322265625
Step 139: grad_norm=17.243335723876953, loss=2.0013084411621094, param_norm=1886.9833984375
22:38:13.801 [I] Progress on: 139it/1.00kit rate:9.2s/it remaining:2:12:32 elapsed:21:36 postfix:- (3484008:tqdm_logging.py:145)
Step 140: grad_norm=9.97028636932373, loss=1.7844511270523071, param_norm=1886.9837646484375
Step 141: grad_norm=10.507447242736816, loss=1.9858839511871338, param_norm=1886.984130859375
22:38:31.327 [I] Progress on: 141it/1.00kit rate:9.0s/it remaining:2:08:44 elapsed:21:53 postfix:- (3484008:tqdm_logging.py:145)
Step 142: grad_norm=16.153270721435547, loss=2.1482181549072266, param_norm=1886.9844970703125
Step 143: grad_norm=6.394702434539795, loss=2.0828030109405518, param_norm=1886.98486328125
22:38:48.878 [I] Progress on: 143it/1.00kit rate:8.9s/it remaining:2:06:50 elapsed:22:11 postfix:- (3484008:tqdm_logging.py:145)
Step 144: grad_norm=11.073705673217773, loss=1.9697178602218628, param_norm=1886.9852294921875
Step 145: grad_norm=5.885644912719727, loss=2.0293805599212646, param_norm=1886.985595703125
22:39:06.440 [I] Progress on: 145it/1.00kit rate:8.8s/it remaining:2:05:48 elapsed:22:28 postfix:- (3484008:tqdm_logging.py:145)
Step 146: grad_norm=16.36651611328125, loss=1.97006356716156, param_norm=1886.9859619140625
Step 147: grad_norm=5.035102367401123, loss=1.7302312850952148, param_norm=1886.986328125
22:39:24.028 [I] Progress on: 147it/1.00kit rate:8.8s/it remaining:2:05:17 elapsed:22:46 postfix:- (3484008:tqdm_logging.py:145)
Step 148: grad_norm=13.903054237365723, loss=1.7540923357009888, param_norm=1886.9866943359375
Step 149: grad_norm=13.149913787841797, loss=1.9588558673858643, param_norm=1886.9871826171875
22:39:41.620 [I] Progress on: 149it/1.00kit rate:8.8s/it remaining:2:04:51 elapsed:23:03 postfix:- (3484008:tqdm_logging.py:145)
Step 150: grad_norm=23.050352096557617, loss=1.7681456804275513, param_norm=1886.987548828125
Step 151: grad_norm=6.751385688781738, loss=1.8446812629699707, param_norm=1886.9879150390625
22:39:59.244 [I] Progress on: 151it/1.00kit rate:8.8s/it remaining:2:04:39 elapsed:23:21 postfix:- (3484008:tqdm_logging.py:145)
Step 152: grad_norm=15.549538612365723, loss=2.1557505130767822, param_norm=1886.9884033203125
Step 153: grad_norm=9.274308204650879, loss=2.0814805030822754, param_norm=1886.98876953125
22:40:16.781 [I] Progress on: 153it/1.00kit rate:8.8s/it remaining:2:04:03 elapsed:23:39 postfix:- (3484008:tqdm_logging.py:145)
Step 154: grad_norm=5.113890171051025, loss=1.8479371070861816, param_norm=1886.9892578125
Step 155: grad_norm=14.07138442993164, loss=1.987940788269043, param_norm=1886.9896240234375
22:40:34.304 [I] Progress on: 155it/1.00kit rate:8.8s/it remaining:2:03:34 elapsed:23:56 postfix:- (3484008:tqdm_logging.py:145)
Step 156: grad_norm=5.089278221130371, loss=1.788331151008606, param_norm=1886.9901123046875
Step 157: grad_norm=11.737850189208984, loss=2.038381576538086, param_norm=1886.990478515625
22:40:51.987 [I] Progress on: 157it/1.00kit rate:8.8s/it remaining:2:03:43 elapsed:24:14 postfix:- (3484008:tqdm_logging.py:145)
Step 158: grad_norm=12.200467109680176, loss=2.0381505489349365, param_norm=1886.9908447265625
Step 159: grad_norm=7.785197734832764, loss=1.894468903541565, param_norm=1886.9913330078125
22:41:09.569 [I] Progress on: 159it/1.00kit rate:8.8s/it remaining:2:03:20 elapsed:24:31 postfix:- (3484008:tqdm_logging.py:145)
Step 160: grad_norm=5.313929557800293, loss=2.1498818397521973, param_norm=1886.9918212890625
Step 161: grad_norm=6.3639140129089355, loss=1.8276252746582031, param_norm=1886.9921875
22:41:27.184 [I] Progress on: 161it/1.00kit rate:8.8s/it remaining:2:03:04 elapsed:24:49 postfix:- (3484008:tqdm_logging.py:145)
Step 162: grad_norm=10.976282119750977, loss=1.8384075164794922, param_norm=1886.9925537109375
Step 163: grad_norm=7.220658302307129, loss=2.0952091217041016, param_norm=1886.992919921875
22:41:44.801 [I] Progress on: 163it/1.00kit rate:8.8s/it remaining:2:02:50 elapsed:25:07 postfix:- (3484008:tqdm_logging.py:145)
Step 164: grad_norm=5.886687755584717, loss=1.9785237312316895, param_norm=1886.993408203125
Step 165: grad_norm=4.806744575500488, loss=1.8251290321350098, param_norm=1886.9937744140625
22:42:02.482 [I] Progress on: 165it/1.00kit rate:8.8s/it remaining:2:02:44 elapsed:25:24 postfix:- (3484008:tqdm_logging.py:145)
Step 166: grad_norm=5.249563694000244, loss=1.9305431842803955, param_norm=1886.9942626953125
Step 167: grad_norm=6.73203706741333, loss=2.0551493167877197, param_norm=1886.9947509765625
22:42:20.152 [I] Progress on: 167it/1.00kit rate:8.8s/it remaining:2:02:32 elapsed:25:42 postfix:- (3484008:tqdm_logging.py:145)
Step 168: grad_norm=6.45400857925415, loss=2.041262149810791, param_norm=1886.9951171875
Step 169: grad_norm=9.893519401550293, loss=1.740311622619629, param_norm=1886.99560546875
22:42:37.783 [I] Progress on: 169it/1.00kit rate:8.8s/it remaining:2:02:09 elapsed:26:00 postfix:- (3484008:tqdm_logging.py:145)
Step 170: grad_norm=7.356943607330322, loss=1.6789950132369995, param_norm=1886.9959716796875
Step 171: grad_norm=6.872811317443848, loss=1.9277507066726685, param_norm=1886.996337890625
22:42:55.427 [I] Progress on: 171it/1.00kit rate:8.8s/it remaining:2:01:51 elapsed:26:17 postfix:- (3484008:tqdm_logging.py:145)
Step 172: grad_norm=6.249750137329102, loss=1.9614994525909424, param_norm=1886.996826171875
Step 173: grad_norm=7.421590328216553, loss=1.8840676546096802, param_norm=1886.9971923828125
22:43:13.059 [I] Progress on: 173it/1.00kit rate:8.8s/it remaining:2:01:32 elapsed:26:35 postfix:- (3484008:tqdm_logging.py:145)
Step 174: grad_norm=6.552208423614502, loss=2.028216600418091, param_norm=1886.997802734375
Step 175: grad_norm=6.561563968658447, loss=1.7576161623001099, param_norm=1886.998291015625
22:43:30.748 [I] Progress on: 175it/1.00kit rate:8.8s/it remaining:2:01:27 elapsed:26:53 postfix:- (3484008:tqdm_logging.py:145)
Step 176: grad_norm=5.519667148590088, loss=1.872955322265625, param_norm=1886.9986572265625
Step 177: grad_norm=10.03384017944336, loss=1.9979571104049683, param_norm=1886.9990234375
22:43:48.450 [I] Progress on: 177it/1.00kit rate:8.8s/it remaining:2:01:15 elapsed:27:10 postfix:- (3484008:tqdm_logging.py:145)
Step 178: grad_norm=16.660186767578125, loss=2.1239676475524902, param_norm=1886.99951171875
Step 179: grad_norm=6.173167705535889, loss=1.7555749416351318, param_norm=1887.0
22:44:06.122 [I] Progress on: 179it/1.00kit rate:8.8s/it remaining:2:00:56 elapsed:27:28 postfix:- (3484008:tqdm_logging.py:145)
Step 180: grad_norm=9.300751686096191, loss=1.965885043144226, param_norm=1887.0003662109375
Step 181: grad_norm=9.157160758972168, loss=1.908453345298767, param_norm=1887.000732421875
22:44:23.776 [I] Progress on: 181it/1.00kit rate:8.8s/it remaining:2:00:34 elapsed:27:46 postfix:- (3484008:tqdm_logging.py:145)
Step 182: grad_norm=15.429214477539062, loss=2.029853105545044, param_norm=1887.001220703125
Step 183: grad_norm=8.99221420288086, loss=1.773622989654541, param_norm=1887.0015869140625
22:44:41.424 [I] Progress on: 183it/1.00kit rate:8.8s/it remaining:2:00:12 elapsed:28:03 postfix:- (3484008:tqdm_logging.py:145)
Step 184: grad_norm=10.134239196777344, loss=1.8377878665924072, param_norm=1887.001953125
Step 185: grad_norm=11.336386680603027, loss=2.2354979515075684, param_norm=1887.00244140625
22:44:59.067 [I] Progress on: 185it/1.00kit rate:8.8s/it remaining:1:59:52 elapsed:28:21 postfix:- (3484008:tqdm_logging.py:145)
Step 186: grad_norm=32.900840759277344, loss=2.144028663635254, param_norm=1887.002685546875
Step 187: grad_norm=9.786849975585938, loss=2.033926486968994, param_norm=1887.0030517578125
22:45:16.736 [I] Progress on: 187it/1.00kit rate:8.8s/it remaining:1:59:36 elapsed:28:38 postfix:- (3484008:tqdm_logging.py:145)
Step 188: grad_norm=12.138779640197754, loss=1.9882704019546509, param_norm=1887.0032958984375
Step 189: grad_norm=12.255012512207031, loss=2.039795398712158, param_norm=1887.0035400390625
22:45:34.407 [I] Progress on: 189it/1.00kit rate:8.8s/it remaining:1:59:22 elapsed:28:56 postfix:- (3484008:tqdm_logging.py:145)
Step 190: grad_norm=15.281961441040039, loss=1.898060917854309, param_norm=1887.0037841796875
Step 191: grad_norm=15.814715385437012, loss=2.0163731575012207, param_norm=1887.004150390625
22:45:52.060 [I] Progress on: 191it/1.00kit rate:8.8s/it remaining:1:59:03 elapsed:29:14 postfix:- (3484008:tqdm_logging.py:145)
Step 192: grad_norm=33.507568359375, loss=2.0591988563537598, param_norm=1887.00439453125
Step 193: grad_norm=7.038434028625488, loss=1.7466237545013428, param_norm=1887.004638671875
22:46:09.719 [I] Progress on: 193it/1.00kit rate:8.8s/it remaining:1:58:45 elapsed:29:31 postfix:- (3484008:tqdm_logging.py:145)
Step 194: grad_norm=7.691147327423096, loss=1.9833922386169434, param_norm=1887.0050048828125
Step 195: grad_norm=8.819263458251953, loss=2.0198373794555664, param_norm=1887.0052490234375
22:46:27.383 [I] Progress on: 195it/1.00kit rate:8.8s/it remaining:1:58:27 elapsed:29:49 postfix:- (3484008:tqdm_logging.py:145)
Step 196: grad_norm=5.032357215881348, loss=1.9196040630340576, param_norm=1887.005615234375
Step 197: grad_norm=12.778968811035156, loss=1.8224818706512451, param_norm=1887.0059814453125
22:46:45.022 [I] Progress on: 197it/1.00kit rate:8.8s/it remaining:1:58:07 elapsed:30:07 postfix:- (3484008:tqdm_logging.py:145)
Step 198: grad_norm=18.078266143798828, loss=2.1438403129577637, param_norm=1887.00634765625
Step 199: grad_norm=6.067256450653076, loss=1.9616036415100098, param_norm=1887.006591796875
22:47:02.646 [I] Progress on: 199it/1.00kit rate:8.8s/it remaining:1:57:46 elapsed:30:24 postfix:- (3484008:tqdm_logging.py:145)
Step 200: grad_norm=7.92028284072876, loss=1.8044366836547852, param_norm=1887.0069580078125
22:47:11.689 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
22:47:11.689 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
22:47:11.689 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (3484008:checkpoint_manager.py:1786)
22:47:11.690 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (3484008:checkpoint_manager.py:1817)
22:47:11.690 [I] [process=0] Saving checkpoint at step 200                                        (3484008:checkpoint_manager.py:1286)
22:47:11.691 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200. (3484008:async_checkpointer.py:358)
22:47:11.692 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
22:47:11.692 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3 (3484008:atomicity.py:144)
22:47:11.693 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
22:47:11.694 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
22:47:11.695 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (3484008:atomicity.py:144)
22:47:11.695 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (3484008:atomicity.py:144)
22:47:11.696 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
22:47:11.700 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
22:47:15.487 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
22:47:15.488 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
22:47:15.490 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
22:47:15.491 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
22:47:15.513 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
22:47:15.514 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
22:47:15.531 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
22:47:15.532 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
22:47:15.533 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742784431.6893756, 'wait_for_prev_duration_secs': 0.0007185935974121094, 'checkpointer_blocking_start_time': 1742784431.6907065, 'checkpointer_blocking_duration_secs': 3.8223235607147217, 'get_old_steps_start_time': 1742784435.5130918, 'get_old_steps_duration_secs': 0.0017397403717041016, 'checkpoint_manager_blocking_start_time': 1742784431.689176, 'checkpoint_manager_blocking_duration_secs': 3.84452486038208} (3484008:standard_logger.py:34)
22:47:15.534 [I] Progress on: 201it/1.00kit rate:10.0s/it remaining:2:12:50 elapsed:30:37 postfix:- (3484008:tqdm_logging.py:145)
22:47:22.920 [I] ChainedFuture completed 1/1 futures in 7.41 seconds.                             (3484008:future.py:137)
22:47:22.920 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 923.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
22:47:22.920 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
22:47:22.921 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3 (3484008:async_checkpointer.py:406)
22:47:22.922 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3/assets (3484008:atomicity.py:287)
22:47:22.935 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3/params (3484008:atomicity.py:287)
22:47:22.936 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200 (3484008:async_checkpointer.py:416)
22:47:22.936 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3 (3484008:async_checkpointer.py:426)
22:47:22.937 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200 (3484008:atomicity.py:287)
22:47:22.939 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/200`. (3484008:atomicity.py:548)
22:47:22.940 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
22:47:22.940 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
22:47:22.941 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
22:47:22.942 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
22:47:22.942 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 201: grad_norm=14.164463996887207, loss=1.9730949401855469, param_norm=1887.0074462890625
Step 202: grad_norm=7.758147716522217, loss=1.9900846481323242, param_norm=1887.0076904296875
22:47:32.955 [I] Progress on: 202it/1.00kit rate:9.6s/it remaining:2:08:03 elapsed:30:55 postfix:- (3484008:tqdm_logging.py:145)
Step 203: grad_norm=5.382383823394775, loss=1.7225332260131836, param_norm=1887.008056640625
Step 204: grad_norm=6.754506587982178, loss=1.7400901317596436, param_norm=1887.0084228515625
22:47:50.585 [I] Progress on: 204it/1.00kit rate:9.2s/it remaining:2:02:14 elapsed:31:12 postfix:- (3484008:tqdm_logging.py:145)
Step 205: grad_norm=17.409761428833008, loss=1.8124428987503052, param_norm=1887.0087890625
Step 206: grad_norm=10.991965293884277, loss=1.909380555152893, param_norm=1887.009033203125
22:48:08.203 [I] Progress on: 206it/1.00kit rate:9.0s/it remaining:1:59:12 elapsed:31:30 postfix:- (3484008:tqdm_logging.py:145)
Step 207: grad_norm=6.6572041511535645, loss=1.4526928663253784, param_norm=1887.009521484375
22:48:19.196 [I] Progress on: 207it/1.00kit rate:9.6s/it remaining:2:06:56 elapsed:31:41 postfix:- (3484008:tqdm_logging.py:145)
Step 208: grad_norm=10.23847770690918, loss=1.514100432395935, param_norm=1887.0098876953125
Step 209: grad_norm=20.141130447387695, loss=1.850234031677246, param_norm=1887.01025390625
22:48:36.877 [I] Progress on: 209it/1.00kit rate:9.2s/it remaining:2:01:24 elapsed:31:59 postfix:- (3484008:tqdm_logging.py:145)
Step 210: grad_norm=15.663738250732422, loss=1.978421926498413, param_norm=1887.0106201171875
Step 211: grad_norm=6.8855085372924805, loss=1.8128349781036377, param_norm=1887.010986328125
22:48:54.524 [I] Progress on: 211it/1.00kit rate:9.0s/it remaining:1:58:29 elapsed:32:16 postfix:- (3484008:tqdm_logging.py:145)
Step 212: grad_norm=9.116830825805664, loss=1.6504497528076172, param_norm=1887.0113525390625
Step 213: grad_norm=7.236478805541992, loss=1.3046962022781372, param_norm=1887.0118408203125
22:49:12.146 [I] Progress on: 213it/1.00kit rate:8.9s/it remaining:1:56:52 elapsed:32:34 postfix:- (3484008:tqdm_logging.py:145)
Step 214: grad_norm=16.18613624572754, loss=1.52079176902771, param_norm=1887.01220703125
Step 215: grad_norm=11.239171981811523, loss=1.7333476543426514, param_norm=1887.0125732421875
22:49:29.786 [I] Progress on: 215it/1.00kit rate:8.9s/it remaining:1:55:55 elapsed:32:52 postfix:- (3484008:tqdm_logging.py:145)
Step 216: grad_norm=9.120067596435547, loss=1.6209938526153564, param_norm=1887.012939453125
Step 217: grad_norm=8.42050552368164, loss=1.6678516864776611, param_norm=1887.01318359375
22:49:47.428 [I] Progress on: 217it/1.00kit rate:8.8s/it remaining:1:55:21 elapsed:33:09 postfix:- (3484008:tqdm_logging.py:145)
Step 218: grad_norm=12.857057571411133, loss=1.5885443687438965, param_norm=1887.0135498046875
Step 219: grad_norm=8.24367618560791, loss=1.7673468589782715, param_norm=1887.013916015625
22:50:05.070 [I] Progress on: 219it/1.00kit rate:8.8s/it remaining:1:54:57 elapsed:33:27 postfix:- (3484008:tqdm_logging.py:145)
Step 220: grad_norm=6.968536853790283, loss=1.7763164043426514, param_norm=1887.0142822265625
Step 221: grad_norm=5.5037431716918945, loss=1.4959888458251953, param_norm=1887.0145263671875
22:50:22.700 [I] Progress on: 221it/1.00kit rate:8.8s/it remaining:1:54:31 elapsed:33:44 postfix:- (3484008:tqdm_logging.py:145)
Step 222: grad_norm=5.870216369628906, loss=1.7514660358428955, param_norm=1887.014892578125
Step 223: grad_norm=9.62774658203125, loss=1.5598359107971191, param_norm=1887.0152587890625
22:50:40.353 [I] Progress on: 223it/1.00kit rate:8.8s/it remaining:1:54:15 elapsed:34:02 postfix:- (3484008:tqdm_logging.py:145)
Step 224: grad_norm=8.398167610168457, loss=1.4456677436828613, param_norm=1887.0155029296875
Step 225: grad_norm=6.212403774261475, loss=1.723745584487915, param_norm=1887.015869140625
22:50:57.989 [I] Progress on: 225it/1.00kit rate:8.8s/it remaining:1:53:57 elapsed:34:20 postfix:- (3484008:tqdm_logging.py:145)
Step 226: grad_norm=7.568455219268799, loss=1.4327600002288818, param_norm=1887.0162353515625
Step 227: grad_norm=8.70205020904541, loss=1.7475440502166748, param_norm=1887.0166015625
22:51:15.633 [I] Progress on: 227it/1.00kit rate:8.8s/it remaining:1:53:40 elapsed:34:37 postfix:- (3484008:tqdm_logging.py:145)
Step 228: grad_norm=6.964660167694092, loss=1.7508347034454346, param_norm=1887.0169677734375
Step 229: grad_norm=11.47940444946289, loss=1.648577332496643, param_norm=1887.017333984375
22:51:33.287 [I] Progress on: 229it/1.00kit rate:8.8s/it remaining:1:53:21 elapsed:34:55 postfix:- (3484008:tqdm_logging.py:145)
Step 230: grad_norm=6.349099159240723, loss=1.8704005479812622, param_norm=1887.017578125
Step 231: grad_norm=8.779362678527832, loss=1.6495769023895264, param_norm=1887.017822265625
22:51:50.928 [I] Progress on: 231it/1.00kit rate:8.8s/it remaining:1:53:05 elapsed:35:13 postfix:- (3484008:tqdm_logging.py:145)
Step 232: grad_norm=6.008040904998779, loss=1.732788324356079, param_norm=1887.018310546875
Step 233: grad_norm=5.304325103759766, loss=1.5169156789779663, param_norm=1887.0186767578125
22:52:08.567 [I] Progress on: 233it/1.00kit rate:8.8s/it remaining:1:52:43 elapsed:35:30 postfix:- (3484008:tqdm_logging.py:145)
Step 234: grad_norm=6.106603145599365, loss=1.6230731010437012, param_norm=1887.01904296875
Step 235: grad_norm=11.275270462036133, loss=1.7806403636932373, param_norm=1887.01953125
22:52:26.205 [I] Progress on: 235it/1.00kit rate:8.8s/it remaining:1:52:27 elapsed:35:48 postfix:- (3484008:tqdm_logging.py:145)
Step 236: grad_norm=11.690421104431152, loss=1.7838470935821533, param_norm=1887.02001953125
Step 237: grad_norm=8.645069122314453, loss=1.5712920427322388, param_norm=1887.0203857421875
22:52:43.836 [I] Progress on: 237it/1.00kit rate:8.8s/it remaining:1:52:08 elapsed:36:06 postfix:- (3484008:tqdm_logging.py:145)
Step 238: grad_norm=15.599897384643555, loss=1.6771247386932373, param_norm=1887.020751953125
Step 239: grad_norm=14.45639705657959, loss=1.7462948560714722, param_norm=1887.0211181640625
22:53:01.473 [I] Progress on: 239it/1.00kit rate:8.8s/it remaining:1:51:48 elapsed:36:23 postfix:- (3484008:tqdm_logging.py:145)
Step 240: grad_norm=11.869036674499512, loss=1.7370588779449463, param_norm=1887.021484375
Step 241: grad_norm=7.868936538696289, loss=1.923553705215454, param_norm=1887.0218505859375
22:53:19.101 [I] Progress on: 241it/1.00kit rate:8.8s/it remaining:1:51:31 elapsed:36:41 postfix:- (3484008:tqdm_logging.py:145)
Step 242: grad_norm=6.980470180511475, loss=1.5784310102462769, param_norm=1887.0220947265625
Step 243: grad_norm=7.203638076782227, loss=1.7360212802886963, param_norm=1887.0224609375
22:53:36.751 [I] Progress on: 243it/1.00kit rate:8.8s/it remaining:1:51:16 elapsed:36:59 postfix:- (3484008:tqdm_logging.py:145)
Step 244: grad_norm=7.912607669830322, loss=1.4857566356658936, param_norm=1887.0228271484375
Step 245: grad_norm=6.230358600616455, loss=1.500812292098999, param_norm=1887.023193359375
22:53:54.380 [I] Progress on: 245it/1.00kit rate:8.8s/it remaining:1:50:56 elapsed:37:16 postfix:- (3484008:tqdm_logging.py:145)
Step 246: grad_norm=12.555269241333008, loss=1.629481315612793, param_norm=1887.0235595703125
Step 247: grad_norm=5.474762916564941, loss=1.7968494892120361, param_norm=1887.02392578125
22:54:12.005 [I] Progress on: 247it/1.00kit rate:8.8s/it remaining:1:50:36 elapsed:37:34 postfix:- (3484008:tqdm_logging.py:145)
Step 248: grad_norm=8.05732536315918, loss=1.8109129667282104, param_norm=1887.0242919921875
Step 249: grad_norm=5.9239301681518555, loss=1.4428938627243042, param_norm=1887.024658203125
22:54:29.644 [I] Progress on: 249it/1.00kit rate:8.8s/it remaining:1:50:21 elapsed:37:51 postfix:- (3484008:tqdm_logging.py:145)
Step 250: grad_norm=6.25641393661499, loss=1.4833943843841553, param_norm=1887.025146484375
Step 251: grad_norm=11.76196002960205, loss=1.7635595798492432, param_norm=1887.0255126953125
22:54:47.298 [I] Progress on: 251it/1.00kit rate:8.8s/it remaining:1:50:07 elapsed:38:09 postfix:- (3484008:tqdm_logging.py:145)
Step 252: grad_norm=11.455405235290527, loss=1.5946872234344482, param_norm=1887.02587890625
Step 253: grad_norm=8.109447479248047, loss=1.3918395042419434, param_norm=1887.0262451171875
22:55:04.988 [I] Progress on: 253it/1.00kit rate:8.8s/it remaining:1:49:55 elapsed:38:27 postfix:- (3484008:tqdm_logging.py:145)
Step 254: grad_norm=6.717854022979736, loss=1.647212028503418, param_norm=1887.026611328125
Step 255: grad_norm=6.576849460601807, loss=1.4759957790374756, param_norm=1887.0269775390625
22:55:22.604 [I] Progress on: 255it/1.00kit rate:8.8s/it remaining:1:49:25 elapsed:38:44 postfix:- (3484008:tqdm_logging.py:145)
Step 256: grad_norm=6.62031364440918, loss=1.626554250717163, param_norm=1887.0274658203125
Step 257: grad_norm=5.9750847816467285, loss=1.658874273300171, param_norm=1887.02783203125
22:55:40.250 [I] Progress on: 257it/1.00kit rate:8.8s/it remaining:1:49:14 elapsed:39:02 postfix:- (3484008:tqdm_logging.py:145)
Step 258: grad_norm=7.122623443603516, loss=1.738556146621704, param_norm=1887.0281982421875
Step 259: grad_norm=14.932247161865234, loss=1.7609784603118896, param_norm=1887.028564453125
22:55:57.839 [I] Progress on: 259it/1.00kit rate:8.8s/it remaining:1:48:46 elapsed:39:20 postfix:- (3484008:tqdm_logging.py:145)
Step 260: grad_norm=6.706399440765381, loss=1.8403923511505127, param_norm=1887.029052734375
Step 261: grad_norm=7.203826427459717, loss=1.6143555641174316, param_norm=1887.0294189453125
22:56:15.483 [I] Progress on: 261it/1.00kit rate:8.8s/it remaining:1:48:33 elapsed:39:37 postfix:- (3484008:tqdm_logging.py:145)
Step 262: grad_norm=7.858466148376465, loss=1.6384804248809814, param_norm=1887.02978515625
Step 263: grad_norm=6.043312072753906, loss=1.586296558380127, param_norm=1887.030029296875
22:56:33.178 [I] Progress on: 263it/1.00kit rate:8.8s/it remaining:1:48:27 elapsed:39:55 postfix:- (3484008:tqdm_logging.py:145)
Step 264: grad_norm=9.747604370117188, loss=1.7385790348052979, param_norm=1887.0303955078125
Step 265: grad_norm=13.44027328491211, loss=1.953526496887207, param_norm=1887.0306396484375
22:56:50.780 [I] Progress on: 265it/1.00kit rate:8.8s/it remaining:1:48:00 elapsed:40:13 postfix:- (3484008:tqdm_logging.py:145)
Step 266: grad_norm=17.468002319335938, loss=1.6436715126037598, param_norm=1887.0308837890625
Step 267: grad_norm=15.648563385009766, loss=1.7726267576217651, param_norm=1887.03125
22:57:08.487 [I] Progress on: 267it/1.00kit rate:8.8s/it remaining:1:47:52 elapsed:40:30 postfix:- (3484008:tqdm_logging.py:145)
Step 268: grad_norm=6.433926582336426, loss=1.690059781074524, param_norm=1887.031494140625
Step 269: grad_norm=16.32038688659668, loss=1.7630232572555542, param_norm=1887.03173828125
22:57:26.175 [I] Progress on: 269it/1.00kit rate:8.8s/it remaining:1:47:41 elapsed:40:48 postfix:- (3484008:tqdm_logging.py:145)
Step 270: grad_norm=10.271077156066895, loss=1.7148149013519287, param_norm=1887.0322265625
Step 271: grad_norm=10.58879280090332, loss=1.6455037593841553, param_norm=1887.032470703125
22:57:43.774 [I] Progress on: 271it/1.00kit rate:8.8s/it remaining:1:47:10 elapsed:41:06 postfix:- (3484008:tqdm_logging.py:145)
Step 272: grad_norm=9.5654935836792, loss=1.7131614685058594, param_norm=1887.032958984375
Step 273: grad_norm=5.42595100402832, loss=1.654847264289856, param_norm=1887.033203125
22:58:01.480 [I] Progress on: 273it/1.00kit rate:8.8s/it remaining:1:47:03 elapsed:41:23 postfix:- (3484008:tqdm_logging.py:145)
Step 274: grad_norm=10.805218696594238, loss=1.7803868055343628, param_norm=1887.03369140625
Step 275: grad_norm=11.801953315734863, loss=1.5965157747268677, param_norm=1887.033935546875
22:58:19.155 [I] Progress on: 275it/1.00kit rate:8.8s/it remaining:1:46:47 elapsed:41:41 postfix:- (3484008:tqdm_logging.py:145)
Step 276: grad_norm=14.790308952331543, loss=1.2346172332763672, param_norm=1887.0343017578125
22:58:30.289 [I] Progress on: 276it/1.00kit rate:9.5s/it remaining:1:55:00 elapsed:41:52 postfix:- (3484008:tqdm_logging.py:145)
Step 277: grad_norm=5.312173843383789, loss=1.4341415166854858, param_norm=1887.0345458984375
Step 278: grad_norm=5.5729498863220215, loss=1.3114244937896729, param_norm=1887.034912109375
22:58:47.876 [I] Progress on: 278it/1.00kit rate:9.2s/it remaining:1:50:14 elapsed:42:10 postfix:- (3484008:tqdm_logging.py:145)
Step 279: grad_norm=5.8021416664123535, loss=1.2931554317474365, param_norm=1887.0352783203125
Step 280: grad_norm=8.081563949584961, loss=1.351349115371704, param_norm=1887.03564453125
22:59:05.540 [I] Progress on: 280it/1.00kit rate:9.0s/it remaining:1:47:53 elapsed:42:27 postfix:- (3484008:tqdm_logging.py:145)
Step 281: grad_norm=22.811830520629883, loss=1.404213786125183, param_norm=1887.0361328125
Step 282: grad_norm=5.539158821105957, loss=1.2494618892669678, param_norm=1887.03662109375
22:59:23.227 [I] Progress on: 282it/1.00kit rate:8.9s/it remaining:1:46:42 elapsed:42:45 postfix:- (3484008:tqdm_logging.py:145)
Step 283: grad_norm=17.154699325561523, loss=1.3809030055999756, param_norm=1887.036865234375
Step 284: grad_norm=9.554542541503906, loss=1.4383747577667236, param_norm=1887.0372314453125
22:59:40.843 [I] Progress on: 284it/1.00kit rate:8.9s/it remaining:1:45:44 elapsed:43:03 postfix:- (3484008:tqdm_logging.py:145)
Step 285: grad_norm=11.622209548950195, loss=1.3459548950195312, param_norm=1887.03759765625
Step 286: grad_norm=13.938838958740234, loss=1.3313482999801636, param_norm=1887.0379638671875
22:59:58.524 [I] Progress on: 286it/1.00kit rate:8.9s/it remaining:1:45:19 elapsed:43:20 postfix:- (3484008:tqdm_logging.py:145)
Step 287: grad_norm=9.765131950378418, loss=1.4068481922149658, param_norm=1887.038330078125
Step 288: grad_norm=6.5972113609313965, loss=1.4376063346862793, param_norm=1887.0386962890625
23:00:16.169 [I] Progress on: 288it/1.00kit rate:8.8s/it remaining:1:44:47 elapsed:43:38 postfix:- (3484008:tqdm_logging.py:145)
Step 289: grad_norm=6.891796112060547, loss=1.4350416660308838, param_norm=1887.0390625
Step 290: grad_norm=7.874932765960693, loss=1.5726935863494873, param_norm=1887.039306640625
23:00:33.808 [I] Progress on: 290it/1.00kit rate:8.8s/it remaining:1:44:28 elapsed:43:56 postfix:- (3484008:tqdm_logging.py:145)
Step 291: grad_norm=6.775542259216309, loss=1.533625841140747, param_norm=1887.0396728515625
Step 292: grad_norm=13.669739723205566, loss=1.475682020187378, param_norm=1887.0399169921875
23:00:51.446 [I] Progress on: 292it/1.00kit rate:8.8s/it remaining:1:44:03 elapsed:44:13 postfix:- (3484008:tqdm_logging.py:145)
Step 293: grad_norm=15.84462833404541, loss=1.3945200443267822, param_norm=1887.040283203125
Step 294: grad_norm=5.691668510437012, loss=1.2295804023742676, param_norm=1887.04052734375
23:01:09.102 [I] Progress on: 294it/1.00kit rate:8.8s/it remaining:1:43:51 elapsed:44:31 postfix:- (3484008:tqdm_logging.py:145)
Step 295: grad_norm=6.45993185043335, loss=1.474486231803894, param_norm=1887.040771484375
Step 296: grad_norm=10.835203170776367, loss=1.2187581062316895, param_norm=1887.041015625
23:01:26.714 [I] Progress on: 296it/1.00kit rate:8.8s/it remaining:1:43:28 elapsed:44:48 postfix:- (3484008:tqdm_logging.py:145)
Step 297: grad_norm=16.754688262939453, loss=1.3417632579803467, param_norm=1887.0413818359375
Step 298: grad_norm=6.188939094543457, loss=1.4930009841918945, param_norm=1887.0416259765625
23:01:44.335 [I] Progress on: 298it/1.00kit rate:8.8s/it remaining:1:43:06 elapsed:45:06 postfix:- (3484008:tqdm_logging.py:145)
Step 299: grad_norm=5.236473083496094, loss=1.3485121726989746, param_norm=1887.0421142578125
Step 300: grad_norm=6.642485618591309, loss=1.2600359916687012, param_norm=1887.0423583984375
23:02:01.993 [I] Progress on: 300it/1.00kit rate:8.8s/it remaining:1:42:53 elapsed:45:24 postfix:- (3484008:tqdm_logging.py:145)
23:02:02.202 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
23:02:02.202 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
23:02:02.202 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (3484008:checkpoint_manager.py:1786)
23:02:02.202 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (3484008:checkpoint_manager.py:1817)
23:02:02.203 [I] [process=0] Saving checkpoint at step 300                                        (3484008:checkpoint_manager.py:1286)
23:02:02.204 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300. (3484008:async_checkpointer.py:358)
23:02:02.205 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:02:02.205 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6 (3484008:atomicity.py:144)
23:02:02.206 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:02:02.206 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:02:02.208 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (3484008:atomicity.py:144)
23:02:02.208 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (3484008:atomicity.py:144)
23:02:02.209 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:02:02.214 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
23:02:06.134 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:02:06.139 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
23:02:06.142 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
23:02:06.144 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
23:02:06.148 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:02:06.153 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:02:06.157 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
23:02:06.162 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
23:02:06.164 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
23:02:06.169 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742785322.2022562, 'wait_for_prev_duration_secs': 0.0007123947143554688, 'checkpointer_blocking_start_time': 1742785322.2036028, 'checkpointer_blocking_duration_secs': 3.944929361343384, 'get_old_steps_start_time': 1742785326.1487186, 'get_old_steps_duration_secs': 0.008266925811767578, 'checkpoint_manager_blocking_start_time': 1742785322.202061, 'checkpoint_manager_blocking_duration_secs': 3.967482089996338} (3484008:standard_logger.py:34)
23:02:14.379 [I] ChainedFuture completed 1/1 futures in 8.23 seconds.                             (3484008:future.py:137)
23:02:14.380 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 851.3 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:02:14.380 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
23:02:14.382 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6 (3484008:async_checkpointer.py:406)
23:02:14.382 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6/assets (3484008:atomicity.py:287)
23:02:14.393 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6/params (3484008:atomicity.py:287)
23:02:14.394 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300 (3484008:async_checkpointer.py:416)
23:02:14.394 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6 (3484008:async_checkpointer.py:426)
23:02:14.394 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300 (3484008:atomicity.py:287)
23:02:14.396 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/300`. (3484008:atomicity.py:548)
23:02:14.396 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
23:02:14.397 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
23:02:14.397 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
23:02:14.397 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
23:02:14.398 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 301: grad_norm=5.984297752380371, loss=1.1404993534088135, param_norm=1887.0428466796875
23:02:14.778 [I] Progress on: 301it/1.00kit rate:10.0s/it remaining:1:56:39 elapsed:45:37 postfix:- (3484008:tqdm_logging.py:145)
Step 302: grad_norm=15.999345779418945, loss=1.2651135921478271, param_norm=1887.043212890625
Step 303: grad_norm=9.934468269348145, loss=1.3103049993515015, param_norm=1887.0435791015625
23:02:32.476 [I] Progress on: 303it/1.00kit rate:9.4s/it remaining:1:49:24 elapsed:45:54 postfix:- (3484008:tqdm_logging.py:145)
Step 304: grad_norm=8.219612121582031, loss=1.4324990510940552, param_norm=1887.0439453125
Step 305: grad_norm=7.641829967498779, loss=1.497748851776123, param_norm=1887.044189453125
23:02:50.140 [I] Progress on: 305it/1.00kit rate:9.1s/it remaining:1:45:35 elapsed:46:12 postfix:- (3484008:tqdm_logging.py:145)
Step 306: grad_norm=7.518257141113281, loss=1.649426817893982, param_norm=1887.044677734375
Step 307: grad_norm=6.036615371704102, loss=1.216065764427185, param_norm=1887.0450439453125
23:03:07.807 [I] Progress on: 307it/1.00kit rate:9.0s/it remaining:1:43:39 elapsed:46:30 postfix:- (3484008:tqdm_logging.py:145)
Step 308: grad_norm=8.586352348327637, loss=1.458512306213379, param_norm=1887.0452880859375
Step 309: grad_norm=5.835598468780518, loss=1.311905026435852, param_norm=1887.045654296875
23:03:25.469 [I] Progress on: 309it/1.00kit rate:8.9s/it remaining:1:42:28 elapsed:46:47 postfix:- (3484008:tqdm_logging.py:145)
Step 310: grad_norm=8.834488868713379, loss=1.4335603713989258, param_norm=1887.046142578125
Step 311: grad_norm=15.291586875915527, loss=1.632849931716919, param_norm=1887.0465087890625
23:03:43.154 [I] Progress on: 311it/1.00kit rate:8.9s/it remaining:1:41:54 elapsed:47:05 postfix:- (3484008:tqdm_logging.py:145)
Step 312: grad_norm=13.089274406433105, loss=1.5588111877441406, param_norm=1887.046875
Step 313: grad_norm=11.082392692565918, loss=1.4569664001464844, param_norm=1887.047119140625
23:04:00.857 [I] Progress on: 313it/1.00kit rate:8.9s/it remaining:1:41:27 elapsed:47:23 postfix:- (3484008:tqdm_logging.py:145)
Step 314: grad_norm=9.033552169799805, loss=1.487961769104004, param_norm=1887.0474853515625
Step 315: grad_norm=6.350255966186523, loss=1.4679839611053467, param_norm=1887.0477294921875
23:04:18.536 [I] Progress on: 315it/1.00kit rate:8.9s/it remaining:1:41:03 elapsed:47:40 postfix:- (3484008:tqdm_logging.py:145)
Step 316: grad_norm=7.978424072265625, loss=1.3844436407089233, param_norm=1887.0479736328125
Step 317: grad_norm=8.536311149597168, loss=1.4772090911865234, param_norm=1887.04833984375
23:04:36.264 [I] Progress on: 317it/1.00kit rate:8.9s/it remaining:1:40:49 elapsed:47:58 postfix:- (3484008:tqdm_logging.py:145)
Step 318: grad_norm=5.117897033691406, loss=1.4055771827697754, param_norm=1887.0487060546875
Step 319: grad_norm=15.03597354888916, loss=1.4986791610717773, param_norm=1887.049072265625
23:04:53.920 [I] Progress on: 319it/1.00kit rate:8.8s/it remaining:1:40:22 elapsed:48:16 postfix:- (3484008:tqdm_logging.py:145)
Step 320: grad_norm=8.3112154006958, loss=1.460395097732544, param_norm=1887.04931640625
Step 321: grad_norm=7.027895927429199, loss=1.2657155990600586, param_norm=1887.049560546875
23:05:11.581 [I] Progress on: 321it/1.00kit rate:8.8s/it remaining:1:39:59 elapsed:48:33 postfix:- (3484008:tqdm_logging.py:145)
Step 322: grad_norm=6.352358341217041, loss=1.4507923126220703, param_norm=1887.0499267578125
Step 323: grad_norm=14.390945434570312, loss=1.5642541646957397, param_norm=1887.0501708984375
23:05:29.244 [I] Progress on: 323it/1.00kit rate:8.8s/it remaining:1:39:42 elapsed:48:51 postfix:- (3484008:tqdm_logging.py:145)
Step 324: grad_norm=16.147451400756836, loss=1.4983129501342773, param_norm=1887.0504150390625
Step 325: grad_norm=5.7497076988220215, loss=1.3054530620574951, param_norm=1887.05078125
23:05:46.935 [I] Progress on: 325it/1.00kit rate:8.8s/it remaining:1:39:27 elapsed:49:09 postfix:- (3484008:tqdm_logging.py:145)
Step 326: grad_norm=6.088041305541992, loss=1.2639868259429932, param_norm=1887.051025390625
Step 327: grad_norm=8.014562606811523, loss=1.1831578016281128, param_norm=1887.05126953125
23:06:04.575 [I] Progress on: 327it/1.00kit rate:8.8s/it remaining:1:39:04 elapsed:49:26 postfix:- (3484008:tqdm_logging.py:145)
Step 328: grad_norm=11.10849380493164, loss=1.4828072786331177, param_norm=1887.051513671875
Step 329: grad_norm=13.73668384552002, loss=1.2568227052688599, param_norm=1887.0518798828125
23:06:22.307 [I] Progress on: 329it/1.00kit rate:8.8s/it remaining:1:38:57 elapsed:49:44 postfix:- (3484008:tqdm_logging.py:145)
Step 330: grad_norm=6.33080530166626, loss=1.3865039348602295, param_norm=1887.05224609375
Step 331: grad_norm=5.445930480957031, loss=1.4878199100494385, param_norm=1887.0526123046875
23:06:39.986 [I] Progress on: 331it/1.00kit rate:8.8s/it remaining:1:38:39 elapsed:50:02 postfix:- (3484008:tqdm_logging.py:145)
Step 332: grad_norm=9.246237754821777, loss=1.4374842643737793, param_norm=1887.0528564453125
Step 333: grad_norm=6.178779125213623, loss=1.516251564025879, param_norm=1887.0531005859375
23:06:57.646 [I] Progress on: 333it/1.00kit rate:8.8s/it remaining:1:38:14 elapsed:50:19 postfix:- (3484008:tqdm_logging.py:145)
Step 334: grad_norm=6.263903617858887, loss=1.3216818571090698, param_norm=1887.053466796875
Step 335: grad_norm=10.723313331604004, loss=1.4681732654571533, param_norm=1887.0538330078125
23:07:15.298 [I] Progress on: 335it/1.00kit rate:8.8s/it remaining:1:37:54 elapsed:50:37 postfix:- (3484008:tqdm_logging.py:145)
Step 336: grad_norm=17.464391708374023, loss=1.325617790222168, param_norm=1887.05419921875
Step 337: grad_norm=5.755026817321777, loss=1.2856554985046387, param_norm=1887.0545654296875
23:07:32.938 [I] Progress on: 337it/1.00kit rate:8.8s/it remaining:1:37:32 elapsed:50:55 postfix:- (3484008:tqdm_logging.py:145)
Step 338: grad_norm=6.405655860900879, loss=1.5601820945739746, param_norm=1887.0548095703125
Step 339: grad_norm=8.709305763244629, loss=1.302898645401001, param_norm=1887.0552978515625
23:07:50.578 [I] Progress on: 339it/1.00kit rate:8.8s/it remaining:1:37:12 elapsed:51:12 postfix:- (3484008:tqdm_logging.py:145)
Step 340: grad_norm=6.552711009979248, loss=1.2900062799453735, param_norm=1887.0556640625
Step 341: grad_norm=16.985265731811523, loss=1.5954581499099731, param_norm=1887.055908203125
23:08:08.230 [I] Progress on: 341it/1.00kit rate:8.8s/it remaining:1:36:54 elapsed:51:30 postfix:- (3484008:tqdm_logging.py:145)
Step 342: grad_norm=5.635429382324219, loss=1.223671317100525, param_norm=1887.056396484375
Step 343: grad_norm=11.992464065551758, loss=1.4223380088806152, param_norm=1887.0565185546875
23:08:25.863 [I] Progress on: 343it/1.00kit rate:8.8s/it remaining:1:36:35 elapsed:51:48 postfix:- (3484008:tqdm_logging.py:145)
Step 344: grad_norm=6.115450382232666, loss=1.5606741905212402, param_norm=1887.0570068359375
23:08:37.169 [I] Progress on: 345it/1.00kit rate:9.5s/it remaining:1:43:44 elapsed:51:59 postfix:- (3484008:tqdm_logging.py:145)
Step 345: grad_norm=7.183987140655518, loss=1.2045674324035645, param_norm=1887.0572509765625
Step 346: grad_norm=5.351207256317139, loss=1.2532424926757812, param_norm=1887.0574951171875
23:08:54.509 [I] Progress on: 346it/1.00kit rate:9.3s/it remaining:1:41:01 elapsed:52:16 postfix:- (3484008:tqdm_logging.py:145)
Step 347: grad_norm=13.951848983764648, loss=1.2425702810287476, param_norm=1887.0577392578125
Step 348: grad_norm=12.701069831848145, loss=1.1017138957977295, param_norm=1887.05810546875
23:09:12.157 [I] Progress on: 348it/1.00kit rate:9.0s/it remaining:1:38:15 elapsed:52:34 postfix:- (3484008:tqdm_logging.py:145)
Step 349: grad_norm=6.492056846618652, loss=1.2308437824249268, param_norm=1887.0584716796875
Step 350: grad_norm=9.102437973022461, loss=1.2439440488815308, param_norm=1887.058837890625
23:09:29.795 [I] Progress on: 350it/1.00kit rate:8.9s/it remaining:1:36:45 elapsed:52:52 postfix:- (3484008:tqdm_logging.py:145)
Step 351: grad_norm=7.479671955108643, loss=1.346067190170288, param_norm=1887.0592041015625
Step 352: grad_norm=10.19079303741455, loss=1.1376583576202393, param_norm=1887.0595703125
23:09:47.446 [I] Progress on: 352it/1.00kit rate:8.9s/it remaining:1:35:50 elapsed:53:09 postfix:- (3484008:tqdm_logging.py:145)
Step 353: grad_norm=7.404621601104736, loss=1.3012020587921143, param_norm=1887.0599365234375
Step 354: grad_norm=6.2373504638671875, loss=1.365346908569336, param_norm=1887.0601806640625
23:10:05.144 [I] Progress on: 354it/1.00kit rate:8.9s/it remaining:1:35:24 elapsed:53:27 postfix:- (3484008:tqdm_logging.py:145)
Step 355: grad_norm=10.964556694030762, loss=1.117772102355957, param_norm=1887.0604248046875
Step 356: grad_norm=12.13795280456543, loss=1.2922708988189697, param_norm=1887.060791015625
23:10:22.936 [I] Progress on: 356it/1.00kit rate:8.9s/it remaining:1:35:22 elapsed:53:45 postfix:- (3484008:tqdm_logging.py:145)
Step 357: grad_norm=5.482418537139893, loss=1.1367615461349487, param_norm=1887.06103515625
Step 358: grad_norm=6.332463264465332, loss=0.9934399127960205, param_norm=1887.061279296875
23:10:40.620 [I] Progress on: 358it/1.00kit rate:8.9s/it remaining:1:34:50 elapsed:54:02 postfix:- (3484008:tqdm_logging.py:145)
Step 359: grad_norm=11.946621894836426, loss=1.2600892782211304, param_norm=1887.0616455078125
Step 360: grad_norm=6.4277167320251465, loss=1.2300724983215332, param_norm=1887.0618896484375
23:10:58.264 [I] Progress on: 360it/1.00kit rate:8.8s/it remaining:1:34:18 elapsed:54:20 postfix:- (3484008:tqdm_logging.py:145)
Step 361: grad_norm=6.227228164672852, loss=1.2509530782699585, param_norm=1887.0621337890625
Step 362: grad_norm=7.709073066711426, loss=1.1990857124328613, param_norm=1887.0625
23:11:15.898 [I] Progress on: 362it/1.00kit rate:8.8s/it remaining:1:33:52 elapsed:54:38 postfix:- (3484008:tqdm_logging.py:145)
Step 363: grad_norm=11.141904830932617, loss=1.2542414665222168, param_norm=1887.062744140625
Step 364: grad_norm=7.550280570983887, loss=1.2425304651260376, param_norm=1887.0631103515625
23:11:33.576 [I] Progress on: 364it/1.00kit rate:8.8s/it remaining:1:33:38 elapsed:54:55 postfix:- (3484008:tqdm_logging.py:145)
Step 365: grad_norm=7.319443225860596, loss=1.3164972066879272, param_norm=1887.0633544921875
Step 366: grad_norm=18.360328674316406, loss=1.0971636772155762, param_norm=1887.063720703125
23:11:51.226 [I] Progress on: 366it/1.00kit rate:8.8s/it remaining:1:33:17 elapsed:55:13 postfix:- (3484008:tqdm_logging.py:145)
Step 367: grad_norm=21.273466110229492, loss=1.164365291595459, param_norm=1887.06396484375
Step 368: grad_norm=6.095151901245117, loss=0.8295362591743469, param_norm=1887.064208984375
23:12:08.837 [I] Progress on: 368it/1.00kit rate:8.8s/it remaining:1:32:51 elapsed:55:31 postfix:- (3484008:tqdm_logging.py:145)
Step 369: grad_norm=14.861553192138672, loss=1.2585645914077759, param_norm=1887.0645751953125
Step 370: grad_norm=9.51125717163086, loss=1.2120325565338135, param_norm=1887.0648193359375
23:12:26.528 [I] Progress on: 370it/1.00kit rate:8.8s/it remaining:1:32:44 elapsed:55:48 postfix:- (3484008:tqdm_logging.py:145)
Step 371: grad_norm=8.560907363891602, loss=1.1561601161956787, param_norm=1887.065185546875
Step 372: grad_norm=10.614398002624512, loss=1.3399479389190674, param_norm=1887.0654296875
23:12:44.168 [I] Progress on: 372it/1.00kit rate:8.8s/it remaining:1:32:21 elapsed:56:06 postfix:- (3484008:tqdm_logging.py:145)
Step 373: grad_norm=9.04153823852539, loss=1.0560775995254517, param_norm=1887.065673828125
Step 374: grad_norm=7.746777057647705, loss=1.1235160827636719, param_norm=1887.06591796875
23:13:01.805 [I] Progress on: 374it/1.00kit rate:8.8s/it remaining:1:32:02 elapsed:56:24 postfix:- (3484008:tqdm_logging.py:145)
Step 375: grad_norm=19.959543228149414, loss=1.1304328441619873, param_norm=1887.0662841796875
Step 376: grad_norm=21.856826782226562, loss=1.3203195333480835, param_norm=1887.0665283203125
23:13:19.458 [I] Progress on: 376it/1.00kit rate:8.8s/it remaining:1:31:46 elapsed:56:41 postfix:- (3484008:tqdm_logging.py:145)
Step 377: grad_norm=12.064188957214355, loss=1.236438512802124, param_norm=1887.0667724609375
Step 378: grad_norm=8.340167999267578, loss=1.2984271049499512, param_norm=1887.0670166015625
23:13:37.113 [I] Progress on: 378it/1.00kit rate:8.8s/it remaining:1:31:30 elapsed:56:59 postfix:- (3484008:tqdm_logging.py:145)
Step 379: grad_norm=9.016946792602539, loss=1.3919144868850708, param_norm=1887.0672607421875
Step 380: grad_norm=10.72537612915039, loss=1.1184393167495728, param_norm=1887.067626953125
23:13:54.826 [I] Progress on: 380it/1.00kit rate:8.8s/it remaining:1:31:22 elapsed:57:17 postfix:- (3484008:tqdm_logging.py:145)
Step 381: grad_norm=6.788053035736084, loss=1.0645191669464111, param_norm=1887.06787109375
Step 382: grad_norm=10.19520092010498, loss=1.1671279668807983, param_norm=1887.068115234375
23:14:12.474 [I] Progress on: 382it/1.00kit rate:8.8s/it remaining:1:30:56 elapsed:57:34 postfix:- (3484008:tqdm_logging.py:145)
Step 383: grad_norm=6.000422477722168, loss=1.2858450412750244, param_norm=1887.068359375
Step 384: grad_norm=8.469650268554688, loss=1.0526463985443115, param_norm=1887.068603515625
23:14:30.117 [I] Progress on: 384it/1.00kit rate:8.8s/it remaining:1:30:37 elapsed:57:52 postfix:- (3484008:tqdm_logging.py:145)
Step 385: grad_norm=12.772041320800781, loss=1.0912871360778809, param_norm=1887.06884765625
Step 386: grad_norm=9.619622230529785, loss=1.06058669090271, param_norm=1887.0689697265625
23:14:47.762 [I] Progress on: 386it/1.00kit rate:8.8s/it remaining:1:30:16 elapsed:58:10 postfix:- (3484008:tqdm_logging.py:145)
Step 387: grad_norm=12.015934944152832, loss=1.3755061626434326, param_norm=1887.0693359375
Step 388: grad_norm=12.222770690917969, loss=1.262316107749939, param_norm=1887.069580078125
23:15:05.337 [I] Progress on: 388it/1.00kit rate:8.8s/it remaining:1:29:51 elapsed:58:27 postfix:- (3484008:tqdm_logging.py:145)
Step 389: grad_norm=6.392819404602051, loss=1.1658251285552979, param_norm=1887.0699462890625
Step 390: grad_norm=8.083194732666016, loss=1.26888108253479, param_norm=1887.0701904296875
23:15:22.977 [I] Progress on: 390it/1.00kit rate:8.8s/it remaining:1:29:35 elapsed:58:45 postfix:- (3484008:tqdm_logging.py:145)
Step 391: grad_norm=14.996149063110352, loss=1.0445342063903809, param_norm=1887.0704345703125
Step 392: grad_norm=7.331932544708252, loss=1.098031997680664, param_norm=1887.07080078125
23:15:40.617 [I] Progress on: 392it/1.00kit rate:8.8s/it remaining:1:29:21 elapsed:59:02 postfix:- (3484008:tqdm_logging.py:145)
Step 393: grad_norm=9.44766616821289, loss=1.0759692192077637, param_norm=1887.071044921875
Step 394: grad_norm=6.420192241668701, loss=1.23585844039917, param_norm=1887.0714111328125
23:15:58.263 [I] Progress on: 394it/1.00kit rate:8.8s/it remaining:1:29:04 elapsed:59:20 postfix:- (3484008:tqdm_logging.py:145)
Step 395: grad_norm=12.569487571716309, loss=1.291738510131836, param_norm=1887.0716552734375
Step 396: grad_norm=14.446417808532715, loss=1.3009190559387207, param_norm=1887.07177734375
23:16:16.193 [I] Progress on: 396it/1.00kit rate:8.9s/it remaining:1:29:42 elapsed:59:38 postfix:- (3484008:tqdm_logging.py:145)
Step 397: grad_norm=7.505610942840576, loss=1.1145412921905518, param_norm=1887.0721435546875
Step 398: grad_norm=7.8968963623046875, loss=1.0839126110076904, param_norm=1887.0723876953125
23:16:33.817 [I] Progress on: 398it/1.00kit rate:8.9s/it remaining:1:28:51 elapsed:59:56 postfix:- (3484008:tqdm_logging.py:145)
Step 399: grad_norm=9.593327522277832, loss=1.1467397212982178, param_norm=1887.0726318359375
Step 400: grad_norm=7.34432315826416, loss=1.1636296510696411, param_norm=1887.07275390625
23:16:51.401 [I] Progress on: 400it/1.00kit rate:8.8s/it remaining:1:28:13 elapsed:1:00:13 postfix:- (3484008:tqdm_logging.py:145)
23:16:51.602 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
23:16:51.603 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
23:16:51.603 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (3484008:checkpoint_manager.py:1786)
23:16:51.603 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (3484008:checkpoint_manager.py:1817)
23:16:51.603 [I] [process=0] Saving checkpoint at step 400                                        (3484008:checkpoint_manager.py:1286)
23:16:51.604 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400. (3484008:async_checkpointer.py:358)
23:16:51.605 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:16:51.606 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9 (3484008:atomicity.py:144)
23:16:51.606 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:16:51.607 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:16:51.608 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (3484008:atomicity.py:144)
23:16:51.608 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (3484008:atomicity.py:144)
23:16:51.608 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:16:51.613 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
23:16:55.446 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:16:55.450 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
23:16:55.452 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
23:16:55.453 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
23:16:55.457 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:16:55.458 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:16:55.460 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:16:55.464 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
23:16:55.465 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
23:16:55.470 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
23:16:55.475 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742786211.6026647, 'wait_for_prev_duration_secs': 0.0007147789001464844, 'checkpointer_blocking_start_time': 1742786211.6039739, 'checkpointer_blocking_duration_secs': 3.85351300239563, 'get_old_steps_start_time': 1742786215.4575465, 'get_old_steps_duration_secs': 0.0068819522857666016, 'checkpoint_manager_blocking_start_time': 1742786211.6024709, 'checkpoint_manager_blocking_duration_secs': 3.873089075088501} (3484008:standard_logger.py:34)
23:17:03.190 [I] ChainedFuture completed 1/1 futures in 7.74 seconds.                             (3484008:future.py:137)
23:17:03.191 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 894.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:17:03.191 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
23:17:03.193 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9 (3484008:async_checkpointer.py:406)
23:17:03.194 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9/assets (3484008:atomicity.py:287)
23:17:03.217 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9/params (3484008:atomicity.py:287)
23:17:03.217 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400 (3484008:async_checkpointer.py:416)
23:17:03.218 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9 (3484008:async_checkpointer.py:426)
23:17:03.218 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400 (3484008:atomicity.py:287)
23:17:03.219 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/400`. (3484008:atomicity.py:548)
23:17:03.220 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
23:17:03.220 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
23:17:03.221 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
23:17:03.221 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
23:17:03.221 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 401: grad_norm=7.961683750152588, loss=1.0314222574234009, param_norm=1887.0731201171875
23:17:04.094 [I] Progress on: 401it/1.00kit rate:10.0s/it remaining:1:39:42 elapsed:1:00:26 postfix:- (3484008:tqdm_logging.py:145)
Step 402: grad_norm=10.150279998779297, loss=1.1056265830993652, param_norm=1887.0732421875
Step 403: grad_norm=12.5840482711792, loss=1.0188281536102295, param_norm=1887.073486328125
23:17:21.773 [I] Progress on: 403it/1.00kit rate:9.4s/it remaining:1:33:32 elapsed:1:00:44 postfix:- (3484008:tqdm_logging.py:145)
Step 404: grad_norm=6.8867692947387695, loss=0.9807869791984558, param_norm=1887.07373046875
Step 405: grad_norm=7.882315635681152, loss=1.363067626953125, param_norm=1887.073974609375
23:17:39.405 [I] Progress on: 405it/1.00kit rate:9.1s/it remaining:1:30:15 elapsed:1:01:01 postfix:- (3484008:tqdm_logging.py:145)
Step 406: grad_norm=13.654570579528809, loss=1.058711051940918, param_norm=1887.07421875
Step 407: grad_norm=20.05068016052246, loss=1.0823771953582764, param_norm=1887.074462890625
23:17:57.040 [I] Progress on: 407it/1.00kit rate:9.0s/it remaining:1:28:29 elapsed:1:01:19 postfix:- (3484008:tqdm_logging.py:145)
Step 408: grad_norm=10.967144012451172, loss=1.1289656162261963, param_norm=1887.07470703125
Step 409: grad_norm=6.894429683685303, loss=1.188570261001587, param_norm=1887.0750732421875
23:18:14.626 [I] Progress on: 409it/1.00kit rate:8.9s/it remaining:1:27:22 elapsed:1:01:36 postfix:- (3484008:tqdm_logging.py:145)
Step 410: grad_norm=7.7959136962890625, loss=1.1801824569702148, param_norm=1887.0751953125
Step 411: grad_norm=8.805850982666016, loss=1.099238634109497, param_norm=1887.0755615234375
23:18:32.252 [I] Progress on: 411it/1.00kit rate:8.8s/it remaining:1:26:47 elapsed:1:01:54 postfix:- (3484008:tqdm_logging.py:145)
Step 412: grad_norm=8.946535110473633, loss=1.2946077585220337, param_norm=1887.0758056640625
Step 413: grad_norm=14.073243141174316, loss=1.2655798196792603, param_norm=1887.0760498046875
23:18:49.938 [I] Progress on: 413it/1.00kit rate:8.8s/it remaining:1:26:31 elapsed:1:02:12 postfix:- (3484008:tqdm_logging.py:145)
Step 414: grad_norm=7.363261699676514, loss=0.8739414215087891, param_norm=1887.0762939453125
23:19:01.032 [I] Progress on: 414it/1.00kit rate:9.5s/it remaining:1:33:00 elapsed:1:02:23 postfix:- (3484008:tqdm_logging.py:145)
Step 415: grad_norm=5.427743434906006, loss=0.8867305517196655, param_norm=1887.0765380859375
Step 416: grad_norm=34.99968719482422, loss=1.174513816833496, param_norm=1887.0767822265625
23:19:18.671 [I] Progress on: 416it/1.00kit rate:9.2s/it remaining:1:29:12 elapsed:1:02:40 postfix:- (3484008:tqdm_logging.py:145)
Step 417: grad_norm=30.057125091552734, loss=1.0668368339538574, param_norm=1887.0770263671875
Step 418: grad_norm=14.229459762573242, loss=1.1992988586425781, param_norm=1887.0771484375
23:19:36.282 [I] Progress on: 418it/1.00kit rate:9.0s/it remaining:1:27:06 elapsed:1:02:58 postfix:- (3484008:tqdm_logging.py:145)
Step 419: grad_norm=9.971040725708008, loss=1.1245019435882568, param_norm=1887.077392578125
Step 420: grad_norm=7.526778221130371, loss=1.0317015647888184, param_norm=1887.07763671875
23:19:53.928 [I] Progress on: 420it/1.00kit rate:8.9s/it remaining:1:26:02 elapsed:1:03:16 postfix:- (3484008:tqdm_logging.py:145)
Step 421: grad_norm=5.14938497543335, loss=0.9274057745933533, param_norm=1887.077880859375
Step 422: grad_norm=7.908599376678467, loss=0.944532036781311, param_norm=1887.078125
23:20:11.558 [I] Progress on: 422it/1.00kit rate:8.9s/it remaining:1:25:18 elapsed:1:03:33 postfix:- (3484008:tqdm_logging.py:145)
Step 423: grad_norm=4.852025032043457, loss=0.9198322892189026, param_norm=1887.078369140625
Step 424: grad_norm=22.9183292388916, loss=1.014451503753662, param_norm=1887.0787353515625
23:20:29.195 [I] Progress on: 424it/1.00kit rate:8.8s/it remaining:1:24:50 elapsed:1:03:51 postfix:- (3484008:tqdm_logging.py:145)
Step 425: grad_norm=15.537156105041504, loss=1.0056102275848389, param_norm=1887.078857421875
Step 426: grad_norm=7.329870223999023, loss=1.0002732276916504, param_norm=1887.0791015625
23:20:46.826 [I] Progress on: 426it/1.00kit rate:8.8s/it remaining:1:24:26 elapsed:1:04:09 postfix:- (3484008:tqdm_logging.py:145)
Step 427: grad_norm=9.507244110107422, loss=1.0583715438842773, param_norm=1887.079345703125
Step 428: grad_norm=34.91409683227539, loss=1.058664321899414, param_norm=1887.07958984375
23:21:04.465 [I] Progress on: 428it/1.00kit rate:8.8s/it remaining:1:24:07 elapsed:1:04:26 postfix:- (3484008:tqdm_logging.py:145)
Step 429: grad_norm=6.737603664398193, loss=1.0002018213272095, param_norm=1887.0797119140625
Step 430: grad_norm=8.688630104064941, loss=1.0352697372436523, param_norm=1887.0799560546875
23:21:22.094 [I] Progress on: 430it/1.00kit rate:8.8s/it remaining:1:23:46 elapsed:1:04:44 postfix:- (3484008:tqdm_logging.py:145)
Step 431: grad_norm=9.444464683532715, loss=1.0799899101257324, param_norm=1887.0802001953125
Step 432: grad_norm=7.9181342124938965, loss=0.9689279794692993, param_norm=1887.0804443359375
23:21:39.723 [I] Progress on: 432it/1.00kit rate:8.8s/it remaining:1:23:29 elapsed:1:05:01 postfix:- (3484008:tqdm_logging.py:145)
Step 433: grad_norm=12.364877700805664, loss=1.0706595182418823, param_norm=1887.0806884765625
Step 434: grad_norm=9.301916122436523, loss=0.9399435520172119, param_norm=1887.0810546875
23:21:57.300 [I] Progress on: 434it/1.00kit rate:8.8s/it remaining:1:23:01 elapsed:1:05:19 postfix:- (3484008:tqdm_logging.py:145)
Step 435: grad_norm=6.80918550491333, loss=0.8000912666320801, param_norm=1887.0811767578125
Step 436: grad_norm=5.769716262817383, loss=0.8806985020637512, param_norm=1887.0814208984375
23:22:14.845 [I] Progress on: 436it/1.00kit rate:8.8s/it remaining:1:22:34 elapsed:1:05:37 postfix:- (3484008:tqdm_logging.py:145)
Step 437: grad_norm=11.115997314453125, loss=0.9185636043548584, param_norm=1887.081787109375
Step 438: grad_norm=6.183439254760742, loss=0.9832944869995117, param_norm=1887.0819091796875
23:22:32.497 [I] Progress on: 438it/1.00kit rate:8.8s/it remaining:1:22:28 elapsed:1:05:54 postfix:- (3484008:tqdm_logging.py:145)
Step 439: grad_norm=5.270096778869629, loss=0.7740600109100342, param_norm=1887.0821533203125
Step 440: grad_norm=15.481851577758789, loss=1.0273486375808716, param_norm=1887.0823974609375
23:22:50.225 [I] Progress on: 440it/1.00kit rate:8.8s/it remaining:1:22:29 elapsed:1:06:12 postfix:- (3484008:tqdm_logging.py:145)
Step 441: grad_norm=14.991781234741211, loss=0.7725566029548645, param_norm=1887.0826416015625
Step 442: grad_norm=7.578505992889404, loss=1.0973694324493408, param_norm=1887.0828857421875
23:23:07.876 [I] Progress on: 442it/1.00kit rate:8.8s/it remaining:1:22:05 elapsed:1:06:30 postfix:- (3484008:tqdm_logging.py:145)
Step 443: grad_norm=5.793776988983154, loss=1.01629638671875, param_norm=1887.0830078125
Step 444: grad_norm=8.91188907623291, loss=1.253869652748108, param_norm=1887.0833740234375
23:23:25.600 [I] Progress on: 444it/1.00kit rate:8.8s/it remaining:1:21:59 elapsed:1:06:47 postfix:- (3484008:tqdm_logging.py:145)
Step 445: grad_norm=9.54471492767334, loss=1.2585935592651367, param_norm=1887.0836181640625
Step 446: grad_norm=10.875443458557129, loss=0.9205530285835266, param_norm=1887.0838623046875
23:23:43.327 [I] Progress on: 446it/1.00kit rate:8.9s/it remaining:1:21:48 elapsed:1:07:05 postfix:- (3484008:tqdm_logging.py:145)
Step 447: grad_norm=6.522018909454346, loss=0.9932761192321777, param_norm=1887.0841064453125
Step 448: grad_norm=13.93340015411377, loss=1.1089153289794922, param_norm=1887.084228515625
23:24:00.962 [I] Progress on: 448it/1.00kit rate:8.8s/it remaining:1:21:17 elapsed:1:07:23 postfix:- (3484008:tqdm_logging.py:145)
Step 449: grad_norm=10.253844261169434, loss=1.0829137563705444, param_norm=1887.08447265625
Step 450: grad_norm=9.909477233886719, loss=1.0046896934509277, param_norm=1887.084716796875
23:24:18.580 [I] Progress on: 450it/1.00kit rate:8.8s/it remaining:1:20:52 elapsed:1:07:40 postfix:- (3484008:tqdm_logging.py:145)
Step 451: grad_norm=10.013553619384766, loss=1.1579326391220093, param_norm=1887.0849609375
Step 452: grad_norm=12.863100051879883, loss=0.94707190990448, param_norm=1887.085205078125
23:24:36.222 [I] Progress on: 452it/1.00kit rate:8.8s/it remaining:1:20:34 elapsed:1:07:58 postfix:- (3484008:tqdm_logging.py:145)
Step 453: grad_norm=13.556877136230469, loss=1.0854036808013916, param_norm=1887.0853271484375
Step 454: grad_norm=10.897919654846191, loss=1.0230631828308105, param_norm=1887.0855712890625
23:24:53.869 [I] Progress on: 454it/1.00kit rate:8.8s/it remaining:1:20:16 elapsed:1:08:16 postfix:- (3484008:tqdm_logging.py:145)
Step 455: grad_norm=11.688493728637695, loss=0.9818129539489746, param_norm=1887.0858154296875
Step 456: grad_norm=6.097085475921631, loss=1.1161627769470215, param_norm=1887.0859375
23:25:11.524 [I] Progress on: 456it/1.00kit rate:8.8s/it remaining:1:20:00 elapsed:1:08:33 postfix:- (3484008:tqdm_logging.py:145)
Step 457: grad_norm=6.623448371887207, loss=1.1153779029846191, param_norm=1887.086181640625
Step 458: grad_norm=7.853882312774658, loss=0.8947064280509949, param_norm=1887.08642578125
23:25:29.194 [I] Progress on: 458it/1.00kit rate:8.8s/it remaining:1:19:45 elapsed:1:08:51 postfix:- (3484008:tqdm_logging.py:145)
Step 459: grad_norm=10.172575950622559, loss=0.9888277053833008, param_norm=1887.0865478515625
Step 460: grad_norm=9.923807144165039, loss=0.8783951997756958, param_norm=1887.086669921875
23:25:46.825 [I] Progress on: 460it/1.00kit rate:8.8s/it remaining:1:19:24 elapsed:1:09:09 postfix:- (3484008:tqdm_logging.py:145)
Step 461: grad_norm=7.848145961761475, loss=1.0624136924743652, param_norm=1887.0869140625
Step 462: grad_norm=10.336099624633789, loss=1.0741297006607056, param_norm=1887.0870361328125
23:26:04.490 [I] Progress on: 462it/1.00kit rate:8.8s/it remaining:1:19:09 elapsed:1:09:26 postfix:- (3484008:tqdm_logging.py:145)
Step 463: grad_norm=6.013957500457764, loss=1.0289885997772217, param_norm=1887.087158203125
Step 464: grad_norm=6.436429977416992, loss=0.8464246988296509, param_norm=1887.08740234375
23:26:22.054 [I] Progress on: 464it/1.00kit rate:8.8s/it remaining:1:18:40 elapsed:1:09:44 postfix:- (3484008:tqdm_logging.py:145)
Step 465: grad_norm=6.015190124511719, loss=0.9218874573707581, param_norm=1887.0875244140625
Step 466: grad_norm=6.342552185058594, loss=0.9884059429168701, param_norm=1887.0877685546875
23:26:39.761 [I] Progress on: 466it/1.00kit rate:8.8s/it remaining:1:18:35 elapsed:1:10:02 postfix:- (3484008:tqdm_logging.py:145)
Step 467: grad_norm=10.64906120300293, loss=1.0890024900436401, param_norm=1887.0880126953125
Step 468: grad_norm=9.117175102233887, loss=0.9766461849212646, param_norm=1887.088134765625
23:26:57.424 [I] Progress on: 468it/1.00kit rate:8.8s/it remaining:1:18:18 elapsed:1:10:19 postfix:- (3484008:tqdm_logging.py:145)
Step 469: grad_norm=9.12648868560791, loss=0.8607829809188843, param_norm=1887.08837890625
Step 470: grad_norm=10.323019027709961, loss=0.7840068340301514, param_norm=1887.0885009765625
23:27:15.103 [I] Progress on: 470it/1.00kit rate:8.8s/it remaining:1:18:02 elapsed:1:10:37 postfix:- (3484008:tqdm_logging.py:145)
Step 471: grad_norm=6.4446492195129395, loss=1.0485098361968994, param_norm=1887.0887451171875
Step 472: grad_norm=6.6330037117004395, loss=1.0200316905975342, param_norm=1887.0888671875
23:27:32.769 [I] Progress on: 472it/1.00kit rate:8.8s/it remaining:1:17:44 elapsed:1:10:55 postfix:- (3484008:tqdm_logging.py:145)
Step 473: grad_norm=6.794081687927246, loss=0.8836742639541626, param_norm=1887.0889892578125
Step 474: grad_norm=5.850157260894775, loss=0.9567437171936035, param_norm=1887.0892333984375
23:27:50.434 [I] Progress on: 474it/1.00kit rate:8.8s/it remaining:1:17:24 elapsed:1:11:12 postfix:- (3484008:tqdm_logging.py:145)
Step 475: grad_norm=8.006624221801758, loss=1.011230230331421, param_norm=1887.0894775390625
Step 476: grad_norm=5.346802711486816, loss=0.8685628175735474, param_norm=1887.089599609375
23:28:08.074 [I] Progress on: 476it/1.00kit rate:8.8s/it remaining:1:17:03 elapsed:1:11:30 postfix:- (3484008:tqdm_logging.py:145)
Step 477: grad_norm=9.316279411315918, loss=0.9418349266052246, param_norm=1887.08984375
Step 478: grad_norm=6.554022312164307, loss=1.0331544876098633, param_norm=1887.0899658203125
23:28:25.751 [I] Progress on: 478it/1.00kit rate:8.8s/it remaining:1:16:51 elapsed:1:11:48 postfix:- (3484008:tqdm_logging.py:145)
Step 479: grad_norm=5.224797248840332, loss=0.9568040370941162, param_norm=1887.09033203125
Step 480: grad_norm=5.808481216430664, loss=0.9467207193374634, param_norm=1887.0904541015625
23:28:43.395 [I] Progress on: 480it/1.00kit rate:8.8s/it remaining:1:16:30 elapsed:1:12:05 postfix:- (3484008:tqdm_logging.py:145)
Step 481: grad_norm=5.764036655426025, loss=0.9213582277297974, param_norm=1887.0906982421875
Step 482: grad_norm=7.287908554077148, loss=0.9958598613739014, param_norm=1887.0908203125
23:29:01.053 [I] Progress on: 482it/1.00kit rate:8.8s/it remaining:1:16:14 elapsed:1:12:23 postfix:- (3484008:tqdm_logging.py:145)
Step 483: grad_norm=5.98893928527832, loss=0.8612275719642639, param_norm=1887.0911865234375
23:29:11.949 [I] Progress on: 483it/1.00kit rate:9.5s/it remaining:1:21:28 elapsed:1:12:34 postfix:- (3484008:tqdm_logging.py:145)
Step 484: grad_norm=6.4533162117004395, loss=0.8107765913009644, param_norm=1887.09130859375
Step 485: grad_norm=3.8790228366851807, loss=0.6178585886955261, param_norm=1887.091552734375
23:29:29.578 [I] Progress on: 485it/1.00kit rate:9.1s/it remaining:1:18:20 elapsed:1:12:51 postfix:- (3484008:tqdm_logging.py:145)
Step 486: grad_norm=5.334622383117676, loss=0.8275963068008423, param_norm=1887.091796875
Step 487: grad_norm=5.129049777984619, loss=0.7810620665550232, param_norm=1887.0919189453125
23:29:47.190 [I] Progress on: 487it/1.00kit rate:9.0s/it remaining:1:16:38 elapsed:1:13:09 postfix:- (3484008:tqdm_logging.py:145)
Step 488: grad_norm=4.812314033508301, loss=0.9385470151901245, param_norm=1887.0921630859375
Step 489: grad_norm=8.90417194366455, loss=0.6842427849769592, param_norm=1887.09228515625
23:30:04.826 [I] Progress on: 489it/1.00kit rate:8.9s/it remaining:1:15:41 elapsed:1:13:27 postfix:- (3484008:tqdm_logging.py:145)
Step 490: grad_norm=5.4731526374816895, loss=0.8976273536682129, param_norm=1887.0926513671875
Step 491: grad_norm=6.065781593322754, loss=0.9781663417816162, param_norm=1887.0927734375
23:30:22.453 [I] Progress on: 491it/1.00kit rate:8.8s/it remaining:1:15:03 elapsed:1:13:44 postfix:- (3484008:tqdm_logging.py:145)
Step 492: grad_norm=6.4743218421936035, loss=0.9283151030540466, param_norm=1887.093017578125
Step 493: grad_norm=5.0575361251831055, loss=0.989392101764679, param_norm=1887.09326171875
23:30:40.094 [I] Progress on: 493it/1.00kit rate:8.8s/it remaining:1:14:38 elapsed:1:14:02 postfix:- (3484008:tqdm_logging.py:145)
Step 494: grad_norm=5.701637268066406, loss=0.9303361773490906, param_norm=1887.0933837890625
Step 495: grad_norm=9.906229019165039, loss=0.7607400417327881, param_norm=1887.0936279296875
23:30:57.726 [I] Progress on: 495it/1.00kit rate:8.8s/it remaining:1:14:17 elapsed:1:14:19 postfix:- (3484008:tqdm_logging.py:145)
Step 496: grad_norm=6.112005233764648, loss=0.870821475982666, param_norm=1887.0938720703125
Step 497: grad_norm=7.283374786376953, loss=0.8203279972076416, param_norm=1887.09423828125
23:31:15.334 [I] Progress on: 497it/1.00kit rate:8.8s/it remaining:1:13:53 elapsed:1:14:37 postfix:- (3484008:tqdm_logging.py:145)
Step 498: grad_norm=5.354565143585205, loss=0.7912039756774902, param_norm=1887.094482421875
Step 499: grad_norm=6.36061954498291, loss=0.8705226182937622, param_norm=1887.094482421875
23:31:32.975 [I] Progress on: 499it/1.00kit rate:8.8s/it remaining:1:13:37 elapsed:1:14:55 postfix:- (3484008:tqdm_logging.py:145)
Step 500: grad_norm=6.450517654418945, loss=0.9392589926719666, param_norm=1887.0947265625
23:31:42.010 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
23:31:42.010 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
23:31:42.010 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (3484008:checkpoint_manager.py:1786)
23:31:42.011 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (3484008:checkpoint_manager.py:1817)
23:31:42.011 [I] [process=0] Saving checkpoint at step 500                                        (3484008:checkpoint_manager.py:1286)
23:31:42.012 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500. (3484008:async_checkpointer.py:358)
23:31:42.013 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:31:42.014 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12 (3484008:atomicity.py:144)
23:31:42.014 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:31:42.015 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:31:42.016 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (3484008:atomicity.py:144)
23:31:42.016 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (3484008:atomicity.py:144)
23:31:42.017 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:31:42.022 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
23:31:46.199 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:31:46.204 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
23:31:46.207 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
23:31:46.208 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
23:31:46.213 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:31:46.214 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:31:46.217 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:31:46.218 [I] Preserving Checkpoint[step=400 | time=2025-03-24 03:16:55.457503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:31:46.225 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
23:31:46.236 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
23:31:46.241 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
23:31:46.242 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742787102.0104299, 'wait_for_prev_duration_secs': 0.0007028579711914062, 'checkpointer_blocking_start_time': 1742787102.0117445, 'checkpointer_blocking_duration_secs': 4.201735496520996, 'get_old_steps_start_time': 1742787106.2136467, 'get_old_steps_duration_secs': 0.011232852935791016, 'checkpoint_manager_blocking_start_time': 1742787102.0102355, 'checkpoint_manager_blocking_duration_secs': 4.231797456741333} (3484008:standard_logger.py:34)
23:31:46.246 [I] Progress on: 501it/1.00kit rate:10.1s/it remaining:1:23:55 elapsed:1:15:08 postfix:- (3484008:tqdm_logging.py:145)
23:31:54.003 [I] ChainedFuture completed 1/1 futures in 7.79 seconds.                             (3484008:future.py:137)
23:31:54.003 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 864.4 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:31:54.003 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
23:31:54.004 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12 (3484008:async_checkpointer.py:406)
23:31:54.005 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12/assets (3484008:atomicity.py:287)
23:31:54.015 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12/params (3484008:atomicity.py:287)
23:31:54.016 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500 (3484008:async_checkpointer.py:416)
23:31:54.016 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12 (3484008:async_checkpointer.py:426)
23:31:54.016 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500 (3484008:atomicity.py:287)
23:31:54.018 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/500`. (3484008:atomicity.py:548)
23:31:54.018 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
23:31:54.018 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
23:31:54.019 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
23:31:54.019 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
23:31:54.019 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 501: grad_norm=6.823004722595215, loss=0.8228825330734253, param_norm=1887.0948486328125
Step 502: grad_norm=6.775909423828125, loss=0.8416733145713806, param_norm=1887.0950927734375
23:32:03.709 [I] Progress on: 502it/1.00kit rate:9.7s/it remaining:1:20:41 elapsed:1:15:25 postfix:- (3484008:tqdm_logging.py:145)
Step 503: grad_norm=6.51010799407959, loss=0.7572957277297974, param_norm=1887.0953369140625
Step 504: grad_norm=8.26930046081543, loss=0.889051079750061, param_norm=1887.095458984375
23:32:21.396 [I] Progress on: 504it/1.00kit rate:9.3s/it remaining:1:16:33 elapsed:1:15:43 postfix:- (3484008:tqdm_logging.py:145)
Step 505: grad_norm=5.101207733154297, loss=0.8836351633071899, param_norm=1887.095703125
Step 506: grad_norm=5.093695640563965, loss=0.8810628056526184, param_norm=1887.0958251953125
23:32:39.030 [I] Progress on: 506it/1.00kit rate:9.0s/it remaining:1:14:26 elapsed:1:16:01 postfix:- (3484008:tqdm_logging.py:145)
Step 507: grad_norm=8.516741752624512, loss=1.0141561031341553, param_norm=1887.0960693359375
Step 508: grad_norm=8.078386306762695, loss=0.9359813332557678, param_norm=1887.09619140625
23:32:56.713 [I] Progress on: 508it/1.00kit rate:8.9s/it remaining:1:13:18 elapsed:1:16:18 postfix:- (3484008:tqdm_logging.py:145)
Step 509: grad_norm=5.640884876251221, loss=0.7945543527603149, param_norm=1887.096435546875
Step 510: grad_norm=5.4575514793396, loss=0.6787546873092651, param_norm=1887.0966796875
23:33:14.420 [I] Progress on: 510it/1.00kit rate:8.9s/it remaining:1:12:38 elapsed:1:16:36 postfix:- (3484008:tqdm_logging.py:145)
Step 511: grad_norm=7.514395713806152, loss=0.9670460224151611, param_norm=1887.0966796875
Step 512: grad_norm=13.293106079101562, loss=0.8190269470214844, param_norm=1887.096923828125
23:33:32.062 [I] Progress on: 512it/1.00kit rate:8.9s/it remaining:1:12:02 elapsed:1:16:54 postfix:- (3484008:tqdm_logging.py:145)
Step 513: grad_norm=6.279815196990967, loss=0.797188401222229, param_norm=1887.0970458984375
Step 514: grad_norm=6.48577880859375, loss=0.9430209398269653, param_norm=1887.097412109375
23:33:49.723 [I] Progress on: 514it/1.00kit rate:8.8s/it remaining:1:11:37 elapsed:1:17:11 postfix:- (3484008:tqdm_logging.py:145)
Step 515: grad_norm=5.415528297424316, loss=0.936948299407959, param_norm=1887.09765625
Step 516: grad_norm=6.9314775466918945, loss=0.8880049586296082, param_norm=1887.0977783203125
23:34:07.403 [I] Progress on: 516it/1.00kit rate:8.8s/it remaining:1:11:20 elapsed:1:17:29 postfix:- (3484008:tqdm_logging.py:145)
Step 517: grad_norm=10.027472496032715, loss=0.9139025211334229, param_norm=1887.097900390625
Step 518: grad_norm=10.679910659790039, loss=0.9027928709983826, param_norm=1887.0980224609375
23:34:25.054 [I] Progress on: 518it/1.00kit rate:8.8s/it remaining:1:10:57 elapsed:1:17:47 postfix:- (3484008:tqdm_logging.py:145)
Step 519: grad_norm=12.76191520690918, loss=1.0365217924118042, param_norm=1887.0982666015625
Step 520: grad_norm=6.655950546264648, loss=0.7196062803268433, param_norm=1887.098388671875
23:34:42.699 [I] Progress on: 520it/1.00kit rate:8.8s/it remaining:1:10:37 elapsed:1:18:04 postfix:- (3484008:tqdm_logging.py:145)
Step 521: grad_norm=5.679865837097168, loss=0.8132321834564209, param_norm=1887.0985107421875
Step 522: grad_norm=6.085871696472168, loss=0.7781201601028442, param_norm=1887.0987548828125
23:35:00.355 [I] Progress on: 522it/1.00kit rate:8.8s/it remaining:1:10:20 elapsed:1:18:22 postfix:- (3484008:tqdm_logging.py:145)
Step 523: grad_norm=4.985991954803467, loss=0.8461987376213074, param_norm=1887.0989990234375
Step 524: grad_norm=11.538020133972168, loss=0.6610337495803833, param_norm=1887.09912109375
23:35:18.010 [I] Progress on: 524it/1.00kit rate:8.8s/it remaining:1:10:02 elapsed:1:18:40 postfix:- (3484008:tqdm_logging.py:145)
Step 525: grad_norm=9.832253456115723, loss=0.8658791780471802, param_norm=1887.0992431640625
Step 526: grad_norm=4.720189571380615, loss=0.8434083461761475, param_norm=1887.099365234375
23:35:35.657 [I] Progress on: 526it/1.00kit rate:8.8s/it remaining:1:09:43 elapsed:1:18:57 postfix:- (3484008:tqdm_logging.py:145)
Step 527: grad_norm=5.233965873718262, loss=0.7176129817962646, param_norm=1887.099609375
Step 528: grad_norm=7.283492565155029, loss=0.699004054069519, param_norm=1887.0997314453125
23:35:53.330 [I] Progress on: 528it/1.00kit rate:8.8s/it remaining:1:09:28 elapsed:1:19:15 postfix:- (3484008:tqdm_logging.py:145)
Step 529: grad_norm=7.548730850219727, loss=0.8422508835792542, param_norm=1887.0999755859375
Step 530: grad_norm=11.211968421936035, loss=0.8085631132125854, param_norm=1887.0999755859375
23:36:10.996 [I] Progress on: 530it/1.00kit rate:8.8s/it remaining:1:09:11 elapsed:1:19:33 postfix:- (3484008:tqdm_logging.py:145)
Step 531: grad_norm=7.185042858123779, loss=0.8167983293533325, param_norm=1887.100341796875
Step 532: grad_norm=5.532561302185059, loss=0.8536254167556763, param_norm=1887.1004638671875
23:36:28.636 [I] Progress on: 532it/1.00kit rate:8.8s/it remaining:1:08:51 elapsed:1:19:50 postfix:- (3484008:tqdm_logging.py:145)
Step 533: grad_norm=5.858254909515381, loss=0.9769430160522461, param_norm=1887.1007080078125
Step 534: grad_norm=5.388108730316162, loss=0.7680185437202454, param_norm=1887.100830078125
23:36:46.393 [I] Progress on: 534it/1.00kit rate:8.8s/it remaining:1:08:33 elapsed:1:20:08 postfix:- (3484008:tqdm_logging.py:145)
Step 535: grad_norm=8.850085258483887, loss=0.8258267641067505, param_norm=1887.100830078125
Step 536: grad_norm=9.016999244689941, loss=0.7671157121658325, param_norm=1887.10107421875
23:37:04.084 [I] Progress on: 536it/1.00kit rate:8.9s/it remaining:1:08:30 elapsed:1:20:26 postfix:- (3484008:tqdm_logging.py:145)
Step 537: grad_norm=4.583975791931152, loss=0.7539404630661011, param_norm=1887.1011962890625
Step 538: grad_norm=5.219437599182129, loss=0.9105619192123413, param_norm=1887.101318359375
23:37:21.749 [I] Progress on: 538it/1.00kit rate:8.8s/it remaining:1:08:07 elapsed:1:20:44 postfix:- (3484008:tqdm_logging.py:145)
Step 539: grad_norm=4.865049362182617, loss=0.8477252125740051, param_norm=1887.1014404296875
Step 540: grad_norm=9.567934036254883, loss=0.7605952024459839, param_norm=1887.1016845703125
23:37:39.451 [I] Progress on: 540it/1.00kit rate:8.9s/it remaining:1:07:51 elapsed:1:21:01 postfix:- (3484008:tqdm_logging.py:145)
Step 541: grad_norm=9.043941497802734, loss=0.8575005531311035, param_norm=1887.1019287109375
Step 542: grad_norm=5.43098258972168, loss=0.7883099317550659, param_norm=1887.10205078125
23:37:57.168 [I] Progress on: 542it/1.00kit rate:8.9s/it remaining:1:07:33 elapsed:1:21:19 postfix:- (3484008:tqdm_logging.py:145)
Step 543: grad_norm=6.591585636138916, loss=0.8020739555358887, param_norm=1887.1021728515625
Step 544: grad_norm=8.029220581054688, loss=0.759503960609436, param_norm=1887.1024169921875
23:38:14.824 [I] Progress on: 544it/1.00kit rate:8.8s/it remaining:1:07:10 elapsed:1:21:37 postfix:- (3484008:tqdm_logging.py:145)
Step 545: grad_norm=6.2766265869140625, loss=0.7842946648597717, param_norm=1887.1025390625
Step 546: grad_norm=5.2736358642578125, loss=0.8887083530426025, param_norm=1887.1026611328125
23:38:32.460 [I] Progress on: 546it/1.00kit rate:8.8s/it remaining:1:06:49 elapsed:1:21:54 postfix:- (3484008:tqdm_logging.py:145)
Step 547: grad_norm=5.9157938957214355, loss=0.9006519913673401, param_norm=1887.1029052734375
Step 548: grad_norm=5.262039661407471, loss=0.9250943660736084, param_norm=1887.10302734375
23:38:50.088 [I] Progress on: 548it/1.00kit rate:8.8s/it remaining:1:06:27 elapsed:1:22:12 postfix:- (3484008:tqdm_logging.py:145)
Step 549: grad_norm=5.155134677886963, loss=0.8984575271606445, param_norm=1887.1031494140625
Step 550: grad_norm=4.9237775802612305, loss=0.8780957460403442, param_norm=1887.1031494140625
23:39:07.711 [I] Progress on: 550it/1.00kit rate:8.8s/it remaining:1:06:07 elapsed:1:22:29 postfix:- (3484008:tqdm_logging.py:145)
Step 551: grad_norm=9.16246223449707, loss=0.9688880443572998, param_norm=1887.1033935546875
23:39:18.947 [I] Progress on: 552it/1.00kit rate:9.5s/it remaining:1:10:48 elapsed:1:22:41 postfix:- (3484008:tqdm_logging.py:145)
Step 552: grad_norm=6.464038848876953, loss=0.7362926006317139, param_norm=1887.103515625
Step 553: grad_norm=5.755870819091797, loss=0.7522920370101929, param_norm=1887.1036376953125
23:39:36.374 [I] Progress on: 553it/1.00kit rate:9.3s/it remaining:1:09:08 elapsed:1:22:58 postfix:- (3484008:tqdm_logging.py:145)
Step 554: grad_norm=4.1028594970703125, loss=0.6154412031173706, param_norm=1887.103759765625
Step 555: grad_norm=6.9581193923950195, loss=0.7927964925765991, param_norm=1887.1038818359375
23:39:53.995 [I] Progress on: 555it/1.00kit rate:9.0s/it remaining:1:07:04 elapsed:1:23:16 postfix:- (3484008:tqdm_logging.py:145)
Step 556: grad_norm=6.885305404663086, loss=0.762822151184082, param_norm=1887.10400390625
Step 557: grad_norm=6.111979007720947, loss=0.6952350735664368, param_norm=1887.10400390625
23:40:11.633 [I] Progress on: 557it/1.00kit rate:8.9s/it remaining:1:05:54 elapsed:1:23:33 postfix:- (3484008:tqdm_logging.py:145)
Step 558: grad_norm=4.19556999206543, loss=0.7713062763214111, param_norm=1887.104248046875
Step 559: grad_norm=5.631019592285156, loss=0.8284081816673279, param_norm=1887.1043701171875
23:40:29.236 [I] Progress on: 559it/1.00kit rate:8.9s/it remaining:1:05:09 elapsed:1:23:51 postfix:- (3484008:tqdm_logging.py:145)
Step 560: grad_norm=5.595297336578369, loss=0.7860302925109863, param_norm=1887.1044921875
Step 561: grad_norm=5.119967460632324, loss=0.7736338376998901, param_norm=1887.1046142578125
23:40:46.887 [I] Progress on: 561it/1.00kit rate:8.8s/it remaining:1:04:42 elapsed:1:24:09 postfix:- (3484008:tqdm_logging.py:145)
Step 562: grad_norm=4.080048561096191, loss=0.7026538252830505, param_norm=1887.104736328125
Step 563: grad_norm=8.104289054870605, loss=0.7602357268333435, param_norm=1887.10498046875
23:41:04.532 [I] Progress on: 563it/1.00kit rate:8.8s/it remaining:1:04:19 elapsed:1:24:26 postfix:- (3484008:tqdm_logging.py:145)
Step 564: grad_norm=9.065261840820312, loss=0.8775414824485779, param_norm=1887.105224609375
Step 565: grad_norm=8.069069862365723, loss=0.7211110591888428, param_norm=1887.105224609375
23:41:22.150 [I] Progress on: 565it/1.00kit rate:8.8s/it remaining:1:03:57 elapsed:1:24:44 postfix:- (3484008:tqdm_logging.py:145)
Step 566: grad_norm=7.394952297210693, loss=0.9234252572059631, param_norm=1887.10546875
Step 567: grad_norm=5.173553943634033, loss=0.5611388683319092, param_norm=1887.1055908203125
23:41:39.811 [I] Progress on: 567it/1.00kit rate:8.8s/it remaining:1:03:41 elapsed:1:25:02 postfix:- (3484008:tqdm_logging.py:145)
Step 568: grad_norm=4.590444087982178, loss=0.6482138633728027, param_norm=1887.105712890625
Step 569: grad_norm=4.2839579582214355, loss=0.6805902719497681, param_norm=1887.1058349609375
23:41:57.464 [I] Progress on: 569it/1.00kit rate:8.8s/it remaining:1:03:24 elapsed:1:25:19 postfix:- (3484008:tqdm_logging.py:145)
Step 570: grad_norm=3.835998773574829, loss=0.5270116329193115, param_norm=1887.1060791015625
Step 571: grad_norm=5.128787517547607, loss=0.8263932466506958, param_norm=1887.1060791015625
23:42:15.090 [I] Progress on: 571it/1.00kit rate:8.8s/it remaining:1:03:00 elapsed:1:25:37 postfix:- (3484008:tqdm_logging.py:145)
Step 572: grad_norm=5.905843257904053, loss=0.849024772644043, param_norm=1887.106201171875
Step 573: grad_norm=5.524466037750244, loss=0.7216843366622925, param_norm=1887.1063232421875
23:42:32.801 [I] Progress on: 573it/1.00kit rate:8.8s/it remaining:1:02:51 elapsed:1:25:55 postfix:- (3484008:tqdm_logging.py:145)
Step 574: grad_norm=4.596415996551514, loss=0.7045650482177734, param_norm=1887.1065673828125
Step 575: grad_norm=7.394655704498291, loss=0.6913251280784607, param_norm=1887.1068115234375
23:42:50.510 [I] Progress on: 575it/1.00kit rate:8.8s/it remaining:1:02:39 elapsed:1:26:12 postfix:- (3484008:tqdm_logging.py:145)
Step 576: grad_norm=5.698256015777588, loss=0.6147902011871338, param_norm=1887.1068115234375
Step 577: grad_norm=5.387332439422607, loss=0.8209199905395508, param_norm=1887.1070556640625
23:43:08.161 [I] Progress on: 577it/1.00kit rate:8.8s/it remaining:1:02:18 elapsed:1:26:30 postfix:- (3484008:tqdm_logging.py:145)
Step 578: grad_norm=4.496542453765869, loss=0.6849570274353027, param_norm=1887.107177734375
Step 579: grad_norm=5.0447587966918945, loss=0.8108956217765808, param_norm=1887.107421875
23:43:25.884 [I] Progress on: 579it/1.00kit rate:8.8s/it remaining:1:02:05 elapsed:1:26:48 postfix:- (3484008:tqdm_logging.py:145)
Step 580: grad_norm=5.865760803222656, loss=0.8330788612365723, param_norm=1887.1075439453125
Step 581: grad_norm=3.785677671432495, loss=0.6737015247344971, param_norm=1887.107666015625
23:43:43.540 [I] Progress on: 581it/1.00kit rate:8.8s/it remaining:1:01:43 elapsed:1:27:05 postfix:- (3484008:tqdm_logging.py:145)
Step 582: grad_norm=5.223525047302246, loss=0.7336846590042114, param_norm=1887.1077880859375
Step 583: grad_norm=4.651937961578369, loss=0.566973090171814, param_norm=1887.10791015625
23:44:01.218 [I] Progress on: 583it/1.00kit rate:8.8s/it remaining:1:01:25 elapsed:1:27:23 postfix:- (3484008:tqdm_logging.py:145)
Step 584: grad_norm=5.735792636871338, loss=0.8134129047393799, param_norm=1887.108154296875
Step 585: grad_norm=4.504108428955078, loss=0.7309484481811523, param_norm=1887.1082763671875
23:44:18.856 [I] Progress on: 585it/1.00kit rate:8.8s/it remaining:1:01:03 elapsed:1:27:41 postfix:- (3484008:tqdm_logging.py:145)
Step 586: grad_norm=6.59119176864624, loss=0.7595638632774353, param_norm=1887.1082763671875
Step 587: grad_norm=3.9653427600860596, loss=0.6781649589538574, param_norm=1887.1083984375
23:44:36.514 [I] Progress on: 587it/1.00kit rate:8.8s/it remaining:1:00:46 elapsed:1:27:58 postfix:- (3484008:tqdm_logging.py:145)
Step 588: grad_norm=7.354309558868408, loss=0.8262767791748047, param_norm=1887.1085205078125
Step 589: grad_norm=4.38704252243042, loss=0.6659475564956665, param_norm=1887.108642578125
23:44:54.173 [I] Progress on: 589it/1.00kit rate:8.8s/it remaining:1:00:29 elapsed:1:28:16 postfix:- (3484008:tqdm_logging.py:145)
Step 590: grad_norm=4.666484355926514, loss=0.706974983215332, param_norm=1887.1087646484375
Step 591: grad_norm=4.967360019683838, loss=0.7657175660133362, param_norm=1887.10888671875
23:45:11.837 [I] Progress on: 591it/1.00kit rate:8.8s/it remaining:1:00:11 elapsed:1:28:34 postfix:- (3484008:tqdm_logging.py:145)
Step 592: grad_norm=4.559347629547119, loss=0.7576791048049927, param_norm=1887.1090087890625
Step 593: grad_norm=6.240209102630615, loss=0.7179006934165955, param_norm=1887.1092529296875
23:45:29.473 [I] Progress on: 593it/1.00kit rate:8.8s/it remaining:59:51 elapsed:1:28:51 postfix:- (3484008:tqdm_logging.py:145)
Step 594: grad_norm=5.406534671783447, loss=0.7088631391525269, param_norm=1887.1092529296875
Step 595: grad_norm=5.054596424102783, loss=0.7606217861175537, param_norm=1887.109375
23:45:47.154 [I] Progress on: 595it/1.00kit rate:8.8s/it remaining:59:37 elapsed:1:29:09 postfix:- (3484008:tqdm_logging.py:145)
Step 596: grad_norm=6.685121536254883, loss=0.9496301412582397, param_norm=1887.109375
Step 597: grad_norm=7.131544589996338, loss=0.8111535310745239, param_norm=1887.109619140625
23:46:04.873 [I] Progress on: 597it/1.00kit rate:8.8s/it remaining:59:24 elapsed:1:29:27 postfix:- (3484008:tqdm_logging.py:145)
Step 598: grad_norm=5.941779136657715, loss=0.7292693853378296, param_norm=1887.109619140625
Step 599: grad_norm=6.764699459075928, loss=0.6587656140327454, param_norm=1887.10986328125
23:46:22.509 [I] Progress on: 599it/1.00kit rate:8.8s/it remaining:59:02 elapsed:1:29:44 postfix:- (3484008:tqdm_logging.py:145)
Step 600: grad_norm=5.249120712280273, loss=0.8057971000671387, param_norm=1887.10986328125
23:46:31.538 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
23:46:31.539 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
23:46:31.539 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (3484008:checkpoint_manager.py:1786)
23:46:31.539 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (3484008:checkpoint_manager.py:1817)
23:46:31.539 [I] [process=0] Saving checkpoint at step 600                                        (3484008:checkpoint_manager.py:1286)
23:46:31.540 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600. (3484008:async_checkpointer.py:358)
23:46:31.541 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:46:31.542 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15 (3484008:atomicity.py:144)
23:46:31.542 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:46:31.543 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
23:46:31.544 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (3484008:atomicity.py:144)
23:46:31.544 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (3484008:atomicity.py:144)
23:46:31.545 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
23:46:31.550 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
23:46:35.261 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:46:35.267 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
23:46:35.270 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
23:46:35.274 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
23:46:35.282 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:46:35.288 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:46:35.293 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:46:35.302 [I] Preserving Checkpoint[step=400 | time=2025-03-24 03:16:55.457503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:46:35.308 [I] Preserving Checkpoint[step=500 | time=2025-03-24 03:31:46.213544+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
23:46:35.309 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
23:46:35.315 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
23:46:35.329 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
23:46:35.334 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742787991.5387366, 'wait_for_prev_duration_secs': 0.0007586479187011719, 'checkpointer_blocking_start_time': 1742787991.5401173, 'checkpointer_blocking_duration_secs': 3.741881847381592, 'get_old_steps_start_time': 1742787995.2823339, 'get_old_steps_duration_secs': 0.027033329010009766, 'checkpoint_manager_blocking_start_time': 1742787991.5385416, 'checkpoint_manager_blocking_duration_secs': 3.7958099842071533} (3484008:standard_logger.py:34)
23:46:35.340 [I] Progress on: 601it/1.00kit rate:10.0s/it remaining:1:06:17 elapsed:1:29:57 postfix:- (3484008:tqdm_logging.py:145)
23:46:43.321 [I] ChainedFuture completed 1/1 futures in 8.04 seconds.                             (3484008:future.py:137)
23:46:43.321 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 879.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
23:46:43.322 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
23:46:43.322 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15 (3484008:async_checkpointer.py:406)
23:46:43.322 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15/assets (3484008:atomicity.py:287)
23:46:43.331 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15/params (3484008:atomicity.py:287)
23:46:43.331 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600 (3484008:async_checkpointer.py:416)
23:46:43.331 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15 (3484008:async_checkpointer.py:426)
23:46:43.331 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600 (3484008:atomicity.py:287)
23:46:43.332 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/600`. (3484008:atomicity.py:548)
23:46:43.333 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
23:46:43.333 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
23:46:43.333 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
23:46:43.334 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
23:46:43.334 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 601: grad_norm=8.111227989196777, loss=0.6511522531509399, param_norm=1887.1099853515625
Step 602: grad_norm=4.564513206481934, loss=0.7171101570129395, param_norm=1887.110107421875
23:46:52.849 [I] Progress on: 602it/1.00kit rate:9.6s/it remaining:1:03:59 elapsed:1:30:15 postfix:- (3484008:tqdm_logging.py:145)
Step 603: grad_norm=6.596380710601807, loss=0.7315798997879028, param_norm=1887.1102294921875
Step 604: grad_norm=5.102671146392822, loss=0.8513636589050293, param_norm=1887.1104736328125
23:47:10.494 [I] Progress on: 604it/1.00kit rate:9.2s/it remaining:1:00:53 elapsed:1:30:32 postfix:- (3484008:tqdm_logging.py:145)
Step 605: grad_norm=7.436920166015625, loss=0.6616787910461426, param_norm=1887.1104736328125
Step 606: grad_norm=4.528702259063721, loss=0.7153639197349548, param_norm=1887.110595703125
23:47:28.094 [I] Progress on: 606it/1.00kit rate:9.0s/it remaining:59:07 elapsed:1:30:50 postfix:- (3484008:tqdm_logging.py:145)
Step 607: grad_norm=9.36523151397705, loss=0.6550591588020325, param_norm=1887.1107177734375
Step 608: grad_norm=4.738171577453613, loss=0.6720066070556641, param_norm=1887.11083984375
23:47:45.749 [I] Progress on: 608it/1.00kit rate:8.9s/it remaining:58:14 elapsed:1:31:08 postfix:- (3484008:tqdm_logging.py:145)
Step 609: grad_norm=5.609923839569092, loss=0.9003521203994751, param_norm=1887.11083984375
Step 610: grad_norm=5.092777252197266, loss=0.7406790852546692, param_norm=1887.111083984375
23:48:03.393 [I] Progress on: 610it/1.00kit rate:8.9s/it remaining:57:38 elapsed:1:31:25 postfix:- (3484008:tqdm_logging.py:145)
Step 611: grad_norm=4.617123126983643, loss=0.6743009090423584, param_norm=1887.1112060546875
Step 612: grad_norm=5.717456817626953, loss=0.6529955267906189, param_norm=1887.111328125
23:48:21.055 [I] Progress on: 612it/1.00kit rate:8.8s/it remaining:57:13 elapsed:1:31:43 postfix:- (3484008:tqdm_logging.py:145)
Step 613: grad_norm=4.315623760223389, loss=0.8111420273780823, param_norm=1887.1114501953125
Step 614: grad_norm=4.604091167449951, loss=0.7141783833503723, param_norm=1887.1114501953125
23:48:38.708 [I] Progress on: 614it/1.00kit rate:8.8s/it remaining:56:51 elapsed:1:32:00 postfix:- (3484008:tqdm_logging.py:145)
Step 615: grad_norm=8.602551460266113, loss=0.7776923179626465, param_norm=1887.111572265625
Step 616: grad_norm=4.890974998474121, loss=0.6792691349983215, param_norm=1887.1116943359375
23:48:56.353 [I] Progress on: 616it/1.00kit rate:8.8s/it remaining:56:31 elapsed:1:32:18 postfix:- (3484008:tqdm_logging.py:145)
Step 617: grad_norm=5.459652900695801, loss=0.7341316938400269, param_norm=1887.11181640625
Step 618: grad_norm=6.144920349121094, loss=0.7136528491973877, param_norm=1887.11181640625
23:49:14.006 [I] Progress on: 618it/1.00kit rate:8.8s/it remaining:56:12 elapsed:1:32:36 postfix:- (3484008:tqdm_logging.py:145)
Step 619: grad_norm=4.358562469482422, loss=0.7380716800689697, param_norm=1887.1119384765625
Step 620: grad_norm=4.258927822113037, loss=0.532717764377594, param_norm=1887.1119384765625
23:49:31.693 [I] Progress on: 620it/1.00kit rate:8.8s/it remaining:55:57 elapsed:1:32:53 postfix:- (3484008:tqdm_logging.py:145)
Step 621: grad_norm=5.441217422485352, loss=0.705208420753479, param_norm=1887.112060546875
23:49:42.759 [I] Progress on: 621it/1.00kit rate:9.5s/it remaining:1:00:04 elapsed:1:33:05 postfix:- (3484008:tqdm_logging.py:145)
Step 622: grad_norm=3.9956953525543213, loss=0.6155133247375488, param_norm=1887.1121826171875
Step 623: grad_norm=3.738145589828491, loss=0.6409915685653687, param_norm=1887.1123046875
23:50:00.393 [I] Progress on: 623it/1.00kit rate:9.2s/it remaining:57:32 elapsed:1:33:22 postfix:- (3484008:tqdm_logging.py:145)
Step 624: grad_norm=4.1287360191345215, loss=0.6181963682174683, param_norm=1887.1123046875
Step 625: grad_norm=4.016297340393066, loss=0.5729227662086487, param_norm=1887.1124267578125
23:50:18.164 [I] Progress on: 625it/1.00kit rate:9.0s/it remaining:56:23 elapsed:1:33:40 postfix:- (3484008:tqdm_logging.py:145)
Step 626: grad_norm=4.078668117523193, loss=0.6076408624649048, param_norm=1887.1126708984375
Step 627: grad_norm=4.123398303985596, loss=0.6023984551429749, param_norm=1887.11279296875
23:50:35.814 [I] Progress on: 627it/1.00kit rate:8.9s/it remaining:55:28 elapsed:1:33:58 postfix:- (3484008:tqdm_logging.py:145)
Step 628: grad_norm=4.04301643371582, loss=0.6117027997970581, param_norm=1887.1129150390625
Step 629: grad_norm=3.882798194885254, loss=0.6051962375640869, param_norm=1887.113037109375
23:50:53.454 [I] Progress on: 629it/1.00kit rate:8.9s/it remaining:54:49 elapsed:1:34:15 postfix:- (3484008:tqdm_logging.py:145)
Step 630: grad_norm=3.8255615234375, loss=0.5620496273040771, param_norm=1887.1131591796875
Step 631: grad_norm=5.53724479675293, loss=0.6853667497634888, param_norm=1887.1134033203125
23:51:11.084 [I] Progress on: 631it/1.00kit rate:8.8s/it remaining:54:22 elapsed:1:34:33 postfix:- (3484008:tqdm_logging.py:145)
Step 632: grad_norm=5.322460651397705, loss=0.62322998046875, param_norm=1887.113525390625
Step 633: grad_norm=6.215673923492432, loss=0.5894882082939148, param_norm=1887.1136474609375
23:51:28.721 [I] Progress on: 633it/1.00kit rate:8.8s/it remaining:54:00 elapsed:1:34:50 postfix:- (3484008:tqdm_logging.py:145)
Step 634: grad_norm=4.616038799285889, loss=0.6024683713912964, param_norm=1887.11376953125
Step 635: grad_norm=7.155609607696533, loss=0.6686295866966248, param_norm=1887.1138916015625
23:51:46.372 [I] Progress on: 635it/1.00kit rate:8.8s/it remaining:53:41 elapsed:1:35:08 postfix:- (3484008:tqdm_logging.py:145)
Step 636: grad_norm=5.835284233093262, loss=0.5941682457923889, param_norm=1887.1138916015625
Step 637: grad_norm=4.370330810546875, loss=0.5393388271331787, param_norm=1887.114013671875
23:52:04.023 [I] Progress on: 637it/1.00kit rate:8.8s/it remaining:53:23 elapsed:1:35:26 postfix:- (3484008:tqdm_logging.py:145)
Step 638: grad_norm=7.0687947273254395, loss=0.6920377016067505, param_norm=1887.114013671875
Step 639: grad_norm=7.904654502868652, loss=0.6458154916763306, param_norm=1887.1141357421875
23:52:21.687 [I] Progress on: 639it/1.00kit rate:8.8s/it remaining:53:06 elapsed:1:35:43 postfix:- (3484008:tqdm_logging.py:145)
Step 640: grad_norm=5.255407810211182, loss=0.7120708227157593, param_norm=1887.1141357421875
Step 641: grad_norm=4.866464614868164, loss=0.6926833391189575, param_norm=1887.1143798828125
23:52:39.373 [I] Progress on: 641it/1.00kit rate:8.8s/it remaining:52:50 elapsed:1:36:01 postfix:- (3484008:tqdm_logging.py:145)
Step 642: grad_norm=4.670989036560059, loss=0.6579809188842773, param_norm=1887.114501953125
Step 643: grad_norm=4.9102349281311035, loss=0.6453633904457092, param_norm=1887.114501953125
23:52:57.024 [I] Progress on: 643it/1.00kit rate:8.8s/it remaining:52:31 elapsed:1:36:19 postfix:- (3484008:tqdm_logging.py:145)
Step 644: grad_norm=5.4280219078063965, loss=0.6657587885856628, param_norm=1887.11474609375
Step 645: grad_norm=5.9945549964904785, loss=0.5695502758026123, param_norm=1887.1148681640625
23:53:14.672 [I] Progress on: 645it/1.00kit rate:8.8s/it remaining:52:13 elapsed:1:36:36 postfix:- (3484008:tqdm_logging.py:145)
Step 646: grad_norm=4.21736478805542, loss=0.5436484813690186, param_norm=1887.1148681640625
Step 647: grad_norm=4.235924243927002, loss=0.5845947861671448, param_norm=1887.114990234375
23:53:32.383 [I] Progress on: 647it/1.00kit rate:8.8s/it remaining:51:59 elapsed:1:36:54 postfix:- (3484008:tqdm_logging.py:145)
Step 648: grad_norm=4.845895290374756, loss=0.5942015647888184, param_norm=1887.1151123046875
Step 649: grad_norm=4.282596588134766, loss=0.5129239559173584, param_norm=1887.115234375
23:53:50.021 [I] Progress on: 649it/1.00kit rate:8.8s/it remaining:51:39 elapsed:1:37:12 postfix:- (3484008:tqdm_logging.py:145)
Step 650: grad_norm=4.984183311462402, loss=0.6948044896125793, param_norm=1887.115234375
Step 651: grad_norm=3.806170701980591, loss=0.6599372625350952, param_norm=1887.1153564453125
23:54:07.689 [I] Progress on: 651it/1.00kit rate:8.8s/it remaining:51:20 elapsed:1:37:29 postfix:- (3484008:tqdm_logging.py:145)
Step 652: grad_norm=6.778417587280273, loss=0.6113331317901611, param_norm=1887.115478515625
Step 653: grad_norm=4.57205057144165, loss=0.4638320505619049, param_norm=1887.1156005859375
23:54:25.351 [I] Progress on: 653it/1.00kit rate:8.8s/it remaining:51:03 elapsed:1:37:47 postfix:- (3484008:tqdm_logging.py:145)
Step 654: grad_norm=4.908379554748535, loss=0.7347167730331421, param_norm=1887.1156005859375
Step 655: grad_norm=3.82100772857666, loss=0.6352620720863342, param_norm=1887.11572265625
23:54:43.017 [I] Progress on: 655it/1.00kit rate:8.8s/it remaining:50:45 elapsed:1:38:05 postfix:- (3484008:tqdm_logging.py:145)
Step 656: grad_norm=3.8060624599456787, loss=0.5317655801773071, param_norm=1887.1158447265625
Step 657: grad_norm=3.8341400623321533, loss=0.49922528862953186, param_norm=1887.115966796875
23:55:00.707 [I] Progress on: 657it/1.00kit rate:8.8s/it remaining:50:31 elapsed:1:38:22 postfix:- (3484008:tqdm_logging.py:145)
Step 658: grad_norm=4.733470439910889, loss=0.6544644832611084, param_norm=1887.115966796875
Step 659: grad_norm=3.6692590713500977, loss=0.5625945925712585, param_norm=1887.1160888671875
23:55:18.414 [I] Progress on: 659it/1.00kit rate:8.8s/it remaining:50:15 elapsed:1:38:40 postfix:- (3484008:tqdm_logging.py:145)
Step 660: grad_norm=4.42857027053833, loss=0.7105623483657837, param_norm=1887.1160888671875
Step 661: grad_norm=3.620722770690918, loss=0.5431060791015625, param_norm=1887.1162109375
23:55:36.077 [I] Progress on: 661it/1.00kit rate:8.8s/it remaining:49:56 elapsed:1:38:58 postfix:- (3484008:tqdm_logging.py:145)
Step 662: grad_norm=3.8236539363861084, loss=0.6331555247306824, param_norm=1887.1163330078125
Step 663: grad_norm=5.5075178146362305, loss=0.6363812685012817, param_norm=1887.1163330078125
23:55:53.798 [I] Progress on: 663it/1.00kit rate:8.8s/it remaining:49:40 elapsed:1:39:16 postfix:- (3484008:tqdm_logging.py:145)
Step 664: grad_norm=4.1601643562316895, loss=0.5630176663398743, param_norm=1887.116455078125
Step 665: grad_norm=4.365546703338623, loss=0.588402509689331, param_norm=1887.116455078125
23:56:11.464 [I] Progress on: 665it/1.00kit rate:8.8s/it remaining:49:21 elapsed:1:39:33 postfix:- (3484008:tqdm_logging.py:145)
Step 666: grad_norm=4.97210693359375, loss=0.6957700252532959, param_norm=1887.116455078125
Step 667: grad_norm=4.699504852294922, loss=0.6544502377510071, param_norm=1887.1165771484375
23:56:29.089 [I] Progress on: 667it/1.00kit rate:8.8s/it remaining:48:59 elapsed:1:39:51 postfix:- (3484008:tqdm_logging.py:145)
Step 668: grad_norm=4.260074138641357, loss=0.6808443665504456, param_norm=1887.11669921875
Step 669: grad_norm=3.787888288497925, loss=0.5445610284805298, param_norm=1887.11669921875
23:56:46.751 [I] Progress on: 669it/1.00kit rate:8.8s/it remaining:48:41 elapsed:1:40:09 postfix:- (3484008:tqdm_logging.py:145)
Step 670: grad_norm=4.3038105964660645, loss=0.6822912693023682, param_norm=1887.1168212890625
Step 671: grad_norm=5.103779315948486, loss=0.6069538593292236, param_norm=1887.116943359375
23:57:04.412 [I] Progress on: 671it/1.00kit rate:8.8s/it remaining:48:25 elapsed:1:40:26 postfix:- (3484008:tqdm_logging.py:145)
Step 672: grad_norm=6.111432075500488, loss=0.677433967590332, param_norm=1887.1170654296875
Step 673: grad_norm=4.562307357788086, loss=0.628354549407959, param_norm=1887.1170654296875
23:57:22.074 [I] Progress on: 673it/1.00kit rate:8.8s/it remaining:48:07 elapsed:1:40:44 postfix:- (3484008:tqdm_logging.py:145)
Step 674: grad_norm=4.325832366943359, loss=0.5542059540748596, param_norm=1887.1171875
Step 675: grad_norm=5.29246187210083, loss=0.7657145261764526, param_norm=1887.1173095703125
23:57:39.733 [I] Progress on: 675it/1.00kit rate:8.8s/it remaining:47:49 elapsed:1:41:01 postfix:- (3484008:tqdm_logging.py:145)
Step 676: grad_norm=3.943455219268799, loss=0.6032748818397522, param_norm=1887.117431640625
Step 677: grad_norm=6.046566009521484, loss=0.5503019690513611, param_norm=1887.1175537109375
23:57:57.465 [I] Progress on: 677it/1.00kit rate:8.8s/it remaining:47:36 elapsed:1:41:19 postfix:- (3484008:tqdm_logging.py:145)
Step 678: grad_norm=4.787103176116943, loss=0.7049764394760132, param_norm=1887.1175537109375
Step 679: grad_norm=5.168411731719971, loss=0.5969031453132629, param_norm=1887.11767578125
23:58:15.204 [I] Progress on: 679it/1.00kit rate:8.9s/it remaining:47:23 elapsed:1:41:37 postfix:- (3484008:tqdm_logging.py:145)
Step 680: grad_norm=7.029439449310303, loss=0.5803207159042358, param_norm=1887.11767578125
Step 681: grad_norm=5.598100662231445, loss=0.6171882748603821, param_norm=1887.11767578125
23:58:32.879 [I] Progress on: 681it/1.00kit rate:8.9s/it remaining:47:03 elapsed:1:41:55 postfix:- (3484008:tqdm_logging.py:145)
Step 682: grad_norm=4.621200084686279, loss=0.6350845098495483, param_norm=1887.1177978515625
Step 683: grad_norm=5.424975395202637, loss=0.5647958517074585, param_norm=1887.1177978515625
23:58:50.535 [I] Progress on: 683it/1.00kit rate:8.8s/it remaining:46:41 elapsed:1:42:12 postfix:- (3484008:tqdm_logging.py:145)
Step 684: grad_norm=3.4345757961273193, loss=0.5454851984977722, param_norm=1887.117919921875
Step 685: grad_norm=5.770686149597168, loss=0.5946166515350342, param_norm=1887.117919921875
23:59:08.195 [I] Progress on: 685it/1.00kit rate:8.8s/it remaining:46:22 elapsed:1:42:30 postfix:- (3484008:tqdm_logging.py:145)
Step 686: grad_norm=5.3306803703308105, loss=0.6418554782867432, param_norm=1887.117919921875
Step 687: grad_norm=4.449934959411621, loss=0.6894068121910095, param_norm=1887.1180419921875
23:59:25.847 [I] Progress on: 687it/1.00kit rate:8.8s/it remaining:46:03 elapsed:1:42:48 postfix:- (3484008:tqdm_logging.py:145)
Step 688: grad_norm=7.835917949676514, loss=0.7194591164588928, param_norm=1887.1181640625
Step 689: grad_norm=5.241569519042969, loss=0.5091109275817871, param_norm=1887.1181640625
23:59:43.490 [I] Progress on: 689it/1.00kit rate:8.8s/it remaining:45:44 elapsed:1:43:05 postfix:- (3484008:tqdm_logging.py:145)
Step 690: grad_norm=3.3150205612182617, loss=0.5306037068367004, param_norm=1887.1182861328125
23:59:54.561 [I] Progress on: 690it/1.00kit rate:9.5s/it remaining:49:05 elapsed:1:43:16 postfix:- (3484008:tqdm_logging.py:145)
Step 691: grad_norm=3.167800188064575, loss=0.5696995854377747, param_norm=1887.1182861328125
Step 692: grad_norm=5.775899410247803, loss=0.5623364448547363, param_norm=1887.1182861328125
00:00:12.182 [I] Progress on: 692it/1.00kit rate:9.2s/it remaining:46:58 elapsed:1:43:34 postfix:- (3484008:tqdm_logging.py:145)
Step 693: grad_norm=3.2233388423919678, loss=0.5622082948684692, param_norm=1887.118408203125
Step 694: grad_norm=3.593268632888794, loss=0.5341202020645142, param_norm=1887.118408203125
00:00:29.827 [I] Progress on: 694it/1.00kit rate:9.0s/it remaining:45:47 elapsed:1:43:52 postfix:- (3484008:tqdm_logging.py:145)
Step 695: grad_norm=3.5030407905578613, loss=0.47782304883003235, param_norm=1887.118408203125
Step 696: grad_norm=3.8318734169006348, loss=0.5414962768554688, param_norm=1887.11865234375
00:00:47.423 [I] Progress on: 696it/1.00kit rate:8.9s/it remaining:45:00 elapsed:1:44:09 postfix:- (3484008:tqdm_logging.py:145)
Step 697: grad_norm=4.466126441955566, loss=0.5316048264503479, param_norm=1887.11865234375
Step 698: grad_norm=3.818054676055908, loss=0.5512621402740479, param_norm=1887.1187744140625
00:01:05.078 [I] Progress on: 698it/1.00kit rate:8.9s/it remaining:44:34 elapsed:1:44:27 postfix:- (3484008:tqdm_logging.py:145)
Step 699: grad_norm=3.6257872581481934, loss=0.531762957572937, param_norm=1887.1187744140625
Step 700: grad_norm=3.168595790863037, loss=0.4454640746116638, param_norm=1887.118896484375
00:01:22.783 [I] Progress on: 700it/1.00kit rate:8.9s/it remaining:44:15 elapsed:1:44:45 postfix:- (3484008:tqdm_logging.py:145)
00:01:23.027 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
00:01:23.028 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
00:01:23.028 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (3484008:checkpoint_manager.py:1786)
00:01:23.028 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (3484008:checkpoint_manager.py:1817)
00:01:23.029 [I] [process=0] Saving checkpoint at step 700                                        (3484008:checkpoint_manager.py:1286)
00:01:23.029 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700. (3484008:async_checkpointer.py:358)
00:01:23.030 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:01:23.031 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18 (3484008:atomicity.py:144)
00:01:23.032 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:01:23.032 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:01:23.033 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (3484008:atomicity.py:144)
00:01:23.033 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (3484008:atomicity.py:144)
00:01:23.034 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:01:23.039 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
00:01:26.684 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
00:01:26.686 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:01:26.687 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
00:01:26.688 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
00:01:26.713 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:01:26.719 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:01:26.721 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:01:26.722 [I] Preserving Checkpoint[step=400 | time=2025-03-24 03:16:55.457503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:01:26.723 [I] Preserving Checkpoint[step=500 | time=2025-03-24 03:31:46.213544+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:01:26.725 [I] Preserving Checkpoint[step=600 | time=2025-03-24 03:46:35.282092+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:01:26.725 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
00:01:26.725 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
00:01:26.726 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
00:01:26.727 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742788883.0278487, 'wait_for_prev_duration_secs': 0.0007367134094238281, 'checkpointer_blocking_start_time': 1742788883.0291877, 'checkpointer_blocking_duration_secs': 3.6840312480926514, 'get_old_steps_start_time': 1742788886.7132776, 'get_old_steps_duration_secs': 0.012212276458740234, 'checkpoint_manager_blocking_start_time': 1742788883.0276446, 'checkpoint_manager_blocking_duration_secs': 3.699324607849121} (3484008:standard_logger.py:34)
00:01:34.093 [I] ChainedFuture completed 1/1 futures in 7.39 seconds.                             (3484008:future.py:137)
00:01:34.094 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 936.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:01:34.094 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
00:01:34.094 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18 (3484008:async_checkpointer.py:406)
00:01:34.095 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18/assets (3484008:atomicity.py:287)
00:01:34.103 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18/params (3484008:atomicity.py:287)
00:01:34.103 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700 (3484008:async_checkpointer.py:416)
00:01:34.103 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18 (3484008:async_checkpointer.py:426)
00:01:34.103 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700 (3484008:atomicity.py:287)
00:01:34.104 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/700`. (3484008:atomicity.py:548)
00:01:34.104 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
00:01:34.105 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
00:01:34.105 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
00:01:34.105 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
00:01:34.106 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 701: grad_norm=5.173880577087402, loss=0.5593273639678955, param_norm=1887.1190185546875
00:01:35.335 [I] Progress on: 701it/1.00kit rate:10.0s/it remaining:49:40 elapsed:1:44:57 postfix:- (3484008:tqdm_logging.py:145)
Step 702: grad_norm=3.747877836227417, loss=0.5810636878013611, param_norm=1887.119140625
Step 703: grad_norm=3.95892071723938, loss=0.5086991786956787, param_norm=1887.119140625
00:01:52.971 [I] Progress on: 703it/1.00kit rate:9.4s/it remaining:46:25 elapsed:1:45:15 postfix:- (3484008:tqdm_logging.py:145)
Step 704: grad_norm=6.4377121925354, loss=0.6538960933685303, param_norm=1887.1192626953125
Step 705: grad_norm=3.847769260406494, loss=0.5204594135284424, param_norm=1887.1192626953125
00:02:10.610 [I] Progress on: 705it/1.00kit rate:9.1s/it remaining:44:42 elapsed:1:45:32 postfix:- (3484008:tqdm_logging.py:145)
Step 706: grad_norm=5.11268424987793, loss=0.6085034608840942, param_norm=1887.119384765625
Step 707: grad_norm=4.8907647132873535, loss=0.6149474382400513, param_norm=1887.119384765625
00:02:28.199 [I] Progress on: 707it/1.00kit rate:8.9s/it remaining:43:39 elapsed:1:45:50 postfix:- (3484008:tqdm_logging.py:145)
Step 708: grad_norm=4.343927383422852, loss=0.5185279846191406, param_norm=1887.1195068359375
Step 709: grad_norm=3.8277084827423096, loss=0.5869557857513428, param_norm=1887.1195068359375
00:02:45.870 [I] Progress on: 709it/1.00kit rate:8.9s/it remaining:43:05 elapsed:1:46:08 postfix:- (3484008:tqdm_logging.py:145)
Step 710: grad_norm=4.3765106201171875, loss=0.6265243887901306, param_norm=1887.11962890625
Step 711: grad_norm=3.3096816539764404, loss=0.534958004951477, param_norm=1887.1197509765625
00:03:03.534 [I] Progress on: 711it/1.00kit rate:8.9s/it remaining:42:39 elapsed:1:46:25 postfix:- (3484008:tqdm_logging.py:145)
Step 712: grad_norm=3.802443265914917, loss=0.5374441742897034, param_norm=1887.1197509765625
Step 713: grad_norm=4.241487503051758, loss=0.5659429430961609, param_norm=1887.119873046875
00:03:21.196 [I] Progress on: 713it/1.00kit rate:8.8s/it remaining:42:17 elapsed:1:46:43 postfix:- (3484008:tqdm_logging.py:145)
Step 714: grad_norm=4.756914138793945, loss=0.5824775695800781, param_norm=1887.1199951171875
Step 715: grad_norm=4.2502760887146, loss=0.5110527873039246, param_norm=1887.1199951171875
00:03:38.873 [I] Progress on: 715it/1.00kit rate:8.8s/it remaining:41:59 elapsed:1:47:01 postfix:- (3484008:tqdm_logging.py:145)
Step 716: grad_norm=4.528378009796143, loss=0.5133578181266785, param_norm=1887.1201171875
Step 717: grad_norm=4.098869323730469, loss=0.5090541243553162, param_norm=1887.1201171875
00:03:56.597 [I] Progress on: 717it/1.00kit rate:8.8s/it remaining:41:44 elapsed:1:47:18 postfix:- (3484008:tqdm_logging.py:145)
Step 718: grad_norm=3.084104299545288, loss=0.4904462695121765, param_norm=1887.1202392578125
Step 719: grad_norm=7.054766654968262, loss=0.5720697045326233, param_norm=1887.1202392578125
00:04:14.279 [I] Progress on: 719it/1.00kit rate:8.8s/it remaining:41:24 elapsed:1:47:36 postfix:- (3484008:tqdm_logging.py:145)
Step 720: grad_norm=3.98154616355896, loss=0.49996352195739746, param_norm=1887.120361328125
Step 721: grad_norm=5.977914333343506, loss=0.5826846957206726, param_norm=1887.120361328125
00:04:31.995 [I] Progress on: 721it/1.00kit rate:8.9s/it remaining:41:09 elapsed:1:47:54 postfix:- (3484008:tqdm_logging.py:145)
Step 722: grad_norm=5.153139114379883, loss=0.6434594392776489, param_norm=1887.120361328125
Step 723: grad_norm=3.808136463165283, loss=0.5079798102378845, param_norm=1887.1204833984375
00:04:49.688 [I] Progress on: 723it/1.00kit rate:8.8s/it remaining:40:51 elapsed:1:48:11 postfix:- (3484008:tqdm_logging.py:145)
Step 724: grad_norm=3.84712553024292, loss=0.5498474836349487, param_norm=1887.1204833984375
Step 725: grad_norm=2.912700891494751, loss=0.3706948757171631, param_norm=1887.12060546875
00:05:07.346 [I] Progress on: 725it/1.00kit rate:8.8s/it remaining:40:30 elapsed:1:48:29 postfix:- (3484008:tqdm_logging.py:145)
Step 726: grad_norm=4.444907188415527, loss=0.577057421207428, param_norm=1887.1207275390625
Step 727: grad_norm=5.348758220672607, loss=0.5383751392364502, param_norm=1887.1207275390625
00:05:25.031 [I] Progress on: 727it/1.00kit rate:8.8s/it remaining:40:13 elapsed:1:48:47 postfix:- (3484008:tqdm_logging.py:145)
Step 728: grad_norm=4.457663536071777, loss=0.5631421208381653, param_norm=1887.1207275390625
Step 729: grad_norm=5.642446517944336, loss=0.5589557886123657, param_norm=1887.120849609375
00:05:42.709 [I] Progress on: 729it/1.00kit rate:8.8s/it remaining:39:54 elapsed:1:49:04 postfix:- (3484008:tqdm_logging.py:145)
Step 730: grad_norm=3.310770034790039, loss=0.47081223130226135, param_norm=1887.120849609375
Step 731: grad_norm=3.4524526596069336, loss=0.4942791759967804, param_norm=1887.1209716796875
00:06:00.361 [I] Progress on: 731it/1.00kit rate:8.8s/it remaining:39:35 elapsed:1:49:22 postfix:- (3484008:tqdm_logging.py:145)
Step 732: grad_norm=3.3845767974853516, loss=0.552820086479187, param_norm=1887.1209716796875
Step 733: grad_norm=4.6612629890441895, loss=0.5951462388038635, param_norm=1887.1209716796875
00:06:18.017 [I] Progress on: 733it/1.00kit rate:8.8s/it remaining:39:16 elapsed:1:49:40 postfix:- (3484008:tqdm_logging.py:145)
Step 734: grad_norm=5.3976054191589355, loss=0.5885468125343323, param_norm=1887.12109375
Step 735: grad_norm=4.355294227600098, loss=0.5872037410736084, param_norm=1887.12109375
00:06:35.676 [I] Progress on: 735it/1.00kit rate:8.8s/it remaining:38:58 elapsed:1:49:57 postfix:- (3484008:tqdm_logging.py:145)
Step 736: grad_norm=4.993940830230713, loss=0.45215722918510437, param_norm=1887.12109375
Step 737: grad_norm=3.3290481567382812, loss=0.44316691160202026, param_norm=1887.12109375
00:06:53.314 [I] Progress on: 737it/1.00kit rate:8.8s/it remaining:38:41 elapsed:1:50:15 postfix:- (3484008:tqdm_logging.py:145)
Step 738: grad_norm=3.1069133281707764, loss=0.4483371376991272, param_norm=1887.1212158203125
Step 739: grad_norm=3.3543179035186768, loss=0.5037391781806946, param_norm=1887.1212158203125
00:07:10.977 [I] Progress on: 739it/1.00kit rate:8.8s/it remaining:38:23 elapsed:1:50:33 postfix:- (3484008:tqdm_logging.py:145)
Step 740: grad_norm=4.0033392906188965, loss=0.47262853384017944, param_norm=1887.1212158203125
Step 741: grad_norm=3.3863086700439453, loss=0.44015878438949585, param_norm=1887.121337890625
00:07:28.623 [I] Progress on: 741it/1.00kit rate:8.8s/it remaining:38:05 elapsed:1:50:50 postfix:- (3484008:tqdm_logging.py:145)
Step 742: grad_norm=4.257422924041748, loss=0.5155209302902222, param_norm=1887.121337890625
Step 743: grad_norm=5.999257564544678, loss=0.534603476524353, param_norm=1887.1214599609375
00:07:46.324 [I] Progress on: 743it/1.00kit rate:8.8s/it remaining:37:51 elapsed:1:51:08 postfix:- (3484008:tqdm_logging.py:145)
Step 744: grad_norm=3.942807197570801, loss=0.4687536358833313, param_norm=1887.1214599609375
Step 745: grad_norm=4.74839448928833, loss=0.5309237241744995, param_norm=1887.1214599609375
00:08:03.971 [I] Progress on: 745it/1.00kit rate:8.8s/it remaining:37:31 elapsed:1:51:26 postfix:- (3484008:tqdm_logging.py:145)
Step 746: grad_norm=3.2066304683685303, loss=0.48918914794921875, param_norm=1887.12158203125
Step 747: grad_norm=4.621206760406494, loss=0.5104501843452454, param_norm=1887.12158203125
00:08:21.691 [I] Progress on: 747it/1.00kit rate:8.8s/it remaining:37:17 elapsed:1:51:43 postfix:- (3484008:tqdm_logging.py:145)
Step 748: grad_norm=3.828312873840332, loss=0.4303467869758606, param_norm=1887.1217041015625
Step 749: grad_norm=3.0984792709350586, loss=0.38028785586357117, param_norm=1887.12158203125
00:08:39.352 [I] Progress on: 749it/1.00kit rate:8.8s/it remaining:36:58 elapsed:1:52:01 postfix:- (3484008:tqdm_logging.py:145)
Step 750: grad_norm=3.7291111946105957, loss=0.48304444551467896, param_norm=1887.121826171875
Step 751: grad_norm=4.479580879211426, loss=0.5965428352355957, param_norm=1887.1217041015625
00:08:57.007 [I] Progress on: 751it/1.00kit rate:8.8s/it remaining:36:39 elapsed:1:52:19 postfix:- (3484008:tqdm_logging.py:145)
Step 752: grad_norm=4.075592041015625, loss=0.5350217819213867, param_norm=1887.121826171875
Step 753: grad_norm=3.8810698986053467, loss=0.608525812625885, param_norm=1887.121826171875
00:09:14.699 [I] Progress on: 753it/1.00kit rate:8.8s/it remaining:36:22 elapsed:1:52:36 postfix:- (3484008:tqdm_logging.py:145)
Step 754: grad_norm=4.066590785980225, loss=0.45870348811149597, param_norm=1887.1220703125
Step 755: grad_norm=4.676249027252197, loss=0.5012832283973694, param_norm=1887.1220703125
00:09:32.364 [I] Progress on: 755it/1.00kit rate:8.8s/it remaining:36:04 elapsed:1:52:54 postfix:- (3484008:tqdm_logging.py:145)
Step 756: grad_norm=4.080417156219482, loss=0.5920923948287964, param_norm=1887.1220703125
Step 757: grad_norm=3.7704484462738037, loss=0.6086958050727844, param_norm=1887.1220703125
00:09:50.011 [I] Progress on: 757it/1.00kit rate:8.8s/it remaining:35:45 elapsed:1:53:12 postfix:- (3484008:tqdm_logging.py:145)
Step 758: grad_norm=4.4985857009887695, loss=0.5048713684082031, param_norm=1887.1220703125
00:10:01.251 [I] Progress on: 759it/1.00kit rate:9.5s/it remaining:38:06 elapsed:1:53:23 postfix:- (3484008:tqdm_logging.py:145)
Step 759: grad_norm=2.617338180541992, loss=0.3428906798362732, param_norm=1887.1221923828125
Step 760: grad_norm=3.0700204372406006, loss=0.4413437843322754, param_norm=1887.122314453125
00:10:18.707 [I] Progress on: 760it/1.00kit rate:9.3s/it remaining:37:09 elapsed:1:53:40 postfix:- (3484008:tqdm_logging.py:145)
Step 761: grad_norm=4.859355926513672, loss=0.5043485760688782, param_norm=1887.1221923828125
Step 762: grad_norm=5.337993144989014, loss=0.4824371337890625, param_norm=1887.122314453125
00:10:36.365 [I] Progress on: 762it/1.00kit rate:9.1s/it remaining:35:54 elapsed:1:53:58 postfix:- (3484008:tqdm_logging.py:145)
Step 763: grad_norm=4.163944721221924, loss=0.49483487010002136, param_norm=1887.122314453125
Step 764: grad_norm=6.221024990081787, loss=0.45569971203804016, param_norm=1887.122314453125
00:10:54.108 [I] Progress on: 764it/1.00kit rate:9.0s/it remaining:35:15 elapsed:1:54:16 postfix:- (3484008:tqdm_logging.py:145)
Step 765: grad_norm=4.03794002532959, loss=0.4578397274017334, param_norm=1887.1224365234375
Step 766: grad_norm=3.524217367172241, loss=0.43401476740837097, param_norm=1887.1224365234375
00:11:11.785 [I] Progress on: 766it/1.00kit rate:8.9s/it remaining:34:42 elapsed:1:54:34 postfix:- (3484008:tqdm_logging.py:145)
Step 767: grad_norm=4.101136207580566, loss=0.41282886266708374, param_norm=1887.12255859375
Step 768: grad_norm=3.0611424446105957, loss=0.4389110207557678, param_norm=1887.12255859375
00:11:29.486 [I] Progress on: 768it/1.00kit rate:8.9s/it remaining:34:18 elapsed:1:54:51 postfix:- (3484008:tqdm_logging.py:145)
Step 769: grad_norm=2.925673246383667, loss=0.398649126291275, param_norm=1887.1226806640625
Step 770: grad_norm=5.878355503082275, loss=0.5100772380828857, param_norm=1887.1226806640625
00:11:47.167 [I] Progress on: 770it/1.00kit rate:8.9s/it remaining:33:57 elapsed:1:55:09 postfix:- (3484008:tqdm_logging.py:145)
Step 771: grad_norm=3.7280821800231934, loss=0.45180949568748474, param_norm=1887.1226806640625
Step 772: grad_norm=3.9300966262817383, loss=0.40879353880882263, param_norm=1887.122802734375
00:12:04.913 [I] Progress on: 772it/1.00kit rate:8.9s/it remaining:33:42 elapsed:1:55:27 postfix:- (3484008:tqdm_logging.py:145)
Step 773: grad_norm=3.0974206924438477, loss=0.49320608377456665, param_norm=1887.1229248046875
Step 774: grad_norm=3.688091278076172, loss=0.4735940992832184, param_norm=1887.1229248046875
00:12:22.565 [I] Progress on: 774it/1.00kit rate:8.8s/it remaining:33:20 elapsed:1:55:44 postfix:- (3484008:tqdm_logging.py:145)
Step 775: grad_norm=3.4041829109191895, loss=0.42984962463378906, param_norm=1887.123046875
Step 776: grad_norm=3.0046324729919434, loss=0.3864976167678833, param_norm=1887.123046875
00:12:40.231 [I] Progress on: 776it/1.00kit rate:8.8s/it remaining:33:00 elapsed:1:56:02 postfix:- (3484008:tqdm_logging.py:145)
Step 777: grad_norm=3.6919212341308594, loss=0.49409377574920654, param_norm=1887.123046875
Step 778: grad_norm=4.5236406326293945, loss=0.4532274901866913, param_norm=1887.123046875
00:12:57.984 [I] Progress on: 778it/1.00kit rate:8.9s/it remaining:32:47 elapsed:1:56:20 postfix:- (3484008:tqdm_logging.py:145)
Step 779: grad_norm=3.5275380611419678, loss=0.4536610543727875, param_norm=1887.1231689453125
Step 780: grad_norm=4.119913578033447, loss=0.5007906556129456, param_norm=1887.1231689453125
00:13:15.644 [I] Progress on: 780it/1.00kit rate:8.8s/it remaining:32:26 elapsed:1:56:37 postfix:- (3484008:tqdm_logging.py:145)
Step 781: grad_norm=3.5780367851257324, loss=0.4179702401161194, param_norm=1887.1231689453125
Step 782: grad_norm=3.6393871307373047, loss=0.4481476843357086, param_norm=1887.123291015625
00:13:33.315 [I] Progress on: 782it/1.00kit rate:8.8s/it remaining:32:06 elapsed:1:56:55 postfix:- (3484008:tqdm_logging.py:145)
Step 783: grad_norm=3.4400901794433594, loss=0.379345178604126, param_norm=1887.123291015625
Step 784: grad_norm=4.011733055114746, loss=0.49644404649734497, param_norm=1887.123291015625
00:13:51.060 [I] Progress on: 784it/1.00kit rate:8.9s/it remaining:31:51 elapsed:1:57:13 postfix:- (3484008:tqdm_logging.py:145)
Step 785: grad_norm=3.3010995388031006, loss=0.4923328757286072, param_norm=1887.1234130859375
Step 786: grad_norm=3.872755527496338, loss=0.5143699645996094, param_norm=1887.1234130859375
00:14:08.711 [I] Progress on: 786it/1.00kit rate:8.8s/it remaining:31:31 elapsed:1:57:30 postfix:- (3484008:tqdm_logging.py:145)
Step 787: grad_norm=3.804572105407715, loss=0.5405450463294983, param_norm=1887.1234130859375
Step 788: grad_norm=2.8829243183135986, loss=0.4360792636871338, param_norm=1887.12353515625
00:14:26.355 [I] Progress on: 788it/1.00kit rate:8.8s/it remaining:31:11 elapsed:1:57:48 postfix:- (3484008:tqdm_logging.py:145)
Step 789: grad_norm=3.144659996032715, loss=0.47989681363105774, param_norm=1887.12353515625
Step 790: grad_norm=3.6933419704437256, loss=0.4257577061653137, param_norm=1887.1236572265625
00:14:43.991 [I] Progress on: 790it/1.00kit rate:8.8s/it remaining:30:53 elapsed:1:58:06 postfix:- (3484008:tqdm_logging.py:145)
Step 791: grad_norm=3.006103277206421, loss=0.4413111209869385, param_norm=1887.1236572265625
Step 792: grad_norm=3.345132350921631, loss=0.5157788395881653, param_norm=1887.1236572265625
00:15:01.639 [I] Progress on: 792it/1.00kit rate:8.8s/it remaining:30:35 elapsed:1:58:23 postfix:- (3484008:tqdm_logging.py:145)
Step 793: grad_norm=2.8983871936798096, loss=0.37667977809906006, param_norm=1887.123779296875
Step 794: grad_norm=3.4189038276672363, loss=0.45735418796539307, param_norm=1887.123779296875
00:15:19.302 [I] Progress on: 794it/1.00kit rate:8.8s/it remaining:30:18 elapsed:1:58:41 postfix:- (3484008:tqdm_logging.py:145)
Step 795: grad_norm=3.4379405975341797, loss=0.417412132024765, param_norm=1887.123779296875
Step 796: grad_norm=3.6432085037231445, loss=0.5204328298568726, param_norm=1887.123779296875
00:15:36.986 [I] Progress on: 796it/1.00kit rate:8.8s/it remaining:30:02 elapsed:1:58:59 postfix:- (3484008:tqdm_logging.py:145)
Step 797: grad_norm=3.1284806728363037, loss=0.4464574456214905, param_norm=1887.1239013671875
Step 798: grad_norm=3.113147735595703, loss=0.3718034327030182, param_norm=1887.1239013671875
00:15:54.678 [I] Progress on: 798it/1.00kit rate:8.8s/it remaining:29:46 elapsed:1:59:16 postfix:- (3484008:tqdm_logging.py:145)
Step 799: grad_norm=4.074581146240234, loss=0.4519868493080139, param_norm=1887.1239013671875
Step 800: grad_norm=2.9523823261260986, loss=0.40026333928108215, param_norm=1887.1239013671875
00:16:12.334 [I] Progress on: 800it/1.00kit rate:8.8s/it remaining:29:27 elapsed:1:59:34 postfix:- (3484008:tqdm_logging.py:145)
00:16:12.537 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
00:16:12.537 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
00:16:12.538 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (3484008:checkpoint_manager.py:1786)
00:16:12.538 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (3484008:checkpoint_manager.py:1817)
00:16:12.538 [I] [process=0] Saving checkpoint at step 800                                        (3484008:checkpoint_manager.py:1286)
00:16:12.539 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800. (3484008:async_checkpointer.py:358)
00:16:12.540 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:16:12.541 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21 (3484008:atomicity.py:144)
00:16:12.541 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:16:12.542 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:16:12.543 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (3484008:atomicity.py:144)
00:16:12.543 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (3484008:atomicity.py:144)
00:16:12.544 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:16:12.549 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
00:16:16.320 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:16:16.324 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
00:16:16.337 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
00:16:16.347 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
00:16:16.361 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.363 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.366 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.390 [I] Preserving Checkpoint[step=400 | time=2025-03-24 03:16:55.457503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.391 [I] Preserving Checkpoint[step=500 | time=2025-03-24 03:31:46.213544+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.391 [I] Preserving Checkpoint[step=600 | time=2025-03-24 03:46:35.282092+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.395 [I] Preserving Checkpoint[step=700 | time=2025-03-24 04:01:26.713236+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:16:16.414 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
00:16:16.417 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
00:16:16.427 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
00:16:16.433 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742789772.5376148, 'wait_for_prev_duration_secs': 0.0007283687591552734, 'checkpointer_blocking_start_time': 1742789772.5389385, 'checkpointer_blocking_duration_secs': 3.8219971656799316, 'get_old_steps_start_time': 1742789776.3611724, 'get_old_steps_duration_secs': 0.05268669128417969, 'checkpoint_manager_blocking_start_time': 1742789772.5374131, 'checkpoint_manager_blocking_duration_secs': 3.8958663940429688} (3484008:standard_logger.py:34)
Step 801: grad_norm=4.383208751678467, loss=0.5039238333702087, param_norm=1887.1239013671875
00:16:25.058 [I] Progress on: 801it/1.00kit rate:10.0s/it remaining:33:11 elapsed:1:59:47 postfix:- (3484008:tqdm_logging.py:145)
00:16:25.808 [I] ChainedFuture completed 1/1 futures in 9.47 seconds.                             (3484008:future.py:137)
00:16:25.809 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 781.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:16:25.809 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
00:16:25.811 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21 (3484008:async_checkpointer.py:406)
00:16:25.812 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21/assets (3484008:atomicity.py:287)
00:16:25.824 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21/params (3484008:atomicity.py:287)
00:16:25.825 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800 (3484008:async_checkpointer.py:416)
00:16:25.826 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21 (3484008:async_checkpointer.py:426)
00:16:25.826 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800 (3484008:atomicity.py:287)
00:16:25.828 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/800`. (3484008:atomicity.py:548)
00:16:25.828 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
00:16:25.829 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
00:16:25.829 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
00:16:25.830 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
00:16:25.830 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 802: grad_norm=3.3497989177703857, loss=0.4994041621685028, param_norm=1887.1239013671875
Step 803: grad_norm=2.986149549484253, loss=0.4729125499725342, param_norm=1887.1240234375
00:16:43.162 [I] Progress on: 803it/1.00kit rate:9.4s/it remaining:30:49 elapsed:2:00:05 postfix:- (3484008:tqdm_logging.py:145)
Step 804: grad_norm=3.141723394393921, loss=0.47177940607070923, param_norm=1887.1240234375
Step 805: grad_norm=3.1657121181488037, loss=0.431699275970459, param_norm=1887.1240234375
00:17:00.824 [I] Progress on: 805it/1.00kit rate:9.2s/it remaining:29:55 elapsed:2:00:23 postfix:- (3484008:tqdm_logging.py:145)
Step 806: grad_norm=2.983677864074707, loss=0.49354586005210876, param_norm=1887.1240234375
Step 807: grad_norm=2.910311698913574, loss=0.42699915170669556, param_norm=1887.1241455078125
00:17:18.448 [I] Progress on: 807it/1.00kit rate:9.0s/it remaining:28:57 elapsed:2:00:40 postfix:- (3484008:tqdm_logging.py:145)
Step 808: grad_norm=3.1560304164886475, loss=0.5310407280921936, param_norm=1887.1241455078125
Step 809: grad_norm=4.102754592895508, loss=0.4720715284347534, param_norm=1887.1241455078125
00:17:36.076 [I] Progress on: 809it/1.00kit rate:8.9s/it remaining:28:21 elapsed:2:00:58 postfix:- (3484008:tqdm_logging.py:145)
Step 810: grad_norm=3.3430099487304688, loss=0.4148563742637634, param_norm=1887.124267578125
Step 811: grad_norm=3.331563949584961, loss=0.43288320302963257, param_norm=1887.124267578125
00:17:53.704 [I] Progress on: 811it/1.00kit rate:8.9s/it remaining:27:53 elapsed:2:01:15 postfix:- (3484008:tqdm_logging.py:145)
Step 812: grad_norm=3.6888182163238525, loss=0.464496374130249, param_norm=1887.124267578125
Step 813: grad_norm=3.6371042728424072, loss=0.5569981336593628, param_norm=1887.1243896484375
00:18:11.321 [I] Progress on: 813it/1.00kit rate:8.8s/it remaining:27:31 elapsed:2:01:33 postfix:- (3484008:tqdm_logging.py:145)
Step 814: grad_norm=2.5285606384277344, loss=0.37866395711898804, param_norm=1887.1243896484375
Step 815: grad_norm=3.4363090991973877, loss=0.5075064897537231, param_norm=1887.1243896484375
00:18:28.919 [I] Progress on: 815it/1.00kit rate:8.8s/it remaining:27:10 elapsed:2:01:51 postfix:- (3484008:tqdm_logging.py:145)
Step 816: grad_norm=3.539844036102295, loss=0.46063879132270813, param_norm=1887.1243896484375
Step 817: grad_norm=3.4292125701904297, loss=0.4972061514854431, param_norm=1887.12451171875
00:18:46.564 [I] Progress on: 817it/1.00kit rate:8.8s/it remaining:26:53 elapsed:2:02:08 postfix:- (3484008:tqdm_logging.py:145)
Step 818: grad_norm=3.1050374507904053, loss=0.47453802824020386, param_norm=1887.12451171875
Step 819: grad_norm=3.4740631580352783, loss=0.35092562437057495, param_norm=1887.12451171875
00:19:04.228 [I] Progress on: 819it/1.00kit rate:8.8s/it remaining:26:37 elapsed:2:02:26 postfix:- (3484008:tqdm_logging.py:145)
Step 820: grad_norm=3.134622812271118, loss=0.41141340136528015, param_norm=1887.12451171875
Step 821: grad_norm=3.56246280670166, loss=0.5069515109062195, param_norm=1887.12451171875
00:19:21.801 [I] Progress on: 821it/1.00kit rate:8.8s/it remaining:26:16 elapsed:2:02:44 postfix:- (3484008:tqdm_logging.py:145)
Step 822: grad_norm=3.197571277618408, loss=0.4450525641441345, param_norm=1887.1246337890625
Step 823: grad_norm=3.9482057094573975, loss=0.47472214698791504, param_norm=1887.1246337890625
00:19:39.374 [I] Progress on: 823it/1.00kit rate:8.8s/it remaining:25:56 elapsed:2:03:01 postfix:- (3484008:tqdm_logging.py:145)
Step 824: grad_norm=3.781996011734009, loss=0.5369405746459961, param_norm=1887.1246337890625
Step 825: grad_norm=3.300675392150879, loss=0.41270941495895386, param_norm=1887.1246337890625
00:19:56.928 [I] Progress on: 825it/1.00kit rate:8.8s/it remaining:25:36 elapsed:2:03:19 postfix:- (3484008:tqdm_logging.py:145)
Step 826: grad_norm=3.4114186763763428, loss=0.5209775567054749, param_norm=1887.124755859375
Step 827: grad_norm=3.2774622440338135, loss=0.528691291809082, param_norm=1887.124755859375
00:20:14.490 [I] Progress on: 827it/1.00kit rate:8.8s/it remaining:25:19 elapsed:2:03:36 postfix:- (3484008:tqdm_logging.py:145)
Step 828: grad_norm=2.8193812370300293, loss=0.37453413009643555, param_norm=1887.124755859375
00:20:25.615 [I] Progress on: 828it/1.00kit rate:9.5s/it remaining:27:11 elapsed:2:03:47 postfix:- (3484008:tqdm_logging.py:145)
Step 829: grad_norm=3.359231948852539, loss=0.4442817270755768, param_norm=1887.124755859375
Step 830: grad_norm=2.6475229263305664, loss=0.3919905424118042, param_norm=1887.124755859375
00:20:43.171 [I] Progress on: 830it/1.00kit rate:9.1s/it remaining:25:52 elapsed:2:04:05 postfix:- (3484008:tqdm_logging.py:145)
Step 831: grad_norm=3.656496286392212, loss=0.4568518400192261, param_norm=1887.124755859375
Step 832: grad_norm=3.0101702213287354, loss=0.42160212993621826, param_norm=1887.1248779296875
00:21:00.739 [I] Progress on: 832it/1.00kit rate:9.0s/it remaining:25:05 elapsed:2:04:22 postfix:- (3484008:tqdm_logging.py:145)
Step 833: grad_norm=3.4727623462677, loss=0.37172263860702515, param_norm=1887.1248779296875
Step 834: grad_norm=3.1172091960906982, loss=0.4331682324409485, param_norm=1887.125
00:21:18.298 [I] Progress on: 834it/1.00kit rate:8.9s/it remaining:24:33 elapsed:2:04:40 postfix:- (3484008:tqdm_logging.py:145)
Step 835: grad_norm=3.170196533203125, loss=0.42169177532196045, param_norm=1887.125
Step 836: grad_norm=3.4301414489746094, loss=0.49036622047424316, param_norm=1887.1248779296875
00:21:35.880 [I] Progress on: 836it/1.00kit rate:8.8s/it remaining:24:09 elapsed:2:04:58 postfix:- (3484008:tqdm_logging.py:145)
Step 837: grad_norm=3.450540065765381, loss=0.44066178798675537, param_norm=1887.125
Step 838: grad_norm=2.9607582092285156, loss=0.39327937364578247, param_norm=1887.125
00:21:53.458 [I] Progress on: 838it/1.00kit rate:8.8s/it remaining:23:48 elapsed:2:05:15 postfix:- (3484008:tqdm_logging.py:145)
Step 839: grad_norm=2.8694844245910645, loss=0.421859472990036, param_norm=1887.125
Step 840: grad_norm=2.8969943523406982, loss=0.35713881254196167, param_norm=1887.125
00:22:11.056 [I] Progress on: 840it/1.00kit rate:8.8s/it remaining:23:30 elapsed:2:05:33 postfix:- (3484008:tqdm_logging.py:145)
Step 841: grad_norm=3.0757932662963867, loss=0.3260936141014099, param_norm=1887.1251220703125
Step 842: grad_norm=2.990689516067505, loss=0.37695446610450745, param_norm=1887.1251220703125
00:22:28.615 [I] Progress on: 842it/1.00kit rate:8.8s/it remaining:23:11 elapsed:2:05:50 postfix:- (3484008:tqdm_logging.py:145)
Step 843: grad_norm=3.29616117477417, loss=0.39538973569869995, param_norm=1887.125244140625
Step 844: grad_norm=4.663046360015869, loss=0.4304763376712799, param_norm=1887.125244140625
00:22:46.208 [I] Progress on: 844it/1.00kit rate:8.8s/it remaining:22:53 elapsed:2:06:08 postfix:- (3484008:tqdm_logging.py:145)
Step 845: grad_norm=3.8207106590270996, loss=0.47515085339546204, param_norm=1887.125244140625
Step 846: grad_norm=3.167046308517456, loss=0.45955193042755127, param_norm=1887.125244140625
00:23:03.789 [I] Progress on: 846it/1.00kit rate:8.8s/it remaining:22:35 elapsed:2:06:26 postfix:- (3484008:tqdm_logging.py:145)
Step 847: grad_norm=2.8659863471984863, loss=0.46701565384864807, param_norm=1887.1253662109375
Step 848: grad_norm=2.8894290924072266, loss=0.43162810802459717, param_norm=1887.1253662109375
00:23:21.421 [I] Progress on: 848it/1.00kit rate:8.8s/it remaining:22:20 elapsed:2:06:43 postfix:- (3484008:tqdm_logging.py:145)
Step 849: grad_norm=3.466296434402466, loss=0.38605165481567383, param_norm=1887.1253662109375
Step 850: grad_norm=2.591093063354492, loss=0.3222789764404297, param_norm=1887.12548828125
00:23:38.956 [I] Progress on: 850it/1.00kit rate:8.8s/it remaining:21:59 elapsed:2:07:01 postfix:- (3484008:tqdm_logging.py:145)
Step 851: grad_norm=2.7208847999572754, loss=0.3936766982078552, param_norm=1887.12548828125
Step 852: grad_norm=2.9918816089630127, loss=0.41548392176628113, param_norm=1887.12548828125
00:23:56.486 [I] Progress on: 852it/1.00kit rate:8.8s/it remaining:21:40 elapsed:2:07:18 postfix:- (3484008:tqdm_logging.py:145)
Step 853: grad_norm=4.321882724761963, loss=0.46914055943489075, param_norm=1887.12548828125
Step 854: grad_norm=2.8459713459014893, loss=0.30773407220840454, param_norm=1887.12548828125
00:24:14.021 [I] Progress on: 854it/1.00kit rate:8.8s/it remaining:21:21 elapsed:2:07:36 postfix:- (3484008:tqdm_logging.py:145)
Step 855: grad_norm=5.087764263153076, loss=0.44461649656295776, param_norm=1887.12548828125
Step 856: grad_norm=3.227085828781128, loss=0.42607685923576355, param_norm=1887.12548828125
00:24:31.557 [I] Progress on: 856it/1.00kit rate:8.8s/it remaining:21:04 elapsed:2:07:53 postfix:- (3484008:tqdm_logging.py:145)
Step 857: grad_norm=3.466381311416626, loss=0.4078272879123688, param_norm=1887.1256103515625
Step 858: grad_norm=2.8462629318237305, loss=0.39167141914367676, param_norm=1887.1256103515625
00:24:49.091 [I] Progress on: 858it/1.00kit rate:8.8s/it remaining:20:46 elapsed:2:08:11 postfix:- (3484008:tqdm_logging.py:145)
Step 859: grad_norm=3.3758137226104736, loss=0.4751170873641968, param_norm=1887.1256103515625
Step 860: grad_norm=3.2877695560455322, loss=0.4480697512626648, param_norm=1887.1256103515625
00:25:06.635 [I] Progress on: 860it/1.00kit rate:8.8s/it remaining:20:29 elapsed:2:08:28 postfix:- (3484008:tqdm_logging.py:145)
Step 861: grad_norm=4.1719818115234375, loss=0.4602243900299072, param_norm=1887.1256103515625
Step 862: grad_norm=2.933344841003418, loss=0.3740105628967285, param_norm=1887.1256103515625
00:25:24.138 [I] Progress on: 862it/1.00kit rate:8.8s/it remaining:20:10 elapsed:2:08:46 postfix:- (3484008:tqdm_logging.py:145)
Step 863: grad_norm=3.4329874515533447, loss=0.4307700991630554, param_norm=1887.125732421875
Step 864: grad_norm=2.8572988510131836, loss=0.3156208097934723, param_norm=1887.125732421875
00:25:41.660 [I] Progress on: 864it/1.00kit rate:8.8s/it remaining:19:52 elapsed:2:09:03 postfix:- (3484008:tqdm_logging.py:145)
Step 865: grad_norm=4.1265034675598145, loss=0.41736316680908203, param_norm=1887.125732421875
Step 866: grad_norm=3.4846746921539307, loss=0.42526575922966003, param_norm=1887.125732421875
00:25:59.168 [I] Progress on: 866it/1.00kit rate:8.8s/it remaining:19:35 elapsed:2:09:21 postfix:- (3484008:tqdm_logging.py:145)
Step 867: grad_norm=3.5200626850128174, loss=0.45127713680267334, param_norm=1887.125732421875
Step 868: grad_norm=3.337092876434326, loss=0.4058981239795685, param_norm=1887.125732421875
00:26:16.699 [I] Progress on: 868it/1.00kit rate:8.8s/it remaining:19:17 elapsed:2:09:38 postfix:- (3484008:tqdm_logging.py:145)
Step 869: grad_norm=3.772212028503418, loss=0.4011537432670593, param_norm=1887.125732421875
Step 870: grad_norm=3.709542751312256, loss=0.3947892487049103, param_norm=1887.1258544921875
00:26:34.188 [I] Progress on: 870it/1.00kit rate:8.8s/it remaining:18:59 elapsed:2:09:56 postfix:- (3484008:tqdm_logging.py:145)
Step 871: grad_norm=2.504110813140869, loss=0.2814892828464508, param_norm=1887.1258544921875
Step 872: grad_norm=3.5403079986572266, loss=0.4168592691421509, param_norm=1887.1259765625
00:26:51.711 [I] Progress on: 872it/1.00kit rate:8.8s/it remaining:18:41 elapsed:2:10:13 postfix:- (3484008:tqdm_logging.py:145)
Step 873: grad_norm=3.2826499938964844, loss=0.3629470467567444, param_norm=1887.1259765625
Step 874: grad_norm=3.4120523929595947, loss=0.4394400119781494, param_norm=1887.1259765625
00:27:09.238 [I] Progress on: 874it/1.00kit rate:8.8s/it remaining:18:24 elapsed:2:10:31 postfix:- (3484008:tqdm_logging.py:145)
Step 875: grad_norm=2.8957343101501465, loss=0.4169732928276062, param_norm=1887.1259765625
Step 876: grad_norm=2.9527387619018555, loss=0.4036900997161865, param_norm=1887.1259765625
00:27:26.855 [I] Progress on: 876it/1.00kit rate:8.8s/it remaining:18:10 elapsed:2:10:49 postfix:- (3484008:tqdm_logging.py:145)
Step 877: grad_norm=3.1263835430145264, loss=0.3895062208175659, param_norm=1887.1259765625
Step 878: grad_norm=2.7990612983703613, loss=0.40525269508361816, param_norm=1887.1259765625
00:27:44.479 [I] Progress on: 878it/1.00kit rate:8.8s/it remaining:17:54 elapsed:2:11:06 postfix:- (3484008:tqdm_logging.py:145)
Step 879: grad_norm=3.5206451416015625, loss=0.44808125495910645, param_norm=1887.1259765625
Step 880: grad_norm=3.9477202892303467, loss=0.44190770387649536, param_norm=1887.1260986328125
00:28:02.122 [I] Progress on: 880it/1.00kit rate:8.8s/it remaining:17:38 elapsed:2:11:24 postfix:- (3484008:tqdm_logging.py:145)
Step 881: grad_norm=2.4224612712860107, loss=0.3289085030555725, param_norm=1887.1260986328125
Step 882: grad_norm=2.9159464836120605, loss=0.36727428436279297, param_norm=1887.1260986328125
00:28:19.822 [I] Progress on: 882it/1.00kit rate:8.8s/it remaining:17:23 elapsed:2:11:42 postfix:- (3484008:tqdm_logging.py:145)
Step 883: grad_norm=2.9810376167297363, loss=0.37541550397872925, param_norm=1887.1260986328125
Step 884: grad_norm=3.2122981548309326, loss=0.40994399785995483, param_norm=1887.1260986328125
00:28:37.394 [I] Progress on: 884it/1.00kit rate:8.8s/it remaining:17:02 elapsed:2:11:59 postfix:- (3484008:tqdm_logging.py:145)
Step 885: grad_norm=2.7843222618103027, loss=0.41314226388931274, param_norm=1887.1260986328125
Step 886: grad_norm=3.25858736038208, loss=0.4174479842185974, param_norm=1887.1260986328125
00:28:54.993 [I] Progress on: 886it/1.00kit rate:8.8s/it remaining:16:44 elapsed:2:12:17 postfix:- (3484008:tqdm_logging.py:145)
Step 887: grad_norm=3.7511115074157715, loss=0.36498063802719116, param_norm=1887.1260986328125
Step 888: grad_norm=3.2411954402923584, loss=0.42886894941329956, param_norm=1887.1260986328125
00:29:12.661 [I] Progress on: 888it/1.00kit rate:8.8s/it remaining:16:29 elapsed:2:12:34 postfix:- (3484008:tqdm_logging.py:145)
Step 889: grad_norm=5.356354236602783, loss=0.3746701776981354, param_norm=1887.126220703125
Step 890: grad_norm=3.9467310905456543, loss=0.43927547335624695, param_norm=1887.126220703125
00:29:30.286 [I] Progress on: 890it/1.00kit rate:8.8s/it remaining:16:11 elapsed:2:12:52 postfix:- (3484008:tqdm_logging.py:145)
Step 891: grad_norm=3.399003505706787, loss=0.4069804549217224, param_norm=1887.126220703125
Step 892: grad_norm=2.552778720855713, loss=0.29560554027557373, param_norm=1887.126220703125
00:29:47.876 [I] Progress on: 892it/1.00kit rate:8.8s/it remaining:15:52 elapsed:2:13:10 postfix:- (3484008:tqdm_logging.py:145)
Step 893: grad_norm=3.3457860946655273, loss=0.4264475703239441, param_norm=1887.126220703125
Step 894: grad_norm=3.6317379474639893, loss=0.39147835969924927, param_norm=1887.1263427734375
00:30:05.493 [I] Progress on: 894it/1.00kit rate:8.8s/it remaining:15:34 elapsed:2:13:27 postfix:- (3484008:tqdm_logging.py:145)
Step 895: grad_norm=3.501579761505127, loss=0.45190632343292236, param_norm=1887.1263427734375
Step 896: grad_norm=3.250570058822632, loss=0.46241897344589233, param_norm=1887.1263427734375
00:30:23.049 [I] Progress on: 896it/1.00kit rate:8.8s/it remaining:15:15 elapsed:2:13:45 postfix:- (3484008:tqdm_logging.py:145)
Step 897: grad_norm=2.6504194736480713, loss=0.3588201105594635, param_norm=1887.1263427734375
00:30:34.319 [I] Progress on: 897it/1.00kit rate:9.5s/it remaining:16:23 elapsed:2:13:56 postfix:- (3484008:tqdm_logging.py:145)
Step 898: grad_norm=2.819138288497925, loss=0.2903067469596863, param_norm=1887.1263427734375
Step 899: grad_norm=2.333383321762085, loss=0.3604079484939575, param_norm=1887.1263427734375
00:30:52.114 [I] Progress on: 899it/1.00kit rate:9.2s/it remaining:15:30 elapsed:2:14:14 postfix:- (3484008:tqdm_logging.py:145)
Step 900: grad_norm=3.069498062133789, loss=0.43869253993034363, param_norm=1887.12646484375
00:31:01.130 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
00:31:01.130 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
00:31:01.130 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (3484008:checkpoint_manager.py:1786)
00:31:01.131 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (3484008:checkpoint_manager.py:1817)
00:31:01.131 [I] [process=0] Saving checkpoint at step 900                                        (3484008:checkpoint_manager.py:1286)
00:31:01.132 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900. (3484008:async_checkpointer.py:358)
00:31:01.134 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:31:01.134 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24 (3484008:atomicity.py:144)
00:31:01.135 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:31:01.136 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:31:01.137 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (3484008:atomicity.py:144)
00:31:01.138 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (3484008:atomicity.py:144)
00:31:01.138 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:31:01.144 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
00:31:05.008 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
00:31:05.009 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
00:31:05.018 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:31:05.023 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
00:31:05.045 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.047 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.048 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.054 [I] Preserving Checkpoint[step=400 | time=2025-03-24 03:16:55.457503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.057 [I] Preserving Checkpoint[step=500 | time=2025-03-24 03:31:46.213544+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.057 [I] Preserving Checkpoint[step=600 | time=2025-03-24 03:46:35.282092+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.059 [I] Preserving Checkpoint[step=700 | time=2025-03-24 04:01:26.713236+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.059 [I] Preserving Checkpoint[step=800 | time=2025-03-24 04:16:16.361005+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:31:05.059 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
00:31:05.059 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
00:31:05.061 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
00:31:05.062 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742790661.130266, 'wait_for_prev_duration_secs': 0.0008769035339355469, 'checkpointer_blocking_start_time': 1742790661.132037, 'checkpointer_blocking_duration_secs': 3.913346529006958, 'get_old_steps_start_time': 1742790665.0454597, 'get_old_steps_duration_secs': 0.014187812805175781, 'checkpoint_manager_blocking_start_time': 1742790661.129913, 'checkpoint_manager_blocking_duration_secs': 3.9320785999298096} (3484008:standard_logger.py:34)
00:31:05.063 [I] Progress on: 901it/1.00kit rate:10.2s/it remaining:16:48 elapsed:2:14:27 postfix:- (3484008:tqdm_logging.py:145)
00:31:13.446 [I] ChainedFuture completed 1/1 futures in 8.41 seconds.                             (3484008:future.py:137)
00:31:13.447 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 841.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:31:13.447 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
00:31:13.449 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24 (3484008:async_checkpointer.py:406)
00:31:13.449 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24/assets (3484008:atomicity.py:287)
00:31:13.461 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24/params (3484008:atomicity.py:287)
00:31:13.461 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900 (3484008:async_checkpointer.py:416)
00:31:13.462 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24 (3484008:async_checkpointer.py:426)
00:31:13.462 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900 (3484008:atomicity.py:287)
00:31:13.464 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/900`. (3484008:atomicity.py:548)
00:31:13.464 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
00:31:13.465 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
00:31:13.465 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
00:31:13.465 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
00:31:13.465 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
Step 901: grad_norm=2.317761182785034, loss=0.29298895597457886, param_norm=1887.1263427734375
Step 902: grad_norm=2.8575308322906494, loss=0.4242887496948242, param_norm=1887.12646484375
00:31:22.535 [I] Progress on: 902it/1.00kit rate:9.8s/it remaining:15:59 elapsed:2:14:44 postfix:- (3484008:tqdm_logging.py:145)
Step 903: grad_norm=3.0544185638427734, loss=0.4337529242038727, param_norm=1887.12646484375
Step 904: grad_norm=2.4696741104125977, loss=0.3887609541416168, param_norm=1887.12646484375
00:31:40.182 [I] Progress on: 904it/1.00kit rate:9.3s/it remaining:14:52 elapsed:2:15:02 postfix:- (3484008:tqdm_logging.py:145)
Step 905: grad_norm=2.902977705001831, loss=0.397017240524292, param_norm=1887.12646484375
Step 906: grad_norm=2.3717784881591797, loss=0.30874449014663696, param_norm=1887.12646484375
00:31:57.899 [I] Progress on: 906it/1.00kit rate:9.1s/it remaining:14:13 elapsed:2:15:20 postfix:- (3484008:tqdm_logging.py:145)
Step 907: grad_norm=2.682914972305298, loss=0.34028273820877075, param_norm=1887.12646484375
Step 908: grad_norm=2.7712175846099854, loss=0.386635959148407, param_norm=1887.12646484375
00:32:15.547 [I] Progress on: 908it/1.00kit rate:9.0s/it remaining:13:43 elapsed:2:15:37 postfix:- (3484008:tqdm_logging.py:145)
Step 909: grad_norm=2.9163362979888916, loss=0.36572694778442383, param_norm=1887.12646484375
Step 910: grad_norm=2.5583994388580322, loss=0.312114417552948, param_norm=1887.1265869140625
00:32:33.176 [I] Progress on: 910it/1.00kit rate:8.9s/it remaining:13:19 elapsed:2:15:55 postfix:- (3484008:tqdm_logging.py:145)
Step 911: grad_norm=2.326829195022583, loss=0.30611366033554077, param_norm=1887.12646484375
Step 912: grad_norm=2.3304009437561035, loss=0.37256312370300293, param_norm=1887.12646484375
00:32:50.871 [I] Progress on: 912it/1.00kit rate:8.9s/it remaining:13:00 elapsed:2:16:13 postfix:- (3484008:tqdm_logging.py:145)
Step 913: grad_norm=2.778705358505249, loss=0.38773053884506226, param_norm=1887.12646484375
Step 914: grad_norm=2.6846086978912354, loss=0.38040411472320557, param_norm=1887.12646484375
00:33:08.535 [I] Progress on: 914it/1.00kit rate:8.9s/it remaining:12:41 elapsed:2:16:30 postfix:- (3484008:tqdm_logging.py:145)
Step 915: grad_norm=3.423126459121704, loss=0.4132343530654907, param_norm=1887.12646484375
Step 916: grad_norm=3.212928295135498, loss=0.3994055390357971, param_norm=1887.126708984375
00:33:26.240 [I] Progress on: 916it/1.00kit rate:8.9s/it remaining:12:24 elapsed:2:16:48 postfix:- (3484008:tqdm_logging.py:145)
Step 917: grad_norm=3.2811505794525146, loss=0.3586997389793396, param_norm=1887.126708984375
Step 918: grad_norm=3.097236156463623, loss=0.3748847246170044, param_norm=1887.126708984375
00:33:43.923 [I] Progress on: 918it/1.00kit rate:8.9s/it remaining:12:06 elapsed:2:17:06 postfix:- (3484008:tqdm_logging.py:145)
Step 919: grad_norm=3.0907838344573975, loss=0.40655717253685, param_norm=1887.126708984375
Step 920: grad_norm=3.5426018238067627, loss=0.3997482359409332, param_norm=1887.126708984375
00:34:01.654 [I] Progress on: 920it/1.00kit rate:8.9s/it remaining:11:49 elapsed:2:17:23 postfix:- (3484008:tqdm_logging.py:145)
Step 921: grad_norm=2.8039638996124268, loss=0.3896876573562622, param_norm=1887.126708984375
Step 922: grad_norm=2.939535140991211, loss=0.43333134055137634, param_norm=1887.126708984375
00:34:19.361 [I] Progress on: 922it/1.00kit rate:8.9s/it remaining:11:31 elapsed:2:17:41 postfix:- (3484008:tqdm_logging.py:145)
Step 923: grad_norm=2.6327147483825684, loss=0.38903287053108215, param_norm=1887.126708984375
Step 924: grad_norm=2.690204620361328, loss=0.34570175409317017, param_norm=1887.1268310546875
00:34:37.069 [I] Progress on: 924it/1.00kit rate:8.9s/it remaining:11:13 elapsed:2:17:59 postfix:- (3484008:tqdm_logging.py:145)
Step 925: grad_norm=2.786011219024658, loss=0.38353845477104187, param_norm=1887.1268310546875
Step 926: grad_norm=3.7690303325653076, loss=0.3754623830318451, param_norm=1887.1268310546875
00:34:54.746 [I] Progress on: 926it/1.00kit rate:8.9s/it remaining:10:55 elapsed:2:18:16 postfix:- (3484008:tqdm_logging.py:145)
Step 927: grad_norm=2.867879867553711, loss=0.41457295417785645, param_norm=1887.1268310546875
Step 928: grad_norm=2.6122539043426514, loss=0.3994123339653015, param_norm=1887.126953125
00:35:12.761 [I] Progress on: 928it/1.00kit rate:9.0s/it remaining:10:44 elapsed:2:18:35 postfix:- (3484008:tqdm_logging.py:145)
Step 929: grad_norm=2.9596896171569824, loss=0.40689998865127563, param_norm=1887.126953125
Step 930: grad_norm=3.0372400283813477, loss=0.36467263102531433, param_norm=1887.126953125
00:35:30.506 [I] Progress on: 930it/1.00kit rate:8.9s/it remaining:10:24 elapsed:2:18:52 postfix:- (3484008:tqdm_logging.py:145)
Step 931: grad_norm=3.2675158977508545, loss=0.33737820386886597, param_norm=1887.126953125
Step 932: grad_norm=2.666187047958374, loss=0.37226784229278564, param_norm=1887.126953125
00:35:48.329 [I] Progress on: 932it/1.00kit rate:8.9s/it remaining:10:07 elapsed:2:19:10 postfix:- (3484008:tqdm_logging.py:145)
Step 933: grad_norm=2.493962287902832, loss=0.41715946793556213, param_norm=1887.126953125
Step 934: grad_norm=2.6679611206054688, loss=0.35700786113739014, param_norm=1887.126953125
00:36:06.073 [I] Progress on: 934it/1.00kit rate:8.9s/it remaining:09:48 elapsed:2:19:28 postfix:- (3484008:tqdm_logging.py:145)
Step 935: grad_norm=2.5900418758392334, loss=0.35452020168304443, param_norm=1887.126953125
Step 936: grad_norm=2.459228038787842, loss=0.2985588610172272, param_norm=1887.126953125
00:36:23.797 [I] Progress on: 936it/1.00kit rate:8.9s/it remaining:09:29 elapsed:2:19:46 postfix:- (3484008:tqdm_logging.py:145)
Step 937: grad_norm=2.7484560012817383, loss=0.4097897708415985, param_norm=1887.126953125
Step 938: grad_norm=3.485640525817871, loss=0.3562479019165039, param_norm=1887.126953125
00:36:41.459 [I] Progress on: 938it/1.00kit rate:8.9s/it remaining:09:09 elapsed:2:20:03 postfix:- (3484008:tqdm_logging.py:145)
Step 939: grad_norm=2.4828763008117676, loss=0.3074243664741516, param_norm=1887.126953125
Step 940: grad_norm=3.063983917236328, loss=0.3701130151748657, param_norm=1887.126953125
00:36:59.133 [I] Progress on: 940it/1.00kit rate:8.9s/it remaining:08:51 elapsed:2:20:21 postfix:- (3484008:tqdm_logging.py:145)
Step 941: grad_norm=3.17879581451416, loss=0.35944148898124695, param_norm=1887.126953125
Step 942: grad_norm=3.0370023250579834, loss=0.3514989912509918, param_norm=1887.1270751953125
00:37:16.844 [I] Progress on: 942it/1.00kit rate:8.9s/it remaining:08:34 elapsed:2:20:39 postfix:- (3484008:tqdm_logging.py:145)
Step 943: grad_norm=2.6101717948913574, loss=0.3382532596588135, param_norm=1887.1270751953125
Step 944: grad_norm=2.6367368698120117, loss=0.3523486256599426, param_norm=1887.1270751953125
00:37:34.568 [I] Progress on: 944it/1.00kit rate:8.9s/it remaining:08:16 elapsed:2:20:56 postfix:- (3484008:tqdm_logging.py:145)
Step 945: grad_norm=2.664503335952759, loss=0.36641234159469604, param_norm=1887.1270751953125
Step 946: grad_norm=3.0421059131622314, loss=0.35790538787841797, param_norm=1887.127197265625
00:37:52.332 [I] Progress on: 946it/1.00kit rate:8.9s/it remaining:07:59 elapsed:2:21:14 postfix:- (3484008:tqdm_logging.py:145)
Step 947: grad_norm=3.002760887145996, loss=0.36295002698898315, param_norm=1887.127197265625
Step 948: grad_norm=2.7883238792419434, loss=0.3753511309623718, param_norm=1887.127197265625
00:38:10.085 [I] Progress on: 948it/1.00kit rate:8.9s/it remaining:07:42 elapsed:2:21:32 postfix:- (3484008:tqdm_logging.py:145)
Step 949: grad_norm=2.921870470046997, loss=0.3583051264286041, param_norm=1887.127197265625
Step 950: grad_norm=2.481513261795044, loss=0.34453284740448, param_norm=1887.127197265625
00:38:27.763 [I] Progress on: 950it/1.00kit rate:8.9s/it remaining:07:23 elapsed:2:21:50 postfix:- (3484008:tqdm_logging.py:145)
Step 951: grad_norm=2.548521041870117, loss=0.28449976444244385, param_norm=1887.127197265625
Step 952: grad_norm=3.189465284347534, loss=0.41025078296661377, param_norm=1887.127197265625
00:38:45.519 [I] Progress on: 952it/1.00kit rate:8.9s/it remaining:07:06 elapsed:2:22:07 postfix:- (3484008:tqdm_logging.py:145)
Step 953: grad_norm=3.424544334411621, loss=0.35954371094703674, param_norm=1887.127197265625
Step 954: grad_norm=2.9438560009002686, loss=0.34526652097702026, param_norm=1887.127197265625
00:39:03.292 [I] Progress on: 954it/1.00kit rate:8.9s/it remaining:06:49 elapsed:2:22:25 postfix:- (3484008:tqdm_logging.py:145)
Step 955: grad_norm=2.8258018493652344, loss=0.35607534646987915, param_norm=1887.127197265625
Step 956: grad_norm=2.99126935005188, loss=0.4357879161834717, param_norm=1887.127197265625
00:39:21.039 [I] Progress on: 956it/1.00kit rate:8.9s/it remaining:06:31 elapsed:2:22:43 postfix:- (3484008:tqdm_logging.py:145)
Step 957: grad_norm=2.920692205429077, loss=0.3643488883972168, param_norm=1887.127197265625
Step 958: grad_norm=2.7835986614227295, loss=0.3811275362968445, param_norm=1887.127197265625
00:39:38.758 [I] Progress on: 958it/1.00kit rate:8.9s/it remaining:06:12 elapsed:2:23:01 postfix:- (3484008:tqdm_logging.py:145)
Step 959: grad_norm=3.651667833328247, loss=0.3920604884624481, param_norm=1887.127197265625
Step 960: grad_norm=2.730581760406494, loss=0.41834497451782227, param_norm=1887.127197265625
00:39:56.422 [I] Progress on: 960it/1.00kit rate:8.9s/it remaining:05:54 elapsed:2:23:18 postfix:- (3484008:tqdm_logging.py:145)
Step 961: grad_norm=2.940558910369873, loss=0.30335524678230286, param_norm=1887.1273193359375
Step 962: grad_norm=2.7646896839141846, loss=0.3445347547531128, param_norm=1887.1273193359375
00:40:14.143 [I] Progress on: 962it/1.00kit rate:8.9s/it remaining:05:36 elapsed:2:23:36 postfix:- (3484008:tqdm_logging.py:145)
Step 963: grad_norm=3.1858432292938232, loss=0.41518527269363403, param_norm=1887.1273193359375
Step 964: grad_norm=2.853684902191162, loss=0.3295396566390991, param_norm=1887.1273193359375
00:40:31.820 [I] Progress on: 964it/1.00kit rate:8.9s/it remaining:05:18 elapsed:2:23:54 postfix:- (3484008:tqdm_logging.py:145)
Step 965: grad_norm=2.743753671646118, loss=0.35633647441864014, param_norm=1887.1273193359375
00:40:43.064 [I] Progress on: 966it/1.00kit rate:9.5s/it remaining:05:23 elapsed:2:24:05 postfix:- (3484008:tqdm_logging.py:145)
Step 966: grad_norm=2.6281473636627197, loss=0.40221333503723145, param_norm=1887.1273193359375
Step 967: grad_norm=2.620185613632202, loss=0.36963483691215515, param_norm=1887.1273193359375
00:41:00.546 [I] Progress on: 967it/1.00kit rate:9.3s/it remaining:05:07 elapsed:2:24:22 postfix:- (3484008:tqdm_logging.py:145)
Step 968: grad_norm=2.3436105251312256, loss=0.26919102668762207, param_norm=1887.1273193359375
Step 969: grad_norm=2.3616883754730225, loss=0.39456474781036377, param_norm=1887.12744140625
00:41:18.187 [I] Progress on: 969it/1.00kit rate:9.1s/it remaining:04:41 elapsed:2:24:40 postfix:- (3484008:tqdm_logging.py:145)
Step 970: grad_norm=2.222266674041748, loss=0.24918963015079498, param_norm=1887.12744140625
Step 971: grad_norm=2.8235270977020264, loss=0.34018421173095703, param_norm=1887.12744140625
00:41:35.881 [I] Progress on: 971it/1.00kit rate:9.0s/it remaining:04:19 elapsed:2:24:58 postfix:- (3484008:tqdm_logging.py:145)
Step 972: grad_norm=2.369770050048828, loss=0.35570821166038513, param_norm=1887.1275634765625
Step 973: grad_norm=2.5643675327301025, loss=0.36702314019203186, param_norm=1887.1275634765625
00:41:53.594 [I] Progress on: 973it/1.00kit rate:8.9s/it remaining:04:00 elapsed:2:25:15 postfix:- (3484008:tqdm_logging.py:145)
Step 974: grad_norm=2.748561382293701, loss=0.3643673062324524, param_norm=1887.1275634765625
Step 975: grad_norm=2.7521286010742188, loss=0.4147837162017822, param_norm=1887.1275634765625
00:42:11.322 [I] Progress on: 975it/1.00kit rate:8.9s/it remaining:03:42 elapsed:2:25:33 postfix:- (3484008:tqdm_logging.py:145)
Step 976: grad_norm=2.4164066314697266, loss=0.37866324186325073, param_norm=1887.1275634765625
Step 977: grad_norm=3.040928363800049, loss=0.38995641469955444, param_norm=1887.1275634765625
00:42:29.013 [I] Progress on: 977it/1.00kit rate:8.9s/it remaining:03:23 elapsed:2:25:51 postfix:- (3484008:tqdm_logging.py:145)
Step 978: grad_norm=2.758573293685913, loss=0.35659289360046387, param_norm=1887.1275634765625
Step 979: grad_norm=2.417685031890869, loss=0.33052724599838257, param_norm=1887.1275634765625
00:42:46.679 [I] Progress on: 979it/1.00kit rate:8.9s/it remaining:03:05 elapsed:2:26:08 postfix:- (3484008:tqdm_logging.py:145)
Step 980: grad_norm=2.8237547874450684, loss=0.4472583532333374, param_norm=1887.1275634765625
Step 981: grad_norm=2.797492742538452, loss=0.2864669859409332, param_norm=1887.127685546875
00:43:04.287 [I] Progress on: 981it/1.00kit rate:8.8s/it remaining:02:47 elapsed:2:26:26 postfix:- (3484008:tqdm_logging.py:145)
Step 982: grad_norm=2.6053740978240967, loss=0.38395223021507263, param_norm=1887.127685546875
Step 983: grad_norm=2.670152187347412, loss=0.32454848289489746, param_norm=1887.127685546875
00:43:22.049 [I] Progress on: 983it/1.00kit rate:8.9s/it remaining:02:30 elapsed:2:26:44 postfix:- (3484008:tqdm_logging.py:145)
Step 984: grad_norm=2.464540719985962, loss=0.2765223979949951, param_norm=1887.1275634765625
Step 985: grad_norm=2.711986541748047, loss=0.33926114439964294, param_norm=1887.1275634765625
00:43:39.700 [I] Progress on: 985it/1.00kit rate:8.8s/it remaining:02:12 elapsed:2:27:01 postfix:- (3484008:tqdm_logging.py:145)
Step 986: grad_norm=2.6812546253204346, loss=0.3806290030479431, param_norm=1887.1275634765625
Step 987: grad_norm=3.102543354034424, loss=0.32366013526916504, param_norm=1887.1275634765625
00:43:57.432 [I] Progress on: 987it/1.00kit rate:8.9s/it remaining:01:55 elapsed:2:27:19 postfix:- (3484008:tqdm_logging.py:145)
Step 988: grad_norm=2.827955961227417, loss=0.38311105966567993, param_norm=1887.1275634765625
Step 989: grad_norm=2.1012070178985596, loss=0.2901970148086548, param_norm=1887.127685546875
00:44:15.180 [I] Progress on: 989it/1.00kit rate:8.9s/it remaining:01:37 elapsed:2:27:37 postfix:- (3484008:tqdm_logging.py:145)
Step 990: grad_norm=2.4152004718780518, loss=0.33956456184387207, param_norm=1887.127685546875
Step 991: grad_norm=3.0796666145324707, loss=0.3173104226589203, param_norm=1887.127685546875
00:44:32.808 [I] Progress on: 991it/1.00kit rate:8.8s/it remaining:01:19 elapsed:2:27:55 postfix:- (3484008:tqdm_logging.py:145)
Step 992: grad_norm=2.456540107727051, loss=0.2993537485599518, param_norm=1887.1278076171875
Step 993: grad_norm=2.7974512577056885, loss=0.36020928621292114, param_norm=1887.1278076171875
00:44:50.439 [I] Progress on: 993it/1.00kit rate:8.8s/it remaining:01:01 elapsed:2:28:12 postfix:- (3484008:tqdm_logging.py:145)
Step 994: grad_norm=2.66218638420105, loss=0.3743588924407959, param_norm=1887.1278076171875
Step 995: grad_norm=2.5367720127105713, loss=0.35103321075439453, param_norm=1887.1278076171875
00:45:08.124 [I] Progress on: 995it/1.00kit rate:8.8s/it remaining:00:44 elapsed:2:28:30 postfix:- (3484008:tqdm_logging.py:145)
Step 996: grad_norm=3.038688898086548, loss=0.3578694462776184, param_norm=1887.1278076171875
Step 997: grad_norm=3.1445767879486084, loss=0.3577021062374115, param_norm=1887.1278076171875
00:45:25.839 [I] Progress on: 997it/1.00kit rate:8.8s/it remaining:00:26 elapsed:2:28:48 postfix:- (3484008:tqdm_logging.py:145)
Step 998: grad_norm=2.8357954025268555, loss=0.3609577417373657, param_norm=1887.1278076171875
Step 999: grad_norm=2.678684711456299, loss=0.3569798171520233, param_norm=1887.1278076171875
00:45:43.569 [I] Progress on: 999it/1.00kit rate:8.9s/it remaining:00:08 elapsed:2:29:05 postfix:- (3484008:tqdm_logging.py:145)
00:45:43.791 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
00:45:43.791 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
00:45:43.791 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (3484008:checkpoint_manager.py:1786)
00:45:43.791 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (3484008:checkpoint_manager.py:1817)
00:45:43.792 [I] [process=0] Saving checkpoint at step 999                                        (3484008:checkpoint_manager.py:1286)
00:45:43.793 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999. (3484008:async_checkpointer.py:358)
00:45:43.795 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:45:43.795 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27 (3484008:atomicity.py:144)
00:45:43.797 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:45:43.797 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3484008:multihost.py:293)
00:45:43.799 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (3484008:atomicity.py:144)
00:45:43.800 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (3484008:atomicity.py:144)
00:45:43.802 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3484008:multihost.py:293)
00:45:43.807 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3484008:replica_slices.py:419)
00:45:47.624 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:45:47.628 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3484008:tensorstore_utils.py:371)
00:45:47.629 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3484008:tensorstore_utils.py:371)
00:45:47.641 [I] [process=0][thread=async_save] Background save thread started.                   (3484008:async_checkpointer.py:121)
00:45:47.658 [I] Preserving Checkpoint[step=100 | time=2025-03-24 02:32:29.652939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.660 [I] Preserving Checkpoint[step=200 | time=2025-03-24 02:47:15.513050+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.661 [I] Preserving Checkpoint[step=300 | time=2025-03-24 03:02:06.148624+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.676 [I] Preserving Checkpoint[step=400 | time=2025-03-24 03:16:55.457503+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.678 [I] Preserving Checkpoint[step=500 | time=2025-03-24 03:31:46.213544+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.679 [I] Preserving Checkpoint[step=600 | time=2025-03-24 03:46:35.282092+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.681 [I] Preserving Checkpoint[step=700 | time=2025-03-24 04:01:26.713236+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.684 [I] Preserving Checkpoint[step=800 | time=2025-03-24 04:16:16.361005+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.687 [I] Preserving Checkpoint[step=900 | time=2025-03-24 04:31:05.045400+00:00 | is_locked=None]: (Reason: on keep_period=100). (3484008:checkpoint_manager.py:1734)
00:45:47.690 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3484008:multihost.py:293)
00:45:47.691 [I] [process=0][thread=MainThread][step=999] Starting CheckpointManager Save Finalize thread=save_finalize (3484008:checkpoint_manager.py:1328)
00:45:47.697 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3484008:async_checkpointer.py:231)
00:45:47.698 [I] {'step': 999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742791543.7911239, 'wait_for_prev_duration_secs': 0.0009844303131103516, 'checkpointer_blocking_start_time': 1742791543.7927914, 'checkpointer_blocking_duration_secs': 3.8656508922576904, 'get_old_steps_start_time': 1742791547.6584854, 'get_old_steps_duration_secs': 0.03175234794616699, 'checkpoint_manager_blocking_start_time': 1742791543.7909114, 'checkpoint_manager_blocking_duration_secs': 3.9070229530334473} (3484008:standard_logger.py:34)
00:45:47.700 [I] Progress on: 1.00kit/1.00kit rate:10.0s/it remaining:00:00 elapsed:2:29:09 postfix:- (3484008:tqdm_logging.py:145)
00:45:47.704 [I] Waiting for checkpoint manager to finish                                         (3484008:train_pi0_fast_regent.py:301)
00:45:47.705 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3484008:checkpoint_manager.py:1759)
00:45:47.705 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3484008:checkpoint_manager.py:1777)
00:45:56.231 [I] ChainedFuture completed 1/1 futures in 8.58 seconds.                             (3484008:future.py:137)
00:45:56.232 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 833.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3484008:base_pytree_checkpoint_handler.py:113)
00:45:56.232 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3484008:async_checkpointer.py:131)
00:45:56.233 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7f7314977d90> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27 (3484008:async_checkpointer.py:406)
00:45:56.234 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27/assets (3484008:atomicity.py:287)
00:45:56.246 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27/params (3484008:atomicity.py:287)
00:45:56.247 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999 (3484008:async_checkpointer.py:416)
00:45:56.248 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27 (3484008:async_checkpointer.py:426)
00:45:56.248 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999 (3484008:atomicity.py:287)
00:45:56.250 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/1st_try_regent_pokeball/999`. (3484008:atomicity.py:548)
00:45:56.250 [I] [process=0][thread=async_save] Background save thread done.                      (3484008:async_checkpointer.py:183)
00:45:56.251 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3484008:async_checkpointer.py:239)
00:45:56.251 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3484008:async_checkpointer.py:249)
00:45:56.251 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is syncing with other hosts... (3484008:checkpoint_manager.py:1890)
00:45:56.252 [I] [process=0][thread=save_finalize][step=999] CheckpointManager Save Finalize is done on all hosts. (3484008:checkpoint_manager.py:1905)
00:45:56.252 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=999. (3484008:checkpoint_manager.py:1786)
00:45:56.253 [I] [process=0][thread=MainThread][step=999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=999, also errors if any. (3484008:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m1st_try_regent_pokeball[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/jaaidde2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250323_221548-jaaidde2/logs[0m
