nohup: ignoring input
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `data.repo-id` is annotated with type `<class 'str'>`, but the default value `None` has type `<class 'NoneType'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
/home/ksridhar/openpi_regent_droid/.venv/lib/python3.11/site-packages/tyro/_parsers.py:332: UserWarning: The field `model.action-expert-variant` is annotated with type `typing.Literal['dummy', 'gemma_300m', 'gemma_2b', 'gemma_2b_lora']`, but the default value `gemma_300m_lora` has type `<class 'str'>`. We'll try to handle this gracefully, but it may cause unexpected behavior.
  warnings.warn(message)
01:11:09.015 [I] Running on: ivy                                                                  (3802351:train_pi0_fast_regent.py:226)
INFO:2025-03-24 01:11:09,799:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
01:11:09.799 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (3802351:xla_bridge.py:945)
INFO:2025-03-24 01:11:09,799:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
01:11:09.799 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (3802351:xla_bridge.py:945)
01:11:10.777 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3802351:base_pytree_checkpoint_handler.py:332)
01:11:10.777 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3802351:base_pytree_checkpoint_handler.py:332)
01:11:10.777 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (3802351:multihost.py:375)
01:11:10.778 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x7fa5e44dc210>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4419bd0>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4530050>}, handler_registry=None (3802351:checkpoint_manager.py:622)
01:11:10.778 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x7fa5e44dc210>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (3802351:composite_checkpoint_handler.py:239)
01:11:10.779 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4419bd0>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3802351:composite_checkpoint_handler.py:239)
01:11:10.779 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4530050>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (3802351:composite_checkpoint_handler.py:239)
01:11:10.779 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fa5e443bd10>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (3802351:composite_checkpoint_handler.py:239)
01:11:10.779 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fa5e44dc210>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x7fa5e44dc210>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4419bd0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4419bd0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4530050>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x7fa5e4530050>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fa5e443bd10>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7fa5e443bd10>}). (3802351:composite_checkpoint_handler.py:508)
01:11:10.779 [I] orbax-checkpoint version: 0.11.1                                                 (3802351:abstract_checkpointer.py:35)
01:11:10.779 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7fa5e476bc40> timeout: 7200 secs and primary_host=0 for async checkpoint writes (3802351:async_checkpointer.py:80)
01:11:10.780 [I] Found 0 checkpoint steps in /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball (3802351:checkpoint_manager.py:1528)
01:11:10.780 [I] Saving root metadata                                                             (3802351:checkpoint_manager.py:1569)
01:11:10.780 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:save_metadata (3802351:multihost.py:293)
01:11:10.780 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=100, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=False), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7fa5e4439150> (3802351:checkpoint_manager.py:797)
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ksridhar. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /home/ksridhar/openpi_regent_droid/wandb/run-20250324_011111-wq1w3oia
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 2nd_try_regent_pokeball
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ksridhar/openpi
wandb: üöÄ View run at https://wandb.ai/ksridhar/openpi/runs/wq1w3oia
Some kwargs in processor config are unused and will not have any effect: action_dim, time_horizon, scale, min_token, vocab_size. 
Some kwargs in processor config are unused and will not have any effect: action_dim, time_horizon, scale, min_token, vocab_size. 
01:11:20.571 [I] Loaded norm stats from /home/ksridhar/openpi_regent_droid/assets/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/droid (3802351:config.py:167)
count_droid: 0, count_collected_demos: 1108
len_dataset: 1108
all 20 episode prompts are the same: pick up the poke ball and put it in the tray
01:11:41.000 [I] Initialized data loader:
[0].query_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].query_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].query_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_0_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_1_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_2_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_0_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['base_1_rgb']: (16, 224, 224, 3)@float32
[0].retrieved_3_images['left_wrist_0_rgb']: (16, 224, 224, 3)@float32
[0].query_image_masks['base_0_rgb']: (16,)@bool
[0].query_image_masks['base_1_rgb']: (16,)@bool
[0].query_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_0_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_0_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_1_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_1_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_2_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_2_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_0_rgb']: (16,)@bool
[0].retrieved_3_image_masks['base_1_rgb']: (16,)@bool
[0].retrieved_3_image_masks['left_wrist_0_rgb']: (16,)@bool
[0].exp_lamda_distances: (16, 5, 1)@float32
[0].query_state: (16, 8)@float32
[0].retrieved_0_state: (16, 8)@float32
[0].retrieved_1_state: (16, 8)@float32
[0].retrieved_2_state: (16, 8)@float32
[0].retrieved_3_state: (16, 8)@float32
[0].query_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_prefix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_prefix: (16, 125)@int32
[0].query_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_0_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_1_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_2_tokenized_prompt_postfix: (16, 125)@int32
[0].retrieved_3_tokenized_prompt_postfix: (16, 125)@int32
[0].query_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_0_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_1_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_2_tokenized_prompt_mask: (16, 250)@bool
[0].retrieved_3_tokenized_prompt_mask: (16, 250)@bool
[0].query_token_ar_mask: (16, 250)@int32
[0].retrieved_0_token_ar_mask: (16, 250)@int32
[0].retrieved_1_token_ar_mask: (16, 250)@int32
[0].retrieved_2_token_ar_mask: (16, 250)@int32
[0].retrieved_3_token_ar_mask: (16, 250)@int32
[0].query_token_loss_mask: (16, 250)@bool
[0].retrieved_0_token_loss_mask: (16, 250)@bool
[0].retrieved_1_token_loss_mask: (16, 250)@bool
[0].retrieved_2_token_loss_mask: (16, 250)@bool
[0].retrieved_3_token_loss_mask: (16, 250)@bool
[1]: (16, 15, 8)@float32 (3802351:train_pi0_fast_regent.py:258)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
01:11:42.185 [I] Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None (3802351:base_pytree_checkpoint_handler.py:332)
01:11:42.212 [I] Restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (3802351:checkpointer.py:256)
01:11:58.952 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 618.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 16 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:11:58.953 [I] Finished restoring checkpoint from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon/14th_try_with_interpolation_longer_act_horizon/5400/params. (3802351:checkpointer.py:259)
01:11:58.953 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: Checkpointer:restore (3802351:multihost.py:293)
Total Parameters: 2923.0M
Trainable Parameters: 2508.0M
Trainable Parameters %: 85.81%
2025-03-24 01:12:32.733682: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 30.69GiB (32957682654 bytes) by rematerialization; only reduced to 38.92GiB (41795723548 bytes), down from 38.92GiB (41795723548 bytes) originally
01:12:34.755 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@bfloat16
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@bfloat16
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@bfloat16
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@bfloat16
['PaliGemma']['img']['head']['bias'].value: (2048,)@bfloat16
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@bfloat16
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@bfloat16
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32 (3802351:train_pi0_fast_regent.py:262)
decode_indices shape: (1245,)
01:12:36.937 [I] Progress on: -/2000 rate:- remaining:? elapsed:00:00 postfix:-                   (3802351:tqdm_logging.py:145)
first_targets shape: (16, 125, 257152)
input_token_embeddings shape: (16, 5090, 2048)
attn_mask shape: (16, 5090, 5090)
loss_mask shape: (16, 249)
targets shape: (16, 249, 257152)
pre_logits shape: (16, 5089, 2048)
logits shape: (16, 249, 257152)
new_logits shape: (16, 249, 257152)
logp shape: (16, 249, 257152)
token_pplx shape: (16, 249)
loss shape: (16,)
Step 0: grad_norm=17.359312057495117, loss=4.503760814666748, param_norm=1886.9476318359375
01:12:54.173 [I] Progress on: -/2000 rate:- remaining:? elapsed:00:17 postfix:-                   (3802351:tqdm_logging.py:145)
Step 1: grad_norm=12.591771125793457, loss=3.7288219928741455, param_norm=1886.9476318359375
Step 2: grad_norm=10.91232967376709, loss=3.572413921356201, param_norm=1886.9476318359375
01:13:11.280 [I] Progress on: 2.00it/2.00kit rate:12.2s/it remaining:6:46:16 elapsed:00:34 postfix:- (3802351:tqdm_logging.py:145)
Step 3: grad_norm=10.12385082244873, loss=3.579873561859131, param_norm=1886.9476318359375
Step 4: grad_norm=14.463150978088379, loss=3.7384250164031982, param_norm=1886.947509765625
01:13:28.464 [I] Progress on: 4.00it/2.00kit rate:9.8s/it remaining:5:24:57 elapsed:00:51 postfix:- (3802351:tqdm_logging.py:145)
Step 5: grad_norm=12.474493980407715, loss=4.07280969619751, param_norm=1886.947509765625
Step 6: grad_norm=8.664877891540527, loss=3.6987273693084717, param_norm=1886.9473876953125
01:13:45.752 [I] Progress on: 6.00it/2.00kit rate:9.1s/it remaining:5:02:33 elapsed:01:08 postfix:- (3802351:tqdm_logging.py:145)
Step 7: grad_norm=10.479289054870605, loss=3.5206496715545654, param_norm=1886.9473876953125
Step 8: grad_norm=11.862122535705566, loss=3.092031478881836, param_norm=1886.947265625
01:14:03.136 [I] Progress on: 8.00it/2.00kit rate:8.9s/it remaining:4:54:29 elapsed:01:26 postfix:- (3802351:tqdm_logging.py:145)
Step 9: grad_norm=8.151997566223145, loss=3.678605079650879, param_norm=1886.947265625
Step 10: grad_norm=6.676815986633301, loss=3.472080707550049, param_norm=1886.9471435546875
01:14:20.601 [I] Progress on: 10.0it/2.00kit rate:8.8s/it remaining:4:51:31 elapsed:01:43 postfix:- (3802351:tqdm_logging.py:145)
Step 11: grad_norm=6.402171611785889, loss=3.0600857734680176, param_norm=1886.947021484375
Step 12: grad_norm=6.476511001586914, loss=3.1136436462402344, param_norm=1886.947021484375
01:14:38.149 [I] Progress on: 12.0it/2.00kit rate:8.8s/it remaining:4:50:31 elapsed:02:01 postfix:- (3802351:tqdm_logging.py:145)
Step 13: grad_norm=6.090893268585205, loss=3.0221710205078125, param_norm=1886.9468994140625
Step 14: grad_norm=7.419186592102051, loss=3.331929922103882, param_norm=1886.9468994140625
01:14:55.856 [I] Progress on: 14.0it/2.00kit rate:8.8s/it remaining:4:51:32 elapsed:02:18 postfix:- (3802351:tqdm_logging.py:145)
Step 15: grad_norm=9.230602264404297, loss=3.182802677154541, param_norm=1886.94677734375
Step 16: grad_norm=4.99884033203125, loss=3.1785378456115723, param_norm=1886.94677734375
01:15:13.590 [I] Progress on: 16.0it/2.00kit rate:8.8s/it remaining:4:52:12 elapsed:02:36 postfix:- (3802351:tqdm_logging.py:145)
Step 17: grad_norm=4.979180812835693, loss=3.0808024406433105, param_norm=1886.94677734375
Step 18: grad_norm=8.644203186035156, loss=3.1692190170288086, param_norm=1886.9466552734375
01:15:31.365 [I] Progress on: 18.0it/2.00kit rate:8.9s/it remaining:4:52:31 elapsed:02:54 postfix:- (3802351:tqdm_logging.py:145)
Step 19: grad_norm=13.922208786010742, loss=2.985393762588501, param_norm=1886.9466552734375
Step 20: grad_norm=6.9568867683410645, loss=2.9219045639038086, param_norm=1886.9466552734375
01:15:49.097 [I] Progress on: 20.0it/2.00kit rate:8.9s/it remaining:4:52:28 elapsed:03:12 postfix:- (3802351:tqdm_logging.py:145)
Step 21: grad_norm=9.392939567565918, loss=3.044787645339966, param_norm=1886.9466552734375
Step 22: grad_norm=4.937397003173828, loss=2.985551357269287, param_norm=1886.9466552734375
01:16:06.755 [I] Progress on: 22.0it/2.00kit rate:8.9s/it remaining:4:52:05 elapsed:03:29 postfix:- (3802351:tqdm_logging.py:145)
Step 23: grad_norm=4.566145420074463, loss=3.083221673965454, param_norm=1886.94677734375
Step 24: grad_norm=4.8812127113342285, loss=3.074944496154785, param_norm=1886.94677734375
01:16:24.357 [I] Progress on: 24.0it/2.00kit rate:8.8s/it remaining:4:50:48 elapsed:03:47 postfix:- (3802351:tqdm_logging.py:145)
Step 25: grad_norm=16.349361419677734, loss=2.9603819847106934, param_norm=1886.94677734375
Step 26: grad_norm=10.860029220581055, loss=2.9531853199005127, param_norm=1886.9468994140625
01:16:41.922 [I] Progress on: 26.0it/2.00kit rate:8.8s/it remaining:4:49:58 elapsed:04:04 postfix:- (3802351:tqdm_logging.py:145)
Step 27: grad_norm=10.568001747131348, loss=2.9210591316223145, param_norm=1886.947021484375
Step 28: grad_norm=5.551740646362305, loss=2.7070083618164062, param_norm=1886.947021484375
01:16:59.436 [I] Progress on: 28.0it/2.00kit rate:8.8s/it remaining:4:48:53 elapsed:04:22 postfix:- (3802351:tqdm_logging.py:145)
Step 29: grad_norm=4.139656066894531, loss=3.020700454711914, param_norm=1886.9471435546875
Step 30: grad_norm=4.954986572265625, loss=2.984964370727539, param_norm=1886.9471435546875
01:17:16.924 [I] Progress on: 30.0it/2.00kit rate:8.8s/it remaining:4:47:54 elapsed:04:39 postfix:- (3802351:tqdm_logging.py:145)
Step 31: grad_norm=7.688737392425537, loss=2.4436044692993164, param_norm=1886.9471435546875
Step 32: grad_norm=12.159642219543457, loss=2.7950992584228516, param_norm=1886.947265625
01:17:34.413 [I] Progress on: 32.0it/2.00kit rate:8.8s/it remaining:4:47:20 elapsed:04:57 postfix:- (3802351:tqdm_logging.py:145)
Step 33: grad_norm=5.775798320770264, loss=2.9317378997802734, param_norm=1886.9473876953125
Step 34: grad_norm=7.185525894165039, loss=2.7943103313446045, param_norm=1886.947509765625
01:17:51.896 [I] Progress on: 34.0it/2.00kit rate:8.8s/it remaining:4:46:49 elapsed:05:14 postfix:- (3802351:tqdm_logging.py:145)
Step 35: grad_norm=5.550178527832031, loss=2.938230276107788, param_norm=1886.947509765625
Step 36: grad_norm=4.369815826416016, loss=3.000481128692627, param_norm=1886.9476318359375
01:18:09.362 [I] Progress on: 36.0it/2.00kit rate:8.7s/it remaining:4:46:09 elapsed:05:32 postfix:- (3802351:tqdm_logging.py:145)
Step 37: grad_norm=11.523294448852539, loss=2.424617052078247, param_norm=1886.9478759765625
Step 38: grad_norm=12.911242485046387, loss=2.997547149658203, param_norm=1886.9478759765625
01:18:26.826 [I] Progress on: 38.0it/2.00kit rate:8.7s/it remaining:4:45:43 elapsed:05:49 postfix:- (3802351:tqdm_logging.py:145)
Step 39: grad_norm=4.402286052703857, loss=2.55133056640625, param_norm=1886.9482421875
Step 40: grad_norm=9.5483980178833, loss=2.380614757537842, param_norm=1886.9483642578125
01:18:44.295 [I] Progress on: 40.0it/2.00kit rate:8.7s/it remaining:4:45:21 elapsed:06:07 postfix:- (3802351:tqdm_logging.py:145)
Step 41: grad_norm=6.397523880004883, loss=2.7866759300231934, param_norm=1886.9486083984375
Step 42: grad_norm=9.824344635009766, loss=2.951122760772705, param_norm=1886.94873046875
01:19:01.865 [I] Progress on: 42.0it/2.00kit rate:8.8s/it remaining:4:45:58 elapsed:06:24 postfix:- (3802351:tqdm_logging.py:145)
Step 43: grad_norm=12.526063919067383, loss=2.665227174758911, param_norm=1886.948974609375
Step 44: grad_norm=5.764842987060547, loss=2.6807236671447754, param_norm=1886.94921875
01:19:19.395 [I] Progress on: 44.0it/2.00kit rate:8.8s/it remaining:4:45:43 elapsed:06:42 postfix:- (3802351:tqdm_logging.py:145)
Step 45: grad_norm=9.013398170471191, loss=2.8297958374023438, param_norm=1886.949462890625
Step 46: grad_norm=5.511894702911377, loss=2.5106945037841797, param_norm=1886.9498291015625
01:19:36.811 [I] Progress on: 46.0it/2.00kit rate:8.7s/it remaining:4:44:26 elapsed:06:59 postfix:- (3802351:tqdm_logging.py:145)
Step 47: grad_norm=4.890532970428467, loss=2.522463321685791, param_norm=1886.949951171875
Step 48: grad_norm=9.930152893066406, loss=2.803083896636963, param_norm=1886.9503173828125
01:19:54.282 [I] Progress on: 48.0it/2.00kit rate:8.7s/it remaining:4:44:12 elapsed:07:17 postfix:- (3802351:tqdm_logging.py:145)
Step 49: grad_norm=4.546972274780273, loss=2.8235230445861816, param_norm=1886.9505615234375
Step 50: grad_norm=5.6679277420043945, loss=2.7259464263916016, param_norm=1886.950927734375
01:20:11.814 [I] Progress on: 50.0it/2.00kit rate:8.7s/it remaining:4:44:20 elapsed:07:34 postfix:- (3802351:tqdm_logging.py:145)
Step 51: grad_norm=6.051424980163574, loss=2.8012518882751465, param_norm=1886.9512939453125
Step 52: grad_norm=5.108010768890381, loss=2.581411600112915, param_norm=1886.95166015625
01:20:29.353 [I] Progress on: 52.0it/2.00kit rate:8.8s/it remaining:4:44:23 elapsed:07:52 postfix:- (3802351:tqdm_logging.py:145)
Step 53: grad_norm=6.594728469848633, loss=2.54706072807312, param_norm=1886.951904296875
Step 54: grad_norm=6.090963840484619, loss=2.861199378967285, param_norm=1886.9522705078125
01:20:46.895 [I] Progress on: 54.0it/2.00kit rate:8.8s/it remaining:4:44:21 elapsed:08:09 postfix:- (3802351:tqdm_logging.py:145)
Step 55: grad_norm=12.31094741821289, loss=2.4697322845458984, param_norm=1886.95263671875
Step 56: grad_norm=4.97099494934082, loss=2.9011826515197754, param_norm=1886.9530029296875
01:21:04.441 [I] Progress on: 56.0it/2.00kit rate:8.8s/it remaining:4:44:03 elapsed:08:27 postfix:- (3802351:tqdm_logging.py:145)
Step 57: grad_norm=7.044312000274658, loss=2.6260476112365723, param_norm=1886.953369140625
Step 58: grad_norm=4.373429775238037, loss=2.5242154598236084, param_norm=1886.9537353515625
01:21:22.002 [I] Progress on: 58.0it/2.00kit rate:8.8s/it remaining:4:44:02 elapsed:08:45 postfix:- (3802351:tqdm_logging.py:145)
Step 59: grad_norm=10.74135971069336, loss=2.6992297172546387, param_norm=1886.9541015625
Step 60: grad_norm=10.180986404418945, loss=2.802504777908325, param_norm=1886.9544677734375
01:21:39.591 [I] Progress on: 60.0it/2.00kit rate:8.8s/it remaining:4:43:54 elapsed:09:02 postfix:- (3802351:tqdm_logging.py:145)
Step 61: grad_norm=9.2617826461792, loss=2.6976537704467773, param_norm=1886.9547119140625
Step 62: grad_norm=5.990161418914795, loss=2.516288995742798, param_norm=1886.955078125
01:21:57.181 [I] Progress on: 62.0it/2.00kit rate:8.8s/it remaining:4:43:54 elapsed:09:20 postfix:- (3802351:tqdm_logging.py:145)
Step 63: grad_norm=9.065080642700195, loss=2.551793098449707, param_norm=1886.955322265625
Step 64: grad_norm=13.19752025604248, loss=2.7902750968933105, param_norm=1886.95556640625
01:22:14.756 [I] Progress on: 64.0it/2.00kit rate:8.8s/it remaining:4:43:37 elapsed:09:37 postfix:- (3802351:tqdm_logging.py:145)
Step 65: grad_norm=11.001066207885742, loss=2.7820849418640137, param_norm=1886.9560546875
Step 66: grad_norm=6.373847484588623, loss=2.756953239440918, param_norm=1886.956298828125
01:22:32.357 [I] Progress on: 66.0it/2.00kit rate:8.8s/it remaining:4:43:31 elapsed:09:55 postfix:- (3802351:tqdm_logging.py:145)
Step 67: grad_norm=6.379817485809326, loss=2.63039493560791, param_norm=1886.95654296875
Step 68: grad_norm=19.905658721923828, loss=2.394322633743286, param_norm=1886.956787109375
01:22:49.963 [I] Progress on: 68.0it/2.00kit rate:8.8s/it remaining:4:43:26 elapsed:10:13 postfix:- (3802351:tqdm_logging.py:145)
Step 69: grad_norm=6.013224124908447, loss=2.04160213470459, param_norm=1886.957275390625
01:23:01.161 [I] Progress on: 69.0it/2.00kit rate:9.5s/it remaining:5:06:26 elapsed:10:24 postfix:- (3802351:tqdm_logging.py:145)
Step 70: grad_norm=8.181267738342285, loss=2.061638116836548, param_norm=1886.9576416015625
Step 71: grad_norm=8.090156555175781, loss=2.3515703678131104, param_norm=1886.9581298828125
01:23:18.747 [I] Progress on: 71.0it/2.00kit rate:9.1s/it remaining:4:54:08 elapsed:10:41 postfix:- (3802351:tqdm_logging.py:145)
Step 72: grad_norm=12.958568572998047, loss=2.2052340507507324, param_norm=1886.95849609375
Step 73: grad_norm=5.92341947555542, loss=1.9806129932403564, param_norm=1886.958740234375
01:23:36.329 [I] Progress on: 73.0it/2.00kit rate:9.0s/it remaining:4:47:58 elapsed:10:59 postfix:- (3802351:tqdm_logging.py:145)
Step 74: grad_norm=9.340143203735352, loss=2.357534408569336, param_norm=1886.959228515625
Step 75: grad_norm=4.515537261962891, loss=2.5101418495178223, param_norm=1886.95947265625
01:23:53.946 [I] Progress on: 75.0it/2.00kit rate:8.9s/it remaining:4:44:56 elapsed:11:17 postfix:- (3802351:tqdm_logging.py:145)
Step 76: grad_norm=8.70199203491211, loss=2.3433115482330322, param_norm=1886.9598388671875
Step 77: grad_norm=7.98675012588501, loss=1.9545643329620361, param_norm=1886.9603271484375
01:24:11.529 [I] Progress on: 77.0it/2.00kit rate:8.8s/it remaining:4:43:12 elapsed:11:34 postfix:- (3802351:tqdm_logging.py:145)
Step 78: grad_norm=6.86632776260376, loss=2.304525852203369, param_norm=1886.960693359375
Step 79: grad_norm=4.997509479522705, loss=2.3141283988952637, param_norm=1886.9610595703125
01:24:29.130 [I] Progress on: 79.0it/2.00kit rate:8.8s/it remaining:4:42:16 elapsed:11:52 postfix:- (3802351:tqdm_logging.py:145)
Step 80: grad_norm=10.544984817504883, loss=2.2326159477233887, param_norm=1886.9615478515625
Step 81: grad_norm=8.09062385559082, loss=1.8073844909667969, param_norm=1886.9617919921875
01:24:46.726 [I] Progress on: 81.0it/2.00kit rate:8.8s/it remaining:4:41:42 elapsed:12:09 postfix:- (3802351:tqdm_logging.py:145)
Step 82: grad_norm=4.583964824676514, loss=2.185009002685547, param_norm=1886.9622802734375
Step 83: grad_norm=6.208401203155518, loss=2.561537742614746, param_norm=1886.962646484375
01:25:04.469 [I] Progress on: 83.0it/2.00kit rate:8.8s/it remaining:4:41:27 elapsed:12:27 postfix:- (3802351:tqdm_logging.py:145)
Step 84: grad_norm=12.710963249206543, loss=2.2565195560455322, param_norm=1886.9630126953125
Step 85: grad_norm=10.542794227600098, loss=2.324143886566162, param_norm=1886.96337890625
01:25:22.133 [I] Progress on: 85.0it/2.00kit rate:8.8s/it remaining:4:42:11 elapsed:12:45 postfix:- (3802351:tqdm_logging.py:145)
Step 86: grad_norm=9.014660835266113, loss=2.209787607192993, param_norm=1886.9638671875
Step 87: grad_norm=9.503302574157715, loss=2.1999258995056152, param_norm=1886.964111328125
01:25:39.737 [I] Progress on: 87.0it/2.00kit rate:8.8s/it remaining:4:41:11 elapsed:13:02 postfix:- (3802351:tqdm_logging.py:145)
Step 88: grad_norm=11.349900245666504, loss=2.512296199798584, param_norm=1886.964599609375
Step 89: grad_norm=5.22439432144165, loss=2.197748899459839, param_norm=1886.96484375
01:25:57.325 [I] Progress on: 89.0it/2.00kit rate:8.8s/it remaining:4:40:31 elapsed:13:20 postfix:- (3802351:tqdm_logging.py:145)
Step 90: grad_norm=6.054595470428467, loss=2.5119876861572266, param_norm=1886.9652099609375
Step 91: grad_norm=5.980011463165283, loss=2.427400588989258, param_norm=1886.965576171875
01:26:14.924 [I] Progress on: 91.0it/2.00kit rate:8.8s/it remaining:4:40:00 elapsed:13:37 postfix:- (3802351:tqdm_logging.py:145)
Step 92: grad_norm=9.726218223571777, loss=2.4630203247070312, param_norm=1886.9659423828125
Step 93: grad_norm=17.819543838500977, loss=2.3492531776428223, param_norm=1886.96630859375
01:26:32.548 [I] Progress on: 93.0it/2.00kit rate:8.8s/it remaining:4:39:51 elapsed:13:55 postfix:- (3802351:tqdm_logging.py:145)
Step 94: grad_norm=8.922445297241211, loss=2.2006216049194336, param_norm=1886.966796875
Step 95: grad_norm=48.851436614990234, loss=2.1452481746673584, param_norm=1886.9671630859375
01:26:50.174 [I] Progress on: 95.0it/2.00kit rate:8.8s/it remaining:4:39:41 elapsed:14:13 postfix:- (3802351:tqdm_logging.py:145)
Step 96: grad_norm=11.982768058776855, loss=2.470423698425293, param_norm=1886.9676513671875
Step 97: grad_norm=8.805614471435547, loss=2.58249831199646, param_norm=1886.9678955078125
01:27:07.798 [I] Progress on: 97.0it/2.00kit rate:8.8s/it remaining:4:39:21 elapsed:14:30 postfix:- (3802351:tqdm_logging.py:145)
Step 98: grad_norm=16.63543701171875, loss=2.259664535522461, param_norm=1886.9683837890625
Step 99: grad_norm=6.446069240570068, loss=2.2358055114746094, param_norm=1886.96875
01:27:25.444 [I] Progress on: 99.0it/2.00kit rate:8.8s/it remaining:4:39:19 elapsed:14:48 postfix:- (3802351:tqdm_logging.py:145)
Step 100: grad_norm=12.052926063537598, loss=2.3201279640197754, param_norm=1886.9691162109375
01:27:34.437 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
01:27:34.437 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (3802351:checkpoint_manager.py:1767)
01:27:34.438 [I] [process=0] Saving checkpoint at step 100                                        (3802351:checkpoint_manager.py:1286)
01:27:34.439 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100. (3802351:async_checkpointer.py:358)
01:27:34.441 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
01:27:34.442 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0 (3802351:atomicity.py:144)
01:27:34.444 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
01:27:34.444 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
01:27:34.446 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (3802351:atomicity.py:144)
01:27:34.447 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742794054443427635, 'commit_timestamp_nsecs': None, 'custom': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1742794054443427635, "commit_timestamp_nsecs": null, "custom": {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3802351:checkpoint.py:185)
01:27:34.447 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (3802351:atomicity.py:144)
01:27:34.449 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
01:27:34.461 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
01:27:38.273 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:27:38.279 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
01:27:38.280 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
01:27:38.281 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
01:27:38.287 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
01:27:38.289 [I] [process=0][thread=MainThread][step=100] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
01:27:38.291 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
01:27:38.303 [I] {'step': 100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742794054.4372292, 'wait_for_prev_duration_secs': 0.0006215572357177734, 'checkpointer_blocking_start_time': 1742794054.4387596, 'checkpointer_blocking_duration_secs': 3.8480594158172607, 'get_old_steps_start_time': 1742794058.286928, 'get_old_steps_duration_secs': 1.3828277587890625e-05, 'checkpoint_manager_blocking_start_time': 1742794054.4369597, 'checkpoint_manager_blocking_duration_secs': 3.8667006492614746} (3802351:standard_logger.py:34)
01:27:38.311 [I] Progress on: 101it/2.00kit rate:10.0s/it remaining:5:15:34 elapsed:15:01 postfix:- (3802351:tqdm_logging.py:145)
Step 101: grad_norm=8.060419082641602, loss=2.278210163116455, param_norm=1886.9693603515625
01:27:47.874 [I] ChainedFuture completed 1/1 futures in 9.59 seconds.                             (3802351:future.py:137)
01:27:47.874 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 771.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:27:47.875 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
01:27:47.876 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742794054443427635, 'commit_timestamp_nsecs': None, 'custom': {}} from /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3802351:checkpoint.py:225)
01:27:47.878 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0 (3802351:async_checkpointer.py:406)
01:27:47.878 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/assets (3802351:atomicity.py:287)
01:27:47.880 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1742794054443427635, 'commit_timestamp_nsecs': None, 'custom': {}} to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (3802351:checkpoint.py:244)
01:27:47.890 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0/params (3802351:atomicity.py:287)
01:27:47.891 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100 (3802351:async_checkpointer.py:416)
01:27:47.891 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0 (3802351:async_checkpointer.py:426)
01:27:47.891 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100.orbax-checkpoint-tmp-0 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100 (3802351:atomicity.py:287)
01:27:47.893 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/100`. (3802351:atomicity.py:548)
01:27:47.893 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
01:27:47.894 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
01:27:47.894 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
01:27:47.895 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
01:27:47.895 [I] [process=0][thread=save_finalize][step=100] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 102: grad_norm=14.355608940124512, loss=2.3614821434020996, param_norm=1886.9698486328125
01:27:55.666 [I] Progress on: 102it/2.00kit rate:9.6s/it remaining:5:03:58 elapsed:15:18 postfix:- (3802351:tqdm_logging.py:145)
Step 103: grad_norm=9.249994277954102, loss=2.4108128547668457, param_norm=1886.97021484375
Step 104: grad_norm=8.41156005859375, loss=2.3377561569213867, param_norm=1886.970458984375
01:28:13.216 [I] Progress on: 104it/2.00kit rate:9.2s/it remaining:4:50:11 elapsed:15:36 postfix:- (3802351:tqdm_logging.py:145)
Step 105: grad_norm=6.943641185760498, loss=2.385061740875244, param_norm=1886.9710693359375
Step 106: grad_norm=14.566985130310059, loss=2.235222101211548, param_norm=1886.971435546875
01:28:30.798 [I] Progress on: 106it/2.00kit rate:9.0s/it remaining:4:43:36 elapsed:15:53 postfix:- (3802351:tqdm_logging.py:145)
Step 107: grad_norm=5.295980453491211, loss=2.1832845211029053, param_norm=1886.9718017578125
Step 108: grad_norm=19.022157669067383, loss=2.369579315185547, param_norm=1886.9722900390625
01:28:48.384 [I] Progress on: 108it/2.00kit rate:8.9s/it remaining:4:40:10 elapsed:16:11 postfix:- (3802351:tqdm_logging.py:145)
Step 109: grad_norm=22.96847152709961, loss=2.2492194175720215, param_norm=1886.97265625
Step 110: grad_norm=8.32153606414795, loss=1.9991017580032349, param_norm=1886.9730224609375
01:29:05.943 [I] Progress on: 110it/2.00kit rate:8.8s/it remaining:4:38:12 elapsed:16:29 postfix:- (3802351:tqdm_logging.py:145)
Step 111: grad_norm=17.99637794494629, loss=2.347137928009033, param_norm=1886.973388671875
Step 112: grad_norm=10.105913162231445, loss=2.2141919136047363, param_norm=1886.9737548828125
01:29:23.503 [I] Progress on: 112it/2.00kit rate:8.8s/it remaining:4:37:02 elapsed:16:46 postfix:- (3802351:tqdm_logging.py:145)
Step 113: grad_norm=6.874527931213379, loss=2.311321258544922, param_norm=1886.9739990234375
Step 114: grad_norm=12.756793022155762, loss=2.1482112407684326, param_norm=1886.974365234375
01:29:41.048 [I] Progress on: 114it/2.00kit rate:8.8s/it remaining:4:36:10 elapsed:17:04 postfix:- (3802351:tqdm_logging.py:145)
Step 115: grad_norm=14.100767135620117, loss=2.301743984222412, param_norm=1886.974853515625
Step 116: grad_norm=9.432969093322754, loss=2.2822957038879395, param_norm=1886.97509765625
01:29:58.634 [I] Progress on: 116it/2.00kit rate:8.8s/it remaining:4:36:03 elapsed:17:21 postfix:- (3802351:tqdm_logging.py:145)
Step 117: grad_norm=15.156864166259766, loss=2.383307933807373, param_norm=1886.9757080078125
Step 118: grad_norm=5.739302158355713, loss=2.257054090499878, param_norm=1886.97607421875
01:30:16.183 [I] Progress on: 118it/2.00kit rate:8.8s/it remaining:4:35:38 elapsed:17:39 postfix:- (3802351:tqdm_logging.py:145)
Step 119: grad_norm=6.147887706756592, loss=2.162501811981201, param_norm=1886.9764404296875
Step 120: grad_norm=11.83105182647705, loss=2.0710713863372803, param_norm=1886.976806640625
01:30:33.751 [I] Progress on: 120it/2.00kit rate:8.8s/it remaining:4:35:06 elapsed:17:56 postfix:- (3802351:tqdm_logging.py:145)
Step 121: grad_norm=12.322354316711426, loss=2.192094326019287, param_norm=1886.9771728515625
Step 122: grad_norm=15.892537117004395, loss=2.240860939025879, param_norm=1886.9776611328125
01:30:51.342 [I] Progress on: 122it/2.00kit rate:8.8s/it remaining:4:35:08 elapsed:18:14 postfix:- (3802351:tqdm_logging.py:145)
Step 123: grad_norm=9.981169700622559, loss=2.1720242500305176, param_norm=1886.97802734375
Step 124: grad_norm=7.758437156677246, loss=2.25392484664917, param_norm=1886.978271484375
01:31:08.932 [I] Progress on: 124it/2.00kit rate:8.8s/it remaining:4:34:59 elapsed:18:31 postfix:- (3802351:tqdm_logging.py:145)
Step 125: grad_norm=5.670289993286133, loss=2.423532009124756, param_norm=1886.978515625
Step 126: grad_norm=7.685245037078857, loss=2.3249943256378174, param_norm=1886.9788818359375
01:31:26.476 [I] Progress on: 126it/2.00kit rate:8.8s/it remaining:4:34:15 elapsed:18:49 postfix:- (3802351:tqdm_logging.py:145)
Step 127: grad_norm=17.89907455444336, loss=2.260835647583008, param_norm=1886.979248046875
Step 128: grad_norm=13.020264625549316, loss=2.327045440673828, param_norm=1886.9796142578125
01:31:44.106 [I] Progress on: 128it/2.00kit rate:8.8s/it remaining:4:34:32 elapsed:19:07 postfix:- (3802351:tqdm_logging.py:145)
Step 129: grad_norm=12.653600692749023, loss=2.2325057983398438, param_norm=1886.97998046875
Step 130: grad_norm=5.98737907409668, loss=2.407604217529297, param_norm=1886.980224609375
01:32:01.750 [I] Progress on: 130it/2.00kit rate:8.8s/it remaining:4:34:38 elapsed:19:24 postfix:- (3802351:tqdm_logging.py:145)
Step 131: grad_norm=15.58297061920166, loss=2.128476142883301, param_norm=1886.98046875
Step 132: grad_norm=16.862768173217773, loss=2.398125171661377, param_norm=1886.9808349609375
01:32:19.371 [I] Progress on: 132it/2.00kit rate:8.8s/it remaining:4:34:19 elapsed:19:42 postfix:- (3802351:tqdm_logging.py:145)
Step 133: grad_norm=5.040887355804443, loss=2.154754161834717, param_norm=1886.981201171875
Step 134: grad_norm=7.706988334655762, loss=2.419553279876709, param_norm=1886.9815673828125
01:32:36.997 [I] Progress on: 134it/2.00kit rate:8.8s/it remaining:4:34:03 elapsed:20:00 postfix:- (3802351:tqdm_logging.py:145)
Step 135: grad_norm=7.211801052093506, loss=2.2055912017822266, param_norm=1886.9818115234375
Step 136: grad_norm=7.688838958740234, loss=2.39852237701416, param_norm=1886.982177734375
01:32:54.600 [I] Progress on: 136it/2.00kit rate:8.8s/it remaining:4:33:36 elapsed:20:17 postfix:- (3802351:tqdm_logging.py:145)
Step 137: grad_norm=20.180252075195312, loss=2.2574572563171387, param_norm=1886.9825439453125
01:33:06.004 [I] Progress on: 138it/2.00kit rate:9.5s/it remaining:4:55:36 elapsed:20:29 postfix:- (3802351:tqdm_logging.py:145)
Step 138: grad_norm=17.093677520751953, loss=1.9738006591796875, param_norm=1886.98291015625
Step 139: grad_norm=12.933274269104004, loss=2.0391476154327393, param_norm=1886.9832763671875
01:33:23.363 [I] Progress on: 139it/2.00kit rate:9.3s/it remaining:4:48:18 elapsed:20:46 postfix:- (3802351:tqdm_logging.py:145)
Step 140: grad_norm=6.977916240692139, loss=1.7207838296890259, param_norm=1886.983642578125
Step 141: grad_norm=10.402813911437988, loss=1.964639663696289, param_norm=1886.984130859375
01:33:41.017 [I] Progress on: 141it/2.00kit rate:9.0s/it remaining:4:40:18 elapsed:21:04 postfix:- (3802351:tqdm_logging.py:145)
Step 142: grad_norm=7.05076265335083, loss=2.297769546508789, param_norm=1886.9844970703125
Step 143: grad_norm=5.245452880859375, loss=1.8909696340560913, param_norm=1886.98486328125
01:33:58.700 [I] Progress on: 143it/2.00kit rate:8.9s/it remaining:4:36:38 elapsed:21:21 postfix:- (3802351:tqdm_logging.py:145)
Step 144: grad_norm=11.499448776245117, loss=1.9413988590240479, param_norm=1886.9852294921875
Step 145: grad_norm=6.570241451263428, loss=1.8010566234588623, param_norm=1886.985595703125
01:34:16.293 [I] Progress on: 145it/2.00kit rate:8.9s/it remaining:4:33:50 elapsed:21:39 postfix:- (3802351:tqdm_logging.py:145)
Step 146: grad_norm=5.166070461273193, loss=1.897162914276123, param_norm=1886.9859619140625
Step 147: grad_norm=6.765385150909424, loss=1.7428958415985107, param_norm=1886.986328125
01:34:33.989 [I] Progress on: 147it/2.00kit rate:8.8s/it remaining:4:33:18 elapsed:21:57 postfix:- (3802351:tqdm_logging.py:145)
Step 148: grad_norm=10.938278198242188, loss=1.7330151796340942, param_norm=1886.9866943359375
Step 149: grad_norm=14.66354751586914, loss=1.9497195482254028, param_norm=1886.9871826171875
01:34:51.664 [I] Progress on: 149it/2.00kit rate:8.8s/it remaining:4:32:34 elapsed:22:14 postfix:- (3802351:tqdm_logging.py:145)
Step 150: grad_norm=27.62462615966797, loss=1.7615761756896973, param_norm=1886.987548828125
Step 151: grad_norm=5.280502796173096, loss=1.789330244064331, param_norm=1886.988037109375
01:35:09.343 [I] Progress on: 151it/2.00kit rate:8.8s/it remaining:4:32:12 elapsed:22:32 postfix:- (3802351:tqdm_logging.py:145)
Step 152: grad_norm=8.946146965026855, loss=2.08866548538208, param_norm=1886.988525390625
Step 153: grad_norm=8.138739585876465, loss=2.107679843902588, param_norm=1886.9888916015625
01:35:27.008 [I] Progress on: 153it/2.00kit rate:8.8s/it remaining:4:31:45 elapsed:22:50 postfix:- (3802351:tqdm_logging.py:145)
Step 154: grad_norm=15.347095489501953, loss=1.9473341703414917, param_norm=1886.9892578125
Step 155: grad_norm=16.959922790527344, loss=2.055563449859619, param_norm=1886.9896240234375
01:35:44.680 [I] Progress on: 155it/2.00kit rate:8.8s/it remaining:4:31:24 elapsed:23:07 postfix:- (3802351:tqdm_logging.py:145)
Step 156: grad_norm=7.3190155029296875, loss=1.8715014457702637, param_norm=1886.9901123046875
Step 157: grad_norm=7.715104579925537, loss=1.9114046096801758, param_norm=1886.990478515625
01:36:02.344 [I] Progress on: 157it/2.00kit rate:8.8s/it remaining:4:31:00 elapsed:23:25 postfix:- (3802351:tqdm_logging.py:145)
Step 158: grad_norm=11.144821166992188, loss=2.036639928817749, param_norm=1886.9908447265625
Step 159: grad_norm=10.90395450592041, loss=1.8967351913452148, param_norm=1886.9912109375
01:36:20.021 [I] Progress on: 159it/2.00kit rate:8.8s/it remaining:4:30:44 elapsed:23:43 postfix:- (3802351:tqdm_logging.py:145)
Step 160: grad_norm=6.728097438812256, loss=2.149294376373291, param_norm=1886.991455078125
Step 161: grad_norm=7.891759872436523, loss=1.828302264213562, param_norm=1886.991943359375
01:36:37.636 [I] Progress on: 161it/2.00kit rate:8.8s/it remaining:4:30:11 elapsed:24:00 postfix:- (3802351:tqdm_logging.py:145)
Step 162: grad_norm=14.147428512573242, loss=1.8627538681030273, param_norm=1886.9921875
Step 163: grad_norm=9.342085838317871, loss=2.1682238578796387, param_norm=1886.9925537109375
01:36:55.296 [I] Progress on: 163it/2.00kit rate:8.8s/it remaining:4:29:50 elapsed:24:18 postfix:- (3802351:tqdm_logging.py:145)
Step 164: grad_norm=7.1093621253967285, loss=1.9480922222137451, param_norm=1886.992919921875
Step 165: grad_norm=6.6333160400390625, loss=1.867814540863037, param_norm=1886.993408203125
01:37:12.902 [I] Progress on: 165it/2.00kit rate:8.8s/it remaining:4:29:14 elapsed:24:35 postfix:- (3802351:tqdm_logging.py:145)
Step 166: grad_norm=28.79961585998535, loss=2.082533836364746, param_norm=1886.99365234375
Step 167: grad_norm=7.573516368865967, loss=2.0849170684814453, param_norm=1886.9940185546875
01:37:30.515 [I] Progress on: 167it/2.00kit rate:8.8s/it remaining:4:28:50 elapsed:24:53 postfix:- (3802351:tqdm_logging.py:145)
Step 168: grad_norm=5.175048828125, loss=2.0461764335632324, param_norm=1886.994384765625
Step 169: grad_norm=11.55620288848877, loss=1.7154533863067627, param_norm=1886.9947509765625
01:37:48.107 [I] Progress on: 169it/2.00kit rate:8.8s/it remaining:4:28:22 elapsed:25:11 postfix:- (3802351:tqdm_logging.py:145)
Step 170: grad_norm=4.763859748840332, loss=1.6311230659484863, param_norm=1886.9952392578125
Step 171: grad_norm=5.488914966583252, loss=1.8507122993469238, param_norm=1886.9954833984375
01:38:05.738 [I] Progress on: 171it/2.00kit rate:8.8s/it remaining:4:28:19 elapsed:25:28 postfix:- (3802351:tqdm_logging.py:145)
Step 172: grad_norm=6.573679447174072, loss=1.9769070148468018, param_norm=1886.995849609375
Step 173: grad_norm=5.669107437133789, loss=1.8483893871307373, param_norm=1886.996337890625
01:38:23.320 [I] Progress on: 173it/2.00kit rate:8.8s/it remaining:4:27:45 elapsed:25:46 postfix:- (3802351:tqdm_logging.py:145)
Step 174: grad_norm=44.46926498413086, loss=2.0349714756011963, param_norm=1886.9967041015625
Step 175: grad_norm=5.196995258331299, loss=1.7672795057296753, param_norm=1886.9970703125
01:38:40.950 [I] Progress on: 175it/2.00kit rate:8.8s/it remaining:4:27:42 elapsed:26:04 postfix:- (3802351:tqdm_logging.py:145)
Step 176: grad_norm=5.96293830871582, loss=1.9152953624725342, param_norm=1886.9974365234375
Step 177: grad_norm=9.127103805541992, loss=2.026777982711792, param_norm=1886.9979248046875
01:38:58.587 [I] Progress on: 177it/2.00kit rate:8.8s/it remaining:4:27:30 elapsed:26:21 postfix:- (3802351:tqdm_logging.py:145)
Step 178: grad_norm=13.244296073913574, loss=2.0745956897735596, param_norm=1886.998291015625
Step 179: grad_norm=17.753307342529297, loss=1.828506588935852, param_norm=1886.9986572265625
01:39:16.219 [I] Progress on: 179it/2.00kit rate:8.8s/it remaining:4:27:15 elapsed:26:39 postfix:- (3802351:tqdm_logging.py:145)
Step 180: grad_norm=8.677837371826172, loss=1.9794948101043701, param_norm=1886.9989013671875
Step 181: grad_norm=17.382970809936523, loss=1.9603374004364014, param_norm=1886.9993896484375
01:39:33.802 [I] Progress on: 181it/2.00kit rate:8.8s/it remaining:4:26:41 elapsed:26:56 postfix:- (3802351:tqdm_logging.py:145)
Step 182: grad_norm=28.97528076171875, loss=2.1441445350646973, param_norm=1886.9998779296875
Step 183: grad_norm=10.536699295043945, loss=1.80912184715271, param_norm=1887.000244140625
01:39:51.450 [I] Progress on: 183it/2.00kit rate:8.8s/it remaining:4:26:40 elapsed:27:14 postfix:- (3802351:tqdm_logging.py:145)
Step 184: grad_norm=11.490802764892578, loss=1.955420732498169, param_norm=1887.0006103515625
Step 185: grad_norm=32.649417877197266, loss=2.30983829498291, param_norm=1887.0009765625
01:40:09.079 [I] Progress on: 185it/2.00kit rate:8.8s/it remaining:4:26:27 elapsed:27:32 postfix:- (3802351:tqdm_logging.py:145)
Step 186: grad_norm=24.104236602783203, loss=2.1160945892333984, param_norm=1887.0013427734375
Step 187: grad_norm=8.50155258178711, loss=2.050968647003174, param_norm=1887.001708984375
01:40:26.700 [I] Progress on: 187it/2.00kit rate:8.8s/it remaining:4:26:05 elapsed:27:49 postfix:- (3802351:tqdm_logging.py:145)
Step 188: grad_norm=7.92353630065918, loss=1.9713916778564453, param_norm=1887.001953125
Step 189: grad_norm=11.897955894470215, loss=2.073284149169922, param_norm=1887.0023193359375
01:40:44.316 [I] Progress on: 189it/2.00kit rate:8.8s/it remaining:4:25:45 elapsed:28:07 postfix:- (3802351:tqdm_logging.py:145)
Step 190: grad_norm=16.50863265991211, loss=1.9232118129730225, param_norm=1887.002685546875
Step 191: grad_norm=17.23451042175293, loss=1.9709763526916504, param_norm=1887.0030517578125
01:41:01.952 [I] Progress on: 191it/2.00kit rate:8.8s/it remaining:4:25:32 elapsed:28:25 postfix:- (3802351:tqdm_logging.py:145)
Step 192: grad_norm=14.270631790161133, loss=2.0229249000549316, param_norm=1887.00341796875
Step 193: grad_norm=5.378663539886475, loss=1.7319421768188477, param_norm=1887.003662109375
01:41:19.612 [I] Progress on: 193it/2.00kit rate:8.8s/it remaining:4:25:25 elapsed:28:42 postfix:- (3802351:tqdm_logging.py:145)
Step 194: grad_norm=8.431853294372559, loss=2.036703109741211, param_norm=1887.004150390625
Step 195: grad_norm=9.858070373535156, loss=1.9655957221984863, param_norm=1887.00439453125
01:41:37.272 [I] Progress on: 195it/2.00kit rate:8.8s/it remaining:4:25:15 elapsed:29:00 postfix:- (3802351:tqdm_logging.py:145)
Step 196: grad_norm=8.806771278381348, loss=1.9796011447906494, param_norm=1887.0048828125
Step 197: grad_norm=12.263287544250488, loss=1.8319288492202759, param_norm=1887.0052490234375
01:41:54.904 [I] Progress on: 197it/2.00kit rate:8.8s/it remaining:4:24:47 elapsed:29:17 postfix:- (3802351:tqdm_logging.py:145)
Step 198: grad_norm=14.331938743591309, loss=2.1345415115356445, param_norm=1887.005615234375
Step 199: grad_norm=8.653434753417969, loss=1.9602315425872803, param_norm=1887.0059814453125
01:42:12.559 [I] Progress on: 199it/2.00kit rate:8.8s/it remaining:4:24:32 elapsed:29:35 postfix:- (3802351:tqdm_logging.py:145)
Step 200: grad_norm=10.194948196411133, loss=1.845332384109497, param_norm=1887.00634765625
01:42:21.585 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
01:42:21.585 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
01:42:21.585 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100. (3802351:checkpoint_manager.py:1786)
01:42:21.585 [I] [process=0][thread=MainThread][step=100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=100, also errors if any. (3802351:checkpoint_manager.py:1817)
01:42:21.586 [I] [process=0] Saving checkpoint at step 200                                        (3802351:checkpoint_manager.py:1286)
01:42:21.587 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200. (3802351:async_checkpointer.py:358)
01:42:21.588 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
01:42:21.589 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3 (3802351:atomicity.py:144)
01:42:21.590 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
01:42:21.591 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
01:42:21.593 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 (3802351:atomicity.py:144)
01:42:21.594 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 (3802351:atomicity.py:144)
01:42:21.595 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
01:42:21.601 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
01:42:25.454 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:42:25.459 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
01:42:25.460 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
01:42:25.463 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
01:42:25.464 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
01:42:25.473 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
01:42:25.480 [I] [process=0][thread=MainThread][step=200] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
01:42:25.486 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
01:42:25.487 [I] {'step': 200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742794941.5850608, 'wait_for_prev_duration_secs': 0.0007772445678710938, 'checkpointer_blocking_start_time': 1742794941.5865645, 'checkpointer_blocking_duration_secs': 3.877903938293457, 'get_old_steps_start_time': 1742794945.4645255, 'get_old_steps_duration_secs': 0.009168148040771484, 'checkpoint_manager_blocking_start_time': 1742794941.5848494, 'checkpoint_manager_blocking_duration_secs': 3.902646780014038} (3802351:standard_logger.py:34)
01:42:25.495 [I] Progress on: 201it/2.00kit rate:10.0s/it remaining:4:59:19 elapsed:29:48 postfix:- (3802351:tqdm_logging.py:145)
01:42:32.604 [I] ChainedFuture completed 1/1 futures in 7.14 seconds.                             (3802351:future.py:137)
01:42:32.605 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 941.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:42:32.605 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
01:42:32.606 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3 (3802351:async_checkpointer.py:406)
01:42:32.607 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3/assets.orbax-checkpoint-tmp-4 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3/assets (3802351:atomicity.py:287)
01:42:32.617 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3/params.orbax-checkpoint-tmp-5 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3/params (3802351:atomicity.py:287)
01:42:32.617 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200 (3802351:async_checkpointer.py:416)
01:42:32.618 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3 (3802351:async_checkpointer.py:426)
01:42:32.618 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200.orbax-checkpoint-tmp-3 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200 (3802351:atomicity.py:287)
01:42:32.619 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/200`. (3802351:atomicity.py:548)
01:42:32.620 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
01:42:32.620 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
01:42:32.620 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
01:42:32.621 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
01:42:32.621 [I] [process=0][thread=save_finalize][step=200] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 201: grad_norm=14.251456260681152, loss=2.026679754257202, param_norm=1887.0067138671875
Step 202: grad_norm=6.7964019775390625, loss=2.017251491546631, param_norm=1887.007080078125
01:42:42.891 [I] Progress on: 202it/2.00kit rate:9.6s/it remaining:4:48:38 elapsed:30:05 postfix:- (3802351:tqdm_logging.py:145)
Step 203: grad_norm=6.908909797668457, loss=1.7334816455841064, param_norm=1887.0074462890625
Step 204: grad_norm=7.82207727432251, loss=1.764762282371521, param_norm=1887.0078125
01:43:00.472 [I] Progress on: 204it/2.00kit rate:9.2s/it remaining:4:35:32 elapsed:30:23 postfix:- (3802351:tqdm_logging.py:145)
Step 205: grad_norm=12.580183982849121, loss=1.7908079624176025, param_norm=1887.0081787109375
Step 206: grad_norm=11.915386199951172, loss=1.879415512084961, param_norm=1887.0084228515625
01:43:18.025 [I] Progress on: 206it/2.00kit rate:9.0s/it remaining:4:28:43 elapsed:30:41 postfix:- (3802351:tqdm_logging.py:145)
Step 207: grad_norm=4.677639484405518, loss=1.3890717029571533, param_norm=1887.0089111328125
01:43:29.019 [I] Progress on: 207it/2.00kit rate:9.6s/it remaining:4:46:39 elapsed:30:52 postfix:- (3802351:tqdm_logging.py:145)
Step 208: grad_norm=12.233309745788574, loss=1.5220322608947754, param_norm=1887.00927734375
Step 209: grad_norm=21.39891815185547, loss=1.8759924173355103, param_norm=1887.0096435546875
01:43:46.588 [I] Progress on: 209it/2.00kit rate:9.2s/it remaining:4:33:48 elapsed:31:09 postfix:- (3802351:tqdm_logging.py:145)
Step 210: grad_norm=8.01926040649414, loss=1.816412329673767, param_norm=1887.010009765625
Step 211: grad_norm=10.802447319030762, loss=1.8479039669036865, param_norm=1887.010498046875
01:44:04.165 [I] Progress on: 211it/2.00kit rate:9.0s/it remaining:4:27:28 elapsed:31:27 postfix:- (3802351:tqdm_logging.py:145)
Step 212: grad_norm=9.305306434631348, loss=1.6456971168518066, param_norm=1887.0108642578125
Step 213: grad_norm=15.165801048278809, loss=1.4464174509048462, param_norm=1887.01123046875
01:44:21.787 [I] Progress on: 213it/2.00kit rate:8.9s/it remaining:4:24:33 elapsed:31:44 postfix:- (3802351:tqdm_logging.py:145)
Step 214: grad_norm=16.631866455078125, loss=1.5421147346496582, param_norm=1887.0115966796875
Step 215: grad_norm=13.904316902160645, loss=1.7438294887542725, param_norm=1887.0120849609375
01:44:39.361 [I] Progress on: 215it/2.00kit rate:8.8s/it remaining:4:22:42 elapsed:32:02 postfix:- (3802351:tqdm_logging.py:145)
Step 216: grad_norm=7.3429718017578125, loss=1.5387628078460693, param_norm=1887.0123291015625
Step 217: grad_norm=9.72610092163086, loss=1.6510093212127686, param_norm=1887.0128173828125
01:44:56.967 [I] Progress on: 217it/2.00kit rate:8.8s/it remaining:4:21:51 elapsed:32:20 postfix:- (3802351:tqdm_logging.py:145)
Step 218: grad_norm=13.4523344039917, loss=1.5992236137390137, param_norm=1887.01318359375
Step 219: grad_norm=11.679791450500488, loss=1.6945104598999023, param_norm=1887.0135498046875
01:45:14.589 [I] Progress on: 219it/2.00kit rate:8.8s/it remaining:4:21:21 elapsed:32:37 postfix:- (3802351:tqdm_logging.py:145)
Step 220: grad_norm=12.576187133789062, loss=1.7531042098999023, param_norm=1887.013916015625
Step 221: grad_norm=11.534270286560059, loss=1.6779893636703491, param_norm=1887.014404296875
01:45:32.222 [I] Progress on: 221it/2.00kit rate:8.8s/it remaining:4:21:04 elapsed:32:55 postfix:- (3802351:tqdm_logging.py:145)
Step 222: grad_norm=9.394628524780273, loss=1.9237444400787354, param_norm=1887.0146484375
Step 223: grad_norm=10.521175384521484, loss=1.5334148406982422, param_norm=1887.0150146484375
01:45:49.846 [I] Progress on: 223it/2.00kit rate:8.8s/it remaining:4:20:44 elapsed:33:12 postfix:- (3802351:tqdm_logging.py:145)
Step 224: grad_norm=9.663106918334961, loss=1.4139020442962646, param_norm=1887.015380859375
Step 225: grad_norm=12.6834716796875, loss=1.777705192565918, param_norm=1887.0157470703125
01:46:07.433 [I] Progress on: 225it/2.00kit rate:8.8s/it remaining:4:20:07 elapsed:33:30 postfix:- (3802351:tqdm_logging.py:145)
Step 226: grad_norm=5.76125431060791, loss=1.4437637329101562, param_norm=1887.01611328125
Step 227: grad_norm=6.6493659019470215, loss=1.7595014572143555, param_norm=1887.0164794921875
01:46:25.012 [I] Progress on: 227it/2.00kit rate:8.8s/it remaining:4:19:41 elapsed:33:48 postfix:- (3802351:tqdm_logging.py:145)
Step 228: grad_norm=5.814072608947754, loss=1.6828217506408691, param_norm=1887.016845703125
Step 229: grad_norm=8.487072944641113, loss=1.672926902770996, param_norm=1887.0172119140625
01:46:42.595 [I] Progress on: 229it/2.00kit rate:8.8s/it remaining:4:19:16 elapsed:34:05 postfix:- (3802351:tqdm_logging.py:145)
Step 230: grad_norm=17.135833740234375, loss=1.773290753364563, param_norm=1887.0174560546875
Step 231: grad_norm=11.490527153015137, loss=1.6868603229522705, param_norm=1887.017822265625
01:47:00.187 [I] Progress on: 231it/2.00kit rate:8.8s/it remaining:4:19:00 elapsed:34:23 postfix:- (3802351:tqdm_logging.py:145)
Step 232: grad_norm=7.601354122161865, loss=1.7865498065948486, param_norm=1887.018310546875
Step 233: grad_norm=8.366034507751465, loss=1.6484735012054443, param_norm=1887.0186767578125
01:47:17.768 [I] Progress on: 233it/2.00kit rate:8.8s/it remaining:4:18:36 elapsed:34:40 postfix:- (3802351:tqdm_logging.py:145)
Step 234: grad_norm=16.464733123779297, loss=1.732143521308899, param_norm=1887.01904296875
Step 235: grad_norm=16.06275749206543, loss=1.7978761196136475, param_norm=1887.0194091796875
01:47:35.403 [I] Progress on: 235it/2.00kit rate:8.8s/it remaining:4:18:43 elapsed:34:58 postfix:- (3802351:tqdm_logging.py:145)
Step 236: grad_norm=8.053653717041016, loss=1.742915153503418, param_norm=1887.019775390625
Step 237: grad_norm=4.981977939605713, loss=1.4803733825683594, param_norm=1887.02001953125
01:47:53.110 [I] Progress on: 237it/2.00kit rate:8.8s/it remaining:4:18:59 elapsed:35:16 postfix:- (3802351:tqdm_logging.py:145)
Step 238: grad_norm=9.55337142944336, loss=1.6875669956207275, param_norm=1887.0205078125
Step 239: grad_norm=7.871782302856445, loss=1.6196534633636475, param_norm=1887.020751953125
01:48:10.706 [I] Progress on: 239it/2.00kit rate:8.8s/it remaining:4:18:17 elapsed:35:33 postfix:- (3802351:tqdm_logging.py:145)
Step 240: grad_norm=5.96474552154541, loss=1.7200512886047363, param_norm=1887.0211181640625
Step 241: grad_norm=11.291248321533203, loss=1.878214955329895, param_norm=1887.021484375
01:48:28.373 [I] Progress on: 241it/2.00kit rate:8.8s/it remaining:4:18:17 elapsed:35:51 postfix:- (3802351:tqdm_logging.py:145)
Step 242: grad_norm=11.973214149475098, loss=1.5955945253372192, param_norm=1887.02197265625
Step 243: grad_norm=5.407522678375244, loss=1.7440767288208008, param_norm=1887.022216796875
01:48:45.966 [I] Progress on: 243it/2.00kit rate:8.8s/it remaining:4:17:38 elapsed:36:09 postfix:- (3802351:tqdm_logging.py:145)
Step 244: grad_norm=6.51963472366333, loss=1.5008991956710815, param_norm=1887.0225830078125
Step 245: grad_norm=6.100858211517334, loss=1.546062707901001, param_norm=1887.0230712890625
01:49:03.590 [I] Progress on: 245it/2.00kit rate:8.8s/it remaining:4:17:26 elapsed:36:26 postfix:- (3802351:tqdm_logging.py:145)
Step 246: grad_norm=11.522216796875, loss=1.6123230457305908, param_norm=1887.0234375
Step 247: grad_norm=6.415776252746582, loss=1.764560341835022, param_norm=1887.0238037109375
01:49:21.196 [I] Progress on: 247it/2.00kit rate:8.8s/it remaining:4:17:01 elapsed:36:44 postfix:- (3802351:tqdm_logging.py:145)
Step 248: grad_norm=10.764968872070312, loss=1.9019980430603027, param_norm=1887.0240478515625
Step 249: grad_norm=5.9033637046813965, loss=1.4316918849945068, param_norm=1887.0244140625
01:49:38.798 [I] Progress on: 249it/2.00kit rate:8.8s/it remaining:4:16:39 elapsed:37:01 postfix:- (3802351:tqdm_logging.py:145)
Step 250: grad_norm=6.783792495727539, loss=1.4191559553146362, param_norm=1887.0247802734375
Step 251: grad_norm=6.4770426750183105, loss=1.7044179439544678, param_norm=1887.025146484375
01:49:56.401 [I] Progress on: 251it/2.00kit rate:8.8s/it remaining:4:16:16 elapsed:37:19 postfix:- (3802351:tqdm_logging.py:145)
Step 252: grad_norm=5.017189979553223, loss=1.5393519401550293, param_norm=1887.025634765625
Step 253: grad_norm=5.302606582641602, loss=1.348961353302002, param_norm=1887.0260009765625
01:50:14.053 [I] Progress on: 253it/2.00kit rate:8.8s/it remaining:4:16:13 elapsed:37:37 postfix:- (3802351:tqdm_logging.py:145)
Step 254: grad_norm=10.10020637512207, loss=1.6401207447052002, param_norm=1887.0264892578125
Step 255: grad_norm=6.4066996574401855, loss=1.4855198860168457, param_norm=1887.0269775390625
01:50:31.687 [I] Progress on: 255it/2.00kit rate:8.8s/it remaining:4:16:08 elapsed:37:54 postfix:- (3802351:tqdm_logging.py:145)
Step 256: grad_norm=10.589737892150879, loss=1.6100783348083496, param_norm=1887.0274658203125
Step 257: grad_norm=7.376115798950195, loss=1.6660187244415283, param_norm=1887.0279541015625
01:50:49.361 [I] Progress on: 257it/2.00kit rate:8.8s/it remaining:4:16:00 elapsed:38:12 postfix:- (3802351:tqdm_logging.py:145)
Step 258: grad_norm=7.5493035316467285, loss=1.7344744205474854, param_norm=1887.0281982421875
Step 259: grad_norm=47.41976547241211, loss=1.8509888648986816, param_norm=1887.0286865234375
01:51:07.010 [I] Progress on: 259it/2.00kit rate:8.8s/it remaining:4:15:48 elapsed:38:30 postfix:- (3802351:tqdm_logging.py:145)
Step 260: grad_norm=7.7202043533325195, loss=1.8016409873962402, param_norm=1887.029052734375
Step 261: grad_norm=5.8770012855529785, loss=1.6281487941741943, param_norm=1887.0294189453125
01:51:24.606 [I] Progress on: 261it/2.00kit rate:8.8s/it remaining:4:15:00 elapsed:38:47 postfix:- (3802351:tqdm_logging.py:145)
Step 262: grad_norm=5.658360004425049, loss=1.6463203430175781, param_norm=1887.02978515625
Step 263: grad_norm=6.454345703125, loss=1.5324780941009521, param_norm=1887.030029296875
01:51:42.225 [I] Progress on: 263it/2.00kit rate:8.8s/it remaining:4:14:48 elapsed:39:05 postfix:- (3802351:tqdm_logging.py:145)
Step 264: grad_norm=16.609743118286133, loss=1.7367149591445923, param_norm=1887.0303955078125
Step 265: grad_norm=6.539350509643555, loss=1.9575369358062744, param_norm=1887.0306396484375
01:52:00.000 [I] Progress on: 265it/2.00kit rate:8.8s/it remaining:4:14:34 elapsed:39:23 postfix:- (3802351:tqdm_logging.py:145)
Step 266: grad_norm=6.076819896697998, loss=1.5976693630218506, param_norm=1887.0308837890625
Step 267: grad_norm=10.286652565002441, loss=1.8208867311477661, param_norm=1887.03125
01:52:17.683 [I] Progress on: 267it/2.00kit rate:8.8s/it remaining:4:15:30 elapsed:39:40 postfix:- (3802351:tqdm_logging.py:145)
Step 268: grad_norm=6.9849443435668945, loss=1.7399247884750366, param_norm=1887.0316162109375
Step 269: grad_norm=7.136366844177246, loss=1.6882636547088623, param_norm=1887.031982421875
01:52:35.337 [I] Progress on: 269it/2.00kit rate:8.8s/it remaining:4:14:43 elapsed:39:58 postfix:- (3802351:tqdm_logging.py:145)
Step 270: grad_norm=7.890730381011963, loss=1.6881413459777832, param_norm=1887.032470703125
Step 271: grad_norm=62.807159423828125, loss=1.7948918342590332, param_norm=1887.0328369140625
01:52:52.939 [I] Progress on: 271it/2.00kit rate:8.8s/it remaining:4:13:50 elapsed:40:16 postfix:- (3802351:tqdm_logging.py:145)
Step 272: grad_norm=12.846720695495605, loss=1.7655489444732666, param_norm=1887.0330810546875
Step 273: grad_norm=5.079626083374023, loss=1.6069495677947998, param_norm=1887.033447265625
01:53:10.602 [I] Progress on: 273it/2.00kit rate:8.8s/it remaining:4:13:40 elapsed:40:33 postfix:- (3802351:tqdm_logging.py:145)
Step 274: grad_norm=11.830719947814941, loss=1.804157018661499, param_norm=1887.03369140625
Step 275: grad_norm=10.271886825561523, loss=1.6663031578063965, param_norm=1887.0340576171875
01:53:28.224 [I] Progress on: 275it/2.00kit rate:8.8s/it remaining:4:13:12 elapsed:40:51 postfix:- (3802351:tqdm_logging.py:145)
Step 276: grad_norm=5.097529411315918, loss=1.232401967048645, param_norm=1887.034423828125
01:53:39.436 [I] Progress on: 276it/2.00kit rate:9.5s/it remaining:4:33:58 elapsed:41:02 postfix:- (3802351:tqdm_logging.py:145)
Step 277: grad_norm=5.112827777862549, loss=1.44502592086792, param_norm=1887.03466796875
Step 278: grad_norm=5.84666109085083, loss=1.3543612957000732, param_norm=1887.034912109375
01:53:57.011 [I] Progress on: 278it/2.00kit rate:9.2s/it remaining:4:22:50 elapsed:41:20 postfix:- (3802351:tqdm_logging.py:145)
Step 279: grad_norm=9.782673835754395, loss=1.3361282348632812, param_norm=1887.0352783203125
Step 280: grad_norm=6.273258686065674, loss=1.3407275676727295, param_norm=1887.03564453125
01:54:14.664 [I] Progress on: 280it/2.00kit rate:9.0s/it remaining:4:17:51 elapsed:41:37 postfix:- (3802351:tqdm_logging.py:145)
Step 281: grad_norm=5.353900909423828, loss=1.3699170351028442, param_norm=1887.0360107421875
Step 282: grad_norm=5.650818824768066, loss=1.3279731273651123, param_norm=1887.036376953125
01:54:32.287 [I] Progress on: 282it/2.00kit rate:8.9s/it remaining:4:14:55 elapsed:41:55 postfix:- (3802351:tqdm_logging.py:145)
Step 283: grad_norm=10.129683494567871, loss=1.4721554517745972, param_norm=1887.0367431640625
Step 284: grad_norm=11.206949234008789, loss=1.4269170761108398, param_norm=1887.0369873046875
01:54:49.916 [I] Progress on: 284it/2.00kit rate:8.9s/it remaining:4:13:30 elapsed:42:12 postfix:- (3802351:tqdm_logging.py:145)
Step 285: grad_norm=8.469043731689453, loss=1.3274484872817993, param_norm=1887.0374755859375
Step 286: grad_norm=7.978769302368164, loss=1.3008179664611816, param_norm=1887.0377197265625
01:55:07.531 [I] Progress on: 286it/2.00kit rate:8.8s/it remaining:4:12:28 elapsed:42:30 postfix:- (3802351:tqdm_logging.py:145)
Step 287: grad_norm=7.57824182510376, loss=1.4117789268493652, param_norm=1887.0382080078125
Step 288: grad_norm=5.164364814758301, loss=1.4153103828430176, param_norm=1887.03857421875
01:55:25.173 [I] Progress on: 288it/2.00kit rate:8.8s/it remaining:4:12:11 elapsed:42:48 postfix:- (3802351:tqdm_logging.py:145)
Step 289: grad_norm=6.606584548950195, loss=1.488433837890625, param_norm=1887.0389404296875
Step 290: grad_norm=7.022618770599365, loss=1.6115081310272217, param_norm=1887.039306640625
01:55:42.756 [I] Progress on: 290it/2.00kit rate:8.8s/it remaining:4:11:20 elapsed:43:05 postfix:- (3802351:tqdm_logging.py:145)
Step 291: grad_norm=8.721344947814941, loss=1.519242525100708, param_norm=1887.0396728515625
Step 292: grad_norm=13.220767974853516, loss=1.469203233718872, param_norm=1887.0400390625
01:56:00.390 [I] Progress on: 292it/2.00kit rate:8.8s/it remaining:4:11:09 elapsed:43:23 postfix:- (3802351:tqdm_logging.py:145)
Step 293: grad_norm=11.10818099975586, loss=1.4077950716018677, param_norm=1887.0404052734375
Step 294: grad_norm=6.6847710609436035, loss=1.2019420862197876, param_norm=1887.0406494140625
01:56:17.956 [I] Progress on: 294it/2.00kit rate:8.8s/it remaining:4:10:26 elapsed:43:41 postfix:- (3802351:tqdm_logging.py:145)
Step 295: grad_norm=9.197200775146484, loss=1.4523521661758423, param_norm=1887.0411376953125
Step 296: grad_norm=12.383391380310059, loss=1.2621545791625977, param_norm=1887.04150390625
01:56:35.615 [I] Progress on: 296it/2.00kit rate:8.8s/it remaining:4:10:34 elapsed:43:58 postfix:- (3802351:tqdm_logging.py:145)
Step 297: grad_norm=7.795392036437988, loss=1.3821933269500732, param_norm=1887.041748046875
Step 298: grad_norm=15.373557090759277, loss=1.5414998531341553, param_norm=1887.0421142578125
01:56:53.194 [I] Progress on: 298it/2.00kit rate:8.8s/it remaining:4:09:57 elapsed:44:16 postfix:- (3802351:tqdm_logging.py:145)
Step 299: grad_norm=15.359016418457031, loss=1.4226542711257935, param_norm=1887.04248046875
Step 300: grad_norm=9.871426582336426, loss=1.2631815671920776, param_norm=1887.0428466796875
01:57:10.813 [I] Progress on: 300it/2.00kit rate:8.8s/it remaining:4:09:40 elapsed:44:33 postfix:- (3802351:tqdm_logging.py:145)
01:57:10.965 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
01:57:10.966 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
01:57:10.966 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=200. (3802351:checkpoint_manager.py:1786)
01:57:10.966 [I] [process=0][thread=MainThread][step=200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=200, also errors if any. (3802351:checkpoint_manager.py:1817)
01:57:10.966 [I] [process=0] Saving checkpoint at step 300                                        (3802351:checkpoint_manager.py:1286)
01:57:10.967 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300. (3802351:async_checkpointer.py:358)
01:57:10.969 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
01:57:10.969 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6 (3802351:atomicity.py:144)
01:57:10.970 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
01:57:10.970 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
01:57:10.972 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 (3802351:atomicity.py:144)
01:57:10.973 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 (3802351:atomicity.py:144)
01:57:10.974 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
01:57:10.979 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
01:57:14.644 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:57:14.652 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
01:57:14.653 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
01:57:14.653 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
01:57:14.672 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
01:57:14.673 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
01:57:14.681 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
01:57:14.682 [I] [process=0][thread=MainThread][step=300] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
01:57:14.685 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
01:57:14.685 [I] {'step': 300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742795830.9657638, 'wait_for_prev_duration_secs': 0.0006906986236572266, 'checkpointer_blocking_start_time': 1742795830.9670794, 'checkpointer_blocking_duration_secs': 3.7055909633636475, 'get_old_steps_start_time': 1742795834.672772, 'get_old_steps_duration_secs': 0.008258581161499023, 'checkpoint_manager_blocking_start_time': 1742795830.9655728, 'checkpoint_manager_blocking_duration_secs': 3.7199161052703857} (3802351:standard_logger.py:34)
01:57:21.972 [I] ChainedFuture completed 1/1 futures in 7.30 seconds.                             (3802351:future.py:137)
01:57:21.972 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 942.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
01:57:21.973 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
01:57:21.974 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6 (3802351:async_checkpointer.py:406)
01:57:21.974 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6/assets.orbax-checkpoint-tmp-7 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6/assets (3802351:atomicity.py:287)
01:57:21.985 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6/params.orbax-checkpoint-tmp-8 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6/params (3802351:atomicity.py:287)
01:57:21.986 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300 (3802351:async_checkpointer.py:416)
01:57:21.986 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6 (3802351:async_checkpointer.py:426)
01:57:21.986 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300.orbax-checkpoint-tmp-6 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300 (3802351:atomicity.py:287)
01:57:21.988 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/300`. (3802351:atomicity.py:548)
01:57:21.988 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
01:57:21.989 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
01:57:21.989 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
01:57:21.990 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
01:57:21.990 [I] [process=0][thread=save_finalize][step=300] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 301: grad_norm=6.590255260467529, loss=1.1543502807617188, param_norm=1887.043212890625
01:57:23.302 [I] Progress on: 301it/2.00kit rate:9.9s/it remaining:4:40:55 elapsed:44:46 postfix:- (3802351:tqdm_logging.py:145)
Step 302: grad_norm=6.664305210113525, loss=1.2827301025390625, param_norm=1887.0435791015625
Step 303: grad_norm=12.91219425201416, loss=1.3579585552215576, param_norm=1887.0438232421875
01:57:40.872 [I] Progress on: 303it/2.00kit rate:9.3s/it remaining:4:24:00 elapsed:45:03 postfix:- (3802351:tqdm_logging.py:145)
Step 304: grad_norm=8.22445297241211, loss=1.5102874040603638, param_norm=1887.044189453125
Step 305: grad_norm=13.108834266662598, loss=1.47605562210083, param_norm=1887.04443359375
01:57:58.452 [I] Progress on: 305it/2.00kit rate:9.0s/it remaining:4:15:39 elapsed:45:21 postfix:- (3802351:tqdm_logging.py:145)
Step 306: grad_norm=6.194434642791748, loss=1.5010415315628052, param_norm=1887.0447998046875
Step 307: grad_norm=8.949400901794434, loss=1.2027721405029297, param_norm=1887.045166015625
01:58:16.077 [I] Progress on: 307it/2.00kit rate:8.9s/it remaining:4:11:48 elapsed:45:39 postfix:- (3802351:tqdm_logging.py:145)
Step 308: grad_norm=6.939329147338867, loss=1.4641621112823486, param_norm=1887.0455322265625
Step 309: grad_norm=8.315652847290039, loss=1.3439544439315796, param_norm=1887.0457763671875
01:58:33.747 [I] Progress on: 309it/2.00kit rate:8.9s/it remaining:4:10:06 elapsed:45:56 postfix:- (3802351:tqdm_logging.py:145)
Step 310: grad_norm=5.883145809173584, loss=1.417757511138916, param_norm=1887.0462646484375
Step 311: grad_norm=12.038717269897461, loss=1.6476285457611084, param_norm=1887.0465087890625
01:58:51.357 [I] Progress on: 311it/2.00kit rate:8.8s/it remaining:4:08:35 elapsed:46:14 postfix:- (3802351:tqdm_logging.py:145)
Step 312: grad_norm=9.96221923828125, loss=1.5668184757232666, param_norm=1887.0469970703125
Step 313: grad_norm=18.20657730102539, loss=1.5312471389770508, param_norm=1887.0472412109375
01:59:08.914 [I] Progress on: 313it/2.00kit rate:8.8s/it remaining:4:07:19 elapsed:46:31 postfix:- (3802351:tqdm_logging.py:145)
Step 314: grad_norm=13.056476593017578, loss=1.5133605003356934, param_norm=1887.047607421875
Step 315: grad_norm=11.306930541992188, loss=1.5493123531341553, param_norm=1887.0478515625
01:59:26.541 [I] Progress on: 315it/2.00kit rate:8.8s/it remaining:4:07:12 elapsed:46:49 postfix:- (3802351:tqdm_logging.py:145)
Step 316: grad_norm=7.732313632965088, loss=1.3453171253204346, param_norm=1887.048095703125
Step 317: grad_norm=6.4973249435424805, loss=1.5400539636611938, param_norm=1887.04833984375
01:59:44.146 [I] Progress on: 317it/2.00kit rate:8.8s/it remaining:4:06:48 elapsed:47:07 postfix:- (3802351:tqdm_logging.py:145)
Step 318: grad_norm=5.490950584411621, loss=1.436760425567627, param_norm=1887.0487060546875
Step 319: grad_norm=10.369734764099121, loss=1.4606945514678955, param_norm=1887.0489501953125
02:00:01.733 [I] Progress on: 319it/2.00kit rate:8.8s/it remaining:4:06:19 elapsed:47:24 postfix:- (3802351:tqdm_logging.py:145)
Step 320: grad_norm=10.67271614074707, loss=1.7078123092651367, param_norm=1887.0491943359375
Step 321: grad_norm=9.264163970947266, loss=1.3020423650741577, param_norm=1887.0494384765625
02:00:19.399 [I] Progress on: 321it/2.00kit rate:8.8s/it remaining:4:06:23 elapsed:47:42 postfix:- (3802351:tqdm_logging.py:145)
Step 322: grad_norm=7.312746047973633, loss=1.4348337650299072, param_norm=1887.0496826171875
Step 323: grad_norm=7.018050670623779, loss=1.5490056276321411, param_norm=1887.0499267578125
02:00:36.975 [I] Progress on: 323it/2.00kit rate:8.8s/it remaining:4:05:49 elapsed:48:00 postfix:- (3802351:tqdm_logging.py:145)
Step 324: grad_norm=9.99013614654541, loss=1.3926233053207397, param_norm=1887.0501708984375
Step 325: grad_norm=10.606314659118652, loss=1.313441514968872, param_norm=1887.0504150390625
02:00:54.536 [I] Progress on: 325it/2.00kit rate:8.8s/it remaining:4:05:12 elapsed:48:17 postfix:- (3802351:tqdm_logging.py:145)
Step 326: grad_norm=7.54617977142334, loss=1.2920606136322021, param_norm=1887.05078125
Step 327: grad_norm=12.486608505249023, loss=1.206486701965332, param_norm=1887.051025390625
02:01:12.086 [I] Progress on: 327it/2.00kit rate:8.8s/it remaining:4:04:37 elapsed:48:35 postfix:- (3802351:tqdm_logging.py:145)
Step 328: grad_norm=7.200491428375244, loss=1.4914978742599487, param_norm=1887.0513916015625
Step 329: grad_norm=14.089341163635254, loss=1.2779775857925415, param_norm=1887.0516357421875
02:01:29.688 [I] Progress on: 329it/2.00kit rate:8.8s/it remaining:4:04:34 elapsed:48:52 postfix:- (3802351:tqdm_logging.py:145)
Step 330: grad_norm=11.979195594787598, loss=1.365302324295044, param_norm=1887.0518798828125
Step 331: grad_norm=11.194411277770996, loss=1.4461036920547485, param_norm=1887.05224609375
02:01:47.310 [I] Progress on: 331it/2.00kit rate:8.8s/it remaining:4:04:30 elapsed:49:10 postfix:- (3802351:tqdm_logging.py:145)
Step 332: grad_norm=11.11163330078125, loss=1.4555838108062744, param_norm=1887.052490234375
Step 333: grad_norm=7.319207668304443, loss=1.4942727088928223, param_norm=1887.052734375
02:02:04.955 [I] Progress on: 333it/2.00kit rate:8.8s/it remaining:4:04:31 elapsed:49:28 postfix:- (3802351:tqdm_logging.py:145)
Step 334: grad_norm=11.20936393737793, loss=1.3114991188049316, param_norm=1887.0531005859375
Step 335: grad_norm=13.432029724121094, loss=1.4637200832366943, param_norm=1887.05322265625
02:02:22.627 [I] Progress on: 335it/2.00kit rate:8.8s/it remaining:4:04:35 elapsed:49:45 postfix:- (3802351:tqdm_logging.py:145)
Step 336: grad_norm=11.21684741973877, loss=1.331417441368103, param_norm=1887.0535888671875
Step 337: grad_norm=7.170559406280518, loss=1.266750693321228, param_norm=1887.053955078125
02:02:40.230 [I] Progress on: 337it/2.00kit rate:8.8s/it remaining:4:03:59 elapsed:50:03 postfix:- (3802351:tqdm_logging.py:145)
Step 338: grad_norm=8.502060890197754, loss=1.4454853534698486, param_norm=1887.05419921875
Step 339: grad_norm=10.279332160949707, loss=1.284590244293213, param_norm=1887.0545654296875
02:02:57.858 [I] Progress on: 339it/2.00kit rate:8.8s/it remaining:4:03:40 elapsed:50:20 postfix:- (3802351:tqdm_logging.py:145)
Step 340: grad_norm=8.792335510253906, loss=1.2376134395599365, param_norm=1887.054931640625
Step 341: grad_norm=19.58333969116211, loss=1.5206654071807861, param_norm=1887.05517578125
02:03:15.503 [I] Progress on: 341it/2.00kit rate:8.8s/it remaining:4:03:26 elapsed:50:38 postfix:- (3802351:tqdm_logging.py:145)
Step 342: grad_norm=5.544361591339111, loss=1.199246883392334, param_norm=1887.0555419921875
Step 343: grad_norm=8.334378242492676, loss=1.4668580293655396, param_norm=1887.0557861328125
02:03:33.120 [I] Progress on: 343it/2.00kit rate:8.8s/it remaining:4:03:07 elapsed:50:56 postfix:- (3802351:tqdm_logging.py:145)
Step 344: grad_norm=5.424715995788574, loss=1.502687692642212, param_norm=1887.0560302734375
02:03:44.614 [I] Progress on: 345it/2.00kit rate:9.6s/it remaining:4:23:34 elapsed:51:07 postfix:- (3802351:tqdm_logging.py:145)
Step 345: grad_norm=7.3195013999938965, loss=1.2474302053451538, param_norm=1887.0562744140625
Step 346: grad_norm=5.2327775955200195, loss=1.1962308883666992, param_norm=1887.0565185546875
02:04:01.988 [I] Progress on: 346it/2.00kit rate:9.3s/it remaining:4:17:00 elapsed:51:25 postfix:- (3802351:tqdm_logging.py:145)
Step 347: grad_norm=11.006037712097168, loss=1.2111515998840332, param_norm=1887.056884765625
Step 348: grad_norm=15.38974380493164, loss=1.101820945739746, param_norm=1887.05712890625
02:04:19.582 [I] Progress on: 348it/2.00kit rate:9.1s/it remaining:4:09:19 elapsed:51:42 postfix:- (3802351:tqdm_logging.py:145)
Step 349: grad_norm=5.762118339538574, loss=1.2110058069229126, param_norm=1887.0574951171875
Step 350: grad_norm=9.384092330932617, loss=1.2093614339828491, param_norm=1887.057861328125
02:04:37.171 [I] Progress on: 350it/2.00kit rate:8.9s/it remaining:4:05:19 elapsed:52:00 postfix:- (3802351:tqdm_logging.py:145)
Step 351: grad_norm=10.058869361877441, loss=1.3173457384109497, param_norm=1887.05810546875
Step 352: grad_norm=6.795180320739746, loss=1.2362008094787598, param_norm=1887.05859375
02:04:54.793 [I] Progress on: 352it/2.00kit rate:8.9s/it remaining:4:03:26 elapsed:52:17 postfix:- (3802351:tqdm_logging.py:145)
Step 353: grad_norm=7.2880940437316895, loss=1.2772464752197266, param_norm=1887.058837890625
Step 354: grad_norm=7.29193639755249, loss=1.3204045295715332, param_norm=1887.0592041015625
02:05:12.372 [I] Progress on: 354it/2.00kit rate:8.8s/it remaining:4:02:08 elapsed:52:35 postfix:- (3802351:tqdm_logging.py:145)
Step 355: grad_norm=7.556447982788086, loss=1.0854566097259521, param_norm=1887.0594482421875
Step 356: grad_norm=11.692322731018066, loss=1.2765028476715088, param_norm=1887.0596923828125
02:05:29.986 [I] Progress on: 356it/2.00kit rate:8.8s/it remaining:4:01:30 elapsed:52:53 postfix:- (3802351:tqdm_logging.py:145)
Step 357: grad_norm=4.899056434631348, loss=1.0759036540985107, param_norm=1887.06005859375
Step 358: grad_norm=4.959926128387451, loss=0.9017030000686646, param_norm=1887.0604248046875
02:05:47.715 [I] Progress on: 358it/2.00kit rate:8.8s/it remaining:4:01:50 elapsed:53:10 postfix:- (3802351:tqdm_logging.py:145)
Step 359: grad_norm=6.643158912658691, loss=1.2368850708007812, param_norm=1887.060791015625
Step 360: grad_norm=6.407670021057129, loss=1.2588361501693726, param_norm=1887.06103515625
02:06:05.351 [I] Progress on: 360it/2.00kit rate:8.8s/it remaining:4:01:17 elapsed:53:28 postfix:- (3802351:tqdm_logging.py:145)
Step 361: grad_norm=10.371456146240234, loss=1.2370187044143677, param_norm=1887.061279296875
Step 362: grad_norm=6.858663558959961, loss=1.1146082878112793, param_norm=1887.0616455078125
02:06:22.948 [I] Progress on: 362it/2.00kit rate:8.8s/it remaining:4:00:40 elapsed:53:46 postfix:- (3802351:tqdm_logging.py:145)
Step 363: grad_norm=6.4141669273376465, loss=1.2663660049438477, param_norm=1887.0618896484375
Step 364: grad_norm=8.465863227844238, loss=1.1615691184997559, param_norm=1887.062255859375
02:06:40.552 [I] Progress on: 364it/2.00kit rate:8.8s/it remaining:4:00:04 elapsed:54:03 postfix:- (3802351:tqdm_logging.py:145)
Step 365: grad_norm=7.371128082275391, loss=1.3390201330184937, param_norm=1887.0625
Step 366: grad_norm=11.365754127502441, loss=1.0743753910064697, param_norm=1887.062744140625
02:06:58.163 [I] Progress on: 366it/2.00kit rate:8.8s/it remaining:3:59:41 elapsed:54:21 postfix:- (3802351:tqdm_logging.py:145)
Step 367: grad_norm=6.587921142578125, loss=1.133524775505066, param_norm=1887.063232421875
Step 368: grad_norm=9.577555656433105, loss=0.8162115812301636, param_norm=1887.0633544921875
02:07:15.763 [I] Progress on: 368it/2.00kit rate:8.8s/it remaining:3:59:22 elapsed:54:38 postfix:- (3802351:tqdm_logging.py:145)
Step 369: grad_norm=7.377799034118652, loss=1.2285354137420654, param_norm=1887.0638427734375
Step 370: grad_norm=14.27627944946289, loss=1.178819179534912, param_norm=1887.06396484375
02:07:33.336 [I] Progress on: 370it/2.00kit rate:8.8s/it remaining:3:58:54 elapsed:54:56 postfix:- (3802351:tqdm_logging.py:145)
Step 371: grad_norm=7.082291603088379, loss=1.103606939315796, param_norm=1887.0643310546875
Step 372: grad_norm=7.296624660491943, loss=1.2628355026245117, param_norm=1887.0645751953125
02:07:50.924 [I] Progress on: 372it/2.00kit rate:8.8s/it remaining:3:58:40 elapsed:55:13 postfix:- (3802351:tqdm_logging.py:145)
Step 373: grad_norm=4.80850076675415, loss=0.9928053617477417, param_norm=1887.06494140625
Step 374: grad_norm=9.029040336608887, loss=1.1526069641113281, param_norm=1887.065185546875
02:08:08.521 [I] Progress on: 374it/2.00kit rate:8.8s/it remaining:3:58:21 elapsed:55:31 postfix:- (3802351:tqdm_logging.py:145)
Step 375: grad_norm=18.781782150268555, loss=1.1305288076400757, param_norm=1887.0655517578125
Step 376: grad_norm=13.837413787841797, loss=1.3016347885131836, param_norm=1887.0657958984375
02:08:26.150 [I] Progress on: 376it/2.00kit rate:8.8s/it remaining:3:58:21 elapsed:55:49 postfix:- (3802351:tqdm_logging.py:145)
Step 377: grad_norm=5.418364524841309, loss=1.1814110279083252, param_norm=1887.066162109375
Step 378: grad_norm=7.806225299835205, loss=1.2745391130447388, param_norm=1887.06640625
02:08:43.751 [I] Progress on: 378it/2.00kit rate:8.8s/it remaining:3:57:55 elapsed:56:06 postfix:- (3802351:tqdm_logging.py:145)
Step 379: grad_norm=9.687433242797852, loss=1.397918701171875, param_norm=1887.0667724609375
Step 380: grad_norm=9.585673332214355, loss=1.1497241258621216, param_norm=1887.067138671875
02:09:01.326 [I] Progress on: 380it/2.00kit rate:8.8s/it remaining:3:57:30 elapsed:56:24 postfix:- (3802351:tqdm_logging.py:145)
Step 381: grad_norm=10.641267776489258, loss=1.1007084846496582, param_norm=1887.0672607421875
Step 382: grad_norm=9.0614595413208, loss=1.1415114402770996, param_norm=1887.0675048828125
02:09:18.944 [I] Progress on: 382it/2.00kit rate:8.8s/it remaining:3:57:20 elapsed:56:42 postfix:- (3802351:tqdm_logging.py:145)
Step 383: grad_norm=8.051074981689453, loss=1.3466582298278809, param_norm=1887.06787109375
Step 384: grad_norm=9.957524299621582, loss=1.060942530632019, param_norm=1887.068115234375
02:09:36.564 [I] Progress on: 384it/2.00kit rate:8.8s/it remaining:3:57:17 elapsed:56:59 postfix:- (3802351:tqdm_logging.py:145)
Step 385: grad_norm=14.103863716125488, loss=1.1471441984176636, param_norm=1887.068359375
Step 386: grad_norm=9.399927139282227, loss=1.06209397315979, param_norm=1887.068603515625
02:09:54.073 [I] Progress on: 386it/2.00kit rate:8.8s/it remaining:3:56:11 elapsed:57:17 postfix:- (3802351:tqdm_logging.py:145)
Step 387: grad_norm=10.88761043548584, loss=1.512495756149292, param_norm=1887.0689697265625
Step 388: grad_norm=7.563320159912109, loss=1.256415843963623, param_norm=1887.069091796875
02:10:11.708 [I] Progress on: 388it/2.00kit rate:8.8s/it remaining:3:56:24 elapsed:57:34 postfix:- (3802351:tqdm_logging.py:145)
Step 389: grad_norm=12.844226837158203, loss=1.2763997316360474, param_norm=1887.0694580078125
Step 390: grad_norm=12.50564193725586, loss=1.359952688217163, param_norm=1887.069580078125
02:10:29.284 [I] Progress on: 390it/2.00kit rate:8.8s/it remaining:3:55:58 elapsed:57:52 postfix:- (3802351:tqdm_logging.py:145)
Step 391: grad_norm=15.664483070373535, loss=1.0789039134979248, param_norm=1887.06982421875
Step 392: grad_norm=12.0985689163208, loss=1.1734528541564941, param_norm=1887.0701904296875
02:10:46.892 [I] Progress on: 392it/2.00kit rate:8.8s/it remaining:3:55:49 elapsed:58:09 postfix:- (3802351:tqdm_logging.py:145)
Step 393: grad_norm=5.584479808807373, loss=1.0833379030227661, param_norm=1887.0703125
Step 394: grad_norm=7.504265785217285, loss=1.2386188507080078, param_norm=1887.070556640625
02:11:04.539 [I] Progress on: 394it/2.00kit rate:8.8s/it remaining:3:55:52 elapsed:58:27 postfix:- (3802351:tqdm_logging.py:145)
Step 395: grad_norm=15.153149604797363, loss=1.3149863481521606, param_norm=1887.0709228515625
Step 396: grad_norm=15.301031112670898, loss=1.279227614402771, param_norm=1887.071044921875
02:11:22.211 [I] Progress on: 396it/2.00kit rate:8.8s/it remaining:3:55:54 elapsed:58:45 postfix:- (3802351:tqdm_logging.py:145)
Step 397: grad_norm=13.989850044250488, loss=1.2992231845855713, param_norm=1887.0714111328125
Step 398: grad_norm=6.256934642791748, loss=1.0748472213745117, param_norm=1887.0716552734375
02:11:39.798 [I] Progress on: 398it/2.00kit rate:8.8s/it remaining:3:55:19 elapsed:59:02 postfix:- (3802351:tqdm_logging.py:145)
Step 399: grad_norm=7.262077331542969, loss=1.0842632055282593, param_norm=1887.0718994140625
Step 400: grad_norm=8.301215171813965, loss=1.2281180620193481, param_norm=1887.072021484375
02:11:57.435 [I] Progress on: 400it/2.00kit rate:8.8s/it remaining:3:55:05 elapsed:59:20 postfix:- (3802351:tqdm_logging.py:145)
02:11:57.597 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
02:11:57.597 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
02:11:57.597 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=300. (3802351:checkpoint_manager.py:1786)
02:11:57.597 [I] [process=0][thread=MainThread][step=300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=300, also errors if any. (3802351:checkpoint_manager.py:1817)
02:11:57.598 [I] [process=0] Saving checkpoint at step 400                                        (3802351:checkpoint_manager.py:1286)
02:11:57.599 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400. (3802351:async_checkpointer.py:358)
02:11:57.600 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:11:57.601 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9 (3802351:atomicity.py:144)
02:11:57.602 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:11:57.602 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:11:57.603 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 (3802351:atomicity.py:144)
02:11:57.604 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 (3802351:atomicity.py:144)
02:11:57.605 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:11:57.610 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
02:12:01.501 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:12:01.507 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
02:12:01.509 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
02:12:01.515 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
02:12:01.538 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:12:01.540 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:12:01.542 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:12:01.543 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
02:12:01.547 [I] [process=0][thread=MainThread][step=400] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
02:12:01.551 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
02:12:01.553 [I] {'step': 400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742796717.5972757, 'wait_for_prev_duration_secs': 0.0006978511810302734, 'checkpointer_blocking_start_time': 1742796717.5986161, 'checkpointer_blocking_duration_secs': 3.93987774848938, 'get_old_steps_start_time': 1742796721.5385478, 'get_old_steps_duration_secs': 0.005001068115234375, 'checkpoint_manager_blocking_start_time': 1742796717.5970788, 'checkpoint_manager_blocking_duration_secs': 3.95587420463562} (3802351:standard_logger.py:34)
02:12:08.620 [I] ChainedFuture completed 1/1 futures in 7.10 seconds.                             (3802351:future.py:137)
02:12:08.621 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 940.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:12:08.621 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
02:12:08.623 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9 (3802351:async_checkpointer.py:406)
02:12:08.623 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9/assets.orbax-checkpoint-tmp-10 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9/assets (3802351:atomicity.py:287)
02:12:08.633 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9/params.orbax-checkpoint-tmp-11 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9/params (3802351:atomicity.py:287)
02:12:08.634 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400 (3802351:async_checkpointer.py:416)
02:12:08.635 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9 (3802351:async_checkpointer.py:426)
02:12:08.635 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400.orbax-checkpoint-tmp-9 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400 (3802351:atomicity.py:287)
02:12:08.636 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/400`. (3802351:atomicity.py:548)
02:12:08.637 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
02:12:08.637 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
02:12:08.638 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
02:12:08.638 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
02:12:08.638 [I] [process=0][thread=save_finalize][step=400] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 401: grad_norm=6.560458660125732, loss=1.015568494796753, param_norm=1887.072265625
02:12:10.162 [I] Progress on: 401it/2.00kit rate:10.0s/it remaining:4:26:18 elapsed:59:33 postfix:- (3802351:tqdm_logging.py:145)
Step 402: grad_norm=9.649600982666016, loss=1.0959572792053223, param_norm=1887.072509765625
Step 403: grad_norm=12.440576553344727, loss=1.101889967918396, param_norm=1887.07275390625
02:12:27.735 [I] Progress on: 403it/2.00kit rate:9.4s/it remaining:4:09:29 elapsed:59:50 postfix:- (3802351:tqdm_logging.py:145)
Step 404: grad_norm=6.485920429229736, loss=1.0166776180267334, param_norm=1887.0728759765625
Step 405: grad_norm=4.979578971862793, loss=1.2927006483078003, param_norm=1887.0731201171875
02:12:45.297 [I] Progress on: 405it/2.00kit rate:9.1s/it remaining:4:01:11 elapsed:1:00:08 postfix:- (3802351:tqdm_logging.py:145)
Step 406: grad_norm=7.517973899841309, loss=1.0319663286209106, param_norm=1887.0733642578125
Step 407: grad_norm=16.2028865814209, loss=1.0945185422897339, param_norm=1887.073486328125
02:13:02.866 [I] Progress on: 407it/2.00kit rate:8.9s/it remaining:3:56:58 elapsed:1:00:25 postfix:- (3802351:tqdm_logging.py:145)
Step 408: grad_norm=9.59703254699707, loss=1.1326512098312378, param_norm=1887.07373046875
Step 409: grad_norm=8.538182258605957, loss=1.2530591487884521, param_norm=1887.073974609375
02:13:20.443 [I] Progress on: 409it/2.00kit rate:8.9s/it remaining:3:54:47 elapsed:1:00:43 postfix:- (3802351:tqdm_logging.py:145)
Step 410: grad_norm=7.265024662017822, loss=1.1905896663665771, param_norm=1887.07421875
Step 411: grad_norm=6.549090385437012, loss=1.0978376865386963, param_norm=1887.074462890625
02:13:38.027 [I] Progress on: 411it/2.00kit rate:8.8s/it remaining:3:53:38 elapsed:1:01:01 postfix:- (3802351:tqdm_logging.py:145)
Step 412: grad_norm=9.6628999710083, loss=1.3992815017700195, param_norm=1887.07470703125
Step 413: grad_norm=7.507484436035156, loss=1.3361332416534424, param_norm=1887.074951171875
02:13:55.599 [I] Progress on: 413it/2.00kit rate:8.8s/it remaining:3:52:50 elapsed:1:01:18 postfix:- (3802351:tqdm_logging.py:145)
Step 414: grad_norm=6.2908782958984375, loss=0.8766142129898071, param_norm=1887.0751953125
02:14:06.759 [I] Progress on: 414it/2.00kit rate:9.5s/it remaining:4:11:30 elapsed:1:01:29 postfix:- (3802351:tqdm_logging.py:145)
Step 415: grad_norm=5.390888214111328, loss=0.9374375939369202, param_norm=1887.075439453125
Step 416: grad_norm=8.584443092346191, loss=1.0760905742645264, param_norm=1887.07568359375
02:14:24.366 [I] Progress on: 416it/2.00kit rate:9.2s/it remaining:4:01:47 elapsed:1:01:47 postfix:- (3802351:tqdm_logging.py:145)
Step 417: grad_norm=5.993078708648682, loss=1.0064994096755981, param_norm=1887.075927734375
Step 418: grad_norm=6.311561584472656, loss=1.226104736328125, param_norm=1887.0760498046875
02:14:41.969 [I] Progress on: 418it/2.00kit rate:9.0s/it remaining:3:56:48 elapsed:1:02:05 postfix:- (3802351:tqdm_logging.py:145)
Step 419: grad_norm=7.2545576095581055, loss=1.135312557220459, param_norm=1887.076416015625
Step 420: grad_norm=8.018515586853027, loss=1.0314651727676392, param_norm=1887.0765380859375
02:14:59.553 [I] Progress on: 420it/2.00kit rate:8.9s/it remaining:3:54:01 elapsed:1:02:22 postfix:- (3802351:tqdm_logging.py:145)
Step 421: grad_norm=9.32569408416748, loss=0.946808934211731, param_norm=1887.0767822265625
Step 422: grad_norm=10.552546501159668, loss=0.9228365421295166, param_norm=1887.0771484375
02:15:17.150 [I] Progress on: 422it/2.00kit rate:8.8s/it remaining:3:52:45 elapsed:1:02:40 postfix:- (3802351:tqdm_logging.py:145)
Step 423: grad_norm=57.513790130615234, loss=1.0132278203964233, param_norm=1887.077392578125
Step 424: grad_norm=10.954744338989258, loss=0.9803096055984497, param_norm=1887.07763671875
02:15:34.754 [I] Progress on: 424it/2.00kit rate:8.8s/it remaining:3:51:59 elapsed:1:02:57 postfix:- (3802351:tqdm_logging.py:145)
Step 425: grad_norm=6.416996479034424, loss=0.9209927320480347, param_norm=1887.077880859375
Step 426: grad_norm=11.903446197509766, loss=1.016596794128418, param_norm=1887.078125
02:15:52.385 [I] Progress on: 426it/2.00kit rate:8.8s/it remaining:3:51:36 elapsed:1:03:15 postfix:- (3802351:tqdm_logging.py:145)
Step 427: grad_norm=7.393247127532959, loss=0.9697415828704834, param_norm=1887.078369140625
Step 428: grad_norm=8.6386137008667, loss=1.0645886659622192, param_norm=1887.0787353515625
02:16:10.018 [I] Progress on: 428it/2.00kit rate:8.8s/it remaining:3:51:20 elapsed:1:03:33 postfix:- (3802351:tqdm_logging.py:145)
Step 429: grad_norm=7.179262638092041, loss=1.046129822731018, param_norm=1887.078857421875
Step 430: grad_norm=9.717803955078125, loss=1.062347650527954, param_norm=1887.0791015625
02:16:27.636 [I] Progress on: 430it/2.00kit rate:8.8s/it remaining:3:51:02 elapsed:1:03:50 postfix:- (3802351:tqdm_logging.py:145)
Step 431: grad_norm=10.957045555114746, loss=1.1583083868026733, param_norm=1887.079345703125
Step 432: grad_norm=8.805778503417969, loss=1.0353479385375977, param_norm=1887.07958984375
02:16:45.214 [I] Progress on: 432it/2.00kit rate:8.8s/it remaining:3:50:20 elapsed:1:04:08 postfix:- (3802351:tqdm_logging.py:145)
Step 433: grad_norm=5.326560020446777, loss=1.051655650138855, param_norm=1887.079833984375
Step 434: grad_norm=5.28794002532959, loss=0.9590346813201904, param_norm=1887.0802001953125
02:17:02.854 [I] Progress on: 434it/2.00kit rate:8.8s/it remaining:3:50:18 elapsed:1:04:25 postfix:- (3802351:tqdm_logging.py:145)
Step 435: grad_norm=4.050416946411133, loss=0.7649142146110535, param_norm=1887.0804443359375
Step 436: grad_norm=7.303228378295898, loss=0.9466092586517334, param_norm=1887.0806884765625
02:17:20.394 [I] Progress on: 436it/2.00kit rate:8.8s/it remaining:3:49:24 elapsed:1:04:43 postfix:- (3802351:tqdm_logging.py:145)
Step 437: grad_norm=12.897600173950195, loss=0.9308105707168579, param_norm=1887.0809326171875
Step 438: grad_norm=5.645778179168701, loss=0.9914708733558655, param_norm=1887.0811767578125
02:17:38.000 [I] Progress on: 438it/2.00kit rate:8.8s/it remaining:3:49:13 elapsed:1:05:01 postfix:- (3802351:tqdm_logging.py:145)
Step 439: grad_norm=7.0553131103515625, loss=0.7770547866821289, param_norm=1887.0814208984375
Step 440: grad_norm=7.537083625793457, loss=1.0019357204437256, param_norm=1887.0816650390625
02:17:55.619 [I] Progress on: 440it/2.00kit rate:8.8s/it remaining:3:49:13 elapsed:1:05:18 postfix:- (3802351:tqdm_logging.py:145)
Step 441: grad_norm=8.993191719055176, loss=0.7476909160614014, param_norm=1887.0819091796875
Step 442: grad_norm=6.602322578430176, loss=1.0928189754486084, param_norm=1887.0821533203125
02:18:13.224 [I] Progress on: 442it/2.00kit rate:8.8s/it remaining:3:48:51 elapsed:1:05:36 postfix:- (3802351:tqdm_logging.py:145)
Step 443: grad_norm=8.283961296081543, loss=1.0654120445251465, param_norm=1887.0823974609375
Step 444: grad_norm=10.010956764221191, loss=1.2151312828063965, param_norm=1887.0826416015625
02:18:30.803 [I] Progress on: 444it/2.00kit rate:8.8s/it remaining:3:48:19 elapsed:1:05:53 postfix:- (3802351:tqdm_logging.py:145)
Step 445: grad_norm=8.525359153747559, loss=1.1750373840332031, param_norm=1887.0828857421875
Step 446: grad_norm=6.384304046630859, loss=0.9361934661865234, param_norm=1887.0833740234375
02:18:48.589 [I] Progress on: 446it/2.00kit rate:8.8s/it remaining:3:48:18 elapsed:1:06:11 postfix:- (3802351:tqdm_logging.py:145)
Step 447: grad_norm=4.963054180145264, loss=0.9799561500549316, param_norm=1887.08349609375
Step 448: grad_norm=17.015060424804688, loss=1.1172704696655273, param_norm=1887.083740234375
02:19:06.202 [I] Progress on: 448it/2.00kit rate:8.8s/it remaining:3:48:54 elapsed:1:06:29 postfix:- (3802351:tqdm_logging.py:145)
Step 449: grad_norm=14.977275848388672, loss=1.0960415601730347, param_norm=1887.083984375
Step 450: grad_norm=13.922759056091309, loss=1.0183287858963013, param_norm=1887.084228515625
02:19:23.846 [I] Progress on: 450it/2.00kit rate:8.8s/it remaining:3:48:22 elapsed:1:06:46 postfix:- (3802351:tqdm_logging.py:145)
Step 451: grad_norm=6.701842308044434, loss=1.1243257522583008, param_norm=1887.08447265625
Step 452: grad_norm=7.4068379402160645, loss=0.9076153635978699, param_norm=1887.0845947265625
02:19:41.431 [I] Progress on: 452it/2.00kit rate:8.8s/it remaining:3:47:36 elapsed:1:07:04 postfix:- (3802351:tqdm_logging.py:145)
Step 453: grad_norm=15.318160057067871, loss=1.114814043045044, param_norm=1887.0848388671875
Step 454: grad_norm=12.137882232666016, loss=1.0136280059814453, param_norm=1887.0850830078125
02:19:59.054 [I] Progress on: 454it/2.00kit rate:8.8s/it remaining:3:47:17 elapsed:1:07:22 postfix:- (3802351:tqdm_logging.py:145)
Step 455: grad_norm=11.830883026123047, loss=1.0152380466461182, param_norm=1887.085205078125
Step 456: grad_norm=6.6909871101379395, loss=1.166159749031067, param_norm=1887.08544921875
02:20:16.659 [I] Progress on: 456it/2.00kit rate:8.8s/it remaining:3:46:48 elapsed:1:07:39 postfix:- (3802351:tqdm_logging.py:145)
Step 457: grad_norm=7.409585475921631, loss=1.1044437885284424, param_norm=1887.0855712890625
Step 458: grad_norm=15.047968864440918, loss=0.9414018988609314, param_norm=1887.0858154296875
02:20:34.260 [I] Progress on: 458it/2.00kit rate:8.8s/it remaining:3:46:33 elapsed:1:07:57 postfix:- (3802351:tqdm_logging.py:145)
Step 459: grad_norm=15.335875511169434, loss=1.0327098369598389, param_norm=1887.0859375
Step 460: grad_norm=14.916411399841309, loss=0.9356754422187805, param_norm=1887.0860595703125
02:20:51.832 [I] Progress on: 460it/2.00kit rate:8.8s/it remaining:3:45:57 elapsed:1:08:14 postfix:- (3802351:tqdm_logging.py:145)
Step 461: grad_norm=9.774672508239746, loss=1.091801643371582, param_norm=1887.0863037109375
Step 462: grad_norm=6.053519248962402, loss=1.111786961555481, param_norm=1887.08642578125
02:21:09.486 [I] Progress on: 462it/2.00kit rate:8.8s/it remaining:3:46:09 elapsed:1:08:32 postfix:- (3802351:tqdm_logging.py:145)
Step 463: grad_norm=6.226354598999023, loss=1.0720330476760864, param_norm=1887.086669921875
Step 464: grad_norm=4.555908679962158, loss=0.8907531499862671, param_norm=1887.0867919921875
02:21:27.162 [I] Progress on: 464it/2.00kit rate:8.8s/it remaining:3:46:13 elapsed:1:08:50 postfix:- (3802351:tqdm_logging.py:145)
Step 465: grad_norm=13.823270797729492, loss=0.9380621910095215, param_norm=1887.0870361328125
Step 466: grad_norm=14.737822532653809, loss=1.0180082321166992, param_norm=1887.0872802734375
02:21:44.772 [I] Progress on: 466it/2.00kit rate:8.8s/it remaining:3:45:39 elapsed:1:09:07 postfix:- (3802351:tqdm_logging.py:145)
Step 467: grad_norm=14.953303337097168, loss=1.110675573348999, param_norm=1887.08740234375
Step 468: grad_norm=7.614994049072266, loss=0.9748921394348145, param_norm=1887.0875244140625
02:22:02.382 [I] Progress on: 468it/2.00kit rate:8.8s/it remaining:3:45:04 elapsed:1:09:25 postfix:- (3802351:tqdm_logging.py:145)
Step 469: grad_norm=6.095431804656982, loss=0.8675635457038879, param_norm=1887.087890625
Step 470: grad_norm=9.342637062072754, loss=0.8292410969734192, param_norm=1887.0880126953125
02:22:20.030 [I] Progress on: 470it/2.00kit rate:8.8s/it remaining:3:44:59 elapsed:1:09:43 postfix:- (3802351:tqdm_logging.py:145)
Step 471: grad_norm=14.845736503601074, loss=1.1172748804092407, param_norm=1887.0882568359375
Step 472: grad_norm=23.043315887451172, loss=1.0387003421783447, param_norm=1887.08837890625
02:22:37.660 [I] Progress on: 472it/2.00kit rate:8.8s/it remaining:3:44:47 elapsed:1:10:00 postfix:- (3802351:tqdm_logging.py:145)
Step 473: grad_norm=22.068368911743164, loss=0.9265711307525635, param_norm=1887.088623046875
Step 474: grad_norm=21.372879028320312, loss=0.9962176084518433, param_norm=1887.0887451171875
02:22:55.308 [I] Progress on: 474it/2.00kit rate:8.8s/it remaining:3:44:39 elapsed:1:10:18 postfix:- (3802351:tqdm_logging.py:145)
Step 475: grad_norm=13.695080757141113, loss=1.0895578861236572, param_norm=1887.0889892578125
Step 476: grad_norm=12.664113998413086, loss=1.0070629119873047, param_norm=1887.0889892578125
02:23:12.896 [I] Progress on: 476it/2.00kit rate:8.8s/it remaining:3:43:58 elapsed:1:10:35 postfix:- (3802351:tqdm_logging.py:145)
Step 477: grad_norm=8.055997848510742, loss=0.9796788692474365, param_norm=1887.089111328125
Step 478: grad_norm=9.522801399230957, loss=1.148227572441101, param_norm=1887.0892333984375
02:23:30.502 [I] Progress on: 478it/2.00kit rate:8.8s/it remaining:3:43:35 elapsed:1:10:53 postfix:- (3802351:tqdm_logging.py:145)
Step 479: grad_norm=9.117579460144043, loss=0.9968189001083374, param_norm=1887.0894775390625
Step 480: grad_norm=9.10869026184082, loss=0.9666500687599182, param_norm=1887.089599609375
02:23:48.087 [I] Progress on: 480it/2.00kit rate:8.8s/it remaining:3:43:06 elapsed:1:11:11 postfix:- (3802351:tqdm_logging.py:145)
Step 481: grad_norm=10.887439727783203, loss=1.0754308700561523, param_norm=1887.0897216796875
Step 482: grad_norm=7.293828964233398, loss=0.9742105007171631, param_norm=1887.08984375
02:24:05.602 [I] Progress on: 482it/2.00kit rate:8.8s/it remaining:3:42:13 elapsed:1:11:28 postfix:- (3802351:tqdm_logging.py:145)
Step 483: grad_norm=4.177703380584717, loss=0.8607199192047119, param_norm=1887.090087890625
02:24:16.722 [I] Progress on: 483it/2.00kit rate:9.5s/it remaining:3:59:53 elapsed:1:11:39 postfix:- (3802351:tqdm_logging.py:145)
Step 484: grad_norm=6.433049201965332, loss=0.8407877683639526, param_norm=1887.09033203125
Step 485: grad_norm=5.841550350189209, loss=0.6558970808982849, param_norm=1887.0904541015625
02:24:34.343 [I] Progress on: 485it/2.00kit rate:9.1s/it remaining:3:50:52 elapsed:1:11:57 postfix:- (3802351:tqdm_logging.py:145)
Step 486: grad_norm=5.696917533874512, loss=0.8117932081222534, param_norm=1887.0906982421875
Step 487: grad_norm=4.867460250854492, loss=0.778539776802063, param_norm=1887.0909423828125
02:24:51.891 [I] Progress on: 487it/2.00kit rate:9.0s/it remaining:3:45:44 elapsed:1:12:14 postfix:- (3802351:tqdm_logging.py:145)
Step 488: grad_norm=6.709148406982422, loss=1.0210164785385132, param_norm=1887.0911865234375
Step 489: grad_norm=7.102275848388672, loss=0.7486288547515869, param_norm=1887.0914306640625
02:25:09.488 [I] Progress on: 489it/2.00kit rate:8.9s/it remaining:3:43:21 elapsed:1:12:32 postfix:- (3802351:tqdm_logging.py:145)
Step 490: grad_norm=6.892551422119141, loss=0.847402036190033, param_norm=1887.0916748046875
Step 491: grad_norm=9.309664726257324, loss=0.9659663438796997, param_norm=1887.0919189453125
02:25:27.097 [I] Progress on: 491it/2.00kit rate:8.8s/it remaining:3:42:10 elapsed:1:12:50 postfix:- (3802351:tqdm_logging.py:145)
Step 492: grad_norm=9.463274002075195, loss=1.0476018190383911, param_norm=1887.0921630859375
Step 493: grad_norm=5.7184038162231445, loss=0.9784709811210632, param_norm=1887.09228515625
02:25:44.705 [I] Progress on: 493it/2.00kit rate:8.8s/it remaining:3:41:28 elapsed:1:13:07 postfix:- (3802351:tqdm_logging.py:145)
Step 494: grad_norm=5.047178745269775, loss=0.8875223398208618, param_norm=1887.0926513671875
Step 495: grad_norm=7.693125247955322, loss=0.8345727920532227, param_norm=1887.0928955078125
02:26:02.342 [I] Progress on: 495it/2.00kit rate:8.8s/it remaining:3:41:08 elapsed:1:13:25 postfix:- (3802351:tqdm_logging.py:145)
Step 496: grad_norm=5.321666717529297, loss=0.8484604358673096, param_norm=1887.0931396484375
Step 497: grad_norm=5.040360450744629, loss=0.845592200756073, param_norm=1887.0933837890625
02:26:19.980 [I] Progress on: 497it/2.00kit rate:8.8s/it remaining:3:40:56 elapsed:1:13:43 postfix:- (3802351:tqdm_logging.py:145)
Step 498: grad_norm=4.8581461906433105, loss=0.7671397924423218, param_norm=1887.0936279296875
Step 499: grad_norm=5.045691967010498, loss=0.8671169281005859, param_norm=1887.09375
02:26:37.620 [I] Progress on: 499it/2.00kit rate:8.8s/it remaining:3:40:37 elapsed:1:14:00 postfix:- (3802351:tqdm_logging.py:145)
Step 500: grad_norm=4.2176337242126465, loss=0.8316313624382019, param_norm=1887.0941162109375
02:26:46.603 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
02:26:46.604 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
02:26:46.604 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=400. (3802351:checkpoint_manager.py:1786)
02:26:46.604 [I] [process=0][thread=MainThread][step=400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=400, also errors if any. (3802351:checkpoint_manager.py:1817)
02:26:46.605 [I] [process=0] Saving checkpoint at step 500                                        (3802351:checkpoint_manager.py:1286)
02:26:46.605 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500. (3802351:async_checkpointer.py:358)
02:26:46.607 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:26:46.608 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12 (3802351:atomicity.py:144)
02:26:46.609 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:26:46.610 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:26:46.611 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (3802351:atomicity.py:144)
02:26:46.612 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (3802351:atomicity.py:144)
02:26:46.613 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:26:46.619 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
02:26:50.410 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:26:50.412 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
02:26:50.418 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
02:26:50.420 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
02:26:50.434 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:26:50.444 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:26:50.446 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:26:50.447 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:26:50.449 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
02:26:50.450 [I] [process=0][thread=MainThread][step=500] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
02:26:50.451 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
02:26:50.451 [I] {'step': 500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742797606.6036332, 'wait_for_prev_duration_secs': 0.0008368492126464844, 'checkpointer_blocking_start_time': 1742797606.6051476, 'checkpointer_blocking_duration_secs': 3.829080820083618, 'get_old_steps_start_time': 1742797610.43429, 'get_old_steps_duration_secs': 0.014669418334960938, 'checkpoint_manager_blocking_start_time': 1742797606.603421, 'checkpoint_manager_blocking_duration_secs': 3.848384380340576} (3802351:standard_logger.py:34)
02:26:50.457 [I] Progress on: 501it/2.00kit rate:10.0s/it remaining:4:08:57 elapsed:1:14:13 postfix:- (3802351:tqdm_logging.py:145)
02:26:58.092 [I] ChainedFuture completed 1/1 futures in 7.68 seconds.                             (3802351:future.py:137)
02:26:58.093 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 902.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:26:58.094 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
02:26:58.095 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12 (3802351:async_checkpointer.py:406)
02:26:58.095 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12/assets (3802351:atomicity.py:287)
02:26:58.108 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12/params (3802351:atomicity.py:287)
02:26:58.109 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500 (3802351:async_checkpointer.py:416)
02:26:58.109 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12 (3802351:async_checkpointer.py:426)
02:26:58.109 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500.orbax-checkpoint-tmp-12 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500 (3802351:atomicity.py:287)
02:26:58.111 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/500`. (3802351:atomicity.py:548)
02:26:58.111 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
02:26:58.112 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
02:26:58.112 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
02:26:58.112 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
02:26:58.113 [I] [process=0][thread=save_finalize][step=500] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 501: grad_norm=5.400611400604248, loss=0.8603072166442871, param_norm=1887.09423828125
Step 502: grad_norm=6.046794891357422, loss=0.8773446083068848, param_norm=1887.0943603515625
02:27:07.837 [I] Progress on: 502it/2.00kit rate:9.6s/it remaining:3:59:58 elapsed:1:14:30 postfix:- (3802351:tqdm_logging.py:145)
Step 503: grad_norm=4.753164291381836, loss=0.7448543310165405, param_norm=1887.0946044921875
Step 504: grad_norm=6.207764148712158, loss=0.8353843092918396, param_norm=1887.0948486328125
02:27:25.460 [I] Progress on: 504it/2.00kit rate:9.2s/it remaining:3:49:28 elapsed:1:14:48 postfix:- (3802351:tqdm_logging.py:145)
Step 505: grad_norm=7.093405723571777, loss=0.814805269241333, param_norm=1887.094970703125
Step 506: grad_norm=5.289139747619629, loss=0.9050511121749878, param_norm=1887.09521484375
02:27:43.116 [I] Progress on: 506it/2.00kit rate:9.0s/it remaining:3:44:25 elapsed:1:15:06 postfix:- (3802351:tqdm_logging.py:145)
Step 507: grad_norm=7.607161521911621, loss=1.073965072631836, param_norm=1887.0953369140625
Step 508: grad_norm=5.377247333526611, loss=0.921377420425415, param_norm=1887.095458984375
02:28:00.724 [I] Progress on: 508it/2.00kit rate:8.9s/it remaining:3:41:27 elapsed:1:15:23 postfix:- (3802351:tqdm_logging.py:145)
Step 509: grad_norm=7.385807514190674, loss=0.8493685722351074, param_norm=1887.0958251953125
Step 510: grad_norm=5.8606719970703125, loss=0.6903218030929565, param_norm=1887.095947265625
02:28:18.383 [I] Progress on: 510it/2.00kit rate:8.9s/it remaining:3:40:14 elapsed:1:15:41 postfix:- (3802351:tqdm_logging.py:145)
Step 511: grad_norm=5.072181224822998, loss=0.9429649114608765, param_norm=1887.09619140625
Step 512: grad_norm=10.325182914733887, loss=0.8266815543174744, param_norm=1887.0963134765625
02:28:36.029 [I] Progress on: 512it/2.00kit rate:8.8s/it remaining:3:39:22 elapsed:1:15:59 postfix:- (3802351:tqdm_logging.py:145)
Step 513: grad_norm=4.905243873596191, loss=0.866483211517334, param_norm=1887.0965576171875
Step 514: grad_norm=7.100257396697998, loss=0.9882612228393555, param_norm=1887.0966796875
02:28:53.625 [I] Progress on: 514it/2.00kit rate:8.8s/it remaining:3:38:34 elapsed:1:16:16 postfix:- (3802351:tqdm_logging.py:145)
Step 515: grad_norm=6.279980182647705, loss=0.995276689529419, param_norm=1887.096923828125
Step 516: grad_norm=7.4158525466918945, loss=0.8649994730949402, param_norm=1887.0970458984375
02:29:11.213 [I] Progress on: 516it/2.00kit rate:8.8s/it remaining:3:37:52 elapsed:1:16:34 postfix:- (3802351:tqdm_logging.py:145)
Step 517: grad_norm=6.574162006378174, loss=0.952922523021698, param_norm=1887.0972900390625
Step 518: grad_norm=6.050958156585693, loss=0.8462697267532349, param_norm=1887.097412109375
02:29:28.843 [I] Progress on: 518it/2.00kit rate:8.8s/it remaining:3:37:37 elapsed:1:16:51 postfix:- (3802351:tqdm_logging.py:145)
Step 519: grad_norm=6.675451278686523, loss=1.011728048324585, param_norm=1887.0975341796875
Step 520: grad_norm=4.224260330200195, loss=0.7070176601409912, param_norm=1887.09765625
02:29:46.443 [I] Progress on: 520it/2.00kit rate:8.8s/it remaining:3:37:13 elapsed:1:17:09 postfix:- (3802351:tqdm_logging.py:145)
Step 521: grad_norm=6.893687725067139, loss=0.8386744260787964, param_norm=1887.0977783203125
Step 522: grad_norm=4.628655910491943, loss=0.7679922580718994, param_norm=1887.0980224609375
02:30:04.029 [I] Progress on: 522it/2.00kit rate:8.8s/it remaining:3:36:45 elapsed:1:17:27 postfix:- (3802351:tqdm_logging.py:145)
Step 523: grad_norm=5.092493057250977, loss=0.8501991033554077, param_norm=1887.09814453125
Step 524: grad_norm=8.8590669631958, loss=0.7039727568626404, param_norm=1887.098388671875
02:30:21.630 [I] Progress on: 524it/2.00kit rate:8.8s/it remaining:3:36:32 elapsed:1:17:44 postfix:- (3802351:tqdm_logging.py:145)
Step 525: grad_norm=4.8754963874816895, loss=0.8619016408920288, param_norm=1887.0985107421875
Step 526: grad_norm=5.684990882873535, loss=0.8811988830566406, param_norm=1887.0987548828125
02:30:39.234 [I] Progress on: 526it/2.00kit rate:8.8s/it remaining:3:36:13 elapsed:1:18:02 postfix:- (3802351:tqdm_logging.py:145)
Step 527: grad_norm=5.859371185302734, loss=0.8044238686561584, param_norm=1887.098876953125
Step 528: grad_norm=9.687174797058105, loss=0.7254323363304138, param_norm=1887.0989990234375
02:30:56.835 [I] Progress on: 528it/2.00kit rate:8.8s/it remaining:3:35:56 elapsed:1:18:19 postfix:- (3802351:tqdm_logging.py:145)
Step 529: grad_norm=5.149311065673828, loss=0.8712705373764038, param_norm=1887.0992431640625
Step 530: grad_norm=5.016169548034668, loss=0.8038390874862671, param_norm=1887.099365234375
02:31:14.443 [I] Progress on: 530it/2.00kit rate:8.8s/it remaining:3:35:37 elapsed:1:18:37 postfix:- (3802351:tqdm_logging.py:145)
Step 531: grad_norm=7.915329933166504, loss=0.8458529114723206, param_norm=1887.099609375
Step 532: grad_norm=7.083444595336914, loss=0.8091812133789062, param_norm=1887.099853515625
02:31:32.129 [I] Progress on: 532it/2.00kit rate:8.8s/it remaining:3:35:57 elapsed:1:18:55 postfix:- (3802351:tqdm_logging.py:145)
Step 533: grad_norm=8.401115417480469, loss=0.990492582321167, param_norm=1887.0999755859375
Step 534: grad_norm=5.827638149261475, loss=0.808508038520813, param_norm=1887.10009765625
02:31:49.772 [I] Progress on: 534it/2.00kit rate:8.8s/it remaining:3:35:35 elapsed:1:19:12 postfix:- (3802351:tqdm_logging.py:145)
Step 535: grad_norm=5.151017665863037, loss=0.8500049114227295, param_norm=1887.100341796875
Step 536: grad_norm=5.808111190795898, loss=0.79671311378479, param_norm=1887.1004638671875
02:32:07.428 [I] Progress on: 536it/2.00kit rate:8.8s/it remaining:3:35:20 elapsed:1:19:30 postfix:- (3802351:tqdm_logging.py:145)
Step 537: grad_norm=8.392210006713867, loss=0.7699207067489624, param_norm=1887.1007080078125
Step 538: grad_norm=5.573875427246094, loss=0.9099682569503784, param_norm=1887.100830078125
02:32:25.171 [I] Progress on: 538it/2.00kit rate:8.9s/it remaining:3:35:40 elapsed:1:19:48 postfix:- (3802351:tqdm_logging.py:145)
Step 539: grad_norm=5.243292808532715, loss=0.8847744464874268, param_norm=1887.1009521484375
Step 540: grad_norm=7.971319198608398, loss=0.8116522431373596, param_norm=1887.10107421875
02:32:42.874 [I] Progress on: 540it/2.00kit rate:8.9s/it remaining:3:35:21 elapsed:1:20:05 postfix:- (3802351:tqdm_logging.py:145)
Step 541: grad_norm=8.50760555267334, loss=0.8938392400741577, param_norm=1887.1011962890625
Step 542: grad_norm=4.851985454559326, loss=0.8029260635375977, param_norm=1887.101318359375
02:33:00.568 [I] Progress on: 542it/2.00kit rate:8.9s/it remaining:3:35:06 elapsed:1:20:23 postfix:- (3802351:tqdm_logging.py:145)
Step 543: grad_norm=7.662440776824951, loss=0.7912006378173828, param_norm=1887.1014404296875
Step 544: grad_norm=6.07638692855835, loss=0.7824862003326416, param_norm=1887.1015625
02:33:18.237 [I] Progress on: 544it/2.00kit rate:8.8s/it remaining:3:34:40 elapsed:1:20:41 postfix:- (3802351:tqdm_logging.py:145)
Step 545: grad_norm=4.713961124420166, loss=0.7531015872955322, param_norm=1887.101806640625
Step 546: grad_norm=6.963888168334961, loss=0.8328666687011719, param_norm=1887.1019287109375
02:33:35.906 [I] Progress on: 546it/2.00kit rate:8.8s/it remaining:3:34:08 elapsed:1:20:58 postfix:- (3802351:tqdm_logging.py:145)
Step 547: grad_norm=9.534692764282227, loss=0.9251943826675415, param_norm=1887.10205078125
Step 548: grad_norm=5.861279010772705, loss=0.9430893659591675, param_norm=1887.1021728515625
02:33:53.571 [I] Progress on: 548it/2.00kit rate:8.8s/it remaining:3:33:47 elapsed:1:21:16 postfix:- (3802351:tqdm_logging.py:145)
Step 549: grad_norm=6.195521354675293, loss=0.9118980765342712, param_norm=1887.1024169921875
Step 550: grad_norm=7.005850791931152, loss=0.910667896270752, param_norm=1887.1025390625
02:34:11.233 [I] Progress on: 550it/2.00kit rate:8.8s/it remaining:3:33:28 elapsed:1:21:34 postfix:- (3802351:tqdm_logging.py:145)
Step 551: grad_norm=7.418704986572266, loss=0.8023841977119446, param_norm=1887.1026611328125
02:34:22.725 [I] Progress on: 552it/2.00kit rate:9.6s/it remaining:3:50:57 elapsed:1:21:45 postfix:- (3802351:tqdm_logging.py:145)
Step 552: grad_norm=5.818553924560547, loss=0.7365864515304565, param_norm=1887.1029052734375
Step 553: grad_norm=5.101947784423828, loss=0.7598363757133484, param_norm=1887.1029052734375
02:34:40.093 [I] Progress on: 553it/2.00kit rate:9.3s/it remaining:3:44:58 elapsed:1:22:03 postfix:- (3802351:tqdm_logging.py:145)
Step 554: grad_norm=5.14645528793335, loss=0.6415966749191284, param_norm=1887.1031494140625
Step 555: grad_norm=5.449946403503418, loss=0.8143762350082397, param_norm=1887.103271484375
02:34:57.701 [I] Progress on: 555it/2.00kit rate:9.1s/it remaining:3:38:11 elapsed:1:22:20 postfix:- (3802351:tqdm_logging.py:145)
Step 556: grad_norm=4.399714946746826, loss=0.7753158807754517, param_norm=1887.1033935546875
Step 557: grad_norm=4.416441440582275, loss=0.6921409964561462, param_norm=1887.1036376953125
02:35:15.290 [I] Progress on: 557it/2.00kit rate:8.9s/it remaining:3:34:33 elapsed:1:22:38 postfix:- (3802351:tqdm_logging.py:145)
Step 558: grad_norm=5.1995530128479, loss=0.7982749938964844, param_norm=1887.103759765625
Step 559: grad_norm=4.994256019592285, loss=0.799549400806427, param_norm=1887.1038818359375
02:35:32.910 [I] Progress on: 559it/2.00kit rate:8.9s/it remaining:3:32:55 elapsed:1:22:55 postfix:- (3802351:tqdm_logging.py:145)
Step 560: grad_norm=5.13878870010376, loss=0.7877234220504761, param_norm=1887.10400390625
Step 561: grad_norm=5.651273250579834, loss=0.755319356918335, param_norm=1887.104248046875
02:35:50.519 [I] Progress on: 561it/2.00kit rate:8.8s/it remaining:3:31:56 elapsed:1:23:13 postfix:- (3802351:tqdm_logging.py:145)
Step 562: grad_norm=4.550287246704102, loss=0.7071318626403809, param_norm=1887.1043701171875
Step 563: grad_norm=4.281895160675049, loss=0.7324204444885254, param_norm=1887.1044921875
02:36:08.156 [I] Progress on: 563it/2.00kit rate:8.8s/it remaining:3:31:24 elapsed:1:23:31 postfix:- (3802351:tqdm_logging.py:145)
Step 564: grad_norm=5.6748762130737305, loss=0.9071850180625916, param_norm=1887.1046142578125
Step 565: grad_norm=4.996054172515869, loss=0.7364736199378967, param_norm=1887.1048583984375
02:36:25.761 [I] Progress on: 565it/2.00kit rate:8.8s/it remaining:3:30:44 elapsed:1:23:48 postfix:- (3802351:tqdm_logging.py:145)
Step 566: grad_norm=5.6417694091796875, loss=0.8912162780761719, param_norm=1887.1051025390625
Step 567: grad_norm=4.202445030212402, loss=0.5541489124298096, param_norm=1887.1051025390625
02:36:43.382 [I] Progress on: 567it/2.00kit rate:8.8s/it remaining:3:30:28 elapsed:1:24:06 postfix:- (3802351:tqdm_logging.py:145)
Step 568: grad_norm=5.237170219421387, loss=0.6446307301521301, param_norm=1887.1053466796875
Step 569: grad_norm=7.100727081298828, loss=0.7005103826522827, param_norm=1887.1053466796875
02:37:01.008 [I] Progress on: 569it/2.00kit rate:8.8s/it remaining:3:30:11 elapsed:1:24:24 postfix:- (3802351:tqdm_logging.py:145)
Step 570: grad_norm=4.18100643157959, loss=0.5402113795280457, param_norm=1887.10546875
Step 571: grad_norm=4.581853866577148, loss=0.8218797445297241, param_norm=1887.1055908203125
02:37:18.616 [I] Progress on: 571it/2.00kit rate:8.8s/it remaining:3:29:53 elapsed:1:24:41 postfix:- (3802351:tqdm_logging.py:145)
Step 572: grad_norm=6.408998012542725, loss=0.8377425670623779, param_norm=1887.105712890625
Step 573: grad_norm=5.04897403717041, loss=0.7141571044921875, param_norm=1887.10595703125
02:37:36.209 [I] Progress on: 573it/2.00kit rate:8.8s/it remaining:3:29:21 elapsed:1:24:59 postfix:- (3802351:tqdm_logging.py:145)
Step 574: grad_norm=4.2701239585876465, loss=0.6836552619934082, param_norm=1887.10595703125
Step 575: grad_norm=5.982124328613281, loss=0.711448073387146, param_norm=1887.1060791015625
02:37:53.801 [I] Progress on: 575it/2.00kit rate:8.8s/it remaining:3:28:55 elapsed:1:25:16 postfix:- (3802351:tqdm_logging.py:145)
Step 576: grad_norm=4.3084611892700195, loss=0.6493474245071411, param_norm=1887.1063232421875
Step 577: grad_norm=9.152626991271973, loss=0.8902890086174011, param_norm=1887.1063232421875
02:38:11.389 [I] Progress on: 577it/2.00kit rate:8.8s/it remaining:3:28:31 elapsed:1:25:34 postfix:- (3802351:tqdm_logging.py:145)
Step 578: grad_norm=4.357508659362793, loss=0.6546337604522705, param_norm=1887.1065673828125
Step 579: grad_norm=6.458445072174072, loss=0.8057501316070557, param_norm=1887.106689453125
02:38:28.944 [I] Progress on: 579it/2.00kit rate:8.8s/it remaining:3:27:59 elapsed:1:25:52 postfix:- (3802351:tqdm_logging.py:145)
Step 580: grad_norm=7.085474491119385, loss=0.8080661296844482, param_norm=1887.1068115234375
Step 581: grad_norm=9.917011260986328, loss=0.6961924433708191, param_norm=1887.10693359375
02:38:46.584 [I] Progress on: 581it/2.00kit rate:8.8s/it remaining:3:28:04 elapsed:1:26:09 postfix:- (3802351:tqdm_logging.py:145)
Step 582: grad_norm=5.162811279296875, loss=0.7984722852706909, param_norm=1887.1070556640625
Step 583: grad_norm=4.478852272033691, loss=0.5939905643463135, param_norm=1887.107177734375
02:39:04.221 [I] Progress on: 583it/2.00kit rate:8.8s/it remaining:3:27:57 elapsed:1:26:27 postfix:- (3802351:tqdm_logging.py:145)
Step 584: grad_norm=5.03098726272583, loss=0.8558527827262878, param_norm=1887.1072998046875
Step 585: grad_norm=7.891006946563721, loss=0.7518103122711182, param_norm=1887.107421875
02:39:21.844 [I] Progress on: 585it/2.00kit rate:8.8s/it remaining:3:27:43 elapsed:1:26:44 postfix:- (3802351:tqdm_logging.py:145)
Step 586: grad_norm=7.968395709991455, loss=0.7608838677406311, param_norm=1887.1075439453125
Step 587: grad_norm=5.365117073059082, loss=0.7540557384490967, param_norm=1887.107666015625
02:39:39.481 [I] Progress on: 587it/2.00kit rate:8.8s/it remaining:3:27:30 elapsed:1:27:02 postfix:- (3802351:tqdm_logging.py:145)
Step 588: grad_norm=5.577705383300781, loss=0.7589731216430664, param_norm=1887.107666015625
Step 589: grad_norm=4.6677961349487305, loss=0.6968003511428833, param_norm=1887.10791015625
02:39:57.148 [I] Progress on: 589it/2.00kit rate:8.8s/it remaining:3:27:24 elapsed:1:27:20 postfix:- (3802351:tqdm_logging.py:145)
Step 590: grad_norm=5.513300895690918, loss=0.6948874592781067, param_norm=1887.10791015625
Step 591: grad_norm=6.386965274810791, loss=0.741976261138916, param_norm=1887.10791015625
02:40:14.786 [I] Progress on: 591it/2.00kit rate:8.8s/it remaining:3:27:01 elapsed:1:27:37 postfix:- (3802351:tqdm_logging.py:145)
Step 592: grad_norm=4.728209018707275, loss=0.7565972805023193, param_norm=1887.108154296875
Step 593: grad_norm=4.326986789703369, loss=0.7072510123252869, param_norm=1887.1082763671875
02:40:32.412 [I] Progress on: 593it/2.00kit rate:8.8s/it remaining:3:26:43 elapsed:1:27:55 postfix:- (3802351:tqdm_logging.py:145)
Step 594: grad_norm=5.657154560089111, loss=0.7087241411209106, param_norm=1887.1082763671875
Step 595: grad_norm=4.219020843505859, loss=0.7189306020736694, param_norm=1887.1085205078125
02:40:50.069 [I] Progress on: 595it/2.00kit rate:8.8s/it remaining:3:26:26 elapsed:1:28:13 postfix:- (3802351:tqdm_logging.py:145)
Step 596: grad_norm=5.86543607711792, loss=0.916251003742218, param_norm=1887.1085205078125
Step 597: grad_norm=7.705602169036865, loss=0.723196268081665, param_norm=1887.108642578125
02:41:07.728 [I] Progress on: 597it/2.00kit rate:8.8s/it remaining:3:26:18 elapsed:1:28:30 postfix:- (3802351:tqdm_logging.py:145)
Step 598: grad_norm=5.387661457061768, loss=0.7243443131446838, param_norm=1887.1087646484375
Step 599: grad_norm=10.10798454284668, loss=0.7023476362228394, param_norm=1887.10888671875
02:41:25.333 [I] Progress on: 599it/2.00kit rate:8.8s/it remaining:3:25:46 elapsed:1:28:48 postfix:- (3802351:tqdm_logging.py:145)
Step 600: grad_norm=5.459956645965576, loss=0.7841646075248718, param_norm=1887.1090087890625
02:41:34.351 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
02:41:34.351 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
02:41:34.351 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=500. (3802351:checkpoint_manager.py:1786)
02:41:34.352 [I] [process=0][thread=MainThread][step=500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=500, also errors if any. (3802351:checkpoint_manager.py:1817)
02:41:34.352 [I] [process=0] Saving checkpoint at step 600                                        (3802351:checkpoint_manager.py:1286)
02:41:34.353 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600. (3802351:async_checkpointer.py:358)
02:41:34.354 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:41:34.355 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15 (3802351:atomicity.py:144)
02:41:34.356 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:41:34.356 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:41:34.358 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 (3802351:atomicity.py:144)
02:41:34.359 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 (3802351:atomicity.py:144)
02:41:34.360 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:41:34.374 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
02:41:38.187 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:41:38.191 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
02:41:38.193 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
02:41:38.196 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
02:41:38.226 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:41:38.230 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:41:38.232 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:41:38.235 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:41:38.235 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:41:38.236 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
02:41:38.238 [I] [process=0][thread=MainThread][step=600] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
02:41:38.241 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
02:41:38.242 [I] {'step': 600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742798494.3512764, 'wait_for_prev_duration_secs': 0.0008356571197509766, 'checkpointer_blocking_start_time': 1742798494.3527305, 'checkpointer_blocking_duration_secs': 3.873735189437866, 'get_old_steps_start_time': 1742798498.2265315, 'get_old_steps_duration_secs': 0.010307073593139648, 'checkpoint_manager_blocking_start_time': 1742798494.3510752, 'checkpoint_manager_blocking_duration_secs': 3.8913590908050537} (3802351:standard_logger.py:34)
02:41:38.247 [I] Progress on: 601it/2.00kit rate:10.0s/it remaining:3:52:48 elapsed:1:29:01 postfix:- (3802351:tqdm_logging.py:145)
02:41:46.654 [I] ChainedFuture completed 1/1 futures in 8.46 seconds.                             (3802351:future.py:137)
02:41:46.656 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 842.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:41:46.656 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
02:41:46.658 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15 (3802351:async_checkpointer.py:406)
02:41:46.658 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15/assets.orbax-checkpoint-tmp-16 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15/assets (3802351:atomicity.py:287)
02:41:46.672 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15/params.orbax-checkpoint-tmp-17 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15/params (3802351:atomicity.py:287)
02:41:46.673 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600 (3802351:async_checkpointer.py:416)
02:41:46.673 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15 (3802351:async_checkpointer.py:426)
02:41:46.674 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600.orbax-checkpoint-tmp-15 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600 (3802351:atomicity.py:287)
02:41:46.676 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/600`. (3802351:atomicity.py:548)
02:41:46.676 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
02:41:46.677 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
02:41:46.677 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
02:41:46.678 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
02:41:46.678 [I] [process=0][thread=save_finalize][step=600] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 601: grad_norm=6.094506740570068, loss=0.6369326114654541, param_norm=1887.109130859375
Step 602: grad_norm=4.742683410644531, loss=0.7154767513275146, param_norm=1887.1092529296875
02:41:55.643 [I] Progress on: 602it/2.00kit rate:9.6s/it remaining:3:44:19 elapsed:1:29:18 postfix:- (3802351:tqdm_logging.py:145)
Step 603: grad_norm=5.059050559997559, loss=0.73069167137146, param_norm=1887.109375
Step 604: grad_norm=6.453980922698975, loss=0.8563545942306519, param_norm=1887.109619140625
02:42:13.250 [I] Progress on: 604it/2.00kit rate:9.2s/it remaining:3:34:16 elapsed:1:29:36 postfix:- (3802351:tqdm_logging.py:145)
Step 605: grad_norm=9.606196403503418, loss=0.6526696681976318, param_norm=1887.1097412109375
Step 606: grad_norm=4.694567680358887, loss=0.6941980123519897, param_norm=1887.10986328125
02:42:30.872 [I] Progress on: 606it/2.00kit rate:9.0s/it remaining:3:29:11 elapsed:1:29:53 postfix:- (3802351:tqdm_logging.py:145)
Step 607: grad_norm=8.489444732666016, loss=0.7037491202354431, param_norm=1887.10986328125
Step 608: grad_norm=4.440282821655273, loss=0.6779739856719971, param_norm=1887.1099853515625
02:42:48.509 [I] Progress on: 608it/2.00kit rate:8.9s/it remaining:3:26:41 elapsed:1:30:11 postfix:- (3802351:tqdm_logging.py:145)
Step 609: grad_norm=4.904736518859863, loss=0.8368464708328247, param_norm=1887.110107421875
Step 610: grad_norm=5.02488374710083, loss=0.7303811311721802, param_norm=1887.1102294921875
02:43:06.098 [I] Progress on: 610it/2.00kit rate:8.9s/it remaining:3:25:01 elapsed:1:30:29 postfix:- (3802351:tqdm_logging.py:145)
Step 611: grad_norm=7.6902875900268555, loss=0.6967528462409973, param_norm=1887.1102294921875
Step 612: grad_norm=5.295511245727539, loss=0.5976264476776123, param_norm=1887.1102294921875
02:43:23.701 [I] Progress on: 612it/2.00kit rate:8.8s/it remaining:3:24:16 elapsed:1:30:46 postfix:- (3802351:tqdm_logging.py:145)
Step 613: grad_norm=5.712186813354492, loss=0.8287495374679565, param_norm=1887.1103515625
Step 614: grad_norm=4.958507537841797, loss=0.7387927770614624, param_norm=1887.110595703125
02:43:41.339 [I] Progress on: 614it/2.00kit rate:8.8s/it remaining:3:23:47 elapsed:1:31:04 postfix:- (3802351:tqdm_logging.py:145)
Step 615: grad_norm=9.580504417419434, loss=0.8240759372711182, param_norm=1887.110595703125
Step 616: grad_norm=4.782344818115234, loss=0.6963876485824585, param_norm=1887.1107177734375
02:43:58.974 [I] Progress on: 616it/2.00kit rate:8.8s/it remaining:3:23:32 elapsed:1:31:22 postfix:- (3802351:tqdm_logging.py:145)
Step 617: grad_norm=5.645314693450928, loss=0.746853768825531, param_norm=1887.11083984375
Step 618: grad_norm=4.660579204559326, loss=0.6805684566497803, param_norm=1887.1109619140625
02:44:16.564 [I] Progress on: 618it/2.00kit rate:8.8s/it remaining:3:22:53 elapsed:1:31:39 postfix:- (3802351:tqdm_logging.py:145)
Step 619: grad_norm=4.588610649108887, loss=0.7683619260787964, param_norm=1887.1109619140625
Step 620: grad_norm=4.953551769256592, loss=0.5234622955322266, param_norm=1887.1112060546875
02:44:34.163 [I] Progress on: 620it/2.00kit rate:8.8s/it remaining:3:22:30 elapsed:1:31:57 postfix:- (3802351:tqdm_logging.py:145)
Step 621: grad_norm=5.0073394775390625, loss=0.706851601600647, param_norm=1887.111328125
02:44:45.194 [I] Progress on: 621it/2.00kit rate:9.5s/it remaining:3:37:48 elapsed:1:32:08 postfix:- (3802351:tqdm_logging.py:145)
Step 622: grad_norm=3.6708734035491943, loss=0.6038193702697754, param_norm=1887.1114501953125
Step 623: grad_norm=3.7591543197631836, loss=0.6287335157394409, param_norm=1887.111572265625
02:45:02.770 [I] Progress on: 623it/2.00kit rate:9.1s/it remaining:3:29:20 elapsed:1:32:25 postfix:- (3802351:tqdm_logging.py:145)
Step 624: grad_norm=6.197090148925781, loss=0.6176683306694031, param_norm=1887.1116943359375
Step 625: grad_norm=4.435189247131348, loss=0.577261209487915, param_norm=1887.1116943359375
02:45:20.367 [I] Progress on: 625it/2.00kit rate:9.0s/it remaining:3:25:15 elapsed:1:32:43 postfix:- (3802351:tqdm_logging.py:145)
Step 626: grad_norm=3.8274319171905518, loss=0.6097041964530945, param_norm=1887.11181640625
Step 627: grad_norm=4.258520126342773, loss=0.6119909286499023, param_norm=1887.1119384765625
02:45:38.189 [I] Progress on: 627it/2.00kit rate:8.9s/it remaining:3:22:59 elapsed:1:33:01 postfix:- (3802351:tqdm_logging.py:145)
Step 628: grad_norm=3.991989850997925, loss=0.5838689804077148, param_norm=1887.112060546875
Step 629: grad_norm=6.616085052490234, loss=0.6119107604026794, param_norm=1887.112060546875
02:45:55.746 [I] Progress on: 629it/2.00kit rate:8.9s/it remaining:3:22:43 elapsed:1:33:18 postfix:- (3802351:tqdm_logging.py:145)
Step 630: grad_norm=5.317129135131836, loss=0.5551321506500244, param_norm=1887.1121826171875
Step 631: grad_norm=4.437252521514893, loss=0.6354798674583435, param_norm=1887.1123046875
02:46:13.345 [I] Progress on: 631it/2.00kit rate:8.8s/it remaining:3:21:33 elapsed:1:33:36 postfix:- (3802351:tqdm_logging.py:145)
Step 632: grad_norm=4.748897075653076, loss=0.6218876838684082, param_norm=1887.1124267578125
Step 633: grad_norm=7.107388973236084, loss=0.5664214491844177, param_norm=1887.112548828125
02:46:30.944 [I] Progress on: 633it/2.00kit rate:8.8s/it remaining:3:20:46 elapsed:1:33:54 postfix:- (3802351:tqdm_logging.py:145)
Step 634: grad_norm=3.7267560958862305, loss=0.6022615432739258, param_norm=1887.1126708984375
Step 635: grad_norm=5.286778926849365, loss=0.6781575679779053, param_norm=1887.11279296875
02:46:48.546 [I] Progress on: 635it/2.00kit rate:8.8s/it remaining:3:20:25 elapsed:1:34:11 postfix:- (3802351:tqdm_logging.py:145)
Step 636: grad_norm=6.089687824249268, loss=0.588830292224884, param_norm=1887.1129150390625
Step 637: grad_norm=5.525829315185547, loss=0.5371620059013367, param_norm=1887.113037109375
02:47:06.145 [I] Progress on: 637it/2.00kit rate:8.8s/it remaining:3:19:59 elapsed:1:34:29 postfix:- (3802351:tqdm_logging.py:145)
Step 638: grad_norm=7.5428032875061035, loss=0.7841307520866394, param_norm=1887.1131591796875
Step 639: grad_norm=4.803875923156738, loss=0.6696971654891968, param_norm=1887.11328125
02:47:23.778 [I] Progress on: 639it/2.00kit rate:8.8s/it remaining:3:19:48 elapsed:1:34:46 postfix:- (3802351:tqdm_logging.py:145)
Step 640: grad_norm=5.1994709968566895, loss=0.7407383918762207, param_norm=1887.11328125
Step 641: grad_norm=6.371039390563965, loss=0.6979461908340454, param_norm=1887.1134033203125
02:47:41.391 [I] Progress on: 641it/2.00kit rate:8.8s/it remaining:3:19:27 elapsed:1:35:04 postfix:- (3802351:tqdm_logging.py:145)
Step 642: grad_norm=4.892164707183838, loss=0.647864043712616, param_norm=1887.113525390625
Step 643: grad_norm=4.314097881317139, loss=0.6564773321151733, param_norm=1887.1136474609375
02:47:58.983 [I] Progress on: 643it/2.00kit rate:8.8s/it remaining:3:19:03 elapsed:1:35:22 postfix:- (3802351:tqdm_logging.py:145)
Step 644: grad_norm=4.884329319000244, loss=0.6942741870880127, param_norm=1887.11376953125
Step 645: grad_norm=3.9711434841156006, loss=0.5778428316116333, param_norm=1887.1138916015625
02:48:16.582 [I] Progress on: 645it/2.00kit rate:8.8s/it remaining:3:18:41 elapsed:1:35:39 postfix:- (3802351:tqdm_logging.py:145)
Step 646: grad_norm=5.0750041007995605, loss=0.5802867412567139, param_norm=1887.114013671875
Step 647: grad_norm=4.572304725646973, loss=0.5943598747253418, param_norm=1887.114013671875
02:48:34.154 [I] Progress on: 647it/2.00kit rate:8.8s/it remaining:3:18:16 elapsed:1:35:57 postfix:- (3802351:tqdm_logging.py:145)
Step 648: grad_norm=3.3639135360717773, loss=0.5502949357032776, param_norm=1887.1141357421875
Step 649: grad_norm=3.7321455478668213, loss=0.5051953792572021, param_norm=1887.1142578125
02:48:51.779 [I] Progress on: 649it/2.00kit rate:8.8s/it remaining:3:18:11 elapsed:1:36:14 postfix:- (3802351:tqdm_logging.py:145)
Step 650: grad_norm=6.389935493469238, loss=0.6919590830802917, param_norm=1887.1143798828125
Step 651: grad_norm=4.366100788116455, loss=0.6665935516357422, param_norm=1887.114501953125
02:49:09.395 [I] Progress on: 651it/2.00kit rate:8.8s/it remaining:3:17:54 elapsed:1:36:32 postfix:- (3802351:tqdm_logging.py:145)
Step 652: grad_norm=3.875098943710327, loss=0.5938953757286072, param_norm=1887.114501953125
Step 653: grad_norm=5.24675989151001, loss=0.5167275667190552, param_norm=1887.1146240234375
02:49:26.982 [I] Progress on: 653it/2.00kit rate:8.8s/it remaining:3:17:27 elapsed:1:36:50 postfix:- (3802351:tqdm_logging.py:145)
Step 654: grad_norm=6.123846054077148, loss=0.7224259972572327, param_norm=1887.11474609375
Step 655: grad_norm=3.9622769355773926, loss=0.6477872729301453, param_norm=1887.11474609375
02:49:44.582 [I] Progress on: 655it/2.00kit rate:8.8s/it remaining:3:17:07 elapsed:1:37:07 postfix:- (3802351:tqdm_logging.py:145)
Step 656: grad_norm=3.893486976623535, loss=0.5532568693161011, param_norm=1887.1148681640625
Step 657: grad_norm=5.85300350189209, loss=0.5016505122184753, param_norm=1887.114990234375
02:50:02.162 [I] Progress on: 657it/2.00kit rate:8.8s/it remaining:3:16:47 elapsed:1:37:25 postfix:- (3802351:tqdm_logging.py:145)
Step 658: grad_norm=4.59879207611084, loss=0.6916030645370483, param_norm=1887.1151123046875
Step 659: grad_norm=5.661241054534912, loss=0.5777063965797424, param_norm=1887.1151123046875
02:50:19.738 [I] Progress on: 659it/2.00kit rate:8.8s/it remaining:3:16:27 elapsed:1:37:42 postfix:- (3802351:tqdm_logging.py:145)
Step 660: grad_norm=4.166078567504883, loss=0.7043921947479248, param_norm=1887.115234375
Step 661: grad_norm=3.5622782707214355, loss=0.5486718416213989, param_norm=1887.1153564453125
02:50:37.299 [I] Progress on: 661it/2.00kit rate:8.8s/it remaining:3:16:05 elapsed:1:38:00 postfix:- (3802351:tqdm_logging.py:145)
Step 662: grad_norm=4.713273048400879, loss=0.6541539430618286, param_norm=1887.1153564453125
Step 663: grad_norm=4.286576747894287, loss=0.6617072820663452, param_norm=1887.115478515625
02:50:54.903 [I] Progress on: 663it/2.00kit rate:8.8s/it remaining:3:15:52 elapsed:1:38:17 postfix:- (3802351:tqdm_logging.py:145)
Step 664: grad_norm=4.017987251281738, loss=0.5678783655166626, param_norm=1887.1156005859375
Step 665: grad_norm=4.091289520263672, loss=0.5804481506347656, param_norm=1887.1156005859375
02:51:12.586 [I] Progress on: 665it/2.00kit rate:8.8s/it remaining:3:16:10 elapsed:1:38:35 postfix:- (3802351:tqdm_logging.py:145)
Step 666: grad_norm=4.781476020812988, loss=0.6677564382553101, param_norm=1887.1156005859375
Step 667: grad_norm=5.4154558181762695, loss=0.6756750345230103, param_norm=1887.11572265625
02:51:30.204 [I] Progress on: 667it/2.00kit rate:8.8s/it remaining:3:15:44 elapsed:1:38:53 postfix:- (3802351:tqdm_logging.py:145)
Step 668: grad_norm=5.645437717437744, loss=0.6885377168655396, param_norm=1887.1158447265625
Step 669: grad_norm=4.116077423095703, loss=0.5767187476158142, param_norm=1887.115966796875
02:51:47.830 [I] Progress on: 669it/2.00kit rate:8.8s/it remaining:3:15:20 elapsed:1:39:10 postfix:- (3802351:tqdm_logging.py:145)
Step 670: grad_norm=4.756325721740723, loss=0.6807419061660767, param_norm=1887.115966796875
Step 671: grad_norm=6.319974422454834, loss=0.6313023567199707, param_norm=1887.1160888671875
02:52:05.458 [I] Progress on: 671it/2.00kit rate:8.8s/it remaining:3:15:04 elapsed:1:39:28 postfix:- (3802351:tqdm_logging.py:145)
Step 672: grad_norm=4.7492289543151855, loss=0.6432175636291504, param_norm=1887.1162109375
Step 673: grad_norm=4.69147253036499, loss=0.6392015814781189, param_norm=1887.1162109375
02:52:23.100 [I] Progress on: 673it/2.00kit rate:8.8s/it remaining:3:14:57 elapsed:1:39:46 postfix:- (3802351:tqdm_logging.py:145)
Step 674: grad_norm=4.3308563232421875, loss=0.542293906211853, param_norm=1887.1163330078125
Step 675: grad_norm=4.4446258544921875, loss=0.7058130502700806, param_norm=1887.1163330078125
02:52:40.744 [I] Progress on: 675it/2.00kit rate:8.8s/it remaining:3:14:41 elapsed:1:40:03 postfix:- (3802351:tqdm_logging.py:145)
Step 676: grad_norm=4.103795528411865, loss=0.5929128527641296, param_norm=1887.116455078125
Step 677: grad_norm=5.85885763168335, loss=0.5572788119316101, param_norm=1887.1165771484375
02:52:58.345 [I] Progress on: 677it/2.00kit rate:8.8s/it remaining:3:14:08 elapsed:1:40:21 postfix:- (3802351:tqdm_logging.py:145)
Step 678: grad_norm=4.186570644378662, loss=0.6712484359741211, param_norm=1887.11669921875
Step 679: grad_norm=7.085056304931641, loss=0.5770903825759888, param_norm=1887.11669921875
02:53:15.902 [I] Progress on: 679it/2.00kit rate:8.8s/it remaining:3:13:29 elapsed:1:40:38 postfix:- (3802351:tqdm_logging.py:145)
Step 680: grad_norm=9.81803035736084, loss=0.5864568948745728, param_norm=1887.1168212890625
Step 681: grad_norm=5.828959941864014, loss=0.6269285082817078, param_norm=1887.1168212890625
02:53:33.556 [I] Progress on: 681it/2.00kit rate:8.8s/it remaining:3:13:37 elapsed:1:40:56 postfix:- (3802351:tqdm_logging.py:145)
Step 682: grad_norm=4.443506717681885, loss=0.6168293952941895, param_norm=1887.116943359375
Step 683: grad_norm=7.099562168121338, loss=0.5971003770828247, param_norm=1887.116943359375
02:53:51.190 [I] Progress on: 683it/2.00kit rate:8.8s/it remaining:3:13:26 elapsed:1:41:14 postfix:- (3802351:tqdm_logging.py:145)
Step 684: grad_norm=3.633347511291504, loss=0.547640323638916, param_norm=1887.116943359375
Step 685: grad_norm=6.446547508239746, loss=0.5871905088424683, param_norm=1887.1170654296875
02:54:08.876 [I] Progress on: 685it/2.00kit rate:8.8s/it remaining:3:13:31 elapsed:1:41:31 postfix:- (3802351:tqdm_logging.py:145)
Step 686: grad_norm=5.377883434295654, loss=0.6663429737091064, param_norm=1887.1170654296875
Step 687: grad_norm=4.01283073425293, loss=0.6742498874664307, param_norm=1887.1171875
02:54:26.532 [I] Progress on: 687it/2.00kit rate:8.8s/it remaining:3:13:09 elapsed:1:41:49 postfix:- (3802351:tqdm_logging.py:145)
Step 688: grad_norm=4.59018611907959, loss=0.7187402248382568, param_norm=1887.1171875
Step 689: grad_norm=5.00424337387085, loss=0.5205860137939453, param_norm=1887.117431640625
02:54:44.146 [I] Progress on: 689it/2.00kit rate:8.8s/it remaining:3:12:38 elapsed:1:42:07 postfix:- (3802351:tqdm_logging.py:145)
Step 690: grad_norm=4.361682415008545, loss=0.5445610284805298, param_norm=1887.117431640625
02:54:55.353 [I] Progress on: 690it/2.00kit rate:9.5s/it remaining:3:28:10 elapsed:1:42:18 postfix:- (3802351:tqdm_logging.py:145)
Step 691: grad_norm=3.1114377975463867, loss=0.565506100654602, param_norm=1887.117431640625
Step 692: grad_norm=4.182460308074951, loss=0.5596681833267212, param_norm=1887.1175537109375
02:55:12.945 [I] Progress on: 692it/2.00kit rate:9.2s/it remaining:3:19:41 elapsed:1:42:36 postfix:- (3802351:tqdm_logging.py:145)
Step 693: grad_norm=3.5349907875061035, loss=0.5708968639373779, param_norm=1887.11767578125
Step 694: grad_norm=3.2722132205963135, loss=0.5292483568191528, param_norm=1887.11767578125
02:55:30.509 [I] Progress on: 694it/2.00kit rate:9.0s/it remaining:3:15:07 elapsed:1:42:53 postfix:- (3802351:tqdm_logging.py:145)
Step 695: grad_norm=3.19506573677063, loss=0.4599487781524658, param_norm=1887.1177978515625
Step 696: grad_norm=4.168755531311035, loss=0.5456718802452087, param_norm=1887.117919921875
02:55:48.114 [I] Progress on: 696it/2.00kit rate:8.9s/it remaining:3:13:03 elapsed:1:43:11 postfix:- (3802351:tqdm_logging.py:145)
Step 697: grad_norm=5.823326587677002, loss=0.530570387840271, param_norm=1887.117919921875
Step 698: grad_norm=4.370254039764404, loss=0.5699658989906311, param_norm=1887.1180419921875
02:56:05.777 [I] Progress on: 698it/2.00kit rate:8.9s/it remaining:3:12:10 elapsed:1:43:28 postfix:- (3802351:tqdm_logging.py:145)
Step 699: grad_norm=3.6007204055786133, loss=0.5205318331718445, param_norm=1887.1181640625
Step 700: grad_norm=3.194495677947998, loss=0.4530610740184784, param_norm=1887.1181640625
02:56:23.468 [I] Progress on: 700it/2.00kit rate:8.9s/it remaining:3:11:46 elapsed:1:43:46 postfix:- (3802351:tqdm_logging.py:145)
02:56:23.660 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
02:56:23.661 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
02:56:23.661 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=600. (3802351:checkpoint_manager.py:1786)
02:56:23.661 [I] [process=0][thread=MainThread][step=600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=600, also errors if any. (3802351:checkpoint_manager.py:1817)
02:56:23.661 [I] [process=0] Saving checkpoint at step 700                                        (3802351:checkpoint_manager.py:1286)
02:56:23.662 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700. (3802351:async_checkpointer.py:358)
02:56:23.664 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:56:23.665 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18 (3802351:atomicity.py:144)
02:56:23.666 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:56:23.666 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
02:56:23.668 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 (3802351:atomicity.py:144)
02:56:23.668 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 (3802351:atomicity.py:144)
02:56:23.670 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
02:56:23.675 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
02:56:27.626 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:56:27.628 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
02:56:27.632 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
02:56:27.633 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
02:56:27.667 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:56:27.668 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:56:27.670 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:56:27.671 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:56:27.672 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:56:27.673 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
02:56:27.681 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
02:56:27.682 [I] [process=0][thread=MainThread][step=700] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
02:56:27.684 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
02:56:27.685 [I] {'step': 700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742799383.6606715, 'wait_for_prev_duration_secs': 0.0008394718170166016, 'checkpointer_blocking_start_time': 1742799383.6621144, 'checkpointer_blocking_duration_secs': 4.005480051040649, 'get_old_steps_start_time': 1742799387.667655, 'get_old_steps_duration_secs': 0.013931989669799805, 'checkpoint_manager_blocking_start_time': 1742799383.6604824, 'checkpoint_manager_blocking_duration_secs': 4.02480149269104} (3802351:standard_logger.py:34)
02:56:34.921 [I] ChainedFuture completed 1/1 futures in 7.29 seconds.                             (3802351:future.py:137)
02:56:34.922 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 920.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
02:56:34.922 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
02:56:34.923 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18 (3802351:async_checkpointer.py:406)
02:56:34.924 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18/assets.orbax-checkpoint-tmp-19 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18/assets (3802351:atomicity.py:287)
02:56:34.936 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18/params.orbax-checkpoint-tmp-20 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18/params (3802351:atomicity.py:287)
02:56:34.936 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700 (3802351:async_checkpointer.py:416)
02:56:34.937 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18 (3802351:async_checkpointer.py:426)
02:56:34.937 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700.orbax-checkpoint-tmp-18 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700 (3802351:atomicity.py:287)
02:56:34.939 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/700`. (3802351:atomicity.py:548)
02:56:34.939 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
02:56:34.939 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
02:56:34.940 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
02:56:34.940 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
02:56:34.940 [I] [process=0][thread=save_finalize][step=700] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 701: grad_norm=3.8222579956054688, loss=0.5397449731826782, param_norm=1887.1182861328125
02:56:36.280 [I] Progress on: 701it/2.00kit rate:10.0s/it remaining:3:37:30 elapsed:1:43:59 postfix:- (3802351:tqdm_logging.py:145)
Step 702: grad_norm=4.720900058746338, loss=0.595080554485321, param_norm=1887.118408203125
Step 703: grad_norm=3.8598742485046387, loss=0.5140872597694397, param_norm=1887.1185302734375
02:56:53.854 [I] Progress on: 703it/2.00kit rate:9.4s/it remaining:3:23:14 elapsed:1:44:16 postfix:- (3802351:tqdm_logging.py:145)
Step 704: grad_norm=4.689585208892822, loss=0.6408271789550781, param_norm=1887.1185302734375
Step 705: grad_norm=3.6278231143951416, loss=0.49932926893234253, param_norm=1887.1185302734375
02:57:11.458 [I] Progress on: 705it/2.00kit rate:9.1s/it remaining:3:16:17 elapsed:1:44:34 postfix:- (3802351:tqdm_logging.py:145)
Step 706: grad_norm=4.550610065460205, loss=0.6128025054931641, param_norm=1887.11865234375
Step 707: grad_norm=4.8703460693359375, loss=0.6186603903770447, param_norm=1887.11865234375
02:57:29.091 [I] Progress on: 707it/2.00kit rate:8.9s/it remaining:3:12:51 elapsed:1:44:52 postfix:- (3802351:tqdm_logging.py:145)
Step 708: grad_norm=4.303867816925049, loss=0.5400326251983643, param_norm=1887.1187744140625
Step 709: grad_norm=5.515620708465576, loss=0.6020381450653076, param_norm=1887.118896484375
02:57:46.725 [I] Progress on: 709it/2.00kit rate:8.9s/it remaining:3:11:00 elapsed:1:45:09 postfix:- (3802351:tqdm_logging.py:145)
Step 710: grad_norm=4.764654636383057, loss=0.6258269548416138, param_norm=1887.1190185546875
Step 711: grad_norm=3.692239761352539, loss=0.5440384149551392, param_norm=1887.1190185546875
02:58:04.355 [I] Progress on: 711it/2.00kit rate:8.8s/it remaining:3:10:02 elapsed:1:45:27 postfix:- (3802351:tqdm_logging.py:145)
Step 712: grad_norm=4.10337495803833, loss=0.569791316986084, param_norm=1887.119140625
Step 713: grad_norm=4.193880081176758, loss=0.5833041667938232, param_norm=1887.119140625
02:58:22.043 [I] Progress on: 713it/2.00kit rate:8.8s/it remaining:3:09:33 elapsed:1:45:45 postfix:- (3802351:tqdm_logging.py:145)
Step 714: grad_norm=4.576001167297363, loss=0.5472819805145264, param_norm=1887.119140625
Step 715: grad_norm=4.3082966804504395, loss=0.5223920941352844, param_norm=1887.1192626953125
02:58:39.655 [I] Progress on: 715it/2.00kit rate:8.8s/it remaining:3:09:00 elapsed:1:46:02 postfix:- (3802351:tqdm_logging.py:145)
Step 716: grad_norm=3.864426374435425, loss=0.5089682340621948, param_norm=1887.119384765625
Step 717: grad_norm=3.071645975112915, loss=0.4711691737174988, param_norm=1887.119384765625
02:58:57.266 [I] Progress on: 717it/2.00kit rate:8.8s/it remaining:3:08:25 elapsed:1:46:20 postfix:- (3802351:tqdm_logging.py:145)
Step 718: grad_norm=3.8150475025177, loss=0.49174267053604126, param_norm=1887.1195068359375
Step 719: grad_norm=4.598222255706787, loss=0.5733384490013123, param_norm=1887.1195068359375
02:59:15.192 [I] Progress on: 719it/2.00kit rate:8.9s/it remaining:3:09:29 elapsed:1:46:38 postfix:- (3802351:tqdm_logging.py:145)
Step 720: grad_norm=4.390807628631592, loss=0.5017051100730896, param_norm=1887.11962890625
Step 721: grad_norm=4.5051984786987305, loss=0.6035345196723938, param_norm=1887.11962890625
02:59:32.766 [I] Progress on: 721it/2.00kit rate:8.8s/it remaining:3:08:09 elapsed:1:46:55 postfix:- (3802351:tqdm_logging.py:145)
Step 722: grad_norm=3.9063873291015625, loss=0.6026016473770142, param_norm=1887.1197509765625
Step 723: grad_norm=4.062833786010742, loss=0.5523009300231934, param_norm=1887.1197509765625
02:59:50.419 [I] Progress on: 723it/2.00kit rate:8.8s/it remaining:3:07:50 elapsed:1:47:13 postfix:- (3802351:tqdm_logging.py:145)
Step 724: grad_norm=3.882497549057007, loss=0.5647295713424683, param_norm=1887.119873046875
Step 725: grad_norm=3.9797255992889404, loss=0.39890024065971375, param_norm=1887.119873046875
03:00:08.027 [I] Progress on: 725it/2.00kit rate:8.8s/it remaining:3:07:16 elapsed:1:47:31 postfix:- (3802351:tqdm_logging.py:145)
Step 726: grad_norm=4.6916823387146, loss=0.589952290058136, param_norm=1887.1199951171875
Step 727: grad_norm=6.194736003875732, loss=0.5524392127990723, param_norm=1887.1199951171875
03:00:25.629 [I] Progress on: 727it/2.00kit rate:8.8s/it remaining:3:06:49 elapsed:1:47:48 postfix:- (3802351:tqdm_logging.py:145)
Step 728: grad_norm=3.956702709197998, loss=0.5423781871795654, param_norm=1887.1199951171875
Step 729: grad_norm=4.449923515319824, loss=0.567955732345581, param_norm=1887.1199951171875
03:00:43.213 [I] Progress on: 729it/2.00kit rate:8.8s/it remaining:3:06:22 elapsed:1:48:06 postfix:- (3802351:tqdm_logging.py:145)
Step 730: grad_norm=3.571873903274536, loss=0.49161267280578613, param_norm=1887.1201171875
Step 731: grad_norm=4.25572395324707, loss=0.4966835379600525, param_norm=1887.1201171875
03:01:00.820 [I] Progress on: 731it/2.00kit rate:8.8s/it remaining:3:06:13 elapsed:1:48:23 postfix:- (3802351:tqdm_logging.py:145)
Step 732: grad_norm=6.671046257019043, loss=0.5958952903747559, param_norm=1887.1202392578125
Step 733: grad_norm=4.245402812957764, loss=0.6229532957077026, param_norm=1887.1202392578125
03:01:18.536 [I] Progress on: 733it/2.00kit rate:8.8s/it remaining:3:06:26 elapsed:1:48:41 postfix:- (3802351:tqdm_logging.py:145)
Step 734: grad_norm=5.3605451583862305, loss=0.605442225933075, param_norm=1887.1202392578125
Step 735: grad_norm=4.522486686706543, loss=0.6178715229034424, param_norm=1887.120361328125
03:01:36.165 [I] Progress on: 735it/2.00kit rate:8.8s/it remaining:3:05:53 elapsed:1:48:59 postfix:- (3802351:tqdm_logging.py:145)
Step 736: grad_norm=3.6805076599121094, loss=0.4441646635532379, param_norm=1887.120361328125
Step 737: grad_norm=3.075425386428833, loss=0.43891650438308716, param_norm=1887.120361328125
03:01:53.785 [I] Progress on: 737it/2.00kit rate:8.8s/it remaining:3:05:32 elapsed:1:49:16 postfix:- (3802351:tqdm_logging.py:145)
Step 738: grad_norm=3.5691628456115723, loss=0.4658907651901245, param_norm=1887.120361328125
Step 739: grad_norm=4.580188274383545, loss=0.509763777256012, param_norm=1887.1204833984375
03:02:11.387 [I] Progress on: 739it/2.00kit rate:8.8s/it remaining:3:05:09 elapsed:1:49:34 postfix:- (3802351:tqdm_logging.py:145)
Step 740: grad_norm=3.5636563301086426, loss=0.4532489776611328, param_norm=1887.12060546875
Step 741: grad_norm=3.226705312728882, loss=0.43480998277664185, param_norm=1887.12060546875
03:02:28.987 [I] Progress on: 741it/2.00kit rate:8.8s/it remaining:3:04:44 elapsed:1:49:52 postfix:- (3802351:tqdm_logging.py:145)
Step 742: grad_norm=6.755836486816406, loss=0.4942939877510071, param_norm=1887.1207275390625
Step 743: grad_norm=6.867288112640381, loss=0.5398345589637756, param_norm=1887.1207275390625
03:02:46.590 [I] Progress on: 743it/2.00kit rate:8.8s/it remaining:3:04:22 elapsed:1:50:09 postfix:- (3802351:tqdm_logging.py:145)
Step 744: grad_norm=4.49464225769043, loss=0.4602997601032257, param_norm=1887.1207275390625
Step 745: grad_norm=6.179898738861084, loss=0.5278998017311096, param_norm=1887.120849609375
03:03:04.241 [I] Progress on: 745it/2.00kit rate:8.8s/it remaining:3:04:20 elapsed:1:50:27 postfix:- (3802351:tqdm_logging.py:145)
Step 746: grad_norm=4.136406898498535, loss=0.5024402141571045, param_norm=1887.120849609375
Step 747: grad_norm=6.158783435821533, loss=0.5042071342468262, param_norm=1887.120849609375
03:03:21.842 [I] Progress on: 747it/2.00kit rate:8.8s/it remaining:3:03:55 elapsed:1:50:44 postfix:- (3802351:tqdm_logging.py:145)
Step 748: grad_norm=3.894101142883301, loss=0.4131242632865906, param_norm=1887.1209716796875
Step 749: grad_norm=2.940495491027832, loss=0.3678148686885834, param_norm=1887.1209716796875
03:03:39.468 [I] Progress on: 749it/2.00kit rate:8.8s/it remaining:3:03:40 elapsed:1:51:02 postfix:- (3802351:tqdm_logging.py:145)
Step 750: grad_norm=3.778921604156494, loss=0.4977263808250427, param_norm=1887.1209716796875
Step 751: grad_norm=4.222388744354248, loss=0.5862599611282349, param_norm=1887.1209716796875
03:03:57.127 [I] Progress on: 751it/2.00kit rate:8.8s/it remaining:3:03:34 elapsed:1:51:20 postfix:- (3802351:tqdm_logging.py:145)
Step 752: grad_norm=4.889084815979004, loss=0.541516125202179, param_norm=1887.12109375
Step 753: grad_norm=4.749881267547607, loss=0.5866296291351318, param_norm=1887.12109375
03:04:14.775 [I] Progress on: 753it/2.00kit rate:8.8s/it remaining:3:03:23 elapsed:1:51:37 postfix:- (3802351:tqdm_logging.py:145)
Step 754: grad_norm=4.410953044891357, loss=0.4690873920917511, param_norm=1887.1212158203125
Step 755: grad_norm=5.87523078918457, loss=0.4879884719848633, param_norm=1887.1212158203125
03:04:32.401 [I] Progress on: 755it/2.00kit rate:8.8s/it remaining:3:03:01 elapsed:1:51:55 postfix:- (3802351:tqdm_logging.py:145)
Step 756: grad_norm=4.5737104415893555, loss=0.591721773147583, param_norm=1887.121337890625
Step 757: grad_norm=3.816284656524658, loss=0.6192471981048584, param_norm=1887.121337890625
03:04:49.982 [I] Progress on: 757it/2.00kit rate:8.8s/it remaining:3:02:23 elapsed:1:52:13 postfix:- (3802351:tqdm_logging.py:145)
Step 758: grad_norm=4.285984039306641, loss=0.4863789975643158, param_norm=1887.121337890625
03:05:01.256 [I] Progress on: 759it/2.00kit rate:9.5s/it remaining:3:16:10 elapsed:1:52:24 postfix:- (3802351:tqdm_logging.py:145)
Step 759: grad_norm=3.012331962585449, loss=0.34547755122184753, param_norm=1887.1214599609375
Step 760: grad_norm=2.9095396995544434, loss=0.4279925227165222, param_norm=1887.1214599609375
03:05:18.684 [I] Progress on: 760it/2.00kit rate:9.3s/it remaining:3:11:55 elapsed:1:52:41 postfix:- (3802351:tqdm_logging.py:145)
Step 761: grad_norm=5.63010311126709, loss=0.5043999552726746, param_norm=1887.12158203125
Step 762: grad_norm=5.908699035644531, loss=0.4587591886520386, param_norm=1887.12158203125
03:05:36.275 [I] Progress on: 762it/2.00kit rate:9.0s/it remaining:3:06:28 elapsed:1:52:59 postfix:- (3802351:tqdm_logging.py:145)
Step 763: grad_norm=3.615628957748413, loss=0.5039061307907104, param_norm=1887.12158203125
Step 764: grad_norm=6.484828948974609, loss=0.471134752035141, param_norm=1887.12158203125
03:05:53.880 [I] Progress on: 764it/2.00kit rate:8.9s/it remaining:3:03:40 elapsed:1:53:16 postfix:- (3802351:tqdm_logging.py:145)
Step 765: grad_norm=4.878437042236328, loss=0.4516112208366394, param_norm=1887.1217041015625
Step 766: grad_norm=3.8660335540771484, loss=0.42615950107574463, param_norm=1887.121826171875
03:06:11.476 [I] Progress on: 766it/2.00kit rate:8.9s/it remaining:3:02:08 elapsed:1:53:34 postfix:- (3802351:tqdm_logging.py:145)
Step 767: grad_norm=3.372830867767334, loss=0.39152926206588745, param_norm=1887.121826171875
Step 768: grad_norm=3.414625644683838, loss=0.4445236921310425, param_norm=1887.121826171875
03:06:29.126 [I] Progress on: 768it/2.00kit rate:8.8s/it remaining:3:01:29 elapsed:1:53:52 postfix:- (3802351:tqdm_logging.py:145)
Step 769: grad_norm=2.8514411449432373, loss=0.40540969371795654, param_norm=1887.121826171875
Step 770: grad_norm=4.924534320831299, loss=0.52303147315979, param_norm=1887.1220703125
03:06:46.789 [I] Progress on: 770it/2.00kit rate:8.8s/it remaining:3:01:09 elapsed:1:54:09 postfix:- (3802351:tqdm_logging.py:145)
Step 771: grad_norm=4.421113014221191, loss=0.4522685408592224, param_norm=1887.1220703125
Step 772: grad_norm=3.5756547451019287, loss=0.38841164112091064, param_norm=1887.1221923828125
03:07:04.364 [I] Progress on: 772it/2.00kit rate:8.8s/it remaining:3:00:23 elapsed:1:54:27 postfix:- (3802351:tqdm_logging.py:145)
Step 773: grad_norm=3.6795623302459717, loss=0.510320246219635, param_norm=1887.1221923828125
Step 774: grad_norm=5.072115898132324, loss=0.4835108518600464, param_norm=1887.1221923828125
03:07:21.926 [I] Progress on: 774it/2.00kit rate:8.8s/it remaining:2:59:47 elapsed:1:54:44 postfix:- (3802351:tqdm_logging.py:145)
Step 775: grad_norm=3.6209137439727783, loss=0.4241219758987427, param_norm=1887.122314453125
Step 776: grad_norm=3.363320827484131, loss=0.3772926330566406, param_norm=1887.122314453125
03:07:39.539 [I] Progress on: 776it/2.00kit rate:8.8s/it remaining:2:59:32 elapsed:1:55:02 postfix:- (3802351:tqdm_logging.py:145)
Step 777: grad_norm=3.947296142578125, loss=0.5069438219070435, param_norm=1887.122314453125
Step 778: grad_norm=2.9107041358947754, loss=0.43111497163772583, param_norm=1887.1224365234375
03:07:57.195 [I] Progress on: 778it/2.00kit rate:8.8s/it remaining:2:59:30 elapsed:1:55:20 postfix:- (3802351:tqdm_logging.py:145)
Step 779: grad_norm=3.82371187210083, loss=0.4450569748878479, param_norm=1887.1224365234375
Step 780: grad_norm=3.5134527683258057, loss=0.4819539785385132, param_norm=1887.1224365234375
03:08:14.805 [I] Progress on: 780it/2.00kit rate:8.8s/it remaining:2:59:10 elapsed:1:55:37 postfix:- (3802351:tqdm_logging.py:145)
Step 781: grad_norm=3.382596015930176, loss=0.41367271542549133, param_norm=1887.1224365234375
Step 782: grad_norm=4.268515586853027, loss=0.4476933181285858, param_norm=1887.12255859375
03:08:32.442 [I] Progress on: 782it/2.00kit rate:8.8s/it remaining:2:58:57 elapsed:1:55:55 postfix:- (3802351:tqdm_logging.py:145)
Step 783: grad_norm=3.271333932876587, loss=0.37671971321105957, param_norm=1887.12255859375
Step 784: grad_norm=3.8269166946411133, loss=0.4953432083129883, param_norm=1887.1226806640625
03:08:50.098 [I] Progress on: 784it/2.00kit rate:8.8s/it remaining:2:58:49 elapsed:1:56:13 postfix:- (3802351:tqdm_logging.py:145)
Step 785: grad_norm=3.21911883354187, loss=0.4819803833961487, param_norm=1887.1226806640625
Step 786: grad_norm=4.118764400482178, loss=0.49651038646698, param_norm=1887.1226806640625
03:09:07.687 [I] Progress on: 786it/2.00kit rate:8.8s/it remaining:2:58:13 elapsed:1:56:30 postfix:- (3802351:tqdm_logging.py:145)
Step 787: grad_norm=4.134882926940918, loss=0.5231963992118835, param_norm=1887.1226806640625
Step 788: grad_norm=2.8313040733337402, loss=0.42896366119384766, param_norm=1887.122802734375
03:09:25.322 [I] Progress on: 788it/2.00kit rate:8.8s/it remaining:2:58:02 elapsed:1:56:48 postfix:- (3802351:tqdm_logging.py:145)
Step 789: grad_norm=3.465108633041382, loss=0.48120880126953125, param_norm=1887.122802734375
Step 790: grad_norm=3.1734437942504883, loss=0.4225309491157532, param_norm=1887.1229248046875
03:09:42.902 [I] Progress on: 790it/2.00kit rate:8.8s/it remaining:2:57:29 elapsed:1:57:05 postfix:- (3802351:tqdm_logging.py:145)
Step 791: grad_norm=3.832491159439087, loss=0.4568532705307007, param_norm=1887.1229248046875
Step 792: grad_norm=3.896991491317749, loss=0.5197560787200928, param_norm=1887.1229248046875
03:10:00.536 [I] Progress on: 792it/2.00kit rate:8.8s/it remaining:2:57:26 elapsed:1:57:23 postfix:- (3802351:tqdm_logging.py:145)
Step 793: grad_norm=2.837796211242676, loss=0.37622302770614624, param_norm=1887.123046875
Step 794: grad_norm=3.2305874824523926, loss=0.4607994556427002, param_norm=1887.123046875
03:10:18.195 [I] Progress on: 794it/2.00kit rate:8.8s/it remaining:2:57:19 elapsed:1:57:41 postfix:- (3802351:tqdm_logging.py:145)
Step 795: grad_norm=4.741545677185059, loss=0.4196266531944275, param_norm=1887.123046875
Step 796: grad_norm=4.2715744972229, loss=0.5334812998771667, param_norm=1887.123046875
03:10:35.847 [I] Progress on: 796it/2.00kit rate:8.8s/it remaining:2:57:05 elapsed:1:57:58 postfix:- (3802351:tqdm_logging.py:145)
Step 797: grad_norm=3.2714216709136963, loss=0.44929131865501404, param_norm=1887.1231689453125
Step 798: grad_norm=2.83817195892334, loss=0.38458263874053955, param_norm=1887.1231689453125
03:10:53.470 [I] Progress on: 798it/2.00kit rate:8.8s/it remaining:2:56:47 elapsed:1:58:16 postfix:- (3802351:tqdm_logging.py:145)
Step 799: grad_norm=3.6986520290374756, loss=0.4290790259838104, param_norm=1887.1231689453125
Step 800: grad_norm=3.284241199493408, loss=0.40760689973831177, param_norm=1887.123291015625
03:11:11.067 [I] Progress on: 800it/2.00kit rate:8.8s/it remaining:2:56:14 elapsed:1:58:34 postfix:- (3802351:tqdm_logging.py:145)
03:11:11.263 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
03:11:11.263 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
03:11:11.263 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=700. (3802351:checkpoint_manager.py:1786)
03:11:11.263 [I] [process=0][thread=MainThread][step=700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=700, also errors if any. (3802351:checkpoint_manager.py:1817)
03:11:11.264 [I] [process=0] Saving checkpoint at step 800                                        (3802351:checkpoint_manager.py:1286)
03:11:11.264 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800. (3802351:async_checkpointer.py:358)
03:11:11.266 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:11:11.266 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21 (3802351:atomicity.py:144)
03:11:11.267 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:11:11.268 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:11:11.269 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 (3802351:atomicity.py:144)
03:11:11.269 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 (3802351:atomicity.py:144)
03:11:11.270 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:11:11.274 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
03:11:15.098 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
03:11:15.099 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
03:11:15.102 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:11:15.115 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
03:11:15.130 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.130 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.132 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.133 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.144 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.145 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.146 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:11:15.147 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
03:11:15.148 [I] [process=0][thread=MainThread][step=800] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
03:11:15.154 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
03:11:15.155 [I] {'step': 800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742800271.263076, 'wait_for_prev_duration_secs': 0.0007250308990478516, 'checkpointer_blocking_start_time': 1742800271.264364, 'checkpointer_blocking_duration_secs': 3.8655219078063965, 'get_old_steps_start_time': 1742800275.1299489, 'get_old_steps_duration_secs': 0.017328262329101562, 'checkpoint_manager_blocking_start_time': 1742800271.262897, 'checkpoint_manager_blocking_duration_secs': 3.892760992050171} (3802351:standard_logger.py:34)
03:11:22.178 [I] ChainedFuture completed 1/1 futures in 7.06 seconds.                             (3802351:future.py:137)
03:11:22.179 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 949.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 10 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:11:22.179 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
03:11:22.181 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21 (3802351:async_checkpointer.py:406)
03:11:22.181 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21/assets.orbax-checkpoint-tmp-22 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21/assets (3802351:atomicity.py:287)
03:11:22.191 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21/params.orbax-checkpoint-tmp-23 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21/params (3802351:atomicity.py:287)
03:11:22.192 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800 (3802351:async_checkpointer.py:416)
03:11:22.192 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21 (3802351:async_checkpointer.py:426)
03:11:22.192 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800.orbax-checkpoint-tmp-21 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800 (3802351:atomicity.py:287)
03:11:22.194 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/800`. (3802351:atomicity.py:548)
03:11:22.194 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
03:11:22.195 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
03:11:22.195 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
03:11:22.195 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
03:11:22.196 [I] [process=0][thread=save_finalize][step=800] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 801: grad_norm=3.960087299346924, loss=0.5157920122146606, param_norm=1887.123291015625
03:11:23.753 [I] Progress on: 801it/2.00kit rate:10.0s/it remaining:3:19:25 elapsed:1:58:46 postfix:- (3802351:tqdm_logging.py:145)
Step 802: grad_norm=3.4558908939361572, loss=0.48897647857666016, param_norm=1887.123291015625
Step 803: grad_norm=3.1353089809417725, loss=0.48378315567970276, param_norm=1887.123291015625
03:11:41.283 [I] Progress on: 803it/2.00kit rate:9.4s/it remaining:3:06:38 elapsed:1:59:04 postfix:- (3802351:tqdm_logging.py:145)
Step 804: grad_norm=3.5851974487304688, loss=0.47941988706588745, param_norm=1887.123291015625
Step 805: grad_norm=3.8996870517730713, loss=0.42680811882019043, param_norm=1887.1234130859375
03:11:58.900 [I] Progress on: 805it/2.00kit rate:9.1s/it remaining:3:00:43 elapsed:1:59:21 postfix:- (3802351:tqdm_logging.py:145)
Step 806: grad_norm=3.2837934494018555, loss=0.505445122718811, param_norm=1887.1234130859375
Step 807: grad_norm=3.173621892929077, loss=0.4210624098777771, param_norm=1887.1234130859375
03:12:16.494 [I] Progress on: 807it/2.00kit rate:8.9s/it remaining:2:57:35 elapsed:1:59:39 postfix:- (3802351:tqdm_logging.py:145)
Step 808: grad_norm=3.899756669998169, loss=0.5466747879981995, param_norm=1887.1234130859375
Step 809: grad_norm=3.9938418865203857, loss=0.48347166180610657, param_norm=1887.12353515625
03:12:34.132 [I] Progress on: 809it/2.00kit rate:8.9s/it remaining:2:56:09 elapsed:1:59:57 postfix:- (3802351:tqdm_logging.py:145)
Step 810: grad_norm=3.720125436782837, loss=0.43638303875923157, param_norm=1887.1236572265625
Step 811: grad_norm=4.5572733879089355, loss=0.4453198313713074, param_norm=1887.1236572265625
03:12:51.771 [I] Progress on: 811it/2.00kit rate:8.8s/it remaining:2:55:16 elapsed:2:00:14 postfix:- (3802351:tqdm_logging.py:145)
Step 812: grad_norm=4.082080364227295, loss=0.4622595012187958, param_norm=1887.1236572265625
Step 813: grad_norm=4.122989654541016, loss=0.5773267149925232, param_norm=1887.123779296875
03:13:09.398 [I] Progress on: 813it/2.00kit rate:8.8s/it remaining:2:54:39 elapsed:2:00:32 postfix:- (3802351:tqdm_logging.py:145)
Step 814: grad_norm=2.852349042892456, loss=0.38959065079689026, param_norm=1887.123779296875
Step 815: grad_norm=3.7566120624542236, loss=0.5244777202606201, param_norm=1887.123779296875
03:13:26.974 [I] Progress on: 815it/2.00kit rate:8.8s/it remaining:2:53:53 elapsed:2:00:50 postfix:- (3802351:tqdm_logging.py:145)
Step 816: grad_norm=3.211641311645508, loss=0.4555259048938751, param_norm=1887.1239013671875
Step 817: grad_norm=3.7383463382720947, loss=0.508535623550415, param_norm=1887.1239013671875
03:13:44.572 [I] Progress on: 817it/2.00kit rate:8.8s/it remaining:2:53:32 elapsed:2:01:07 postfix:- (3802351:tqdm_logging.py:145)
Step 818: grad_norm=3.1521871089935303, loss=0.4708482027053833, param_norm=1887.1239013671875
Step 819: grad_norm=3.322727680206299, loss=0.34978950023651123, param_norm=1887.1239013671875
03:14:02.146 [I] Progress on: 819it/2.00kit rate:8.8s/it remaining:2:53:06 elapsed:2:01:25 postfix:- (3802351:tqdm_logging.py:145)
Step 820: grad_norm=3.1074378490448, loss=0.40928056836128235, param_norm=1887.1240234375
Step 821: grad_norm=3.9273271560668945, loss=0.5098258256912231, param_norm=1887.1240234375
03:14:19.764 [I] Progress on: 821it/2.00kit rate:8.8s/it remaining:2:52:57 elapsed:2:01:42 postfix:- (3802351:tqdm_logging.py:145)
Step 822: grad_norm=3.129701614379883, loss=0.45016205310821533, param_norm=1887.1240234375
Step 823: grad_norm=3.4153103828430176, loss=0.4730396270751953, param_norm=1887.1240234375
03:14:37.352 [I] Progress on: 823it/2.00kit rate:8.8s/it remaining:2:52:32 elapsed:2:02:00 postfix:- (3802351:tqdm_logging.py:145)
Step 824: grad_norm=3.83772349357605, loss=0.5487079620361328, param_norm=1887.1241455078125
Step 825: grad_norm=3.2861485481262207, loss=0.4226676821708679, param_norm=1887.1240234375
03:14:54.951 [I] Progress on: 825it/2.00kit rate:8.8s/it remaining:2:52:16 elapsed:2:02:18 postfix:- (3802351:tqdm_logging.py:145)
Step 826: grad_norm=3.9167370796203613, loss=0.5281462073326111, param_norm=1887.1241455078125
Step 827: grad_norm=3.6258456707000732, loss=0.5113784074783325, param_norm=1887.1241455078125
03:15:12.559 [I] Progress on: 827it/2.00kit rate:8.8s/it remaining:2:52:02 elapsed:2:02:35 postfix:- (3802351:tqdm_logging.py:145)
Step 828: grad_norm=2.665228843688965, loss=0.3750765323638916, param_norm=1887.1241455078125
03:15:23.622 [I] Progress on: 828it/2.00kit rate:9.5s/it remaining:3:05:11 elapsed:2:02:46 postfix:- (3802351:tqdm_logging.py:145)
Step 829: grad_norm=3.5454955101013184, loss=0.4434592127799988, param_norm=1887.1241455078125
Step 830: grad_norm=2.465355157852173, loss=0.3907618522644043, param_norm=1887.1241455078125
03:15:41.234 [I] Progress on: 830it/2.00kit rate:9.1s/it remaining:2:58:15 elapsed:2:03:04 postfix:- (3802351:tqdm_logging.py:145)
Step 831: grad_norm=3.474595546722412, loss=0.46219658851623535, param_norm=1887.1241455078125
Step 832: grad_norm=3.145293712615967, loss=0.44112443923950195, param_norm=1887.1241455078125
03:15:58.860 [I] Progress on: 832it/2.00kit rate:9.0s/it remaining:2:54:48 elapsed:2:03:21 postfix:- (3802351:tqdm_logging.py:145)
Step 833: grad_norm=2.6321074962615967, loss=0.3688884675502777, param_norm=1887.1241455078125
Step 834: grad_norm=3.4704277515411377, loss=0.45756176114082336, param_norm=1887.124267578125
03:16:16.436 [I] Progress on: 834it/2.00kit rate:8.9s/it remaining:2:52:40 elapsed:2:03:39 postfix:- (3802351:tqdm_logging.py:145)
Step 835: grad_norm=3.1105055809020996, loss=0.42362260818481445, param_norm=1887.124267578125
Step 836: grad_norm=3.8520140647888184, loss=0.5054670572280884, param_norm=1887.124267578125
03:16:34.085 [I] Progress on: 836it/2.00kit rate:8.9s/it remaining:2:51:49 elapsed:2:03:57 postfix:- (3802351:tqdm_logging.py:145)
Step 837: grad_norm=3.2582921981811523, loss=0.43094950914382935, param_norm=1887.1243896484375
Step 838: grad_norm=3.1106715202331543, loss=0.3909638226032257, param_norm=1887.1243896484375
03:16:51.658 [I] Progress on: 838it/2.00kit rate:8.8s/it remaining:2:50:52 elapsed:2:04:14 postfix:- (3802351:tqdm_logging.py:145)
Step 839: grad_norm=3.395723342895508, loss=0.4311540424823761, param_norm=1887.1243896484375
Step 840: grad_norm=2.8301587104797363, loss=0.3602961599826813, param_norm=1887.1243896484375
03:17:09.304 [I] Progress on: 840it/2.00kit rate:8.8s/it remaining:2:50:44 elapsed:2:04:32 postfix:- (3802351:tqdm_logging.py:145)
Step 841: grad_norm=2.842693328857422, loss=0.3430072069168091, param_norm=1887.1243896484375
Step 842: grad_norm=2.585822105407715, loss=0.3670772910118103, param_norm=1887.1243896484375
03:17:26.928 [I] Progress on: 842it/2.00kit rate:8.8s/it remaining:2:50:18 elapsed:2:04:49 postfix:- (3802351:tqdm_logging.py:145)
Step 843: grad_norm=2.989874839782715, loss=0.40820127725601196, param_norm=1887.12451171875
Step 844: grad_norm=3.904181957244873, loss=0.42020195722579956, param_norm=1887.12451171875
03:17:44.600 [I] Progress on: 844it/2.00kit rate:8.8s/it remaining:2:50:13 elapsed:2:05:07 postfix:- (3802351:tqdm_logging.py:145)
Step 845: grad_norm=4.521341323852539, loss=0.4956679940223694, param_norm=1887.12451171875
Step 846: grad_norm=3.4290645122528076, loss=0.4763975739479065, param_norm=1887.12451171875
03:18:02.288 [I] Progress on: 846it/2.00kit rate:8.8s/it remaining:2:50:10 elapsed:2:05:25 postfix:- (3802351:tqdm_logging.py:145)
Step 847: grad_norm=2.9980030059814453, loss=0.4624900221824646, param_norm=1887.1246337890625
Step 848: grad_norm=3.1814258098602295, loss=0.44265270233154297, param_norm=1887.1246337890625
03:18:19.874 [I] Progress on: 848it/2.00kit rate:8.8s/it remaining:2:49:32 elapsed:2:05:42 postfix:- (3802351:tqdm_logging.py:145)
Step 849: grad_norm=3.6228010654449463, loss=0.3880869746208191, param_norm=1887.1246337890625
Step 850: grad_norm=2.601623058319092, loss=0.3304252624511719, param_norm=1887.1246337890625
03:18:37.474 [I] Progress on: 850it/2.00kit rate:8.8s/it remaining:2:48:56 elapsed:2:06:00 postfix:- (3802351:tqdm_logging.py:145)
Step 851: grad_norm=3.4191486835479736, loss=0.4004065990447998, param_norm=1887.1246337890625
Step 852: grad_norm=3.157611131668091, loss=0.42179256677627563, param_norm=1887.124755859375
03:18:55.164 [I] Progress on: 852it/2.00kit rate:8.8s/it remaining:2:49:06 elapsed:2:06:18 postfix:- (3802351:tqdm_logging.py:145)
Step 853: grad_norm=3.459977388381958, loss=0.47633737325668335, param_norm=1887.124755859375
Step 854: grad_norm=2.528200626373291, loss=0.31075721979141235, param_norm=1887.124755859375
03:19:12.746 [I] Progress on: 854it/2.00kit rate:8.8s/it remaining:2:48:21 elapsed:2:06:35 postfix:- (3802351:tqdm_logging.py:145)
Step 855: grad_norm=3.645850896835327, loss=0.44528865814208984, param_norm=1887.124755859375
Step 856: grad_norm=3.4817450046539307, loss=0.4516648054122925, param_norm=1887.124755859375
03:19:30.452 [I] Progress on: 856it/2.00kit rate:8.8s/it remaining:2:48:39 elapsed:2:06:53 postfix:- (3802351:tqdm_logging.py:145)
Step 857: grad_norm=3.3677539825439453, loss=0.4027746617794037, param_norm=1887.124755859375
Step 858: grad_norm=2.5810182094573975, loss=0.3858317732810974, param_norm=1887.1248779296875
03:19:48.056 [I] Progress on: 858it/2.00kit rate:8.8s/it remaining:2:47:58 elapsed:2:07:11 postfix:- (3802351:tqdm_logging.py:145)
Step 859: grad_norm=3.3834314346313477, loss=0.4693669080734253, param_norm=1887.1248779296875
Step 860: grad_norm=3.0520222187042236, loss=0.4484059512615204, param_norm=1887.1248779296875
03:20:05.704 [I] Progress on: 860it/2.00kit rate:8.8s/it remaining:2:47:46 elapsed:2:07:28 postfix:- (3802351:tqdm_logging.py:145)
Step 861: grad_norm=4.034380912780762, loss=0.44862282276153564, param_norm=1887.1248779296875
Step 862: grad_norm=3.517207384109497, loss=0.379711389541626, param_norm=1887.1248779296875
03:20:23.347 [I] Progress on: 862it/2.00kit rate:8.8s/it remaining:2:47:30 elapsed:2:07:46 postfix:- (3802351:tqdm_logging.py:145)
Step 863: grad_norm=3.531198501586914, loss=0.42708995938301086, param_norm=1887.1248779296875
Step 864: grad_norm=2.805382013320923, loss=0.323420912027359, param_norm=1887.1248779296875
03:20:41.012 [I] Progress on: 864it/2.00kit rate:8.8s/it remaining:2:47:18 elapsed:2:08:04 postfix:- (3802351:tqdm_logging.py:145)
Step 865: grad_norm=3.2652103900909424, loss=0.4183838963508606, param_norm=1887.1248779296875
Step 866: grad_norm=3.5322000980377197, loss=0.42952626943588257, param_norm=1887.125
03:20:58.679 [I] Progress on: 866it/2.00kit rate:8.8s/it remaining:2:47:06 elapsed:2:08:21 postfix:- (3802351:tqdm_logging.py:145)
Step 867: grad_norm=3.5873565673828125, loss=0.4459347724914551, param_norm=1887.125
Step 868: grad_norm=3.3410680294036865, loss=0.40762341022491455, param_norm=1887.125
03:21:16.367 [I] Progress on: 868it/2.00kit rate:8.8s/it remaining:2:46:57 elapsed:2:08:39 postfix:- (3802351:tqdm_logging.py:145)
Step 869: grad_norm=3.242203950881958, loss=0.3972828984260559, param_norm=1887.125244140625
Step 870: grad_norm=3.3497066497802734, loss=0.36583781242370605, param_norm=1887.125244140625
03:21:34.007 [I] Progress on: 870it/2.00kit rate:8.8s/it remaining:2:46:25 elapsed:2:08:57 postfix:- (3802351:tqdm_logging.py:145)
Step 871: grad_norm=2.2820558547973633, loss=0.2836117744445801, param_norm=1887.125244140625
Step 872: grad_norm=3.567500352859497, loss=0.4145974814891815, param_norm=1887.125244140625
03:21:51.640 [I] Progress on: 872it/2.00kit rate:8.8s/it remaining:2:46:04 elapsed:2:09:14 postfix:- (3802351:tqdm_logging.py:145)
Step 873: grad_norm=2.8261914253234863, loss=0.3602367043495178, param_norm=1887.125244140625
Step 874: grad_norm=2.8853800296783447, loss=0.4271349012851715, param_norm=1887.125244140625
03:22:09.227 [I] Progress on: 874it/2.00kit rate:8.8s/it remaining:2:45:25 elapsed:2:09:32 postfix:- (3802351:tqdm_logging.py:145)
Step 875: grad_norm=2.9475631713867188, loss=0.4181510806083679, param_norm=1887.125244140625
Step 876: grad_norm=2.6718811988830566, loss=0.3967796564102173, param_norm=1887.125244140625
03:22:26.909 [I] Progress on: 876it/2.00kit rate:8.8s/it remaining:2:45:26 elapsed:2:09:49 postfix:- (3802351:tqdm_logging.py:145)
Step 877: grad_norm=2.932441234588623, loss=0.39770931005477905, param_norm=1887.125244140625
Step 878: grad_norm=3.5132110118865967, loss=0.41523218154907227, param_norm=1887.125244140625
03:22:44.570 [I] Progress on: 878it/2.00kit rate:8.8s/it remaining:2:45:15 elapsed:2:10:07 postfix:- (3802351:tqdm_logging.py:145)
Step 879: grad_norm=3.7326323986053467, loss=0.4537865221500397, param_norm=1887.125244140625
Step 880: grad_norm=3.493013858795166, loss=0.4493522047996521, param_norm=1887.125244140625
03:23:02.243 [I] Progress on: 880it/2.00kit rate:8.8s/it remaining:2:45:04 elapsed:2:10:25 postfix:- (3802351:tqdm_logging.py:145)
Step 881: grad_norm=2.512550115585327, loss=0.32471024990081787, param_norm=1887.125244140625
Step 882: grad_norm=3.022752523422241, loss=0.3705574870109558, param_norm=1887.125244140625
03:23:19.896 [I] Progress on: 882it/2.00kit rate:8.8s/it remaining:2:44:40 elapsed:2:10:42 postfix:- (3802351:tqdm_logging.py:145)
Step 883: grad_norm=2.923722982406616, loss=0.38244348764419556, param_norm=1887.125244140625
Step 884: grad_norm=3.003382444381714, loss=0.414973646402359, param_norm=1887.1253662109375
03:23:37.573 [I] Progress on: 884it/2.00kit rate:8.8s/it remaining:2:44:28 elapsed:2:11:00 postfix:- (3802351:tqdm_logging.py:145)
Step 885: grad_norm=3.271233558654785, loss=0.4260097146034241, param_norm=1887.1253662109375
Step 886: grad_norm=3.5974364280700684, loss=0.4041479527950287, param_norm=1887.1253662109375
03:23:55.194 [I] Progress on: 886it/2.00kit rate:8.8s/it remaining:2:44:00 elapsed:2:11:18 postfix:- (3802351:tqdm_logging.py:145)
Step 887: grad_norm=4.204392433166504, loss=0.3763112723827362, param_norm=1887.1253662109375
Step 888: grad_norm=3.7258124351501465, loss=0.44076430797576904, param_norm=1887.1253662109375
03:24:12.812 [I] Progress on: 888it/2.00kit rate:8.8s/it remaining:2:43:30 elapsed:2:11:35 postfix:- (3802351:tqdm_logging.py:145)
Step 889: grad_norm=4.681276321411133, loss=0.38722240924835205, param_norm=1887.12548828125
Step 890: grad_norm=3.3340816497802734, loss=0.4301750659942627, param_norm=1887.12548828125
03:24:30.454 [I] Progress on: 890it/2.00kit rate:8.8s/it remaining:2:43:17 elapsed:2:11:53 postfix:- (3802351:tqdm_logging.py:145)
Step 891: grad_norm=3.204345464706421, loss=0.41226696968078613, param_norm=1887.12548828125
Step 892: grad_norm=2.294097423553467, loss=0.29365265369415283, param_norm=1887.12548828125
03:24:48.111 [I] Progress on: 892it/2.00kit rate:8.8s/it remaining:2:43:09 elapsed:2:12:11 postfix:- (3802351:tqdm_logging.py:145)
Step 893: grad_norm=3.520469903945923, loss=0.41834133863449097, param_norm=1887.12548828125
Step 894: grad_norm=3.967747449874878, loss=0.39579683542251587, param_norm=1887.12548828125
03:25:05.708 [I] Progress on: 894it/2.00kit rate:8.8s/it remaining:2:42:32 elapsed:2:12:28 postfix:- (3802351:tqdm_logging.py:145)
Step 895: grad_norm=3.463536262512207, loss=0.452990859746933, param_norm=1887.12548828125
Step 896: grad_norm=3.724722146987915, loss=0.47742581367492676, param_norm=1887.12548828125
03:25:23.319 [I] Progress on: 896it/2.00kit rate:8.8s/it remaining:2:42:12 elapsed:2:12:46 postfix:- (3802351:tqdm_logging.py:145)
Step 897: grad_norm=2.77162504196167, loss=0.3648129403591156, param_norm=1887.1256103515625
03:25:34.601 [I] Progress on: 897it/2.00kit rate:9.6s/it remaining:2:55:45 elapsed:2:12:57 postfix:- (3802351:tqdm_logging.py:145)
Step 898: grad_norm=2.7310190200805664, loss=0.2968369722366333, param_norm=1887.1256103515625
Step 899: grad_norm=2.662431001663208, loss=0.3666965365409851, param_norm=1887.1256103515625
03:25:52.150 [I] Progress on: 899it/2.00kit rate:9.2s/it remaining:2:48:10 elapsed:2:13:15 postfix:- (3802351:tqdm_logging.py:145)
Step 900: grad_norm=2.79982590675354, loss=0.4417128562927246, param_norm=1887.1256103515625
03:26:01.084 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
03:26:01.084 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
03:26:01.084 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=800. (3802351:checkpoint_manager.py:1786)
03:26:01.084 [I] [process=0][thread=MainThread][step=800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=800, also errors if any. (3802351:checkpoint_manager.py:1817)
03:26:01.085 [I] [process=0] Saving checkpoint at step 900                                        (3802351:checkpoint_manager.py:1286)
03:26:01.085 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900. (3802351:async_checkpointer.py:358)
03:26:01.086 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:26:01.087 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24 (3802351:atomicity.py:144)
03:26:01.087 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:26:01.088 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:26:01.089 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (3802351:atomicity.py:144)
03:26:01.089 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (3802351:atomicity.py:144)
03:26:01.090 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:26:01.094 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
03:26:04.905 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
03:26:04.907 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
03:26:04.922 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:26:04.929 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
03:26:04.950 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.952 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.976 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.976 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.977 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.977 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.977 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.978 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:26:04.978 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
03:26:04.979 [I] [process=0][thread=MainThread][step=900] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
03:26:04.979 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
03:26:04.980 [I] {'step': 900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742801161.0841231, 'wait_for_prev_duration_secs': 0.0006844997406005859, 'checkpointer_blocking_start_time': 1742801161.0852647, 'checkpointer_blocking_duration_secs': 3.865229606628418, 'get_old_steps_start_time': 1742801164.9505432, 'get_old_steps_duration_secs': 0.028269290924072266, 'checkpoint_manager_blocking_start_time': 1742801161.0840147, 'checkpoint_manager_blocking_duration_secs': 3.896080493927002} (3802351:standard_logger.py:34)
03:26:04.987 [I] Progress on: 901it/2.00kit rate:10.1s/it remaining:3:05:41 elapsed:2:13:28 postfix:- (3802351:tqdm_logging.py:145)
03:26:12.541 [I] ChainedFuture completed 1/1 futures in 7.61 seconds.                             (3802351:future.py:137)
03:26:12.542 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 904.7 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:26:12.542 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
03:26:12.543 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24 (3802351:async_checkpointer.py:406)
03:26:12.544 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24/assets (3802351:atomicity.py:287)
03:26:12.556 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24/params (3802351:atomicity.py:287)
03:26:12.556 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900 (3802351:async_checkpointer.py:416)
03:26:12.557 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24 (3802351:async_checkpointer.py:426)
03:26:12.557 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900.orbax-checkpoint-tmp-24 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900 (3802351:atomicity.py:287)
03:26:12.559 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/900`. (3802351:atomicity.py:548)
03:26:12.559 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
03:26:12.560 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
03:26:12.560 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
03:26:12.560 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
03:26:12.560 [I] [process=0][thread=save_finalize][step=900] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 901: grad_norm=2.696408987045288, loss=0.2964712977409363, param_norm=1887.1256103515625
Step 902: grad_norm=2.95808482170105, loss=0.4284019470214844, param_norm=1887.125732421875
03:26:22.274 [I] Progress on: 902it/2.00kit rate:9.7s/it remaining:2:57:38 elapsed:2:13:45 postfix:- (3802351:tqdm_logging.py:145)
Step 903: grad_norm=3.215060234069824, loss=0.4409392476081848, param_norm=1887.125732421875
Step 904: grad_norm=2.6209816932678223, loss=0.4026763439178467, param_norm=1887.125732421875
03:26:39.874 [I] Progress on: 904it/2.00kit rate:9.2s/it remaining:2:48:39 elapsed:2:14:02 postfix:- (3802351:tqdm_logging.py:145)
Step 905: grad_norm=2.975120782852173, loss=0.39520418643951416, param_norm=1887.125732421875
Step 906: grad_norm=2.994060516357422, loss=0.3259594440460205, param_norm=1887.125732421875
03:26:57.489 [I] Progress on: 906it/2.00kit rate:9.0s/it remaining:2:44:17 elapsed:2:14:20 postfix:- (3802351:tqdm_logging.py:145)
Step 907: grad_norm=2.738037109375, loss=0.3354474902153015, param_norm=1887.125732421875
Step 908: grad_norm=3.029489755630493, loss=0.3940754532814026, param_norm=1887.125732421875
03:27:15.113 [I] Progress on: 908it/2.00kit rate:8.9s/it remaining:2:42:06 elapsed:2:14:38 postfix:- (3802351:tqdm_logging.py:145)
Step 909: grad_norm=2.7543742656707764, loss=0.3648603558540344, param_norm=1887.125732421875
Step 910: grad_norm=2.576125383377075, loss=0.3147847056388855, param_norm=1887.125732421875
03:27:32.742 [I] Progress on: 910it/2.00kit rate:8.9s/it remaining:2:40:50 elapsed:2:14:55 postfix:- (3802351:tqdm_logging.py:145)
Step 911: grad_norm=2.367286443710327, loss=0.30964452028274536, param_norm=1887.125732421875
Step 912: grad_norm=2.734153985977173, loss=0.38457736372947693, param_norm=1887.1258544921875
03:27:50.407 [I] Progress on: 912it/2.00kit rate:8.8s/it remaining:2:40:10 elapsed:2:15:13 postfix:- (3802351:tqdm_logging.py:145)
Step 913: grad_norm=2.619481086730957, loss=0.3846386671066284, param_norm=1887.1258544921875
Step 914: grad_norm=2.707120418548584, loss=0.38755691051483154, param_norm=1887.1259765625
03:28:08.048 [I] Progress on: 914it/2.00kit rate:8.8s/it remaining:2:39:44 elapsed:2:15:31 postfix:- (3802351:tqdm_logging.py:145)
Step 915: grad_norm=3.23453950881958, loss=0.4071255922317505, param_norm=1887.1259765625
Step 916: grad_norm=3.294708251953125, loss=0.40575021505355835, param_norm=1887.1259765625
03:28:25.692 [I] Progress on: 916it/2.00kit rate:8.8s/it remaining:2:39:20 elapsed:2:15:48 postfix:- (3802351:tqdm_logging.py:145)
Step 917: grad_norm=2.8613088130950928, loss=0.3584643006324768, param_norm=1887.1259765625
Step 918: grad_norm=3.437593698501587, loss=0.3928305506706238, param_norm=1887.1259765625
03:28:43.300 [I] Progress on: 918it/2.00kit rate:8.8s/it remaining:2:38:47 elapsed:2:16:06 postfix:- (3802351:tqdm_logging.py:145)
Step 919: grad_norm=2.839855194091797, loss=0.39856231212615967, param_norm=1887.1259765625
Step 920: grad_norm=3.2493393421173096, loss=0.3967393636703491, param_norm=1887.1259765625
03:29:00.944 [I] Progress on: 920it/2.00kit rate:8.8s/it remaining:2:38:35 elapsed:2:16:24 postfix:- (3802351:tqdm_logging.py:145)
Step 921: grad_norm=2.7717926502227783, loss=0.3935563862323761, param_norm=1887.1259765625
Step 922: grad_norm=2.812009572982788, loss=0.4306153655052185, param_norm=1887.1260986328125
03:29:18.502 [I] Progress on: 922it/2.00kit rate:8.8s/it remaining:2:37:54 elapsed:2:16:41 postfix:- (3802351:tqdm_logging.py:145)
Step 923: grad_norm=5.201921463012695, loss=0.4242464005947113, param_norm=1887.1260986328125
Step 924: grad_norm=2.5925252437591553, loss=0.34676438570022583, param_norm=1887.1260986328125
03:29:36.057 [I] Progress on: 924it/2.00kit rate:8.8s/it remaining:2:37:27 elapsed:2:16:59 postfix:- (3802351:tqdm_logging.py:145)
Step 925: grad_norm=2.7168619632720947, loss=0.3809031844139099, param_norm=1887.1260986328125
Step 926: grad_norm=3.1189157962799072, loss=0.3737947344779968, param_norm=1887.1260986328125
03:29:53.608 [I] Progress on: 926it/2.00kit rate:8.8s/it remaining:2:37:00 elapsed:2:17:16 postfix:- (3802351:tqdm_logging.py:145)
Step 927: grad_norm=2.631669044494629, loss=0.4159756898880005, param_norm=1887.1260986328125
Step 928: grad_norm=2.6196820735931396, loss=0.4038184881210327, param_norm=1887.1260986328125
03:30:11.168 [I] Progress on: 928it/2.00kit rate:8.8s/it remaining:2:36:42 elapsed:2:17:34 postfix:- (3802351:tqdm_logging.py:145)
Step 929: grad_norm=3.1951375007629395, loss=0.41094353795051575, param_norm=1887.1260986328125
Step 930: grad_norm=3.0444626808166504, loss=0.3634595572948456, param_norm=1887.126220703125
03:30:28.758 [I] Progress on: 930it/2.00kit rate:8.8s/it remaining:2:36:37 elapsed:2:17:51 postfix:- (3802351:tqdm_logging.py:145)
Step 931: grad_norm=2.802159309387207, loss=0.3328525424003601, param_norm=1887.126220703125
Step 932: grad_norm=2.707876682281494, loss=0.3751511871814728, param_norm=1887.126220703125
03:30:46.362 [I] Progress on: 932it/2.00kit rate:8.8s/it remaining:2:36:27 elapsed:2:18:09 postfix:- (3802351:tqdm_logging.py:145)
Step 933: grad_norm=2.753293514251709, loss=0.4178406894207001, param_norm=1887.126220703125
Step 934: grad_norm=2.478883743286133, loss=0.3573329448699951, param_norm=1887.126220703125
03:31:03.963 [I] Progress on: 934it/2.00kit rate:8.8s/it remaining:2:36:12 elapsed:2:18:27 postfix:- (3802351:tqdm_logging.py:145)
Step 935: grad_norm=2.4769392013549805, loss=0.3485111594200134, param_norm=1887.126220703125
Step 936: grad_norm=2.465071439743042, loss=0.3042614758014679, param_norm=1887.126220703125
03:31:21.557 [I] Progress on: 936it/2.00kit rate:8.8s/it remaining:2:35:51 elapsed:2:18:44 postfix:- (3802351:tqdm_logging.py:145)
Step 937: grad_norm=3.196960926055908, loss=0.42767035961151123, param_norm=1887.126220703125
Step 938: grad_norm=3.186610221862793, loss=0.3552432060241699, param_norm=1887.126220703125
03:31:39.172 [I] Progress on: 938it/2.00kit rate:8.8s/it remaining:2:35:40 elapsed:2:19:02 postfix:- (3802351:tqdm_logging.py:145)
Step 939: grad_norm=2.620191812515259, loss=0.31344395875930786, param_norm=1887.126220703125
Step 940: grad_norm=2.714123249053955, loss=0.3654240667819977, param_norm=1887.1263427734375
03:31:56.800 [I] Progress on: 940it/2.00kit rate:8.8s/it remaining:2:35:31 elapsed:2:19:19 postfix:- (3802351:tqdm_logging.py:145)
Step 941: grad_norm=2.892510175704956, loss=0.34966298937797546, param_norm=1887.1263427734375
Step 942: grad_norm=3.0672354698181152, loss=0.3551537096500397, param_norm=1887.1263427734375
03:32:14.404 [I] Progress on: 942it/2.00kit rate:8.8s/it remaining:2:35:09 elapsed:2:19:37 postfix:- (3802351:tqdm_logging.py:145)
Step 943: grad_norm=2.6280877590179443, loss=0.34040045738220215, param_norm=1887.1263427734375
Step 944: grad_norm=2.63822603225708, loss=0.34637999534606934, param_norm=1887.1263427734375
03:32:31.984 [I] Progress on: 944it/2.00kit rate:8.8s/it remaining:2:34:40 elapsed:2:19:55 postfix:- (3802351:tqdm_logging.py:145)
Step 945: grad_norm=2.7006900310516357, loss=0.36351972818374634, param_norm=1887.1263427734375
Step 946: grad_norm=3.0348124504089355, loss=0.3629438877105713, param_norm=1887.1263427734375
03:32:49.548 [I] Progress on: 946it/2.00kit rate:8.8s/it remaining:2:34:13 elapsed:2:20:12 postfix:- (3802351:tqdm_logging.py:145)
Step 947: grad_norm=2.566056251525879, loss=0.36833518743515015, param_norm=1887.1263427734375
Step 948: grad_norm=2.700450897216797, loss=0.36492544412612915, param_norm=1887.1263427734375
03:33:07.182 [I] Progress on: 948it/2.00kit rate:8.8s/it remaining:2:34:10 elapsed:2:20:30 postfix:- (3802351:tqdm_logging.py:145)
Step 949: grad_norm=2.992713451385498, loss=0.36582309007644653, param_norm=1887.1263427734375
Step 950: grad_norm=3.064423084259033, loss=0.35106420516967773, param_norm=1887.12646484375
03:33:24.807 [I] Progress on: 950it/2.00kit rate:8.8s/it remaining:2:33:57 elapsed:2:20:47 postfix:- (3802351:tqdm_logging.py:145)
Step 951: grad_norm=3.193439245223999, loss=0.299648642539978, param_norm=1887.12646484375
Step 952: grad_norm=3.186692476272583, loss=0.40140414237976074, param_norm=1887.12646484375
03:33:42.463 [I] Progress on: 952it/2.00kit rate:8.8s/it remaining:2:33:52 elapsed:2:21:05 postfix:- (3802351:tqdm_logging.py:145)
Step 953: grad_norm=2.7429563999176025, loss=0.3711587190628052, param_norm=1887.12646484375
Step 954: grad_norm=3.1825413703918457, loss=0.3431980013847351, param_norm=1887.12646484375
03:34:00.118 [I] Progress on: 954it/2.00kit rate:8.8s/it remaining:2:33:38 elapsed:2:21:23 postfix:- (3802351:tqdm_logging.py:145)
Step 955: grad_norm=2.634058713912964, loss=0.35361790657043457, param_norm=1887.12646484375
Step 956: grad_norm=3.106450319290161, loss=0.4421324133872986, param_norm=1887.1265869140625
03:34:17.777 [I] Progress on: 956it/2.00kit rate:8.8s/it remaining:2:33:22 elapsed:2:21:40 postfix:- (3802351:tqdm_logging.py:145)
Step 957: grad_norm=2.8918778896331787, loss=0.3653867542743683, param_norm=1887.1265869140625
Step 958: grad_norm=2.944309949874878, loss=0.3820763826370239, param_norm=1887.1265869140625
03:34:35.422 [I] Progress on: 958it/2.00kit rate:8.8s/it remaining:2:33:07 elapsed:2:21:58 postfix:- (3802351:tqdm_logging.py:145)
Step 959: grad_norm=3.4526658058166504, loss=0.39048299193382263, param_norm=1887.1265869140625
Step 960: grad_norm=2.6668171882629395, loss=0.42235296964645386, param_norm=1887.1265869140625
03:34:53.054 [I] Progress on: 960it/2.00kit rate:8.8s/it remaining:2:32:37 elapsed:2:22:16 postfix:- (3802351:tqdm_logging.py:145)
Step 961: grad_norm=3.1137630939483643, loss=0.308925986289978, param_norm=1887.1265869140625
Step 962: grad_norm=2.845348834991455, loss=0.3454762101173401, param_norm=1887.126708984375
03:35:10.697 [I] Progress on: 962it/2.00kit rate:8.8s/it remaining:2:32:25 elapsed:2:22:33 postfix:- (3802351:tqdm_logging.py:145)
Step 963: grad_norm=2.5929431915283203, loss=0.4068799614906311, param_norm=1887.126708984375
Step 964: grad_norm=2.5560381412506104, loss=0.3233409821987152, param_norm=1887.126708984375
03:35:28.358 [I] Progress on: 964it/2.00kit rate:8.8s/it remaining:2:32:07 elapsed:2:22:51 postfix:- (3802351:tqdm_logging.py:145)
Step 965: grad_norm=2.733107566833496, loss=0.347902774810791, param_norm=1887.126708984375
03:35:39.840 [I] Progress on: 966it/2.00kit rate:9.6s/it remaining:2:44:41 elapsed:2:23:02 postfix:- (3802351:tqdm_logging.py:145)
Step 966: grad_norm=2.2782020568847656, loss=0.39705151319503784, param_norm=1887.126708984375
Step 967: grad_norm=2.6730942726135254, loss=0.3690109848976135, param_norm=1887.126708984375
03:35:57.146 [I] Progress on: 967it/2.00kit rate:9.3s/it remaining:2:40:08 elapsed:2:23:20 postfix:- (3802351:tqdm_logging.py:145)
Step 968: grad_norm=2.343839406967163, loss=0.26995256543159485, param_norm=1887.126708984375
Step 969: grad_norm=2.2143654823303223, loss=0.39185571670532227, param_norm=1887.126708984375
03:36:14.755 [I] Progress on: 969it/2.00kit rate:9.0s/it remaining:2:35:23 elapsed:2:23:37 postfix:- (3802351:tqdm_logging.py:145)
Step 970: grad_norm=2.3991379737854004, loss=0.25652992725372314, param_norm=1887.126708984375
Step 971: grad_norm=2.5602197647094727, loss=0.3380173444747925, param_norm=1887.1268310546875
03:36:32.388 [I] Progress on: 971it/2.00kit rate:8.9s/it remaining:2:33:00 elapsed:2:23:55 postfix:- (3802351:tqdm_logging.py:145)
Step 972: grad_norm=2.3003251552581787, loss=0.3516371250152588, param_norm=1887.1268310546875
Step 973: grad_norm=2.923687696456909, loss=0.3668819069862366, param_norm=1887.1268310546875
03:36:49.984 [I] Progress on: 973it/2.00kit rate:8.9s/it remaining:2:31:34 elapsed:2:24:13 postfix:- (3802351:tqdm_logging.py:145)
Step 974: grad_norm=2.819537878036499, loss=0.3619830012321472, param_norm=1887.1268310546875
Step 975: grad_norm=2.627880811691284, loss=0.40438348054885864, param_norm=1887.1268310546875
03:37:07.656 [I] Progress on: 975it/2.00kit rate:8.8s/it remaining:2:30:58 elapsed:2:24:30 postfix:- (3802351:tqdm_logging.py:145)
Step 976: grad_norm=2.4986748695373535, loss=0.37955722212791443, param_norm=1887.1268310546875
Step 977: grad_norm=2.8120999336242676, loss=0.395126074552536, param_norm=1887.1268310546875
03:37:25.246 [I] Progress on: 977it/2.00kit rate:8.8s/it remaining:2:30:17 elapsed:2:24:48 postfix:- (3802351:tqdm_logging.py:145)
Step 978: grad_norm=2.9825751781463623, loss=0.3613753914833069, param_norm=1887.1268310546875
Step 979: grad_norm=2.694859743118286, loss=0.36332547664642334, param_norm=1887.1268310546875
03:37:42.865 [I] Progress on: 979it/2.00kit rate:8.8s/it remaining:2:29:51 elapsed:2:25:05 postfix:- (3802351:tqdm_logging.py:145)
Step 980: grad_norm=2.5822315216064453, loss=0.44113290309906006, param_norm=1887.126953125
Step 981: grad_norm=2.859217882156372, loss=0.2827405333518982, param_norm=1887.126953125
03:38:00.435 [I] Progress on: 981it/2.00kit rate:8.8s/it remaining:2:29:19 elapsed:2:25:23 postfix:- (3802351:tqdm_logging.py:145)
Step 982: grad_norm=2.5632431507110596, loss=0.388241171836853, param_norm=1887.126953125
Step 983: grad_norm=2.598050832748413, loss=0.3308562636375427, param_norm=1887.126953125
03:38:18.112 [I] Progress on: 983it/2.00kit rate:8.8s/it remaining:2:29:17 elapsed:2:25:41 postfix:- (3802351:tqdm_logging.py:145)
Step 984: grad_norm=2.630906105041504, loss=0.2730853855609894, param_norm=1887.126953125
Step 985: grad_norm=2.549201250076294, loss=0.3375049829483032, param_norm=1887.126953125
03:38:35.748 [I] Progress on: 985it/2.00kit rate:8.8s/it remaining:2:29:05 elapsed:2:25:58 postfix:- (3802351:tqdm_logging.py:145)
Step 986: grad_norm=2.9567153453826904, loss=0.3797333240509033, param_norm=1887.126953125
Step 987: grad_norm=2.6561026573181152, loss=0.32394909858703613, param_norm=1887.126953125
03:38:53.352 [I] Progress on: 987it/2.00kit rate:8.8s/it remaining:2:28:31 elapsed:2:26:16 postfix:- (3802351:tqdm_logging.py:145)
Step 988: grad_norm=3.450483798980713, loss=0.38648608326911926, param_norm=1887.126953125
Step 989: grad_norm=2.2570197582244873, loss=0.28987282514572144, param_norm=1887.126953125
03:39:10.928 [I] Progress on: 989it/2.00kit rate:8.8s/it remaining:2:28:05 elapsed:2:26:33 postfix:- (3802351:tqdm_logging.py:145)
Step 990: grad_norm=2.6489319801330566, loss=0.34691113233566284, param_norm=1887.126953125
Step 991: grad_norm=2.7985551357269287, loss=0.3077927827835083, param_norm=1887.126953125
03:39:28.514 [I] Progress on: 991it/2.00kit rate:8.8s/it remaining:2:27:44 elapsed:2:26:51 postfix:- (3802351:tqdm_logging.py:145)
Step 992: grad_norm=2.5619540214538574, loss=0.3015758991241455, param_norm=1887.126953125
Step 993: grad_norm=2.845562696456909, loss=0.35476523637771606, param_norm=1887.126953125
03:39:46.432 [I] Progress on: 993it/2.00kit rate:8.8s/it remaining:2:27:27 elapsed:2:27:09 postfix:- (3802351:tqdm_logging.py:145)
Step 994: grad_norm=2.443678140640259, loss=0.3771324157714844, param_norm=1887.126953125
Step 995: grad_norm=2.989799737930298, loss=0.36130619049072266, param_norm=1887.126953125
03:40:04.157 [I] Progress on: 995it/2.00kit rate:8.9s/it remaining:2:28:50 elapsed:2:27:27 postfix:- (3802351:tqdm_logging.py:145)
Step 996: grad_norm=2.8850278854370117, loss=0.3463479280471802, param_norm=1887.126953125
Step 997: grad_norm=3.059236526489258, loss=0.3584241271018982, param_norm=1887.126953125
03:40:21.766 [I] Progress on: 997it/2.00kit rate:8.8s/it remaining:2:27:43 elapsed:2:27:44 postfix:- (3802351:tqdm_logging.py:145)
Step 998: grad_norm=3.0753564834594727, loss=0.3607712388038635, param_norm=1887.126953125
Step 999: grad_norm=2.583169460296631, loss=0.3545859456062317, param_norm=1887.126953125
03:40:39.409 [I] Progress on: 999it/2.00kit rate:8.8s/it remaining:2:27:13 elapsed:2:28:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1000: grad_norm=2.334594964981079, loss=0.33227047324180603, param_norm=1887.1270751953125
03:40:48.453 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
03:40:48.453 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
03:40:48.454 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=900. (3802351:checkpoint_manager.py:1786)
03:40:48.454 [I] [process=0][thread=MainThread][step=900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=900, also errors if any. (3802351:checkpoint_manager.py:1817)
03:40:48.454 [I] [process=0] Saving checkpoint at step 1000                                       (3802351:checkpoint_manager.py:1286)
03:40:48.455 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000. (3802351:async_checkpointer.py:358)
03:40:48.457 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:40:48.457 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27 (3802351:atomicity.py:144)
03:40:48.458 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:40:48.459 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:40:48.461 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 (3802351:atomicity.py:144)
03:40:48.461 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 (3802351:atomicity.py:144)
03:40:48.462 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:40:48.467 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
03:40:53.261 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.1 GiB/s (total bytes: 10.1 GiB) (time elapsed: 4 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:40:53.267 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
03:40:53.269 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
03:40:53.275 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
03:40:53.304 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.306 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.307 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.308 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.309 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.310 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.311 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.312 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.312 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:40:53.313 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
03:40:53.321 [I] [process=0][thread=MainThread][step=1000] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
03:40:53.325 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
03:40:53.341 [I] {'step': 1000, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742802048.4535005, 'wait_for_prev_duration_secs': 0.0008347034454345703, 'checkpointer_blocking_start_time': 1742802048.454949, 'checkpointer_blocking_duration_secs': 4.849240064620972, 'get_old_steps_start_time': 1742802053.3042252, 'get_old_steps_duration_secs': 0.009441852569580078, 'checkpoint_manager_blocking_start_time': 1742802048.4533288, 'checkpoint_manager_blocking_duration_secs': 4.888186454772949} (3802351:standard_logger.py:34)
03:40:53.344 [I] Progress on: 1.00kit/2.00kit rate:10.3s/it remaining:2:51:19 elapsed:2:28:16 postfix:- (3802351:tqdm_logging.py:145)
03:41:01.269 [I] ChainedFuture completed 1/1 futures in 7.99 seconds.                             (3802351:future.py:137)
03:41:01.270 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 808.9 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:41:01.271 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
03:41:01.272 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27 (3802351:async_checkpointer.py:406)
03:41:01.273 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27/assets.orbax-checkpoint-tmp-28 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27/assets (3802351:atomicity.py:287)
03:41:01.286 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27/params.orbax-checkpoint-tmp-29 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27/params (3802351:atomicity.py:287)
03:41:01.286 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000 (3802351:async_checkpointer.py:416)
03:41:01.287 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27 (3802351:async_checkpointer.py:426)
03:41:01.287 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000.orbax-checkpoint-tmp-27 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000 (3802351:atomicity.py:287)
03:41:01.289 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1000`. (3802351:atomicity.py:548)
03:41:01.289 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
03:41:01.289 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
03:41:01.290 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
03:41:01.290 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
03:41:01.291 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1001: grad_norm=2.2126710414886475, loss=0.25067850947380066, param_norm=1887.1270751953125
Step 1002: grad_norm=2.421590805053711, loss=0.3115882873535156, param_norm=1887.1270751953125
03:41:10.785 [I] Progress on: 1.00kit/2.00kit rate:9.9s/it remaining:2:43:57 elapsed:2:28:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1003: grad_norm=2.3883919715881348, loss=0.3607538640499115, param_norm=1887.1270751953125
Step 1004: grad_norm=2.8127715587615967, loss=0.37190937995910645, param_norm=1887.1270751953125
03:41:28.463 [I] Progress on: 1.00kit/2.00kit rate:9.3s/it remaining:2:35:06 elapsed:2:28:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1005: grad_norm=2.6853883266448975, loss=0.3060739040374756, param_norm=1887.1270751953125
Step 1006: grad_norm=2.678741693496704, loss=0.347626268863678, param_norm=1887.1270751953125
03:41:46.123 [I] Progress on: 1.01kit/2.00kit rate:9.1s/it remaining:2:30:36 elapsed:2:29:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1007: grad_norm=2.9836225509643555, loss=0.36067768931388855, param_norm=1887.127197265625
Step 1008: grad_norm=3.3321456909179688, loss=0.3453832268714905, param_norm=1887.127197265625
03:42:03.685 [I] Progress on: 1.01kit/2.00kit rate:8.9s/it remaining:2:27:42 elapsed:2:29:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1009: grad_norm=2.5707945823669434, loss=0.31749609112739563, param_norm=1887.127197265625
Step 1010: grad_norm=3.1966941356658936, loss=0.3786763846874237, param_norm=1887.127197265625
03:42:21.304 [I] Progress on: 1.01kit/2.00kit rate:8.9s/it remaining:2:26:29 elapsed:2:29:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1011: grad_norm=2.7373838424682617, loss=0.3478502631187439, param_norm=1887.127197265625
Step 1012: grad_norm=2.557675361633301, loss=0.3449907600879669, param_norm=1887.127197265625
03:42:38.895 [I] Progress on: 1.01kit/2.00kit rate:8.8s/it remaining:2:25:30 elapsed:2:30:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1013: grad_norm=2.9080939292907715, loss=0.3484318256378174, param_norm=1887.127197265625
Step 1014: grad_norm=2.5679402351379395, loss=0.3710910677909851, param_norm=1887.127197265625
03:42:56.522 [I] Progress on: 1.01kit/2.00kit rate:8.8s/it remaining:2:25:09 elapsed:2:30:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1015: grad_norm=2.620321750640869, loss=0.3532105088233948, param_norm=1887.1273193359375
Step 1016: grad_norm=2.386568546295166, loss=0.33650439977645874, param_norm=1887.127197265625
03:43:14.063 [I] Progress on: 1.02kit/2.00kit rate:8.8s/it remaining:2:24:25 elapsed:2:30:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1017: grad_norm=2.6953961849212646, loss=0.3730212450027466, param_norm=1887.127197265625
Step 1018: grad_norm=2.6433894634246826, loss=0.3563346266746521, param_norm=1887.127197265625
03:43:31.656 [I] Progress on: 1.02kit/2.00kit rate:8.8s/it remaining:2:24:07 elapsed:2:30:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1019: grad_norm=3.080916404724121, loss=0.36533308029174805, param_norm=1887.1273193359375
Step 1020: grad_norm=2.832784652709961, loss=0.3688288927078247, param_norm=1887.1273193359375
03:43:49.247 [I] Progress on: 1.02kit/2.00kit rate:8.8s/it remaining:2:23:47 elapsed:2:31:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1021: grad_norm=3.3626561164855957, loss=0.40166038274765015, param_norm=1887.1273193359375
Step 1022: grad_norm=2.8571300506591797, loss=0.3738934397697449, param_norm=1887.1273193359375
03:44:06.858 [I] Progress on: 1.02kit/2.00kit rate:8.8s/it remaining:2:23:42 elapsed:2:31:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1023: grad_norm=2.6123666763305664, loss=0.32914137840270996, param_norm=1887.1273193359375
Step 1024: grad_norm=2.827115058898926, loss=0.30783364176750183, param_norm=1887.1273193359375
03:44:24.502 [I] Progress on: 1.02kit/2.00kit rate:8.8s/it remaining:2:23:32 elapsed:2:31:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1025: grad_norm=3.1685729026794434, loss=0.33794593811035156, param_norm=1887.1273193359375
Step 1026: grad_norm=2.7528364658355713, loss=0.28149843215942383, param_norm=1887.1273193359375
03:44:42.179 [I] Progress on: 1.03kit/2.00kit rate:8.8s/it remaining:2:23:29 elapsed:2:32:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1027: grad_norm=3.1590235233306885, loss=0.3474368453025818, param_norm=1887.1273193359375
Step 1028: grad_norm=2.4893639087677, loss=0.286989688873291, param_norm=1887.1273193359375
03:44:59.744 [I] Progress on: 1.03kit/2.00kit rate:8.8s/it remaining:2:22:45 elapsed:2:32:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1029: grad_norm=2.68050217628479, loss=0.28522855043411255, param_norm=1887.1273193359375
Step 1030: grad_norm=2.71711802482605, loss=0.3574759364128113, param_norm=1887.1273193359375
03:45:17.415 [I] Progress on: 1.03kit/2.00kit rate:8.8s/it remaining:2:22:45 elapsed:2:32:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1031: grad_norm=2.790276050567627, loss=0.3268381357192993, param_norm=1887.12744140625
Step 1032: grad_norm=3.0982234477996826, loss=0.3401501774787903, param_norm=1887.12744140625
03:45:34.993 [I] Progress on: 1.03kit/2.00kit rate:8.8s/it remaining:2:22:09 elapsed:2:32:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1033: grad_norm=3.777749538421631, loss=0.41059643030166626, param_norm=1887.12744140625
Step 1034: grad_norm=2.480512857437134, loss=0.28913378715515137, param_norm=1887.12744140625
03:45:52.562 [I] Progress on: 1.03kit/2.00kit rate:8.8s/it remaining:2:21:44 elapsed:2:33:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1035: grad_norm=2.344917058944702, loss=0.3038429915904999, param_norm=1887.1275634765625
03:46:03.533 [I] Progress on: 1.03kit/2.00kit rate:9.5s/it remaining:2:32:07 elapsed:2:33:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1036: grad_norm=2.66955828666687, loss=0.3417687714099884, param_norm=1887.1275634765625
Step 1037: grad_norm=2.697680950164795, loss=0.3110769987106323, param_norm=1887.1275634765625
03:46:21.095 [I] Progress on: 1.04kit/2.00kit rate:9.1s/it remaining:2:26:15 elapsed:2:33:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1038: grad_norm=2.393359899520874, loss=0.32311710715293884, param_norm=1887.1275634765625
Step 1039: grad_norm=2.6120171546936035, loss=0.31859928369522095, param_norm=1887.1275634765625
03:46:38.663 [I] Progress on: 1.04kit/2.00kit rate:8.9s/it remaining:2:23:11 elapsed:2:34:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1040: grad_norm=2.2623043060302734, loss=0.30417513847351074, param_norm=1887.1275634765625
Step 1041: grad_norm=2.7705113887786865, loss=0.37891823053359985, param_norm=1887.1275634765625
03:46:56.264 [I] Progress on: 1.04kit/2.00kit rate:8.9s/it remaining:2:21:44 elapsed:2:34:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1042: grad_norm=2.816317558288574, loss=0.3777148723602295, param_norm=1887.1275634765625
Step 1043: grad_norm=2.6153688430786133, loss=0.29384541511535645, param_norm=1887.1275634765625
03:47:13.922 [I] Progress on: 1.04kit/2.00kit rate:8.8s/it remaining:2:21:07 elapsed:2:34:36 postfix:- (3802351:tqdm_logging.py:145)
Step 1044: grad_norm=2.2918732166290283, loss=0.3004707098007202, param_norm=1887.1275634765625
Step 1045: grad_norm=2.334122896194458, loss=0.31686165928840637, param_norm=1887.1275634765625
03:47:31.596 [I] Progress on: 1.04kit/2.00kit rate:8.8s/it remaining:2:20:41 elapsed:2:34:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1046: grad_norm=2.4198992252349854, loss=0.35309070348739624, param_norm=1887.1275634765625
Step 1047: grad_norm=2.5524404048919678, loss=0.36056429147720337, param_norm=1887.1275634765625
03:47:49.272 [I] Progress on: 1.05kit/2.00kit rate:8.8s/it remaining:2:20:21 elapsed:2:35:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1048: grad_norm=2.921614408493042, loss=0.34080585837364197, param_norm=1887.127685546875
Step 1049: grad_norm=2.1935853958129883, loss=0.26782506704330444, param_norm=1887.127685546875
03:48:06.924 [I] Progress on: 1.05kit/2.00kit rate:8.8s/it remaining:2:19:56 elapsed:2:35:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1050: grad_norm=2.8508453369140625, loss=0.33384281396865845, param_norm=1887.127685546875
Step 1051: grad_norm=2.7431139945983887, loss=0.29588645696640015, param_norm=1887.127685546875
03:48:24.598 [I] Progress on: 1.05kit/2.00kit rate:8.8s/it remaining:2:19:42 elapsed:2:35:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1052: grad_norm=2.6572153568267822, loss=0.36077648401260376, param_norm=1887.127685546875
Step 1053: grad_norm=3.0064635276794434, loss=0.40307891368865967, param_norm=1887.127685546875
03:48:42.249 [I] Progress on: 1.05kit/2.00kit rate:8.8s/it remaining:2:19:21 elapsed:2:36:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1054: grad_norm=2.926738977432251, loss=0.373102068901062, param_norm=1887.127685546875
Step 1055: grad_norm=2.733332395553589, loss=0.31621670722961426, param_norm=1887.127685546875
03:48:59.854 [I] Progress on: 1.05kit/2.00kit rate:8.8s/it remaining:2:18:48 elapsed:2:36:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1056: grad_norm=2.4533886909484863, loss=0.30416759848594666, param_norm=1887.127685546875
Step 1057: grad_norm=2.5955357551574707, loss=0.312432199716568, param_norm=1887.1278076171875
03:49:17.434 [I] Progress on: 1.06kit/2.00kit rate:8.8s/it remaining:2:18:17 elapsed:2:36:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1058: grad_norm=2.3063743114471436, loss=0.3238452076911926, param_norm=1887.1278076171875
Step 1059: grad_norm=2.547264337539673, loss=0.2651902437210083, param_norm=1887.1278076171875
03:49:35.105 [I] Progress on: 1.06kit/2.00kit rate:8.8s/it remaining:2:18:19 elapsed:2:36:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1060: grad_norm=2.1744673252105713, loss=0.2819373905658722, param_norm=1887.1278076171875
Step 1061: grad_norm=2.962557792663574, loss=0.3603702783584595, param_norm=1887.1278076171875
03:49:52.726 [I] Progress on: 1.06kit/2.00kit rate:8.8s/it remaining:2:17:56 elapsed:2:37:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1062: grad_norm=2.1315364837646484, loss=0.28280574083328247, param_norm=1887.1278076171875
Step 1063: grad_norm=2.8073720932006836, loss=0.336579829454422, param_norm=1887.1278076171875
03:50:10.347 [I] Progress on: 1.06kit/2.00kit rate:8.8s/it remaining:2:17:34 elapsed:2:37:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1064: grad_norm=2.817147731781006, loss=0.35168787837028503, param_norm=1887.1278076171875
Step 1065: grad_norm=2.937075138092041, loss=0.31891024112701416, param_norm=1887.1278076171875
03:50:27.987 [I] Progress on: 1.06kit/2.00kit rate:8.8s/it remaining:2:17:24 elapsed:2:37:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1066: grad_norm=3.377877950668335, loss=0.4340033531188965, param_norm=1887.1278076171875
Step 1067: grad_norm=2.562016248703003, loss=0.2816329598426819, param_norm=1887.1278076171875
03:50:45.642 [I] Progress on: 1.07kit/2.00kit rate:8.8s/it remaining:2:17:07 elapsed:2:38:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1068: grad_norm=2.40187406539917, loss=0.3088070750236511, param_norm=1887.1278076171875
Step 1069: grad_norm=2.3911750316619873, loss=0.29526183009147644, param_norm=1887.1278076171875
03:51:03.297 [I] Progress on: 1.07kit/2.00kit rate:8.8s/it remaining:2:16:53 elapsed:2:38:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1070: grad_norm=2.784620761871338, loss=0.3611461818218231, param_norm=1887.1278076171875
Step 1071: grad_norm=3.1096296310424805, loss=0.40057387948036194, param_norm=1887.1278076171875
03:51:20.937 [I] Progress on: 1.07kit/2.00kit rate:8.8s/it remaining:2:16:31 elapsed:2:38:43 postfix:- (3802351:tqdm_logging.py:145)
Step 1072: grad_norm=2.9192731380462646, loss=0.33907824754714966, param_norm=1887.1278076171875
Step 1073: grad_norm=3.4083197116851807, loss=0.32261502742767334, param_norm=1887.1279296875
03:51:38.555 [I] Progress on: 1.07kit/2.00kit rate:8.8s/it remaining:2:16:05 elapsed:2:39:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1074: grad_norm=2.687561511993408, loss=0.34823518991470337, param_norm=1887.1279296875
Step 1075: grad_norm=2.53964900970459, loss=0.29436856508255005, param_norm=1887.1279296875
03:51:56.177 [I] Progress on: 1.07kit/2.00kit rate:8.8s/it remaining:2:15:49 elapsed:2:39:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1076: grad_norm=2.681272268295288, loss=0.3561103045940399, param_norm=1887.1279296875
Step 1077: grad_norm=3.827002763748169, loss=0.3719262480735779, param_norm=1887.1279296875
03:52:13.796 [I] Progress on: 1.08kit/2.00kit rate:8.8s/it remaining:2:15:33 elapsed:2:39:36 postfix:- (3802351:tqdm_logging.py:145)
Step 1078: grad_norm=3.026045799255371, loss=0.3514706492424011, param_norm=1887.1279296875
Step 1079: grad_norm=2.5049002170562744, loss=0.3070570230484009, param_norm=1887.1279296875
03:52:31.433 [I] Progress on: 1.08kit/2.00kit rate:8.8s/it remaining:2:15:18 elapsed:2:39:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1080: grad_norm=2.8906500339508057, loss=0.3692767024040222, param_norm=1887.1279296875
Step 1081: grad_norm=3.359586477279663, loss=0.2859141230583191, param_norm=1887.1279296875
03:52:49.066 [I] Progress on: 1.08kit/2.00kit rate:8.8s/it remaining:2:15:00 elapsed:2:40:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1082: grad_norm=2.473665952682495, loss=0.30643123388290405, param_norm=1887.1279296875
Step 1083: grad_norm=2.496211528778076, loss=0.28917890787124634, param_norm=1887.1279296875
03:53:06.919 [I] Progress on: 1.08kit/2.00kit rate:8.8s/it remaining:2:14:42 elapsed:2:40:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1084: grad_norm=2.5892035961151123, loss=0.3242108225822449, param_norm=1887.1279296875
Step 1085: grad_norm=3.1850337982177734, loss=0.37940672039985657, param_norm=1887.1279296875
03:53:24.526 [I] Progress on: 1.08kit/2.00kit rate:8.9s/it remaining:2:15:03 elapsed:2:40:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1086: grad_norm=2.784045934677124, loss=0.3728391230106354, param_norm=1887.1279296875
Step 1087: grad_norm=2.146841049194336, loss=0.3129573464393616, param_norm=1887.1279296875
03:53:42.156 [I] Progress on: 1.09kit/2.00kit rate:8.8s/it remaining:2:14:26 elapsed:2:41:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1088: grad_norm=3.3270723819732666, loss=0.3459117114543915, param_norm=1887.1279296875
Step 1089: grad_norm=2.640345335006714, loss=0.3058798313140869, param_norm=1887.1279296875
03:53:59.777 [I] Progress on: 1.09kit/2.00kit rate:8.8s/it remaining:2:13:54 elapsed:2:41:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1090: grad_norm=3.208817481994629, loss=0.31964993476867676, param_norm=1887.1280517578125
Step 1091: grad_norm=2.7117984294891357, loss=0.3348728120326996, param_norm=1887.1280517578125
03:54:17.327 [I] Progress on: 1.09kit/2.00kit rate:8.8s/it remaining:2:13:17 elapsed:2:41:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1092: grad_norm=2.6215407848358154, loss=0.3347027599811554, param_norm=1887.1280517578125
Step 1093: grad_norm=2.6288416385650635, loss=0.3548443913459778, param_norm=1887.1280517578125
03:54:34.878 [I] Progress on: 1.09kit/2.00kit rate:8.8s/it remaining:2:12:50 elapsed:2:41:57 postfix:- (3802351:tqdm_logging.py:145)
Step 1094: grad_norm=2.5357532501220703, loss=0.32912832498550415, param_norm=1887.1280517578125
Step 1095: grad_norm=2.6226468086242676, loss=0.32266443967819214, param_norm=1887.1280517578125
03:54:52.520 [I] Progress on: 1.09kit/2.00kit rate:8.8s/it remaining:2:12:49 elapsed:2:42:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1096: grad_norm=2.4080088138580322, loss=0.26169151067733765, param_norm=1887.1280517578125
Step 1097: grad_norm=3.068835973739624, loss=0.3538591265678406, param_norm=1887.1282958984375
03:55:10.092 [I] Progress on: 1.10kit/2.00kit rate:8.8s/it remaining:2:12:21 elapsed:2:42:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1098: grad_norm=2.5671744346618652, loss=0.33149778842926025, param_norm=1887.1282958984375
Step 1099: grad_norm=2.634685516357422, loss=0.29880258440971375, param_norm=1887.1282958984375
03:55:27.744 [I] Progress on: 1.10kit/2.00kit rate:8.8s/it remaining:2:12:13 elapsed:2:42:50 postfix:- (3802351:tqdm_logging.py:145)
Step 1100: grad_norm=2.723700523376465, loss=0.30862659215927124, param_norm=1887.1282958984375
03:55:36.798 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
03:55:36.798 [I] [process=0][thread=MainThread][step=1000][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
03:55:36.798 [I] [process=0][thread=MainThread][step=1000][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1000. (3802351:checkpoint_manager.py:1786)
03:55:36.799 [I] [process=0][thread=MainThread][step=1000][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1000, also errors if any. (3802351:checkpoint_manager.py:1817)
03:55:36.799 [I] [process=0] Saving checkpoint at step 1100                                       (3802351:checkpoint_manager.py:1286)
03:55:36.800 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100. (3802351:async_checkpointer.py:358)
03:55:36.802 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:55:36.802 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30 (3802351:atomicity.py:144)
03:55:36.803 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:55:36.804 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
03:55:36.806 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30/assets.orbax-checkpoint-tmp-31 (3802351:atomicity.py:144)
03:55:36.806 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30/params.orbax-checkpoint-tmp-32 (3802351:atomicity.py:144)
03:55:36.807 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
03:55:36.813 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
03:55:40.646 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
03:55:40.647 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:55:40.649 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
03:55:40.650 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
03:55:40.695 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.696 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.697 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.704 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.705 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.706 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.709 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.709 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.711 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.713 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
03:55:40.715 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
03:55:40.716 [I] [process=0][thread=MainThread][step=1100] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
03:55:40.718 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
03:55:40.719 [I] {'step': 1100, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742802936.7982686, 'wait_for_prev_duration_secs': 0.0011913776397705078, 'checkpointer_blocking_start_time': 1742802936.8001049, 'checkpointer_blocking_duration_secs': 3.8955116271972656, 'get_old_steps_start_time': 1742802940.6956668, 'get_old_steps_duration_secs': 0.019515275955200195, 'checkpoint_manager_blocking_start_time': 1742802936.7980964, 'checkpoint_manager_blocking_duration_secs': 3.921121597290039} (3802351:standard_logger.py:34)
03:55:40.722 [I] Progress on: 1.10kit/2.00kit rate:10.0s/it remaining:2:29:47 elapsed:2:43:03 postfix:- (3802351:tqdm_logging.py:145)
03:55:48.157 [I] ChainedFuture completed 1/1 futures in 7.49 seconds.                             (3802351:future.py:137)
03:55:48.158 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 912.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
03:55:48.158 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
03:55:48.160 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30 (3802351:async_checkpointer.py:406)
03:55:48.161 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30/assets.orbax-checkpoint-tmp-31 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30/assets (3802351:atomicity.py:287)
03:55:48.173 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30/params.orbax-checkpoint-tmp-32 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30/params (3802351:atomicity.py:287)
03:55:48.174 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100 (3802351:async_checkpointer.py:416)
03:55:48.174 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30 (3802351:async_checkpointer.py:426)
03:55:48.175 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100.orbax-checkpoint-tmp-30 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100 (3802351:atomicity.py:287)
03:55:48.176 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1100`. (3802351:atomicity.py:548)
03:55:48.177 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
03:55:48.177 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
03:55:48.178 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
03:55:48.178 [I] [process=0][thread=save_finalize][step=1100] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
03:55:48.179 [I] [process=0][thread=save_finalize][step=1100] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1101: grad_norm=2.741867780685425, loss=0.35833439230918884, param_norm=1887.1282958984375
Step 1102: grad_norm=2.42370343208313, loss=0.2980443835258484, param_norm=1887.1282958984375
03:55:58.089 [I] Progress on: 1.10kit/2.00kit rate:9.6s/it remaining:2:24:06 elapsed:2:43:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1103: grad_norm=2.998722553253174, loss=0.29266440868377686, param_norm=1887.1282958984375
03:56:09.470 [I] Progress on: 1.10kit/2.00kit rate:9.9s/it remaining:2:28:08 elapsed:2:43:32 postfix:- (3802351:tqdm_logging.py:145)
Step 1104: grad_norm=2.429030179977417, loss=0.28479254245758057, param_norm=1887.1282958984375
Step 1105: grad_norm=2.517944812774658, loss=0.31007465720176697, param_norm=1887.1282958984375
03:56:26.830 [I] Progress on: 1.10kit/2.00kit rate:9.6s/it remaining:2:22:51 elapsed:2:43:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1106: grad_norm=2.424161672592163, loss=0.2878583073616028, param_norm=1887.1282958984375
Step 1107: grad_norm=2.9257402420043945, loss=0.36768001317977905, param_norm=1887.1282958984375
03:56:44.372 [I] Progress on: 1.11kit/2.00kit rate:9.2s/it remaining:2:16:21 elapsed:2:44:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1108: grad_norm=2.2755508422851562, loss=0.311107873916626, param_norm=1887.1282958984375
Step 1109: grad_norm=3.4787404537200928, loss=0.31758254766464233, param_norm=1887.1282958984375
03:57:01.925 [I] Progress on: 1.11kit/2.00kit rate:9.0s/it remaining:2:13:08 elapsed:2:44:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1110: grad_norm=2.370983600616455, loss=0.3001878261566162, param_norm=1887.1282958984375
Step 1111: grad_norm=2.3568782806396484, loss=0.31699255108833313, param_norm=1887.1282958984375
03:57:19.479 [I] Progress on: 1.11kit/2.00kit rate:8.9s/it remaining:2:11:25 elapsed:2:44:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1112: grad_norm=2.3358895778656006, loss=0.24856050312519073, param_norm=1887.1282958984375
Step 1113: grad_norm=2.5850419998168945, loss=0.2782159149646759, param_norm=1887.1282958984375
03:57:37.026 [I] Progress on: 1.11kit/2.00kit rate:8.8s/it remaining:2:10:22 elapsed:2:45:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1114: grad_norm=2.5451323986053467, loss=0.2992892265319824, param_norm=1887.1282958984375
Step 1115: grad_norm=2.4354615211486816, loss=0.32187336683273315, param_norm=1887.1282958984375
03:57:54.590 [I] Progress on: 1.11kit/2.00kit rate:8.8s/it remaining:2:09:51 elapsed:2:45:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1116: grad_norm=2.8248860836029053, loss=0.29185858368873596, param_norm=1887.12841796875
Step 1117: grad_norm=2.3135106563568115, loss=0.3160422444343567, param_norm=1887.1282958984375
03:58:12.184 [I] Progress on: 1.12kit/2.00kit rate:8.8s/it remaining:2:09:26 elapsed:2:45:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1118: grad_norm=3.0714454650878906, loss=0.35728639364242554, param_norm=1887.1282958984375
Step 1119: grad_norm=2.1115148067474365, loss=0.2992994487285614, param_norm=1887.12841796875
03:58:29.754 [I] Progress on: 1.12kit/2.00kit rate:8.8s/it remaining:2:09:08 elapsed:2:45:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1120: grad_norm=2.9843876361846924, loss=0.3708828389644623, param_norm=1887.12841796875
Step 1121: grad_norm=2.6071343421936035, loss=0.2697193920612335, param_norm=1887.12841796875
03:58:47.305 [I] Progress on: 1.12kit/2.00kit rate:8.8s/it remaining:2:08:39 elapsed:2:46:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1122: grad_norm=2.7827866077423096, loss=0.3271867036819458, param_norm=1887.12841796875
Step 1123: grad_norm=3.3992257118225098, loss=0.4034268260002136, param_norm=1887.12841796875
03:59:04.916 [I] Progress on: 1.12kit/2.00kit rate:8.8s/it remaining:2:08:29 elapsed:2:46:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1124: grad_norm=2.5350160598754883, loss=0.2589508891105652, param_norm=1887.12841796875
Step 1125: grad_norm=3.0713398456573486, loss=0.3468632102012634, param_norm=1887.12841796875
03:59:22.506 [I] Progress on: 1.12kit/2.00kit rate:8.8s/it remaining:2:08:15 elapsed:2:46:45 postfix:- (3802351:tqdm_logging.py:145)
Step 1126: grad_norm=2.3628056049346924, loss=0.2608445882797241, param_norm=1887.1285400390625
Step 1127: grad_norm=2.717827796936035, loss=0.28967541456222534, param_norm=1887.1285400390625
03:59:40.093 [I] Progress on: 1.13kit/2.00kit rate:8.8s/it remaining:2:07:58 elapsed:2:47:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1128: grad_norm=3.2985002994537354, loss=0.3663637340068817, param_norm=1887.1285400390625
Step 1129: grad_norm=2.7278926372528076, loss=0.29643943905830383, param_norm=1887.1285400390625
03:59:57.669 [I] Progress on: 1.13kit/2.00kit rate:8.8s/it remaining:2:07:33 elapsed:2:47:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1130: grad_norm=3.333303213119507, loss=0.4107832610607147, param_norm=1887.1285400390625
Step 1131: grad_norm=2.816880464553833, loss=0.3303760588169098, param_norm=1887.1285400390625
04:00:15.269 [I] Progress on: 1.13kit/2.00kit rate:8.8s/it remaining:2:07:20 elapsed:2:47:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1132: grad_norm=2.9580118656158447, loss=0.340374618768692, param_norm=1887.1285400390625
Step 1133: grad_norm=3.0054123401641846, loss=0.33393603563308716, param_norm=1887.1285400390625
04:00:32.906 [I] Progress on: 1.13kit/2.00kit rate:8.8s/it remaining:2:07:13 elapsed:2:47:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1134: grad_norm=2.2840523719787598, loss=0.2999081015586853, param_norm=1887.1285400390625
Step 1135: grad_norm=2.9740381240844727, loss=0.3136330246925354, param_norm=1887.1285400390625
04:00:50.510 [I] Progress on: 1.14kit/2.00kit rate:8.8s/it remaining:2:06:56 elapsed:2:48:13 postfix:- (3802351:tqdm_logging.py:145)
Step 1136: grad_norm=3.391817569732666, loss=0.3263203203678131, param_norm=1887.1285400390625
Step 1137: grad_norm=2.929891347885132, loss=0.3220289349555969, param_norm=1887.1285400390625
04:01:08.126 [I] Progress on: 1.14kit/2.00kit rate:8.8s/it remaining:2:06:42 elapsed:2:48:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1138: grad_norm=3.4072763919830322, loss=0.3428254723548889, param_norm=1887.1285400390625
Step 1139: grad_norm=2.6204702854156494, loss=0.30142802000045776, param_norm=1887.1285400390625
04:01:25.672 [I] Progress on: 1.14kit/2.00kit rate:8.8s/it remaining:2:06:07 elapsed:2:48:48 postfix:- (3802351:tqdm_logging.py:145)
Step 1140: grad_norm=2.808307647705078, loss=0.37266606092453003, param_norm=1887.128662109375
Step 1141: grad_norm=2.4811363220214844, loss=0.23389609158039093, param_norm=1887.128662109375
04:01:43.268 [I] Progress on: 1.14kit/2.00kit rate:8.8s/it remaining:2:05:53 elapsed:2:49:06 postfix:- (3802351:tqdm_logging.py:145)
Step 1142: grad_norm=2.7318179607391357, loss=0.3016730844974518, param_norm=1887.128662109375
Step 1143: grad_norm=3.2599635124206543, loss=0.3725926876068115, param_norm=1887.128662109375
04:02:00.884 [I] Progress on: 1.14kit/2.00kit rate:8.8s/it remaining:2:05:43 elapsed:2:49:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1144: grad_norm=3.23911190032959, loss=0.2848197817802429, param_norm=1887.128662109375
Step 1145: grad_norm=3.3529276847839355, loss=0.38604581356048584, param_norm=1887.128662109375
04:02:18.486 [I] Progress on: 1.15kit/2.00kit rate:8.8s/it remaining:2:05:26 elapsed:2:49:41 postfix:- (3802351:tqdm_logging.py:145)
Step 1146: grad_norm=2.7333593368530273, loss=0.3386872708797455, param_norm=1887.128662109375
Step 1147: grad_norm=3.2704527378082275, loss=0.3675306737422943, param_norm=1887.128662109375
04:02:36.092 [I] Progress on: 1.15kit/2.00kit rate:8.8s/it remaining:2:05:12 elapsed:2:49:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1148: grad_norm=3.5376107692718506, loss=0.38425010442733765, param_norm=1887.128662109375
Step 1149: grad_norm=2.9610471725463867, loss=0.3546868860721588, param_norm=1887.128662109375
04:02:53.641 [I] Progress on: 1.15kit/2.00kit rate:8.8s/it remaining:2:04:38 elapsed:2:50:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1150: grad_norm=3.0782504081726074, loss=0.3018619418144226, param_norm=1887.128662109375
Step 1151: grad_norm=3.1233577728271484, loss=0.27520155906677246, param_norm=1887.128662109375
04:03:11.209 [I] Progress on: 1.15kit/2.00kit rate:8.8s/it remaining:2:04:19 elapsed:2:50:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1152: grad_norm=2.304980754852295, loss=0.3002386689186096, param_norm=1887.128662109375
Step 1153: grad_norm=2.7562501430511475, loss=0.3058529794216156, param_norm=1887.128662109375
04:03:28.798 [I] Progress on: 1.15kit/2.00kit rate:8.8s/it remaining:2:04:05 elapsed:2:50:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1154: grad_norm=3.1157867908477783, loss=0.35224634408950806, param_norm=1887.128662109375
Step 1155: grad_norm=2.9194438457489014, loss=0.3314189016819, param_norm=1887.128662109375
04:03:46.368 [I] Progress on: 1.16kit/2.00kit rate:8.8s/it remaining:2:03:44 elapsed:2:51:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1156: grad_norm=4.3856401443481445, loss=0.343835711479187, param_norm=1887.128662109375
Step 1157: grad_norm=3.366302490234375, loss=0.2849563956260681, param_norm=1887.128662109375
04:04:03.920 [I] Progress on: 1.16kit/2.00kit rate:8.8s/it remaining:2:03:18 elapsed:2:51:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1158: grad_norm=2.5963151454925537, loss=0.3467552065849304, param_norm=1887.128662109375
Step 1159: grad_norm=2.9149997234344482, loss=0.3126682639122009, param_norm=1887.128662109375
04:04:21.465 [I] Progress on: 1.16kit/2.00kit rate:8.8s/it remaining:2:03:00 elapsed:2:51:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1160: grad_norm=3.6212525367736816, loss=0.3813982605934143, param_norm=1887.128662109375
Step 1161: grad_norm=3.5229380130767822, loss=0.32145264744758606, param_norm=1887.128662109375
04:04:39.079 [I] Progress on: 1.16kit/2.00kit rate:8.8s/it remaining:2:02:55 elapsed:2:52:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1162: grad_norm=3.383150815963745, loss=0.27353572845458984, param_norm=1887.128662109375
Step 1163: grad_norm=3.264122724533081, loss=0.3340337574481964, param_norm=1887.128662109375
04:04:56.662 [I] Progress on: 1.16kit/2.00kit rate:8.8s/it remaining:2:02:38 elapsed:2:52:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1164: grad_norm=3.2725183963775635, loss=0.3353714346885681, param_norm=1887.1287841796875
Step 1165: grad_norm=2.715092420578003, loss=0.29405659437179565, param_norm=1887.1287841796875
04:05:14.287 [I] Progress on: 1.17kit/2.00kit rate:8.8s/it remaining:2:02:27 elapsed:2:52:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1166: grad_norm=2.9788341522216797, loss=0.3027492165565491, param_norm=1887.1287841796875
Step 1167: grad_norm=3.1880202293395996, loss=0.31359177827835083, param_norm=1887.1287841796875
04:05:31.956 [I] Progress on: 1.17kit/2.00kit rate:8.8s/it remaining:2:02:26 elapsed:2:52:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1168: grad_norm=3.332199811935425, loss=0.33309081196784973, param_norm=1887.1287841796875
Step 1169: grad_norm=2.8676869869232178, loss=0.2960830628871918, param_norm=1887.1287841796875
04:05:49.580 [I] Progress on: 1.17kit/2.00kit rate:8.8s/it remaining:2:02:06 elapsed:2:53:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1170: grad_norm=3.4209330081939697, loss=0.2711646556854248, param_norm=1887.1287841796875
Step 1171: grad_norm=3.3025734424591064, loss=0.3068592846393585, param_norm=1887.1287841796875
04:06:07.201 [I] Progress on: 1.17kit/2.00kit rate:8.8s/it remaining:2:01:46 elapsed:2:53:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1172: grad_norm=2.4137885570526123, loss=0.293835312128067, param_norm=1887.1287841796875
04:06:18.636 [I] Progress on: 1.17kit/2.00kit rate:9.5s/it remaining:2:11:27 elapsed:2:53:41 postfix:- (3802351:tqdm_logging.py:145)
Step 1173: grad_norm=2.1017720699310303, loss=0.2424732744693756, param_norm=1887.1287841796875
Step 1174: grad_norm=2.5206682682037354, loss=0.31724244356155396, param_norm=1887.1287841796875
04:06:36.242 [I] Progress on: 1.17kit/2.00kit rate:9.4s/it remaining:2:09:07 elapsed:2:53:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1175: grad_norm=2.385712146759033, loss=0.3018169403076172, param_norm=1887.1287841796875
Step 1176: grad_norm=2.3640148639678955, loss=0.2744278311729431, param_norm=1887.12890625
04:06:53.884 [I] Progress on: 1.18kit/2.00kit rate:9.1s/it remaining:2:04:52 elapsed:2:54:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1177: grad_norm=2.4844961166381836, loss=0.33419069647789, param_norm=1887.12890625
Step 1178: grad_norm=2.9632749557495117, loss=0.33554044365882874, param_norm=1887.12890625
04:07:11.402 [I] Progress on: 1.18kit/2.00kit rate:8.9s/it remaining:2:02:16 elapsed:2:54:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1179: grad_norm=2.780296802520752, loss=0.329712837934494, param_norm=1887.12890625
Step 1180: grad_norm=3.0703370571136475, loss=0.31709539890289307, param_norm=1887.12890625
04:07:28.967 [I] Progress on: 1.18kit/2.00kit rate:8.9s/it remaining:2:00:58 elapsed:2:54:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1181: grad_norm=2.841024160385132, loss=0.3259640336036682, param_norm=1887.12890625
Step 1182: grad_norm=2.846073627471924, loss=0.29727327823638916, param_norm=1887.12890625
04:07:46.581 [I] Progress on: 1.18kit/2.00kit rate:8.8s/it remaining:2:00:22 elapsed:2:55:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1183: grad_norm=2.850846529006958, loss=0.3545507788658142, param_norm=1887.12890625
Step 1184: grad_norm=2.6348037719726562, loss=0.3253023624420166, param_norm=1887.1290283203125
04:08:04.132 [I] Progress on: 1.18kit/2.00kit rate:8.8s/it remaining:1:59:42 elapsed:2:55:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1185: grad_norm=2.481715440750122, loss=0.3229130506515503, param_norm=1887.12890625
Step 1186: grad_norm=2.439739465713501, loss=0.2649378180503845, param_norm=1887.12890625
04:08:21.759 [I] Progress on: 1.19kit/2.00kit rate:8.8s/it remaining:1:59:31 elapsed:2:55:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1187: grad_norm=2.447885036468506, loss=0.28995463252067566, param_norm=1887.1290283203125
Step 1188: grad_norm=3.058042049407959, loss=0.3106269836425781, param_norm=1887.1290283203125
04:08:39.353 [I] Progress on: 1.19kit/2.00kit rate:8.8s/it remaining:1:59:12 elapsed:2:56:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1189: grad_norm=3.239032030105591, loss=0.3013879656791687, param_norm=1887.1290283203125
Step 1190: grad_norm=2.994878053665161, loss=0.3162289261817932, param_norm=1887.1290283203125
04:08:56.964 [I] Progress on: 1.19kit/2.00kit rate:8.8s/it remaining:1:58:51 elapsed:2:56:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1191: grad_norm=3.016244411468506, loss=0.32594573497772217, param_norm=1887.1290283203125
Step 1192: grad_norm=3.0629639625549316, loss=0.3349073529243469, param_norm=1887.1290283203125
04:09:14.545 [I] Progress on: 1.19kit/2.00kit rate:8.8s/it remaining:1:58:31 elapsed:2:56:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1193: grad_norm=3.0429139137268066, loss=0.2533680200576782, param_norm=1887.1290283203125
Step 1194: grad_norm=3.0214662551879883, loss=0.31431931257247925, param_norm=1887.1290283203125
04:09:32.147 [I] Progress on: 1.19kit/2.00kit rate:8.8s/it remaining:1:58:13 elapsed:2:56:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1195: grad_norm=2.90946626663208, loss=0.3012167513370514, param_norm=1887.1290283203125
Step 1196: grad_norm=3.2793853282928467, loss=0.3180930018424988, param_norm=1887.1290283203125
04:09:49.759 [I] Progress on: 1.20kit/2.00kit rate:8.8s/it remaining:1:57:57 elapsed:2:57:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1197: grad_norm=2.598032236099243, loss=0.32744842767715454, param_norm=1887.129150390625
Step 1198: grad_norm=3.483966827392578, loss=0.3355461359024048, param_norm=1887.129150390625
04:10:07.384 [I] Progress on: 1.20kit/2.00kit rate:8.8s/it remaining:1:57:44 elapsed:2:57:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1199: grad_norm=2.5090157985687256, loss=0.29497289657592773, param_norm=1887.129150390625
Step 1200: grad_norm=3.0847513675689697, loss=0.29062116146087646, param_norm=1887.129150390625
04:10:25.036 [I] Progress on: 1.20kit/2.00kit rate:8.8s/it remaining:1:57:35 elapsed:2:57:48 postfix:- (3802351:tqdm_logging.py:145)
04:10:25.220 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
04:10:25.220 [I] [process=0][thread=MainThread][step=1100][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
04:10:25.220 [I] [process=0][thread=MainThread][step=1100][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1100. (3802351:checkpoint_manager.py:1786)
04:10:25.220 [I] [process=0][thread=MainThread][step=1100][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1100, also errors if any. (3802351:checkpoint_manager.py:1817)
04:10:25.221 [I] [process=0] Saving checkpoint at step 1200                                       (3802351:checkpoint_manager.py:1286)
04:10:25.222 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200. (3802351:async_checkpointer.py:358)
04:10:25.223 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:10:25.224 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33 (3802351:atomicity.py:144)
04:10:25.225 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:10:25.225 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:10:25.227 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33/assets.orbax-checkpoint-tmp-34 (3802351:atomicity.py:144)
04:10:25.227 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33/params.orbax-checkpoint-tmp-35 (3802351:atomicity.py:144)
04:10:25.229 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:10:25.234 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
04:10:31.193 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
04:10:31.194 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 5 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:10:31.195 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
04:10:31.196 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
04:10:31.220 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.222 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.228 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.229 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.233 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.235 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.237 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.238 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.245 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.247 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.248 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:10:31.250 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
04:10:31.250 [I] [process=0][thread=MainThread][step=1200] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
04:10:31.255 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
04:10:31.255 [I] {'step': 1200, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742803825.220133, 'wait_for_prev_duration_secs': 0.0007374286651611328, 'checkpointer_blocking_start_time': 1742803825.221519, 'checkpointer_blocking_duration_secs': 5.9986183643341064, 'get_old_steps_start_time': 1742803831.22019, 'get_old_steps_duration_secs': 0.030367374420166016, 'checkpoint_manager_blocking_start_time': 1742803825.2199736, 'checkpoint_manager_blocking_duration_secs': 6.035233497619629} (3802351:standard_logger.py:34)
04:10:39.002 [I] ChainedFuture completed 1/1 futures in 7.80 seconds.                             (3802351:future.py:137)
04:10:39.003 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 752.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 13 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:10:39.003 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
04:10:39.005 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33 (3802351:async_checkpointer.py:406)
04:10:39.005 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33/assets.orbax-checkpoint-tmp-34 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33/assets (3802351:atomicity.py:287)
04:10:39.019 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33/params.orbax-checkpoint-tmp-35 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33/params (3802351:atomicity.py:287)
04:10:39.020 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200 (3802351:async_checkpointer.py:416)
04:10:39.020 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33 (3802351:async_checkpointer.py:426)
04:10:39.020 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200.orbax-checkpoint-tmp-33 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200 (3802351:atomicity.py:287)
04:10:39.022 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1200`. (3802351:atomicity.py:548)
04:10:39.023 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
04:10:39.023 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
04:10:39.024 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
04:10:39.024 [I] [process=0][thread=save_finalize][step=1200] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
04:10:39.024 [I] [process=0][thread=save_finalize][step=1200] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1201: grad_norm=2.6940433979034424, loss=0.3227693438529968, param_norm=1887.129150390625
04:10:39.834 [I] Progress on: 1.20kit/2.00kit rate:10.6s/it remaining:2:21:27 elapsed:2:58:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1202: grad_norm=2.5077710151672363, loss=0.30764660239219666, param_norm=1887.129150390625
Step 1203: grad_norm=3.344688653945923, loss=0.321562796831131, param_norm=1887.129150390625
04:10:57.398 [I] Progress on: 1.20kit/2.00kit rate:9.7s/it remaining:2:08:34 elapsed:2:58:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1204: grad_norm=2.234189033508301, loss=0.2739284038543701, param_norm=1887.129150390625
Step 1205: grad_norm=2.880171537399292, loss=0.30864855647087097, param_norm=1887.129150390625
04:11:14.993 [I] Progress on: 1.21kit/2.00kit rate:9.2s/it remaining:2:02:13 elapsed:2:58:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1206: grad_norm=2.738416910171509, loss=0.36807215213775635, param_norm=1887.129150390625
Step 1207: grad_norm=2.644679546356201, loss=0.288358598947525, param_norm=1887.129150390625
04:11:32.627 [I] Progress on: 1.21kit/2.00kit rate:9.0s/it remaining:1:59:07 elapsed:2:58:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1208: grad_norm=2.8275034427642822, loss=0.29950225353240967, param_norm=1887.1292724609375
Step 1209: grad_norm=2.8128881454467773, loss=0.2772302031517029, param_norm=1887.1292724609375
04:11:50.257 [I] Progress on: 1.21kit/2.00kit rate:8.9s/it remaining:1:57:26 elapsed:2:59:13 postfix:- (3802351:tqdm_logging.py:145)
Step 1210: grad_norm=3.497361183166504, loss=0.37904128432273865, param_norm=1887.1292724609375
Step 1211: grad_norm=2.7600345611572266, loss=0.2833191752433777, param_norm=1887.1292724609375
04:12:07.891 [I] Progress on: 1.21kit/2.00kit rate:8.9s/it remaining:1:56:31 elapsed:2:59:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1212: grad_norm=3.0508718490600586, loss=0.3103422522544861, param_norm=1887.1292724609375
Step 1213: grad_norm=2.4419243335723877, loss=0.26753905415534973, param_norm=1887.1292724609375
04:12:25.546 [I] Progress on: 1.21kit/2.00kit rate:8.8s/it remaining:1:55:59 elapsed:2:59:48 postfix:- (3802351:tqdm_logging.py:145)
Step 1214: grad_norm=3.218825340270996, loss=0.3109055161476135, param_norm=1887.1292724609375
Step 1215: grad_norm=3.0641753673553467, loss=0.2740846574306488, param_norm=1887.1292724609375
04:12:43.165 [I] Progress on: 1.22kit/2.00kit rate:8.8s/it remaining:1:55:28 elapsed:3:00:06 postfix:- (3802351:tqdm_logging.py:145)
Step 1216: grad_norm=3.1543257236480713, loss=0.3309594392776489, param_norm=1887.1292724609375
Step 1217: grad_norm=3.1883678436279297, loss=0.2954062223434448, param_norm=1887.1292724609375
04:13:00.778 [I] Progress on: 1.22kit/2.00kit rate:8.8s/it remaining:1:55:04 elapsed:3:00:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1218: grad_norm=2.377195119857788, loss=0.29823294281959534, param_norm=1887.1292724609375
Step 1219: grad_norm=2.5305511951446533, loss=0.2622753381729126, param_norm=1887.1292724609375
04:13:18.419 [I] Progress on: 1.22kit/2.00kit rate:8.8s/it remaining:1:54:46 elapsed:3:00:41 postfix:- (3802351:tqdm_logging.py:145)
Step 1220: grad_norm=2.809326648712158, loss=0.3320327699184418, param_norm=1887.1292724609375
Step 1221: grad_norm=3.086806535720825, loss=0.3753429055213928, param_norm=1887.1292724609375
04:13:36.014 [I] Progress on: 1.22kit/2.00kit rate:8.8s/it remaining:1:54:17 elapsed:3:00:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1222: grad_norm=2.681659698486328, loss=0.3109185993671417, param_norm=1887.1292724609375
Step 1223: grad_norm=2.994188070297241, loss=0.343564510345459, param_norm=1887.1292724609375
04:13:53.633 [I] Progress on: 1.22kit/2.00kit rate:8.8s/it remaining:1:54:01 elapsed:3:01:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1224: grad_norm=2.741492509841919, loss=0.2931991219520569, param_norm=1887.1292724609375
Step 1225: grad_norm=2.2393617630004883, loss=0.25790220499038696, param_norm=1887.1292724609375
04:14:11.318 [I] Progress on: 1.23kit/2.00kit rate:8.8s/it remaining:1:53:57 elapsed:3:01:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1226: grad_norm=2.7028682231903076, loss=0.30235856771469116, param_norm=1887.1292724609375
Step 1227: grad_norm=1.996246576309204, loss=0.23663245141506195, param_norm=1887.1292724609375
04:14:28.939 [I] Progress on: 1.23kit/2.00kit rate:8.8s/it remaining:1:53:33 elapsed:3:01:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1228: grad_norm=2.4345929622650146, loss=0.2958548367023468, param_norm=1887.1292724609375
Step 1229: grad_norm=2.5531797409057617, loss=0.258675754070282, param_norm=1887.1292724609375
04:14:46.539 [I] Progress on: 1.23kit/2.00kit rate:8.8s/it remaining:1:53:10 elapsed:3:02:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1230: grad_norm=2.598625898361206, loss=0.2547694444656372, param_norm=1887.12939453125
Step 1231: grad_norm=2.725820779800415, loss=0.3171885907649994, param_norm=1887.12939453125
04:15:04.132 [I] Progress on: 1.23kit/2.00kit rate:8.8s/it remaining:1:52:47 elapsed:3:02:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1232: grad_norm=2.8731446266174316, loss=0.30444926023483276, param_norm=1887.12939453125
Step 1233: grad_norm=3.0317599773406982, loss=0.33780062198638916, param_norm=1887.12939453125
04:15:21.700 [I] Progress on: 1.23kit/2.00kit rate:8.8s/it remaining:1:52:26 elapsed:3:02:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1234: grad_norm=3.099439859390259, loss=0.34731096029281616, param_norm=1887.12939453125
Step 1235: grad_norm=2.5158069133758545, loss=0.3118174374103546, param_norm=1887.12939453125
04:15:39.347 [I] Progress on: 1.24kit/2.00kit rate:8.8s/it remaining:1:52:18 elapsed:3:03:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1236: grad_norm=2.7981817722320557, loss=0.2849026322364807, param_norm=1887.12939453125
Step 1237: grad_norm=2.859358549118042, loss=0.2838573455810547, param_norm=1887.12939453125
04:15:57.010 [I] Progress on: 1.24kit/2.00kit rate:8.8s/it remaining:1:52:07 elapsed:3:03:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1238: grad_norm=2.8041622638702393, loss=0.3625566363334656, param_norm=1887.1295166015625
Step 1239: grad_norm=2.615814208984375, loss=0.26978805661201477, param_norm=1887.1295166015625
04:16:14.673 [I] Progress on: 1.24kit/2.00kit rate:8.8s/it remaining:1:51:54 elapsed:3:03:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1240: grad_norm=2.7457399368286133, loss=0.3041871190071106, param_norm=1887.1295166015625
Step 1241: grad_norm=2.7858827114105225, loss=0.26521730422973633, param_norm=1887.1295166015625
04:16:32.284 [I] Progress on: 1.24kit/2.00kit rate:8.8s/it remaining:1:51:27 elapsed:3:03:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1242: grad_norm=2.3952295780181885, loss=0.21797463297843933, param_norm=1887.1295166015625
04:16:46.479 [I] Progress on: 1.24kit/2.00kit rate:10.4s/it remaining:2:11:53 elapsed:3:04:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1243: grad_norm=3.1384551525115967, loss=0.2728186547756195, param_norm=1887.1295166015625
Step 1244: grad_norm=2.4901723861694336, loss=0.31661227345466614, param_norm=1887.1295166015625
04:17:04.022 [I] Progress on: 1.24kit/2.00kit rate:9.6s/it remaining:2:00:50 elapsed:3:04:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1245: grad_norm=3.1483943462371826, loss=0.3088732957839966, param_norm=1887.1295166015625
Step 1246: grad_norm=3.1364099979400635, loss=0.3012966513633728, param_norm=1887.1295166015625
04:17:21.603 [I] Progress on: 1.25kit/2.00kit rate:9.2s/it remaining:1:55:28 elapsed:3:04:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1247: grad_norm=2.919541835784912, loss=0.3135739266872406, param_norm=1887.1295166015625
Step 1248: grad_norm=2.3476836681365967, loss=0.2457043081521988, param_norm=1887.1295166015625
04:17:39.179 [I] Progress on: 1.25kit/2.00kit rate:9.0s/it remaining:1:52:37 elapsed:3:05:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1249: grad_norm=3.0106658935546875, loss=0.3524065315723419, param_norm=1887.1295166015625
Step 1250: grad_norm=2.6343626976013184, loss=0.307530015707016, param_norm=1887.129638671875
04:17:56.771 [I] Progress on: 1.25kit/2.00kit rate:8.9s/it remaining:1:51:12 elapsed:3:05:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1251: grad_norm=4.264949321746826, loss=0.3479645550251007, param_norm=1887.129638671875
Step 1252: grad_norm=2.1175808906555176, loss=0.2338208258152008, param_norm=1887.129638671875
04:18:14.348 [I] Progress on: 1.25kit/2.00kit rate:8.8s/it remaining:1:50:16 elapsed:3:05:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1253: grad_norm=2.8382785320281982, loss=0.33124256134033203, param_norm=1887.129638671875
Step 1254: grad_norm=3.1568241119384766, loss=0.2949932813644409, param_norm=1887.129638671875
04:18:32.013 [I] Progress on: 1.25kit/2.00kit rate:8.8s/it remaining:1:49:58 elapsed:3:05:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1255: grad_norm=2.900956392288208, loss=0.22776928544044495, param_norm=1887.129638671875
Step 1256: grad_norm=2.641202211380005, loss=0.30020976066589355, param_norm=1887.129638671875
04:18:49.672 [I] Progress on: 1.26kit/2.00kit rate:8.8s/it remaining:1:49:39 elapsed:3:06:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1257: grad_norm=2.4135215282440186, loss=0.24259234964847565, param_norm=1887.129638671875
Step 1258: grad_norm=2.999312162399292, loss=0.32636207342147827, param_norm=1887.129638671875
04:19:07.345 [I] Progress on: 1.26kit/2.00kit rate:8.8s/it remaining:1:49:23 elapsed:3:06:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1259: grad_norm=3.3058793544769287, loss=0.3388296365737915, param_norm=1887.129638671875
Step 1260: grad_norm=2.5555031299591064, loss=0.3165440559387207, param_norm=1887.129638671875
04:19:24.967 [I] Progress on: 1.26kit/2.00kit rate:8.8s/it remaining:1:48:54 elapsed:3:06:48 postfix:- (3802351:tqdm_logging.py:145)
Step 1261: grad_norm=2.900439500808716, loss=0.24241752922534943, param_norm=1887.1297607421875
Step 1262: grad_norm=3.363598108291626, loss=0.3075988292694092, param_norm=1887.1297607421875
04:19:42.897 [I] Progress on: 1.26kit/2.00kit rate:8.8s/it remaining:1:48:36 elapsed:3:07:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1263: grad_norm=3.3088197708129883, loss=0.34254592657089233, param_norm=1887.1297607421875
Step 1264: grad_norm=3.6123485565185547, loss=0.34260380268096924, param_norm=1887.1297607421875
04:20:00.609 [I] Progress on: 1.26kit/2.00kit rate:8.9s/it remaining:1:49:21 elapsed:3:07:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1265: grad_norm=3.6757655143737793, loss=0.26178473234176636, param_norm=1887.1297607421875
Step 1266: grad_norm=2.91753888130188, loss=0.28420960903167725, param_norm=1887.1297607421875
04:20:18.293 [I] Progress on: 1.27kit/2.00kit rate:8.9s/it remaining:1:48:39 elapsed:3:07:41 postfix:- (3802351:tqdm_logging.py:145)
Step 1267: grad_norm=2.338416337966919, loss=0.2508038282394409, param_norm=1887.1297607421875
Step 1268: grad_norm=2.5841386318206787, loss=0.28198927640914917, param_norm=1887.1297607421875
04:20:35.984 [I] Progress on: 1.27kit/2.00kit rate:8.9s/it remaining:1:48:13 elapsed:3:07:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1269: grad_norm=2.5187747478485107, loss=0.27602794766426086, param_norm=1887.1297607421875
Step 1270: grad_norm=2.9469408988952637, loss=0.2987830638885498, param_norm=1887.1297607421875
04:20:53.619 [I] Progress on: 1.27kit/2.00kit rate:8.8s/it remaining:1:47:37 elapsed:3:08:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1271: grad_norm=2.964895725250244, loss=0.3360017240047455, param_norm=1887.1297607421875
Step 1272: grad_norm=3.3728442192077637, loss=0.3476147949695587, param_norm=1887.1298828125
04:21:11.240 [I] Progress on: 1.27kit/2.00kit rate:8.8s/it remaining:1:47:11 elapsed:3:08:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1273: grad_norm=2.5471646785736084, loss=0.2646302282810211, param_norm=1887.1298828125
Step 1274: grad_norm=3.3459794521331787, loss=0.36895108222961426, param_norm=1887.1298828125
04:21:28.880 [I] Progress on: 1.27kit/2.00kit rate:8.8s/it remaining:1:46:51 elapsed:3:08:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1275: grad_norm=3.466475009918213, loss=0.35057324171066284, param_norm=1887.1298828125
Step 1276: grad_norm=3.217639684677124, loss=0.32636499404907227, param_norm=1887.1300048828125
04:21:46.511 [I] Progress on: 1.28kit/2.00kit rate:8.8s/it remaining:1:46:32 elapsed:3:09:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1277: grad_norm=2.4458885192871094, loss=0.21300074458122253, param_norm=1887.1298828125
Step 1278: grad_norm=2.571855306625366, loss=0.2599828541278839, param_norm=1887.1298828125
04:22:04.174 [I] Progress on: 1.28kit/2.00kit rate:8.8s/it remaining:1:46:17 elapsed:3:09:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1279: grad_norm=2.658027172088623, loss=0.2674708664417267, param_norm=1887.1298828125
Step 1280: grad_norm=3.175412654876709, loss=0.335651159286499, param_norm=1887.1300048828125
04:22:21.811 [I] Progress on: 1.28kit/2.00kit rate:8.8s/it remaining:1:46:01 elapsed:3:09:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1281: grad_norm=3.1297190189361572, loss=0.324256032705307, param_norm=1887.1298828125
Step 1282: grad_norm=2.5450894832611084, loss=0.34750425815582275, param_norm=1887.1300048828125
04:22:39.492 [I] Progress on: 1.28kit/2.00kit rate:8.8s/it remaining:1:45:50 elapsed:3:10:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1283: grad_norm=3.0722391605377197, loss=0.30595463514328003, param_norm=1887.1300048828125
Step 1284: grad_norm=2.7364182472229004, loss=0.24472539126873016, param_norm=1887.1300048828125
04:22:57.103 [I] Progress on: 1.28kit/2.00kit rate:8.8s/it remaining:1:45:22 elapsed:3:10:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1285: grad_norm=3.1953773498535156, loss=0.26424849033355713, param_norm=1887.1300048828125
Step 1286: grad_norm=3.0023186206817627, loss=0.29132241010665894, param_norm=1887.1300048828125
04:23:14.817 [I] Progress on: 1.29kit/2.00kit rate:8.9s/it remaining:1:45:19 elapsed:3:10:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1287: grad_norm=2.80247163772583, loss=0.27610719203948975, param_norm=1887.1300048828125
Step 1288: grad_norm=3.0588440895080566, loss=0.31916964054107666, param_norm=1887.1300048828125
04:23:32.462 [I] Progress on: 1.29kit/2.00kit rate:8.8s/it remaining:1:44:53 elapsed:3:10:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1289: grad_norm=2.513995409011841, loss=0.26885032653808594, param_norm=1887.1300048828125
Step 1290: grad_norm=3.414886951446533, loss=0.27433568239212036, param_norm=1887.1300048828125
04:23:50.074 [I] Progress on: 1.29kit/2.00kit rate:8.8s/it remaining:1:44:27 elapsed:3:11:13 postfix:- (3802351:tqdm_logging.py:145)
Step 1291: grad_norm=3.4608922004699707, loss=0.3290771245956421, param_norm=1887.1300048828125
Step 1292: grad_norm=2.8826241493225098, loss=0.2554816007614136, param_norm=1887.1300048828125
04:24:07.694 [I] Progress on: 1.29kit/2.00kit rate:8.8s/it remaining:1:44:05 elapsed:3:11:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1293: grad_norm=3.2120134830474854, loss=0.338945209980011, param_norm=1887.1300048828125
Step 1294: grad_norm=3.121206760406494, loss=0.28425127267837524, param_norm=1887.130126953125
04:24:25.390 [I] Progress on: 1.29kit/2.00kit rate:8.8s/it remaining:1:44:01 elapsed:3:11:48 postfix:- (3802351:tqdm_logging.py:145)
Step 1295: grad_norm=3.7271487712860107, loss=0.3024616241455078, param_norm=1887.130126953125
Step 1296: grad_norm=3.252690553665161, loss=0.27880799770355225, param_norm=1887.130126953125
04:24:43.084 [I] Progress on: 1.30kit/2.00kit rate:8.8s/it remaining:1:43:49 elapsed:3:12:06 postfix:- (3802351:tqdm_logging.py:145)
Step 1297: grad_norm=3.2474186420440674, loss=0.3289056420326233, param_norm=1887.130126953125
Step 1298: grad_norm=3.2477221488952637, loss=0.3209570050239563, param_norm=1887.130126953125
04:25:00.804 [I] Progress on: 1.30kit/2.00kit rate:8.9s/it remaining:1:43:42 elapsed:3:12:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1299: grad_norm=2.7310400009155273, loss=0.32366782426834106, param_norm=1887.130126953125
Step 1300: grad_norm=3.5309865474700928, loss=0.3318628668785095, param_norm=1887.130126953125
04:25:18.471 [I] Progress on: 1.30kit/2.00kit rate:8.9s/it remaining:1:43:19 elapsed:3:12:41 postfix:- (3802351:tqdm_logging.py:145)
04:25:18.622 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
04:25:18.622 [I] [process=0][thread=MainThread][step=1200][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
04:25:18.622 [I] [process=0][thread=MainThread][step=1200][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1200. (3802351:checkpoint_manager.py:1786)
04:25:18.622 [I] [process=0][thread=MainThread][step=1200][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1200, also errors if any. (3802351:checkpoint_manager.py:1817)
04:25:18.623 [I] [process=0] Saving checkpoint at step 1300                                       (3802351:checkpoint_manager.py:1286)
04:25:18.624 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300. (3802351:async_checkpointer.py:358)
04:25:18.625 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:25:18.625 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36 (3802351:atomicity.py:144)
04:25:18.626 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:25:18.626 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:25:18.627 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36/assets.orbax-checkpoint-tmp-37 (3802351:atomicity.py:144)
04:25:18.628 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38 (3802351:atomicity.py:144)
04:25:18.628 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:25:18.633 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
04:25:22.351 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
04:25:22.352 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:25:22.354 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
04:25:22.355 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
04:25:22.385 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.385 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.385 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.386 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.386 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.386 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.386 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.387 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.387 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.387 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.387 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.387 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:25:22.388 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
04:25:22.388 [I] [process=0][thread=MainThread][step=1300] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
04:25:22.389 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
04:25:22.389 [I] {'step': 1300, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742804718.622302, 'wait_for_prev_duration_secs': 0.0006830692291259766, 'checkpointer_blocking_start_time': 1742804718.623528, 'checkpointer_blocking_duration_secs': 3.761723041534424, 'get_old_steps_start_time': 1742804722.3852968, 'get_old_steps_duration_secs': 0.0028531551361083984, 'checkpoint_manager_blocking_start_time': 1742804718.6221492, 'checkpoint_manager_blocking_duration_secs': 3.7671315670013428} (3802351:standard_logger.py:34)
04:25:29.907 [I] ChainedFuture completed 1/1 futures in 7.54 seconds.                             (3802351:future.py:137)
04:25:29.908 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 918.5 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:25:29.908 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
04:25:29.910 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36 (3802351:async_checkpointer.py:406)
04:25:29.910 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36/assets.orbax-checkpoint-tmp-37 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36/assets (3802351:atomicity.py:287)
04:25:29.922 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36/params (3802351:atomicity.py:287)
04:25:29.922 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300 (3802351:async_checkpointer.py:416)
04:25:29.923 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36 (3802351:async_checkpointer.py:426)
04:25:29.923 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300.orbax-checkpoint-tmp-36 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300 (3802351:atomicity.py:287)
04:25:29.925 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1300`. (3802351:atomicity.py:548)
04:25:29.925 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
04:25:29.926 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
04:25:29.927 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
04:25:29.927 [I] [process=0][thread=save_finalize][step=1300] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
04:25:29.927 [I] [process=0][thread=save_finalize][step=1300] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1301: grad_norm=3.2957286834716797, loss=0.3197031617164612, param_norm=1887.130126953125
04:25:30.996 [I] Progress on: 1.30kit/2.00kit rate:10.0s/it remaining:1:56:02 elapsed:3:12:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1302: grad_norm=2.4061763286590576, loss=0.2995600998401642, param_norm=1887.130126953125
Step 1303: grad_norm=2.1593401432037354, loss=0.24836856126785278, param_norm=1887.130126953125
04:25:48.592 [I] Progress on: 1.30kit/2.00kit rate:9.4s/it remaining:1:48:46 elapsed:3:13:11 postfix:- (3802351:tqdm_logging.py:145)
Step 1304: grad_norm=3.895097017288208, loss=0.2958897352218628, param_norm=1887.130126953125
Step 1305: grad_norm=2.887734889984131, loss=0.32639050483703613, param_norm=1887.130126953125
04:26:06.164 [I] Progress on: 1.30kit/2.00kit rate:9.1s/it remaining:1:44:59 elapsed:3:13:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1306: grad_norm=3.4750967025756836, loss=0.28955939412117004, param_norm=1887.130126953125
Step 1307: grad_norm=2.6856439113616943, loss=0.28279003500938416, param_norm=1887.130126953125
04:26:23.755 [I] Progress on: 1.31kit/2.00kit rate:8.9s/it remaining:1:43:00 elapsed:3:13:46 postfix:- (3802351:tqdm_logging.py:145)
Step 1308: grad_norm=3.691174268722534, loss=0.359941303730011, param_norm=1887.130126953125
Step 1309: grad_norm=3.1152760982513428, loss=0.3219262957572937, param_norm=1887.130126953125
04:26:41.436 [I] Progress on: 1.31kit/2.00kit rate:8.9s/it remaining:1:42:10 elapsed:3:14:04 postfix:- (3802351:tqdm_logging.py:145)
Step 1310: grad_norm=3.158738136291504, loss=0.3376239538192749, param_norm=1887.130126953125
04:26:52.857 [I] Progress on: 1.31kit/2.00kit rate:9.6s/it remaining:1:49:48 elapsed:3:14:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1311: grad_norm=2.7909557819366455, loss=0.27703508734703064, param_norm=1887.130126953125
Step 1312: grad_norm=3.234902858734131, loss=0.29681164026260376, param_norm=1887.130126953125
04:27:10.181 [I] Progress on: 1.31kit/2.00kit rate:9.3s/it remaining:1:46:45 elapsed:3:14:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1313: grad_norm=2.765411615371704, loss=0.3088526427745819, param_norm=1887.130126953125
Step 1314: grad_norm=2.878100872039795, loss=0.2861684560775757, param_norm=1887.1302490234375
04:27:27.806 [I] Progress on: 1.31kit/2.00kit rate:9.1s/it remaining:1:43:28 elapsed:3:14:50 postfix:- (3802351:tqdm_logging.py:145)
Step 1315: grad_norm=2.928684949874878, loss=0.2714529037475586, param_norm=1887.1302490234375
Step 1316: grad_norm=3.049368381500244, loss=0.3196452558040619, param_norm=1887.1302490234375
04:27:45.449 [I] Progress on: 1.32kit/2.00kit rate:8.9s/it remaining:1:41:46 elapsed:3:15:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1317: grad_norm=2.857109308242798, loss=0.24349594116210938, param_norm=1887.1302490234375
Step 1318: grad_norm=2.507127523422241, loss=0.2545822262763977, param_norm=1887.1302490234375
04:28:03.057 [I] Progress on: 1.32kit/2.00kit rate:8.9s/it remaining:1:40:42 elapsed:3:15:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1319: grad_norm=3.4784960746765137, loss=0.307414174079895, param_norm=1887.1302490234375
Step 1320: grad_norm=2.702075242996216, loss=0.2852606773376465, param_norm=1887.1302490234375
04:28:20.685 [I] Progress on: 1.32kit/2.00kit rate:8.8s/it remaining:1:40:06 elapsed:3:15:43 postfix:- (3802351:tqdm_logging.py:145)
Step 1321: grad_norm=2.9830739498138428, loss=0.31639713048934937, param_norm=1887.1302490234375
Step 1322: grad_norm=2.5631754398345947, loss=0.305419921875, param_norm=1887.1302490234375
04:28:38.305 [I] Progress on: 1.32kit/2.00kit rate:8.8s/it remaining:1:39:38 elapsed:3:16:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1323: grad_norm=2.3519866466522217, loss=0.2364436388015747, param_norm=1887.1302490234375
Step 1324: grad_norm=2.760352611541748, loss=0.2787589728832245, param_norm=1887.1302490234375
04:28:55.961 [I] Progress on: 1.32kit/2.00kit rate:8.8s/it remaining:1:39:19 elapsed:3:16:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1325: grad_norm=2.845372438430786, loss=0.29859885573387146, param_norm=1887.1302490234375
Step 1326: grad_norm=3.1460330486297607, loss=0.2874366044998169, param_norm=1887.1302490234375
04:29:13.606 [I] Progress on: 1.33kit/2.00kit rate:8.8s/it remaining:1:39:01 elapsed:3:16:36 postfix:- (3802351:tqdm_logging.py:145)
Step 1327: grad_norm=3.476588010787964, loss=0.3004978597164154, param_norm=1887.1302490234375
Step 1328: grad_norm=3.018279790878296, loss=0.27472126483917236, param_norm=1887.13037109375
04:29:31.229 [I] Progress on: 1.33kit/2.00kit rate:8.8s/it remaining:1:38:38 elapsed:3:16:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1329: grad_norm=3.318918466567993, loss=0.3080076575279236, param_norm=1887.13037109375
Step 1330: grad_norm=3.605940580368042, loss=0.3371667265892029, param_norm=1887.13037109375
04:29:48.848 [I] Progress on: 1.33kit/2.00kit rate:8.8s/it remaining:1:38:18 elapsed:3:17:11 postfix:- (3802351:tqdm_logging.py:145)
Step 1331: grad_norm=2.8845555782318115, loss=0.2800413966178894, param_norm=1887.13037109375
Step 1332: grad_norm=3.801433801651001, loss=0.34536105394363403, param_norm=1887.13037109375
04:30:06.432 [I] Progress on: 1.33kit/2.00kit rate:8.8s/it remaining:1:37:54 elapsed:3:17:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1333: grad_norm=2.156275987625122, loss=0.25319918990135193, param_norm=1887.13037109375
Step 1334: grad_norm=2.849585771560669, loss=0.3186119794845581, param_norm=1887.13037109375
04:30:24.017 [I] Progress on: 1.33kit/2.00kit rate:8.8s/it remaining:1:37:32 elapsed:3:17:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1335: grad_norm=3.1297624111175537, loss=0.25869348645210266, param_norm=1887.13037109375
Step 1336: grad_norm=3.3604915142059326, loss=0.3231058120727539, param_norm=1887.13037109375
04:30:41.703 [I] Progress on: 1.34kit/2.00kit rate:8.8s/it remaining:1:37:28 elapsed:3:18:04 postfix:- (3802351:tqdm_logging.py:145)
Step 1337: grad_norm=2.7585504055023193, loss=0.2875494956970215, param_norm=1887.1304931640625
Step 1338: grad_norm=2.9619007110595703, loss=0.318790078163147, param_norm=1887.1304931640625
04:30:59.302 [I] Progress on: 1.34kit/2.00kit rate:8.8s/it remaining:1:37:05 elapsed:3:18:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1339: grad_norm=2.9468624591827393, loss=0.31398242712020874, param_norm=1887.1304931640625
Step 1340: grad_norm=2.333322048187256, loss=0.26743602752685547, param_norm=1887.1304931640625
04:31:16.896 [I] Progress on: 1.34kit/2.00kit rate:8.8s/it remaining:1:36:41 elapsed:3:18:39 postfix:- (3802351:tqdm_logging.py:145)
Step 1341: grad_norm=2.8586812019348145, loss=0.2725326418876648, param_norm=1887.1304931640625
Step 1342: grad_norm=2.7404301166534424, loss=0.26300346851348877, param_norm=1887.1304931640625
04:31:34.513 [I] Progress on: 1.34kit/2.00kit rate:8.8s/it remaining:1:36:25 elapsed:3:18:57 postfix:- (3802351:tqdm_logging.py:145)
Step 1343: grad_norm=3.2912092208862305, loss=0.3176984190940857, param_norm=1887.1304931640625
Step 1344: grad_norm=3.9356460571289062, loss=0.30767732858657837, param_norm=1887.1304931640625
04:31:52.183 [I] Progress on: 1.34kit/2.00kit rate:8.8s/it remaining:1:36:19 elapsed:3:19:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1345: grad_norm=2.6603477001190186, loss=0.27859729528427124, param_norm=1887.1304931640625
Step 1346: grad_norm=3.0465242862701416, loss=0.2751096785068512, param_norm=1887.1304931640625
04:32:09.863 [I] Progress on: 1.35kit/2.00kit rate:8.8s/it remaining:1:36:08 elapsed:3:19:32 postfix:- (3802351:tqdm_logging.py:145)
Step 1347: grad_norm=3.101097822189331, loss=0.28780150413513184, param_norm=1887.1304931640625
Step 1348: grad_norm=3.0563907623291016, loss=0.3242058753967285, param_norm=1887.1304931640625
04:32:27.474 [I] Progress on: 1.35kit/2.00kit rate:8.8s/it remaining:1:35:41 elapsed:3:19:50 postfix:- (3802351:tqdm_logging.py:145)
Step 1349: grad_norm=2.4081006050109863, loss=0.2802730202674866, param_norm=1887.1304931640625
Step 1350: grad_norm=2.686074733734131, loss=0.31961676478385925, param_norm=1887.1304931640625
04:32:45.090 [I] Progress on: 1.35kit/2.00kit rate:8.8s/it remaining:1:35:21 elapsed:3:20:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1351: grad_norm=3.1408474445343018, loss=0.3143129348754883, param_norm=1887.130615234375
Step 1352: grad_norm=2.4277708530426025, loss=0.2102222442626953, param_norm=1887.130615234375
04:33:02.904 [I] Progress on: 1.35kit/2.00kit rate:8.8s/it remaining:1:34:56 elapsed:3:20:25 postfix:- (3802351:tqdm_logging.py:145)
Step 1353: grad_norm=3.182279586791992, loss=0.3278765082359314, param_norm=1887.130615234375
Step 1354: grad_norm=2.524240255355835, loss=0.22519323229789734, param_norm=1887.130615234375
04:33:20.554 [I] Progress on: 1.35kit/2.00kit rate:8.8s/it remaining:1:35:15 elapsed:3:20:43 postfix:- (3802351:tqdm_logging.py:145)
Step 1355: grad_norm=2.3263235092163086, loss=0.22718308866024017, param_norm=1887.130615234375
Step 1356: grad_norm=2.459918975830078, loss=0.2813582420349121, param_norm=1887.130615234375
04:33:38.172 [I] Progress on: 1.36kit/2.00kit rate:8.8s/it remaining:1:34:43 elapsed:3:21:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1357: grad_norm=2.862746000289917, loss=0.31211909651756287, param_norm=1887.130615234375
Step 1358: grad_norm=3.0708863735198975, loss=0.3098698556423187, param_norm=1887.1307373046875
04:33:55.854 [I] Progress on: 1.36kit/2.00kit rate:8.8s/it remaining:1:34:26 elapsed:3:21:18 postfix:- (3802351:tqdm_logging.py:145)
Step 1359: grad_norm=2.8731131553649902, loss=0.2742666006088257, param_norm=1887.130615234375
Step 1360: grad_norm=3.247708559036255, loss=0.312306672334671, param_norm=1887.130615234375
04:34:13.523 [I] Progress on: 1.36kit/2.00kit rate:8.8s/it remaining:1:34:05 elapsed:3:21:36 postfix:- (3802351:tqdm_logging.py:145)
Step 1361: grad_norm=2.2828104496002197, loss=0.2496219277381897, param_norm=1887.1307373046875
Step 1362: grad_norm=3.3893115520477295, loss=0.36231300234794617, param_norm=1887.1307373046875
04:34:31.223 [I] Progress on: 1.36kit/2.00kit rate:8.8s/it remaining:1:33:54 elapsed:3:21:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1363: grad_norm=3.126934766769409, loss=0.28375741839408875, param_norm=1887.1307373046875
Step 1364: grad_norm=2.7436535358428955, loss=0.29571613669395447, param_norm=1887.1307373046875
04:34:48.919 [I] Progress on: 1.36kit/2.00kit rate:8.8s/it remaining:1:33:36 elapsed:3:22:11 postfix:- (3802351:tqdm_logging.py:145)
Step 1365: grad_norm=3.3683502674102783, loss=0.31150293350219727, param_norm=1887.1307373046875
Step 1366: grad_norm=2.9456064701080322, loss=0.24188454449176788, param_norm=1887.1307373046875
04:35:06.634 [I] Progress on: 1.37kit/2.00kit rate:8.8s/it remaining:1:33:24 elapsed:3:22:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1367: grad_norm=2.9479613304138184, loss=0.28699254989624023, param_norm=1887.1307373046875
Step 1368: grad_norm=2.471733570098877, loss=0.27837032079696655, param_norm=1887.1307373046875
04:35:24.307 [I] Progress on: 1.37kit/2.00kit rate:8.8s/it remaining:1:33:03 elapsed:3:22:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1369: grad_norm=3.0028998851776123, loss=0.29735028743743896, param_norm=1887.1307373046875
Step 1370: grad_norm=2.6096129417419434, loss=0.24921099841594696, param_norm=1887.1307373046875
04:35:41.993 [I] Progress on: 1.37kit/2.00kit rate:8.8s/it remaining:1:32:42 elapsed:3:23:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1371: grad_norm=3.7558202743530273, loss=0.32669317722320557, param_norm=1887.130859375
Step 1372: grad_norm=3.081707000732422, loss=0.33434826135635376, param_norm=1887.130859375
04:35:59.671 [I] Progress on: 1.37kit/2.00kit rate:8.8s/it remaining:1:32:23 elapsed:3:23:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1373: grad_norm=2.9030423164367676, loss=0.2483024299144745, param_norm=1887.130859375
Step 1374: grad_norm=2.8650619983673096, loss=0.27095404267311096, param_norm=1887.130859375
04:36:17.384 [I] Progress on: 1.37kit/2.00kit rate:8.8s/it remaining:1:32:10 elapsed:3:23:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1375: grad_norm=3.688354253768921, loss=0.33215710520744324, param_norm=1887.130859375
Step 1376: grad_norm=2.902475357055664, loss=0.29501163959503174, param_norm=1887.130859375
04:36:34.992 [I] Progress on: 1.38kit/2.00kit rate:8.8s/it remaining:1:31:41 elapsed:3:23:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1377: grad_norm=2.3101327419281006, loss=0.23741325736045837, param_norm=1887.130859375
Step 1378: grad_norm=3.1831483840942383, loss=0.2571682035923004, param_norm=1887.130859375
04:36:52.644 [I] Progress on: 1.38kit/2.00kit rate:8.8s/it remaining:1:31:24 elapsed:3:24:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1379: grad_norm=3.4169514179229736, loss=0.31568336486816406, param_norm=1887.130859375
04:37:04.087 [I] Progress on: 1.38kit/2.00kit rate:9.5s/it remaining:1:38:39 elapsed:3:24:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1380: grad_norm=3.024010419845581, loss=0.3098790645599365, param_norm=1887.130859375
Step 1381: grad_norm=2.8633241653442383, loss=0.27267760038375854, param_norm=1887.130859375
04:37:21.489 [I] Progress on: 1.38kit/2.00kit rate:9.3s/it remaining:1:36:10 elapsed:3:24:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1382: grad_norm=2.8950018882751465, loss=0.2865450978279114, param_norm=1887.1309814453125
Step 1383: grad_norm=2.2469935417175293, loss=0.2603183388710022, param_norm=1887.1309814453125
04:37:39.093 [I] Progress on: 1.38kit/2.00kit rate:9.1s/it remaining:1:33:08 elapsed:3:25:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1384: grad_norm=2.566702365875244, loss=0.3033393919467926, param_norm=1887.1309814453125
Step 1385: grad_norm=2.8714284896850586, loss=0.2826240062713623, param_norm=1887.1309814453125
04:37:56.713 [I] Progress on: 1.39kit/2.00kit rate:8.9s/it remaining:1:31:29 elapsed:3:25:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1386: grad_norm=3.1324009895324707, loss=0.27513688802719116, param_norm=1887.130859375
Step 1387: grad_norm=2.3282206058502197, loss=0.26092833280563354, param_norm=1887.130859375
04:38:14.310 [I] Progress on: 1.39kit/2.00kit rate:8.9s/it remaining:1:30:30 elapsed:3:25:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1388: grad_norm=2.3091094493865967, loss=0.2536594271659851, param_norm=1887.130859375
Step 1389: grad_norm=2.886444330215454, loss=0.2829659879207611, param_norm=1887.1309814453125
04:38:31.999 [I] Progress on: 1.39kit/2.00kit rate:8.8s/it remaining:1:30:06 elapsed:3:25:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1390: grad_norm=3.0235650539398193, loss=0.29622626304626465, param_norm=1887.1309814453125
Step 1391: grad_norm=2.4571263790130615, loss=0.2565416991710663, param_norm=1887.1309814453125
04:38:49.629 [I] Progress on: 1.39kit/2.00kit rate:8.8s/it remaining:1:29:37 elapsed:3:26:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1392: grad_norm=3.3393256664276123, loss=0.30529242753982544, param_norm=1887.1309814453125
Step 1393: grad_norm=3.0758681297302246, loss=0.2866497337818146, param_norm=1887.1309814453125
04:39:07.199 [I] Progress on: 1.39kit/2.00kit rate:8.8s/it remaining:1:29:05 elapsed:3:26:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1394: grad_norm=2.895777463912964, loss=0.22944393754005432, param_norm=1887.1309814453125
Step 1395: grad_norm=3.162966251373291, loss=0.32022368907928467, param_norm=1887.1309814453125
04:39:24.855 [I] Progress on: 1.40kit/2.00kit rate:8.8s/it remaining:1:28:53 elapsed:3:26:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1396: grad_norm=2.909780740737915, loss=0.30645617842674255, param_norm=1887.1309814453125
Step 1397: grad_norm=2.738584041595459, loss=0.3056986927986145, param_norm=1887.131103515625
04:39:42.475 [I] Progress on: 1.40kit/2.00kit rate:8.8s/it remaining:1:28:33 elapsed:3:27:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1398: grad_norm=2.813758373260498, loss=0.23720628023147583, param_norm=1887.1309814453125
Step 1399: grad_norm=2.1652073860168457, loss=0.23936259746551514, param_norm=1887.1309814453125
04:40:00.088 [I] Progress on: 1.40kit/2.00kit rate:8.8s/it remaining:1:28:14 elapsed:3:27:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1400: grad_norm=3.1544933319091797, loss=0.305095911026001, param_norm=1887.131103515625
04:40:09.086 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
04:40:09.087 [I] [process=0][thread=MainThread][step=1300][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
04:40:09.087 [I] [process=0][thread=MainThread][step=1300][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1300. (3802351:checkpoint_manager.py:1786)
04:40:09.087 [I] [process=0][thread=MainThread][step=1300][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1300, also errors if any. (3802351:checkpoint_manager.py:1817)
04:40:09.088 [I] [process=0] Saving checkpoint at step 1400                                       (3802351:checkpoint_manager.py:1286)
04:40:09.088 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400. (3802351:async_checkpointer.py:358)
04:40:09.090 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:40:09.091 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39 (3802351:atomicity.py:144)
04:40:09.092 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:40:09.092 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:40:09.093 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39/assets.orbax-checkpoint-tmp-40 (3802351:atomicity.py:144)
04:40:09.094 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39/params.orbax-checkpoint-tmp-41 (3802351:atomicity.py:144)
04:40:09.095 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:40:09.101 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
04:40:12.990 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
04:40:12.991 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
04:40:12.992 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:40:13.001 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
04:40:13.026 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.030 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.031 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.032 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.034 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.035 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.036 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.039 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.040 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.041 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.041 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.042 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.042 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:40:13.042 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
04:40:13.043 [I] [process=0][thread=MainThread][step=1400] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
04:40:13.044 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
04:40:13.045 [I] {'step': 1400, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742805609.0868797, 'wait_for_prev_duration_secs': 0.0008349418640136719, 'checkpointer_blocking_start_time': 1742805609.08831, 'checkpointer_blocking_duration_secs': 3.938390016555786, 'get_old_steps_start_time': 1742805613.026744, 'get_old_steps_duration_secs': 0.01589035987854004, 'checkpoint_manager_blocking_start_time': 1742805609.0866995, 'checkpoint_manager_blocking_duration_secs': 3.9583516120910645} (3802351:standard_logger.py:34)
04:40:13.046 [I] Progress on: 1.40kit/2.00kit rate:10.0s/it remaining:1:39:45 elapsed:3:27:36 postfix:- (3802351:tqdm_logging.py:145)
04:40:21.290 [I] ChainedFuture completed 1/1 futures in 8.28 seconds.                             (3802351:future.py:137)
04:40:21.290 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 849.6 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:40:21.291 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
04:40:21.292 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39 (3802351:async_checkpointer.py:406)
04:40:21.293 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39/assets.orbax-checkpoint-tmp-40 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39/assets (3802351:atomicity.py:287)
04:40:21.303 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39/params.orbax-checkpoint-tmp-41 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39/params (3802351:atomicity.py:287)
04:40:21.304 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400 (3802351:async_checkpointer.py:416)
04:40:21.304 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39 (3802351:async_checkpointer.py:426)
04:40:21.304 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400.orbax-checkpoint-tmp-39 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400 (3802351:atomicity.py:287)
04:40:21.306 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1400`. (3802351:atomicity.py:548)
04:40:21.306 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
04:40:21.307 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
04:40:21.307 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
04:40:21.307 [I] [process=0][thread=save_finalize][step=1400] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
04:40:21.308 [I] [process=0][thread=save_finalize][step=1400] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1401: grad_norm=3.382341146469116, loss=0.277395099401474, param_norm=1887.1309814453125
Step 1402: grad_norm=3.4645581245422363, loss=0.30770015716552734, param_norm=1887.1309814453125
04:40:30.417 [I] Progress on: 1.40kit/2.00kit rate:9.6s/it remaining:1:35:58 elapsed:3:27:53 postfix:- (3802351:tqdm_logging.py:145)
Step 1403: grad_norm=2.5538556575775146, loss=0.2536660432815552, param_norm=1887.1309814453125
Step 1404: grad_norm=3.1180310249328613, loss=0.27643436193466187, param_norm=1887.1309814453125
04:40:48.032 [I] Progress on: 1.40kit/2.00kit rate:9.2s/it remaining:1:31:29 elapsed:3:28:11 postfix:- (3802351:tqdm_logging.py:145)
Step 1405: grad_norm=2.6308369636535645, loss=0.2498755156993866, param_norm=1887.1309814453125
Step 1406: grad_norm=3.37380313873291, loss=0.2750978469848633, param_norm=1887.1309814453125
04:41:05.631 [I] Progress on: 1.41kit/2.00kit rate:9.0s/it remaining:1:29:07 elapsed:3:28:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1407: grad_norm=3.055966854095459, loss=0.3138495683670044, param_norm=1887.1309814453125
Step 1408: grad_norm=2.554633378982544, loss=0.23127493262290955, param_norm=1887.1309814453125
04:41:23.224 [I] Progress on: 1.41kit/2.00kit rate:8.9s/it remaining:1:27:48 elapsed:3:28:46 postfix:- (3802351:tqdm_logging.py:145)
Step 1409: grad_norm=3.198791980743408, loss=0.3017922043800354, param_norm=1887.1309814453125
Step 1410: grad_norm=2.9012269973754883, loss=0.2946770191192627, param_norm=1887.1309814453125
04:41:40.763 [I] Progress on: 1.41kit/2.00kit rate:8.8s/it remaining:1:26:52 elapsed:3:29:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1411: grad_norm=2.5410449504852295, loss=0.2630063593387604, param_norm=1887.1309814453125
Step 1412: grad_norm=2.9100592136383057, loss=0.18835723400115967, param_norm=1887.1309814453125
04:41:58.325 [I] Progress on: 1.41kit/2.00kit rate:8.8s/it remaining:1:26:18 elapsed:3:29:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1413: grad_norm=2.8054122924804688, loss=0.30389559268951416, param_norm=1887.1309814453125
Step 1414: grad_norm=2.4376165866851807, loss=0.25705626606941223, param_norm=1887.131103515625
04:42:15.898 [I] Progress on: 1.41kit/2.00kit rate:8.8s/it remaining:1:25:55 elapsed:3:29:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1415: grad_norm=2.7583553791046143, loss=0.24516940116882324, param_norm=1887.131103515625
Step 1416: grad_norm=3.0778143405914307, loss=0.27238935232162476, param_norm=1887.131103515625
04:42:33.512 [I] Progress on: 1.42kit/2.00kit rate:8.8s/it remaining:1:25:42 elapsed:3:29:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1417: grad_norm=3.114494562149048, loss=0.2794651985168457, param_norm=1887.131103515625
Step 1418: grad_norm=2.8278005123138428, loss=0.26097971200942993, param_norm=1887.131103515625
04:42:51.057 [I] Progress on: 1.42kit/2.00kit rate:8.8s/it remaining:1:25:15 elapsed:3:30:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1419: grad_norm=3.1296560764312744, loss=0.3217560648918152, param_norm=1887.131103515625
Step 1420: grad_norm=2.772282361984253, loss=0.2418684959411621, param_norm=1887.131103515625
04:43:08.719 [I] Progress on: 1.42kit/2.00kit rate:8.8s/it remaining:1:25:10 elapsed:3:30:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1421: grad_norm=2.8793280124664307, loss=0.324221134185791, param_norm=1887.131103515625
Step 1422: grad_norm=2.5786256790161133, loss=0.27010267972946167, param_norm=1887.131103515625
04:43:26.271 [I] Progress on: 1.42kit/2.00kit rate:8.8s/it remaining:1:24:42 elapsed:3:30:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1423: grad_norm=3.3388519287109375, loss=0.29863569140434265, param_norm=1887.131103515625
Step 1424: grad_norm=3.0880696773529053, loss=0.27788442373275757, param_norm=1887.131103515625
04:43:43.850 [I] Progress on: 1.42kit/2.00kit rate:8.8s/it remaining:1:24:23 elapsed:3:31:06 postfix:- (3802351:tqdm_logging.py:145)
Step 1425: grad_norm=2.683163642883301, loss=0.26752346754074097, param_norm=1887.131103515625
Step 1426: grad_norm=2.9021756649017334, loss=0.271215558052063, param_norm=1887.131103515625
04:44:01.501 [I] Progress on: 1.43kit/2.00kit rate:8.8s/it remaining:1:24:16 elapsed:3:31:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1427: grad_norm=3.505344867706299, loss=0.3181498944759369, param_norm=1887.131103515625
Step 1428: grad_norm=3.1811649799346924, loss=0.2647002339363098, param_norm=1887.131103515625
04:44:19.167 [I] Progress on: 1.43kit/2.00kit rate:8.8s/it remaining:1:24:04 elapsed:3:31:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1429: grad_norm=3.2597742080688477, loss=0.3181752562522888, param_norm=1887.131103515625
Step 1430: grad_norm=3.208386182785034, loss=0.29430750012397766, param_norm=1887.131103515625
04:44:36.825 [I] Progress on: 1.43kit/2.00kit rate:8.8s/it remaining:1:23:52 elapsed:3:31:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1431: grad_norm=2.899038076400757, loss=0.27384573221206665, param_norm=1887.131103515625
Step 1432: grad_norm=3.8057591915130615, loss=0.29671016335487366, param_norm=1887.131103515625
04:44:54.481 [I] Progress on: 1.43kit/2.00kit rate:8.8s/it remaining:1:23:32 elapsed:3:32:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1433: grad_norm=3.082493543624878, loss=0.297824501991272, param_norm=1887.131103515625
Step 1434: grad_norm=3.4182660579681396, loss=0.2981300950050354, param_norm=1887.131103515625
04:45:12.148 [I] Progress on: 1.43kit/2.00kit rate:8.8s/it remaining:1:23:19 elapsed:3:32:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1435: grad_norm=3.387026786804199, loss=0.26604729890823364, param_norm=1887.131103515625
Step 1436: grad_norm=3.6555206775665283, loss=0.359710693359375, param_norm=1887.131103515625
04:45:29.802 [I] Progress on: 1.44kit/2.00kit rate:8.8s/it remaining:1:23:01 elapsed:3:32:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1437: grad_norm=3.066282272338867, loss=0.26917505264282227, param_norm=1887.131103515625
Step 1438: grad_norm=3.5014638900756836, loss=0.3459307849407196, param_norm=1887.131103515625
04:45:47.464 [I] Progress on: 1.44kit/2.00kit rate:8.8s/it remaining:1:22:43 elapsed:3:33:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1439: grad_norm=3.366666555404663, loss=0.29082363843917847, param_norm=1887.131103515625
Step 1440: grad_norm=2.733842372894287, loss=0.29534777998924255, param_norm=1887.1312255859375
04:46:05.101 [I] Progress on: 1.44kit/2.00kit rate:8.8s/it remaining:1:22:22 elapsed:3:33:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1441: grad_norm=3.0583951473236084, loss=0.3011745512485504, param_norm=1887.1312255859375
Step 1442: grad_norm=3.4528191089630127, loss=0.28739452362060547, param_norm=1887.1312255859375
04:46:22.796 [I] Progress on: 1.44kit/2.00kit rate:8.8s/it remaining:1:22:13 elapsed:3:33:45 postfix:- (3802351:tqdm_logging.py:145)
Step 1443: grad_norm=3.2890522480010986, loss=0.23849204182624817, param_norm=1887.1312255859375
Step 1444: grad_norm=2.8137447834014893, loss=0.2465120404958725, param_norm=1887.1312255859375
04:46:40.401 [I] Progress on: 1.44kit/2.00kit rate:8.8s/it remaining:1:21:45 elapsed:3:34:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1445: grad_norm=3.267749309539795, loss=0.27492618560791016, param_norm=1887.1312255859375
Step 1446: grad_norm=2.8479137420654297, loss=0.23407922685146332, param_norm=1887.1312255859375
04:46:57.996 [I] Progress on: 1.45kit/2.00kit rate:8.8s/it remaining:1:21:18 elapsed:3:34:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1447: grad_norm=2.9493608474731445, loss=0.2992277443408966, param_norm=1887.1312255859375
Step 1448: grad_norm=3.1992502212524414, loss=0.2936588525772095, param_norm=1887.1314697265625
04:47:15.670 [I] Progress on: 1.45kit/2.00kit rate:8.8s/it remaining:1:21:09 elapsed:3:34:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1449: grad_norm=3.1418261528015137, loss=0.27011799812316895, param_norm=1887.1314697265625
04:47:26.912 [I] Progress on: 1.45kit/2.00kit rate:9.6s/it remaining:1:27:46 elapsed:3:34:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1450: grad_norm=3.299139976501465, loss=0.27616453170776367, param_norm=1887.1314697265625
Step 1451: grad_norm=2.758456230163574, loss=0.23750656843185425, param_norm=1887.1314697265625
04:47:44.478 [I] Progress on: 1.45kit/2.00kit rate:9.2s/it remaining:1:23:47 elapsed:3:35:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1452: grad_norm=2.9898734092712402, loss=0.33183178305625916, param_norm=1887.1314697265625
Step 1453: grad_norm=3.309267044067383, loss=0.3206486701965332, param_norm=1887.1314697265625
04:48:02.027 [I] Progress on: 1.45kit/2.00kit rate:9.0s/it remaining:1:21:43 elapsed:3:35:25 postfix:- (3802351:tqdm_logging.py:145)
Step 1454: grad_norm=3.0857763290405273, loss=0.2922782897949219, param_norm=1887.1314697265625
Step 1455: grad_norm=3.63273024559021, loss=0.27216044068336487, param_norm=1887.1314697265625
04:48:19.591 [I] Progress on: 1.46kit/2.00kit rate:8.9s/it remaining:1:20:34 elapsed:3:35:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1456: grad_norm=2.7504920959472656, loss=0.24450553953647614, param_norm=1887.1314697265625
Step 1457: grad_norm=3.128016710281372, loss=0.31665098667144775, param_norm=1887.1314697265625
04:48:37.193 [I] Progress on: 1.46kit/2.00kit rate:8.8s/it remaining:1:19:56 elapsed:3:36:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1458: grad_norm=4.060684680938721, loss=0.3172672390937805, param_norm=1887.1314697265625
Step 1459: grad_norm=3.219526529312134, loss=0.2577016055583954, param_norm=1887.1314697265625
04:48:54.765 [I] Progress on: 1.46kit/2.00kit rate:8.8s/it remaining:1:19:26 elapsed:3:36:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1460: grad_norm=3.799865961074829, loss=0.29234689474105835, param_norm=1887.1314697265625
Step 1461: grad_norm=2.505598783493042, loss=0.20272698998451233, param_norm=1887.1314697265625
04:49:12.338 [I] Progress on: 1.46kit/2.00kit rate:8.8s/it remaining:1:19:02 elapsed:3:36:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1462: grad_norm=3.0030086040496826, loss=0.3470684289932251, param_norm=1887.1314697265625
Step 1463: grad_norm=2.645068645477295, loss=0.24683547019958496, param_norm=1887.1314697265625
04:49:29.962 [I] Progress on: 1.46kit/2.00kit rate:8.8s/it remaining:1:18:48 elapsed:3:36:53 postfix:- (3802351:tqdm_logging.py:145)
Step 1464: grad_norm=2.779338836669922, loss=0.2686891257762909, param_norm=1887.1314697265625
Step 1465: grad_norm=3.3406991958618164, loss=0.2735259532928467, param_norm=1887.131591796875
04:49:47.593 [I] Progress on: 1.47kit/2.00kit rate:8.8s/it remaining:1:18:30 elapsed:3:37:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1466: grad_norm=3.159346103668213, loss=0.2652510106563568, param_norm=1887.131591796875
Step 1467: grad_norm=3.5601441860198975, loss=0.29476016759872437, param_norm=1887.131591796875
04:50:05.164 [I] Progress on: 1.47kit/2.00kit rate:8.8s/it remaining:1:18:09 elapsed:3:37:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1468: grad_norm=3.0228943824768066, loss=0.2735660672187805, param_norm=1887.131591796875
Step 1469: grad_norm=4.009024620056152, loss=0.3071979284286499, param_norm=1887.131591796875
04:50:22.764 [I] Progress on: 1.47kit/2.00kit rate:8.8s/it remaining:1:17:52 elapsed:3:37:45 postfix:- (3802351:tqdm_logging.py:145)
Step 1470: grad_norm=3.8731775283813477, loss=0.31538844108581543, param_norm=1887.131591796875
Step 1471: grad_norm=2.905169725418091, loss=0.27606165409088135, param_norm=1887.131591796875
04:50:40.385 [I] Progress on: 1.47kit/2.00kit rate:8.8s/it remaining:1:17:36 elapsed:3:38:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1472: grad_norm=3.2436447143554688, loss=0.304345965385437, param_norm=1887.131591796875
Step 1473: grad_norm=3.3828377723693848, loss=0.31064584851264954, param_norm=1887.1317138671875
04:50:57.934 [I] Progress on: 1.47kit/2.00kit rate:8.8s/it remaining:1:17:12 elapsed:3:38:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1474: grad_norm=3.637139081954956, loss=0.269715279340744, param_norm=1887.1317138671875
Step 1475: grad_norm=3.2087631225585938, loss=0.2980460524559021, param_norm=1887.1317138671875
04:51:15.592 [I] Progress on: 1.48kit/2.00kit rate:8.8s/it remaining:1:17:02 elapsed:3:38:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1476: grad_norm=3.1581921577453613, loss=0.2790616452693939, param_norm=1887.1317138671875
Step 1477: grad_norm=2.564586877822876, loss=0.23444631695747375, param_norm=1887.1317138671875
04:51:33.261 [I] Progress on: 1.48kit/2.00kit rate:8.8s/it remaining:1:16:51 elapsed:3:38:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1478: grad_norm=2.8056640625, loss=0.2650104761123657, param_norm=1887.1317138671875
Step 1479: grad_norm=2.127091407775879, loss=0.20643334090709686, param_norm=1887.1317138671875
04:51:50.880 [I] Progress on: 1.48kit/2.00kit rate:8.8s/it remaining:1:16:31 elapsed:3:39:13 postfix:- (3802351:tqdm_logging.py:145)
Step 1480: grad_norm=2.9663708209991455, loss=0.24820847809314728, param_norm=1887.1317138671875
Step 1481: grad_norm=3.3250162601470947, loss=0.2408764362335205, param_norm=1887.1317138671875
04:52:08.563 [I] Progress on: 1.48kit/2.00kit rate:8.8s/it remaining:1:16:20 elapsed:3:39:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1482: grad_norm=2.9647176265716553, loss=0.2781372666358948, param_norm=1887.1318359375
Step 1483: grad_norm=3.1821746826171875, loss=0.30271315574645996, param_norm=1887.1318359375
04:52:26.257 [I] Progress on: 1.48kit/2.00kit rate:8.8s/it remaining:1:16:06 elapsed:3:39:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1484: grad_norm=2.4853765964508057, loss=0.2312028706073761, param_norm=1887.1317138671875
Step 1485: grad_norm=2.4548871517181396, loss=0.26385387778282166, param_norm=1887.1318359375
04:52:43.938 [I] Progress on: 1.49kit/2.00kit rate:8.8s/it remaining:1:15:51 elapsed:3:40:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1486: grad_norm=2.812652111053467, loss=0.26407039165496826, param_norm=1887.1318359375
Step 1487: grad_norm=3.0319604873657227, loss=0.24878251552581787, param_norm=1887.1318359375
04:53:01.563 [I] Progress on: 1.49kit/2.00kit rate:8.8s/it remaining:1:15:26 elapsed:3:40:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1488: grad_norm=2.442049264907837, loss=0.19930538535118103, param_norm=1887.1318359375
Step 1489: grad_norm=3.1578211784362793, loss=0.2794877588748932, param_norm=1887.1318359375
04:53:19.242 [I] Progress on: 1.49kit/2.00kit rate:8.8s/it remaining:1:15:10 elapsed:3:40:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1490: grad_norm=3.1069092750549316, loss=0.224513441324234, param_norm=1887.1318359375
Step 1491: grad_norm=3.0579798221588135, loss=0.25509828329086304, param_norm=1887.1318359375
04:53:36.948 [I] Progress on: 1.49kit/2.00kit rate:8.8s/it remaining:1:15:00 elapsed:3:41:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1492: grad_norm=3.0140066146850586, loss=0.28501343727111816, param_norm=1887.1318359375
Step 1493: grad_norm=3.8880650997161865, loss=0.3572147488594055, param_norm=1887.1318359375
04:53:54.616 [I] Progress on: 1.49kit/2.00kit rate:8.8s/it remaining:1:14:38 elapsed:3:41:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1494: grad_norm=2.8308770656585693, loss=0.2611809968948364, param_norm=1887.1318359375
Step 1495: grad_norm=3.3230366706848145, loss=0.29221343994140625, param_norm=1887.1318359375
04:54:12.336 [I] Progress on: 1.50kit/2.00kit rate:8.8s/it remaining:1:14:26 elapsed:3:41:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1496: grad_norm=2.990992784500122, loss=0.2740306854248047, param_norm=1887.1319580078125
Step 1497: grad_norm=3.2471790313720703, loss=0.26419371366500854, param_norm=1887.1319580078125
04:54:30.026 [I] Progress on: 1.50kit/2.00kit rate:8.8s/it remaining:1:14:09 elapsed:3:41:53 postfix:- (3802351:tqdm_logging.py:145)
Step 1498: grad_norm=2.3780806064605713, loss=0.23334883153438568, param_norm=1887.1319580078125
Step 1499: grad_norm=3.165670156478882, loss=0.3045894503593445, param_norm=1887.1319580078125
04:54:47.688 [I] Progress on: 1.50kit/2.00kit rate:8.8s/it remaining:1:13:49 elapsed:3:42:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1500: grad_norm=3.0106112957000732, loss=0.26841264963150024, param_norm=1887.1319580078125
04:54:56.664 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
04:54:56.664 [I] [process=0][thread=MainThread][step=1400][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
04:54:56.664 [I] [process=0][thread=MainThread][step=1400][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1400. (3802351:checkpoint_manager.py:1786)
04:54:56.665 [I] [process=0][thread=MainThread][step=1400][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1400, also errors if any. (3802351:checkpoint_manager.py:1817)
04:54:56.665 [I] [process=0] Saving checkpoint at step 1500                                       (3802351:checkpoint_manager.py:1286)
04:54:56.666 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500. (3802351:async_checkpointer.py:358)
04:54:56.667 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:54:56.668 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42 (3802351:atomicity.py:144)
04:54:56.669 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:54:56.670 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
04:54:56.673 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42/params.orbax-checkpoint-tmp-44 (3802351:atomicity.py:144)
04:54:56.673 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42/assets.orbax-checkpoint-tmp-43 (3802351:atomicity.py:144)
04:54:56.674 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
04:54:56.679 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
04:55:00.396 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
04:55:00.397 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:55:00.399 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
04:55:00.403 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
04:55:00.436 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.437 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.438 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.439 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.448 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.452 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.452 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.453 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.455 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.456 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.457 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.458 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.458 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.458 [I] Preserving Checkpoint[step=1400 | time=2025-03-24 08:40:13.026710+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
04:55:00.458 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
04:55:00.459 [I] [process=0][thread=MainThread][step=1500] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
04:55:00.460 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
04:55:00.461 [I] {'step': 1500, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742806496.6643596, 'wait_for_prev_duration_secs': 0.0008149147033691406, 'checkpointer_blocking_start_time': 1742806496.6657798, 'checkpointer_blocking_duration_secs': 3.7709898948669434, 'get_old_steps_start_time': 1742806500.4368231, 'get_old_steps_duration_secs': 0.02206587791442871, 'checkpoint_manager_blocking_start_time': 1742806496.6641703, 'checkpoint_manager_blocking_duration_secs': 3.7975194454193115} (3802351:standard_logger.py:34)
04:55:00.468 [I] Progress on: 1.50kit/2.00kit rate:10.0s/it remaining:1:22:49 elapsed:3:42:23 postfix:- (3802351:tqdm_logging.py:145)
04:55:08.538 [I] ChainedFuture completed 1/1 futures in 8.13 seconds.                             (3802351:future.py:137)
04:55:08.539 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 873.2 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
04:55:08.539 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
04:55:08.540 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42 (3802351:async_checkpointer.py:406)
04:55:08.540 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42/assets.orbax-checkpoint-tmp-43 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42/assets (3802351:atomicity.py:287)
04:55:08.551 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42/params.orbax-checkpoint-tmp-44 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42/params (3802351:atomicity.py:287)
04:55:08.551 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500 (3802351:async_checkpointer.py:416)
04:55:08.552 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42 (3802351:async_checkpointer.py:426)
04:55:08.552 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500.orbax-checkpoint-tmp-42 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500 (3802351:atomicity.py:287)
04:55:08.553 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1500`. (3802351:atomicity.py:548)
04:55:08.553 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
04:55:08.554 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
04:55:08.554 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
04:55:08.555 [I] [process=0][thread=save_finalize][step=1500] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
04:55:08.555 [I] [process=0][thread=save_finalize][step=1500] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1501: grad_norm=3.4037580490112305, loss=0.3180192708969116, param_norm=1887.1319580078125
Step 1502: grad_norm=2.5630533695220947, loss=0.2366061806678772, param_norm=1887.1319580078125
04:55:17.890 [I] Progress on: 1.50kit/2.00kit rate:9.6s/it remaining:1:19:51 elapsed:3:42:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1503: grad_norm=3.0936403274536133, loss=0.26954221725463867, param_norm=1887.1319580078125
Step 1504: grad_norm=3.012449026107788, loss=0.28770142793655396, param_norm=1887.1319580078125
04:55:35.485 [I] Progress on: 1.50kit/2.00kit rate:9.2s/it remaining:1:16:00 elapsed:3:42:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1505: grad_norm=2.7166080474853516, loss=0.24368613958358765, param_norm=1887.1319580078125
Step 1506: grad_norm=3.0338776111602783, loss=0.25849398970603943, param_norm=1887.1319580078125
04:55:53.049 [I] Progress on: 1.51kit/2.00kit rate:9.0s/it remaining:1:13:59 elapsed:3:43:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1507: grad_norm=3.613711357116699, loss=0.3335832357406616, param_norm=1887.1319580078125
Step 1508: grad_norm=2.560384511947632, loss=0.2419741004705429, param_norm=1887.1319580078125
04:56:10.615 [I] Progress on: 1.51kit/2.00kit rate:8.9s/it remaining:1:12:49 elapsed:3:43:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1509: grad_norm=3.014416217803955, loss=0.23850077390670776, param_norm=1887.1319580078125
Step 1510: grad_norm=2.846092462539673, loss=0.2559712529182434, param_norm=1887.1319580078125
04:56:28.219 [I] Progress on: 1.51kit/2.00kit rate:8.8s/it remaining:1:12:09 elapsed:3:43:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1511: grad_norm=3.098341941833496, loss=0.3057538866996765, param_norm=1887.1319580078125
Step 1512: grad_norm=2.9245548248291016, loss=0.25253042578697205, param_norm=1887.1319580078125
04:56:45.858 [I] Progress on: 1.51kit/2.00kit rate:8.8s/it remaining:1:11:49 elapsed:3:44:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1513: grad_norm=2.919440746307373, loss=0.3053015470504761, param_norm=1887.1319580078125
Step 1514: grad_norm=3.2985291481018066, loss=0.3080957531929016, param_norm=1887.1319580078125
04:57:03.518 [I] Progress on: 1.51kit/2.00kit rate:8.8s/it remaining:1:11:30 elapsed:3:44:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1515: grad_norm=3.9085981845855713, loss=0.2987605333328247, param_norm=1887.1319580078125
Step 1516: grad_norm=2.731178045272827, loss=0.26799917221069336, param_norm=1887.1319580078125
04:57:21.188 [I] Progress on: 1.52kit/2.00kit rate:8.8s/it remaining:1:11:16 elapsed:3:44:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1517: grad_norm=2.9907939434051514, loss=0.27115321159362793, param_norm=1887.1319580078125
04:57:32.521 [I] Progress on: 1.52kit/2.00kit rate:9.5s/it remaining:1:16:30 elapsed:3:44:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1518: grad_norm=3.3762753009796143, loss=0.2837652564048767, param_norm=1887.1319580078125
Step 1519: grad_norm=3.1856439113616943, loss=0.3068009316921234, param_norm=1887.1319580078125
04:57:49.900 [I] Progress on: 1.52kit/2.00kit rate:9.3s/it remaining:1:14:34 elapsed:3:45:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1520: grad_norm=3.770376205444336, loss=0.34003663063049316, param_norm=1887.132080078125
Step 1521: grad_norm=3.2104952335357666, loss=0.2782040238380432, param_norm=1887.132080078125
04:58:07.574 [I] Progress on: 1.52kit/2.00kit rate:9.1s/it remaining:1:12:19 elapsed:3:45:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1522: grad_norm=2.548832654953003, loss=0.22225219011306763, param_norm=1887.132080078125
Step 1523: grad_norm=2.846031904220581, loss=0.28509530425071716, param_norm=1887.132080078125
04:58:25.120 [I] Progress on: 1.52kit/2.00kit rate:8.9s/it remaining:1:10:52 elapsed:3:45:48 postfix:- (3802351:tqdm_logging.py:145)
Step 1524: grad_norm=3.792609930038452, loss=0.314802885055542, param_norm=1887.132080078125
Step 1525: grad_norm=3.0527939796447754, loss=0.24941551685333252, param_norm=1887.132080078125
04:58:42.712 [I] Progress on: 1.52kit/2.00kit rate:8.9s/it remaining:1:10:05 elapsed:3:46:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1526: grad_norm=3.9168591499328613, loss=0.32405197620391846, param_norm=1887.132080078125
Step 1527: grad_norm=3.1399710178375244, loss=0.27966341376304626, param_norm=1887.132080078125
04:59:00.392 [I] Progress on: 1.53kit/2.00kit rate:8.8s/it remaining:1:09:42 elapsed:3:46:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1528: grad_norm=3.155439615249634, loss=0.30139026045799255, param_norm=1887.132080078125
Step 1529: grad_norm=2.910766839981079, loss=0.2633935809135437, param_norm=1887.132080078125
04:59:18.015 [I] Progress on: 1.53kit/2.00kit rate:8.8s/it remaining:1:09:17 elapsed:3:46:41 postfix:- (3802351:tqdm_logging.py:145)
Step 1530: grad_norm=3.752643585205078, loss=0.2958528399467468, param_norm=1887.132080078125
Step 1531: grad_norm=2.4444971084594727, loss=0.24689069390296936, param_norm=1887.132080078125
04:59:35.863 [I] Progress on: 1.53kit/2.00kit rate:8.8s/it remaining:1:08:57 elapsed:3:46:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1532: grad_norm=2.966892957687378, loss=0.32097333669662476, param_norm=1887.1322021484375
Step 1533: grad_norm=2.9844181537628174, loss=0.2717423439025879, param_norm=1887.1322021484375
04:59:53.543 [I] Progress on: 1.53kit/2.00kit rate:8.9s/it remaining:1:09:03 elapsed:3:47:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1534: grad_norm=3.089359760284424, loss=0.23814935982227325, param_norm=1887.1322021484375
Step 1535: grad_norm=2.75862979888916, loss=0.2588382959365845, param_norm=1887.1322021484375
05:00:11.121 [I] Progress on: 1.53kit/2.00kit rate:8.8s/it remaining:1:08:26 elapsed:3:47:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1536: grad_norm=3.828462839126587, loss=0.32185590267181396, param_norm=1887.1322021484375
Step 1537: grad_norm=2.957224130630493, loss=0.22559712827205658, param_norm=1887.1322021484375
05:00:28.764 [I] Progress on: 1.54kit/2.00kit rate:8.8s/it remaining:1:08:05 elapsed:3:47:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1538: grad_norm=2.6352040767669678, loss=0.260294646024704, param_norm=1887.1322021484375
Step 1539: grad_norm=2.758247137069702, loss=0.23713044822216034, param_norm=1887.1322021484375
05:00:46.412 [I] Progress on: 1.54kit/2.00kit rate:8.8s/it remaining:1:07:47 elapsed:3:48:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1540: grad_norm=3.2102065086364746, loss=0.29435473680496216, param_norm=1887.1322021484375
Step 1541: grad_norm=2.6827335357666016, loss=0.2503676414489746, param_norm=1887.1322021484375
05:01:03.999 [I] Progress on: 1.54kit/2.00kit rate:8.8s/it remaining:1:07:22 elapsed:3:48:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1542: grad_norm=3.7563552856445312, loss=0.26563239097595215, param_norm=1887.13232421875
Step 1543: grad_norm=2.9763948917388916, loss=0.2552067041397095, param_norm=1887.1322021484375
05:01:21.629 [I] Progress on: 1.54kit/2.00kit rate:8.8s/it remaining:1:07:06 elapsed:3:48:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1544: grad_norm=2.986453056335449, loss=0.32190799713134766, param_norm=1887.1322021484375
Step 1545: grad_norm=2.9270060062408447, loss=0.25621914863586426, param_norm=1887.1322021484375
05:01:39.235 [I] Progress on: 1.54kit/2.00kit rate:8.8s/it remaining:1:06:45 elapsed:3:49:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1546: grad_norm=3.1693854331970215, loss=0.28237274289131165, param_norm=1887.1322021484375
Step 1547: grad_norm=2.79115891456604, loss=0.26767534017562866, param_norm=1887.13232421875
05:01:56.792 [I] Progress on: 1.55kit/2.00kit rate:8.8s/it remaining:1:06:23 elapsed:3:49:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1548: grad_norm=2.778775215148926, loss=0.2752549350261688, param_norm=1887.13232421875
Step 1549: grad_norm=2.649624824523926, loss=0.27933311462402344, param_norm=1887.13232421875
05:02:14.443 [I] Progress on: 1.55kit/2.00kit rate:8.8s/it remaining:1:06:12 elapsed:3:49:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1550: grad_norm=3.9852874279022217, loss=0.33758771419525146, param_norm=1887.13232421875
Step 1551: grad_norm=3.0711050033569336, loss=0.28991854190826416, param_norm=1887.13232421875
05:02:32.052 [I] Progress on: 1.55kit/2.00kit rate:8.8s/it remaining:1:05:53 elapsed:3:49:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1552: grad_norm=3.7151355743408203, loss=0.3146466314792633, param_norm=1887.13232421875
Step 1553: grad_norm=4.084543228149414, loss=0.3269146680831909, param_norm=1887.13232421875
05:02:49.710 [I] Progress on: 1.55kit/2.00kit rate:8.8s/it remaining:1:05:40 elapsed:3:50:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1554: grad_norm=2.945173978805542, loss=0.24094915390014648, param_norm=1887.13232421875
Step 1555: grad_norm=3.3538968563079834, loss=0.2542436420917511, param_norm=1887.13232421875
05:03:07.298 [I] Progress on: 1.55kit/2.00kit rate:8.8s/it remaining:1:05:16 elapsed:3:50:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1556: grad_norm=3.0817668437957764, loss=0.26200932264328003, param_norm=1887.13232421875
Step 1557: grad_norm=3.00760817527771, loss=0.24942001700401306, param_norm=1887.13232421875
05:03:24.898 [I] Progress on: 1.56kit/2.00kit rate:8.8s/it remaining:1:04:59 elapsed:3:50:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1558: grad_norm=2.8980624675750732, loss=0.2779258191585541, param_norm=1887.13232421875
Step 1559: grad_norm=3.5182933807373047, loss=0.2743629217147827, param_norm=1887.13232421875
05:03:42.503 [I] Progress on: 1.56kit/2.00kit rate:8.8s/it remaining:1:04:40 elapsed:3:51:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1560: grad_norm=2.7333261966705322, loss=0.25669634342193604, param_norm=1887.13232421875
Step 1561: grad_norm=2.5565128326416016, loss=0.2129254937171936, param_norm=1887.13232421875
05:04:00.156 [I] Progress on: 1.56kit/2.00kit rate:8.8s/it remaining:1:04:29 elapsed:3:51:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1562: grad_norm=2.404663324356079, loss=0.254495769739151, param_norm=1887.13232421875
Step 1563: grad_norm=2.978778123855591, loss=0.257053017616272, param_norm=1887.1324462890625
05:04:17.748 [I] Progress on: 1.56kit/2.00kit rate:8.8s/it remaining:1:04:06 elapsed:3:51:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1564: grad_norm=2.971693277359009, loss=0.29962778091430664, param_norm=1887.1324462890625
Step 1565: grad_norm=3.2048838138580322, loss=0.2649635076522827, param_norm=1887.1324462890625
05:04:35.379 [I] Progress on: 1.56kit/2.00kit rate:8.8s/it remaining:1:03:50 elapsed:3:51:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1566: grad_norm=3.497972249984741, loss=0.2686814069747925, param_norm=1887.1324462890625
Step 1567: grad_norm=3.119112014770508, loss=0.2758828103542328, param_norm=1887.1324462890625
05:04:53.010 [I] Progress on: 1.57kit/2.00kit rate:8.8s/it remaining:1:03:35 elapsed:3:52:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1568: grad_norm=3.1002798080444336, loss=0.2505999505519867, param_norm=1887.1324462890625
Step 1569: grad_norm=2.427780866622925, loss=0.242362380027771, param_norm=1887.1324462890625
05:05:10.662 [I] Progress on: 1.57kit/2.00kit rate:8.8s/it remaining:1:03:20 elapsed:3:52:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1570: grad_norm=2.9363250732421875, loss=0.2522502541542053, param_norm=1887.1324462890625
Step 1571: grad_norm=4.396969795227051, loss=0.30316758155822754, param_norm=1887.1324462890625
05:05:28.292 [I] Progress on: 1.57kit/2.00kit rate:8.8s/it remaining:1:03:00 elapsed:3:52:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1572: grad_norm=3.4046216011047363, loss=0.2693290710449219, param_norm=1887.1324462890625
Step 1573: grad_norm=3.093334674835205, loss=0.23162828385829926, param_norm=1887.1324462890625
05:05:45.919 [I] Progress on: 1.57kit/2.00kit rate:8.8s/it remaining:1:02:41 elapsed:3:53:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1574: grad_norm=2.0638890266418457, loss=0.19567367434501648, param_norm=1887.132568359375
Step 1575: grad_norm=2.8415744304656982, loss=0.23559966683387756, param_norm=1887.132568359375
05:06:03.573 [I] Progress on: 1.57kit/2.00kit rate:8.8s/it remaining:1:02:28 elapsed:3:53:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1576: grad_norm=3.0891244411468506, loss=0.26653286814689636, param_norm=1887.132568359375
Step 1577: grad_norm=2.9917757511138916, loss=0.29135218262672424, param_norm=1887.132568359375
05:06:21.167 [I] Progress on: 1.58kit/2.00kit rate:8.8s/it remaining:1:02:05 elapsed:3:53:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1578: grad_norm=3.029311180114746, loss=0.2623181939125061, param_norm=1887.132568359375
Step 1579: grad_norm=2.58772611618042, loss=0.26126980781555176, param_norm=1887.132568359375
05:06:38.785 [I] Progress on: 1.58kit/2.00kit rate:8.8s/it remaining:1:01:47 elapsed:3:54:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1580: grad_norm=3.149867057800293, loss=0.28782618045806885, param_norm=1887.132568359375
Step 1581: grad_norm=3.509035348892212, loss=0.2936723828315735, param_norm=1887.132568359375
05:06:56.422 [I] Progress on: 1.58kit/2.00kit rate:8.8s/it remaining:1:01:31 elapsed:3:54:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1582: grad_norm=3.0676677227020264, loss=0.265308678150177, param_norm=1887.132568359375
Step 1583: grad_norm=2.4008891582489014, loss=0.2173396348953247, param_norm=1887.132568359375
05:07:14.022 [I] Progress on: 1.58kit/2.00kit rate:8.8s/it remaining:1:01:11 elapsed:3:54:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1584: grad_norm=2.966548442840576, loss=0.23864370584487915, param_norm=1887.132568359375
Step 1585: grad_norm=2.698305130004883, loss=0.21870288252830505, param_norm=1887.132568359375
05:07:31.591 [I] Progress on: 1.58kit/2.00kit rate:8.8s/it remaining:1:00:49 elapsed:3:54:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1586: grad_norm=3.3533918857574463, loss=0.2424752414226532, param_norm=1887.132568359375
05:07:42.823 [I] Progress on: 1.59kit/2.00kit rate:9.5s/it remaining:1:05:11 elapsed:3:55:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1587: grad_norm=3.237208604812622, loss=0.26117125153541565, param_norm=1887.132568359375
Step 1588: grad_norm=3.0400779247283936, loss=0.25274521112442017, param_norm=1887.1326904296875
05:08:00.138 [I] Progress on: 1.59kit/2.00kit rate:9.2s/it remaining:1:03:28 elapsed:3:55:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1589: grad_norm=2.107919454574585, loss=0.20030641555786133, param_norm=1887.1326904296875
Step 1590: grad_norm=3.379544496536255, loss=0.24665476381778717, param_norm=1887.1326904296875
05:08:17.737 [I] Progress on: 1.59kit/2.00kit rate:9.0s/it remaining:1:01:35 elapsed:3:55:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1591: grad_norm=3.2236530780792236, loss=0.283374160528183, param_norm=1887.1326904296875
Step 1592: grad_norm=3.0366530418395996, loss=0.26400864124298096, param_norm=1887.1326904296875
05:08:35.355 [I] Progress on: 1.59kit/2.00kit rate:8.9s/it remaining:1:00:33 elapsed:3:55:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1593: grad_norm=3.5286505222320557, loss=0.28940534591674805, param_norm=1887.1326904296875
Step 1594: grad_norm=3.091379404067993, loss=0.274103581905365, param_norm=1887.1326904296875
05:08:52.988 [I] Progress on: 1.59kit/2.00kit rate:8.9s/it remaining:59:56 elapsed:3:56:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1595: grad_norm=3.8231611251831055, loss=0.2936590611934662, param_norm=1887.1326904296875
Step 1596: grad_norm=3.72821307182312, loss=0.2855101227760315, param_norm=1887.1326904296875
05:09:10.642 [I] Progress on: 1.60kit/2.00kit rate:8.8s/it remaining:59:31 elapsed:3:56:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1597: grad_norm=4.236849308013916, loss=0.35316944122314453, param_norm=1887.1326904296875
Step 1598: grad_norm=3.710270643234253, loss=0.2964322566986084, param_norm=1887.1326904296875
05:09:28.304 [I] Progress on: 1.60kit/2.00kit rate:8.8s/it remaining:59:11 elapsed:3:56:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1599: grad_norm=3.26326060295105, loss=0.2601136565208435, param_norm=1887.1328125
Step 1600: grad_norm=3.0470128059387207, loss=0.2337777018547058, param_norm=1887.1328125
05:09:45.936 [I] Progress on: 1.60kit/2.00kit rate:8.8s/it remaining:58:49 elapsed:3:57:08 postfix:- (3802351:tqdm_logging.py:145)
05:09:46.160 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
05:09:46.161 [I] [process=0][thread=MainThread][step=1500][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
05:09:46.161 [I] [process=0][thread=MainThread][step=1500][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1500. (3802351:checkpoint_manager.py:1786)
05:09:46.161 [I] [process=0][thread=MainThread][step=1500][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1500, also errors if any. (3802351:checkpoint_manager.py:1817)
05:09:46.161 [I] [process=0] Saving checkpoint at step 1600                                       (3802351:checkpoint_manager.py:1286)
05:09:46.162 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600. (3802351:async_checkpointer.py:358)
05:09:46.163 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:09:46.164 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45 (3802351:atomicity.py:144)
05:09:46.165 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:09:46.165 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:09:46.167 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45/assets.orbax-checkpoint-tmp-46 (3802351:atomicity.py:144)
05:09:46.169 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45/params.orbax-checkpoint-tmp-47 (3802351:atomicity.py:144)
05:09:46.170 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:09:46.175 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
05:09:50.073 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
05:09:50.074 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
05:09:50.075 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:09:50.091 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
05:09:50.099 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.102 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.102 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.103 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.104 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.106 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.106 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.108 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.109 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.110 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.111 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.112 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.112 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.117 [I] Preserving Checkpoint[step=1400 | time=2025-03-24 08:40:13.026710+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.121 [I] Preserving Checkpoint[step=1500 | time=2025-03-24 08:55:00.436780+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:09:50.121 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
05:09:50.125 [I] [process=0][thread=MainThread][step=1600] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
05:09:50.127 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
05:09:50.138 [I] {'step': 1600, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742807386.1609166, 'wait_for_prev_duration_secs': 0.0007376670837402344, 'checkpointer_blocking_start_time': 1742807386.1621053, 'checkpointer_blocking_duration_secs': 3.936915159225464, 'get_old_steps_start_time': 1742807390.0990741, 'get_old_steps_duration_secs': 0.022705078125, 'checkpoint_manager_blocking_start_time': 1742807386.160846, 'checkpoint_manager_blocking_duration_secs': 3.9773385524749756} (3802351:standard_logger.py:34)
05:09:57.889 [I] ChainedFuture completed 1/1 futures in 7.79 seconds.                             (3802351:future.py:137)
05:09:57.889 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 884.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:09:57.890 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
05:09:57.891 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45 (3802351:async_checkpointer.py:406)
05:09:57.892 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45/assets.orbax-checkpoint-tmp-46 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45/assets (3802351:atomicity.py:287)
05:09:57.906 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45/params.orbax-checkpoint-tmp-47 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45/params (3802351:atomicity.py:287)
05:09:57.906 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600 (3802351:async_checkpointer.py:416)
05:09:57.907 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45 (3802351:async_checkpointer.py:426)
05:09:57.907 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600.orbax-checkpoint-tmp-45 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600 (3802351:atomicity.py:287)
05:09:57.909 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1600`. (3802351:atomicity.py:548)
05:09:57.909 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
05:09:57.910 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
05:09:57.910 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
05:09:57.911 [I] [process=0][thread=save_finalize][step=1600] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
05:09:57.911 [I] [process=0][thread=save_finalize][step=1600] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1601: grad_norm=2.4227983951568604, loss=0.23333628475666046, param_norm=1887.1328125
05:09:58.742 [I] Progress on: 1.60kit/2.00kit rate:10.0s/it remaining:1:06:38 elapsed:3:57:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1602: grad_norm=3.221583366394043, loss=0.3140968978404999, param_norm=1887.1328125
Step 1603: grad_norm=2.964959144592285, loss=0.2271527349948883, param_norm=1887.1328125
05:10:16.347 [I] Progress on: 1.60kit/2.00kit rate:9.4s/it remaining:1:02:11 elapsed:3:57:39 postfix:- (3802351:tqdm_logging.py:145)
Step 1604: grad_norm=3.4165127277374268, loss=0.2606281042098999, param_norm=1887.1329345703125
Step 1605: grad_norm=2.672415256500244, loss=0.2671299874782562, param_norm=1887.1329345703125
05:10:33.962 [I] Progress on: 1.60kit/2.00kit rate:9.1s/it remaining:59:54 elapsed:3:57:57 postfix:- (3802351:tqdm_logging.py:145)
Step 1606: grad_norm=3.060093879699707, loss=0.2641316056251526, param_norm=1887.1329345703125
Step 1607: grad_norm=3.2932446002960205, loss=0.26540321111679077, param_norm=1887.1329345703125
05:10:51.575 [I] Progress on: 1.61kit/2.00kit rate:8.9s/it remaining:58:36 elapsed:3:58:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1608: grad_norm=2.4910571575164795, loss=0.1823509782552719, param_norm=1887.1329345703125
Step 1609: grad_norm=3.120427131652832, loss=0.29747188091278076, param_norm=1887.1329345703125
05:11:09.181 [I] Progress on: 1.61kit/2.00kit rate:8.9s/it remaining:57:50 elapsed:3:58:32 postfix:- (3802351:tqdm_logging.py:145)
Step 1610: grad_norm=3.366894245147705, loss=0.24790167808532715, param_norm=1887.1329345703125
Step 1611: grad_norm=3.4302823543548584, loss=0.26269450783729553, param_norm=1887.1329345703125
05:11:26.795 [I] Progress on: 1.61kit/2.00kit rate:8.8s/it remaining:57:18 elapsed:3:58:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1612: grad_norm=2.8247580528259277, loss=0.23623278737068176, param_norm=1887.1329345703125
Step 1613: grad_norm=2.9563522338867188, loss=0.29780474305152893, param_norm=1887.133056640625
05:11:44.411 [I] Progress on: 1.61kit/2.00kit rate:8.8s/it remaining:56:56 elapsed:3:59:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1614: grad_norm=2.34232759475708, loss=0.21980395913124084, param_norm=1887.133056640625
Step 1615: grad_norm=3.662142038345337, loss=0.32533684372901917, param_norm=1887.133056640625
05:12:02.002 [I] Progress on: 1.61kit/2.00kit rate:8.8s/it remaining:56:31 elapsed:3:59:25 postfix:- (3802351:tqdm_logging.py:145)
Step 1616: grad_norm=3.2479724884033203, loss=0.320476233959198, param_norm=1887.133056640625
Step 1617: grad_norm=2.771543264389038, loss=0.21001233160495758, param_norm=1887.133056640625
05:12:19.602 [I] Progress on: 1.62kit/2.00kit rate:8.8s/it remaining:56:12 elapsed:3:59:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1618: grad_norm=2.8964991569519043, loss=0.27161064743995667, param_norm=1887.133056640625
Step 1619: grad_norm=2.935436248779297, loss=0.260386198759079, param_norm=1887.133056640625
05:12:37.206 [I] Progress on: 1.62kit/2.00kit rate:8.8s/it remaining:55:54 elapsed:4:00:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1620: grad_norm=2.9621615409851074, loss=0.2621431350708008, param_norm=1887.133056640625
Step 1621: grad_norm=3.229752779006958, loss=0.2782045006752014, param_norm=1887.133056640625
05:12:55.018 [I] Progress on: 1.62kit/2.00kit rate:8.9s/it remaining:56:02 elapsed:4:00:18 postfix:- (3802351:tqdm_logging.py:145)
Step 1622: grad_norm=2.3586275577545166, loss=0.25669944286346436, param_norm=1887.133056640625
Step 1623: grad_norm=3.338754415512085, loss=0.269512802362442, param_norm=1887.133056640625
05:13:12.625 [I] Progress on: 1.62kit/2.00kit rate:8.8s/it remaining:55:31 elapsed:4:00:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1624: grad_norm=2.5975019931793213, loss=0.21894505620002747, param_norm=1887.1331787109375
Step 1625: grad_norm=2.864044189453125, loss=0.2701006233692169, param_norm=1887.1331787109375
05:13:30.227 [I] Progress on: 1.62kit/2.00kit rate:8.8s/it remaining:55:05 elapsed:4:00:53 postfix:- (3802351:tqdm_logging.py:145)
Step 1626: grad_norm=2.504382371902466, loss=0.22067531943321228, param_norm=1887.1331787109375
Step 1627: grad_norm=2.8037877082824707, loss=0.27919620275497437, param_norm=1887.1331787109375
05:13:47.815 [I] Progress on: 1.63kit/2.00kit rate:8.8s/it remaining:54:43 elapsed:4:01:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1628: grad_norm=3.3723995685577393, loss=0.24739626049995422, param_norm=1887.1331787109375
Step 1629: grad_norm=3.0140116214752197, loss=0.26984161138534546, param_norm=1887.1331787109375
05:14:05.433 [I] Progress on: 1.63kit/2.00kit rate:8.8s/it remaining:54:28 elapsed:4:01:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1630: grad_norm=3.290961980819702, loss=0.2437668889760971, param_norm=1887.1331787109375
Step 1631: grad_norm=3.8439688682556152, loss=0.2899261713027954, param_norm=1887.1331787109375
05:14:23.042 [I] Progress on: 1.63kit/2.00kit rate:8.8s/it remaining:54:09 elapsed:4:01:46 postfix:- (3802351:tqdm_logging.py:145)
Step 1632: grad_norm=2.6847455501556396, loss=0.23857907950878143, param_norm=1887.1331787109375
Step 1633: grad_norm=2.5747182369232178, loss=0.23801027238368988, param_norm=1887.1331787109375
05:14:40.666 [I] Progress on: 1.63kit/2.00kit rate:8.8s/it remaining:53:53 elapsed:4:02:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1634: grad_norm=3.218881607055664, loss=0.28081557154655457, param_norm=1887.1331787109375
Step 1635: grad_norm=3.0448431968688965, loss=0.21129736304283142, param_norm=1887.133056640625
05:14:58.254 [I] Progress on: 1.64kit/2.00kit rate:8.8s/it remaining:53:34 elapsed:4:02:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1636: grad_norm=2.271401882171631, loss=0.20500729978084564, param_norm=1887.1331787109375
Step 1637: grad_norm=3.3730227947235107, loss=0.2700121998786926, param_norm=1887.1331787109375
05:15:15.855 [I] Progress on: 1.64kit/2.00kit rate:8.8s/it remaining:53:16 elapsed:4:02:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1638: grad_norm=3.6177797317504883, loss=0.2511481046676636, param_norm=1887.1331787109375
Step 1639: grad_norm=2.982844114303589, loss=0.21762409806251526, param_norm=1887.1331787109375
05:15:33.486 [I] Progress on: 1.64kit/2.00kit rate:8.8s/it remaining:53:00 elapsed:4:02:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1640: grad_norm=2.747413396835327, loss=0.25923943519592285, param_norm=1887.1331787109375
Step 1641: grad_norm=2.3725597858428955, loss=0.23242850601673126, param_norm=1887.1331787109375
05:15:51.128 [I] Progress on: 1.64kit/2.00kit rate:8.8s/it remaining:52:44 elapsed:4:03:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1642: grad_norm=3.33699631690979, loss=0.30890220403671265, param_norm=1887.1331787109375
Step 1643: grad_norm=3.5320122241973877, loss=0.3194290101528168, param_norm=1887.1331787109375
05:16:08.760 [I] Progress on: 1.64kit/2.00kit rate:8.8s/it remaining:52:28 elapsed:4:03:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1644: grad_norm=3.2454116344451904, loss=0.22885268926620483, param_norm=1887.1331787109375
Step 1645: grad_norm=3.3899197578430176, loss=0.2540506422519684, param_norm=1887.1331787109375
05:16:26.410 [I] Progress on: 1.65kit/2.00kit rate:8.8s/it remaining:52:13 elapsed:4:03:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1646: grad_norm=2.855342149734497, loss=0.2629743218421936, param_norm=1887.13330078125
Step 1647: grad_norm=2.8011820316314697, loss=0.23779763281345367, param_norm=1887.1331787109375
05:16:43.995 [I] Progress on: 1.65kit/2.00kit rate:8.8s/it remaining:51:49 elapsed:4:04:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1648: grad_norm=3.4354164600372314, loss=0.31120923161506653, param_norm=1887.1331787109375
Step 1649: grad_norm=2.9414772987365723, loss=0.28429263830184937, param_norm=1887.1331787109375
05:17:01.580 [I] Progress on: 1.65kit/2.00kit rate:8.8s/it remaining:51:27 elapsed:4:04:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1650: grad_norm=3.384492874145508, loss=0.2937612533569336, param_norm=1887.13330078125
Step 1651: grad_norm=3.255714178085327, loss=0.2995375394821167, param_norm=1887.1331787109375
05:17:19.234 [I] Progress on: 1.65kit/2.00kit rate:8.8s/it remaining:51:17 elapsed:4:04:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1652: grad_norm=3.0315163135528564, loss=0.22409862279891968, param_norm=1887.1331787109375
Step 1653: grad_norm=3.2116506099700928, loss=0.25003379583358765, param_norm=1887.13330078125
05:17:36.872 [I] Progress on: 1.65kit/2.00kit rate:8.8s/it remaining:50:59 elapsed:4:04:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1654: grad_norm=2.7940359115600586, loss=0.2254522740840912, param_norm=1887.13330078125
Step 1655: grad_norm=2.2710959911346436, loss=0.19088387489318848, param_norm=1887.1331787109375
05:17:54.521 [I] Progress on: 1.66kit/2.00kit rate:8.8s/it remaining:50:42 elapsed:4:05:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1656: grad_norm=3.6026411056518555, loss=0.26168230175971985, param_norm=1887.1331787109375
05:18:05.703 [I] Progress on: 1.66kit/2.00kit rate:9.5s/it remaining:54:41 elapsed:4:05:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1657: grad_norm=2.462250232696533, loss=0.22688105702400208, param_norm=1887.13330078125
Step 1658: grad_norm=3.1441245079040527, loss=0.28875744342803955, param_norm=1887.13330078125
05:18:23.258 [I] Progress on: 1.66kit/2.00kit rate:9.1s/it remaining:52:08 elapsed:4:05:46 postfix:- (3802351:tqdm_logging.py:145)
Step 1659: grad_norm=3.257014751434326, loss=0.26526618003845215, param_norm=1887.13330078125
Step 1660: grad_norm=4.30649471282959, loss=0.2882046699523926, param_norm=1887.13330078125
05:18:40.829 [I] Progress on: 1.66kit/2.00kit rate:9.0s/it remaining:50:46 elapsed:4:06:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1661: grad_norm=3.2913858890533447, loss=0.28754860162734985, param_norm=1887.13330078125
Step 1662: grad_norm=2.693044900894165, loss=0.23647667467594147, param_norm=1887.13330078125
05:18:58.456 [I] Progress on: 1.66kit/2.00kit rate:8.9s/it remaining:50:02 elapsed:4:06:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1663: grad_norm=3.048248291015625, loss=0.23015065491199493, param_norm=1887.13330078125
Step 1664: grad_norm=3.535277843475342, loss=0.28333330154418945, param_norm=1887.13330078125
05:19:16.028 [I] Progress on: 1.66kit/2.00kit rate:8.8s/it remaining:49:28 elapsed:4:06:39 postfix:- (3802351:tqdm_logging.py:145)
Step 1665: grad_norm=3.123539686203003, loss=0.2874939739704132, param_norm=1887.13330078125
Step 1666: grad_norm=2.97920560836792, loss=0.24332647025585175, param_norm=1887.13330078125
05:19:33.647 [I] Progress on: 1.67kit/2.00kit rate:8.8s/it remaining:49:05 elapsed:4:06:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1667: grad_norm=4.404534339904785, loss=0.31374499201774597, param_norm=1887.1334228515625
Step 1668: grad_norm=4.079723358154297, loss=0.2850474715232849, param_norm=1887.1334228515625
05:19:51.277 [I] Progress on: 1.67kit/2.00kit rate:8.8s/it remaining:48:46 elapsed:4:07:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1669: grad_norm=3.2260875701904297, loss=0.25844618678092957, param_norm=1887.1334228515625
Step 1670: grad_norm=2.6156272888183594, loss=0.22855782508850098, param_norm=1887.1334228515625
05:20:08.894 [I] Progress on: 1.67kit/2.00kit rate:8.8s/it remaining:48:27 elapsed:4:07:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1671: grad_norm=3.0652694702148438, loss=0.2376035451889038, param_norm=1887.1334228515625
Step 1672: grad_norm=3.204425573348999, loss=0.3146684765815735, param_norm=1887.133544921875
05:20:26.512 [I] Progress on: 1.67kit/2.00kit rate:8.8s/it remaining:48:08 elapsed:4:07:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1673: grad_norm=2.996048927307129, loss=0.2475491762161255, param_norm=1887.133544921875
Step 1674: grad_norm=2.959219455718994, loss=0.2197839319705963, param_norm=1887.133544921875
05:20:44.109 [I] Progress on: 1.67kit/2.00kit rate:8.8s/it remaining:47:49 elapsed:4:08:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1675: grad_norm=3.1915764808654785, loss=0.27876630425453186, param_norm=1887.133544921875
Step 1676: grad_norm=2.9561312198638916, loss=0.25052493810653687, param_norm=1887.133544921875
05:21:01.733 [I] Progress on: 1.68kit/2.00kit rate:8.8s/it remaining:47:32 elapsed:4:08:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1677: grad_norm=3.6658473014831543, loss=0.24775823950767517, param_norm=1887.133544921875
Step 1678: grad_norm=3.189652442932129, loss=0.246914803981781, param_norm=1887.133544921875
05:21:19.347 [I] Progress on: 1.68kit/2.00kit rate:8.8s/it remaining:47:15 elapsed:4:08:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1679: grad_norm=4.040907859802246, loss=0.29092568159103394, param_norm=1887.133544921875
Step 1680: grad_norm=2.826141119003296, loss=0.20061783492565155, param_norm=1887.133544921875
05:21:36.950 [I] Progress on: 1.68kit/2.00kit rate:8.8s/it remaining:46:55 elapsed:4:09:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1681: grad_norm=3.684140682220459, loss=0.2547397315502167, param_norm=1887.133544921875
Step 1682: grad_norm=3.6076414585113525, loss=0.30753248929977417, param_norm=1887.133544921875
05:21:54.554 [I] Progress on: 1.68kit/2.00kit rate:8.8s/it remaining:46:39 elapsed:4:09:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1683: grad_norm=3.630679130554199, loss=0.2692648768424988, param_norm=1887.133544921875
Step 1684: grad_norm=2.1810429096221924, loss=0.17734739184379578, param_norm=1887.133544921875
05:22:12.167 [I] Progress on: 1.68kit/2.00kit rate:8.8s/it remaining:46:20 elapsed:4:09:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1685: grad_norm=3.3932111263275146, loss=0.254216730594635, param_norm=1887.133544921875
Step 1686: grad_norm=2.3544490337371826, loss=0.20443633198738098, param_norm=1887.133544921875
05:22:29.783 [I] Progress on: 1.69kit/2.00kit rate:8.8s/it remaining:46:03 elapsed:4:09:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1687: grad_norm=4.100574493408203, loss=0.3080269694328308, param_norm=1887.133544921875
Step 1688: grad_norm=3.4055898189544678, loss=0.25336819887161255, param_norm=1887.133544921875
05:22:47.413 [I] Progress on: 1.69kit/2.00kit rate:8.8s/it remaining:45:46 elapsed:4:10:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1689: grad_norm=2.34747052192688, loss=0.22358322143554688, param_norm=1887.133544921875
Step 1690: grad_norm=3.631488084793091, loss=0.27851492166519165, param_norm=1887.1337890625
05:23:05.060 [I] Progress on: 1.69kit/2.00kit rate:8.8s/it remaining:45:32 elapsed:4:10:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1691: grad_norm=3.0267984867095947, loss=0.2572934627532959, param_norm=1887.1337890625
Step 1692: grad_norm=2.868695020675659, loss=0.23476871848106384, param_norm=1887.1336669921875
05:23:22.706 [I] Progress on: 1.69kit/2.00kit rate:8.8s/it remaining:45:15 elapsed:4:10:45 postfix:- (3802351:tqdm_logging.py:145)
Step 1693: grad_norm=2.450347423553467, loss=0.22485986351966858, param_norm=1887.1337890625
Step 1694: grad_norm=4.414557933807373, loss=0.2954157590866089, param_norm=1887.1337890625
05:23:40.336 [I] Progress on: 1.69kit/2.00kit rate:8.8s/it remaining:44:58 elapsed:4:11:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1695: grad_norm=3.2816579341888428, loss=0.25324076414108276, param_norm=1887.1337890625
Step 1696: grad_norm=3.7905280590057373, loss=0.2556586265563965, param_norm=1887.1337890625
05:23:57.939 [I] Progress on: 1.70kit/2.00kit rate:8.8s/it remaining:44:37 elapsed:4:11:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1697: grad_norm=3.670551061630249, loss=0.27144861221313477, param_norm=1887.1337890625
Step 1698: grad_norm=4.740087985992432, loss=0.3145237863063812, param_norm=1887.1337890625
05:24:15.535 [I] Progress on: 1.70kit/2.00kit rate:8.8s/it remaining:44:18 elapsed:4:11:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1699: grad_norm=3.1028342247009277, loss=0.2680242657661438, param_norm=1887.1337890625
Step 1700: grad_norm=3.413600206375122, loss=0.2407854199409485, param_norm=1887.1337890625
05:24:33.139 [I] Progress on: 1.70kit/2.00kit rate:8.8s/it remaining:43:59 elapsed:4:11:56 postfix:- (3802351:tqdm_logging.py:145)
05:24:33.356 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
05:24:33.356 [I] [process=0][thread=MainThread][step=1600][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
05:24:33.356 [I] [process=0][thread=MainThread][step=1600][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1600. (3802351:checkpoint_manager.py:1786)
05:24:33.356 [I] [process=0][thread=MainThread][step=1600][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1600, also errors if any. (3802351:checkpoint_manager.py:1817)
05:24:33.357 [I] [process=0] Saving checkpoint at step 1700                                       (3802351:checkpoint_manager.py:1286)
05:24:33.358 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700. (3802351:async_checkpointer.py:358)
05:24:33.359 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:24:33.360 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48 (3802351:atomicity.py:144)
05:24:33.361 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:24:33.361 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:24:33.362 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50 (3802351:atomicity.py:144)
05:24:33.363 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48/assets.orbax-checkpoint-tmp-49 (3802351:atomicity.py:144)
05:24:33.365 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:24:33.370 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
05:24:37.241 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
05:24:37.243 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
05:24:37.261 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:24:37.277 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
05:24:37.291 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.292 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.293 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.294 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.294 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.297 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.303 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.303 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.304 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.304 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.306 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.308 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.308 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.309 [I] Preserving Checkpoint[step=1400 | time=2025-03-24 08:40:13.026710+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.309 [I] Preserving Checkpoint[step=1500 | time=2025-03-24 08:55:00.436780+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.309 [I] Preserving Checkpoint[step=1600 | time=2025-03-24 09:09:50.099040+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:24:37.310 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
05:24:37.310 [I] [process=0][thread=MainThread][step=1700] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
05:24:37.320 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
05:24:37.321 [I] {'step': 1700, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742808273.3562362, 'wait_for_prev_duration_secs': 0.0008108615875244141, 'checkpointer_blocking_start_time': 1742808273.3576348, 'checkpointer_blocking_duration_secs': 3.933284282684326, 'get_old_steps_start_time': 1742808277.2909758, 'get_old_steps_duration_secs': 0.019058942794799805, 'checkpoint_manager_blocking_start_time': 1742808273.3560445, 'checkpoint_manager_blocking_duration_secs': 3.9648845195770264} (3802351:standard_logger.py:34)
05:24:45.234 [I] ChainedFuture completed 1/1 futures in 7.95 seconds.                             (3802351:future.py:137)
05:24:45.235 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 872.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:24:45.236 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
05:24:45.237 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48 (3802351:async_checkpointer.py:406)
05:24:45.238 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48/assets.orbax-checkpoint-tmp-49 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48/assets (3802351:atomicity.py:287)
05:24:45.249 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48/params (3802351:atomicity.py:287)
05:24:45.250 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700 (3802351:async_checkpointer.py:416)
05:24:45.250 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48 (3802351:async_checkpointer.py:426)
05:24:45.250 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700.orbax-checkpoint-tmp-48 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700 (3802351:atomicity.py:287)
05:24:45.252 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1700`. (3802351:atomicity.py:548)
05:24:45.252 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
05:24:45.253 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
05:24:45.253 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
05:24:45.254 [I] [process=0][thread=save_finalize][step=1700] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
05:24:45.254 [I] [process=0][thread=save_finalize][step=1700] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1701: grad_norm=2.432840585708618, loss=0.24702122807502747, param_norm=1887.1337890625
05:24:45.911 [I] Progress on: 1.70kit/2.00kit rate:10.0s/it remaining:49:50 elapsed:4:12:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1702: grad_norm=2.8945553302764893, loss=0.23223987221717834, param_norm=1887.1337890625
Step 1703: grad_norm=3.2123806476593018, loss=0.24902427196502686, param_norm=1887.1337890625
05:25:03.535 [I] Progress on: 1.70kit/2.00kit rate:9.4s/it remaining:46:30 elapsed:4:12:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1704: grad_norm=3.9440112113952637, loss=0.3175443410873413, param_norm=1887.1339111328125
Step 1705: grad_norm=3.2561025619506836, loss=0.2715217173099518, param_norm=1887.1339111328125
05:25:21.105 [I] Progress on: 1.71kit/2.00kit rate:9.1s/it remaining:44:40 elapsed:4:12:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1706: grad_norm=3.461623191833496, loss=0.2676076889038086, param_norm=1887.1339111328125
Step 1707: grad_norm=3.16827654838562, loss=0.2938973903656006, param_norm=1887.1339111328125
05:25:38.641 [I] Progress on: 1.71kit/2.00kit rate:8.9s/it remaining:43:33 elapsed:4:13:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1708: grad_norm=3.445727825164795, loss=0.2618476152420044, param_norm=1887.1339111328125
Step 1709: grad_norm=2.6317811012268066, loss=0.2291519194841385, param_norm=1887.1339111328125
05:25:56.321 [I] Progress on: 1.71kit/2.00kit rate:8.9s/it remaining:43:04 elapsed:4:13:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1710: grad_norm=3.582458972930908, loss=0.26835930347442627, param_norm=1887.1339111328125
Step 1711: grad_norm=3.348271608352661, loss=0.2776590585708618, param_norm=1887.1339111328125
05:26:13.972 [I] Progress on: 1.71kit/2.00kit rate:8.9s/it remaining:42:39 elapsed:4:13:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1712: grad_norm=3.317213296890259, loss=0.27555397152900696, param_norm=1887.1339111328125
Step 1713: grad_norm=3.112413167953491, loss=0.2679412364959717, param_norm=1887.1339111328125
05:26:31.615 [I] Progress on: 1.71kit/2.00kit rate:8.8s/it remaining:42:17 elapsed:4:13:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1714: grad_norm=3.160615921020508, loss=0.25377440452575684, param_norm=1887.1339111328125
Step 1715: grad_norm=2.8668572902679443, loss=0.26006150245666504, param_norm=1887.1339111328125
05:26:49.267 [I] Progress on: 1.72kit/2.00kit rate:8.8s/it remaining:41:56 elapsed:4:14:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1716: grad_norm=2.842452049255371, loss=0.2248261570930481, param_norm=1887.1339111328125
Step 1717: grad_norm=3.6495792865753174, loss=0.25833868980407715, param_norm=1887.134033203125
05:27:06.919 [I] Progress on: 1.72kit/2.00kit rate:8.8s/it remaining:41:38 elapsed:4:14:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1718: grad_norm=3.2648613452911377, loss=0.3023814558982849, param_norm=1887.134033203125
Step 1719: grad_norm=2.9560937881469727, loss=0.25020426511764526, param_norm=1887.134033203125
05:27:24.565 [I] Progress on: 1.72kit/2.00kit rate:8.8s/it remaining:41:20 elapsed:4:14:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1720: grad_norm=3.300168991088867, loss=0.2367132604122162, param_norm=1887.134033203125
Step 1721: grad_norm=2.932358503341675, loss=0.27392125129699707, param_norm=1887.134033203125
05:27:42.191 [I] Progress on: 1.72kit/2.00kit rate:8.8s/it remaining:41:01 elapsed:4:15:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1722: grad_norm=2.9861087799072266, loss=0.24958176910877228, param_norm=1887.134033203125
Step 1723: grad_norm=2.733750820159912, loss=0.24394766986370087, param_norm=1887.134033203125
05:27:59.877 [I] Progress on: 1.72kit/2.00kit rate:8.8s/it remaining:40:46 elapsed:4:15:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1724: grad_norm=3.0833449363708496, loss=0.2702889144420624, param_norm=1887.134033203125
05:28:11.435 [I] Progress on: 1.73kit/2.00kit rate:9.6s/it remaining:43:55 elapsed:4:15:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1725: grad_norm=2.5250227451324463, loss=0.25677740573883057, param_norm=1887.134033203125
Step 1726: grad_norm=3.099144220352173, loss=0.22139997780323029, param_norm=1887.134033203125
05:28:28.737 [I] Progress on: 1.73kit/2.00kit rate:9.3s/it remaining:42:34 elapsed:4:15:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1727: grad_norm=3.2981631755828857, loss=0.2580573260784149, param_norm=1887.134033203125
Step 1728: grad_norm=2.473327875137329, loss=0.20290769636631012, param_norm=1887.1341552734375
05:28:46.335 [I] Progress on: 1.73kit/2.00kit rate:9.1s/it remaining:41:02 elapsed:4:16:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1729: grad_norm=3.557508707046509, loss=0.26574909687042236, param_norm=1887.1341552734375
Step 1730: grad_norm=2.7319042682647705, loss=0.23875968158245087, param_norm=1887.1341552734375
05:29:03.885 [I] Progress on: 1.73kit/2.00kit rate:8.9s/it remaining:40:05 elapsed:4:16:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1731: grad_norm=2.289710521697998, loss=0.20821800827980042, param_norm=1887.1341552734375
Step 1732: grad_norm=4.107734680175781, loss=0.2429770529270172, param_norm=1887.1341552734375
05:29:21.485 [I] Progress on: 1.73kit/2.00kit rate:8.9s/it remaining:39:33 elapsed:4:16:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1733: grad_norm=3.4090750217437744, loss=0.27929574251174927, param_norm=1887.1341552734375
Step 1734: grad_norm=2.3879895210266113, loss=0.20379337668418884, param_norm=1887.1341552734375
05:29:39.084 [I] Progress on: 1.73kit/2.00kit rate:8.8s/it remaining:39:07 elapsed:4:17:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1735: grad_norm=2.752112627029419, loss=0.25272366404533386, param_norm=1887.1341552734375
Step 1736: grad_norm=2.7884716987609863, loss=0.28113284707069397, param_norm=1887.1341552734375
05:29:56.699 [I] Progress on: 1.74kit/2.00kit rate:8.8s/it remaining:38:47 elapsed:4:17:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1737: grad_norm=4.290093421936035, loss=0.2854371666908264, param_norm=1887.1341552734375
Step 1738: grad_norm=3.171760082244873, loss=0.25903820991516113, param_norm=1887.1341552734375
05:30:14.301 [I] Progress on: 1.74kit/2.00kit rate:8.8s/it remaining:38:27 elapsed:4:17:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1739: grad_norm=3.1045608520507812, loss=0.23024891316890717, param_norm=1887.1341552734375
Step 1740: grad_norm=4.350968837738037, loss=0.24979108572006226, param_norm=1887.1341552734375
05:30:31.873 [I] Progress on: 1.74kit/2.00kit rate:8.8s/it remaining:38:07 elapsed:4:17:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1741: grad_norm=3.349165201187134, loss=0.2723652124404907, param_norm=1887.1341552734375
Step 1742: grad_norm=3.337944507598877, loss=0.28193214535713196, param_norm=1887.13427734375
05:30:49.493 [I] Progress on: 1.74kit/2.00kit rate:8.8s/it remaining:37:50 elapsed:4:18:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1743: grad_norm=3.898791790008545, loss=0.29187309741973877, param_norm=1887.13427734375
Step 1744: grad_norm=2.937154769897461, loss=0.23686566948890686, param_norm=1887.1341552734375
05:31:07.095 [I] Progress on: 1.74kit/2.00kit rate:8.8s/it remaining:37:33 elapsed:4:18:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1745: grad_norm=3.435253620147705, loss=0.280600368976593, param_norm=1887.13427734375
Step 1746: grad_norm=2.946103811264038, loss=0.24568936228752136, param_norm=1887.13427734375
05:31:24.765 [I] Progress on: 1.75kit/2.00kit rate:8.8s/it remaining:37:20 elapsed:4:18:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1747: grad_norm=3.1752514839172363, loss=0.2521161139011383, param_norm=1887.13427734375
Step 1748: grad_norm=3.509676456451416, loss=0.2589402198791504, param_norm=1887.13427734375
05:31:42.433 [I] Progress on: 1.75kit/2.00kit rate:8.8s/it remaining:37:04 elapsed:4:19:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1749: grad_norm=3.430591344833374, loss=0.30569642782211304, param_norm=1887.13427734375
Step 1750: grad_norm=2.617777109146118, loss=0.22271540760993958, param_norm=1887.1343994140625
05:32:00.047 [I] Progress on: 1.75kit/2.00kit rate:8.8s/it remaining:36:44 elapsed:4:19:23 postfix:- (3802351:tqdm_logging.py:145)
Step 1751: grad_norm=3.278522491455078, loss=0.25391876697540283, param_norm=1887.1343994140625
Step 1752: grad_norm=3.90948748588562, loss=0.27764469385147095, param_norm=1887.1343994140625
05:32:17.652 [I] Progress on: 1.75kit/2.00kit rate:8.8s/it remaining:36:25 elapsed:4:19:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1753: grad_norm=3.659252166748047, loss=0.2829771637916565, param_norm=1887.13427734375
Step 1754: grad_norm=3.182263135910034, loss=0.27414512634277344, param_norm=1887.134521484375
05:32:35.277 [I] Progress on: 1.75kit/2.00kit rate:8.8s/it remaining:36:07 elapsed:4:19:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1755: grad_norm=3.2086355686187744, loss=0.2562815248966217, param_norm=1887.134521484375
Step 1756: grad_norm=3.138742208480835, loss=0.23726226389408112, param_norm=1887.13427734375
05:32:52.925 [I] Progress on: 1.76kit/2.00kit rate:8.8s/it remaining:35:51 elapsed:4:20:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1757: grad_norm=2.6950175762176514, loss=0.24157992005348206, param_norm=1887.134521484375
Step 1758: grad_norm=2.9958109855651855, loss=0.26463058590888977, param_norm=1887.13427734375
05:33:10.587 [I] Progress on: 1.76kit/2.00kit rate:8.8s/it remaining:35:36 elapsed:4:20:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1759: grad_norm=2.529642343521118, loss=0.1953277587890625, param_norm=1887.134521484375
Step 1760: grad_norm=2.5539186000823975, loss=0.20214411616325378, param_norm=1887.134521484375
05:33:28.254 [I] Progress on: 1.76kit/2.00kit rate:8.8s/it remaining:35:18 elapsed:4:20:51 postfix:- (3802351:tqdm_logging.py:145)
Step 1761: grad_norm=2.5164570808410645, loss=0.20181816816329956, param_norm=1887.134521484375
Step 1762: grad_norm=3.432739496231079, loss=0.2912519574165344, param_norm=1887.134521484375
05:33:45.899 [I] Progress on: 1.76kit/2.00kit rate:8.8s/it remaining:35:00 elapsed:4:21:08 postfix:- (3802351:tqdm_logging.py:145)
Step 1763: grad_norm=2.710519552230835, loss=0.2324347198009491, param_norm=1887.134521484375
Step 1764: grad_norm=3.2903048992156982, loss=0.2520598769187927, param_norm=1887.134521484375
05:34:03.550 [I] Progress on: 1.76kit/2.00kit rate:8.8s/it remaining:34:43 elapsed:4:21:26 postfix:- (3802351:tqdm_logging.py:145)
Step 1765: grad_norm=3.59009051322937, loss=0.30973881483078003, param_norm=1887.134521484375
Step 1766: grad_norm=3.941340208053589, loss=0.2574896216392517, param_norm=1887.134521484375
05:34:21.158 [I] Progress on: 1.77kit/2.00kit rate:8.8s/it remaining:34:23 elapsed:4:21:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1767: grad_norm=3.4332540035247803, loss=0.26879042387008667, param_norm=1887.134521484375
Step 1768: grad_norm=3.4937798976898193, loss=0.26535940170288086, param_norm=1887.134521484375
05:34:38.827 [I] Progress on: 1.77kit/2.00kit rate:8.8s/it remaining:34:06 elapsed:4:22:01 postfix:- (3802351:tqdm_logging.py:145)
Step 1769: grad_norm=3.6527183055877686, loss=0.2970839738845825, param_norm=1887.134521484375
Step 1770: grad_norm=3.186720371246338, loss=0.28357455134391785, param_norm=1887.134521484375
05:34:56.443 [I] Progress on: 1.77kit/2.00kit rate:8.8s/it remaining:33:48 elapsed:4:22:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1771: grad_norm=3.504824161529541, loss=0.2293417602777481, param_norm=1887.1346435546875
Step 1772: grad_norm=3.7524843215942383, loss=0.2666921615600586, param_norm=1887.1346435546875
05:35:14.079 [I] Progress on: 1.77kit/2.00kit rate:8.8s/it remaining:33:30 elapsed:4:22:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1773: grad_norm=3.1559536457061768, loss=0.21324878931045532, param_norm=1887.1346435546875
Step 1774: grad_norm=3.820645570755005, loss=0.2981812655925751, param_norm=1887.134521484375
05:35:31.710 [I] Progress on: 1.77kit/2.00kit rate:8.8s/it remaining:33:14 elapsed:4:22:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1775: grad_norm=2.358328342437744, loss=0.22381258010864258, param_norm=1887.1346435546875
Step 1776: grad_norm=2.8594605922698975, loss=0.21315309405326843, param_norm=1887.1346435546875
05:35:49.327 [I] Progress on: 1.78kit/2.00kit rate:8.8s/it remaining:32:55 elapsed:4:23:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1777: grad_norm=3.4692115783691406, loss=0.22263599932193756, param_norm=1887.1346435546875
Step 1778: grad_norm=2.948564291000366, loss=0.23480994999408722, param_norm=1887.1346435546875
05:36:06.958 [I] Progress on: 1.78kit/2.00kit rate:8.8s/it remaining:32:37 elapsed:4:23:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1779: grad_norm=3.1253092288970947, loss=0.242507204413414, param_norm=1887.1346435546875
Step 1780: grad_norm=2.713451623916626, loss=0.25072264671325684, param_norm=1887.1346435546875
05:36:24.606 [I] Progress on: 1.78kit/2.00kit rate:8.8s/it remaining:32:21 elapsed:4:23:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1781: grad_norm=2.784926652908325, loss=0.23651348054409027, param_norm=1887.134765625
Step 1782: grad_norm=3.014389991760254, loss=0.21467754244804382, param_norm=1887.1346435546875
05:36:42.242 [I] Progress on: 1.78kit/2.00kit rate:8.8s/it remaining:32:02 elapsed:4:24:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1783: grad_norm=3.1095359325408936, loss=0.25174006819725037, param_norm=1887.1346435546875
Step 1784: grad_norm=3.7018134593963623, loss=0.2803329527378082, param_norm=1887.134765625
05:36:59.908 [I] Progress on: 1.78kit/2.00kit rate:8.8s/it remaining:31:47 elapsed:4:24:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1785: grad_norm=3.0036826133728027, loss=0.2623014450073242, param_norm=1887.1346435546875
Step 1786: grad_norm=3.1222951412200928, loss=0.2680128514766693, param_norm=1887.134765625
05:37:17.559 [I] Progress on: 1.79kit/2.00kit rate:8.8s/it remaining:31:29 elapsed:4:24:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1787: grad_norm=2.642469882965088, loss=0.22369487583637238, param_norm=1887.134765625
Step 1788: grad_norm=3.2784061431884766, loss=0.23629412055015564, param_norm=1887.134765625
05:37:35.212 [I] Progress on: 1.79kit/2.00kit rate:8.8s/it remaining:31:12 elapsed:4:24:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1789: grad_norm=3.011834144592285, loss=0.22761961817741394, param_norm=1887.134765625
Step 1790: grad_norm=3.6459386348724365, loss=0.28298917412757874, param_norm=1887.134765625
05:37:52.848 [I] Progress on: 1.79kit/2.00kit rate:8.8s/it remaining:30:53 elapsed:4:25:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1791: grad_norm=3.1286418437957764, loss=0.27538764476776123, param_norm=1887.134765625
Step 1792: grad_norm=3.2269492149353027, loss=0.24656113982200623, param_norm=1887.134765625
05:38:10.521 [I] Progress on: 1.79kit/2.00kit rate:8.8s/it remaining:30:37 elapsed:4:25:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1793: grad_norm=2.985246181488037, loss=0.24034690856933594, param_norm=1887.134765625
05:38:21.787 [I] Progress on: 1.79kit/2.00kit rate:9.5s/it remaining:32:37 elapsed:4:25:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1794: grad_norm=3.9929757118225098, loss=0.32676300406455994, param_norm=1887.134765625
Step 1795: grad_norm=3.115227222442627, loss=0.2562129497528076, param_norm=1887.134765625
05:38:39.148 [I] Progress on: 1.79kit/2.00kit rate:9.3s/it remaining:31:42 elapsed:4:26:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1796: grad_norm=3.496814012527466, loss=0.28964799642562866, param_norm=1887.134765625
Step 1797: grad_norm=2.371472120285034, loss=0.2171640843153, param_norm=1887.134765625
05:38:56.789 [I] Progress on: 1.80kit/2.00kit rate:9.0s/it remaining:30:35 elapsed:4:26:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1798: grad_norm=2.0224552154541016, loss=0.17468030750751495, param_norm=1887.1348876953125
Step 1799: grad_norm=2.273763418197632, loss=0.2064616084098816, param_norm=1887.134765625
05:39:14.359 [I] Progress on: 1.80kit/2.00kit rate:8.9s/it remaining:29:50 elapsed:4:26:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1800: grad_norm=2.9042084217071533, loss=0.23635795712471008, param_norm=1887.1348876953125
05:39:23.315 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
05:39:23.315 [I] [process=0][thread=MainThread][step=1700][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
05:39:23.315 [I] [process=0][thread=MainThread][step=1700][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1700. (3802351:checkpoint_manager.py:1786)
05:39:23.316 [I] [process=0][thread=MainThread][step=1700][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1700, also errors if any. (3802351:checkpoint_manager.py:1817)
05:39:23.316 [I] [process=0] Saving checkpoint at step 1800                                       (3802351:checkpoint_manager.py:1286)
05:39:23.317 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800. (3802351:async_checkpointer.py:358)
05:39:23.318 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:39:23.319 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51 (3802351:atomicity.py:144)
05:39:23.320 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:39:23.320 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:39:23.322 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51/params.orbax-checkpoint-tmp-53 (3802351:atomicity.py:144)
05:39:23.322 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51/assets.orbax-checkpoint-tmp-52 (3802351:atomicity.py:144)
05:39:23.324 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:39:23.329 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
05:39:27.119 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
05:39:27.121 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.7 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:39:27.122 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
05:39:27.124 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
05:39:27.157 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.160 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.161 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.169 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.170 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.182 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.184 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.191 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.191 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.194 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.197 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.198 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.201 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.204 [I] Preserving Checkpoint[step=1400 | time=2025-03-24 08:40:13.026710+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.204 [I] Preserving Checkpoint[step=1500 | time=2025-03-24 08:55:00.436780+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.205 [I] Preserving Checkpoint[step=1600 | time=2025-03-24 09:09:50.099040+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.205 [I] Preserving Checkpoint[step=1700 | time=2025-03-24 09:24:37.290939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:39:27.205 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
05:39:27.207 [I] [process=0][thread=MainThread][step=1800] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
05:39:27.210 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
05:39:27.212 [I] {'step': 1800, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742809163.3154838, 'wait_for_prev_duration_secs': 0.0006821155548095703, 'checkpointer_blocking_start_time': 1742809163.3166845, 'checkpointer_blocking_duration_secs': 3.8410487174987793, 'get_old_steps_start_time': 1742809167.1577783, 'get_old_steps_duration_secs': 0.04778170585632324, 'checkpoint_manager_blocking_start_time': 1742809163.3153274, 'checkpoint_manager_blocking_duration_secs': 3.896571636199951} (3802351:standard_logger.py:34)
05:39:27.244 [I] Progress on: 1.80kit/2.00kit rate:10.0s/it remaining:33:14 elapsed:4:26:50 postfix:- (3802351:tqdm_logging.py:145)
Step 1801: grad_norm=4.054871559143066, loss=0.2891784608364105, param_norm=1887.1348876953125
05:39:36.242 [I] ChainedFuture completed 1/1 futures in 9.10 seconds.                             (3802351:future.py:137)
05:39:36.243 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 802.0 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:39:36.243 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
05:39:36.245 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51 (3802351:async_checkpointer.py:406)
05:39:36.245 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51/assets.orbax-checkpoint-tmp-52 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51/assets (3802351:atomicity.py:287)
05:39:36.259 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51/params.orbax-checkpoint-tmp-53 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51/params (3802351:atomicity.py:287)
05:39:36.260 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800 (3802351:async_checkpointer.py:416)
05:39:36.260 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51 (3802351:async_checkpointer.py:426)
05:39:36.260 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800.orbax-checkpoint-tmp-51 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800 (3802351:atomicity.py:287)
05:39:36.262 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1800`. (3802351:atomicity.py:548)
05:39:36.263 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
05:39:36.263 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
05:39:36.264 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
05:39:36.264 [I] [process=0][thread=save_finalize][step=1800] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
05:39:36.264 [I] [process=0][thread=save_finalize][step=1800] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1802: grad_norm=2.86788010597229, loss=0.26612672209739685, param_norm=1887.1348876953125
05:39:44.627 [I] Progress on: 1.80kit/2.00kit rate:9.7s/it remaining:31:51 elapsed:4:27:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1803: grad_norm=3.367579698562622, loss=0.2455291599035263, param_norm=1887.1348876953125
Step 1804: grad_norm=3.7947354316711426, loss=0.25137174129486084, param_norm=1887.1348876953125
05:40:02.253 [I] Progress on: 1.80kit/2.00kit rate:9.2s/it remaining:30:07 elapsed:4:27:25 postfix:- (3802351:tqdm_logging.py:145)
Step 1805: grad_norm=2.7814722061157227, loss=0.2603553533554077, param_norm=1887.1348876953125
Step 1806: grad_norm=3.3663976192474365, loss=0.2872348725795746, param_norm=1887.1348876953125
05:40:19.877 [I] Progress on: 1.81kit/2.00kit rate:9.0s/it remaining:29:08 elapsed:4:27:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1807: grad_norm=2.62347674369812, loss=0.22186721861362457, param_norm=1887.1348876953125
Step 1808: grad_norm=3.0223867893218994, loss=0.2566068768501282, param_norm=1887.1348876953125
05:40:37.521 [I] Progress on: 1.81kit/2.00kit rate:8.9s/it remaining:28:31 elapsed:4:28:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1809: grad_norm=2.888897180557251, loss=0.23192037642002106, param_norm=1887.1348876953125
Step 1810: grad_norm=2.851191759109497, loss=0.19986441731452942, param_norm=1887.1348876953125
05:40:55.142 [I] Progress on: 1.81kit/2.00kit rate:8.9s/it remaining:28:04 elapsed:4:28:18 postfix:- (3802351:tqdm_logging.py:145)
Step 1811: grad_norm=2.9832980632781982, loss=0.2631070017814636, param_norm=1887.1348876953125
Step 1812: grad_norm=3.6849424839019775, loss=0.2948082387447357, param_norm=1887.135009765625
05:41:12.775 [I] Progress on: 1.81kit/2.00kit rate:8.8s/it remaining:27:41 elapsed:4:28:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1813: grad_norm=3.4884023666381836, loss=0.2656008005142212, param_norm=1887.135009765625
Step 1814: grad_norm=3.3381426334381104, loss=0.2366742342710495, param_norm=1887.135009765625
05:41:30.374 [I] Progress on: 1.81kit/2.00kit rate:8.8s/it remaining:27:20 elapsed:4:28:53 postfix:- (3802351:tqdm_logging.py:145)
Step 1815: grad_norm=3.478210687637329, loss=0.23983773589134216, param_norm=1887.135009765625
Step 1816: grad_norm=3.627657175064087, loss=0.25728148221969604, param_norm=1887.135009765625
05:41:48.006 [I] Progress on: 1.82kit/2.00kit rate:8.8s/it remaining:27:02 elapsed:4:29:11 postfix:- (3802351:tqdm_logging.py:145)
Step 1817: grad_norm=2.639038324356079, loss=0.22223396599292755, param_norm=1887.135009765625
Step 1818: grad_norm=2.6218655109405518, loss=0.22386890649795532, param_norm=1887.135009765625
05:42:05.577 [I] Progress on: 1.82kit/2.00kit rate:8.8s/it remaining:26:41 elapsed:4:29:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1819: grad_norm=3.7086145877838135, loss=0.3118160665035248, param_norm=1887.135009765625
Step 1820: grad_norm=3.2127389907836914, loss=0.2069580852985382, param_norm=1887.135009765625
05:42:23.192 [I] Progress on: 1.82kit/2.00kit rate:8.8s/it remaining:26:24 elapsed:4:29:46 postfix:- (3802351:tqdm_logging.py:145)
Step 1821: grad_norm=3.3995354175567627, loss=0.24981524050235748, param_norm=1887.135009765625
Step 1822: grad_norm=2.5438973903656006, loss=0.19752317667007446, param_norm=1887.135009765625
05:42:40.786 [I] Progress on: 1.82kit/2.00kit rate:8.8s/it remaining:26:07 elapsed:4:30:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1823: grad_norm=2.8890647888183594, loss=0.22052812576293945, param_norm=1887.1351318359375
Step 1824: grad_norm=3.284329414367676, loss=0.2511407136917114, param_norm=1887.1351318359375
05:42:58.392 [I] Progress on: 1.82kit/2.00kit rate:8.8s/it remaining:25:49 elapsed:4:30:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1825: grad_norm=3.2379510402679443, loss=0.25877392292022705, param_norm=1887.1351318359375
Step 1826: grad_norm=3.2635722160339355, loss=0.23249799013137817, param_norm=1887.1351318359375
05:43:15.996 [I] Progress on: 1.83kit/2.00kit rate:8.8s/it remaining:25:31 elapsed:4:30:39 postfix:- (3802351:tqdm_logging.py:145)
Step 1827: grad_norm=3.053818464279175, loss=0.23679956793785095, param_norm=1887.1351318359375
Step 1828: grad_norm=3.3910810947418213, loss=0.2827327251434326, param_norm=1887.1351318359375
05:43:33.625 [I] Progress on: 1.83kit/2.00kit rate:8.8s/it remaining:25:15 elapsed:4:30:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1829: grad_norm=4.84348201751709, loss=0.2875020503997803, param_norm=1887.1351318359375
Step 1830: grad_norm=3.264798641204834, loss=0.26522326469421387, param_norm=1887.135009765625
05:43:51.223 [I] Progress on: 1.83kit/2.00kit rate:8.8s/it remaining:24:56 elapsed:4:31:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1831: grad_norm=2.9056954383850098, loss=0.2336975485086441, param_norm=1887.1351318359375
Step 1832: grad_norm=2.684542655944824, loss=0.22959303855895996, param_norm=1887.1351318359375
05:44:08.900 [I] Progress on: 1.83kit/2.00kit rate:8.8s/it remaining:24:42 elapsed:4:31:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1833: grad_norm=3.3088629245758057, loss=0.24283286929130554, param_norm=1887.1351318359375
Step 1834: grad_norm=3.5324084758758545, loss=0.23300515115261078, param_norm=1887.1351318359375
05:44:26.564 [I] Progress on: 1.83kit/2.00kit rate:8.8s/it remaining:24:25 elapsed:4:31:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1835: grad_norm=3.1117351055145264, loss=0.23434007167816162, param_norm=1887.1351318359375
Step 1836: grad_norm=3.45284366607666, loss=0.24935203790664673, param_norm=1887.1351318359375
05:44:44.186 [I] Progress on: 1.84kit/2.00kit rate:8.8s/it remaining:24:05 elapsed:4:32:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1837: grad_norm=3.508244752883911, loss=0.27702897787094116, param_norm=1887.1351318359375
Step 1838: grad_norm=3.1696527004241943, loss=0.2546479105949402, param_norm=1887.1351318359375
05:45:01.836 [I] Progress on: 1.84kit/2.00kit rate:8.8s/it remaining:23:49 elapsed:4:32:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1839: grad_norm=3.09578013420105, loss=0.24024862051010132, param_norm=1887.13525390625
Step 1840: grad_norm=3.737938642501831, loss=0.27505141496658325, param_norm=1887.13525390625
05:45:19.453 [I] Progress on: 1.84kit/2.00kit rate:8.8s/it remaining:23:30 elapsed:4:32:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1841: grad_norm=3.170499086380005, loss=0.2233957052230835, param_norm=1887.13525390625
Step 1842: grad_norm=3.3853018283843994, loss=0.22699670493602753, param_norm=1887.13525390625
05:45:37.051 [I] Progress on: 1.84kit/2.00kit rate:8.8s/it remaining:23:11 elapsed:4:33:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1843: grad_norm=2.9807307720184326, loss=0.2416709065437317, param_norm=1887.13525390625
Step 1844: grad_norm=2.393798828125, loss=0.22266125679016113, param_norm=1887.13525390625
05:45:54.644 [I] Progress on: 1.84kit/2.00kit rate:8.8s/it remaining:22:53 elapsed:4:33:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1845: grad_norm=2.9979920387268066, loss=0.277907133102417, param_norm=1887.13525390625
Step 1846: grad_norm=2.8680973052978516, loss=0.23702964186668396, param_norm=1887.1353759765625
05:46:12.235 [I] Progress on: 1.85kit/2.00kit rate:8.8s/it remaining:22:35 elapsed:4:33:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1847: grad_norm=3.0252482891082764, loss=0.21039123833179474, param_norm=1887.1353759765625
Step 1848: grad_norm=3.001361846923828, loss=0.26356619596481323, param_norm=1887.1353759765625
05:46:29.838 [I] Progress on: 1.85kit/2.00kit rate:8.8s/it remaining:22:17 elapsed:4:33:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1849: grad_norm=8.313318252563477, loss=0.28040075302124023, param_norm=1887.1353759765625
Step 1850: grad_norm=4.256025791168213, loss=0.292935311794281, param_norm=1887.1353759765625
05:46:47.417 [I] Progress on: 1.85kit/2.00kit rate:8.8s/it remaining:21:59 elapsed:4:34:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1851: grad_norm=2.821504831314087, loss=0.20618462562561035, param_norm=1887.1353759765625
Step 1852: grad_norm=3.7381601333618164, loss=0.2875242829322815, param_norm=1887.1353759765625
05:47:05.008 [I] Progress on: 1.85kit/2.00kit rate:8.8s/it remaining:21:41 elapsed:4:34:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1853: grad_norm=3.242622137069702, loss=0.250209778547287, param_norm=1887.1353759765625
Step 1854: grad_norm=2.5771138668060303, loss=0.1853107064962387, param_norm=1887.1353759765625
05:47:22.615 [I] Progress on: 1.85kit/2.00kit rate:8.8s/it remaining:21:24 elapsed:4:34:45 postfix:- (3802351:tqdm_logging.py:145)
Step 1855: grad_norm=2.6267988681793213, loss=0.18776842951774597, param_norm=1887.1353759765625
Step 1856: grad_norm=2.9285998344421387, loss=0.24589884281158447, param_norm=1887.1353759765625
05:47:40.298 [I] Progress on: 1.86kit/2.00kit rate:8.8s/it remaining:21:10 elapsed:4:35:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1857: grad_norm=3.073331832885742, loss=0.2589307725429535, param_norm=1887.135498046875
Step 1858: grad_norm=3.0059359073638916, loss=0.23608575761318207, param_norm=1887.135498046875
05:47:57.892 [I] Progress on: 1.86kit/2.00kit rate:8.8s/it remaining:20:51 elapsed:4:35:20 postfix:- (3802351:tqdm_logging.py:145)
Step 1859: grad_norm=2.9792613983154297, loss=0.22639372944831848, param_norm=1887.135498046875
Step 1860: grad_norm=4.053584098815918, loss=0.2834423780441284, param_norm=1887.135498046875
05:48:15.507 [I] Progress on: 1.86kit/2.00kit rate:8.8s/it remaining:20:33 elapsed:4:35:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1861: grad_norm=4.089598655700684, loss=0.2576194107532501, param_norm=1887.135498046875
Step 1862: grad_norm=3.1117937564849854, loss=0.22556379437446594, param_norm=1887.135498046875
05:48:33.123 [I] Progress on: 1.86kit/2.00kit rate:8.8s/it remaining:20:15 elapsed:4:35:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1863: grad_norm=2.8679585456848145, loss=0.1931162029504776, param_norm=1887.135498046875
05:48:44.270 [I] Progress on: 1.86kit/2.00kit rate:9.5s/it remaining:21:43 elapsed:4:36:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1864: grad_norm=3.2709245681762695, loss=0.21586717665195465, param_norm=1887.135498046875
Step 1865: grad_norm=3.7547295093536377, loss=0.26248666644096375, param_norm=1887.135498046875
05:49:01.901 [I] Progress on: 1.86kit/2.00kit rate:9.2s/it remaining:20:36 elapsed:4:36:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1866: grad_norm=3.1754627227783203, loss=0.2215227484703064, param_norm=1887.135498046875
Step 1867: grad_norm=2.899005889892578, loss=0.24575844407081604, param_norm=1887.135498046875
05:49:19.556 [I] Progress on: 1.87kit/2.00kit rate:9.0s/it remaining:19:55 elapsed:4:36:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1868: grad_norm=3.657869815826416, loss=0.24222372472286224, param_norm=1887.135498046875
Step 1869: grad_norm=2.8945908546447754, loss=0.15506906807422638, param_norm=1887.135498046875
05:49:37.189 [I] Progress on: 1.87kit/2.00kit rate:8.9s/it remaining:19:25 elapsed:4:37:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1870: grad_norm=3.468276262283325, loss=0.25650686025619507, param_norm=1887.135498046875
Step 1871: grad_norm=3.786223888397217, loss=0.22984282672405243, param_norm=1887.135498046875
05:49:54.783 [I] Progress on: 1.87kit/2.00kit rate:8.8s/it remaining:19:01 elapsed:4:37:17 postfix:- (3802351:tqdm_logging.py:145)
Step 1872: grad_norm=3.0986220836639404, loss=0.2223571240901947, param_norm=1887.135498046875
Step 1873: grad_norm=2.6254565715789795, loss=0.2231050282716751, param_norm=1887.135498046875
05:50:12.339 [I] Progress on: 1.87kit/2.00kit rate:8.8s/it remaining:18:38 elapsed:4:37:35 postfix:- (3802351:tqdm_logging.py:145)
Step 1874: grad_norm=3.046586275100708, loss=0.22300243377685547, param_norm=1887.135498046875
Step 1875: grad_norm=3.0978410243988037, loss=0.24268370866775513, param_norm=1887.135498046875
05:50:29.901 [I] Progress on: 1.88kit/2.00kit rate:8.8s/it remaining:18:19 elapsed:4:37:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1876: grad_norm=3.630852222442627, loss=0.24811381101608276, param_norm=1887.135498046875
Step 1877: grad_norm=3.4189188480377197, loss=0.2618800103664398, param_norm=1887.135498046875
05:50:47.536 [I] Progress on: 1.88kit/2.00kit rate:8.8s/it remaining:18:02 elapsed:4:38:10 postfix:- (3802351:tqdm_logging.py:145)
Step 1878: grad_norm=3.1001291275024414, loss=0.25497961044311523, param_norm=1887.1356201171875
Step 1879: grad_norm=2.7938451766967773, loss=0.21929006278514862, param_norm=1887.135498046875
05:51:05.208 [I] Progress on: 1.88kit/2.00kit rate:8.8s/it remaining:17:47 elapsed:4:38:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1880: grad_norm=3.105776786804199, loss=0.228561669588089, param_norm=1887.1356201171875
Step 1881: grad_norm=3.698641777038574, loss=0.2884746789932251, param_norm=1887.1356201171875
05:51:22.840 [I] Progress on: 1.88kit/2.00kit rate:8.8s/it remaining:17:29 elapsed:4:38:45 postfix:- (3802351:tqdm_logging.py:145)
Step 1882: grad_norm=3.0697097778320312, loss=0.22350409626960754, param_norm=1887.1356201171875
Step 1883: grad_norm=2.411018133163452, loss=0.1834188848733902, param_norm=1887.1356201171875
05:51:40.453 [I] Progress on: 1.88kit/2.00kit rate:8.8s/it remaining:17:10 elapsed:4:39:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1884: grad_norm=3.018378257751465, loss=0.1959691196680069, param_norm=1887.1356201171875
Step 1885: grad_norm=3.1261627674102783, loss=0.27183645963668823, param_norm=1887.1356201171875
05:51:58.039 [I] Progress on: 1.89kit/2.00kit rate:8.8s/it remaining:16:51 elapsed:4:39:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1886: grad_norm=3.1850907802581787, loss=0.257537841796875, param_norm=1887.1356201171875
Step 1887: grad_norm=3.12912654876709, loss=0.22243094444274902, param_norm=1887.1356201171875
05:52:15.621 [I] Progress on: 1.89kit/2.00kit rate:8.8s/it remaining:16:33 elapsed:4:39:38 postfix:- (3802351:tqdm_logging.py:145)
Step 1888: grad_norm=3.6263790130615234, loss=0.23218941688537598, param_norm=1887.1356201171875
Step 1889: grad_norm=3.1748406887054443, loss=0.25325727462768555, param_norm=1887.1356201171875
05:52:33.179 [I] Progress on: 1.89kit/2.00kit rate:8.8s/it remaining:16:15 elapsed:4:39:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1890: grad_norm=4.247477054595947, loss=0.3155871629714966, param_norm=1887.1357421875
Step 1891: grad_norm=3.5203871726989746, loss=0.24690711498260498, param_norm=1887.1357421875
05:52:50.750 [I] Progress on: 1.89kit/2.00kit rate:8.8s/it remaining:15:57 elapsed:4:40:13 postfix:- (3802351:tqdm_logging.py:145)
Step 1892: grad_norm=3.5064804553985596, loss=0.21386176347732544, param_norm=1887.1357421875
Step 1893: grad_norm=3.8818325996398926, loss=0.24278569221496582, param_norm=1887.1357421875
05:53:08.320 [I] Progress on: 1.89kit/2.00kit rate:8.8s/it remaining:15:39 elapsed:4:40:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1894: grad_norm=4.047562122344971, loss=0.316699743270874, param_norm=1887.1357421875
Step 1895: grad_norm=3.3257904052734375, loss=0.2505223751068115, param_norm=1887.1357421875
05:53:26.142 [I] Progress on: 1.90kit/2.00kit rate:8.8s/it remaining:15:28 elapsed:4:40:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1896: grad_norm=5.31541109085083, loss=0.28799527883529663, param_norm=1887.1357421875
Step 1897: grad_norm=3.50940203666687, loss=0.2441733181476593, param_norm=1887.1357421875
05:53:43.710 [I] Progress on: 1.90kit/2.00kit rate:8.8s/it remaining:15:07 elapsed:4:41:06 postfix:- (3802351:tqdm_logging.py:145)
Step 1898: grad_norm=3.022810697555542, loss=0.25508540868759155, param_norm=1887.1357421875
Step 1899: grad_norm=3.4622950553894043, loss=0.2601136267185211, param_norm=1887.1357421875
05:54:01.286 [I] Progress on: 1.90kit/2.00kit rate:8.8s/it remaining:14:48 elapsed:4:41:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1900: grad_norm=2.806581974029541, loss=0.208841934800148, param_norm=1887.1357421875
05:54:10.230 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
05:54:10.231 [I] [process=0][thread=MainThread][step=1800][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
05:54:10.231 [I] [process=0][thread=MainThread][step=1800][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1800. (3802351:checkpoint_manager.py:1786)
05:54:10.231 [I] [process=0][thread=MainThread][step=1800][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1800, also errors if any. (3802351:checkpoint_manager.py:1817)
05:54:10.231 [I] [process=0] Saving checkpoint at step 1900                                       (3802351:checkpoint_manager.py:1286)
05:54:10.232 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900. (3802351:async_checkpointer.py:358)
05:54:10.233 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:54:10.233 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54 (3802351:atomicity.py:144)
05:54:10.234 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:54:10.235 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
05:54:10.235 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54/assets.orbax-checkpoint-tmp-55 (3802351:atomicity.py:144)
05:54:10.236 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54/params.orbax-checkpoint-tmp-56 (3802351:atomicity.py:144)
05:54:10.236 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
05:54:10.241 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
05:54:14.136 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:54:14.139 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
05:54:14.141 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
05:54:14.143 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
05:54:14.147 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.151 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.153 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.159 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.160 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.166 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.167 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.169 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.170 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.171 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.175 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.177 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.178 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.179 [I] Preserving Checkpoint[step=1400 | time=2025-03-24 08:40:13.026710+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.187 [I] Preserving Checkpoint[step=1500 | time=2025-03-24 08:55:00.436780+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.188 [I] Preserving Checkpoint[step=1600 | time=2025-03-24 09:09:50.099040+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.188 [I] Preserving Checkpoint[step=1700 | time=2025-03-24 09:24:37.290939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.189 [I] Preserving Checkpoint[step=1800 | time=2025-03-24 09:39:27.157744+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
05:54:14.189 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
05:54:14.189 [I] [process=0][thread=MainThread][step=1900] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
05:54:14.198 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
05:54:14.198 [I] {'step': 1900, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742810050.2308776, 'wait_for_prev_duration_secs': 0.0006525516510009766, 'checkpointer_blocking_start_time': 1742810050.2320268, 'checkpointer_blocking_duration_secs': 3.9150774478912354, 'get_old_steps_start_time': 1742810054.1471488, 'get_old_steps_duration_secs': 0.04214191436767578, 'checkpoint_manager_blocking_start_time': 1742810050.2307184, 'checkpoint_manager_blocking_duration_secs': 3.967618942260742} (3802351:standard_logger.py:34)
05:54:14.204 [I] Progress on: 1.90kit/2.00kit rate:10.0s/it remaining:16:28 elapsed:4:41:37 postfix:- (3802351:tqdm_logging.py:145)
05:54:22.049 [I] ChainedFuture completed 1/1 futures in 7.91 seconds.                             (3802351:future.py:137)
05:54:22.050 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 877.1 MiB/s (total bytes: 10.1 GiB) (time elapsed: 11 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
05:54:22.050 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
05:54:22.051 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54 (3802351:async_checkpointer.py:406)
05:54:22.052 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54/assets.orbax-checkpoint-tmp-55 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54/assets (3802351:atomicity.py:287)
05:54:22.062 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54/params.orbax-checkpoint-tmp-56 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54/params (3802351:atomicity.py:287)
05:54:22.062 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900 (3802351:async_checkpointer.py:416)
05:54:22.063 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54 (3802351:async_checkpointer.py:426)
05:54:22.063 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900.orbax-checkpoint-tmp-54 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900 (3802351:atomicity.py:287)
05:54:22.064 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1900`. (3802351:atomicity.py:548)
05:54:22.065 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
05:54:22.065 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
05:54:22.066 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
05:54:22.066 [I] [process=0][thread=save_finalize][step=1900] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
05:54:22.066 [I] [process=0][thread=save_finalize][step=1900] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
Step 1901: grad_norm=3.590013027191162, loss=0.2527218163013458, param_norm=1887.1357421875
Step 1902: grad_norm=2.9090123176574707, loss=0.22808125615119934, param_norm=1887.1357421875
05:54:31.557 [I] Progress on: 1.90kit/2.00kit rate:9.6s/it remaining:15:42 elapsed:4:41:54 postfix:- (3802351:tqdm_logging.py:145)
Step 1903: grad_norm=2.8863697052001953, loss=0.20874662697315216, param_norm=1887.1358642578125
Step 1904: grad_norm=5.019430160522461, loss=0.293668657541275, param_norm=1887.1358642578125
05:54:49.067 [I] Progress on: 1.90kit/2.00kit rate:9.2s/it remaining:14:40 elapsed:4:42:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1905: grad_norm=3.351633071899414, loss=0.2576568126678467, param_norm=1887.1358642578125
Step 1906: grad_norm=3.1342577934265137, loss=0.2905687093734741, param_norm=1887.1358642578125
05:55:06.595 [I] Progress on: 1.91kit/2.00kit rate:9.0s/it remaining:14:02 elapsed:4:42:29 postfix:- (3802351:tqdm_logging.py:145)
Step 1907: grad_norm=3.635742664337158, loss=0.2801656723022461, param_norm=1887.1358642578125
Step 1908: grad_norm=3.4615166187286377, loss=0.2522374093532562, param_norm=1887.1358642578125
05:55:24.140 [I] Progress on: 1.91kit/2.00kit rate:8.9s/it remaining:13:35 elapsed:4:42:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1909: grad_norm=3.059344530105591, loss=0.2667192220687866, param_norm=1887.1358642578125
Step 1910: grad_norm=2.4724347591400146, loss=0.21994280815124512, param_norm=1887.1358642578125
05:55:41.665 [I] Progress on: 1.91kit/2.00kit rate:8.8s/it remaining:13:13 elapsed:4:43:04 postfix:- (3802351:tqdm_logging.py:145)
Step 1911: grad_norm=2.8914730548858643, loss=0.18701446056365967, param_norm=1887.1358642578125
Step 1912: grad_norm=16.207792282104492, loss=0.263680100440979, param_norm=1887.1358642578125
05:55:59.207 [I] Progress on: 1.91kit/2.00kit rate:8.8s/it remaining:12:53 elapsed:4:43:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1913: grad_norm=3.335144519805908, loss=0.2507143020629883, param_norm=1887.135986328125
Step 1914: grad_norm=2.6023879051208496, loss=0.23005980253219604, param_norm=1887.135986328125
05:56:16.759 [I] Progress on: 1.91kit/2.00kit rate:8.8s/it remaining:12:35 elapsed:4:43:39 postfix:- (3802351:tqdm_logging.py:145)
Step 1915: grad_norm=2.67441463470459, loss=0.23437494039535522, param_norm=1887.135986328125
Step 1916: grad_norm=2.690971851348877, loss=0.23164549469947815, param_norm=1887.1361083984375
05:56:34.297 [I] Progress on: 1.92kit/2.00kit rate:8.8s/it remaining:12:17 elapsed:4:43:57 postfix:- (3802351:tqdm_logging.py:145)
Step 1917: grad_norm=3.0322165489196777, loss=0.25866249203681946, param_norm=1887.1361083984375
Step 1918: grad_norm=4.072366714477539, loss=0.25781702995300293, param_norm=1887.1361083984375
05:56:51.852 [I] Progress on: 1.92kit/2.00kit rate:8.8s/it remaining:11:59 elapsed:4:44:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1919: grad_norm=3.6880240440368652, loss=0.27180325984954834, param_norm=1887.1361083984375
Step 1920: grad_norm=2.957260847091675, loss=0.2512863874435425, param_norm=1887.1361083984375
05:57:09.434 [I] Progress on: 1.92kit/2.00kit rate:8.8s/it remaining:11:42 elapsed:4:44:32 postfix:- (3802351:tqdm_logging.py:145)
Step 1921: grad_norm=2.534625768661499, loss=0.21526439487934113, param_norm=1887.1361083984375
Step 1922: grad_norm=2.4550254344940186, loss=0.19905555248260498, param_norm=1887.1361083984375
05:57:27.001 [I] Progress on: 1.92kit/2.00kit rate:8.8s/it remaining:11:25 elapsed:4:44:50 postfix:- (3802351:tqdm_logging.py:145)
Step 1923: grad_norm=4.437913417816162, loss=0.2951071858406067, param_norm=1887.1361083984375
Step 1924: grad_norm=3.286256790161133, loss=0.24412673711776733, param_norm=1887.1361083984375
05:57:44.581 [I] Progress on: 1.92kit/2.00kit rate:8.8s/it remaining:11:07 elapsed:4:45:07 postfix:- (3802351:tqdm_logging.py:145)
Step 1925: grad_norm=3.4477334022521973, loss=0.24714568257331848, param_norm=1887.1361083984375
Step 1926: grad_norm=3.767618417739868, loss=0.24454385042190552, param_norm=1887.1361083984375
05:58:02.158 [I] Progress on: 1.93kit/2.00kit rate:8.8s/it remaining:10:50 elapsed:4:45:25 postfix:- (3802351:tqdm_logging.py:145)
Step 1927: grad_norm=3.8404619693756104, loss=0.19726906716823578, param_norm=1887.1361083984375
Step 1928: grad_norm=3.1700706481933594, loss=0.2638845443725586, param_norm=1887.1361083984375
05:58:19.744 [I] Progress on: 1.93kit/2.00kit rate:8.8s/it remaining:10:32 elapsed:4:45:42 postfix:- (3802351:tqdm_logging.py:145)
Step 1929: grad_norm=2.7060210704803467, loss=0.24165402352809906, param_norm=1887.13623046875
Step 1930: grad_norm=3.4488885402679443, loss=0.2937835454940796, param_norm=1887.13623046875
05:58:37.323 [I] Progress on: 1.93kit/2.00kit rate:8.8s/it remaining:10:15 elapsed:4:46:00 postfix:- (3802351:tqdm_logging.py:145)
Step 1931: grad_norm=3.8154051303863525, loss=0.25646236538887024, param_norm=1887.13623046875
05:58:48.497 [I] Progress on: 1.93kit/2.00kit rate:9.5s/it remaining:10:43 elapsed:4:46:11 postfix:- (3802351:tqdm_logging.py:145)
Step 1932: grad_norm=4.077017784118652, loss=0.24875546991825104, param_norm=1887.13623046875
Step 1933: grad_norm=3.7081661224365234, loss=0.27645736932754517, param_norm=1887.13623046875
05:59:05.837 [I] Progress on: 1.93kit/2.00kit rate:9.2s/it remaining:10:18 elapsed:4:46:28 postfix:- (3802351:tqdm_logging.py:145)
Step 1934: grad_norm=4.2614006996154785, loss=0.27791768312454224, param_norm=1887.13623046875
Step 1935: grad_norm=3.498636484146118, loss=0.2364121377468109, param_norm=1887.13623046875
05:59:23.390 [I] Progress on: 1.94kit/2.00kit rate:9.0s/it remaining:09:44 elapsed:4:46:46 postfix:- (3802351:tqdm_logging.py:145)
Step 1936: grad_norm=2.367278575897217, loss=0.18352557718753815, param_norm=1887.13623046875
Step 1937: grad_norm=2.908703088760376, loss=0.21549642086029053, param_norm=1887.13623046875
05:59:40.934 [I] Progress on: 1.94kit/2.00kit rate:8.9s/it remaining:09:19 elapsed:4:47:03 postfix:- (3802351:tqdm_logging.py:145)
Step 1938: grad_norm=2.899359941482544, loss=0.24616074562072754, param_norm=1887.13623046875
Step 1939: grad_norm=3.3676443099975586, loss=0.25656312704086304, param_norm=1887.13623046875
05:59:58.482 [I] Progress on: 1.94kit/2.00kit rate:8.8s/it remaining:08:57 elapsed:4:47:21 postfix:- (3802351:tqdm_logging.py:145)
Step 1940: grad_norm=3.046018600463867, loss=0.23956608772277832, param_norm=1887.13623046875
Step 1941: grad_norm=2.825098991394043, loss=0.23027603328227997, param_norm=1887.13623046875
06:00:16.035 [I] Progress on: 1.94kit/2.00kit rate:8.8s/it remaining:08:38 elapsed:4:47:39 postfix:- (3802351:tqdm_logging.py:145)
Step 1942: grad_norm=2.9215362071990967, loss=0.2195986807346344, param_norm=1887.13623046875
Step 1943: grad_norm=3.6482365131378174, loss=0.28006094694137573, param_norm=1887.13623046875
06:00:33.564 [I] Progress on: 1.94kit/2.00kit rate:8.8s/it remaining:08:20 elapsed:4:47:56 postfix:- (3802351:tqdm_logging.py:145)
Step 1944: grad_norm=3.0973732471466064, loss=0.25965720415115356, param_norm=1887.13623046875
Step 1945: grad_norm=3.8093490600585938, loss=0.2454494833946228, param_norm=1887.13623046875
06:00:51.107 [I] Progress on: 1.95kit/2.00kit rate:8.8s/it remaining:08:02 elapsed:4:48:14 postfix:- (3802351:tqdm_logging.py:145)
Step 1946: grad_norm=3.604564905166626, loss=0.2551335096359253, param_norm=1887.13623046875
Step 1947: grad_norm=3.332834243774414, loss=0.23390182852745056, param_norm=1887.13623046875
06:01:08.642 [I] Progress on: 1.95kit/2.00kit rate:8.8s/it remaining:07:44 elapsed:4:48:31 postfix:- (3802351:tqdm_logging.py:145)
Step 1948: grad_norm=3.4679930210113525, loss=0.2276196926832199, param_norm=1887.1363525390625
Step 1949: grad_norm=3.660414934158325, loss=0.23774279654026031, param_norm=1887.1363525390625
06:01:26.202 [I] Progress on: 1.95kit/2.00kit rate:8.8s/it remaining:07:27 elapsed:4:48:49 postfix:- (3802351:tqdm_logging.py:145)
Step 1950: grad_norm=4.145411491394043, loss=0.27669990062713623, param_norm=1887.1363525390625
Step 1951: grad_norm=2.875789165496826, loss=0.2477714717388153, param_norm=1887.1363525390625
06:01:43.742 [I] Progress on: 1.95kit/2.00kit rate:8.8s/it remaining:07:09 elapsed:4:49:06 postfix:- (3802351:tqdm_logging.py:145)
Step 1952: grad_norm=4.349314212799072, loss=0.28989821672439575, param_norm=1887.1363525390625
Step 1953: grad_norm=2.9914772510528564, loss=0.2094976305961609, param_norm=1887.1363525390625
06:02:01.277 [I] Progress on: 1.95kit/2.00kit rate:8.8s/it remaining:06:51 elapsed:4:49:24 postfix:- (3802351:tqdm_logging.py:145)
Step 1954: grad_norm=4.124055862426758, loss=0.25241756439208984, param_norm=1887.1363525390625
Step 1955: grad_norm=3.6483757495880127, loss=0.2291449010372162, param_norm=1887.1363525390625
06:02:18.813 [I] Progress on: 1.96kit/2.00kit rate:8.8s/it remaining:06:34 elapsed:4:49:41 postfix:- (3802351:tqdm_logging.py:145)
Step 1956: grad_norm=3.98453688621521, loss=0.23360705375671387, param_norm=1887.1363525390625
Step 1957: grad_norm=2.967310667037964, loss=0.21282386779785156, param_norm=1887.1363525390625
06:02:36.367 [I] Progress on: 1.96kit/2.00kit rate:8.8s/it remaining:06:16 elapsed:4:49:59 postfix:- (3802351:tqdm_logging.py:145)
Step 1958: grad_norm=3.235337257385254, loss=0.2153085172176361, param_norm=1887.1363525390625
Step 1959: grad_norm=4.078700065612793, loss=0.2918344736099243, param_norm=1887.1363525390625
06:02:53.894 [I] Progress on: 1.96kit/2.00kit rate:8.8s/it remaining:05:59 elapsed:4:50:16 postfix:- (3802351:tqdm_logging.py:145)
Step 1960: grad_norm=3.470937728881836, loss=0.25102293491363525, param_norm=1887.136474609375
Step 1961: grad_norm=3.360354423522949, loss=0.21815893054008484, param_norm=1887.136474609375
06:03:11.450 [I] Progress on: 1.96kit/2.00kit rate:8.8s/it remaining:05:41 elapsed:4:50:34 postfix:- (3802351:tqdm_logging.py:145)
Step 1962: grad_norm=4.580491065979004, loss=0.22659321129322052, param_norm=1887.136474609375
Step 1963: grad_norm=3.137375831604004, loss=0.23903751373291016, param_norm=1887.1365966796875
06:03:29.007 [I] Progress on: 1.96kit/2.00kit rate:8.8s/it remaining:05:24 elapsed:4:50:52 postfix:- (3802351:tqdm_logging.py:145)
Step 1964: grad_norm=3.0792455673217773, loss=0.20586463809013367, param_norm=1887.1365966796875
Step 1965: grad_norm=3.0252442359924316, loss=0.23413363099098206, param_norm=1887.1365966796875
06:03:46.593 [I] Progress on: 1.97kit/2.00kit rate:8.8s/it remaining:05:07 elapsed:4:51:09 postfix:- (3802351:tqdm_logging.py:145)
Step 1966: grad_norm=3.4398858547210693, loss=0.24923083186149597, param_norm=1887.1365966796875
Step 1967: grad_norm=5.693294525146484, loss=0.2671412229537964, param_norm=1887.1365966796875
06:04:04.134 [I] Progress on: 1.97kit/2.00kit rate:8.8s/it remaining:04:49 elapsed:4:51:27 postfix:- (3802351:tqdm_logging.py:145)
Step 1968: grad_norm=3.5396153926849365, loss=0.22182539105415344, param_norm=1887.1365966796875
Step 1969: grad_norm=3.2545180320739746, loss=0.2608053684234619, param_norm=1887.1365966796875
06:04:21.709 [I] Progress on: 1.97kit/2.00kit rate:8.8s/it remaining:04:31 elapsed:4:51:44 postfix:- (3802351:tqdm_logging.py:145)
Step 1970: grad_norm=4.100086688995361, loss=0.28058838844299316, param_norm=1887.1365966796875
Step 1971: grad_norm=4.242141246795654, loss=0.2366127371788025, param_norm=1887.1365966796875
06:04:39.269 [I] Progress on: 1.97kit/2.00kit rate:8.8s/it remaining:04:14 elapsed:4:52:02 postfix:- (3802351:tqdm_logging.py:145)
Step 1972: grad_norm=3.608173370361328, loss=0.27545326948165894, param_norm=1887.1365966796875
Step 1973: grad_norm=3.623150587081909, loss=0.22800029814243317, param_norm=1887.1365966796875
06:04:56.842 [I] Progress on: 1.97kit/2.00kit rate:8.8s/it remaining:03:56 elapsed:4:52:19 postfix:- (3802351:tqdm_logging.py:145)
Step 1974: grad_norm=2.4259793758392334, loss=0.20945124328136444, param_norm=1887.1365966796875
Step 1975: grad_norm=2.860140323638916, loss=0.27634015679359436, param_norm=1887.1365966796875
06:05:14.410 [I] Progress on: 1.98kit/2.00kit rate:8.8s/it remaining:03:39 elapsed:4:52:37 postfix:- (3802351:tqdm_logging.py:145)
Step 1976: grad_norm=3.0418896675109863, loss=0.22793884575366974, param_norm=1887.1365966796875
Step 1977: grad_norm=3.964934825897217, loss=0.16427630186080933, param_norm=1887.1365966796875
06:05:31.980 [I] Progress on: 1.98kit/2.00kit rate:8.8s/it remaining:03:21 elapsed:4:52:55 postfix:- (3802351:tqdm_logging.py:145)
Step 1978: grad_norm=2.526181221008301, loss=0.2037527859210968, param_norm=1887.1365966796875
Step 1979: grad_norm=2.216403007507324, loss=0.19851529598236084, param_norm=1887.1365966796875
06:05:49.545 [I] Progress on: 1.98kit/2.00kit rate:8.8s/it remaining:03:04 elapsed:4:53:12 postfix:- (3802351:tqdm_logging.py:145)
Step 1980: grad_norm=3.0193347930908203, loss=0.20350217819213867, param_norm=1887.1365966796875
Step 1981: grad_norm=3.3966848850250244, loss=0.2381991446018219, param_norm=1887.1365966796875
06:06:07.136 [I] Progress on: 1.98kit/2.00kit rate:8.8s/it remaining:02:46 elapsed:4:53:30 postfix:- (3802351:tqdm_logging.py:145)
Step 1982: grad_norm=3.0015594959259033, loss=0.26441752910614014, param_norm=1887.1365966796875
Step 1983: grad_norm=3.2026026248931885, loss=0.22317582368850708, param_norm=1887.13671875
06:06:24.697 [I] Progress on: 1.98kit/2.00kit rate:8.8s/it remaining:02:29 elapsed:4:53:47 postfix:- (3802351:tqdm_logging.py:145)
Step 1984: grad_norm=3.0959250926971436, loss=0.23772206902503967, param_norm=1887.13671875
Step 1985: grad_norm=2.7637054920196533, loss=0.18650618195533752, param_norm=1887.13671875
06:06:42.286 [I] Progress on: 1.99kit/2.00kit rate:8.8s/it remaining:02:11 elapsed:4:54:05 postfix:- (3802351:tqdm_logging.py:145)
Step 1986: grad_norm=3.828676700592041, loss=0.2855806350708008, param_norm=1887.13671875
Step 1987: grad_norm=3.2996058464050293, loss=0.24865230917930603, param_norm=1887.13671875
06:06:59.841 [I] Progress on: 1.99kit/2.00kit rate:8.8s/it remaining:01:54 elapsed:4:54:22 postfix:- (3802351:tqdm_logging.py:145)
Step 1988: grad_norm=3.4080750942230225, loss=0.2685123085975647, param_norm=1887.13671875
Step 1989: grad_norm=3.329591751098633, loss=0.2865571081638336, param_norm=1887.13671875
06:07:17.409 [I] Progress on: 1.99kit/2.00kit rate:8.8s/it remaining:01:36 elapsed:4:54:40 postfix:- (3802351:tqdm_logging.py:145)
Step 1990: grad_norm=3.2384538650512695, loss=0.21926718950271606, param_norm=1887.13671875
Step 1991: grad_norm=3.135469913482666, loss=0.2232050895690918, param_norm=1887.13671875
06:07:34.972 [I] Progress on: 1.99kit/2.00kit rate:8.8s/it remaining:01:18 elapsed:4:54:58 postfix:- (3802351:tqdm_logging.py:145)
Step 1992: grad_norm=3.7112948894500732, loss=0.233125239610672, param_norm=1887.1368408203125
Step 1993: grad_norm=4.230702877044678, loss=0.2468929886817932, param_norm=1887.1368408203125
06:07:52.543 [I] Progress on: 1.99kit/2.00kit rate:8.8s/it remaining:01:01 elapsed:4:55:15 postfix:- (3802351:tqdm_logging.py:145)
Step 1994: grad_norm=3.206326961517334, loss=0.23200839757919312, param_norm=1887.1368408203125
Step 1995: grad_norm=3.2351536750793457, loss=0.25813043117523193, param_norm=1887.1368408203125
06:08:10.098 [I] Progress on: 2.00kit/2.00kit rate:8.8s/it remaining:00:43 elapsed:4:55:33 postfix:- (3802351:tqdm_logging.py:145)
Step 1996: grad_norm=3.4198319911956787, loss=0.2693576216697693, param_norm=1887.1368408203125
Step 1997: grad_norm=3.1330814361572266, loss=0.22838404774665833, param_norm=1887.1368408203125
06:08:27.641 [I] Progress on: 2.00kit/2.00kit rate:8.8s/it remaining:00:26 elapsed:4:55:50 postfix:- (3802351:tqdm_logging.py:145)
Step 1998: grad_norm=3.295210123062134, loss=0.21924056112766266, param_norm=1887.1368408203125
Step 1999: grad_norm=3.0393097400665283, loss=0.21226368844509125, param_norm=1887.1368408203125
06:08:45.184 [I] Progress on: 2.00kit/2.00kit rate:8.8s/it remaining:00:08 elapsed:4:56:08 postfix:- (3802351:tqdm_logging.py:145)
06:08:45.354 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
06:08:45.354 [I] [process=0][thread=MainThread][step=1900][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
06:08:45.354 [I] [process=0][thread=MainThread][step=1900][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1900. (3802351:checkpoint_manager.py:1786)
06:08:45.354 [I] [process=0][thread=MainThread][step=1900][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1900, also errors if any. (3802351:checkpoint_manager.py:1817)
06:08:45.355 [I] [process=0] Saving checkpoint at step 1999                                       (3802351:checkpoint_manager.py:1286)
06:08:45.355 [I] [process=0] Started async saving checkpoint to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999. (3802351:async_checkpointer.py:358)
06:08:45.356 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
06:08:45.357 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57 (3802351:atomicity.py:144)
06:08:45.357 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
06:08:45.358 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:pre (3802351:multihost.py:293)
06:08:45.359 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57/assets.orbax-checkpoint-tmp-58 (3802351:atomicity.py:144)
06:08:45.359 [I] Creating tmp directory /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57/params.orbax-checkpoint-tmp-59 (3802351:atomicity.py:144)
06:08:45.360 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: create_tmp_directory:post (3802351:multihost.py:293)
06:08:45.365 [I] Transferring arrays to host memory with options: use_replica_parallel=False, enable_pinned_host_transfer=False (3802351:replica_slices.py:419)
06:08:49.038 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 4096) (3802351:tensorstore_utils.py:371)
06:08:49.039 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 10.1 GiB) (time elapsed: 3 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
06:08:49.041 [I] Array name: 'params.PaliGemma.llm.layers.mlp.linear.value', global shape: (18, 16384, 2048), write shape: (18, 16384, 2048), chosen chunk shape: (18, 8192, 2048) (3802351:tensorstore_utils.py:371)
06:08:49.042 [I] [process=0][thread=async_save] Background save thread started.                   (3802351:async_checkpointer.py:121)
06:08:49.059 [I] Preserving Checkpoint[step=100 | time=2025-03-24 05:27:38.286861+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.066 [I] Preserving Checkpoint[step=200 | time=2025-03-24 05:42:25.464489+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.067 [I] Preserving Checkpoint[step=300 | time=2025-03-24 05:57:14.672718+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.069 [I] Preserving Checkpoint[step=400 | time=2025-03-24 06:12:01.538510+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.073 [I] Preserving Checkpoint[step=500 | time=2025-03-24 06:26:50.434245+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.074 [I] Preserving Checkpoint[step=600 | time=2025-03-24 06:41:38.226487+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.075 [I] Preserving Checkpoint[step=700 | time=2025-03-24 06:56:27.667611+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.076 [I] Preserving Checkpoint[step=800 | time=2025-03-24 07:11:15.129903+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.079 [I] Preserving Checkpoint[step=900 | time=2025-03-24 07:26:04.950504+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.080 [I] Preserving Checkpoint[step=1000 | time=2025-03-24 07:40:53.304196+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.081 [I] Preserving Checkpoint[step=1100 | time=2025-03-24 07:55:40.695628+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.081 [I] Preserving Checkpoint[step=1200 | time=2025-03-24 08:10:31.220149+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.081 [I] Preserving Checkpoint[step=1300 | time=2025-03-24 08:25:22.385262+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.081 [I] Preserving Checkpoint[step=1400 | time=2025-03-24 08:40:13.026710+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.082 [I] Preserving Checkpoint[step=1500 | time=2025-03-24 08:55:00.436780+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.088 [I] Preserving Checkpoint[step=1600 | time=2025-03-24 09:09:50.099040+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.090 [I] Preserving Checkpoint[step=1700 | time=2025-03-24 09:24:37.290939+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.090 [I] Preserving Checkpoint[step=1800 | time=2025-03-24 09:39:27.157744+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.090 [I] Preserving Checkpoint[step=1900 | time=2025-03-24 09:54:14.147115+00:00 | is_locked=None]: (Reason: on keep_period=100). (3802351:checkpoint_manager.py:1734)
06:08:49.091 [I] [process=0][thread=MainThread] Skipping global process sync, barrier name: CheckpointManager:old_steps_to_remove (3802351:multihost.py:293)
06:08:49.091 [I] [process=0][thread=MainThread][step=1999] Starting CheckpointManager Save Finalize thread=save_finalize (3802351:checkpoint_manager.py:1328)
06:08:49.092 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (3802351:async_checkpointer.py:231)
06:08:49.092 [I] {'step': 1999, 'event_type': 'save', 'directory': '/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1742810925.3539584, 'wait_for_prev_duration_secs': 0.0006871223449707031, 'checkpointer_blocking_start_time': 1742810925.3551557, 'checkpointer_blocking_duration_secs': 3.7045178413391113, 'get_old_steps_start_time': 1742810929.0597215, 'get_old_steps_duration_secs': 0.03139829635620117, 'checkpoint_manager_blocking_start_time': 1742810925.3538017, 'checkpoint_manager_blocking_duration_secs': 3.738614559173584} (3802351:standard_logger.py:34)
06:08:49.093 [I] Progress on: 2.00kit/2.00kit rate:9.9s/it remaining:00:00 elapsed:4:56:12 postfix:- (3802351:tqdm_logging.py:145)
06:08:49.093 [I] Waiting for checkpoint manager to finish                                         (3802351:train_pi0_fast_regent.py:301)
06:08:49.094 [I] [process=0][thread=MainThread][wait_until_finished] Initiating wait for Save Finalize thread. (3802351:checkpoint_manager.py:1759)
06:08:49.094 [I] [process=0][thread=MainThread][step=1999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (3802351:checkpoint_manager.py:1777)
06:08:58.060 [I] ChainedFuture completed 1/1 futures in 9.01 seconds.                             (3802351:future.py:137)
06:08:58.061 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 815.8 MiB/s (total bytes: 10.1 GiB) (time elapsed: 12 seconds) (per-host) (3802351:base_pytree_checkpoint_handler.py:113)
06:08:58.061 [I] [process=0][thread=async_save] 2 Handler Commit operations completed.            (3802351:async_checkpointer.py:131)
06:08:58.062 [I] [process=0][thread=async_save] Async Save Callback [1/3]: Finalizing Handler: <orbax.checkpoint._src.handlers.composite_checkpoint_handler.CompositeCheckpointHandler object at 0x7fa5e4449ed0> on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57 (3802351:async_checkpointer.py:406)
06:08:58.063 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57/assets.orbax-checkpoint-tmp-58 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57/assets (3802351:atomicity.py:287)
06:08:58.074 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57/params.orbax-checkpoint-tmp-59 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57/params (3802351:atomicity.py:287)
06:08:58.074 [I] [process=0][thread=async_save] Async Save Callback [2/3]: Running post_finalization_callback: None on /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999 (3802351:async_checkpointer.py:416)
06:08:58.075 [I] [process=0][thread=async_save] Async Save Callback [3/3]: Finalizing checkpoint directory: /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57 (3802351:async_checkpointer.py:426)
06:08:58.075 [I] Renaming /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999.orbax-checkpoint-tmp-57 to /home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999 (3802351:atomicity.py:287)
06:08:58.077 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/ksridhar/openpi_regent_droid/checkpoints/pi0_fast_droid_regent_with_interpolation_longer_act_horizon___finetune_on_pokeball/2nd_try_regent_pokeball/1999`. (3802351:atomicity.py:548)
06:08:58.077 [I] [process=0][thread=async_save] Background save thread done.                      (3802351:async_checkpointer.py:183)
06:08:58.078 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (3802351:async_checkpointer.py:239)
06:08:58.078 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (3802351:async_checkpointer.py:249)
06:08:58.078 [I] [process=0][thread=save_finalize][step=1999] CheckpointManager Save Finalize is syncing with other hosts... (3802351:checkpoint_manager.py:1890)
06:08:58.079 [I] [process=0][thread=save_finalize][step=1999] CheckpointManager Save Finalize is done on all hosts. (3802351:checkpoint_manager.py:1905)
06:08:58.079 [I] [process=0][thread=MainThread][step=1999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=1999. (3802351:checkpoint_manager.py:1786)
06:08:58.079 [I] [process=0][thread=MainThread][step=1999][wait_until_finished] Resetting Save Finalize thread (save_finalize) running at step=1999, also errors if any. (3802351:checkpoint_manager.py:1817)
[1;34mwandb[0m: üöÄ View run [33m2nd_try_regent_pokeball[0m at: [34mhttps://wandb.ai/ksridhar/openpi/runs/wq1w3oia[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250324_011111-wq1w3oia/logs[0m
