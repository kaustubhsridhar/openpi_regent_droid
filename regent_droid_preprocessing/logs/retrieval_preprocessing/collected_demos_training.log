nohup: ignoring input
2025-03-13 11:00:30: [retrieval_preprocessing] starting retrieval preprocessing for wrist_image
2025-03-13 11:00:33: [retrieval_preprocessing] concatenated all embeddings and indices for 19 episodes for collected_demos_training/2025-03-10_pick_up_the_apple_and_put_it_in_the_bowl [chosen_id count 0/8]
2025-03-13 11:00:33: [retrieval_preprocessing] we have num_total=2340 embedding_dim=49152
[retrieval_preprocessing] for episode 100000 [episode count 0/19], we have num_retrieval=np.int64(2197) num_query=np.int64(143)
2025-03-13 11:00:34,540 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:34,915 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:34
2025-03-13 11:00:34,915 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 8774.69it/s]
2025-03-13 11:00:34,950 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 11:00:34,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 11:00:34,951 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:34
2025-03-13 11:00:34,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:34,951 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:00:34,951 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:34,951 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:00:34,951 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:34
2025-03-13 11:00:34,952 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:34,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 11:00:34,952 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:34
2025-03-13 11:00:34,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:34,952 [INFO]: 	Creating the index 03/13/2025, 11:00:34
2025-03-13 11:00:34,952 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:34
2025-03-13 11:00:34,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:00:34,953 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:34
2025-03-13 11:00:34,954 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:34,954 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.13it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.11it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.14it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.19it/s]100%|██████████| 9/9 [00:02<00:00,  3.01it/s]100%|██████████| 9/9 [00:02<00:00,  4.25it/s]
2025-03-13 11:00:37,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:37
2025-03-13 11:01:10,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6428 secs
2025-03-13 11:01:10,722 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 11:01:10,722 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.63it/s]
2025-03-13 11:01:22,137 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4153 secs
2025-03-13 11:01:22,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1859 secs
2025-03-13 11:01:22,140 [INFO]: {
2025-03-13 11:01:22,140 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:22,140 [INFO]: 	index_param: efSearch=157
2025-03-13 11:01:22,140 [INFO]: 	index_path: knn.index
2025-03-13 11:01:22,140 [INFO]: 	size in bytes: 432246490
2025-03-13 11:01:22,140 [INFO]: 	avg_search_speed_ms: 8.09467410845946
2025-03-13 11:01:22,140 [INFO]: 	99p_search_speed_ms: 13.395281177945456
2025-03-13 11:01:22,140 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:22,140 [INFO]: 	nb vectors: 2197
2025-03-13 11:01:22,140 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:22,140 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 11:01:22,140 [INFO]: }
2025-03-13 11:01:22,140 [INFO]: 	>>> Finished "Creating the index" in 47.1878 secs
2025-03-13 11:01:22,140 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2250 secs
2025-03-13 11:01:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 100000 [episode count 0/19]
[retrieval_preprocessing] for episode 100001 [episode count 1/19], we have num_retrieval=np.int64(2208) num_query=np.int64(132)
2025-03-13 11:01:23,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:23,589 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:23
2025-03-13 11:01:23,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.02it/s]
2025-03-13 11:01:23,622 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 11:01:23,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 11:01:23,623 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:23
2025-03-13 11:01:23,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:23,623 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:01:23,623 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:23,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:01:23,623 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:23
2025-03-13 11:01:23,623 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:23,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:01:23,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:23
2025-03-13 11:01:23,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:23,623 [INFO]: 	Creating the index 03/13/2025, 11:01:23
2025-03-13 11:01:23,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:23
2025-03-13 11:01:23,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:01:23,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:23
2025-03-13 11:01:23,624 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:01:23,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00, 10.00it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.78it/s]100%|██████████| 9/9 [00:01<00:00,  4.76it/s]
2025-03-13 11:01:25,519 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:25
2025-03-13 11:01:54,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8666 secs
2025-03-13 11:01:54,387 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 11:01:54,387 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.66it/s]
2025-03-13 11:02:05,990 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6029 secs
2025-03-13 11:02:05,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3670 secs
2025-03-13 11:02:05,992 [INFO]: {
2025-03-13 11:02:05,992 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:05,992 [INFO]: 	index_param: efSearch=221
2025-03-13 11:02:05,992 [INFO]: 	index_path: knn.index
2025-03-13 11:02:05,992 [INFO]: 	size in bytes: 434410630
2025-03-13 11:02:05,992 [INFO]: 	avg_search_speed_ms: 9.933767017613368
2025-03-13 11:02:05,992 [INFO]: 	99p_search_speed_ms: 13.229190064594146
2025-03-13 11:02:05,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:05,992 [INFO]: 	nb vectors: 2208
2025-03-13 11:02:05,992 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:05,992 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 11:02:05,992 [INFO]: }
2025-03-13 11:02:05,992 [INFO]: 	>>> Finished "Creating the index" in 42.3685 secs
2025-03-13 11:02:05,992 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4030 secs
2025-03-13 11:02:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100001 [episode count 1/19]
[retrieval_preprocessing] for episode 100002 [episode count 2/19], we have num_retrieval=np.int64(2231) num_query=np.int64(109)
2025-03-13 11:02:07,251 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:07,600 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:07
2025-03-13 11:02:07,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1542.59it/s]
2025-03-13 11:02:07,631 [INFO]: There are 2231 embeddings of dim 49152
2025-03-13 11:02:07,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 11:02:07,631 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:07
2025-03-13 11:02:07,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:07,631 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:02:07,631 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:07,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:07,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:07
2025-03-13 11:02:07,632 [INFO]: 460.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:07,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:02:07,632 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:07
2025-03-13 11:02:07,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:07,632 [INFO]: 	Creating the index 03/13/2025, 11:02:07
2025-03-13 11:02:07,632 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:07
2025-03-13 11:02:07,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:02:07,633 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:07
2025-03-13 11:02:07,633 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:02:07,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.31it/s] 89%|████████▉ | 8/9 [00:00<00:00, 37.90it/s]100%|██████████| 9/9 [00:01<00:00,  5.41it/s]
2025-03-13 11:02:09,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:09
2025-03-13 11:02:34,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6845 secs
2025-03-13 11:02:34,985 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:02:34,985 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-13 11:02:46,386 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4001 secs
2025-03-13 11:02:46,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7543 secs
2025-03-13 11:02:46,387 [INFO]: {
2025-03-13 11:02:46,388 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:46,388 [INFO]: 	index_param: efSearch=204
2025-03-13 11:02:46,388 [INFO]: 	index_path: knn.index
2025-03-13 11:02:46,388 [INFO]: 	size in bytes: 438935650
2025-03-13 11:02:46,388 [INFO]: 	avg_search_speed_ms: 9.634785961785026
2025-03-13 11:02:46,388 [INFO]: 	99p_search_speed_ms: 15.00940693542358
2025-03-13 11:02:46,388 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:46,388 [INFO]: 	nb vectors: 2231
2025-03-13 11:02:46,388 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:46,388 [INFO]: 	compression ratio: 0.9993092335972255
2025-03-13 11:02:46,388 [INFO]: }
2025-03-13 11:02:46,388 [INFO]: 	>>> Finished "Creating the index" in 38.7559 secs
2025-03-13 11:02:46,388 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7880 secs
2025-03-13 11:02:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100002 [episode count 2/19]
[retrieval_preprocessing] for episode 100003 [episode count 3/19], we have num_retrieval=np.int64(2236) num_query=np.int64(104)
2025-03-13 11:02:47,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:47,936 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:47
2025-03-13 11:02:47,936 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.80it/s]
2025-03-13 11:02:47,967 [INFO]: There are 2236 embeddings of dim 49152
2025-03-13 11:02:47,967 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 11:02:47,967 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:47
2025-03-13 11:02:47,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:47,967 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:02:47,967 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:47,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:47,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:47
2025-03-13 11:02:47,967 [INFO]: 461.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:47,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:02:47,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:47
2025-03-13 11:02:47,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:47,968 [INFO]: 	Creating the index 03/13/2025, 11:02:47
2025-03-13 11:02:47,968 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:47
2025-03-13 11:02:47,969 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:02:47,969 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:47
2025-03-13 11:02:47,969 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:02:47,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.54it/s] 89%|████████▉ | 8/9 [00:00<00:00, 39.31it/s]100%|██████████| 9/9 [00:01<00:00,  5.51it/s]
2025-03-13 11:02:49,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:49
2025-03-13 11:03:16,936 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3306 secs
2025-03-13 11:03:16,936 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 11:03:16,936 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 11:03:28,413 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4769 secs
2025-03-13 11:03:28,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4459 secs
2025-03-13 11:03:28,415 [INFO]: {
2025-03-13 11:03:28,415 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:28,415 [INFO]: 	index_param: efSearch=181
2025-03-13 11:03:28,415 [INFO]: 	index_path: knn.index
2025-03-13 11:03:28,415 [INFO]: 	size in bytes: 439919350
2025-03-13 11:03:28,415 [INFO]: 	avg_search_speed_ms: 8.443868916868736
2025-03-13 11:03:28,415 [INFO]: 	99p_search_speed_ms: 12.540946565568465
2025-03-13 11:03:28,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:28,415 [INFO]: 	nb vectors: 2236
2025-03-13 11:03:28,415 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:28,415 [INFO]: 	compression ratio: 0.9993092779392404
2025-03-13 11:03:28,415 [INFO]: }
2025-03-13 11:03:28,415 [INFO]: 	>>> Finished "Creating the index" in 40.4473 secs
2025-03-13 11:03:28,415 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4791 secs
2025-03-13 11:03:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 100003 [episode count 3/19]
[retrieval_preprocessing] for episode 100004 [episode count 4/19], we have num_retrieval=np.int64(2240) num_query=np.int64(100)
2025-03-13 11:03:29,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:29,560 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:29
2025-03-13 11:03:29,560 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2097.15it/s]
2025-03-13 11:03:29,588 [INFO]: There are 2240 embeddings of dim 49152
2025-03-13 11:03:29,588 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:03:29,588 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:29
2025-03-13 11:03:29,588 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:29,588 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:03:29,588 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:29,588 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:29,588 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:29
2025-03-13 11:03:29,588 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:29,588 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:29,588 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:29
2025-03-13 11:03:29,588 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:29,588 [INFO]: 	Creating the index 03/13/2025, 11:03:29
2025-03-13 11:03:29,589 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:29
2025-03-13 11:03:29,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:03:29,590 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:29
2025-03-13 11:03:29,590 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:29,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.92it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.21it/s]100%|██████████| 9/9 [00:01<00:00,  3.92it/s]100%|██████████| 9/9 [00:01<00:00,  4.80it/s]
2025-03-13 11:03:31,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:31
2025-03-13 11:03:57,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1992 secs
2025-03-13 11:03:57,668 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 11:03:57,668 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 11:04:09,325 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6565 secs
2025-03-13 11:04:09,326 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7367 secs
2025-03-13 11:04:09,326 [INFO]: {
2025-03-13 11:04:09,326 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:09,326 [INFO]: 	index_param: efSearch=183
2025-03-13 11:04:09,326 [INFO]: 	index_path: knn.index
2025-03-13 11:04:09,326 [INFO]: 	size in bytes: 440706310
2025-03-13 11:04:09,326 [INFO]: 	avg_search_speed_ms: 8.870536008826601
2025-03-13 11:04:09,326 [INFO]: 	99p_search_speed_ms: 12.609570263884962
2025-03-13 11:04:09,326 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:09,326 [INFO]: 	nb vectors: 2240
2025-03-13 11:04:09,326 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:09,326 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-13 11:04:09,327 [INFO]: }
2025-03-13 11:04:09,327 [INFO]: 	>>> Finished "Creating the index" in 39.7380 secs
2025-03-13 11:04:09,327 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7667 secs
2025-03-13 11:04:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 100004 [episode count 4/19]
[retrieval_preprocessing] for episode 100005 [episode count 5/19], we have num_retrieval=np.int64(2241) num_query=np.int64(99)
2025-03-13 11:04:10,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:10,572 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:10
2025-03-13 11:04:10,572 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.01it/s]
2025-03-13 11:04:10,602 [INFO]: There are 2241 embeddings of dim 49152
2025-03-13 11:04:10,603 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 11:04:10,603 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:10
2025-03-13 11:04:10,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:10,603 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:04:10,603 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:10,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:10,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:10
2025-03-13 11:04:10,603 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:10,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:04:10,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:10
2025-03-13 11:04:10,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:10,603 [INFO]: 	Creating the index 03/13/2025, 11:04:10
2025-03-13 11:04:10,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:10
2025-03-13 11:04:10,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:04:10,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:10
2025-03-13 11:04:10,604 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:04:10,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.92it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.41it/s]100%|██████████| 9/9 [00:01<00:00,  4.86it/s]
2025-03-13 11:04:12,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:12
2025-03-13 11:04:39,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7156 secs
2025-03-13 11:04:39,175 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:04:39,175 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 11:04:50,615 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4403 secs
2025-03-13 11:04:50,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.0132 secs
2025-03-13 11:04:50,617 [INFO]: {
2025-03-13 11:04:50,618 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:50,618 [INFO]: 	index_param: efSearch=219
2025-03-13 11:04:50,618 [INFO]: 	index_path: knn.index
2025-03-13 11:04:50,618 [INFO]: 	size in bytes: 440903050
2025-03-13 11:04:50,618 [INFO]: 	avg_search_speed_ms: 11.255388207842582
2025-03-13 11:04:50,618 [INFO]: 	99p_search_speed_ms: 17.806891966611147
2025-03-13 11:04:50,618 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:50,618 [INFO]: 	nb vectors: 2241
2025-03-13 11:04:50,618 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:50,618 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-13 11:04:50,618 [INFO]: }
2025-03-13 11:04:50,618 [INFO]: 	>>> Finished "Creating the index" in 40.0146 secs
2025-03-13 11:04:50,618 [INFO]: >>> Finished "Launching the whole pipeline" in 40.0460 secs
2025-03-13 11:04:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 100005 [episode count 5/19]
[retrieval_preprocessing] for episode 100006 [episode count 6/19], we have num_retrieval=np.int64(2196) num_query=np.int64(144)
2025-03-13 11:04:51,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:52,048 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:52
2025-03-13 11:04:52,048 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1255.78it/s]
2025-03-13 11:04:52,079 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 11:04:52,079 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:04:52,079 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:52
2025-03-13 11:04:52,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:52,079 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:04:52,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:52,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:52,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:52
2025-03-13 11:04:52,079 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:52,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:04:52,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:52
2025-03-13 11:04:52,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:52,079 [INFO]: 	Creating the index 03/13/2025, 11:04:52
2025-03-13 11:04:52,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:52
2025-03-13 11:04:52,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:04:52,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:52
2025-03-13 11:04:52,080 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:04:52,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.89it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.56it/s]100%|██████████| 9/9 [00:01<00:00,  5.31it/s]
2025-03-13 11:04:53,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:53
2025-03-13 11:05:21,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4075 secs
2025-03-13 11:05:21,188 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 11:05:21,188 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.05it/s]
2025-03-13 11:05:32,722 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5331 secs
2025-03-13 11:05:32,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6431 secs
2025-03-13 11:05:32,724 [INFO]: {
2025-03-13 11:05:32,724 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:32,724 [INFO]: 	index_param: efSearch=191
2025-03-13 11:05:32,724 [INFO]: 	index_path: knn.index
2025-03-13 11:05:32,724 [INFO]: 	size in bytes: 432049750
2025-03-13 11:05:32,724 [INFO]: 	avg_search_speed_ms: 9.76393181876075
2025-03-13 11:05:32,724 [INFO]: 	99p_search_speed_ms: 14.518478121608496
2025-03-13 11:05:32,724 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:32,724 [INFO]: 	nb vectors: 2196
2025-03-13 11:05:32,724 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:32,724 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 11:05:32,724 [INFO]: }
2025-03-13 11:05:32,724 [INFO]: 	>>> Finished "Creating the index" in 40.6445 secs
2025-03-13 11:05:32,724 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6756 secs
2025-03-13 11:05:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 100006 [episode count 6/19]
[retrieval_preprocessing] for episode 100007 [episode count 7/19], we have num_retrieval=np.int64(2185) num_query=np.int64(155)
2025-03-13 11:05:34,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:34,359 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:34
2025-03-13 11:05:34,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.97it/s]
2025-03-13 11:05:34,388 [INFO]: There are 2185 embeddings of dim 49152
2025-03-13 11:05:34,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:05:34,388 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:34
2025-03-13 11:05:34,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:34,389 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:05:34,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:34,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:34,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:34
2025-03-13 11:05:34,389 [INFO]: 450.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:34,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:05:34,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:34
2025-03-13 11:05:34,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:34,389 [INFO]: 	Creating the index 03/13/2025, 11:05:34
2025-03-13 11:05:34,389 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:34
2025-03-13 11:05:34,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:05:34,390 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:34
2025-03-13 11:05:34,390 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:05:34,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.54it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.85it/s]100%|██████████| 9/9 [00:02<00:00,  4.43it/s]
2025-03-13 11:05:36,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:36
2025-03-13 11:06:01,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5395 secs
2025-03-13 11:06:01,965 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 11:06:01,965 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-13 11:06:15,315 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3507 secs
2025-03-13 11:06:15,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9272 secs
2025-03-13 11:06:15,317 [INFO]: {
2025-03-13 11:06:15,317 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:15,317 [INFO]: 	index_param: efSearch=206
2025-03-13 11:06:15,317 [INFO]: 	index_path: knn.index
2025-03-13 11:06:15,317 [INFO]: 	size in bytes: 429885490
2025-03-13 11:06:15,317 [INFO]: 	avg_search_speed_ms: 9.444415496092384
2025-03-13 11:06:15,317 [INFO]: 	99p_search_speed_ms: 11.888872887939218
2025-03-13 11:06:15,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:15,317 [INFO]: 	nb vectors: 2185
2025-03-13 11:06:15,317 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:15,317 [INFO]: 	compression ratio: 0.9993090950801805
2025-03-13 11:06:15,317 [INFO]: }
2025-03-13 11:06:15,317 [INFO]: 	>>> Finished "Creating the index" in 40.9285 secs
2025-03-13 11:06:15,317 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9579 secs
2025-03-13 11:06:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 100007 [episode count 7/19]
[retrieval_preprocessing] for episode 100008 [episode count 8/19], we have num_retrieval=np.int64(2178) num_query=np.int64(162)
2025-03-13 11:06:16,725 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:17,039 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:17
2025-03-13 11:06:17,039 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.45it/s]
2025-03-13 11:06:17,069 [INFO]: There are 2178 embeddings of dim 49152
2025-03-13 11:06:17,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 11:06:17,069 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:17
2025-03-13 11:06:17,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:17,069 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:06:17,069 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:17,069 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:17,069 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:17
2025-03-13 11:06:17,069 [INFO]: 449.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:17,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:17,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:17
2025-03-13 11:06:17,070 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:17,070 [INFO]: 	Creating the index 03/13/2025, 11:06:17
2025-03-13 11:06:17,070 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:17
2025-03-13 11:06:17,071 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:06:17,071 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:17
2025-03-13 11:06:17,071 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:06:17,071 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.85it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.03it/s]100%|██████████| 9/9 [00:01<00:00,  4.51it/s]
2025-03-13 11:06:19,070 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:19
2025-03-13 11:06:50,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4474 secs
2025-03-13 11:06:50,518 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 11:06:50,518 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.41it/s]
2025-03-13 11:07:01,860 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3417 secs
2025-03-13 11:07:01,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7908 secs
2025-03-13 11:07:01,862 [INFO]: {
2025-03-13 11:07:01,862 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:01,862 [INFO]: 	index_param: efSearch=221
2025-03-13 11:07:01,862 [INFO]: 	index_path: knn.index
2025-03-13 11:07:01,862 [INFO]: 	size in bytes: 428508310
2025-03-13 11:07:01,862 [INFO]: 	avg_search_speed_ms: 9.39792209445793
2025-03-13 11:07:01,862 [INFO]: 	99p_search_speed_ms: 12.097995849326251
2025-03-13 11:07:01,862 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:01,862 [INFO]: 	nb vectors: 2178
2025-03-13 11:07:01,862 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:01,862 [INFO]: 	compression ratio: 0.9993090309030414
2025-03-13 11:07:01,862 [INFO]: }
2025-03-13 11:07:01,862 [INFO]: 	>>> Finished "Creating the index" in 44.7922 secs
2025-03-13 11:07:01,862 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8229 secs
2025-03-13 11:07:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 100008 [episode count 8/19]
[retrieval_preprocessing] for episode 100009 [episode count 9/19], we have num_retrieval=np.int64(2243) num_query=np.int64(97)
2025-03-13 11:07:03,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:03,778 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:03
2025-03-13 11:07:03,778 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1582.16it/s]
2025-03-13 11:07:03,809 [INFO]: There are 2243 embeddings of dim 49152
2025-03-13 11:07:03,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 11:07:03,809 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:03
2025-03-13 11:07:03,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:03,809 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:07:03,809 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:03,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:07:03,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:03
2025-03-13 11:07:03,810 [INFO]: 462.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:03,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:07:03,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:03
2025-03-13 11:07:03,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:03,810 [INFO]: 	Creating the index 03/13/2025, 11:07:03
2025-03-13 11:07:03,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:03
2025-03-13 11:07:03,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:07:03,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:03
2025-03-13 11:07:03,812 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:03,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.49it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.06it/s]100%|██████████| 9/9 [00:01<00:00,  4.64it/s]
2025-03-13 11:07:05,758 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:05
2025-03-13 11:07:33,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9163 secs
2025-03-13 11:07:33,675 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:07:33,675 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.57it/s]
2025-03-13 11:07:46,744 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0689 secs
2025-03-13 11:07:46,745 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9333 secs
2025-03-13 11:07:46,746 [INFO]: {
2025-03-13 11:07:46,746 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:46,746 [INFO]: 	index_param: efSearch=184
2025-03-13 11:07:46,746 [INFO]: 	index_path: knn.index
2025-03-13 11:07:46,746 [INFO]: 	size in bytes: 441296530
2025-03-13 11:07:46,746 [INFO]: 	avg_search_speed_ms: 8.130078444946406
2025-03-13 11:07:46,746 [INFO]: 	99p_search_speed_ms: 10.728224285412582
2025-03-13 11:07:46,746 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:46,746 [INFO]: 	nb vectors: 2243
2025-03-13 11:07:46,746 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:46,746 [INFO]: 	compression ratio: 0.9993093396859477
2025-03-13 11:07:46,746 [INFO]: }
2025-03-13 11:07:46,746 [INFO]: 	>>> Finished "Creating the index" in 42.9356 secs
2025-03-13 11:07:46,746 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9679 secs
2025-03-13 11:07:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100009 [episode count 9/19]
[retrieval_preprocessing] for episode 100010 [episode count 10/19], we have num_retrieval=np.int64(2247) num_query=np.int64(93)
2025-03-13 11:07:47,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:47,967 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:47
2025-03-13 11:07:47,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.59it/s]
2025-03-13 11:07:48,003 [INFO]: There are 2247 embeddings of dim 49152
2025-03-13 11:07:48,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 11:07:48,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:48
2025-03-13 11:07:48,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:48,004 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:07:48,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:48,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:07:48,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:48
2025-03-13 11:07:48,004 [INFO]: 463.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:48,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:07:48,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:48
2025-03-13 11:07:48,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:48,005 [INFO]: 	Creating the index 03/13/2025, 11:07:48
2025-03-13 11:07:48,005 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:48
2025-03-13 11:07:48,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:07:48,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:48
2025-03-13 11:07:48,009 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:48,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.29it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.16it/s]100%|██████████| 9/9 [00:01<00:00,  4.70it/s]
2025-03-13 11:07:49,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:49
2025-03-13 11:08:17,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1105 secs
2025-03-13 11:08:17,041 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 11:08:17,041 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.77it/s]
2025-03-13 11:08:28,660 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6183 secs
2025-03-13 11:08:28,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6527 secs
2025-03-13 11:08:28,662 [INFO]: {
2025-03-13 11:08:28,662 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:28,662 [INFO]: 	index_param: efSearch=222
2025-03-13 11:08:28,662 [INFO]: 	index_path: knn.index
2025-03-13 11:08:28,662 [INFO]: 	size in bytes: 442083490
2025-03-13 11:08:28,662 [INFO]: 	avg_search_speed_ms: 9.969536707655768
2025-03-13 11:08:28,662 [INFO]: 	99p_search_speed_ms: 14.219576506875457
2025-03-13 11:08:28,662 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:28,662 [INFO]: 	nb vectors: 2247
2025-03-13 11:08:28,662 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:28,662 [INFO]: 	compression ratio: 0.9993093747970547
2025-03-13 11:08:28,662 [INFO]: }
2025-03-13 11:08:28,662 [INFO]: 	>>> Finished "Creating the index" in 40.6570 secs
2025-03-13 11:08:28,662 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6949 secs
2025-03-13 11:08:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 100010 [episode count 10/19]
[retrieval_preprocessing] for episode 100011 [episode count 11/19], we have num_retrieval=np.int64(2270) num_query=np.int64(70)
2025-03-13 11:08:29,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:30,345 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:30
2025-03-13 11:08:30,345 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1933.75it/s]
2025-03-13 11:08:30,386 [INFO]: There are 2270 embeddings of dim 49152
2025-03-13 11:08:30,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0410 secs
2025-03-13 11:08:30,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:30
2025-03-13 11:08:30,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:30,387 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:08:30,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:30,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:08:30,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:30
2025-03-13 11:08:30,388 [INFO]: 468.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:30,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:08:30,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:30
2025-03-13 11:08:30,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:30,388 [INFO]: 	Creating the index 03/13/2025, 11:08:30
2025-03-13 11:08:30,389 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:30
2025-03-13 11:08:30,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:08:30,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:30
2025-03-13 11:08:30,392 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:08:30,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.61it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.50it/s]100%|██████████| 9/9 [00:02<00:00,  4.06it/s]
2025-03-13 11:08:32,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:32
2025-03-13 11:09:00,821 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2092 secs
2025-03-13 11:09:00,822 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 11:09:00,822 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.90it/s]
2025-03-13 11:09:13,500 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6776 secs
2025-03-13 11:09:13,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1096 secs
2025-03-13 11:09:13,501 [INFO]: {
2025-03-13 11:09:13,501 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:13,501 [INFO]: 	index_param: efSearch=234
2025-03-13 11:09:13,501 [INFO]: 	index_path: knn.index
2025-03-13 11:09:13,501 [INFO]: 	size in bytes: 446608570
2025-03-13 11:09:13,501 [INFO]: 	avg_search_speed_ms: 10.388731731146358
2025-03-13 11:09:13,501 [INFO]: 	99p_search_speed_ms: 13.672373779118061
2025-03-13 11:09:13,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:13,501 [INFO]: 	nb vectors: 2270
2025-03-13 11:09:13,501 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:13,501 [INFO]: 	compression ratio: 0.9993094400315695
2025-03-13 11:09:13,501 [INFO]: }
2025-03-13 11:09:13,501 [INFO]: 	>>> Finished "Creating the index" in 43.1128 secs
2025-03-13 11:09:13,501 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1560 secs
2025-03-13 11:09:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100011 [episode count 11/19]
[retrieval_preprocessing] for episode 100012 [episode count 12/19], we have num_retrieval=np.int64(2246) num_query=np.int64(94)
2025-03-13 11:09:14,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:14,699 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:14
2025-03-13 11:09:14,700 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.38it/s]
2025-03-13 11:09:14,735 [INFO]: There are 2246 embeddings of dim 49152
2025-03-13 11:09:14,735 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-13 11:09:14,736 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:14
2025-03-13 11:09:14,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:14,736 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:09:14,736 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:14,736 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:09:14,736 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:14
2025-03-13 11:09:14,736 [INFO]: 463.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:14,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:09:14,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:14
2025-03-13 11:09:14,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:14,736 [INFO]: 	Creating the index 03/13/2025, 11:09:14
2025-03-13 11:09:14,737 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:14
2025-03-13 11:09:14,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:09:14,739 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:14
2025-03-13 11:09:14,739 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:09:14,739 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.86it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.47it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.36it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.79it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.23it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.51it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.80it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.98it/s]100%|██████████| 9/9 [00:02<00:00,  1.57it/s]100%|██████████| 9/9 [00:02<00:00,  3.24it/s]
2025-03-13 11:09:17,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:17
2025-03-13 11:09:50,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7794 secs
2025-03-13 11:09:50,301 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 11:09:50,301 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.88it/s]
2025-03-13 11:10:02,645 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3442 secs
2025-03-13 11:10:02,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9078 secs
2025-03-13 11:10:02,647 [INFO]: {
2025-03-13 11:10:02,647 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:02,647 [INFO]: 	index_param: efSearch=186
2025-03-13 11:10:02,647 [INFO]: 	index_path: knn.index
2025-03-13 11:10:02,647 [INFO]: 	size in bytes: 441886750
2025-03-13 11:10:02,647 [INFO]: 	avg_search_speed_ms: 9.458029808568202
2025-03-13 11:10:02,647 [INFO]: 	99p_search_speed_ms: 13.202556772157557
2025-03-13 11:10:02,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:02,647 [INFO]: 	nb vectors: 2246
2025-03-13 11:10:02,647 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:02,647 [INFO]: 	compression ratio: 0.9993093660310023
2025-03-13 11:10:02,647 [INFO]: }
2025-03-13 11:10:02,647 [INFO]: 	>>> Finished "Creating the index" in 47.9106 secs
2025-03-13 11:10:02,647 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9477 secs
2025-03-13 11:10:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 100012 [episode count 12/19]
[retrieval_preprocessing] for episode 100013 [episode count 13/19], we have num_retrieval=np.int64(2245) num_query=np.int64(95)
2025-03-13 11:10:03,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:04,149 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:04
2025-03-13 11:10:04,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1474.79it/s]
2025-03-13 11:10:04,180 [INFO]: There are 2245 embeddings of dim 49152
2025-03-13 11:10:04,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 11:10:04,181 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:04
2025-03-13 11:10:04,181 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:04,181 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:10:04,181 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:04,181 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:04,181 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:04
2025-03-13 11:10:04,181 [INFO]: 463.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:04,181 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:10:04,181 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:04
2025-03-13 11:10:04,181 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:04,181 [INFO]: 	Creating the index 03/13/2025, 11:10:04
2025-03-13 11:10:04,181 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:04
2025-03-13 11:10:04,182 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:10:04,182 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:04
2025-03-13 11:10:04,182 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:10:04,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.88it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.40it/s]100%|██████████| 9/9 [00:01<00:00,  4.85it/s]
2025-03-13 11:10:06,041 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:06
2025-03-13 11:10:34,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3961 secs
2025-03-13 11:10:34,438 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 11:10:34,438 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.89it/s]
2025-03-13 11:10:47,055 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6176 secs
2025-03-13 11:10:47,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8750 secs
2025-03-13 11:10:47,057 [INFO]: {
2025-03-13 11:10:47,057 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:47,057 [INFO]: 	index_param: efSearch=180
2025-03-13 11:10:47,057 [INFO]: 	index_path: knn.index
2025-03-13 11:10:47,057 [INFO]: 	size in bytes: 441690010
2025-03-13 11:10:47,057 [INFO]: 	avg_search_speed_ms: 10.195727435165635
2025-03-13 11:10:47,057 [INFO]: 	99p_search_speed_ms: 14.896556781604891
2025-03-13 11:10:47,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:47,057 [INFO]: 	nb vectors: 2245
2025-03-13 11:10:47,057 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:47,057 [INFO]: 	compression ratio: 0.9993093572571405
2025-03-13 11:10:47,057 [INFO]: }
2025-03-13 11:10:47,057 [INFO]: 	>>> Finished "Creating the index" in 42.8763 secs
2025-03-13 11:10:47,057 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9087 secs
2025-03-13 11:10:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100013 [episode count 13/19]
[retrieval_preprocessing] for episode 100014 [episode count 14/19], we have num_retrieval=np.int64(2079) num_query=np.int64(261)
2025-03-13 11:10:48,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:48,349 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:48
2025-03-13 11:10:48,349 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 11:10:48,382 [INFO]: There are 2079 embeddings of dim 49152
2025-03-13 11:10:48,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 11:10:48,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:48
2025-03-13 11:10:48,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:48,382 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:10:48,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:48,382 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:48,382 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:48
2025-03-13 11:10:48,383 [INFO]: 429.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:48,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:10:48,383 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:48
2025-03-13 11:10:48,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:48,383 [INFO]: 	Creating the index 03/13/2025, 11:10:48
2025-03-13 11:10:48,383 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:48
2025-03-13 11:10:48,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:10:48,384 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:48
2025-03-13 11:10:48,384 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:10:48,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.70it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.32it/s]100%|██████████| 9/9 [00:01<00:00,  4.79it/s]
2025-03-13 11:10:50,267 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:50
2025-03-13 11:11:20,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9587 secs
2025-03-13 11:11:20,227 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:11:20,227 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 11:11:31,911 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6843 secs
2025-03-13 11:11:31,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5285 secs
2025-03-13 11:11:31,913 [INFO]: {
2025-03-13 11:11:31,913 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:31,913 [INFO]: 	index_param: efSearch=204
2025-03-13 11:11:31,913 [INFO]: 	index_path: knn.index
2025-03-13 11:11:31,913 [INFO]: 	size in bytes: 409030630
2025-03-13 11:11:31,913 [INFO]: 	avg_search_speed_ms: 10.163972680731412
2025-03-13 11:11:31,913 [INFO]: 	99p_search_speed_ms: 13.553627231158316
2025-03-13 11:11:31,913 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:31,913 [INFO]: 	nb vectors: 2079
2025-03-13 11:11:31,913 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:31,913 [INFO]: 	compression ratio: 0.9993091030859963
2025-03-13 11:11:31,913 [INFO]: }
2025-03-13 11:11:31,913 [INFO]: 	>>> Finished "Creating the index" in 43.5300 secs
2025-03-13 11:11:31,913 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5641 secs
2025-03-13 11:11:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 100014 [episode count 14/19]
[retrieval_preprocessing] for episode 100015 [episode count 15/19], we have num_retrieval=np.int64(2240) num_query=np.int64(100)
2025-03-13 11:11:33,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:34,287 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:34
2025-03-13 11:11:34,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.90it/s]
2025-03-13 11:11:34,319 [INFO]: There are 2240 embeddings of dim 49152
2025-03-13 11:11:34,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 11:11:34,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:34
2025-03-13 11:11:34,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:34,320 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:11:34,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:34,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:11:34,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:34
2025-03-13 11:11:34,320 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:34,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:34,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:34
2025-03-13 11:11:34,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:34,320 [INFO]: 	Creating the index 03/13/2025, 11:11:34
2025-03-13 11:11:34,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:34
2025-03-13 11:11:34,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:11:34,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:34
2025-03-13 11:11:34,321 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:11:34,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.94it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.61it/s]100%|██████████| 9/9 [00:01<00:00,  5.22it/s]
2025-03-13 11:11:36,050 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:36
2025-03-13 11:12:10,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9851 secs
2025-03-13 11:12:10,036 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 11:12:10,036 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.79it/s]
2025-03-13 11:12:22,050 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0139 secs
2025-03-13 11:12:22,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7301 secs
2025-03-13 11:12:22,051 [INFO]: {
2025-03-13 11:12:22,051 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:22,051 [INFO]: 	index_param: efSearch=186
2025-03-13 11:12:22,051 [INFO]: 	index_path: knn.index
2025-03-13 11:12:22,051 [INFO]: 	size in bytes: 440706310
2025-03-13 11:12:22,051 [INFO]: 	avg_search_speed_ms: 9.97401098418955
2025-03-13 11:12:22,051 [INFO]: 	99p_search_speed_ms: 18.14466868992895
2025-03-13 11:12:22,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:22,051 [INFO]: 	nb vectors: 2240
2025-03-13 11:12:22,051 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:22,051 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-13 11:12:22,051 [INFO]: }
2025-03-13 11:12:22,051 [INFO]: 	>>> Finished "Creating the index" in 47.7315 secs
2025-03-13 11:12:22,051 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7639 secs
2025-03-13 11:12:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 100015 [episode count 15/19]
[retrieval_preprocessing] for episode 100016 [episode count 16/19], we have num_retrieval=np.int64(2237) num_query=np.int64(103)
2025-03-13 11:12:23,048 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:23,432 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:23
2025-03-13 11:12:23,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2085.68it/s]
2025-03-13 11:12:23,464 [INFO]: There are 2237 embeddings of dim 49152
2025-03-13 11:12:23,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 11:12:23,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:23,465 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:12:23,465 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:23,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:12:23,465 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,466 [INFO]: 461.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:23,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:12:23,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:23
2025-03-13 11:12:23,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:23,467 [INFO]: 	Creating the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:23
2025-03-13 11:12:23,470 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:12:23,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:23
2025-03-13 11:12:23,470 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:12:23,470 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.40it/s] 89%|████████▉ | 8/9 [00:00<00:00, 39.35it/s]100%|██████████| 9/9 [00:01<00:00,  4.88it/s]
2025-03-13 11:12:25,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:25
2025-03-13 11:12:57,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4648 secs
2025-03-13 11:12:57,786 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 11:12:57,786 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.36it/s]
2025-03-13 11:13:10,056 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2698 secs
2025-03-13 11:13:10,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5883 secs
2025-03-13 11:13:10,059 [INFO]: {
2025-03-13 11:13:10,059 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:10,059 [INFO]: 	index_param: efSearch=199
2025-03-13 11:13:10,059 [INFO]: 	index_path: knn.index
2025-03-13 11:13:10,059 [INFO]: 	size in bytes: 440116090
2025-03-13 11:13:10,059 [INFO]: 	avg_search_speed_ms: 10.38361756064392
2025-03-13 11:13:10,059 [INFO]: 	99p_search_speed_ms: 16.26112924190238
2025-03-13 11:13:10,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:10,059 [INFO]: 	nb vectors: 2237
2025-03-13 11:13:10,059 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:10,059 [INFO]: 	compression ratio: 0.9993092867838574
2025-03-13 11:13:10,059 [INFO]: }
2025-03-13 11:13:10,059 [INFO]: 	>>> Finished "Creating the index" in 46.5922 secs
2025-03-13 11:13:10,059 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6266 secs
2025-03-13 11:13:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 100016 [episode count 16/19]
[retrieval_preprocessing] for episode 100017 [episode count 17/19], we have num_retrieval=np.int64(2184) num_query=np.int64(156)
2025-03-13 11:13:11,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:11,489 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:11
2025-03-13 11:13:11,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1766.77it/s]
2025-03-13 11:13:11,523 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 11:13:11,523 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 11:13:11,523 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:11
2025-03-13 11:13:11,523 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:11,523 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:13:11,523 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:11,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:11,523 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:11
2025-03-13 11:13:11,523 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:11,524 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:11,524 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:11
2025-03-13 11:13:11,524 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:11,524 [INFO]: 	Creating the index 03/13/2025, 11:13:11
2025-03-13 11:13:11,524 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:11
2025-03-13 11:13:11,525 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:13:11,525 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:11
2025-03-13 11:13:11,525 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:13:11,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.70it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.45it/s]100%|██████████| 9/9 [00:01<00:00,  4.56it/s]
2025-03-13 11:13:13,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:13
2025-03-13 11:13:41,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1393 secs
2025-03-13 11:13:41,640 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 11:13:41,640 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-13 11:13:53,587 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9472 secs
2025-03-13 11:13:53,589 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0644 secs
2025-03-13 11:13:53,589 [INFO]: {
2025-03-13 11:13:53,589 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:53,589 [INFO]: 	index_param: efSearch=169
2025-03-13 11:13:53,589 [INFO]: 	index_path: knn.index
2025-03-13 11:13:53,589 [INFO]: 	size in bytes: 429688750
2025-03-13 11:13:53,589 [INFO]: 	avg_search_speed_ms: 9.072693153757758
2025-03-13 11:13:53,589 [INFO]: 	99p_search_speed_ms: 14.018851600121707
2025-03-13 11:13:53,589 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:53,589 [INFO]: 	nb vectors: 2184
2025-03-13 11:13:53,589 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:53,589 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 11:13:53,589 [INFO]: }
2025-03-13 11:13:53,589 [INFO]: 	>>> Finished "Creating the index" in 42.0657 secs
2025-03-13 11:13:53,589 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1001 secs
2025-03-13 11:13:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100017 [episode count 17/19]
[retrieval_preprocessing] for episode 100018 [episode count 18/19], we have num_retrieval=np.int64(2217) num_query=np.int64(123)
2025-03-13 11:13:54,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:55,139 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:55
2025-03-13 11:13:55,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.90it/s]
2025-03-13 11:13:55,171 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 11:13:55,171 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 11:13:55,171 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:55
2025-03-13 11:13:55,171 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:55,171 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:13:55,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:55,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:55,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:55
2025-03-13 11:13:55,171 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:55,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:55,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:55
2025-03-13 11:13:55,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:55,171 [INFO]: 	Creating the index 03/13/2025, 11:13:55
2025-03-13 11:13:55,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:55
2025-03-13 11:13:55,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:13:55,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:55
2025-03-13 11:13:55,173 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:13:55,173 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.57it/s] 89%|████████▉ | 8/9 [00:00<00:00, 37.18it/s]100%|██████████| 9/9 [00:01<00:00,  5.28it/s]
2025-03-13 11:13:56,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:56
2025-03-13 11:14:26,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2664 secs
2025-03-13 11:14:26,149 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:14:26,149 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 11:14:38,446 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2972 secs
2025-03-13 11:14:38,449 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2766 secs
2025-03-13 11:14:38,449 [INFO]: {
2025-03-13 11:14:38,449 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:38,449 [INFO]: 	index_param: efSearch=216
2025-03-13 11:14:38,449 [INFO]: 	index_path: knn.index
2025-03-13 11:14:38,449 [INFO]: 	size in bytes: 436181290
2025-03-13 11:14:38,450 [INFO]: 	avg_search_speed_ms: 10.75974756611451
2025-03-13 11:14:38,450 [INFO]: 	99p_search_speed_ms: 17.81912160571665
2025-03-13 11:14:38,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:38,450 [INFO]: 	nb vectors: 2217
2025-03-13 11:14:38,450 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:38,450 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 11:14:38,450 [INFO]: }
2025-03-13 11:14:38,450 [INFO]: 	>>> Finished "Creating the index" in 43.2782 secs
2025-03-13 11:14:38,450 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3108 secs
2025-03-13 11:14:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 100018 [episode count 18/19]
2025-03-13 11:14:39: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_apple_and_put_it_in_the_bowl [chosen_id count 0/8]
2025-03-13 11:14:41: [retrieval_preprocessing] concatenated all embeddings and indices for 7 episodes for collected_demos_training/2025-03-10_pour_the_cup_of_pasta_into_the_bowl [chosen_id count 1/8]
2025-03-13 11:14:41: [retrieval_preprocessing] we have num_total=2224 embedding_dim=49152
[retrieval_preprocessing] for episode 100019 [episode count 0/7], we have num_retrieval=np.int64(1849) num_query=np.int64(375)
2025-03-13 11:14:41,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:41,596 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:41
2025-03-13 11:14:41,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-13 11:14:41,629 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 11:14:41,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 11:14:41,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,630 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:41,630 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:14:41,630 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:41,630 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:41,630 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,630 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:41,630 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:14:41,630 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:41
2025-03-13 11:14:41,630 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:41,630 [INFO]: 	Creating the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,630 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:41
2025-03-13 11:14:41,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:14:41,631 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,632 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:14:41,632 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.35it/s]100%|██████████| 8/8 [00:01<00:00,  4.50it/s]100%|██████████| 8/8 [00:01<00:00,  4.96it/s]
2025-03-13 11:14:43,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:43
2025-03-13 11:15:05,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.2769 secs
2025-03-13 11:15:05,526 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:15:05,526 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-13 11:15:17,317 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7908 secs
2025-03-13 11:15:17,318 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.6868 secs
2025-03-13 11:15:17,318 [INFO]: {
2025-03-13 11:15:17,318 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:17,318 [INFO]: 	index_param: efSearch=295
2025-03-13 11:15:17,318 [INFO]: 	index_path: knn.index
2025-03-13 11:15:17,319 [INFO]: 	size in bytes: 363779470
2025-03-13 11:15:17,319 [INFO]: 	avg_search_speed_ms: 10.181776531199837
2025-03-13 11:15:17,319 [INFO]: 	99p_search_speed_ms: 13.759951936081052
2025-03-13 11:15:17,319 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:17,319 [INFO]: 	nb vectors: 1849
2025-03-13 11:15:17,319 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:17,319 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 11:15:17,319 [INFO]: }
2025-03-13 11:15:17,319 [INFO]: 	>>> Finished "Creating the index" in 35.6887 secs
2025-03-13 11:15:17,319 [INFO]: >>> Finished "Launching the whole pipeline" in 35.7235 secs
2025-03-13 11:15:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 100019 [episode count 0/7]
[retrieval_preprocessing] for episode 100020 [episode count 1/7], we have num_retrieval=np.int64(1952) num_query=np.int64(272)
2025-03-13 11:15:22,423 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:22,765 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:22
2025-03-13 11:15:22,765 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-13 11:15:22,798 [INFO]: There are 1952 embeddings of dim 49152
2025-03-13 11:15:22,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 11:15:22,798 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:22
2025-03-13 11:15:22,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:22,798 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:15:22,798 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:22,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:22,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:22
2025-03-13 11:15:22,799 [INFO]: 402.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:22,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:15:22,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:22
2025-03-13 11:15:22,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:22,799 [INFO]: 	Creating the index 03/13/2025, 11:15:22
2025-03-13 11:15:22,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:22
2025-03-13 11:15:22,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:15:22,800 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:22
2025-03-13 11:15:22,800 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:15:22,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.58it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.39it/s]100%|██████████| 8/8 [00:01<00:00,  5.86it/s]
2025-03-13 11:15:24,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:24
2025-03-13 11:15:48,357 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1870 secs
2025-03-13 11:15:48,357 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 11:15:48,357 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 11:16:01,003 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6461 secs
2025-03-13 11:16:01,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.2051 secs
2025-03-13 11:16:01,005 [INFO]: {
2025-03-13 11:16:01,005 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:01,005 [INFO]: 	index_param: efSearch=272
2025-03-13 11:16:01,005 [INFO]: 	index_path: knn.index
2025-03-13 11:16:01,006 [INFO]: 	size in bytes: 384044350
2025-03-13 11:16:01,006 [INFO]: 	avg_search_speed_ms: 12.305111780666447
2025-03-13 11:16:01,006 [INFO]: 	99p_search_speed_ms: 17.25040976889431
2025-03-13 11:16:01,006 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:01,006 [INFO]: 	nb vectors: 1952
2025-03-13 11:16:01,006 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:01,006 [INFO]: 	compression ratio: 0.9993085850631575
2025-03-13 11:16:01,006 [INFO]: }
2025-03-13 11:16:01,006 [INFO]: 	>>> Finished "Creating the index" in 38.2069 secs
2025-03-13 11:16:01,006 [INFO]: >>> Finished "Launching the whole pipeline" in 38.2408 secs
2025-03-13 11:16:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 100020 [episode count 1/7]
[retrieval_preprocessing] for episode 100021 [episode count 2/7], we have num_retrieval=np.int64(1780) num_query=np.int64(444)
2025-03-13 11:16:03,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:03,833 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:03
2025-03-13 11:16:03,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.00it/s]
2025-03-13 11:16:03,864 [INFO]: There are 1780 embeddings of dim 49152
2025-03-13 11:16:03,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 11:16:03,865 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:03,865 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:16:03,865 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:03,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:03,865 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,865 [INFO]: 367.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:03,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:16:03,865 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:03
2025-03-13 11:16:03,865 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:03,865 [INFO]: 	Creating the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,865 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:03
2025-03-13 11:16:03,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:16:03,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:03
2025-03-13 11:16:03,866 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:16:03,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.43it/s]100%|██████████| 8/8 [00:01<00:00,  6.69it/s]100%|██████████| 8/8 [00:01<00:00,  7.01it/s]
2025-03-13 11:16:05,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:05
2025-03-13 11:16:26,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.9061 secs
2025-03-13 11:16:26,918 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 11:16:26,918 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-13 11:16:38,103 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1857 secs
2025-03-13 11:16:38,105 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.2385 secs
2025-03-13 11:16:38,105 [INFO]: {
2025-03-13 11:16:38,105 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:38,105 [INFO]: 	index_param: efSearch=315
2025-03-13 11:16:38,105 [INFO]: 	index_path: knn.index
2025-03-13 11:16:38,105 [INFO]: 	size in bytes: 350204350
2025-03-13 11:16:38,105 [INFO]: 	avg_search_speed_ms: 9.872297747180175
2025-03-13 11:16:38,105 [INFO]: 	99p_search_speed_ms: 14.147081896662712
2025-03-13 11:16:38,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:38,105 [INFO]: 	nb vectors: 1780
2025-03-13 11:16:38,105 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:38,105 [INFO]: 	compression ratio: 0.9993086607861953
2025-03-13 11:16:38,106 [INFO]: }
2025-03-13 11:16:38,106 [INFO]: 	>>> Finished "Creating the index" in 34.2404 secs
2025-03-13 11:16:38,106 [INFO]: >>> Finished "Launching the whole pipeline" in 34.2724 secs
2025-03-13 11:16:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100021 [episode count 2/7]
[retrieval_preprocessing] for episode 100022 [episode count 3/7], we have num_retrieval=np.int64(1956) num_query=np.int64(268)
2025-03-13 11:16:42,956 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:43,315 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:43
2025-03-13 11:16:43,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1971.01it/s]
2025-03-13 11:16:43,347 [INFO]: There are 1956 embeddings of dim 49152
2025-03-13 11:16:43,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:16:43,347 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:43,347 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:16:43,347 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:43,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:43,347 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,347 [INFO]: 403.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:43,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:16:43,348 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:43
2025-03-13 11:16:43,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:43,348 [INFO]: 	Creating the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,348 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:43
2025-03-13 11:16:43,349 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:16:43,349 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,349 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:16:43,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.73it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.46it/s]100%|██████████| 8/8 [00:01<00:00,  4.72it/s]
2025-03-13 11:16:45,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:45
2025-03-13 11:17:07,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.9563 secs
2025-03-13 11:17:07,004 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:17:07,004 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 11:17:18,401 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3975 secs
2025-03-13 11:17:18,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.0536 secs
2025-03-13 11:17:18,403 [INFO]: {
2025-03-13 11:17:18,403 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:18,403 [INFO]: 	index_param: efSearch=295
2025-03-13 11:17:18,403 [INFO]: 	index_path: knn.index
2025-03-13 11:17:18,403 [INFO]: 	size in bytes: 384831310
2025-03-13 11:17:18,403 [INFO]: 	avg_search_speed_ms: 10.166392940838586
2025-03-13 11:17:18,403 [INFO]: 	99p_search_speed_ms: 13.930535060353575
2025-03-13 11:17:18,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:18,403 [INFO]: 	nb vectors: 1956
2025-03-13 11:17:18,403 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:18,403 [INFO]: 	compression ratio: 0.9993086269409835
2025-03-13 11:17:18,403 [INFO]: }
2025-03-13 11:17:18,403 [INFO]: 	>>> Finished "Creating the index" in 35.0554 secs
2025-03-13 11:17:18,403 [INFO]: >>> Finished "Launching the whole pipeline" in 35.0882 secs
2025-03-13 11:17:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 100022 [episode count 3/7]
[retrieval_preprocessing] for episode 100023 [episode count 4/7], we have num_retrieval=np.int64(2039) num_query=np.int64(185)
2025-03-13 11:17:21,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:21,932 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:21
2025-03-13 11:17:21,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.88it/s]
2025-03-13 11:17:21,987 [INFO]: There are 2039 embeddings of dim 49152
2025-03-13 11:17:21,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0549 secs
2025-03-13 11:17:21,988 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:21
2025-03-13 11:17:21,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:21,988 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:17:21,988 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:21,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:17:21,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:21
2025-03-13 11:17:21,988 [INFO]: 420.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:21,989 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:17:21,989 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:21
2025-03-13 11:17:21,989 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:21,989 [INFO]: 	Creating the index 03/13/2025, 11:17:21
2025-03-13 11:17:21,989 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:21
2025-03-13 11:17:21,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:17:21,991 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:21
2025-03-13 11:17:21,991 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:17:21,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.21it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.11it/s]100%|██████████| 9/9 [00:01<00:00,  4.24it/s]100%|██████████| 9/9 [00:01<00:00,  5.17it/s]
2025-03-13 11:17:23,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:23
2025-03-13 11:17:47,138 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4002 secs
2025-03-13 11:17:47,138 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 11:17:47,138 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-13 11:17:58,841 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7026 secs
2025-03-13 11:17:58,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.8512 secs
2025-03-13 11:17:58,843 [INFO]: {
2025-03-13 11:17:58,843 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:58,843 [INFO]: 	index_param: efSearch=314
2025-03-13 11:17:58,843 [INFO]: 	index_path: knn.index
2025-03-13 11:17:58,843 [INFO]: 	size in bytes: 401161030
2025-03-13 11:17:58,843 [INFO]: 	avg_search_speed_ms: 10.191435274401268
2025-03-13 11:17:58,843 [INFO]: 	99p_search_speed_ms: 14.057518308982253
2025-03-13 11:17:58,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:58,843 [INFO]: 	nb vectors: 2039
2025-03-13 11:17:58,843 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:58,843 [INFO]: 	compression ratio: 0.9993087115166696
2025-03-13 11:17:58,843 [INFO]: }
2025-03-13 11:17:58,843 [INFO]: 	>>> Finished "Creating the index" in 36.8542 secs
2025-03-13 11:17:58,843 [INFO]: >>> Finished "Launching the whole pipeline" in 36.9104 secs
2025-03-13 11:18:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 100023 [episode count 4/7]
[retrieval_preprocessing] for episode 100024 [episode count 5/7], we have num_retrieval=np.int64(1878) num_query=np.int64(346)
2025-03-13 11:18:01,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:01,314 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:01
2025-03-13 11:18:01,314 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1936.43it/s]
2025-03-13 11:18:01,344 [INFO]: There are 1878 embeddings of dim 49152
2025-03-13 11:18:01,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:18:01,344 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:01,344 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:18:01,344 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:01,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:01,344 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,344 [INFO]: 387.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:01,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:18:01,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:01
2025-03-13 11:18:01,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:01,344 [INFO]: 	Creating the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:01
2025-03-13 11:18:01,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:18:01,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,345 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:18:01,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.84it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.43it/s]100%|██████████| 8/8 [00:01<00:00,  6.06it/s]
2025-03-13 11:18:02,669 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:02
2025-03-13 11:18:25,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9938 secs
2025-03-13 11:18:25,663 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:18:25,663 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.70it/s]
2025-03-13 11:18:37,287 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6233 secs
2025-03-13 11:18:37,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.9427 secs
2025-03-13 11:18:37,288 [INFO]: {
2025-03-13 11:18:37,288 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:37,288 [INFO]: 	index_param: efSearch=219
2025-03-13 11:18:37,288 [INFO]: 	index_path: knn.index
2025-03-13 11:18:37,288 [INFO]: 	size in bytes: 369485230
2025-03-13 11:18:37,288 [INFO]: 	avg_search_speed_ms: 8.090158248385023
2025-03-13 11:18:37,288 [INFO]: 	99p_search_speed_ms: 13.5082675376907
2025-03-13 11:18:37,288 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:37,288 [INFO]: 	nb vectors: 1878
2025-03-13 11:18:37,288 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:37,288 [INFO]: 	compression ratio: 0.9993087518004441
2025-03-13 11:18:37,288 [INFO]: }
2025-03-13 11:18:37,288 [INFO]: 	>>> Finished "Creating the index" in 35.9441 secs
2025-03-13 11:18:37,288 [INFO]: >>> Finished "Launching the whole pipeline" in 35.9748 secs
2025-03-13 11:18:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 100024 [episode count 5/7]
[retrieval_preprocessing] for episode 100025 [episode count 6/7], we have num_retrieval=np.int64(1890) num_query=np.int64(334)
2025-03-13 11:18:39,635 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:39,890 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:39
2025-03-13 11:18:39,890 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.54it/s]
2025-03-13 11:18:39,922 [INFO]: There are 1890 embeddings of dim 49152
2025-03-13 11:18:39,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:18:39,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:39
2025-03-13 11:18:39,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:39,922 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:18:39,922 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:39,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:39,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:39
2025-03-13 11:18:39,922 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:39,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:18:39,922 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:39
2025-03-13 11:18:39,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:39,922 [INFO]: 	Creating the index 03/13/2025, 11:18:39
2025-03-13 11:18:39,922 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:39
2025-03-13 11:18:39,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:18:39,923 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:39
2025-03-13 11:18:39,924 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:18:39,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.04it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.77it/s]100%|██████████| 8/8 [00:01<00:00,  6.19it/s]
2025-03-13 11:18:41,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:41
2025-03-13 11:19:02,983 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.7640 secs
2025-03-13 11:19:02,984 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 11:19:02,984 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 11:19:14,280 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2965 secs
2025-03-13 11:19:14,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.3581 secs
2025-03-13 11:19:14,282 [INFO]: {
2025-03-13 11:19:14,282 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:14,282 [INFO]: 	index_param: efSearch=299
2025-03-13 11:19:14,282 [INFO]: 	index_path: knn.index
2025-03-13 11:19:14,282 [INFO]: 	size in bytes: 371846230
2025-03-13 11:19:14,282 [INFO]: 	avg_search_speed_ms: 9.89346895629446
2025-03-13 11:19:14,282 [INFO]: 	99p_search_speed_ms: 16.48333079647272
2025-03-13 11:19:14,282 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:14,282 [INFO]: 	nb vectors: 1890
2025-03-13 11:19:14,282 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:14,282 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-13 11:19:14,282 [INFO]: }
2025-03-13 11:19:14,282 [INFO]: 	>>> Finished "Creating the index" in 34.3597 secs
2025-03-13 11:19:14,282 [INFO]: >>> Finished "Launching the whole pipeline" in 34.3923 secs
2025-03-13 11:19:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 100025 [episode count 6/7]
2025-03-13 11:19:17: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pour_the_cup_of_pasta_into_the_bowl [chosen_id count 1/8]
2025-03-13 11:19:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_pick_up_the_duck_and_put_it_in_the_bowl [chosen_id count 2/8]
2025-03-13 11:19:19: [retrieval_preprocessing] we have num_total=1917 embedding_dim=49152
[retrieval_preprocessing] for episode 100026 [episode count 0/20], we have num_retrieval=np.int64(1790) num_query=np.int64(127)
2025-03-13 11:19:19,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:19,564 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:19
2025-03-13 11:19:19,564 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1988.76it/s]
2025-03-13 11:19:19,590 [INFO]: There are 1790 embeddings of dim 49152
2025-03-13 11:19:19,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 11:19:19,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:19
2025-03-13 11:19:19,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:19,590 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:19:19,590 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:19,590 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:19,590 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:19
2025-03-13 11:19:19,590 [INFO]: 369.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:19,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:19,590 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:19
2025-03-13 11:19:19,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:19,591 [INFO]: 	Creating the index 03/13/2025, 11:19:19
2025-03-13 11:19:19,591 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:19
2025-03-13 11:19:19,592 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:19:19,592 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:19
2025-03-13 11:19:19,592 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:19:19,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.49it/s]100%|██████████| 8/8 [00:01<00:00,  5.70it/s]100%|██████████| 8/8 [00:01<00:00,  6.01it/s]
2025-03-13 11:19:20,926 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:20
2025-03-13 11:19:46,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4883 secs
2025-03-13 11:19:46,415 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 11:19:46,415 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.79it/s]
2025-03-13 11:19:57,641 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2256 secs
2025-03-13 11:19:57,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.0501 secs
2025-03-13 11:19:57,642 [INFO]: {
2025-03-13 11:19:57,642 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:57,642 [INFO]: 	index_param: efSearch=224
2025-03-13 11:19:57,642 [INFO]: 	index_path: knn.index
2025-03-13 11:19:57,642 [INFO]: 	size in bytes: 352171750
2025-03-13 11:19:57,642 [INFO]: 	avg_search_speed_ms: 10.007497799349949
2025-03-13 11:19:57,642 [INFO]: 	99p_search_speed_ms: 15.116770232561958
2025-03-13 11:19:57,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:57,642 [INFO]: 	nb vectors: 1790
2025-03-13 11:19:57,642 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:57,642 [INFO]: 	compression ratio: 0.9993087747668573
2025-03-13 11:19:57,642 [INFO]: }
2025-03-13 11:19:57,642 [INFO]: 	>>> Finished "Creating the index" in 38.0518 secs
2025-03-13 11:19:57,642 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0786 secs
2025-03-13 11:19:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100026 [episode count 0/20]
[retrieval_preprocessing] for episode 100027 [episode count 1/20], we have num_retrieval=np.int64(1844) num_query=np.int64(73)
2025-03-13 11:19:58,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:59,017 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:59
2025-03-13 11:19:59,018 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.24it/s]
2025-03-13 11:19:59,049 [INFO]: There are 1844 embeddings of dim 49152
2025-03-13 11:19:59,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 11:19:59,049 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:59
2025-03-13 11:19:59,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:59,050 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:19:59,050 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:59,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:59,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:59
2025-03-13 11:19:59,050 [INFO]: 380.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:59,050 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:59,050 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:59
2025-03-13 11:19:59,050 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:59,050 [INFO]: 	Creating the index 03/13/2025, 11:19:59
2025-03-13 11:19:59,050 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:59
2025-03-13 11:19:59,051 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:59,051 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:59
2025-03-13 11:19:59,051 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:19:59,051 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.29it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.44it/s]100%|██████████| 8/8 [00:01<00:00,  5.61it/s]
2025-03-13 11:20:00,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:00
2025-03-13 11:20:21,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.3026 secs
2025-03-13 11:20:21,783 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:20:21,783 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.52it/s]
2025-03-13 11:20:34,178 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3947 secs
2025-03-13 11:20:34,179 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.1282 secs
2025-03-13 11:20:34,180 [INFO]: {
2025-03-13 11:20:34,180 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:34,180 [INFO]: 	index_param: efSearch=295
2025-03-13 11:20:34,180 [INFO]: 	index_path: knn.index
2025-03-13 11:20:34,180 [INFO]: 	size in bytes: 362795770
2025-03-13 11:20:34,180 [INFO]: 	avg_search_speed_ms: 11.871541318597442
2025-03-13 11:20:34,180 [INFO]: 	99p_search_speed_ms: 17.082123081199843
2025-03-13 11:20:34,180 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:34,180 [INFO]: 	nb vectors: 1844
2025-03-13 11:20:34,180 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:34,180 [INFO]: 	compression ratio: 0.9993092036326664
2025-03-13 11:20:34,180 [INFO]: }
2025-03-13 11:20:34,180 [INFO]: 	>>> Finished "Creating the index" in 35.1303 secs
2025-03-13 11:20:34,180 [INFO]: >>> Finished "Launching the whole pipeline" in 35.1626 secs
2025-03-13 11:20:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 100027 [episode count 1/20]
[retrieval_preprocessing] for episode 100028 [episode count 2/20], we have num_retrieval=np.int64(1828) num_query=np.int64(89)
2025-03-13 11:20:35,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:35,433 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:35
2025-03-13 11:20:35,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.78it/s]
2025-03-13 11:20:35,459 [INFO]: There are 1828 embeddings of dim 49152
2025-03-13 11:20:35,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:20:35,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:35
2025-03-13 11:20:35,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:35,460 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:20:35,461 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:35,461 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:20:35,461 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:35
2025-03-13 11:20:35,461 [INFO]: 377.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:35,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:20:35,462 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:35
2025-03-13 11:20:35,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:35,462 [INFO]: 	Creating the index 03/13/2025, 11:20:35
2025-03-13 11:20:35,462 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:35
2025-03-13 11:20:35,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 11:20:35,465 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:35
2025-03-13 11:20:35,466 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:20:35,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.91it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.02it/s]100%|██████████| 8/8 [00:01<00:00,  5.24it/s]
2025-03-13 11:20:36,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:36
2025-03-13 11:20:59,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9219 secs
2025-03-13 11:20:59,920 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 11:20:59,920 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.03it/s]
2025-03-13 11:21:11,815 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8942 secs
2025-03-13 11:21:11,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.3504 secs
2025-03-13 11:21:11,816 [INFO]: {
2025-03-13 11:21:11,816 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:11,816 [INFO]: 	index_param: efSearch=227
2025-03-13 11:21:11,816 [INFO]: 	index_path: knn.index
2025-03-13 11:21:11,816 [INFO]: 	size in bytes: 359647930
2025-03-13 11:21:11,816 [INFO]: 	avg_search_speed_ms: 10.16070130891621
2025-03-13 11:21:11,816 [INFO]: 	99p_search_speed_ms: 16.799811341334127
2025-03-13 11:21:11,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:11,816 [INFO]: 	nb vectors: 1828
2025-03-13 11:21:11,816 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:11,816 [INFO]: 	compression ratio: 0.9993090298058993
2025-03-13 11:21:11,816 [INFO]: }
2025-03-13 11:21:11,816 [INFO]: 	>>> Finished "Creating the index" in 36.3544 secs
2025-03-13 11:21:11,816 [INFO]: >>> Finished "Launching the whole pipeline" in 36.3837 secs
2025-03-13 11:21:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 100028 [episode count 2/20]
[retrieval_preprocessing] for episode 100029 [episode count 3/20], we have num_retrieval=np.int64(1858) num_query=np.int64(59)
2025-03-13 11:21:12,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:13,235 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:13
2025-03-13 11:21:13,235 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1367.56it/s]
2025-03-13 11:21:13,266 [INFO]: There are 1858 embeddings of dim 49152
2025-03-13 11:21:13,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 11:21:13,266 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:13,266 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:21:13,267 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:13,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:13,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,267 [INFO]: 383.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:13,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:21:13,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:13
2025-03-13 11:21:13,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:13,267 [INFO]: 	Creating the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:13
2025-03-13 11:21:13,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:21:13,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,269 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:21:13,269 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.20it/s]100%|██████████| 8/8 [00:01<00:00,  4.83it/s]100%|██████████| 8/8 [00:01<00:00,  5.11it/s]
2025-03-13 11:21:14,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:14
2025-03-13 11:21:37,298 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.4585 secs
2025-03-13 11:21:37,298 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 11:21:37,298 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 11:21:48,652 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3539 secs
2025-03-13 11:21:48,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.3848 secs
2025-03-13 11:21:48,653 [INFO]: {
2025-03-13 11:21:48,653 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:48,653 [INFO]: 	index_param: efSearch=212
2025-03-13 11:21:48,653 [INFO]: 	index_path: knn.index
2025-03-13 11:21:48,653 [INFO]: 	size in bytes: 365550250
2025-03-13 11:21:48,654 [INFO]: 	avg_search_speed_ms: 9.77552839976354
2025-03-13 11:21:48,654 [INFO]: 	99p_search_speed_ms: 14.446151284500955
2025-03-13 11:21:48,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:48,654 [INFO]: 	nb vectors: 1858
2025-03-13 11:21:48,654 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:48,654 [INFO]: 	compression ratio: 0.9993090252297735
2025-03-13 11:21:48,654 [INFO]: }
2025-03-13 11:21:48,654 [INFO]: 	>>> Finished "Creating the index" in 35.3866 secs
2025-03-13 11:21:48,654 [INFO]: >>> Finished "Launching the whole pipeline" in 35.4188 secs
2025-03-13 11:21:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 100029 [episode count 3/20]
[retrieval_preprocessing] for episode 100030 [episode count 4/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-13 11:21:49,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:49,683 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:49
2025-03-13 11:21:49,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.90it/s]
2025-03-13 11:21:49,711 [INFO]: There are 1833 embeddings of dim 49152
2025-03-13 11:21:49,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:21:49,711 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:49
2025-03-13 11:21:49,711 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:49,711 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:21:49,711 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:49,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:49,712 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:49
2025-03-13 11:21:49,712 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:49,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:49,712 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:49
2025-03-13 11:21:49,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:49,712 [INFO]: 	Creating the index 03/13/2025, 11:21:49
2025-03-13 11:21:49,712 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:49
2025-03-13 11:21:49,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:21:49,713 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:49
2025-03-13 11:21:49,713 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:21:49,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.90it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.95it/s]100%|██████████| 8/8 [00:01<00:00,  5.82it/s]
2025-03-13 11:21:51,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:51
2025-03-13 11:22:12,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.8628 secs
2025-03-13 11:22:12,953 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 11:22:12,953 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-13 11:22:24,161 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2077 secs
2025-03-13 11:22:24,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.4493 secs
2025-03-13 11:22:24,162 [INFO]: {
2025-03-13 11:22:24,162 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:24,162 [INFO]: 	index_param: efSearch=222
2025-03-13 11:22:24,162 [INFO]: 	index_path: knn.index
2025-03-13 11:22:24,162 [INFO]: 	size in bytes: 360631630
2025-03-13 11:22:24,162 [INFO]: 	avg_search_speed_ms: 9.609471293753165
2025-03-13 11:22:24,163 [INFO]: 	99p_search_speed_ms: 13.003730354830623
2025-03-13 11:22:24,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:24,163 [INFO]: 	nb vectors: 1833
2025-03-13 11:22:24,163 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:24,163 [INFO]: 	compression ratio: 0.999309084452742
2025-03-13 11:22:24,163 [INFO]: }
2025-03-13 11:22:24,163 [INFO]: 	>>> Finished "Creating the index" in 34.4507 secs
2025-03-13 11:22:24,163 [INFO]: >>> Finished "Launching the whole pipeline" in 34.4791 secs
2025-03-13 11:22:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 100030 [episode count 4/20]
[retrieval_preprocessing] for episode 100031 [episode count 5/20], we have num_retrieval=np.int64(1811) num_query=np.int64(106)
2025-03-13 11:22:24,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:25,220 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:25
2025-03-13 11:22:25,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1775.74it/s]
2025-03-13 11:22:25,251 [INFO]: There are 1811 embeddings of dim 49152
2025-03-13 11:22:25,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 11:22:25,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:25
2025-03-13 11:22:25,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:25,251 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:22:25,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:25,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:25,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:25
2025-03-13 11:22:25,251 [INFO]: 373.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:25,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:22:25,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:25
2025-03-13 11:22:25,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:25,252 [INFO]: 	Creating the index 03/13/2025, 11:22:25
2025-03-13 11:22:25,252 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:25
2025-03-13 11:22:25,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:22:25,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:25
2025-03-13 11:22:25,253 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:22:25,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.34it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.64it/s]100%|██████████| 8/8 [00:01<00:00,  5.06it/s]
2025-03-13 11:22:26,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:26
2025-03-13 11:22:54,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9818 secs
2025-03-13 11:22:54,818 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 11:22:54,818 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:54
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-13 11:23:06,124 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3052 secs
2025-03-13 11:23:06,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8729 secs
2025-03-13 11:23:06,126 [INFO]: {
2025-03-13 11:23:06,126 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:06,126 [INFO]: 	index_param: efSearch=242
2025-03-13 11:23:06,126 [INFO]: 	index_path: knn.index
2025-03-13 11:23:06,126 [INFO]: 	size in bytes: 356303350
2025-03-13 11:23:06,126 [INFO]: 	avg_search_speed_ms: 9.63864038673253
2025-03-13 11:23:06,126 [INFO]: 	99p_search_speed_ms: 13.388658035546525
2025-03-13 11:23:06,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:06,126 [INFO]: 	nb vectors: 1811
2025-03-13 11:23:06,126 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:06,126 [INFO]: 	compression ratio: 0.9993088417495934
2025-03-13 11:23:06,126 [INFO]: }
2025-03-13 11:23:06,126 [INFO]: 	>>> Finished "Creating the index" in 40.8744 secs
2025-03-13 11:23:06,126 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9060 secs
2025-03-13 11:23:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100031 [episode count 5/20]
[retrieval_preprocessing] for episode 100032 [episode count 6/20], we have num_retrieval=np.int64(1832) num_query=np.int64(85)
2025-03-13 11:23:07,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:07,942 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:07
2025-03-13 11:23:07,942 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.38it/s]
2025-03-13 11:23:07,970 [INFO]: There are 1832 embeddings of dim 49152
2025-03-13 11:23:07,970 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:23:07,970 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:07
2025-03-13 11:23:07,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:07,971 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:23:07,971 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:07,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:07,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:07
2025-03-13 11:23:07,971 [INFO]: 378.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:07,971 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:23:07,971 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:07
2025-03-13 11:23:07,971 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:07,971 [INFO]: 	Creating the index 03/13/2025, 11:23:07
2025-03-13 11:23:07,971 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:07
2025-03-13 11:23:07,972 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:23:07,972 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:07
2025-03-13 11:23:07,972 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:23:07,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.72it/s] 62%|██████▎   | 5/8 [00:00<00:00, 25.66it/s]100%|██████████| 8/8 [00:01<00:00,  4.43it/s]100%|██████████| 8/8 [00:01<00:00,  5.30it/s]
2025-03-13 11:23:09,484 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:09
2025-03-13 11:23:34,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9833 secs
2025-03-13 11:23:34,468 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 11:23:34,468 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-13 11:23:45,705 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2367 secs
2025-03-13 11:23:45,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.7340 secs
2025-03-13 11:23:45,706 [INFO]: {
2025-03-13 11:23:45,706 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:45,706 [INFO]: 	index_param: efSearch=279
2025-03-13 11:23:45,706 [INFO]: 	index_path: knn.index
2025-03-13 11:23:45,706 [INFO]: 	size in bytes: 360434890
2025-03-13 11:23:45,706 [INFO]: 	avg_search_speed_ms: 10.625667640430642
2025-03-13 11:23:45,707 [INFO]: 	99p_search_speed_ms: 14.548233198001983
2025-03-13 11:23:45,707 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:45,707 [INFO]: 	nb vectors: 1832
2025-03-13 11:23:45,707 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:45,707 [INFO]: 	compression ratio: 0.9993090735472362
2025-03-13 11:23:45,707 [INFO]: }
2025-03-13 11:23:45,707 [INFO]: 	>>> Finished "Creating the index" in 37.7356 secs
2025-03-13 11:23:45,707 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7648 secs
2025-03-13 11:23:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 100032 [episode count 6/20]
[retrieval_preprocessing] for episode 100033 [episode count 7/20], we have num_retrieval=np.int64(1702) num_query=np.int64(215)
2025-03-13 11:23:46,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:47,237 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:47
2025-03-13 11:23:47,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.79it/s]
2025-03-13 11:23:47,269 [INFO]: There are 1702 embeddings of dim 49152
2025-03-13 11:23:47,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 11:23:47,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:47
2025-03-13 11:23:47,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:47,270 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 11:23:47,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:47,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:23:47,271 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:47
2025-03-13 11:23:47,271 [INFO]: 351.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:47,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:23:47,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:47
2025-03-13 11:23:47,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:47,272 [INFO]: 	Creating the index 03/13/2025, 11:23:47
2025-03-13 11:23:47,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:47
2025-03-13 11:23:47,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 11:23:47,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:47
2025-03-13 11:23:47,276 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:23:47,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 25.86it/s]100%|██████████| 7/7 [00:01<00:00,  4.09it/s]100%|██████████| 7/7 [00:01<00:00,  4.58it/s]
2025-03-13 11:23:48,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:48
2025-03-13 11:24:10,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.2780 secs
2025-03-13 11:24:10,089 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 11:24:10,089 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.91it/s]
2025-03-13 11:24:21,287 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1983 secs
2025-03-13 11:24:21,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.0126 secs
2025-03-13 11:24:21,289 [INFO]: {
2025-03-13 11:24:21,289 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:21,289 [INFO]: 	index_param: efSearch=264
2025-03-13 11:24:21,289 [INFO]: 	index_path: knn.index
2025-03-13 11:24:21,289 [INFO]: 	size in bytes: 334858210
2025-03-13 11:24:21,289 [INFO]: 	avg_search_speed_ms: 10.897307825114472
2025-03-13 11:24:21,289 [INFO]: 	99p_search_speed_ms: 15.567892526742073
2025-03-13 11:24:21,289 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:21,289 [INFO]: 	nb vectors: 1702
2025-03-13 11:24:21,289 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:21,289 [INFO]: 	compression ratio: 0.999308979164644
2025-03-13 11:24:21,289 [INFO]: }
2025-03-13 11:24:21,289 [INFO]: 	>>> Finished "Creating the index" in 34.0170 secs
2025-03-13 11:24:21,289 [INFO]: >>> Finished "Launching the whole pipeline" in 34.0516 secs
2025-03-13 11:24:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 100033 [episode count 7/20]
[retrieval_preprocessing] for episode 100034 [episode count 8/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-13 11:24:23,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:23,285 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:23
2025-03-13 11:24:23,285 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2244.14it/s]
2025-03-13 11:24:23,325 [INFO]: There are 1833 embeddings of dim 49152
2025-03-13 11:24:23,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0406 secs
2025-03-13 11:24:23,326 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:23
2025-03-13 11:24:23,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:23,326 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:24:23,326 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:23,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:24:23,326 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:23
2025-03-13 11:24:23,326 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:23,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:24:23,327 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:23
2025-03-13 11:24:23,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:23,327 [INFO]: 	Creating the index 03/13/2025, 11:24:23
2025-03-13 11:24:23,327 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:23
2025-03-13 11:24:23,329 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:24:23,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:23
2025-03-13 11:24:23,329 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:24:23,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.65it/s]100%|██████████| 8/8 [00:01<00:00,  4.73it/s]100%|██████████| 8/8 [00:01<00:00,  5.00it/s]
2025-03-13 11:24:24,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:24
2025-03-13 11:24:51,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2905 secs
2025-03-13 11:24:51,224 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 11:24:51,224 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.25it/s]
2025-03-13 11:25:04,612 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3883 secs
2025-03-13 11:25:04,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2848 secs
2025-03-13 11:25:04,614 [INFO]: {
2025-03-13 11:25:04,614 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:04,614 [INFO]: 	index_param: efSearch=257
2025-03-13 11:25:04,614 [INFO]: 	index_path: knn.index
2025-03-13 11:25:04,614 [INFO]: 	size in bytes: 360631630
2025-03-13 11:25:04,614 [INFO]: 	avg_search_speed_ms: 10.478052118529824
2025-03-13 11:25:04,614 [INFO]: 	99p_search_speed_ms: 17.796554868109528
2025-03-13 11:25:04,614 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:04,614 [INFO]: 	nb vectors: 1833
2025-03-13 11:25:04,614 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:04,614 [INFO]: 	compression ratio: 0.999309084452742
2025-03-13 11:25:04,614 [INFO]: }
2025-03-13 11:25:04,614 [INFO]: 	>>> Finished "Creating the index" in 41.2869 secs
2025-03-13 11:25:04,614 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3290 secs
2025-03-13 11:25:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 100034 [episode count 8/20]
[retrieval_preprocessing] for episode 100035 [episode count 9/20], we have num_retrieval=np.int64(1801) num_query=np.int64(116)
2025-03-13 11:25:05,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:05,922 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:05
2025-03-13 11:25:05,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.81it/s]
2025-03-13 11:25:05,947 [INFO]: There are 1801 embeddings of dim 49152
2025-03-13 11:25:05,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:25:05,948 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:05
2025-03-13 11:25:05,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:05,948 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:25:05,948 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:05,948 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:25:05,948 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:05
2025-03-13 11:25:05,948 [INFO]: 371.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:05,948 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:25:05,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:05
2025-03-13 11:25:05,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:05,948 [INFO]: 	Creating the index 03/13/2025, 11:25:05
2025-03-13 11:25:05,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:05
2025-03-13 11:25:05,949 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:25:05,949 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:05
2025-03-13 11:25:05,949 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:25:05,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.59it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.90it/s]100%|██████████| 8/8 [00:01<00:00,  4.93it/s]
2025-03-13 11:25:07,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:07
2025-03-13 11:25:35,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7050 secs
2025-03-13 11:25:35,282 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 11:25:35,282 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 11:25:47,812 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5298 secs
2025-03-13 11:25:47,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8643 secs
2025-03-13 11:25:47,813 [INFO]: {
2025-03-13 11:25:47,813 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:47,814 [INFO]: 	index_param: efSearch=233
2025-03-13 11:25:47,814 [INFO]: 	index_path: knn.index
2025-03-13 11:25:47,814 [INFO]: 	size in bytes: 354335950
2025-03-13 11:25:47,814 [INFO]: 	avg_search_speed_ms: 10.110452742936397
2025-03-13 11:25:47,814 [INFO]: 	99p_search_speed_ms: 15.324901584535837
2025-03-13 11:25:47,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:47,814 [INFO]: 	nb vectors: 1801
2025-03-13 11:25:47,814 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:47,814 [INFO]: 	compression ratio: 0.9993087294698717
2025-03-13 11:25:47,814 [INFO]: }
2025-03-13 11:25:47,814 [INFO]: 	>>> Finished "Creating the index" in 41.8656 secs
2025-03-13 11:25:47,814 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8916 secs
2025-03-13 11:25:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 100035 [episode count 9/20]
[retrieval_preprocessing] for episode 100036 [episode count 10/20], we have num_retrieval=np.int64(1809) num_query=np.int64(108)
2025-03-13 11:25:49,098 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:49,338 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:49
2025-03-13 11:25:49,338 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-13 11:25:49,366 [INFO]: There are 1809 embeddings of dim 49152
2025-03-13 11:25:49,366 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 11:25:49,367 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:49
2025-03-13 11:25:49,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:49,367 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:25:49,367 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:49,367 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:49,367 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:49
2025-03-13 11:25:49,367 [INFO]: 373.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:49,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:25:49,367 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:49
2025-03-13 11:25:49,367 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:49,367 [INFO]: 	Creating the index 03/13/2025, 11:25:49
2025-03-13 11:25:49,367 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:49
2025-03-13 11:25:49,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:25:49,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:49
2025-03-13 11:25:49,368 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:25:49,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.33it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.85it/s]100%|██████████| 8/8 [00:01<00:00,  5.22it/s]
2025-03-13 11:25:50,903 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:50
2025-03-13 11:26:19,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5679 secs
2025-03-13 11:26:19,471 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 11:26:19,471 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.24it/s]
2025-03-13 11:26:32,291 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8197 secs
2025-03-13 11:26:32,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9244 secs
2025-03-13 11:26:32,293 [INFO]: {
2025-03-13 11:26:32,293 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:32,293 [INFO]: 	index_param: efSearch=236
2025-03-13 11:26:32,293 [INFO]: 	index_path: knn.index
2025-03-13 11:26:32,293 [INFO]: 	size in bytes: 355909870
2025-03-13 11:26:32,293 [INFO]: 	avg_search_speed_ms: 9.943045401032903
2025-03-13 11:26:32,293 [INFO]: 	99p_search_speed_ms: 14.158923097420505
2025-03-13 11:26:32,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:32,293 [INFO]: 	nb vectors: 1809
2025-03-13 11:26:32,293 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:32,293 [INFO]: 	compression ratio: 0.9993088193929547
2025-03-13 11:26:32,293 [INFO]: }
2025-03-13 11:26:32,293 [INFO]: 	>>> Finished "Creating the index" in 42.9257 secs
2025-03-13 11:26:32,293 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9544 secs
2025-03-13 11:26:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 100036 [episode count 10/20]
[retrieval_preprocessing] for episode 100037 [episode count 11/20], we have num_retrieval=np.int64(1824) num_query=np.int64(93)
2025-03-13 11:26:33,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:33,719 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:33
2025-03-13 11:26:33,720 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.32it/s]
2025-03-13 11:26:33,752 [INFO]: There are 1824 embeddings of dim 49152
2025-03-13 11:26:33,752 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 11:26:33,752 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:33
2025-03-13 11:26:33,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:33,753 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:26:33,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:33,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:26:33,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:33
2025-03-13 11:26:33,753 [INFO]: 376.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:33,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:26:33,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:33
2025-03-13 11:26:33,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:33,754 [INFO]: 	Creating the index 03/13/2025, 11:26:33
2025-03-13 11:26:33,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:33
2025-03-13 11:26:33,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:26:33,757 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:33
2025-03-13 11:26:33,757 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:26:33,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 24.76it/s]100%|██████████| 8/8 [00:01<00:00,  4.77it/s]100%|██████████| 8/8 [00:01<00:00,  5.24it/s]
2025-03-13 11:26:35,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:35
2025-03-13 11:27:01,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3194 secs
2025-03-13 11:27:01,610 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 11:27:01,610 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.51it/s]
2025-03-13 11:27:12,948 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3377 secs
2025-03-13 11:27:12,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.1928 secs
2025-03-13 11:27:12,950 [INFO]: {
2025-03-13 11:27:12,950 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:12,950 [INFO]: 	index_param: efSearch=247
2025-03-13 11:27:12,950 [INFO]: 	index_path: knn.index
2025-03-13 11:27:12,950 [INFO]: 	size in bytes: 358860970
2025-03-13 11:27:12,950 [INFO]: 	avg_search_speed_ms: 10.960780719890865
2025-03-13 11:27:12,950 [INFO]: 	99p_search_speed_ms: 17.035187147557735
2025-03-13 11:27:12,950 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:12,950 [INFO]: 	nb vectors: 1824
2025-03-13 11:27:12,950 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:12,950 [INFO]: 	compression ratio: 0.9993089858727183
2025-03-13 11:27:12,950 [INFO]: }
2025-03-13 11:27:12,950 [INFO]: 	>>> Finished "Creating the index" in 39.1963 secs
2025-03-13 11:27:12,950 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2308 secs
2025-03-13 11:27:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100037 [episode count 11/20]
[retrieval_preprocessing] for episode 100038 [episode count 12/20], we have num_retrieval=np.int64(1827) num_query=np.int64(90)
2025-03-13 11:27:14,023 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:14,255 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:14
2025-03-13 11:27:14,255 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1859.18it/s]
2025-03-13 11:27:14,280 [INFO]: There are 1827 embeddings of dim 49152
2025-03-13 11:27:14,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:27:14,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:14
2025-03-13 11:27:14,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:14,280 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:27:14,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:14,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:14,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:14
2025-03-13 11:27:14,280 [INFO]: 377.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:14,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:14,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:14
2025-03-13 11:27:14,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:14,280 [INFO]: 	Creating the index 03/13/2025, 11:27:14
2025-03-13 11:27:14,281 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:14
2025-03-13 11:27:14,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:27:14,282 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:14
2025-03-13 11:27:14,282 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:27:14,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.52it/s]100%|██████████| 8/8 [00:01<00:00,  4.76it/s]100%|██████████| 8/8 [00:01<00:00,  5.03it/s]
2025-03-13 11:27:15,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:15
2025-03-13 11:27:38,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7365 secs
2025-03-13 11:27:38,611 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 11:27:38,611 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.91it/s]
2025-03-13 11:27:50,197 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5862 secs
2025-03-13 11:27:50,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.9169 secs
2025-03-13 11:27:50,199 [INFO]: {
2025-03-13 11:27:50,199 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:50,199 [INFO]: 	index_param: efSearch=198
2025-03-13 11:27:50,199 [INFO]: 	index_path: knn.index
2025-03-13 11:27:50,199 [INFO]: 	size in bytes: 359451190
2025-03-13 11:27:50,199 [INFO]: 	avg_search_speed_ms: 9.322967127925487
2025-03-13 11:27:50,199 [INFO]: 	99p_search_speed_ms: 14.331353716552252
2025-03-13 11:27:50,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:50,199 [INFO]: 	nb vectors: 1827
2025-03-13 11:27:50,199 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:50,199 [INFO]: 	compression ratio: 0.9993090188406387
2025-03-13 11:27:50,199 [INFO]: }
2025-03-13 11:27:50,199 [INFO]: 	>>> Finished "Creating the index" in 35.9183 secs
2025-03-13 11:27:50,199 [INFO]: >>> Finished "Launching the whole pipeline" in 35.9436 secs
2025-03-13 11:27:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100038 [episode count 12/20]
[retrieval_preprocessing] for episode 100039 [episode count 13/20], we have num_retrieval=np.int64(1752) num_query=np.int64(165)
2025-03-13 11:27:51,117 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:51,351 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:51
2025-03-13 11:27:51,351 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1903.04it/s]
2025-03-13 11:27:51,377 [INFO]: There are 1752 embeddings of dim 49152
2025-03-13 11:27:51,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 11:27:51,378 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:51
2025-03-13 11:27:51,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:51,378 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:27:51,378 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:51,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:51,378 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:51
2025-03-13 11:27:51,378 [INFO]: 361.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:51,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:51,378 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:51
2025-03-13 11:27:51,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:51,378 [INFO]: 	Creating the index 03/13/2025, 11:27:51
2025-03-13 11:27:51,378 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:51
2025-03-13 11:27:51,379 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:27:51,379 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:51
2025-03-13 11:27:51,379 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:27:51,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.80it/s]100%|██████████| 7/7 [00:01<00:00,  4.48it/s]100%|██████████| 7/7 [00:01<00:00,  4.78it/s]
2025-03-13 11:27:52,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:52
2025-03-13 11:28:20,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1510 secs
2025-03-13 11:28:20,996 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 11:28:20,996 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 11:28:33,607 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6109 secs
2025-03-13 11:28:33,609 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2300 secs
2025-03-13 11:28:33,609 [INFO]: {
2025-03-13 11:28:33,609 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:33,609 [INFO]: 	index_param: efSearch=247
2025-03-13 11:28:33,609 [INFO]: 	index_path: knn.index
2025-03-13 11:28:33,609 [INFO]: 	size in bytes: 344695510
2025-03-13 11:28:33,609 [INFO]: 	avg_search_speed_ms: 10.958511383361454
2025-03-13 11:28:33,609 [INFO]: 	99p_search_speed_ms: 16.059618275612593
2025-03-13 11:28:33,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:33,609 [INFO]: 	nb vectors: 1752
2025-03-13 11:28:33,609 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:33,609 [INFO]: 	compression ratio: 0.9993086826109223
2025-03-13 11:28:33,609 [INFO]: }
2025-03-13 11:28:33,610 [INFO]: 	>>> Finished "Creating the index" in 42.2315 secs
2025-03-13 11:28:33,610 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2589 secs
2025-03-13 11:28:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 100039 [episode count 13/20]
[retrieval_preprocessing] for episode 100040 [episode count 14/20], we have num_retrieval=np.int64(1856) num_query=np.int64(61)
2025-03-13 11:28:35,884 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:36,132 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:36
2025-03-13 11:28:36,132 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1696.04it/s]
2025-03-13 11:28:36,160 [INFO]: There are 1856 embeddings of dim 49152
2025-03-13 11:28:36,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 11:28:36,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:36
2025-03-13 11:28:36,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:36,161 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:28:36,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:36,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:36,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:36
2025-03-13 11:28:36,161 [INFO]: 383.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:36,161 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:28:36,161 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:36
2025-03-13 11:28:36,161 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:36,161 [INFO]: 	Creating the index 03/13/2025, 11:28:36
2025-03-13 11:28:36,161 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:36
2025-03-13 11:28:36,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:28:36,162 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:36
2025-03-13 11:28:36,162 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:28:36,162 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.14it/s]100%|██████████| 8/8 [00:01<00:00,  5.12it/s]100%|██████████| 8/8 [00:01<00:00,  5.40it/s]
2025-03-13 11:28:37,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:37
2025-03-13 11:29:00,845 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1989 secs
2025-03-13 11:29:00,845 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 11:29:00,845 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-13 11:29:13,451 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6060 secs
2025-03-13 11:29:13,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.2903 secs
2025-03-13 11:29:13,453 [INFO]: {
2025-03-13 11:29:13,453 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:13,453 [INFO]: 	index_param: efSearch=248
2025-03-13 11:29:13,453 [INFO]: 	index_path: knn.index
2025-03-13 11:29:13,453 [INFO]: 	size in bytes: 365156710
2025-03-13 11:29:13,453 [INFO]: 	avg_search_speed_ms: 10.665136553507958
2025-03-13 11:29:13,453 [INFO]: 	99p_search_speed_ms: 14.660757479723543
2025-03-13 11:29:13,453 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:13,453 [INFO]: 	nb vectors: 1856
2025-03-13 11:29:13,453 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:13,453 [INFO]: 	compression ratio: 0.9993091678364612
2025-03-13 11:29:13,453 [INFO]: }
2025-03-13 11:29:13,453 [INFO]: 	>>> Finished "Creating the index" in 37.2918 secs
2025-03-13 11:29:13,453 [INFO]: >>> Finished "Launching the whole pipeline" in 37.3213 secs
2025-03-13 11:29:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100040 [episode count 14/20]
[retrieval_preprocessing] for episode 100041 [episode count 15/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-13 11:29:14,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:14,562 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:14
2025-03-13 11:29:14,562 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1833.98it/s]
2025-03-13 11:29:14,587 [INFO]: There are 1833 embeddings of dim 49152
2025-03-13 11:29:14,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:29:14,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:14
2025-03-13 11:29:14,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:14,587 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:29:14,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:14,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:14,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:14
2025-03-13 11:29:14,587 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:14,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:14,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:14
2025-03-13 11:29:14,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:14,587 [INFO]: 	Creating the index 03/13/2025, 11:29:14
2025-03-13 11:29:14,588 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:14
2025-03-13 11:29:14,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:29:14,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:14
2025-03-13 11:29:14,589 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:29:14,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.60it/s]100%|██████████| 8/8 [00:01<00:00,  5.68it/s]100%|██████████| 8/8 [00:01<00:00,  5.97it/s]
2025-03-13 11:29:15,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:15
2025-03-13 11:29:38,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.6684 secs
2025-03-13 11:29:38,600 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 11:29:38,600 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 11:29:50,134 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5336 secs
2025-03-13 11:29:50,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.5472 secs
2025-03-13 11:29:50,136 [INFO]: {
2025-03-13 11:29:50,136 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:50,136 [INFO]: 	index_param: efSearch=284
2025-03-13 11:29:50,136 [INFO]: 	index_path: knn.index
2025-03-13 11:29:50,136 [INFO]: 	size in bytes: 360631630
2025-03-13 11:29:50,136 [INFO]: 	avg_search_speed_ms: 11.923113206781101
2025-03-13 11:29:50,136 [INFO]: 	99p_search_speed_ms: 17.717175530269742
2025-03-13 11:29:50,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:50,136 [INFO]: 	nb vectors: 1833
2025-03-13 11:29:50,136 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:50,136 [INFO]: 	compression ratio: 0.999309084452742
2025-03-13 11:29:50,136 [INFO]: }
2025-03-13 11:29:50,136 [INFO]: 	>>> Finished "Creating the index" in 35.5487 secs
2025-03-13 11:29:50,136 [INFO]: >>> Finished "Launching the whole pipeline" in 35.5746 secs
2025-03-13 11:29:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 100041 [episode count 15/20]
[retrieval_preprocessing] for episode 100042 [episode count 16/20], we have num_retrieval=np.int64(1847) num_query=np.int64(70)
2025-03-13 11:29:51,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:51,501 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:51
2025-03-13 11:29:51,501 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1633.30it/s]
2025-03-13 11:29:51,531 [INFO]: There are 1847 embeddings of dim 49152
2025-03-13 11:29:51,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:29:51,532 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:51
2025-03-13 11:29:51,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:51,533 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:29:51,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:51,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:29:51,533 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:51
2025-03-13 11:29:51,533 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:51,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:29:51,534 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:51
2025-03-13 11:29:51,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:51,534 [INFO]: 	Creating the index 03/13/2025, 11:29:51
2025-03-13 11:29:51,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:51
2025-03-13 11:29:51,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:29:51,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:51
2025-03-13 11:29:51,538 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:29:51,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.59it/s]100%|██████████| 8/8 [00:01<00:00,  4.43it/s]100%|██████████| 8/8 [00:01<00:00,  4.88it/s]
2025-03-13 11:29:53,183 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:53
2025-03-13 11:30:15,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3796 secs
2025-03-13 11:30:15,564 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 11:30:15,564 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 11:30:27,126 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5624 secs
2025-03-13 11:30:27,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.5899 secs
2025-03-13 11:30:27,128 [INFO]: {
2025-03-13 11:30:27,128 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:27,128 [INFO]: 	index_param: efSearch=277
2025-03-13 11:30:27,128 [INFO]: 	index_path: knn.index
2025-03-13 11:30:27,128 [INFO]: 	size in bytes: 363385990
2025-03-13 11:30:27,128 [INFO]: 	avg_search_speed_ms: 11.998104370965196
2025-03-13 11:30:27,128 [INFO]: 	99p_search_speed_ms: 19.663329701870676
2025-03-13 11:30:27,128 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:27,128 [INFO]: 	nb vectors: 1847
2025-03-13 11:30:27,128 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:27,128 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-13 11:30:27,128 [INFO]: }
2025-03-13 11:30:27,128 [INFO]: 	>>> Finished "Creating the index" in 35.5940 secs
2025-03-13 11:30:27,128 [INFO]: >>> Finished "Launching the whole pipeline" in 35.6269 secs
2025-03-13 11:30:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 100042 [episode count 16/20]
[retrieval_preprocessing] for episode 100043 [episode count 17/20], we have num_retrieval=np.int64(1848) num_query=np.int64(69)
2025-03-13 11:30:28,013 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:28,275 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:28
2025-03-13 11:30:28,275 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-13 11:30:28,297 [INFO]: There are 1848 embeddings of dim 49152
2025-03-13 11:30:28,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 11:30:28,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:28,297 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:30:28,297 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:28,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:28,297 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,298 [INFO]: 381.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:28,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:28,298 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:28
2025-03-13 11:30:28,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:28,298 [INFO]: 	Creating the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,298 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:28
2025-03-13 11:30:28,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:28,299 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,299 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:30:28,299 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.94it/s]100%|██████████| 8/8 [00:02<00:00,  3.16it/s]100%|██████████| 8/8 [00:02<00:00,  3.37it/s]
2025-03-13 11:30:30,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:30
2025-03-13 11:30:52,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1933 secs
2025-03-13 11:30:52,868 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 11:30:52,868 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 11:31:06,703 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8341 secs
2025-03-13 11:31:06,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.4048 secs
2025-03-13 11:31:06,704 [INFO]: {
2025-03-13 11:31:06,704 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:06,704 [INFO]: 	index_param: efSearch=274
2025-03-13 11:31:06,704 [INFO]: 	index_path: knn.index
2025-03-13 11:31:06,704 [INFO]: 	size in bytes: 363582730
2025-03-13 11:31:06,704 [INFO]: 	avg_search_speed_ms: 11.926737232677665
2025-03-13 11:31:06,704 [INFO]: 	99p_search_speed_ms: 19.453876884654168
2025-03-13 11:31:06,704 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:06,704 [INFO]: 	nb vectors: 1848
2025-03-13 11:31:06,704 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:06,704 [INFO]: 	compression ratio: 0.999309246619057
2025-03-13 11:31:06,704 [INFO]: }
2025-03-13 11:31:06,704 [INFO]: 	>>> Finished "Creating the index" in 38.4064 secs
2025-03-13 11:31:06,704 [INFO]: >>> Finished "Launching the whole pipeline" in 38.4288 secs
2025-03-13 11:31:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100043 [episode count 17/20]
[retrieval_preprocessing] for episode 100044 [episode count 18/20], we have num_retrieval=np.int64(1830) num_query=np.int64(87)
2025-03-13 11:31:07,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:07,862 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:07
2025-03-13 11:31:07,862 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.57it/s]
2025-03-13 11:31:07,890 [INFO]: There are 1830 embeddings of dim 49152
2025-03-13 11:31:07,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:31:07,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:07
2025-03-13 11:31:07,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:07,890 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:31:07,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:07,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:07,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:07
2025-03-13 11:31:07,891 [INFO]: 377.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:07,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:07,891 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:07
2025-03-13 11:31:07,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:07,891 [INFO]: 	Creating the index 03/13/2025, 11:31:07
2025-03-13 11:31:07,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:07
2025-03-13 11:31:07,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:07,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:07
2025-03-13 11:31:07,892 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:31:07,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.72it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.80it/s]100%|██████████| 8/8 [00:01<00:00,  5.27it/s]
2025-03-13 11:31:09,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:09
2025-03-13 11:31:32,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3371 secs
2025-03-13 11:31:32,750 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 11:31:32,750 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.39it/s]
2025-03-13 11:31:45,964 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2145 secs
2025-03-13 11:31:45,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.0740 secs
2025-03-13 11:31:45,966 [INFO]: {
2025-03-13 11:31:45,966 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:45,966 [INFO]: 	index_param: efSearch=280
2025-03-13 11:31:45,966 [INFO]: 	index_path: knn.index
2025-03-13 11:31:45,966 [INFO]: 	size in bytes: 360041410
2025-03-13 11:31:45,966 [INFO]: 	avg_search_speed_ms: 10.982401991052436
2025-03-13 11:31:45,966 [INFO]: 	99p_search_speed_ms: 15.382717526517807
2025-03-13 11:31:45,966 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:45,966 [INFO]: 	nb vectors: 1830
2025-03-13 11:31:45,966 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:45,966 [INFO]: 	compression ratio: 0.9993090517004697
2025-03-13 11:31:45,966 [INFO]: }
2025-03-13 11:31:45,966 [INFO]: 	>>> Finished "Creating the index" in 38.0754 secs
2025-03-13 11:31:45,966 [INFO]: >>> Finished "Launching the whole pipeline" in 38.1037 secs
2025-03-13 11:31:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 100044 [episode count 18/20]
[retrieval_preprocessing] for episode 100045 [episode count 19/20], we have num_retrieval=np.int64(1865) num_query=np.int64(52)
2025-03-13 11:31:47,010 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:47,253 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:47
2025-03-13 11:31:47,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1605.17it/s]
2025-03-13 11:31:47,293 [INFO]: There are 1865 embeddings of dim 49152
2025-03-13 11:31:47,293 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 11:31:47,294 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:47
2025-03-13 11:31:47,294 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:47,294 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:31:47,294 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:47,294 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:31:47,294 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:47
2025-03-13 11:31:47,294 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:47,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:31:47,294 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:47
2025-03-13 11:31:47,294 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:47,294 [INFO]: 	Creating the index 03/13/2025, 11:31:47
2025-03-13 11:31:47,294 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:47
2025-03-13 11:31:47,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:31:47,296 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:47
2025-03-13 11:31:47,296 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:31:47,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.34it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]100%|██████████| 8/8 [00:01<00:00,  5.38it/s]
2025-03-13 11:31:48,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:48
2025-03-13 11:32:12,559 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7710 secs
2025-03-13 11:32:12,559 [INFO]: The best hyperparameters are: efSearch=285
2025-03-13 11:32:12,559 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.30it/s]
2025-03-13 11:32:27,786 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2271 secs
2025-03-13 11:32:27,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4916 secs
2025-03-13 11:32:27,788 [INFO]: {
2025-03-13 11:32:27,788 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:27,788 [INFO]: 	index_param: efSearch=285
2025-03-13 11:32:27,788 [INFO]: 	index_path: knn.index
2025-03-13 11:32:27,788 [INFO]: 	size in bytes: 366927490
2025-03-13 11:32:27,788 [INFO]: 	avg_search_speed_ms: 11.538137636129179
2025-03-13 11:32:27,788 [INFO]: 	99p_search_speed_ms: 15.366685935296118
2025-03-13 11:32:27,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:27,788 [INFO]: 	nb vectors: 1865
2025-03-13 11:32:27,788 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:27,788 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-13 11:32:27,788 [INFO]: }
2025-03-13 11:32:27,788 [INFO]: 	>>> Finished "Creating the index" in 40.4938 secs
2025-03-13 11:32:27,788 [INFO]: >>> Finished "Launching the whole pipeline" in 40.5350 secs
2025-03-13 11:32:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 100045 [episode count 19/20]
2025-03-13 11:32:28: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_duck_and_put_it_in_the_bowl [chosen_id count 2/8]
2025-03-13 11:32:30: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2023-03-04_pick_up_the_pineapple_and_put_it_in_the_bowl [chosen_id count 3/8]
2025-03-13 11:32:30: [retrieval_preprocessing] we have num_total=2137 embedding_dim=49152
[retrieval_preprocessing] for episode 100046 [episode count 0/20], we have num_retrieval=np.int64(2021) num_query=np.int64(116)
2025-03-13 11:32:30,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:30,946 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:30
2025-03-13 11:32:30,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2181.13it/s]
2025-03-13 11:32:30,972 [INFO]: There are 2021 embeddings of dim 49152
2025-03-13 11:32:30,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:32:30,972 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:30
2025-03-13 11:32:30,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:30,973 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:32:30,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:30,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:30,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:30
2025-03-13 11:32:30,973 [INFO]: 417.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:30,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:30,973 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:30
2025-03-13 11:32:30,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:30,973 [INFO]: 	Creating the index 03/13/2025, 11:32:30
2025-03-13 11:32:30,973 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:30
2025-03-13 11:32:30,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:32:30,974 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:30
2025-03-13 11:32:30,974 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:32:30,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.68it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.87it/s]100%|██████████| 8/8 [00:01<00:00,  4.45it/s]
2025-03-13 11:32:32,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:32
2025-03-13 11:32:57,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5633 secs
2025-03-13 11:32:57,342 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 11:32:57,342 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.90it/s]
2025-03-13 11:33:12,238 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8963 secs
2025-03-13 11:33:12,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2657 secs
2025-03-13 11:33:12,240 [INFO]: {
2025-03-13 11:33:12,240 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:12,240 [INFO]: 	index_param: efSearch=291
2025-03-13 11:33:12,240 [INFO]: 	index_path: knn.index
2025-03-13 11:33:12,240 [INFO]: 	size in bytes: 397619590
2025-03-13 11:33:12,240 [INFO]: 	avg_search_speed_ms: 9.934846140941847
2025-03-13 11:33:12,240 [INFO]: 	99p_search_speed_ms: 15.436562937684354
2025-03-13 11:33:12,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:12,240 [INFO]: 	nb vectors: 2021
2025-03-13 11:33:12,240 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:12,240 [INFO]: 	compression ratio: 0.9993088318410066
2025-03-13 11:33:12,240 [INFO]: }
2025-03-13 11:33:12,240 [INFO]: 	>>> Finished "Creating the index" in 41.2671 secs
2025-03-13 11:33:12,240 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2938 secs
2025-03-13 11:33:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100046 [episode count 0/20]
[retrieval_preprocessing] for episode 100047 [episode count 1/20], we have num_retrieval=np.int64(2032) num_query=np.int64(105)
2025-03-13 11:33:13,606 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:13,895 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:13
2025-03-13 11:33:13,895 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-13 11:33:13,923 [INFO]: There are 2032 embeddings of dim 49152
2025-03-13 11:33:13,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:33:13,923 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,923 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:13,923 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:33:13,923 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:13,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:13,923 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,923 [INFO]: 419.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:13,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:33:13,923 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:13
2025-03-13 11:33:13,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:13,923 [INFO]: 	Creating the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,923 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:13
2025-03-13 11:33:13,924 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:33:13,924 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:13
2025-03-13 11:33:13,924 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:33:13,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.84it/s] 75%|███████▌  | 6/8 [00:00<00:00, 32.19it/s]100%|██████████| 8/8 [00:01<00:00,  4.43it/s]
2025-03-13 11:33:15,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:15
2025-03-13 11:33:40,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6167 secs
2025-03-13 11:33:40,352 [INFO]: The best hyperparameters are: efSearch=324
2025-03-13 11:33:40,352 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.29it/s]
2025-03-13 11:33:53,145 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7938 secs
2025-03-13 11:33:53,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2225 secs
2025-03-13 11:33:53,147 [INFO]: {
2025-03-13 11:33:53,147 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:53,147 [INFO]: 	index_param: efSearch=324
2025-03-13 11:33:53,147 [INFO]: 	index_path: knn.index
2025-03-13 11:33:53,147 [INFO]: 	size in bytes: 399783790
2025-03-13 11:33:53,147 [INFO]: 	avg_search_speed_ms: 9.703991638594077
2025-03-13 11:33:53,147 [INFO]: 	99p_search_speed_ms: 13.248838670551779
2025-03-13 11:33:53,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:53,147 [INFO]: 	nb vectors: 2032
2025-03-13 11:33:53,147 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:53,147 [INFO]: 	compression ratio: 0.999308791384463
2025-03-13 11:33:53,147 [INFO]: }
2025-03-13 11:33:53,147 [INFO]: 	>>> Finished "Creating the index" in 39.2238 secs
2025-03-13 11:33:53,147 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2523 secs
2025-03-13 11:33:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100047 [episode count 1/20]
[retrieval_preprocessing] for episode 100048 [episode count 2/20], we have num_retrieval=np.int64(2025) num_query=np.int64(112)
2025-03-13 11:33:54,468 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:54,810 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:54
2025-03-13 11:33:54,810 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.12it/s]
2025-03-13 11:33:54,838 [INFO]: There are 2025 embeddings of dim 49152
2025-03-13 11:33:54,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 11:33:54,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:54,838 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:33:54,838 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:54,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:54,838 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,839 [INFO]: 417.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:54,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:33:54,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:54
2025-03-13 11:33:54,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:54,839 [INFO]: 	Creating the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,839 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:54
2025-03-13 11:33:54,840 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:33:54,840 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:54
2025-03-13 11:33:54,840 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:33:54,840 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.50it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.83it/s]100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
2025-03-13 11:33:56,582 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:56
2025-03-13 11:34:20,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5844 secs
2025-03-13 11:34:20,167 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 11:34:20,167 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 11:34:31,738 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5714 secs
2025-03-13 11:34:31,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.8999 secs
2025-03-13 11:34:31,740 [INFO]: {
2025-03-13 11:34:31,740 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:31,740 [INFO]: 	index_param: efSearch=284
2025-03-13 11:34:31,740 [INFO]: 	index_path: knn.index
2025-03-13 11:34:31,740 [INFO]: 	size in bytes: 398406610
2025-03-13 11:34:31,740 [INFO]: 	avg_search_speed_ms: 8.678814108457622
2025-03-13 11:34:31,740 [INFO]: 	99p_search_speed_ms: 11.631767745129764
2025-03-13 11:34:31,740 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:31,740 [INFO]: 	nb vectors: 2025
2025-03-13 11:34:31,740 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:31,740 [INFO]: 	compression ratio: 0.9993087213086148
2025-03-13 11:34:31,740 [INFO]: }
2025-03-13 11:34:31,740 [INFO]: 	>>> Finished "Creating the index" in 36.9016 secs
2025-03-13 11:34:31,740 [INFO]: >>> Finished "Launching the whole pipeline" in 36.9299 secs
2025-03-13 11:34:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 100048 [episode count 2/20]
[retrieval_preprocessing] for episode 100049 [episode count 3/20], we have num_retrieval=np.int64(2022) num_query=np.int64(115)
2025-03-13 11:34:33,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:33,288 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:33
2025-03-13 11:34:33,289 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1770.50it/s]
2025-03-13 11:34:33,318 [INFO]: There are 2022 embeddings of dim 49152
2025-03-13 11:34:33,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 11:34:33,318 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:33
2025-03-13 11:34:33,318 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:33,318 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:34:33,318 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:33,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:33,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:33
2025-03-13 11:34:33,318 [INFO]: 417.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:33,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:33,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:33
2025-03-13 11:34:33,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:33,318 [INFO]: 	Creating the index 03/13/2025, 11:34:33
2025-03-13 11:34:33,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:33
2025-03-13 11:34:33,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:34:33,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:33
2025-03-13 11:34:33,319 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:34:33,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.78it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]100%|██████████| 8/8 [00:01<00:00,  5.36it/s]
2025-03-13 11:34:34,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:34
2025-03-13 11:34:58,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0658 secs
2025-03-13 11:34:58,882 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 11:34:58,882 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.56it/s]
2025-03-13 11:35:13,537 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6556 secs
2025-03-13 11:35:13,539 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.2198 secs
2025-03-13 11:35:13,539 [INFO]: {
2025-03-13 11:35:13,539 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:13,539 [INFO]: 	index_param: efSearch=301
2025-03-13 11:35:13,539 [INFO]: 	index_path: knn.index
2025-03-13 11:35:13,539 [INFO]: 	size in bytes: 397816330
2025-03-13 11:35:13,539 [INFO]: 	avg_search_speed_ms: 10.791017591276134
2025-03-13 11:35:13,539 [INFO]: 	99p_search_speed_ms: 15.718244509771466
2025-03-13 11:35:13,539 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:13,539 [INFO]: 	nb vectors: 2022
2025-03-13 11:35:13,539 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:13,539 [INFO]: 	compression ratio: 0.9993088418466884
2025-03-13 11:35:13,539 [INFO]: }
2025-03-13 11:35:13,539 [INFO]: 	>>> Finished "Creating the index" in 40.2212 secs
2025-03-13 11:35:13,539 [INFO]: >>> Finished "Launching the whole pipeline" in 40.2508 secs
2025-03-13 11:35:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100049 [episode count 3/20]
[retrieval_preprocessing] for episode 100050 [episode count 4/20], we have num_retrieval=np.int64(2017) num_query=np.int64(120)
2025-03-13 11:35:14,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:15,065 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:15
2025-03-13 11:35:15,065 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-13 11:35:15,091 [INFO]: There are 2017 embeddings of dim 49152
2025-03-13 11:35:15,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:35:15,091 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:15
2025-03-13 11:35:15,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:15,091 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:35:15,091 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:15,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:15,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:15
2025-03-13 11:35:15,091 [INFO]: 416.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:15,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:35:15,092 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:15
2025-03-13 11:35:15,092 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:15,092 [INFO]: 	Creating the index 03/13/2025, 11:35:15
2025-03-13 11:35:15,092 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:15
2025-03-13 11:35:15,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:35:15,093 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:15
2025-03-13 11:35:15,093 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:35:15,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.50it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.32it/s]100%|██████████| 8/8 [00:01<00:00,  5.23it/s]
2025-03-13 11:35:16,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:16
2025-03-13 11:35:40,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5221 secs
2025-03-13 11:35:40,151 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 11:35:40,151 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.72it/s]
2025-03-13 11:35:52,782 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6312 secs
2025-03-13 11:35:52,784 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6914 secs
2025-03-13 11:35:52,784 [INFO]: {
2025-03-13 11:35:52,784 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:52,784 [INFO]: 	index_param: efSearch=321
2025-03-13 11:35:52,784 [INFO]: 	index_path: knn.index
2025-03-13 11:35:52,784 [INFO]: 	size in bytes: 396832570
2025-03-13 11:35:52,784 [INFO]: 	avg_search_speed_ms: 9.974842917096105
2025-03-13 11:35:52,784 [INFO]: 	99p_search_speed_ms: 14.50444752816111
2025-03-13 11:35:52,784 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:52,784 [INFO]: 	nb vectors: 2017
2025-03-13 11:35:52,784 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:52,784 [INFO]: 	compression ratio: 0.9993089428118261
2025-03-13 11:35:52,784 [INFO]: }
2025-03-13 11:35:52,784 [INFO]: 	>>> Finished "Creating the index" in 37.6929 secs
2025-03-13 11:35:52,784 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7197 secs
2025-03-13 11:35:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100050 [episode count 4/20]
[retrieval_preprocessing] for episode 100051 [episode count 5/20], we have num_retrieval=np.int64(2020) num_query=np.int64(117)
2025-03-13 11:35:54,513 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:54,795 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:54
2025-03-13 11:35:54,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.12it/s]
2025-03-13 11:35:54,824 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 11:35:54,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:35:54,824 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:54
2025-03-13 11:35:54,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:54,824 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:35:54,824 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:54,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:54,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:54
2025-03-13 11:35:54,825 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:54,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:35:54,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:54
2025-03-13 11:35:54,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:54,825 [INFO]: 	Creating the index 03/13/2025, 11:35:54
2025-03-13 11:35:54,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:54
2025-03-13 11:35:54,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:35:54,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:54
2025-03-13 11:35:54,826 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:35:54,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.43it/s]100%|██████████| 8/8 [00:01<00:00,  5.48it/s]100%|██████████| 8/8 [00:01<00:00,  5.78it/s]
2025-03-13 11:35:56,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:56
2025-03-13 11:36:25,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2626 secs
2025-03-13 11:36:25,476 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 11:36:25,476 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 11:36:41,139 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6634 secs
2025-03-13 11:36:41,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3151 secs
2025-03-13 11:36:41,141 [INFO]: {
2025-03-13 11:36:41,141 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:41,141 [INFO]: 	index_param: efSearch=266
2025-03-13 11:36:41,141 [INFO]: 	index_path: knn.index
2025-03-13 11:36:41,141 [INFO]: 	size in bytes: 397422850
2025-03-13 11:36:41,141 [INFO]: 	avg_search_speed_ms: 9.316960429531441
2025-03-13 11:36:41,141 [INFO]: 	99p_search_speed_ms: 14.419104745611543
2025-03-13 11:36:41,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:41,141 [INFO]: 	nb vectors: 2020
2025-03-13 11:36:41,141 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:41,141 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 11:36:41,141 [INFO]: }
2025-03-13 11:36:41,141 [INFO]: 	>>> Finished "Creating the index" in 46.3165 secs
2025-03-13 11:36:41,141 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3459 secs
2025-03-13 11:36:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100051 [episode count 5/20]
[retrieval_preprocessing] for episode 100052 [episode count 6/20], we have num_retrieval=np.int64(2043) num_query=np.int64(94)
2025-03-13 11:36:42,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:42,950 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:42
2025-03-13 11:36:42,950 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.16it/s]
2025-03-13 11:36:42,980 [INFO]: There are 2043 embeddings of dim 49152
2025-03-13 11:36:42,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 11:36:42,981 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:42
2025-03-13 11:36:42,981 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:42,981 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:36:42,981 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:42,981 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:36:42,981 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:42
2025-03-13 11:36:42,981 [INFO]: 421.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:42,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:36:42,981 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:42
2025-03-13 11:36:42,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:42,981 [INFO]: 	Creating the index 03/13/2025, 11:36:42
2025-03-13 11:36:42,981 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:42
2025-03-13 11:36:42,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:36:42,982 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:42
2025-03-13 11:36:42,982 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:36:42,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.81it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.27it/s]100%|██████████| 9/9 [00:01<00:00,  6.19it/s]
2025-03-13 11:36:44,441 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:44
2025-03-13 11:37:10,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2590 secs
2025-03-13 11:37:10,700 [INFO]: The best hyperparameters are: efSearch=323
2025-03-13 11:37:10,700 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-13 11:37:28,128 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4273 secs
2025-03-13 11:37:28,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1469 secs
2025-03-13 11:37:28,129 [INFO]: {
2025-03-13 11:37:28,129 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:28,129 [INFO]: 	index_param: efSearch=323
2025-03-13 11:37:28,129 [INFO]: 	index_path: knn.index
2025-03-13 11:37:28,130 [INFO]: 	size in bytes: 401947990
2025-03-13 11:37:28,130 [INFO]: 	avg_search_speed_ms: 10.245000050626466
2025-03-13 11:37:28,130 [INFO]: 	99p_search_speed_ms: 14.919585606548935
2025-03-13 11:37:28,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:28,130 [INFO]: 	nb vectors: 2043
2025-03-13 11:37:28,130 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:28,130 [INFO]: 	compression ratio: 0.9993087513635781
2025-03-13 11:37:28,130 [INFO]: }
2025-03-13 11:37:28,130 [INFO]: 	>>> Finished "Creating the index" in 45.1484 secs
2025-03-13 11:37:28,130 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1793 secs
2025-03-13 11:37:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 100052 [episode count 6/20]
[retrieval_preprocessing] for episode 100053 [episode count 7/20], we have num_retrieval=np.int64(2035) num_query=np.int64(102)
2025-03-13 11:37:29,156 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:29,519 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:29
2025-03-13 11:37:29,520 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.80it/s]
2025-03-13 11:37:29,558 [INFO]: There are 2035 embeddings of dim 49152
2025-03-13 11:37:29,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 11:37:29,558 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:29
2025-03-13 11:37:29,558 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:29,558 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:37:29,558 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:29,558 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:29,558 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:29
2025-03-13 11:37:29,558 [INFO]: 420.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:29,559 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:29,559 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:29
2025-03-13 11:37:29,559 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:29,559 [INFO]: 	Creating the index 03/13/2025, 11:37:29
2025-03-13 11:37:29,559 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:29
2025-03-13 11:37:29,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:29,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:29
2025-03-13 11:37:29,560 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:37:29,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.61it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.84it/s]100%|██████████| 9/9 [00:01<00:00,  5.40it/s]
2025-03-13 11:37:31,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:31
2025-03-13 11:37:55,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3073 secs
2025-03-13 11:37:55,538 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:37:55,538 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 11:38:07,850 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3116 secs
2025-03-13 11:38:07,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.2916 secs
2025-03-13 11:38:07,852 [INFO]: {
2025-03-13 11:38:07,852 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:07,852 [INFO]: 	index_param: efSearch=294
2025-03-13 11:38:07,852 [INFO]: 	index_path: knn.index
2025-03-13 11:38:07,852 [INFO]: 	size in bytes: 400374010
2025-03-13 11:38:07,852 [INFO]: 	avg_search_speed_ms: 10.827599802645109
2025-03-13 11:38:07,852 [INFO]: 	99p_search_speed_ms: 15.301176020875571
2025-03-13 11:38:07,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:07,852 [INFO]: 	nb vectors: 2035
2025-03-13 11:38:07,852 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:07,852 [INFO]: 	compression ratio: 0.9993088212693926
2025-03-13 11:38:07,852 [INFO]: }
2025-03-13 11:38:07,852 [INFO]: 	>>> Finished "Creating the index" in 38.2930 secs
2025-03-13 11:38:07,852 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3321 secs
2025-03-13 11:38:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 100053 [episode count 7/20]
[retrieval_preprocessing] for episode 100054 [episode count 8/20], we have num_retrieval=np.int64(2039) num_query=np.int64(98)
2025-03-13 11:38:09,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:09,450 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:09
2025-03-13 11:38:09,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2107.69it/s]
2025-03-13 11:38:09,475 [INFO]: There are 2039 embeddings of dim 49152
2025-03-13 11:38:09,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:38:09,475 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:09
2025-03-13 11:38:09,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:09,475 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:38:09,475 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:09,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:09,475 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:09
2025-03-13 11:38:09,475 [INFO]: 420.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:09,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:38:09,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:09
2025-03-13 11:38:09,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:09,476 [INFO]: 	Creating the index 03/13/2025, 11:38:09
2025-03-13 11:38:09,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:09
2025-03-13 11:38:09,477 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:38:09,477 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:09
2025-03-13 11:38:09,477 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:38:09,477 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.05it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.82it/s]100%|██████████| 9/9 [00:01<00:00,  6.20it/s]
2025-03-13 11:38:10,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:10
2025-03-13 11:38:34,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7009 secs
2025-03-13 11:38:34,633 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 11:38:34,633 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 11:38:47,369 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7364 secs
2025-03-13 11:38:47,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8939 secs
2025-03-13 11:38:47,371 [INFO]: {
2025-03-13 11:38:47,371 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:47,371 [INFO]: 	index_param: efSearch=229
2025-03-13 11:38:47,371 [INFO]: 	index_path: knn.index
2025-03-13 11:38:47,371 [INFO]: 	size in bytes: 401161030
2025-03-13 11:38:47,371 [INFO]: 	avg_search_speed_ms: 8.345885042922077
2025-03-13 11:38:47,371 [INFO]: 	99p_search_speed_ms: 12.04405192984268
2025-03-13 11:38:47,371 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:47,371 [INFO]: 	nb vectors: 2039
2025-03-13 11:38:47,371 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:47,371 [INFO]: 	compression ratio: 0.9993087115166696
2025-03-13 11:38:47,371 [INFO]: }
2025-03-13 11:38:47,371 [INFO]: 	>>> Finished "Creating the index" in 37.8953 secs
2025-03-13 11:38:47,371 [INFO]: >>> Finished "Launching the whole pipeline" in 37.9212 secs
2025-03-13 11:38:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 100054 [episode count 8/20]
[retrieval_preprocessing] for episode 100055 [episode count 9/20], we have num_retrieval=np.int64(2027) num_query=np.int64(110)
2025-03-13 11:38:48,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:48,748 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:48
2025-03-13 11:38:48,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2075.36it/s]
2025-03-13 11:38:48,778 [INFO]: There are 2027 embeddings of dim 49152
2025-03-13 11:38:48,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:38:48,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:48,778 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:38:48,778 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:48,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:48,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,778 [INFO]: 418.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:48,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:38:48,778 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:48
2025-03-13 11:38:48,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:48,778 [INFO]: 	Creating the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,778 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:48
2025-03-13 11:38:48,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:38:48,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,780 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:38:48,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.88it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.11it/s]100%|██████████| 8/8 [00:01<00:00,  4.67it/s]
2025-03-13 11:38:50,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:50
2025-03-13 11:39:14,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4469 secs
2025-03-13 11:39:14,944 [INFO]: The best hyperparameters are: efSearch=319
2025-03-13 11:39:14,944 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 11:39:29,725 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7807 secs
2025-03-13 11:39:29,727 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9469 secs
2025-03-13 11:39:29,727 [INFO]: {
2025-03-13 11:39:29,727 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:29,727 [INFO]: 	index_param: efSearch=319
2025-03-13 11:39:29,727 [INFO]: 	index_path: knn.index
2025-03-13 11:39:29,727 [INFO]: 	size in bytes: 398800090
2025-03-13 11:39:29,727 [INFO]: 	avg_search_speed_ms: 11.030632737600948
2025-03-13 11:39:29,727 [INFO]: 	99p_search_speed_ms: 15.280051361769438
2025-03-13 11:39:29,727 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:29,727 [INFO]: 	nb vectors: 2027
2025-03-13 11:39:29,727 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:29,727 [INFO]: 	compression ratio: 0.9993087413796722
2025-03-13 11:39:29,727 [INFO]: }
2025-03-13 11:39:29,727 [INFO]: 	>>> Finished "Creating the index" in 40.9486 secs
2025-03-13 11:39:29,727 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9786 secs
2025-03-13 11:39:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 100055 [episode count 9/20]
[retrieval_preprocessing] for episode 100056 [episode count 10/20], we have num_retrieval=np.int64(2037) num_query=np.int64(100)
2025-03-13 11:39:31,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:31,619 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:31
2025-03-13 11:39:31,619 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.74it/s]
2025-03-13 11:39:31,644 [INFO]: There are 2037 embeddings of dim 49152
2025-03-13 11:39:31,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:39:31,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:31
2025-03-13 11:39:31,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:31,644 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:39:31,644 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:31,644 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:39:31,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:31
2025-03-13 11:39:31,645 [INFO]: 420.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:31,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:39:31,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:31
2025-03-13 11:39:31,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:31,645 [INFO]: 	Creating the index 03/13/2025, 11:39:31
2025-03-13 11:39:31,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:31
2025-03-13 11:39:31,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:39:31,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:31
2025-03-13 11:39:31,646 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:39:31,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.67it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.57it/s]100%|██████████| 9/9 [00:01<00:00,  6.12it/s]
2025-03-13 11:39:33,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:33
2025-03-13 11:39:56,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0291 secs
2025-03-13 11:39:56,149 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 11:39:56,150 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 11:40:11,399 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2492 secs
2025-03-13 11:40:11,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7543 secs
2025-03-13 11:40:11,400 [INFO]: {
2025-03-13 11:40:11,400 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:11,400 [INFO]: 	index_param: efSearch=279
2025-03-13 11:40:11,400 [INFO]: 	index_path: knn.index
2025-03-13 11:40:11,400 [INFO]: 	size in bytes: 400767550
2025-03-13 11:40:11,400 [INFO]: 	avg_search_speed_ms: 9.302782355916015
2025-03-13 11:40:11,400 [INFO]: 	99p_search_speed_ms: 14.463497726246715
2025-03-13 11:40:11,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:11,400 [INFO]: 	nb vectors: 2037
2025-03-13 11:40:11,400 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:11,400 [INFO]: 	compression ratio: 0.9993086915345317
2025-03-13 11:40:11,400 [INFO]: }
2025-03-13 11:40:11,400 [INFO]: 	>>> Finished "Creating the index" in 39.7556 secs
2025-03-13 11:40:11,400 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7816 secs
2025-03-13 11:40:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 100056 [episode count 10/20]
[retrieval_preprocessing] for episode 100057 [episode count 11/20], we have num_retrieval=np.int64(2036) num_query=np.int64(101)
2025-03-13 11:40:12,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:12,762 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:12
2025-03-13 11:40:12,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1677.72it/s]
2025-03-13 11:40:12,793 [INFO]: There are 2036 embeddings of dim 49152
2025-03-13 11:40:12,793 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 11:40:12,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:12
2025-03-13 11:40:12,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:12,793 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:40:12,793 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:12,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:12,794 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:12
2025-03-13 11:40:12,794 [INFO]: 420.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:12,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:40:12,794 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:12
2025-03-13 11:40:12,794 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:12,794 [INFO]: 	Creating the index 03/13/2025, 11:40:12
2025-03-13 11:40:12,794 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:12
2025-03-13 11:40:12,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:40:12,795 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:12
2025-03-13 11:40:12,795 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:40:12,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.30it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.94it/s]100%|██████████| 9/9 [00:01<00:00,  6.55it/s]
2025-03-13 11:40:14,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:14
2025-03-13 11:40:38,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9419 secs
2025-03-13 11:40:38,114 [INFO]: The best hyperparameters are: efSearch=344
2025-03-13 11:40:38,114 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.01it/s]
2025-03-13 11:40:54,410 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2954 secs
2025-03-13 11:40:54,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6163 secs
2025-03-13 11:40:54,412 [INFO]: {
2025-03-13 11:40:54,412 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:54,412 [INFO]: 	index_param: efSearch=344
2025-03-13 11:40:54,412 [INFO]: 	index_path: knn.index
2025-03-13 11:40:54,412 [INFO]: 	size in bytes: 400570810
2025-03-13 11:40:54,412 [INFO]: 	avg_search_speed_ms: 10.59392115379431
2025-03-13 11:40:54,412 [INFO]: 	99p_search_speed_ms: 14.17279923567548
2025-03-13 11:40:54,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:54,412 [INFO]: 	nb vectors: 2036
2025-03-13 11:40:54,412 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:54,412 [INFO]: 	compression ratio: 0.9993086815287414
2025-03-13 11:40:54,412 [INFO]: }
2025-03-13 11:40:54,412 [INFO]: 	>>> Finished "Creating the index" in 41.6185 secs
2025-03-13 11:40:54,412 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6499 secs
2025-03-13 11:40:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 100057 [episode count 11/20]
[retrieval_preprocessing] for episode 100058 [episode count 12/20], we have num_retrieval=np.int64(2038) num_query=np.int64(99)
2025-03-13 11:40:55,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:56,218 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:56
2025-03-13 11:40:56,218 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2222.74it/s]
2025-03-13 11:40:56,239 [INFO]: There are 2038 embeddings of dim 49152
2025-03-13 11:40:56,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0207 secs
2025-03-13 11:40:56,239 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:56,239 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:40:56,239 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:56,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:56,239 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,240 [INFO]: 420.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:56,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:40:56,240 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:56
2025-03-13 11:40:56,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:56,240 [INFO]: 	Creating the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,240 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:56
2025-03-13 11:40:56,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:40:56,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,241 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:40:56,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.19it/s] 89%|████████▉ | 8/9 [00:00<00:00, 37.56it/s]100%|██████████| 9/9 [00:01<00:00,  5.71it/s]
2025-03-13 11:40:57,820 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:57
2025-03-13 11:41:23,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3591 secs
2025-03-13 11:41:23,179 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 11:41:23,179 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.62it/s]
2025-03-13 11:41:35,535 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3554 secs
2025-03-13 11:41:35,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2957 secs
2025-03-13 11:41:35,536 [INFO]: {
2025-03-13 11:41:35,536 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:35,537 [INFO]: 	index_param: efSearch=317
2025-03-13 11:41:35,537 [INFO]: 	index_path: knn.index
2025-03-13 11:41:35,537 [INFO]: 	size in bytes: 400964290
2025-03-13 11:41:35,537 [INFO]: 	avg_search_speed_ms: 11.039901906408566
2025-03-13 11:41:35,537 [INFO]: 	99p_search_speed_ms: 14.821115136146549
2025-03-13 11:41:35,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:35,537 [INFO]: 	nb vectors: 2038
2025-03-13 11:41:35,537 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:35,537 [INFO]: 	compression ratio: 0.9993087015305029
2025-03-13 11:41:35,537 [INFO]: }
2025-03-13 11:41:35,537 [INFO]: 	>>> Finished "Creating the index" in 39.2970 secs
2025-03-13 11:41:35,537 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3182 secs
2025-03-13 11:41:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 100058 [episode count 12/20]
[retrieval_preprocessing] for episode 100059 [episode count 13/20], we have num_retrieval=np.int64(2020) num_query=np.int64(117)
2025-03-13 11:41:36,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:37,232 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:37
2025-03-13 11:41:37,232 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1190.89it/s]
2025-03-13 11:41:37,262 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 11:41:37,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 11:41:37,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:37,262 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:41:37,262 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:37,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:41:37,263 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,263 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:37,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:41:37,263 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:37
2025-03-13 11:41:37,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:37,264 [INFO]: 	Creating the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:37
2025-03-13 11:41:37,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 11:41:37,266 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:37
2025-03-13 11:41:37,266 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:41:37,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.10it/s]100%|██████████| 8/8 [00:01<00:00,  5.23it/s]100%|██████████| 8/8 [00:01<00:00,  5.74it/s]
2025-03-13 11:41:38,665 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:38
2025-03-13 11:42:03,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2431 secs
2025-03-13 11:42:03,909 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 11:42:03,909 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s]
2025-03-13 11:42:16,827 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9174 secs
2025-03-13 11:42:16,828 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5617 secs
2025-03-13 11:42:16,828 [INFO]: {
2025-03-13 11:42:16,828 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:16,828 [INFO]: 	index_param: efSearch=300
2025-03-13 11:42:16,828 [INFO]: 	index_path: knn.index
2025-03-13 11:42:16,828 [INFO]: 	size in bytes: 397422850
2025-03-13 11:42:16,828 [INFO]: 	avg_search_speed_ms: 11.096914534764023
2025-03-13 11:42:16,828 [INFO]: 	99p_search_speed_ms: 16.700448002666235
2025-03-13 11:42:16,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:16,828 [INFO]: 	nb vectors: 2020
2025-03-13 11:42:16,828 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:16,828 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 11:42:16,828 [INFO]: }
2025-03-13 11:42:16,828 [INFO]: 	>>> Finished "Creating the index" in 39.5648 secs
2025-03-13 11:42:16,828 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5967 secs
2025-03-13 11:42:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100059 [episode count 13/20]
[retrieval_preprocessing] for episode 100060 [episode count 14/20], we have num_retrieval=np.int64(2034) num_query=np.int64(103)
2025-03-13 11:42:18,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:18,473 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:18
2025-03-13 11:42:18,473 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.35it/s]
2025-03-13 11:42:18,500 [INFO]: There are 2034 embeddings of dim 49152
2025-03-13 11:42:18,500 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 11:42:18,501 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:18
2025-03-13 11:42:18,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:18,501 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:42:18,501 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:18,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:42:18,501 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:18
2025-03-13 11:42:18,501 [INFO]: 419.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:18,501 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:42:18,501 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:18
2025-03-13 11:42:18,501 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:18,501 [INFO]: 	Creating the index 03/13/2025, 11:42:18
2025-03-13 11:42:18,501 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:18
2025-03-13 11:42:18,502 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:42:18,502 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:18
2025-03-13 11:42:18,502 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:42:18,502 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.68it/s] 89%|████████▉ | 8/9 [00:00<00:00, 40.01it/s]100%|██████████| 9/9 [00:01<00:00,  6.64it/s]
2025-03-13 11:42:19,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:19
2025-03-13 11:42:44,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2888 secs
2025-03-13 11:42:44,151 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 11:42:44,151 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.69it/s]
2025-03-13 11:42:58,880 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7284 secs
2025-03-13 11:42:58,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3791 secs
2025-03-13 11:42:58,881 [INFO]: {
2025-03-13 11:42:58,881 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:58,881 [INFO]: 	index_param: efSearch=226
2025-03-13 11:42:58,881 [INFO]: 	index_path: knn.index
2025-03-13 11:42:58,882 [INFO]: 	size in bytes: 400177270
2025-03-13 11:42:58,882 [INFO]: 	avg_search_speed_ms: 7.878227309097071
2025-03-13 11:42:58,882 [INFO]: 	99p_search_speed_ms: 12.342982599511732
2025-03-13 11:42:58,882 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:58,882 [INFO]: 	nb vectors: 2034
2025-03-13 11:42:58,882 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:58,882 [INFO]: 	compression ratio: 0.9993088113175443
2025-03-13 11:42:58,882 [INFO]: }
2025-03-13 11:42:58,882 [INFO]: 	>>> Finished "Creating the index" in 40.3806 secs
2025-03-13 11:42:58,882 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4085 secs
2025-03-13 11:42:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100060 [episode count 14/20]
[retrieval_preprocessing] for episode 100061 [episode count 15/20], we have num_retrieval=np.int64(2028) num_query=np.int64(109)
2025-03-13 11:42:59,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:00,318 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:00
2025-03-13 11:43:00,318 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.52it/s]
2025-03-13 11:43:00,348 [INFO]: There are 2028 embeddings of dim 49152
2025-03-13 11:43:00,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:43:00,348 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:00
2025-03-13 11:43:00,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:00,349 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:43:00,349 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:00,349 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:43:00,349 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:00
2025-03-13 11:43:00,349 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:00,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:43:00,349 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:00
2025-03-13 11:43:00,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:00,349 [INFO]: 	Creating the index 03/13/2025, 11:43:00
2025-03-13 11:43:00,349 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:00
2025-03-13 11:43:00,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:43:00,350 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:00
2025-03-13 11:43:00,350 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:43:00,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.39it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.15it/s]100%|██████████| 8/8 [00:01<00:00,  4.81it/s]
2025-03-13 11:43:02,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:02
2025-03-13 11:43:27,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4235 secs
2025-03-13 11:43:27,863 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 11:43:27,863 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 11:43:40,785 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9219 secs
2025-03-13 11:43:40,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4367 secs
2025-03-13 11:43:40,787 [INFO]: {
2025-03-13 11:43:40,787 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:40,787 [INFO]: 	index_param: efSearch=299
2025-03-13 11:43:40,787 [INFO]: 	index_path: knn.index
2025-03-13 11:43:40,787 [INFO]: 	size in bytes: 398996830
2025-03-13 11:43:40,787 [INFO]: 	avg_search_speed_ms: 10.12105007325054
2025-03-13 11:43:40,787 [INFO]: 	99p_search_speed_ms: 13.856487951707095
2025-03-13 11:43:40,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:40,787 [INFO]: 	nb vectors: 2028
2025-03-13 11:43:40,787 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:40,787 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-13 11:43:40,787 [INFO]: }
2025-03-13 11:43:40,787 [INFO]: 	>>> Finished "Creating the index" in 40.4382 secs
2025-03-13 11:43:40,787 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4689 secs
2025-03-13 11:43:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 100061 [episode count 15/20]
[retrieval_preprocessing] for episode 100062 [episode count 16/20], we have num_retrieval=np.int64(2028) num_query=np.int64(109)
2025-03-13 11:43:42,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:42,385 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:42
2025-03-13 11:43:42,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.13it/s]
2025-03-13 11:43:42,413 [INFO]: There are 2028 embeddings of dim 49152
2025-03-13 11:43:42,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 11:43:42,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:42
2025-03-13 11:43:42,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:42,414 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:43:42,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:42,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:43:42,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:42
2025-03-13 11:43:42,415 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:42,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:43:42,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:42
2025-03-13 11:43:42,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:42,416 [INFO]: 	Creating the index 03/13/2025, 11:43:42
2025-03-13 11:43:42,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:42
2025-03-13 11:43:42,419 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:43:42,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:42
2025-03-13 11:43:42,420 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:43:42,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 24.69it/s]100%|██████████| 8/8 [00:01<00:00,  4.13it/s]100%|██████████| 8/8 [00:01<00:00,  4.56it/s]
2025-03-13 11:43:44,182 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:44
2025-03-13 11:44:08,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7971 secs
2025-03-13 11:44:08,979 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 11:44:08,979 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.61it/s]
2025-03-13 11:44:25,852 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8726 secs
2025-03-13 11:44:25,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4337 secs
2025-03-13 11:44:25,854 [INFO]: {
2025-03-13 11:44:25,854 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:25,854 [INFO]: 	index_param: efSearch=257
2025-03-13 11:44:25,854 [INFO]: 	index_path: knn.index
2025-03-13 11:44:25,854 [INFO]: 	size in bytes: 398996830
2025-03-13 11:44:25,854 [INFO]: 	avg_search_speed_ms: 8.506042811327431
2025-03-13 11:44:25,854 [INFO]: 	99p_search_speed_ms: 11.781659617554396
2025-03-13 11:44:25,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:25,854 [INFO]: 	nb vectors: 2028
2025-03-13 11:44:25,854 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:25,854 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-13 11:44:25,854 [INFO]: }
2025-03-13 11:44:25,854 [INFO]: 	>>> Finished "Creating the index" in 43.4377 secs
2025-03-13 11:44:25,854 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4692 secs
2025-03-13 11:44:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 100062 [episode count 16/20]
[retrieval_preprocessing] for episode 100063 [episode count 17/20], we have num_retrieval=np.int64(2037) num_query=np.int64(100)
2025-03-13 11:44:27,961 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:28,272 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:28
2025-03-13 11:44:28,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1668.38it/s]
2025-03-13 11:44:28,297 [INFO]: There are 2037 embeddings of dim 49152
2025-03-13 11:44:28,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:44:28,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:28
2025-03-13 11:44:28,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:28,297 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:44:28,297 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:28,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:28,297 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:28
2025-03-13 11:44:28,297 [INFO]: 420.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:28,297 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:44:28,297 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:28
2025-03-13 11:44:28,297 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:28,297 [INFO]: 	Creating the index 03/13/2025, 11:44:28
2025-03-13 11:44:28,297 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:28
2025-03-13 11:44:28,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:44:28,299 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:28
2025-03-13 11:44:28,299 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:44:28,299 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.49it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.88it/s]100%|██████████| 9/9 [00:01<00:00,  3.94it/s]100%|██████████| 9/9 [00:01<00:00,  4.61it/s]
2025-03-13 11:44:30,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:30
2025-03-13 11:44:56,520 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2652 secs
2025-03-13 11:44:56,521 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 11:44:56,521 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.20it/s]
2025-03-13 11:45:09,825 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3039 secs
2025-03-13 11:45:09,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5277 secs
2025-03-13 11:45:09,826 [INFO]: {
2025-03-13 11:45:09,826 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:09,826 [INFO]: 	index_param: efSearch=317
2025-03-13 11:45:09,826 [INFO]: 	index_path: knn.index
2025-03-13 11:45:09,827 [INFO]: 	size in bytes: 400767550
2025-03-13 11:45:09,827 [INFO]: 	avg_search_speed_ms: 10.351617425279095
2025-03-13 11:45:09,827 [INFO]: 	99p_search_speed_ms: 14.274139422923326
2025-03-13 11:45:09,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:09,827 [INFO]: 	nb vectors: 2037
2025-03-13 11:45:09,827 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:09,827 [INFO]: 	compression ratio: 0.9993086915345317
2025-03-13 11:45:09,827 [INFO]: }
2025-03-13 11:45:09,827 [INFO]: 	>>> Finished "Creating the index" in 41.5292 secs
2025-03-13 11:45:09,827 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5549 secs
2025-03-13 11:45:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 100063 [episode count 17/20]
[retrieval_preprocessing] for episode 100064 [episode count 18/20], we have num_retrieval=np.int64(2031) num_query=np.int64(106)
2025-03-13 11:45:10,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:11,288 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:11
2025-03-13 11:45:11,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-13 11:45:11,316 [INFO]: There are 2031 embeddings of dim 49152
2025-03-13 11:45:11,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 11:45:11,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:11
2025-03-13 11:45:11,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:11,317 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:45:11,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:11,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:11,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:11
2025-03-13 11:45:11,317 [INFO]: 419.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:11,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:45:11,317 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:11
2025-03-13 11:45:11,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:11,317 [INFO]: 	Creating the index 03/13/2025, 11:45:11
2025-03-13 11:45:11,317 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:11
2025-03-13 11:45:11,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:45:11,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:11
2025-03-13 11:45:11,318 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:45:11,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.65it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.63it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]
2025-03-13 11:45:12,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:12
2025-03-13 11:45:44,054 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2997 secs
2025-03-13 11:45:44,055 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 11:45:44,055 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.92it/s]
2025-03-13 11:46:04,758 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7037 secs
2025-03-13 11:46:04,760 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4416 secs
2025-03-13 11:46:04,760 [INFO]: {
2025-03-13 11:46:04,760 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:04,760 [INFO]: 	index_param: efSearch=239
2025-03-13 11:46:04,760 [INFO]: 	index_path: knn.index
2025-03-13 11:46:04,760 [INFO]: 	size in bytes: 399587050
2025-03-13 11:46:04,760 [INFO]: 	avg_search_speed_ms: 8.132780337047468
2025-03-13 11:46:04,760 [INFO]: 	99p_search_speed_ms: 12.635339824482806
2025-03-13 11:46:04,760 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:04,760 [INFO]: 	nb vectors: 2031
2025-03-13 11:46:04,760 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:04,760 [INFO]: 	compression ratio: 0.9993087814032011
2025-03-13 11:46:04,760 [INFO]: }
2025-03-13 11:46:04,760 [INFO]: 	>>> Finished "Creating the index" in 53.4431 secs
2025-03-13 11:46:04,760 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4723 secs
2025-03-13 11:46:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 100064 [episode count 18/20]
[retrieval_preprocessing] for episode 100065 [episode count 19/20], we have num_retrieval=np.int64(2033) num_query=np.int64(104)
2025-03-13 11:46:06,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:06,415 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:06
2025-03-13 11:46:06,415 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.69it/s]
2025-03-13 11:46:06,451 [INFO]: There are 2033 embeddings of dim 49152
2025-03-13 11:46:06,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 11:46:06,451 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:06
2025-03-13 11:46:06,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:06,451 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:46:06,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:06,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:46:06,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:06
2025-03-13 11:46:06,451 [INFO]: 419.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:06,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:46:06,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:06
2025-03-13 11:46:06,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:06,452 [INFO]: 	Creating the index 03/13/2025, 11:46:06
2025-03-13 11:46:06,452 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:06
2025-03-13 11:46:06,453 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:46:06,453 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:06
2025-03-13 11:46:06,453 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:46:06,453 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.36it/s] 56%|█████▌    | 5/9 [00:00<00:00, 26.57it/s]100%|██████████| 9/9 [00:01<00:00,  4.59it/s]100%|██████████| 9/9 [00:01<00:00,  5.37it/s]
2025-03-13 11:46:08,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:08
2025-03-13 11:46:32,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8008 secs
2025-03-13 11:46:32,934 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 11:46:32,934 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 11:46:46,192 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2575 secs
2025-03-13 11:46:46,193 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7402 secs
2025-03-13 11:46:46,193 [INFO]: {
2025-03-13 11:46:46,193 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:46,193 [INFO]: 	index_param: efSearch=303
2025-03-13 11:46:46,193 [INFO]: 	index_path: knn.index
2025-03-13 11:46:46,193 [INFO]: 	size in bytes: 399980530
2025-03-13 11:46:46,193 [INFO]: 	avg_search_speed_ms: 10.046410510161271
2025-03-13 11:46:46,194 [INFO]: 	99p_search_speed_ms: 15.453675738535809
2025-03-13 11:46:46,194 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:46,194 [INFO]: 	nb vectors: 2033
2025-03-13 11:46:46,194 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:46,194 [INFO]: 	compression ratio: 0.999308801355906
2025-03-13 11:46:46,194 [INFO]: }
2025-03-13 11:46:46,194 [INFO]: 	>>> Finished "Creating the index" in 39.7420 secs
2025-03-13 11:46:46,194 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7784 secs
2025-03-13 11:46:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100065 [episode count 19/20]
2025-03-13 11:46:47: [retrieval_preprocessing] finished for collected_demos_training/2023-03-04_pick_up_the_pineapple_and_put_it_in_the_bowl [chosen_id count 3/8]
2025-03-13 11:46:48: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_the_jug_to_the_left [chosen_id count 4/8]
2025-03-13 11:46:48: [retrieval_preprocessing] we have num_total=1973 embedding_dim=49152
[retrieval_preprocessing] for episode 100066 [episode count 0/20], we have num_retrieval=np.int64(1828) num_query=np.int64(145)
2025-03-13 11:46:48,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:48,756 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:48
2025-03-13 11:46:48,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.31it/s]
2025-03-13 11:46:48,783 [INFO]: There are 1828 embeddings of dim 49152
2025-03-13 11:46:48,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 11:46:48,784 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:48
2025-03-13 11:46:48,784 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:48,784 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:46:48,784 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:48,784 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:46:48,784 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:48
2025-03-13 11:46:48,784 [INFO]: 377.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:48,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:46:48,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:48
2025-03-13 11:46:48,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:48,785 [INFO]: 	Creating the index 03/13/2025, 11:46:48
2025-03-13 11:46:48,785 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:48
2025-03-13 11:46:48,788 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:46:48,788 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:48
2025-03-13 11:46:48,789 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:46:48,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.53it/s]100%|██████████| 8/8 [00:01<00:00,  5.80it/s]100%|██████████| 8/8 [00:01<00:00,  6.37it/s]
2025-03-13 11:46:50,050 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:50
2025-03-13 11:47:22,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9663 secs
2025-03-13 11:47:22,017 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 11:47:22,017 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 11:47:36,755 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7376 secs
2025-03-13 11:47:36,757 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9680 secs
2025-03-13 11:47:36,757 [INFO]: {
2025-03-13 11:47:36,757 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:36,757 [INFO]: 	index_param: efSearch=186
2025-03-13 11:47:36,757 [INFO]: 	index_path: knn.index
2025-03-13 11:47:36,757 [INFO]: 	size in bytes: 359647930
2025-03-13 11:47:36,757 [INFO]: 	avg_search_speed_ms: 9.803379363809512
2025-03-13 11:47:36,757 [INFO]: 	99p_search_speed_ms: 15.104403002187608
2025-03-13 11:47:36,757 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:36,757 [INFO]: 	nb vectors: 1828
2025-03-13 11:47:36,757 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:36,757 [INFO]: 	compression ratio: 0.9993090298058993
2025-03-13 11:47:36,757 [INFO]: }
2025-03-13 11:47:36,757 [INFO]: 	>>> Finished "Creating the index" in 47.9718 secs
2025-03-13 11:47:36,757 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0009 secs
2025-03-13 11:47:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 100066 [episode count 0/20]
[retrieval_preprocessing] for episode 100067 [episode count 1/20], we have num_retrieval=np.int64(1862) num_query=np.int64(111)
2025-03-13 11:47:38,258 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:38,625 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:38
2025-03-13 11:47:38,625 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.38it/s]
2025-03-13 11:47:38,663 [INFO]: There are 1862 embeddings of dim 49152
2025-03-13 11:47:38,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0381 secs
2025-03-13 11:47:38,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:38
2025-03-13 11:47:38,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:38,664 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:47:38,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:38,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:38,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:38
2025-03-13 11:47:38,664 [INFO]: 384.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:38,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:47:38,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:38
2025-03-13 11:47:38,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:38,664 [INFO]: 	Creating the index 03/13/2025, 11:47:38
2025-03-13 11:47:38,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:38
2025-03-13 11:47:38,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:47:38,666 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:38
2025-03-13 11:47:38,666 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:47:38,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.53it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.07it/s]100%|██████████| 8/8 [00:01<00:00,  4.80it/s]
2025-03-13 11:47:40,336 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:40
2025-03-13 11:48:04,171 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8349 secs
2025-03-13 11:48:04,172 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 11:48:04,172 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
2025-03-13 11:48:17,325 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1532 secs
2025-03-13 11:48:17,327 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.6610 secs
2025-03-13 11:48:17,327 [INFO]: {
2025-03-13 11:48:17,327 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:17,327 [INFO]: 	index_param: efSearch=195
2025-03-13 11:48:17,327 [INFO]: 	index_path: knn.index
2025-03-13 11:48:17,327 [INFO]: 	size in bytes: 366337270
2025-03-13 11:48:17,327 [INFO]: 	avg_search_speed_ms: 8.805313268528831
2025-03-13 11:48:17,327 [INFO]: 	99p_search_speed_ms: 12.208984047174456
2025-03-13 11:48:17,327 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:17,327 [INFO]: 	nb vectors: 1862
2025-03-13 11:48:17,327 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:17,327 [INFO]: 	compression ratio: 0.9993089046058568
2025-03-13 11:48:17,327 [INFO]: }
2025-03-13 11:48:17,327 [INFO]: 	>>> Finished "Creating the index" in 38.6628 secs
2025-03-13 11:48:17,327 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7016 secs
2025-03-13 11:48:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:48:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100067 [episode count 1/20]
[retrieval_preprocessing] for episode 100068 [episode count 2/20], we have num_retrieval=np.int64(1844) num_query=np.int64(129)
2025-03-13 11:48:18,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:18,522 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:18
2025-03-13 11:48:18,522 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-13 11:48:18,554 [INFO]: There are 1844 embeddings of dim 49152
2025-03-13 11:48:18,555 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 11:48:18,555 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:18
2025-03-13 11:48:18,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:18,556 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:48:18,556 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:18,556 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:48:18,556 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:18
2025-03-13 11:48:18,556 [INFO]: 380.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:18,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:48:18,557 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:18
2025-03-13 11:48:18,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:18,557 [INFO]: 	Creating the index 03/13/2025, 11:48:18
2025-03-13 11:48:18,557 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:18
2025-03-13 11:48:18,561 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:48:18,561 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:18
2025-03-13 11:48:18,561 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:48:18,561 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.16it/s]100%|██████████| 8/8 [00:01<00:00,  4.59it/s]100%|██████████| 8/8 [00:01<00:00,  5.05it/s]
2025-03-13 11:48:20,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:20
2025-03-13 11:48:40,806 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6544 secs
2025-03-13 11:48:40,806 [INFO]: The best hyperparameters are: efSearch=306
2025-03-13 11:48:40,806 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.36it/s]
2025-03-13 11:48:55,042 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2362 secs
2025-03-13 11:48:55,514 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.9531 secs
2025-03-13 11:48:55,515 [INFO]: {
2025-03-13 11:48:55,515 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:55,515 [INFO]: 	index_param: efSearch=306
2025-03-13 11:48:55,515 [INFO]: 	index_path: knn.index
2025-03-13 11:48:55,515 [INFO]: 	size in bytes: 362795770
2025-03-13 11:48:55,515 [INFO]: 	avg_search_speed_ms: 10.954466456116911
2025-03-13 11:48:55,515 [INFO]: 	99p_search_speed_ms: 14.124109949916601
2025-03-13 11:48:55,515 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:55,515 [INFO]: 	nb vectors: 1844
2025-03-13 11:48:55,515 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:55,515 [INFO]: 	compression ratio: 0.9993092036326664
2025-03-13 11:48:55,515 [INFO]: }
2025-03-13 11:48:55,515 [INFO]: 	>>> Finished "Creating the index" in 36.9583 secs
2025-03-13 11:48:55,515 [INFO]: >>> Finished "Launching the whole pipeline" in 36.9932 secs
2025-03-13 11:48:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:48:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 100068 [episode count 2/20]
[retrieval_preprocessing] for episode 100069 [episode count 3/20], we have num_retrieval=np.int64(1888) num_query=np.int64(85)
2025-03-13 11:48:57,140 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:57,453 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:57
2025-03-13 11:48:57,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.88it/s]
2025-03-13 11:48:57,480 [INFO]: There are 1888 embeddings of dim 49152
2025-03-13 11:48:57,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:48:57,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:57,480 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:48:57,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:57,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:48:57,481 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,481 [INFO]: 389.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:57,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:48:57,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:57
2025-03-13 11:48:57,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:57,481 [INFO]: 	Creating the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:57
2025-03-13 11:48:57,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:48:57,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,482 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:48:57,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.24it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.15it/s]100%|██████████| 8/8 [00:01<00:00,  4.61it/s]
2025-03-13 11:48:59,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:59
2025-03-13 11:49:26,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6653 secs
2025-03-13 11:49:26,886 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 11:49:26,886 [INFO]: 	Compute fast metrics 03/13/2025, 11:49:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 11:49:41,508 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6216 secs
2025-03-13 11:49:41,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0277 secs
2025-03-13 11:49:41,510 [INFO]: {
2025-03-13 11:49:41,510 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:41,510 [INFO]: 	index_param: efSearch=243
2025-03-13 11:49:41,510 [INFO]: 	index_path: knn.index
2025-03-13 11:49:41,510 [INFO]: 	size in bytes: 371452750
2025-03-13 11:49:41,510 [INFO]: 	avg_search_speed_ms: 10.203503694252245
2025-03-13 11:49:41,510 [INFO]: 	99p_search_speed_ms: 13.523752090986822
2025-03-13 11:49:41,510 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:41,510 [INFO]: 	nb vectors: 1888
2025-03-13 11:49:41,510 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:41,510 [INFO]: 	compression ratio: 0.9993085365500727
2025-03-13 11:49:41,510 [INFO]: }
2025-03-13 11:49:41,510 [INFO]: 	>>> Finished "Creating the index" in 44.0290 secs
2025-03-13 11:49:41,510 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0563 secs
2025-03-13 11:49:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100069 [episode count 3/20]
[retrieval_preprocessing] for episode 100070 [episode count 4/20], we have num_retrieval=np.int64(1872) num_query=np.int64(101)
2025-03-13 11:49:42,678 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:42,991 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:42
2025-03-13 11:49:42,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.98it/s]
2025-03-13 11:49:43,022 [INFO]: There are 1872 embeddings of dim 49152
2025-03-13 11:49:43,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 11:49:43,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:43
2025-03-13 11:49:43,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:43,023 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:49:43,023 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:43,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:43,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:43
2025-03-13 11:49:43,023 [INFO]: 386.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:43,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:49:43,023 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:43
2025-03-13 11:49:43,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:43,023 [INFO]: 	Creating the index 03/13/2025, 11:49:43
2025-03-13 11:49:43,023 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:43
2025-03-13 11:49:43,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:49:43,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:43
2025-03-13 11:49:43,025 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:49:43,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.70it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.51it/s]100%|██████████| 8/8 [00:01<00:00,  5.29it/s]
2025-03-13 11:49:44,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:44
2025-03-13 11:50:09,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9397 secs
2025-03-13 11:50:09,482 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 11:50:09,482 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.29it/s]
2025-03-13 11:50:29,608 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1267 secs
2025-03-13 11:50:29,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5850 secs
2025-03-13 11:50:29,610 [INFO]: {
2025-03-13 11:50:29,610 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:29,610 [INFO]: 	index_param: efSearch=179
2025-03-13 11:50:29,610 [INFO]: 	index_path: knn.index
2025-03-13 11:50:29,610 [INFO]: 	size in bytes: 368304730
2025-03-13 11:50:29,610 [INFO]: 	avg_search_speed_ms: 6.611916647112815
2025-03-13 11:50:29,610 [INFO]: 	99p_search_speed_ms: 9.727629099506888
2025-03-13 11:50:29,610 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:29,610 [INFO]: 	nb vectors: 1872
2025-03-13 11:50:29,610 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:29,610 [INFO]: 	compression ratio: 0.9993088494953621
2025-03-13 11:50:29,610 [INFO]: }
2025-03-13 11:50:29,610 [INFO]: 	>>> Finished "Creating the index" in 46.5867 secs
2025-03-13 11:50:29,610 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6186 secs
2025-03-13 11:50:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100070 [episode count 4/20]
[retrieval_preprocessing] for episode 100071 [episode count 5/20], we have num_retrieval=np.int64(1873) num_query=np.int64(100)
2025-03-13 11:50:30,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:30,651 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:30
2025-03-13 11:50:30,651 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1517.48it/s]
2025-03-13 11:50:30,675 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 11:50:30,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 11:50:30,675 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:30
2025-03-13 11:50:30,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:30,675 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:50:30,675 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:30,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:50:30,675 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:30
2025-03-13 11:50:30,676 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:30,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:50:30,676 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:30
2025-03-13 11:50:30,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:30,676 [INFO]: 	Creating the index 03/13/2025, 11:50:30
2025-03-13 11:50:30,676 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:30
2025-03-13 11:50:30,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:50:30,677 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:30
2025-03-13 11:50:30,677 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:50:30,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.98it/s]100%|██████████| 8/8 [00:01<00:00,  6.07it/s]100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
2025-03-13 11:50:31,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:31
2025-03-13 11:50:54,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3675 secs
2025-03-13 11:50:54,253 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 11:50:54,253 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 11:51:07,205 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9520 secs
2025-03-13 11:51:07,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.5298 secs
2025-03-13 11:51:07,207 [INFO]: {
2025-03-13 11:51:07,207 [INFO]: 	index_key: HNSW15
2025-03-13 11:51:07,207 [INFO]: 	index_param: efSearch=196
2025-03-13 11:51:07,207 [INFO]: 	index_path: knn.index
2025-03-13 11:51:07,207 [INFO]: 	size in bytes: 368501470
2025-03-13 11:51:07,207 [INFO]: 	avg_search_speed_ms: 11.18652495165966
2025-03-13 11:51:07,207 [INFO]: 	99p_search_speed_ms: 20.108015551231798
2025-03-13 11:51:07,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:07,207 [INFO]: 	nb vectors: 1873
2025-03-13 11:51:07,207 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:07,207 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 11:51:07,207 [INFO]: }
2025-03-13 11:51:07,207 [INFO]: 	>>> Finished "Creating the index" in 36.5313 secs
2025-03-13 11:51:07,207 [INFO]: >>> Finished "Launching the whole pipeline" in 36.5556 secs
2025-03-13 11:51:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 100071 [episode count 5/20]
[retrieval_preprocessing] for episode 100072 [episode count 6/20], we have num_retrieval=np.int64(1876) num_query=np.int64(97)
2025-03-13 11:51:08,263 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:51:08,528 [INFO]: Launching the whole pipeline 03/13/2025, 11:51:08
2025-03-13 11:51:08,528 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:51:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2016.49it/s]
2025-03-13 11:51:08,559 [INFO]: There are 1876 embeddings of dim 49152
2025-03-13 11:51:08,559 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:51:08,559 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:51:08
2025-03-13 11:51:08,559 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:51:08,559 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:51:08,559 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:51:08,559 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:51:08,559 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:51:08
2025-03-13 11:51:08,559 [INFO]: 387.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:51:08,559 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:51:08,559 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:51:08
2025-03-13 11:51:08,559 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:51:08,559 [INFO]: 	Creating the index 03/13/2025, 11:51:08
2025-03-13 11:51:08,560 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:51:08
2025-03-13 11:51:08,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:51:08,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:51:08
2025-03-13 11:51:08,560 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:51:08,561 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.08it/s] 62%|██████▎   | 5/8 [00:00<00:00, 23.20it/s]100%|██████████| 8/8 [00:01<00:00,  3.95it/s]100%|██████████| 8/8 [00:01<00:00,  4.72it/s]
2025-03-13 11:51:10,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:10
2025-03-13 11:51:33,579 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3215 secs
2025-03-13 11:51:33,580 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 11:51:33,580 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.31it/s]
2025-03-13 11:51:48,878 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2982 secs
2025-03-13 11:51:48,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3190 secs
2025-03-13 11:51:48,880 [INFO]: {
2025-03-13 11:51:48,880 [INFO]: 	index_key: HNSW15
2025-03-13 11:51:48,880 [INFO]: 	index_param: efSearch=243
2025-03-13 11:51:48,880 [INFO]: 	index_path: knn.index
2025-03-13 11:51:48,880 [INFO]: 	size in bytes: 369091750
2025-03-13 11:51:48,880 [INFO]: 	avg_search_speed_ms: 10.469126804483109
2025-03-13 11:51:48,880 [INFO]: 	99p_search_speed_ms: 13.648109817877414
2025-03-13 11:51:48,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:48,880 [INFO]: 	nb vectors: 1876
2025-03-13 11:51:48,880 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:48,880 [INFO]: 	compression ratio: 0.999308730146366
2025-03-13 11:51:48,880 [INFO]: }
2025-03-13 11:51:48,880 [INFO]: 	>>> Finished "Creating the index" in 40.3202 secs
2025-03-13 11:51:48,880 [INFO]: >>> Finished "Launching the whole pipeline" in 40.3516 secs
2025-03-13 11:51:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 100072 [episode count 6/20]
[retrieval_preprocessing] for episode 100073 [episode count 7/20], we have num_retrieval=np.int64(1839) num_query=np.int64(134)
2025-03-13 11:51:50,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:51:50,289 [INFO]: Launching the whole pipeline 03/13/2025, 11:51:50
2025-03-13 11:51:50,289 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:51:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1497.43it/s]
2025-03-13 11:51:50,322 [INFO]: There are 1839 embeddings of dim 49152
2025-03-13 11:51:50,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 11:51:50,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:51:50
2025-03-13 11:51:50,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:51:50,323 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:51:50,323 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:51:50,323 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:51:50,323 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:51:50
2025-03-13 11:51:50,324 [INFO]: 379.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:51:50,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:51:50,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:51:50
2025-03-13 11:51:50,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:51:50,324 [INFO]: 	Creating the index 03/13/2025, 11:51:50
2025-03-13 11:51:50,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:51:50
2025-03-13 11:51:50,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:51:50,328 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:51:50
2025-03-13 11:51:50,328 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:51:50,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.03it/s]100%|██████████| 8/8 [00:01<00:00,  5.38it/s]100%|██████████| 8/8 [00:01<00:00,  5.90it/s]
2025-03-13 11:51:51,689 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:51
2025-03-13 11:52:13,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.7240 secs
2025-03-13 11:52:13,413 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:52:13,413 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 11:52:29,153 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7392 secs
2025-03-13 11:52:29,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.8259 secs
2025-03-13 11:52:29,154 [INFO]: {
2025-03-13 11:52:29,154 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:29,154 [INFO]: 	index_param: efSearch=249
2025-03-13 11:52:29,154 [INFO]: 	index_path: knn.index
2025-03-13 11:52:29,154 [INFO]: 	size in bytes: 361812070
2025-03-13 11:52:29,155 [INFO]: 	avg_search_speed_ms: 11.059114524775612
2025-03-13 11:52:29,155 [INFO]: 	99p_search_speed_ms: 16.020224913954735
2025-03-13 11:52:29,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:29,155 [INFO]: 	nb vectors: 1839
2025-03-13 11:52:29,155 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:29,155 [INFO]: 	compression ratio: 0.9993091496367161
2025-03-13 11:52:29,155 [INFO]: }
2025-03-13 11:52:29,155 [INFO]: 	>>> Finished "Creating the index" in 38.8302 secs
2025-03-13 11:52:29,155 [INFO]: >>> Finished "Launching the whole pipeline" in 38.8651 secs
2025-03-13 11:52:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100073 [episode count 7/20]
[retrieval_preprocessing] for episode 100074 [episode count 8/20], we have num_retrieval=np.int64(1879) num_query=np.int64(94)
2025-03-13 11:52:30,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:31,211 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:31
2025-03-13 11:52:31,211 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-13 11:52:31,239 [INFO]: There are 1879 embeddings of dim 49152
2025-03-13 11:52:31,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 11:52:31,239 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:31
2025-03-13 11:52:31,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:31,240 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:52:31,240 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:31,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:52:31,240 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:31
2025-03-13 11:52:31,240 [INFO]: 387.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:31,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:52:31,240 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:31
2025-03-13 11:52:31,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:31,240 [INFO]: 	Creating the index 03/13/2025, 11:52:31
2025-03-13 11:52:31,240 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:31
2025-03-13 11:52:31,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:52:31,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:31
2025-03-13 11:52:31,241 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:52:31,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.69it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.77it/s]100%|██████████| 8/8 [00:01<00:00,  4.68it/s]
2025-03-13 11:52:32,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:32
2025-03-13 11:53:00,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8333 secs
2025-03-13 11:53:00,789 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 11:53:00,789 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 11:53:13,998 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2095 secs
2025-03-13 11:53:14,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7598 secs
2025-03-13 11:53:14,001 [INFO]: {
2025-03-13 11:53:14,001 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:14,001 [INFO]: 	index_param: efSearch=220
2025-03-13 11:53:14,001 [INFO]: 	index_path: knn.index
2025-03-13 11:53:14,001 [INFO]: 	size in bytes: 369682030
2025-03-13 11:53:14,001 [INFO]: 	avg_search_speed_ms: 9.943086138989399
2025-03-13 11:53:14,001 [INFO]: 	99p_search_speed_ms: 13.648589362856002
2025-03-13 11:53:14,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:14,001 [INFO]: 	nb vectors: 1879
2025-03-13 11:53:14,001 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:14,002 [INFO]: 	compression ratio: 0.9993086004207453
2025-03-13 11:53:14,002 [INFO]: }
2025-03-13 11:53:14,002 [INFO]: 	>>> Finished "Creating the index" in 42.7618 secs
2025-03-13 11:53:14,002 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7907 secs
2025-03-13 11:53:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100074 [episode count 8/20]
[retrieval_preprocessing] for episode 100075 [episode count 9/20], we have num_retrieval=np.int64(1898) num_query=np.int64(75)
2025-03-13 11:53:14,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:15,502 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:15
2025-03-13 11:53:15,502 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-13 11:53:15,545 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 11:53:15,545 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0429 secs
2025-03-13 11:53:15,545 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:15
2025-03-13 11:53:15,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:15,545 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:53:15,545 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:15,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:53:15,545 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:15
2025-03-13 11:53:15,545 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:15,545 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:53:15,546 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:15
2025-03-13 11:53:15,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:15,546 [INFO]: 	Creating the index 03/13/2025, 11:53:15
2025-03-13 11:53:15,546 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:15
2025-03-13 11:53:15,547 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:53:15,548 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:15
2025-03-13 11:53:15,548 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:53:15,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 12.00it/s] 50%|█████     | 4/8 [00:00<00:00, 12.26it/s] 75%|███████▌  | 6/8 [00:00<00:00, 11.66it/s]100%|██████████| 8/8 [00:02<00:00,  2.56it/s]100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
2025-03-13 11:53:17,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:17
2025-03-13 11:53:42,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4098 secs
2025-03-13 11:53:42,192 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 11:53:42,192 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.20it/s]
2025-03-13 11:53:59,335 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1430 secs
2025-03-13 11:53:59,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7891 secs
2025-03-13 11:53:59,337 [INFO]: {
2025-03-13 11:53:59,337 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:59,337 [INFO]: 	index_param: efSearch=203
2025-03-13 11:53:59,337 [INFO]: 	index_path: knn.index
2025-03-13 11:53:59,337 [INFO]: 	size in bytes: 373420150
2025-03-13 11:53:59,337 [INFO]: 	avg_search_speed_ms: 8.793833359204422
2025-03-13 11:53:59,337 [INFO]: 	99p_search_speed_ms: 12.425023503601551
2025-03-13 11:53:59,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:59,337 [INFO]: 	nb vectors: 1898
2025-03-13 11:53:59,337 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:59,337 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 11:53:59,337 [INFO]: }
2025-03-13 11:53:59,337 [INFO]: 	>>> Finished "Creating the index" in 43.7915 secs
2025-03-13 11:53:59,337 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8354 secs
2025-03-13 11:53:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100075 [episode count 9/20]
[retrieval_preprocessing] for episode 100076 [episode count 10/20], we have num_retrieval=np.int64(1841) num_query=np.int64(132)
2025-03-13 11:54:00,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:00,295 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:00
2025-03-13 11:54:00,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2467.24it/s]
2025-03-13 11:54:00,320 [INFO]: There are 1841 embeddings of dim 49152
2025-03-13 11:54:00,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:54:00,320 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:00
2025-03-13 11:54:00,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:00,320 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:54:00,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:00,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:00,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:00
2025-03-13 11:54:00,321 [INFO]: 379.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:00,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:54:00,321 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:00
2025-03-13 11:54:00,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:00,321 [INFO]: 	Creating the index 03/13/2025, 11:54:00
2025-03-13 11:54:00,321 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:00
2025-03-13 11:54:00,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:54:00,322 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:00
2025-03-13 11:54:00,322 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:54:00,322 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.94it/s]100%|██████████| 8/8 [00:01<00:00,  4.90it/s]100%|██████████| 8/8 [00:01<00:00,  5.19it/s]
2025-03-13 11:54:01,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:01
2025-03-13 11:54:25,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1039 secs
2025-03-13 11:54:25,972 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 11:54:25,972 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.40it/s]
2025-03-13 11:54:41,440 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4681 secs
2025-03-13 11:54:41,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1197 secs
2025-03-13 11:54:41,442 [INFO]: {
2025-03-13 11:54:41,442 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:41,442 [INFO]: 	index_param: efSearch=139
2025-03-13 11:54:41,442 [INFO]: 	index_path: knn.index
2025-03-13 11:54:41,442 [INFO]: 	size in bytes: 362205550
2025-03-13 11:54:41,442 [INFO]: 	avg_search_speed_ms: 7.727393236513634
2025-03-13 11:54:41,442 [INFO]: 	99p_search_speed_ms: 11.333931626286356
2025-03-13 11:54:41,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:41,442 [INFO]: 	nb vectors: 1841
2025-03-13 11:54:41,442 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:41,442 [INFO]: 	compression ratio: 0.9993091712702912
2025-03-13 11:54:41,442 [INFO]: }
2025-03-13 11:54:41,442 [INFO]: 	>>> Finished "Creating the index" in 41.1211 secs
2025-03-13 11:54:41,442 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1469 secs
2025-03-13 11:54:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100076 [episode count 10/20]
[retrieval_preprocessing] for episode 100077 [episode count 11/20], we have num_retrieval=np.int64(1859) num_query=np.int64(114)
2025-03-13 11:54:42,505 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:42,769 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:42
2025-03-13 11:54:42,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.58it/s]
2025-03-13 11:54:42,799 [INFO]: There are 1859 embeddings of dim 49152
2025-03-13 11:54:42,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:54:42,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:42
2025-03-13 11:54:42,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:42,800 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:54:42,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:42,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:54:42,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:42
2025-03-13 11:54:42,800 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:42,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:54:42,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:42
2025-03-13 11:54:42,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:42,801 [INFO]: 	Creating the index 03/13/2025, 11:54:42
2025-03-13 11:54:42,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:42
2025-03-13 11:54:42,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:54:42,804 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:42
2025-03-13 11:54:42,805 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:54:42,805 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 24.91it/s]100%|██████████| 8/8 [00:01<00:00,  4.14it/s]100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
2025-03-13 11:54:44,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:44
2025-03-13 11:55:07,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1812 secs
2025-03-13 11:55:07,744 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 11:55:07,744 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.76it/s]
2025-03-13 11:55:22,320 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5765 secs
2025-03-13 11:55:22,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5172 secs
2025-03-13 11:55:22,322 [INFO]: {
2025-03-13 11:55:22,322 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:22,322 [INFO]: 	index_param: efSearch=242
2025-03-13 11:55:22,322 [INFO]: 	index_path: knn.index
2025-03-13 11:55:22,322 [INFO]: 	size in bytes: 365746990
2025-03-13 11:55:22,322 [INFO]: 	avg_search_speed_ms: 11.219245717326187
2025-03-13 11:55:22,322 [INFO]: 	99p_search_speed_ms: 18.130223115440458
2025-03-13 11:55:22,322 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:22,322 [INFO]: 	nb vectors: 1859
2025-03-13 11:55:22,322 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:22,322 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-13 11:55:22,322 [INFO]: }
2025-03-13 11:55:22,322 [INFO]: 	>>> Finished "Creating the index" in 39.5212 secs
2025-03-13 11:55:22,322 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5536 secs
2025-03-13 11:55:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 100077 [episode count 11/20]
[retrieval_preprocessing] for episode 100078 [episode count 12/20], we have num_retrieval=np.int64(1902) num_query=np.int64(71)
2025-03-13 11:55:23,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:24,004 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:24
2025-03-13 11:55:24,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.29it/s]100%|██████████| 1/1 [00:00<00:00,  1.29it/s]
2025-03-13 11:55:24,803 [INFO]: There are 1902 embeddings of dim 49152
2025-03-13 11:55:24,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.8001 secs
2025-03-13 11:55:24,804 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:24
2025-03-13 11:55:24,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:24,805 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:55:24,805 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:24,805 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:55:24,805 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:24
2025-03-13 11:55:24,806 [INFO]: 392.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:24,806 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 11:55:24,806 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:24
2025-03-13 11:55:24,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:24,807 [INFO]: 	Creating the index 03/13/2025, 11:55:24
2025-03-13 11:55:24,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:24
2025-03-13 11:55:24,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:55:24,811 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:24
2025-03-13 11:55:24,811 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:55:24,811 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.93it/s]100%|██████████| 8/8 [00:01<00:00,  4.90it/s]100%|██████████| 8/8 [00:01<00:00,  5.39it/s]
2025-03-13 11:55:26,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:26
2025-03-13 11:55:47,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.4808 secs
2025-03-13 11:55:47,781 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 11:55:47,781 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.00it/s]
2025-03-13 11:56:02,046 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2652 secs
2025-03-13 11:56:02,048 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.2370 secs
2025-03-13 11:56:02,048 [INFO]: {
2025-03-13 11:56:02,048 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:02,048 [INFO]: 	index_param: efSearch=185
2025-03-13 11:56:02,048 [INFO]: 	index_path: knn.index
2025-03-13 11:56:02,048 [INFO]: 	size in bytes: 374207170
2025-03-13 11:56:02,048 [INFO]: 	avg_search_speed_ms: 9.609522028055736
2025-03-13 11:56:02,048 [INFO]: 	99p_search_speed_ms: 16.221617194823917
2025-03-13 11:56:02,048 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:02,048 [INFO]: 	nb vectors: 1902
2025-03-13 11:56:02,048 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:02,048 [INFO]: 	compression ratio: 0.9993085274127698
2025-03-13 11:56:02,048 [INFO]: }
2025-03-13 11:56:02,048 [INFO]: 	>>> Finished "Creating the index" in 37.2412 secs
2025-03-13 11:56:02,048 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0447 secs
2025-03-13 11:56:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 100078 [episode count 12/20]
[retrieval_preprocessing] for episode 100079 [episode count 13/20], we have num_retrieval=np.int64(1916) num_query=np.int64(57)
2025-03-13 11:56:04,137 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:04,551 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:04
2025-03-13 11:56:04,552 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.99it/s]
2025-03-13 11:56:04,583 [INFO]: There are 1916 embeddings of dim 49152
2025-03-13 11:56:04,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 11:56:04,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:04,583 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:56:04,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:04,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:04,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,584 [INFO]: 395.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:04,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:56:04,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:04
2025-03-13 11:56:04,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:04,584 [INFO]: 	Creating the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:04
2025-03-13 11:56:04,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:56:04,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,586 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:56:04,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.67it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.19it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.16it/s] 50%|█████     | 4/8 [00:00<00:00,  8.58it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.80it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.92it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.68it/s]100%|██████████| 8/8 [00:02<00:00,  1.35it/s]100%|██████████| 8/8 [00:02<00:00,  2.74it/s]
2025-03-13 11:56:07,509 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:07
2025-03-13 11:56:35,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2360 secs
2025-03-13 11:56:35,746 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 11:56:35,746 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 11:56:50,255 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5086 secs
2025-03-13 11:56:50,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6712 secs
2025-03-13 11:56:50,257 [INFO]: {
2025-03-13 11:56:50,257 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:50,257 [INFO]: 	index_param: efSearch=193
2025-03-13 11:56:50,257 [INFO]: 	index_path: knn.index
2025-03-13 11:56:50,257 [INFO]: 	size in bytes: 376961590
2025-03-13 11:56:50,257 [INFO]: 	avg_search_speed_ms: 9.279909790130695
2025-03-13 11:56:50,257 [INFO]: 	99p_search_speed_ms: 18.65101797739046
2025-03-13 11:56:50,257 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:50,257 [INFO]: 	nb vectors: 1916
2025-03-13 11:56:50,257 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:50,257 [INFO]: 	compression ratio: 0.9993085184089976
2025-03-13 11:56:50,257 [INFO]: }
2025-03-13 11:56:50,257 [INFO]: 	>>> Finished "Creating the index" in 45.6731 secs
2025-03-13 11:56:50,257 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7057 secs
2025-03-13 11:56:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100079 [episode count 13/20]
[retrieval_preprocessing] for episode 100080 [episode count 14/20], we have num_retrieval=np.int64(1832) num_query=np.int64(141)
2025-03-13 11:56:51,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:51,655 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:51
2025-03-13 11:56:51,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.79it/s]100%|██████████| 1/1 [00:00<00:00,  1.79it/s]
2025-03-13 11:56:52,242 [INFO]: There are 1832 embeddings of dim 49152
2025-03-13 11:56:52,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5872 secs
2025-03-13 11:56:52,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:52
2025-03-13 11:56:52,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:52,242 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:56:52,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:52,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:56:52,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:52
2025-03-13 11:56:52,243 [INFO]: 378.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:52,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:56:52,243 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:52
2025-03-13 11:56:52,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:52,244 [INFO]: 	Creating the index 03/13/2025, 11:56:52
2025-03-13 11:56:52,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:52
2025-03-13 11:56:52,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:56:52,247 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:52
2025-03-13 11:56:52,247 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:56:52,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.10it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.82it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.75it/s] 50%|█████     | 4/8 [00:00<00:00,  7.75it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.85it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.93it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.09it/s]100%|██████████| 8/8 [00:02<00:00,  2.08it/s]100%|██████████| 8/8 [00:02<00:00,  3.74it/s]
2025-03-13 11:56:54,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:54
2025-03-13 11:57:16,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0480 secs
2025-03-13 11:57:16,437 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 11:57:16,437 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 11:57:29,855 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4178 secs
2025-03-13 11:57:29,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6098 secs
2025-03-13 11:57:29,857 [INFO]: {
2025-03-13 11:57:29,857 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:29,857 [INFO]: 	index_param: efSearch=259
2025-03-13 11:57:29,857 [INFO]: 	index_path: knn.index
2025-03-13 11:57:29,857 [INFO]: 	size in bytes: 360434890
2025-03-13 11:57:29,857 [INFO]: 	avg_search_speed_ms: 10.516730174383092
2025-03-13 11:57:29,857 [INFO]: 	99p_search_speed_ms: 21.36595407500863
2025-03-13 11:57:29,857 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:29,857 [INFO]: 	nb vectors: 1832
2025-03-13 11:57:29,857 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:29,857 [INFO]: 	compression ratio: 0.9993090735472362
2025-03-13 11:57:29,857 [INFO]: }
2025-03-13 11:57:29,857 [INFO]: 	>>> Finished "Creating the index" in 37.6133 secs
2025-03-13 11:57:29,857 [INFO]: >>> Finished "Launching the whole pipeline" in 38.2024 secs
2025-03-13 11:57:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 100080 [episode count 14/20]
[retrieval_preprocessing] for episode 100081 [episode count 15/20], we have num_retrieval=np.int64(1904) num_query=np.int64(69)
2025-03-13 11:57:32,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:33,126 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:33
2025-03-13 11:57:33,126 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-13 11:57:33,153 [INFO]: There are 1904 embeddings of dim 49152
2025-03-13 11:57:33,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:57:33,153 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:33
2025-03-13 11:57:33,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:33,153 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:57:33,153 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:33,153 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:33,153 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:33
2025-03-13 11:57:33,153 [INFO]: 392.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:33,153 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:57:33,153 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:33
2025-03-13 11:57:33,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:33,153 [INFO]: 	Creating the index 03/13/2025, 11:57:33
2025-03-13 11:57:33,154 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:33
2025-03-13 11:57:33,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:57:33,155 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:33
2025-03-13 11:57:33,155 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:57:33,155 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.93it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.30it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.54it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.27it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.52it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.79it/s]100%|██████████| 8/8 [00:02<00:00,  1.90it/s]100%|██████████| 8/8 [00:02<00:00,  3.35it/s]
2025-03-13 11:57:35,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:35
2025-03-13 11:57:59,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5161 secs
2025-03-13 11:57:59,060 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 11:57:59,060 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-13 11:58:13,765 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7055 secs
2025-03-13 11:58:13,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6120 secs
2025-03-13 11:58:13,767 [INFO]: {
2025-03-13 11:58:13,767 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:13,767 [INFO]: 	index_param: efSearch=280
2025-03-13 11:58:13,767 [INFO]: 	index_path: knn.index
2025-03-13 11:58:13,767 [INFO]: 	size in bytes: 374600710
2025-03-13 11:58:13,767 [INFO]: 	avg_search_speed_ms: 10.514480962548268
2025-03-13 11:58:13,767 [INFO]: 	99p_search_speed_ms: 15.113963978365064
2025-03-13 11:58:13,767 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:13,767 [INFO]: 	nb vectors: 1904
2025-03-13 11:58:13,767 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:13,767 [INFO]: 	compression ratio: 0.9993083889243028
2025-03-13 11:58:13,767 [INFO]: }
2025-03-13 11:58:13,767 [INFO]: 	>>> Finished "Creating the index" in 40.6136 secs
2025-03-13 11:58:13,767 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6407 secs
2025-03-13 11:58:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100081 [episode count 15/20]
[retrieval_preprocessing] for episode 100082 [episode count 16/20], we have num_retrieval=np.int64(1905) num_query=np.int64(68)
2025-03-13 11:58:15,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:15,797 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:15
2025-03-13 11:58:15,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1739.65it/s]
2025-03-13 11:58:15,822 [INFO]: There are 1905 embeddings of dim 49152
2025-03-13 11:58:15,822 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:58:15,822 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:15
2025-03-13 11:58:15,822 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:15,822 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:58:15,822 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:15,822 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:15,822 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:15
2025-03-13 11:58:15,823 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:15,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:58:15,823 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:15
2025-03-13 11:58:15,823 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:15,823 [INFO]: 	Creating the index 03/13/2025, 11:58:15
2025-03-13 11:58:15,823 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:15
2025-03-13 11:58:15,824 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:58:15,824 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:15
2025-03-13 11:58:15,824 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:58:15,824 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.62it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.61it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.97it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.38it/s]100%|██████████| 8/8 [00:02<00:00,  2.13it/s]100%|██████████| 8/8 [00:02<00:00,  3.31it/s]
2025-03-13 11:58:18,247 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:18
2025-03-13 11:58:44,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6634 secs
2025-03-13 11:58:44,911 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 11:58:44,911 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.01it/s]
2025-03-13 11:58:59,914 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0028 secs
2025-03-13 11:58:59,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0915 secs
2025-03-13 11:58:59,916 [INFO]: {
2025-03-13 11:58:59,916 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:59,916 [INFO]: 	index_param: efSearch=205
2025-03-13 11:58:59,916 [INFO]: 	index_path: knn.index
2025-03-13 11:58:59,916 [INFO]: 	size in bytes: 374797450
2025-03-13 11:58:59,916 [INFO]: 	avg_search_speed_ms: 8.699318567574348
2025-03-13 11:58:59,916 [INFO]: 	99p_search_speed_ms: 11.277600356843323
2025-03-13 11:58:59,916 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:59,916 [INFO]: 	nb vectors: 1905
2025-03-13 11:58:59,916 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:59,916 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 11:58:59,916 [INFO]: }
2025-03-13 11:58:59,916 [INFO]: 	>>> Finished "Creating the index" in 44.0931 secs
2025-03-13 11:58:59,916 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1187 secs
2025-03-13 11:59:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 100082 [episode count 16/20]
[retrieval_preprocessing] for episode 100083 [episode count 17/20], we have num_retrieval=np.int64(1901) num_query=np.int64(72)
2025-03-13 11:59:01,168 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:01,496 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:01
2025-03-13 11:59:01,496 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.11it/s]
2025-03-13 11:59:01,520 [INFO]: There are 1901 embeddings of dim 49152
2025-03-13 11:59:01,520 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:59:01,520 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:01
2025-03-13 11:59:01,520 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:01,520 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:59:01,520 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:01,520 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:59:01,520 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:01
2025-03-13 11:59:01,520 [INFO]: 392.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:01,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:59:01,520 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:01
2025-03-13 11:59:01,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:01,521 [INFO]: 	Creating the index 03/13/2025, 11:59:01
2025-03-13 11:59:01,521 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:01
2025-03-13 11:59:01,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:59:01,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:01
2025-03-13 11:59:01,522 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:59:01,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.85it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.16it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.72it/s] 50%|█████     | 4/8 [00:00<00:00,  6.94it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.18it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.25it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.30it/s]100%|██████████| 8/8 [00:03<00:00,  1.36it/s]100%|██████████| 8/8 [00:03<00:00,  2.63it/s]
2025-03-13 11:59:04,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:04
2025-03-13 11:59:28,023 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4607 secs
2025-03-13 11:59:28,024 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 11:59:28,024 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s]
2025-03-13 11:59:41,296 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2724 secs
2025-03-13 11:59:41,299 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7771 secs
2025-03-13 11:59:41,299 [INFO]: {
2025-03-13 11:59:41,299 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:41,299 [INFO]: 	index_param: efSearch=237
2025-03-13 11:59:41,299 [INFO]: 	index_path: knn.index
2025-03-13 11:59:41,299 [INFO]: 	size in bytes: 374010430
2025-03-13 11:59:41,299 [INFO]: 	avg_search_speed_ms: 9.753371424427847
2025-03-13 11:59:41,299 [INFO]: 	99p_search_speed_ms: 18.468405194580555
2025-03-13 11:59:41,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:41,299 [INFO]: 	nb vectors: 1901
2025-03-13 11:59:41,299 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:41,299 [INFO]: 	compression ratio: 0.9993085166100849
2025-03-13 11:59:41,299 [INFO]: }
2025-03-13 11:59:41,299 [INFO]: 	>>> Finished "Creating the index" in 39.7789 secs
2025-03-13 11:59:41,300 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8034 secs
2025-03-13 11:59:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100083 [episode count 17/20]
[retrieval_preprocessing] for episode 100084 [episode count 18/20], we have num_retrieval=np.int64(1894) num_query=np.int64(79)
2025-03-13 11:59:42,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:42,990 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:42
2025-03-13 11:59:42,990 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-13 11:59:43,016 [INFO]: There are 1894 embeddings of dim 49152
2025-03-13 11:59:43,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:59:43,016 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:43
2025-03-13 11:59:43,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:43,017 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 11:59:43,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:43,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:59:43,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:43
2025-03-13 11:59:43,017 [INFO]: 390.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:43,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:59:43,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:43
2025-03-13 11:59:43,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:43,018 [INFO]: 	Creating the index 03/13/2025, 11:59:43
2025-03-13 11:59:43,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:43
2025-03-13 11:59:43,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:59:43,021 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:43
2025-03-13 11:59:43,021 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 11:59:43,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.37it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.97it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.80it/s] 50%|█████     | 4/8 [00:00<00:00,  8.17it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.34it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.45it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.58it/s]100%|██████████| 8/8 [00:02<00:00,  1.88it/s]100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
2025-03-13 11:59:45,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:45
2025-03-13 12:00:07,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.9570 secs
2025-03-13 12:00:07,272 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 12:00:07,272 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 50%|█████     | 2/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 12:00:26,144 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8716 secs
2025-03-13 12:00:26,145 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1242 secs
2025-03-13 12:00:26,146 [INFO]: {
2025-03-13 12:00:26,146 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:26,146 [INFO]: 	index_param: efSearch=225
2025-03-13 12:00:26,146 [INFO]: 	index_path: knn.index
2025-03-13 12:00:26,146 [INFO]: 	size in bytes: 372633190
2025-03-13 12:00:26,146 [INFO]: 	avg_search_speed_ms: 10.180747386849582
2025-03-13 12:00:26,146 [INFO]: 	99p_search_speed_ms: 19.145126733928805
2025-03-13 12:00:26,146 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:26,146 [INFO]: 	nb vectors: 1894
2025-03-13 12:00:26,146 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:26,146 [INFO]: 	compression ratio: 0.9993086015767946
2025-03-13 12:00:26,146 [INFO]: }
2025-03-13 12:00:26,146 [INFO]: 	>>> Finished "Creating the index" in 43.1278 secs
2025-03-13 12:00:26,146 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1560 secs
2025-03-13 12:00:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 100084 [episode count 18/20]
[retrieval_preprocessing] for episode 100085 [episode count 19/20], we have num_retrieval=np.int64(1874) num_query=np.int64(99)
2025-03-13 12:00:27,451 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:27,718 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:27
2025-03-13 12:00:27,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-13 12:00:27,743 [INFO]: There are 1874 embeddings of dim 49152
2025-03-13 12:00:27,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:00:27,743 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:27
2025-03-13 12:00:27,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:27,743 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:00:27,743 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:27,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:00:27,743 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:27
2025-03-13 12:00:27,744 [INFO]: 386.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:27,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:00:27,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:27
2025-03-13 12:00:27,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:27,744 [INFO]: 	Creating the index 03/13/2025, 12:00:27
2025-03-13 12:00:27,744 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:27
2025-03-13 12:00:27,745 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:00:27,745 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:27
2025-03-13 12:00:27,745 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:00:27,745 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.30it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.90it/s] 50%|█████     | 4/8 [00:00<00:00,  8.09it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.27it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.50it/s]100%|██████████| 8/8 [00:02<00:00,  2.44it/s]100%|██████████| 8/8 [00:02<00:00,  3.63it/s]
2025-03-13 12:00:29,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:29
2025-03-13 12:00:57,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4532 secs
2025-03-13 12:00:57,403 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 12:00:57,403 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 12:01:15,897 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4942 secs
2025-03-13 12:01:16,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4021 secs
2025-03-13 12:01:16,147 [INFO]: {
2025-03-13 12:01:16,147 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:16,147 [INFO]: 	index_param: efSearch=170
2025-03-13 12:01:16,148 [INFO]: 	index_path: knn.index
2025-03-13 12:01:16,148 [INFO]: 	size in bytes: 368698210
2025-03-13 12:01:16,148 [INFO]: 	avg_search_speed_ms: 7.937323816105842
2025-03-13 12:01:16,148 [INFO]: 	99p_search_speed_ms: 15.45507875969641
2025-03-13 12:01:16,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:16,148 [INFO]: 	nb vectors: 1874
2025-03-13 12:01:16,148 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:16,148 [INFO]: 	compression ratio: 0.9993088710682919
2025-03-13 12:01:16,148 [INFO]: }
2025-03-13 12:01:16,148 [INFO]: 	>>> Finished "Creating the index" in 48.4042 secs
2025-03-13 12:01:16,148 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4297 secs
2025-03-13 12:01:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 100085 [episode count 19/20]
2025-03-13 12:01:17: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_the_jug_to_the_left [chosen_id count 4/8]
2025-03-13 12:01:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_the_strawberry_forwards [chosen_id count 5/8]
2025-03-13 12:01:19: [retrieval_preprocessing] we have num_total=1952 embedding_dim=49152
[retrieval_preprocessing] for episode 100086 [episode count 0/20], we have num_retrieval=np.int64(1847) num_query=np.int64(105)
2025-03-13 12:01:20,548 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:21,254 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:21
2025-03-13 12:01:21,255 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.18it/s]
2025-03-13 12:01:21,281 [INFO]: There are 1847 embeddings of dim 49152
2025-03-13 12:01:21,281 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 12:01:21,281 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,281 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:21,282 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:01:21,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:21,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:01:21,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,282 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:21,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:01:21,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:21
2025-03-13 12:01:21,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:21,282 [INFO]: 	Creating the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:21
2025-03-13 12:01:21,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:01:21,283 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:21
2025-03-13 12:01:21,283 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:01:21,283 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.25it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.82it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.34it/s] 50%|█████     | 4/8 [00:00<00:00,  7.83it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.19it/s]100%|██████████| 8/8 [00:02<00:00,  2.97it/s]100%|██████████| 8/8 [00:02<00:00,  3.98it/s]
2025-03-13 12:01:23,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:23
2025-03-13 12:01:46,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1239 secs
2025-03-13 12:01:46,419 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 12:01:46,419 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 12:02:09,072 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6532 secs
2025-03-13 12:02:09,074 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7901 secs
2025-03-13 12:02:09,074 [INFO]: {
2025-03-13 12:02:09,074 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:09,074 [INFO]: 	index_param: efSearch=300
2025-03-13 12:02:09,074 [INFO]: 	index_path: knn.index
2025-03-13 12:02:09,074 [INFO]: 	size in bytes: 363385990
2025-03-13 12:02:09,074 [INFO]: 	avg_search_speed_ms: 9.243101425350138
2025-03-13 12:02:09,074 [INFO]: 	99p_search_speed_ms: 13.497314092237511
2025-03-13 12:02:09,074 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:09,074 [INFO]: 	nb vectors: 1847
2025-03-13 12:02:09,074 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:09,074 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-13 12:02:09,074 [INFO]: }
2025-03-13 12:02:09,074 [INFO]: 	>>> Finished "Creating the index" in 47.7923 secs
2025-03-13 12:02:09,074 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8198 secs
2025-03-13 12:02:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 100086 [episode count 0/20]
[retrieval_preprocessing] for episode 100087 [episode count 1/20], we have num_retrieval=np.int64(1834) num_query=np.int64(118)
2025-03-13 12:02:10,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:10,963 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:10
2025-03-13 12:02:10,963 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1930.19it/s]
2025-03-13 12:02:10,985 [INFO]: There are 1834 embeddings of dim 49152
2025-03-13 12:02:10,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 12:02:10,985 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:10
2025-03-13 12:02:10,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:10,985 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:02:10,985 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:10,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:02:10,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:10
2025-03-13 12:02:10,985 [INFO]: 378.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:10,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:02:10,985 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:10
2025-03-13 12:02:10,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:10,985 [INFO]: 	Creating the index 03/13/2025, 12:02:10
2025-03-13 12:02:10,985 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:10
2025-03-13 12:02:10,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:02:10,986 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:10
2025-03-13 12:02:10,986 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:02:10,986 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.21it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.84it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.96it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.59it/s]100%|██████████| 8/8 [00:01<00:00,  4.31it/s]
2025-03-13 12:02:12,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:12
2025-03-13 12:02:34,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.4058 secs
2025-03-13 12:02:34,251 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 12:02:34,251 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 12:02:47,984 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7325 secs
2025-03-13 12:02:47,986 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.9994 secs
2025-03-13 12:02:47,986 [INFO]: {
2025-03-13 12:02:47,986 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:47,986 [INFO]: 	index_param: efSearch=247
2025-03-13 12:02:47,986 [INFO]: 	index_path: knn.index
2025-03-13 12:02:47,986 [INFO]: 	size in bytes: 360828370
2025-03-13 12:02:47,986 [INFO]: 	avg_search_speed_ms: 8.74168516732622
2025-03-13 12:02:47,986 [INFO]: 	99p_search_speed_ms: 16.028539347462356
2025-03-13 12:02:47,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:47,986 [INFO]: 	nb vectors: 1834
2025-03-13 12:02:47,986 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:47,986 [INFO]: 	compression ratio: 0.9993090953463554
2025-03-13 12:02:47,986 [INFO]: }
2025-03-13 12:02:47,986 [INFO]: 	>>> Finished "Creating the index" in 37.0008 secs
2025-03-13 12:02:47,986 [INFO]: >>> Finished "Launching the whole pipeline" in 37.0230 secs
2025-03-13 12:02:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 100087 [episode count 1/20]
[retrieval_preprocessing] for episode 100088 [episode count 2/20], we have num_retrieval=np.int64(1852) num_query=np.int64(100)
2025-03-13 12:02:49,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:50,094 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:50
2025-03-13 12:02:50,094 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.69it/s]
2025-03-13 12:02:50,121 [INFO]: There are 1852 embeddings of dim 49152
2025-03-13 12:02:50,122 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 12:02:50,122 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:50
2025-03-13 12:02:50,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:50,122 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:02:50,122 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:50,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:02:50,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:50
2025-03-13 12:02:50,123 [INFO]: 382.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:50,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:02:50,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:50
2025-03-13 12:02:50,124 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:50,124 [INFO]: 	Creating the index 03/13/2025, 12:02:50
2025-03-13 12:02:50,124 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:50
2025-03-13 12:02:50,127 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:02:50,127 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:50
2025-03-13 12:02:50,127 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:02:50,128 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.40it/s] 38%|███▊      | 3/8 [00:00<00:00, 12.51it/s] 62%|██████▎   | 5/8 [00:00<00:00, 13.81it/s] 88%|████████▊ | 7/8 [00:00<00:00, 14.72it/s]100%|██████████| 8/8 [00:01<00:00,  4.74it/s]
2025-03-13 12:02:51,822 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:51
2025-03-13 12:03:12,066 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2432 secs
2025-03-13 12:03:12,066 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 12:03:12,066 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
2025-03-13 12:03:26,551 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4856 secs
2025-03-13 12:03:26,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.5152 secs
2025-03-13 12:03:26,643 [INFO]: {
2025-03-13 12:03:26,643 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:26,643 [INFO]: 	index_param: efSearch=290
2025-03-13 12:03:26,643 [INFO]: 	index_path: knn.index
2025-03-13 12:03:26,643 [INFO]: 	size in bytes: 364369690
2025-03-13 12:03:26,643 [INFO]: 	avg_search_speed_ms: 9.24177353989932
2025-03-13 12:03:26,643 [INFO]: 	99p_search_speed_ms: 12.779864715412263
2025-03-13 12:03:26,644 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:26,644 [INFO]: 	nb vectors: 1852
2025-03-13 12:03:26,644 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:26,644 [INFO]: 	compression ratio: 0.9993092894197648
2025-03-13 12:03:26,644 [INFO]: }
2025-03-13 12:03:26,644 [INFO]: 	>>> Finished "Creating the index" in 36.5200 secs
2025-03-13 12:03:26,644 [INFO]: >>> Finished "Launching the whole pipeline" in 36.5498 secs
2025-03-13 12:03:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 100088 [episode count 2/20]
[retrieval_preprocessing] for episode 100089 [episode count 3/20], we have num_retrieval=np.int64(1860) num_query=np.int64(92)
2025-03-13 12:03:28,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:28,679 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:28
2025-03-13 12:03:28,680 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.71it/s]
2025-03-13 12:03:28,707 [INFO]: There are 1860 embeddings of dim 49152
2025-03-13 12:03:28,708 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:03:28,708 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:28
2025-03-13 12:03:28,708 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:28,708 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:03:28,708 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:28,708 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:28,708 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:28
2025-03-13 12:03:28,708 [INFO]: 383.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:28,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:03:28,708 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:28
2025-03-13 12:03:28,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:28,708 [INFO]: 	Creating the index 03/13/2025, 12:03:28
2025-03-13 12:03:28,708 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:28
2025-03-13 12:03:28,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:03:28,709 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:28
2025-03-13 12:03:28,710 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:03:28,710 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.98it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.58it/s]100%|██████████| 8/8 [00:01<00:00,  4.54it/s]
2025-03-13 12:03:30,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:30
2025-03-13 12:03:54,880 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4037 secs
2025-03-13 12:03:54,880 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 12:03:54,880 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.25it/s]
2025-03-13 12:04:08,797 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9167 secs
2025-03-13 12:04:08,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.0896 secs
2025-03-13 12:04:08,799 [INFO]: {
2025-03-13 12:04:08,799 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:08,799 [INFO]: 	index_param: efSearch=188
2025-03-13 12:04:08,799 [INFO]: 	index_path: knn.index
2025-03-13 12:04:08,799 [INFO]: 	size in bytes: 365943790
2025-03-13 12:04:08,799 [INFO]: 	avg_search_speed_ms: 9.554434939507313
2025-03-13 12:04:08,799 [INFO]: 	99p_search_speed_ms: 15.550112617202101
2025-03-13 12:04:08,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:08,799 [INFO]: 	nb vectors: 1860
2025-03-13 12:04:08,799 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:08,799 [INFO]: 	compression ratio: 0.9993088829298074
2025-03-13 12:04:08,799 [INFO]: }
2025-03-13 12:04:08,799 [INFO]: 	>>> Finished "Creating the index" in 40.0914 secs
2025-03-13 12:04:08,800 [INFO]: >>> Finished "Launching the whole pipeline" in 40.1200 secs
2025-03-13 12:04:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 100089 [episode count 3/20]
[retrieval_preprocessing] for episode 100090 [episode count 4/20], we have num_retrieval=np.int64(1881) num_query=np.int64(71)
2025-03-13 12:04:10,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:10,395 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:10
2025-03-13 12:04:10,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.38it/s]
2025-03-13 12:04:10,429 [INFO]: There are 1881 embeddings of dim 49152
2025-03-13 12:04:10,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 12:04:10,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:10,429 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:04:10,429 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:10,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:10,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,430 [INFO]: 388.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:10,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:04:10,430 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:10
2025-03-13 12:04:10,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:10,430 [INFO]: 	Creating the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,430 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:10
2025-03-13 12:04:10,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:04:10,431 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:10
2025-03-13 12:04:10,431 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:04:10,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.73it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.23it/s]100%|██████████| 8/8 [00:01<00:00,  4.16it/s]
2025-03-13 12:04:12,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:12
2025-03-13 12:04:42,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8073 secs
2025-03-13 12:04:42,168 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 12:04:42,168 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 12:04:59,171 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0032 secs
2025-03-13 12:04:59,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7426 secs
2025-03-13 12:04:59,174 [INFO]: {
2025-03-13 12:04:59,174 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:59,174 [INFO]: 	index_param: efSearch=182
2025-03-13 12:04:59,174 [INFO]: 	index_path: knn.index
2025-03-13 12:04:59,174 [INFO]: 	size in bytes: 370075510
2025-03-13 12:04:59,174 [INFO]: 	avg_search_speed_ms: 9.156915574562067
2025-03-13 12:04:59,174 [INFO]: 	99p_search_speed_ms: 15.114753320813158
2025-03-13 12:04:59,174 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:59,174 [INFO]: 	nb vectors: 1881
2025-03-13 12:04:59,174 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:59,174 [INFO]: 	compression ratio: 0.9993086221782144
2025-03-13 12:04:59,174 [INFO]: }
2025-03-13 12:04:59,174 [INFO]: 	>>> Finished "Creating the index" in 48.7444 secs
2025-03-13 12:04:59,174 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7795 secs
2025-03-13 12:04:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100090 [episode count 4/20]
[retrieval_preprocessing] for episode 100091 [episode count 5/20], we have num_retrieval=np.int64(1873) num_query=np.int64(79)
2025-03-13 12:05:00,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:00,497 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:00
2025-03-13 12:05:00,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1331.10it/s]
2025-03-13 12:05:00,533 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 12:05:00,533 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 12:05:00,533 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:00
2025-03-13 12:05:00,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:00,533 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:05:00,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:00,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:00,533 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:00
2025-03-13 12:05:00,534 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:00,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:05:00,534 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:00
2025-03-13 12:05:00,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:00,534 [INFO]: 	Creating the index 03/13/2025, 12:05:00
2025-03-13 12:05:00,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:00
2025-03-13 12:05:00,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:05:00,535 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:00
2025-03-13 12:05:00,535 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:05:00,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.20it/s] 62%|██████▎   | 5/8 [00:00<00:00, 25.67it/s]100%|██████████| 8/8 [00:02<00:00,  2.87it/s]100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
2025-03-13 12:05:02,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:02
2025-03-13 12:05:31,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7792 secs
2025-03-13 12:05:31,597 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:05:31,597 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.40it/s]
2025-03-13 12:05:47,920 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3235 secs
2025-03-13 12:05:47,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3868 secs
2025-03-13 12:05:47,922 [INFO]: {
2025-03-13 12:05:47,922 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:47,922 [INFO]: 	index_param: efSearch=241
2025-03-13 12:05:47,922 [INFO]: 	index_path: knn.index
2025-03-13 12:05:47,922 [INFO]: 	size in bytes: 368501470
2025-03-13 12:05:47,922 [INFO]: 	avg_search_speed_ms: 9.551553333617584
2025-03-13 12:05:47,922 [INFO]: 	99p_search_speed_ms: 15.919905779883258
2025-03-13 12:05:47,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:47,922 [INFO]: 	nb vectors: 1873
2025-03-13 12:05:47,922 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:47,922 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 12:05:47,922 [INFO]: }
2025-03-13 12:05:47,922 [INFO]: 	>>> Finished "Creating the index" in 47.3884 secs
2025-03-13 12:05:47,922 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4246 secs
2025-03-13 12:05:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 100091 [episode count 5/20]
[retrieval_preprocessing] for episode 100092 [episode count 6/20], we have num_retrieval=np.int64(1859) num_query=np.int64(93)
2025-03-13 12:05:49,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:49,716 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:49
2025-03-13 12:05:49,716 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.19it/s]
2025-03-13 12:05:49,741 [INFO]: There are 1859 embeddings of dim 49152
2025-03-13 12:05:49,741 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 12:05:49,741 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:49
2025-03-13 12:05:49,741 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:49,742 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:05:49,742 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:49,742 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:49,742 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:49
2025-03-13 12:05:49,742 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:49,742 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:05:49,742 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:49
2025-03-13 12:05:49,742 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:49,742 [INFO]: 	Creating the index 03/13/2025, 12:05:49
2025-03-13 12:05:49,742 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:49
2025-03-13 12:05:49,743 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:05:49,743 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:49
2025-03-13 12:05:49,743 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:05:49,743 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.19it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.69it/s]100%|██████████| 8/8 [00:01<00:00,  5.33it/s]
2025-03-13 12:05:51,247 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:51
2025-03-13 12:06:14,357 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1104 secs
2025-03-13 12:06:14,358 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:06:14,358 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 12:06:29,572 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2145 secs
2025-03-13 12:06:29,574 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8305 secs
2025-03-13 12:06:29,574 [INFO]: {
2025-03-13 12:06:29,574 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:29,574 [INFO]: 	index_param: efSearch=208
2025-03-13 12:06:29,574 [INFO]: 	index_path: knn.index
2025-03-13 12:06:29,574 [INFO]: 	size in bytes: 365746990
2025-03-13 12:06:29,574 [INFO]: 	avg_search_speed_ms: 10.511449845106647
2025-03-13 12:06:29,574 [INFO]: 	99p_search_speed_ms: 14.762554971966892
2025-03-13 12:06:29,574 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:29,574 [INFO]: 	nb vectors: 1859
2025-03-13 12:06:29,574 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:29,574 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-13 12:06:29,574 [INFO]: }
2025-03-13 12:06:29,574 [INFO]: 	>>> Finished "Creating the index" in 39.8320 secs
2025-03-13 12:06:29,574 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8580 secs
2025-03-13 12:06:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100092 [episode count 6/20]
[retrieval_preprocessing] for episode 100093 [episode count 7/20], we have num_retrieval=np.int64(1880) num_query=np.int64(72)
2025-03-13 12:06:30,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:30,630 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:30
2025-03-13 12:06:30,630 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.75it/s]
2025-03-13 12:06:30,659 [INFO]: There are 1880 embeddings of dim 49152
2025-03-13 12:06:30,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 12:06:30,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:30
2025-03-13 12:06:30,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:30,660 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:06:30,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:30,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:06:30,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:30
2025-03-13 12:06:30,660 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:30,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:06:30,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:30
2025-03-13 12:06:30,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:30,660 [INFO]: 	Creating the index 03/13/2025, 12:06:30
2025-03-13 12:06:30,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:30
2025-03-13 12:06:30,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:06:30,661 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:30
2025-03-13 12:06:30,661 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:06:30,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.14it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.40it/s]100%|██████████| 8/8 [00:01<00:00,  4.72it/s]
2025-03-13 12:06:32,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:32
2025-03-13 12:07:07,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6310 secs
2025-03-13 12:07:07,991 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 12:07:07,991 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.46it/s]
2025-03-13 12:07:25,306 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3143 secs
2025-03-13 12:07:25,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6459 secs
2025-03-13 12:07:25,307 [INFO]: {
2025-03-13 12:07:25,307 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:25,307 [INFO]: 	index_param: efSearch=178
2025-03-13 12:07:25,307 [INFO]: 	index_path: knn.index
2025-03-13 12:07:25,307 [INFO]: 	size in bytes: 369878770
2025-03-13 12:07:25,307 [INFO]: 	avg_search_speed_ms: 8.5614664118396
2025-03-13 12:07:25,307 [INFO]: 	99p_search_speed_ms: 12.026178305968642
2025-03-13 12:07:25,307 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:25,307 [INFO]: 	nb vectors: 1880
2025-03-13 12:07:25,307 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:25,307 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-13 12:07:25,307 [INFO]: }
2025-03-13 12:07:25,307 [INFO]: 	>>> Finished "Creating the index" in 54.6472 secs
2025-03-13 12:07:25,307 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6773 secs
2025-03-13 12:07:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100093 [episode count 7/20]
[retrieval_preprocessing] for episode 100094 [episode count 8/20], we have num_retrieval=np.int64(1873) num_query=np.int64(79)
2025-03-13 12:07:26,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:26,271 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:26
2025-03-13 12:07:26,271 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 12:07:26,301 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 12:07:26,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:07:26,301 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:26,301 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:07:26,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:26,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:07:26,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,301 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:26,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:07:26,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:26
2025-03-13 12:07:26,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:26,301 [INFO]: 	Creating the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:26
2025-03-13 12:07:26,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:07:26,302 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,302 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:07:26,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.41it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.56it/s]100%|██████████| 8/8 [00:01<00:00,  5.32it/s]
2025-03-13 12:07:27,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:27
2025-03-13 12:07:56,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3296 secs
2025-03-13 12:07:56,139 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 12:07:56,139 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-13 12:08:12,926 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7868 secs
2025-03-13 12:08:12,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6250 secs
2025-03-13 12:08:12,927 [INFO]: {
2025-03-13 12:08:12,927 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:12,927 [INFO]: 	index_param: efSearch=215
2025-03-13 12:08:12,927 [INFO]: 	index_path: knn.index
2025-03-13 12:08:12,928 [INFO]: 	size in bytes: 368501470
2025-03-13 12:08:12,928 [INFO]: 	avg_search_speed_ms: 9.11434657817389
2025-03-13 12:08:12,928 [INFO]: 	99p_search_speed_ms: 12.614718582481146
2025-03-13 12:08:12,928 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:12,928 [INFO]: 	nb vectors: 1873
2025-03-13 12:08:12,928 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:12,928 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 12:08:12,928 [INFO]: }
2025-03-13 12:08:12,928 [INFO]: 	>>> Finished "Creating the index" in 46.6264 secs
2025-03-13 12:08:12,928 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6562 secs
2025-03-13 12:08:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100094 [episode count 8/20]
[retrieval_preprocessing] for episode 100095 [episode count 9/20], we have num_retrieval=np.int64(1864) num_query=np.int64(88)
2025-03-13 12:08:13,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:14,095 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:14
2025-03-13 12:08:14,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.76it/s]
2025-03-13 12:08:14,133 [INFO]: There are 1864 embeddings of dim 49152
2025-03-13 12:08:14,134 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 12:08:14,134 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:14
2025-03-13 12:08:14,134 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:14,135 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:08:14,135 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:14,135 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:08:14,135 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:14
2025-03-13 12:08:14,135 [INFO]: 384.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:14,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:08:14,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:14
2025-03-13 12:08:14,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:14,136 [INFO]: 	Creating the index 03/13/2025, 12:08:14
2025-03-13 12:08:14,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:14
2025-03-13 12:08:14,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:08:14,139 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:14
2025-03-13 12:08:14,139 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:08:14,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.48it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.06it/s]100%|██████████| 8/8 [00:01<00:00,  5.87it/s]
2025-03-13 12:08:16,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:16
2025-03-13 12:08:40,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1282 secs
2025-03-13 12:08:40,178 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 12:08:40,178 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 12:08:53,675 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4971 secs
2025-03-13 12:08:53,677 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5381 secs
2025-03-13 12:08:53,678 [INFO]: {
2025-03-13 12:08:53,678 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:53,678 [INFO]: 	index_param: efSearch=210
2025-03-13 12:08:53,678 [INFO]: 	index_path: knn.index
2025-03-13 12:08:53,678 [INFO]: 	size in bytes: 366730750
2025-03-13 12:08:53,678 [INFO]: 	avg_search_speed_ms: 8.818966946548189
2025-03-13 12:08:53,678 [INFO]: 	99p_search_speed_ms: 12.191644480917606
2025-03-13 12:08:53,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:53,678 [INFO]: 	nb vectors: 1864
2025-03-13 12:08:53,678 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:53,678 [INFO]: 	compression ratio: 0.999308926235392
2025-03-13 12:08:53,678 [INFO]: }
2025-03-13 12:08:53,678 [INFO]: 	>>> Finished "Creating the index" in 39.5417 secs
2025-03-13 12:08:53,678 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5827 secs
2025-03-13 12:08:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100095 [episode count 9/20]
[retrieval_preprocessing] for episode 100096 [episode count 10/20], we have num_retrieval=np.int64(1868) num_query=np.int64(84)
2025-03-13 12:08:54,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:54,959 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:54
2025-03-13 12:08:54,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-13 12:08:54,987 [INFO]: There are 1868 embeddings of dim 49152
2025-03-13 12:08:54,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:08:54,988 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:54
2025-03-13 12:08:54,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:54,988 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:08:54,988 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:54,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:08:54,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:54
2025-03-13 12:08:54,989 [INFO]: 385.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:54,989 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:08:54,989 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:54
2025-03-13 12:08:54,989 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:54,989 [INFO]: 	Creating the index 03/13/2025, 12:08:54
2025-03-13 12:08:54,990 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:54
2025-03-13 12:08:54,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 12:08:54,993 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:54
2025-03-13 12:08:54,993 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:08:54,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.26it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]100%|██████████| 8/8 [00:01<00:00,  5.36it/s]
2025-03-13 12:08:56,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:56
2025-03-13 12:09:19,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1898 secs
2025-03-13 12:09:19,680 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 12:09:19,681 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-13 12:09:32,689 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0085 secs
2025-03-13 12:09:32,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6977 secs
2025-03-13 12:09:32,691 [INFO]: {
2025-03-13 12:09:32,691 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:32,691 [INFO]: 	index_param: efSearch=196
2025-03-13 12:09:32,691 [INFO]: 	index_path: knn.index
2025-03-13 12:09:32,691 [INFO]: 	size in bytes: 367517710
2025-03-13 12:09:32,691 [INFO]: 	avg_search_speed_ms: 8.572511900664844
2025-03-13 12:09:32,691 [INFO]: 	99p_search_speed_ms: 11.491598403081298
2025-03-13 12:09:32,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:32,691 [INFO]: 	nb vectors: 1868
2025-03-13 12:09:32,691 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:32,691 [INFO]: 	compression ratio: 0.9993089693555176
2025-03-13 12:09:32,691 [INFO]: }
2025-03-13 12:09:32,691 [INFO]: 	>>> Finished "Creating the index" in 37.7012 secs
2025-03-13 12:09:32,691 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7316 secs
2025-03-13 12:09:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 100096 [episode count 10/20]
[retrieval_preprocessing] for episode 100097 [episode count 11/20], we have num_retrieval=np.int64(1839) num_query=np.int64(113)
2025-03-13 12:09:33,496 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:33,766 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:33
2025-03-13 12:09:33,766 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.88it/s]
2025-03-13 12:09:33,794 [INFO]: There are 1839 embeddings of dim 49152
2025-03-13 12:09:33,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:09:33,794 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:33
2025-03-13 12:09:33,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:33,794 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:09:33,794 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:33,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:09:33,794 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:33
2025-03-13 12:09:33,794 [INFO]: 379.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:33,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:09:33,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:33
2025-03-13 12:09:33,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:33,795 [INFO]: 	Creating the index 03/13/2025, 12:09:33
2025-03-13 12:09:33,795 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:33
2025-03-13 12:09:33,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:09:33,796 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:33
2025-03-13 12:09:33,796 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:09:33,796 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.82it/s]100%|██████████| 8/8 [00:01<00:00,  5.77it/s]100%|██████████| 8/8 [00:01<00:00,  6.09it/s]
2025-03-13 12:09:35,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:35
2025-03-13 12:09:56,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.0804 secs
2025-03-13 12:09:56,193 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 12:09:56,193 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 12:10:11,205 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0115 secs
2025-03-13 12:10:11,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.4106 secs
2025-03-13 12:10:11,207 [INFO]: {
2025-03-13 12:10:11,207 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:11,207 [INFO]: 	index_param: efSearch=211
2025-03-13 12:10:11,207 [INFO]: 	index_path: knn.index
2025-03-13 12:10:11,207 [INFO]: 	size in bytes: 361812070
2025-03-13 12:10:11,207 [INFO]: 	avg_search_speed_ms: 9.2926110594523
2025-03-13 12:10:11,207 [INFO]: 	99p_search_speed_ms: 13.147037825547159
2025-03-13 12:10:11,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:11,207 [INFO]: 	nb vectors: 1839
2025-03-13 12:10:11,207 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:11,207 [INFO]: 	compression ratio: 0.9993091496367161
2025-03-13 12:10:11,207 [INFO]: }
2025-03-13 12:10:11,207 [INFO]: 	>>> Finished "Creating the index" in 37.4122 secs
2025-03-13 12:10:11,207 [INFO]: >>> Finished "Launching the whole pipeline" in 37.4407 secs
2025-03-13 12:10:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100097 [episode count 11/20]
[retrieval_preprocessing] for episode 100098 [episode count 12/20], we have num_retrieval=np.int64(1857) num_query=np.int64(95)
2025-03-13 12:10:13,792 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:14,101 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:14
2025-03-13 12:10:14,101 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.71it/s]
2025-03-13 12:10:14,132 [INFO]: There are 1857 embeddings of dim 49152
2025-03-13 12:10:14,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 12:10:14,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:14,132 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:10:14,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:14,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:14,132 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,132 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:14,132 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:10:14,132 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:14
2025-03-13 12:10:14,132 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:14,132 [INFO]: 	Creating the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,132 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:14
2025-03-13 12:10:14,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:10:14,133 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,133 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:10:14,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.42it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.62it/s]100%|██████████| 8/8 [00:02<00:00,  3.76it/s]
2025-03-13 12:10:16,268 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:16
2025-03-13 12:10:41,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6431 secs
2025-03-13 12:10:41,912 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 12:10:41,912 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.02it/s]
2025-03-13 12:10:56,857 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9456 secs
2025-03-13 12:10:57,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0333 secs
2025-03-13 12:10:57,167 [INFO]: {
2025-03-13 12:10:57,167 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:57,167 [INFO]: 	index_param: efSearch=143
2025-03-13 12:10:57,167 [INFO]: 	index_path: knn.index
2025-03-13 12:10:57,167 [INFO]: 	size in bytes: 365353510
2025-03-13 12:10:57,167 [INFO]: 	avg_search_speed_ms: 8.472866499678121
2025-03-13 12:10:57,168 [INFO]: 	99p_search_speed_ms: 11.806215678807348
2025-03-13 12:10:57,168 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:57,168 [INFO]: 	nb vectors: 1857
2025-03-13 12:10:57,168 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:57,168 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-13 12:10:57,168 [INFO]: }
2025-03-13 12:10:57,168 [INFO]: 	>>> Finished "Creating the index" in 43.0354 secs
2025-03-13 12:10:57,168 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0666 secs
2025-03-13 12:10:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 100098 [episode count 12/20]
[retrieval_preprocessing] for episode 100099 [episode count 13/20], we have num_retrieval=np.int64(1835) num_query=np.int64(117)
2025-03-13 12:10:57,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:58,207 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:58
2025-03-13 12:10:58,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-13 12:10:58,236 [INFO]: There are 1835 embeddings of dim 49152
2025-03-13 12:10:58,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:10:58,237 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:58
2025-03-13 12:10:58,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:58,237 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:10:58,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:58,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:58,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:58
2025-03-13 12:10:58,237 [INFO]: 378.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:58,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:10:58,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:58
2025-03-13 12:10:58,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:58,237 [INFO]: 	Creating the index 03/13/2025, 12:10:58
2025-03-13 12:10:58,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:58
2025-03-13 12:10:58,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:10:58,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:58
2025-03-13 12:10:58,238 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:10:58,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.17it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.51it/s]100%|██████████| 8/8 [00:01<00:00,  4.70it/s]
2025-03-13 12:10:59,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:59
2025-03-13 12:11:25,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1455 secs
2025-03-13 12:11:25,092 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 12:11:25,092 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.66it/s]
2025-03-13 12:11:40,806 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7145 secs
2025-03-13 12:11:40,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5693 secs
2025-03-13 12:11:40,808 [INFO]: {
2025-03-13 12:11:40,808 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:40,808 [INFO]: 	index_param: efSearch=254
2025-03-13 12:11:40,808 [INFO]: 	index_path: knn.index
2025-03-13 12:11:40,808 [INFO]: 	size in bytes: 361025110
2025-03-13 12:11:40,808 [INFO]: 	avg_search_speed_ms: 9.918893102235257
2025-03-13 12:11:40,808 [INFO]: 	99p_search_speed_ms: 14.70428013242781
2025-03-13 12:11:40,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:40,808 [INFO]: 	nb vectors: 1835
2025-03-13 12:11:40,808 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:40,808 [INFO]: 	compression ratio: 0.9993091062280959
2025-03-13 12:11:40,808 [INFO]: }
2025-03-13 12:11:40,808 [INFO]: 	>>> Finished "Creating the index" in 42.5707 secs
2025-03-13 12:11:40,808 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6005 secs
2025-03-13 12:11:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100099 [episode count 13/20]
[retrieval_preprocessing] for episode 100100 [episode count 14/20], we have num_retrieval=np.int64(1836) num_query=np.int64(116)
2025-03-13 12:11:42,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:42,992 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:42
2025-03-13 12:11:42,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2105.57it/s]
2025-03-13 12:11:43,020 [INFO]: There are 1836 embeddings of dim 49152
2025-03-13 12:11:43,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:11:43,020 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:43
2025-03-13 12:11:43,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:43,020 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:11:43,020 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:43,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:43,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:43
2025-03-13 12:11:43,021 [INFO]: 378.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:43,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:43,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:43
2025-03-13 12:11:43,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:43,021 [INFO]: 	Creating the index 03/13/2025, 12:11:43
2025-03-13 12:11:43,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:43
2025-03-13 12:11:43,022 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:11:43,022 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:43
2025-03-13 12:11:43,022 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:11:43,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.10it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.19it/s]100%|██████████| 8/8 [00:01<00:00,  4.65it/s]
2025-03-13 12:11:44,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:44
2025-03-13 12:12:11,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0984 secs
2025-03-13 12:12:11,847 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 12:12:11,847 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.30it/s]
2025-03-13 12:12:24,159 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3112 secs
2025-03-13 12:12:24,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1379 secs
2025-03-13 12:12:24,160 [INFO]: {
2025-03-13 12:12:24,160 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:24,160 [INFO]: 	index_param: efSearch=252
2025-03-13 12:12:24,160 [INFO]: 	index_path: knn.index
2025-03-13 12:12:24,160 [INFO]: 	size in bytes: 361221850
2025-03-13 12:12:24,160 [INFO]: 	avg_search_speed_ms: 10.581940441101631
2025-03-13 12:12:24,160 [INFO]: 	99p_search_speed_ms: 16.060785260051478
2025-03-13 12:12:24,160 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:24,160 [INFO]: 	nb vectors: 1836
2025-03-13 12:12:24,160 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:24,160 [INFO]: 	compression ratio: 0.9993091170979829
2025-03-13 12:12:24,160 [INFO]: }
2025-03-13 12:12:24,160 [INFO]: 	>>> Finished "Creating the index" in 41.1392 secs
2025-03-13 12:12:24,160 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1679 secs
2025-03-13 12:12:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100100 [episode count 14/20]
[retrieval_preprocessing] for episode 100101 [episode count 15/20], we have num_retrieval=np.int64(1849) num_query=np.int64(103)
2025-03-13 12:12:25,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:25,826 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:25
2025-03-13 12:12:25,826 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2114.06it/s]
2025-03-13 12:12:25,854 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 12:12:25,854 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:12:25,854 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:25
2025-03-13 12:12:25,854 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:25,854 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:12:25,854 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:25,854 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:12:25,854 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:25
2025-03-13 12:12:25,854 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:25,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:12:25,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:25
2025-03-13 12:12:25,855 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:25,855 [INFO]: 	Creating the index 03/13/2025, 12:12:25
2025-03-13 12:12:25,855 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:25
2025-03-13 12:12:25,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:12:25,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:25
2025-03-13 12:12:25,856 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:12:25,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.39it/s]100%|██████████| 8/8 [00:01<00:00,  5.29it/s]100%|██████████| 8/8 [00:01<00:00,  5.57it/s]
2025-03-13 12:12:27,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:27
2025-03-13 12:12:53,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2931 secs
2025-03-13 12:12:53,588 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 12:12:53,588 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.09it/s]
2025-03-13 12:13:08,772 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1842 secs
2025-03-13 12:13:08,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9179 secs
2025-03-13 12:13:08,774 [INFO]: {
2025-03-13 12:13:08,774 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:08,774 [INFO]: 	index_param: efSearch=248
2025-03-13 12:13:08,774 [INFO]: 	index_path: knn.index
2025-03-13 12:13:08,774 [INFO]: 	size in bytes: 363779470
2025-03-13 12:13:08,774 [INFO]: 	avg_search_speed_ms: 12.970468145342188
2025-03-13 12:13:08,774 [INFO]: 	99p_search_speed_ms: 21.591584361158304
2025-03-13 12:13:08,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:08,774 [INFO]: 	nb vectors: 1849
2025-03-13 12:13:08,774 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:08,774 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 12:13:08,774 [INFO]: }
2025-03-13 12:13:08,774 [INFO]: 	>>> Finished "Creating the index" in 42.9193 secs
2025-03-13 12:13:08,774 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9482 secs
2025-03-13 12:13:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 100101 [episode count 15/20]
[retrieval_preprocessing] for episode 100102 [episode count 16/20], we have num_retrieval=np.int64(1800) num_query=np.int64(152)
2025-03-13 12:13:10,048 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:10,340 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:10
2025-03-13 12:13:10,340 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.85it/s]
2025-03-13 12:13:10,367 [INFO]: There are 1800 embeddings of dim 49152
2025-03-13 12:13:10,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 12:13:10,367 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:10
2025-03-13 12:13:10,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:10,367 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:13:10,367 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:10,367 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:10,367 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:10
2025-03-13 12:13:10,367 [INFO]: 371.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:10,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:13:10,367 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:10
2025-03-13 12:13:10,367 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:10,367 [INFO]: 	Creating the index 03/13/2025, 12:13:10
2025-03-13 12:13:10,367 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:10
2025-03-13 12:13:10,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:13:10,369 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:10
2025-03-13 12:13:10,369 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:13:10,369 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.79it/s]100%|██████████| 8/8 [00:01<00:00,  4.86it/s]100%|██████████| 8/8 [00:01<00:00,  5.13it/s]
2025-03-13 12:13:11,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:11
2025-03-13 12:13:36,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8678 secs
2025-03-13 12:13:36,798 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 12:13:36,798 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.36it/s]
2025-03-13 12:13:52,181 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3823 secs
2025-03-13 12:13:52,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8134 secs
2025-03-13 12:13:52,182 [INFO]: {
2025-03-13 12:13:52,182 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:52,182 [INFO]: 	index_param: efSearch=228
2025-03-13 12:13:52,182 [INFO]: 	index_path: knn.index
2025-03-13 12:13:52,182 [INFO]: 	size in bytes: 354139210
2025-03-13 12:13:52,182 [INFO]: 	avg_search_speed_ms: 10.40580822494071
2025-03-13 12:13:52,182 [INFO]: 	99p_search_speed_ms: 18.055801838636395
2025-03-13 12:13:52,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:52,182 [INFO]: 	nb vectors: 1800
2025-03-13 12:13:52,182 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:52,182 [INFO]: 	compression ratio: 0.9993087181732856
2025-03-13 12:13:52,182 [INFO]: }
2025-03-13 12:13:52,182 [INFO]: 	>>> Finished "Creating the index" in 41.8148 secs
2025-03-13 12:13:52,182 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8420 secs
2025-03-13 12:13:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 100102 [episode count 16/20]
[retrieval_preprocessing] for episode 100103 [episode count 17/20], we have num_retrieval=np.int64(1849) num_query=np.int64(103)
2025-03-13 12:13:53,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:54,162 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:54
2025-03-13 12:13:54,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.96it/s]
2025-03-13 12:13:54,193 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 12:13:54,194 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 12:13:54,194 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:54
2025-03-13 12:13:54,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:54,195 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:13:54,195 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:54,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:13:54,195 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:54
2025-03-13 12:13:54,195 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:54,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:13:54,196 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:54
2025-03-13 12:13:54,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:54,196 [INFO]: 	Creating the index 03/13/2025, 12:13:54
2025-03-13 12:13:54,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:54
2025-03-13 12:13:54,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:13:54,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:54
2025-03-13 12:13:54,200 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:13:54,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.15it/s]100%|██████████| 8/8 [00:01<00:00,  5.63it/s]100%|██████████| 8/8 [00:01<00:00,  6.17it/s]
2025-03-13 12:13:55,503 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:55
2025-03-13 12:14:26,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7598 secs
2025-03-13 12:14:26,263 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 12:14:26,263 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-13 12:14:41,650 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3869 secs
2025-03-13 12:14:41,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4512 secs
2025-03-13 12:14:41,651 [INFO]: {
2025-03-13 12:14:41,652 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:41,652 [INFO]: 	index_param: efSearch=200
2025-03-13 12:14:41,652 [INFO]: 	index_path: knn.index
2025-03-13 12:14:41,652 [INFO]: 	size in bytes: 363779470
2025-03-13 12:14:41,652 [INFO]: 	avg_search_speed_ms: 8.578893799641477
2025-03-13 12:14:41,652 [INFO]: 	99p_search_speed_ms: 13.610553136095394
2025-03-13 12:14:41,652 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:41,652 [INFO]: 	nb vectors: 1849
2025-03-13 12:14:41,652 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:41,652 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 12:14:41,652 [INFO]: }
2025-03-13 12:14:41,652 [INFO]: 	>>> Finished "Creating the index" in 47.4553 secs
2025-03-13 12:14:41,652 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4895 secs
2025-03-13 12:14:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100103 [episode count 17/20]
[retrieval_preprocessing] for episode 100104 [episode count 18/20], we have num_retrieval=np.int64(1865) num_query=np.int64(87)
2025-03-13 12:14:42,491 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:42,731 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:42
2025-03-13 12:14:42,731 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1655.21it/s]
2025-03-13 12:14:42,755 [INFO]: There are 1865 embeddings of dim 49152
2025-03-13 12:14:42,755 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 12:14:42,755 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:42
2025-03-13 12:14:42,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:42,756 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:14:42,756 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:42,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:14:42,756 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:42
2025-03-13 12:14:42,756 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:42,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:14:42,757 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:42
2025-03-13 12:14:42,757 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:42,757 [INFO]: 	Creating the index 03/13/2025, 12:14:42
2025-03-13 12:14:42,757 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:42
2025-03-13 12:14:42,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:14:42,760 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:42
2025-03-13 12:14:42,761 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:14:42,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.42it/s]100%|██████████| 8/8 [00:01<00:00,  5.61it/s]100%|██████████| 8/8 [00:01<00:00,  6.15it/s]
2025-03-13 12:14:44,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:44
2025-03-13 12:15:19,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1877 secs
2025-03-13 12:15:19,256 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 12:15:19,256 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-13 12:15:33,038 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7821 secs
2025-03-13 12:15:33,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8471 secs
2025-03-13 12:15:33,608 [INFO]: {
2025-03-13 12:15:33,608 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:33,608 [INFO]: 	index_param: efSearch=161
2025-03-13 12:15:33,608 [INFO]: 	index_path: knn.index
2025-03-13 12:15:33,609 [INFO]: 	size in bytes: 366927490
2025-03-13 12:15:33,609 [INFO]: 	avg_search_speed_ms: 8.35377056308794
2025-03-13 12:15:33,609 [INFO]: 	99p_search_speed_ms: 14.740347713232037
2025-03-13 12:15:33,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:33,609 [INFO]: 	nb vectors: 1865
2025-03-13 12:15:33,609 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:33,609 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-13 12:15:33,609 [INFO]: }
2025-03-13 12:15:33,609 [INFO]: 	>>> Finished "Creating the index" in 50.8521 secs
2025-03-13 12:15:33,609 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8785 secs
2025-03-13 12:15:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 100104 [episode count 18/20]
[retrieval_preprocessing] for episode 100105 [episode count 19/20], we have num_retrieval=np.int64(1867) num_query=np.int64(85)
2025-03-13 12:15:34,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:34,592 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:34
2025-03-13 12:15:34,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.30it/s]
2025-03-13 12:15:34,624 [INFO]: There are 1867 embeddings of dim 49152
2025-03-13 12:15:34,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 12:15:34,625 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:34
2025-03-13 12:15:34,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:34,625 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:15:34,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:34,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:34,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:34
2025-03-13 12:15:34,625 [INFO]: 385.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:34,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:15:34,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:34
2025-03-13 12:15:34,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:34,625 [INFO]: 	Creating the index 03/13/2025, 12:15:34
2025-03-13 12:15:34,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:34
2025-03-13 12:15:34,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:15:34,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:34
2025-03-13 12:15:34,626 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:15:34,626 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.81it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.66it/s]100%|██████████| 8/8 [00:01<00:00,  5.62it/s]
2025-03-13 12:15:36,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:36
2025-03-13 12:15:59,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4706 secs
2025-03-13 12:15:59,524 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:15:59,524 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 12:16:14,934 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4102 secs
2025-03-13 12:16:14,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3094 secs
2025-03-13 12:16:14,936 [INFO]: {
2025-03-13 12:16:14,936 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:14,936 [INFO]: 	index_param: efSearch=258
2025-03-13 12:16:14,936 [INFO]: 	index_path: knn.index
2025-03-13 12:16:14,936 [INFO]: 	size in bytes: 367320970
2025-03-13 12:16:14,936 [INFO]: 	avg_search_speed_ms: 10.221279446469417
2025-03-13 12:16:14,936 [INFO]: 	99p_search_speed_ms: 15.40678285993636
2025-03-13 12:16:14,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:14,936 [INFO]: 	nb vectors: 1867
2025-03-13 12:16:14,936 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:14,936 [INFO]: 	compression ratio: 0.9993089585928078
2025-03-13 12:16:14,936 [INFO]: }
2025-03-13 12:16:14,936 [INFO]: 	>>> Finished "Creating the index" in 40.3113 secs
2025-03-13 12:16:14,936 [INFO]: >>> Finished "Launching the whole pipeline" in 40.3442 secs
2025-03-13 12:16:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 100105 [episode count 19/20]
2025-03-13 12:16:15: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_the_strawberry_forwards [chosen_id count 5/8]
2025-03-13 12:16:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_watermelon_to_the_right [chosen_id count 6/8]
2025-03-13 12:16:17: [retrieval_preprocessing] we have num_total=1571 embedding_dim=49152
[retrieval_preprocessing] for episode 100106 [episode count 0/20], we have num_retrieval=np.int64(1462) num_query=np.int64(109)
2025-03-13 12:16:17,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:17,752 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:17
2025-03-13 12:16:17,752 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1824.40it/s]
2025-03-13 12:16:17,784 [INFO]: There are 1462 embeddings of dim 49152
2025-03-13 12:16:17,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 12:16:17,785 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:17
2025-03-13 12:16:17,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:17,785 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:16:17,785 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:17,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:16:17,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:17
2025-03-13 12:16:17,786 [INFO]: 301.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:17,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:16:17,787 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:17
2025-03-13 12:16:17,787 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:17,787 [INFO]: 	Creating the index 03/13/2025, 12:16:17
2025-03-13 12:16:17,787 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:17
2025-03-13 12:16:17,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:16:17,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:17
2025-03-13 12:16:17,791 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:16:17,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 25.78it/s]100%|██████████| 6/6 [00:01<00:00,  3.95it/s]100%|██████████| 6/6 [00:01<00:00,  4.52it/s]
2025-03-13 12:16:19,124 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:19
2025-03-13 12:16:39,900 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7757 secs
2025-03-13 12:16:39,900 [INFO]: The best hyperparameters are: efSearch=348
2025-03-13 12:16:39,900 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.43it/s]
2025-03-13 12:16:57,609 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7085 secs
2025-03-13 12:16:57,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8199 secs
2025-03-13 12:16:57,611 [INFO]: {
2025-03-13 12:16:57,611 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:57,611 [INFO]: 	index_param: efSearch=348
2025-03-13 12:16:57,611 [INFO]: 	index_path: knn.index
2025-03-13 12:16:57,611 [INFO]: 	size in bytes: 287639710
2025-03-13 12:16:57,611 [INFO]: 	avg_search_speed_ms: 11.815561924774064
2025-03-13 12:16:57,611 [INFO]: 	99p_search_speed_ms: 17.394961467944086
2025-03-13 12:16:57,611 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:57,611 [INFO]: 	nb vectors: 1462
2025-03-13 12:16:57,611 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:57,611 [INFO]: 	compression ratio: 0.9993088089262779
2025-03-13 12:16:57,611 [INFO]: }
2025-03-13 12:16:57,611 [INFO]: 	>>> Finished "Creating the index" in 39.8235 secs
2025-03-13 12:16:57,611 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8583 secs
2025-03-13 12:16:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100106 [episode count 0/20]
[retrieval_preprocessing] for episode 100107 [episode count 1/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-13 12:16:58,924 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:59,205 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:59
2025-03-13 12:16:59,205 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2341.88it/s]
2025-03-13 12:16:59,237 [INFO]: There are 1480 embeddings of dim 49152
2025-03-13 12:16:59,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 12:16:59,237 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:59
2025-03-13 12:16:59,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:59,237 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:16:59,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:59,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:16:59,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:59
2025-03-13 12:16:59,238 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:59,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:16:59,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:59
2025-03-13 12:16:59,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:59,238 [INFO]: 	Creating the index 03/13/2025, 12:16:59
2025-03-13 12:16:59,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:59
2025-03-13 12:16:59,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:16:59,239 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:59
2025-03-13 12:16:59,239 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:16:59,239 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 27.29it/s]100%|██████████| 6/6 [00:01<00:00,  4.52it/s]100%|██████████| 6/6 [00:01<00:00,  5.16it/s]
2025-03-13 12:17:00,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:00
2025-03-13 12:17:27,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9080 secs
2025-03-13 12:17:27,313 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 12:17:27,313 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.74it/s]
2025-03-13 12:17:42,144 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8315 secs
2025-03-13 12:17:42,146 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9070 secs
2025-03-13 12:17:42,146 [INFO]: {
2025-03-13 12:17:42,146 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:42,146 [INFO]: 	index_param: efSearch=230
2025-03-13 12:17:42,146 [INFO]: 	index_path: knn.index
2025-03-13 12:17:42,146 [INFO]: 	size in bytes: 291181150
2025-03-13 12:17:42,146 [INFO]: 	avg_search_speed_ms: 9.403401766501059
2025-03-13 12:17:42,146 [INFO]: 	99p_search_speed_ms: 14.555260161869228
2025-03-13 12:17:42,146 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:42,146 [INFO]: 	nb vectors: 1480
2025-03-13 12:17:42,146 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:42,146 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-13 12:17:42,146 [INFO]: }
2025-03-13 12:17:42,146 [INFO]: 	>>> Finished "Creating the index" in 42.9085 secs
2025-03-13 12:17:42,146 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9415 secs
2025-03-13 12:17:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100107 [episode count 1/20]
[retrieval_preprocessing] for episode 100108 [episode count 2/20], we have num_retrieval=np.int64(1491) num_query=np.int64(80)
2025-03-13 12:17:42,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:43,133 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:43
2025-03-13 12:17:43,133 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.93it/s]
2025-03-13 12:17:43,162 [INFO]: There are 1491 embeddings of dim 49152
2025-03-13 12:17:43,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:17:43,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:43
2025-03-13 12:17:43,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:43,163 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:17:43,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:43,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:17:43,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:43
2025-03-13 12:17:43,163 [INFO]: 307.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:43,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:43,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:43
2025-03-13 12:17:43,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:43,163 [INFO]: 	Creating the index 03/13/2025, 12:17:43
2025-03-13 12:17:43,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:43
2025-03-13 12:17:43,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:17:43,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:43
2025-03-13 12:17:43,164 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:17:43,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.49it/s]100%|██████████| 6/6 [00:01<00:00,  3.64it/s]100%|██████████| 6/6 [00:01<00:00,  3.95it/s]
2025-03-13 12:17:44,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:44
2025-03-13 12:18:13,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1475 secs
2025-03-13 12:18:13,834 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 12:18:13,834 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-13 12:18:25,544 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7105 secs
2025-03-13 12:18:25,546 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3811 secs
2025-03-13 12:18:25,546 [INFO]: {
2025-03-13 12:18:25,546 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:25,546 [INFO]: 	index_param: efSearch=209
2025-03-13 12:18:25,546 [INFO]: 	index_path: knn.index
2025-03-13 12:18:25,546 [INFO]: 	size in bytes: 293345350
2025-03-13 12:18:25,546 [INFO]: 	avg_search_speed_ms: 9.21438000007133
2025-03-13 12:18:25,546 [INFO]: 	99p_search_speed_ms: 12.431989947799595
2025-03-13 12:18:25,546 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:25,546 [INFO]: 	nb vectors: 1491
2025-03-13 12:18:25,546 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:25,546 [INFO]: 	compression ratio: 0.9993085896878884
2025-03-13 12:18:25,546 [INFO]: }
2025-03-13 12:18:25,546 [INFO]: 	>>> Finished "Creating the index" in 42.3826 secs
2025-03-13 12:18:25,546 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4125 secs
2025-03-13 12:18:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 100108 [episode count 2/20]
[retrieval_preprocessing] for episode 100109 [episode count 3/20], we have num_retrieval=np.int64(1487) num_query=np.int64(84)
2025-03-13 12:18:26,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:26,595 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:26
2025-03-13 12:18:26,595 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1231.45it/s]
2025-03-13 12:18:26,856 [INFO]: There are 1487 embeddings of dim 49152
2025-03-13 12:18:26,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2620 secs
2025-03-13 12:18:26,857 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:26
2025-03-13 12:18:26,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:26,858 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:18:26,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:26,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:18:26,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:26
2025-03-13 12:18:26,858 [INFO]: 306.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:26,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:18:26,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:26
2025-03-13 12:18:26,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:26,859 [INFO]: 	Creating the index 03/13/2025, 12:18:26
2025-03-13 12:18:26,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:26
2025-03-13 12:18:26,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:18:26,863 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:26
2025-03-13 12:18:26,863 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:18:26,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.67it/s]100%|██████████| 6/6 [00:01<00:00,  3.25it/s]100%|██████████| 6/6 [00:01<00:00,  3.54it/s]
2025-03-13 12:18:28,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:28
2025-03-13 12:18:52,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4643 secs
2025-03-13 12:18:52,031 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 12:18:52,031 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.94it/s]
2025-03-13 12:19:05,681 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6506 secs
2025-03-13 12:19:05,683 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.8194 secs
2025-03-13 12:19:05,683 [INFO]: {
2025-03-13 12:19:05,683 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:05,683 [INFO]: 	index_param: efSearch=284
2025-03-13 12:19:05,683 [INFO]: 	index_path: knn.index
2025-03-13 12:19:05,683 [INFO]: 	size in bytes: 292558390
2025-03-13 12:19:05,683 [INFO]: 	avg_search_speed_ms: 10.531267533323875
2025-03-13 12:19:05,683 [INFO]: 	99p_search_speed_ms: 14.555058851838112
2025-03-13 12:19:05,683 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:05,683 [INFO]: 	nb vectors: 1487
2025-03-13 12:19:05,683 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:05,683 [INFO]: 	compression ratio: 0.9993085346142355
2025-03-13 12:19:05,683 [INFO]: }
2025-03-13 12:19:05,683 [INFO]: 	>>> Finished "Creating the index" in 38.8236 secs
2025-03-13 12:19:05,683 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0881 secs
2025-03-13 12:19:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 100109 [episode count 3/20]
[retrieval_preprocessing] for episode 100110 [episode count 4/20], we have num_retrieval=np.int64(1502) num_query=np.int64(69)
2025-03-13 12:19:06,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:07,080 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:07
2025-03-13 12:19:07,080 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2619.80it/s]
2025-03-13 12:19:07,099 [INFO]: There are 1502 embeddings of dim 49152
2025-03-13 12:19:07,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0195 secs
2025-03-13 12:19:07,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:07
2025-03-13 12:19:07,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:07,100 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:19:07,100 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:07,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:07,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:07
2025-03-13 12:19:07,100 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:07,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:07,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:07
2025-03-13 12:19:07,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:07,100 [INFO]: 	Creating the index 03/13/2025, 12:19:07
2025-03-13 12:19:07,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:07
2025-03-13 12:19:07,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:19:07,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:07
2025-03-13 12:19:07,101 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:19:07,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.68it/s]100%|██████████| 6/6 [00:01<00:00,  4.42it/s]100%|██████████| 6/6 [00:01<00:00,  4.78it/s]
2025-03-13 12:19:08,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:08
2025-03-13 12:19:33,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2497 secs
2025-03-13 12:19:33,609 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 12:19:33,609 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-13 12:19:46,538 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9292 secs
2025-03-13 12:19:46,539 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.4382 secs
2025-03-13 12:19:46,539 [INFO]: {
2025-03-13 12:19:46,539 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:46,539 [INFO]: 	index_param: efSearch=293
2025-03-13 12:19:46,539 [INFO]: 	index_path: knn.index
2025-03-13 12:19:46,539 [INFO]: 	size in bytes: 295509490
2025-03-13 12:19:46,539 [INFO]: 	avg_search_speed_ms: 10.800959320626268
2025-03-13 12:19:46,539 [INFO]: 	99p_search_speed_ms: 14.580613933503628
2025-03-13 12:19:46,539 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:46,539 [INFO]: 	nb vectors: 1502
2025-03-13 12:19:46,539 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:46,539 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-13 12:19:46,539 [INFO]: }
2025-03-13 12:19:46,539 [INFO]: 	>>> Finished "Creating the index" in 39.4394 secs
2025-03-13 12:19:46,539 [INFO]: >>> Finished "Launching the whole pipeline" in 39.4595 secs
2025-03-13 12:19:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100110 [episode count 4/20]
[retrieval_preprocessing] for episode 100111 [episode count 5/20], we have num_retrieval=np.int64(1497) num_query=np.int64(74)
2025-03-13 12:19:47,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:48,252 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:48
2025-03-13 12:19:48,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1644.18it/s]
2025-03-13 12:19:48,277 [INFO]: There are 1497 embeddings of dim 49152
2025-03-13 12:19:48,277 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 12:19:48,277 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:48
2025-03-13 12:19:48,277 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:48,277 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:19:48,277 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:48,277 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:48,277 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:48
2025-03-13 12:19:48,277 [INFO]: 308.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:48,277 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:48,277 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:48
2025-03-13 12:19:48,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:48,277 [INFO]: 	Creating the index 03/13/2025, 12:19:48
2025-03-13 12:19:48,277 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:48
2025-03-13 12:19:48,278 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:19:48,278 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:48
2025-03-13 12:19:48,278 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:19:48,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 15.76it/s]100%|██████████| 6/6 [00:01<00:00,  3.70it/s]100%|██████████| 6/6 [00:01<00:00,  4.00it/s]
2025-03-13 12:19:49,786 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:49
2025-03-13 12:20:19,987 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2007 secs
2025-03-13 12:20:19,988 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:20:19,988 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 12:20:36,614 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6265 secs
2025-03-13 12:20:36,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3372 secs
2025-03-13 12:20:36,616 [INFO]: {
2025-03-13 12:20:36,616 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:36,616 [INFO]: 	index_param: efSearch=207
2025-03-13 12:20:36,616 [INFO]: 	index_path: knn.index
2025-03-13 12:20:36,616 [INFO]: 	size in bytes: 294525790
2025-03-13 12:20:36,616 [INFO]: 	avg_search_speed_ms: 8.62788593832876
2025-03-13 12:20:36,616 [INFO]: 	99p_search_speed_ms: 12.371525964699694
2025-03-13 12:20:36,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:36,616 [INFO]: 	nb vectors: 1497
2025-03-13 12:20:36,616 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:36,616 [INFO]: 	compression ratio: 0.9993086717465387
2025-03-13 12:20:36,616 [INFO]: }
2025-03-13 12:20:36,616 [INFO]: 	>>> Finished "Creating the index" in 48.3386 secs
2025-03-13 12:20:36,616 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3637 secs
2025-03-13 12:20:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 100111 [episode count 5/20]
[retrieval_preprocessing] for episode 100112 [episode count 6/20], we have num_retrieval=np.int64(1511) num_query=np.int64(60)
2025-03-13 12:20:37,220 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:37,432 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:37
2025-03-13 12:20:37,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.65it/s]
2025-03-13 12:20:37,462 [INFO]: There are 1511 embeddings of dim 49152
2025-03-13 12:20:37,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:20:37,462 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:37,462 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:20:37,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:37,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:20:37,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,462 [INFO]: 311.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:37,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:20:37,462 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:37
2025-03-13 12:20:37,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:37,462 [INFO]: 	Creating the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,462 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:37
2025-03-13 12:20:37,463 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:20:37,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,464 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:20:37,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.43it/s]100%|██████████| 6/6 [00:01<00:00,  3.22it/s]100%|██████████| 6/6 [00:01<00:00,  3.51it/s]
2025-03-13 12:20:39,175 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:39
2025-03-13 12:21:10,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7489 secs
2025-03-13 12:21:10,925 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 12:21:10,925 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 12:21:24,700 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7755 secs
2025-03-13 12:21:24,702 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2380 secs
2025-03-13 12:21:24,702 [INFO]: {
2025-03-13 12:21:24,702 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:24,702 [INFO]: 	index_param: efSearch=209
2025-03-13 12:21:24,702 [INFO]: 	index_path: knn.index
2025-03-13 12:21:24,702 [INFO]: 	size in bytes: 297280150
2025-03-13 12:21:24,702 [INFO]: 	avg_search_speed_ms: 8.705557106764706
2025-03-13 12:21:24,702 [INFO]: 	99p_search_speed_ms: 11.462068893015385
2025-03-13 12:21:24,702 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:24,702 [INFO]: 	nb vectors: 1511
2025-03-13 12:21:24,702 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:24,702 [INFO]: 	compression ratio: 0.9993088606824236
2025-03-13 12:21:24,702 [INFO]: }
2025-03-13 12:21:24,702 [INFO]: 	>>> Finished "Creating the index" in 47.2396 secs
2025-03-13 12:21:24,702 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2695 secs
2025-03-13 12:21:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100112 [episode count 6/20]
[retrieval_preprocessing] for episode 100113 [episode count 7/20], we have num_retrieval=np.int64(1510) num_query=np.int64(61)
2025-03-13 12:21:25,219 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:25,811 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:25
2025-03-13 12:21:25,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-13 12:21:25,848 [INFO]: There are 1510 embeddings of dim 49152
2025-03-13 12:21:25,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 12:21:25,849 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,849 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:25,849 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:21:25,849 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:25,849 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:21:25,849 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,849 [INFO]: 311.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:25,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:21:25,849 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:25
2025-03-13 12:21:25,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:25,850 [INFO]: 	Creating the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,850 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:25
2025-03-13 12:21:25,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 12:21:25,852 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,852 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:21:25,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.72it/s]100%|██████████| 6/6 [00:01<00:00,  3.79it/s]100%|██████████| 6/6 [00:01<00:00,  4.11it/s]
2025-03-13 12:21:27,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:27
2025-03-13 12:21:55,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7248 secs
2025-03-13 12:21:55,044 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 12:21:55,044 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.83it/s]
2025-03-13 12:22:07,231 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1872 secs
2025-03-13 12:22:07,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3805 secs
2025-03-13 12:22:07,233 [INFO]: {
2025-03-13 12:22:07,233 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:07,233 [INFO]: 	index_param: efSearch=196
2025-03-13 12:22:07,233 [INFO]: 	index_path: knn.index
2025-03-13 12:22:07,233 [INFO]: 	size in bytes: 297083410
2025-03-13 12:22:07,233 [INFO]: 	avg_search_speed_ms: 12.038032426224254
2025-03-13 12:22:07,233 [INFO]: 	99p_search_speed_ms: 17.400290467776358
2025-03-13 12:22:07,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:07,233 [INFO]: 	nb vectors: 1510
2025-03-13 12:22:07,233 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:07,233 [INFO]: 	compression ratio: 0.9993088473031867
2025-03-13 12:22:07,233 [INFO]: }
2025-03-13 12:22:07,233 [INFO]: 	>>> Finished "Creating the index" in 41.3832 secs
2025-03-13 12:22:07,233 [INFO]: >>> Finished "Launching the whole pipeline" in 41.4220 secs
2025-03-13 12:22:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100113 [episode count 7/20]
[retrieval_preprocessing] for episode 100114 [episode count 8/20], we have num_retrieval=np.int64(1518) num_query=np.int64(53)
2025-03-13 12:22:07,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:07,998 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:07
2025-03-13 12:22:07,998 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1824.40it/s]
2025-03-13 12:22:08,025 [INFO]: There are 1518 embeddings of dim 49152
2025-03-13 12:22:08,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 12:22:08,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:08
2025-03-13 12:22:08,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:08,026 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:22:08,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:08,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:22:08,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:08
2025-03-13 12:22:08,026 [INFO]: 313.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:08,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:22:08,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:08
2025-03-13 12:22:08,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:08,026 [INFO]: 	Creating the index 03/13/2025, 12:22:08
2025-03-13 12:22:08,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:08
2025-03-13 12:22:08,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:22:08,027 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:08
2025-03-13 12:22:08,027 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:22:08,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.74it/s]100%|██████████| 6/6 [00:01<00:00,  4.30it/s]100%|██████████| 6/6 [00:01<00:00,  4.41it/s]
2025-03-13 12:22:09,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:09
2025-03-13 12:22:34,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5836 secs
2025-03-13 12:22:34,974 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 12:22:34,974 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-13 12:22:49,982 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0087 secs
2025-03-13 12:22:49,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9565 secs
2025-03-13 12:22:49,984 [INFO]: {
2025-03-13 12:22:49,984 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:49,984 [INFO]: 	index_param: efSearch=273
2025-03-13 12:22:49,984 [INFO]: 	index_path: knn.index
2025-03-13 12:22:49,984 [INFO]: 	size in bytes: 298657390
2025-03-13 12:22:49,984 [INFO]: 	avg_search_speed_ms: 9.357741154848805
2025-03-13 12:22:49,984 [INFO]: 	99p_search_speed_ms: 12.432592306286095
2025-03-13 12:22:49,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:49,984 [INFO]: 	nb vectors: 1518
2025-03-13 12:22:49,984 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:49,984 [INFO]: 	compression ratio: 0.9993087530832571
2025-03-13 12:22:49,984 [INFO]: }
2025-03-13 12:22:49,984 [INFO]: 	>>> Finished "Creating the index" in 41.9580 secs
2025-03-13 12:22:49,984 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9862 secs
2025-03-13 12:22:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100114 [episode count 8/20]
[retrieval_preprocessing] for episode 100115 [episode count 9/20], we have num_retrieval=np.int64(1496) num_query=np.int64(75)
2025-03-13 12:22:50,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:50,779 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:50
2025-03-13 12:22:50,779 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-13 12:22:50,809 [INFO]: There are 1496 embeddings of dim 49152
2025-03-13 12:22:50,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 12:22:50,810 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:50
2025-03-13 12:22:50,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:50,810 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:22:50,810 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:50,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:22:50,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:50
2025-03-13 12:22:50,810 [INFO]: 308.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:50,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:22:50,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:50
2025-03-13 12:22:50,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:50,810 [INFO]: 	Creating the index 03/13/2025, 12:22:50
2025-03-13 12:22:50,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:50
2025-03-13 12:22:50,811 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:22:50,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:50
2025-03-13 12:22:50,812 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:22:50,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 17.11it/s]100%|██████████| 6/6 [00:01<00:00,  3.24it/s]100%|██████████| 6/6 [00:01<00:00,  3.52it/s]
2025-03-13 12:22:52,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:52
2025-03-13 12:23:22,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1112 secs
2025-03-13 12:23:22,633 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 12:23:22,633 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-13 12:23:34,943 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3101 secs
2025-03-13 12:23:34,944 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1327 secs
2025-03-13 12:23:34,944 [INFO]: {
2025-03-13 12:23:34,944 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:34,945 [INFO]: 	index_param: efSearch=149
2025-03-13 12:23:34,945 [INFO]: 	index_path: knn.index
2025-03-13 12:23:34,945 [INFO]: 	size in bytes: 294329050
2025-03-13 12:23:34,945 [INFO]: 	avg_search_speed_ms: 7.834509661206596
2025-03-13 12:23:34,945 [INFO]: 	99p_search_speed_ms: 11.654947185888886
2025-03-13 12:23:34,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:34,945 [INFO]: 	nb vectors: 1496
2025-03-13 12:23:34,945 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:34,945 [INFO]: 	compression ratio: 0.999308658115806
2025-03-13 12:23:34,945 [INFO]: }
2025-03-13 12:23:34,945 [INFO]: 	>>> Finished "Creating the index" in 44.1344 secs
2025-03-13 12:23:34,945 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1657 secs
2025-03-13 12:23:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 100115 [episode count 9/20]
[retrieval_preprocessing] for episode 100116 [episode count 10/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-13 12:23:35,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:35,777 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:35
2025-03-13 12:23:35,777 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1809.45it/s]
2025-03-13 12:23:35,807 [INFO]: There are 1480 embeddings of dim 49152
2025-03-13 12:23:35,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 12:23:35,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:35
2025-03-13 12:23:35,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:35,808 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:23:35,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:35,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:35,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:35
2025-03-13 12:23:35,808 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:35,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:23:35,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:35
2025-03-13 12:23:35,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:35,808 [INFO]: 	Creating the index 03/13/2025, 12:23:35
2025-03-13 12:23:35,808 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:35
2025-03-13 12:23:35,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:23:35,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:35
2025-03-13 12:23:35,809 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:23:35,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.38it/s]100%|██████████| 6/6 [00:01<00:00,  3.85it/s]100%|██████████| 6/6 [00:01<00:00,  4.17it/s]
2025-03-13 12:23:37,251 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:37
2025-03-13 12:24:04,729 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4778 secs
2025-03-13 12:24:04,729 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 12:24:04,729 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.82it/s]
2025-03-13 12:24:17,999 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2696 secs
2025-03-13 12:24:18,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1912 secs
2025-03-13 12:24:18,001 [INFO]: {
2025-03-13 12:24:18,001 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:18,001 [INFO]: 	index_param: efSearch=218
2025-03-13 12:24:18,001 [INFO]: 	index_path: knn.index
2025-03-13 12:24:18,001 [INFO]: 	size in bytes: 291181150
2025-03-13 12:24:18,001 [INFO]: 	avg_search_speed_ms: 9.38991995729471
2025-03-13 12:24:18,001 [INFO]: 	99p_search_speed_ms: 12.223361898213623
2025-03-13 12:24:18,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:18,001 [INFO]: 	nb vectors: 1480
2025-03-13 12:24:18,001 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:18,001 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-13 12:24:18,001 [INFO]: }
2025-03-13 12:24:18,001 [INFO]: 	>>> Finished "Creating the index" in 42.1928 secs
2025-03-13 12:24:18,001 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2236 secs
2025-03-13 12:24:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100116 [episode count 10/20]
[retrieval_preprocessing] for episode 100117 [episode count 11/20], we have num_retrieval=np.int64(1477) num_query=np.int64(94)
2025-03-13 12:24:18,953 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:19,178 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:19
2025-03-13 12:24:19,178 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.66it/s]
2025-03-13 12:24:19,208 [INFO]: There are 1477 embeddings of dim 49152
2025-03-13 12:24:19,209 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 12:24:19,209 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:19
2025-03-13 12:24:19,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:19,209 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:24:19,209 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:19,209 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:24:19,209 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:19
2025-03-13 12:24:19,209 [INFO]: 304.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:19,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:19,209 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:19
2025-03-13 12:24:19,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:19,209 [INFO]: 	Creating the index 03/13/2025, 12:24:19
2025-03-13 12:24:19,209 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:19
2025-03-13 12:24:19,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:24:19,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:19
2025-03-13 12:24:19,210 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:24:19,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.28it/s] 67%|██████▋   | 4/6 [00:00<00:00, 20.16it/s]100%|██████████| 6/6 [00:01<00:00,  4.06it/s]
2025-03-13 12:24:20,691 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:20
2025-03-13 12:24:47,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1713 secs
2025-03-13 12:24:47,863 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 12:24:47,863 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.65it/s]
2025-03-13 12:25:03,567 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7041 secs
2025-03-13 12:25:03,569 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3585 secs
2025-03-13 12:25:03,569 [INFO]: {
2025-03-13 12:25:03,569 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:03,569 [INFO]: 	index_param: efSearch=270
2025-03-13 12:25:03,569 [INFO]: 	index_path: knn.index
2025-03-13 12:25:03,569 [INFO]: 	size in bytes: 290590930
2025-03-13 12:25:03,569 [INFO]: 	avg_search_speed_ms: 10.918368657595401
2025-03-13 12:25:03,569 [INFO]: 	99p_search_speed_ms: 16.53688397491351
2025-03-13 12:25:03,569 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:03,569 [INFO]: 	nb vectors: 1477
2025-03-13 12:25:03,569 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:03,569 [INFO]: 	compression ratio: 0.9993086019580859
2025-03-13 12:25:03,569 [INFO]: }
2025-03-13 12:25:03,569 [INFO]: 	>>> Finished "Creating the index" in 44.3599 secs
2025-03-13 12:25:03,569 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3912 secs
2025-03-13 12:25:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 100117 [episode count 11/20]
[retrieval_preprocessing] for episode 100118 [episode count 12/20], we have num_retrieval=np.int64(1512) num_query=np.int64(59)
2025-03-13 12:25:04,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:04,640 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:04
2025-03-13 12:25:04,640 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.06it/s]
2025-03-13 12:25:04,669 [INFO]: There are 1512 embeddings of dim 49152
2025-03-13 12:25:04,669 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:25:04,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:04
2025-03-13 12:25:04,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:04,670 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:25:04,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:04,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:04,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:04
2025-03-13 12:25:04,670 [INFO]: 312.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:04,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:25:04,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:04
2025-03-13 12:25:04,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:04,670 [INFO]: 	Creating the index 03/13/2025, 12:25:04
2025-03-13 12:25:04,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:04
2025-03-13 12:25:04,671 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:25:04,671 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:04
2025-03-13 12:25:04,671 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:25:04,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.12it/s]100%|██████████| 6/6 [00:02<00:00,  2.86it/s]100%|██████████| 6/6 [00:02<00:00,  2.96it/s]
2025-03-13 12:25:06,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:06
2025-03-13 12:25:27,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7716 secs
2025-03-13 12:25:27,474 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 12:25:27,474 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.70it/s]
2025-03-13 12:25:43,662 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1879 secs
2025-03-13 12:25:43,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.9927 secs
2025-03-13 12:25:43,664 [INFO]: {
2025-03-13 12:25:43,664 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:43,664 [INFO]: 	index_param: efSearch=175
2025-03-13 12:25:43,664 [INFO]: 	index_path: knn.index
2025-03-13 12:25:43,664 [INFO]: 	size in bytes: 297476890
2025-03-13 12:25:43,664 [INFO]: 	avg_search_speed_ms: 10.153838369976446
2025-03-13 12:25:43,664 [INFO]: 	99p_search_speed_ms: 18.620554003864513
2025-03-13 12:25:43,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:43,664 [INFO]: 	nb vectors: 1512
2025-03-13 12:25:43,664 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:43,664 [INFO]: 	compression ratio: 0.9993088740439635
2025-03-13 12:25:43,664 [INFO]: }
2025-03-13 12:25:43,664 [INFO]: 	>>> Finished "Creating the index" in 38.9944 secs
2025-03-13 12:25:43,664 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0239 secs
2025-03-13 12:25:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 100118 [episode count 12/20]
[retrieval_preprocessing] for episode 100119 [episode count 13/20], we have num_retrieval=np.int64(1502) num_query=np.int64(69)
2025-03-13 12:25:44,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:44,923 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:44
2025-03-13 12:25:44,923 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1346.05it/s]
2025-03-13 12:25:44,954 [INFO]: There are 1502 embeddings of dim 49152
2025-03-13 12:25:44,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 12:25:44,955 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:44
2025-03-13 12:25:44,955 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:44,955 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:25:44,955 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:44,955 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:25:44,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:44
2025-03-13 12:25:44,956 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:44,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:25:44,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:44
2025-03-13 12:25:44,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:44,956 [INFO]: 	Creating the index 03/13/2025, 12:25:44
2025-03-13 12:25:44,957 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:44
2025-03-13 12:25:44,960 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:25:44,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:44
2025-03-13 12:25:44,960 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:25:44,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.73it/s] 83%|████████▎ | 5/6 [00:00<00:00, 24.62it/s]100%|██████████| 6/6 [00:01<00:00,  3.47it/s]
2025-03-13 12:25:46,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:46
2025-03-13 12:26:16,242 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5442 secs
2025-03-13 12:26:16,243 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 12:26:16,243 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 12:26:30,113 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8707 secs
2025-03-13 12:26:30,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1545 secs
2025-03-13 12:26:30,115 [INFO]: {
2025-03-13 12:26:30,115 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:30,115 [INFO]: 	index_param: efSearch=171
2025-03-13 12:26:30,115 [INFO]: 	index_path: knn.index
2025-03-13 12:26:30,115 [INFO]: 	size in bytes: 295509490
2025-03-13 12:26:30,115 [INFO]: 	avg_search_speed_ms: 8.162352175508834
2025-03-13 12:26:30,115 [INFO]: 	99p_search_speed_ms: 11.54750102199614
2025-03-13 12:26:30,115 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:30,115 [INFO]: 	nb vectors: 1502
2025-03-13 12:26:30,115 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:30,115 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-13 12:26:30,115 [INFO]: }
2025-03-13 12:26:30,115 [INFO]: 	>>> Finished "Creating the index" in 45.1583 secs
2025-03-13 12:26:30,115 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1915 secs
2025-03-13 12:26:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100119 [episode count 13/20]
[retrieval_preprocessing] for episode 100120 [episode count 14/20], we have num_retrieval=np.int64(1492) num_query=np.int64(79)
2025-03-13 12:26:30,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:30,835 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:30
2025-03-13 12:26:30,836 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1811.79it/s]
2025-03-13 12:26:30,862 [INFO]: There are 1492 embeddings of dim 49152
2025-03-13 12:26:30,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:26:30,862 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:30
2025-03-13 12:26:30,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:30,862 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:26:30,862 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:30,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:30,862 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:30
2025-03-13 12:26:30,862 [INFO]: 307.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:30,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:26:30,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:30
2025-03-13 12:26:30,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:30,862 [INFO]: 	Creating the index 03/13/2025, 12:26:30
2025-03-13 12:26:30,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:30
2025-03-13 12:26:30,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:26:30,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:30
2025-03-13 12:26:30,864 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:26:30,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 26.28it/s]100%|██████████| 6/6 [00:01<00:00,  4.38it/s]100%|██████████| 6/6 [00:01<00:00,  5.00it/s]
2025-03-13 12:26:32,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:32
2025-03-13 12:26:58,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2075 secs
2025-03-13 12:26:58,275 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 12:26:58,275 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 12:27:11,934 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6589 secs
2025-03-13 12:27:11,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0725 secs
2025-03-13 12:27:11,936 [INFO]: {
2025-03-13 12:27:11,936 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:11,936 [INFO]: 	index_param: efSearch=248
2025-03-13 12:27:11,936 [INFO]: 	index_path: knn.index
2025-03-13 12:27:11,936 [INFO]: 	size in bytes: 293542090
2025-03-13 12:27:11,936 [INFO]: 	avg_search_speed_ms: 10.87351770965261
2025-03-13 12:27:11,936 [INFO]: 	99p_search_speed_ms: 15.593682129401714
2025-03-13 12:27:11,937 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:11,937 [INFO]: 	nb vectors: 1492
2025-03-13 12:27:11,937 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:11,937 [INFO]: 	compression ratio: 0.9993086034101617
2025-03-13 12:27:11,937 [INFO]: }
2025-03-13 12:27:11,937 [INFO]: 	>>> Finished "Creating the index" in 41.0742 secs
2025-03-13 12:27:11,937 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1012 secs
2025-03-13 12:27:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 100120 [episode count 14/20]
[retrieval_preprocessing] for episode 100121 [episode count 15/20], we have num_retrieval=np.int64(1491) num_query=np.int64(80)
2025-03-13 12:27:12,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:13,008 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:13
2025-03-13 12:27:13,008 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1789.38it/s]
2025-03-13 12:27:13,035 [INFO]: There are 1491 embeddings of dim 49152
2025-03-13 12:27:13,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 12:27:13,036 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:13
2025-03-13 12:27:13,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:13,036 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:27:13,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:13,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:27:13,037 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:13
2025-03-13 12:27:13,037 [INFO]: 307.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:13,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:27:13,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:13
2025-03-13 12:27:13,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:13,038 [INFO]: 	Creating the index 03/13/2025, 12:27:13
2025-03-13 12:27:13,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:13
2025-03-13 12:27:13,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:27:13,041 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:13
2025-03-13 12:27:13,041 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:27:13,041 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 27.93it/s]100%|██████████| 6/6 [00:01<00:00,  3.94it/s]100%|██████████| 6/6 [00:01<00:00,  4.51it/s]
2025-03-13 12:27:14,375 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:14
2025-03-13 12:27:46,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2781 secs
2025-03-13 12:27:46,654 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 12:27:46,654 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 12:28:00,895 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2413 secs
2025-03-13 12:28:00,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8565 secs
2025-03-13 12:28:00,898 [INFO]: {
2025-03-13 12:28:00,898 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:00,898 [INFO]: 	index_param: efSearch=201
2025-03-13 12:28:00,898 [INFO]: 	index_path: knn.index
2025-03-13 12:28:00,898 [INFO]: 	size in bytes: 293345350
2025-03-13 12:28:00,898 [INFO]: 	avg_search_speed_ms: 9.000471283863597
2025-03-13 12:28:00,898 [INFO]: 	99p_search_speed_ms: 12.327824300155049
2025-03-13 12:28:00,898 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:00,898 [INFO]: 	nb vectors: 1491
2025-03-13 12:28:00,898 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:00,898 [INFO]: 	compression ratio: 0.9993085896878884
2025-03-13 12:28:00,898 [INFO]: }
2025-03-13 12:28:00,898 [INFO]: 	>>> Finished "Creating the index" in 47.8601 secs
2025-03-13 12:28:00,898 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8897 secs
2025-03-13 12:28:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 100121 [episode count 15/20]
[retrieval_preprocessing] for episode 100122 [episode count 16/20], we have num_retrieval=np.int64(1487) num_query=np.int64(84)
2025-03-13 12:28:01,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:01,971 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:01
2025-03-13 12:28:01,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1732.47it/s]
2025-03-13 12:28:01,999 [INFO]: There are 1487 embeddings of dim 49152
2025-03-13 12:28:02,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 12:28:02,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:02
2025-03-13 12:28:02,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:02,000 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:28:02,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:02,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:02,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:02
2025-03-13 12:28:02,000 [INFO]: 306.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:02,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:28:02,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:02
2025-03-13 12:28:02,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:02,000 [INFO]: 	Creating the index 03/13/2025, 12:28:02
2025-03-13 12:28:02,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:02
2025-03-13 12:28:02,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:28:02,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:02
2025-03-13 12:28:02,001 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:28:02,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.33it/s]100%|██████████| 6/6 [00:01<00:00,  4.05it/s]100%|██████████| 6/6 [00:01<00:00,  4.39it/s]
2025-03-13 12:28:03,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:03
2025-03-13 12:28:28,501 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1292 secs
2025-03-13 12:28:28,501 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 12:28:28,501 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 12:28:43,058 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5570 secs
2025-03-13 12:28:43,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0581 secs
2025-03-13 12:28:43,060 [INFO]: {
2025-03-13 12:28:43,060 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:43,060 [INFO]: 	index_param: efSearch=250
2025-03-13 12:28:43,060 [INFO]: 	index_path: knn.index
2025-03-13 12:28:43,060 [INFO]: 	size in bytes: 292558390
2025-03-13 12:28:43,060 [INFO]: 	avg_search_speed_ms: 10.020721820649692
2025-03-13 12:28:43,060 [INFO]: 	99p_search_speed_ms: 13.501983433961868
2025-03-13 12:28:43,060 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:43,060 [INFO]: 	nb vectors: 1487
2025-03-13 12:28:43,060 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:43,060 [INFO]: 	compression ratio: 0.9993085346142355
2025-03-13 12:28:43,060 [INFO]: }
2025-03-13 12:28:43,060 [INFO]: 	>>> Finished "Creating the index" in 41.0599 secs
2025-03-13 12:28:43,060 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0890 secs
2025-03-13 12:28:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 100122 [episode count 16/20]
[retrieval_preprocessing] for episode 100123 [episode count 17/20], we have num_retrieval=np.int64(1482) num_query=np.int64(89)
2025-03-13 12:28:43,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:43,986 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:43
2025-03-13 12:28:43,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1285.02it/s]
2025-03-13 12:28:44,015 [INFO]: There are 1482 embeddings of dim 49152
2025-03-13 12:28:44,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 12:28:44,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:44
2025-03-13 12:28:44,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:44,015 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:28:44,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:44,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:44,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:44
2025-03-13 12:28:44,015 [INFO]: 305.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:44,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:28:44,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:44
2025-03-13 12:28:44,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:44,015 [INFO]: 	Creating the index 03/13/2025, 12:28:44
2025-03-13 12:28:44,015 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:44
2025-03-13 12:28:44,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:28:44,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:44
2025-03-13 12:28:44,016 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:28:44,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 17.23it/s]100%|██████████| 6/6 [00:01<00:00,  4.24it/s]100%|██████████| 6/6 [00:01<00:00,  4.58it/s]
2025-03-13 12:28:45,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:45
2025-03-13 12:29:08,838 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3363 secs
2025-03-13 12:29:08,838 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 12:29:08,838 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.55it/s]
2025-03-13 12:29:25,036 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1979 secs
2025-03-13 12:29:25,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6055 secs
2025-03-13 12:29:25,622 [INFO]: {
2025-03-13 12:29:25,622 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:25,622 [INFO]: 	index_param: efSearch=250
2025-03-13 12:29:25,622 [INFO]: 	index_path: knn.index
2025-03-13 12:29:25,622 [INFO]: 	size in bytes: 291574690
2025-03-13 12:29:25,623 [INFO]: 	avg_search_speed_ms: 9.150550175417292
2025-03-13 12:29:25,623 [INFO]: 	99p_search_speed_ms: 12.237407611683008
2025-03-13 12:29:25,623 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:25,623 [INFO]: 	nb vectors: 1482
2025-03-13 12:29:25,623 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:25,623 [INFO]: 	compression ratio: 0.9993084653541088
2025-03-13 12:29:25,623 [INFO]: }
2025-03-13 12:29:25,623 [INFO]: 	>>> Finished "Creating the index" in 41.6076 secs
2025-03-13 12:29:25,623 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6371 secs
2025-03-13 12:29:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 100123 [episode count 17/20]
[retrieval_preprocessing] for episode 100124 [episode count 18/20], we have num_retrieval=np.int64(1492) num_query=np.int64(79)
2025-03-13 12:29:26,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:26,987 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:26
2025-03-13 12:29:26,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1724.63it/s]
2025-03-13 12:29:27,016 [INFO]: There are 1492 embeddings of dim 49152
2025-03-13 12:29:27,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 12:29:27,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:27
2025-03-13 12:29:27,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:27,017 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:29:27,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:27,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:29:27,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:27
2025-03-13 12:29:27,018 [INFO]: 307.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:27,018 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:29:27,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:27
2025-03-13 12:29:27,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:27,018 [INFO]: 	Creating the index 03/13/2025, 12:29:27
2025-03-13 12:29:27,019 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:27
2025-03-13 12:29:27,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:29:27,022 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:27
2025-03-13 12:29:27,022 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:29:27,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.99it/s]100%|██████████| 6/6 [00:01<00:00,  4.14it/s]100%|██████████| 6/6 [00:01<00:00,  4.49it/s]
2025-03-13 12:29:28,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:28
2025-03-13 12:29:58,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1804 secs
2025-03-13 12:29:58,546 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 12:29:58,546 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-13 12:30:12,606 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0597 secs
2025-03-13 12:30:13,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0651 secs
2025-03-13 12:30:13,088 [INFO]: {
2025-03-13 12:30:13,088 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:13,088 [INFO]: 	index_param: efSearch=232
2025-03-13 12:30:13,088 [INFO]: 	index_path: knn.index
2025-03-13 12:30:13,088 [INFO]: 	size in bytes: 293542090
2025-03-13 12:30:13,088 [INFO]: 	avg_search_speed_ms: 10.329438393650777
2025-03-13 12:30:13,088 [INFO]: 	99p_search_speed_ms: 18.67953499313444
2025-03-13 12:30:13,088 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:13,088 [INFO]: 	nb vectors: 1492
2025-03-13 12:30:13,088 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:13,089 [INFO]: 	compression ratio: 0.9993086034101617
2025-03-13 12:30:13,089 [INFO]: }
2025-03-13 12:30:13,089 [INFO]: 	>>> Finished "Creating the index" in 46.0702 secs
2025-03-13 12:30:13,089 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1018 secs
2025-03-13 12:30:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100124 [episode count 18/20]
[retrieval_preprocessing] for episode 100125 [episode count 19/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-13 12:30:13,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:14,060 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:14
2025-03-13 12:30:14,060 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-13 12:30:14,089 [INFO]: There are 1480 embeddings of dim 49152
2025-03-13 12:30:14,089 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:30:14,089 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:14
2025-03-13 12:30:14,089 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:14,089 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 12:30:14,089 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:14,089 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:14,089 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:14
2025-03-13 12:30:14,090 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:14,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:30:14,090 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:14
2025-03-13 12:30:14,090 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:14,090 [INFO]: 	Creating the index 03/13/2025, 12:30:14
2025-03-13 12:30:14,090 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:14
2025-03-13 12:30:14,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:30:14,091 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:14
2025-03-13 12:30:14,091 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:30:14,091 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 16.59it/s]100%|██████████| 6/6 [00:01<00:00,  3.63it/s]100%|██████████| 6/6 [00:01<00:00,  3.94it/s]
2025-03-13 12:30:15,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:15
2025-03-13 12:30:42,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0631 secs
2025-03-13 12:30:42,682 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:30:42,682 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 12:30:57,400 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7185 secs
2025-03-13 12:30:57,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3108 secs
2025-03-13 12:30:57,402 [INFO]: {
2025-03-13 12:30:57,402 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:57,402 [INFO]: 	index_param: efSearch=241
2025-03-13 12:30:57,402 [INFO]: 	index_path: knn.index
2025-03-13 12:30:57,402 [INFO]: 	size in bytes: 291181150
2025-03-13 12:30:57,402 [INFO]: 	avg_search_speed_ms: 9.742168856316773
2025-03-13 12:30:57,402 [INFO]: 	99p_search_speed_ms: 14.997130250558257
2025-03-13 12:30:57,402 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:57,402 [INFO]: 	nb vectors: 1480
2025-03-13 12:30:57,402 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:57,402 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-13 12:30:57,402 [INFO]: }
2025-03-13 12:30:57,402 [INFO]: 	>>> Finished "Creating the index" in 43.3122 secs
2025-03-13 12:30:57,402 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3417 secs
2025-03-13 12:30:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 100125 [episode count 19/20]
2025-03-13 12:30:57: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_watermelon_to_the_right [chosen_id count 6/8]
2025-03-13 12:30:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_pick_up_the_orange_in_the_bowl_and_move_it_to_the_other_container [chosen_id count 7/8]
2025-03-13 12:30:59: [retrieval_preprocessing] we have num_total=2036 embedding_dim=49152
[retrieval_preprocessing] for episode 100126 [episode count 0/20], we have num_retrieval=np.int64(1946) num_query=np.int64(90)
2025-03-13 12:30:59,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:59,843 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:59
2025-03-13 12:30:59,843 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-13 12:30:59,875 [INFO]: There are 1946 embeddings of dim 49152
2025-03-13 12:30:59,875 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 12:30:59,875 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:59
2025-03-13 12:30:59,875 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:59,875 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:30:59,875 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:59,875 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:59,875 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:59
2025-03-13 12:30:59,875 [INFO]: 401.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:59,875 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:30:59,875 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:59
2025-03-13 12:30:59,875 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:59,876 [INFO]: 	Creating the index 03/13/2025, 12:30:59
2025-03-13 12:30:59,876 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:59
2025-03-13 12:30:59,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:30:59,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:59
2025-03-13 12:30:59,877 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:30:59,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.60it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.51it/s]100%|██████████| 8/8 [00:01<00:00,  5.08it/s]
2025-03-13 12:31:01,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:01
2025-03-13 12:31:26,115 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6591 secs
2025-03-13 12:31:26,115 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 12:31:26,115 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 12:31:38,088 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9725 secs
2025-03-13 12:31:38,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.2126 secs
2025-03-13 12:31:38,089 [INFO]: {
2025-03-13 12:31:38,090 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:38,090 [INFO]: 	index_param: efSearch=184
2025-03-13 12:31:38,090 [INFO]: 	index_path: knn.index
2025-03-13 12:31:38,090 [INFO]: 	size in bytes: 382863910
2025-03-13 12:31:38,090 [INFO]: 	avg_search_speed_ms: 8.48092720093422
2025-03-13 12:31:38,090 [INFO]: 	99p_search_speed_ms: 11.017322866246104
2025-03-13 12:31:38,090 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:38,090 [INFO]: 	nb vectors: 1946
2025-03-13 12:31:38,090 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:38,090 [INFO]: 	compression ratio: 0.9993085219236255
2025-03-13 12:31:38,090 [INFO]: }
2025-03-13 12:31:38,090 [INFO]: 	>>> Finished "Creating the index" in 38.2141 secs
2025-03-13 12:31:38,090 [INFO]: >>> Finished "Launching the whole pipeline" in 38.2464 secs
2025-03-13 12:31:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 100126 [episode count 0/20]
[retrieval_preprocessing] for episode 100127 [episode count 1/20], we have num_retrieval=np.int64(1880) num_query=np.int64(156)
2025-03-13 12:31:39,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:39,357 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:39
2025-03-13 12:31:39,357 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-13 12:31:39,383 [INFO]: There are 1880 embeddings of dim 49152
2025-03-13 12:31:39,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:31:39,383 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:39
2025-03-13 12:31:39,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:39,383 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:31:39,383 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:39,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:31:39,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:39
2025-03-13 12:31:39,384 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:39,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:31:39,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:39
2025-03-13 12:31:39,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:39,384 [INFO]: 	Creating the index 03/13/2025, 12:31:39
2025-03-13 12:31:39,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:39
2025-03-13 12:31:39,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:31:39,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:39
2025-03-13 12:31:39,385 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:31:39,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.30it/s]100%|██████████| 8/8 [00:01<00:00,  4.56it/s]100%|██████████| 8/8 [00:01<00:00,  5.02it/s]
2025-03-13 12:31:40,982 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:40
2025-03-13 12:32:01,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.8104 secs
2025-03-13 12:32:01,793 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 12:32:01,793 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-13 12:32:14,955 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1619 secs
2025-03-13 12:32:14,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.5717 secs
2025-03-13 12:32:14,957 [INFO]: {
2025-03-13 12:32:14,957 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:14,957 [INFO]: 	index_param: efSearch=195
2025-03-13 12:32:14,957 [INFO]: 	index_path: knn.index
2025-03-13 12:32:14,957 [INFO]: 	size in bytes: 369878770
2025-03-13 12:32:14,957 [INFO]: 	avg_search_speed_ms: 9.483520616666896
2025-03-13 12:32:14,957 [INFO]: 	99p_search_speed_ms: 13.439665064215665
2025-03-13 12:32:14,957 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:14,957 [INFO]: 	nb vectors: 1880
2025-03-13 12:32:14,957 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:14,957 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-13 12:32:14,957 [INFO]: }
2025-03-13 12:32:14,957 [INFO]: 	>>> Finished "Creating the index" in 35.5734 secs
2025-03-13 12:32:14,957 [INFO]: >>> Finished "Launching the whole pipeline" in 35.6004 secs
2025-03-13 12:32:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 100127 [episode count 1/20]
[retrieval_preprocessing] for episode 100128 [episode count 2/20], we have num_retrieval=np.int64(1953) num_query=np.int64(83)
2025-03-13 12:32:16,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:16,829 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:16
2025-03-13 12:32:16,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.96it/s]
2025-03-13 12:32:16,857 [INFO]: There are 1953 embeddings of dim 49152
2025-03-13 12:32:16,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:32:16,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:16
2025-03-13 12:32:16,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:16,858 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:32:16,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:16,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:16,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:16
2025-03-13 12:32:16,858 [INFO]: 403.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:16,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:16,858 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:16
2025-03-13 12:32:16,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:16,858 [INFO]: 	Creating the index 03/13/2025, 12:32:16
2025-03-13 12:32:16,858 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:16
2025-03-13 12:32:16,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:32:16,859 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:16
2025-03-13 12:32:16,859 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:32:16,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.55it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.15it/s]100%|██████████| 8/8 [00:01<00:00,  4.56it/s]
2025-03-13 12:32:18,616 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:18
2025-03-13 12:32:42,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7115 secs
2025-03-13 12:32:42,329 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 12:32:42,329 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.08it/s]
2025-03-13 12:32:58,747 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4180 secs
2025-03-13 12:32:58,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8888 secs
2025-03-13 12:32:58,748 [INFO]: {
2025-03-13 12:32:58,748 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:58,748 [INFO]: 	index_param: efSearch=157
2025-03-13 12:32:58,748 [INFO]: 	index_path: knn.index
2025-03-13 12:32:58,748 [INFO]: 	size in bytes: 384241090
2025-03-13 12:32:58,748 [INFO]: 	avg_search_speed_ms: 7.141227663084492
2025-03-13 12:32:58,748 [INFO]: 	99p_search_speed_ms: 10.091467993333936
2025-03-13 12:32:58,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:58,748 [INFO]: 	nb vectors: 1953
2025-03-13 12:32:58,748 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:58,748 [INFO]: 	compression ratio: 0.9993085955486958
2025-03-13 12:32:58,748 [INFO]: }
2025-03-13 12:32:58,748 [INFO]: 	>>> Finished "Creating the index" in 41.8902 secs
2025-03-13 12:32:58,748 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9190 secs
2025-03-13 12:32:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100128 [episode count 2/20]
[retrieval_preprocessing] for episode 100129 [episode count 3/20], we have num_retrieval=np.int64(1936) num_query=np.int64(100)
2025-03-13 12:32:59,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:59,849 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:59
2025-03-13 12:32:59,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1972.86it/s]
2025-03-13 12:32:59,872 [INFO]: There are 1936 embeddings of dim 49152
2025-03-13 12:32:59,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 12:32:59,872 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:59
2025-03-13 12:32:59,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:59,872 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:32:59,872 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:59,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:59,872 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:59
2025-03-13 12:32:59,872 [INFO]: 399.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:59,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:32:59,873 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:59
2025-03-13 12:32:59,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:59,873 [INFO]: 	Creating the index 03/13/2025, 12:32:59
2025-03-13 12:32:59,873 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:59
2025-03-13 12:32:59,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:32:59,874 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:59
2025-03-13 12:32:59,874 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:32:59,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.17it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.38it/s]100%|██████████| 8/8 [00:01<00:00,  5.11it/s]
2025-03-13 12:33:01,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:01
2025-03-13 12:33:25,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4466 secs
2025-03-13 12:33:25,891 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:33:25,891 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-13 12:33:41,795 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9039 secs
2025-03-13 12:33:41,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9228 secs
2025-03-13 12:33:41,797 [INFO]: {
2025-03-13 12:33:41,797 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:41,797 [INFO]: 	index_param: efSearch=241
2025-03-13 12:33:41,797 [INFO]: 	index_path: knn.index
2025-03-13 12:33:41,797 [INFO]: 	size in bytes: 380896510
2025-03-13 12:33:41,797 [INFO]: 	avg_search_speed_ms: 10.318113203324815
2025-03-13 12:33:41,797 [INFO]: 	99p_search_speed_ms: 13.501375885680313
2025-03-13 12:33:41,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:41,797 [INFO]: 	nb vectors: 1936
2025-03-13 12:33:41,797 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:41,797 [INFO]: 	compression ratio: 0.9993084158213998
2025-03-13 12:33:41,797 [INFO]: }
2025-03-13 12:33:41,797 [INFO]: 	>>> Finished "Creating the index" in 41.9241 secs
2025-03-13 12:33:41,797 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9475 secs
2025-03-13 12:33:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100129 [episode count 3/20]
[retrieval_preprocessing] for episode 100130 [episode count 4/20], we have num_retrieval=np.int64(1964) num_query=np.int64(72)
2025-03-13 12:33:42,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:43,063 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:43
2025-03-13 12:33:43,063 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2197.12it/s]
2025-03-13 12:33:43,090 [INFO]: There are 1964 embeddings of dim 49152
2025-03-13 12:33:43,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 12:33:43,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:43
2025-03-13 12:33:43,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:43,090 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:33:43,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:43,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:33:43,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:43
2025-03-13 12:33:43,091 [INFO]: 405.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:43,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:33:43,091 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:43
2025-03-13 12:33:43,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:43,091 [INFO]: 	Creating the index 03/13/2025, 12:33:43
2025-03-13 12:33:43,091 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:43
2025-03-13 12:33:43,092 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:33:43,092 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:43
2025-03-13 12:33:43,092 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:33:43,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.18it/s]100%|██████████| 8/8 [00:01<00:00,  5.45it/s]100%|██████████| 8/8 [00:01<00:00,  5.97it/s]
2025-03-13 12:33:44,434 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:44
2025-03-13 12:34:08,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3347 secs
2025-03-13 12:34:08,770 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 12:34:08,770 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 12:34:24,294 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5244 secs
2025-03-13 12:34:24,606 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5143 secs
2025-03-13 12:34:24,607 [INFO]: {
2025-03-13 12:34:24,607 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:24,607 [INFO]: 	index_param: efSearch=219
2025-03-13 12:34:24,607 [INFO]: 	index_path: knn.index
2025-03-13 12:34:24,607 [INFO]: 	size in bytes: 386405230
2025-03-13 12:34:24,607 [INFO]: 	avg_search_speed_ms: 11.017911464369769
2025-03-13 12:34:24,607 [INFO]: 	99p_search_speed_ms: 17.022612488362938
2025-03-13 12:34:24,607 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:24,607 [INFO]: 	nb vectors: 1964
2025-03-13 12:34:24,607 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:24,607 [INFO]: 	compression ratio: 0.999308710184901
2025-03-13 12:34:24,607 [INFO]: }
2025-03-13 12:34:24,607 [INFO]: 	>>> Finished "Creating the index" in 41.5164 secs
2025-03-13 12:34:24,607 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5439 secs
2025-03-13 12:34:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100130 [episode count 4/20]
[retrieval_preprocessing] for episode 100131 [episode count 5/20], we have num_retrieval=np.int64(1922) num_query=np.int64(114)
2025-03-13 12:34:25,412 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:25,662 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:25
2025-03-13 12:34:25,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.91it/s]
2025-03-13 12:34:25,689 [INFO]: There are 1922 embeddings of dim 49152
2025-03-13 12:34:25,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 12:34:25,690 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:25
2025-03-13 12:34:25,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:25,690 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:34:25,690 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:25,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:34:25,690 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:25
2025-03-13 12:34:25,690 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:25,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:34:25,690 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:25
2025-03-13 12:34:25,690 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:25,690 [INFO]: 	Creating the index 03/13/2025, 12:34:25
2025-03-13 12:34:25,690 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:25
2025-03-13 12:34:25,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:34:25,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:25
2025-03-13 12:34:25,691 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:34:25,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.77it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.23it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]
2025-03-13 12:34:27,268 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:27
2025-03-13 12:34:50,834 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5658 secs
2025-03-13 12:34:50,834 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:34:50,835 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.64it/s]
2025-03-13 12:35:03,990 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1546 secs
2025-03-13 12:35:03,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3000 secs
2025-03-13 12:35:03,992 [INFO]: {
2025-03-13 12:35:03,992 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:03,992 [INFO]: 	index_param: efSearch=208
2025-03-13 12:35:03,992 [INFO]: 	index_path: knn.index
2025-03-13 12:35:03,992 [INFO]: 	size in bytes: 378142030
2025-03-13 12:35:03,992 [INFO]: 	avg_search_speed_ms: 9.615947270112184
2025-03-13 12:35:03,992 [INFO]: 	99p_search_speed_ms: 13.84555845288558
2025-03-13 12:35:03,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:03,992 [INFO]: 	nb vectors: 1922
2025-03-13 12:35:03,992 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:03,992 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-13 12:35:03,992 [INFO]: }
2025-03-13 12:35:03,992 [INFO]: 	>>> Finished "Creating the index" in 38.3016 secs
2025-03-13 12:35:03,992 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3298 secs
2025-03-13 12:35:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 100131 [episode count 5/20]
[retrieval_preprocessing] for episode 100132 [episode count 6/20], we have num_retrieval=np.int64(1945) num_query=np.int64(91)
2025-03-13 12:35:05,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:05,645 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:05
2025-03-13 12:35:05,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.32it/s]
2025-03-13 12:35:05,676 [INFO]: There are 1945 embeddings of dim 49152
2025-03-13 12:35:05,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 12:35:05,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,677 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:05,677 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:35:05,677 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:05,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:35:05,677 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,677 [INFO]: 401.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:05,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:35:05,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:05
2025-03-13 12:35:05,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:05,677 [INFO]: 	Creating the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:05
2025-03-13 12:35:05,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:35:05,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,678 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:35:05,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.66it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.48it/s]100%|██████████| 8/8 [00:01<00:00,  4.74it/s]
2025-03-13 12:35:07,368 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:07
2025-03-13 12:35:33,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1984 secs
2025-03-13 12:35:33,567 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 12:35:33,567 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.37it/s]
2025-03-13 12:35:49,113 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5464 secs
2025-03-13 12:35:49,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4369 secs
2025-03-13 12:35:49,115 [INFO]: {
2025-03-13 12:35:49,115 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:49,115 [INFO]: 	index_param: efSearch=204
2025-03-13 12:35:49,115 [INFO]: 	index_path: knn.index
2025-03-13 12:35:49,115 [INFO]: 	size in bytes: 382667170
2025-03-13 12:35:49,115 [INFO]: 	avg_search_speed_ms: 10.069675302538132
2025-03-13 12:35:49,115 [INFO]: 	99p_search_speed_ms: 14.841087805107236
2025-03-13 12:35:49,115 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:49,115 [INFO]: 	nb vectors: 1945
2025-03-13 12:35:49,115 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:49,115 [INFO]: 	compression ratio: 0.9993085113624981
2025-03-13 12:35:49,115 [INFO]: }
2025-03-13 12:35:49,115 [INFO]: 	>>> Finished "Creating the index" in 43.4383 secs
2025-03-13 12:35:49,115 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4706 secs
2025-03-13 12:35:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 100132 [episode count 6/20]
[retrieval_preprocessing] for episode 100133 [episode count 7/20], we have num_retrieval=np.int64(1967) num_query=np.int64(69)
2025-03-13 12:35:50,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:50,312 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:50
2025-03-13 12:35:50,312 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 895.84it/s]
2025-03-13 12:35:50,341 [INFO]: There are 1967 embeddings of dim 49152
2025-03-13 12:35:50,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 12:35:50,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:50
2025-03-13 12:35:50,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:50,343 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:35:50,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:50,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:35:50,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:50
2025-03-13 12:35:50,344 [INFO]: 405.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:50,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:35:50,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:50
2025-03-13 12:35:50,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:50,344 [INFO]: 	Creating the index 03/13/2025, 12:35:50
2025-03-13 12:35:50,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:50
2025-03-13 12:35:50,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:35:50,348 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:50
2025-03-13 12:35:50,348 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:35:50,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.41it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.99it/s]100%|██████████| 8/8 [00:01<00:00,  4.51it/s]
2025-03-13 12:35:52,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:52
2025-03-13 12:36:16,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3213 secs
2025-03-13 12:36:16,449 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 12:36:16,450 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.49it/s]
2025-03-13 12:36:31,251 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8011 secs
2025-03-13 12:36:31,253 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9045 secs
2025-03-13 12:36:31,253 [INFO]: {
2025-03-13 12:36:31,253 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:31,253 [INFO]: 	index_param: efSearch=197
2025-03-13 12:36:31,253 [INFO]: 	index_path: knn.index
2025-03-13 12:36:31,253 [INFO]: 	size in bytes: 386995450
2025-03-13 12:36:31,253 [INFO]: 	avg_search_speed_ms: 9.574968912126273
2025-03-13 12:36:31,253 [INFO]: 	99p_search_speed_ms: 16.36843149550259
2025-03-13 12:36:31,253 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:31,253 [INFO]: 	nb vectors: 1967
2025-03-13 12:36:31,253 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:31,253 [INFO]: 	compression ratio: 0.9993087412268026
2025-03-13 12:36:31,253 [INFO]: }
2025-03-13 12:36:31,253 [INFO]: 	>>> Finished "Creating the index" in 40.9084 secs
2025-03-13 12:36:31,253 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9413 secs
2025-03-13 12:36:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 100133 [episode count 7/20]
[retrieval_preprocessing] for episode 100134 [episode count 8/20], we have num_retrieval=np.int64(1957) num_query=np.int64(79)
2025-03-13 12:36:32,082 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:32,344 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:32
2025-03-13 12:36:32,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.78it/s]
2025-03-13 12:36:32,372 [INFO]: There are 1957 embeddings of dim 49152
2025-03-13 12:36:32,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 12:36:32,372 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:32
2025-03-13 12:36:32,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:32,372 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:36:32,372 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:32,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:36:32,373 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:32
2025-03-13 12:36:32,373 [INFO]: 403.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:32,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:36:32,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:32
2025-03-13 12:36:32,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:32,373 [INFO]: 	Creating the index 03/13/2025, 12:36:32
2025-03-13 12:36:32,373 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:32
2025-03-13 12:36:32,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:36:32,374 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:32
2025-03-13 12:36:32,374 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:36:32,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 20.00it/s]100%|██████████| 8/8 [00:01<00:00,  5.27it/s]100%|██████████| 8/8 [00:01<00:00,  5.57it/s]
2025-03-13 12:36:33,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:33
2025-03-13 12:37:00,501 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6874 secs
2025-03-13 12:37:00,501 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:37:00,501 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.08it/s]
2025-03-13 12:37:16,085 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5833 secs
2025-03-13 12:37:16,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7135 secs
2025-03-13 12:37:16,088 [INFO]: {
2025-03-13 12:37:16,088 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:16,088 [INFO]: 	index_param: efSearch=207
2025-03-13 12:37:16,088 [INFO]: 	index_path: knn.index
2025-03-13 12:37:16,088 [INFO]: 	size in bytes: 385028050
2025-03-13 12:37:16,088 [INFO]: 	avg_search_speed_ms: 11.248687859049088
2025-03-13 12:37:16,088 [INFO]: 	99p_search_speed_ms: 17.031876731198285
2025-03-13 12:37:16,088 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:16,088 [INFO]: 	nb vectors: 1957
2025-03-13 12:37:16,088 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:16,088 [INFO]: 	compression ratio: 0.9993086373836919
2025-03-13 12:37:16,088 [INFO]: }
2025-03-13 12:37:16,088 [INFO]: 	>>> Finished "Creating the index" in 43.7151 secs
2025-03-13 12:37:16,088 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7442 secs
2025-03-13 12:37:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 100134 [episode count 8/20]
[retrieval_preprocessing] for episode 100135 [episode count 9/20], we have num_retrieval=np.int64(1959) num_query=np.int64(77)
2025-03-13 12:37:17,471 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:17,817 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:17
2025-03-13 12:37:17,817 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.08it/s]
2025-03-13 12:37:17,843 [INFO]: There are 1959 embeddings of dim 49152
2025-03-13 12:37:17,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 12:37:17,844 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:17
2025-03-13 12:37:17,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:17,844 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:37:17,844 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:17,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:37:17,844 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:17
2025-03-13 12:37:17,844 [INFO]: 404.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:17,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:37:17,844 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:17
2025-03-13 12:37:17,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:17,844 [INFO]: 	Creating the index 03/13/2025, 12:37:17
2025-03-13 12:37:17,844 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:17
2025-03-13 12:37:17,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:37:17,845 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:17
2025-03-13 12:37:17,845 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:37:17,845 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.58it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.81it/s]100%|██████████| 8/8 [00:01<00:00,  4.70it/s]
2025-03-13 12:37:19,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:19
2025-03-13 12:37:44,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5696 secs
2025-03-13 12:37:44,123 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 12:37:44,123 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 12:37:58,593 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4696 secs
2025-03-13 12:37:58,595 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.7491 secs
2025-03-13 12:37:58,595 [INFO]: {
2025-03-13 12:37:58,595 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:58,595 [INFO]: 	index_param: efSearch=232
2025-03-13 12:37:58,595 [INFO]: 	index_path: knn.index
2025-03-13 12:37:58,595 [INFO]: 	size in bytes: 385421530
2025-03-13 12:37:58,595 [INFO]: 	avg_search_speed_ms: 11.190954582782366
2025-03-13 12:37:58,595 [INFO]: 	99p_search_speed_ms: 14.958386535290622
2025-03-13 12:37:58,595 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:58,595 [INFO]: 	nb vectors: 1959
2025-03-13 12:37:58,595 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:58,595 [INFO]: 	compression ratio: 0.9993086582371254
2025-03-13 12:37:58,595 [INFO]: }
2025-03-13 12:37:58,595 [INFO]: 	>>> Finished "Creating the index" in 40.7506 secs
2025-03-13 12:37:58,595 [INFO]: >>> Finished "Launching the whole pipeline" in 40.7782 secs
2025-03-13 12:37:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100135 [episode count 9/20]
[retrieval_preprocessing] for episode 100136 [episode count 10/20], we have num_retrieval=np.int64(1956) num_query=np.int64(80)
2025-03-13 12:37:59,683 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:00,004 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:00
2025-03-13 12:38:00,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1655.21it/s]
2025-03-13 12:38:00,442 [INFO]: There are 1956 embeddings of dim 49152
2025-03-13 12:38:00,442 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4383 secs
2025-03-13 12:38:00,442 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:00
2025-03-13 12:38:00,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:00,443 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:38:00,443 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:00,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:38:00,443 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:00
2025-03-13 12:38:00,443 [INFO]: 403.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:00,443 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:38:00,443 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:00
2025-03-13 12:38:00,443 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:00,443 [INFO]: 	Creating the index 03/13/2025, 12:38:00
2025-03-13 12:38:00,443 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:00
2025-03-13 12:38:00,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 12:38:00,445 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:00
2025-03-13 12:38:00,445 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:38:00,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.02it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.30it/s]100%|██████████| 8/8 [00:01<00:00,  5.28it/s]
2025-03-13 12:38:01,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:01
2025-03-13 12:38:27,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3690 secs
2025-03-13 12:38:27,334 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 12:38:27,334 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.37it/s]
2025-03-13 12:38:46,734 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3996 secs
2025-03-13 12:38:46,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2901 secs
2025-03-13 12:38:46,735 [INFO]: {
2025-03-13 12:38:46,735 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:46,735 [INFO]: 	index_param: efSearch=242
2025-03-13 12:38:46,735 [INFO]: 	index_path: knn.index
2025-03-13 12:38:46,736 [INFO]: 	size in bytes: 384831310
2025-03-13 12:38:46,736 [INFO]: 	avg_search_speed_ms: 10.93125569461107
2025-03-13 12:38:46,736 [INFO]: 	99p_search_speed_ms: 15.542917158454657
2025-03-13 12:38:46,736 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:46,736 [INFO]: 	nb vectors: 1956
2025-03-13 12:38:46,736 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:46,736 [INFO]: 	compression ratio: 0.9993086269409835
2025-03-13 12:38:46,736 [INFO]: }
2025-03-13 12:38:46,736 [INFO]: 	>>> Finished "Creating the index" in 46.2922 secs
2025-03-13 12:38:46,736 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7317 secs
2025-03-13 12:38:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100136 [episode count 10/20]
[retrieval_preprocessing] for episode 100137 [episode count 11/20], we have num_retrieval=np.int64(1954) num_query=np.int64(82)
2025-03-13 12:38:47,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:48,136 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:48
2025-03-13 12:38:48,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2259.86it/s]
2025-03-13 12:38:48,161 [INFO]: There are 1954 embeddings of dim 49152
2025-03-13 12:38:48,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 12:38:48,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:48
2025-03-13 12:38:48,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:48,162 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:38:48,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:48,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:38:48,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:48
2025-03-13 12:38:48,163 [INFO]: 403.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:48,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:38:48,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:48
2025-03-13 12:38:48,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:48,164 [INFO]: 	Creating the index 03/13/2025, 12:38:48
2025-03-13 12:38:48,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:48
2025-03-13 12:38:48,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:38:48,167 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:48
2025-03-13 12:38:48,167 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:38:48,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.80it/s]100%|██████████| 8/8 [00:01<00:00,  4.77it/s]100%|██████████| 8/8 [00:01<00:00,  5.05it/s]
2025-03-13 12:38:49,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:49
2025-03-13 12:39:15,165 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4074 secs
2025-03-13 12:39:15,166 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 12:39:15,166 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-13 12:39:29,206 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0403 secs
2025-03-13 12:39:29,208 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0413 secs
2025-03-13 12:39:29,208 [INFO]: {
2025-03-13 12:39:29,208 [INFO]: 	index_key: HNSW15
2025-03-13 12:39:29,208 [INFO]: 	index_param: efSearch=226
2025-03-13 12:39:29,208 [INFO]: 	index_path: knn.index
2025-03-13 12:39:29,208 [INFO]: 	size in bytes: 384437830
2025-03-13 12:39:29,208 [INFO]: 	avg_search_speed_ms: 10.287182868377846
2025-03-13 12:39:29,208 [INFO]: 	99p_search_speed_ms: 15.02390630543232
2025-03-13 12:39:29,208 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:29,208 [INFO]: 	nb vectors: 1954
2025-03-13 12:39:29,208 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:29,208 [INFO]: 	compression ratio: 0.9993086060235019
2025-03-13 12:39:29,208 [INFO]: }
2025-03-13 12:39:29,208 [INFO]: 	>>> Finished "Creating the index" in 41.0448 secs
2025-03-13 12:39:29,208 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0726 secs
2025-03-13 12:39:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100137 [episode count 11/20]
[retrieval_preprocessing] for episode 100138 [episode count 12/20], we have num_retrieval=np.int64(1960) num_query=np.int64(76)
2025-03-13 12:39:30,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:30,803 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:30
2025-03-13 12:39:30,803 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1848.53it/s]
2025-03-13 12:39:30,832 [INFO]: There are 1960 embeddings of dim 49152
2025-03-13 12:39:30,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:39:30,832 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:30,832 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:39:30,832 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:30,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:39:30,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,833 [INFO]: 404.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:30,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:39:30,833 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:30
2025-03-13 12:39:30,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:30,833 [INFO]: 	Creating the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,833 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:30
2025-03-13 12:39:30,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:39:30,834 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,834 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:39:30,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.82it/s] 75%|███████▌  | 6/8 [00:00<00:00, 33.20it/s]100%|██████████| 8/8 [00:01<00:00,  4.55it/s]
2025-03-13 12:39:32,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:32
2025-03-13 12:39:56,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0574 secs
2025-03-13 12:39:56,653 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 12:39:56,653 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.69it/s]
2025-03-13 12:40:19,141 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4878 secs
2025-03-13 12:40:19,142 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3086 secs
2025-03-13 12:40:19,142 [INFO]: {
2025-03-13 12:40:19,143 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:19,143 [INFO]: 	index_param: efSearch=211
2025-03-13 12:40:19,143 [INFO]: 	index_path: knn.index
2025-03-13 12:40:19,143 [INFO]: 	size in bytes: 385618270
2025-03-13 12:40:19,143 [INFO]: 	avg_search_speed_ms: 8.537179683756287
2025-03-13 12:40:19,143 [INFO]: 	99p_search_speed_ms: 11.700290464796124
2025-03-13 12:40:19,143 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:19,143 [INFO]: 	nb vectors: 1960
2025-03-13 12:40:19,143 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:19,143 [INFO]: 	compression ratio: 0.9993086686478833
2025-03-13 12:40:19,143 [INFO]: }
2025-03-13 12:40:19,143 [INFO]: 	>>> Finished "Creating the index" in 48.3099 secs
2025-03-13 12:40:19,143 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3393 secs
2025-03-13 12:40:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 100138 [episode count 12/20]
[retrieval_preprocessing] for episode 100139 [episode count 13/20], we have num_retrieval=np.int64(1926) num_query=np.int64(110)
2025-03-13 12:40:19,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:20,058 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:20
2025-03-13 12:40:20,058 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1286.60it/s]
2025-03-13 12:40:20,081 [INFO]: There are 1926 embeddings of dim 49152
2025-03-13 12:40:20,082 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 12:40:20,082 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:20
2025-03-13 12:40:20,082 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:20,082 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:40:20,082 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:20,082 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:40:20,082 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:20
2025-03-13 12:40:20,082 [INFO]: 397.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:20,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:40:20,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:20
2025-03-13 12:40:20,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:20,082 [INFO]: 	Creating the index 03/13/2025, 12:40:20
2025-03-13 12:40:20,082 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:20
2025-03-13 12:40:20,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:40:20,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:20
2025-03-13 12:40:20,083 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:40:20,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.35it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]100%|██████████| 8/8 [00:01<00:00,  5.90it/s]
2025-03-13 12:40:21,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:21
2025-03-13 12:40:54,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1592 secs
2025-03-13 12:40:54,602 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 12:40:54,603 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:54
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.57it/s]
2025-03-13 12:41:09,653 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0505 secs
2025-03-13 12:41:09,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5714 secs
2025-03-13 12:41:09,655 [INFO]: {
2025-03-13 12:41:09,655 [INFO]: 	index_key: HNSW15
2025-03-13 12:41:09,655 [INFO]: 	index_param: efSearch=139
2025-03-13 12:41:09,655 [INFO]: 	index_path: knn.index
2025-03-13 12:41:09,655 [INFO]: 	size in bytes: 378928990
2025-03-13 12:41:09,655 [INFO]: 	avg_search_speed_ms: 8.033663294760578
2025-03-13 12:41:09,655 [INFO]: 	99p_search_speed_ms: 13.353323265910145
2025-03-13 12:41:09,655 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:09,655 [INFO]: 	nb vectors: 1926
2025-03-13 12:41:09,655 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:09,655 [INFO]: 	compression ratio: 0.9993086250803878
2025-03-13 12:41:09,655 [INFO]: }
2025-03-13 12:41:09,655 [INFO]: 	>>> Finished "Creating the index" in 49.5727 secs
2025-03-13 12:41:09,655 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5964 secs
2025-03-13 12:41:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 100139 [episode count 13/20]
[retrieval_preprocessing] for episode 100140 [episode count 14/20], we have num_retrieval=np.int64(1933) num_query=np.int64(103)
2025-03-13 12:41:10,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:41:10,966 [INFO]: Launching the whole pipeline 03/13/2025, 12:41:10
2025-03-13 12:41:10,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:41:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1897.88it/s]
2025-03-13 12:41:11,003 [INFO]: There are 1933 embeddings of dim 49152
2025-03-13 12:41:11,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 12:41:11,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:41:11
2025-03-13 12:41:11,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:41:11,003 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:41:11,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:41:11,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:41:11,003 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:41:11
2025-03-13 12:41:11,003 [INFO]: 398.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:41:11,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:41:11,004 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:41:11
2025-03-13 12:41:11,004 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:41:11,004 [INFO]: 	Creating the index 03/13/2025, 12:41:11
2025-03-13 12:41:11,004 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:41:11
2025-03-13 12:41:11,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:41:11,006 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:41:11
2025-03-13 12:41:11,006 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:41:11,006 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.15it/s]100%|██████████| 8/8 [00:01<00:00,  5.31it/s]100%|██████████| 8/8 [00:01<00:00,  5.83it/s]
2025-03-13 12:41:12,382 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:41:12
2025-03-13 12:41:39,021 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6388 secs
2025-03-13 12:41:39,021 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 12:41:39,021 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.60s/it] 75%|███████▌  | 3/4 [00:01<00:00,  1.79it/s]
2025-03-13 12:41:58,750 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7288 secs
2025-03-13 12:41:58,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7457 secs
2025-03-13 12:41:58,752 [INFO]: {
2025-03-13 12:41:58,752 [INFO]: 	index_key: HNSW15
2025-03-13 12:41:58,752 [INFO]: 	index_param: efSearch=148
2025-03-13 12:41:58,752 [INFO]: 	index_path: knn.index
2025-03-13 12:41:58,752 [INFO]: 	size in bytes: 380306290
2025-03-13 12:41:58,752 [INFO]: 	avg_search_speed_ms: 8.205524774671664
2025-03-13 12:41:58,752 [INFO]: 	99p_search_speed_ms: 11.817207899875939
2025-03-13 12:41:58,752 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:58,752 [INFO]: 	nb vectors: 1933
2025-03-13 12:41:58,752 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:58,752 [INFO]: 	compression ratio: 0.9993083837766659
2025-03-13 12:41:58,752 [INFO]: }
2025-03-13 12:41:58,752 [INFO]: 	>>> Finished "Creating the index" in 47.7480 secs
2025-03-13 12:41:58,752 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7861 secs
2025-03-13 12:41:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100140 [episode count 14/20]
[retrieval_preprocessing] for episode 100141 [episode count 15/20], we have num_retrieval=np.int64(1943) num_query=np.int64(93)
2025-03-13 12:41:59,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:00,129 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:00
2025-03-13 12:42:00,129 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1672.37it/s]
2025-03-13 12:42:00,161 [INFO]: There are 1943 embeddings of dim 49152
2025-03-13 12:42:00,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 12:42:00,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:00
2025-03-13 12:42:00,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:00,162 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:42:00,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:00,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:42:00,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:00
2025-03-13 12:42:00,163 [INFO]: 401.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:00,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:42:00,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:00
2025-03-13 12:42:00,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:00,164 [INFO]: 	Creating the index 03/13/2025, 12:42:00
2025-03-13 12:42:00,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:00
2025-03-13 12:42:00,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:42:00,167 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:00
2025-03-13 12:42:00,167 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:42:00,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.67it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.16it/s]100%|██████████| 8/8 [00:01<00:00,  4.56it/s]
2025-03-13 12:42:01,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:01
2025-03-13 12:42:44,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1262 secs
2025-03-13 12:42:44,055 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 12:42:44,055 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.98it/s]
2025-03-13 12:42:58,656 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6005 secs
2025-03-13 12:42:58,658 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4909 secs
2025-03-13 12:42:58,658 [INFO]: {
2025-03-13 12:42:58,658 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:58,658 [INFO]: 	index_param: efSearch=169
2025-03-13 12:42:58,658 [INFO]: 	index_path: knn.index
2025-03-13 12:42:58,658 [INFO]: 	size in bytes: 382273690
2025-03-13 12:42:58,658 [INFO]: 	avg_search_speed_ms: 9.941978788810594
2025-03-13 12:42:58,658 [INFO]: 	99p_search_speed_ms: 13.900965568609541
2025-03-13 12:42:58,658 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:58,658 [INFO]: 	nb vectors: 1943
2025-03-13 12:42:58,658 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:58,658 [INFO]: 	compression ratio: 0.9993084902076311
2025-03-13 12:42:58,658 [INFO]: }
2025-03-13 12:42:58,658 [INFO]: 	>>> Finished "Creating the index" in 58.4945 secs
2025-03-13 12:42:58,658 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5287 secs
2025-03-13 12:42:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100141 [episode count 15/20]
[retrieval_preprocessing] for episode 100142 [episode count 16/20], we have num_retrieval=np.int64(1905) num_query=np.int64(131)
2025-03-13 12:42:59,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:00,095 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:00
2025-03-13 12:43:00,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1659.14it/s]
2025-03-13 12:43:00,127 [INFO]: There are 1905 embeddings of dim 49152
2025-03-13 12:43:00,127 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 12:43:00,127 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:00
2025-03-13 12:43:00,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:00,127 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:43:00,127 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:00,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:43:00,127 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:00
2025-03-13 12:43:00,127 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:00,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:43:00,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:00
2025-03-13 12:43:00,128 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:00,128 [INFO]: 	Creating the index 03/13/2025, 12:43:00
2025-03-13 12:43:00,128 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:00
2025-03-13 12:43:00,129 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:43:00,129 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:00
2025-03-13 12:43:00,129 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:43:00,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.55it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.39it/s]100%|██████████| 8/8 [00:01<00:00,  4.58it/s]
2025-03-13 12:43:01,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:01
2025-03-13 12:43:28,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7056 secs
2025-03-13 12:43:28,586 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 12:43:28,586 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.46it/s]
2025-03-13 12:43:43,736 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1496 secs
2025-03-13 12:43:43,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6086 secs
2025-03-13 12:43:43,737 [INFO]: {
2025-03-13 12:43:43,737 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:43,737 [INFO]: 	index_param: efSearch=256
2025-03-13 12:43:43,737 [INFO]: 	index_path: knn.index
2025-03-13 12:43:43,737 [INFO]: 	size in bytes: 374797450
2025-03-13 12:43:43,737 [INFO]: 	avg_search_speed_ms: 11.383709203466704
2025-03-13 12:43:43,737 [INFO]: 	99p_search_speed_ms: 16.18623792193831
2025-03-13 12:43:43,738 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:43,738 [INFO]: 	nb vectors: 1905
2025-03-13 12:43:43,738 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:43,738 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 12:43:43,738 [INFO]: }
2025-03-13 12:43:43,738 [INFO]: 	>>> Finished "Creating the index" in 43.6099 secs
2025-03-13 12:43:43,738 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6427 secs
2025-03-13 12:43:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 100142 [episode count 16/20]
[retrieval_preprocessing] for episode 100143 [episode count 17/20], we have num_retrieval=np.int64(1953) num_query=np.int64(83)
2025-03-13 12:43:45,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:45,615 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:45
2025-03-13 12:43:45,615 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.57it/s]
2025-03-13 12:43:45,650 [INFO]: There are 1953 embeddings of dim 49152
2025-03-13 12:43:45,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 12:43:45,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:45,650 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:43:45,650 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:45,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:43:45,650 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,651 [INFO]: 403.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:45,651 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:43:45,651 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:45
2025-03-13 12:43:45,651 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:45,651 [INFO]: 	Creating the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,651 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:45
2025-03-13 12:43:45,652 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:43:45,652 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,652 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:43:45,653 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.79it/s]100%|██████████| 8/8 [00:01<00:00,  4.26it/s]100%|██████████| 8/8 [00:01<00:00,  4.51it/s]
2025-03-13 12:43:47,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:47
2025-03-13 12:44:11,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2797 secs
2025-03-13 12:44:11,709 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 12:44:11,710 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.63it/s]
2025-03-13 12:44:24,610 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9004 secs
2025-03-13 12:44:24,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.9591 secs
2025-03-13 12:44:24,612 [INFO]: {
2025-03-13 12:44:24,612 [INFO]: 	index_key: HNSW15
2025-03-13 12:44:24,612 [INFO]: 	index_param: efSearch=221
2025-03-13 12:44:24,612 [INFO]: 	index_path: knn.index
2025-03-13 12:44:24,612 [INFO]: 	size in bytes: 384241090
2025-03-13 12:44:24,612 [INFO]: 	avg_search_speed_ms: 9.993818586228878
2025-03-13 12:44:24,612 [INFO]: 	99p_search_speed_ms: 14.692032942548394
2025-03-13 12:44:24,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:44:24,612 [INFO]: 	nb vectors: 1953
2025-03-13 12:44:24,612 [INFO]: 	vectors dimension: 49152
2025-03-13 12:44:24,612 [INFO]: 	compression ratio: 0.9993085955486958
2025-03-13 12:44:24,612 [INFO]: }
2025-03-13 12:44:24,612 [INFO]: 	>>> Finished "Creating the index" in 38.9607 secs
2025-03-13 12:44:24,612 [INFO]: >>> Finished "Launching the whole pipeline" in 38.9965 secs
2025-03-13 12:44:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100143 [episode count 17/20]
[retrieval_preprocessing] for episode 100144 [episode count 18/20], we have num_retrieval=np.int64(1946) num_query=np.int64(90)
2025-03-13 12:44:25,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:25,789 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:25
2025-03-13 12:44:25,790 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.72it/s]
2025-03-13 12:44:25,816 [INFO]: There are 1946 embeddings of dim 49152
2025-03-13 12:44:25,816 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:44:25,816 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:25
2025-03-13 12:44:25,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:25,816 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 12:44:25,816 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:25,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:44:25,816 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:25
2025-03-13 12:44:25,816 [INFO]: 401.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:25,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:44:25,816 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:25
2025-03-13 12:44:25,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:25,816 [INFO]: 	Creating the index 03/13/2025, 12:44:25
2025-03-13 12:44:25,816 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:25
2025-03-13 12:44:25,817 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:44:25,817 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:25
2025-03-13 12:44:25,817 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:44:25,817 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.52it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.71it/s]100%|██████████| 8/8 [00:01<00:00,  4.99it/s]
2025-03-13 12:44:27,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:27
2025-03-13 12:44:52,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9092 secs
2025-03-13 12:44:52,335 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 12:44:52,335 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.65s/it] 50%|█████     | 2/4 [00:04<00:03,  1.80s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.40s/it]
2025-03-13 12:45:11,007 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6720 secs
2025-03-13 12:45:11,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1912 secs
2025-03-13 12:45:11,009 [INFO]: {
2025-03-13 12:45:11,009 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:11,009 [INFO]: 	index_param: efSearch=211
2025-03-13 12:45:11,009 [INFO]: 	index_path: knn.index
2025-03-13 12:45:11,009 [INFO]: 	size in bytes: 382863910
2025-03-13 12:45:11,009 [INFO]: 	avg_search_speed_ms: 10.253035065719903
2025-03-13 12:45:11,009 [INFO]: 	99p_search_speed_ms: 15.335635340306908
2025-03-13 12:45:11,009 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:11,009 [INFO]: 	nb vectors: 1946
2025-03-13 12:45:11,009 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:11,009 [INFO]: 	compression ratio: 0.9993085219236255
2025-03-13 12:45:11,009 [INFO]: }
2025-03-13 12:45:11,009 [INFO]: 	>>> Finished "Creating the index" in 45.1925 secs
2025-03-13 12:45:11,009 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2194 secs
2025-03-13 12:45:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 100144 [episode count 18/20]
[retrieval_preprocessing] for episode 100145 [episode count 19/20], we have num_retrieval=np.int64(1779) num_query=np.int64(257)
2025-03-13 12:45:11,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:12,301 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:12
2025-03-13 12:45:12,301 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2091.92it/s]
2025-03-13 12:45:12,331 [INFO]: There are 1779 embeddings of dim 49152
2025-03-13 12:45:12,331 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 12:45:12,331 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,331 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:12,331 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 12:45:12,331 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:12,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:45:12,331 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,331 [INFO]: 367.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:12,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:45:12,331 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:12
2025-03-13 12:45:12,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:12,331 [INFO]: 	Creating the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,331 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:12
2025-03-13 12:45:12,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:45:12,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:12
2025-03-13 12:45:12,333 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 12:45:12,333 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.88it/s]100%|██████████| 8/8 [00:01<00:00,  5.49it/s]100%|██████████| 8/8 [00:01<00:00,  5.78it/s]
2025-03-13 12:45:13,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:13
2025-03-13 12:45:37,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6182 secs
2025-03-13 12:45:37,338 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 12:45:37,338 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.01it/s]
2025-03-13 12:45:52,913 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5743 secs
2025-03-13 12:45:52,914 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.5820 secs
2025-03-13 12:45:52,915 [INFO]: {
2025-03-13 12:45:52,915 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:52,915 [INFO]: 	index_param: efSearch=203
2025-03-13 12:45:52,915 [INFO]: 	index_path: knn.index
2025-03-13 12:45:52,915 [INFO]: 	size in bytes: 350007610
2025-03-13 12:45:52,915 [INFO]: 	avg_search_speed_ms: 11.896590422617447
2025-03-13 12:45:52,915 [INFO]: 	99p_search_speed_ms: 19.207008834928274
2025-03-13 12:45:52,915 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:52,915 [INFO]: 	nb vectors: 1779
2025-03-13 12:45:52,915 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:52,915 [INFO]: 	compression ratio: 0.9993086493176534
2025-03-13 12:45:52,915 [INFO]: }
2025-03-13 12:45:52,915 [INFO]: 	>>> Finished "Creating the index" in 40.5835 secs
2025-03-13 12:45:52,915 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6143 secs
2025-03-13 12:45:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 100145 [episode count 19/20]
2025-03-13 12:45:55: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_orange_in_the_bowl_and_move_it_to_the_other_container [chosen_id count 7/8]
2025-03-13 12:45:55: [retrieval_preprocessing] done for embedding_type='wrist_image'!
done!
