nohup: ignoring input
2025-03-13 14:51:33: [retrieval_preprocessing] starting retrieval preprocessing for wrist_image
2025-03-13 14:51:35: [retrieval_preprocessing] concatenated all embeddings and indices for 19 episodes for collected_demos_training/2025-03-10_pick_up_the_apple_and_put_it_in_the_bowl [chosen_id count 0/8]
2025-03-13 14:51:35: [retrieval_preprocessing] we have num_total=2340 embedding_dim=49152
[retrieval_preprocessing] for episode 100000 [episode count 0/19], we have num_retrieval=np.int64(2197) num_query=np.int64(143)
2025-03-13 14:51:35,983 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:36,371 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:36
2025-03-13 14:51:36,371 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 775.43it/s]
2025-03-13 14:51:36,406 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 14:51:36,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 14:51:36,406 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,406 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:36,406 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:51:36,406 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:36,406 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:51:36,406 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,407 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:36,407 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 14:51:36,407 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:36
2025-03-13 14:51:36,407 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:36,407 [INFO]: 	Creating the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,407 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:36
2025-03-13 14:51:36,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:51:36,409 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,409 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:51:36,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.95it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.45it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.09it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.45it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.69it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.91it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.94it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.98it/s]100%|██████████| 9/9 [00:02<00:00,  1.59it/s]100%|██████████| 9/9 [00:02<00:00,  3.21it/s]
2025-03-13 14:51:39,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:39
2025-03-13 14:52:09,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3622 secs
2025-03-13 14:52:09,582 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 14:52:09,582 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.94it/s]
2025-03-13 14:52:29,177 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5946 secs
2025-03-13 14:52:29,179 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7705 secs
2025-03-13 14:52:29,179 [INFO]: {
2025-03-13 14:52:29,179 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:29,179 [INFO]: 	index_param: efSearch=195
2025-03-13 14:52:29,180 [INFO]: 	index_path: knn.index
2025-03-13 14:52:29,180 [INFO]: 	size in bytes: 432246490
2025-03-13 14:52:29,180 [INFO]: 	avg_search_speed_ms: 10.190267773738148
2025-03-13 14:52:29,180 [INFO]: 	99p_search_speed_ms: 14.499264955520637
2025-03-13 14:52:29,180 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:29,180 [INFO]: 	nb vectors: 2197
2025-03-13 14:52:29,180 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:29,180 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 14:52:29,180 [INFO]: }
2025-03-13 14:52:29,180 [INFO]: 	>>> Finished "Creating the index" in 52.7723 secs
2025-03-13 14:52:29,180 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8088 secs
2025-03-13 14:52:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100000 [episode count 0/19]
[retrieval_preprocessing] for episode 100001 [episode count 1/19], we have num_retrieval=np.int64(2208) num_query=np.int64(132)
2025-03-13 14:52:31,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:31,716 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:31
2025-03-13 14:52:31,716 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1490.51it/s]
2025-03-13 14:52:31,740 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 14:52:31,740 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 14:52:31,740 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:31
2025-03-13 14:52:31,740 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:31,740 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:52:31,740 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:31,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:31,740 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:31
2025-03-13 14:52:31,740 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:31,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:52:31,740 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:31
2025-03-13 14:52:31,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:31,740 [INFO]: 	Creating the index 03/13/2025, 14:52:31
2025-03-13 14:52:31,741 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:31
2025-03-13 14:52:31,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:52:31,742 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:31
2025-03-13 14:52:31,742 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:52:31,742 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.46it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.01it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.33it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.91it/s]100%|██████████| 9/9 [00:03<00:00,  2.02it/s]100%|██████████| 9/9 [00:03<00:00,  2.99it/s]
2025-03-13 14:52:34,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:34
2025-03-13 14:53:07,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0452 secs
2025-03-13 14:53:07,810 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 14:53:07,810 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 14:53:29,792 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9822 secs
2025-03-13 14:53:29,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0524 secs
2025-03-13 14:53:29,794 [INFO]: {
2025-03-13 14:53:29,794 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:29,794 [INFO]: 	index_param: efSearch=221
2025-03-13 14:53:29,794 [INFO]: 	index_path: knn.index
2025-03-13 14:53:29,794 [INFO]: 	size in bytes: 434410630
2025-03-13 14:53:29,794 [INFO]: 	avg_search_speed_ms: 10.309344864469598
2025-03-13 14:53:29,794 [INFO]: 	99p_search_speed_ms: 14.524508530739693
2025-03-13 14:53:29,794 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:29,794 [INFO]: 	nb vectors: 2208
2025-03-13 14:53:29,794 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:29,794 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 14:53:29,794 [INFO]: }
2025-03-13 14:53:29,794 [INFO]: 	>>> Finished "Creating the index" in 58.0538 secs
2025-03-13 14:53:29,794 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0785 secs
2025-03-13 14:53:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100001 [episode count 1/19]
[retrieval_preprocessing] for episode 100002 [episode count 2/19], we have num_retrieval=np.int64(2231) num_query=np.int64(109)
2025-03-13 14:53:31,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:32,649 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:32
2025-03-13 14:53:32,649 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1643.54it/s]
2025-03-13 14:53:32,674 [INFO]: There are 2231 embeddings of dim 49152
2025-03-13 14:53:32,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 14:53:32,674 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:32,674 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:53:32,674 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:32,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:32,674 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,675 [INFO]: 460.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:32,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:32,675 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:32
2025-03-13 14:53:32,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:32,675 [INFO]: 	Creating the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,675 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:32
2025-03-13 14:53:32,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:53:32,676 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:32
2025-03-13 14:53:32,676 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:53:32,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.13it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.95it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.83it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.24it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.61it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.77it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.73it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.59it/s]100%|██████████| 9/9 [00:02<00:00,  1.82it/s]100%|██████████| 9/9 [00:02<00:00,  3.64it/s]
2025-03-13 14:53:35,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:35
2025-03-13 14:54:01,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5445 secs
2025-03-13 14:54:01,705 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 14:54:01,705 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 14:54:21,027 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3218 secs
2025-03-13 14:54:21,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3533 secs
2025-03-13 14:54:21,030 [INFO]: {
2025-03-13 14:54:21,030 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:21,030 [INFO]: 	index_param: efSearch=209
2025-03-13 14:54:21,030 [INFO]: 	index_path: knn.index
2025-03-13 14:54:21,030 [INFO]: 	size in bytes: 438935650
2025-03-13 14:54:21,030 [INFO]: 	avg_search_speed_ms: 9.067278092554817
2025-03-13 14:54:21,030 [INFO]: 	99p_search_speed_ms: 11.838490031659605
2025-03-13 14:54:21,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:21,030 [INFO]: 	nb vectors: 2231
2025-03-13 14:54:21,030 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:21,030 [INFO]: 	compression ratio: 0.9993092335972255
2025-03-13 14:54:21,030 [INFO]: }
2025-03-13 14:54:21,030 [INFO]: 	>>> Finished "Creating the index" in 48.3550 secs
2025-03-13 14:54:21,030 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3806 secs
2025-03-13 14:54:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 100002 [episode count 2/19]
[retrieval_preprocessing] for episode 100003 [episode count 3/19], we have num_retrieval=np.int64(2236) num_query=np.int64(104)
2025-03-13 14:54:22,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:24,059 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:24
2025-03-13 14:54:24,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.83it/s]
2025-03-13 14:54:24,094 [INFO]: There are 2236 embeddings of dim 49152
2025-03-13 14:54:24,094 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 14:54:24,094 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:24
2025-03-13 14:54:24,094 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:24,094 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:54:24,094 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:24,094 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:54:24,094 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:24
2025-03-13 14:54:24,094 [INFO]: 461.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:24,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:54:24,095 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:24
2025-03-13 14:54:24,095 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:24,095 [INFO]: 	Creating the index 03/13/2025, 14:54:24
2025-03-13 14:54:24,095 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:24
2025-03-13 14:54:24,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:54:24,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:24
2025-03-13 14:54:24,096 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:54:24,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.94it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.86it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.94it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.21it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.35it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.15it/s]100%|██████████| 9/9 [00:02<00:00,  1.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.16it/s]
2025-03-13 14:54:26,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:26
2025-03-13 14:54:54,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5694 secs
2025-03-13 14:54:54,523 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 14:54:54,523 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:06<00:19,  6.42s/it] 50%|█████     | 2/4 [00:08<00:07,  3.99s/it] 75%|███████▌  | 3/4 [00:10<00:02,  2.95s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.23s/it]
2025-03-13 14:55:32,283 [INFO]: 	>>> Finished "Compute fast metrics" in 37.7603 secs
2025-03-13 14:55:32,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1898 secs
2025-03-13 14:55:32,286 [INFO]: {
2025-03-13 14:55:32,286 [INFO]: 	index_key: HNSW15
2025-03-13 14:55:32,286 [INFO]: 	index_param: efSearch=165
2025-03-13 14:55:32,286 [INFO]: 	index_path: knn.index
2025-03-13 14:55:32,286 [INFO]: 	size in bytes: 439919350
2025-03-13 14:55:32,286 [INFO]: 	avg_search_speed_ms: 7.879151508044759
2025-03-13 14:55:32,286 [INFO]: 	99p_search_speed_ms: 10.139539185911415
2025-03-13 14:55:32,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:32,286 [INFO]: 	nb vectors: 2236
2025-03-13 14:55:32,286 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:32,286 [INFO]: 	compression ratio: 0.9993092779392404
2025-03-13 14:55:32,286 [INFO]: }
2025-03-13 14:55:32,286 [INFO]: 	>>> Finished "Creating the index" in 68.1915 secs
2025-03-13 14:55:32,286 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2270 secs
2025-03-13 14:55:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 100003 [episode count 3/19]
[retrieval_preprocessing] for episode 100004 [episode count 4/19], we have num_retrieval=np.int64(2240) num_query=np.int64(100)
2025-03-13 14:55:34,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:35,049 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:35
2025-03-13 14:55:35,049 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1609.48it/s]
2025-03-13 14:55:35,072 [INFO]: There are 2240 embeddings of dim 49152
2025-03-13 14:55:35,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 14:55:35,072 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:35
2025-03-13 14:55:35,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:35,072 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:55:35,072 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:35,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:55:35,072 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:35
2025-03-13 14:55:35,072 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:35,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:55:35,072 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:35
2025-03-13 14:55:35,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:35,072 [INFO]: 	Creating the index 03/13/2025, 14:55:35
2025-03-13 14:55:35,072 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:35
2025-03-13 14:55:35,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:55:35,073 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:35
2025-03-13 14:55:35,073 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:55:35,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:17,  2.25s/it] 33%|███▎      | 3/9 [00:02<00:03,  1.51it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.75it/s] 78%|███████▊  | 7/9 [00:02<00:00,  3.98it/s] 89%|████████▉ | 8/9 [00:02<00:00,  4.28it/s]100%|██████████| 9/9 [00:04<00:00,  1.50it/s]100%|██████████| 9/9 [00:04<00:00,  1.81it/s]
2025-03-13 14:55:40,058 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:40
2025-03-13 14:56:15,416 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3571 secs
2025-03-13 14:56:15,416 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 14:56:15,416 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.81s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.08it/s] 75%|███████▌  | 3/4 [00:04<00:01,  1.34s/it]
2025-03-13 14:56:45,225 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8085 secs
2025-03-13 14:56:45,228 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1542 secs
2025-03-13 14:56:45,228 [INFO]: {
2025-03-13 14:56:45,228 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:45,228 [INFO]: 	index_param: efSearch=159
2025-03-13 14:56:45,228 [INFO]: 	index_path: knn.index
2025-03-13 14:56:45,228 [INFO]: 	size in bytes: 440706310
2025-03-13 14:56:45,228 [INFO]: 	avg_search_speed_ms: 7.573816413765378
2025-03-13 14:56:45,228 [INFO]: 	99p_search_speed_ms: 11.480735619552409
2025-03-13 14:56:45,228 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:45,228 [INFO]: 	nb vectors: 2240
2025-03-13 14:56:45,228 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:45,228 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-13 14:56:45,228 [INFO]: }
2025-03-13 14:56:45,228 [INFO]: 	>>> Finished "Creating the index" in 70.1556 secs
2025-03-13 14:56:45,228 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1791 secs
2025-03-13 14:56:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 100004 [episode count 4/19]
[retrieval_preprocessing] for episode 100005 [episode count 5/19], we have num_retrieval=np.int64(2241) num_query=np.int64(99)
2025-03-13 14:56:56,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:56,705 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:56
2025-03-13 14:56:56,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.05it/s]
2025-03-13 14:56:56,736 [INFO]: There are 2241 embeddings of dim 49152
2025-03-13 14:56:56,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 14:56:56,737 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:56
2025-03-13 14:56:56,737 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:56,737 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:56:56,737 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:56,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:56:56,737 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:56
2025-03-13 14:56:56,738 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:56,738 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:56:56,738 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:56
2025-03-13 14:56:56,738 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:56,739 [INFO]: 	Creating the index 03/13/2025, 14:56:56
2025-03-13 14:56:56,739 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:56
2025-03-13 14:56:56,742 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:56:56,742 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:56
2025-03-13 14:56:56,742 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:56:56,742 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.22it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.52it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.83it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.80it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.54it/s] 67%|██████▋   | 6/9 [00:00<00:00,  6.34it/s] 78%|███████▊  | 7/9 [00:01<00:00,  5.94it/s] 89%|████████▉ | 8/9 [00:01<00:00,  5.76it/s]100%|██████████| 9/9 [00:03<00:00,  1.16it/s]100%|██████████| 9/9 [00:03<00:00,  2.44it/s]
2025-03-13 14:57:00,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:00
2025-03-13 14:57:35,266 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8158 secs
2025-03-13 14:57:35,266 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 14:57:35,266 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.09s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.33it/s]
2025-03-13 14:58:01,764 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4972 secs
2025-03-13 14:58:01,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0240 secs
2025-03-13 14:58:01,766 [INFO]: {
2025-03-13 14:58:01,766 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:01,766 [INFO]: 	index_param: efSearch=172
2025-03-13 14:58:01,766 [INFO]: 	index_path: knn.index
2025-03-13 14:58:01,766 [INFO]: 	size in bytes: 440903050
2025-03-13 14:58:01,766 [INFO]: 	avg_search_speed_ms: 8.317985401268794
2025-03-13 14:58:01,766 [INFO]: 	99p_search_speed_ms: 12.191062760539353
2025-03-13 14:58:01,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:01,766 [INFO]: 	nb vectors: 2241
2025-03-13 14:58:01,766 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:01,766 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-13 14:58:01,766 [INFO]: }
2025-03-13 14:58:01,766 [INFO]: 	>>> Finished "Creating the index" in 65.0278 secs
2025-03-13 14:58:01,766 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0611 secs
2025-03-13 14:58:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 100005 [episode count 5/19]
[retrieval_preprocessing] for episode 100006 [episode count 6/19], we have num_retrieval=np.int64(2196) num_query=np.int64(144)
2025-03-13 14:58:03,502 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:03,946 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:03
2025-03-13 14:58:03,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-13 14:58:03,971 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 14:58:03,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 14:58:03,972 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:03
2025-03-13 14:58:03,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:03,972 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:58:03,972 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:03,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:58:03,972 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:03
2025-03-13 14:58:03,972 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:03,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:58:03,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:03
2025-03-13 14:58:03,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:03,972 [INFO]: 	Creating the index 03/13/2025, 14:58:03
2025-03-13 14:58:03,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:03
2025-03-13 14:58:03,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:58:03,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:03
2025-03-13 14:58:03,973 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:58:03,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.24it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.25it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.95it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.52it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.95it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.33it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.33it/s]100%|██████████| 9/9 [00:02<00:00,  1.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.19it/s]
2025-03-13 14:58:06,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:06
2025-03-13 14:58:41,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7189 secs
2025-03-13 14:58:41,521 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 14:58:41,521 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.65it/s] 50%|█████     | 2/4 [00:00<00:00,  3.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.34it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.86it/s]
2025-03-13 14:58:59,213 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6913 secs
2025-03-13 14:58:59,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2415 secs
2025-03-13 14:58:59,215 [INFO]: {
2025-03-13 14:58:59,215 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:59,215 [INFO]: 	index_param: efSearch=158
2025-03-13 14:58:59,215 [INFO]: 	index_path: knn.index
2025-03-13 14:58:59,215 [INFO]: 	size in bytes: 432049750
2025-03-13 14:58:59,215 [INFO]: 	avg_search_speed_ms: 9.745509005841557
2025-03-13 14:58:59,215 [INFO]: 	99p_search_speed_ms: 15.688491926994175
2025-03-13 14:58:59,215 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:59,215 [INFO]: 	nb vectors: 2196
2025-03-13 14:58:59,215 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:59,215 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 14:58:59,215 [INFO]: }
2025-03-13 14:58:59,215 [INFO]: 	>>> Finished "Creating the index" in 55.2430 secs
2025-03-13 14:58:59,215 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2694 secs
2025-03-13 14:58:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 100006 [episode count 6/19]
[retrieval_preprocessing] for episode 100007 [episode count 7/19], we have num_retrieval=np.int64(2185) num_query=np.int64(155)
2025-03-13 14:59:01,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:02,420 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:02
2025-03-13 14:59:02,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.98it/s]
2025-03-13 14:59:02,444 [INFO]: There are 2185 embeddings of dim 49152
2025-03-13 14:59:02,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 14:59:02,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:02,444 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:59:02,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:02,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:02,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,444 [INFO]: 450.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:02,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:59:02,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:02
2025-03-13 14:59:02,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:02,445 [INFO]: 	Creating the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,445 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:02
2025-03-13 14:59:02,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:59:02,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,446 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:59:02,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.17it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.59it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.19it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.39it/s]100%|██████████| 9/9 [00:02<00:00,  2.42it/s]100%|██████████| 9/9 [00:02<00:00,  3.46it/s]
2025-03-13 14:59:05,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:05
2025-03-13 14:59:33,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2709 secs
2025-03-13 14:59:33,321 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 14:59:33,321 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  5.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 14:59:52,613 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2916 secs
2025-03-13 14:59:52,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4745 secs
2025-03-13 14:59:52,921 [INFO]: {
2025-03-13 14:59:52,921 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:52,921 [INFO]: 	index_param: efSearch=117
2025-03-13 14:59:52,921 [INFO]: 	index_path: knn.index
2025-03-13 14:59:52,921 [INFO]: 	size in bytes: 429885490
2025-03-13 14:59:52,921 [INFO]: 	avg_search_speed_ms: 8.18127506308154
2025-03-13 14:59:52,921 [INFO]: 	99p_search_speed_ms: 17.23454814637074
2025-03-13 14:59:52,921 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:52,921 [INFO]: 	nb vectors: 2185
2025-03-13 14:59:52,921 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:52,921 [INFO]: 	compression ratio: 0.9993090950801805
2025-03-13 14:59:52,921 [INFO]: }
2025-03-13 14:59:52,921 [INFO]: 	>>> Finished "Creating the index" in 50.4768 secs
2025-03-13 14:59:52,921 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5012 secs
2025-03-13 14:59:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100007 [episode count 7/19]
[retrieval_preprocessing] for episode 100008 [episode count 8/19], we have num_retrieval=np.int64(2178) num_query=np.int64(162)
2025-03-13 14:59:55,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:55,998 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:55
2025-03-13 14:59:55,998 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.87it/s]
2025-03-13 14:59:56,025 [INFO]: There are 2178 embeddings of dim 49152
2025-03-13 14:59:56,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 14:59:56,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:56
2025-03-13 14:59:56,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:56,026 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:59:56,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:56,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:56,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:56
2025-03-13 14:59:56,026 [INFO]: 449.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:56,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:56,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:56
2025-03-13 14:59:56,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:56,026 [INFO]: 	Creating the index 03/13/2025, 14:59:56
2025-03-13 14:59:56,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:56
2025-03-13 14:59:56,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:59:56,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:56
2025-03-13 14:59:56,028 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:59:56,028 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.69it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.39it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.23it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.73it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.28it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.42it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.50it/s]100%|██████████| 9/9 [00:02<00:00,  1.72it/s]100%|██████████| 9/9 [00:02<00:00,  3.38it/s]
2025-03-13 14:59:58,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:58
2025-03-13 15:00:35,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1321 secs
2025-03-13 15:00:35,825 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 15:00:35,825 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s]
2025-03-13 15:00:53,104 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2785 secs
2025-03-13 15:00:53,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0801 secs
2025-03-13 15:00:53,108 [INFO]: {
2025-03-13 15:00:53,108 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:53,108 [INFO]: 	index_param: efSearch=125
2025-03-13 15:00:53,108 [INFO]: 	index_path: knn.index
2025-03-13 15:00:53,108 [INFO]: 	size in bytes: 428508310
2025-03-13 15:00:53,108 [INFO]: 	avg_search_speed_ms: 8.859332267110846
2025-03-13 15:00:53,108 [INFO]: 	99p_search_speed_ms: 18.595745451748375
2025-03-13 15:00:53,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:53,108 [INFO]: 	nb vectors: 2178
2025-03-13 15:00:53,108 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:53,108 [INFO]: 	compression ratio: 0.9993090309030414
2025-03-13 15:00:53,108 [INFO]: }
2025-03-13 15:00:53,109 [INFO]: 	>>> Finished "Creating the index" in 57.0821 secs
2025-03-13 15:00:53,109 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1101 secs
2025-03-13 15:00:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100008 [episode count 8/19]
[retrieval_preprocessing] for episode 100009 [episode count 9/19], we have num_retrieval=np.int64(2243) num_query=np.int64(97)
2025-03-13 15:01:02,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:03,431 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:03
2025-03-13 15:01:03,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 596.12it/s]
2025-03-13 15:01:03,489 [INFO]: There are 2243 embeddings of dim 49152
2025-03-13 15:01:03,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0577 secs
2025-03-13 15:01:03,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:03
2025-03-13 15:01:03,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:03,490 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:01:03,490 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:03,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:01:03,490 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:03
2025-03-13 15:01:03,490 [INFO]: 462.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:03,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:01:03,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:03
2025-03-13 15:01:03,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:03,490 [INFO]: 	Creating the index 03/13/2025, 15:01:03
2025-03-13 15:01:03,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:03
2025-03-13 15:01:03,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:01:03,492 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:03
2025-03-13 15:01:03,492 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:01:03,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.46it/s] 56%|█████▌    | 5/9 [00:00<00:00, 26.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.26it/s]100%|██████████| 9/9 [00:02<00:00,  3.87it/s]
2025-03-13 15:01:05,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:05
2025-03-13 15:01:43,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8319 secs
2025-03-13 15:01:43,654 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 15:01:43,654 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.04it/s]
2025-03-13 15:02:12,203 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5488 secs
2025-03-13 15:02:12,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7125 secs
2025-03-13 15:02:12,205 [INFO]: {
2025-03-13 15:02:12,205 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:12,205 [INFO]: 	index_param: efSearch=161
2025-03-13 15:02:12,205 [INFO]: 	index_path: knn.index
2025-03-13 15:02:12,205 [INFO]: 	size in bytes: 441296530
2025-03-13 15:02:12,205 [INFO]: 	avg_search_speed_ms: 8.973216400753222
2025-03-13 15:02:12,205 [INFO]: 	99p_search_speed_ms: 16.025629299692685
2025-03-13 15:02:12,205 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:12,205 [INFO]: 	nb vectors: 2243
2025-03-13 15:02:12,205 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:12,205 [INFO]: 	compression ratio: 0.9993093396859477
2025-03-13 15:02:12,205 [INFO]: }
2025-03-13 15:02:12,205 [INFO]: 	>>> Finished "Creating the index" in 68.7150 secs
2025-03-13 15:02:12,205 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7739 secs
2025-03-13 15:02:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100009 [episode count 9/19]
[retrieval_preprocessing] for episode 100010 [episode count 10/19], we have num_retrieval=np.int64(2247) num_query=np.int64(93)
2025-03-13 15:02:13,336 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:13,670 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:13
2025-03-13 15:02:13,670 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.90it/s]
2025-03-13 15:02:13,707 [INFO]: There are 2247 embeddings of dim 49152
2025-03-13 15:02:13,708 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 15:02:13,708 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:13
2025-03-13 15:02:13,708 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:13,708 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:02:13,709 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:13,709 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:02:13,709 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:13
2025-03-13 15:02:13,709 [INFO]: 463.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:13,709 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:02:13,710 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:13
2025-03-13 15:02:13,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:13,710 [INFO]: 	Creating the index 03/13/2025, 15:02:13
2025-03-13 15:02:13,710 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:13
2025-03-13 15:02:13,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:02:13,714 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:13
2025-03-13 15:02:13,714 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:02:13,714 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.78it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.58it/s]100%|██████████| 9/9 [00:01<00:00,  4.77it/s]
2025-03-13 15:02:15,607 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:15
2025-03-13 15:02:49,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8689 secs
2025-03-13 15:02:49,477 [INFO]: The best hyperparameters are: efSearch=82
2025-03-13 15:02:49,477 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 15:03:06,282 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8050 secs
2025-03-13 15:03:07,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3983 secs
2025-03-13 15:03:07,112 [INFO]: {
2025-03-13 15:03:07,113 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:07,113 [INFO]: 	index_param: efSearch=82
2025-03-13 15:03:07,113 [INFO]: 	index_path: knn.index
2025-03-13 15:03:07,113 [INFO]: 	size in bytes: 442083490
2025-03-13 15:03:07,113 [INFO]: 	avg_search_speed_ms: 6.295124897692277
2025-03-13 15:03:07,113 [INFO]: 	99p_search_speed_ms: 9.424271939788005
2025-03-13 15:03:07,113 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:07,113 [INFO]: 	nb vectors: 2247
2025-03-13 15:03:07,113 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:07,113 [INFO]: 	compression ratio: 0.9993093747970547
2025-03-13 15:03:07,113 [INFO]: }
2025-03-13 15:03:07,113 [INFO]: 	>>> Finished "Creating the index" in 53.4034 secs
2025-03-13 15:03:07,114 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4434 secs
2025-03-13 15:03:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100010 [episode count 10/19]
[retrieval_preprocessing] for episode 100011 [episode count 11/19], we have num_retrieval=np.int64(2270) num_query=np.int64(70)
2025-03-13 15:03:08,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:08,632 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:08
2025-03-13 15:03:08,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.55it/s]
2025-03-13 15:03:08,681 [INFO]: There are 2270 embeddings of dim 49152
2025-03-13 15:03:08,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0488 secs
2025-03-13 15:03:08,681 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:08
2025-03-13 15:03:08,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:08,682 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:03:08,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:08,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:03:08,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:08
2025-03-13 15:03:08,682 [INFO]: 468.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:08,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:03:08,682 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:08
2025-03-13 15:03:08,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:08,682 [INFO]: 	Creating the index 03/13/2025, 15:03:08
2025-03-13 15:03:08,682 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:08
2025-03-13 15:03:08,683 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:03:08,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:08
2025-03-13 15:03:08,684 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:03:08,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.84it/s] 56%|█████▌    | 5/9 [00:00<00:00, 21.13it/s]100%|██████████| 9/9 [00:02<00:00,  2.94it/s]100%|██████████| 9/9 [00:02<00:00,  3.47it/s]
2025-03-13 15:03:11,281 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:11
2025-03-13 15:03:45,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5312 secs
2025-03-13 15:03:45,813 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 15:03:45,814 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.67it/s]
2025-03-13 15:04:04,152 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3386 secs
2025-03-13 15:04:04,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4708 secs
2025-03-13 15:04:04,155 [INFO]: {
2025-03-13 15:04:04,155 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:04,155 [INFO]: 	index_param: efSearch=181
2025-03-13 15:04:04,155 [INFO]: 	index_path: knn.index
2025-03-13 15:04:04,155 [INFO]: 	size in bytes: 446608570
2025-03-13 15:04:04,155 [INFO]: 	avg_search_speed_ms: 12.359992410741258
2025-03-13 15:04:04,155 [INFO]: 	99p_search_speed_ms: 21.35739182122049
2025-03-13 15:04:04,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:04,155 [INFO]: 	nb vectors: 2270
2025-03-13 15:04:04,155 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:04,155 [INFO]: 	compression ratio: 0.9993094400315695
2025-03-13 15:04:04,155 [INFO]: }
2025-03-13 15:04:04,155 [INFO]: 	>>> Finished "Creating the index" in 55.4729 secs
2025-03-13 15:04:04,155 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5225 secs
2025-03-13 15:04:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 100011 [episode count 11/19]
[retrieval_preprocessing] for episode 100012 [episode count 12/19], we have num_retrieval=np.int64(2246) num_query=np.int64(94)
2025-03-13 15:04:05,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:05,561 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:05
2025-03-13 15:04:05,562 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.03it/s]
2025-03-13 15:04:05,604 [INFO]: There are 2246 embeddings of dim 49152
2025-03-13 15:04:05,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0427 secs
2025-03-13 15:04:05,605 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:05
2025-03-13 15:04:05,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:05,605 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:04:05,605 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:05,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:04:05,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:05
2025-03-13 15:04:05,606 [INFO]: 463.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:05,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:04:05,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:05
2025-03-13 15:04:05,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:05,606 [INFO]: 	Creating the index 03/13/2025, 15:04:05
2025-03-13 15:04:05,607 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:05
2025-03-13 15:04:05,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:04:05,610 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:05
2025-03-13 15:04:05,611 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:04:05,611 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.90it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.37it/s]100%|██████████| 9/9 [00:02<00:00,  2.74it/s]100%|██████████| 9/9 [00:02<00:00,  3.50it/s]
2025-03-13 15:04:08,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:08
2025-03-13 15:04:49,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9151 secs
2025-03-13 15:04:49,104 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 15:04:49,104 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.17it/s]
2025-03-13 15:05:03,550 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4463 secs
2025-03-13 15:05:03,553 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9424 secs
2025-03-13 15:05:03,553 [INFO]: {
2025-03-13 15:05:03,553 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:03,553 [INFO]: 	index_param: efSearch=131
2025-03-13 15:05:03,553 [INFO]: 	index_path: knn.index
2025-03-13 15:05:03,553 [INFO]: 	size in bytes: 441886750
2025-03-13 15:05:03,553 [INFO]: 	avg_search_speed_ms: 9.184762945824582
2025-03-13 15:05:03,553 [INFO]: 	99p_search_speed_ms: 14.597706571221336
2025-03-13 15:05:03,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:03,553 [INFO]: 	nb vectors: 2246
2025-03-13 15:05:03,553 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:03,553 [INFO]: 	compression ratio: 0.9993093660310023
2025-03-13 15:05:03,553 [INFO]: }
2025-03-13 15:05:03,553 [INFO]: 	>>> Finished "Creating the index" in 57.9468 secs
2025-03-13 15:05:03,553 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9919 secs
2025-03-13 15:05:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 100012 [episode count 12/19]
[retrieval_preprocessing] for episode 100013 [episode count 13/19], we have num_retrieval=np.int64(2245) num_query=np.int64(95)
2025-03-13 15:05:04,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:05,196 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:05
2025-03-13 15:05:05,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.19it/s]
2025-03-13 15:05:05,235 [INFO]: There are 2245 embeddings of dim 49152
2025-03-13 15:05:05,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 15:05:05,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:05
2025-03-13 15:05:05,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:05,236 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:05:05,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:05,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:05:05,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:05
2025-03-13 15:05:05,236 [INFO]: 463.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:05,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:05:05,236 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:05
2025-03-13 15:05:05,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:05,236 [INFO]: 	Creating the index 03/13/2025, 15:05:05
2025-03-13 15:05:05,236 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:05
2025-03-13 15:05:05,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:05:05,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:05
2025-03-13 15:05:05,237 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:05:05,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.99it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.70it/s]100%|██████████| 9/9 [00:02<00:00,  4.40it/s]
2025-03-13 15:05:07,287 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:07
2025-03-13 15:05:41,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2601 secs
2025-03-13 15:05:41,548 [INFO]: The best hyperparameters are: efSearch=88
2025-03-13 15:05:41,548 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 15:06:00,504 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9559 secs
2025-03-13 15:06:00,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2690 secs
2025-03-13 15:06:00,506 [INFO]: {
2025-03-13 15:06:00,506 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:00,506 [INFO]: 	index_param: efSearch=88
2025-03-13 15:06:00,506 [INFO]: 	index_path: knn.index
2025-03-13 15:06:00,506 [INFO]: 	size in bytes: 441690010
2025-03-13 15:06:00,506 [INFO]: 	avg_search_speed_ms: 6.299305748882238
2025-03-13 15:06:00,506 [INFO]: 	99p_search_speed_ms: 8.931913818232712
2025-03-13 15:06:00,506 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:00,506 [INFO]: 	nb vectors: 2245
2025-03-13 15:06:00,507 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:00,507 [INFO]: 	compression ratio: 0.9993093572571405
2025-03-13 15:06:00,507 [INFO]: }
2025-03-13 15:06:00,507 [INFO]: 	>>> Finished "Creating the index" in 55.2707 secs
2025-03-13 15:06:00,507 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3109 secs
2025-03-13 15:06:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 100013 [episode count 13/19]
[retrieval_preprocessing] for episode 100014 [episode count 14/19], we have num_retrieval=np.int64(2079) num_query=np.int64(261)
2025-03-13 15:06:01,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:01,841 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:01
2025-03-13 15:06:01,841 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1949.03it/s]
2025-03-13 15:06:01,876 [INFO]: There are 2079 embeddings of dim 49152
2025-03-13 15:06:01,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 15:06:01,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:01,876 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:06:01,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:01,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:01,876 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,876 [INFO]: 429.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:01,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:06:01,876 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:01
2025-03-13 15:06:01,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:01,877 [INFO]: 	Creating the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,877 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:01
2025-03-13 15:06:01,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:06:01,878 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,878 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:06:01,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.45it/s] 44%|████▍     | 4/9 [00:00<00:00, 19.09it/s] 89%|████████▉ | 8/9 [00:00<00:00, 27.19it/s]100%|██████████| 9/9 [00:01<00:00,  4.74it/s]
2025-03-13 15:06:03,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:03
2025-03-13 15:06:34,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1095 secs
2025-03-13 15:06:34,892 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 15:06:34,892 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-13 15:07:01,329 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4375 secs
2025-03-13 15:07:01,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4536 secs
2025-03-13 15:07:01,331 [INFO]: {
2025-03-13 15:07:01,331 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:01,331 [INFO]: 	index_param: efSearch=197
2025-03-13 15:07:01,331 [INFO]: 	index_path: knn.index
2025-03-13 15:07:01,332 [INFO]: 	size in bytes: 409030630
2025-03-13 15:07:01,332 [INFO]: 	avg_search_speed_ms: 9.940070737519896
2025-03-13 15:07:01,332 [INFO]: 	99p_search_speed_ms: 15.467009355779739
2025-03-13 15:07:01,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:01,332 [INFO]: 	nb vectors: 2079
2025-03-13 15:07:01,332 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:01,332 [INFO]: 	compression ratio: 0.9993091030859963
2025-03-13 15:07:01,332 [INFO]: }
2025-03-13 15:07:01,332 [INFO]: 	>>> Finished "Creating the index" in 59.4551 secs
2025-03-13 15:07:01,332 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4910 secs
2025-03-13 15:07:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 100014 [episode count 14/19]
[retrieval_preprocessing] for episode 100015 [episode count 15/19], we have num_retrieval=np.int64(2240) num_query=np.int64(100)
2025-03-13 15:07:03,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:04,098 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:04
2025-03-13 15:07:04,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 902.19it/s]
2025-03-13 15:07:04,136 [INFO]: There are 2240 embeddings of dim 49152
2025-03-13 15:07:04,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 15:07:04,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:04
2025-03-13 15:07:04,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:04,136 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:07:04,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:04,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:04,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:04
2025-03-13 15:07:04,136 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:04,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:04,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:04
2025-03-13 15:07:04,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:04,137 [INFO]: 	Creating the index 03/13/2025, 15:07:04
2025-03-13 15:07:04,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:04
2025-03-13 15:07:04,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:07:04,138 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:04
2025-03-13 15:07:04,138 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:07:04,138 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.74it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.98it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]100%|██████████| 9/9 [00:02<00:00,  3.77it/s]
2025-03-13 15:07:06,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:06
2025-03-13 15:07:46,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8521 secs
2025-03-13 15:07:46,386 [INFO]: The best hyperparameters are: efSearch=104
2025-03-13 15:07:46,386 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.64it/s]
2025-03-13 15:08:04,474 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0882 secs
2025-03-13 15:08:04,476 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3384 secs
2025-03-13 15:08:04,477 [INFO]: {
2025-03-13 15:08:04,477 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:04,477 [INFO]: 	index_param: efSearch=104
2025-03-13 15:08:04,477 [INFO]: 	index_path: knn.index
2025-03-13 15:08:04,477 [INFO]: 	size in bytes: 440706310
2025-03-13 15:08:04,477 [INFO]: 	avg_search_speed_ms: 7.194087228891875
2025-03-13 15:08:04,478 [INFO]: 	99p_search_speed_ms: 10.583460954949244
2025-03-13 15:08:04,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:04,478 [INFO]: 	nb vectors: 2240
2025-03-13 15:08:04,478 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:04,478 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-13 15:08:04,478 [INFO]: }
2025-03-13 15:08:04,478 [INFO]: 	>>> Finished "Creating the index" in 60.3410 secs
2025-03-13 15:08:04,478 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3796 secs
2025-03-13 15:08:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 100015 [episode count 15/19]
[retrieval_preprocessing] for episode 100016 [episode count 16/19], we have num_retrieval=np.int64(2237) num_query=np.int64(103)
2025-03-13 15:08:05,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:05,921 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:05
2025-03-13 15:08:05,921 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.29it/s]
2025-03-13 15:08:05,959 [INFO]: There are 2237 embeddings of dim 49152
2025-03-13 15:08:05,959 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 15:08:05,959 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:05
2025-03-13 15:08:05,959 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:05,959 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:08:05,959 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:05,959 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:05,959 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:05
2025-03-13 15:08:05,959 [INFO]: 461.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:05,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:08:05,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:05
2025-03-13 15:08:05,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:05,960 [INFO]: 	Creating the index 03/13/2025, 15:08:05
2025-03-13 15:08:05,960 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:05
2025-03-13 15:08:05,961 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:08:05,961 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:05
2025-03-13 15:08:05,961 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:08:05,961 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.38it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.09it/s]100%|██████████| 9/9 [00:02<00:00,  3.02it/s]100%|██████████| 9/9 [00:02<00:00,  3.85it/s]
2025-03-13 15:08:08,303 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:08
2025-03-13 15:08:37,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7071 secs
2025-03-13 15:08:37,011 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 15:08:37,012 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.20it/s]
2025-03-13 15:08:58,443 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4311 secs
2025-03-13 15:08:58,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4838 secs
2025-03-13 15:08:58,445 [INFO]: {
2025-03-13 15:08:58,445 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:58,445 [INFO]: 	index_param: efSearch=140
2025-03-13 15:08:58,445 [INFO]: 	index_path: knn.index
2025-03-13 15:08:58,445 [INFO]: 	size in bytes: 440116090
2025-03-13 15:08:58,445 [INFO]: 	avg_search_speed_ms: 7.918385263961561
2025-03-13 15:08:58,445 [INFO]: 	99p_search_speed_ms: 14.142347262240943
2025-03-13 15:08:58,445 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:58,445 [INFO]: 	nb vectors: 2237
2025-03-13 15:08:58,445 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:58,445 [INFO]: 	compression ratio: 0.9993092867838574
2025-03-13 15:08:58,445 [INFO]: }
2025-03-13 15:08:58,445 [INFO]: 	>>> Finished "Creating the index" in 52.4855 secs
2025-03-13 15:08:58,445 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5238 secs
2025-03-13 15:08:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100016 [episode count 16/19]
[retrieval_preprocessing] for episode 100017 [episode count 17/19], we have num_retrieval=np.int64(2184) num_query=np.int64(156)
2025-03-13 15:08:59,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:59,861 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:59
2025-03-13 15:08:59,861 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1965.47it/s]
2025-03-13 15:08:59,897 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 15:08:59,897 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 15:08:59,897 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:59
2025-03-13 15:08:59,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:59,897 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:08:59,897 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:59,897 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:59,897 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:59
2025-03-13 15:08:59,897 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:59,897 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:08:59,898 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:59
2025-03-13 15:08:59,898 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:59,898 [INFO]: 	Creating the index 03/13/2025, 15:08:59
2025-03-13 15:08:59,898 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:59
2025-03-13 15:08:59,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:08:59,899 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:59
2025-03-13 15:08:59,899 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:08:59,899 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.36it/s] 44%|████▍     | 4/9 [00:00<00:00, 18.21it/s] 78%|███████▊  | 7/9 [00:00<00:00, 22.40it/s]100%|██████████| 9/9 [00:02<00:00,  3.80it/s]
2025-03-13 15:09:02,271 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:02
2025-03-13 15:09:35,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3915 secs
2025-03-13 15:09:35,663 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 15:09:35,663 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 15:09:53,626 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9624 secs
2025-03-13 15:09:53,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7284 secs
2025-03-13 15:09:53,628 [INFO]: {
2025-03-13 15:09:53,628 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:53,628 [INFO]: 	index_param: efSearch=145
2025-03-13 15:09:53,628 [INFO]: 	index_path: knn.index
2025-03-13 15:09:53,628 [INFO]: 	size in bytes: 429688750
2025-03-13 15:09:53,628 [INFO]: 	avg_search_speed_ms: 8.907222039732197
2025-03-13 15:09:53,628 [INFO]: 	99p_search_speed_ms: 11.916924021206794
2025-03-13 15:09:53,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:53,628 [INFO]: 	nb vectors: 2184
2025-03-13 15:09:53,628 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:53,628 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 15:09:53,628 [INFO]: }
2025-03-13 15:09:53,628 [INFO]: 	>>> Finished "Creating the index" in 53.7299 secs
2025-03-13 15:09:53,628 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7671 secs
2025-03-13 15:09:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100017 [episode count 17/19]
[retrieval_preprocessing] for episode 100018 [episode count 18/19], we have num_retrieval=np.int64(2217) num_query=np.int64(123)
2025-03-13 15:09:54,943 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:55,375 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:55
2025-03-13 15:09:55,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1375.63it/s]
2025-03-13 15:09:55,414 [INFO]: There are 2217 embeddings of dim 49152
2025-03-13 15:09:55,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0394 secs
2025-03-13 15:09:55,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:55
2025-03-13 15:09:55,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:55,415 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:09:55,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:55,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:55,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:55
2025-03-13 15:09:55,415 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:55,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:09:55,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:55
2025-03-13 15:09:55,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:55,415 [INFO]: 	Creating the index 03/13/2025, 15:09:55
2025-03-13 15:09:55,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:55
2025-03-13 15:09:55,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:09:55,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:55
2025-03-13 15:09:55,416 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:09:55,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.19it/s] 78%|███████▊  | 7/9 [00:00<00:00, 30.82it/s]100%|██████████| 9/9 [00:02<00:00,  4.21it/s]
2025-03-13 15:09:57,556 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:57
2025-03-13 15:10:27,703 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1465 secs
2025-03-13 15:10:27,703 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:10:27,703 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.58it/s]
2025-03-13 15:10:48,559 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8557 secs
2025-03-13 15:10:48,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4316 secs
2025-03-13 15:10:48,848 [INFO]: {
2025-03-13 15:10:48,848 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:48,849 [INFO]: 	index_param: efSearch=156
2025-03-13 15:10:48,849 [INFO]: 	index_path: knn.index
2025-03-13 15:10:48,849 [INFO]: 	size in bytes: 436181290
2025-03-13 15:10:48,849 [INFO]: 	avg_search_speed_ms: 9.58545640787808
2025-03-13 15:10:48,849 [INFO]: 	99p_search_speed_ms: 12.95629519969225
2025-03-13 15:10:48,849 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:48,849 [INFO]: 	nb vectors: 2217
2025-03-13 15:10:48,849 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:48,849 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-13 15:10:48,849 [INFO]: }
2025-03-13 15:10:48,849 [INFO]: 	>>> Finished "Creating the index" in 53.4343 secs
2025-03-13 15:10:48,850 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4746 secs
2025-03-13 15:10:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 100018 [episode count 18/19]
2025-03-13 15:10:49: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_apple_and_put_it_in_the_bowl [chosen_id count 0/8]
2025-03-13 15:10:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_pick_up_the_duck_and_put_it_in_the_bowl [chosen_id count 1/8]
2025-03-13 15:10:51: [retrieval_preprocessing] we have num_total=1917 embedding_dim=49152
[retrieval_preprocessing] for episode 100019 [episode count 0/20], we have num_retrieval=np.int64(1790) num_query=np.int64(127)
2025-03-13 15:10:51,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:52,321 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:52
2025-03-13 15:10:52,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 964.43it/s]
2025-03-13 15:10:52,357 [INFO]: There are 1790 embeddings of dim 49152
2025-03-13 15:10:52,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 15:10:52,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:52
2025-03-13 15:10:52,358 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:52,358 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:10:52,358 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:52,358 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:52,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:52
2025-03-13 15:10:52,358 [INFO]: 369.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:52,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:10:52,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:52
2025-03-13 15:10:52,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:52,358 [INFO]: 	Creating the index 03/13/2025, 15:10:52
2025-03-13 15:10:52,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:52
2025-03-13 15:10:52,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:10:52,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:52
2025-03-13 15:10:52,360 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:10:52,360 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.45it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.75it/s]100%|██████████| 8/8 [00:01<00:00,  5.16it/s]
2025-03-13 15:10:53,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:53
2025-03-13 15:11:19,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3808 secs
2025-03-13 15:11:19,294 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 15:11:19,295 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.95it/s]
2025-03-13 15:11:36,598 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3034 secs
2025-03-13 15:11:36,600 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2400 secs
2025-03-13 15:11:36,600 [INFO]: {
2025-03-13 15:11:36,600 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:36,600 [INFO]: 	index_param: efSearch=149
2025-03-13 15:11:36,600 [INFO]: 	index_path: knn.index
2025-03-13 15:11:36,600 [INFO]: 	size in bytes: 352171750
2025-03-13 15:11:36,600 [INFO]: 	avg_search_speed_ms: 9.498734921986433
2025-03-13 15:11:36,600 [INFO]: 	99p_search_speed_ms: 12.54877507686615
2025-03-13 15:11:36,600 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:36,600 [INFO]: 	nb vectors: 1790
2025-03-13 15:11:36,600 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:36,600 [INFO]: 	compression ratio: 0.9993087747668573
2025-03-13 15:11:36,600 [INFO]: }
2025-03-13 15:11:36,600 [INFO]: 	>>> Finished "Creating the index" in 44.2420 secs
2025-03-13 15:11:36,600 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2796 secs
2025-03-13 15:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 100019 [episode count 0/20]
[retrieval_preprocessing] for episode 100020 [episode count 1/20], we have num_retrieval=np.int64(1844) num_query=np.int64(73)
2025-03-13 15:11:38,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:38,761 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:38
2025-03-13 15:11:38,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1752.74it/s]
2025-03-13 15:11:38,799 [INFO]: There are 1844 embeddings of dim 49152
2025-03-13 15:11:38,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-13 15:11:38,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:38
2025-03-13 15:11:38,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:38,800 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:11:38,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:38,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:38,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:38
2025-03-13 15:11:38,800 [INFO]: 380.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:38,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:11:38,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:38
2025-03-13 15:11:38,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:38,801 [INFO]: 	Creating the index 03/13/2025, 15:11:38
2025-03-13 15:11:38,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:38
2025-03-13 15:11:38,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:11:38,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:38
2025-03-13 15:11:38,802 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:11:38,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.82it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.33it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.77it/s]100%|██████████| 8/8 [00:03<00:00,  1.53it/s]100%|██████████| 8/8 [00:03<00:00,  2.01it/s]
2025-03-13 15:11:42,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:42
2025-03-13 15:12:16,607 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8132 secs
2025-03-13 15:12:16,607 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:12:16,607 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s]
2025-03-13 15:12:35,087 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4789 secs
2025-03-13 15:12:35,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5995 secs
2025-03-13 15:12:35,402 [INFO]: {
2025-03-13 15:12:35,402 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:35,402 [INFO]: 	index_param: efSearch=177
2025-03-13 15:12:35,402 [INFO]: 	index_path: knn.index
2025-03-13 15:12:35,402 [INFO]: 	size in bytes: 362795770
2025-03-13 15:12:35,402 [INFO]: 	avg_search_speed_ms: 15.264613865505586
2025-03-13 15:12:35,402 [INFO]: 	99p_search_speed_ms: 22.648060019128028
2025-03-13 15:12:35,402 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:35,402 [INFO]: 	nb vectors: 1844
2025-03-13 15:12:35,402 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:35,403 [INFO]: 	compression ratio: 0.9993092036326664
2025-03-13 15:12:35,403 [INFO]: }
2025-03-13 15:12:35,403 [INFO]: 	>>> Finished "Creating the index" in 56.6019 secs
2025-03-13 15:12:35,403 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6417 secs
2025-03-13 15:12:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 100020 [episode count 1/20]
[retrieval_preprocessing] for episode 100021 [episode count 2/20], we have num_retrieval=np.int64(1828) num_query=np.int64(89)
2025-03-13 15:12:36,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:37,327 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:37
2025-03-13 15:12:37,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.25it/s]
2025-03-13 15:12:37,353 [INFO]: There are 1828 embeddings of dim 49152
2025-03-13 15:12:37,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:12:37,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:37
2025-03-13 15:12:37,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:37,354 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:12:37,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:37,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:37,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:37
2025-03-13 15:12:37,354 [INFO]: 377.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:37,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:12:37,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:37
2025-03-13 15:12:37,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:37,354 [INFO]: 	Creating the index 03/13/2025, 15:12:37
2025-03-13 15:12:37,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:37
2025-03-13 15:12:37,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:12:37,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:37
2025-03-13 15:12:37,356 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:12:37,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.49it/s] 25%|██▌       | 2/8 [00:00<00:00,  9.02it/s] 50%|█████     | 4/8 [00:00<00:00, 10.13it/s] 75%|███████▌  | 6/8 [00:00<00:00, 10.58it/s]100%|██████████| 8/8 [00:02<00:00,  2.20it/s]100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
2025-03-13 15:12:39,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:39
2025-03-13 15:13:05,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8884 secs
2025-03-13 15:13:05,817 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 15:13:05,817 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 15:13:26,671 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8541 secs
2025-03-13 15:13:26,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3172 secs
2025-03-13 15:13:26,673 [INFO]: {
2025-03-13 15:13:26,673 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:26,673 [INFO]: 	index_param: efSearch=226
2025-03-13 15:13:26,673 [INFO]: 	index_path: knn.index
2025-03-13 15:13:26,673 [INFO]: 	size in bytes: 359647930
2025-03-13 15:13:26,673 [INFO]: 	avg_search_speed_ms: 11.225768122205345
2025-03-13 15:13:26,673 [INFO]: 	99p_search_speed_ms: 16.950222640298318
2025-03-13 15:13:26,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:26,673 [INFO]: 	nb vectors: 1828
2025-03-13 15:13:26,673 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:26,673 [INFO]: 	compression ratio: 0.9993090298058993
2025-03-13 15:13:26,673 [INFO]: }
2025-03-13 15:13:26,673 [INFO]: 	>>> Finished "Creating the index" in 49.3190 secs
2025-03-13 15:13:26,673 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3456 secs
2025-03-13 15:13:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 100021 [episode count 2/20]
[retrieval_preprocessing] for episode 100022 [episode count 3/20], we have num_retrieval=np.int64(1858) num_query=np.int64(59)
2025-03-13 15:13:28,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:28,911 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:28
2025-03-13 15:13:28,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1785.57it/s]
2025-03-13 15:13:28,944 [INFO]: There are 1858 embeddings of dim 49152
2025-03-13 15:13:28,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 15:13:28,945 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,945 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:28,945 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:13:28,945 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:28,945 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:13:28,945 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,946 [INFO]: 383.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:28,946 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:13:28,946 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:28
2025-03-13 15:13:28,946 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:28,946 [INFO]: 	Creating the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,947 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:28
2025-03-13 15:13:28,950 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 15:13:28,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,951 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:13:28,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.79it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.35it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.20it/s] 50%|█████     | 4/8 [00:00<00:00,  8.61it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.66it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.07it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.16it/s]100%|██████████| 8/8 [00:03<00:00,  1.30it/s]100%|██████████| 8/8 [00:03<00:00,  2.66it/s]
2025-03-13 15:13:31,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:31
2025-03-13 15:13:57,559 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5905 secs
2025-03-13 15:13:57,559 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 15:13:57,559 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 15:14:19,055 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4964 secs
2025-03-13 15:14:19,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1065 secs
2025-03-13 15:14:19,057 [INFO]: {
2025-03-13 15:14:19,057 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:19,057 [INFO]: 	index_param: efSearch=253
2025-03-13 15:14:19,057 [INFO]: 	index_path: knn.index
2025-03-13 15:14:19,057 [INFO]: 	size in bytes: 365550250
2025-03-13 15:14:19,057 [INFO]: 	avg_search_speed_ms: 9.87769566014365
2025-03-13 15:14:19,057 [INFO]: 	99p_search_speed_ms: 20.071083707734935
2025-03-13 15:14:19,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:19,058 [INFO]: 	nb vectors: 1858
2025-03-13 15:14:19,058 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:19,058 [INFO]: 	compression ratio: 0.9993090252297735
2025-03-13 15:14:19,058 [INFO]: }
2025-03-13 15:14:19,058 [INFO]: 	>>> Finished "Creating the index" in 50.1110 secs
2025-03-13 15:14:19,058 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1461 secs
2025-03-13 15:14:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 100022 [episode count 3/20]
[retrieval_preprocessing] for episode 100023 [episode count 4/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-13 15:14:20,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:20,740 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:20
2025-03-13 15:14:20,740 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 886.18it/s]
2025-03-13 15:14:20,768 [INFO]: There are 1833 embeddings of dim 49152
2025-03-13 15:14:20,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:14:20,769 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:20
2025-03-13 15:14:20,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:20,769 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:14:20,769 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:20,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:14:20,770 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:20
2025-03-13 15:14:20,770 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:20,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:14:20,771 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:20
2025-03-13 15:14:20,771 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:20,771 [INFO]: 	Creating the index 03/13/2025, 15:14:20
2025-03-13 15:14:20,771 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:20
2025-03-13 15:14:20,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0038 secs
2025-03-13 15:14:20,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:20
2025-03-13 15:14:20,776 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:14:20,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.84it/s] 25%|██▌       | 2/8 [00:00<00:01,  6.00it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.54it/s] 50%|█████     | 4/8 [00:00<00:00,  6.73it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.37it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.76it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.67it/s]100%|██████████| 8/8 [00:02<00:00,  1.79it/s]100%|██████████| 8/8 [00:02<00:00,  3.25it/s]
2025-03-13 15:14:23,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:23
2025-03-13 15:14:47,559 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3173 secs
2025-03-13 15:14:47,560 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 15:14:47,560 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s]
2025-03-13 15:15:03,581 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0212 secs
2025-03-13 15:15:03,583 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8070 secs
2025-03-13 15:15:03,583 [INFO]: {
2025-03-13 15:15:03,583 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:03,583 [INFO]: 	index_param: efSearch=240
2025-03-13 15:15:03,583 [INFO]: 	index_path: knn.index
2025-03-13 15:15:03,583 [INFO]: 	size in bytes: 360631630
2025-03-13 15:15:03,583 [INFO]: 	avg_search_speed_ms: 10.850360339260993
2025-03-13 15:15:03,583 [INFO]: 	99p_search_speed_ms: 15.57935198303312
2025-03-13 15:15:03,583 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:03,583 [INFO]: 	nb vectors: 1833
2025-03-13 15:15:03,583 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:03,583 [INFO]: 	compression ratio: 0.999309084452742
2025-03-13 15:15:03,583 [INFO]: }
2025-03-13 15:15:03,583 [INFO]: 	>>> Finished "Creating the index" in 42.8118 secs
2025-03-13 15:15:03,583 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8431 secs
2025-03-13 15:15:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 100023 [episode count 4/20]
[retrieval_preprocessing] for episode 100024 [episode count 5/20], we have num_retrieval=np.int64(1811) num_query=np.int64(106)
2025-03-13 15:15:05,536 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:05,931 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:05
2025-03-13 15:15:05,931 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-13 15:15:05,956 [INFO]: There are 1811 embeddings of dim 49152
2025-03-13 15:15:05,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:15:05,957 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:05
2025-03-13 15:15:05,957 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:05,957 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:15:05,957 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:05,957 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:05,957 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:05
2025-03-13 15:15:05,957 [INFO]: 373.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:05,957 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:15:05,957 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:05
2025-03-13 15:15:05,957 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:05,957 [INFO]: 	Creating the index 03/13/2025, 15:15:05
2025-03-13 15:15:05,957 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:05
2025-03-13 15:15:05,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:15:05,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:05
2025-03-13 15:15:05,959 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:15:05,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.63it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.45it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.17it/s] 50%|█████     | 4/8 [00:00<00:00,  8.63it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.85it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.86it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.02it/s]100%|██████████| 8/8 [00:02<00:00,  1.95it/s]100%|██████████| 8/8 [00:02<00:00,  3.64it/s]
2025-03-13 15:15:08,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:08
2025-03-13 15:15:32,857 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6953 secs
2025-03-13 15:15:32,857 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 15:15:32,857 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 15:15:52,810 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9534 secs
2025-03-13 15:15:52,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8549 secs
2025-03-13 15:15:52,814 [INFO]: {
2025-03-13 15:15:52,814 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:52,814 [INFO]: 	index_param: efSearch=224
2025-03-13 15:15:52,814 [INFO]: 	index_path: knn.index
2025-03-13 15:15:52,814 [INFO]: 	size in bytes: 356303350
2025-03-13 15:15:52,814 [INFO]: 	avg_search_speed_ms: 11.674404527900725
2025-03-13 15:15:52,814 [INFO]: 	99p_search_speed_ms: 15.819212123751637
2025-03-13 15:15:52,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:52,814 [INFO]: 	nb vectors: 1811
2025-03-13 15:15:52,814 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:52,814 [INFO]: 	compression ratio: 0.9993088417495934
2025-03-13 15:15:52,814 [INFO]: }
2025-03-13 15:15:52,814 [INFO]: 	>>> Finished "Creating the index" in 46.8568 secs
2025-03-13 15:15:52,814 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8831 secs
2025-03-13 15:15:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100024 [episode count 5/20]
[retrieval_preprocessing] for episode 100025 [episode count 6/20], we have num_retrieval=np.int64(1832) num_query=np.int64(85)
2025-03-13 15:15:55,102 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:55,566 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:55
2025-03-13 15:15:55,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1338.32it/s]
2025-03-13 15:15:55,593 [INFO]: There are 1832 embeddings of dim 49152
2025-03-13 15:15:55,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 15:15:55,593 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:55
2025-03-13 15:15:55,593 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:55,593 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:15:55,593 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:55,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:55,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:55
2025-03-13 15:15:55,594 [INFO]: 378.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:55,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:15:55,594 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:55
2025-03-13 15:15:55,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:55,594 [INFO]: 	Creating the index 03/13/2025, 15:15:55
2025-03-13 15:15:55,594 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:55
2025-03-13 15:15:55,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:15:55,595 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:55
2025-03-13 15:15:55,595 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:15:55,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.98it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.66it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.41it/s] 50%|█████     | 4/8 [00:00<00:00,  7.58it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.83it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.77it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.84it/s]100%|██████████| 8/8 [00:02<00:00,  1.50it/s]100%|██████████| 8/8 [00:02<00:00,  2.90it/s]
2025-03-13 15:15:58,355 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:58
2025-03-13 15:16:24,758 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4028 secs
2025-03-13 15:16:24,759 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 15:16:24,759 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 15:16:46,882 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1234 secs
2025-03-13 15:16:46,884 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2892 secs
2025-03-13 15:16:46,884 [INFO]: {
2025-03-13 15:16:46,884 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:46,884 [INFO]: 	index_param: efSearch=230
2025-03-13 15:16:46,884 [INFO]: 	index_path: knn.index
2025-03-13 15:16:46,884 [INFO]: 	size in bytes: 360434890
2025-03-13 15:16:46,884 [INFO]: 	avg_search_speed_ms: 9.644269940543026
2025-03-13 15:16:46,884 [INFO]: 	99p_search_speed_ms: 14.324569730088136
2025-03-13 15:16:46,884 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:46,884 [INFO]: 	nb vectors: 1832
2025-03-13 15:16:46,884 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:46,885 [INFO]: 	compression ratio: 0.9993090735472362
2025-03-13 15:16:46,885 [INFO]: }
2025-03-13 15:16:46,885 [INFO]: 	>>> Finished "Creating the index" in 51.2907 secs
2025-03-13 15:16:46,885 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3183 secs
2025-03-13 15:16:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 100025 [episode count 6/20]
[retrieval_preprocessing] for episode 100026 [episode count 7/20], we have num_retrieval=np.int64(1702) num_query=np.int64(215)
2025-03-13 15:16:48,707 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:49,051 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:49
2025-03-13 15:16:49,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.33it/s]
2025-03-13 15:16:49,080 [INFO]: There are 1702 embeddings of dim 49152
2025-03-13 15:16:49,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 15:16:49,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:49
2025-03-13 15:16:49,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:49,081 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:16:49,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:49,082 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:16:49,082 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:49
2025-03-13 15:16:49,082 [INFO]: 351.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:49,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:16:49,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:49
2025-03-13 15:16:49,083 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:49,083 [INFO]: 	Creating the index 03/13/2025, 15:16:49
2025-03-13 15:16:49,083 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:49
2025-03-13 15:16:49,086 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:16:49,086 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:49
2025-03-13 15:16:49,086 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:16:49,087 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.44it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.35it/s] 57%|█████▋    | 4/7 [00:00<00:00,  8.83it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.43it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.17it/s]100%|██████████| 7/7 [00:02<00:00,  1.80it/s]100%|██████████| 7/7 [00:02<00:00,  3.16it/s]
2025-03-13 15:16:51,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:51
2025-03-13 15:17:11,195 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8864 secs
2025-03-13 15:17:11,196 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 15:17:11,196 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 15:17:30,190 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9941 secs
2025-03-13 15:17:30,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2289 secs
2025-03-13 15:17:30,316 [INFO]: {
2025-03-13 15:17:30,316 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:30,316 [INFO]: 	index_param: efSearch=265
2025-03-13 15:17:30,316 [INFO]: 	index_path: knn.index
2025-03-13 15:17:30,316 [INFO]: 	size in bytes: 334858210
2025-03-13 15:17:30,316 [INFO]: 	avg_search_speed_ms: 11.218509458020046
2025-03-13 15:17:30,316 [INFO]: 	99p_search_speed_ms: 18.303438022267073
2025-03-13 15:17:30,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:30,316 [INFO]: 	nb vectors: 1702
2025-03-13 15:17:30,316 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:30,316 [INFO]: 	compression ratio: 0.999308979164644
2025-03-13 15:17:30,316 [INFO]: }
2025-03-13 15:17:30,316 [INFO]: 	>>> Finished "Creating the index" in 41.2332 secs
2025-03-13 15:17:30,316 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2653 secs
2025-03-13 15:17:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 100026 [episode count 7/20]
[retrieval_preprocessing] for episode 100027 [episode count 8/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-13 15:17:33,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:33,818 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:33
2025-03-13 15:17:33,818 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2538.92it/s]
2025-03-13 15:17:33,844 [INFO]: There are 1833 embeddings of dim 49152
2025-03-13 15:17:33,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:17:33,844 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:33
2025-03-13 15:17:33,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:33,844 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:17:33,844 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:33,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:17:33,844 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:33
2025-03-13 15:17:33,844 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:33,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:17:33,844 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:33
2025-03-13 15:17:33,845 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:33,845 [INFO]: 	Creating the index 03/13/2025, 15:17:33
2025-03-13 15:17:33,845 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:33
2025-03-13 15:17:33,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:17:33,845 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:33
2025-03-13 15:17:33,845 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:17:33,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.82it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.52it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.73it/s] 50%|█████     | 4/8 [00:00<00:00,  6.77it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.87it/s] 75%|███████▌  | 6/8 [00:00<00:00,  6.79it/s] 88%|████████▊ | 7/8 [00:01<00:00,  6.91it/s]100%|██████████| 8/8 [00:02<00:00,  1.49it/s]100%|██████████| 8/8 [00:02<00:00,  2.82it/s]
2025-03-13 15:17:36,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:36
2025-03-13 15:18:08,625 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9396 secs
2025-03-13 15:18:08,625 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 15:18:08,625 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-13 15:18:29,878 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2525 secs
2025-03-13 15:18:29,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0342 secs
2025-03-13 15:18:29,880 [INFO]: {
2025-03-13 15:18:29,880 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:29,880 [INFO]: 	index_param: efSearch=245
2025-03-13 15:18:29,880 [INFO]: 	index_path: knn.index
2025-03-13 15:18:29,880 [INFO]: 	size in bytes: 360631630
2025-03-13 15:18:29,880 [INFO]: 	avg_search_speed_ms: 10.997127433695777
2025-03-13 15:18:29,880 [INFO]: 	99p_search_speed_ms: 17.79155671596527
2025-03-13 15:18:29,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:29,880 [INFO]: 	nb vectors: 1833
2025-03-13 15:18:29,880 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:29,880 [INFO]: 	compression ratio: 0.999309084452742
2025-03-13 15:18:29,880 [INFO]: }
2025-03-13 15:18:29,880 [INFO]: 	>>> Finished "Creating the index" in 56.0354 secs
2025-03-13 15:18:29,880 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0615 secs
2025-03-13 15:18:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100027 [episode count 8/20]
[retrieval_preprocessing] for episode 100028 [episode count 9/20], we have num_retrieval=np.int64(1801) num_query=np.int64(116)
2025-03-13 15:18:31,403 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:32,201 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:32
2025-03-13 15:18:32,201 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1776.49it/s]
2025-03-13 15:18:32,377 [INFO]: There are 1801 embeddings of dim 49152
2025-03-13 15:18:32,377 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1763 secs
2025-03-13 15:18:32,377 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:32
2025-03-13 15:18:32,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:32,377 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:18:32,378 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:32,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:18:32,378 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:32
2025-03-13 15:18:32,378 [INFO]: 371.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:32,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:18:32,378 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:32
2025-03-13 15:18:32,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:32,378 [INFO]: 	Creating the index 03/13/2025, 15:18:32
2025-03-13 15:18:32,378 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:32
2025-03-13 15:18:32,379 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:18:32,379 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:32
2025-03-13 15:18:32,379 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:18:32,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.40it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.94it/s] 50%|█████     | 4/8 [00:00<00:00,  9.83it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.75it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.80it/s]100%|██████████| 8/8 [00:01<00:00,  2.76it/s]100%|██████████| 8/8 [00:01<00:00,  4.17it/s]
2025-03-13 15:18:34,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:34
2025-03-13 15:19:03,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1752 secs
2025-03-13 15:19:03,474 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 15:19:03,474 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 15:19:24,787 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3125 secs
2025-03-13 15:19:24,789 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4099 secs
2025-03-13 15:19:24,789 [INFO]: {
2025-03-13 15:19:24,789 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:24,789 [INFO]: 	index_param: efSearch=223
2025-03-13 15:19:24,789 [INFO]: 	index_path: knn.index
2025-03-13 15:19:24,789 [INFO]: 	size in bytes: 354335950
2025-03-13 15:19:24,789 [INFO]: 	avg_search_speed_ms: 11.386345157607677
2025-03-13 15:19:24,789 [INFO]: 	99p_search_speed_ms: 23.09547179844232
2025-03-13 15:19:24,789 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:24,789 [INFO]: 	nb vectors: 1801
2025-03-13 15:19:24,789 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:24,789 [INFO]: 	compression ratio: 0.9993087294698717
2025-03-13 15:19:24,789 [INFO]: }
2025-03-13 15:19:24,789 [INFO]: 	>>> Finished "Creating the index" in 52.4113 secs
2025-03-13 15:19:24,789 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5882 secs
2025-03-13 15:19:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100028 [episode count 9/20]
[retrieval_preprocessing] for episode 100029 [episode count 10/20], we have num_retrieval=np.int64(1809) num_query=np.int64(108)
2025-03-13 15:19:26,403 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:26,720 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:26
2025-03-13 15:19:26,720 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.12it/s]
2025-03-13 15:19:26,743 [INFO]: There are 1809 embeddings of dim 49152
2025-03-13 15:19:26,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 15:19:26,743 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:26,743 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:19:26,743 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:26,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:26,743 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,743 [INFO]: 373.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:26,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:19:26,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:26
2025-03-13 15:19:26,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:26,744 [INFO]: 	Creating the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,744 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:26
2025-03-13 15:19:26,745 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:19:26,745 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,745 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:19:26,745 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.03it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.92it/s] 62%|██████▎   | 5/8 [00:00<00:00, 12.55it/s] 88%|████████▊ | 7/8 [00:00<00:00, 13.12it/s]100%|██████████| 8/8 [00:02<00:00,  3.94it/s]
2025-03-13 15:19:28,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:28
2025-03-13 15:19:56,849 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0704 secs
2025-03-13 15:19:56,849 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 15:19:56,849 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.45it/s]
2025-03-13 15:20:12,564 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7145 secs
2025-03-13 15:20:12,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8930 secs
2025-03-13 15:20:12,638 [INFO]: {
2025-03-13 15:20:12,638 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:12,638 [INFO]: 	index_param: efSearch=208
2025-03-13 15:20:12,638 [INFO]: 	index_path: knn.index
2025-03-13 15:20:12,638 [INFO]: 	size in bytes: 355909870
2025-03-13 15:20:12,638 [INFO]: 	avg_search_speed_ms: 11.919085728670598
2025-03-13 15:20:12,639 [INFO]: 	99p_search_speed_ms: 19.03547424357385
2025-03-13 15:20:12,639 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:12,639 [INFO]: 	nb vectors: 1809
2025-03-13 15:20:12,639 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:12,639 [INFO]: 	compression ratio: 0.9993088193929547
2025-03-13 15:20:12,639 [INFO]: }
2025-03-13 15:20:12,639 [INFO]: 	>>> Finished "Creating the index" in 45.8952 secs
2025-03-13 15:20:12,639 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9191 secs
2025-03-13 15:20:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100029 [episode count 10/20]
[retrieval_preprocessing] for episode 100030 [episode count 11/20], we have num_retrieval=np.int64(1824) num_query=np.int64(93)
2025-03-13 15:20:15,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:15,977 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:15
2025-03-13 15:20:15,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-13 15:20:16,004 [INFO]: There are 1824 embeddings of dim 49152
2025-03-13 15:20:16,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:20:16,004 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:16
2025-03-13 15:20:16,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:16,004 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:20:16,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:16,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:16,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:16
2025-03-13 15:20:16,005 [INFO]: 376.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:16,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:16,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:16
2025-03-13 15:20:16,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:16,005 [INFO]: 	Creating the index 03/13/2025, 15:20:16
2025-03-13 15:20:16,005 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:16
2025-03-13 15:20:16,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:20:16,006 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:16
2025-03-13 15:20:16,006 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:20:16,006 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.25it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.33it/s] 38%|███▊      | 3/8 [00:00<00:00,  5.84it/s] 50%|█████     | 4/8 [00:00<00:00,  6.15it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.03it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.90it/s]100%|██████████| 8/8 [00:02<00:00,  1.83it/s]100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
2025-03-13 15:20:18,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:18
2025-03-13 15:20:47,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4615 secs
2025-03-13 15:20:47,197 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 15:20:47,197 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 15:21:08,513 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3153 secs
2025-03-13 15:21:08,515 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5083 secs
2025-03-13 15:21:08,515 [INFO]: {
2025-03-13 15:21:08,515 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:08,515 [INFO]: 	index_param: efSearch=243
2025-03-13 15:21:08,515 [INFO]: 	index_path: knn.index
2025-03-13 15:21:08,515 [INFO]: 	size in bytes: 358860970
2025-03-13 15:21:08,515 [INFO]: 	avg_search_speed_ms: 10.930084126691023
2025-03-13 15:21:08,515 [INFO]: 	99p_search_speed_ms: 16.2372720008716
2025-03-13 15:21:08,515 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:08,515 [INFO]: 	nb vectors: 1824
2025-03-13 15:21:08,515 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:08,515 [INFO]: 	compression ratio: 0.9993089858727183
2025-03-13 15:21:08,515 [INFO]: }
2025-03-13 15:21:08,515 [INFO]: 	>>> Finished "Creating the index" in 52.5101 secs
2025-03-13 15:21:08,515 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5381 secs
2025-03-13 15:21:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 100030 [episode count 11/20]
[retrieval_preprocessing] for episode 100031 [episode count 12/20], we have num_retrieval=np.int64(1827) num_query=np.int64(90)
2025-03-13 15:21:10,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:10,592 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:10
2025-03-13 15:21:10,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.53it/s]
2025-03-13 15:21:10,620 [INFO]: There are 1827 embeddings of dim 49152
2025-03-13 15:21:10,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:21:10,620 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:10
2025-03-13 15:21:10,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:10,620 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:21:10,620 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:10,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:10,620 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:10
2025-03-13 15:21:10,620 [INFO]: 377.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:10,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:21:10,620 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:10
2025-03-13 15:21:10,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:10,620 [INFO]: 	Creating the index 03/13/2025, 15:21:10
2025-03-13 15:21:10,620 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:10
2025-03-13 15:21:10,621 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:21:10,621 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:10
2025-03-13 15:21:10,622 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:21:10,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.90it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.21it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.13it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.83it/s]100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
2025-03-13 15:21:12,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:12
2025-03-13 15:21:39,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5598 secs
2025-03-13 15:21:39,474 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:21:39,474 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-13 15:21:57,416 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9411 secs
2025-03-13 15:21:57,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7958 secs
2025-03-13 15:21:57,417 [INFO]: {
2025-03-13 15:21:57,417 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:57,418 [INFO]: 	index_param: efSearch=207
2025-03-13 15:21:57,418 [INFO]: 	index_path: knn.index
2025-03-13 15:21:57,418 [INFO]: 	size in bytes: 359451190
2025-03-13 15:21:57,418 [INFO]: 	avg_search_speed_ms: 10.439924334588078
2025-03-13 15:21:57,418 [INFO]: 	99p_search_speed_ms: 15.329025899991388
2025-03-13 15:21:57,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:57,418 [INFO]: 	nb vectors: 1827
2025-03-13 15:21:57,418 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:57,418 [INFO]: 	compression ratio: 0.9993090188406387
2025-03-13 15:21:57,418 [INFO]: }
2025-03-13 15:21:57,418 [INFO]: 	>>> Finished "Creating the index" in 46.7973 secs
2025-03-13 15:21:57,418 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8254 secs
2025-03-13 15:21:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100031 [episode count 12/20]
[retrieval_preprocessing] for episode 100032 [episode count 13/20], we have num_retrieval=np.int64(1752) num_query=np.int64(165)
2025-03-13 15:21:58,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:59,137 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:59
2025-03-13 15:21:59,138 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.88it/s]
2025-03-13 15:21:59,165 [INFO]: There are 1752 embeddings of dim 49152
2025-03-13 15:21:59,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:21:59,166 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:59
2025-03-13 15:21:59,166 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:59,166 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:21:59,166 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:59,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:21:59,166 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:59
2025-03-13 15:21:59,167 [INFO]: 361.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:59,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:21:59,167 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:59
2025-03-13 15:21:59,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:59,167 [INFO]: 	Creating the index 03/13/2025, 15:21:59
2025-03-13 15:21:59,167 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:59
2025-03-13 15:21:59,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:21:59,171 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:59
2025-03-13 15:21:59,171 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:21:59,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  7.01it/s] 43%|████▎     | 3/7 [00:00<00:00, 10.43it/s] 71%|███████▏  | 5/7 [00:00<00:00, 11.35it/s]100%|██████████| 7/7 [00:02<00:00,  2.60it/s]100%|██████████| 7/7 [00:02<00:00,  3.43it/s]
2025-03-13 15:22:01,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:01
2025-03-13 15:22:27,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6369 secs
2025-03-13 15:22:27,859 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 15:22:27,860 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 15:22:48,908 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0480 secs
2025-03-13 15:22:48,910 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7388 secs
2025-03-13 15:22:48,910 [INFO]: {
2025-03-13 15:22:48,910 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:48,910 [INFO]: 	index_param: efSearch=204
2025-03-13 15:22:48,910 [INFO]: 	index_path: knn.index
2025-03-13 15:22:48,910 [INFO]: 	size in bytes: 344695510
2025-03-13 15:22:48,910 [INFO]: 	avg_search_speed_ms: 9.830982263832771
2025-03-13 15:22:48,910 [INFO]: 	99p_search_speed_ms: 17.987430412322304
2025-03-13 15:22:48,910 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:48,910 [INFO]: 	nb vectors: 1752
2025-03-13 15:22:48,910 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:48,910 [INFO]: 	compression ratio: 0.9993086826109223
2025-03-13 15:22:48,910 [INFO]: }
2025-03-13 15:22:48,910 [INFO]: 	>>> Finished "Creating the index" in 49.7426 secs
2025-03-13 15:22:48,910 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7724 secs
2025-03-13 15:22:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100032 [episode count 13/20]
[retrieval_preprocessing] for episode 100033 [episode count 14/20], we have num_retrieval=np.int64(1856) num_query=np.int64(61)
2025-03-13 15:22:51,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:51,621 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:51
2025-03-13 15:22:51,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.36it/s]
2025-03-13 15:22:51,645 [INFO]: There are 1856 embeddings of dim 49152
2025-03-13 15:22:51,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 15:22:51,646 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:51
2025-03-13 15:22:51,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:51,646 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:22:51,646 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:51,646 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:51,646 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:51
2025-03-13 15:22:51,646 [INFO]: 383.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:51,646 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:22:51,646 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:51
2025-03-13 15:22:51,646 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:51,646 [INFO]: 	Creating the index 03/13/2025, 15:22:51
2025-03-13 15:22:51,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:51
2025-03-13 15:22:51,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:22:51,647 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:51
2025-03-13 15:22:51,647 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:22:51,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.96it/s] 38%|███▊      | 3/8 [00:00<00:00, 12.83it/s] 62%|██████▎   | 5/8 [00:00<00:00, 13.30it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.41it/s]100%|██████████| 8/8 [00:01<00:00,  4.28it/s]
2025-03-13 15:22:54,060 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:54
2025-03-13 15:23:21,375 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3147 secs
2025-03-13 15:23:21,375 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:23:21,375 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 15:23:40,294 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9192 secs
2025-03-13 15:23:40,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6490 secs
2025-03-13 15:23:40,296 [INFO]: {
2025-03-13 15:23:40,296 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:40,296 [INFO]: 	index_param: efSearch=206
2025-03-13 15:23:40,296 [INFO]: 	index_path: knn.index
2025-03-13 15:23:40,296 [INFO]: 	size in bytes: 365156710
2025-03-13 15:23:40,296 [INFO]: 	avg_search_speed_ms: 12.128920118239792
2025-03-13 15:23:40,297 [INFO]: 	99p_search_speed_ms: 26.581090902909633
2025-03-13 15:23:40,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:40,297 [INFO]: 	nb vectors: 1856
2025-03-13 15:23:40,297 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:40,297 [INFO]: 	compression ratio: 0.9993091678364612
2025-03-13 15:23:40,297 [INFO]: }
2025-03-13 15:23:40,297 [INFO]: 	>>> Finished "Creating the index" in 48.6505 secs
2025-03-13 15:23:40,297 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6755 secs
2025-03-13 15:23:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 100033 [episode count 14/20]
[retrieval_preprocessing] for episode 100034 [episode count 15/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-13 15:23:41,133 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:41,417 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:41
2025-03-13 15:23:41,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.34it/s]
2025-03-13 15:23:41,453 [INFO]: There are 1833 embeddings of dim 49152
2025-03-13 15:23:41,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 15:23:41,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:41
2025-03-13 15:23:41,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:41,454 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:23:41,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:41,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:23:41,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:41
2025-03-13 15:23:41,454 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:41,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:23:41,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:41
2025-03-13 15:23:41,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:41,454 [INFO]: 	Creating the index 03/13/2025, 15:23:41
2025-03-13 15:23:41,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:41
2025-03-13 15:23:41,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:23:41,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:41
2025-03-13 15:23:41,456 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:23:41,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.62it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.85it/s]100%|██████████| 8/8 [00:01<00:00,  4.37it/s]
2025-03-13 15:23:43,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:43
2025-03-13 15:24:10,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3094 secs
2025-03-13 15:24:10,601 [INFO]: The best hyperparameters are: efSearch=93
2025-03-13 15:24:10,601 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.83it/s]
2025-03-13 15:24:30,982 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3804 secs
2025-03-13 15:24:30,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5277 secs
2025-03-13 15:24:30,984 [INFO]: {
2025-03-13 15:24:30,984 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:30,984 [INFO]: 	index_param: efSearch=93
2025-03-13 15:24:30,984 [INFO]: 	index_path: knn.index
2025-03-13 15:24:30,984 [INFO]: 	size in bytes: 360631630
2025-03-13 15:24:30,984 [INFO]: 	avg_search_speed_ms: 7.306108925895666
2025-03-13 15:24:30,984 [INFO]: 	99p_search_speed_ms: 11.744085550308222
2025-03-13 15:24:30,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:30,984 [INFO]: 	nb vectors: 1833
2025-03-13 15:24:30,984 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:30,984 [INFO]: 	compression ratio: 0.999309084452742
2025-03-13 15:24:30,984 [INFO]: }
2025-03-13 15:24:30,984 [INFO]: 	>>> Finished "Creating the index" in 49.5295 secs
2025-03-13 15:24:30,984 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5664 secs
2025-03-13 15:24:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 100034 [episode count 15/20]
[retrieval_preprocessing] for episode 100035 [episode count 16/20], we have num_retrieval=np.int64(1847) num_query=np.int64(70)
2025-03-13 15:24:31,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:32,020 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:32
2025-03-13 15:24:32,020 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-13 15:24:32,050 [INFO]: There are 1847 embeddings of dim 49152
2025-03-13 15:24:32,051 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 15:24:32,051 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:32
2025-03-13 15:24:32,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:32,051 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:24:32,051 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:32,051 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:32,051 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:32
2025-03-13 15:24:32,051 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:32,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:24:32,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:32
2025-03-13 15:24:32,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:32,051 [INFO]: 	Creating the index 03/13/2025, 15:24:32
2025-03-13 15:24:32,051 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:32
2025-03-13 15:24:32,052 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:24:32,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:32
2025-03-13 15:24:32,052 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:24:32,052 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.67it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.24it/s]100%|██████████| 8/8 [00:01<00:00,  4.52it/s]
2025-03-13 15:24:33,825 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:33
2025-03-13 15:25:00,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1870 secs
2025-03-13 15:25:00,013 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:25:00,013 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 15:25:18,664 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6514 secs
2025-03-13 15:25:18,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6140 secs
2025-03-13 15:25:18,667 [INFO]: {
2025-03-13 15:25:18,667 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:18,667 [INFO]: 	index_param: efSearch=221
2025-03-13 15:25:18,667 [INFO]: 	index_path: knn.index
2025-03-13 15:25:18,667 [INFO]: 	size in bytes: 363385990
2025-03-13 15:25:18,667 [INFO]: 	avg_search_speed_ms: 14.696006023115785
2025-03-13 15:25:18,667 [INFO]: 	99p_search_speed_ms: 21.63180341012776
2025-03-13 15:25:18,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:18,667 [INFO]: 	nb vectors: 1847
2025-03-13 15:25:18,667 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:18,667 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-13 15:25:18,667 [INFO]: }
2025-03-13 15:25:18,667 [INFO]: 	>>> Finished "Creating the index" in 46.6158 secs
2025-03-13 15:25:18,667 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6469 secs
2025-03-13 15:25:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 100035 [episode count 16/20]
[retrieval_preprocessing] for episode 100036 [episode count 17/20], we have num_retrieval=np.int64(1848) num_query=np.int64(69)
2025-03-13 15:25:20,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:20,516 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:20
2025-03-13 15:25:20,516 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 15:25:20,550 [INFO]: There are 1848 embeddings of dim 49152
2025-03-13 15:25:20,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 15:25:20,550 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:20
2025-03-13 15:25:20,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:20,550 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:25:20,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:20,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:20,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:20
2025-03-13 15:25:20,550 [INFO]: 381.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:20,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:25:20,550 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:20
2025-03-13 15:25:20,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:20,550 [INFO]: 	Creating the index 03/13/2025, 15:25:20
2025-03-13 15:25:20,550 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:20
2025-03-13 15:25:20,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:25:20,552 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:20
2025-03-13 15:25:20,552 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:25:20,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.14it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.29it/s]100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
2025-03-13 15:25:22,856 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:22
2025-03-13 15:25:55,767 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9110 secs
2025-03-13 15:25:55,767 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 15:25:55,768 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.68it/s]
2025-03-13 15:26:16,922 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1539 secs
2025-03-13 15:26:16,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3715 secs
2025-03-13 15:26:16,923 [INFO]: {
2025-03-13 15:26:16,923 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:16,923 [INFO]: 	index_param: efSearch=198
2025-03-13 15:26:16,923 [INFO]: 	index_path: knn.index
2025-03-13 15:26:16,923 [INFO]: 	size in bytes: 363582730
2025-03-13 15:26:16,924 [INFO]: 	avg_search_speed_ms: 10.977379589737215
2025-03-13 15:26:16,924 [INFO]: 	99p_search_speed_ms: 17.369004013016816
2025-03-13 15:26:16,924 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:16,924 [INFO]: 	nb vectors: 1848
2025-03-13 15:26:16,924 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:16,924 [INFO]: 	compression ratio: 0.999309246619057
2025-03-13 15:26:16,924 [INFO]: }
2025-03-13 15:26:16,924 [INFO]: 	>>> Finished "Creating the index" in 56.3732 secs
2025-03-13 15:26:16,924 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4079 secs
2025-03-13 15:26:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 100036 [episode count 17/20]
[retrieval_preprocessing] for episode 100037 [episode count 18/20], we have num_retrieval=np.int64(1830) num_query=np.int64(87)
2025-03-13 15:26:17,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:17,928 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:17
2025-03-13 15:26:17,928 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.27it/s]
2025-03-13 15:26:17,958 [INFO]: There are 1830 embeddings of dim 49152
2025-03-13 15:26:17,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:26:17,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:17
2025-03-13 15:26:17,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:17,958 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:26:17,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:17,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:17,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:17
2025-03-13 15:26:17,958 [INFO]: 377.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:17,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:26:17,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:17
2025-03-13 15:26:17,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:17,959 [INFO]: 	Creating the index 03/13/2025, 15:26:17
2025-03-13 15:26:17,959 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:17
2025-03-13 15:26:17,960 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:26:17,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:17
2025-03-13 15:26:17,960 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:26:17,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.86it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.44it/s]100%|██████████| 8/8 [00:01<00:00,  4.64it/s]
2025-03-13 15:26:19,688 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:19
2025-03-13 15:26:48,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1284 secs
2025-03-13 15:26:48,817 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:26:48,817 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.58it/s]
2025-03-13 15:27:07,999 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1823 secs
2025-03-13 15:27:08,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0404 secs
2025-03-13 15:27:08,001 [INFO]: {
2025-03-13 15:27:08,001 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:08,001 [INFO]: 	index_param: efSearch=162
2025-03-13 15:27:08,001 [INFO]: 	index_path: knn.index
2025-03-13 15:27:08,001 [INFO]: 	size in bytes: 360041410
2025-03-13 15:27:08,001 [INFO]: 	avg_search_speed_ms: 10.018908172353116
2025-03-13 15:27:08,001 [INFO]: 	99p_search_speed_ms: 15.388445775024591
2025-03-13 15:27:08,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:08,001 [INFO]: 	nb vectors: 1830
2025-03-13 15:27:08,001 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:08,001 [INFO]: 	compression ratio: 0.9993090517004697
2025-03-13 15:27:08,001 [INFO]: }
2025-03-13 15:27:08,001 [INFO]: 	>>> Finished "Creating the index" in 50.0423 secs
2025-03-13 15:27:08,001 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0732 secs
2025-03-13 15:27:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 100037 [episode count 18/20]
[retrieval_preprocessing] for episode 100038 [episode count 19/20], we have num_retrieval=np.int64(1865) num_query=np.int64(52)
2025-03-13 15:27:08,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:09,103 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:09
2025-03-13 15:27:09,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.76it/s]
2025-03-13 15:27:09,135 [INFO]: There are 1865 embeddings of dim 49152
2025-03-13 15:27:09,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 15:27:09,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:09,136 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:27:09,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:09,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:09,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,136 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:09,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:09,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:09
2025-03-13 15:27:09,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:09,136 [INFO]: 	Creating the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:09
2025-03-13 15:27:09,137 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:27:09,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,137 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:27:09,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.43it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.69it/s]100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
2025-03-13 15:27:10,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:10
2025-03-13 15:27:35,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6793 secs
2025-03-13 15:27:35,561 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:27:35,561 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.88it/s]
2025-03-13 15:27:57,127 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5665 secs
2025-03-13 15:27:57,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9916 secs
2025-03-13 15:27:57,129 [INFO]: {
2025-03-13 15:27:57,129 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:57,129 [INFO]: 	index_param: efSearch=183
2025-03-13 15:27:57,129 [INFO]: 	index_path: knn.index
2025-03-13 15:27:57,129 [INFO]: 	size in bytes: 366927490
2025-03-13 15:27:57,129 [INFO]: 	avg_search_speed_ms: 10.876167667067975
2025-03-13 15:27:57,129 [INFO]: 	99p_search_speed_ms: 15.058044320903713
2025-03-13 15:27:57,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:57,129 [INFO]: 	nb vectors: 1865
2025-03-13 15:27:57,129 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:57,129 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-13 15:27:57,129 [INFO]: }
2025-03-13 15:27:57,129 [INFO]: 	>>> Finished "Creating the index" in 47.9930 secs
2025-03-13 15:27:57,129 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0261 secs
2025-03-13 15:27:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 100038 [episode count 19/20]
2025-03-13 15:27:57: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_duck_and_put_it_in_the_bowl [chosen_id count 1/8]
2025-03-13 15:27:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2023-03-04_pick_up_the_pineapple_and_put_it_in_the_bowl [chosen_id count 2/8]
2025-03-13 15:27:59: [retrieval_preprocessing] we have num_total=2137 embedding_dim=49152
[retrieval_preprocessing] for episode 100039 [episode count 0/20], we have num_retrieval=np.int64(2021) num_query=np.int64(116)
2025-03-13 15:27:59,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:00,384 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:00
2025-03-13 15:28:00,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1593.58it/s]
2025-03-13 15:28:00,416 [INFO]: There are 2021 embeddings of dim 49152
2025-03-13 15:28:00,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 15:28:00,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:00
2025-03-13 15:28:00,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:00,417 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:28:00,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:00,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:28:00,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:00
2025-03-13 15:28:00,418 [INFO]: 417.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:00,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:28:00,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:00
2025-03-13 15:28:00,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:00,418 [INFO]: 	Creating the index 03/13/2025, 15:28:00
2025-03-13 15:28:00,418 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:00
2025-03-13 15:28:00,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:28:00,421 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:00
2025-03-13 15:28:00,422 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:28:00,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.53it/s] 75%|███████▌  | 6/8 [00:00<00:00, 27.96it/s]100%|██████████| 8/8 [00:01<00:00,  4.29it/s]
2025-03-13 15:28:02,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:02
2025-03-13 15:28:36,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9654 secs
2025-03-13 15:28:36,260 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 15:28:36,260 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.43it/s]
2025-03-13 15:28:54,726 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4656 secs
2025-03-13 15:28:54,728 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3064 secs
2025-03-13 15:28:54,728 [INFO]: {
2025-03-13 15:28:54,728 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:54,728 [INFO]: 	index_param: efSearch=250
2025-03-13 15:28:54,728 [INFO]: 	index_path: knn.index
2025-03-13 15:28:54,728 [INFO]: 	size in bytes: 397619590
2025-03-13 15:28:54,728 [INFO]: 	avg_search_speed_ms: 11.289555173941192
2025-03-13 15:28:54,728 [INFO]: 	99p_search_speed_ms: 19.70800397684795
2025-03-13 15:28:54,728 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:54,728 [INFO]: 	nb vectors: 2021
2025-03-13 15:28:54,728 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:54,728 [INFO]: 	compression ratio: 0.9993088318410066
2025-03-13 15:28:54,728 [INFO]: }
2025-03-13 15:28:54,728 [INFO]: 	>>> Finished "Creating the index" in 54.3101 secs
2025-03-13 15:28:54,728 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3444 secs
2025-03-13 15:28:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 100039 [episode count 0/20]
[retrieval_preprocessing] for episode 100040 [episode count 1/20], we have num_retrieval=np.int64(2032) num_query=np.int64(105)
2025-03-13 15:28:57,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:58,366 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:58
2025-03-13 15:28:58,367 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2003.97it/s]
2025-03-13 15:28:58,403 [INFO]: There are 2032 embeddings of dim 49152
2025-03-13 15:28:58,404 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 15:28:58,404 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:58
2025-03-13 15:28:58,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:58,404 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:28:58,404 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:58,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:28:58,405 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:58
2025-03-13 15:28:58,405 [INFO]: 419.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:58,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:28:58,405 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:58
2025-03-13 15:28:58,406 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:58,406 [INFO]: 	Creating the index 03/13/2025, 15:28:58
2025-03-13 15:28:58,406 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:58
2025-03-13 15:28:58,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:28:58,409 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:58
2025-03-13 15:28:58,409 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:28:58,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.71it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.34it/s]100%|██████████| 8/8 [00:01<00:00,  4.00it/s]
2025-03-13 15:29:00,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:00
2025-03-13 15:29:30,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4078 secs
2025-03-13 15:29:30,823 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 15:29:30,823 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 15:29:53,469 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6463 secs
2025-03-13 15:29:53,877 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4676 secs
2025-03-13 15:29:53,877 [INFO]: {
2025-03-13 15:29:53,877 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:53,877 [INFO]: 	index_param: efSearch=234
2025-03-13 15:29:53,877 [INFO]: 	index_path: knn.index
2025-03-13 15:29:53,877 [INFO]: 	size in bytes: 399783790
2025-03-13 15:29:53,878 [INFO]: 	avg_search_speed_ms: 9.727861364199944
2025-03-13 15:29:53,878 [INFO]: 	99p_search_speed_ms: 14.922921794932337
2025-03-13 15:29:53,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:53,878 [INFO]: 	nb vectors: 2032
2025-03-13 15:29:53,878 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:53,878 [INFO]: 	compression ratio: 0.999308791384463
2025-03-13 15:29:53,878 [INFO]: }
2025-03-13 15:29:53,878 [INFO]: 	>>> Finished "Creating the index" in 55.4721 secs
2025-03-13 15:29:53,878 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5114 secs
2025-03-13 15:29:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100040 [episode count 1/20]
[retrieval_preprocessing] for episode 100041 [episode count 2/20], we have num_retrieval=np.int64(2025) num_query=np.int64(112)
2025-03-13 15:29:55,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:55,607 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:55
2025-03-13 15:29:55,607 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.94it/s]
2025-03-13 15:29:55,635 [INFO]: There are 2025 embeddings of dim 49152
2025-03-13 15:29:55,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 15:29:55,636 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:55
2025-03-13 15:29:55,636 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:55,636 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:29:55,636 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:55,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:29:55,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:55
2025-03-13 15:29:55,636 [INFO]: 417.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:55,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:29:55,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:55
2025-03-13 15:29:55,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:55,636 [INFO]: 	Creating the index 03/13/2025, 15:29:55
2025-03-13 15:29:55,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:55
2025-03-13 15:29:55,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:29:55,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:55
2025-03-13 15:29:55,637 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:29:55,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.35it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.19it/s]100%|██████████| 8/8 [00:01<00:00,  4.66it/s]
2025-03-13 15:29:57,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:57
2025-03-13 15:30:27,801 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4429 secs
2025-03-13 15:30:27,802 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 15:30:27,802 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.59it/s]
2025-03-13 15:30:45,297 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4956 secs
2025-03-13 15:30:45,299 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6620 secs
2025-03-13 15:30:45,299 [INFO]: {
2025-03-13 15:30:45,299 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:45,299 [INFO]: 	index_param: efSearch=217
2025-03-13 15:30:45,299 [INFO]: 	index_path: knn.index
2025-03-13 15:30:45,299 [INFO]: 	size in bytes: 398406610
2025-03-13 15:30:45,299 [INFO]: 	avg_search_speed_ms: 9.109236316743539
2025-03-13 15:30:45,299 [INFO]: 	99p_search_speed_ms: 13.982125297188757
2025-03-13 15:30:45,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:45,299 [INFO]: 	nb vectors: 2025
2025-03-13 15:30:45,299 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:45,299 [INFO]: 	compression ratio: 0.9993087213086148
2025-03-13 15:30:45,299 [INFO]: }
2025-03-13 15:30:45,299 [INFO]: 	>>> Finished "Creating the index" in 49.6634 secs
2025-03-13 15:30:45,299 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6920 secs
2025-03-13 15:30:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 100041 [episode count 2/20]
[retrieval_preprocessing] for episode 100042 [episode count 3/20], we have num_retrieval=np.int64(2022) num_query=np.int64(115)
2025-03-13 15:30:46,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:46,600 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:46
2025-03-13 15:30:46,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 15:30:46,633 [INFO]: There are 2022 embeddings of dim 49152
2025-03-13 15:30:46,634 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 15:30:46,634 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:46
2025-03-13 15:30:46,634 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:46,634 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:30:46,634 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:46,634 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:30:46,634 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:46
2025-03-13 15:30:46,634 [INFO]: 417.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:46,634 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:30:46,634 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:46
2025-03-13 15:30:46,634 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:46,634 [INFO]: 	Creating the index 03/13/2025, 15:30:46
2025-03-13 15:30:46,634 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:46
2025-03-13 15:30:46,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:30:46,635 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:46
2025-03-13 15:30:46,635 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:30:46,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.98it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.04it/s]100%|██████████| 8/8 [00:01<00:00,  4.53it/s]
2025-03-13 15:30:48,407 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:48
2025-03-13 15:31:15,903 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4959 secs
2025-03-13 15:31:15,903 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 15:31:15,903 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.88it/s]
2025-03-13 15:31:34,510 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6063 secs
2025-03-13 15:31:34,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9627 secs
2025-03-13 15:31:34,598 [INFO]: {
2025-03-13 15:31:34,599 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:34,599 [INFO]: 	index_param: efSearch=195
2025-03-13 15:31:34,599 [INFO]: 	index_path: knn.index
2025-03-13 15:31:34,599 [INFO]: 	size in bytes: 397816330
2025-03-13 15:31:34,599 [INFO]: 	avg_search_speed_ms: 8.39529373572778
2025-03-13 15:31:34,599 [INFO]: 	99p_search_speed_ms: 14.632248179987068
2025-03-13 15:31:34,599 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:34,599 [INFO]: 	nb vectors: 2022
2025-03-13 15:31:34,599 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:34,599 [INFO]: 	compression ratio: 0.9993088418466884
2025-03-13 15:31:34,599 [INFO]: }
2025-03-13 15:31:34,599 [INFO]: 	>>> Finished "Creating the index" in 47.9649 secs
2025-03-13 15:31:34,599 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9990 secs
2025-03-13 15:31:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 100042 [episode count 3/20]
[retrieval_preprocessing] for episode 100043 [episode count 4/20], we have num_retrieval=np.int64(2017) num_query=np.int64(120)
2025-03-13 15:31:35,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:35,832 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:35
2025-03-13 15:31:35,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2067.18it/s]
2025-03-13 15:31:35,858 [INFO]: There are 2017 embeddings of dim 49152
2025-03-13 15:31:35,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:31:35,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:35
2025-03-13 15:31:35,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:35,858 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:31:35,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:35,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:35,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:35
2025-03-13 15:31:35,858 [INFO]: 416.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:35,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:31:35,858 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:35
2025-03-13 15:31:35,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:35,858 [INFO]: 	Creating the index 03/13/2025, 15:31:35
2025-03-13 15:31:35,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:35
2025-03-13 15:31:35,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:31:35,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:35
2025-03-13 15:31:35,860 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:31:35,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.67it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.69it/s]100%|██████████| 8/8 [00:01<00:00,  5.55it/s]
2025-03-13 15:31:37,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:37
2025-03-13 15:32:03,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4861 secs
2025-03-13 15:32:03,792 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 15:32:03,792 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 15:32:23,161 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3691 secs
2025-03-13 15:32:23,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3029 secs
2025-03-13 15:32:23,163 [INFO]: {
2025-03-13 15:32:23,163 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:23,163 [INFO]: 	index_param: efSearch=261
2025-03-13 15:32:23,163 [INFO]: 	index_path: knn.index
2025-03-13 15:32:23,163 [INFO]: 	size in bytes: 396832570
2025-03-13 15:32:23,163 [INFO]: 	avg_search_speed_ms: 11.159952883774947
2025-03-13 15:32:23,163 [INFO]: 	99p_search_speed_ms: 14.789018023293456
2025-03-13 15:32:23,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:23,163 [INFO]: 	nb vectors: 2017
2025-03-13 15:32:23,163 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:23,163 [INFO]: 	compression ratio: 0.9993089428118261
2025-03-13 15:32:23,163 [INFO]: }
2025-03-13 15:32:23,163 [INFO]: 	>>> Finished "Creating the index" in 47.3044 secs
2025-03-13 15:32:23,163 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3307 secs
2025-03-13 15:32:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 100043 [episode count 4/20]
[retrieval_preprocessing] for episode 100044 [episode count 5/20], we have num_retrieval=np.int64(2020) num_query=np.int64(117)
2025-03-13 15:32:24,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:25,677 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:25
2025-03-13 15:32:25,677 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1835.58it/s]
2025-03-13 15:32:25,715 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 15:32:25,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 15:32:25,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:25
2025-03-13 15:32:25,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:25,715 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:32:25,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:25,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:25,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:25
2025-03-13 15:32:25,715 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:25,715 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:32:25,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:25
2025-03-13 15:32:25,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:25,716 [INFO]: 	Creating the index 03/13/2025, 15:32:25
2025-03-13 15:32:25,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:25
2025-03-13 15:32:25,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:32:25,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:25
2025-03-13 15:32:25,717 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:32:25,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.38it/s] 62%|██████▎   | 5/8 [00:00<00:00, 25.45it/s]100%|██████████| 8/8 [00:01<00:00,  3.89it/s]100%|██████████| 8/8 [00:01<00:00,  4.68it/s]
2025-03-13 15:32:27,431 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:27
2025-03-13 15:32:55,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3805 secs
2025-03-13 15:32:55,812 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 15:32:55,812 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.76it/s]
2025-03-13 15:33:13,097 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2850 secs
2025-03-13 15:33:13,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3823 secs
2025-03-13 15:33:13,100 [INFO]: {
2025-03-13 15:33:13,100 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:13,100 [INFO]: 	index_param: efSearch=231
2025-03-13 15:33:13,100 [INFO]: 	index_path: knn.index
2025-03-13 15:33:13,100 [INFO]: 	size in bytes: 397422850
2025-03-13 15:33:13,100 [INFO]: 	avg_search_speed_ms: 9.748901395067268
2025-03-13 15:33:13,100 [INFO]: 	99p_search_speed_ms: 14.319753099698573
2025-03-13 15:33:13,100 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:13,100 [INFO]: 	nb vectors: 2020
2025-03-13 15:33:13,100 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:13,100 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 15:33:13,100 [INFO]: }
2025-03-13 15:33:13,100 [INFO]: 	>>> Finished "Creating the index" in 47.3844 secs
2025-03-13 15:33:13,100 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4226 secs
2025-03-13 15:33:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100044 [episode count 5/20]
[retrieval_preprocessing] for episode 100045 [episode count 6/20], we have num_retrieval=np.int64(2043) num_query=np.int64(94)
2025-03-13 15:33:14,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:15,269 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:15
2025-03-13 15:33:15,269 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.96it/s]
2025-03-13 15:33:15,300 [INFO]: There are 2043 embeddings of dim 49152
2025-03-13 15:33:15,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 15:33:15,300 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:15
2025-03-13 15:33:15,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:15,301 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:33:15,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:15,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:15,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:15
2025-03-13 15:33:15,301 [INFO]: 421.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:15,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:33:15,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:15
2025-03-13 15:33:15,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:15,301 [INFO]: 	Creating the index 03/13/2025, 15:33:15
2025-03-13 15:33:15,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:15
2025-03-13 15:33:15,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:33:15,302 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:15
2025-03-13 15:33:15,302 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:33:15,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.04it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.87it/s]100%|██████████| 9/9 [00:01<00:00,  5.68it/s]
2025-03-13 15:33:16,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:16
2025-03-13 15:33:41,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0283 secs
2025-03-13 15:33:41,919 [INFO]: The best hyperparameters are: efSearch=331
2025-03-13 15:33:41,919 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.09it/s]
2025-03-13 15:34:06,753 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8339 secs
2025-03-13 15:34:06,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4530 secs
2025-03-13 15:34:06,756 [INFO]: {
2025-03-13 15:34:06,756 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:06,756 [INFO]: 	index_param: efSearch=331
2025-03-13 15:34:06,756 [INFO]: 	index_path: knn.index
2025-03-13 15:34:06,756 [INFO]: 	size in bytes: 401947990
2025-03-13 15:34:06,756 [INFO]: 	avg_search_speed_ms: 13.22763635242289
2025-03-13 15:34:06,756 [INFO]: 	99p_search_speed_ms: 21.803203388117286
2025-03-13 15:34:06,756 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:06,756 [INFO]: 	nb vectors: 2043
2025-03-13 15:34:06,756 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:06,756 [INFO]: 	compression ratio: 0.9993087513635781
2025-03-13 15:34:06,756 [INFO]: }
2025-03-13 15:34:06,756 [INFO]: 	>>> Finished "Creating the index" in 51.4547 secs
2025-03-13 15:34:06,756 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4864 secs
2025-03-13 15:34:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 100045 [episode count 6/20]
[retrieval_preprocessing] for episode 100046 [episode count 7/20], we have num_retrieval=np.int64(2035) num_query=np.int64(102)
2025-03-13 15:34:08,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:09,137 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:09
2025-03-13 15:34:09,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-13 15:34:09,174 [INFO]: There are 2035 embeddings of dim 49152
2025-03-13 15:34:09,175 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-13 15:34:09,175 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:09
2025-03-13 15:34:09,175 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:09,175 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:34:09,175 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:09,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:09,175 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:09
2025-03-13 15:34:09,175 [INFO]: 420.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:09,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:09,175 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:09
2025-03-13 15:34:09,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:09,175 [INFO]: 	Creating the index 03/13/2025, 15:34:09
2025-03-13 15:34:09,175 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:09
2025-03-13 15:34:09,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:34:09,176 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:09
2025-03-13 15:34:09,176 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:34:09,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.23it/s] 56%|█████▌    | 5/9 [00:00<00:00, 24.93it/s] 89%|████████▉ | 8/9 [00:00<00:00, 26.65it/s]100%|██████████| 9/9 [00:01<00:00,  4.67it/s]
2025-03-13 15:34:11,108 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:11
2025-03-13 15:34:40,828 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7188 secs
2025-03-13 15:34:40,828 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 15:34:40,829 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 15:34:57,269 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4407 secs
2025-03-13 15:34:57,272 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0955 secs
2025-03-13 15:34:57,272 [INFO]: {
2025-03-13 15:34:57,272 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:57,272 [INFO]: 	index_param: efSearch=153
2025-03-13 15:34:57,272 [INFO]: 	index_path: knn.index
2025-03-13 15:34:57,272 [INFO]: 	size in bytes: 400374010
2025-03-13 15:34:57,272 [INFO]: 	avg_search_speed_ms: 8.323571203876718
2025-03-13 15:34:57,272 [INFO]: 	99p_search_speed_ms: 14.34744312427938
2025-03-13 15:34:57,272 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:57,272 [INFO]: 	nb vectors: 2035
2025-03-13 15:34:57,272 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:57,272 [INFO]: 	compression ratio: 0.9993088212693926
2025-03-13 15:34:57,272 [INFO]: }
2025-03-13 15:34:57,272 [INFO]: 	>>> Finished "Creating the index" in 48.0971 secs
2025-03-13 15:34:57,272 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1355 secs
2025-03-13 15:34:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100046 [episode count 7/20]
[retrieval_preprocessing] for episode 100047 [episode count 8/20], we have num_retrieval=np.int64(2039) num_query=np.int64(98)
2025-03-13 15:34:58,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:58,715 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:58
2025-03-13 15:34:58,716 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-13 15:34:58,750 [INFO]: There are 2039 embeddings of dim 49152
2025-03-13 15:34:58,751 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 15:34:58,751 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:58
2025-03-13 15:34:58,751 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:58,751 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:34:58,751 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:58,752 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:34:58,752 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:58
2025-03-13 15:34:58,752 [INFO]: 420.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:58,752 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:34:58,752 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:58
2025-03-13 15:34:58,752 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:58,753 [INFO]: 	Creating the index 03/13/2025, 15:34:58
2025-03-13 15:34:58,753 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:58
2025-03-13 15:34:58,756 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:34:58,756 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:58
2025-03-13 15:34:58,756 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:34:58,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.89it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.24it/s]100%|██████████| 9/9 [00:01<00:00,  4.88it/s]
2025-03-13 15:35:00,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:00
2025-03-13 15:35:27,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9450 secs
2025-03-13 15:35:27,551 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:35:27,551 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.12it/s]
2025-03-13 15:35:49,843 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2922 secs
2025-03-13 15:35:49,845 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0886 secs
2025-03-13 15:35:49,845 [INFO]: {
2025-03-13 15:35:49,845 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:49,845 [INFO]: 	index_param: efSearch=168
2025-03-13 15:35:49,845 [INFO]: 	index_path: knn.index
2025-03-13 15:35:49,845 [INFO]: 	size in bytes: 401161030
2025-03-13 15:35:49,845 [INFO]: 	avg_search_speed_ms: 7.505618977778544
2025-03-13 15:35:49,845 [INFO]: 	99p_search_speed_ms: 10.411225012503568
2025-03-13 15:35:49,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:49,845 [INFO]: 	nb vectors: 2039
2025-03-13 15:35:49,845 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:49,845 [INFO]: 	compression ratio: 0.9993087115166696
2025-03-13 15:35:49,845 [INFO]: }
2025-03-13 15:35:49,845 [INFO]: 	>>> Finished "Creating the index" in 51.0924 secs
2025-03-13 15:35:49,845 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1295 secs
2025-03-13 15:35:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100047 [episode count 8/20]
[retrieval_preprocessing] for episode 100048 [episode count 9/20], we have num_retrieval=np.int64(2027) num_query=np.int64(110)
2025-03-13 15:35:50,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:51,037 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:51
2025-03-13 15:35:51,037 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.82it/s]
2025-03-13 15:35:51,064 [INFO]: There are 2027 embeddings of dim 49152
2025-03-13 15:35:51,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:35:51,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:51
2025-03-13 15:35:51,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:51,065 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:35:51,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:51,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:35:51,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:51
2025-03-13 15:35:51,065 [INFO]: 418.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:51,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:35:51,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:51
2025-03-13 15:35:51,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:51,065 [INFO]: 	Creating the index 03/13/2025, 15:35:51
2025-03-13 15:35:51,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:51
2025-03-13 15:35:51,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:35:51,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:51
2025-03-13 15:35:51,066 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:35:51,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.86it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.20it/s]100%|██████████| 8/8 [00:01<00:00,  4.51it/s]
2025-03-13 15:35:52,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:52
2025-03-13 15:36:19,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5009 secs
2025-03-13 15:36:19,347 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 15:36:19,347 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.40it/s]
2025-03-13 15:36:39,850 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5023 secs
2025-03-13 15:36:39,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7856 secs
2025-03-13 15:36:39,852 [INFO]: {
2025-03-13 15:36:39,852 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:39,852 [INFO]: 	index_param: efSearch=215
2025-03-13 15:36:39,852 [INFO]: 	index_path: knn.index
2025-03-13 15:36:39,852 [INFO]: 	size in bytes: 398800090
2025-03-13 15:36:39,852 [INFO]: 	avg_search_speed_ms: 8.517410812027594
2025-03-13 15:36:39,852 [INFO]: 	99p_search_speed_ms: 11.935926992446184
2025-03-13 15:36:39,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:39,852 [INFO]: 	nb vectors: 2027
2025-03-13 15:36:39,852 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:39,852 [INFO]: 	compression ratio: 0.9993087413796722
2025-03-13 15:36:39,852 [INFO]: }
2025-03-13 15:36:39,852 [INFO]: 	>>> Finished "Creating the index" in 48.7870 secs
2025-03-13 15:36:39,852 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8147 secs
2025-03-13 15:36:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 100048 [episode count 9/20]
[retrieval_preprocessing] for episode 100049 [episode count 10/20], we have num_retrieval=np.int64(2037) num_query=np.int64(100)
2025-03-13 15:36:41,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:41,497 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:41
2025-03-13 15:36:41,497 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.78it/s]
2025-03-13 15:36:41,535 [INFO]: There are 2037 embeddings of dim 49152
2025-03-13 15:36:41,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 15:36:41,535 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:41
2025-03-13 15:36:41,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:41,535 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:36:41,535 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:41,535 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:41,535 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:41
2025-03-13 15:36:41,535 [INFO]: 420.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:41,535 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:36:41,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:41
2025-03-13 15:36:41,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:41,536 [INFO]: 	Creating the index 03/13/2025, 15:36:41
2025-03-13 15:36:41,536 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:41
2025-03-13 15:36:41,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:36:41,537 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:41
2025-03-13 15:36:41,537 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:36:41,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.36it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.60it/s]100%|██████████| 9/9 [00:01<00:00,  4.85it/s]
2025-03-13 15:36:43,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:43
2025-03-13 15:37:15,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5705 secs
2025-03-13 15:37:15,966 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 15:37:15,966 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.26it/s]
2025-03-13 15:37:32,609 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6419 secs
2025-03-13 15:37:32,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0742 secs
2025-03-13 15:37:32,612 [INFO]: {
2025-03-13 15:37:32,612 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:32,612 [INFO]: 	index_param: efSearch=174
2025-03-13 15:37:32,612 [INFO]: 	index_path: knn.index
2025-03-13 15:37:32,612 [INFO]: 	size in bytes: 400767550
2025-03-13 15:37:32,612 [INFO]: 	avg_search_speed_ms: 11.878759671841038
2025-03-13 15:37:32,612 [INFO]: 	99p_search_speed_ms: 28.254189041908834
2025-03-13 15:37:32,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:32,612 [INFO]: 	nb vectors: 2037
2025-03-13 15:37:32,612 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:32,612 [INFO]: 	compression ratio: 0.9993086915345317
2025-03-13 15:37:32,612 [INFO]: }
2025-03-13 15:37:32,612 [INFO]: 	>>> Finished "Creating the index" in 51.0763 secs
2025-03-13 15:37:32,612 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1152 secs
2025-03-13 15:37:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 100049 [episode count 10/20]
[retrieval_preprocessing] for episode 100050 [episode count 11/20], we have num_retrieval=np.int64(2036) num_query=np.int64(101)
2025-03-13 15:37:34,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:35,787 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:35
2025-03-13 15:37:35,787 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 847.68it/s]
2025-03-13 15:37:35,826 [INFO]: There are 2036 embeddings of dim 49152
2025-03-13 15:37:35,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0390 secs
2025-03-13 15:37:35,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:35
2025-03-13 15:37:35,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:35,826 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:37:35,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:35,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:37:35,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:35
2025-03-13 15:37:35,827 [INFO]: 420.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:35,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:37:35,827 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:35
2025-03-13 15:37:35,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:35,827 [INFO]: 	Creating the index 03/13/2025, 15:37:35
2025-03-13 15:37:35,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:35
2025-03-13 15:37:35,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:37:35,828 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:35
2025-03-13 15:37:35,828 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:37:35,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.53it/s] 44%|████▍     | 4/9 [00:00<00:00, 15.48it/s] 78%|███████▊  | 7/9 [00:00<00:00, 20.15it/s]100%|██████████| 9/9 [00:04<00:00,  2.02it/s]
2025-03-13 15:37:40,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:40
2025-03-13 15:38:10,541 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2574 secs
2025-03-13 15:38:10,542 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 15:38:10,542 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.03it/s]
2025-03-13 15:38:28,733 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1912 secs
2025-03-13 15:38:28,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9064 secs
2025-03-13 15:38:28,735 [INFO]: {
2025-03-13 15:38:28,735 [INFO]: 	index_key: HNSW15
2025-03-13 15:38:28,735 [INFO]: 	index_param: efSearch=242
2025-03-13 15:38:28,735 [INFO]: 	index_path: knn.index
2025-03-13 15:38:28,735 [INFO]: 	size in bytes: 400570810
2025-03-13 15:38:28,735 [INFO]: 	avg_search_speed_ms: 9.266751213301323
2025-03-13 15:38:28,735 [INFO]: 	99p_search_speed_ms: 14.564962098374965
2025-03-13 15:38:28,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:38:28,735 [INFO]: 	nb vectors: 2036
2025-03-13 15:38:28,735 [INFO]: 	vectors dimension: 49152
2025-03-13 15:38:28,735 [INFO]: 	compression ratio: 0.9993086815287414
2025-03-13 15:38:28,735 [INFO]: }
2025-03-13 15:38:28,735 [INFO]: 	>>> Finished "Creating the index" in 52.9081 secs
2025-03-13 15:38:28,735 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9480 secs
2025-03-13 15:38:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:38:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 100050 [episode count 11/20]
[retrieval_preprocessing] for episode 100051 [episode count 12/20], we have num_retrieval=np.int64(2038) num_query=np.int64(99)
2025-03-13 15:38:29,886 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:30,268 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:30
2025-03-13 15:38:30,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 849.91it/s]
2025-03-13 15:38:30,302 [INFO]: There are 2038 embeddings of dim 49152
2025-03-13 15:38:30,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 15:38:30,303 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:30
2025-03-13 15:38:30,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:30,304 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:38:30,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:30,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:38:30,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:30
2025-03-13 15:38:30,305 [INFO]: 420.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:30,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:38:30,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:30
2025-03-13 15:38:30,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:30,305 [INFO]: 	Creating the index 03/13/2025, 15:38:30
2025-03-13 15:38:30,306 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:30
2025-03-13 15:38:30,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:38:30,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:30
2025-03-13 15:38:30,309 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:38:30,310 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.59it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.71it/s]100%|██████████| 9/9 [00:01<00:00,  5.18it/s]
2025-03-13 15:38:32,054 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:32
2025-03-13 15:38:57,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0044 secs
2025-03-13 15:38:57,059 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 15:38:57,059 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:11,  3.69s/it] 50%|█████     | 2/4 [00:04<00:04,  2.05s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.44s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.68s/it]
2025-03-13 15:39:27,344 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2854 secs
2025-03-13 15:39:27,347 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0375 secs
2025-03-13 15:39:27,347 [INFO]: {
2025-03-13 15:39:27,347 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:27,347 [INFO]: 	index_param: efSearch=269
2025-03-13 15:39:27,347 [INFO]: 	index_path: knn.index
2025-03-13 15:39:27,347 [INFO]: 	size in bytes: 400964290
2025-03-13 15:39:27,347 [INFO]: 	avg_search_speed_ms: 9.892972202558886
2025-03-13 15:39:27,347 [INFO]: 	99p_search_speed_ms: 21.54314413201063
2025-03-13 15:39:27,347 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:27,347 [INFO]: 	nb vectors: 2038
2025-03-13 15:39:27,347 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:27,347 [INFO]: 	compression ratio: 0.9993087015305029
2025-03-13 15:39:27,347 [INFO]: }
2025-03-13 15:39:27,347 [INFO]: 	>>> Finished "Creating the index" in 57.0417 secs
2025-03-13 15:39:27,347 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0795 secs
2025-03-13 15:39:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 100051 [episode count 12/20]
[retrieval_preprocessing] for episode 100052 [episode count 13/20], we have num_retrieval=np.int64(2020) num_query=np.int64(117)
2025-03-13 15:39:28,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:28,931 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:28
2025-03-13 15:39:28,931 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 976.10it/s]
2025-03-13 15:39:28,964 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 15:39:28,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 15:39:28,964 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:28,965 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:39:28,965 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:28,965 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 15:39:28,965 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,965 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:28,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:39:28,966 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:28
2025-03-13 15:39:28,966 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:28,966 [INFO]: 	Creating the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:28
2025-03-13 15:39:28,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0043 secs
2025-03-13 15:39:28,972 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,972 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:39:28,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.54it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.54it/s]100%|██████████| 8/8 [00:02<00:00,  3.77it/s]
2025-03-13 15:39:31,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:31
2025-03-13 15:39:59,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8325 secs
2025-03-13 15:39:59,938 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 15:39:59,938 [INFO]: 	Compute fast metrics 03/13/2025, 15:39:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 15:40:17,063 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1252 secs
2025-03-13 15:40:17,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7058 secs
2025-03-13 15:40:17,678 [INFO]: {
2025-03-13 15:40:17,678 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:17,678 [INFO]: 	index_param: efSearch=147
2025-03-13 15:40:17,678 [INFO]: 	index_path: knn.index
2025-03-13 15:40:17,678 [INFO]: 	size in bytes: 397422850
2025-03-13 15:40:17,678 [INFO]: 	avg_search_speed_ms: 7.017320159561279
2025-03-13 15:40:17,678 [INFO]: 	99p_search_speed_ms: 12.156018605455756
2025-03-13 15:40:17,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:17,679 [INFO]: 	nb vectors: 2020
2025-03-13 15:40:17,679 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:17,679 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 15:40:17,679 [INFO]: }
2025-03-13 15:40:17,679 [INFO]: 	>>> Finished "Creating the index" in 48.7123 secs
2025-03-13 15:40:17,679 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7478 secs
2025-03-13 15:40:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100052 [episode count 13/20]
[retrieval_preprocessing] for episode 100053 [episode count 14/20], we have num_retrieval=np.int64(2034) num_query=np.int64(103)
2025-03-13 15:40:18,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:19,212 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:19
2025-03-13 15:40:19,212 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.42it/s]
2025-03-13 15:40:19,241 [INFO]: There are 2034 embeddings of dim 49152
2025-03-13 15:40:19,241 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 15:40:19,241 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,241 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:19,241 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:40:19,242 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:19,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:19,242 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,242 [INFO]: 419.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:19,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:40:19,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:19
2025-03-13 15:40:19,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:19,242 [INFO]: 	Creating the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:19
2025-03-13 15:40:19,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:40:19,243 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:19
2025-03-13 15:40:19,243 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:40:19,243 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.76it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.73it/s]100%|██████████| 9/9 [00:01<00:00,  5.79it/s]
2025-03-13 15:40:20,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:20
2025-03-13 15:40:45,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4313 secs
2025-03-13 15:40:45,232 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 15:40:45,233 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 15:41:05,213 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9801 secs
2025-03-13 15:41:05,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9715 secs
2025-03-13 15:41:05,215 [INFO]: {
2025-03-13 15:41:05,215 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:05,215 [INFO]: 	index_param: efSearch=209
2025-03-13 15:41:05,215 [INFO]: 	index_path: knn.index
2025-03-13 15:41:05,215 [INFO]: 	size in bytes: 400177270
2025-03-13 15:41:05,215 [INFO]: 	avg_search_speed_ms: 9.679637600271985
2025-03-13 15:41:05,215 [INFO]: 	99p_search_speed_ms: 16.45328459329903
2025-03-13 15:41:05,215 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:05,215 [INFO]: 	nb vectors: 2034
2025-03-13 15:41:05,215 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:05,215 [INFO]: 	compression ratio: 0.9993088113175443
2025-03-13 15:41:05,215 [INFO]: }
2025-03-13 15:41:05,215 [INFO]: 	>>> Finished "Creating the index" in 45.9733 secs
2025-03-13 15:41:05,215 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0034 secs
2025-03-13 15:41:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 100053 [episode count 14/20]
[retrieval_preprocessing] for episode 100054 [episode count 15/20], we have num_retrieval=np.int64(2028) num_query=np.int64(109)
2025-03-13 15:41:06,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:06,653 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:06
2025-03-13 15:41:06,653 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1688.53it/s]
2025-03-13 15:41:06,684 [INFO]: There are 2028 embeddings of dim 49152
2025-03-13 15:41:06,684 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 15:41:06,684 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:06
2025-03-13 15:41:06,684 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:06,684 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:41:06,684 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:06,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:41:06,684 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:06
2025-03-13 15:41:06,685 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:06,685 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:41:06,685 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:06
2025-03-13 15:41:06,685 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:06,685 [INFO]: 	Creating the index 03/13/2025, 15:41:06
2025-03-13 15:41:06,685 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:06
2025-03-13 15:41:06,686 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:41:06,686 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:06
2025-03-13 15:41:06,686 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:41:06,686 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.82it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.84it/s]100%|██████████| 8/8 [00:01<00:00,  4.68it/s]
2025-03-13 15:41:08,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:08
2025-03-13 15:41:36,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4197 secs
2025-03-13 15:41:36,818 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 15:41:36,818 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.81it/s]
2025-03-13 15:41:58,973 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1548 secs
2025-03-13 15:41:58,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2890 secs
2025-03-13 15:41:58,975 [INFO]: {
2025-03-13 15:41:58,975 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:58,975 [INFO]: 	index_param: efSearch=232
2025-03-13 15:41:58,975 [INFO]: 	index_path: knn.index
2025-03-13 15:41:58,975 [INFO]: 	size in bytes: 398996830
2025-03-13 15:41:58,975 [INFO]: 	avg_search_speed_ms: 8.630273532205944
2025-03-13 15:41:58,975 [INFO]: 	99p_search_speed_ms: 12.15985053218902
2025-03-13 15:41:58,975 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:58,975 [INFO]: 	nb vectors: 2028
2025-03-13 15:41:58,975 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:58,975 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-13 15:41:58,975 [INFO]: }
2025-03-13 15:41:58,975 [INFO]: 	>>> Finished "Creating the index" in 52.2905 secs
2025-03-13 15:41:58,975 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3220 secs
2025-03-13 15:41:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 100054 [episode count 15/20]
[retrieval_preprocessing] for episode 100055 [episode count 16/20], we have num_retrieval=np.int64(2028) num_query=np.int64(109)
2025-03-13 15:42:00,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:00,702 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:00
2025-03-13 15:42:00,702 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.29it/s]
2025-03-13 15:42:00,733 [INFO]: There are 2028 embeddings of dim 49152
2025-03-13 15:42:00,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 15:42:00,734 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:00,734 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:42:00,734 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:00,734 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:42:00,734 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,734 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:00,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:42:00,734 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:00
2025-03-13 15:42:00,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:00,734 [INFO]: 	Creating the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,734 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:00
2025-03-13 15:42:00,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:42:00,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,735 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:42:00,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.70it/s] 62%|██████▎   | 5/8 [00:00<00:00, 23.97it/s]100%|██████████| 8/8 [00:02<00:00,  3.07it/s]100%|██████████| 8/8 [00:02<00:00,  3.73it/s]
2025-03-13 15:42:02,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:02
2025-03-13 15:42:36,352 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4661 secs
2025-03-13 15:42:36,352 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 15:42:36,353 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.53it/s]
2025-03-13 15:42:56,229 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8763 secs
2025-03-13 15:42:56,230 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4948 secs
2025-03-13 15:42:56,230 [INFO]: {
2025-03-13 15:42:56,230 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:56,230 [INFO]: 	index_param: efSearch=247
2025-03-13 15:42:56,230 [INFO]: 	index_path: knn.index
2025-03-13 15:42:56,230 [INFO]: 	size in bytes: 398996830
2025-03-13 15:42:56,230 [INFO]: 	avg_search_speed_ms: 8.289265041324507
2025-03-13 15:42:56,230 [INFO]: 	99p_search_speed_ms: 12.131570477504285
2025-03-13 15:42:56,230 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:56,230 [INFO]: 	nb vectors: 2028
2025-03-13 15:42:56,230 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:56,230 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-13 15:42:56,230 [INFO]: }
2025-03-13 15:42:56,230 [INFO]: 	>>> Finished "Creating the index" in 55.4962 secs
2025-03-13 15:42:56,230 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5282 secs
2025-03-13 15:42:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 100055 [episode count 16/20]
[retrieval_preprocessing] for episode 100056 [episode count 17/20], we have num_retrieval=np.int64(2037) num_query=np.int64(100)
2025-03-13 15:42:57,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:57,633 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:57
2025-03-13 15:42:57,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1684.46it/s]
2025-03-13 15:42:57,663 [INFO]: There are 2037 embeddings of dim 49152
2025-03-13 15:42:57,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 15:42:57,663 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:57
2025-03-13 15:42:57,663 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:57,663 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:42:57,663 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:57,663 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:42:57,663 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:57
2025-03-13 15:42:57,663 [INFO]: 420.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:57,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:42:57,663 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:57
2025-03-13 15:42:57,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:57,664 [INFO]: 	Creating the index 03/13/2025, 15:42:57
2025-03-13 15:42:57,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:57
2025-03-13 15:42:57,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:42:57,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:57
2025-03-13 15:42:57,665 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:42:57,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.66it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.83it/s]100%|██████████| 9/9 [00:01<00:00,  5.12it/s]100%|██████████| 9/9 [00:01<00:00,  6.16it/s]
2025-03-13 15:42:59,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:59
2025-03-13 15:43:23,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6607 secs
2025-03-13 15:43:23,790 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 15:43:23,790 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 15:43:43,896 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1059 secs
2025-03-13 15:43:43,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2336 secs
2025-03-13 15:43:43,898 [INFO]: {
2025-03-13 15:43:43,899 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:43,899 [INFO]: 	index_param: efSearch=239
2025-03-13 15:43:43,899 [INFO]: 	index_path: knn.index
2025-03-13 15:43:43,899 [INFO]: 	size in bytes: 400767550
2025-03-13 15:43:43,899 [INFO]: 	avg_search_speed_ms: 10.099837286529384
2025-03-13 15:43:43,899 [INFO]: 	99p_search_speed_ms: 14.424584270454945
2025-03-13 15:43:43,899 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:43,899 [INFO]: 	nb vectors: 2037
2025-03-13 15:43:43,899 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:43,899 [INFO]: 	compression ratio: 0.9993086915345317
2025-03-13 15:43:43,899 [INFO]: }
2025-03-13 15:43:43,899 [INFO]: 	>>> Finished "Creating the index" in 46.2352 secs
2025-03-13 15:43:43,899 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2658 secs
2025-03-13 15:43:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 100056 [episode count 17/20]
[retrieval_preprocessing] for episode 100057 [episode count 18/20], we have num_retrieval=np.int64(2031) num_query=np.int64(106)
2025-03-13 15:43:45,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:45,770 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:45
2025-03-13 15:43:45,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1616.30it/s]
2025-03-13 15:43:45,798 [INFO]: There are 2031 embeddings of dim 49152
2025-03-13 15:43:45,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:43:45,798 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:45,798 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:43:45,798 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:45,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:43:45,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,798 [INFO]: 419.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:45,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:43:45,798 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:45
2025-03-13 15:43:45,798 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:45,799 [INFO]: 	Creating the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:45
2025-03-13 15:43:45,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:43:45,800 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,800 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:43:45,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.57it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.79it/s]100%|██████████| 8/8 [00:01<00:00,  4.96it/s]
2025-03-13 15:43:47,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:47
2025-03-13 15:44:12,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1101 secs
2025-03-13 15:44:12,526 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 15:44:12,526 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 15:44:33,752 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2260 secs
2025-03-13 15:44:33,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9547 secs
2025-03-13 15:44:33,755 [INFO]: {
2025-03-13 15:44:33,755 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:33,755 [INFO]: 	index_param: efSearch=293
2025-03-13 15:44:33,755 [INFO]: 	index_path: knn.index
2025-03-13 15:44:33,755 [INFO]: 	size in bytes: 399587050
2025-03-13 15:44:33,755 [INFO]: 	avg_search_speed_ms: 11.980406898157504
2025-03-13 15:44:33,755 [INFO]: 	99p_search_speed_ms: 19.442087095230814
2025-03-13 15:44:33,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:33,755 [INFO]: 	nb vectors: 2031
2025-03-13 15:44:33,755 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:33,755 [INFO]: 	compression ratio: 0.9993087814032011
2025-03-13 15:44:33,755 [INFO]: }
2025-03-13 15:44:33,755 [INFO]: 	>>> Finished "Creating the index" in 47.9563 secs
2025-03-13 15:44:33,755 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9845 secs
2025-03-13 15:44:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 100057 [episode count 18/20]
[retrieval_preprocessing] for episode 100058 [episode count 19/20], we have num_retrieval=np.int64(2033) num_query=np.int64(104)
2025-03-13 15:44:35,660 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:35,950 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:35
2025-03-13 15:44:35,950 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.50it/s]
2025-03-13 15:44:35,979 [INFO]: There are 2033 embeddings of dim 49152
2025-03-13 15:44:35,979 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 15:44:35,979 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:35
2025-03-13 15:44:35,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:35,979 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:44:35,979 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:35,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:35,979 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:35
2025-03-13 15:44:35,979 [INFO]: 419.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:35,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:44:35,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:35
2025-03-13 15:44:35,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:35,979 [INFO]: 	Creating the index 03/13/2025, 15:44:35
2025-03-13 15:44:35,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:35
2025-03-13 15:44:35,980 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:44:35,980 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:35
2025-03-13 15:44:35,981 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:44:35,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.68it/s] 22%|██▏       | 2/9 [00:00<00:00,  8.23it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.78it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.94it/s] 67%|██████▋   | 6/9 [00:00<00:00, 11.44it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.82it/s]100%|██████████| 9/9 [00:02<00:00,  4.02it/s]
2025-03-13 15:44:38,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:38
2025-03-13 15:45:05,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1792 secs
2025-03-13 15:45:05,404 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 15:45:05,404 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.84it/s]
2025-03-13 15:45:30,413 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0083 secs
2025-03-13 15:45:30,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4340 secs
2025-03-13 15:45:30,415 [INFO]: {
2025-03-13 15:45:30,415 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:30,415 [INFO]: 	index_param: efSearch=256
2025-03-13 15:45:30,415 [INFO]: 	index_path: knn.index
2025-03-13 15:45:30,415 [INFO]: 	size in bytes: 399980530
2025-03-13 15:45:30,415 [INFO]: 	avg_search_speed_ms: 9.763547415332141
2025-03-13 15:45:30,415 [INFO]: 	99p_search_speed_ms: 18.251826330088072
2025-03-13 15:45:30,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:30,415 [INFO]: 	nb vectors: 2033
2025-03-13 15:45:30,415 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:30,415 [INFO]: 	compression ratio: 0.999308801355906
2025-03-13 15:45:30,415 [INFO]: }
2025-03-13 15:45:30,415 [INFO]: 	>>> Finished "Creating the index" in 54.4355 secs
2025-03-13 15:45:30,415 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4651 secs
2025-03-13 15:45:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 100058 [episode count 19/20]
2025-03-13 15:45:31: [retrieval_preprocessing] finished for collected_demos_training/2023-03-04_pick_up_the_pineapple_and_put_it_in_the_bowl [chosen_id count 2/8]
2025-03-13 15:45:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_the_jug_to_the_left [chosen_id count 3/8]
2025-03-13 15:45:33: [retrieval_preprocessing] we have num_total=1973 embedding_dim=49152
[retrieval_preprocessing] for episode 100059 [episode count 0/20], we have num_retrieval=np.int64(1828) num_query=np.int64(145)
2025-03-13 15:45:33,508 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:33,899 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:33
2025-03-13 15:45:33,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 874.91it/s]
2025-03-13 15:45:33,940 [INFO]: There are 1828 embeddings of dim 49152
2025-03-13 15:45:33,940 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0411 secs
2025-03-13 15:45:33,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:33
2025-03-13 15:45:33,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:33,941 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:45:33,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:33,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:45:33,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:33
2025-03-13 15:45:33,942 [INFO]: 377.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:33,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:45:33,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:33
2025-03-13 15:45:33,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:33,943 [INFO]: 	Creating the index 03/13/2025, 15:45:33
2025-03-13 15:45:33,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:33
2025-03-13 15:45:33,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 15:45:33,946 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:33
2025-03-13 15:45:33,946 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:45:33,946 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.17it/s] 50%|█████     | 4/8 [00:00<00:00, 18.04it/s]100%|██████████| 8/8 [00:01<00:00,  3.61it/s]100%|██████████| 8/8 [00:01<00:00,  4.16it/s]
2025-03-13 15:45:35,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:35
2025-03-13 15:46:06,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3477 secs
2025-03-13 15:46:06,224 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 15:46:06,224 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.94it/s]
2025-03-13 15:46:23,220 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9954 secs
2025-03-13 15:46:23,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2756 secs
2025-03-13 15:46:23,222 [INFO]: {
2025-03-13 15:46:23,222 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:23,222 [INFO]: 	index_param: efSearch=92
2025-03-13 15:46:23,222 [INFO]: 	index_path: knn.index
2025-03-13 15:46:23,222 [INFO]: 	size in bytes: 359647930
2025-03-13 15:46:23,222 [INFO]: 	avg_search_speed_ms: 6.590183275759751
2025-03-13 15:46:23,222 [INFO]: 	99p_search_speed_ms: 10.301398551091548
2025-03-13 15:46:23,222 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:23,222 [INFO]: 	nb vectors: 1828
2025-03-13 15:46:23,222 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:23,222 [INFO]: 	compression ratio: 0.9993090298058993
2025-03-13 15:46:23,222 [INFO]: }
2025-03-13 15:46:23,222 [INFO]: 	>>> Finished "Creating the index" in 49.2791 secs
2025-03-13 15:46:23,222 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3230 secs
2025-03-13 15:46:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 100059 [episode count 0/20]
[retrieval_preprocessing] for episode 100060 [episode count 1/20], we have num_retrieval=np.int64(1862) num_query=np.int64(111)
2025-03-13 15:46:24,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:24,991 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:24
2025-03-13 15:46:24,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-13 15:46:25,029 [INFO]: There are 1862 embeddings of dim 49152
2025-03-13 15:46:25,029 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 15:46:25,029 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:25
2025-03-13 15:46:25,029 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:25,029 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:46:25,029 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:25,029 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:46:25,029 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:25
2025-03-13 15:46:25,029 [INFO]: 384.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:25,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:46:25,029 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:25
2025-03-13 15:46:25,030 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:25,030 [INFO]: 	Creating the index 03/13/2025, 15:46:25
2025-03-13 15:46:25,030 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:25
2025-03-13 15:46:25,031 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:46:25,031 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:25
2025-03-13 15:46:25,031 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:46:25,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.92it/s] 62%|██████▎   | 5/8 [00:00<00:00, 21.43it/s]100%|██████████| 8/8 [00:02<00:00,  3.30it/s]100%|██████████| 8/8 [00:02<00:00,  3.97it/s]
2025-03-13 15:46:27,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:27
2025-03-13 15:46:52,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7266 secs
2025-03-13 15:46:52,775 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 15:46:52,775 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.53it/s]
2025-03-13 15:47:12,008 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2320 secs
2025-03-13 15:47:12,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9782 secs
2025-03-13 15:47:12,009 [INFO]: {
2025-03-13 15:47:12,009 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:12,009 [INFO]: 	index_param: efSearch=192
2025-03-13 15:47:12,009 [INFO]: 	index_path: knn.index
2025-03-13 15:47:12,009 [INFO]: 	size in bytes: 366337270
2025-03-13 15:47:12,009 [INFO]: 	avg_search_speed_ms: 9.883452405170225
2025-03-13 15:47:12,009 [INFO]: 	99p_search_speed_ms: 14.745598253794011
2025-03-13 15:47:12,009 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:12,009 [INFO]: 	nb vectors: 1862
2025-03-13 15:47:12,009 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:12,009 [INFO]: 	compression ratio: 0.9993089046058568
2025-03-13 15:47:12,009 [INFO]: }
2025-03-13 15:47:12,009 [INFO]: 	>>> Finished "Creating the index" in 46.9799 secs
2025-03-13 15:47:12,009 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0185 secs
2025-03-13 15:47:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100060 [episode count 1/20]
[retrieval_preprocessing] for episode 100061 [episode count 2/20], we have num_retrieval=np.int64(1844) num_query=np.int64(129)
2025-03-13 15:47:13,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:13,579 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:13
2025-03-13 15:47:13,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.69it/s]
2025-03-13 15:47:13,608 [INFO]: There are 1844 embeddings of dim 49152
2025-03-13 15:47:13,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 15:47:13,608 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,608 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:13,608 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:47:13,608 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:13,608 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:47:13,608 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,609 [INFO]: 380.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:13,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:47:13,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:13
2025-03-13 15:47:13,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:13,609 [INFO]: 	Creating the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:13
2025-03-13 15:47:13,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:47:13,610 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,610 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:47:13,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.57it/s] 88%|████████▊ | 7/8 [00:00<00:00, 30.91it/s]100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
2025-03-13 15:47:15,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:15
2025-03-13 15:47:46,982 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0745 secs
2025-03-13 15:47:46,982 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:47:46,982 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.61s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.31s/it]
2025-03-13 15:48:06,486 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5037 secs
2025-03-13 15:48:06,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8789 secs
2025-03-13 15:48:06,489 [INFO]: {
2025-03-13 15:48:06,489 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:06,489 [INFO]: 	index_param: efSearch=162
2025-03-13 15:48:06,489 [INFO]: 	index_path: knn.index
2025-03-13 15:48:06,489 [INFO]: 	size in bytes: 362795770
2025-03-13 15:48:06,489 [INFO]: 	avg_search_speed_ms: 11.142944742330165
2025-03-13 15:48:06,489 [INFO]: 	99p_search_speed_ms: 17.17881795484572
2025-03-13 15:48:06,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:06,489 [INFO]: 	nb vectors: 1844
2025-03-13 15:48:06,489 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:06,489 [INFO]: 	compression ratio: 0.9993092036326664
2025-03-13 15:48:06,489 [INFO]: }
2025-03-13 15:48:06,489 [INFO]: 	>>> Finished "Creating the index" in 52.8804 secs
2025-03-13 15:48:06,489 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9105 secs
2025-03-13 15:48:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100061 [episode count 2/20]
[retrieval_preprocessing] for episode 100062 [episode count 3/20], we have num_retrieval=np.int64(1888) num_query=np.int64(85)
2025-03-13 15:48:08,160 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:08,535 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:08
2025-03-13 15:48:08,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1355.63it/s]
2025-03-13 15:48:08,565 [INFO]: There are 1888 embeddings of dim 49152
2025-03-13 15:48:08,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 15:48:08,566 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:08
2025-03-13 15:48:08,566 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:08,566 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:48:08,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:08,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:48:08,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:08
2025-03-13 15:48:08,566 [INFO]: 389.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:08,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:48:08,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:08
2025-03-13 15:48:08,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:08,566 [INFO]: 	Creating the index 03/13/2025, 15:48:08
2025-03-13 15:48:08,566 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:08
2025-03-13 15:48:08,568 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:48:08,568 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:08
2025-03-13 15:48:08,568 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:48:08,568 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.31it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.32it/s] 50%|█████     | 4/8 [00:00<00:00,  8.89it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.56it/s]100%|██████████| 8/8 [00:02<00:00,  2.57it/s]100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
2025-03-13 15:48:10,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:10
2025-03-13 15:48:38,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5738 secs
2025-03-13 15:48:38,446 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 15:48:38,446 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.10it/s]
2025-03-13 15:49:01,338 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8921 secs
2025-03-13 15:49:01,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7717 secs
2025-03-13 15:49:01,340 [INFO]: {
2025-03-13 15:49:01,340 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:01,340 [INFO]: 	index_param: efSearch=188
2025-03-13 15:49:01,340 [INFO]: 	index_path: knn.index
2025-03-13 15:49:01,340 [INFO]: 	size in bytes: 371452750
2025-03-13 15:49:01,340 [INFO]: 	avg_search_speed_ms: 10.192253976959686
2025-03-13 15:49:01,340 [INFO]: 	99p_search_speed_ms: 21.541553316637884
2025-03-13 15:49:01,340 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:01,340 [INFO]: 	nb vectors: 1888
2025-03-13 15:49:01,340 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:01,340 [INFO]: 	compression ratio: 0.9993085365500727
2025-03-13 15:49:01,340 [INFO]: }
2025-03-13 15:49:01,340 [INFO]: 	>>> Finished "Creating the index" in 52.7737 secs
2025-03-13 15:49:01,340 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8046 secs
2025-03-13 15:49:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 100062 [episode count 3/20]
[retrieval_preprocessing] for episode 100063 [episode count 4/20], we have num_retrieval=np.int64(1872) num_query=np.int64(101)
2025-03-13 15:49:02,231 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:02,630 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:02
2025-03-13 15:49:02,630 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1053.85it/s]
2025-03-13 15:49:02,661 [INFO]: There are 1872 embeddings of dim 49152
2025-03-13 15:49:02,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 15:49:02,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:02
2025-03-13 15:49:02,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:02,661 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:49:02,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:02,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:02,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:02
2025-03-13 15:49:02,661 [INFO]: 386.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:02,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:49:02,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:02
2025-03-13 15:49:02,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:02,662 [INFO]: 	Creating the index 03/13/2025, 15:49:02
2025-03-13 15:49:02,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:02
2025-03-13 15:49:02,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:49:02,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:02
2025-03-13 15:49:02,663 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:49:02,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.37it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.50it/s]100%|██████████| 8/8 [00:01<00:00,  5.06it/s]
2025-03-13 15:49:04,677 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:04
2025-03-13 15:49:33,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9556 secs
2025-03-13 15:49:33,633 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 15:49:33,633 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.19it/s]
2025-03-13 15:49:58,245 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6119 secs
2025-03-13 15:49:58,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5836 secs
2025-03-13 15:49:58,247 [INFO]: {
2025-03-13 15:49:58,247 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:58,247 [INFO]: 	index_param: efSearch=224
2025-03-13 15:49:58,247 [INFO]: 	index_path: knn.index
2025-03-13 15:49:58,247 [INFO]: 	size in bytes: 368304730
2025-03-13 15:49:58,247 [INFO]: 	avg_search_speed_ms: 10.701233394105326
2025-03-13 15:49:58,247 [INFO]: 	99p_search_speed_ms: 15.773646319285026
2025-03-13 15:49:58,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:58,247 [INFO]: 	nb vectors: 1872
2025-03-13 15:49:58,247 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:58,247 [INFO]: 	compression ratio: 0.9993088494953621
2025-03-13 15:49:58,247 [INFO]: }
2025-03-13 15:49:58,247 [INFO]: 	>>> Finished "Creating the index" in 55.5854 secs
2025-03-13 15:49:58,247 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6167 secs
2025-03-13 15:49:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 100063 [episode count 4/20]
[retrieval_preprocessing] for episode 100064 [episode count 5/20], we have num_retrieval=np.int64(1873) num_query=np.int64(100)
2025-03-13 15:49:59,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:59,782 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:59
2025-03-13 15:49:59,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2135.59it/s]
2025-03-13 15:49:59,812 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 15:49:59,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 15:49:59,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:59
2025-03-13 15:49:59,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:59,812 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:49:59,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:59,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:59,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:59
2025-03-13 15:49:59,812 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:59,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:49:59,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:59
2025-03-13 15:49:59,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:59,812 [INFO]: 	Creating the index 03/13/2025, 15:49:59
2025-03-13 15:49:59,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:59
2025-03-13 15:49:59,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:49:59,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:59
2025-03-13 15:49:59,813 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:49:59,814 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.55it/s]100%|██████████| 8/8 [00:01<00:00,  5.13it/s]100%|██████████| 8/8 [00:01<00:00,  5.42it/s]
2025-03-13 15:50:01,291 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:01
2025-03-13 15:50:27,218 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9261 secs
2025-03-13 15:50:27,218 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:50:27,218 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.63it/s]
2025-03-13 15:50:44,671 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4534 secs
2025-03-13 15:50:45,329 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5153 secs
2025-03-13 15:50:45,329 [INFO]: {
2025-03-13 15:50:45,329 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:45,329 [INFO]: 	index_param: efSearch=154
2025-03-13 15:50:45,330 [INFO]: 	index_path: knn.index
2025-03-13 15:50:45,330 [INFO]: 	size in bytes: 368501470
2025-03-13 15:50:45,330 [INFO]: 	avg_search_speed_ms: 9.5092626751096
2025-03-13 15:50:45,330 [INFO]: 	99p_search_speed_ms: 14.455244059208782
2025-03-13 15:50:45,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:45,330 [INFO]: 	nb vectors: 1873
2025-03-13 15:50:45,330 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:45,330 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 15:50:45,330 [INFO]: }
2025-03-13 15:50:45,330 [INFO]: 	>>> Finished "Creating the index" in 45.5178 secs
2025-03-13 15:50:45,330 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5483 secs
2025-03-13 15:50:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 100064 [episode count 5/20]
[retrieval_preprocessing] for episode 100065 [episode count 6/20], we have num_retrieval=np.int64(1876) num_query=np.int64(97)
2025-03-13 15:50:46,660 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:47,095 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:47
2025-03-13 15:50:47,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.09it/s]
2025-03-13 15:50:47,138 [INFO]: There are 1876 embeddings of dim 49152
2025-03-13 15:50:47,139 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0434 secs
2025-03-13 15:50:47,139 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:47
2025-03-13 15:50:47,139 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:47,139 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:50:47,139 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:47,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:50:47,139 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:47
2025-03-13 15:50:47,139 [INFO]: 387.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:47,139 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:50:47,139 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:47
2025-03-13 15:50:47,139 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:47,139 [INFO]: 	Creating the index 03/13/2025, 15:50:47
2025-03-13 15:50:47,139 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:47
2025-03-13 15:50:47,140 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:50:47,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:47
2025-03-13 15:50:47,140 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:50:47,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.81it/s] 50%|█████     | 4/8 [00:00<00:00, 15.53it/s] 88%|████████▊ | 7/8 [00:00<00:00, 20.18it/s]100%|██████████| 8/8 [00:01<00:00,  4.11it/s]
2025-03-13 15:50:49,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:49
2025-03-13 15:51:18,349 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2554 secs
2025-03-13 15:51:18,349 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 15:51:18,349 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-13 15:51:44,046 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6971 secs
2025-03-13 15:51:44,048 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9077 secs
2025-03-13 15:51:44,048 [INFO]: {
2025-03-13 15:51:44,048 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:44,048 [INFO]: 	index_param: efSearch=157
2025-03-13 15:51:44,048 [INFO]: 	index_path: knn.index
2025-03-13 15:51:44,048 [INFO]: 	size in bytes: 369091750
2025-03-13 15:51:44,048 [INFO]: 	avg_search_speed_ms: 9.343050087140613
2025-03-13 15:51:44,048 [INFO]: 	99p_search_speed_ms: 19.276153682731074
2025-03-13 15:51:44,048 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:44,048 [INFO]: 	nb vectors: 1876
2025-03-13 15:51:44,048 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:44,048 [INFO]: 	compression ratio: 0.999308730146366
2025-03-13 15:51:44,048 [INFO]: }
2025-03-13 15:51:44,048 [INFO]: 	>>> Finished "Creating the index" in 56.9092 secs
2025-03-13 15:51:44,048 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9534 secs
2025-03-13 15:51:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 100065 [episode count 6/20]
[retrieval_preprocessing] for episode 100066 [episode count 7/20], we have num_retrieval=np.int64(1839) num_query=np.int64(134)
2025-03-13 15:51:44,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:45,285 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:45
2025-03-13 15:51:45,285 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-13 15:51:45,320 [INFO]: There are 1839 embeddings of dim 49152
2025-03-13 15:51:45,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 15:51:45,320 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:45
2025-03-13 15:51:45,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:45,320 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:51:45,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:45,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:51:45,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:45
2025-03-13 15:51:45,321 [INFO]: 379.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:45,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:51:45,321 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:45
2025-03-13 15:51:45,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:45,321 [INFO]: 	Creating the index 03/13/2025, 15:51:45
2025-03-13 15:51:45,321 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:45
2025-03-13 15:51:45,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:51:45,322 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:45
2025-03-13 15:51:45,322 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:51:45,322 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.03it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.29it/s]100%|██████████| 8/8 [00:01<00:00,  4.46it/s]
2025-03-13 15:51:47,118 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:47
2025-03-13 15:52:18,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9870 secs
2025-03-13 15:52:18,106 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 15:52:18,106 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.92it/s]
2025-03-13 15:52:32,810 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7041 secs
2025-03-13 15:52:32,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4902 secs
2025-03-13 15:52:32,812 [INFO]: {
2025-03-13 15:52:32,812 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:32,812 [INFO]: 	index_param: efSearch=167
2025-03-13 15:52:32,812 [INFO]: 	index_path: knn.index
2025-03-13 15:52:32,812 [INFO]: 	size in bytes: 361812070
2025-03-13 15:52:32,812 [INFO]: 	avg_search_speed_ms: 9.98002304876792
2025-03-13 15:52:32,812 [INFO]: 	99p_search_speed_ms: 19.506261402275413
2025-03-13 15:52:32,812 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:32,812 [INFO]: 	nb vectors: 1839
2025-03-13 15:52:32,812 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:32,812 [INFO]: 	compression ratio: 0.9993091496367161
2025-03-13 15:52:32,812 [INFO]: }
2025-03-13 15:52:32,812 [INFO]: 	>>> Finished "Creating the index" in 47.4917 secs
2025-03-13 15:52:32,812 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5272 secs
2025-03-13 15:52:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 100066 [episode count 7/20]
[retrieval_preprocessing] for episode 100067 [episode count 8/20], we have num_retrieval=np.int64(1879) num_query=np.int64(94)
2025-03-13 15:52:33,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:34,304 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:34
2025-03-13 15:52:34,304 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 747.12it/s]
2025-03-13 15:52:34,345 [INFO]: There are 1879 embeddings of dim 49152
2025-03-13 15:52:34,346 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0418 secs
2025-03-13 15:52:34,346 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,346 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:34,346 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:52:34,346 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:34,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:52:34,347 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,347 [INFO]: 387.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:34,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:52:34,348 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:34
2025-03-13 15:52:34,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:34,348 [INFO]: 	Creating the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,348 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:34
2025-03-13 15:52:34,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:52:34,352 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,352 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:52:34,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.29it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.73it/s]100%|██████████| 8/8 [00:01<00:00,  4.14it/s]
2025-03-13 15:52:36,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:36
2025-03-13 15:53:05,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1164 secs
2025-03-13 15:53:05,407 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 15:53:05,407 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.77it/s]
2025-03-13 15:53:25,709 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3013 secs
2025-03-13 15:53:25,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3588 secs
2025-03-13 15:53:25,711 [INFO]: {
2025-03-13 15:53:25,711 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:25,711 [INFO]: 	index_param: efSearch=170
2025-03-13 15:53:25,711 [INFO]: 	index_path: knn.index
2025-03-13 15:53:25,711 [INFO]: 	size in bytes: 369682030
2025-03-13 15:53:25,711 [INFO]: 	avg_search_speed_ms: 9.073018308723862
2025-03-13 15:53:25,711 [INFO]: 	99p_search_speed_ms: 14.138662037439648
2025-03-13 15:53:25,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:25,711 [INFO]: 	nb vectors: 1879
2025-03-13 15:53:25,711 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:25,711 [INFO]: 	compression ratio: 0.9993086004207453
2025-03-13 15:53:25,711 [INFO]: }
2025-03-13 15:53:25,711 [INFO]: 	>>> Finished "Creating the index" in 51.3632 secs
2025-03-13 15:53:25,711 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4076 secs
2025-03-13 15:53:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 100067 [episode count 8/20]
[retrieval_preprocessing] for episode 100068 [episode count 9/20], we have num_retrieval=np.int64(1898) num_query=np.int64(75)
2025-03-13 15:53:26,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:27,067 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:27
2025-03-13 15:53:27,067 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1312.36it/s]
2025-03-13 15:53:27,098 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 15:53:27,098 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 15:53:27,098 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,098 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:27,098 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:53:27,098 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:27,098 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:27,098 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,098 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:27,099 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:53:27,099 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:27
2025-03-13 15:53:27,099 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:27,099 [INFO]: 	Creating the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,099 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:27
2025-03-13 15:53:27,100 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:53:27,100 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,100 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:53:27,100 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.24it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.35it/s]100%|██████████| 8/8 [00:02<00:00,  3.72it/s]
2025-03-13 15:53:29,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:29
2025-03-13 15:53:56,851 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5954 secs
2025-03-13 15:53:56,851 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 15:53:56,851 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.44it/s]
2025-03-13 15:54:17,340 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4886 secs
2025-03-13 15:54:17,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2412 secs
2025-03-13 15:54:17,341 [INFO]: {
2025-03-13 15:54:17,341 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:17,341 [INFO]: 	index_param: efSearch=184
2025-03-13 15:54:17,341 [INFO]: 	index_path: knn.index
2025-03-13 15:54:17,341 [INFO]: 	size in bytes: 373420150
2025-03-13 15:54:17,341 [INFO]: 	avg_search_speed_ms: 8.995378523539054
2025-03-13 15:54:17,341 [INFO]: 	99p_search_speed_ms: 13.809317410923546
2025-03-13 15:54:17,341 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:17,341 [INFO]: 	nb vectors: 1898
2025-03-13 15:54:17,341 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:17,341 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 15:54:17,341 [INFO]: }
2025-03-13 15:54:17,341 [INFO]: 	>>> Finished "Creating the index" in 50.2428 secs
2025-03-13 15:54:17,341 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2740 secs
2025-03-13 15:54:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100068 [episode count 9/20]
[retrieval_preprocessing] for episode 100069 [episode count 10/20], we have num_retrieval=np.int64(1841) num_query=np.int64(132)
2025-03-13 15:54:18,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:18,432 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:18
2025-03-13 15:54:18,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.98it/s]
2025-03-13 15:54:18,462 [INFO]: There are 1841 embeddings of dim 49152
2025-03-13 15:54:18,463 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 15:54:18,463 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:18
2025-03-13 15:54:18,463 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:18,463 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:54:18,463 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:18,463 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:18,463 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:18
2025-03-13 15:54:18,463 [INFO]: 379.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:18,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:54:18,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:18
2025-03-13 15:54:18,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:18,463 [INFO]: 	Creating the index 03/13/2025, 15:54:18
2025-03-13 15:54:18,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:18
2025-03-13 15:54:18,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:54:18,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:18
2025-03-13 15:54:18,464 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:54:18,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.69it/s]100%|██████████| 8/8 [00:01<00:00,  5.65it/s]100%|██████████| 8/8 [00:01<00:00,  5.95it/s]
2025-03-13 15:54:19,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:19
2025-03-13 15:54:45,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2387 secs
2025-03-13 15:54:45,051 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 15:54:45,051 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.58it/s]
2025-03-13 15:55:02,979 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9275 secs
2025-03-13 15:55:02,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.5163 secs
2025-03-13 15:55:02,981 [INFO]: {
2025-03-13 15:55:02,981 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:02,981 [INFO]: 	index_param: efSearch=198
2025-03-13 15:55:02,981 [INFO]: 	index_path: knn.index
2025-03-13 15:55:02,981 [INFO]: 	size in bytes: 362205550
2025-03-13 15:55:02,981 [INFO]: 	avg_search_speed_ms: 12.739116613379425
2025-03-13 15:55:02,981 [INFO]: 	99p_search_speed_ms: 18.849232811480757
2025-03-13 15:55:02,981 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:02,981 [INFO]: 	nb vectors: 1841
2025-03-13 15:55:02,981 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:02,981 [INFO]: 	compression ratio: 0.9993091712702912
2025-03-13 15:55:02,981 [INFO]: }
2025-03-13 15:55:02,981 [INFO]: 	>>> Finished "Creating the index" in 44.5178 secs
2025-03-13 15:55:02,981 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5489 secs
2025-03-13 15:55:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 100069 [episode count 10/20]
[retrieval_preprocessing] for episode 100070 [episode count 11/20], we have num_retrieval=np.int64(1859) num_query=np.int64(114)
2025-03-13 15:55:04,592 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:04,882 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:04
2025-03-13 15:55:04,882 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2366.99it/s]
2025-03-13 15:55:04,913 [INFO]: There are 1859 embeddings of dim 49152
2025-03-13 15:55:04,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 15:55:04,913 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:04,913 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:55:04,913 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:04,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:04,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,913 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:04,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:55:04,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:04
2025-03-13 15:55:04,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:04,913 [INFO]: 	Creating the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,913 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:04
2025-03-13 15:55:04,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:55:04,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:04
2025-03-13 15:55:04,914 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:55:04,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.94it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.46it/s]100%|██████████| 8/8 [00:01<00:00,  5.07it/s]
2025-03-13 15:55:06,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:06
2025-03-13 15:55:35,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9772 secs
2025-03-13 15:55:35,471 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:55:35,472 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.76it/s]
2025-03-13 15:55:53,593 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1209 secs
2025-03-13 15:55:53,594 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6798 secs
2025-03-13 15:55:53,594 [INFO]: {
2025-03-13 15:55:53,594 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:53,594 [INFO]: 	index_param: efSearch=187
2025-03-13 15:55:53,594 [INFO]: 	index_path: knn.index
2025-03-13 15:55:53,594 [INFO]: 	size in bytes: 365746990
2025-03-13 15:55:53,594 [INFO]: 	avg_search_speed_ms: 12.139557604791
2025-03-13 15:55:53,594 [INFO]: 	99p_search_speed_ms: 17.05331997014582
2025-03-13 15:55:53,594 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:53,594 [INFO]: 	nb vectors: 1859
2025-03-13 15:55:53,594 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:53,594 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-13 15:55:53,594 [INFO]: }
2025-03-13 15:55:53,594 [INFO]: 	>>> Finished "Creating the index" in 48.6812 secs
2025-03-13 15:55:53,594 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7126 secs
2025-03-13 15:55:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 100070 [episode count 11/20]
[retrieval_preprocessing] for episode 100071 [episode count 12/20], we have num_retrieval=np.int64(1902) num_query=np.int64(71)
2025-03-13 15:55:54,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:55,078 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:55
2025-03-13 15:55:55,078 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.94it/s]
2025-03-13 15:55:55,107 [INFO]: There are 1902 embeddings of dim 49152
2025-03-13 15:55:55,107 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:55:55,107 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:55
2025-03-13 15:55:55,107 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:55,107 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:55:55,107 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:55,107 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:55,107 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:55
2025-03-13 15:55:55,108 [INFO]: 392.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:55,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:55:55,108 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:55
2025-03-13 15:55:55,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:55,108 [INFO]: 	Creating the index 03/13/2025, 15:55:55
2025-03-13 15:55:55,108 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:55
2025-03-13 15:55:55,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:55:55,109 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:55
2025-03-13 15:55:55,109 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:55:55,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.04it/s] 62%|██████▎   | 5/8 [00:00<00:00, 25.62it/s]100%|██████████| 8/8 [00:02<00:00,  2.87it/s]100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
2025-03-13 15:55:57,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:57
2025-03-13 15:56:35,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3793 secs
2025-03-13 15:56:35,776 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 15:56:35,776 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.80it/s]
2025-03-13 15:56:52,280 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5047 secs
2025-03-13 15:56:52,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1733 secs
2025-03-13 15:56:52,282 [INFO]: {
2025-03-13 15:56:52,282 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:52,282 [INFO]: 	index_param: efSearch=139
2025-03-13 15:56:52,283 [INFO]: 	index_path: knn.index
2025-03-13 15:56:52,283 [INFO]: 	size in bytes: 374207170
2025-03-13 15:56:52,283 [INFO]: 	avg_search_speed_ms: 7.917832869480372
2025-03-13 15:56:52,283 [INFO]: 	99p_search_speed_ms: 11.369519550353282
2025-03-13 15:56:52,283 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:52,283 [INFO]: 	nb vectors: 1902
2025-03-13 15:56:52,283 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:52,283 [INFO]: 	compression ratio: 0.9993085274127698
2025-03-13 15:56:52,283 [INFO]: }
2025-03-13 15:56:52,283 [INFO]: 	>>> Finished "Creating the index" in 57.1749 secs
2025-03-13 15:56:52,283 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2043 secs
2025-03-13 15:56:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 100071 [episode count 12/20]
[retrieval_preprocessing] for episode 100072 [episode count 13/20], we have num_retrieval=np.int64(1916) num_query=np.int64(57)
2025-03-13 15:56:53,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:53,492 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:53
2025-03-13 15:56:53,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1600.88it/s]
2025-03-13 15:56:53,526 [INFO]: There are 1916 embeddings of dim 49152
2025-03-13 15:56:53,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 15:56:53,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:53
2025-03-13 15:56:53,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:53,526 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:56:53,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:53,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:53,527 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:53
2025-03-13 15:56:53,527 [INFO]: 395.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:53,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:56:53,527 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:53
2025-03-13 15:56:53,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:53,527 [INFO]: 	Creating the index 03/13/2025, 15:56:53
2025-03-13 15:56:53,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:53
2025-03-13 15:56:53,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:56:53,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:53
2025-03-13 15:56:53,528 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:56:53,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.71it/s] 62%|██████▎   | 5/8 [00:00<00:00, 20.65it/s]100%|██████████| 8/8 [00:02<00:00,  2.79it/s]100%|██████████| 8/8 [00:02<00:00,  3.38it/s]
2025-03-13 15:56:55,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:55
2025-03-13 15:57:23,733 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8350 secs
2025-03-13 15:57:23,733 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 15:57:23,734 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 15:57:41,873 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1392 secs
2025-03-13 15:57:41,875 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3472 secs
2025-03-13 15:57:41,875 [INFO]: {
2025-03-13 15:57:41,875 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:41,875 [INFO]: 	index_param: efSearch=180
2025-03-13 15:57:41,875 [INFO]: 	index_path: knn.index
2025-03-13 15:57:41,876 [INFO]: 	size in bytes: 376961590
2025-03-13 15:57:41,876 [INFO]: 	avg_search_speed_ms: 12.382874793216292
2025-03-13 15:57:41,876 [INFO]: 	99p_search_speed_ms: 22.828961017075862
2025-03-13 15:57:41,876 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:41,876 [INFO]: 	nb vectors: 1916
2025-03-13 15:57:41,876 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:41,876 [INFO]: 	compression ratio: 0.9993085184089976
2025-03-13 15:57:41,876 [INFO]: }
2025-03-13 15:57:41,876 [INFO]: 	>>> Finished "Creating the index" in 48.3487 secs
2025-03-13 15:57:41,876 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3838 secs
2025-03-13 15:57:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 100072 [episode count 13/20]
[retrieval_preprocessing] for episode 100073 [episode count 14/20], we have num_retrieval=np.int64(1832) num_query=np.int64(141)
2025-03-13 15:57:43,462 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:43,746 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:43
2025-03-13 15:57:43,746 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.25it/s]
2025-03-13 15:57:43,774 [INFO]: There are 1832 embeddings of dim 49152
2025-03-13 15:57:43,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:57:43,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:43
2025-03-13 15:57:43,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:43,774 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:57:43,774 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:43,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:43,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:43
2025-03-13 15:57:43,774 [INFO]: 378.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:43,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:57:43,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:43
2025-03-13 15:57:43,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:43,774 [INFO]: 	Creating the index 03/13/2025, 15:57:43
2025-03-13 15:57:43,774 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:43
2025-03-13 15:57:43,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:57:43,775 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:43
2025-03-13 15:57:43,775 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:57:43,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.17it/s] 38%|███▊      | 3/8 [00:00<00:00, 11.86it/s] 62%|██████▎   | 5/8 [00:00<00:00, 13.41it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.79it/s]100%|██████████| 8/8 [00:02<00:00,  3.74it/s]
2025-03-13 15:57:45,917 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:45
2025-03-13 15:58:12,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6372 secs
2025-03-13 15:58:12,555 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 15:58:12,555 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
2025-03-13 15:58:38,431 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8754 secs
2025-03-13 15:58:38,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6585 secs
2025-03-13 15:58:38,434 [INFO]: {
2025-03-13 15:58:38,434 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:38,434 [INFO]: 	index_param: efSearch=233
2025-03-13 15:58:38,434 [INFO]: 	index_path: knn.index
2025-03-13 15:58:38,434 [INFO]: 	size in bytes: 360434890
2025-03-13 15:58:38,434 [INFO]: 	avg_search_speed_ms: 10.145168404121323
2025-03-13 15:58:38,434 [INFO]: 	99p_search_speed_ms: 22.27520606247708
2025-03-13 15:58:38,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:38,434 [INFO]: 	nb vectors: 1832
2025-03-13 15:58:38,434 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:38,434 [INFO]: 	compression ratio: 0.9993090735472362
2025-03-13 15:58:38,434 [INFO]: }
2025-03-13 15:58:38,434 [INFO]: 	>>> Finished "Creating the index" in 54.6601 secs
2025-03-13 15:58:38,434 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6885 secs
2025-03-13 15:58:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 100073 [episode count 14/20]
[retrieval_preprocessing] for episode 100074 [episode count 15/20], we have num_retrieval=np.int64(1904) num_query=np.int64(69)
2025-03-13 15:58:40,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:41,311 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:41
2025-03-13 15:58:41,311 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.00it/s]
2025-03-13 15:58:41,336 [INFO]: There are 1904 embeddings of dim 49152
2025-03-13 15:58:41,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 15:58:41,336 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:41,336 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:58:41,336 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:41,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:58:41,336 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,337 [INFO]: 392.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:41,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:58:41,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:41
2025-03-13 15:58:41,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:41,337 [INFO]: 	Creating the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,337 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:41
2025-03-13 15:58:41,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:58:41,338 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:41
2025-03-13 15:58:41,338 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:58:41,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.22it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.62it/s] 62%|██████▎   | 5/8 [00:00<00:00, 12.54it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.96it/s]100%|██████████| 8/8 [00:02<00:00,  3.97it/s]
2025-03-13 15:58:43,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:43
2025-03-13 15:59:12,975 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0671 secs
2025-03-13 15:59:12,975 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 15:59:12,975 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 15:59:34,291 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3162 secs
2025-03-13 15:59:34,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9553 secs
2025-03-13 15:59:34,293 [INFO]: {
2025-03-13 15:59:34,293 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:34,293 [INFO]: 	index_param: efSearch=218
2025-03-13 15:59:34,293 [INFO]: 	index_path: knn.index
2025-03-13 15:59:34,293 [INFO]: 	size in bytes: 374600710
2025-03-13 15:59:34,293 [INFO]: 	avg_search_speed_ms: 9.61958689306182
2025-03-13 15:59:34,293 [INFO]: 	99p_search_speed_ms: 12.716462940443305
2025-03-13 15:59:34,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:34,293 [INFO]: 	nb vectors: 1904
2025-03-13 15:59:34,293 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:34,293 [INFO]: 	compression ratio: 0.9993083889243028
2025-03-13 15:59:34,293 [INFO]: }
2025-03-13 15:59:34,294 [INFO]: 	>>> Finished "Creating the index" in 52.9568 secs
2025-03-13 15:59:34,294 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9824 secs
2025-03-13 15:59:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 100074 [episode count 15/20]
[retrieval_preprocessing] for episode 100075 [episode count 16/20], we have num_retrieval=np.int64(1905) num_query=np.int64(68)
2025-03-13 15:59:35,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:36,018 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:36
2025-03-13 15:59:36,018 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1667.05it/s]
2025-03-13 15:59:36,043 [INFO]: There are 1905 embeddings of dim 49152
2025-03-13 15:59:36,043 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 15:59:36,043 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:36
2025-03-13 15:59:36,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:36,043 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:59:36,043 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:36,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:36,043 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:36
2025-03-13 15:59:36,043 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:36,043 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:59:36,043 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:36
2025-03-13 15:59:36,043 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:36,043 [INFO]: 	Creating the index 03/13/2025, 15:59:36
2025-03-13 15:59:36,043 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:36
2025-03-13 15:59:36,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:59:36,045 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:36
2025-03-13 15:59:36,045 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:59:36,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.84it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.45it/s] 50%|█████     | 4/8 [00:00<00:00,  8.93it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.79it/s]100%|██████████| 8/8 [00:02<00:00,  2.52it/s]100%|██████████| 8/8 [00:02<00:00,  3.41it/s]
2025-03-13 15:59:38,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:38
2025-03-13 16:00:03,630 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2329 secs
2025-03-13 16:00:03,630 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:00:03,630 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 16:00:21,638 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0077 secs
2025-03-13 16:00:21,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5950 secs
2025-03-13 16:00:21,640 [INFO]: {
2025-03-13 16:00:21,640 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:21,640 [INFO]: 	index_param: efSearch=193
2025-03-13 16:00:21,640 [INFO]: 	index_path: knn.index
2025-03-13 16:00:21,640 [INFO]: 	size in bytes: 374797450
2025-03-13 16:00:21,640 [INFO]: 	avg_search_speed_ms: 9.954602483993591
2025-03-13 16:00:21,640 [INFO]: 	99p_search_speed_ms: 18.314573550596837
2025-03-13 16:00:21,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:21,641 [INFO]: 	nb vectors: 1905
2025-03-13 16:00:21,641 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:21,641 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 16:00:21,641 [INFO]: }
2025-03-13 16:00:21,641 [INFO]: 	>>> Finished "Creating the index" in 45.5972 secs
2025-03-13 16:00:21,641 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6222 secs
2025-03-13 16:00:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 100075 [episode count 16/20]
[retrieval_preprocessing] for episode 100076 [episode count 17/20], we have num_retrieval=np.int64(1901) num_query=np.int64(72)
2025-03-13 16:00:23,003 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:23,352 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:23
2025-03-13 16:00:23,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-13 16:00:23,378 [INFO]: There are 1901 embeddings of dim 49152
2025-03-13 16:00:23,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 16:00:23,379 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:23
2025-03-13 16:00:23,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:23,379 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:00:23,379 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:23,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:00:23,379 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:23
2025-03-13 16:00:23,379 [INFO]: 392.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:23,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:00:23,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:23
2025-03-13 16:00:23,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:23,379 [INFO]: 	Creating the index 03/13/2025, 16:00:23
2025-03-13 16:00:23,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:23
2025-03-13 16:00:23,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:00:23,381 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:23
2025-03-13 16:00:23,381 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:00:23,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.70it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.92it/s] 50%|█████     | 4/8 [00:00<00:00,  8.81it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.16it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.23it/s]100%|██████████| 8/8 [00:02<00:00,  2.36it/s]100%|██████████| 8/8 [00:02<00:00,  3.75it/s]
2025-03-13 16:00:25,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:25
2025-03-13 16:00:49,331 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8149 secs
2025-03-13 16:00:49,331 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:00:49,331 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-13 16:01:11,067 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7362 secs
2025-03-13 16:01:11,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6887 secs
2025-03-13 16:01:11,069 [INFO]: {
2025-03-13 16:01:11,069 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:11,069 [INFO]: 	index_param: efSearch=242
2025-03-13 16:01:11,069 [INFO]: 	index_path: knn.index
2025-03-13 16:01:11,069 [INFO]: 	size in bytes: 374010430
2025-03-13 16:01:11,070 [INFO]: 	avg_search_speed_ms: 11.209258688310989
2025-03-13 16:01:11,070 [INFO]: 	99p_search_speed_ms: 16.42471643164754
2025-03-13 16:01:11,070 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:11,070 [INFO]: 	nb vectors: 1901
2025-03-13 16:01:11,070 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:11,070 [INFO]: 	compression ratio: 0.9993085166100849
2025-03-13 16:01:11,070 [INFO]: }
2025-03-13 16:01:11,070 [INFO]: 	>>> Finished "Creating the index" in 47.6902 secs
2025-03-13 16:01:11,070 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7176 secs
2025-03-13 16:01:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 100076 [episode count 17/20]
[retrieval_preprocessing] for episode 100077 [episode count 18/20], we have num_retrieval=np.int64(1894) num_query=np.int64(79)
2025-03-13 16:01:12,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:13,332 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:13
2025-03-13 16:01:13,332 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.15it/s]
2025-03-13 16:01:13,381 [INFO]: There are 1894 embeddings of dim 49152
2025-03-13 16:01:13,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0490 secs
2025-03-13 16:01:13,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:13
2025-03-13 16:01:13,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:13,382 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:01:13,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:13,382 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:01:13,382 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:13
2025-03-13 16:01:13,382 [INFO]: 390.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:13,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:01:13,383 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:13
2025-03-13 16:01:13,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:13,383 [INFO]: 	Creating the index 03/13/2025, 16:01:13
2025-03-13 16:01:13,383 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:13
2025-03-13 16:01:13,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:01:13,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:13
2025-03-13 16:01:13,385 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:01:13,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.57it/s]100%|██████████| 8/8 [00:01<00:00,  5.66it/s]100%|██████████| 8/8 [00:01<00:00,  5.97it/s]
2025-03-13 16:01:14,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:14
2025-03-13 16:01:51,840 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1105 secs
2025-03-13 16:01:51,840 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 16:01:51,840 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 16:02:10,928 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0881 secs
2025-03-13 16:02:10,931 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5459 secs
2025-03-13 16:02:10,931 [INFO]: {
2025-03-13 16:02:10,931 [INFO]: 	index_key: HNSW15
2025-03-13 16:02:10,931 [INFO]: 	index_param: efSearch=139
2025-03-13 16:02:10,931 [INFO]: 	index_path: knn.index
2025-03-13 16:02:10,931 [INFO]: 	size in bytes: 372633190
2025-03-13 16:02:10,931 [INFO]: 	avg_search_speed_ms: 12.103174862984035
2025-03-13 16:02:10,931 [INFO]: 	99p_search_speed_ms: 25.79035225789994
2025-03-13 16:02:10,931 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:02:10,931 [INFO]: 	nb vectors: 1894
2025-03-13 16:02:10,931 [INFO]: 	vectors dimension: 49152
2025-03-13 16:02:10,931 [INFO]: 	compression ratio: 0.9993086015767946
2025-03-13 16:02:10,931 [INFO]: }
2025-03-13 16:02:10,931 [INFO]: 	>>> Finished "Creating the index" in 57.5486 secs
2025-03-13 16:02:10,932 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5992 secs
2025-03-13 16:02:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 100077 [episode count 18/20]
[retrieval_preprocessing] for episode 100078 [episode count 19/20], we have num_retrieval=np.int64(1874) num_query=np.int64(99)
2025-03-13 16:02:13,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:13,547 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:13
2025-03-13 16:02:13,548 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.69it/s]
2025-03-13 16:02:13,588 [INFO]: There are 1874 embeddings of dim 49152
2025-03-13 16:02:13,588 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 16:02:13,589 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:13,589 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:02:13,589 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:13,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:02:13,589 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,589 [INFO]: 386.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:13,589 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:02:13,589 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:13
2025-03-13 16:02:13,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:13,590 [INFO]: 	Creating the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,590 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:13
2025-03-13 16:02:13,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 16:02:13,591 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,591 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:02:13,591 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.82it/s] 75%|███████▌  | 6/8 [00:00<00:00, 31.22it/s]100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
2025-03-13 16:02:15,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:15
2025-03-13 16:02:45,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8611 secs
2025-03-13 16:02:45,196 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 16:02:45,196 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.44it/s]
2025-03-13 16:03:05,227 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0309 secs
2025-03-13 16:03:05,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6377 secs
2025-03-13 16:03:05,229 [INFO]: {
2025-03-13 16:03:05,229 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:05,229 [INFO]: 	index_param: efSearch=173
2025-03-13 16:03:05,229 [INFO]: 	index_path: knn.index
2025-03-13 16:03:05,229 [INFO]: 	size in bytes: 368698210
2025-03-13 16:03:05,229 [INFO]: 	avg_search_speed_ms: 9.152671485399694
2025-03-13 16:03:05,229 [INFO]: 	99p_search_speed_ms: 14.052299978211515
2025-03-13 16:03:05,229 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:05,229 [INFO]: 	nb vectors: 1874
2025-03-13 16:03:05,229 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:05,229 [INFO]: 	compression ratio: 0.9993088710682919
2025-03-13 16:03:05,229 [INFO]: }
2025-03-13 16:03:05,229 [INFO]: 	>>> Finished "Creating the index" in 51.6398 secs
2025-03-13 16:03:05,229 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6818 secs
2025-03-13 16:03:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 100078 [episode count 19/20]
2025-03-13 16:03:06: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_the_jug_to_the_left [chosen_id count 3/8]
2025-03-13 16:03:07: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_the_strawberry_forwards [chosen_id count 4/8]
2025-03-13 16:03:07: [retrieval_preprocessing] we have num_total=1952 embedding_dim=49152
[retrieval_preprocessing] for episode 100079 [episode count 0/20], we have num_retrieval=np.int64(1847) num_query=np.int64(105)
2025-03-13 16:03:08,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:08,453 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:08
2025-03-13 16:03:08,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-13 16:03:08,490 [INFO]: There are 1847 embeddings of dim 49152
2025-03-13 16:03:08,490 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 16:03:08,490 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:08,490 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:03:08,490 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:08,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:08,490 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,490 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:08,491 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:03:08,491 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:08
2025-03-13 16:03:08,491 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:08,491 [INFO]: 	Creating the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,491 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:08
2025-03-13 16:03:08,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:03:08,492 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,492 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:03:08,492 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.09it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.95it/s]100%|██████████| 8/8 [00:01<00:00,  4.88it/s]
2025-03-13 16:03:10,134 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:10
2025-03-13 16:03:43,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0265 secs
2025-03-13 16:03:43,161 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 16:03:43,161 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-13 16:04:13,468 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3065 secs
2025-03-13 16:04:13,470 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9776 secs
2025-03-13 16:04:13,470 [INFO]: {
2025-03-13 16:04:13,470 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:13,470 [INFO]: 	index_param: efSearch=228
2025-03-13 16:04:13,470 [INFO]: 	index_path: knn.index
2025-03-13 16:04:13,470 [INFO]: 	size in bytes: 363385990
2025-03-13 16:04:13,470 [INFO]: 	avg_search_speed_ms: 10.02133246170607
2025-03-13 16:04:13,470 [INFO]: 	99p_search_speed_ms: 13.664831176865842
2025-03-13 16:04:13,470 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:13,470 [INFO]: 	nb vectors: 1847
2025-03-13 16:04:13,470 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:13,470 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-13 16:04:13,470 [INFO]: }
2025-03-13 16:04:13,470 [INFO]: 	>>> Finished "Creating the index" in 64.9795 secs
2025-03-13 16:04:13,470 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0168 secs
2025-03-13 16:04:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100079 [episode count 0/20]
[retrieval_preprocessing] for episode 100080 [episode count 1/20], we have num_retrieval=np.int64(1834) num_query=np.int64(118)
2025-03-13 16:04:14,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:15,868 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:15
2025-03-13 16:04:15,868 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-13 16:04:15,901 [INFO]: There are 1834 embeddings of dim 49152
2025-03-13 16:04:15,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 16:04:15,902 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:15
2025-03-13 16:04:15,902 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:15,902 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:04:15,902 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:15,902 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:04:15,902 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:15
2025-03-13 16:04:15,902 [INFO]: 378.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:15,902 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:04:15,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:15
2025-03-13 16:04:15,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:15,902 [INFO]: 	Creating the index 03/13/2025, 16:04:15
2025-03-13 16:04:15,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:15
2025-03-13 16:04:15,903 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:04:15,903 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:15
2025-03-13 16:04:15,903 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:04:15,903 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.89it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.84it/s]100%|██████████| 8/8 [00:01<00:00,  5.43it/s]
2025-03-13 16:04:17,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:17
2025-03-13 16:04:53,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3549 secs
2025-03-13 16:04:53,735 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 16:04:53,735 [INFO]: 	Compute fast metrics 03/13/2025, 16:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 16:05:08,680 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9441 secs
2025-03-13 16:05:08,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7784 secs
2025-03-13 16:05:08,682 [INFO]: {
2025-03-13 16:05:08,682 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:08,682 [INFO]: 	index_param: efSearch=196
2025-03-13 16:05:08,682 [INFO]: 	index_path: knn.index
2025-03-13 16:05:08,682 [INFO]: 	size in bytes: 360828370
2025-03-13 16:05:08,682 [INFO]: 	avg_search_speed_ms: 9.865211142884673
2025-03-13 16:05:08,682 [INFO]: 	99p_search_speed_ms: 16.47750125033781
2025-03-13 16:05:08,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:08,682 [INFO]: 	nb vectors: 1834
2025-03-13 16:05:08,682 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:08,682 [INFO]: 	compression ratio: 0.9993090953463554
2025-03-13 16:05:08,682 [INFO]: }
2025-03-13 16:05:08,682 [INFO]: 	>>> Finished "Creating the index" in 52.7800 secs
2025-03-13 16:05:08,682 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8143 secs
2025-03-13 16:05:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 100080 [episode count 1/20]
[retrieval_preprocessing] for episode 100081 [episode count 2/20], we have num_retrieval=np.int64(1852) num_query=np.int64(100)
2025-03-13 16:05:10,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:10,304 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:10
2025-03-13 16:05:10,304 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.83it/s]
2025-03-13 16:05:10,339 [INFO]: There are 1852 embeddings of dim 49152
2025-03-13 16:05:10,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 16:05:10,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:10
2025-03-13 16:05:10,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:10,339 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:05:10,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:10,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:05:10,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:10
2025-03-13 16:05:10,339 [INFO]: 382.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:10,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:05:10,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:10
2025-03-13 16:05:10,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:10,339 [INFO]: 	Creating the index 03/13/2025, 16:05:10
2025-03-13 16:05:10,339 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:10
2025-03-13 16:05:10,340 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:05:10,340 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:10
2025-03-13 16:05:10,340 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:05:10,340 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.97it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.14it/s]100%|██████████| 8/8 [00:01<00:00,  4.76it/s]
2025-03-13 16:05:12,023 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:12
2025-03-13 16:05:39,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5843 secs
2025-03-13 16:05:39,608 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 16:05:39,608 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 16:05:58,186 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5779 secs
2025-03-13 16:05:58,188 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8478 secs
2025-03-13 16:05:58,188 [INFO]: {
2025-03-13 16:05:58,188 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:58,188 [INFO]: 	index_param: efSearch=224
2025-03-13 16:05:58,188 [INFO]: 	index_path: knn.index
2025-03-13 16:05:58,188 [INFO]: 	size in bytes: 364369690
2025-03-13 16:05:58,188 [INFO]: 	avg_search_speed_ms: 9.811600126185335
2025-03-13 16:05:58,188 [INFO]: 	99p_search_speed_ms: 13.810635884292424
2025-03-13 16:05:58,188 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:58,188 [INFO]: 	nb vectors: 1852
2025-03-13 16:05:58,188 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:58,188 [INFO]: 	compression ratio: 0.9993092894197648
2025-03-13 16:05:58,189 [INFO]: }
2025-03-13 16:05:58,189 [INFO]: 	>>> Finished "Creating the index" in 47.8493 secs
2025-03-13 16:05:58,189 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8847 secs
2025-03-13 16:05:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100081 [episode count 2/20]
[retrieval_preprocessing] for episode 100082 [episode count 3/20], we have num_retrieval=np.int64(1860) num_query=np.int64(92)
2025-03-13 16:05:59,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:59,402 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:59
2025-03-13 16:05:59,402 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.31it/s]
2025-03-13 16:05:59,435 [INFO]: There are 1860 embeddings of dim 49152
2025-03-13 16:05:59,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 16:05:59,435 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:59
2025-03-13 16:05:59,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:59,436 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:05:59,436 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:59,436 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:05:59,436 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:59
2025-03-13 16:05:59,436 [INFO]: 383.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:59,436 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:05:59,436 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:59
2025-03-13 16:05:59,436 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:59,436 [INFO]: 	Creating the index 03/13/2025, 16:05:59
2025-03-13 16:05:59,436 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:59
2025-03-13 16:05:59,437 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:05:59,437 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:59
2025-03-13 16:05:59,437 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:05:59,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.18it/s] 75%|███████▌  | 6/8 [00:00<00:00, 27.48it/s]100%|██████████| 8/8 [00:01<00:00,  4.87it/s]
2025-03-13 16:06:01,081 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:01
2025-03-13 16:06:26,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0727 secs
2025-03-13 16:06:26,154 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:06:26,154 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.81it/s]
2025-03-13 16:06:52,982 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8276 secs
2025-03-13 16:06:52,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5466 secs
2025-03-13 16:06:52,984 [INFO]: {
2025-03-13 16:06:52,984 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:52,984 [INFO]: 	index_param: efSearch=220
2025-03-13 16:06:52,984 [INFO]: 	index_path: knn.index
2025-03-13 16:06:52,984 [INFO]: 	size in bytes: 365943790
2025-03-13 16:06:52,984 [INFO]: 	avg_search_speed_ms: 10.196095683291995
2025-03-13 16:06:52,984 [INFO]: 	99p_search_speed_ms: 16.859201807528763
2025-03-13 16:06:52,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:52,984 [INFO]: 	nb vectors: 1860
2025-03-13 16:06:52,984 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:52,984 [INFO]: 	compression ratio: 0.9993088829298074
2025-03-13 16:06:52,984 [INFO]: }
2025-03-13 16:06:52,984 [INFO]: 	>>> Finished "Creating the index" in 53.5479 secs
2025-03-13 16:06:52,984 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5821 secs
2025-03-13 16:06:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 100082 [episode count 3/20]
[retrieval_preprocessing] for episode 100083 [episode count 4/20], we have num_retrieval=np.int64(1881) num_query=np.int64(71)
2025-03-13 16:06:53,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:54,202 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:54
2025-03-13 16:06:54,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1690.57it/s]
2025-03-13 16:06:54,236 [INFO]: There are 1881 embeddings of dim 49152
2025-03-13 16:06:54,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 16:06:54,237 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:54
2025-03-13 16:06:54,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:54,237 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:06:54,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:54,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:06:54,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:54
2025-03-13 16:06:54,238 [INFO]: 388.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:54,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:06:54,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:54
2025-03-13 16:06:54,239 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:54,239 [INFO]: 	Creating the index 03/13/2025, 16:06:54
2025-03-13 16:06:54,239 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:54
2025-03-13 16:06:54,242 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:06:54,243 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:54
2025-03-13 16:06:54,243 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:06:54,243 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.79it/s] 88%|████████▊ | 7/8 [00:00<00:00, 36.12it/s]100%|██████████| 8/8 [00:01<00:00,  5.30it/s]
2025-03-13 16:06:55,758 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:55
2025-03-13 16:07:25,480 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7216 secs
2025-03-13 16:07:25,481 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:07:25,481 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 16:07:43,784 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3033 secs
2025-03-13 16:07:44,314 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0710 secs
2025-03-13 16:07:44,314 [INFO]: {
2025-03-13 16:07:44,314 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:44,315 [INFO]: 	index_param: efSearch=207
2025-03-13 16:07:44,315 [INFO]: 	index_path: knn.index
2025-03-13 16:07:44,315 [INFO]: 	size in bytes: 370075510
2025-03-13 16:07:44,315 [INFO]: 	avg_search_speed_ms: 11.700611295483528
2025-03-13 16:07:44,315 [INFO]: 	99p_search_speed_ms: 19.328321679495275
2025-03-13 16:07:44,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:44,315 [INFO]: 	nb vectors: 1881
2025-03-13 16:07:44,315 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:44,315 [INFO]: 	compression ratio: 0.9993086221782144
2025-03-13 16:07:44,315 [INFO]: }
2025-03-13 16:07:44,315 [INFO]: 	>>> Finished "Creating the index" in 50.0761 secs
2025-03-13 16:07:44,315 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1130 secs
2025-03-13 16:07:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 100083 [episode count 4/20]
[retrieval_preprocessing] for episode 100084 [episode count 5/20], we have num_retrieval=np.int64(1873) num_query=np.int64(79)
2025-03-13 16:07:45,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:45,605 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:45
2025-03-13 16:07:45,605 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2273.34it/s]
2025-03-13 16:07:45,632 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 16:07:45,632 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 16:07:45,632 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:45
2025-03-13 16:07:45,632 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:45,632 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:07:45,632 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:45,632 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:45,632 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:45
2025-03-13 16:07:45,633 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:45,633 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:07:45,633 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:45
2025-03-13 16:07:45,633 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:45,633 [INFO]: 	Creating the index 03/13/2025, 16:07:45
2025-03-13 16:07:45,633 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:45
2025-03-13 16:07:45,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 16:07:45,634 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:45
2025-03-13 16:07:45,634 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:07:45,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.15it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.94it/s]100%|██████████| 8/8 [00:01<00:00,  4.41it/s]
2025-03-13 16:07:47,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:47
2025-03-13 16:08:14,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6605 secs
2025-03-13 16:08:14,112 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:08:14,112 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.34it/s]
2025-03-13 16:08:28,826 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7134 secs
2025-03-13 16:08:28,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1935 secs
2025-03-13 16:08:28,827 [INFO]: {
2025-03-13 16:08:28,827 [INFO]: 	index_key: HNSW15
2025-03-13 16:08:28,827 [INFO]: 	index_param: efSearch=169
2025-03-13 16:08:28,827 [INFO]: 	index_path: knn.index
2025-03-13 16:08:28,827 [INFO]: 	size in bytes: 368501470
2025-03-13 16:08:28,827 [INFO]: 	avg_search_speed_ms: 9.36738402370803
2025-03-13 16:08:28,827 [INFO]: 	99p_search_speed_ms: 12.313211401924486
2025-03-13 16:08:28,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:28,827 [INFO]: 	nb vectors: 1873
2025-03-13 16:08:28,828 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:28,828 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 16:08:28,828 [INFO]: }
2025-03-13 16:08:28,828 [INFO]: 	>>> Finished "Creating the index" in 43.1949 secs
2025-03-13 16:08:28,828 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2227 secs
2025-03-13 16:08:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 100084 [episode count 5/20]
[retrieval_preprocessing] for episode 100085 [episode count 6/20], we have num_retrieval=np.int64(1859) num_query=np.int64(93)
2025-03-13 16:08:29,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:30,363 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:30
2025-03-13 16:08:30,364 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1993.49it/s]
2025-03-13 16:08:30,394 [INFO]: There are 1859 embeddings of dim 49152
2025-03-13 16:08:30,394 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 16:08:30,394 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:30
2025-03-13 16:08:30,394 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:30,394 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:08:30,394 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:30,394 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:08:30,394 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:30
2025-03-13 16:08:30,394 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:30,394 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:08:30,394 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:30
2025-03-13 16:08:30,394 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:30,394 [INFO]: 	Creating the index 03/13/2025, 16:08:30
2025-03-13 16:08:30,394 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:30
2025-03-13 16:08:30,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:08:30,395 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:30
2025-03-13 16:08:30,396 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:08:30,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.76it/s] 62%|██████▎   | 5/8 [00:00<00:00, 26.08it/s]100%|██████████| 8/8 [00:01<00:00,  3.49it/s]100%|██████████| 8/8 [00:01<00:00,  4.23it/s]
2025-03-13 16:08:32,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:32
2025-03-13 16:08:59,701 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4116 secs
2025-03-13 16:08:59,701 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 16:08:59,701 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.85it/s]
2025-03-13 16:09:28,603 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9018 secs
2025-03-13 16:09:28,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2091 secs
2025-03-13 16:09:28,605 [INFO]: {
2025-03-13 16:09:28,605 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:28,605 [INFO]: 	index_param: efSearch=223
2025-03-13 16:09:28,605 [INFO]: 	index_path: knn.index
2025-03-13 16:09:28,605 [INFO]: 	size in bytes: 365746990
2025-03-13 16:09:28,605 [INFO]: 	avg_search_speed_ms: 8.796842159578869
2025-03-13 16:09:28,605 [INFO]: 	99p_search_speed_ms: 12.529508778825408
2025-03-13 16:09:28,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:28,605 [INFO]: 	nb vectors: 1859
2025-03-13 16:09:28,605 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:28,605 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-13 16:09:28,605 [INFO]: }
2025-03-13 16:09:28,605 [INFO]: 	>>> Finished "Creating the index" in 58.2107 secs
2025-03-13 16:09:28,605 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2414 secs
2025-03-13 16:09:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 100085 [episode count 6/20]
[retrieval_preprocessing] for episode 100086 [episode count 7/20], we have num_retrieval=np.int64(1880) num_query=np.int64(72)
2025-03-13 16:09:29,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:29,737 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:29
2025-03-13 16:09:29,737 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.91it/s]
2025-03-13 16:09:29,771 [INFO]: There are 1880 embeddings of dim 49152
2025-03-13 16:09:29,772 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 16:09:29,772 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:29
2025-03-13 16:09:29,772 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:29,772 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:09:29,772 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:29,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:09:29,772 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:29
2025-03-13 16:09:29,772 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:29,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:09:29,772 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:29
2025-03-13 16:09:29,772 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:29,772 [INFO]: 	Creating the index 03/13/2025, 16:09:29
2025-03-13 16:09:29,772 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:29
2025-03-13 16:09:29,773 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:09:29,773 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:29
2025-03-13 16:09:29,773 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:09:29,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.06it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.37it/s]100%|██████████| 8/8 [00:01<00:00,  5.10it/s]
2025-03-13 16:09:31,347 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:31
2025-03-13 16:09:51,594 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2471 secs
2025-03-13 16:09:51,594 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 16:09:51,594 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.22it/s]
2025-03-13 16:10:19,464 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8694 secs
2025-03-13 16:10:19,466 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6923 secs
2025-03-13 16:10:19,466 [INFO]: {
2025-03-13 16:10:19,466 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:19,466 [INFO]: 	index_param: efSearch=274
2025-03-13 16:10:19,466 [INFO]: 	index_path: knn.index
2025-03-13 16:10:19,466 [INFO]: 	size in bytes: 369878770
2025-03-13 16:10:19,466 [INFO]: 	avg_search_speed_ms: 14.288135282030064
2025-03-13 16:10:19,466 [INFO]: 	99p_search_speed_ms: 23.399273271206763
2025-03-13 16:10:19,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:19,466 [INFO]: 	nb vectors: 1880
2025-03-13 16:10:19,466 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:19,466 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-13 16:10:19,466 [INFO]: }
2025-03-13 16:10:19,466 [INFO]: 	>>> Finished "Creating the index" in 49.6939 secs
2025-03-13 16:10:19,466 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7294 secs
2025-03-13 16:10:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 100086 [episode count 7/20]
[retrieval_preprocessing] for episode 100087 [episode count 8/20], we have num_retrieval=np.int64(1873) num_query=np.int64(79)
2025-03-13 16:10:21,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:21,534 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:21
2025-03-13 16:10:21,534 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-13 16:10:21,565 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 16:10:21,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 16:10:21,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:21
2025-03-13 16:10:21,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:21,565 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:10:21,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:21,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:21,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:21
2025-03-13 16:10:21,565 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:21,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:10:21,565 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:21
2025-03-13 16:10:21,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:21,566 [INFO]: 	Creating the index 03/13/2025, 16:10:21
2025-03-13 16:10:21,566 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:21
2025-03-13 16:10:21,567 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:10:21,567 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:21
2025-03-13 16:10:21,567 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:10:21,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.93it/s] 62%|██████▎   | 5/8 [00:00<00:00, 20.26it/s]100%|██████████| 8/8 [00:02<00:00,  2.58it/s]100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
2025-03-13 16:10:24,121 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:24
2025-03-13 16:10:58,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0848 secs
2025-03-13 16:10:58,207 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 16:10:58,207 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-13 16:11:18,657 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4498 secs
2025-03-13 16:11:18,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0922 secs
2025-03-13 16:11:18,660 [INFO]: {
2025-03-13 16:11:18,660 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:18,660 [INFO]: 	index_param: efSearch=175
2025-03-13 16:11:18,660 [INFO]: 	index_path: knn.index
2025-03-13 16:11:18,660 [INFO]: 	size in bytes: 368501470
2025-03-13 16:11:18,660 [INFO]: 	avg_search_speed_ms: 9.557899032072756
2025-03-13 16:11:18,660 [INFO]: 	99p_search_speed_ms: 17.480923528783016
2025-03-13 16:11:18,660 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:18,660 [INFO]: 	nb vectors: 1873
2025-03-13 16:11:18,660 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:18,660 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 16:11:18,660 [INFO]: }
2025-03-13 16:11:18,660 [INFO]: 	>>> Finished "Creating the index" in 57.0943 secs
2025-03-13 16:11:18,660 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1258 secs
2025-03-13 16:11:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 100087 [episode count 8/20]
[retrieval_preprocessing] for episode 100088 [episode count 9/20], we have num_retrieval=np.int64(1864) num_query=np.int64(88)
2025-03-13 16:11:20,977 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:21,346 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:21
2025-03-13 16:11:21,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 880.97it/s]
2025-03-13 16:11:21,373 [INFO]: There are 1864 embeddings of dim 49152
2025-03-13 16:11:21,374 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 16:11:21,374 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:21
2025-03-13 16:11:21,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:21,374 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:11:21,374 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:21,374 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:11:21,374 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:21
2025-03-13 16:11:21,374 [INFO]: 384.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:21,374 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:11:21,374 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:21
2025-03-13 16:11:21,374 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:21,374 [INFO]: 	Creating the index 03/13/2025, 16:11:21
2025-03-13 16:11:21,374 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:21
2025-03-13 16:11:21,375 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:11:21,376 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:21
2025-03-13 16:11:21,376 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:11:21,376 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.85it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.77it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.59it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.08it/s]100%|██████████| 8/8 [00:02<00:00,  3.31it/s]
2025-03-13 16:11:23,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:23
2025-03-13 16:11:49,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3058 secs
2025-03-13 16:11:49,107 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 16:11:49,107 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 16:12:13,028 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9203 secs
2025-03-13 16:12:13,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6536 secs
2025-03-13 16:12:13,029 [INFO]: {
2025-03-13 16:12:13,029 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:13,029 [INFO]: 	index_param: efSearch=182
2025-03-13 16:12:13,029 [INFO]: 	index_path: knn.index
2025-03-13 16:12:13,029 [INFO]: 	size in bytes: 366730750
2025-03-13 16:12:13,029 [INFO]: 	avg_search_speed_ms: 8.55766785437826
2025-03-13 16:12:13,029 [INFO]: 	99p_search_speed_ms: 13.64721713587638
2025-03-13 16:12:13,029 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:13,029 [INFO]: 	nb vectors: 1864
2025-03-13 16:12:13,029 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:13,029 [INFO]: 	compression ratio: 0.999308926235392
2025-03-13 16:12:13,030 [INFO]: }
2025-03-13 16:12:13,030 [INFO]: 	>>> Finished "Creating the index" in 51.6552 secs
2025-03-13 16:12:13,030 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6839 secs
2025-03-13 16:12:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100088 [episode count 9/20]
[retrieval_preprocessing] for episode 100089 [episode count 10/20], we have num_retrieval=np.int64(1868) num_query=np.int64(84)
2025-03-13 16:12:14,425 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:14,802 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:14
2025-03-13 16:12:14,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2229.83it/s]
2025-03-13 16:12:14,827 [INFO]: There are 1868 embeddings of dim 49152
2025-03-13 16:12:14,828 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:12:14,828 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:14
2025-03-13 16:12:14,828 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:14,828 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:12:14,828 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:14,828 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:14,828 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:14
2025-03-13 16:12:14,828 [INFO]: 385.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:14,828 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:14,828 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:14
2025-03-13 16:12:14,828 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:14,828 [INFO]: 	Creating the index 03/13/2025, 16:12:14
2025-03-13 16:12:14,828 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:14
2025-03-13 16:12:14,830 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:12:14,830 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:14
2025-03-13 16:12:14,830 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:12:14,830 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.14it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.35it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.47it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.69it/s]100%|██████████| 8/8 [00:02<00:00,  2.64it/s]100%|██████████| 8/8 [00:02<00:00,  3.95it/s]
2025-03-13 16:12:17,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:17
2025-03-13 16:12:43,636 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1373 secs
2025-03-13 16:12:43,637 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 16:12:43,637 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 16:13:16,297 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6607 secs
2025-03-13 16:13:16,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4701 secs
2025-03-13 16:13:16,301 [INFO]: {
2025-03-13 16:13:16,301 [INFO]: 	index_key: HNSW15
2025-03-13 16:13:16,301 [INFO]: 	index_param: efSearch=260
2025-03-13 16:13:16,301 [INFO]: 	index_path: knn.index
2025-03-13 16:13:16,301 [INFO]: 	size in bytes: 367517710
2025-03-13 16:13:16,301 [INFO]: 	avg_search_speed_ms: 10.306641097390596
2025-03-13 16:13:16,301 [INFO]: 	99p_search_speed_ms: 14.446969190612432
2025-03-13 16:13:16,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:13:16,301 [INFO]: 	nb vectors: 1868
2025-03-13 16:13:16,301 [INFO]: 	vectors dimension: 49152
2025-03-13 16:13:16,301 [INFO]: 	compression ratio: 0.9993089693555176
2025-03-13 16:13:16,301 [INFO]: }
2025-03-13 16:13:16,301 [INFO]: 	>>> Finished "Creating the index" in 61.4727 secs
2025-03-13 16:13:16,301 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4990 secs
2025-03-13 16:13:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:13:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 100089 [episode count 10/20]
[retrieval_preprocessing] for episode 100090 [episode count 11/20], we have num_retrieval=np.int64(1839) num_query=np.int64(113)
2025-03-13 16:13:17,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:13:18,331 [INFO]: Launching the whole pipeline 03/13/2025, 16:13:18
2025-03-13 16:13:18,332 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:13:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1649.35it/s]
2025-03-13 16:13:18,358 [INFO]: There are 1839 embeddings of dim 49152
2025-03-13 16:13:18,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 16:13:18,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:13:18
2025-03-13 16:13:18,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:13:18,359 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:13:18,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:13:18,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:13:18,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:13:18
2025-03-13 16:13:18,360 [INFO]: 379.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:13:18,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:13:18,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:13:18
2025-03-13 16:13:18,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:13:18,360 [INFO]: 	Creating the index 03/13/2025, 16:13:18
2025-03-13 16:13:18,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:13:18
2025-03-13 16:13:18,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:13:18,363 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:13:18
2025-03-13 16:13:18,364 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:13:18,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:03,  2.31it/s] 25%|██▌       | 2/8 [00:00<00:02,  2.96it/s] 50%|█████     | 4/8 [00:00<00:00,  6.14it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.36it/s]100%|██████████| 8/8 [00:02<00:00,  2.52it/s]100%|██████████| 8/8 [00:02<00:00,  3.10it/s]
2025-03-13 16:13:20,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:13:20
2025-03-13 16:14:00,301 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3477 secs
2025-03-13 16:14:00,301 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 16:14:00,301 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.47it/s] 50%|█████     | 2/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 16:14:26,781 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4801 secs
2025-03-13 16:14:26,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4198 secs
2025-03-13 16:14:26,783 [INFO]: {
2025-03-13 16:14:26,784 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:26,784 [INFO]: 	index_param: efSearch=235
2025-03-13 16:14:26,784 [INFO]: 	index_path: knn.index
2025-03-13 16:14:26,784 [INFO]: 	size in bytes: 361812070
2025-03-13 16:14:26,784 [INFO]: 	avg_search_speed_ms: 9.623313476165704
2025-03-13 16:14:26,784 [INFO]: 	99p_search_speed_ms: 15.777305644005503
2025-03-13 16:14:26,784 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:26,784 [INFO]: 	nb vectors: 1839
2025-03-13 16:14:26,784 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:26,784 [INFO]: 	compression ratio: 0.9993091496367161
2025-03-13 16:14:26,784 [INFO]: }
2025-03-13 16:14:26,784 [INFO]: 	>>> Finished "Creating the index" in 68.4234 secs
2025-03-13 16:14:26,784 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4521 secs
2025-03-13 16:14:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 100090 [episode count 11/20]
[retrieval_preprocessing] for episode 100091 [episode count 12/20], we have num_retrieval=np.int64(1857) num_query=np.int64(95)
2025-03-13 16:14:28,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:28,957 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:28
2025-03-13 16:14:28,957 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.64it/s]
2025-03-13 16:14:28,985 [INFO]: There are 1857 embeddings of dim 49152
2025-03-13 16:14:28,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 16:14:28,985 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:28
2025-03-13 16:14:28,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:28,985 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:14:28,985 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:28,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:14:28,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:28
2025-03-13 16:14:28,985 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:28,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:14:28,985 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:28
2025-03-13 16:14:28,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:28,985 [INFO]: 	Creating the index 03/13/2025, 16:14:28
2025-03-13 16:14:28,986 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:28
2025-03-13 16:14:28,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:14:28,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:28
2025-03-13 16:14:28,987 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:14:28,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.31it/s] 38%|███▊      | 3/8 [00:02<00:04,  1.23it/s] 50%|█████     | 4/8 [00:02<00:02,  1.74it/s] 62%|██████▎   | 5/8 [00:02<00:01,  2.37it/s] 75%|███████▌  | 6/8 [00:02<00:00,  3.11it/s]100%|██████████| 8/8 [00:04<00:00,  1.80it/s]100%|██████████| 8/8 [00:04<00:00,  1.90it/s]
2025-03-13 16:14:33,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:33
2025-03-13 16:14:57,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6217 secs
2025-03-13 16:14:57,824 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 16:14:57,824 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.74it/s]
2025-03-13 16:15:16,132 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3085 secs
2025-03-13 16:15:16,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7557 secs
2025-03-13 16:15:16,743 [INFO]: {
2025-03-13 16:15:16,743 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:16,743 [INFO]: 	index_param: efSearch=158
2025-03-13 16:15:16,743 [INFO]: 	index_path: knn.index
2025-03-13 16:15:16,743 [INFO]: 	size in bytes: 365353510
2025-03-13 16:15:16,743 [INFO]: 	avg_search_speed_ms: 10.243959198171487
2025-03-13 16:15:16,743 [INFO]: 	99p_search_speed_ms: 19.669614790473133
2025-03-13 16:15:16,743 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:16,743 [INFO]: 	nb vectors: 1857
2025-03-13 16:15:16,743 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:16,743 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-13 16:15:16,743 [INFO]: }
2025-03-13 16:15:16,743 [INFO]: 	>>> Finished "Creating the index" in 47.7579 secs
2025-03-13 16:15:16,744 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7863 secs
2025-03-13 16:15:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 100091 [episode count 12/20]
[retrieval_preprocessing] for episode 100092 [episode count 13/20], we have num_retrieval=np.int64(1835) num_query=np.int64(117)
2025-03-13 16:15:18,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:18,475 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:18
2025-03-13 16:15:18,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.79it/s]
2025-03-13 16:15:18,501 [INFO]: There are 1835 embeddings of dim 49152
2025-03-13 16:15:18,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:15:18,501 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:18,501 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:15:18,501 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:18,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:18,501 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,501 [INFO]: 378.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:18,501 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:15:18,501 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:18
2025-03-13 16:15:18,501 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:18,501 [INFO]: 	Creating the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,501 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:18
2025-03-13 16:15:18,502 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:15:18,503 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:18
2025-03-13 16:15:18,503 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:15:18,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.02it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.10it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.93it/s]100%|██████████| 8/8 [00:02<00:00,  3.24it/s]100%|██████████| 8/8 [00:02<00:00,  3.95it/s]
2025-03-13 16:15:20,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:20
2025-03-13 16:15:52,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4365 secs
2025-03-13 16:15:52,967 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 16:15:52,967 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.55s/it] 50%|█████     | 2/4 [00:04<00:04,  2.07s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.49s/it]
2025-03-13 16:16:17,323 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3557 secs
2025-03-13 16:16:17,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8219 secs
2025-03-13 16:16:17,325 [INFO]: {
2025-03-13 16:16:17,325 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:17,325 [INFO]: 	index_param: efSearch=244
2025-03-13 16:16:17,325 [INFO]: 	index_path: knn.index
2025-03-13 16:16:17,325 [INFO]: 	size in bytes: 361025110
2025-03-13 16:16:17,325 [INFO]: 	avg_search_speed_ms: 8.890188060700893
2025-03-13 16:16:17,325 [INFO]: 	99p_search_speed_ms: 14.358427552506324
2025-03-13 16:16:17,325 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:17,325 [INFO]: 	nb vectors: 1835
2025-03-13 16:16:17,325 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:17,325 [INFO]: 	compression ratio: 0.9993091062280959
2025-03-13 16:16:17,325 [INFO]: }
2025-03-13 16:16:17,325 [INFO]: 	>>> Finished "Creating the index" in 58.8233 secs
2025-03-13 16:16:17,325 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8493 secs
2025-03-13 16:16:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:16:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 100092 [episode count 13/20]
[retrieval_preprocessing] for episode 100093 [episode count 14/20], we have num_retrieval=np.int64(1836) num_query=np.int64(116)
2025-03-13 16:16:20,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:16:20,808 [INFO]: Launching the whole pipeline 03/13/2025, 16:16:20
2025-03-13 16:16:20,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:16:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 929.59it/s]
2025-03-13 16:16:20,838 [INFO]: There are 1836 embeddings of dim 49152
2025-03-13 16:16:20,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 16:16:20,839 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:16:20
2025-03-13 16:16:20,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:16:20,839 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:16:20,839 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:16:20,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:16:20,839 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:16:20
2025-03-13 16:16:20,840 [INFO]: 378.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:16:20,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:16:20,840 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:16:20
2025-03-13 16:16:20,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:16:20,840 [INFO]: 	Creating the index 03/13/2025, 16:16:20
2025-03-13 16:16:20,840 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:16:20
2025-03-13 16:16:20,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:16:20,843 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:16:20
2025-03-13 16:16:20,843 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:16:20,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.42it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.60it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.09it/s] 50%|█████     | 4/8 [00:00<00:00,  7.35it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.25it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.00it/s]100%|██████████| 8/8 [00:02<00:00,  2.02it/s]100%|██████████| 8/8 [00:02<00:00,  3.39it/s]
2025-03-13 16:16:23,210 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:16:23
2025-03-13 16:16:44,795 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.5842 secs
2025-03-13 16:16:44,796 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:16:44,796 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.64it/s]
2025-03-13 16:17:06,893 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0969 secs
2025-03-13 16:17:06,895 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0514 secs
2025-03-13 16:17:06,895 [INFO]: {
2025-03-13 16:17:06,895 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:06,895 [INFO]: 	index_param: efSearch=212
2025-03-13 16:17:06,895 [INFO]: 	index_path: knn.index
2025-03-13 16:17:06,895 [INFO]: 	size in bytes: 361221850
2025-03-13 16:17:06,895 [INFO]: 	avg_search_speed_ms: 10.196580744284859
2025-03-13 16:17:06,895 [INFO]: 	99p_search_speed_ms: 24.17132174596193
2025-03-13 16:17:06,895 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:06,895 [INFO]: 	nb vectors: 1836
2025-03-13 16:17:06,895 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:06,895 [INFO]: 	compression ratio: 0.9993091170979829
2025-03-13 16:17:06,895 [INFO]: }
2025-03-13 16:17:06,895 [INFO]: 	>>> Finished "Creating the index" in 46.0550 secs
2025-03-13 16:17:06,895 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0872 secs
2025-03-13 16:17:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100093 [episode count 14/20]
[retrieval_preprocessing] for episode 100094 [episode count 15/20], we have num_retrieval=np.int64(1849) num_query=np.int64(103)
2025-03-13 16:17:08,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:08,503 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:08
2025-03-13 16:17:08,504 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 970.68it/s]
2025-03-13 16:17:08,547 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 16:17:08,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0441 secs
2025-03-13 16:17:08,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:08
2025-03-13 16:17:08,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:08,548 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:17:08,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:08,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:08,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:08
2025-03-13 16:17:08,548 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:08,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:17:08,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:08
2025-03-13 16:17:08,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:08,548 [INFO]: 	Creating the index 03/13/2025, 16:17:08
2025-03-13 16:17:08,548 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:08
2025-03-13 16:17:08,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:17:08,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:08
2025-03-13 16:17:08,550 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:17:08,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.36it/s] 62%|██████▎   | 5/8 [00:00<00:00, 24.37it/s]100%|██████████| 8/8 [00:02<00:00,  2.86it/s]100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
2025-03-13 16:17:10,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:10
2025-03-13 16:17:41,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0227 secs
2025-03-13 16:17:41,869 [INFO]: The best hyperparameters are: efSearch=87
2025-03-13 16:17:41,869 [INFO]: 	Compute fast metrics 03/13/2025, 16:17:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 16:17:57,121 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2514 secs
2025-03-13 16:17:57,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5736 secs
2025-03-13 16:17:57,124 [INFO]: {
2025-03-13 16:17:57,124 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:57,124 [INFO]: 	index_param: efSearch=87
2025-03-13 16:17:57,124 [INFO]: 	index_path: knn.index
2025-03-13 16:17:57,124 [INFO]: 	size in bytes: 363779470
2025-03-13 16:17:57,124 [INFO]: 	avg_search_speed_ms: 8.326817443865746
2025-03-13 16:17:57,124 [INFO]: 	99p_search_speed_ms: 14.917063992470503
2025-03-13 16:17:57,124 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:57,124 [INFO]: 	nb vectors: 1849
2025-03-13 16:17:57,124 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:57,124 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 16:17:57,124 [INFO]: }
2025-03-13 16:17:57,124 [INFO]: 	>>> Finished "Creating the index" in 48.5754 secs
2025-03-13 16:17:57,124 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6202 secs
2025-03-13 16:17:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100094 [episode count 15/20]
[retrieval_preprocessing] for episode 100095 [episode count 16/20], we have num_retrieval=np.int64(1800) num_query=np.int64(152)
2025-03-13 16:17:59,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:59,624 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:59
2025-03-13 16:17:59,625 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.04it/s]
2025-03-13 16:17:59,652 [INFO]: There are 1800 embeddings of dim 49152
2025-03-13 16:17:59,652 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 16:17:59,652 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:59
2025-03-13 16:17:59,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:59,653 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:17:59,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:59,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:59,653 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:59
2025-03-13 16:17:59,653 [INFO]: 371.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:59,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:17:59,653 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:59
2025-03-13 16:17:59,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:59,653 [INFO]: 	Creating the index 03/13/2025, 16:17:59
2025-03-13 16:17:59,653 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:59
2025-03-13 16:17:59,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:17:59,654 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:59
2025-03-13 16:17:59,654 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:17:59,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.41it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.51it/s] 38%|███▊      | 3/8 [00:00<00:00,  5.90it/s] 50%|█████     | 4/8 [00:00<00:00,  5.85it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.03it/s] 75%|███████▌  | 6/8 [00:01<00:00,  4.11it/s] 88%|████████▊ | 7/8 [00:01<00:00,  4.34it/s]100%|██████████| 8/8 [00:03<00:00,  1.45it/s]100%|██████████| 8/8 [00:03<00:00,  2.55it/s]
2025-03-13 16:18:02,797 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:02
2025-03-13 16:18:26,144 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3460 secs
2025-03-13 16:18:26,144 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 16:18:26,144 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 16:18:44,540 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3959 secs
2025-03-13 16:18:44,567 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9127 secs
2025-03-13 16:18:44,567 [INFO]: {
2025-03-13 16:18:44,567 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:44,567 [INFO]: 	index_param: efSearch=133
2025-03-13 16:18:44,567 [INFO]: 	index_path: knn.index
2025-03-13 16:18:44,567 [INFO]: 	size in bytes: 354139210
2025-03-13 16:18:44,567 [INFO]: 	avg_search_speed_ms: 7.841989494421902
2025-03-13 16:18:44,567 [INFO]: 	99p_search_speed_ms: 15.863115699030457
2025-03-13 16:18:44,567 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:44,567 [INFO]: 	nb vectors: 1800
2025-03-13 16:18:44,567 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:44,567 [INFO]: 	compression ratio: 0.9993087181732856
2025-03-13 16:18:44,567 [INFO]: }
2025-03-13 16:18:44,567 [INFO]: 	>>> Finished "Creating the index" in 44.9144 secs
2025-03-13 16:18:44,567 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9427 secs
2025-03-13 16:18:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 100095 [episode count 16/20]
[retrieval_preprocessing] for episode 100096 [episode count 17/20], we have num_retrieval=np.int64(1849) num_query=np.int64(103)
2025-03-13 16:18:46,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:18:46,760 [INFO]: Launching the whole pipeline 03/13/2025, 16:18:46
2025-03-13 16:18:46,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:18:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.27it/s]
2025-03-13 16:18:46,796 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 16:18:46,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 16:18:46,796 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:18:46
2025-03-13 16:18:46,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:18:46,796 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:18:46,796 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:18:46,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:18:46,796 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:18:46
2025-03-13 16:18:46,796 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:18:46,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:18:46,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:18:46
2025-03-13 16:18:46,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:18:46,796 [INFO]: 	Creating the index 03/13/2025, 16:18:46
2025-03-13 16:18:46,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:18:46
2025-03-13 16:18:46,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:18:46,798 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:18:46
2025-03-13 16:18:46,798 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:18:46,798 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.75it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.23it/s]100%|██████████| 8/8 [00:01<00:00,  4.77it/s]
2025-03-13 16:18:48,477 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:48
2025-03-13 16:19:18,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0941 secs
2025-03-13 16:19:18,572 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 16:19:18,572 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-13 16:19:37,748 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1758 secs
2025-03-13 16:19:37,750 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9525 secs
2025-03-13 16:19:37,750 [INFO]: {
2025-03-13 16:19:37,750 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:37,750 [INFO]: 	index_param: efSearch=97
2025-03-13 16:19:37,750 [INFO]: 	index_path: knn.index
2025-03-13 16:19:37,750 [INFO]: 	size in bytes: 363779470
2025-03-13 16:19:37,750 [INFO]: 	avg_search_speed_ms: 8.3994448852154
2025-03-13 16:19:37,750 [INFO]: 	99p_search_speed_ms: 13.546352216508215
2025-03-13 16:19:37,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:37,750 [INFO]: 	nb vectors: 1849
2025-03-13 16:19:37,751 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:37,751 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 16:19:37,751 [INFO]: }
2025-03-13 16:19:37,751 [INFO]: 	>>> Finished "Creating the index" in 50.9541 secs
2025-03-13 16:19:37,751 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9901 secs
2025-03-13 16:19:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 100096 [episode count 17/20]
[retrieval_preprocessing] for episode 100097 [episode count 18/20], we have num_retrieval=np.int64(1865) num_query=np.int64(87)
2025-03-13 16:19:38,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:39,192 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:39
2025-03-13 16:19:39,192 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.83it/s]
2025-03-13 16:19:39,235 [INFO]: There are 1865 embeddings of dim 49152
2025-03-13 16:19:39,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0437 secs
2025-03-13 16:19:39,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:39,236 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:19:39,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:39,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:19:39,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,237 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:39,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:19:39,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:39
2025-03-13 16:19:39,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:39,238 [INFO]: 	Creating the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:39
2025-03-13 16:19:39,242 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:19:39,242 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:39
2025-03-13 16:19:39,242 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:19:39,243 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 15.98it/s] 75%|███████▌  | 6/8 [00:00<00:00, 24.80it/s]100%|██████████| 8/8 [00:02<00:00,  3.78it/s]
2025-03-13 16:19:41,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:41
2025-03-13 16:20:07,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7345 secs
2025-03-13 16:20:07,100 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:20:07,100 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.58it/s]
2025-03-13 16:20:25,283 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1829 secs
2025-03-13 16:20:25,285 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0424 secs
2025-03-13 16:20:25,285 [INFO]: {
2025-03-13 16:20:25,285 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:25,285 [INFO]: 	index_param: efSearch=220
2025-03-13 16:20:25,285 [INFO]: 	index_path: knn.index
2025-03-13 16:20:25,285 [INFO]: 	size in bytes: 366927490
2025-03-13 16:20:25,285 [INFO]: 	avg_search_speed_ms: 11.043358405807341
2025-03-13 16:20:25,285 [INFO]: 	99p_search_speed_ms: 15.182282810565088
2025-03-13 16:20:25,285 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:25,285 [INFO]: 	nb vectors: 1865
2025-03-13 16:20:25,285 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:25,285 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-13 16:20:25,285 [INFO]: }
2025-03-13 16:20:25,285 [INFO]: 	>>> Finished "Creating the index" in 46.0469 secs
2025-03-13 16:20:25,285 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0933 secs
2025-03-13 16:20:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 100097 [episode count 18/20]
[retrieval_preprocessing] for episode 100098 [episode count 19/20], we have num_retrieval=np.int64(1867) num_query=np.int64(85)
2025-03-13 16:20:28,807 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:29,462 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:29
2025-03-13 16:20:29,462 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1250.17it/s]
2025-03-13 16:20:29,508 [INFO]: There are 1867 embeddings of dim 49152
2025-03-13 16:20:29,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0460 secs
2025-03-13 16:20:29,509 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:29
2025-03-13 16:20:29,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:29,509 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:20:29,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:29,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:20:29,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:29
2025-03-13 16:20:29,510 [INFO]: 385.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:29,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:20:29,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:29
2025-03-13 16:20:29,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:29,511 [INFO]: 	Creating the index 03/13/2025, 16:20:29
2025-03-13 16:20:29,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:29
2025-03-13 16:20:29,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:20:29,514 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:29
2025-03-13 16:20:29,515 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:20:29,515 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.14it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.37it/s] 75%|███████▌  | 6/8 [00:00<00:00, 14.86it/s]100%|██████████| 8/8 [00:03<00:00,  1.91it/s]100%|██████████| 8/8 [00:03<00:00,  2.59it/s]
2025-03-13 16:20:32,616 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:32
2025-03-13 16:21:04,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6385 secs
2025-03-13 16:21:04,255 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:21:04,255 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 16:21:29,673 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4178 secs
2025-03-13 16:21:29,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1599 secs
2025-03-13 16:21:29,675 [INFO]: {
2025-03-13 16:21:29,675 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:29,675 [INFO]: 	index_param: efSearch=216
2025-03-13 16:21:29,675 [INFO]: 	index_path: knn.index
2025-03-13 16:21:29,675 [INFO]: 	size in bytes: 367320970
2025-03-13 16:21:29,675 [INFO]: 	avg_search_speed_ms: 9.987469489958796
2025-03-13 16:21:29,675 [INFO]: 	99p_search_speed_ms: 14.968109084293246
2025-03-13 16:21:29,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:29,675 [INFO]: 	nb vectors: 1867
2025-03-13 16:21:29,675 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:29,675 [INFO]: 	compression ratio: 0.9993089585928078
2025-03-13 16:21:29,675 [INFO]: }
2025-03-13 16:21:29,675 [INFO]: 	>>> Finished "Creating the index" in 60.1635 secs
2025-03-13 16:21:29,675 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2126 secs
2025-03-13 16:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 100098 [episode count 19/20]
2025-03-13 16:21:30: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_the_strawberry_forwards [chosen_id count 4/8]
2025-03-13 16:21:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_watermelon_to_the_right [chosen_id count 5/8]
2025-03-13 16:21:32: [retrieval_preprocessing] we have num_total=1571 embedding_dim=49152
[retrieval_preprocessing] for episode 100099 [episode count 0/20], we have num_retrieval=np.int64(1462) num_query=np.int64(109)
2025-03-13 16:21:32,611 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:32,982 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:32
2025-03-13 16:21:32,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.33it/s]
2025-03-13 16:21:33,019 [INFO]: There are 1462 embeddings of dim 49152
2025-03-13 16:21:33,019 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 16:21:33,019 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:33
2025-03-13 16:21:33,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:33,020 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:21:33,020 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:33,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:21:33,020 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:33
2025-03-13 16:21:33,021 [INFO]: 301.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:33,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:21:33,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:33
2025-03-13 16:21:33,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:33,022 [INFO]: 	Creating the index 03/13/2025, 16:21:33
2025-03-13 16:21:33,022 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:33
2025-03-13 16:21:33,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:21:33,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:33
2025-03-13 16:21:33,025 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:21:33,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  6.58it/s] 67%|██████▋   | 4/6 [00:00<00:00, 17.36it/s]100%|██████████| 6/6 [00:02<00:00,  2.03it/s]100%|██████████| 6/6 [00:02<00:00,  2.53it/s]
2025-03-13 16:21:35,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:35
2025-03-13 16:22:02,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9695 secs
2025-03-13 16:22:02,371 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 16:22:02,371 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.27it/s]
2025-03-13 16:22:18,136 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7646 secs
2025-03-13 16:22:18,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1122 secs
2025-03-13 16:22:18,137 [INFO]: {
2025-03-13 16:22:18,137 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:18,137 [INFO]: 	index_param: efSearch=226
2025-03-13 16:22:18,137 [INFO]: 	index_path: knn.index
2025-03-13 16:22:18,137 [INFO]: 	size in bytes: 287639710
2025-03-13 16:22:18,137 [INFO]: 	avg_search_speed_ms: 9.737398652015244
2025-03-13 16:22:18,137 [INFO]: 	99p_search_speed_ms: 13.290757313370705
2025-03-13 16:22:18,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:18,137 [INFO]: 	nb vectors: 1462
2025-03-13 16:22:18,137 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:18,137 [INFO]: 	compression ratio: 0.9993088089262779
2025-03-13 16:22:18,137 [INFO]: }
2025-03-13 16:22:18,137 [INFO]: 	>>> Finished "Creating the index" in 45.1154 secs
2025-03-13 16:22:18,137 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1549 secs
2025-03-13 16:22:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 100099 [episode count 0/20]
[retrieval_preprocessing] for episode 100100 [episode count 1/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-13 16:22:19,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:22:19,638 [INFO]: Launching the whole pipeline 03/13/2025, 16:22:19
2025-03-13 16:22:19,638 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:22:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2272.10it/s]
2025-03-13 16:22:19,669 [INFO]: There are 1480 embeddings of dim 49152
2025-03-13 16:22:19,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 16:22:19,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:22:19
2025-03-13 16:22:19,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:22:19,670 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:22:19,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:22:19,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:22:19,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:22:19
2025-03-13 16:22:19,671 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:22:19,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:22:19,671 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:22:19
2025-03-13 16:22:19,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:22:19,672 [INFO]: 	Creating the index 03/13/2025, 16:22:19
2025-03-13 16:22:19,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:22:19
2025-03-13 16:22:19,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:22:19,675 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:22:19
2025-03-13 16:22:19,675 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:22:19,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 17.85it/s]100%|██████████| 6/6 [00:01<00:00,  3.14it/s]100%|██████████| 6/6 [00:01<00:00,  3.42it/s]
2025-03-13 16:22:22,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:22
2025-03-13 16:22:46,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3835 secs
2025-03-13 16:22:46,431 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 16:22:46,431 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-13 16:23:12,878 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4467 secs
2025-03-13 16:23:12,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2042 secs
2025-03-13 16:23:12,880 [INFO]: {
2025-03-13 16:23:12,880 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:12,880 [INFO]: 	index_param: efSearch=304
2025-03-13 16:23:12,880 [INFO]: 	index_path: knn.index
2025-03-13 16:23:12,880 [INFO]: 	size in bytes: 291181150
2025-03-13 16:23:12,880 [INFO]: 	avg_search_speed_ms: 14.033549705906909
2025-03-13 16:23:12,880 [INFO]: 	99p_search_speed_ms: 22.439835220575333
2025-03-13 16:23:12,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:12,880 [INFO]: 	nb vectors: 1480
2025-03-13 16:23:12,880 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:12,880 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-13 16:23:12,880 [INFO]: }
2025-03-13 16:23:12,880 [INFO]: 	>>> Finished "Creating the index" in 53.2081 secs
2025-03-13 16:23:12,880 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2416 secs
2025-03-13 16:23:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100100 [episode count 1/20]
[retrieval_preprocessing] for episode 100101 [episode count 2/20], we have num_retrieval=np.int64(1491) num_query=np.int64(80)
2025-03-13 16:23:13,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:14,137 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:14
2025-03-13 16:23:14,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.37it/s]
2025-03-13 16:23:14,169 [INFO]: There are 1491 embeddings of dim 49152
2025-03-13 16:23:14,169 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 16:23:14,169 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:14
2025-03-13 16:23:14,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:14,169 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:23:14,169 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:14,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:14,169 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:14
2025-03-13 16:23:14,169 [INFO]: 307.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:14,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:23:14,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:14
2025-03-13 16:23:14,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:14,169 [INFO]: 	Creating the index 03/13/2025, 16:23:14
2025-03-13 16:23:14,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:14
2025-03-13 16:23:14,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:23:14,171 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:14
2025-03-13 16:23:14,171 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:23:14,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.78it/s]100%|██████████| 6/6 [00:01<00:00,  4.56it/s]100%|██████████| 6/6 [00:01<00:00,  4.93it/s]
2025-03-13 16:23:15,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:15
2025-03-13 16:23:41,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0174 secs
2025-03-13 16:23:41,410 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 16:23:41,410 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.06it/s]
2025-03-13 16:24:01,216 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8064 secs
2025-03-13 16:24:01,218 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0473 secs
2025-03-13 16:24:01,218 [INFO]: {
2025-03-13 16:24:01,218 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:01,218 [INFO]: 	index_param: efSearch=137
2025-03-13 16:24:01,218 [INFO]: 	index_path: knn.index
2025-03-13 16:24:01,218 [INFO]: 	size in bytes: 293345350
2025-03-13 16:24:01,218 [INFO]: 	avg_search_speed_ms: 8.699807642311182
2025-03-13 16:24:01,218 [INFO]: 	99p_search_speed_ms: 14.057076482567936
2025-03-13 16:24:01,218 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:01,218 [INFO]: 	nb vectors: 1491
2025-03-13 16:24:01,218 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:01,218 [INFO]: 	compression ratio: 0.9993085896878884
2025-03-13 16:24:01,218 [INFO]: }
2025-03-13 16:24:01,218 [INFO]: 	>>> Finished "Creating the index" in 47.0490 secs
2025-03-13 16:24:01,218 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0812 secs
2025-03-13 16:24:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 100101 [episode count 2/20]
[retrieval_preprocessing] for episode 100102 [episode count 3/20], we have num_retrieval=np.int64(1487) num_query=np.int64(84)
2025-03-13 16:24:01,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:02,113 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:02
2025-03-13 16:24:02,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.35it/s]
2025-03-13 16:24:02,143 [INFO]: There are 1487 embeddings of dim 49152
2025-03-13 16:24:02,143 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 16:24:02,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:02
2025-03-13 16:24:02,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:02,144 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:24:02,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:02,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:02,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:02
2025-03-13 16:24:02,144 [INFO]: 306.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:02,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:24:02,144 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:02
2025-03-13 16:24:02,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:02,144 [INFO]: 	Creating the index 03/13/2025, 16:24:02
2025-03-13 16:24:02,144 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:02
2025-03-13 16:24:02,145 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:24:02,145 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:02
2025-03-13 16:24:02,145 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:24:02,145 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  8.10it/s]100%|██████████| 6/6 [00:01<00:00,  4.15it/s]100%|██████████| 6/6 [00:01<00:00,  4.25it/s]
2025-03-13 16:24:03,559 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:03
2025-03-13 16:24:29,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7232 secs
2025-03-13 16:24:29,283 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 16:24:29,283 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 16:24:44,170 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8870 secs
2025-03-13 16:24:44,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4903 secs
2025-03-13 16:24:44,636 [INFO]: {
2025-03-13 16:24:44,636 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:44,636 [INFO]: 	index_param: efSearch=161
2025-03-13 16:24:44,636 [INFO]: 	index_path: knn.index
2025-03-13 16:24:44,636 [INFO]: 	size in bytes: 292558390
2025-03-13 16:24:44,636 [INFO]: 	avg_search_speed_ms: 11.082684027006284
2025-03-13 16:24:44,636 [INFO]: 	99p_search_speed_ms: 17.43051396450028
2025-03-13 16:24:44,636 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:44,636 [INFO]: 	nb vectors: 1487
2025-03-13 16:24:44,636 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:44,636 [INFO]: 	compression ratio: 0.9993085346142355
2025-03-13 16:24:44,636 [INFO]: }
2025-03-13 16:24:44,636 [INFO]: 	>>> Finished "Creating the index" in 42.4925 secs
2025-03-13 16:24:44,637 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5237 secs
2025-03-13 16:24:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 100102 [episode count 3/20]
[retrieval_preprocessing] for episode 100103 [episode count 4/20], we have num_retrieval=np.int64(1502) num_query=np.int64(69)
2025-03-13 16:24:45,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:46,088 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:46
2025-03-13 16:24:46,088 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.08it/s]
2025-03-13 16:24:46,123 [INFO]: There are 1502 embeddings of dim 49152
2025-03-13 16:24:46,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 16:24:46,124 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:46
2025-03-13 16:24:46,124 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:46,124 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:24:46,124 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:46,124 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:24:46,124 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:46
2025-03-13 16:24:46,124 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:46,125 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:24:46,125 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:46
2025-03-13 16:24:46,125 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:46,125 [INFO]: 	Creating the index 03/13/2025, 16:24:46
2025-03-13 16:24:46,125 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:46
2025-03-13 16:24:46,127 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 16:24:46,127 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:46
2025-03-13 16:24:46,128 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:24:46,128 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  7.66it/s] 67%|██████▋   | 4/6 [00:00<00:00, 19.08it/s]100%|██████████| 6/6 [00:02<00:00,  2.23it/s]
2025-03-13 16:24:48,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:48
2025-03-13 16:25:16,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6048 secs
2025-03-13 16:25:16,434 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 16:25:16,435 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-13 16:25:35,127 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6925 secs
2025-03-13 16:25:35,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0013 secs
2025-03-13 16:25:35,129 [INFO]: {
2025-03-13 16:25:35,129 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:35,129 [INFO]: 	index_param: efSearch=202
2025-03-13 16:25:35,129 [INFO]: 	index_path: knn.index
2025-03-13 16:25:35,129 [INFO]: 	size in bytes: 295509490
2025-03-13 16:25:35,129 [INFO]: 	avg_search_speed_ms: 9.787542099149537
2025-03-13 16:25:35,129 [INFO]: 	99p_search_speed_ms: 14.371729784179479
2025-03-13 16:25:35,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:35,129 [INFO]: 	nb vectors: 1502
2025-03-13 16:25:35,129 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:35,129 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-13 16:25:35,129 [INFO]: }
2025-03-13 16:25:35,129 [INFO]: 	>>> Finished "Creating the index" in 49.0042 secs
2025-03-13 16:25:35,129 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0411 secs
2025-03-13 16:25:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 100103 [episode count 4/20]
[retrieval_preprocessing] for episode 100104 [episode count 5/20], we have num_retrieval=np.int64(1497) num_query=np.int64(74)
2025-03-13 16:25:35,800 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:36,032 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:36
2025-03-13 16:25:36,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 16:25:36,064 [INFO]: There are 1497 embeddings of dim 49152
2025-03-13 16:25:36,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 16:25:36,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:36
2025-03-13 16:25:36,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:36,065 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:25:36,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:36,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:36,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:36
2025-03-13 16:25:36,065 [INFO]: 308.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:36,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:25:36,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:36
2025-03-13 16:25:36,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:36,065 [INFO]: 	Creating the index 03/13/2025, 16:25:36
2025-03-13 16:25:36,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:36
2025-03-13 16:25:36,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:25:36,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:36
2025-03-13 16:25:36,066 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:25:36,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 16.61it/s]100%|██████████| 6/6 [00:01<00:00,  3.65it/s]100%|██████████| 6/6 [00:01<00:00,  3.96it/s]
2025-03-13 16:25:37,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:37
2025-03-13 16:26:00,299 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7120 secs
2025-03-13 16:26:00,299 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 16:26:00,299 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.60it/s]
2025-03-13 16:26:25,360 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0601 secs
2025-03-13 16:26:25,569 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5029 secs
2025-03-13 16:26:25,570 [INFO]: {
2025-03-13 16:26:25,570 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:25,570 [INFO]: 	index_param: efSearch=265
2025-03-13 16:26:25,570 [INFO]: 	index_path: knn.index
2025-03-13 16:26:25,570 [INFO]: 	size in bytes: 294525790
2025-03-13 16:26:25,570 [INFO]: 	avg_search_speed_ms: 9.410282253066072
2025-03-13 16:26:25,570 [INFO]: 	99p_search_speed_ms: 12.810932742431744
2025-03-13 16:26:25,570 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:25,570 [INFO]: 	nb vectors: 1497
2025-03-13 16:26:25,570 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:25,570 [INFO]: 	compression ratio: 0.9993086717465387
2025-03-13 16:26:25,570 [INFO]: }
2025-03-13 16:26:25,570 [INFO]: 	>>> Finished "Creating the index" in 49.5051 secs
2025-03-13 16:26:25,570 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5381 secs
2025-03-13 16:26:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 100104 [episode count 5/20]
[retrieval_preprocessing] for episode 100105 [episode count 6/20], we have num_retrieval=np.int64(1511) num_query=np.int64(60)
2025-03-13 16:26:26,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:26,489 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:26
2025-03-13 16:26:26,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-13 16:26:26,517 [INFO]: There are 1511 embeddings of dim 49152
2025-03-13 16:26:26,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:26:26,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:26,517 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:26:26,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:26,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:26,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,517 [INFO]: 311.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:26,517 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:26,517 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:26
2025-03-13 16:26:26,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:26,517 [INFO]: 	Creating the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,517 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:26
2025-03-13 16:26:26,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:26:26,518 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,518 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:26:26,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.88it/s]100%|██████████| 6/6 [00:01<00:00,  4.43it/s]100%|██████████| 6/6 [00:01<00:00,  4.80it/s]
2025-03-13 16:26:27,772 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:27
2025-03-13 16:26:51,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1555 secs
2025-03-13 16:26:51,928 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 16:26:51,928 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.98it/s]
2025-03-13 16:27:07,790 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8618 secs
2025-03-13 16:27:07,792 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2731 secs
2025-03-13 16:27:07,792 [INFO]: {
2025-03-13 16:27:07,792 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:07,792 [INFO]: 	index_param: efSearch=232
2025-03-13 16:27:07,792 [INFO]: 	index_path: knn.index
2025-03-13 16:27:07,792 [INFO]: 	size in bytes: 297280150
2025-03-13 16:27:07,792 [INFO]: 	avg_search_speed_ms: 11.971448801578196
2025-03-13 16:27:07,792 [INFO]: 	99p_search_speed_ms: 17.70593118853867
2025-03-13 16:27:07,792 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:07,792 [INFO]: 	nb vectors: 1511
2025-03-13 16:27:07,792 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:07,792 [INFO]: 	compression ratio: 0.9993088606824236
2025-03-13 16:27:07,792 [INFO]: }
2025-03-13 16:27:07,792 [INFO]: 	>>> Finished "Creating the index" in 41.2746 secs
2025-03-13 16:27:07,792 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3030 secs
2025-03-13 16:27:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 100105 [episode count 6/20]
[retrieval_preprocessing] for episode 100106 [episode count 7/20], we have num_retrieval=np.int64(1510) num_query=np.int64(61)
2025-03-13 16:27:08,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:08,999 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:08
2025-03-13 16:27:08,999 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.00it/s]
2025-03-13 16:27:09,044 [INFO]: There are 1510 embeddings of dim 49152
2025-03-13 16:27:09,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0454 secs
2025-03-13 16:27:09,045 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:09
2025-03-13 16:27:09,045 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:09,045 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:27:09,045 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:09,045 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:27:09,046 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:09
2025-03-13 16:27:09,046 [INFO]: 311.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:09,046 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:27:09,046 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:09
2025-03-13 16:27:09,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:09,047 [INFO]: 	Creating the index 03/13/2025, 16:27:09
2025-03-13 16:27:09,047 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:09
2025-03-13 16:27:09,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 16:27:09,050 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:09
2025-03-13 16:27:09,050 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:27:09,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 15.80it/s]100%|██████████| 6/6 [00:02<00:00,  1.95it/s]100%|██████████| 6/6 [00:02<00:00,  2.13it/s]
2025-03-13 16:27:11,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:11
2025-03-13 16:27:48,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8617 secs
2025-03-13 16:27:48,730 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 16:27:48,730 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 16:28:13,142 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4115 secs
2025-03-13 16:28:13,143 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0932 secs
2025-03-13 16:28:13,143 [INFO]: {
2025-03-13 16:28:13,143 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:13,143 [INFO]: 	index_param: efSearch=202
2025-03-13 16:28:13,143 [INFO]: 	index_path: knn.index
2025-03-13 16:28:13,143 [INFO]: 	size in bytes: 297083410
2025-03-13 16:28:13,143 [INFO]: 	avg_search_speed_ms: 8.910629553629049
2025-03-13 16:28:13,143 [INFO]: 	99p_search_speed_ms: 14.023107264656572
2025-03-13 16:28:13,143 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:13,143 [INFO]: 	nb vectors: 1510
2025-03-13 16:28:13,143 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:13,143 [INFO]: 	compression ratio: 0.9993088473031867
2025-03-13 16:28:13,143 [INFO]: }
2025-03-13 16:28:13,143 [INFO]: 	>>> Finished "Creating the index" in 64.0965 secs
2025-03-13 16:28:13,143 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1445 secs
2025-03-13 16:28:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100106 [episode count 7/20]
[retrieval_preprocessing] for episode 100107 [episode count 8/20], we have num_retrieval=np.int64(1518) num_query=np.int64(53)
2025-03-13 16:28:13,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:14,936 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:14
2025-03-13 16:28:14,936 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1823.61it/s]
2025-03-13 16:28:14,963 [INFO]: There are 1518 embeddings of dim 49152
2025-03-13 16:28:14,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 16:28:14,964 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:14
2025-03-13 16:28:14,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:14,964 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:28:14,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:14,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:28:14,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:14
2025-03-13 16:28:14,964 [INFO]: 313.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:14,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:28:14,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:14
2025-03-13 16:28:14,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:14,964 [INFO]: 	Creating the index 03/13/2025, 16:28:14
2025-03-13 16:28:14,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:14
2025-03-13 16:28:14,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:28:14,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:14
2025-03-13 16:28:14,965 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:28:14,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.70it/s]100%|██████████| 6/6 [00:01<00:00,  4.32it/s]100%|██████████| 6/6 [00:01<00:00,  4.68it/s]
2025-03-13 16:28:16,250 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:28:16
2025-03-13 16:28:43,607 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3567 secs
2025-03-13 16:28:43,607 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 16:28:43,607 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 16:29:03,313 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7053 secs
2025-03-13 16:29:03,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9125 secs
2025-03-13 16:29:03,878 [INFO]: {
2025-03-13 16:29:03,878 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:03,878 [INFO]: 	index_param: efSearch=265
2025-03-13 16:29:03,878 [INFO]: 	index_path: knn.index
2025-03-13 16:29:03,878 [INFO]: 	size in bytes: 298657390
2025-03-13 16:29:03,878 [INFO]: 	avg_search_speed_ms: 11.777402845156544
2025-03-13 16:29:03,878 [INFO]: 	99p_search_speed_ms: 21.135249137878418
2025-03-13 16:29:03,879 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:03,879 [INFO]: 	nb vectors: 1518
2025-03-13 16:29:03,879 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:03,879 [INFO]: 	compression ratio: 0.9993087530832571
2025-03-13 16:29:03,879 [INFO]: }
2025-03-13 16:29:03,879 [INFO]: 	>>> Finished "Creating the index" in 48.9147 secs
2025-03-13 16:29:03,879 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9427 secs
2025-03-13 16:29:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 100107 [episode count 8/20]
[retrieval_preprocessing] for episode 100108 [episode count 9/20], we have num_retrieval=np.int64(1496) num_query=np.int64(75)
2025-03-13 16:29:04,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:05,082 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:05
2025-03-13 16:29:05,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.50it/s]
2025-03-13 16:29:05,119 [INFO]: There are 1496 embeddings of dim 49152
2025-03-13 16:29:05,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 16:29:05,120 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:05
2025-03-13 16:29:05,120 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:05,120 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:29:05,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:05,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:29:05,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:05
2025-03-13 16:29:05,121 [INFO]: 308.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:05,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:29:05,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:05
2025-03-13 16:29:05,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:05,122 [INFO]: 	Creating the index 03/13/2025, 16:29:05
2025-03-13 16:29:05,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:05
2025-03-13 16:29:05,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:29:05,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:05
2025-03-13 16:29:05,126 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:29:05,126 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  8.89it/s] 83%|████████▎ | 5/6 [00:00<00:00, 22.28it/s]100%|██████████| 6/6 [00:01<00:00,  3.71it/s]
2025-03-13 16:29:06,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:06
2025-03-13 16:29:31,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2580 secs
2025-03-13 16:29:31,010 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 16:29:31,010 [INFO]: 	Compute fast metrics 03/13/2025, 16:29:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.32it/s]
2025-03-13 16:29:46,834 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8233 secs
2025-03-13 16:29:46,836 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7100 secs
2025-03-13 16:29:46,836 [INFO]: {
2025-03-13 16:29:46,836 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:46,836 [INFO]: 	index_param: efSearch=164
2025-03-13 16:29:46,836 [INFO]: 	index_path: knn.index
2025-03-13 16:29:46,836 [INFO]: 	size in bytes: 294329050
2025-03-13 16:29:46,836 [INFO]: 	avg_search_speed_ms: 11.153698847976948
2025-03-13 16:29:46,836 [INFO]: 	99p_search_speed_ms: 17.85633848980069
2025-03-13 16:29:46,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:46,836 [INFO]: 	nb vectors: 1496
2025-03-13 16:29:46,836 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:46,836 [INFO]: 	compression ratio: 0.999308658115806
2025-03-13 16:29:46,836 [INFO]: }
2025-03-13 16:29:46,836 [INFO]: 	>>> Finished "Creating the index" in 41.7139 secs
2025-03-13 16:29:46,836 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7537 secs
2025-03-13 16:29:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100108 [episode count 9/20]
[retrieval_preprocessing] for episode 100109 [episode count 10/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-13 16:29:50,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:50,745 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:50
2025-03-13 16:29:50,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.69it/s]
2025-03-13 16:29:50,774 [INFO]: There are 1480 embeddings of dim 49152
2025-03-13 16:29:50,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:29:50,775 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:50
2025-03-13 16:29:50,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:50,775 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:29:50,775 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:50,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:29:50,775 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:50
2025-03-13 16:29:50,775 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:50,775 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:50,775 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:50
2025-03-13 16:29:50,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:50,775 [INFO]: 	Creating the index 03/13/2025, 16:29:50
2025-03-13 16:29:50,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:50
2025-03-13 16:29:50,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:29:50,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:50
2025-03-13 16:29:50,776 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:29:50,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 16.84it/s]100%|██████████| 6/6 [00:01<00:00,  3.47it/s]100%|██████████| 6/6 [00:01<00:00,  3.77it/s]
2025-03-13 16:29:52,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:52
2025-03-13 16:30:25,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3288 secs
2025-03-13 16:30:25,702 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 16:30:25,702 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.46it/s]
2025-03-13 16:30:44,037 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3344 secs
2025-03-13 16:30:44,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2618 secs
2025-03-13 16:30:44,038 [INFO]: {
2025-03-13 16:30:44,038 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:44,038 [INFO]: 	index_param: efSearch=203
2025-03-13 16:30:44,038 [INFO]: 	index_path: knn.index
2025-03-13 16:30:44,038 [INFO]: 	size in bytes: 291181150
2025-03-13 16:30:44,038 [INFO]: 	avg_search_speed_ms: 9.476758323177272
2025-03-13 16:30:44,038 [INFO]: 	99p_search_speed_ms: 14.37804353423417
2025-03-13 16:30:44,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:44,039 [INFO]: 	nb vectors: 1480
2025-03-13 16:30:44,039 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:44,039 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-13 16:30:44,039 [INFO]: }
2025-03-13 16:30:44,039 [INFO]: 	>>> Finished "Creating the index" in 53.2632 secs
2025-03-13 16:30:44,039 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2934 secs
2025-03-13 16:30:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 100109 [episode count 10/20]
[retrieval_preprocessing] for episode 100110 [episode count 11/20], we have num_retrieval=np.int64(1477) num_query=np.int64(94)
2025-03-13 16:30:44,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:45,106 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:45
2025-03-13 16:30:45,106 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-13 16:30:45,146 [INFO]: There are 1477 embeddings of dim 49152
2025-03-13 16:30:45,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 16:30:45,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:45
2025-03-13 16:30:45,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:45,147 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:30:45,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:45,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:30:45,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:45
2025-03-13 16:30:45,148 [INFO]: 304.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:45,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:30:45,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:45
2025-03-13 16:30:45,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:45,148 [INFO]: 	Creating the index 03/13/2025, 16:30:45
2025-03-13 16:30:45,148 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:45
2025-03-13 16:30:45,150 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:30:45,151 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:45
2025-03-13 16:30:45,151 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:30:45,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 16.51it/s]100%|██████████| 6/6 [00:01<00:00,  4.25it/s]100%|██████████| 6/6 [00:01<00:00,  4.58it/s]
2025-03-13 16:30:46,465 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:46
2025-03-13 16:31:10,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8174 secs
2025-03-13 16:31:10,283 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 16:31:10,283 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.11it/s]
2025-03-13 16:31:27,885 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6021 secs
2025-03-13 16:31:27,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7359 secs
2025-03-13 16:31:27,887 [INFO]: {
2025-03-13 16:31:27,887 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:27,887 [INFO]: 	index_param: efSearch=254
2025-03-13 16:31:27,887 [INFO]: 	index_path: knn.index
2025-03-13 16:31:27,887 [INFO]: 	size in bytes: 290590930
2025-03-13 16:31:27,887 [INFO]: 	avg_search_speed_ms: 10.95387553704366
2025-03-13 16:31:27,887 [INFO]: 	99p_search_speed_ms: 15.651964396238327
2025-03-13 16:31:27,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:27,887 [INFO]: 	nb vectors: 1477
2025-03-13 16:31:27,887 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:27,887 [INFO]: 	compression ratio: 0.9993086019580859
2025-03-13 16:31:27,887 [INFO]: }
2025-03-13 16:31:27,887 [INFO]: 	>>> Finished "Creating the index" in 42.7387 secs
2025-03-13 16:31:27,887 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7806 secs
2025-03-13 16:31:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 100110 [episode count 11/20]
[retrieval_preprocessing] for episode 100111 [episode count 12/20], we have num_retrieval=np.int64(1512) num_query=np.int64(59)
2025-03-13 16:31:28,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:28,905 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:28
2025-03-13 16:31:28,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1083.52it/s]
2025-03-13 16:31:28,943 [INFO]: There are 1512 embeddings of dim 49152
2025-03-13 16:31:28,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 16:31:28,944 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:28
2025-03-13 16:31:28,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:28,944 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:31:28,944 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:28,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:31:28,944 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:28
2025-03-13 16:31:28,944 [INFO]: 312.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:28,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:31:28,945 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:28
2025-03-13 16:31:28,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:28,945 [INFO]: 	Creating the index 03/13/2025, 16:31:28
2025-03-13 16:31:28,945 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:28
2025-03-13 16:31:28,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:31:28,947 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:28
2025-03-13 16:31:28,947 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:31:28,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.21it/s]100%|██████████| 6/6 [00:01<00:00,  4.18it/s]100%|██████████| 6/6 [00:01<00:00,  4.52it/s]
2025-03-13 16:31:30,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:30
2025-03-13 16:31:58,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1990 secs
2025-03-13 16:31:58,140 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 16:31:58,141 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 16:32:19,872 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7311 secs
2025-03-13 16:32:19,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9262 secs
2025-03-13 16:32:19,873 [INFO]: {
2025-03-13 16:32:19,873 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:19,873 [INFO]: 	index_param: efSearch=215
2025-03-13 16:32:19,873 [INFO]: 	index_path: knn.index
2025-03-13 16:32:19,873 [INFO]: 	size in bytes: 297476890
2025-03-13 16:32:19,873 [INFO]: 	avg_search_speed_ms: 9.302696005203003
2025-03-13 16:32:19,873 [INFO]: 	99p_search_speed_ms: 12.942017018795013
2025-03-13 16:32:19,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:19,873 [INFO]: 	nb vectors: 1512
2025-03-13 16:32:19,873 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:19,873 [INFO]: 	compression ratio: 0.9993088740439635
2025-03-13 16:32:19,873 [INFO]: }
2025-03-13 16:32:19,873 [INFO]: 	>>> Finished "Creating the index" in 50.9284 secs
2025-03-13 16:32:19,873 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9680 secs
2025-03-13 16:32:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 100111 [episode count 12/20]
[retrieval_preprocessing] for episode 100112 [episode count 13/20], we have num_retrieval=np.int64(1502) num_query=np.int64(69)
2025-03-13 16:32:20,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:21,163 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:21
2025-03-13 16:32:21,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2173.21it/s]
2025-03-13 16:32:21,189 [INFO]: There are 1502 embeddings of dim 49152
2025-03-13 16:32:21,189 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:32:21,189 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:21
2025-03-13 16:32:21,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:21,189 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:32:21,189 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:21,189 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:32:21,189 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:21
2025-03-13 16:32:21,189 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:21,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:32:21,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:21
2025-03-13 16:32:21,190 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:21,190 [INFO]: 	Creating the index 03/13/2025, 16:32:21
2025-03-13 16:32:21,190 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:21
2025-03-13 16:32:21,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:32:21,191 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:21
2025-03-13 16:32:21,191 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:32:21,191 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  8.69it/s]100%|██████████| 6/6 [00:01<00:00,  4.68it/s]100%|██████████| 6/6 [00:01<00:00,  4.79it/s]
2025-03-13 16:32:22,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:22
2025-03-13 16:32:53,671 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2241 secs
2025-03-13 16:32:53,672 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 16:32:53,672 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.13it/s]
2025-03-13 16:33:19,493 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8210 secs
2025-03-13 16:33:19,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3040 secs
2025-03-13 16:33:19,495 [INFO]: {
2025-03-13 16:33:19,495 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:19,495 [INFO]: 	index_param: efSearch=168
2025-03-13 16:33:19,495 [INFO]: 	index_path: knn.index
2025-03-13 16:33:19,495 [INFO]: 	size in bytes: 295509490
2025-03-13 16:33:19,495 [INFO]: 	avg_search_speed_ms: 7.99826389926074
2025-03-13 16:33:19,495 [INFO]: 	99p_search_speed_ms: 11.359279626049101
2025-03-13 16:33:19,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:19,495 [INFO]: 	nb vectors: 1502
2025-03-13 16:33:19,495 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:19,495 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-13 16:33:19,495 [INFO]: }
2025-03-13 16:33:19,495 [INFO]: 	>>> Finished "Creating the index" in 58.3055 secs
2025-03-13 16:33:19,495 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3318 secs
2025-03-13 16:33:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 100112 [episode count 13/20]
[retrieval_preprocessing] for episode 100113 [episode count 14/20], we have num_retrieval=np.int64(1492) num_query=np.int64(79)
2025-03-13 16:33:20,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:20,360 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:20
2025-03-13 16:33:20,360 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.04it/s]
2025-03-13 16:33:20,391 [INFO]: There are 1492 embeddings of dim 49152
2025-03-13 16:33:20,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 16:33:20,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:20
2025-03-13 16:33:20,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:20,391 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:33:20,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:20,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:33:20,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:20
2025-03-13 16:33:20,392 [INFO]: 307.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:20,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:33:20,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:20
2025-03-13 16:33:20,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:20,392 [INFO]: 	Creating the index 03/13/2025, 16:33:20
2025-03-13 16:33:20,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:20
2025-03-13 16:33:20,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:33:20,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:20
2025-03-13 16:33:20,393 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:33:20,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 16.18it/s]100%|██████████| 6/6 [00:01<00:00,  3.22it/s]100%|██████████| 6/6 [00:01<00:00,  3.49it/s]
2025-03-13 16:33:22,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:22
2025-03-13 16:33:45,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0870 secs
2025-03-13 16:33:45,202 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 16:33:45,203 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-13 16:34:01,039 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8364 secs
2025-03-13 16:34:01,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6483 secs
2025-03-13 16:34:01,041 [INFO]: {
2025-03-13 16:34:01,041 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:01,041 [INFO]: 	index_param: efSearch=239
2025-03-13 16:34:01,041 [INFO]: 	index_path: knn.index
2025-03-13 16:34:01,041 [INFO]: 	size in bytes: 293542090
2025-03-13 16:34:01,041 [INFO]: 	avg_search_speed_ms: 12.51036892470438
2025-03-13 16:34:01,041 [INFO]: 	99p_search_speed_ms: 18.776980377733704
2025-03-13 16:34:01,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:01,041 [INFO]: 	nb vectors: 1492
2025-03-13 16:34:01,041 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:01,041 [INFO]: 	compression ratio: 0.9993086034101617
2025-03-13 16:34:01,041 [INFO]: }
2025-03-13 16:34:01,041 [INFO]: 	>>> Finished "Creating the index" in 40.6496 secs
2025-03-13 16:34:01,041 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6817 secs
2025-03-13 16:34:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 100113 [episode count 14/20]
[retrieval_preprocessing] for episode 100114 [episode count 15/20], we have num_retrieval=np.int64(1491) num_query=np.int64(80)
2025-03-13 16:34:02,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:02,338 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:02
2025-03-13 16:34:02,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2133.42it/s]
2025-03-13 16:34:02,368 [INFO]: There are 1491 embeddings of dim 49152
2025-03-13 16:34:02,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 16:34:02,369 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:02
2025-03-13 16:34:02,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:02,369 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:34:02,369 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:02,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:34:02,369 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:02
2025-03-13 16:34:02,369 [INFO]: 307.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:02,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:34:02,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:02
2025-03-13 16:34:02,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:02,369 [INFO]: 	Creating the index 03/13/2025, 16:34:02
2025-03-13 16:34:02,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:02
2025-03-13 16:34:02,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:34:02,371 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:02
2025-03-13 16:34:02,371 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:34:02,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 24.42it/s]100%|██████████| 6/6 [00:01<00:00,  3.06it/s]100%|██████████| 6/6 [00:01<00:00,  3.52it/s]
2025-03-13 16:34:04,079 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:04
2025-03-13 16:34:34,962 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8828 secs
2025-03-13 16:34:34,962 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:34:34,963 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.33it/s]
2025-03-13 16:34:50,832 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8696 secs
2025-03-13 16:34:50,834 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4624 secs
2025-03-13 16:34:50,834 [INFO]: {
2025-03-13 16:34:50,834 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:50,834 [INFO]: 	index_param: efSearch=219
2025-03-13 16:34:50,834 [INFO]: 	index_path: knn.index
2025-03-13 16:34:50,834 [INFO]: 	size in bytes: 293345350
2025-03-13 16:34:50,834 [INFO]: 	avg_search_speed_ms: 11.946265733986648
2025-03-13 16:34:50,834 [INFO]: 	99p_search_speed_ms: 19.035462625324723
2025-03-13 16:34:50,834 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:50,834 [INFO]: 	nb vectors: 1491
2025-03-13 16:34:50,834 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:50,834 [INFO]: 	compression ratio: 0.9993085896878884
2025-03-13 16:34:50,834 [INFO]: }
2025-03-13 16:34:50,834 [INFO]: 	>>> Finished "Creating the index" in 48.4647 secs
2025-03-13 16:34:50,834 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4953 secs
2025-03-13 16:34:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 100114 [episode count 15/20]
[retrieval_preprocessing] for episode 100115 [episode count 16/20], we have num_retrieval=np.int64(1487) num_query=np.int64(84)
2025-03-13 16:34:51,605 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:51,828 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:51
2025-03-13 16:34:51,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2008.77it/s]
2025-03-13 16:34:51,857 [INFO]: There are 1487 embeddings of dim 49152
2025-03-13 16:34:51,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:34:51,857 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:51
2025-03-13 16:34:51,857 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:51,857 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:34:51,857 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:51,857 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:34:51,857 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:51
2025-03-13 16:34:51,858 [INFO]: 306.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:51,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:34:51,858 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:51
2025-03-13 16:34:51,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:51,858 [INFO]: 	Creating the index 03/13/2025, 16:34:51
2025-03-13 16:34:51,858 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:51
2025-03-13 16:34:51,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:34:51,859 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:51
2025-03-13 16:34:51,859 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:34:51,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 17.38it/s]100%|██████████| 6/6 [00:01<00:00,  4.12it/s]100%|██████████| 6/6 [00:01<00:00,  4.45it/s]
2025-03-13 16:34:53,210 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:53
2025-03-13 16:35:20,189 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9783 secs
2025-03-13 16:35:20,189 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 16:35:20,189 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.90it/s]
2025-03-13 16:35:43,168 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9789 secs
2025-03-13 16:35:43,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6221 secs
2025-03-13 16:35:43,481 [INFO]: {
2025-03-13 16:35:43,481 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:43,481 [INFO]: 	index_param: efSearch=231
2025-03-13 16:35:43,481 [INFO]: 	index_path: knn.index
2025-03-13 16:35:43,481 [INFO]: 	size in bytes: 292558390
2025-03-13 16:35:43,481 [INFO]: 	avg_search_speed_ms: 9.492907106286124
2025-03-13 16:35:43,482 [INFO]: 	99p_search_speed_ms: 12.567071174271405
2025-03-13 16:35:43,482 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:43,482 [INFO]: 	nb vectors: 1487
2025-03-13 16:35:43,482 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:43,482 [INFO]: 	compression ratio: 0.9993085346142355
2025-03-13 16:35:43,482 [INFO]: }
2025-03-13 16:35:43,482 [INFO]: 	>>> Finished "Creating the index" in 51.6241 secs
2025-03-13 16:35:43,482 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6535 secs
2025-03-13 16:35:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 100115 [episode count 16/20]
[retrieval_preprocessing] for episode 100116 [episode count 17/20], we have num_retrieval=np.int64(1482) num_query=np.int64(89)
2025-03-13 16:35:45,124 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:45,373 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:45
2025-03-13 16:35:45,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.33it/s]
2025-03-13 16:35:45,404 [INFO]: There are 1482 embeddings of dim 49152
2025-03-13 16:35:45,405 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 16:35:45,405 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,405 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:45,405 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:35:45,405 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:45,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:45,405 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,405 [INFO]: 305.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:45,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:35:45,405 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:45
2025-03-13 16:35:45,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:45,405 [INFO]: 	Creating the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,405 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:45
2025-03-13 16:35:45,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:35:45,406 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,407 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:35:45,407 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.78it/s]100%|██████████| 6/6 [00:01<00:00,  3.72it/s]100%|██████████| 6/6 [00:01<00:00,  4.04it/s]
2025-03-13 16:35:46,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:46
2025-03-13 16:36:17,955 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0585 secs
2025-03-13 16:36:17,955 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 16:36:17,955 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 16:36:38,484 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5290 secs
2025-03-13 16:36:38,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0796 secs
2025-03-13 16:36:38,486 [INFO]: {
2025-03-13 16:36:38,486 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:38,486 [INFO]: 	index_param: efSearch=188
2025-03-13 16:36:38,486 [INFO]: 	index_path: knn.index
2025-03-13 16:36:38,486 [INFO]: 	size in bytes: 291574690
2025-03-13 16:36:38,486 [INFO]: 	avg_search_speed_ms: 9.164811519653478
2025-03-13 16:36:38,486 [INFO]: 	99p_search_speed_ms: 11.92951396573335
2025-03-13 16:36:38,486 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:38,486 [INFO]: 	nb vectors: 1482
2025-03-13 16:36:38,486 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:38,486 [INFO]: 	compression ratio: 0.9993084653541088
2025-03-13 16:36:38,486 [INFO]: }
2025-03-13 16:36:38,486 [INFO]: 	>>> Finished "Creating the index" in 53.0812 secs
2025-03-13 16:36:38,486 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1129 secs
2025-03-13 16:36:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 100116 [episode count 17/20]
[retrieval_preprocessing] for episode 100117 [episode count 18/20], we have num_retrieval=np.int64(1492) num_query=np.int64(79)
2025-03-13 16:36:39,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:39,620 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:39
2025-03-13 16:36:39,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1822.03it/s]
2025-03-13 16:36:39,662 [INFO]: There are 1492 embeddings of dim 49152
2025-03-13 16:36:39,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0416 secs
2025-03-13 16:36:39,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:39,662 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:36:39,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:39,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:36:39,663 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,663 [INFO]: 307.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:39,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:36:39,663 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:39
2025-03-13 16:36:39,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:39,663 [INFO]: 	Creating the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,663 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:39
2025-03-13 16:36:39,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 16:36:39,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,665 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:36:39,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.42it/s]100%|██████████| 6/6 [00:01<00:00,  3.53it/s]100%|██████████| 6/6 [00:01<00:00,  3.84it/s]
2025-03-13 16:36:41,231 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:41
2025-03-13 16:37:06,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2400 secs
2025-03-13 16:37:06,472 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 16:37:06,472 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.63it/s]
2025-03-13 16:37:24,355 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8829 secs
2025-03-13 16:37:24,357 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6914 secs
2025-03-13 16:37:24,357 [INFO]: {
2025-03-13 16:37:24,357 [INFO]: 	index_key: HNSW15
2025-03-13 16:37:24,357 [INFO]: 	index_param: efSearch=164
2025-03-13 16:37:24,357 [INFO]: 	index_path: knn.index
2025-03-13 16:37:24,357 [INFO]: 	size in bytes: 293542090
2025-03-13 16:37:24,357 [INFO]: 	avg_search_speed_ms: 9.437422853024712
2025-03-13 16:37:24,357 [INFO]: 	99p_search_speed_ms: 15.899882605299359
2025-03-13 16:37:24,357 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:24,357 [INFO]: 	nb vectors: 1492
2025-03-13 16:37:24,357 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:24,357 [INFO]: 	compression ratio: 0.9993086034101617
2025-03-13 16:37:24,357 [INFO]: }
2025-03-13 16:37:24,357 [INFO]: 	>>> Finished "Creating the index" in 44.6940 secs
2025-03-13 16:37:24,357 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7368 secs
2025-03-13 16:37:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 100117 [episode count 18/20]
[retrieval_preprocessing] for episode 100118 [episode count 19/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-13 16:37:25,110 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:25,377 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:25
2025-03-13 16:37:25,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.98it/s]
2025-03-13 16:37:25,410 [INFO]: There are 1480 embeddings of dim 49152
2025-03-13 16:37:25,410 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 16:37:25,410 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:25
2025-03-13 16:37:25,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:25,410 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:37:25,410 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:37:25,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:37:25,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:25
2025-03-13 16:37:25,410 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:25,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:37:25,410 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:25
2025-03-13 16:37:25,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:25,410 [INFO]: 	Creating the index 03/13/2025, 16:37:25
2025-03-13 16:37:25,411 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:37:25
2025-03-13 16:37:25,412 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:37:25,412 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:25
2025-03-13 16:37:25,412 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:37:25,412 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.65it/s]100%|██████████| 6/6 [00:01<00:00,  3.76it/s]100%|██████████| 6/6 [00:01<00:00,  3.87it/s]
2025-03-13 16:37:26,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:37:26
2025-03-13 16:37:47,359 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3936 secs
2025-03-13 16:37:47,360 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 16:37:47,360 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.85it/s]
2025-03-13 16:38:14,035 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6755 secs
2025-03-13 16:38:14,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6255 secs
2025-03-13 16:38:14,038 [INFO]: {
2025-03-13 16:38:14,038 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:14,038 [INFO]: 	index_param: efSearch=270
2025-03-13 16:38:14,038 [INFO]: 	index_path: knn.index
2025-03-13 16:38:14,038 [INFO]: 	size in bytes: 291181150
2025-03-13 16:38:14,038 [INFO]: 	avg_search_speed_ms: 11.884592988941987
2025-03-13 16:38:14,038 [INFO]: 	99p_search_speed_ms: 22.765707105863843
2025-03-13 16:38:14,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:14,038 [INFO]: 	nb vectors: 1480
2025-03-13 16:38:14,038 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:14,038 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-13 16:38:14,038 [INFO]: }
2025-03-13 16:38:14,038 [INFO]: 	>>> Finished "Creating the index" in 48.6273 secs
2025-03-13 16:38:14,038 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6605 secs
2025-03-13 16:38:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 100118 [episode count 19/20]
2025-03-13 16:38:15: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_watermelon_to_the_right [chosen_id count 5/8]
2025-03-13 16:38:16: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_pick_up_the_orange_in_the_bowl_and_move_it_to_the_other_container [chosen_id count 6/8]
2025-03-13 16:38:16: [retrieval_preprocessing] we have num_total=2036 embedding_dim=49152
[retrieval_preprocessing] for episode 100119 [episode count 0/20], we have num_retrieval=np.int64(1946) num_query=np.int64(90)
2025-03-13 16:38:17,189 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:17,726 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:17
2025-03-13 16:38:17,726 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.89it/s]
2025-03-13 16:38:17,766 [INFO]: There are 1946 embeddings of dim 49152
2025-03-13 16:38:17,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 16:38:17,766 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:17
2025-03-13 16:38:17,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:17,767 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:38:17,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:17,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:17,767 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:17
2025-03-13 16:38:17,767 [INFO]: 401.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:17,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:38:17,767 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:17
2025-03-13 16:38:17,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:17,767 [INFO]: 	Creating the index 03/13/2025, 16:38:17
2025-03-13 16:38:17,767 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:17
2025-03-13 16:38:17,768 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:38:17,768 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:17
2025-03-13 16:38:17,768 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:38:17,768 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.79it/s] 50%|█████     | 4/8 [00:00<00:00, 16.48it/s]100%|██████████| 8/8 [00:02<00:00,  2.38it/s]100%|██████████| 8/8 [00:02<00:00,  2.76it/s]
2025-03-13 16:38:20,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:20
2025-03-13 16:39:05,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9856 secs
2025-03-13 16:39:05,652 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 16:39:05,653 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.16it/s]
2025-03-13 16:39:21,302 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6492 secs
2025-03-13 16:39:21,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5352 secs
2025-03-13 16:39:21,304 [INFO]: {
2025-03-13 16:39:21,304 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:21,304 [INFO]: 	index_param: efSearch=142
2025-03-13 16:39:21,304 [INFO]: 	index_path: knn.index
2025-03-13 16:39:21,304 [INFO]: 	size in bytes: 382863910
2025-03-13 16:39:21,304 [INFO]: 	avg_search_speed_ms: 10.072462913024072
2025-03-13 16:39:21,304 [INFO]: 	99p_search_speed_ms: 14.089055331423879
2025-03-13 16:39:21,304 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:21,304 [INFO]: 	nb vectors: 1946
2025-03-13 16:39:21,304 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:21,304 [INFO]: 	compression ratio: 0.9993085219236255
2025-03-13 16:39:21,304 [INFO]: }
2025-03-13 16:39:21,304 [INFO]: 	>>> Finished "Creating the index" in 63.5367 secs
2025-03-13 16:39:21,304 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5781 secs
2025-03-13 16:39:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 100119 [episode count 0/20]
[retrieval_preprocessing] for episode 100120 [episode count 1/20], we have num_retrieval=np.int64(1880) num_query=np.int64(156)
2025-03-13 16:39:22,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:22,401 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:22
2025-03-13 16:39:22,401 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.31it/s]
2025-03-13 16:39:22,429 [INFO]: There are 1880 embeddings of dim 49152
2025-03-13 16:39:22,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:39:22,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:22,429 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:39:22,429 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:22,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:39:22,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,429 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:22,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:39:22,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:22
2025-03-13 16:39:22,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:22,429 [INFO]: 	Creating the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:22
2025-03-13 16:39:22,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:39:22,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,430 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:39:22,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.49it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.46it/s]100%|██████████| 8/8 [00:01<00:00,  4.72it/s]
2025-03-13 16:39:24,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:24
2025-03-13 16:39:50,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9614 secs
2025-03-13 16:39:50,570 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 16:39:50,570 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-13 16:40:17,415 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8444 secs
2025-03-13 16:40:17,416 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9853 secs
2025-03-13 16:40:17,416 [INFO]: {
2025-03-13 16:40:17,416 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:17,416 [INFO]: 	index_param: efSearch=163
2025-03-13 16:40:17,416 [INFO]: 	index_path: knn.index
2025-03-13 16:40:17,416 [INFO]: 	size in bytes: 369878770
2025-03-13 16:40:17,416 [INFO]: 	avg_search_speed_ms: 7.364512433363769
2025-03-13 16:40:17,416 [INFO]: 	99p_search_speed_ms: 10.685024526901548
2025-03-13 16:40:17,416 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:17,416 [INFO]: 	nb vectors: 1880
2025-03-13 16:40:17,416 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:17,416 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-13 16:40:17,416 [INFO]: }
2025-03-13 16:40:17,416 [INFO]: 	>>> Finished "Creating the index" in 54.9866 secs
2025-03-13 16:40:17,416 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0150 secs
2025-03-13 16:40:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100120 [episode count 1/20]
[retrieval_preprocessing] for episode 100121 [episode count 2/20], we have num_retrieval=np.int64(1953) num_query=np.int64(83)
2025-03-13 16:40:18,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:19,874 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:19
2025-03-13 16:40:19,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1765.28it/s]
2025-03-13 16:40:19,918 [INFO]: There are 1953 embeddings of dim 49152
2025-03-13 16:40:19,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0437 secs
2025-03-13 16:40:19,918 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:19
2025-03-13 16:40:19,918 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:19,918 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:40:19,918 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:19,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:40:19,918 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:19
2025-03-13 16:40:19,919 [INFO]: 403.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:19,919 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:40:19,919 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:19
2025-03-13 16:40:19,919 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:19,919 [INFO]: 	Creating the index 03/13/2025, 16:40:19
2025-03-13 16:40:19,919 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:19
2025-03-13 16:40:19,921 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:40:19,922 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:19
2025-03-13 16:40:19,922 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:40:19,922 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.79it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.46it/s]100%|██████████| 8/8 [00:01<00:00,  4.88it/s]
2025-03-13 16:40:21,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:21
2025-03-13 16:40:44,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.6118 secs
2025-03-13 16:40:44,180 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 16:40:44,180 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.75it/s]
2025-03-13 16:41:13,261 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0814 secs
2025-03-13 16:41:13,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3410 secs
2025-03-13 16:41:13,263 [INFO]: {
2025-03-13 16:41:13,263 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:13,263 [INFO]: 	index_param: efSearch=262
2025-03-13 16:41:13,263 [INFO]: 	index_path: knn.index
2025-03-13 16:41:13,263 [INFO]: 	size in bytes: 384241090
2025-03-13 16:41:13,263 [INFO]: 	avg_search_speed_ms: 12.084514939716616
2025-03-13 16:41:13,263 [INFO]: 	99p_search_speed_ms: 17.43164186831564
2025-03-13 16:41:13,263 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:13,263 [INFO]: 	nb vectors: 1953
2025-03-13 16:41:13,263 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:13,263 [INFO]: 	compression ratio: 0.9993085955486958
2025-03-13 16:41:13,263 [INFO]: }
2025-03-13 16:41:13,263 [INFO]: 	>>> Finished "Creating the index" in 53.3439 secs
2025-03-13 16:41:13,263 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3889 secs
2025-03-13 16:41:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100121 [episode count 2/20]
[retrieval_preprocessing] for episode 100122 [episode count 3/20], we have num_retrieval=np.int64(1936) num_query=np.int64(100)
2025-03-13 16:41:14,426 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:14,830 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:14
2025-03-13 16:41:14,830 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-13 16:41:14,867 [INFO]: There are 1936 embeddings of dim 49152
2025-03-13 16:41:14,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 16:41:14,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:14
2025-03-13 16:41:14,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:14,868 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:41:14,868 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:14,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:41:14,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:14
2025-03-13 16:41:14,868 [INFO]: 399.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:14,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:41:14,868 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:14
2025-03-13 16:41:14,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:14,869 [INFO]: 	Creating the index 03/13/2025, 16:41:14
2025-03-13 16:41:14,869 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:14
2025-03-13 16:41:14,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:41:14,870 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:14
2025-03-13 16:41:14,870 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:41:14,870 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 15.31it/s] 75%|███████▌  | 6/8 [00:00<00:00, 26.03it/s]100%|██████████| 8/8 [00:03<00:00,  2.53it/s]
2025-03-13 16:41:18,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:18
2025-03-13 16:41:53,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0283 secs
2025-03-13 16:41:53,061 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 16:41:53,061 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.85it/s]
2025-03-13 16:42:14,862 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8009 secs
2025-03-13 16:42:14,864 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9936 secs
2025-03-13 16:42:14,864 [INFO]: {
2025-03-13 16:42:14,864 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:14,864 [INFO]: 	index_param: efSearch=151
2025-03-13 16:42:14,864 [INFO]: 	index_path: knn.index
2025-03-13 16:42:14,864 [INFO]: 	size in bytes: 380896510
2025-03-13 16:42:14,864 [INFO]: 	avg_search_speed_ms: 7.88354067986079
2025-03-13 16:42:14,864 [INFO]: 	99p_search_speed_ms: 10.86434966418891
2025-03-13 16:42:14,864 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:14,864 [INFO]: 	nb vectors: 1936
2025-03-13 16:42:14,864 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:14,864 [INFO]: 	compression ratio: 0.9993084158213998
2025-03-13 16:42:14,864 [INFO]: }
2025-03-13 16:42:14,864 [INFO]: 	>>> Finished "Creating the index" in 59.9955 secs
2025-03-13 16:42:14,864 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0344 secs
2025-03-13 16:42:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 100122 [episode count 3/20]
[retrieval_preprocessing] for episode 100123 [episode count 4/20], we have num_retrieval=np.int64(1964) num_query=np.int64(72)
2025-03-13 16:42:15,803 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:16,115 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:16
2025-03-13 16:42:16,115 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-13 16:42:16,146 [INFO]: There are 1964 embeddings of dim 49152
2025-03-13 16:42:16,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 16:42:16,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:16
2025-03-13 16:42:16,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:16,147 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:42:16,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:16,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:42:16,148 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:16
2025-03-13 16:42:16,148 [INFO]: 405.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:16,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:42:16,149 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:16
2025-03-13 16:42:16,149 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:16,149 [INFO]: 	Creating the index 03/13/2025, 16:42:16
2025-03-13 16:42:16,149 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:16
2025-03-13 16:42:16,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:42:16,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:16
2025-03-13 16:42:16,152 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:42:16,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.27it/s] 50%|█████     | 4/8 [00:00<00:00, 20.37it/s]100%|██████████| 8/8 [00:02<00:00,  3.12it/s]100%|██████████| 8/8 [00:02<00:00,  3.64it/s]
2025-03-13 16:42:18,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:18
2025-03-13 16:42:44,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4126 secs
2025-03-13 16:42:44,115 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 16:42:44,115 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 16:43:18,975 [INFO]: 	>>> Finished "Compute fast metrics" in 34.8596 secs
2025-03-13 16:43:18,977 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8249 secs
2025-03-13 16:43:18,977 [INFO]: {
2025-03-13 16:43:18,977 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:18,977 [INFO]: 	index_param: efSearch=198
2025-03-13 16:43:18,977 [INFO]: 	index_path: knn.index
2025-03-13 16:43:18,977 [INFO]: 	size in bytes: 386405230
2025-03-13 16:43:18,977 [INFO]: 	avg_search_speed_ms: 10.225160294288584
2025-03-13 16:43:18,977 [INFO]: 	99p_search_speed_ms: 14.091070517897608
2025-03-13 16:43:18,977 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:18,977 [INFO]: 	nb vectors: 1964
2025-03-13 16:43:18,977 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:18,977 [INFO]: 	compression ratio: 0.999308710184901
2025-03-13 16:43:18,977 [INFO]: }
2025-03-13 16:43:18,977 [INFO]: 	>>> Finished "Creating the index" in 62.8279 secs
2025-03-13 16:43:18,977 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8625 secs
2025-03-13 16:43:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 100123 [episode count 4/20]
[retrieval_preprocessing] for episode 100124 [episode count 5/20], we have num_retrieval=np.int64(1922) num_query=np.int64(114)
2025-03-13 16:43:19,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:20,014 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:20
2025-03-13 16:43:20,015 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.04it/s]
2025-03-13 16:43:20,055 [INFO]: There are 1922 embeddings of dim 49152
2025-03-13 16:43:20,055 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 16:43:20,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:20,055 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:43:20,055 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:20,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:20,056 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,056 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:20,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:43:20,056 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:20
2025-03-13 16:43:20,056 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:20,056 [INFO]: 	Creating the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,056 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:20
2025-03-13 16:43:20,057 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:43:20,057 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,057 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:43:20,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.64it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.08it/s]100%|██████████| 8/8 [00:01<00:00,  4.93it/s]
2025-03-13 16:43:21,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:21
2025-03-13 16:43:48,714 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0316 secs
2025-03-13 16:43:48,714 [INFO]: The best hyperparameters are: efSearch=100
2025-03-13 16:43:48,714 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.94it/s]
2025-03-13 16:44:04,843 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1282 secs
2025-03-13 16:44:04,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7874 secs
2025-03-13 16:44:04,844 [INFO]: {
2025-03-13 16:44:04,844 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:04,844 [INFO]: 	index_param: efSearch=100
2025-03-13 16:44:04,844 [INFO]: 	index_path: knn.index
2025-03-13 16:44:04,844 [INFO]: 	size in bytes: 378142030
2025-03-13 16:44:04,844 [INFO]: 	avg_search_speed_ms: 6.169673054404327
2025-03-13 16:44:04,844 [INFO]: 	99p_search_speed_ms: 8.601057063788176
2025-03-13 16:44:04,844 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:04,845 [INFO]: 	nb vectors: 1922
2025-03-13 16:44:04,845 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:04,845 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-13 16:44:04,845 [INFO]: }
2025-03-13 16:44:04,845 [INFO]: 	>>> Finished "Creating the index" in 44.7888 secs
2025-03-13 16:44:04,845 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8300 secs
2025-03-13 16:44:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 100124 [episode count 5/20]
[retrieval_preprocessing] for episode 100125 [episode count 6/20], we have num_retrieval=np.int64(1945) num_query=np.int64(91)
2025-03-13 16:44:07,910 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:08,377 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:08
2025-03-13 16:44:08,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.72it/s]
2025-03-13 16:44:08,417 [INFO]: There are 1945 embeddings of dim 49152
2025-03-13 16:44:08,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 16:44:08,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:08
2025-03-13 16:44:08,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:08,417 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:44:08,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:08,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:44:08,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:08
2025-03-13 16:44:08,418 [INFO]: 401.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:08,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:44:08,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:08
2025-03-13 16:44:08,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:08,418 [INFO]: 	Creating the index 03/13/2025, 16:44:08
2025-03-13 16:44:08,418 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:08
2025-03-13 16:44:08,419 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:44:08,419 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:08
2025-03-13 16:44:08,419 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:44:08,419 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.70it/s] 62%|██████▎   | 5/8 [00:00<00:00, 24.54it/s]100%|██████████| 8/8 [00:02<00:00,  3.16it/s]100%|██████████| 8/8 [00:02<00:00,  3.84it/s]
2025-03-13 16:44:10,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:10
2025-03-13 16:44:48,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1177 secs
2025-03-13 16:44:48,624 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 16:44:48,624 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.88it/s]
2025-03-13 16:45:12,417 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7932 secs
2025-03-13 16:45:13,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9801 secs
2025-03-13 16:45:13,400 [INFO]: {
2025-03-13 16:45:13,400 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:13,400 [INFO]: 	index_param: efSearch=127
2025-03-13 16:45:13,400 [INFO]: 	index_path: knn.index
2025-03-13 16:45:13,400 [INFO]: 	size in bytes: 382667170
2025-03-13 16:45:13,400 [INFO]: 	avg_search_speed_ms: 7.001125023188982
2025-03-13 16:45:13,400 [INFO]: 	99p_search_speed_ms: 9.545394629240038
2025-03-13 16:45:13,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:13,400 [INFO]: 	nb vectors: 1945
2025-03-13 16:45:13,400 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:13,400 [INFO]: 	compression ratio: 0.9993085113624981
2025-03-13 16:45:13,400 [INFO]: }
2025-03-13 16:45:13,400 [INFO]: 	>>> Finished "Creating the index" in 64.9826 secs
2025-03-13 16:45:13,400 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0237 secs
2025-03-13 16:45:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 100125 [episode count 6/20]
[retrieval_preprocessing] for episode 100126 [episode count 7/20], we have num_retrieval=np.int64(1967) num_query=np.int64(69)
2025-03-13 16:45:14,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:14,386 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:14
2025-03-13 16:45:14,387 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1544.29it/s]
2025-03-13 16:45:14,414 [INFO]: There are 1967 embeddings of dim 49152
2025-03-13 16:45:14,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:45:14,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:14
2025-03-13 16:45:14,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:14,414 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:45:14,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:14,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:14,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:14
2025-03-13 16:45:14,414 [INFO]: 405.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:14,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:14,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:14
2025-03-13 16:45:14,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:14,415 [INFO]: 	Creating the index 03/13/2025, 16:45:14
2025-03-13 16:45:14,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:14
2025-03-13 16:45:14,415 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:45:14,416 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:14
2025-03-13 16:45:14,416 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:45:14,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.97it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.75it/s]100%|██████████| 8/8 [00:01<00:00,  5.36it/s]
2025-03-13 16:45:15,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:15
2025-03-13 16:45:39,094 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1809 secs
2025-03-13 16:45:39,094 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 16:45:39,094 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.81it/s]
2025-03-13 16:46:07,805 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7103 secs
2025-03-13 16:46:07,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3910 secs
2025-03-13 16:46:07,807 [INFO]: {
2025-03-13 16:46:07,807 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:07,807 [INFO]: 	index_param: efSearch=210
2025-03-13 16:46:07,807 [INFO]: 	index_path: knn.index
2025-03-13 16:46:07,807 [INFO]: 	size in bytes: 386995450
2025-03-13 16:46:07,807 [INFO]: 	avg_search_speed_ms: 12.10499415934275
2025-03-13 16:46:07,807 [INFO]: 	99p_search_speed_ms: 19.718307033181194
2025-03-13 16:46:07,807 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:07,807 [INFO]: 	nb vectors: 1967
2025-03-13 16:46:07,807 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:07,807 [INFO]: 	compression ratio: 0.9993087412268026
2025-03-13 16:46:07,807 [INFO]: }
2025-03-13 16:46:07,807 [INFO]: 	>>> Finished "Creating the index" in 53.3925 secs
2025-03-13 16:46:07,807 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4205 secs
2025-03-13 16:46:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 100126 [episode count 7/20]
[retrieval_preprocessing] for episode 100127 [episode count 8/20], we have num_retrieval=np.int64(1957) num_query=np.int64(79)
2025-03-13 16:46:08,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:09,154 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:09
2025-03-13 16:46:09,155 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.62it/s]
2025-03-13 16:46:09,193 [INFO]: There are 1957 embeddings of dim 49152
2025-03-13 16:46:09,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 16:46:09,193 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:09
2025-03-13 16:46:09,193 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:09,193 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:46:09,193 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:09,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:09,193 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:09
2025-03-13 16:46:09,194 [INFO]: 403.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:09,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:46:09,194 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:09
2025-03-13 16:46:09,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:09,194 [INFO]: 	Creating the index 03/13/2025, 16:46:09
2025-03-13 16:46:09,194 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:09
2025-03-13 16:46:09,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:46:09,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:09
2025-03-13 16:46:09,195 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:46:09,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.88it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.78it/s]100%|██████████| 8/8 [00:02<00:00,  3.75it/s]
2025-03-13 16:46:11,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:11
2025-03-13 16:46:39,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1814 secs
2025-03-13 16:46:39,031 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 16:46:39,031 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.72it/s]
2025-03-13 16:47:01,500 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4690 secs
2025-03-13 16:47:01,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3061 secs
2025-03-13 16:47:01,502 [INFO]: {
2025-03-13 16:47:01,502 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:01,502 [INFO]: 	index_param: efSearch=191
2025-03-13 16:47:01,502 [INFO]: 	index_path: knn.index
2025-03-13 16:47:01,502 [INFO]: 	size in bytes: 385028050
2025-03-13 16:47:01,502 [INFO]: 	avg_search_speed_ms: 9.15099813433301
2025-03-13 16:47:01,502 [INFO]: 	99p_search_speed_ms: 12.602824838832015
2025-03-13 16:47:01,502 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:01,502 [INFO]: 	nb vectors: 1957
2025-03-13 16:47:01,502 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:01,502 [INFO]: 	compression ratio: 0.9993086373836919
2025-03-13 16:47:01,502 [INFO]: }
2025-03-13 16:47:01,502 [INFO]: 	>>> Finished "Creating the index" in 52.3080 secs
2025-03-13 16:47:01,502 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3472 secs
2025-03-13 16:47:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 100127 [episode count 8/20]
[retrieval_preprocessing] for episode 100128 [episode count 9/20], we have num_retrieval=np.int64(1959) num_query=np.int64(77)
2025-03-13 16:47:02,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:02,593 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:02
2025-03-13 16:47:02,593 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2000.14it/s]
2025-03-13 16:47:02,618 [INFO]: There are 1959 embeddings of dim 49152
2025-03-13 16:47:02,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 16:47:02,618 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:02
2025-03-13 16:47:02,618 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:02,618 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:47:02,618 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:02,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:02,618 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:02
2025-03-13 16:47:02,619 [INFO]: 404.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:02,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:47:02,619 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:02
2025-03-13 16:47:02,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:02,619 [INFO]: 	Creating the index 03/13/2025, 16:47:02
2025-03-13 16:47:02,619 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:02
2025-03-13 16:47:02,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:47:02,620 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:02
2025-03-13 16:47:02,620 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:47:02,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.46it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.79it/s]100%|██████████| 8/8 [00:01<00:00,  4.87it/s]
2025-03-13 16:47:04,266 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:04
2025-03-13 16:47:30,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6924 secs
2025-03-13 16:47:30,960 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:47:30,960 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.15it/s]
2025-03-13 16:47:54,839 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8793 secs
2025-03-13 16:47:54,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2218 secs
2025-03-13 16:47:54,842 [INFO]: {
2025-03-13 16:47:54,842 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:54,842 [INFO]: 	index_param: efSearch=197
2025-03-13 16:47:54,842 [INFO]: 	index_path: knn.index
2025-03-13 16:47:54,842 [INFO]: 	size in bytes: 385421530
2025-03-13 16:47:54,842 [INFO]: 	avg_search_speed_ms: 10.817183809153534
2025-03-13 16:47:54,842 [INFO]: 	99p_search_speed_ms: 15.435064416378735
2025-03-13 16:47:54,842 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:54,842 [INFO]: 	nb vectors: 1959
2025-03-13 16:47:54,842 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:54,842 [INFO]: 	compression ratio: 0.9993086582371254
2025-03-13 16:47:54,842 [INFO]: }
2025-03-13 16:47:54,842 [INFO]: 	>>> Finished "Creating the index" in 52.2233 secs
2025-03-13 16:47:54,842 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2487 secs
2025-03-13 16:47:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 100128 [episode count 9/20]
[retrieval_preprocessing] for episode 100129 [episode count 10/20], we have num_retrieval=np.int64(1956) num_query=np.int64(80)
2025-03-13 16:47:55,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:56,265 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:56
2025-03-13 16:47:56,266 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]
2025-03-13 16:47:56,301 [INFO]: There are 1956 embeddings of dim 49152
2025-03-13 16:47:56,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 16:47:56,301 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:56
2025-03-13 16:47:56,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:56,301 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:47:56,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:56,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:56,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:56
2025-03-13 16:47:56,301 [INFO]: 403.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:56,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:47:56,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:56
2025-03-13 16:47:56,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:56,301 [INFO]: 	Creating the index 03/13/2025, 16:47:56
2025-03-13 16:47:56,302 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:56
2025-03-13 16:47:56,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:47:56,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:56
2025-03-13 16:47:56,303 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:47:56,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.35it/s] 62%|██████▎   | 5/8 [00:00<00:00, 24.74it/s]100%|██████████| 8/8 [00:02<00:00,  3.19it/s]100%|██████████| 8/8 [00:02<00:00,  3.87it/s]
2025-03-13 16:47:58,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:58
2025-03-13 16:48:31,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9946 secs
2025-03-13 16:48:31,369 [INFO]: The best hyperparameters are: efSearch=98
2025-03-13 16:48:31,369 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 16:48:49,318 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9491 secs
2025-03-13 16:48:49,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0171 secs
2025-03-13 16:48:49,320 [INFO]: {
2025-03-13 16:48:49,320 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:49,320 [INFO]: 	index_param: efSearch=98
2025-03-13 16:48:49,320 [INFO]: 	index_path: knn.index
2025-03-13 16:48:49,320 [INFO]: 	size in bytes: 384831310
2025-03-13 16:48:49,320 [INFO]: 	avg_search_speed_ms: 6.950501872936422
2025-03-13 16:48:49,320 [INFO]: 	99p_search_speed_ms: 10.03218246391043
2025-03-13 16:48:49,320 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:49,320 [INFO]: 	nb vectors: 1956
2025-03-13 16:48:49,320 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:49,320 [INFO]: 	compression ratio: 0.9993086269409835
2025-03-13 16:48:49,320 [INFO]: }
2025-03-13 16:48:49,320 [INFO]: 	>>> Finished "Creating the index" in 53.0186 secs
2025-03-13 16:48:49,320 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0546 secs
2025-03-13 16:48:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 100129 [episode count 10/20]
[retrieval_preprocessing] for episode 100130 [episode count 11/20], we have num_retrieval=np.int64(1954) num_query=np.int64(82)
2025-03-13 16:48:50,393 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:50,666 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:50
2025-03-13 16:48:50,667 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.96it/s]
2025-03-13 16:48:50,695 [INFO]: There are 1954 embeddings of dim 49152
2025-03-13 16:48:50,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 16:48:50,696 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:50
2025-03-13 16:48:50,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:50,696 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:48:50,696 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:50,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:50,696 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:50
2025-03-13 16:48:50,696 [INFO]: 403.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:50,696 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:48:50,696 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:50
2025-03-13 16:48:50,696 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:50,696 [INFO]: 	Creating the index 03/13/2025, 16:48:50
2025-03-13 16:48:50,696 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:50
2025-03-13 16:48:50,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:48:50,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:50
2025-03-13 16:48:50,698 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:48:50,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.33it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.20it/s]100%|██████████| 8/8 [00:01<00:00,  4.25it/s]
2025-03-13 16:48:52,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:52
2025-03-13 16:49:19,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7579 secs
2025-03-13 16:49:19,341 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:49:19,341 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-13 16:49:37,992 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6509 secs
2025-03-13 16:49:37,994 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2960 secs
2025-03-13 16:49:37,994 [INFO]: {
2025-03-13 16:49:37,994 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:37,994 [INFO]: 	index_param: efSearch=185
2025-03-13 16:49:37,994 [INFO]: 	index_path: knn.index
2025-03-13 16:49:37,994 [INFO]: 	size in bytes: 384437830
2025-03-13 16:49:37,994 [INFO]: 	avg_search_speed_ms: 10.097605798874655
2025-03-13 16:49:37,994 [INFO]: 	99p_search_speed_ms: 16.73491804394871
2025-03-13 16:49:37,994 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:37,994 [INFO]: 	nb vectors: 1954
2025-03-13 16:49:37,994 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:37,994 [INFO]: 	compression ratio: 0.9993086060235019
2025-03-13 16:49:37,994 [INFO]: }
2025-03-13 16:49:37,994 [INFO]: 	>>> Finished "Creating the index" in 47.2975 secs
2025-03-13 16:49:37,994 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3273 secs
2025-03-13 16:49:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 100130 [episode count 11/20]
[retrieval_preprocessing] for episode 100131 [episode count 12/20], we have num_retrieval=np.int64(1960) num_query=np.int64(76)
2025-03-13 16:49:38,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:39,119 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:39
2025-03-13 16:49:39,119 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2061.08it/s]
2025-03-13 16:49:39,149 [INFO]: There are 1960 embeddings of dim 49152
2025-03-13 16:49:39,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 16:49:39,149 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:39
2025-03-13 16:49:39,149 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:39,149 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:49:39,149 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:39,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:49:39,150 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:39
2025-03-13 16:49:39,150 [INFO]: 404.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:39,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:49:39,150 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:39
2025-03-13 16:49:39,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:39,150 [INFO]: 	Creating the index 03/13/2025, 16:49:39
2025-03-13 16:49:39,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:39
2025-03-13 16:49:39,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:49:39,151 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:39
2025-03-13 16:49:39,151 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:49:39,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.07it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.46it/s]100%|██████████| 8/8 [00:01<00:00,  5.44it/s]
2025-03-13 16:49:40,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:40
2025-03-13 16:50:02,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.8738 secs
2025-03-13 16:50:02,499 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 16:50:02,499 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.25it/s]
2025-03-13 16:50:35,792 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2928 secs
2025-03-13 16:50:35,795 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6443 secs
2025-03-13 16:50:35,796 [INFO]: {
2025-03-13 16:50:35,796 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:35,796 [INFO]: 	index_param: efSearch=274
2025-03-13 16:50:35,796 [INFO]: 	index_path: knn.index
2025-03-13 16:50:35,796 [INFO]: 	size in bytes: 385618270
2025-03-13 16:50:35,796 [INFO]: 	avg_search_speed_ms: 12.091382258845337
2025-03-13 16:50:35,796 [INFO]: 	99p_search_speed_ms: 17.417032597586516
2025-03-13 16:50:35,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:35,796 [INFO]: 	nb vectors: 1960
2025-03-13 16:50:35,796 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:35,796 [INFO]: 	compression ratio: 0.9993086686478833
2025-03-13 16:50:35,796 [INFO]: }
2025-03-13 16:50:35,796 [INFO]: 	>>> Finished "Creating the index" in 56.6463 secs
2025-03-13 16:50:35,796 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6774 secs
2025-03-13 16:50:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 100131 [episode count 12/20]
[retrieval_preprocessing] for episode 100132 [episode count 13/20], we have num_retrieval=np.int64(1926) num_query=np.int64(110)
2025-03-13 16:50:36,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:37,343 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:37
2025-03-13 16:50:37,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.76it/s]
2025-03-13 16:50:37,374 [INFO]: There are 1926 embeddings of dim 49152
2025-03-13 16:50:37,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:50:37,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:37,375 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:50:37,375 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:37,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:50:37,375 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,375 [INFO]: 397.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:37,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:50:37,375 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:37
2025-03-13 16:50:37,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:37,376 [INFO]: 	Creating the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,376 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:37
2025-03-13 16:50:37,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 16:50:37,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,377 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:50:37,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.31it/s]100%|██████████| 8/8 [00:01<00:00,  5.16it/s]100%|██████████| 8/8 [00:01<00:00,  5.66it/s]
2025-03-13 16:50:38,794 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:38
2025-03-13 16:51:08,033 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2387 secs
2025-03-13 16:51:08,033 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:51:08,033 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-13 16:51:28,299 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2657 secs
2025-03-13 16:51:28,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9235 secs
2025-03-13 16:51:28,301 [INFO]: {
2025-03-13 16:51:28,301 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:28,301 [INFO]: 	index_param: efSearch=157
2025-03-13 16:51:28,301 [INFO]: 	index_path: knn.index
2025-03-13 16:51:28,301 [INFO]: 	size in bytes: 378928990
2025-03-13 16:51:28,301 [INFO]: 	avg_search_speed_ms: 9.27387574836197
2025-03-13 16:51:28,301 [INFO]: 	99p_search_speed_ms: 12.69364192383364
2025-03-13 16:51:28,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:28,301 [INFO]: 	nb vectors: 1926
2025-03-13 16:51:28,301 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:28,301 [INFO]: 	compression ratio: 0.9993086250803878
2025-03-13 16:51:28,301 [INFO]: }
2025-03-13 16:51:28,301 [INFO]: 	>>> Finished "Creating the index" in 50.9259 secs
2025-03-13 16:51:28,301 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9587 secs
2025-03-13 16:51:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 100132 [episode count 13/20]
[retrieval_preprocessing] for episode 100133 [episode count 14/20], we have num_retrieval=np.int64(1933) num_query=np.int64(103)
2025-03-13 16:51:29,471 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:31,141 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:31
2025-03-13 16:51:31,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1321.04it/s]
2025-03-13 16:51:31,176 [INFO]: There are 1933 embeddings of dim 49152
2025-03-13 16:51:31,176 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 16:51:31,176 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:31
2025-03-13 16:51:31,177 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:31,177 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:51:31,177 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:31,177 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:51:31,177 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:31
2025-03-13 16:51:31,177 [INFO]: 398.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:31,177 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:51:31,178 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:31
2025-03-13 16:51:31,178 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:31,178 [INFO]: 	Creating the index 03/13/2025, 16:51:31
2025-03-13 16:51:31,178 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:31
2025-03-13 16:51:31,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:51:31,181 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:31
2025-03-13 16:51:31,181 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:51:31,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.63it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.96it/s]100%|██████████| 8/8 [00:02<00:00,  3.63it/s]
2025-03-13 16:51:33,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:33
2025-03-13 16:52:00,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1387 secs
2025-03-13 16:52:00,529 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 16:52:00,529 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.07it/s]
2025-03-13 16:52:13,648 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1193 secs
2025-03-13 16:52:13,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4701 secs
2025-03-13 16:52:13,651 [INFO]: {
2025-03-13 16:52:13,651 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:13,651 [INFO]: 	index_param: efSearch=151
2025-03-13 16:52:13,651 [INFO]: 	index_path: knn.index
2025-03-13 16:52:13,651 [INFO]: 	size in bytes: 380306290
2025-03-13 16:52:13,651 [INFO]: 	avg_search_speed_ms: 10.608177428644384
2025-03-13 16:52:13,651 [INFO]: 	99p_search_speed_ms: 19.885034202598046
2025-03-13 16:52:13,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:13,651 [INFO]: 	nb vectors: 1933
2025-03-13 16:52:13,651 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:13,651 [INFO]: 	compression ratio: 0.9993083837766659
2025-03-13 16:52:13,651 [INFO]: }
2025-03-13 16:52:13,651 [INFO]: 	>>> Finished "Creating the index" in 42.4735 secs
2025-03-13 16:52:13,651 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5101 secs
2025-03-13 16:52:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100133 [episode count 14/20]
[retrieval_preprocessing] for episode 100134 [episode count 15/20], we have num_retrieval=np.int64(1943) num_query=np.int64(93)
2025-03-13 16:52:15,067 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:15,498 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:15
2025-03-13 16:52:15,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.76it/s]
2025-03-13 16:52:15,540 [INFO]: There are 1943 embeddings of dim 49152
2025-03-13 16:52:15,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 16:52:15,540 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:15
2025-03-13 16:52:15,540 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:15,540 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:52:15,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:15,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:52:15,541 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:15
2025-03-13 16:52:15,541 [INFO]: 401.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:15,541 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:52:15,541 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:15
2025-03-13 16:52:15,541 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:15,541 [INFO]: 	Creating the index 03/13/2025, 16:52:15
2025-03-13 16:52:15,541 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:15
2025-03-13 16:52:15,542 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:52:15,542 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:15
2025-03-13 16:52:15,542 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:52:15,542 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.71it/s] 62%|██████▎   | 5/8 [00:00<00:00, 23.01it/s]100%|██████████| 8/8 [00:02<00:00,  2.69it/s]100%|██████████| 8/8 [00:02<00:00,  3.29it/s]
2025-03-13 16:52:18,753 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:18
2025-03-13 16:52:47,976 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2229 secs
2025-03-13 16:52:47,976 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 16:52:47,976 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 16:53:17,337 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3603 secs
2025-03-13 16:53:17,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7965 secs
2025-03-13 16:53:17,339 [INFO]: {
2025-03-13 16:53:17,339 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:17,339 [INFO]: 	index_param: efSearch=246
2025-03-13 16:53:17,339 [INFO]: 	index_path: knn.index
2025-03-13 16:53:17,339 [INFO]: 	size in bytes: 382273690
2025-03-13 16:53:17,339 [INFO]: 	avg_search_speed_ms: 11.698852553527955
2025-03-13 16:53:17,339 [INFO]: 	99p_search_speed_ms: 18.04785012733193
2025-03-13 16:53:17,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:17,339 [INFO]: 	nb vectors: 1943
2025-03-13 16:53:17,339 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:17,339 [INFO]: 	compression ratio: 0.9993084902076311
2025-03-13 16:53:17,339 [INFO]: }
2025-03-13 16:53:17,339 [INFO]: 	>>> Finished "Creating the index" in 61.7981 secs
2025-03-13 16:53:17,339 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8414 secs
2025-03-13 16:53:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 100134 [episode count 15/20]
[retrieval_preprocessing] for episode 100135 [episode count 16/20], we have num_retrieval=np.int64(1905) num_query=np.int64(131)
2025-03-13 16:53:18,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:18,951 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:18
2025-03-13 16:53:18,951 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 903.56it/s]
2025-03-13 16:53:18,985 [INFO]: There are 1905 embeddings of dim 49152
2025-03-13 16:53:18,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 16:53:18,986 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:18
2025-03-13 16:53:18,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:18,986 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:53:18,986 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:18,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:18,986 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:18
2025-03-13 16:53:18,986 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:18,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:53:18,986 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:18
2025-03-13 16:53:18,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:18,986 [INFO]: 	Creating the index 03/13/2025, 16:53:18
2025-03-13 16:53:18,986 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:18
2025-03-13 16:53:18,988 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:53:18,988 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:18
2025-03-13 16:53:18,988 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:53:18,988 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.99it/s] 62%|██████▎   | 5/8 [00:00<00:00, 27.06it/s]100%|██████████| 8/8 [00:01<00:00,  3.78it/s]100%|██████████| 8/8 [00:01<00:00,  4.58it/s]
2025-03-13 16:53:20,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:20
2025-03-13 16:53:46,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1819 secs
2025-03-13 16:53:46,921 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:53:46,921 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.26it/s] 50%|█████     | 2/4 [00:00<00:00,  4.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.80it/s]
2025-03-13 16:54:11,053 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1317 secs
2025-03-13 16:54:11,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0676 secs
2025-03-13 16:54:11,056 [INFO]: {
2025-03-13 16:54:11,056 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:11,056 [INFO]: 	index_param: efSearch=179
2025-03-13 16:54:11,056 [INFO]: 	index_path: knn.index
2025-03-13 16:54:11,056 [INFO]: 	size in bytes: 374797450
2025-03-13 16:54:11,056 [INFO]: 	avg_search_speed_ms: 13.169092164791532
2025-03-13 16:54:11,056 [INFO]: 	99p_search_speed_ms: 21.219972160179168
2025-03-13 16:54:11,056 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:11,056 [INFO]: 	nb vectors: 1905
2025-03-13 16:54:11,056 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:11,056 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 16:54:11,056 [INFO]: }
2025-03-13 16:54:11,056 [INFO]: 	>>> Finished "Creating the index" in 52.0694 secs
2025-03-13 16:54:11,056 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1051 secs
2025-03-13 16:54:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 100135 [episode count 16/20]
[retrieval_preprocessing] for episode 100136 [episode count 17/20], we have num_retrieval=np.int64(1953) num_query=np.int64(83)
2025-03-13 16:54:12,657 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:13,028 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:13
2025-03-13 16:54:13,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1273.70it/s]
2025-03-13 16:54:13,065 [INFO]: There are 1953 embeddings of dim 49152
2025-03-13 16:54:13,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 16:54:13,066 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:13
2025-03-13 16:54:13,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:13,067 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:54:13,067 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:13,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 16:54:13,067 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:13
2025-03-13 16:54:13,068 [INFO]: 403.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:13,068 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:54:13,068 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:13
2025-03-13 16:54:13,068 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:13,069 [INFO]: 	Creating the index 03/13/2025, 16:54:13
2025-03-13 16:54:13,069 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:13
2025-03-13 16:54:13,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:54:13,072 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:13
2025-03-13 16:54:13,072 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:54:13,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.08it/s] 75%|███████▌  | 6/8 [00:00<00:00, 28.88it/s]100%|██████████| 8/8 [00:01<00:00,  4.38it/s]
2025-03-13 16:54:14,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:14
2025-03-13 16:54:41,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7929 secs
2025-03-13 16:54:41,700 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 16:54:41,700 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 16:54:59,420 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7196 secs
2025-03-13 16:54:59,421 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3493 secs
2025-03-13 16:54:59,422 [INFO]: {
2025-03-13 16:54:59,422 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:59,422 [INFO]: 	index_param: efSearch=166
2025-03-13 16:54:59,422 [INFO]: 	index_path: knn.index
2025-03-13 16:54:59,422 [INFO]: 	size in bytes: 384241090
2025-03-13 16:54:59,422 [INFO]: 	avg_search_speed_ms: 9.533375219750024
2025-03-13 16:54:59,422 [INFO]: 	99p_search_speed_ms: 13.604167820885777
2025-03-13 16:54:59,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:59,422 [INFO]: 	nb vectors: 1953
2025-03-13 16:54:59,422 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:59,422 [INFO]: 	compression ratio: 0.9993085955486958
2025-03-13 16:54:59,422 [INFO]: }
2025-03-13 16:54:59,422 [INFO]: 	>>> Finished "Creating the index" in 46.3532 secs
2025-03-13 16:54:59,422 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3941 secs
2025-03-13 16:54:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 100136 [episode count 17/20]
[retrieval_preprocessing] for episode 100137 [episode count 18/20], we have num_retrieval=np.int64(1946) num_query=np.int64(90)
2025-03-13 16:55:00,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:01,169 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:01
2025-03-13 16:55:01,169 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1611.33it/s]
2025-03-13 16:55:01,200 [INFO]: There are 1946 embeddings of dim 49152
2025-03-13 16:55:01,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 16:55:01,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:01
2025-03-13 16:55:01,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:01,201 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:55:01,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:01,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:55:01,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:01
2025-03-13 16:55:01,201 [INFO]: 401.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:01,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:55:01,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:01
2025-03-13 16:55:01,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:01,201 [INFO]: 	Creating the index 03/13/2025, 16:55:01
2025-03-13 16:55:01,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:01
2025-03-13 16:55:01,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:55:01,202 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:01
2025-03-13 16:55:01,202 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:55:01,202 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.92it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.58it/s]100%|██████████| 8/8 [00:01<00:00,  4.47it/s]
2025-03-13 16:55:02,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:02
2025-03-13 16:55:28,138 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1402 secs
2025-03-13 16:55:28,138 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 16:55:28,138 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.77it/s]
2025-03-13 16:55:50,807 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6688 secs
2025-03-13 16:55:50,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6059 secs
2025-03-13 16:55:50,808 [INFO]: {
2025-03-13 16:55:50,808 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:50,808 [INFO]: 	index_param: efSearch=194
2025-03-13 16:55:50,808 [INFO]: 	index_path: knn.index
2025-03-13 16:55:50,808 [INFO]: 	size in bytes: 382863910
2025-03-13 16:55:50,808 [INFO]: 	avg_search_speed_ms: 8.988115817278302
2025-03-13 16:55:50,808 [INFO]: 	99p_search_speed_ms: 12.96262065879998
2025-03-13 16:55:50,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:50,808 [INFO]: 	nb vectors: 1946
2025-03-13 16:55:50,808 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:50,808 [INFO]: 	compression ratio: 0.9993085219236255
2025-03-13 16:55:50,808 [INFO]: }
2025-03-13 16:55:50,808 [INFO]: 	>>> Finished "Creating the index" in 49.6073 secs
2025-03-13 16:55:50,808 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6392 secs
2025-03-13 16:55:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 100137 [episode count 18/20]
[retrieval_preprocessing] for episode 100138 [episode count 19/20], we have num_retrieval=np.int64(1779) num_query=np.int64(257)
2025-03-13 16:55:51,581 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:51,795 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:51
2025-03-13 16:55:51,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2240.55it/s]
2025-03-13 16:55:51,821 [INFO]: There are 1779 embeddings of dim 49152
2025-03-13 16:55:51,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 16:55:51,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:51
2025-03-13 16:55:51,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:51,821 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:55:51,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:51,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:55:51,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:51
2025-03-13 16:55:51,821 [INFO]: 367.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:51,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:55:51,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:51
2025-03-13 16:55:51,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:51,821 [INFO]: 	Creating the index 03/13/2025, 16:55:51
2025-03-13 16:55:51,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:51
2025-03-13 16:55:51,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:55:51,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:51
2025-03-13 16:55:51,822 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:55:51,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.66it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.83it/s]100%|██████████| 8/8 [00:01<00:00,  6.14it/s]
2025-03-13 16:55:53,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:53
2025-03-13 16:56:14,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.3974 secs
2025-03-13 16:56:14,527 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 16:56:14,527 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.90it/s]
2025-03-13 16:56:41,932 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4057 secs
2025-03-13 16:56:42,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2403 secs
2025-03-13 16:56:42,063 [INFO]: {
2025-03-13 16:56:42,063 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:42,063 [INFO]: 	index_param: efSearch=258
2025-03-13 16:56:42,063 [INFO]: 	index_path: knn.index
2025-03-13 16:56:42,063 [INFO]: 	size in bytes: 350007610
2025-03-13 16:56:42,063 [INFO]: 	avg_search_speed_ms: 9.881311967065226
2025-03-13 16:56:42,064 [INFO]: 	99p_search_speed_ms: 15.426225587725638
2025-03-13 16:56:42,064 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:42,064 [INFO]: 	nb vectors: 1779
2025-03-13 16:56:42,064 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:42,064 [INFO]: 	compression ratio: 0.9993086493176534
2025-03-13 16:56:42,064 [INFO]: }
2025-03-13 16:56:42,064 [INFO]: 	>>> Finished "Creating the index" in 50.2423 secs
2025-03-13 16:56:42,064 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2688 secs
2025-03-13 16:56:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 100138 [episode count 19/20]
2025-03-13 16:56:44: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_orange_in_the_bowl_and_move_it_to_the_other_container [chosen_id count 6/8]
2025-03-13 16:56:45: [retrieval_preprocessing] concatenated all embeddings and indices for 7 episodes for collected_demos_training/2025-03-10_pour_the_contents_of_the_cup_into_the_bowl [chosen_id count 7/8]
2025-03-13 16:56:45: [retrieval_preprocessing] we have num_total=2224 embedding_dim=49152
[retrieval_preprocessing] for episode 100139 [episode count 0/7], we have num_retrieval=np.int64(1849) num_query=np.int64(375)
2025-03-13 16:56:45,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:46,005 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:46
2025-03-13 16:56:46,005 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-13 16:56:46,037 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 16:56:46,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 16:56:46,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:46
2025-03-13 16:56:46,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:46,038 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:56:46,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:46,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:56:46,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:46
2025-03-13 16:56:46,038 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:46,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:56:46,038 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:46
2025-03-13 16:56:46,038 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:46,038 [INFO]: 	Creating the index 03/13/2025, 16:56:46
2025-03-13 16:56:46,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:46
2025-03-13 16:56:46,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:56:46,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:46
2025-03-13 16:56:46,039 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:56:46,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.92it/s]100%|██████████| 8/8 [00:01<00:00,  5.58it/s]100%|██████████| 8/8 [00:01<00:00,  5.88it/s]
2025-03-13 16:56:47,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:47
2025-03-13 16:57:20,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6719 secs
2025-03-13 16:57:20,076 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 16:57:20,076 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.44it/s] 50%|█████     | 2/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.58it/s]
2025-03-13 16:57:35,219 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1425 secs
2025-03-13 16:57:35,221 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1819 secs
2025-03-13 16:57:35,221 [INFO]: {
2025-03-13 16:57:35,221 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:35,221 [INFO]: 	index_param: efSearch=174
2025-03-13 16:57:35,222 [INFO]: 	index_path: knn.index
2025-03-13 16:57:35,222 [INFO]: 	size in bytes: 363779470
2025-03-13 16:57:35,222 [INFO]: 	avg_search_speed_ms: 12.319806824137773
2025-03-13 16:57:35,222 [INFO]: 	99p_search_speed_ms: 17.295183255337175
2025-03-13 16:57:35,222 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:35,222 [INFO]: 	nb vectors: 1849
2025-03-13 16:57:35,222 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:35,222 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 16:57:35,222 [INFO]: }
2025-03-13 16:57:35,222 [INFO]: 	>>> Finished "Creating the index" in 49.1835 secs
2025-03-13 16:57:35,222 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2162 secs
2025-03-13 16:57:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 100139 [episode count 0/7]
[retrieval_preprocessing] for episode 100140 [episode count 1/7], we have num_retrieval=np.int64(1952) num_query=np.int64(272)
2025-03-13 16:57:40,411 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:40,858 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:40
2025-03-13 16:57:40,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.63it/s]
2025-03-13 16:57:40,902 [INFO]: There are 1952 embeddings of dim 49152
2025-03-13 16:57:40,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0446 secs
2025-03-13 16:57:40,903 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:40
2025-03-13 16:57:40,903 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:40,904 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:57:40,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:40,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:57:40,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:40
2025-03-13 16:57:40,905 [INFO]: 402.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:40,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:57:40,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:40
2025-03-13 16:57:40,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:40,905 [INFO]: 	Creating the index 03/13/2025, 16:57:40
2025-03-13 16:57:40,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:40
2025-03-13 16:57:40,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:57:40,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:40
2025-03-13 16:57:40,910 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:57:40,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.69it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.67it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.86it/s] 50%|█████     | 4/8 [00:00<00:00,  8.01it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.23it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.50it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.63it/s]100%|██████████| 8/8 [00:02<00:00,  1.44it/s]100%|██████████| 8/8 [00:02<00:00,  2.87it/s]
2025-03-13 16:57:43,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:43
2025-03-13 16:58:12,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1027 secs
2025-03-13 16:58:12,809 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 16:58:12,809 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 50%|█████     | 2/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 16:58:31,501 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6917 secs
2025-03-13 16:58:31,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5935 secs
2025-03-13 16:58:31,503 [INFO]: {
2025-03-13 16:58:31,503 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:31,503 [INFO]: 	index_param: efSearch=252
2025-03-13 16:58:31,503 [INFO]: 	index_path: knn.index
2025-03-13 16:58:31,503 [INFO]: 	size in bytes: 384044350
2025-03-13 16:58:31,503 [INFO]: 	avg_search_speed_ms: 9.381465763019618
2025-03-13 16:58:31,503 [INFO]: 	99p_search_speed_ms: 17.044012423139055
2025-03-13 16:58:31,503 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:31,503 [INFO]: 	nb vectors: 1952
2025-03-13 16:58:31,503 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:31,503 [INFO]: 	compression ratio: 0.9993085850631575
2025-03-13 16:58:31,503 [INFO]: }
2025-03-13 16:58:31,503 [INFO]: 	>>> Finished "Creating the index" in 50.5977 secs
2025-03-13 16:58:31,503 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6452 secs
2025-03-13 16:58:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 100140 [episode count 1/7]
[retrieval_preprocessing] for episode 100141 [episode count 2/7], we have num_retrieval=np.int64(1780) num_query=np.int64(444)
2025-03-13 16:58:35,132 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:35,425 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:35
2025-03-13 16:58:35,425 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1426.15it/s]
2025-03-13 16:58:35,449 [INFO]: There are 1780 embeddings of dim 49152
2025-03-13 16:58:35,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 16:58:35,449 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:35
2025-03-13 16:58:35,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:35,449 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 16:58:35,449 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:35,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:35,449 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:35
2025-03-13 16:58:35,450 [INFO]: 367.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:35,450 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:58:35,450 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:35
2025-03-13 16:58:35,450 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:35,450 [INFO]: 	Creating the index 03/13/2025, 16:58:35
2025-03-13 16:58:35,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:35
2025-03-13 16:58:35,451 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:58:35,451 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:35
2025-03-13 16:58:35,451 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:58:35,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.64it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.26it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.48it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.11it/s]100%|██████████| 8/8 [00:01<00:00,  4.85it/s]
2025-03-13 16:58:37,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:37
2025-03-13 16:58:58,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.1884 secs
2025-03-13 16:58:58,295 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 16:58:58,295 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 16:59:20,954 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6580 secs
2025-03-13 16:59:20,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5045 secs
2025-03-13 16:59:20,955 [INFO]: {
2025-03-13 16:59:20,955 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:20,955 [INFO]: 	index_param: efSearch=301
2025-03-13 16:59:20,955 [INFO]: 	index_path: knn.index
2025-03-13 16:59:20,955 [INFO]: 	size in bytes: 350204350
2025-03-13 16:59:20,955 [INFO]: 	avg_search_speed_ms: 9.768112130586815
2025-03-13 16:59:20,956 [INFO]: 	99p_search_speed_ms: 13.925875548738986
2025-03-13 16:59:20,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:20,956 [INFO]: 	nb vectors: 1780
2025-03-13 16:59:20,956 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:20,956 [INFO]: 	compression ratio: 0.9993086607861953
2025-03-13 16:59:20,956 [INFO]: }
2025-03-13 16:59:20,956 [INFO]: 	>>> Finished "Creating the index" in 45.5059 secs
2025-03-13 16:59:20,956 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5308 secs
2025-03-13 16:59:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 100141 [episode count 2/7]
[retrieval_preprocessing] for episode 100142 [episode count 3/7], we have num_retrieval=np.int64(1956) num_query=np.int64(268)
2025-03-13 16:59:26,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:26,772 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:26
2025-03-13 16:59:26,772 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.05it/s]
2025-03-13 16:59:26,800 [INFO]: There are 1956 embeddings of dim 49152
2025-03-13 16:59:26,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 16:59:26,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:26
2025-03-13 16:59:26,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:26,800 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:59:26,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:26,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:26,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:26
2025-03-13 16:59:26,800 [INFO]: 403.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:26,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:26,800 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:26
2025-03-13 16:59:26,800 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:26,800 [INFO]: 	Creating the index 03/13/2025, 16:59:26
2025-03-13 16:59:26,800 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:26
2025-03-13 16:59:26,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:59:26,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:26
2025-03-13 16:59:26,802 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:59:26,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.21it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.81it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.57it/s] 50%|█████     | 4/8 [00:00<00:00,  8.10it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.29it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.39it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.41it/s]100%|██████████| 8/8 [00:02<00:00,  2.09it/s]100%|██████████| 8/8 [00:02<00:00,  3.75it/s]
2025-03-13 16:59:28,939 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:28
2025-03-13 16:59:52,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4974 secs
2025-03-13 16:59:52,437 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 16:59:52,437 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 17:00:10,946 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5095 secs
2025-03-13 17:00:10,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1468 secs
2025-03-13 17:00:10,949 [INFO]: {
2025-03-13 17:00:10,949 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:10,949 [INFO]: 	index_param: efSearch=271
2025-03-13 17:00:10,949 [INFO]: 	index_path: knn.index
2025-03-13 17:00:10,949 [INFO]: 	size in bytes: 384831310
2025-03-13 17:00:10,949 [INFO]: 	avg_search_speed_ms: 10.403900638147103
2025-03-13 17:00:10,949 [INFO]: 	99p_search_speed_ms: 20.12102995067835
2025-03-13 17:00:10,949 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:10,949 [INFO]: 	nb vectors: 1956
2025-03-13 17:00:10,949 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:10,949 [INFO]: 	compression ratio: 0.9993086269409835
2025-03-13 17:00:10,949 [INFO]: }
2025-03-13 17:00:10,949 [INFO]: 	>>> Finished "Creating the index" in 44.1486 secs
2025-03-13 17:00:10,949 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1772 secs
2025-03-13 17:00:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 100142 [episode count 3/7]
[retrieval_preprocessing] for episode 100143 [episode count 4/7], we have num_retrieval=np.int64(2039) num_query=np.int64(185)
2025-03-13 17:00:15,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:15,679 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:15
2025-03-13 17:00:15,679 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.57it/s]
2025-03-13 17:00:15,707 [INFO]: There are 2039 embeddings of dim 49152
2025-03-13 17:00:15,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:00:15,707 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:15
2025-03-13 17:00:15,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:15,708 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:00:15,708 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:15,708 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:15,708 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:15
2025-03-13 17:00:15,708 [INFO]: 420.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:15,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:00:15,708 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:15
2025-03-13 17:00:15,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:15,708 [INFO]: 	Creating the index 03/13/2025, 17:00:15
2025-03-13 17:00:15,708 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:15
2025-03-13 17:00:15,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:00:15,709 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:15
2025-03-13 17:00:15,709 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:00:15,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.34it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.14it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.86it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.14it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]100%|██████████| 9/9 [00:02<00:00,  4.23it/s]
2025-03-13 17:00:17,841 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:17
2025-03-13 17:00:42,142 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3012 secs
2025-03-13 17:00:42,143 [INFO]: The best hyperparameters are: efSearch=102
2025-03-13 17:00:42,143 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.82it/s]
2025-03-13 17:01:04,666 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5229 secs
2025-03-13 17:01:04,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9593 secs
2025-03-13 17:01:04,669 [INFO]: {
2025-03-13 17:01:04,669 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:04,669 [INFO]: 	index_param: efSearch=102
2025-03-13 17:01:04,669 [INFO]: 	index_path: knn.index
2025-03-13 17:01:04,669 [INFO]: 	size in bytes: 401161030
2025-03-13 17:01:04,669 [INFO]: 	avg_search_speed_ms: 5.002828943904566
2025-03-13 17:01:04,669 [INFO]: 	99p_search_speed_ms: 11.54540915042161
2025-03-13 17:01:04,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:04,669 [INFO]: 	nb vectors: 2039
2025-03-13 17:01:04,669 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:04,669 [INFO]: 	compression ratio: 0.9993087115166696
2025-03-13 17:01:04,669 [INFO]: }
2025-03-13 17:01:04,669 [INFO]: 	>>> Finished "Creating the index" in 48.9610 secs
2025-03-13 17:01:04,669 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9899 secs
2025-03-13 17:01:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 100143 [episode count 4/7]
[retrieval_preprocessing] for episode 100144 [episode count 5/7], we have num_retrieval=np.int64(1878) num_query=np.int64(346)
2025-03-13 17:01:05,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:06,074 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:06
2025-03-13 17:01:06,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.25it/s]
2025-03-13 17:01:06,114 [INFO]: There are 1878 embeddings of dim 49152
2025-03-13 17:01:06,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0399 secs
2025-03-13 17:01:06,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:06
2025-03-13 17:01:06,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:06,115 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:01:06,116 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:06,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:01:06,116 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:06
2025-03-13 17:01:06,116 [INFO]: 387.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:06,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:01:06,117 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:06
2025-03-13 17:01:06,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:06,117 [INFO]: 	Creating the index 03/13/2025, 17:01:06
2025-03-13 17:01:06,117 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:06
2025-03-13 17:01:06,121 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:01:06,121 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:06
2025-03-13 17:01:06,121 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:01:06,121 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.48it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.73it/s]100%|██████████| 8/8 [00:01<00:00,  5.69it/s]
2025-03-13 17:01:07,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:07
2025-03-13 17:01:33,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9227 secs
2025-03-13 17:01:33,458 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 17:01:33,458 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-13 17:02:00,160 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7017 secs
2025-03-13 17:02:00,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0452 secs
2025-03-13 17:02:00,166 [INFO]: {
2025-03-13 17:02:00,166 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:00,166 [INFO]: 	index_param: efSearch=205
2025-03-13 17:02:00,166 [INFO]: 	index_path: knn.index
2025-03-13 17:02:00,166 [INFO]: 	size in bytes: 369485230
2025-03-13 17:02:00,166 [INFO]: 	avg_search_speed_ms: 8.939636130904624
2025-03-13 17:02:00,166 [INFO]: 	99p_search_speed_ms: 13.337164702825236
2025-03-13 17:02:00,167 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:00,167 [INFO]: 	nb vectors: 1878
2025-03-13 17:02:00,167 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:00,167 [INFO]: 	compression ratio: 0.9993087518004441
2025-03-13 17:02:00,167 [INFO]: }
2025-03-13 17:02:00,167 [INFO]: 	>>> Finished "Creating the index" in 54.0493 secs
2025-03-13 17:02:00,167 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0920 secs
2025-03-13 17:02:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 100144 [episode count 5/7]
[retrieval_preprocessing] for episode 100145 [episode count 6/7], we have num_retrieval=np.int64(1890) num_query=np.int64(334)
2025-03-13 17:02:03,575 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:03,848 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:03
2025-03-13 17:02:03,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-13 17:02:03,878 [INFO]: There are 1890 embeddings of dim 49152
2025-03-13 17:02:03,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:02:03,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:03
2025-03-13 17:02:03,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:03,879 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:02:03,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:03,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:02:03,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:03
2025-03-13 17:02:03,880 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:03,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:03,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:03
2025-03-13 17:02:03,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:03,880 [INFO]: 	Creating the index 03/13/2025, 17:02:03
2025-03-13 17:02:03,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:03
2025-03-13 17:02:03,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:02:03,881 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:03
2025-03-13 17:02:03,881 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:02:03,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.69it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.58it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.26it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.36it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.43it/s]100%|██████████| 8/8 [00:02<00:00,  1.80it/s]100%|██████████| 8/8 [00:02<00:00,  3.24it/s]
2025-03-13 17:02:06,353 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:06
2025-03-13 17:02:38,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1108 secs
2025-03-13 17:02:38,465 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:02:38,466 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 17:02:56,068 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6025 secs
2025-03-13 17:02:56,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2724 secs
2025-03-13 17:02:56,154 [INFO]: {
2025-03-13 17:02:56,154 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:56,154 [INFO]: 	index_param: efSearch=201
2025-03-13 17:02:56,154 [INFO]: 	index_path: knn.index
2025-03-13 17:02:56,154 [INFO]: 	size in bytes: 371846230
2025-03-13 17:02:56,154 [INFO]: 	avg_search_speed_ms: 7.526153427512239
2025-03-13 17:02:56,154 [INFO]: 	99p_search_speed_ms: 13.32587675191462
2025-03-13 17:02:56,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:56,155 [INFO]: 	nb vectors: 1890
2025-03-13 17:02:56,155 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:56,155 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-13 17:02:56,155 [INFO]: }
2025-03-13 17:02:56,155 [INFO]: 	>>> Finished "Creating the index" in 52.2750 secs
2025-03-13 17:02:56,155 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3063 secs
2025-03-13 17:02:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 100145 [episode count 6/7]
2025-03-13 17:02:58: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pour_the_contents_of_the_cup_into_the_bowl [chosen_id count 7/8]
2025-03-13 17:02:58: [retrieval_preprocessing] done for embedding_type='wrist_image'!
done!
