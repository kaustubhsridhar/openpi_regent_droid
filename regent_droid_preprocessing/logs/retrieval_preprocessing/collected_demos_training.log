nohup: ignoring input
2025-03-15 04:14:05: [retrieval_preprocessing] starting retrieval preprocessing for top_image
2025-03-15 04:14:06: [retrieval_preprocessing] concatenated all embeddings and indices for 21 episodes for collected_demos_training/2025-03-14_move_apple_to_the_right [chosen_id count 0/21]
2025-03-15 04:14:06: [retrieval_preprocessing] we have num_total=1551 embedding_dim=49152
[retrieval_preprocessing] for episode 100000 [episode count 0/21], we have num_retrieval=np.int64(1474) num_query=np.int64(77)
2025-03-15 04:14:06,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-15 04:14:07,112 [INFO]: Launching the whole pipeline 03/15/2025, 04:14:07
2025-03-15 04:14:07,112 [INFO]: Reading total number of vectors and dimension 03/15/2025, 04:14:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 731.61it/s]
2025-03-15 04:14:07,148 [INFO]: There are 1474 embeddings of dim 49152
2025-03-15 04:14:07,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-15 04:14:07,148 [INFO]: 	Compute estimated construction time of the index 03/15/2025, 04:14:07
2025-03-15 04:14:07,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-15 04:14:07,148 [INFO]: 		-> Add: 0.8 seconds
2025-03-15 04:14:07,149 [INFO]: 		Total: 16.7 minutes
2025-03-15 04:14:07,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-15 04:14:07,149 [INFO]: 	Checking that your have enough memory available to create the index 03/15/2025, 04:14:07
2025-03-15 04:14:07,149 [INFO]: 304.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-15 04:14:07,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0009 secs
2025-03-15 04:14:07,150 [INFO]: 	Selecting most promising index types given data characteristics 03/15/2025, 04:14:07
2025-03-15 04:14:07,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-15 04:14:07,150 [INFO]: 	Creating the index 03/15/2025, 04:14:07
2025-03-15 04:14:07,150 [INFO]: 		-> Instanciate the index HNSW15 03/15/2025, 04:14:07
2025-03-15 04:14:07,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-15 04:14:07,152 [INFO]: 		-> Adding the vectors to the index 03/15/2025, 04:14:07
2025-03-15 04:14:07,152 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-15 04:14:07,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  5.54it/s] 33%|███▎      | 2/6 [00:00<00:00,  7.27it/s] 50%|█████     | 3/6 [00:00<00:00,  8.13it/s] 67%|██████▋   | 4/6 [00:00<00:00,  8.57it/s] 83%|████████▎ | 5/6 [00:00<00:00,  8.83it/s]100%|██████████| 6/6 [00:01<00:00,  2.47it/s]100%|██████████| 6/6 [00:01<00:00,  3.79it/s]
2025-03-15 04:14:08,741 [INFO]: 	Computing best hyperparameters for index knn.index 03/15/2025, 04:14:08
2025-03-15 04:14:26,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 17.3238 secs
2025-03-15 04:14:26,065 [INFO]: The best hyperparameters are: efSearch=355
2025-03-15 04:14:26,065 [INFO]: 	Compute fast metrics 03/15/2025, 04:14:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.88it/s]
2025-03-15 04:14:38,513 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4475 secs
2025-03-15 04:14:38,514 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.3626 secs
2025-03-15 04:14:38,515 [INFO]: {
2025-03-15 04:14:38,515 [INFO]: 	index_key: HNSW15
2025-03-15 04:14:38,515 [INFO]: 	index_param: efSearch=355
2025-03-15 04:14:38,515 [INFO]: 	index_path: knn.index
2025-03-15 04:14:38,515 [INFO]: 	size in bytes: 290000710
2025-03-15 04:14:38,515 [INFO]: 	avg_search_speed_ms: 8.542212152998356
2025-03-15 04:14:38,515 [INFO]: 	99p_search_speed_ms: 11.437296075746415
2025-03-15 04:14:38,515 [INFO]: 	reconstruction error %: 0.0
2025-03-15 04:14:38,515 [INFO]: 	nb vectors: 1474
2025-03-15 04:14:38,515 [INFO]: 	vectors dimension: 49152
2025-03-15 04:14:38,515 [INFO]: 	compression ratio: 0.9993085603135248
2025-03-15 04:14:38,515 [INFO]: }
2025-03-15 04:14:38,515 [INFO]: 	>>> Finished "Creating the index" in 31.3650 secs
2025-03-15 04:14:38,515 [INFO]: >>> Finished "Launching the whole pipeline" in 31.4030 secs
2025-03-15 04:14:39: [retrieval_preprocessing] calculating distances ...
2025-03-15 04:14:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 100000 [episode count 0/21]
[retrieval_preprocessing] for episode 100001 [episode count 1/21], we have num_retrieval=np.int64(1484) num_query=np.int64(67)
2025-03-15 04:14:39,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-15 04:14:39,474 [INFO]: Launching the whole pipeline 03/15/2025, 04:14:39
2025-03-15 04:14:39,474 [INFO]: Reading total number of vectors and dimension 03/15/2025, 04:14:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.27it/s]
2025-03-15 04:14:39,504 [INFO]: There are 1484 embeddings of dim 49152
2025-03-15 04:14:39,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-15 04:14:39,505 [INFO]: 	Compute estimated construction time of the index 03/15/2025, 04:14:39
2025-03-15 04:14:39,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-15 04:14:39,505 [INFO]: 		-> Add: 0.8 seconds
2025-03-15 04:14:39,505 [INFO]: 		Total: 16.7 minutes
2025-03-15 04:14:39,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-15 04:14:39,505 [INFO]: 	Checking that your have enough memory available to create the index 03/15/2025, 04:14:39
2025-03-15 04:14:39,505 [INFO]: 306.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-15 04:14:39,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-15 04:14:39,505 [INFO]: 	Selecting most promising index types given data characteristics 03/15/2025, 04:14:39
2025-03-15 04:14:39,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-15 04:14:39,505 [INFO]: 	Creating the index 03/15/2025, 04:14:39
2025-03-15 04:14:39,505 [INFO]: 		-> Instanciate the index HNSW15 03/15/2025, 04:14:39
2025-03-15 04:14:39,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-15 04:14:39,506 [INFO]: 		-> Adding the vectors to the index 03/15/2025, 04:14:39
2025-03-15 04:14:39,506 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-15 04:14:39,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 27.86it/s]100%|██████████| 6/6 [00:00<00:00,  5.53it/s]100%|██████████| 6/6 [00:00<00:00,  6.27it/s]
2025-03-15 04:14:40,465 [INFO]: 	Computing best hyperparameters for index knn.index 03/15/2025, 04:14:40
2025-03-15 04:14:56,834 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 16.3683 secs
2025-03-15 04:14:56,834 [INFO]: The best hyperparameters are: efSearch=475
2025-03-15 04:14:56,834 [INFO]: 	Compute fast metrics 03/15/2025, 04:14:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.43it/s]
2025-03-15 04:15:09,169 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3341 secs
2025-03-15 04:15:09,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 29.6636 secs
2025-03-15 04:15:09,170 [INFO]: {
2025-03-15 04:15:09,170 [INFO]: 	index_key: HNSW15
2025-03-15 04:15:09,170 [INFO]: 	index_param: efSearch=475
2025-03-15 04:15:09,170 [INFO]: 	index_path: knn.index
2025-03-15 04:15:09,170 [INFO]: 	size in bytes: 291968170
2025-03-15 04:15:09,170 [INFO]: 	avg_search_speed_ms: 10.022597603932889
2025-03-15 04:15:09,170 [INFO]: 	99p_search_speed_ms: 11.663221633061767
2025-03-15 04:15:09,170 [INFO]: 	reconstruction error %: 0.0
2025-03-15 04:15:09,170 [INFO]: 	nb vectors: 1484
2025-03-15 04:15:09,170 [INFO]: 	vectors dimension: 49152
2025-03-15 04:15:09,170 [INFO]: 	compression ratio: 0.9993084931141638
2025-03-15 04:15:09,170 [INFO]: }
2025-03-15 04:15:09,170 [INFO]: 	>>> Finished "Creating the index" in 29.6650 secs
2025-03-15 04:15:09,170 [INFO]: >>> Finished "Launching the whole pipeline" in 29.6957 secs
2025-03-15 04:15:09: [retrieval_preprocessing] calculating distances ...
2025-03-15 04:15:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 100001 [episode count 1/21]
[retrieval_preprocessing] for episode 100002 [episode count 2/21], we have num_retrieval=np.int64(1498) num_query=np.int64(53)
2025-03-15 04:15:09,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-15 04:15:10,123 [INFO]: Launching the whole pipeline 03/15/2025, 04:15:10
2025-03-15 04:15:10,123 [INFO]: Reading total number of vectors and dimension 03/15/2025, 04:15:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.36it/s]
2025-03-15 04:15:10,157 [INFO]: There are 1498 embeddings of dim 49152
2025-03-15 04:15:10,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-15 04:15:10,157 [INFO]: 	Compute estimated construction time of the index 03/15/2025, 04:15:10
2025-03-15 04:15:10,157 [INFO]: 		-> Train: 16.7 minutes
2025-03-15 04:15:10,157 [INFO]: 		-> Add: 0.8 seconds
2025-03-15 04:15:10,157 [INFO]: 		Total: 16.7 minutes
2025-03-15 04:15:10,157 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-15 04:15:10,157 [INFO]: 	Checking that your have enough memory available to create the index 03/15/2025, 04:15:10
2025-03-15 04:15:10,158 [INFO]: 309.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-15 04:15:10,158 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-15 04:15:10,158 [INFO]: 	Selecting most promising index types given data characteristics 03/15/2025, 04:15:10
2025-03-15 04:15:10,158 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-15 04:15:10,158 [INFO]: 	Creating the index 03/15/2025, 04:15:10
2025-03-15 04:15:10,158 [INFO]: 		-> Instanciate the index HNSW15 03/15/2025, 04:15:10
2025-03-15 04:15:10,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-15 04:15:10,162 [INFO]: 		-> Adding the vectors to the index 03/15/2025, 04:15:10
2025-03-15 04:15:10,162 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-15 04:15:10,162 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 67%|██████▋   | 4/6 [00:00<00:00, 36.24it/s]100%|██████████| 6/6 [00:00<00:00,  6.25it/s]
2025-03-15 04:15:11,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/15/2025, 04:15:11
2025-03-15 04:15:27,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 16.2643 secs
2025-03-15 04:15:27,392 [INFO]: The best hyperparameters are: efSearch=485
2025-03-15 04:15:27,392 [INFO]: 	Compute fast metrics 03/15/2025, 04:15:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.26it/s]
