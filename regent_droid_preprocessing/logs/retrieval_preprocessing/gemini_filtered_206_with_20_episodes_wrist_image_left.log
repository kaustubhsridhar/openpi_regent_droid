nohup: ignoring input
2025-03-13 10:49:22: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:49:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_mug [chosen_id count 0/260]
2025-03-13 10:49:24: [retrieval_preprocessing] we have num_total=2760 embedding_dim=49152
[retrieval_preprocessing] for episode 24662 [episode count 0/20], we have num_retrieval=np.int64(2606) num_query=np.int64(154)
2025-03-13 10:49:24,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:49:24,630 [INFO]: Launching the whole pipeline 03/13/2025, 10:49:24
2025-03-13 10:49:24,630 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:49:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 892.03it/s]
2025-03-13 10:49:24,683 [INFO]: There are 2606 embeddings of dim 49152
2025-03-13 10:49:24,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0527 secs
2025-03-13 10:49:24,683 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:49:24
2025-03-13 10:49:24,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:49:24,683 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:49:24,683 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:49:24,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:49:24,683 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:49:24
2025-03-13 10:49:24,684 [INFO]: 537.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:49:24,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 10:49:24,684 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:49:24
2025-03-13 10:49:24,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:49:24,684 [INFO]: 	Creating the index 03/13/2025, 10:49:24
2025-03-13 10:49:24,684 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:49:24
2025-03-13 10:49:24,699 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0152 secs
2025-03-13 10:49:24,700 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:49:24
2025-03-13 10:49:24,700 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:49:24,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.87it/s] 73%|███████▎  | 8/11 [00:00<00:00, 36.63it/s]100%|██████████| 11/11 [00:01<00:00,  6.40it/s]
2025-03-13 10:49:26,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:49:26
2025-03-13 10:49:53,575 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1494 secs
2025-03-13 10:49:53,575 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 10:49:53,575 [INFO]: 	Compute fast metrics 03/13/2025, 10:49:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.88it/s]
2025-03-13 10:50:07,457 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8817 secs
2025-03-13 10:50:07,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7587 secs
2025-03-13 10:50:07,458 [INFO]: {
2025-03-13 10:50:07,458 [INFO]: 	index_key: HNSW15
2025-03-13 10:50:07,458 [INFO]: 	index_param: efSearch=216
2025-03-13 10:50:07,458 [INFO]: 	index_path: knn.index
2025-03-13 10:50:07,458 [INFO]: 	size in bytes: 512714470
2025-03-13 10:50:07,458 [INFO]: 	avg_search_speed_ms: 8.898992991046748
2025-03-13 10:50:07,459 [INFO]: 	99p_search_speed_ms: 12.691080805379897
2025-03-13 10:50:07,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:50:07,459 [INFO]: 	nb vectors: 2606
2025-03-13 10:50:07,459 [INFO]: 	vectors dimension: 49152
2025-03-13 10:50:07,459 [INFO]: 	compression ratio: 0.9993095143189542
2025-03-13 10:50:07,459 [INFO]: }
2025-03-13 10:50:07,459 [INFO]: 	>>> Finished "Creating the index" in 42.7748 secs
2025-03-13 10:50:07,459 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8289 secs
2025-03-13 10:50:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:50:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 24662 [episode count 0/20]
[retrieval_preprocessing] for episode 41049 [episode count 1/20], we have num_retrieval=np.int64(2653) num_query=np.int64(107)
2025-03-13 10:50:08,451 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:08,774 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:08
2025-03-13 10:50:08,774 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1743.99it/s]
2025-03-13 10:50:08,797 [INFO]: There are 2653 embeddings of dim 49152
2025-03-13 10:50:08,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 10:50:08,798 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:08
2025-03-13 10:50:08,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:08,798 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 10:50:08,798 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:08,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:50:08,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:08
2025-03-13 10:50:08,798 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:08,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:50:08,798 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:08
2025-03-13 10:50:08,798 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:08,798 [INFO]: 	Creating the index 03/13/2025, 10:50:08
2025-03-13 10:50:08,798 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:08
2025-03-13 10:50:08,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:50:08,799 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:08
2025-03-13 10:50:08,799 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:50:08,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 28.25it/s] 91%|█████████ | 10/11 [00:00<00:00, 51.37it/s]100%|██████████| 11/11 [00:01<00:00,  6.34it/s]
2025-03-13 10:50:10,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:10
2025-03-13 10:50:35,460 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9228 secs
2025-03-13 10:50:35,460 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 10:50:35,460 [INFO]: 	Compute fast metrics 03/13/2025, 10:50:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.52s/it] 50%|█████     | 2/4 [00:02<00:02,  1.16s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.41it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.02s/it]
2025-03-13 10:50:51,508 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0477 secs
2025-03-13 10:50:51,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7102 secs
2025-03-13 10:50:51,510 [INFO]: {
2025-03-13 10:50:51,510 [INFO]: 	index_key: HNSW15
2025-03-13 10:50:51,510 [INFO]: 	index_param: efSearch=233
2025-03-13 10:50:51,510 [INFO]: 	index_path: knn.index
2025-03-13 10:50:51,510 [INFO]: 	size in bytes: 521961430
2025-03-13 10:50:51,510 [INFO]: 	avg_search_speed_ms: 11.39747382726113
2025-03-13 10:50:51,510 [INFO]: 	99p_search_speed_ms: 18.248752132058144
2025-03-13 10:50:51,510 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:50:51,510 [INFO]: 	nb vectors: 2653
2025-03-13 10:50:51,510 [INFO]: 	vectors dimension: 49152
2025-03-13 10:50:51,510 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-13 10:50:51,510 [INFO]: }
2025-03-13 10:50:51,510 [INFO]: 	>>> Finished "Creating the index" in 42.7119 secs
2025-03-13 10:50:51,510 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7360 secs
2025-03-13 10:50:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:50:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 41049 [episode count 1/20]
[retrieval_preprocessing] for episode 82031 [episode count 2/20], we have num_retrieval=np.int64(2621) num_query=np.int64(139)
2025-03-13 10:50:53,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:53,393 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:53
2025-03-13 10:50:53,393 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2020.38it/s]
2025-03-13 10:50:53,419 [INFO]: There are 2621 embeddings of dim 49152
2025-03-13 10:50:53,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 10:50:53,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:53
2025-03-13 10:50:53,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:53,419 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:50:53,419 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:53,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:50:53,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:53
2025-03-13 10:50:53,419 [INFO]: 540.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:53,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:50:53,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:53
2025-03-13 10:50:53,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:53,419 [INFO]: 	Creating the index 03/13/2025, 10:50:53
2025-03-13 10:50:53,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:53
2025-03-13 10:50:53,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 10:50:53,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:53
2025-03-13 10:50:53,420 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:50:53,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.56it/s] 64%|██████▎   | 7/11 [00:00<00:00, 37.56it/s]100%|██████████| 11/11 [00:01<00:00,  4.89it/s]100%|██████████| 11/11 [00:01<00:00,  5.90it/s]
2025-03-13 10:50:55,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:55
2025-03-13 10:51:23,318 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0276 secs
2025-03-13 10:51:23,318 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 10:51:23,318 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.00it/s] 50%|█████     | 2/4 [00:00<00:00,  3.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.11it/s]
2025-03-13 10:51:35,734 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4165 secs
2025-03-13 10:51:35,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3159 secs
2025-03-13 10:51:35,736 [INFO]: {
2025-03-13 10:51:35,736 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:35,736 [INFO]: 	index_param: efSearch=125
2025-03-13 10:51:35,736 [INFO]: 	index_path: knn.index
2025-03-13 10:51:35,736 [INFO]: 	size in bytes: 515665690
2025-03-13 10:51:35,736 [INFO]: 	avg_search_speed_ms: 7.575981400441378
2025-03-13 10:51:35,736 [INFO]: 	99p_search_speed_ms: 10.729487156495452
2025-03-13 10:51:35,736 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:35,736 [INFO]: 	nb vectors: 2621
2025-03-13 10:51:35,736 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:35,736 [INFO]: 	compression ratio: 0.9993093936499828
2025-03-13 10:51:35,736 [INFO]: }
2025-03-13 10:51:35,736 [INFO]: 	>>> Finished "Creating the index" in 42.3171 secs
2025-03-13 10:51:35,736 [INFO]: >>> Finished "Launching the whole pipeline" in 42.3434 secs
2025-03-13 10:51:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 82031 [episode count 2/20]
[retrieval_preprocessing] for episode 122 [episode count 3/20], we have num_retrieval=np.int64(2616) num_query=np.int64(144)
2025-03-13 10:51:36,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:37,183 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:37
2025-03-13 10:51:37,183 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.90it/s]
2025-03-13 10:51:37,213 [INFO]: There are 2616 embeddings of dim 49152
2025-03-13 10:51:37,214 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 10:51:37,214 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:37
2025-03-13 10:51:37,214 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:37,214 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:51:37,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:37,215 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 10:51:37,215 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:37
2025-03-13 10:51:37,215 [INFO]: 539.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:37,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:51:37,216 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:37
2025-03-13 10:51:37,216 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:37,216 [INFO]: 	Creating the index 03/13/2025, 10:51:37
2025-03-13 10:51:37,216 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:37
2025-03-13 10:51:37,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 10:51:37,219 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:37
2025-03-13 10:51:37,219 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:51:37,219 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.72it/s] 36%|███▋      | 4/11 [00:00<00:00, 11.88it/s] 55%|█████▍    | 6/11 [00:00<00:00,  6.80it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.45it/s]100%|██████████| 11/11 [00:03<00:00,  3.33it/s]
2025-03-13 10:51:40,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:40
2025-03-13 10:52:15,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5015 secs
2025-03-13 10:52:15,030 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 10:52:15,030 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 10:52:26,761 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7312 secs
2025-03-13 10:52:26,764 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5456 secs
2025-03-13 10:52:26,765 [INFO]: {
2025-03-13 10:52:26,765 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:26,765 [INFO]: 	index_param: efSearch=153
2025-03-13 10:52:26,765 [INFO]: 	index_path: knn.index
2025-03-13 10:52:26,765 [INFO]: 	size in bytes: 514681990
2025-03-13 10:52:26,765 [INFO]: 	avg_search_speed_ms: 8.846632279060406
2025-03-13 10:52:26,765 [INFO]: 	99p_search_speed_ms: 14.28387556225062
2025-03-13 10:52:26,765 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:26,765 [INFO]: 	nb vectors: 2616
2025-03-13 10:52:26,765 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:26,765 [INFO]: 	compression ratio: 0.9993093560549885
2025-03-13 10:52:26,765 [INFO]: }
2025-03-13 10:52:26,765 [INFO]: 	>>> Finished "Creating the index" in 49.5490 secs
2025-03-13 10:52:26,765 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5819 secs
2025-03-13 10:52:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 122 [episode count 3/20]
[retrieval_preprocessing] for episode 25058 [episode count 4/20], we have num_retrieval=np.int64(2585) num_query=np.int64(175)
2025-03-13 10:52:28,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:28,838 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:28
2025-03-13 10:52:28,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.07it/s]
2025-03-13 10:52:28,874 [INFO]: There are 2585 embeddings of dim 49152
2025-03-13 10:52:28,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 10:52:28,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:28
2025-03-13 10:52:28,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:28,874 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:52:28,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:28,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:52:28,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:28
2025-03-13 10:52:28,874 [INFO]: 533.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:28,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:52:28,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:28
2025-03-13 10:52:28,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:28,874 [INFO]: 	Creating the index 03/13/2025, 10:52:28
2025-03-13 10:52:28,874 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:28
2025-03-13 10:52:28,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 10:52:28,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:28
2025-03-13 10:52:28,876 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:52:28,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.57it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.59it/s]100%|██████████| 11/11 [00:02<00:00,  4.69it/s]100%|██████████| 11/11 [00:02<00:00,  5.49it/s]
2025-03-13 10:52:30,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:30
2025-03-13 10:53:00,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8949 secs
2025-03-13 10:53:00,777 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 10:53:00,777 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 10:53:12,378 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6007 secs
2025-03-13 10:53:12,380 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5040 secs
2025-03-13 10:53:12,380 [INFO]: {
2025-03-13 10:53:12,380 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:12,380 [INFO]: 	index_param: efSearch=168
2025-03-13 10:53:12,380 [INFO]: 	index_path: knn.index
2025-03-13 10:53:12,380 [INFO]: 	size in bytes: 508582870
2025-03-13 10:53:12,380 [INFO]: 	avg_search_speed_ms: 11.631920212489922
2025-03-13 10:53:12,380 [INFO]: 	99p_search_speed_ms: 18.710723035037514
2025-03-13 10:53:12,380 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:12,380 [INFO]: 	nb vectors: 2585
2025-03-13 10:53:12,380 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:12,380 [INFO]: 	compression ratio: 0.9993094734000774
2025-03-13 10:53:12,380 [INFO]: }
2025-03-13 10:53:12,380 [INFO]: 	>>> Finished "Creating the index" in 43.5059 secs
2025-03-13 10:53:12,380 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5423 secs
2025-03-13 10:53:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 25058 [episode count 4/20]
[retrieval_preprocessing] for episode 33314 [episode count 5/20], we have num_retrieval=np.int64(2621) num_query=np.int64(139)
2025-03-13 10:53:13,894 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:14,249 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:14
2025-03-13 10:53:14,249 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 10:53:14,280 [INFO]: There are 2621 embeddings of dim 49152
2025-03-13 10:53:14,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 10:53:14,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:14
2025-03-13 10:53:14,281 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:14,281 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:53:14,281 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:14,281 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:14,281 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:14
2025-03-13 10:53:14,281 [INFO]: 540.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:14,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:53:14,281 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:14
2025-03-13 10:53:14,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:14,281 [INFO]: 	Creating the index 03/13/2025, 10:53:14
2025-03-13 10:53:14,281 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:14
2025-03-13 10:53:14,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:53:14,282 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:14
2025-03-13 10:53:14,282 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:53:14,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.11it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.06it/s]100%|██████████| 11/11 [00:02<00:00,  4.92it/s]
2025-03-13 10:53:16,518 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:16
2025-03-13 10:53:45,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6363 secs
2025-03-13 10:53:45,155 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 10:53:45,155 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.28it/s]
2025-03-13 10:53:57,697 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5416 secs
2025-03-13 10:53:57,698 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4162 secs
2025-03-13 10:53:57,698 [INFO]: {
2025-03-13 10:53:57,698 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:57,698 [INFO]: 	index_param: efSearch=136
2025-03-13 10:53:57,698 [INFO]: 	index_path: knn.index
2025-03-13 10:53:57,698 [INFO]: 	size in bytes: 515665690
2025-03-13 10:53:57,698 [INFO]: 	avg_search_speed_ms: 8.174803756209409
2025-03-13 10:53:57,698 [INFO]: 	99p_search_speed_ms: 13.666685656644404
2025-03-13 10:53:57,698 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:57,698 [INFO]: 	nb vectors: 2621
2025-03-13 10:53:57,698 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:57,698 [INFO]: 	compression ratio: 0.9993093936499828
2025-03-13 10:53:57,698 [INFO]: }
2025-03-13 10:53:57,699 [INFO]: 	>>> Finished "Creating the index" in 43.4176 secs
2025-03-13 10:53:57,699 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4498 secs
2025-03-13 10:53:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 33314 [episode count 5/20]
[retrieval_preprocessing] for episode 33683 [episode count 6/20], we have num_retrieval=np.int64(2630) num_query=np.int64(130)
2025-03-13 10:53:58,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:59,340 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:59
2025-03-13 10:53:59,340 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.21it/s]
2025-03-13 10:53:59,381 [INFO]: There are 2630 embeddings of dim 49152
2025-03-13 10:53:59,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0408 secs
2025-03-13 10:53:59,381 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:59
2025-03-13 10:53:59,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:59,382 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:53:59,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:59,382 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:53:59,382 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:59
2025-03-13 10:53:59,382 [INFO]: 542.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:59,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:53:59,382 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:59
2025-03-13 10:53:59,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:59,382 [INFO]: 	Creating the index 03/13/2025, 10:53:59
2025-03-13 10:53:59,383 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:59
2025-03-13 10:53:59,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 10:53:59,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:59
2025-03-13 10:53:59,385 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:53:59,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.53it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.50it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]100%|██████████| 11/11 [00:02<00:00,  5.38it/s]
2025-03-13 10:54:01,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:01
2025-03-13 10:54:33,801 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3685 secs
2025-03-13 10:54:33,802 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 10:54:33,802 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-13 10:54:45,386 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5840 secs
2025-03-13 10:54:45,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0029 secs
2025-03-13 10:54:45,388 [INFO]: {
2025-03-13 10:54:45,388 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:45,388 [INFO]: 	index_param: efSearch=133
2025-03-13 10:54:45,388 [INFO]: 	index_path: knn.index
2025-03-13 10:54:45,388 [INFO]: 	size in bytes: 517436410
2025-03-13 10:54:45,388 [INFO]: 	avg_search_speed_ms: 6.914013247830049
2025-03-13 10:54:45,388 [INFO]: 	99p_search_speed_ms: 9.656744566746056
2025-03-13 10:54:45,388 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:45,388 [INFO]: 	nb vectors: 2630
2025-03-13 10:54:45,388 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:45,388 [INFO]: 	compression ratio: 0.9993093450845486
2025-03-13 10:54:45,388 [INFO]: }
2025-03-13 10:54:45,388 [INFO]: 	>>> Finished "Creating the index" in 46.0053 secs
2025-03-13 10:54:45,388 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0474 secs
2025-03-13 10:54:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 33683 [episode count 6/20]
[retrieval_preprocessing] for episode 33705 [episode count 7/20], we have num_retrieval=np.int64(2628) num_query=np.int64(132)
2025-03-13 10:54:46,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:46,633 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:46
2025-03-13 10:54:46,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2160.90it/s]
2025-03-13 10:54:46,660 [INFO]: There are 2628 embeddings of dim 49152
2025-03-13 10:54:46,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 10:54:46,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:46
2025-03-13 10:54:46,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:46,661 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:54:46,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:46,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:46,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:46
2025-03-13 10:54:46,661 [INFO]: 542.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:46,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:46,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:46
2025-03-13 10:54:46,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:46,661 [INFO]: 	Creating the index 03/13/2025, 10:54:46
2025-03-13 10:54:46,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:46
2025-03-13 10:54:46,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:54:46,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:46
2025-03-13 10:54:46,662 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:54:46,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.05it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.09it/s]100%|██████████| 11/11 [00:01<00:00,  4.72it/s]100%|██████████| 11/11 [00:01<00:00,  5.51it/s]
2025-03-13 10:54:48,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:48
2025-03-13 10:55:17,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8514 secs
2025-03-13 10:55:17,515 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 10:55:17,515 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.07it/s]
2025-03-13 10:55:30,107 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5923 secs
2025-03-13 10:55:30,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4468 secs
2025-03-13 10:55:30,109 [INFO]: {
2025-03-13 10:55:30,109 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:30,109 [INFO]: 	index_param: efSearch=161
2025-03-13 10:55:30,109 [INFO]: 	index_path: knn.index
2025-03-13 10:55:30,109 [INFO]: 	size in bytes: 517042930
2025-03-13 10:55:30,109 [INFO]: 	avg_search_speed_ms: 9.528513114367213
2025-03-13 10:55:30,109 [INFO]: 	99p_search_speed_ms: 18.643832893576473
2025-03-13 10:55:30,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:30,109 [INFO]: 	nb vectors: 2628
2025-03-13 10:55:30,109 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:30,109 [INFO]: 	compression ratio: 0.9993093300782587
2025-03-13 10:55:30,109 [INFO]: }
2025-03-13 10:55:30,109 [INFO]: 	>>> Finished "Creating the index" in 43.4482 secs
2025-03-13 10:55:30,109 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4763 secs
2025-03-13 10:55:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 33705 [episode count 7/20]
[retrieval_preprocessing] for episode 91066 [episode count 8/20], we have num_retrieval=np.int64(2652) num_query=np.int64(108)
2025-03-13 10:55:31,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:31,981 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:31
2025-03-13 10:55:31,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.52it/s]
2025-03-13 10:55:32,014 [INFO]: There are 2652 embeddings of dim 49152
2025-03-13 10:55:32,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 10:55:32,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:32
2025-03-13 10:55:32,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:32,014 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 10:55:32,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:32,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:32,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:32
2025-03-13 10:55:32,014 [INFO]: 547.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:32,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:55:32,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:32
2025-03-13 10:55:32,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:32,014 [INFO]: 	Creating the index 03/13/2025, 10:55:32
2025-03-13 10:55:32,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:32
2025-03-13 10:55:32,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:55:32,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:32
2025-03-13 10:55:32,016 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:55:32,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.11it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.99it/s]100%|██████████| 11/11 [00:02<00:00,  3.80it/s]100%|██████████| 11/11 [00:02<00:00,  4.45it/s]
2025-03-13 10:55:34,491 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:34
2025-03-13 10:56:05,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5047 secs
2025-03-13 10:56:05,997 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 10:56:05,997 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.13it/s]
2025-03-13 10:56:18,469 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4728 secs
2025-03-13 10:56:18,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4557 secs
2025-03-13 10:56:18,472 [INFO]: {
2025-03-13 10:56:18,472 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:18,472 [INFO]: 	index_param: efSearch=157
2025-03-13 10:56:18,472 [INFO]: 	index_path: knn.index
2025-03-13 10:56:18,472 [INFO]: 	size in bytes: 521764690
2025-03-13 10:56:18,472 [INFO]: 	avg_search_speed_ms: 8.808955044530759
2025-03-13 10:56:18,472 [INFO]: 	99p_search_speed_ms: 13.800561428070074
2025-03-13 10:56:18,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:18,472 [INFO]: 	nb vectors: 2652
2025-03-13 10:56:18,472 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:18,472 [INFO]: 	compression ratio: 0.9993095086599286
2025-03-13 10:56:18,472 [INFO]: }
2025-03-13 10:56:18,472 [INFO]: 	>>> Finished "Creating the index" in 46.4573 secs
2025-03-13 10:56:18,472 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4907 secs
2025-03-13 10:56:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 91066 [episode count 8/20]
[retrieval_preprocessing] for episode 41322 [episode count 9/20], we have num_retrieval=np.int64(2650) num_query=np.int64(110)
2025-03-13 10:56:19,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:19,837 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:19
2025-03-13 10:56:19,837 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1660.45it/s]
2025-03-13 10:56:19,866 [INFO]: There are 2650 embeddings of dim 49152
2025-03-13 10:56:19,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 10:56:19,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:19
2025-03-13 10:56:19,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:19,867 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 10:56:19,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:19,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:56:19,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:19
2025-03-13 10:56:19,867 [INFO]: 546.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:19,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:56:19,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:19
2025-03-13 10:56:19,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:19,867 [INFO]: 	Creating the index 03/13/2025, 10:56:19
2025-03-13 10:56:19,867 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:19
2025-03-13 10:56:19,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:56:19,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:19
2025-03-13 10:56:19,869 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:56:19,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.22it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.84it/s]100%|██████████| 11/11 [00:02<00:00,  4.46it/s]100%|██████████| 11/11 [00:02<00:00,  5.39it/s]
2025-03-13 10:56:21,915 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:21
2025-03-13 10:56:51,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9808 secs
2025-03-13 10:56:51,898 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 10:56:51,898 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.30it/s]
2025-03-13 10:57:03,601 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7035 secs
2025-03-13 10:57:03,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7352 secs
2025-03-13 10:57:03,604 [INFO]: {
2025-03-13 10:57:03,604 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:03,604 [INFO]: 	index_param: efSearch=151
2025-03-13 10:57:03,604 [INFO]: 	index_path: knn.index
2025-03-13 10:57:03,604 [INFO]: 	size in bytes: 521371210
2025-03-13 10:57:03,604 [INFO]: 	avg_search_speed_ms: 8.201131019382215
2025-03-13 10:57:03,604 [INFO]: 	99p_search_speed_ms: 11.299099833704524
2025-03-13 10:57:03,604 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:03,604 [INFO]: 	nb vectors: 2650
2025-03-13 10:57:03,604 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:03,604 [INFO]: 	compression ratio: 0.9993094939016675
2025-03-13 10:57:03,604 [INFO]: }
2025-03-13 10:57:03,604 [INFO]: 	>>> Finished "Creating the index" in 43.7368 secs
2025-03-13 10:57:03,604 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7672 secs
2025-03-13 10:57:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 41322 [episode count 9/20]
[retrieval_preprocessing] for episode 42437 [episode count 10/20], we have num_retrieval=np.int64(2575) num_query=np.int64(185)
2025-03-13 10:57:04,847 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:05,345 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:05
2025-03-13 10:57:05,345 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 898.91it/s]
2025-03-13 10:57:05,383 [INFO]: There are 2575 embeddings of dim 49152
2025-03-13 10:57:05,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 10:57:05,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:05,384 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:57:05,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:05,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 10:57:05,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,385 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:05,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:57:05,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:05
2025-03-13 10:57:05,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 10:57:05,386 [INFO]: 	Creating the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,386 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:05
2025-03-13 10:57:05,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 10:57:05,389 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:05
2025-03-13 10:57:05,390 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:57:05,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.98it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.33it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.73it/s]100%|██████████| 11/11 [00:02<00:00,  4.89it/s]
2025-03-13 10:57:07,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:07
2025-03-13 10:57:38,543 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8983 secs
2025-03-13 10:57:38,543 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 10:57:38,543 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.41it/s]
2025-03-13 10:57:51,079 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5358 secs
2025-03-13 10:57:51,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6907 secs
2025-03-13 10:57:51,080 [INFO]: {
2025-03-13 10:57:51,080 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:51,080 [INFO]: 	index_param: efSearch=150
2025-03-13 10:57:51,080 [INFO]: 	index_path: knn.index
2025-03-13 10:57:51,080 [INFO]: 	size in bytes: 506615410
2025-03-13 10:57:51,080 [INFO]: 	avg_search_speed_ms: 8.770975888208405
2025-03-13 10:57:51,080 [INFO]: 	99p_search_speed_ms: 12.202714467421174
2025-03-13 10:57:51,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:51,080 [INFO]: 	nb vectors: 2575
2025-03-13 10:57:51,080 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:51,080 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-13 10:57:51,080 [INFO]: }
2025-03-13 10:57:51,081 [INFO]: 	>>> Finished "Creating the index" in 45.6946 secs
2025-03-13 10:57:51,081 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7356 secs
2025-03-13 10:57:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 42437 [episode count 10/20]
[retrieval_preprocessing] for episode 25647 [episode count 11/20], we have num_retrieval=np.int64(2629) num_query=np.int64(131)
2025-03-13 10:57:52,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:52,831 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:52
2025-03-13 10:57:52,831 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2145.42it/s]
2025-03-13 10:57:52,867 [INFO]: There are 2629 embeddings of dim 49152
2025-03-13 10:57:52,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 10:57:52,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:52
2025-03-13 10:57:52,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:52,868 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:57:52,869 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:52,869 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 10:57:52,869 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:52
2025-03-13 10:57:52,869 [INFO]: 542.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:52,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:57:52,870 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:52
2025-03-13 10:57:52,870 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:52,870 [INFO]: 	Creating the index 03/13/2025, 10:57:52
2025-03-13 10:57:52,870 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:52
2025-03-13 10:57:52,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:57:52,874 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:52
2025-03-13 10:57:52,874 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:57:52,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.97it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.67it/s]100%|██████████| 11/11 [00:01<00:00,  4.47it/s]100%|██████████| 11/11 [00:01<00:00,  5.54it/s]
2025-03-13 10:57:54,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:54
2025-03-13 10:58:22,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8573 secs
2025-03-13 10:58:22,723 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 10:58:22,723 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.24it/s]
2025-03-13 10:58:34,421 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6981 secs
2025-03-13 10:58:34,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5487 secs
2025-03-13 10:58:34,423 [INFO]: {
2025-03-13 10:58:34,423 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:34,423 [INFO]: 	index_param: efSearch=132
2025-03-13 10:58:34,423 [INFO]: 	index_path: knn.index
2025-03-13 10:58:34,423 [INFO]: 	size in bytes: 517239670
2025-03-13 10:58:34,423 [INFO]: 	avg_search_speed_ms: 7.1313493581523275
2025-03-13 10:58:34,423 [INFO]: 	99p_search_speed_ms: 9.949320445302874
2025-03-13 10:58:34,423 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:34,423 [INFO]: 	nb vectors: 2629
2025-03-13 10:58:34,423 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:34,423 [INFO]: 	compression ratio: 0.9993093375842576
2025-03-13 10:58:34,423 [INFO]: }
2025-03-13 10:58:34,423 [INFO]: 	>>> Finished "Creating the index" in 41.5526 secs
2025-03-13 10:58:34,423 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5921 secs
2025-03-13 10:58:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 25647 [episode count 11/20]
[retrieval_preprocessing] for episode 91185 [episode count 12/20], we have num_retrieval=np.int64(2631) num_query=np.int64(129)
2025-03-13 10:58:35,252 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:35,677 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:35
2025-03-13 10:58:35,677 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2077.42it/s]
2025-03-13 10:58:35,705 [INFO]: There are 2631 embeddings of dim 49152
2025-03-13 10:58:35,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 10:58:35,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:35
2025-03-13 10:58:35,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:35,705 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:58:35,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:35,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:35,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:35
2025-03-13 10:58:35,705 [INFO]: 543.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:35,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:58:35,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:35
2025-03-13 10:58:35,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:35,705 [INFO]: 	Creating the index 03/13/2025, 10:58:35
2025-03-13 10:58:35,705 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:35
2025-03-13 10:58:35,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:58:35,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:35
2025-03-13 10:58:35,706 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:58:35,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.96it/s] 73%|███████▎  | 8/11 [00:00<00:00, 36.62it/s]100%|██████████| 11/11 [00:01<00:00,  5.69it/s]
2025-03-13 10:58:37,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:37
2025-03-13 10:59:06,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8973 secs
2025-03-13 10:59:06,539 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 10:59:06,539 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.97it/s]
2025-03-13 10:59:18,145 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6060 secs
2025-03-13 10:59:18,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4405 secs
2025-03-13 10:59:18,147 [INFO]: {
2025-03-13 10:59:18,147 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:18,147 [INFO]: 	index_param: efSearch=184
2025-03-13 10:59:18,147 [INFO]: 	index_path: knn.index
2025-03-13 10:59:18,147 [INFO]: 	size in bytes: 517633150
2025-03-13 10:59:18,147 [INFO]: 	avg_search_speed_ms: 9.36225139447017
2025-03-13 10:59:18,147 [INFO]: 	99p_search_speed_ms: 13.760034386068565
2025-03-13 10:59:18,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:18,147 [INFO]: 	nb vectors: 2631
2025-03-13 10:59:18,147 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:18,147 [INFO]: 	compression ratio: 0.9993093525791383
2025-03-13 10:59:18,147 [INFO]: }
2025-03-13 10:59:18,147 [INFO]: 	>>> Finished "Creating the index" in 42.4418 secs
2025-03-13 10:59:18,147 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4700 secs
2025-03-13 10:59:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 91185 [episode count 12/20]
[retrieval_preprocessing] for episode 35181 [episode count 13/20], we have num_retrieval=np.int64(2540) num_query=np.int64(220)
2025-03-13 10:59:19,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:19,620 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:19
2025-03-13 10:59:19,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.17it/s]
2025-03-13 10:59:19,648 [INFO]: There are 2540 embeddings of dim 49152
2025-03-13 10:59:19,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 10:59:19,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:19
2025-03-13 10:59:19,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:19,648 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:59:19,648 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:19,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:59:19,648 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:19
2025-03-13 10:59:19,648 [INFO]: 524.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:19,648 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:59:19,648 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:19
2025-03-13 10:59:19,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:19,648 [INFO]: 	Creating the index 03/13/2025, 10:59:19
2025-03-13 10:59:19,648 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:19
2025-03-13 10:59:19,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:59:19,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:19
2025-03-13 10:59:19,649 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:59:19,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.86it/s] 60%|██████    | 6/10 [00:00<00:00, 32.43it/s]100%|██████████| 10/10 [00:01<00:00,  4.26it/s]100%|██████████| 10/10 [00:01<00:00,  5.10it/s]
2025-03-13 10:59:21,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:21
2025-03-13 10:59:50,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2008 secs
2025-03-13 10:59:50,814 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 10:59:50,814 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s]
2025-03-13 11:00:03,125 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3112 secs
2025-03-13 11:00:03,127 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4776 secs
2025-03-13 11:00:03,127 [INFO]: {
2025-03-13 11:00:03,127 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:03,127 [INFO]: 	index_param: efSearch=99
2025-03-13 11:00:03,127 [INFO]: 	index_path: knn.index
2025-03-13 11:00:03,127 [INFO]: 	size in bytes: 499729270
2025-03-13 11:00:03,127 [INFO]: 	avg_search_speed_ms: 6.405414471105648
2025-03-13 11:00:03,127 [INFO]: 	99p_search_speed_ms: 9.80238663032651
2025-03-13 11:00:03,127 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:03,127 [INFO]: 	nb vectors: 2540
2025-03-13 11:00:03,128 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:03,128 [INFO]: 	compression ratio: 0.9993097262443723
2025-03-13 11:00:03,128 [INFO]: }
2025-03-13 11:00:03,128 [INFO]: 	>>> Finished "Creating the index" in 43.4793 secs
2025-03-13 11:00:03,128 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5079 secs
2025-03-13 11:00:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 35181 [episode count 13/20]
[retrieval_preprocessing] for episode 18810 [episode count 14/20], we have num_retrieval=np.int64(2628) num_query=np.int64(132)
2025-03-13 11:00:04,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:04,812 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:04
2025-03-13 11:00:04,812 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-13 11:00:04,847 [INFO]: There are 2628 embeddings of dim 49152
2025-03-13 11:00:04,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 11:00:04,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:04
2025-03-13 11:00:04,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:04,848 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:00:04,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:04,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:00:04,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:04
2025-03-13 11:00:04,849 [INFO]: 542.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:04,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:00:04,849 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:04
2025-03-13 11:00:04,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:04,849 [INFO]: 	Creating the index 03/13/2025, 11:00:04
2025-03-13 11:00:04,849 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:04
2025-03-13 11:00:04,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:00:04,853 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:04
2025-03-13 11:00:04,853 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:00:04,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.49it/s] 82%|████████▏ | 9/11 [00:00<00:00, 40.54it/s]100%|██████████| 11/11 [00:01<00:00,  5.79it/s]
2025-03-13 11:00:06,759 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:06
2025-03-13 11:00:35,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6965 secs
2025-03-13 11:00:35,456 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 11:00:35,456 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.49it/s]
2025-03-13 11:00:47,731 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2748 secs
2025-03-13 11:00:47,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8798 secs
2025-03-13 11:00:47,733 [INFO]: {
2025-03-13 11:00:47,733 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:47,733 [INFO]: 	index_param: efSearch=154
2025-03-13 11:00:47,733 [INFO]: 	index_path: knn.index
2025-03-13 11:00:47,733 [INFO]: 	size in bytes: 517042930
2025-03-13 11:00:47,733 [INFO]: 	avg_search_speed_ms: 8.049455562745814
2025-03-13 11:00:47,733 [INFO]: 	99p_search_speed_ms: 11.060028374195097
2025-03-13 11:00:47,733 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:47,733 [INFO]: 	nb vectors: 2628
2025-03-13 11:00:47,733 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:47,733 [INFO]: 	compression ratio: 0.9993093300782587
2025-03-13 11:00:47,733 [INFO]: }
2025-03-13 11:00:47,733 [INFO]: 	>>> Finished "Creating the index" in 42.8839 secs
2025-03-13 11:00:47,733 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9211 secs
2025-03-13 11:00:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 18810 [episode count 14/20]
[retrieval_preprocessing] for episode 1642 [episode count 15/20], we have num_retrieval=np.int64(2629) num_query=np.int64(131)
2025-03-13 11:00:48,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:49,304 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:49
2025-03-13 11:00:49,305 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.22it/s]
2025-03-13 11:00:49,341 [INFO]: There are 2629 embeddings of dim 49152
2025-03-13 11:00:49,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 11:00:49,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:49,342 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:00:49,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:49,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:49,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,342 [INFO]: 542.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:49,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:00:49,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:49
2025-03-13 11:00:49,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:49,342 [INFO]: 	Creating the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:49
2025-03-13 11:00:49,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:00:49,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,343 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:00:49,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.93it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.99it/s]100%|██████████| 11/11 [00:02<00:00,  3.68it/s]100%|██████████| 11/11 [00:02<00:00,  4.58it/s]
2025-03-13 11:00:51,747 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:51
2025-03-13 11:01:22,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2302 secs
2025-03-13 11:01:22,978 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 11:01:22,978 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-13 11:01:36,137 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1592 secs
2025-03-13 11:01:36,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7960 secs
2025-03-13 11:01:36,139 [INFO]: {
2025-03-13 11:01:36,139 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:36,139 [INFO]: 	index_param: efSearch=172
2025-03-13 11:01:36,139 [INFO]: 	index_path: knn.index
2025-03-13 11:01:36,139 [INFO]: 	size in bytes: 517239670
2025-03-13 11:01:36,139 [INFO]: 	avg_search_speed_ms: 8.931161974448644
2025-03-13 11:01:36,139 [INFO]: 	99p_search_speed_ms: 12.84791831392794
2025-03-13 11:01:36,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:36,139 [INFO]: 	nb vectors: 2629
2025-03-13 11:01:36,139 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:36,140 [INFO]: 	compression ratio: 0.9993093375842576
2025-03-13 11:01:36,140 [INFO]: }
2025-03-13 11:01:36,140 [INFO]: 	>>> Finished "Creating the index" in 46.7976 secs
2025-03-13 11:01:36,140 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8350 secs
2025-03-13 11:01:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 1642 [episode count 15/20]
[retrieval_preprocessing] for episode 91464 [episode count 16/20], we have num_retrieval=np.int64(2649) num_query=np.int64(111)
2025-03-13 11:01:37,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:37,741 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:37
2025-03-13 11:01:37,741 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2138.86it/s]
2025-03-13 11:01:37,770 [INFO]: There are 2649 embeddings of dim 49152
2025-03-13 11:01:37,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 11:01:37,770 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:37
2025-03-13 11:01:37,770 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:37,770 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:01:37,771 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:37,771 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:01:37,771 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:37
2025-03-13 11:01:37,771 [INFO]: 546.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:37,771 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:01:37,771 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:37
2025-03-13 11:01:37,771 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:37,771 [INFO]: 	Creating the index 03/13/2025, 11:01:37
2025-03-13 11:01:37,771 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:37
2025-03-13 11:01:37,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:01:37,772 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:37
2025-03-13 11:01:37,772 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:01:37,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.95it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.52it/s]100%|██████████| 11/11 [00:02<00:00,  5.32it/s]
2025-03-13 11:01:39,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:39
2025-03-13 11:02:09,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9897 secs
2025-03-13 11:02:09,833 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 11:02:09,833 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-13 11:02:23,710 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8769 secs
2025-03-13 11:02:23,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9406 secs
2025-03-13 11:02:23,713 [INFO]: {
2025-03-13 11:02:23,713 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:23,713 [INFO]: 	index_param: efSearch=183
2025-03-13 11:02:23,713 [INFO]: 	index_path: knn.index
2025-03-13 11:02:23,713 [INFO]: 	size in bytes: 521174470
2025-03-13 11:02:23,713 [INFO]: 	avg_search_speed_ms: 9.93849574925809
2025-03-13 11:02:23,713 [INFO]: 	99p_search_speed_ms: 14.016336672939358
2025-03-13 11:02:23,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:23,713 [INFO]: 	nb vectors: 2649
2025-03-13 11:02:23,713 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:23,713 [INFO]: 	compression ratio: 0.9993094865141802
2025-03-13 11:02:23,713 [INFO]: }
2025-03-13 11:02:23,713 [INFO]: 	>>> Finished "Creating the index" in 45.9421 secs
2025-03-13 11:02:23,713 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9718 secs
2025-03-13 11:02:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 91464 [episode count 16/20]
[retrieval_preprocessing] for episode 17949 [episode count 17/20], we have num_retrieval=np.int64(2636) num_query=np.int64(124)
2025-03-13 11:02:24,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:25,260 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:25
2025-03-13 11:02:25,260 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1572.67it/s]
2025-03-13 11:02:25,288 [INFO]: There are 2636 embeddings of dim 49152
2025-03-13 11:02:25,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 11:02:25,288 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:25,288 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:02:25,288 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:25,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:25,288 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,288 [INFO]: 544.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:25,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:02:25,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:25
2025-03-13 11:02:25,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:25,288 [INFO]: 	Creating the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,288 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:25
2025-03-13 11:02:25,289 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:02:25,289 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,289 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:02:25,289 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.80it/s] 64%|██████▎   | 7/11 [00:00<00:00, 37.22it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.70it/s]
2025-03-13 11:02:27,631 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:27
2025-03-13 11:02:55,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0171 secs
2025-03-13 11:02:55,648 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 11:02:55,648 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 11:03:08,083 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4347 secs
2025-03-13 11:03:08,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7954 secs
2025-03-13 11:03:08,085 [INFO]: {
2025-03-13 11:03:08,085 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:08,085 [INFO]: 	index_param: efSearch=162
2025-03-13 11:03:08,085 [INFO]: 	index_path: knn.index
2025-03-13 11:03:08,085 [INFO]: 	size in bytes: 518616850
2025-03-13 11:03:08,085 [INFO]: 	avg_search_speed_ms: 9.675564043758873
2025-03-13 11:03:08,085 [INFO]: 	99p_search_speed_ms: 14.066301353741434
2025-03-13 11:03:08,085 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:08,085 [INFO]: 	nb vectors: 2636
2025-03-13 11:03:08,085 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:08,085 [INFO]: 	compression ratio: 0.9993093899667934
2025-03-13 11:03:08,085 [INFO]: }
2025-03-13 11:03:08,085 [INFO]: 	>>> Finished "Creating the index" in 42.7966 secs
2025-03-13 11:03:08,085 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8248 secs
2025-03-13 11:03:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 17949 [episode count 17/20]
[retrieval_preprocessing] for episode 42641 [episode count 18/20], we have num_retrieval=np.int64(2642) num_query=np.int64(118)
2025-03-13 11:03:09,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:09,421 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:09
2025-03-13 11:03:09,421 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2049.00it/s]
2025-03-13 11:03:09,449 [INFO]: There are 2642 embeddings of dim 49152
2025-03-13 11:03:09,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:03:09,449 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:09
2025-03-13 11:03:09,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:09,449 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:03:09,449 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:09,450 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:09,450 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:09
2025-03-13 11:03:09,450 [INFO]: 545.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:09,450 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:03:09,450 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:09
2025-03-13 11:03:09,450 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:09,450 [INFO]: 	Creating the index 03/13/2025, 11:03:09
2025-03-13 11:03:09,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:09
2025-03-13 11:03:09,451 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:03:09,451 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:09
2025-03-13 11:03:09,451 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:03:09,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.98it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.52it/s]100%|██████████| 11/11 [00:01<00:00,  5.57it/s]
2025-03-13 11:03:11,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:11
2025-03-13 11:03:39,383 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9537 secs
2025-03-13 11:03:39,383 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 11:03:39,384 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 11:03:52,889 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5057 secs
2025-03-13 11:03:52,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4402 secs
2025-03-13 11:03:52,892 [INFO]: {
2025-03-13 11:03:52,892 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:52,892 [INFO]: 	index_param: efSearch=205
2025-03-13 11:03:52,892 [INFO]: 	index_path: knn.index
2025-03-13 11:03:52,892 [INFO]: 	size in bytes: 519797290
2025-03-13 11:03:52,892 [INFO]: 	avg_search_speed_ms: 11.807173128922926
2025-03-13 11:03:52,892 [INFO]: 	99p_search_speed_ms: 16.966987147461623
2025-03-13 11:03:52,892 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:52,892 [INFO]: 	nb vectors: 2642
2025-03-13 11:03:52,892 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:52,892 [INFO]: 	compression ratio: 0.9993094346451864
2025-03-13 11:03:52,892 [INFO]: }
2025-03-13 11:03:52,892 [INFO]: 	>>> Finished "Creating the index" in 43.4422 secs
2025-03-13 11:03:52,892 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4711 secs
2025-03-13 11:03:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 42641 [episode count 18/20]
[retrieval_preprocessing] for episode 58650 [episode count 19/20], we have num_retrieval=np.int64(2619) num_query=np.int64(141)
2025-03-13 11:03:54,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:54,541 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:54
2025-03-13 11:03:54,541 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2149.82it/s]
2025-03-13 11:03:54,571 [INFO]: There are 2619 embeddings of dim 49152
2025-03-13 11:03:54,571 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 11:03:54,571 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:54
2025-03-13 11:03:54,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:54,572 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:03:54,572 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:54,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:03:54,572 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:54
2025-03-13 11:03:54,572 [INFO]: 540.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:54,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:03:54,573 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:54
2025-03-13 11:03:54,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:54,573 [INFO]: 	Creating the index 03/13/2025, 11:03:54
2025-03-13 11:03:54,573 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:54
2025-03-13 11:03:54,576 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:03:54,576 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:54
2025-03-13 11:03:54,576 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:03:54,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.84it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.23it/s]100%|██████████| 11/11 [00:02<00:00,  5.34it/s]
2025-03-13 11:03:56,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:56
2025-03-13 11:04:24,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1790 secs
2025-03-13 11:04:24,820 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 11:04:24,820 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-13 11:04:37,437 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6169 secs
2025-03-13 11:04:37,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8625 secs
2025-03-13 11:04:37,439 [INFO]: {
2025-03-13 11:04:37,439 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:37,439 [INFO]: 	index_param: efSearch=193
2025-03-13 11:04:37,439 [INFO]: 	index_path: knn.index
2025-03-13 11:04:37,439 [INFO]: 	size in bytes: 515272210
2025-03-13 11:04:37,439 [INFO]: 	avg_search_speed_ms: 9.54037247237195
2025-03-13 11:04:37,439 [INFO]: 	99p_search_speed_ms: 12.048137420788407
2025-03-13 11:04:37,439 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:37,439 [INFO]: 	nb vectors: 2619
2025-03-13 11:04:37,439 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:37,439 [INFO]: 	compression ratio: 0.9993093786292103
2025-03-13 11:04:37,439 [INFO]: }
2025-03-13 11:04:37,439 [INFO]: 	>>> Finished "Creating the index" in 42.8660 secs
2025-03-13 11:04:37,439 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8985 secs
2025-03-13 11:04:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 58650 [episode count 19/20]
2025-03-13 11:04:38: [retrieval_preprocessing] finished for -1_put_marker_in_mug [chosen_id count 0/260]
2025-03-13 11:04:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_cup [chosen_id count 1/260]
2025-03-13 11:04:39: [retrieval_preprocessing] we have num_total=2916 embedding_dim=49152
[retrieval_preprocessing] for episode 40961 [episode count 0/20], we have num_retrieval=np.int64(2778) num_query=np.int64(138)
2025-03-13 11:04:40,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:40,684 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:40
2025-03-13 11:04:40,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-13 11:04:40,719 [INFO]: There are 2778 embeddings of dim 49152
2025-03-13 11:04:40,719 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 11:04:40,719 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,720 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:40,720 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:04:40,720 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:40,720 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:40,720 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,720 [INFO]: 573.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:40,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:04:40,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:40
2025-03-13 11:04:40,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:40,720 [INFO]: 	Creating the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,720 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:40
2025-03-13 11:04:40,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:04:40,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,721 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:04:40,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.59it/s] 55%|█████▍    | 6/11 [00:00<00:00, 26.75it/s]100%|██████████| 11/11 [00:02<00:00,  3.42it/s]100%|██████████| 11/11 [00:02<00:00,  4.02it/s]
2025-03-13 11:04:43,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:43
2025-03-13 11:05:17,289 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8292 secs
2025-03-13 11:05:17,290 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 11:05:17,290 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.08it/s]
2025-03-13 11:05:29,027 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7370 secs
2025-03-13 11:05:29,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3083 secs
2025-03-13 11:05:29,029 [INFO]: {
2025-03-13 11:05:29,029 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:29,029 [INFO]: 	index_param: efSearch=159
2025-03-13 11:05:29,029 [INFO]: 	index_path: knn.index
2025-03-13 11:05:29,029 [INFO]: 	size in bytes: 546554230
2025-03-13 11:05:29,029 [INFO]: 	avg_search_speed_ms: 8.962223749844805
2025-03-13 11:05:29,029 [INFO]: 	99p_search_speed_ms: 16.062394052278236
2025-03-13 11:05:29,029 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:29,029 [INFO]: 	nb vectors: 2778
2025-03-13 11:05:29,029 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:29,029 [INFO]: 	compression ratio: 0.9993098470759251
2025-03-13 11:05:29,029 [INFO]: }
2025-03-13 11:05:29,029 [INFO]: 	>>> Finished "Creating the index" in 48.3095 secs
2025-03-13 11:05:29,029 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3454 secs
2025-03-13 11:05:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 40961 [episode count 0/20]
[retrieval_preprocessing] for episode 8202 [episode count 1/20], we have num_retrieval=np.int64(2767) num_query=np.int64(149)
2025-03-13 11:05:30,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:30,484 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:30
2025-03-13 11:05:30,484 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 881.34it/s]
2025-03-13 11:05:30,513 [INFO]: There are 2767 embeddings of dim 49152
2025-03-13 11:05:30,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:05:30,513 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:30
2025-03-13 11:05:30,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:30,513 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:05:30,513 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:30,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:30,513 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:30
2025-03-13 11:05:30,513 [INFO]: 571.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:30,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:05:30,513 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:30
2025-03-13 11:05:30,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:30,513 [INFO]: 	Creating the index 03/13/2025, 11:05:30
2025-03-13 11:05:30,513 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:30
2025-03-13 11:05:30,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:05:30,514 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:30
2025-03-13 11:05:30,515 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:05:30,515 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.45it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.96it/s]100%|██████████| 11/11 [00:02<00:00,  4.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.78it/s]
2025-03-13 11:05:32,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:32
2025-03-13 11:06:06,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4618 secs
2025-03-13 11:06:06,280 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:06:06,281 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.03it/s]
2025-03-13 11:06:19,457 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1766 secs
2025-03-13 11:06:19,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9445 secs
2025-03-13 11:06:19,459 [INFO]: {
2025-03-13 11:06:19,459 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:19,459 [INFO]: 	index_param: efSearch=249
2025-03-13 11:06:19,459 [INFO]: 	index_path: knn.index
2025-03-13 11:06:19,459 [INFO]: 	size in bytes: 544390090
2025-03-13 11:06:19,459 [INFO]: 	avg_search_speed_ms: 11.64995100131265
2025-03-13 11:06:19,459 [INFO]: 	99p_search_speed_ms: 15.37396425846964
2025-03-13 11:06:19,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:19,459 [INFO]: 	nb vectors: 2767
2025-03-13 11:06:19,459 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:19,459 [INFO]: 	compression ratio: 0.9993097706830042
2025-03-13 11:06:19,459 [INFO]: }
2025-03-13 11:06:19,459 [INFO]: 	>>> Finished "Creating the index" in 48.9459 secs
2025-03-13 11:06:19,459 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9753 secs
2025-03-13 11:06:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 8202 [episode count 1/20]
[retrieval_preprocessing] for episode 32784 [episode count 2/20], we have num_retrieval=np.int64(2790) num_query=np.int64(126)
2025-03-13 11:06:21,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:21,710 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:21
2025-03-13 11:06:21,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1353.44it/s]
2025-03-13 11:06:21,746 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 11:06:21,746 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 11:06:21,746 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:21,746 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:06:21,746 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:21,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:21,746 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,746 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:21,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:21,747 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:21
2025-03-13 11:06:21,747 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:21,747 [INFO]: 	Creating the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,747 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:21
2025-03-13 11:06:21,748 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:06:21,748 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,748 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:06:21,748 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.15it/s] 64%|██████▎   | 7/11 [00:00<00:00, 30.89it/s]100%|██████████| 11/11 [00:02<00:00,  3.49it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]
2025-03-13 11:06:24,284 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:24
2025-03-13 11:06:59,145 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8603 secs
2025-03-13 11:06:59,145 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 11:06:59,145 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-13 11:07:11,653 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5078 secs
2025-03-13 11:07:11,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9071 secs
2025-03-13 11:07:11,655 [INFO]: {
2025-03-13 11:07:11,655 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:11,655 [INFO]: 	index_param: efSearch=210
2025-03-13 11:07:11,655 [INFO]: 	index_path: knn.index
2025-03-13 11:07:11,655 [INFO]: 	size in bytes: 548915110
2025-03-13 11:07:11,655 [INFO]: 	avg_search_speed_ms: 10.613177243268566
2025-03-13 11:07:11,655 [INFO]: 	99p_search_speed_ms: 14.860680028796196
2025-03-13 11:07:11,655 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:11,655 [INFO]: 	nb vectors: 2790
2025-03-13 11:07:11,655 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:11,655 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 11:07:11,655 [INFO]: }
2025-03-13 11:07:11,655 [INFO]: 	>>> Finished "Creating the index" in 49.9086 secs
2025-03-13 11:07:11,655 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9449 secs
2025-03-13 11:07:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 32784 [episode count 2/20]
[retrieval_preprocessing] for episode 24593 [episode count 3/20], we have num_retrieval=np.int64(2781) num_query=np.int64(135)
2025-03-13 11:07:12,805 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:13,161 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:13
2025-03-13 11:07:13,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1861.65it/s]
2025-03-13 11:07:13,187 [INFO]: There are 2781 embeddings of dim 49152
2025-03-13 11:07:13,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:07:13,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:13
2025-03-13 11:07:13,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:13,187 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:07:13,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:13,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:13,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:13
2025-03-13 11:07:13,187 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:13,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:07:13,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:13
2025-03-13 11:07:13,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:13,187 [INFO]: 	Creating the index 03/13/2025, 11:07:13
2025-03-13 11:07:13,187 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:13
2025-03-13 11:07:13,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:07:13,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:13
2025-03-13 11:07:13,189 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:07:13,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.17it/s] 73%|███████▎  | 8/11 [00:00<00:00, 39.67it/s]100%|██████████| 11/11 [00:02<00:00,  4.97it/s]
2025-03-13 11:07:15,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:15
2025-03-13 11:07:46,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0213 secs
2025-03-13 11:07:46,426 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 11:07:46,426 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-13 11:07:58,253 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8264 secs
2025-03-13 11:07:58,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0670 secs
2025-03-13 11:07:58,256 [INFO]: {
2025-03-13 11:07:58,256 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:58,256 [INFO]: 	index_param: efSearch=229
2025-03-13 11:07:58,256 [INFO]: 	index_path: knn.index
2025-03-13 11:07:58,256 [INFO]: 	size in bytes: 547144450
2025-03-13 11:07:58,256 [INFO]: 	avg_search_speed_ms: 11.696387757138725
2025-03-13 11:07:58,256 [INFO]: 	99p_search_speed_ms: 17.93767964933068
2025-03-13 11:07:58,256 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:58,256 [INFO]: 	nb vectors: 2781
2025-03-13 11:07:58,256 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:58,256 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-13 11:07:58,256 [INFO]: }
2025-03-13 11:07:58,256 [INFO]: 	>>> Finished "Creating the index" in 45.0685 secs
2025-03-13 11:07:58,256 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0948 secs
2025-03-13 11:07:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 24593 [episode count 3/20]
[retrieval_preprocessing] for episode 24594 [episode count 4/20], we have num_retrieval=np.int64(2811) num_query=np.int64(105)
2025-03-13 11:08:00,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:00,716 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:00
2025-03-13 11:08:00,716 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.58it/s]
2025-03-13 11:08:00,751 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 11:08:00,751 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 11:08:00,752 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:00
2025-03-13 11:08:00,752 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:00,752 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:08:00,752 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:00,752 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:08:00,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:00
2025-03-13 11:08:00,753 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:00,753 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:08:00,753 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:00
2025-03-13 11:08:00,753 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:00,753 [INFO]: 	Creating the index 03/13/2025, 11:08:00
2025-03-13 11:08:00,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:00
2025-03-13 11:08:00,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:08:00,757 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:00
2025-03-13 11:08:00,757 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:08:00,758 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.39it/s] 75%|███████▌  | 9/12 [00:00<00:00, 40.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.81it/s]
2025-03-13 11:08:03,258 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:03
2025-03-13 11:08:35,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1792 secs
2025-03-13 11:08:35,438 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:08:35,438 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.11it/s]
2025-03-13 11:08:47,239 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8008 secs
2025-03-13 11:08:47,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4838 secs
2025-03-13 11:08:47,241 [INFO]: {
2025-03-13 11:08:47,241 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:47,241 [INFO]: 	index_param: efSearch=202
2025-03-13 11:08:47,241 [INFO]: 	index_path: knn.index
2025-03-13 11:08:47,241 [INFO]: 	size in bytes: 553046830
2025-03-13 11:08:47,241 [INFO]: 	avg_search_speed_ms: 10.878570729603425
2025-03-13 11:08:47,241 [INFO]: 	99p_search_speed_ms: 16.818542100954797
2025-03-13 11:08:47,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:47,241 [INFO]: 	nb vectors: 2811
2025-03-13 11:08:47,241 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:47,241 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 11:08:47,241 [INFO]: }
2025-03-13 11:08:47,241 [INFO]: 	>>> Finished "Creating the index" in 46.4880 secs
2025-03-13 11:08:47,241 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5252 secs
2025-03-13 11:08:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 24594 [episode count 4/20]
[retrieval_preprocessing] for episode 73745 [episode count 5/20], we have num_retrieval=np.int64(2756) num_query=np.int64(160)
2025-03-13 11:08:49,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:50,055 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:50
2025-03-13 11:08:50,055 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.08it/s]
2025-03-13 11:08:50,089 [INFO]: There are 2756 embeddings of dim 49152
2025-03-13 11:08:50,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 11:08:50,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:50,090 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:08:50,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:50,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:50,090 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,090 [INFO]: 568.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:50,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:08:50,090 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:50
2025-03-13 11:08:50,090 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:50,090 [INFO]: 	Creating the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,090 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:50
2025-03-13 11:08:50,092 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:08:50,092 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,092 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:08:50,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.26it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.94it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.83it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.22it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.29it/s] 91%|█████████ | 10/11 [00:00<00:00, 19.47it/s]100%|██████████| 11/11 [00:03<00:00,  3.43it/s]
2025-03-13 11:08:53,310 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:53
2025-03-13 11:09:23,685 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3747 secs
2025-03-13 11:09:23,685 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 11:09:23,685 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.72it/s]
2025-03-13 11:09:37,149 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4633 secs
2025-03-13 11:09:37,151 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0590 secs
2025-03-13 11:09:37,151 [INFO]: {
2025-03-13 11:09:37,151 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:37,151 [INFO]: 	index_param: efSearch=169
2025-03-13 11:09:37,151 [INFO]: 	index_path: knn.index
2025-03-13 11:09:37,151 [INFO]: 	size in bytes: 542225770
2025-03-13 11:09:37,151 [INFO]: 	avg_search_speed_ms: 8.83565394371557
2025-03-13 11:09:37,151 [INFO]: 	99p_search_speed_ms: 17.59513848694044
2025-03-13 11:09:37,151 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:37,151 [INFO]: 	nb vectors: 2756
2025-03-13 11:09:37,151 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:37,151 [INFO]: 	compression ratio: 0.9993100254161656
2025-03-13 11:09:37,151 [INFO]: }
2025-03-13 11:09:37,151 [INFO]: 	>>> Finished "Creating the index" in 47.0610 secs
2025-03-13 11:09:37,151 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0959 secs
2025-03-13 11:09:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 73745 [episode count 5/20]
[retrieval_preprocessing] for episode 57370 [episode count 6/20], we have num_retrieval=np.int64(2780) num_query=np.int64(136)
2025-03-13 11:09:38,586 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:38,958 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:38
2025-03-13 11:09:38,958 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.00it/s]
2025-03-13 11:09:38,993 [INFO]: There are 2780 embeddings of dim 49152
2025-03-13 11:09:38,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 11:09:38,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:38
2025-03-13 11:09:38,994 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:38,994 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:09:38,994 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:38,994 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:09:38,994 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:38
2025-03-13 11:09:38,994 [INFO]: 573.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:38,994 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:09:38,994 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:38
2025-03-13 11:09:38,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:38,994 [INFO]: 	Creating the index 03/13/2025, 11:09:38
2025-03-13 11:09:38,994 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:38
2025-03-13 11:09:38,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:09:38,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:38
2025-03-13 11:09:38,995 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:09:38,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.81it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.30it/s]100%|██████████| 11/11 [00:02<00:00,  3.97it/s]100%|██████████| 11/11 [00:02<00:00,  4.65it/s]
2025-03-13 11:09:41,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:41
2025-03-13 11:10:15,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6752 secs
2025-03-13 11:10:15,039 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 11:10:15,039 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 11:10:29,130 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0913 secs
2025-03-13 11:10:29,132 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1371 secs
2025-03-13 11:10:29,132 [INFO]: {
2025-03-13 11:10:29,132 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:29,132 [INFO]: 	index_param: efSearch=183
2025-03-13 11:10:29,132 [INFO]: 	index_path: knn.index
2025-03-13 11:10:29,132 [INFO]: 	size in bytes: 546947710
2025-03-13 11:10:29,132 [INFO]: 	avg_search_speed_ms: 9.666204995786151
2025-03-13 11:10:29,132 [INFO]: 	99p_search_speed_ms: 13.396729282103477
2025-03-13 11:10:29,132 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:29,132 [INFO]: 	nb vectors: 2780
2025-03-13 11:10:29,132 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:29,132 [INFO]: 	compression ratio: 0.9993098609005969
2025-03-13 11:10:29,132 [INFO]: }
2025-03-13 11:10:29,132 [INFO]: 	>>> Finished "Creating the index" in 50.1386 secs
2025-03-13 11:10:29,132 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1747 secs
2025-03-13 11:10:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 57370 [episode count 6/20]
[retrieval_preprocessing] for episode 90167 [episode count 7/20], we have num_retrieval=np.int64(2765) num_query=np.int64(151)
2025-03-13 11:10:30,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:30,917 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:30
2025-03-13 11:10:30,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.83it/s]
2025-03-13 11:10:30,951 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 11:10:30,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 11:10:30,952 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:30
2025-03-13 11:10:30,952 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:30,952 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:10:30,952 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:30,952 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:10:30,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:30
2025-03-13 11:10:30,953 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:30,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:10:30,953 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:30
2025-03-13 11:10:30,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:10:30,954 [INFO]: 	Creating the index 03/13/2025, 11:10:30
2025-03-13 11:10:30,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:30
2025-03-13 11:10:30,957 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:10:30,957 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:30
2025-03-13 11:10:30,958 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:10:30,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.52it/s] 55%|█████▍    | 6/11 [00:00<00:00, 26.28it/s]100%|██████████| 11/11 [00:02<00:00,  3.77it/s]100%|██████████| 11/11 [00:02<00:00,  4.53it/s]
2025-03-13 11:10:33,394 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:33
2025-03-13 11:11:07,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5777 secs
2025-03-13 11:11:07,973 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 11:11:07,973 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 11:11:20,264 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2917 secs
2025-03-13 11:11:20,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3091 secs
2025-03-13 11:11:20,267 [INFO]: {
2025-03-13 11:11:20,267 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:20,267 [INFO]: 	index_param: efSearch=212
2025-03-13 11:11:20,267 [INFO]: 	index_path: knn.index
2025-03-13 11:11:20,267 [INFO]: 	size in bytes: 543996610
2025-03-13 11:11:20,267 [INFO]: 	avg_search_speed_ms: 10.710241998709355
2025-03-13 11:11:20,267 [INFO]: 	99p_search_speed_ms: 16.132471242453892
2025-03-13 11:11:20,267 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:20,267 [INFO]: 	nb vectors: 2765
2025-03-13 11:11:20,267 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:20,267 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 11:11:20,267 [INFO]: }
2025-03-13 11:11:20,267 [INFO]: 	>>> Finished "Creating the index" in 49.3132 secs
2025-03-13 11:11:20,267 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3496 secs
2025-03-13 11:11:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 90167 [episode count 7/20]
[retrieval_preprocessing] for episode 8528 [episode count 8/20], we have num_retrieval=np.int64(2713) num_query=np.int64(203)
2025-03-13 11:11:21,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:22,253 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:22
2025-03-13 11:11:22,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1839.61it/s]
2025-03-13 11:11:22,280 [INFO]: There are 2713 embeddings of dim 49152
2025-03-13 11:11:22,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:11:22,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:22
2025-03-13 11:11:22,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:22,280 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:11:22,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:22,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:22,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:22
2025-03-13 11:11:22,280 [INFO]: 559.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:22,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:22,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:22
2025-03-13 11:11:22,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:22,280 [INFO]: 	Creating the index 03/13/2025, 11:11:22
2025-03-13 11:11:22,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:22
2025-03-13 11:11:22,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:11:22,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:22
2025-03-13 11:11:22,281 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:11:22,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.70it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.78it/s]
2025-03-13 11:11:24,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:24
2025-03-13 11:11:54,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0043 secs
2025-03-13 11:11:54,589 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:11:54,589 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 11:12:09,441 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8517 secs
2025-03-13 11:12:09,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1613 secs
2025-03-13 11:12:09,443 [INFO]: {
2025-03-13 11:12:09,443 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:09,443 [INFO]: 	index_param: efSearch=215
2025-03-13 11:12:09,443 [INFO]: 	index_path: knn.index
2025-03-13 11:12:09,443 [INFO]: 	size in bytes: 533765950
2025-03-13 11:12:09,443 [INFO]: 	avg_search_speed_ms: 12.06492734859519
2025-03-13 11:12:09,443 [INFO]: 	99p_search_speed_ms: 19.060115320608023
2025-03-13 11:12:09,443 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:09,443 [INFO]: 	nb vectors: 2713
2025-03-13 11:12:09,443 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:09,443 [INFO]: 	compression ratio: 0.9993097236719577
2025-03-13 11:12:09,443 [INFO]: }
2025-03-13 11:12:09,443 [INFO]: 	>>> Finished "Creating the index" in 47.1627 secs
2025-03-13 11:12:09,443 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1899 secs
2025-03-13 11:12:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 8528 [episode count 8/20]
[retrieval_preprocessing] for episode 90207 [episode count 9/20], we have num_retrieval=np.int64(2765) num_query=np.int64(151)
2025-03-13 11:12:11,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:11,724 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:11
2025-03-13 11:12:11,724 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 11:12:11,756 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 11:12:11,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:12:11,756 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,757 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:11,757 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:12:11,757 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:11,757 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:12:11,757 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,758 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:11,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:12:11,758 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:11
2025-03-13 11:12:11,758 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:11,758 [INFO]: 	Creating the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:11
2025-03-13 11:12:11,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:12:11,762 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,762 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:12:11,763 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.93it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.05it/s]100%|██████████| 11/11 [00:02<00:00,  2.95it/s]100%|██████████| 11/11 [00:02<00:00,  3.72it/s]
2025-03-13 11:12:14,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:14
2025-03-13 11:12:45,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1868 secs
2025-03-13 11:12:45,916 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 11:12:45,916 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-13 11:12:59,013 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0968 secs
2025-03-13 11:12:59,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2522 secs
2025-03-13 11:12:59,015 [INFO]: {
2025-03-13 11:12:59,015 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:59,015 [INFO]: 	index_param: efSearch=190
2025-03-13 11:12:59,015 [INFO]: 	index_path: knn.index
2025-03-13 11:12:59,015 [INFO]: 	size in bytes: 543996610
2025-03-13 11:12:59,015 [INFO]: 	avg_search_speed_ms: 9.356476763573495
2025-03-13 11:12:59,015 [INFO]: 	99p_search_speed_ms: 13.639158112928266
2025-03-13 11:12:59,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:59,015 [INFO]: 	nb vectors: 2765
2025-03-13 11:12:59,015 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:59,015 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 11:12:59,015 [INFO]: }
2025-03-13 11:12:59,015 [INFO]: 	>>> Finished "Creating the index" in 47.2562 secs
2025-03-13 11:12:59,015 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2909 secs
2025-03-13 11:12:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 90207 [episode count 9/20]
[retrieval_preprocessing] for episode 57447 [episode count 10/20], we have num_retrieval=np.int64(2762) num_query=np.int64(154)
2025-03-13 11:13:00,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:00,829 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:00
2025-03-13 11:13:00,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  6.05it/s]100%|██████████| 1/1 [00:00<00:00,  6.03it/s]
2025-03-13 11:13:01,027 [INFO]: There are 2762 embeddings of dim 49152
2025-03-13 11:13:01,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1987 secs
2025-03-13 11:13:01,028 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:01
2025-03-13 11:13:01,028 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:01,028 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:13:01,028 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:01,028 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:13:01,029 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:01
2025-03-13 11:13:01,029 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:01,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:13:01,029 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:01
2025-03-13 11:13:01,029 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:01,030 [INFO]: 	Creating the index 03/13/2025, 11:13:01
2025-03-13 11:13:01,030 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:01
2025-03-13 11:13:01,032 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:13:01,033 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:01
2025-03-13 11:13:01,033 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:13:01,033 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.46it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.42it/s]100%|██████████| 11/11 [00:02<00:00,  3.63it/s]100%|██████████| 11/11 [00:02<00:00,  4.52it/s]
2025-03-13 11:13:03,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:03
2025-03-13 11:13:36,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9255 secs
2025-03-13 11:13:36,397 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 11:13:36,397 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.36it/s]
2025-03-13 11:13:49,500 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1038 secs
2025-03-13 11:13:49,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4698 secs
2025-03-13 11:13:49,503 [INFO]: {
2025-03-13 11:13:49,503 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:49,503 [INFO]: 	index_param: efSearch=196
2025-03-13 11:13:49,503 [INFO]: 	index_path: knn.index
2025-03-13 11:13:49,503 [INFO]: 	size in bytes: 543406270
2025-03-13 11:13:49,503 [INFO]: 	avg_search_speed_ms: 9.963661933640589
2025-03-13 11:13:49,503 [INFO]: 	99p_search_speed_ms: 14.15434586349875
2025-03-13 11:13:49,503 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:49,503 [INFO]: 	nb vectors: 2762
2025-03-13 11:13:49,503 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:49,503 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-13 11:13:49,503 [INFO]: }
2025-03-13 11:13:49,503 [INFO]: 	>>> Finished "Creating the index" in 48.4732 secs
2025-03-13 11:13:49,503 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6740 secs
2025-03-13 11:13:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 57447 [episode count 10/20]
[retrieval_preprocessing] for episode 65748 [episode count 11/20], we have num_retrieval=np.int64(2764) num_query=np.int64(152)
2025-03-13 11:13:50,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:51,308 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:51
2025-03-13 11:13:51,308 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.54it/s]
2025-03-13 11:13:51,336 [INFO]: There are 2764 embeddings of dim 49152
2025-03-13 11:13:51,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 11:13:51,337 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:51
2025-03-13 11:13:51,337 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:51,337 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:13:51,337 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:51,337 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:51,337 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:51
2025-03-13 11:13:51,337 [INFO]: 570.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:51,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:51,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:51
2025-03-13 11:13:51,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:51,337 [INFO]: 	Creating the index 03/13/2025, 11:13:51
2025-03-13 11:13:51,337 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:51
2025-03-13 11:13:51,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:13:51,338 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:51
2025-03-13 11:13:51,338 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:13:51,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.16it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.21it/s]100%|██████████| 11/11 [00:02<00:00,  4.33it/s]100%|██████████| 11/11 [00:02<00:00,  5.06it/s]
2025-03-13 11:13:53,514 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:53
2025-03-13 11:14:26,152 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6376 secs
2025-03-13 11:14:26,152 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:14:26,152 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 11:14:38,794 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6422 secs
2025-03-13 11:14:38,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4588 secs
2025-03-13 11:14:38,797 [INFO]: {
2025-03-13 11:14:38,797 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:38,797 [INFO]: 	index_param: efSearch=219
2025-03-13 11:14:38,797 [INFO]: 	index_path: knn.index
2025-03-13 11:14:38,797 [INFO]: 	size in bytes: 543799810
2025-03-13 11:14:38,797 [INFO]: 	avg_search_speed_ms: 11.746027783715896
2025-03-13 11:14:38,797 [INFO]: 	99p_search_speed_ms: 21.030971484724443
2025-03-13 11:14:38,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:38,797 [INFO]: 	nb vectors: 2764
2025-03-13 11:14:38,797 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:38,797 [INFO]: 	compression ratio: 0.9993098600016062
2025-03-13 11:14:38,797 [INFO]: }
2025-03-13 11:14:38,797 [INFO]: 	>>> Finished "Creating the index" in 47.4602 secs
2025-03-13 11:14:38,797 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4893 secs
2025-03-13 11:14:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 65748 [episode count 11/20]
[retrieval_preprocessing] for episode 41187 [episode count 12/20], we have num_retrieval=np.int64(2761) num_query=np.int64(155)
2025-03-13 11:14:41,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:41,426 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:41
2025-03-13 11:14:41,426 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.73it/s]
2025-03-13 11:14:41,457 [INFO]: There are 2761 embeddings of dim 49152
2025-03-13 11:14:41,457 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 11:14:41,457 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:41,458 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:14:41,458 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:41,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:14:41,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,458 [INFO]: 569.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:41,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:14:41,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:41
2025-03-13 11:14:41,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:41,458 [INFO]: 	Creating the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,458 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:41
2025-03-13 11:14:41,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:14:41,459 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:41
2025-03-13 11:14:41,459 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:14:41,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.67it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.55it/s]100%|██████████| 11/11 [00:02<00:00,  3.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.59it/s]
2025-03-13 11:14:43,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:43
2025-03-13 11:15:15,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2460 secs
2025-03-13 11:15:15,107 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:15:15,107 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.71it/s]
2025-03-13 11:15:27,566 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4592 secs
2025-03-13 11:15:27,568 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1088 secs
2025-03-13 11:15:27,568 [INFO]: {
2025-03-13 11:15:27,568 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:27,568 [INFO]: 	index_param: efSearch=223
2025-03-13 11:15:27,568 [INFO]: 	index_path: knn.index
2025-03-13 11:15:27,568 [INFO]: 	size in bytes: 543209530
2025-03-13 11:15:27,568 [INFO]: 	avg_search_speed_ms: 11.2787514315658
2025-03-13 11:15:27,568 [INFO]: 	99p_search_speed_ms: 18.360103296581656
2025-03-13 11:15:27,568 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:27,568 [INFO]: 	nb vectors: 2761
2025-03-13 11:15:27,568 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:27,568 [INFO]: 	compression ratio: 0.9993099495143246
2025-03-13 11:15:27,568 [INFO]: }
2025-03-13 11:15:27,568 [INFO]: 	>>> Finished "Creating the index" in 46.1103 secs
2025-03-13 11:15:27,568 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1423 secs
2025-03-13 11:15:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 41187 [episode count 12/20]
[retrieval_preprocessing] for episode 8612 [episode count 13/20], we have num_retrieval=np.int64(2796) num_query=np.int64(120)
2025-03-13 11:15:28,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:29,315 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:29
2025-03-13 11:15:29,316 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2080.51it/s]
2025-03-13 11:15:29,341 [INFO]: There are 2796 embeddings of dim 49152
2025-03-13 11:15:29,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:15:29,341 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:29
2025-03-13 11:15:29,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:29,341 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:15:29,341 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:29,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:29,341 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:29
2025-03-13 11:15:29,341 [INFO]: 577.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:29,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:15:29,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:29
2025-03-13 11:15:29,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:29,341 [INFO]: 	Creating the index 03/13/2025, 11:15:29
2025-03-13 11:15:29,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:29
2025-03-13 11:15:29,342 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:15:29,342 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:29
2025-03-13 11:15:29,342 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:15:29,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.44it/s] 50%|█████     | 6/12 [00:00<00:00, 31.70it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.20it/s]100%|██████████| 12/12 [00:02<00:00,  5.59it/s]
2025-03-13 11:15:31,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:31
2025-03-13 11:16:02,135 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6403 secs
2025-03-13 11:16:02,135 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 11:16:02,135 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.33it/s]
2025-03-13 11:16:14,853 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7177 secs
2025-03-13 11:16:14,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5126 secs
2025-03-13 11:16:14,855 [INFO]: {
2025-03-13 11:16:14,855 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:14,855 [INFO]: 	index_param: efSearch=180
2025-03-13 11:16:14,855 [INFO]: 	index_path: knn.index
2025-03-13 11:16:14,855 [INFO]: 	size in bytes: 550095610
2025-03-13 11:16:14,855 [INFO]: 	avg_search_speed_ms: 9.010599025206321
2025-03-13 11:16:14,855 [INFO]: 	99p_search_speed_ms: 11.173104885965596
2025-03-13 11:16:14,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:14,855 [INFO]: 	nb vectors: 2796
2025-03-13 11:16:14,855 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:14,855 [INFO]: 	compression ratio: 0.9993098617892988
2025-03-13 11:16:14,855 [INFO]: }
2025-03-13 11:16:14,855 [INFO]: 	>>> Finished "Creating the index" in 45.5139 secs
2025-03-13 11:16:14,855 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5398 secs
2025-03-13 11:16:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 8612 [episode count 13/20]
[retrieval_preprocessing] for episode 25015 [episode count 14/20], we have num_retrieval=np.int64(2747) num_query=np.int64(169)
2025-03-13 11:16:16,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:16,483 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:16
2025-03-13 11:16:16,483 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2511.56it/s]
2025-03-13 11:16:16,513 [INFO]: There are 2747 embeddings of dim 49152
2025-03-13 11:16:16,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 11:16:16,514 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:16
2025-03-13 11:16:16,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:16,514 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:16:16,514 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:16,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:16:16,514 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:16
2025-03-13 11:16:16,514 [INFO]: 566.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:16,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:16:16,514 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:16
2025-03-13 11:16:16,514 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:16,514 [INFO]: 	Creating the index 03/13/2025, 11:16:16
2025-03-13 11:16:16,514 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:16
2025-03-13 11:16:16,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 11:16:16,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:16
2025-03-13 11:16:16,516 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:16:16,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.22it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]100%|██████████| 11/11 [00:02<00:00,  5.19it/s]
2025-03-13 11:16:18,639 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:18
2025-03-13 11:16:47,519 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8801 secs
2025-03-13 11:16:47,519 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 11:16:47,519 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 11:17:01,601 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0817 secs
2025-03-13 11:17:01,603 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0868 secs
2025-03-13 11:17:01,603 [INFO]: {
2025-03-13 11:17:01,603 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:01,603 [INFO]: 	index_param: efSearch=230
2025-03-13 11:17:01,603 [INFO]: 	index_path: knn.index
2025-03-13 11:17:01,603 [INFO]: 	size in bytes: 540455110
2025-03-13 11:17:01,603 [INFO]: 	avg_search_speed_ms: 11.735348883544056
2025-03-13 11:17:01,603 [INFO]: 	99p_search_speed_ms: 16.854902144987136
2025-03-13 11:17:01,603 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:01,603 [INFO]: 	nb vectors: 2747
2025-03-13 11:17:01,603 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:01,603 [INFO]: 	compression ratio: 0.999309963042074
2025-03-13 11:17:01,603 [INFO]: }
2025-03-13 11:17:01,603 [INFO]: 	>>> Finished "Creating the index" in 45.0890 secs
2025-03-13 11:17:01,603 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1206 secs
2025-03-13 11:17:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 25015 [episode count 14/20]
[retrieval_preprocessing] for episode 49620 [episode count 15/20], we have num_retrieval=np.int64(2760) num_query=np.int64(156)
2025-03-13 11:17:03,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:03,978 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:03
2025-03-13 11:17:03,978 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-13 11:17:04,005 [INFO]: There are 2760 embeddings of dim 49152
2025-03-13 11:17:04,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:17:04,005 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:04
2025-03-13 11:17:04,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:04,005 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:17:04,005 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:04,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:04,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:04
2025-03-13 11:17:04,006 [INFO]: 569.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:04,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:04,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:04
2025-03-13 11:17:04,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:04,006 [INFO]: 	Creating the index 03/13/2025, 11:17:04
2025-03-13 11:17:04,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:04
2025-03-13 11:17:04,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:17:04,007 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:04
2025-03-13 11:17:04,007 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:17:04,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.92it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.16it/s]100%|██████████| 11/11 [00:02<00:00,  4.28it/s]100%|██████████| 11/11 [00:02<00:00,  5.01it/s]
2025-03-13 11:17:06,206 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:06
2025-03-13 11:17:40,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2555 secs
2025-03-13 11:17:40,462 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 11:17:40,462 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 11:17:54,007 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5443 secs
2025-03-13 11:17:54,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0017 secs
2025-03-13 11:17:54,009 [INFO]: {
2025-03-13 11:17:54,009 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:54,009 [INFO]: 	index_param: efSearch=209
2025-03-13 11:17:54,009 [INFO]: 	index_path: knn.index
2025-03-13 11:17:54,009 [INFO]: 	size in bytes: 543012790
2025-03-13 11:17:54,009 [INFO]: 	avg_search_speed_ms: 10.040373359778783
2025-03-13 11:17:54,009 [INFO]: 	99p_search_speed_ms: 12.982155836652964
2025-03-13 11:17:54,009 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:54,009 [INFO]: 	nb vectors: 2760
2025-03-13 11:17:54,009 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:54,009 [INFO]: 	compression ratio: 0.9993099425890134
2025-03-13 11:17:54,009 [INFO]: }
2025-03-13 11:17:54,009 [INFO]: 	>>> Finished "Creating the index" in 50.0032 secs
2025-03-13 11:17:54,009 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0308 secs
2025-03-13 11:17:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 49620 [episode count 15/20]
[retrieval_preprocessing] for episode 25076 [episode count 16/20], we have num_retrieval=np.int64(2795) num_query=np.int64(121)
2025-03-13 11:17:55,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:56,084 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:56
2025-03-13 11:17:56,084 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.79it/s]
2025-03-13 11:17:56,121 [INFO]: There are 2795 embeddings of dim 49152
2025-03-13 11:17:56,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 11:17:56,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:56
2025-03-13 11:17:56,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:56,122 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:17:56,122 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:56,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:56,122 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:56
2025-03-13 11:17:56,122 [INFO]: 576.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:56,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:56,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:56
2025-03-13 11:17:56,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:56,122 [INFO]: 	Creating the index 03/13/2025, 11:17:56
2025-03-13 11:17:56,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:56
2025-03-13 11:17:56,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:17:56,123 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:56
2025-03-13 11:17:56,123 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:17:56,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.29it/s] 50%|█████     | 6/12 [00:00<00:00, 31.85it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.55it/s]100%|██████████| 12/12 [00:02<00:00,  4.94it/s]
2025-03-13 11:17:58,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:58
2025-03-13 11:18:30,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3068 secs
2025-03-13 11:18:30,861 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 11:18:30,861 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.85it/s]
2025-03-13 11:18:44,659 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7985 secs
2025-03-13 11:18:44,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5380 secs
2025-03-13 11:18:44,661 [INFO]: {
2025-03-13 11:18:44,661 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:44,661 [INFO]: 	index_param: efSearch=245
2025-03-13 11:18:44,661 [INFO]: 	index_path: knn.index
2025-03-13 11:18:44,661 [INFO]: 	size in bytes: 549898870
2025-03-13 11:18:44,661 [INFO]: 	avg_search_speed_ms: 11.542489317663641
2025-03-13 11:18:44,661 [INFO]: 	99p_search_speed_ms: 14.299943163059654
2025-03-13 11:18:44,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:44,661 [INFO]: 	nb vectors: 2795
2025-03-13 11:18:44,661 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:44,661 [INFO]: 	compression ratio: 0.9993098549193237
2025-03-13 11:18:44,662 [INFO]: }
2025-03-13 11:18:44,662 [INFO]: 	>>> Finished "Creating the index" in 48.5396 secs
2025-03-13 11:18:44,662 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5776 secs
2025-03-13 11:18:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 25076 [episode count 16/20]
[retrieval_preprocessing] for episode 49711 [episode count 17/20], we have num_retrieval=np.int64(2773) num_query=np.int64(143)
2025-03-13 11:18:46,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:47,096 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:47
2025-03-13 11:18:47,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2076.39it/s]
2025-03-13 11:18:47,124 [INFO]: There are 2773 embeddings of dim 49152
2025-03-13 11:18:47,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:18:47,125 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:47
2025-03-13 11:18:47,125 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:47,125 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:18:47,125 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:47,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:18:47,126 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:47
2025-03-13 11:18:47,126 [INFO]: 572.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:47,127 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:18:47,127 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:47
2025-03-13 11:18:47,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:47,127 [INFO]: 	Creating the index 03/13/2025, 11:18:47
2025-03-13 11:18:47,128 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:47
2025-03-13 11:18:47,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:18:47,131 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:47
2025-03-13 11:18:47,131 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:18:47,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.15it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.17it/s]100%|██████████| 11/11 [00:02<00:00,  4.11it/s]100%|██████████| 11/11 [00:02<00:00,  5.10it/s]
2025-03-13 11:18:49,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:49
2025-03-13 11:19:18,801 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5078 secs
2025-03-13 11:19:18,801 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:19:18,801 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 11:19:32,810 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0087 secs
2025-03-13 11:19:32,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6814 secs
2025-03-13 11:19:32,812 [INFO]: {
2025-03-13 11:19:32,812 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:32,812 [INFO]: 	index_param: efSearch=251
2025-03-13 11:19:32,812 [INFO]: 	index_path: knn.index
2025-03-13 11:19:32,812 [INFO]: 	size in bytes: 545570530
2025-03-13 11:19:32,812 [INFO]: 	avg_search_speed_ms: 12.230879944819765
2025-03-13 11:19:32,812 [INFO]: 	99p_search_speed_ms: 15.90435679070652
2025-03-13 11:19:32,812 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:32,812 [INFO]: 	nb vectors: 2773
2025-03-13 11:19:32,812 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:32,812 [INFO]: 	compression ratio: 0.9993098124270019
2025-03-13 11:19:32,813 [INFO]: }
2025-03-13 11:19:32,813 [INFO]: 	>>> Finished "Creating the index" in 45.6851 secs
2025-03-13 11:19:32,813 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7169 secs
2025-03-13 11:19:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 49711 [episode count 17/20]
[retrieval_preprocessing] for episode 49714 [episode count 18/20], we have num_retrieval=np.int64(2759) num_query=np.int64(157)
2025-03-13 11:19:34,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:35,433 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:35
2025-03-13 11:19:35,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-13 11:19:35,471 [INFO]: There are 2759 embeddings of dim 49152
2025-03-13 11:19:35,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0389 secs
2025-03-13 11:19:35,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:35
2025-03-13 11:19:35,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:35,472 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:19:35,472 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:35,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:35,472 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:35
2025-03-13 11:19:35,472 [INFO]: 569.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:35,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:19:35,472 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:35
2025-03-13 11:19:35,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:35,472 [INFO]: 	Creating the index 03/13/2025, 11:19:35
2025-03-13 11:19:35,473 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:35
2025-03-13 11:19:35,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:19:35,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:35
2025-03-13 11:19:35,474 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:19:35,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.24it/s] 55%|█████▍    | 6/11 [00:00<00:00, 25.54it/s]100%|██████████| 11/11 [00:02<00:00,  4.32it/s]100%|██████████| 11/11 [00:02<00:00,  5.02it/s]
2025-03-13 11:19:37,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:37
2025-03-13 11:20:10,101 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4267 secs
2025-03-13 11:20:10,102 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 11:20:10,102 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.73it/s]
2025-03-13 11:20:23,599 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4969 secs
2025-03-13 11:20:23,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1273 secs
2025-03-13 11:20:23,601 [INFO]: {
2025-03-13 11:20:23,601 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:23,601 [INFO]: 	index_param: efSearch=211
2025-03-13 11:20:23,601 [INFO]: 	index_path: knn.index
2025-03-13 11:20:23,601 [INFO]: 	size in bytes: 542815990
2025-03-13 11:20:23,601 [INFO]: 	avg_search_speed_ms: 10.198154784577627
2025-03-13 11:20:23,601 [INFO]: 	99p_search_speed_ms: 17.200408643111587
2025-03-13 11:20:23,601 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:23,601 [INFO]: 	nb vectors: 2759
2025-03-13 11:20:23,601 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:23,601 [INFO]: 	compression ratio: 0.9993100461171013
2025-03-13 11:20:23,601 [INFO]: }
2025-03-13 11:20:23,601 [INFO]: 	>>> Finished "Creating the index" in 48.1289 secs
2025-03-13 11:20:23,601 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1685 secs
2025-03-13 11:20:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 49714 [episode count 18/20]
[retrieval_preprocessing] for episode 1424 [episode count 19/20], we have num_retrieval=np.int64(2781) num_query=np.int64(135)
2025-03-13 11:20:25,120 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:25,501 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:25
2025-03-13 11:20:25,501 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.06it/s]
2025-03-13 11:20:25,528 [INFO]: There are 2781 embeddings of dim 49152
2025-03-13 11:20:25,528 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 11:20:25,528 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:25
2025-03-13 11:20:25,529 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:25,529 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:20:25,529 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:25,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:25,529 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:25
2025-03-13 11:20:25,529 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:25,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:25,529 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:25
2025-03-13 11:20:25,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:25,529 [INFO]: 	Creating the index 03/13/2025, 11:20:25
2025-03-13 11:20:25,529 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:25
2025-03-13 11:20:25,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:20:25,530 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:25
2025-03-13 11:20:25,530 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:20:25,530 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.93it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.74it/s]100%|██████████| 11/11 [00:02<00:00,  4.37it/s]100%|██████████| 11/11 [00:02<00:00,  5.30it/s]
2025-03-13 11:20:27,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:27
2025-03-13 11:20:58,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8133 secs
2025-03-13 11:20:58,424 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 11:20:58,424 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.57it/s]
2025-03-13 11:21:10,971 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5469 secs
2025-03-13 11:21:10,973 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4433 secs
2025-03-13 11:21:10,974 [INFO]: {
2025-03-13 11:21:10,974 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:10,974 [INFO]: 	index_param: efSearch=167
2025-03-13 11:21:10,974 [INFO]: 	index_path: knn.index
2025-03-13 11:21:10,974 [INFO]: 	size in bytes: 547144450
2025-03-13 11:21:10,974 [INFO]: 	avg_search_speed_ms: 8.15074526178844
2025-03-13 11:21:10,974 [INFO]: 	99p_search_speed_ms: 10.459171002730727
2025-03-13 11:21:10,974 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:10,974 [INFO]: 	nb vectors: 2781
2025-03-13 11:21:10,974 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:10,974 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-13 11:21:10,974 [INFO]: }
2025-03-13 11:21:10,974 [INFO]: 	>>> Finished "Creating the index" in 45.4451 secs
2025-03-13 11:21:10,974 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4725 secs
2025-03-13 11:21:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 1424 [episode count 19/20]
2025-03-13 11:21:11: [retrieval_preprocessing] finished for -1_put_marker_in_cup [chosen_id count 1/260]
2025-03-13 11:21:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_bowl [chosen_id count 2/260]
2025-03-13 11:21:13: [retrieval_preprocessing] we have num_total=2312 embedding_dim=49152
[retrieval_preprocessing] for episode 49174 [episode count 0/20], we have num_retrieval=np.int64(2188) num_query=np.int64(124)
2025-03-13 11:21:13,185 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:13,498 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:13
2025-03-13 11:21:13,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1656.52it/s]
2025-03-13 11:21:13,528 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 11:21:13,528 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 11:21:13,528 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:13,529 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:21:13,529 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:13,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:21:13,529 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,529 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:13,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:21:13,529 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:13
2025-03-13 11:21:13,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:13,530 [INFO]: 	Creating the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,530 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:13
2025-03-13 11:21:13,533 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:21:13,533 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:13
2025-03-13 11:21:13,533 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:21:13,533 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.40it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.17it/s]100%|██████████| 9/9 [00:01<00:00,  4.92it/s]
2025-03-13 11:21:15,369 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:15
2025-03-13 11:21:47,141 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7721 secs
2025-03-13 11:21:47,141 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 11:21:47,141 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-13 11:21:59,392 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2503 secs
2025-03-13 11:21:59,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8602 secs
2025-03-13 11:21:59,394 [INFO]: {
2025-03-13 11:21:59,394 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:59,394 [INFO]: 	index_param: efSearch=190
2025-03-13 11:21:59,394 [INFO]: 	index_path: knn.index
2025-03-13 11:21:59,394 [INFO]: 	size in bytes: 430475830
2025-03-13 11:21:59,394 [INFO]: 	avg_search_speed_ms: 9.065136333069649
2025-03-13 11:21:59,394 [INFO]: 	99p_search_speed_ms: 12.12346788030118
2025-03-13 11:21:59,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:59,394 [INFO]: 	nb vectors: 2188
2025-03-13 11:21:59,394 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:59,394 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 11:21:59,394 [INFO]: }
2025-03-13 11:21:59,394 [INFO]: 	>>> Finished "Creating the index" in 45.8643 secs
2025-03-13 11:21:59,394 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8957 secs
2025-03-13 11:21:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 49174 [episode count 0/20]
[retrieval_preprocessing] for episode 49175 [episode count 1/20], we have num_retrieval=np.int64(2174) num_query=np.int64(138)
2025-03-13 11:22:00,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:01,025 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:01
2025-03-13 11:22:01,025 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-13 11:22:01,062 [INFO]: There are 2174 embeddings of dim 49152
2025-03-13 11:22:01,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 11:22:01,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:01
2025-03-13 11:22:01,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:01,063 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:22:01,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:01,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:22:01,063 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:01
2025-03-13 11:22:01,063 [INFO]: 448.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:01,063 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:22:01,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:01
2025-03-13 11:22:01,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:01,064 [INFO]: 	Creating the index 03/13/2025, 11:22:01
2025-03-13 11:22:01,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:01
2025-03-13 11:22:01,065 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:22:01,065 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:01
2025-03-13 11:22:01,066 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:22:01,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.25it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.07it/s]100%|██████████| 9/9 [00:01<00:00,  5.52it/s]
2025-03-13 11:22:02,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:02
2025-03-13 11:22:28,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3424 secs
2025-03-13 11:22:28,041 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:22:28,041 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 11:22:39,417 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3759 secs
2025-03-13 11:22:39,419 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3534 secs
2025-03-13 11:22:39,419 [INFO]: {
2025-03-13 11:22:39,419 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:39,419 [INFO]: 	index_param: efSearch=166
2025-03-13 11:22:39,419 [INFO]: 	index_path: knn.index
2025-03-13 11:22:39,419 [INFO]: 	size in bytes: 427721350
2025-03-13 11:22:39,419 [INFO]: 	avg_search_speed_ms: 8.470606940674653
2025-03-13 11:22:39,419 [INFO]: 	99p_search_speed_ms: 10.96056578680873
2025-03-13 11:22:39,419 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:39,419 [INFO]: 	nb vectors: 2174
2025-03-13 11:22:39,419 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:39,419 [INFO]: 	compression ratio: 0.9993089940448379
2025-03-13 11:22:39,419 [INFO]: }
2025-03-13 11:22:39,419 [INFO]: 	>>> Finished "Creating the index" in 38.3557 secs
2025-03-13 11:22:39,419 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3944 secs
2025-03-13 11:22:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 49175 [episode count 1/20]
[retrieval_preprocessing] for episode 32809 [episode count 2/20], we have num_retrieval=np.int64(2140) num_query=np.int64(172)
2025-03-13 11:22:40,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:40,920 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:40
2025-03-13 11:22:40,920 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.91it/s]
2025-03-13 11:22:40,949 [INFO]: There are 2140 embeddings of dim 49152
2025-03-13 11:22:40,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:22:40,949 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:40
2025-03-13 11:22:40,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:40,950 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:22:40,950 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:40,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:22:40,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:40
2025-03-13 11:22:40,950 [INFO]: 441.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:40,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:22:40,951 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:40
2025-03-13 11:22:40,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:40,951 [INFO]: 	Creating the index 03/13/2025, 11:22:40
2025-03-13 11:22:40,951 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:40
2025-03-13 11:22:40,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:22:40,954 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:40
2025-03-13 11:22:40,954 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:22:40,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.13it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.95it/s]100%|██████████| 9/9 [00:01<00:00,  5.43it/s]
2025-03-13 11:22:42,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:42
2025-03-13 11:23:09,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9505 secs
2025-03-13 11:23:09,569 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 11:23:09,569 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.87it/s]
2025-03-13 11:23:21,304 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7346 secs
2025-03-13 11:23:21,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3513 secs
2025-03-13 11:23:21,306 [INFO]: {
2025-03-13 11:23:21,306 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:21,306 [INFO]: 	index_param: efSearch=148
2025-03-13 11:23:21,306 [INFO]: 	index_path: knn.index
2025-03-13 11:23:21,306 [INFO]: 	size in bytes: 421032010
2025-03-13 11:23:21,306 [INFO]: 	avg_search_speed_ms: 8.364614531636102
2025-03-13 11:23:21,306 [INFO]: 	99p_search_speed_ms: 12.003561912570149
2025-03-13 11:23:21,306 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:21,306 [INFO]: 	nb vectors: 2140
2025-03-13 11:23:21,306 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:21,306 [INFO]: 	compression ratio: 0.999309102412427
2025-03-13 11:23:21,306 [INFO]: }
2025-03-13 11:23:21,306 [INFO]: 	>>> Finished "Creating the index" in 40.3547 secs
2025-03-13 11:23:21,306 [INFO]: >>> Finished "Launching the whole pipeline" in 40.3858 secs
2025-03-13 11:23:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 32809 [episode count 2/20]
[retrieval_preprocessing] for episode 73826 [episode count 3/20], we have num_retrieval=np.int64(2218) num_query=np.int64(94)
2025-03-13 11:23:22,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:22,829 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:22
2025-03-13 11:23:22,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1540.89it/s]
2025-03-13 11:23:22,862 [INFO]: There are 2218 embeddings of dim 49152
2025-03-13 11:23:22,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 11:23:22,863 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:22
2025-03-13 11:23:22,863 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:22,863 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:23:22,863 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:22,864 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:23:22,864 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:22
2025-03-13 11:23:22,864 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:22,864 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:23:22,864 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:22
2025-03-13 11:23:22,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:22,865 [INFO]: 	Creating the index 03/13/2025, 11:23:22
2025-03-13 11:23:22,865 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:22
2025-03-13 11:23:22,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:23:22,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:22
2025-03-13 11:23:22,868 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:23:22,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 25.53it/s]100%|██████████| 9/9 [00:01<00:00,  4.82it/s]100%|██████████| 9/9 [00:01<00:00,  5.24it/s]
2025-03-13 11:23:24,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:24
2025-03-13 11:23:50,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4125 secs
2025-03-13 11:23:50,004 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 11:23:50,004 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.01it/s]
2025-03-13 11:24:01,963 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9581 secs
2025-03-13 11:24:01,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0962 secs
2025-03-13 11:24:01,964 [INFO]: {
2025-03-13 11:24:01,965 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:01,965 [INFO]: 	index_param: efSearch=179
2025-03-13 11:24:01,965 [INFO]: 	index_path: knn.index
2025-03-13 11:24:01,965 [INFO]: 	size in bytes: 436378030
2025-03-13 11:24:01,965 [INFO]: 	avg_search_speed_ms: 9.52109898773155
2025-03-13 11:24:01,965 [INFO]: 	99p_search_speed_ms: 14.52941645868122
2025-03-13 11:24:01,965 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:01,965 [INFO]: 	nb vectors: 2218
2025-03-13 11:24:01,965 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:01,965 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-13 11:24:01,965 [INFO]: }
2025-03-13 11:24:01,965 [INFO]: 	>>> Finished "Creating the index" in 39.0999 secs
2025-03-13 11:24:01,965 [INFO]: >>> Finished "Launching the whole pipeline" in 39.1357 secs
2025-03-13 11:24:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 73826 [episode count 3/20]
[retrieval_preprocessing] for episode 90291 [episode count 4/20], we have num_retrieval=np.int64(2143) num_query=np.int64(169)
2025-03-13 11:24:03,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:03,370 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:03
2025-03-13 11:24:03,370 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.28it/s]
2025-03-13 11:24:03,401 [INFO]: There are 2143 embeddings of dim 49152
2025-03-13 11:24:03,402 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 11:24:03,402 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:03
2025-03-13 11:24:03,402 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:03,402 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:24:03,402 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:03,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:03,402 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:03
2025-03-13 11:24:03,402 [INFO]: 442.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:03,402 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:24:03,402 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:03
2025-03-13 11:24:03,402 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:03,402 [INFO]: 	Creating the index 03/13/2025, 11:24:03
2025-03-13 11:24:03,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:03
2025-03-13 11:24:03,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:24:03,403 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:03
2025-03-13 11:24:03,403 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:24:03,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.10it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.58it/s]100%|██████████| 9/9 [00:01<00:00,  5.53it/s]
2025-03-13 11:24:05,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:05
2025-03-13 11:24:31,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3755 secs
2025-03-13 11:24:31,409 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 11:24:31,410 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-13 11:24:43,341 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9316 secs
2025-03-13 11:24:43,344 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.9405 secs
2025-03-13 11:24:43,344 [INFO]: {
2025-03-13 11:24:43,344 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:43,344 [INFO]: 	index_param: efSearch=201
2025-03-13 11:24:43,344 [INFO]: 	index_path: knn.index
2025-03-13 11:24:43,344 [INFO]: 	size in bytes: 421622230
2025-03-13 11:24:43,344 [INFO]: 	avg_search_speed_ms: 10.846254969508118
2025-03-13 11:24:43,344 [INFO]: 	99p_search_speed_ms: 16.042723557911813
2025-03-13 11:24:43,344 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:43,344 [INFO]: 	nb vectors: 2143
2025-03-13 11:24:43,344 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:43,344 [INFO]: 	compression ratio: 0.9993091303558638
2025-03-13 11:24:43,344 [INFO]: }
2025-03-13 11:24:43,344 [INFO]: 	>>> Finished "Creating the index" in 39.9422 secs
2025-03-13 11:24:43,344 [INFO]: >>> Finished "Launching the whole pipeline" in 39.9743 secs
2025-03-13 11:24:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 90291 [episode count 4/20]
[retrieval_preprocessing] for episode 205 [episode count 5/20], we have num_retrieval=np.int64(2172) num_query=np.int64(140)
2025-03-13 11:24:45,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:45,569 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:45
2025-03-13 11:24:45,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 888.62it/s]
2025-03-13 11:24:45,596 [INFO]: There are 2172 embeddings of dim 49152
2025-03-13 11:24:45,597 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:24:45,597 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,597 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:45,597 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:24:45,597 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:45,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:45,597 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,597 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:45,597 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:24:45,597 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:45
2025-03-13 11:24:45,597 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:45,597 [INFO]: 	Creating the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,597 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:45
2025-03-13 11:24:45,598 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:24:45,598 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:45
2025-03-13 11:24:45,598 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:24:45,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.24it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.46it/s]100%|██████████| 9/9 [00:01<00:00,  4.24it/s]100%|██████████| 9/9 [00:01<00:00,  4.98it/s]
2025-03-13 11:24:47,410 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:47
2025-03-13 11:25:14,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7931 secs
2025-03-13 11:25:14,204 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 11:25:14,204 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-13 11:25:26,150 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9465 secs
2025-03-13 11:25:26,152 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.5540 secs
2025-03-13 11:25:26,153 [INFO]: {
2025-03-13 11:25:26,153 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:26,153 [INFO]: 	index_param: efSearch=193
2025-03-13 11:25:26,153 [INFO]: 	index_path: knn.index
2025-03-13 11:25:26,153 [INFO]: 	size in bytes: 427327810
2025-03-13 11:25:26,153 [INFO]: 	avg_search_speed_ms: 9.34031769506334
2025-03-13 11:25:26,153 [INFO]: 	99p_search_speed_ms: 12.673894059844308
2025-03-13 11:25:26,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:26,153 [INFO]: 	nb vectors: 2172
2025-03-13 11:25:26,153 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:26,153 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-13 11:25:26,153 [INFO]: }
2025-03-13 11:25:26,153 [INFO]: 	>>> Finished "Creating the index" in 40.5556 secs
2025-03-13 11:25:26,153 [INFO]: >>> Finished "Launching the whole pipeline" in 40.5838 secs
2025-03-13 11:25:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 205 [episode count 5/20]
[retrieval_preprocessing] for episode 33024 [episode count 6/20], we have num_retrieval=np.int64(2173) num_query=np.int64(139)
2025-03-13 11:25:27,423 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:27,753 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:27
2025-03-13 11:25:27,754 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1635.21it/s]
2025-03-13 11:25:27,781 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 11:25:27,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:25:27,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:27,782 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:25:27,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:27,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:25:27,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,782 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:27,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:25:27,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:27
2025-03-13 11:25:27,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:27,782 [INFO]: 	Creating the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:27
2025-03-13 11:25:27,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:25:27,785 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:27
2025-03-13 11:25:27,785 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:25:27,785 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.54it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.81it/s]100%|██████████| 9/9 [00:01<00:00,  4.85it/s]
2025-03-13 11:25:29,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:29
2025-03-13 11:25:59,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5789 secs
2025-03-13 11:25:59,226 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:25:59,226 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.66it/s]
2025-03-13 11:26:12,257 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0301 secs
2025-03-13 11:26:12,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4739 secs
2025-03-13 11:26:12,259 [INFO]: {
2025-03-13 11:26:12,259 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:12,259 [INFO]: 	index_param: efSearch=202
2025-03-13 11:26:12,259 [INFO]: 	index_path: knn.index
2025-03-13 11:26:12,259 [INFO]: 	size in bytes: 427524550
2025-03-13 11:26:12,259 [INFO]: 	avg_search_speed_ms: 11.17182338568668
2025-03-13 11:26:12,259 [INFO]: 	99p_search_speed_ms: 15.094859092496328
2025-03-13 11:26:12,259 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:12,259 [INFO]: 	nb vectors: 2173
2025-03-13 11:26:12,259 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:12,259 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 11:26:12,259 [INFO]: }
2025-03-13 11:26:12,259 [INFO]: 	>>> Finished "Creating the index" in 44.4768 secs
2025-03-13 11:26:12,259 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5055 secs
2025-03-13 11:26:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 33024 [episode count 6/20]
[retrieval_preprocessing] for episode 74198 [episode count 7/20], we have num_retrieval=np.int64(2235) num_query=np.int64(77)
2025-03-13 11:26:13,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:14,080 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:14
2025-03-13 11:26:14,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2044.01it/s]
2025-03-13 11:26:14,105 [INFO]: There are 2235 embeddings of dim 49152
2025-03-13 11:26:14,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:26:14,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:14
2025-03-13 11:26:14,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:14,106 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:26:14,106 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:14,106 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:26:14,106 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:14
2025-03-13 11:26:14,106 [INFO]: 461.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:14,106 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:26:14,106 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:14
2025-03-13 11:26:14,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:14,106 [INFO]: 	Creating the index 03/13/2025, 11:26:14
2025-03-13 11:26:14,106 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:14
2025-03-13 11:26:14,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:26:14,108 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:14
2025-03-13 11:26:14,108 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:26:14,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.05it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.80it/s]100%|██████████| 9/9 [00:01<00:00,  5.13it/s]
2025-03-13 11:26:15,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:15
2025-03-13 11:26:41,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6130 secs
2025-03-13 11:26:41,480 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 11:26:41,480 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 11:26:54,364 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8839 secs
2025-03-13 11:26:54,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.2575 secs
2025-03-13 11:26:54,365 [INFO]: {
2025-03-13 11:26:54,365 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:54,365 [INFO]: 	index_param: efSearch=167
2025-03-13 11:26:54,365 [INFO]: 	index_path: knn.index
2025-03-13 11:26:54,365 [INFO]: 	size in bytes: 439722610
2025-03-13 11:26:54,365 [INFO]: 	avg_search_speed_ms: 8.60928789541773
2025-03-13 11:26:54,365 [INFO]: 	99p_search_speed_ms: 11.157616800628606
2025-03-13 11:26:54,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:54,366 [INFO]: 	nb vectors: 2235
2025-03-13 11:26:54,366 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:54,366 [INFO]: 	compression ratio: 0.999309269086709
2025-03-13 11:26:54,366 [INFO]: }
2025-03-13 11:26:54,366 [INFO]: 	>>> Finished "Creating the index" in 40.2596 secs
2025-03-13 11:26:54,366 [INFO]: >>> Finished "Launching the whole pipeline" in 40.2851 secs
2025-03-13 11:26:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 74198 [episode count 7/20]
[retrieval_preprocessing] for episode 25199 [episode count 8/20], we have num_retrieval=np.int64(2209) num_query=np.int64(103)
2025-03-13 11:26:55,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:55,333 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:55
2025-03-13 11:26:55,333 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.76it/s]
2025-03-13 11:26:55,366 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 11:26:55,366 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 11:26:55,366 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:55
2025-03-13 11:26:55,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:55,367 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:26:55,367 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:55,367 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:26:55,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:55
2025-03-13 11:26:55,368 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:55,368 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:26:55,368 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:55
2025-03-13 11:26:55,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:55,369 [INFO]: 	Creating the index 03/13/2025, 11:26:55
2025-03-13 11:26:55,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:55
2025-03-13 11:26:55,372 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:26:55,372 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:55
2025-03-13 11:26:55,372 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:26:55,372 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.43it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.63it/s]100%|██████████| 9/9 [00:01<00:00,  5.01it/s]
2025-03-13 11:26:57,175 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:57
2025-03-13 11:27:23,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2955 secs
2025-03-13 11:27:23,471 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 11:27:23,471 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 11:27:35,208 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7370 secs
2025-03-13 11:27:35,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8378 secs
2025-03-13 11:27:35,210 [INFO]: {
2025-03-13 11:27:35,210 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:35,210 [INFO]: 	index_param: efSearch=188
2025-03-13 11:27:35,210 [INFO]: 	index_path: knn.index
2025-03-13 11:27:35,210 [INFO]: 	size in bytes: 434607370
2025-03-13 11:27:35,210 [INFO]: 	avg_search_speed_ms: 10.827668003881051
2025-03-13 11:27:35,210 [INFO]: 	99p_search_speed_ms: 14.133208731655031
2025-03-13 11:27:35,210 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:35,210 [INFO]: 	nb vectors: 2209
2025-03-13 11:27:35,210 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:35,210 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 11:27:35,210 [INFO]: }
2025-03-13 11:27:35,210 [INFO]: 	>>> Finished "Creating the index" in 39.8417 secs
2025-03-13 11:27:35,211 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8770 secs
2025-03-13 11:27:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 25199 [episode count 8/20]
[retrieval_preprocessing] for episode 90684 [episode count 9/20], we have num_retrieval=np.int64(2215) num_query=np.int64(97)
2025-03-13 11:27:36,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:36,500 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:36
2025-03-13 11:27:36,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1405.13it/s]
2025-03-13 11:27:36,528 [INFO]: There are 2215 embeddings of dim 49152
2025-03-13 11:27:36,529 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:27:36,529 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:36
2025-03-13 11:27:36,529 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:36,529 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:27:36,529 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:36,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:36,529 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:36
2025-03-13 11:27:36,529 [INFO]: 457.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:36,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:36,529 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:36
2025-03-13 11:27:36,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:36,529 [INFO]: 	Creating the index 03/13/2025, 11:27:36
2025-03-13 11:27:36,529 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:36
2025-03-13 11:27:36,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:27:36,530 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:36
2025-03-13 11:27:36,530 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:27:36,530 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.90it/s] 44%|████▍     | 4/9 [00:00<00:00, 19.56it/s] 89%|████████▉ | 8/9 [00:00<00:00, 27.36it/s]100%|██████████| 9/9 [00:02<00:00,  4.38it/s]
2025-03-13 11:27:38,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:38
2025-03-13 11:28:04,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7972 secs
2025-03-13 11:28:04,384 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:28:04,385 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.38it/s]
2025-03-13 11:28:17,215 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8303 secs
2025-03-13 11:28:17,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6868 secs
2025-03-13 11:28:17,217 [INFO]: {
2025-03-13 11:28:17,217 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:17,217 [INFO]: 	index_param: efSearch=216
2025-03-13 11:28:17,217 [INFO]: 	index_path: knn.index
2025-03-13 11:28:17,217 [INFO]: 	size in bytes: 435787810
2025-03-13 11:28:17,217 [INFO]: 	avg_search_speed_ms: 9.483481551436663
2025-03-13 11:28:17,217 [INFO]: 	99p_search_speed_ms: 12.280219946987929
2025-03-13 11:28:17,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:17,217 [INFO]: 	nb vectors: 2215
2025-03-13 11:28:17,217 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:17,217 [INFO]: 	compression ratio: 0.9993090903575297
2025-03-13 11:28:17,217 [INFO]: }
2025-03-13 11:28:17,217 [INFO]: 	>>> Finished "Creating the index" in 40.6882 secs
2025-03-13 11:28:17,217 [INFO]: >>> Finished "Launching the whole pipeline" in 40.7171 secs
2025-03-13 11:28:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 90684 [episode count 9/20]
[retrieval_preprocessing] for episode 67579 [episode count 10/20], we have num_retrieval=np.int64(2188) num_query=np.int64(124)
2025-03-13 11:28:18,046 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:18,334 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:18
2025-03-13 11:28:18,334 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.83it/s]
2025-03-13 11:28:18,362 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 11:28:18,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:28:18,362 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:18
2025-03-13 11:28:18,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:18,363 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:28:18,363 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:18,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:18,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:18
2025-03-13 11:28:18,363 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:18,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:28:18,363 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:18
2025-03-13 11:28:18,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:18,363 [INFO]: 	Creating the index 03/13/2025, 11:28:18
2025-03-13 11:28:18,363 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:18
2025-03-13 11:28:18,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:28:18,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:18
2025-03-13 11:28:18,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:28:18,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.45it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.38it/s]100%|██████████| 9/9 [00:01<00:00,  5.22it/s]
2025-03-13 11:28:20,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:20
2025-03-13 11:28:46,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9892 secs
2025-03-13 11:28:46,081 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 11:28:46,081 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 11:29:01,041 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9596 secs
2025-03-13 11:29:01,042 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6782 secs
2025-03-13 11:29:01,042 [INFO]: {
2025-03-13 11:29:01,042 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:01,042 [INFO]: 	index_param: efSearch=214
2025-03-13 11:29:01,042 [INFO]: 	index_path: knn.index
2025-03-13 11:29:01,042 [INFO]: 	size in bytes: 430475830
2025-03-13 11:29:01,042 [INFO]: 	avg_search_speed_ms: 10.940089540329867
2025-03-13 11:29:01,042 [INFO]: 	99p_search_speed_ms: 17.46545476373285
2025-03-13 11:29:01,042 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:01,043 [INFO]: 	nb vectors: 2188
2025-03-13 11:29:01,043 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:01,043 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 11:29:01,043 [INFO]: }
2025-03-13 11:29:01,043 [INFO]: 	>>> Finished "Creating the index" in 42.6795 secs
2025-03-13 11:29:01,043 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7085 secs
2025-03-13 11:29:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 67579 [episode count 10/20]
[retrieval_preprocessing] for episode 59420 [episode count 11/20], we have num_retrieval=np.int64(2212) num_query=np.int64(100)
2025-03-13 11:29:02,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:02,668 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:02
2025-03-13 11:29:02,668 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1919.59it/s]
2025-03-13 11:29:02,697 [INFO]: There are 2212 embeddings of dim 49152
2025-03-13 11:29:02,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 11:29:02,698 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:02
2025-03-13 11:29:02,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:02,698 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:29:02,698 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:02,698 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:02,698 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:02
2025-03-13 11:29:02,698 [INFO]: 456.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:02,698 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:29:02,698 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:02
2025-03-13 11:29:02,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:02,698 [INFO]: 	Creating the index 03/13/2025, 11:29:02
2025-03-13 11:29:02,698 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:02
2025-03-13 11:29:02,699 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:29:02,699 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:02
2025-03-13 11:29:02,699 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:29:02,699 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.13it/s] 67%|██████▋   | 6/9 [00:00<00:00, 27.46it/s]100%|██████████| 9/9 [00:01<00:00,  4.21it/s]100%|██████████| 9/9 [00:01<00:00,  5.11it/s]
2025-03-13 11:29:04,463 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:04
2025-03-13 11:29:31,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4277 secs
2025-03-13 11:29:31,891 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:29:31,891 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-13 11:29:44,469 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5777 secs
2025-03-13 11:29:44,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7715 secs
2025-03-13 11:29:44,471 [INFO]: {
2025-03-13 11:29:44,471 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:44,471 [INFO]: 	index_param: efSearch=215
2025-03-13 11:29:44,471 [INFO]: 	index_path: knn.index
2025-03-13 11:29:44,471 [INFO]: 	size in bytes: 435197590
2025-03-13 11:29:44,471 [INFO]: 	avg_search_speed_ms: 10.058366219236998
2025-03-13 11:29:44,471 [INFO]: 	99p_search_speed_ms: 13.679948514327407
2025-03-13 11:29:44,471 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:44,471 [INFO]: 	nb vectors: 2212
2025-03-13 11:29:44,471 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:44,471 [INFO]: 	compression ratio: 0.9993090632693991
2025-03-13 11:29:44,471 [INFO]: }
2025-03-13 11:29:44,471 [INFO]: 	>>> Finished "Creating the index" in 41.7729 secs
2025-03-13 11:29:44,471 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8034 secs
2025-03-13 11:29:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 59420 [episode count 11/20]
[retrieval_preprocessing] for episode 9320 [episode count 12/20], we have num_retrieval=np.int64(2188) num_query=np.int64(124)
2025-03-13 11:29:45,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:45,939 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:45
2025-03-13 11:29:45,939 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2321.14it/s]
2025-03-13 11:29:45,963 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 11:29:45,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:29:45,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:45
2025-03-13 11:29:45,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:45,963 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:29:45,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:45,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:45,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:45
2025-03-13 11:29:45,964 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:45,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:45,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:45
2025-03-13 11:29:45,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:45,964 [INFO]: 	Creating the index 03/13/2025, 11:29:45
2025-03-13 11:29:45,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:45
2025-03-13 11:29:45,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:29:45,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:45
2025-03-13 11:29:45,965 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:29:45,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.60it/s] 89%|████████▉ | 8/9 [00:00<00:00, 40.31it/s]100%|██████████| 9/9 [00:01<00:00,  5.73it/s]
2025-03-13 11:29:47,539 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:47
2025-03-13 11:30:13,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3818 secs
2025-03-13 11:30:13,921 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 11:30:13,922 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.81it/s]
2025-03-13 11:30:26,471 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5491 secs
2025-03-13 11:30:26,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.5076 secs
2025-03-13 11:30:26,473 [INFO]: {
2025-03-13 11:30:26,473 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:26,473 [INFO]: 	index_param: efSearch=205
2025-03-13 11:30:26,473 [INFO]: 	index_path: knn.index
2025-03-13 11:30:26,473 [INFO]: 	size in bytes: 430475830
2025-03-13 11:30:26,473 [INFO]: 	avg_search_speed_ms: 10.585810725513117
2025-03-13 11:30:26,473 [INFO]: 	99p_search_speed_ms: 16.70286794193089
2025-03-13 11:30:26,473 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:26,473 [INFO]: 	nb vectors: 2188
2025-03-13 11:30:26,473 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:26,473 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 11:30:26,473 [INFO]: }
2025-03-13 11:30:26,473 [INFO]: 	>>> Finished "Creating the index" in 40.5090 secs
2025-03-13 11:30:26,473 [INFO]: >>> Finished "Launching the whole pipeline" in 40.5337 secs
2025-03-13 11:30:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 9320 [episode count 12/20]
[retrieval_preprocessing] for episode 9598 [episode count 13/20], we have num_retrieval=np.int64(2210) num_query=np.int64(102)
2025-03-13 11:30:27,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:28,160 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:28
2025-03-13 11:30:28,160 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1841.22it/s]
2025-03-13 11:30:28,188 [INFO]: There are 2210 embeddings of dim 49152
2025-03-13 11:30:28,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 11:30:28,189 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:28,189 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:30:28,189 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:28,189 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:30:28,189 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,190 [INFO]: 456.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:28,190 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:30:28,190 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:28
2025-03-13 11:30:28,190 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:28,191 [INFO]: 	Creating the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,191 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:28
2025-03-13 11:30:28,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:30:28,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:28
2025-03-13 11:30:28,194 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:30:28,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.38it/s] 89%|████████▉ | 8/9 [00:00<00:00, 39.63it/s]100%|██████████| 9/9 [00:02<00:00,  3.54it/s]
2025-03-13 11:30:30,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:30
2025-03-13 11:30:57,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0891 secs
2025-03-13 11:30:57,832 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:30:57,832 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 11:31:10,406 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5738 secs
2025-03-13 11:31:10,407 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2132 secs
2025-03-13 11:31:10,407 [INFO]: {
2025-03-13 11:31:10,407 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:10,407 [INFO]: 	index_param: efSearch=215
2025-03-13 11:31:10,407 [INFO]: 	index_path: knn.index
2025-03-13 11:31:10,407 [INFO]: 	size in bytes: 434804110
2025-03-13 11:31:10,407 [INFO]: 	avg_search_speed_ms: 11.085687009793213
2025-03-13 11:31:10,407 [INFO]: 	99p_search_speed_ms: 14.974984037689865
2025-03-13 11:31:10,407 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:10,407 [INFO]: 	nb vectors: 2210
2025-03-13 11:31:10,407 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:10,407 [INFO]: 	compression ratio: 0.9993090451697892
2025-03-13 11:31:10,407 [INFO]: }
2025-03-13 11:31:10,408 [INFO]: 	>>> Finished "Creating the index" in 42.2169 secs
2025-03-13 11:31:10,408 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2475 secs
2025-03-13 11:31:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 9598 [episode count 13/20]
[retrieval_preprocessing] for episode 1520 [episode count 14/20], we have num_retrieval=np.int64(2204) num_query=np.int64(108)
2025-03-13 11:31:11,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:11,628 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:11
2025-03-13 11:31:11,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-13 11:31:11,661 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 11:31:11,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 11:31:11,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:11
2025-03-13 11:31:11,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:11,662 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:31:11,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:11,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:31:11,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:11
2025-03-13 11:31:11,663 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:11,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:31:11,663 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:11
2025-03-13 11:31:11,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:11,663 [INFO]: 	Creating the index 03/13/2025, 11:31:11
2025-03-13 11:31:11,663 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:11
2025-03-13 11:31:11,666 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:31:11,667 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:11
2025-03-13 11:31:11,667 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:31:11,667 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 25.65it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.48it/s]
2025-03-13 11:31:13,316 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:13
2025-03-13 11:31:41,142 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8257 secs
2025-03-13 11:31:41,143 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 11:31:41,143 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.68it/s]
2025-03-13 11:31:55,351 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2083 secs
2025-03-13 11:31:55,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6861 secs
2025-03-13 11:31:55,353 [INFO]: {
2025-03-13 11:31:55,353 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:55,353 [INFO]: 	index_param: efSearch=190
2025-03-13 11:31:55,353 [INFO]: 	index_path: knn.index
2025-03-13 11:31:55,353 [INFO]: 	size in bytes: 433623670
2025-03-13 11:31:55,353 [INFO]: 	avg_search_speed_ms: 9.76386254562474
2025-03-13 11:31:55,353 [INFO]: 	99p_search_speed_ms: 12.634771019220352
2025-03-13 11:31:55,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:55,353 [INFO]: 	nb vectors: 2204
2025-03-13 11:31:55,353 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:55,353 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 11:31:55,353 [INFO]: }
2025-03-13 11:31:55,353 [INFO]: 	>>> Finished "Creating the index" in 43.6898 secs
2025-03-13 11:31:55,353 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7250 secs
2025-03-13 11:31:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 1520 [episode count 14/20]
[retrieval_preprocessing] for episode 82926 [episode count 15/20], we have num_retrieval=np.int64(2226) num_query=np.int64(86)
2025-03-13 11:31:56,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:56,950 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:56
2025-03-13 11:31:56,950 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2024.28it/s]
2025-03-13 11:31:56,978 [INFO]: There are 2226 embeddings of dim 49152
2025-03-13 11:31:56,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 11:31:56,978 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:56
2025-03-13 11:31:56,978 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:56,978 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:31:56,978 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:56,978 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:56,978 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:56
2025-03-13 11:31:56,978 [INFO]: 459.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:56,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:56,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:56
2025-03-13 11:31:56,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:56,979 [INFO]: 	Creating the index 03/13/2025, 11:31:56
2025-03-13 11:31:56,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:56
2025-03-13 11:31:56,980 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:56,980 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:56
2025-03-13 11:31:56,980 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:31:56,980 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.94it/s] 78%|███████▊  | 7/9 [00:00<00:00, 30.95it/s]100%|██████████| 9/9 [00:01<00:00,  4.95it/s]
2025-03-13 11:31:58,801 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:58
2025-03-13 11:32:28,982 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1803 secs
2025-03-13 11:32:28,982 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 11:32:28,982 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 11:32:42,069 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0866 secs
2025-03-13 11:32:42,071 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0910 secs
2025-03-13 11:32:42,071 [INFO]: {
2025-03-13 11:32:42,071 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:42,071 [INFO]: 	index_param: efSearch=179
2025-03-13 11:32:42,071 [INFO]: 	index_path: knn.index
2025-03-13 11:32:42,071 [INFO]: 	size in bytes: 437951950
2025-03-13 11:32:42,071 [INFO]: 	avg_search_speed_ms: 9.690214164623658
2025-03-13 11:32:42,071 [INFO]: 	99p_search_speed_ms: 14.37786083668466
2025-03-13 11:32:42,071 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:42,071 [INFO]: 	nb vectors: 2226
2025-03-13 11:32:42,071 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:42,071 [INFO]: 	compression ratio: 0.9993091890560141
2025-03-13 11:32:42,071 [INFO]: }
2025-03-13 11:32:42,071 [INFO]: 	>>> Finished "Creating the index" in 45.0924 secs
2025-03-13 11:32:42,071 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1214 secs
2025-03-13 11:32:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 82926 [episode count 15/20]
[retrieval_preprocessing] for episode 1384 [episode count 16/20], we have num_retrieval=np.int64(2224) num_query=np.int64(88)
2025-03-13 11:32:42,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:43,286 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:43
2025-03-13 11:32:43,287 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.89it/s]
2025-03-13 11:32:43,313 [INFO]: There are 2224 embeddings of dim 49152
2025-03-13 11:32:43,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:32:43,313 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:43,313 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:32:43,313 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:43,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:43,313 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,314 [INFO]: 459.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:43,314 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:43,314 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:43
2025-03-13 11:32:43,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:43,314 [INFO]: 	Creating the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,314 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:43
2025-03-13 11:32:43,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:32:43,315 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:43
2025-03-13 11:32:43,315 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:32:43,315 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.47it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.63it/s]100%|██████████| 9/9 [00:01<00:00,  5.43it/s]
2025-03-13 11:32:44,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:44
2025-03-13 11:33:14,274 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2967 secs
2025-03-13 11:33:14,274 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 11:33:14,274 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-13 11:33:27,640 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3657 secs
2025-03-13 11:33:27,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3271 secs
2025-03-13 11:33:27,642 [INFO]: {
2025-03-13 11:33:27,642 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:27,642 [INFO]: 	index_param: efSearch=206
2025-03-13 11:33:27,643 [INFO]: 	index_path: knn.index
2025-03-13 11:33:27,643 [INFO]: 	size in bytes: 437558470
2025-03-13 11:33:27,643 [INFO]: 	avg_search_speed_ms: 10.471270792040132
2025-03-13 11:33:27,643 [INFO]: 	99p_search_speed_ms: 15.621817728970203
2025-03-13 11:33:27,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:27,643 [INFO]: 	nb vectors: 2224
2025-03-13 11:33:27,643 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:27,643 [INFO]: 	compression ratio: 0.9993091711834535
2025-03-13 11:33:27,643 [INFO]: }
2025-03-13 11:33:27,643 [INFO]: 	>>> Finished "Creating the index" in 44.3289 secs
2025-03-13 11:33:27,643 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3562 secs
2025-03-13 11:33:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 1384 [episode count 16/20]
[retrieval_preprocessing] for episode 18535 [episode count 17/20], we have num_retrieval=np.int64(2195) num_query=np.int64(117)
2025-03-13 11:33:29,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:29,447 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:29
2025-03-13 11:33:29,448 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1822.82it/s]
2025-03-13 11:33:29,478 [INFO]: There are 2195 embeddings of dim 49152
2025-03-13 11:33:29,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 11:33:29,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:29
2025-03-13 11:33:29,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:29,478 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:33:29,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:29,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:29,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:29
2025-03-13 11:33:29,478 [INFO]: 453.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:29,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:33:29,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:29
2025-03-13 11:33:29,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:29,479 [INFO]: 	Creating the index 03/13/2025, 11:33:29
2025-03-13 11:33:29,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:29
2025-03-13 11:33:29,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:33:29,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:29
2025-03-13 11:33:29,480 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:33:29,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.83it/s] 56%|█████▌    | 5/9 [00:00<00:00, 21.50it/s]100%|██████████| 9/9 [00:02<00:00,  3.40it/s]100%|██████████| 9/9 [00:02<00:00,  3.99it/s]
2025-03-13 11:33:31,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:31
2025-03-13 11:33:59,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2651 secs
2025-03-13 11:33:59,004 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 11:33:59,004 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 11:34:11,973 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9683 secs
2025-03-13 11:34:11,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4957 secs
2025-03-13 11:34:11,976 [INFO]: {
2025-03-13 11:34:11,976 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:11,976 [INFO]: 	index_param: efSearch=205
2025-03-13 11:34:11,976 [INFO]: 	index_path: knn.index
2025-03-13 11:34:11,976 [INFO]: 	size in bytes: 431853010
2025-03-13 11:34:11,976 [INFO]: 	avg_search_speed_ms: 10.173300254639022
2025-03-13 11:34:11,976 [INFO]: 	99p_search_speed_ms: 13.342598630115381
2025-03-13 11:34:11,976 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:11,976 [INFO]: 	nb vectors: 2195
2025-03-13 11:34:11,976 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:11,976 [INFO]: 	compression ratio: 0.9993089083713924
2025-03-13 11:34:11,976 [INFO]: }
2025-03-13 11:34:11,976 [INFO]: 	>>> Finished "Creating the index" in 42.4973 secs
2025-03-13 11:34:11,976 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5284 secs
2025-03-13 11:34:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 18535 [episode count 17/20]
[retrieval_preprocessing] for episode 35190 [episode count 18/20], we have num_retrieval=np.int64(2205) num_query=np.int64(107)
2025-03-13 11:34:13,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:13,808 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:13
2025-03-13 11:34:13,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.06it/s]
2025-03-13 11:34:13,839 [INFO]: There are 2205 embeddings of dim 49152
2025-03-13 11:34:13,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 11:34:13,840 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:13
2025-03-13 11:34:13,840 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:13,840 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:34:13,840 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:13,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:13,840 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:13
2025-03-13 11:34:13,840 [INFO]: 455.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:13,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:34:13,840 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:13
2025-03-13 11:34:13,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:13,840 [INFO]: 	Creating the index 03/13/2025, 11:34:13
2025-03-13 11:34:13,840 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:13
2025-03-13 11:34:13,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:34:13,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:13
2025-03-13 11:34:13,842 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:34:13,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.83it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.08it/s]100%|██████████| 9/9 [00:01<00:00,  5.47it/s]
2025-03-13 11:34:15,492 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:15
2025-03-13 11:34:39,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2472 secs
2025-03-13 11:34:39,740 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:34:39,740 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 11:34:52,785 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0450 secs
2025-03-13 11:34:52,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.9443 secs
2025-03-13 11:34:52,786 [INFO]: {
2025-03-13 11:34:52,786 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:52,786 [INFO]: 	index_param: efSearch=166
2025-03-13 11:34:52,786 [INFO]: 	index_path: knn.index
2025-03-13 11:34:52,786 [INFO]: 	size in bytes: 433820410
2025-03-13 11:34:52,786 [INFO]: 	avg_search_speed_ms: 8.536952431313694
2025-03-13 11:34:52,786 [INFO]: 	99p_search_speed_ms: 11.581300669349728
2025-03-13 11:34:52,786 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:52,786 [INFO]: 	nb vectors: 2205
2025-03-13 11:34:52,786 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:52,786 [INFO]: 	compression ratio: 0.9993089997771197
2025-03-13 11:34:52,786 [INFO]: }
2025-03-13 11:34:52,786 [INFO]: 	>>> Finished "Creating the index" in 38.9459 secs
2025-03-13 11:34:52,786 [INFO]: >>> Finished "Launching the whole pipeline" in 38.9787 secs
2025-03-13 11:34:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 35190 [episode count 18/20]
[retrieval_preprocessing] for episode 4117 [episode count 19/20], we have num_retrieval=np.int64(2209) num_query=np.int64(103)
2025-03-13 11:34:53,622 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:53,910 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:53
2025-03-13 11:34:53,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2153.13it/s]
2025-03-13 11:34:53,934 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 11:34:53,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:34:53,934 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:53
2025-03-13 11:34:53,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:53,934 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:34:53,934 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:53,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:53,934 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:53
2025-03-13 11:34:53,935 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:53,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:53,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:53
2025-03-13 11:34:53,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:53,935 [INFO]: 	Creating the index 03/13/2025, 11:34:53
2025-03-13 11:34:53,935 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:53
2025-03-13 11:34:53,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:34:53,936 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:53
2025-03-13 11:34:53,936 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:34:53,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.88it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.45it/s]100%|██████████| 9/9 [00:01<00:00,  5.00it/s]
2025-03-13 11:34:55,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:55
2025-03-13 11:35:25,846 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1064 secs
2025-03-13 11:35:25,846 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 11:35:25,846 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-13 11:35:38,607 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7604 secs
2025-03-13 11:35:38,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6723 secs
2025-03-13 11:35:38,608 [INFO]: {
2025-03-13 11:35:38,608 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:38,608 [INFO]: 	index_param: efSearch=161
2025-03-13 11:35:38,608 [INFO]: 	index_path: knn.index
2025-03-13 11:35:38,608 [INFO]: 	size in bytes: 434607370
2025-03-13 11:35:38,609 [INFO]: 	avg_search_speed_ms: 9.164089889937413
2025-03-13 11:35:38,609 [INFO]: 	99p_search_speed_ms: 15.010792063549093
2025-03-13 11:35:38,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:38,609 [INFO]: 	nb vectors: 2209
2025-03-13 11:35:38,609 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:38,609 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 11:35:38,609 [INFO]: }
2025-03-13 11:35:38,609 [INFO]: 	>>> Finished "Creating the index" in 44.6739 secs
2025-03-13 11:35:38,609 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6990 secs
2025-03-13 11:35:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 4117 [episode count 19/20]
2025-03-13 11:35:39: [retrieval_preprocessing] finished for -1_put_marker_in_bowl [chosen_id count 2/260]
2025-03-13 11:35:41: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_pot [chosen_id count 3/260]
2025-03-13 11:35:41: [retrieval_preprocessing] we have num_total=4222 embedding_dim=49152
[retrieval_preprocessing] for episode 49314 [episode count 0/20], we have num_retrieval=np.int64(4001) num_query=np.int64(221)
2025-03-13 11:35:41,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:42,453 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:42
2025-03-13 11:35:42,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1527.42it/s]
2025-03-13 11:35:42,485 [INFO]: There are 4001 embeddings of dim 49152
2025-03-13 11:35:42,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 11:35:42,485 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:42
2025-03-13 11:35:42,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:42,486 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:35:42,486 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:42,486 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:42,486 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:42
2025-03-13 11:35:42,486 [INFO]: 825.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:42,486 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:35:42,486 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:42
2025-03-13 11:35:42,486 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:42,486 [INFO]: 	Creating the index 03/13/2025, 11:35:42
2025-03-13 11:35:42,486 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:42
2025-03-13 11:35:42,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:35:42,487 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:42
2025-03-13 11:35:42,487 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:35:42,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:09,  1.51it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.07it/s] 69%|██████▉   | 11/16 [00:00<00:00, 17.95it/s]100%|██████████| 16/16 [00:03<00:00,  3.31it/s]100%|██████████| 16/16 [00:03<00:00,  4.07it/s]
2025-03-13 11:35:46,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:46
2025-03-13 11:36:25,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0766 secs
2025-03-13 11:36:25,506 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 11:36:25,506 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.80it/s]
2025-03-13 11:36:43,075 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5681 secs
2025-03-13 11:36:43,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5907 secs
2025-03-13 11:36:43,078 [INFO]: {
2025-03-13 11:36:43,078 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:43,078 [INFO]: 	index_param: efSearch=268
2025-03-13 11:36:43,078 [INFO]: 	index_path: knn.index
2025-03-13 11:36:43,078 [INFO]: 	size in bytes: 787172890
2025-03-13 11:36:43,078 [INFO]: 	avg_search_speed_ms: 13.558525897481738
2025-03-13 11:36:43,078 [INFO]: 	99p_search_speed_ms: 20.412059468217194
2025-03-13 11:36:43,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:43,078 [INFO]: 	nb vectors: 4001
2025-03-13 11:36:43,078 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:43,078 [INFO]: 	compression ratio: 0.9993085610455918
2025-03-13 11:36:43,078 [INFO]: }
2025-03-13 11:36:43,078 [INFO]: 	>>> Finished "Creating the index" in 60.5923 secs
2025-03-13 11:36:43,078 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6248 secs
2025-03-13 11:36:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 49314 [episode count 0/20]
[retrieval_preprocessing] for episode 41123 [episode count 1/20], we have num_retrieval=np.int64(4052) num_query=np.int64(170)
2025-03-13 11:36:45,691 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:46,671 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:46
2025-03-13 11:36:46,671 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.07it/s]
2025-03-13 11:36:46,702 [INFO]: There are 4052 embeddings of dim 49152
2025-03-13 11:36:46,702 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 11:36:46,702 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:46
2025-03-13 11:36:46,703 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:46,703 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:36:46,703 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:46,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:36:46,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:46
2025-03-13 11:36:46,703 [INFO]: 836.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:46,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:36:46,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:46
2025-03-13 11:36:46,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:46,703 [INFO]: 	Creating the index 03/13/2025, 11:36:46
2025-03-13 11:36:46,703 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:46
2025-03-13 11:36:46,704 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:36:46,704 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:46
2025-03-13 11:36:46,704 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:36:46,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.62it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.17it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.74it/s]100%|██████████| 16/16 [00:03<00:00,  3.53it/s]100%|██████████| 16/16 [00:03<00:00,  4.74it/s]
2025-03-13 11:36:50,081 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:50
2025-03-13 11:37:26,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1224 secs
2025-03-13 11:37:26,204 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:37:26,204 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.83it/s]
2025-03-13 11:37:41,052 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8475 secs
2025-03-13 11:37:41,054 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3504 secs
2025-03-13 11:37:41,055 [INFO]: {
2025-03-13 11:37:41,055 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:41,055 [INFO]: 	index_param: efSearch=202
2025-03-13 11:37:41,055 [INFO]: 	index_path: knn.index
2025-03-13 11:37:41,055 [INFO]: 	size in bytes: 797206810
2025-03-13 11:37:41,055 [INFO]: 	avg_search_speed_ms: 10.485788869751575
2025-03-13 11:37:41,055 [INFO]: 	99p_search_speed_ms: 18.620733337011192
2025-03-13 11:37:41,055 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:41,055 [INFO]: 	nb vectors: 4052
2025-03-13 11:37:41,055 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:41,055 [INFO]: 	compression ratio: 0.9993085934627176
2025-03-13 11:37:41,055 [INFO]: }
2025-03-13 11:37:41,055 [INFO]: 	>>> Finished "Creating the index" in 54.3519 secs
2025-03-13 11:37:41,055 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3839 secs
2025-03-13 11:37:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 41123 [episode count 1/20]
[retrieval_preprocessing] for episode 74202 [episode count 2/20], we have num_retrieval=np.int64(4026) num_query=np.int64(196)
2025-03-13 11:37:42,655 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:43,522 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:43
2025-03-13 11:37:43,522 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 11:37:43,553 [INFO]: There are 4026 embeddings of dim 49152
2025-03-13 11:37:43,553 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 11:37:43,553 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:43
2025-03-13 11:37:43,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:43,554 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:37:43,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:43,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:43,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:43
2025-03-13 11:37:43,554 [INFO]: 830.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:43,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:43,554 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:43
2025-03-13 11:37:43,554 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:43,554 [INFO]: 	Creating the index 03/13/2025, 11:37:43
2025-03-13 11:37:43,554 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:43
2025-03-13 11:37:43,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:43,555 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:43
2025-03-13 11:37:43,555 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:37:43,555 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.89it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.55it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.86it/s]100%|██████████| 16/16 [00:03<00:00,  5.15it/s]
2025-03-13 11:37:46,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:46
2025-03-13 11:38:26,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0529 secs
2025-03-13 11:38:26,716 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:38:26,716 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.80it/s]
2025-03-13 11:38:45,346 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6295 secs
2025-03-13 11:38:45,349 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7940 secs
2025-03-13 11:38:45,349 [INFO]: {
2025-03-13 11:38:45,349 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:45,349 [INFO]: 	index_param: efSearch=216
2025-03-13 11:38:45,349 [INFO]: 	index_path: knn.index
2025-03-13 11:38:45,349 [INFO]: 	size in bytes: 792091510
2025-03-13 11:38:45,349 [INFO]: 	avg_search_speed_ms: 10.811351683443865
2025-03-13 11:38:45,349 [INFO]: 	99p_search_speed_ms: 15.352025758475062
2025-03-13 11:38:45,349 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:45,349 [INFO]: 	nb vectors: 4026
2025-03-13 11:38:45,349 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:45,349 [INFO]: 	compression ratio: 0.9993085369643717
2025-03-13 11:38:45,349 [INFO]: }
2025-03-13 11:38:45,350 [INFO]: 	>>> Finished "Creating the index" in 61.7956 secs
2025-03-13 11:38:45,350 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8277 secs
2025-03-13 11:38:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 74202 [episode count 2/20]
[retrieval_preprocessing] for episode 49448 [episode count 3/20], we have num_retrieval=np.int64(3993) num_query=np.int64(229)
2025-03-13 11:38:47,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:48,457 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:48
2025-03-13 11:38:48,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.44it/s]
2025-03-13 11:38:48,493 [INFO]: There are 3993 embeddings of dim 49152
2025-03-13 11:38:48,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 11:38:48,493 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,493 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:48,493 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:38:48,493 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:48,493 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:48,493 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,493 [INFO]: 824.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:48,493 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:38:48,493 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:48
2025-03-13 11:38:48,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:48,494 [INFO]: 	Creating the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:48
2025-03-13 11:38:48,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:38:48,495 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:48
2025-03-13 11:38:48,495 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:38:48,495 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.21it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.32it/s] 69%|██████▉   | 11/16 [00:00<00:00, 38.40it/s]100%|██████████| 16/16 [00:03<00:00,  3.58it/s]100%|██████████| 16/16 [00:03<00:00,  4.82it/s]
2025-03-13 11:38:51,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:51
2025-03-13 11:39:31,590 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7694 secs
2025-03-13 11:39:31,591 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 11:39:31,591 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 11:39:45,153 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5624 secs
2025-03-13 11:39:45,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6603 secs
2025-03-13 11:39:45,156 [INFO]: {
2025-03-13 11:39:45,156 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:45,156 [INFO]: 	index_param: efSearch=175
2025-03-13 11:39:45,156 [INFO]: 	index_path: knn.index
2025-03-13 11:39:45,156 [INFO]: 	size in bytes: 785598910
2025-03-13 11:39:45,156 [INFO]: 	avg_search_speed_ms: 8.266111500253363
2025-03-13 11:39:45,156 [INFO]: 	99p_search_speed_ms: 11.753557706251744
2025-03-13 11:39:45,156 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:45,156 [INFO]: 	nb vectors: 3993
2025-03-13 11:39:45,156 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:45,156 [INFO]: 	compression ratio: 0.9993085962912042
2025-03-13 11:39:45,156 [INFO]: }
2025-03-13 11:39:45,156 [INFO]: 	>>> Finished "Creating the index" in 56.6621 secs
2025-03-13 11:39:45,156 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6987 secs
2025-03-13 11:39:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 49448 [episode count 3/20]
[retrieval_preprocessing] for episode 256 [episode count 4/20], we have num_retrieval=np.int64(4046) num_query=np.int64(176)
2025-03-13 11:39:47,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:47,623 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:47
2025-03-13 11:39:47,623 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.33it/s]
2025-03-13 11:39:47,655 [INFO]: There are 4046 embeddings of dim 49152
2025-03-13 11:39:47,655 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 11:39:47,655 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:47
2025-03-13 11:39:47,655 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:47,655 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:39:47,655 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:47,655 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:39:47,655 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:47
2025-03-13 11:39:47,655 [INFO]: 835.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:47,655 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:39:47,655 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:47
2025-03-13 11:39:47,655 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:47,655 [INFO]: 	Creating the index 03/13/2025, 11:39:47
2025-03-13 11:39:47,655 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:47
2025-03-13 11:39:47,656 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:39:47,656 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:47
2025-03-13 11:39:47,656 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:39:47,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.67it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.24it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.78it/s]100%|██████████| 16/16 [00:03<00:00,  3.50it/s]100%|██████████| 16/16 [00:03<00:00,  4.70it/s]
2025-03-13 11:39:51,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:51
2025-03-13 11:40:34,742 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6777 secs
2025-03-13 11:40:34,743 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 11:40:34,743 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.92it/s]
2025-03-13 11:40:54,032 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2895 secs
2025-03-13 11:40:54,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3788 secs
2025-03-13 11:40:54,035 [INFO]: {
2025-03-13 11:40:54,035 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:54,035 [INFO]: 	index_param: efSearch=199
2025-03-13 11:40:54,035 [INFO]: 	index_path: knn.index
2025-03-13 11:40:54,035 [INFO]: 	size in bytes: 796026370
2025-03-13 11:40:54,035 [INFO]: 	avg_search_speed_ms: 8.93039611567344
2025-03-13 11:40:54,035 [INFO]: 	99p_search_speed_ms: 11.264909624587743
2025-03-13 11:40:54,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:54,035 [INFO]: 	nb vectors: 4046
2025-03-13 11:40:54,035 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:54,035 [INFO]: 	compression ratio: 0.9993085631070237
2025-03-13 11:40:54,035 [INFO]: }
2025-03-13 11:40:54,035 [INFO]: 	>>> Finished "Creating the index" in 66.3802 secs
2025-03-13 11:40:54,035 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4121 secs
2025-03-13 11:40:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 256 [episode count 4/20]
[retrieval_preprocessing] for episode 90763 [episode count 5/20], we have num_retrieval=np.int64(4026) num_query=np.int64(196)
2025-03-13 11:40:55,608 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:56,103 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:56
2025-03-13 11:40:56,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1823.61it/s]
2025-03-13 11:40:56,132 [INFO]: There are 4026 embeddings of dim 49152
2025-03-13 11:40:56,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:40:56,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:56,132 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:40:56,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:56,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:56,132 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,133 [INFO]: 830.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:56,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:40:56,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:56
2025-03-13 11:40:56,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:56,133 [INFO]: 	Creating the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:56
2025-03-13 11:40:56,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:40:56,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:56
2025-03-13 11:40:56,134 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:40:56,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.12it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.63it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.63it/s]100%|██████████| 16/16 [00:03<00:00,  4.63it/s]
2025-03-13 11:40:59,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:59
2025-03-13 11:41:37,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5133 secs
2025-03-13 11:41:37,104 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 11:41:37,104 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.93it/s]
2025-03-13 11:41:53,280 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1758 secs
2025-03-13 11:41:53,283 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1491 secs
2025-03-13 11:41:53,283 [INFO]: {
2025-03-13 11:41:53,283 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:53,283 [INFO]: 	index_param: efSearch=170
2025-03-13 11:41:53,283 [INFO]: 	index_path: knn.index
2025-03-13 11:41:53,283 [INFO]: 	size in bytes: 792091510
2025-03-13 11:41:53,283 [INFO]: 	avg_search_speed_ms: 8.867657142534442
2025-03-13 11:41:53,283 [INFO]: 	99p_search_speed_ms: 12.846933922264725
2025-03-13 11:41:53,283 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:53,283 [INFO]: 	nb vectors: 4026
2025-03-13 11:41:53,283 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:53,283 [INFO]: 	compression ratio: 0.9993085369643717
2025-03-13 11:41:53,283 [INFO]: }
2025-03-13 11:41:53,283 [INFO]: 	>>> Finished "Creating the index" in 57.1505 secs
2025-03-13 11:41:53,283 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1803 secs
2025-03-13 11:41:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 90763 [episode count 5/20]
[retrieval_preprocessing] for episode 74396 [episode count 6/20], we have num_retrieval=np.int64(3987) num_query=np.int64(235)
2025-03-13 11:41:56,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:56,578 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:56
2025-03-13 11:41:56,578 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.09it/s]
2025-03-13 11:41:56,608 [INFO]: There are 3987 embeddings of dim 49152
2025-03-13 11:41:56,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:41:56,609 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:56
2025-03-13 11:41:56,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:56,609 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:41:56,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:56,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:56,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:56
2025-03-13 11:41:56,609 [INFO]: 822.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:56,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:41:56,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:56
2025-03-13 11:41:56,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:56,609 [INFO]: 	Creating the index 03/13/2025, 11:41:56
2025-03-13 11:41:56,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:56
2025-03-13 11:41:56,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:41:56,610 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:56
2025-03-13 11:41:56,610 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:41:56,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.89it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.64it/s] 81%|████████▏ | 13/16 [00:00<00:00, 44.20it/s]100%|██████████| 16/16 [00:03<00:00,  4.94it/s]
2025-03-13 11:41:59,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:59
2025-03-13 11:42:44,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0512 secs
2025-03-13 11:42:44,905 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 11:42:44,905 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.08it/s]
2025-03-13 11:43:03,588 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6823 secs
2025-03-13 11:43:03,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9798 secs
2025-03-13 11:43:03,590 [INFO]: {
2025-03-13 11:43:03,590 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:03,590 [INFO]: 	index_param: efSearch=210
2025-03-13 11:43:03,590 [INFO]: 	index_path: knn.index
2025-03-13 11:43:03,590 [INFO]: 	size in bytes: 784418470
2025-03-13 11:43:03,590 [INFO]: 	avg_search_speed_ms: 10.49275532001307
2025-03-13 11:43:03,590 [INFO]: 	99p_search_speed_ms: 14.554449813440442
2025-03-13 11:43:03,590 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:03,590 [INFO]: 	nb vectors: 3987
2025-03-13 11:43:03,590 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:03,590 [INFO]: 	compression ratio: 0.9993085654905601
2025-03-13 11:43:03,590 [INFO]: }
2025-03-13 11:43:03,590 [INFO]: 	>>> Finished "Creating the index" in 66.9813 secs
2025-03-13 11:43:03,590 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0123 secs
2025-03-13 11:43:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 74396 [episode count 6/20]
[retrieval_preprocessing] for episode 90852 [episode count 7/20], we have num_retrieval=np.int64(3954) num_query=np.int64(268)
2025-03-13 11:43:05,665 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:07,175 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:07
2025-03-13 11:43:07,175 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1823.61it/s]
2025-03-13 11:43:07,205 [INFO]: There are 3954 embeddings of dim 49152
2025-03-13 11:43:07,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 11:43:07,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:07
2025-03-13 11:43:07,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:07,205 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:43:07,205 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:07,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:43:07,205 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:07
2025-03-13 11:43:07,206 [INFO]: 816.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:07,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:43:07,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:07
2025-03-13 11:43:07,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:07,206 [INFO]: 	Creating the index 03/13/2025, 11:43:07
2025-03-13 11:43:07,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:07
2025-03-13 11:43:07,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:43:07,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:07
2025-03-13 11:43:07,207 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:43:07,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.81it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.50it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.87it/s]100%|██████████| 16/16 [00:03<00:00,  3.45it/s]100%|██████████| 16/16 [00:03<00:00,  4.65it/s]
2025-03-13 11:43:10,648 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:10
2025-03-13 11:43:49,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1955 secs
2025-03-13 11:43:49,844 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 11:43:49,844 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-13 11:44:05,435 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5907 secs
2025-03-13 11:44:05,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2314 secs
2025-03-13 11:44:05,439 [INFO]: {
2025-03-13 11:44:05,439 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:05,439 [INFO]: 	index_param: efSearch=187
2025-03-13 11:44:05,439 [INFO]: 	index_path: knn.index
2025-03-13 11:44:05,439 [INFO]: 	size in bytes: 777925990
2025-03-13 11:44:05,439 [INFO]: 	avg_search_speed_ms: 9.023836536317848
2025-03-13 11:44:05,439 [INFO]: 	99p_search_speed_ms: 13.32709214650095
2025-03-13 11:44:05,439 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:05,439 [INFO]: 	nb vectors: 3954
2025-03-13 11:44:05,439 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:05,439 [INFO]: 	compression ratio: 0.9993084714909705
2025-03-13 11:44:05,439 [INFO]: }
2025-03-13 11:44:05,439 [INFO]: 	>>> Finished "Creating the index" in 58.2330 secs
2025-03-13 11:44:05,439 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2636 secs
2025-03-13 11:44:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 90852 [episode count 7/20]
[retrieval_preprocessing] for episode 25853 [episode count 8/20], we have num_retrieval=np.int64(4058) num_query=np.int64(164)
2025-03-13 11:44:08,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:08,917 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:08
2025-03-13 11:44:08,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.57it/s]
2025-03-13 11:44:08,949 [INFO]: There are 4058 embeddings of dim 49152
2025-03-13 11:44:08,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 11:44:08,949 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:08,949 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:44:08,949 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:08,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:08,949 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,949 [INFO]: 837.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:08,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:44:08,949 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:08
2025-03-13 11:44:08,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:08,949 [INFO]: 	Creating the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,949 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:08
2025-03-13 11:44:08,950 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:44:08,950 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,950 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:44:08,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.00it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.02it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.26it/s]100%|██████████| 16/16 [00:03<00:00,  4.23it/s]
2025-03-13 11:44:12,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:12
2025-03-13 11:45:01,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2707 secs
2025-03-13 11:45:01,009 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:45:01,009 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 11:45:15,774 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7646 secs
2025-03-13 11:45:15,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8261 secs
2025-03-13 11:45:15,777 [INFO]: {
2025-03-13 11:45:15,777 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:15,777 [INFO]: 	index_param: efSearch=216
2025-03-13 11:45:15,777 [INFO]: 	index_path: knn.index
2025-03-13 11:45:15,777 [INFO]: 	size in bytes: 798387250
2025-03-13 11:45:15,777 [INFO]: 	avg_search_speed_ms: 10.833466389213456
2025-03-13 11:45:15,777 [INFO]: 	99p_search_speed_ms: 17.71347069181501
2025-03-13 11:45:15,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:15,777 [INFO]: 	nb vectors: 4058
2025-03-13 11:45:15,777 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:15,777 [INFO]: 	compression ratio: 0.9993086237286479
2025-03-13 11:45:15,777 [INFO]: }
2025-03-13 11:45:15,777 [INFO]: 	>>> Finished "Creating the index" in 66.8279 secs
2025-03-13 11:45:15,777 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8607 secs
2025-03-13 11:45:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 25853 [episode count 8/20]
[retrieval_preprocessing] for episode 17932 [episode count 9/20], we have num_retrieval=np.int64(4074) num_query=np.int64(148)
2025-03-13 11:45:17,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:18,413 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:18
2025-03-13 11:45:18,413 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 11:45:18,453 [INFO]: There are 4074 embeddings of dim 49152
2025-03-13 11:45:18,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 11:45:18,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:18
2025-03-13 11:45:18,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:18,454 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:45:18,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:18,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:18,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:18
2025-03-13 11:45:18,454 [INFO]: 840.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:18,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:45:18,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:18
2025-03-13 11:45:18,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:18,454 [INFO]: 	Creating the index 03/13/2025, 11:45:18
2025-03-13 11:45:18,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:18
2025-03-13 11:45:18,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:45:18,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:18
2025-03-13 11:45:18,455 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:45:18,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.62it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.70it/s] 65%|██████▍   | 11/17 [00:00<00:00, 39.06it/s] 94%|█████████▍| 16/17 [00:00<00:00, 42.70it/s]100%|██████████| 17/17 [00:04<00:00,  4.19it/s]
2025-03-13 11:45:22,511 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:22
2025-03-13 11:46:14,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1822 secs
2025-03-13 11:46:14,694 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 11:46:14,694 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.40it/s]
2025-03-13 11:46:30,867 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1732 secs
2025-03-13 11:46:30,870 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4150 secs
2025-03-13 11:46:30,870 [INFO]: {
2025-03-13 11:46:30,870 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:30,870 [INFO]: 	index_param: efSearch=191
2025-03-13 11:46:30,870 [INFO]: 	index_path: knn.index
2025-03-13 11:46:30,871 [INFO]: 	size in bytes: 801535150
2025-03-13 11:46:30,871 [INFO]: 	avg_search_speed_ms: 10.032051905182563
2025-03-13 11:46:30,871 [INFO]: 	99p_search_speed_ms: 22.271627355366945
2025-03-13 11:46:30,871 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:30,871 [INFO]: 	nb vectors: 4074
2025-03-13 11:46:30,871 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:30,871 [INFO]: 	compression ratio: 0.9993086291973596
2025-03-13 11:46:30,871 [INFO]: }
2025-03-13 11:46:30,871 [INFO]: 	>>> Finished "Creating the index" in 72.4165 secs
2025-03-13 11:46:30,871 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4574 secs
2025-03-13 11:46:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 17932 [episode count 9/20]
[retrieval_preprocessing] for episode 92572 [episode count 10/20], we have num_retrieval=np.int64(4049) num_query=np.int64(173)
2025-03-13 11:46:32,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:33,331 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:33
2025-03-13 11:46:33,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.76it/s]
2025-03-13 11:46:33,364 [INFO]: There are 4049 embeddings of dim 49152
2025-03-13 11:46:33,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 11:46:33,365 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:33
2025-03-13 11:46:33,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:33,365 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:46:33,365 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:33,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:46:33,365 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:33
2025-03-13 11:46:33,365 [INFO]: 835.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:33,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:46:33,365 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:33
2025-03-13 11:46:33,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:33,365 [INFO]: 	Creating the index 03/13/2025, 11:46:33
2025-03-13 11:46:33,365 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:33
2025-03-13 11:46:33,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:46:33,367 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:33
2025-03-13 11:46:33,367 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:46:33,367 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.25it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.26it/s] 81%|████████▏ | 13/16 [00:00<00:00, 41.43it/s]100%|██████████| 16/16 [00:03<00:00,  5.00it/s]
2025-03-13 11:46:36,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:36
2025-03-13 11:47:30,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.3393 secs
2025-03-13 11:47:30,908 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 11:47:30,908 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.76it/s]
2025-03-13 11:47:47,275 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3672 secs
2025-03-13 11:47:47,278 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9112 secs
2025-03-13 11:47:47,278 [INFO]: {
2025-03-13 11:47:47,278 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:47,278 [INFO]: 	index_param: efSearch=208
2025-03-13 11:47:47,278 [INFO]: 	index_path: knn.index
2025-03-13 11:47:47,278 [INFO]: 	size in bytes: 796616590
2025-03-13 11:47:47,278 [INFO]: 	avg_search_speed_ms: 10.054767225405678
2025-03-13 11:47:47,278 [INFO]: 	99p_search_speed_ms: 16.660067113116384
2025-03-13 11:47:47,278 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:47,278 [INFO]: 	nb vectors: 4049
2025-03-13 11:47:47,278 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:47,278 [INFO]: 	compression ratio: 0.9993085782961161
2025-03-13 11:47:47,278 [INFO]: }
2025-03-13 11:47:47,278 [INFO]: 	>>> Finished "Creating the index" in 73.9129 secs
2025-03-13 11:47:47,278 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9472 secs
2025-03-13 11:47:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 92572 [episode count 10/20]
[retrieval_preprocessing] for episode 59795 [episode count 11/20], we have num_retrieval=np.int64(3994) num_query=np.int64(228)
2025-03-13 11:47:49,094 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:49,640 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:49
2025-03-13 11:47:49,641 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 984.12it/s]
2025-03-13 11:47:49,674 [INFO]: There are 3994 embeddings of dim 49152
2025-03-13 11:47:49,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 11:47:49,674 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:49
2025-03-13 11:47:49,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:49,674 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:47:49,674 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:49,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:49,674 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:49
2025-03-13 11:47:49,674 [INFO]: 824.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:49,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:47:49,675 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:49
2025-03-13 11:47:49,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:49,675 [INFO]: 	Creating the index 03/13/2025, 11:47:49
2025-03-13 11:47:49,675 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:49
2025-03-13 11:47:49,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:47:49,676 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:49
2025-03-13 11:47:49,676 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:47:49,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.45it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.43it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.18it/s]100%|██████████| 16/16 [00:03<00:00,  3.62it/s]100%|██████████| 16/16 [00:03<00:00,  4.85it/s]
2025-03-13 11:47:52,978 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:52
2025-03-13 11:48:38,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4601 secs
2025-03-13 11:48:38,439 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 11:48:38,439 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.84it/s]
2025-03-13 11:48:58,563 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1243 secs
2025-03-13 11:48:58,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8904 secs
2025-03-13 11:48:58,566 [INFO]: {
2025-03-13 11:48:58,566 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:58,566 [INFO]: 	index_param: efSearch=234
2025-03-13 11:48:58,566 [INFO]: 	index_path: knn.index
2025-03-13 11:48:58,566 [INFO]: 	size in bytes: 785795650
2025-03-13 11:48:58,566 [INFO]: 	avg_search_speed_ms: 10.307200029290959
2025-03-13 11:48:58,566 [INFO]: 	99p_search_speed_ms: 14.171595242805775
2025-03-13 11:48:58,566 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:58,566 [INFO]: 	nb vectors: 3994
2025-03-13 11:48:58,566 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:58,566 [INFO]: 	compression ratio: 0.9993086014156479
2025-03-13 11:48:58,567 [INFO]: }
2025-03-13 11:48:58,567 [INFO]: 	>>> Finished "Creating the index" in 68.8919 secs
2025-03-13 11:48:58,567 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9260 secs
2025-03-13 11:49:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 59795 [episode count 11/20]
[retrieval_preprocessing] for episode 88236 [episode count 12/20], we have num_retrieval=np.int64(4019) num_query=np.int64(203)
2025-03-13 11:49:01,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:02,568 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:02
2025-03-13 11:49:02,568 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.53it/s]
2025-03-13 11:49:02,599 [INFO]: There are 4019 embeddings of dim 49152
2025-03-13 11:49:02,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 11:49:02,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:02
2025-03-13 11:49:02,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:02,599 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:49:02,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:02,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:02,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:02
2025-03-13 11:49:02,599 [INFO]: 829.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:02,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:49:02,599 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:02
2025-03-13 11:49:02,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:02,599 [INFO]: 	Creating the index 03/13/2025, 11:49:02
2025-03-13 11:49:02,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:02
2025-03-13 11:49:02,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:49:02,600 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:02
2025-03-13 11:49:02,601 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:49:02,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.47it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.33it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.18it/s]100%|██████████| 16/16 [00:03<00:00,  3.13it/s]100%|██████████| 16/16 [00:03<00:00,  4.23it/s]
2025-03-13 11:49:06,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:06
2025-03-13 11:49:46,317 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9278 secs
2025-03-13 11:49:46,318 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 11:49:46,318 [INFO]: 	Compute fast metrics 03/13/2025, 11:49:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.20it/s]
2025-03-13 11:50:02,669 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3510 secs
2025-03-13 11:50:02,672 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0711 secs
2025-03-13 11:50:02,672 [INFO]: {
2025-03-13 11:50:02,672 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:02,672 [INFO]: 	index_param: efSearch=221
2025-03-13 11:50:02,672 [INFO]: 	index_path: knn.index
2025-03-13 11:50:02,672 [INFO]: 	size in bytes: 790714330
2025-03-13 11:50:02,672 [INFO]: 	avg_search_speed_ms: 10.46963569549376
2025-03-13 11:50:02,672 [INFO]: 	99p_search_speed_ms: 13.989549758844078
2025-03-13 11:50:02,672 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:02,672 [INFO]: 	nb vectors: 4019
2025-03-13 11:50:02,672 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:02,672 [INFO]: 	compression ratio: 0.999308501213074
2025-03-13 11:50:02,672 [INFO]: }
2025-03-13 11:50:02,672 [INFO]: 	>>> Finished "Creating the index" in 60.0725 secs
2025-03-13 11:50:02,672 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1037 secs
2025-03-13 11:50:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 88236 [episode count 12/20]
[retrieval_preprocessing] for episode 35473 [episode count 13/20], we have num_retrieval=np.int64(3766) num_query=np.int64(456)
2025-03-13 11:50:04,655 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:05,184 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:05
2025-03-13 11:50:05,184 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1875.81it/s]
2025-03-13 11:50:05,214 [INFO]: There are 3766 embeddings of dim 49152
2025-03-13 11:50:05,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:50:05,215 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:05
2025-03-13 11:50:05,215 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:05,215 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 11:50:05,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:05,215 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:50:05,215 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:05
2025-03-13 11:50:05,215 [INFO]: 777.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:05,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:50:05,215 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:05
2025-03-13 11:50:05,215 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:05,215 [INFO]: 	Creating the index 03/13/2025, 11:50:05
2025-03-13 11:50:05,215 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:05
2025-03-13 11:50:05,216 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:50:05,216 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:05
2025-03-13 11:50:05,216 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:50:05,216 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.45it/s] 40%|████      | 6/15 [00:00<00:00, 28.51it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.40it/s]100%|██████████| 15/15 [00:03<00:00,  3.42it/s]100%|██████████| 15/15 [00:03<00:00,  4.71it/s]
2025-03-13 11:50:08,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:08
2025-03-13 11:50:55,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7991 secs
2025-03-13 11:50:55,202 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:50:55,202 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.34it/s]
2025-03-13 11:51:09,828 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6259 secs
2025-03-13 11:51:09,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6146 secs
2025-03-13 11:51:09,831 [INFO]: {
2025-03-13 11:51:09,831 [INFO]: 	index_key: HNSW15
2025-03-13 11:51:09,831 [INFO]: 	index_param: efSearch=215
2025-03-13 11:51:09,831 [INFO]: 	index_path: knn.index
2025-03-13 11:51:09,831 [INFO]: 	size in bytes: 740937610
2025-03-13 11:51:09,831 [INFO]: 	avg_search_speed_ms: 12.627251859580289
2025-03-13 11:51:09,831 [INFO]: 	99p_search_speed_ms: 23.065746508073072
2025-03-13 11:51:09,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:09,831 [INFO]: 	nb vectors: 3766
2025-03-13 11:51:09,831 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:09,831 [INFO]: 	compression ratio: 0.9993091429115064
2025-03-13 11:51:09,831 [INFO]: }
2025-03-13 11:51:09,831 [INFO]: 	>>> Finished "Creating the index" in 64.6160 secs
2025-03-13 11:51:09,831 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6475 secs
2025-03-13 11:51:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 35473 [episode count 13/20]
[retrieval_preprocessing] for episode 75385 [episode count 14/20], we have num_retrieval=np.int64(4032) num_query=np.int64(190)
2025-03-13 11:51:13,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:51:13,627 [INFO]: Launching the whole pipeline 03/13/2025, 11:51:13
2025-03-13 11:51:13,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:51:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2043.01it/s]
2025-03-13 11:51:13,660 [INFO]: There are 4032 embeddings of dim 49152
2025-03-13 11:51:13,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 11:51:13,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:51:13
2025-03-13 11:51:13,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:51:13,661 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:51:13,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:51:13,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:51:13,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:51:13
2025-03-13 11:51:13,661 [INFO]: 832.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:51:13,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:51:13,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:51:13
2025-03-13 11:51:13,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:51:13,661 [INFO]: 	Creating the index 03/13/2025, 11:51:13
2025-03-13 11:51:13,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:51:13
2025-03-13 11:51:13,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:51:13,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:51:13
2025-03-13 11:51:13,662 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:51:13,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.04it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.94it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.14it/s]100%|██████████| 16/16 [00:03<00:00,  3.41it/s]100%|██████████| 16/16 [00:03<00:00,  4.58it/s]
2025-03-13 11:51:17,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:17
2025-03-13 11:52:02,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7881 secs
2025-03-13 11:52:02,947 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 11:52:02,947 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.42it/s]
2025-03-13 11:52:23,807 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8603 secs
2025-03-13 11:52:23,809 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1473 secs
2025-03-13 11:52:23,810 [INFO]: {
2025-03-13 11:52:23,810 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:23,810 [INFO]: 	index_param: efSearch=241
2025-03-13 11:52:23,810 [INFO]: 	index_path: knn.index
2025-03-13 11:52:23,810 [INFO]: 	size in bytes: 793271950
2025-03-13 11:52:23,810 [INFO]: 	avg_search_speed_ms: 10.321082232145535
2025-03-13 11:52:23,810 [INFO]: 	99p_search_speed_ms: 14.125281805172552
2025-03-13 11:52:23,810 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:23,810 [INFO]: 	nb vectors: 4032
2025-03-13 11:52:23,810 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:23,810 [INFO]: 	compression ratio: 0.9993085675095407
2025-03-13 11:52:23,810 [INFO]: }
2025-03-13 11:52:23,810 [INFO]: 	>>> Finished "Creating the index" in 70.1488 secs
2025-03-13 11:52:23,810 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1825 secs
2025-03-13 11:52:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 75385 [episode count 14/20]
[retrieval_preprocessing] for episode 26590 [episode count 15/20], we have num_retrieval=np.int64(4029) num_query=np.int64(193)
2025-03-13 11:52:25,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:26,518 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:26
2025-03-13 11:52:26,518 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2158.67it/s]
2025-03-13 11:52:26,549 [INFO]: There are 4029 embeddings of dim 49152
2025-03-13 11:52:26,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 11:52:26,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:26
2025-03-13 11:52:26,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:26,549 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:52:26,549 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:26,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:52:26,549 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:26
2025-03-13 11:52:26,549 [INFO]: 831.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:26,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:52:26,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:26
2025-03-13 11:52:26,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:26,549 [INFO]: 	Creating the index 03/13/2025, 11:52:26
2025-03-13 11:52:26,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:26
2025-03-13 11:52:26,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:52:26,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:26
2025-03-13 11:52:26,550 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:52:26,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.31it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.99it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.30it/s]100%|██████████| 16/16 [00:03<00:00,  3.39it/s]100%|██████████| 16/16 [00:03<00:00,  4.56it/s]
2025-03-13 11:52:30,060 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:30
2025-03-13 11:53:11,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9533 secs
2025-03-13 11:53:11,014 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:53:11,014 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 11:53:30,627 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6126 secs
2025-03-13 11:53:31,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4984 secs
2025-03-13 11:53:31,049 [INFO]: {
2025-03-13 11:53:31,049 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:31,049 [INFO]: 	index_param: efSearch=215
2025-03-13 11:53:31,049 [INFO]: 	index_path: knn.index
2025-03-13 11:53:31,049 [INFO]: 	size in bytes: 792681730
2025-03-13 11:53:31,049 [INFO]: 	avg_search_speed_ms: 10.502366625465172
2025-03-13 11:53:31,049 [INFO]: 	99p_search_speed_ms: 13.401663200929761
2025-03-13 11:53:31,049 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:31,049 [INFO]: 	nb vectors: 4029
2025-03-13 11:53:31,049 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:31,050 [INFO]: 	compression ratio: 0.9993085522483279
2025-03-13 11:53:31,050 [INFO]: }
2025-03-13 11:53:31,050 [INFO]: 	>>> Finished "Creating the index" in 64.5004 secs
2025-03-13 11:53:31,050 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5318 secs
2025-03-13 11:53:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 26590 [episode count 15/20]
[retrieval_preprocessing] for episode 89098 [episode count 16/20], we have num_retrieval=np.int64(4019) num_query=np.int64(203)
2025-03-13 11:53:32,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:33,627 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:33
2025-03-13 11:53:33,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.31it/s]
2025-03-13 11:53:33,668 [INFO]: There are 4019 embeddings of dim 49152
2025-03-13 11:53:33,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0414 secs
2025-03-13 11:53:33,669 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:33
2025-03-13 11:53:33,669 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:33,669 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:53:33,669 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:33,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 11:53:33,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:33
2025-03-13 11:53:33,670 [INFO]: 829.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:33,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:53:33,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:33
2025-03-13 11:53:33,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:33,671 [INFO]: 	Creating the index 03/13/2025, 11:53:33
2025-03-13 11:53:33,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:33
2025-03-13 11:53:33,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 11:53:33,675 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:33
2025-03-13 11:53:33,675 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:53:33,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.47it/s] 31%|███▏      | 5/16 [00:00<00:00, 23.51it/s] 56%|█████▋    | 9/16 [00:00<00:00, 28.55it/s] 81%|████████▏ | 13/16 [00:00<00:00, 30.58it/s]100%|██████████| 16/16 [00:04<00:00,  3.84it/s]
2025-03-13 11:53:37,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:37
2025-03-13 11:54:16,800 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9533 secs
2025-03-13 11:54:16,801 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:54:16,801 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-13 11:54:33,159 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3579 secs
2025-03-13 11:54:33,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4870 secs
2025-03-13 11:54:33,162 [INFO]: {
2025-03-13 11:54:33,162 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:33,162 [INFO]: 	index_param: efSearch=184
2025-03-13 11:54:33,162 [INFO]: 	index_path: knn.index
2025-03-13 11:54:33,162 [INFO]: 	size in bytes: 790714330
2025-03-13 11:54:33,162 [INFO]: 	avg_search_speed_ms: 10.030840657354373
2025-03-13 11:54:33,162 [INFO]: 	99p_search_speed_ms: 14.88963859155774
2025-03-13 11:54:33,162 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:33,163 [INFO]: 	nb vectors: 4019
2025-03-13 11:54:33,163 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:33,163 [INFO]: 	compression ratio: 0.999308501213074
2025-03-13 11:54:33,163 [INFO]: }
2025-03-13 11:54:33,163 [INFO]: 	>>> Finished "Creating the index" in 59.4915 secs
2025-03-13 11:54:33,163 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5357 secs
2025-03-13 11:54:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 89098 [episode count 16/20]
[retrieval_preprocessing] for episode 21919 [episode count 17/20], we have num_retrieval=np.int64(3984) num_query=np.int64(238)
2025-03-13 11:54:35,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:35,768 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:35
2025-03-13 11:54:35,768 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-13 11:54:35,801 [INFO]: There are 3984 embeddings of dim 49152
2025-03-13 11:54:35,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 11:54:35,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:35
2025-03-13 11:54:35,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:35,801 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:54:35,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:35,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:35,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:35
2025-03-13 11:54:35,801 [INFO]: 822.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:35,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:54:35,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:35
2025-03-13 11:54:35,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:35,802 [INFO]: 	Creating the index 03/13/2025, 11:54:35
2025-03-13 11:54:35,802 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:35
2025-03-13 11:54:35,803 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:54:35,803 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:35
2025-03-13 11:54:35,803 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:54:35,803 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.14it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.78it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.98it/s]100%|██████████| 16/16 [00:03<00:00,  3.70it/s]100%|██████████| 16/16 [00:03<00:00,  4.98it/s]
2025-03-13 11:54:39,022 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:39
2025-03-13 11:55:19,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2290 secs
2025-03-13 11:55:19,252 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:55:19,253 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-13 11:55:39,243 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9902 secs
2025-03-13 11:55:39,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0485 secs
2025-03-13 11:55:39,852 [INFO]: {
2025-03-13 11:55:39,852 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:39,852 [INFO]: 	index_param: efSearch=194
2025-03-13 11:55:39,852 [INFO]: 	index_path: knn.index
2025-03-13 11:55:39,852 [INFO]: 	size in bytes: 783828250
2025-03-13 11:55:39,852 [INFO]: 	avg_search_speed_ms: 8.857799259627335
2025-03-13 11:55:39,852 [INFO]: 	99p_search_speed_ms: 12.196125257760286
2025-03-13 11:55:39,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:39,852 [INFO]: 	nb vectors: 3984
2025-03-13 11:55:39,852 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:39,852 [INFO]: 	compression ratio: 0.999308550055449
2025-03-13 11:55:39,852 [INFO]: }
2025-03-13 11:55:39,852 [INFO]: 	>>> Finished "Creating the index" in 64.0507 secs
2025-03-13 11:55:39,852 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0844 secs
2025-03-13 11:55:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 21919 [episode count 17/20]
[retrieval_preprocessing] for episode 13683 [episode count 18/20], we have num_retrieval=np.int64(4033) num_query=np.int64(189)
2025-03-13 11:55:41,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:42,534 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:42
2025-03-13 11:55:42,534 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.99it/s]
2025-03-13 11:55:42,567 [INFO]: There are 4033 embeddings of dim 49152
2025-03-13 11:55:42,567 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 11:55:42,567 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:42
2025-03-13 11:55:42,568 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:42,568 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:55:42,568 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:42,568 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:55:42,568 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:42
2025-03-13 11:55:42,568 [INFO]: 832.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:42,568 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:55:42,568 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:42
2025-03-13 11:55:42,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:42,569 [INFO]: 	Creating the index 03/13/2025, 11:55:42
2025-03-13 11:55:42,569 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:42
2025-03-13 11:55:42,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:55:42,571 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:42
2025-03-13 11:55:42,571 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:55:42,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.74it/s] 38%|███▊      | 6/16 [00:00<00:00, 31.04it/s] 62%|██████▎   | 10/16 [00:00<00:00, 35.07it/s] 94%|█████████▍| 15/16 [00:00<00:00, 38.81it/s]100%|██████████| 16/16 [00:03<00:00,  4.63it/s]
2025-03-13 11:55:46,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:46
2025-03-13 11:56:39,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.9123 secs
2025-03-13 11:56:39,945 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 11:56:39,945 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.72it/s]
2025-03-13 11:56:57,895 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9495 secs
2025-03-13 11:56:57,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3262 secs
2025-03-13 11:56:57,897 [INFO]: {
2025-03-13 11:56:57,897 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:57,897 [INFO]: 	index_param: efSearch=198
2025-03-13 11:56:57,897 [INFO]: 	index_path: knn.index
2025-03-13 11:56:57,897 [INFO]: 	size in bytes: 793468690
2025-03-13 11:56:57,897 [INFO]: 	avg_search_speed_ms: 9.655816734248852
2025-03-13 11:56:57,898 [INFO]: 	99p_search_speed_ms: 14.017310587223621
2025-03-13 11:56:57,898 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:57,898 [INFO]: 	nb vectors: 4033
2025-03-13 11:56:57,898 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:57,898 [INFO]: 	compression ratio: 0.9993085725915662
2025-03-13 11:56:57,898 [INFO]: }
2025-03-13 11:56:57,898 [INFO]: 	>>> Finished "Creating the index" in 75.3289 secs
2025-03-13 11:56:57,898 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3634 secs
2025-03-13 11:56:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 13683 [episode count 18/20]
[retrieval_preprocessing] for episode 29953 [episode count 19/20], we have num_retrieval=np.int64(4076) num_query=np.int64(146)
2025-03-13 11:56:59,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:00,636 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:00
2025-03-13 11:57:00,636 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.48it/s]
2025-03-13 11:57:00,670 [INFO]: There are 4076 embeddings of dim 49152
2025-03-13 11:57:00,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 11:57:00,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:00
2025-03-13 11:57:00,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:00,670 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 11:57:00,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:00,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:00,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:00
2025-03-13 11:57:00,670 [INFO]: 841.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:00,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:57:00,671 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:00
2025-03-13 11:57:00,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:00,671 [INFO]: 	Creating the index 03/13/2025, 11:57:00
2025-03-13 11:57:00,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:00
2025-03-13 11:57:00,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:57:00,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:00
2025-03-13 11:57:00,672 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:57:00,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.63it/s] 41%|████      | 7/17 [00:00<00:00, 32.18it/s] 76%|███████▋  | 13/17 [00:00<00:00, 40.82it/s]100%|██████████| 17/17 [00:03<00:00,  5.66it/s]
2025-03-13 11:57:03,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:03
2025-03-13 11:57:50,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5039 secs
2025-03-13 11:57:50,181 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:57:50,181 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 11:58:03,531 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3496 secs
2025-03-13 11:58:03,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8614 secs
2025-03-13 11:58:03,533 [INFO]: {
2025-03-13 11:58:03,533 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:03,534 [INFO]: 	index_param: efSearch=216
2025-03-13 11:58:03,534 [INFO]: 	index_path: knn.index
2025-03-13 11:58:03,534 [INFO]: 	size in bytes: 801928630
2025-03-13 11:58:03,534 [INFO]: 	avg_search_speed_ms: 9.950517698084537
2025-03-13 11:58:03,534 [INFO]: 	99p_search_speed_ms: 14.479201007634405
2025-03-13 11:58:03,534 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:03,534 [INFO]: 	nb vectors: 4076
2025-03-13 11:58:03,534 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:03,534 [INFO]: 	compression ratio: 0.999308639223917
2025-03-13 11:58:03,534 [INFO]: }
2025-03-13 11:58:03,534 [INFO]: 	>>> Finished "Creating the index" in 62.8630 secs
2025-03-13 11:58:03,534 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8977 secs
2025-03-13 11:58:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 29953 [episode count 19/20]
2025-03-13 11:58:05: [retrieval_preprocessing] finished for -1_put_marker_in_pot [chosen_id count 3/260]
2025-03-13 11:58:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_mug [chosen_id count 4/260]
2025-03-13 11:58:06: [retrieval_preprocessing] we have num_total=2455 embedding_dim=49152
[retrieval_preprocessing] for episode 16469 [episode count 0/20], we have num_retrieval=np.int64(2339) num_query=np.int64(116)
2025-03-13 11:58:06,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:07,118 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:07
2025-03-13 11:58:07,118 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1707.08it/s]
2025-03-13 11:58:07,144 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 11:58:07,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:58:07,145 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:07
2025-03-13 11:58:07,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:07,145 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:58:07,145 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:07,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:07,145 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:07
2025-03-13 11:58:07,145 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:07,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:58:07,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:07
2025-03-13 11:58:07,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:07,145 [INFO]: 	Creating the index 03/13/2025, 11:58:07
2025-03-13 11:58:07,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:07
2025-03-13 11:58:07,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:58:07,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:07
2025-03-13 11:58:07,146 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:58:07,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.40it/s] 70%|███████   | 7/10 [00:00<00:00, 35.79it/s]100%|██████████| 10/10 [00:01<00:00,  6.07it/s]
2025-03-13 11:58:08,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:08
2025-03-13 11:58:34,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0355 secs
2025-03-13 11:58:34,833 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 11:58:34,833 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.99it/s]
2025-03-13 11:58:51,801 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9674 secs
2025-03-13 11:58:52,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9309 secs
2025-03-13 11:58:52,078 [INFO]: {
2025-03-13 11:58:52,078 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:52,078 [INFO]: 	index_param: efSearch=208
2025-03-13 11:58:52,078 [INFO]: 	index_path: knn.index
2025-03-13 11:58:52,078 [INFO]: 	size in bytes: 460183870
2025-03-13 11:58:52,078 [INFO]: 	avg_search_speed_ms: 9.806448336252394
2025-03-13 11:58:52,078 [INFO]: 	99p_search_speed_ms: 14.517820109613233
2025-03-13 11:58:52,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:52,078 [INFO]: 	nb vectors: 2339
2025-03-13 11:58:52,078 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:52,078 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 11:58:52,078 [INFO]: }
2025-03-13 11:58:52,078 [INFO]: 	>>> Finished "Creating the index" in 44.9332 secs
2025-03-13 11:58:52,078 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9606 secs
2025-03-13 11:58:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 16469 [episode count 0/20]
[retrieval_preprocessing] for episode 16480 [episode count 1/20], we have num_retrieval=np.int64(2367) num_query=np.int64(88)
2025-03-13 11:58:53,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:53,757 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:53
2025-03-13 11:58:53,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1615.06it/s]
2025-03-13 11:58:53,789 [INFO]: There are 2367 embeddings of dim 49152
2025-03-13 11:58:53,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 11:58:53,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:53
2025-03-13 11:58:53,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:53,790 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:58:53,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:53,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:53,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:53
2025-03-13 11:58:53,790 [INFO]: 488.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:53,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:58:53,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:53
2025-03-13 11:58:53,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:53,790 [INFO]: 	Creating the index 03/13/2025, 11:58:53
2025-03-13 11:58:53,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:53
2025-03-13 11:58:53,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:58:53,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:53
2025-03-13 11:58:53,792 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:58:53,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.35it/s] 70%|███████   | 7/10 [00:00<00:00, 34.53it/s]100%|██████████| 10/10 [00:01<00:00,  5.14it/s]
2025-03-13 11:58:55,740 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:55
2025-03-13 11:59:22,695 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9545 secs
2025-03-13 11:59:22,695 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 11:59:22,695 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.04it/s]
2025-03-13 11:59:36,027 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3312 secs
2025-03-13 11:59:36,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2367 secs
2025-03-13 11:59:36,029 [INFO]: {
2025-03-13 11:59:36,029 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:36,029 [INFO]: 	index_param: efSearch=211
2025-03-13 11:59:36,029 [INFO]: 	index_path: knn.index
2025-03-13 11:59:36,029 [INFO]: 	size in bytes: 465692650
2025-03-13 11:59:36,029 [INFO]: 	avg_search_speed_ms: 10.663424604145417
2025-03-13 11:59:36,029 [INFO]: 	99p_search_speed_ms: 14.991104670334606
2025-03-13 11:59:36,029 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:36,029 [INFO]: 	nb vectors: 2367
2025-03-13 11:59:36,029 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:36,029 [INFO]: 	compression ratio: 0.999309600441407
2025-03-13 11:59:36,029 [INFO]: }
2025-03-13 11:59:36,029 [INFO]: 	>>> Finished "Creating the index" in 42.2391 secs
2025-03-13 11:59:36,029 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2718 secs
2025-03-13 11:59:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 16480 [episode count 1/20]
[retrieval_preprocessing] for episode 90768 [episode count 2/20], we have num_retrieval=np.int64(2309) num_query=np.int64(146)
2025-03-13 11:59:36,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:37,188 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:37
2025-03-13 11:59:37,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-13 11:59:37,211 [INFO]: There are 2309 embeddings of dim 49152
2025-03-13 11:59:37,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 11:59:37,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:37
2025-03-13 11:59:37,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:37,211 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:59:37,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:37,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:59:37,211 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:37
2025-03-13 11:59:37,211 [INFO]: 476.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:37,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:59:37,211 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:37
2025-03-13 11:59:37,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:37,212 [INFO]: 	Creating the index 03/13/2025, 11:59:37
2025-03-13 11:59:37,212 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:37
2025-03-13 11:59:37,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:59:37,213 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:37
2025-03-13 11:59:37,213 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:59:37,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.37it/s] 80%|████████  | 8/10 [00:00<00:00, 37.15it/s]100%|██████████| 10/10 [00:01<00:00,  5.62it/s]
2025-03-13 11:59:38,994 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:38
2025-03-13 12:00:05,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3860 secs
2025-03-13 12:00:05,381 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 12:00:05,381 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.50it/s]
2025-03-13 12:00:23,956 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5751 secs
2025-03-13 12:00:23,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7451 secs
2025-03-13 12:00:23,958 [INFO]: {
2025-03-13 12:00:23,958 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:23,958 [INFO]: 	index_param: efSearch=240
2025-03-13 12:00:23,958 [INFO]: 	index_path: knn.index
2025-03-13 12:00:23,958 [INFO]: 	size in bytes: 454281610
2025-03-13 12:00:23,958 [INFO]: 	avg_search_speed_ms: 11.459578872783128
2025-03-13 12:00:23,958 [INFO]: 	99p_search_speed_ms: 17.6950885169208
2025-03-13 12:00:23,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:23,958 [INFO]: 	nb vectors: 2309
2025-03-13 12:00:23,958 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:23,958 [INFO]: 	compression ratio: 0.9993093755214965
2025-03-13 12:00:23,958 [INFO]: }
2025-03-13 12:00:23,958 [INFO]: 	>>> Finished "Creating the index" in 46.7466 secs
2025-03-13 12:00:23,958 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7704 secs
2025-03-13 12:00:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 90768 [episode count 2/20]
[retrieval_preprocessing] for episode 837 [episode count 3/20], we have num_retrieval=np.int64(2347) num_query=np.int64(108)
2025-03-13 12:00:26,191 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:26,587 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:26
2025-03-13 12:00:26,587 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.16it/s]
2025-03-13 12:00:26,617 [INFO]: There are 2347 embeddings of dim 49152
2025-03-13 12:00:26,617 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 12:00:26,617 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:26
2025-03-13 12:00:26,617 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:26,617 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:00:26,617 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:26,617 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:00:26,617 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:26
2025-03-13 12:00:26,617 [INFO]: 484.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:26,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:00:26,617 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:26
2025-03-13 12:00:26,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:26,617 [INFO]: 	Creating the index 03/13/2025, 12:00:26
2025-03-13 12:00:26,618 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:26
2025-03-13 12:00:26,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:00:26,619 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:26
2025-03-13 12:00:26,619 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:00:26,619 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.71it/s] 60%|██████    | 6/10 [00:00<00:00, 32.17it/s]100%|██████████| 10/10 [00:01<00:00,  4.73it/s]100%|██████████| 10/10 [00:01<00:00,  5.63it/s]
2025-03-13 12:00:28,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:28
2025-03-13 12:00:56,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2582 secs
2025-03-13 12:00:56,657 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 12:00:56,657 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.30it/s]
2025-03-13 12:01:16,814 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1575 secs
2025-03-13 12:01:16,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1974 secs
2025-03-13 12:01:16,816 [INFO]: {
2025-03-13 12:01:16,816 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:16,816 [INFO]: 	index_param: efSearch=138
2025-03-13 12:01:16,816 [INFO]: 	index_path: knn.index
2025-03-13 12:01:16,816 [INFO]: 	size in bytes: 461757790
2025-03-13 12:01:16,816 [INFO]: 	avg_search_speed_ms: 6.84080047009923
2025-03-13 12:01:16,816 [INFO]: 	99p_search_speed_ms: 9.206017926335338
2025-03-13 12:01:16,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:16,816 [INFO]: 	nb vectors: 2347
2025-03-13 12:01:16,816 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:16,816 [INFO]: 	compression ratio: 0.9993095644363682
2025-03-13 12:01:16,816 [INFO]: }
2025-03-13 12:01:16,816 [INFO]: 	>>> Finished "Creating the index" in 50.1988 secs
2025-03-13 12:01:16,816 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2291 secs
2025-03-13 12:01:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 837 [episode count 3/20]
[retrieval_preprocessing] for episode 25942 [episode count 4/20], we have num_retrieval=np.int64(2310) num_query=np.int64(145)
2025-03-13 12:01:17,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:18,049 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:18
2025-03-13 12:01:18,049 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1784.05it/s]
2025-03-13 12:01:18,070 [INFO]: There are 2310 embeddings of dim 49152
2025-03-13 12:01:18,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 12:01:18,071 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:18,071 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:01:18,071 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:18,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:01:18,071 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,071 [INFO]: 476.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:18,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:01:18,071 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:18
2025-03-13 12:01:18,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:18,071 [INFO]: 	Creating the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,071 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:18
2025-03-13 12:01:18,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:01:18,072 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,072 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:01:18,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.07it/s] 70%|███████   | 7/10 [00:00<00:00, 34.08it/s]100%|██████████| 10/10 [00:03<00:00,  3.30it/s]
2025-03-13 12:01:21,102 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:21
2025-03-13 12:01:47,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9484 secs
2025-03-13 12:01:47,051 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 12:01:47,051 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.92it/s]
2025-03-13 12:02:08,165 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1139 secs
2025-03-13 12:02:08,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0947 secs
2025-03-13 12:02:08,167 [INFO]: {
2025-03-13 12:02:08,167 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:08,167 [INFO]: 	index_param: efSearch=220
2025-03-13 12:02:08,167 [INFO]: 	index_path: knn.index
2025-03-13 12:02:08,167 [INFO]: 	size in bytes: 454478350
2025-03-13 12:02:08,167 [INFO]: 	avg_search_speed_ms: 9.491086430075372
2025-03-13 12:02:08,167 [INFO]: 	99p_search_speed_ms: 11.83965458534658
2025-03-13 12:02:08,167 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:08,167 [INFO]: 	nb vectors: 2310
2025-03-13 12:02:08,167 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:08,167 [INFO]: 	compression ratio: 0.9993093840443664
2025-03-13 12:02:08,167 [INFO]: }
2025-03-13 12:02:08,167 [INFO]: 	>>> Finished "Creating the index" in 50.0961 secs
2025-03-13 12:02:08,167 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1186 secs
2025-03-13 12:02:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 25942 [episode count 4/20]
[retrieval_preprocessing] for episode 2000 [episode count 5/20], we have num_retrieval=np.int64(2322) num_query=np.int64(133)
2025-03-13 12:02:11,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:11,860 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:11
2025-03-13 12:02:11,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.43it/s]
2025-03-13 12:02:11,893 [INFO]: There are 2322 embeddings of dim 49152
2025-03-13 12:02:11,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 12:02:11,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,895 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:11,895 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:02:11,895 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:11,895 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:02:11,895 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,895 [INFO]: 479.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:11,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:02:11,896 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:11
2025-03-13 12:02:11,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:11,896 [INFO]: 	Creating the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,896 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:11
2025-03-13 12:02:11,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:02:11,900 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,900 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:02:11,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.25it/s] 70%|███████   | 7/10 [00:00<00:00, 34.79it/s]100%|██████████| 10/10 [00:02<00:00,  4.78it/s]
2025-03-13 12:02:14,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:14
2025-03-13 12:02:52,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3990 secs
2025-03-13 12:02:52,400 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 12:02:52,401 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.10it/s]
2025-03-13 12:03:08,077 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6767 secs
2025-03-13 12:03:08,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1795 secs
2025-03-13 12:03:08,079 [INFO]: {
2025-03-13 12:03:08,079 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:08,079 [INFO]: 	index_param: efSearch=141
2025-03-13 12:03:08,079 [INFO]: 	index_path: knn.index
2025-03-13 12:03:08,079 [INFO]: 	size in bytes: 456839290
2025-03-13 12:03:08,079 [INFO]: 	avg_search_speed_ms: 8.169457805837547
2025-03-13 12:03:08,079 [INFO]: 	99p_search_speed_ms: 11.595620508305728
2025-03-13 12:03:08,079 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:08,080 [INFO]: 	nb vectors: 2322
2025-03-13 12:03:08,080 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:08,080 [INFO]: 	compression ratio: 0.9993093544996973
2025-03-13 12:03:08,080 [INFO]: }
2025-03-13 12:03:08,080 [INFO]: 	>>> Finished "Creating the index" in 56.1833 secs
2025-03-13 12:03:08,080 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2196 secs
2025-03-13 12:03:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 2000 [episode count 5/20]
[retrieval_preprocessing] for episode 17374 [episode count 6/20], we have num_retrieval=np.int64(2348) num_query=np.int64(107)
2025-03-13 12:03:09,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:09,467 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:09
2025-03-13 12:03:09,467 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1745.44it/s]
2025-03-13 12:03:09,499 [INFO]: There are 2348 embeddings of dim 49152
2025-03-13 12:03:09,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 12:03:09,499 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,500 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:09,500 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:03:09,500 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:09,500 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:09,500 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,500 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:09,500 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:03:09,500 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:09
2025-03-13 12:03:09,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:09,500 [INFO]: 	Creating the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:09
2025-03-13 12:03:09,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:03:09,501 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,501 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:03:09,502 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.28it/s] 60%|██████    | 6/10 [00:00<00:00, 30.77it/s]100%|██████████| 10/10 [00:02<00:00,  3.84it/s]100%|██████████| 10/10 [00:02<00:00,  4.60it/s]
2025-03-13 12:03:11,677 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:11
2025-03-13 12:03:40,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1560 secs
2025-03-13 12:03:40,833 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 12:03:40,833 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.07it/s]
2025-03-13 12:04:00,628 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7947 secs
2025-03-13 12:04:00,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1284 secs
2025-03-13 12:04:00,630 [INFO]: {
2025-03-13 12:04:00,630 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:00,630 [INFO]: 	index_param: efSearch=197
2025-03-13 12:04:00,630 [INFO]: 	index_path: knn.index
2025-03-13 12:04:00,630 [INFO]: 	size in bytes: 461954530
2025-03-13 12:04:00,630 [INFO]: 	avg_search_speed_ms: 9.990396788697335
2025-03-13 12:04:00,630 [INFO]: 	99p_search_speed_ms: 14.216197887435555
2025-03-13 12:04:00,630 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:00,630 [INFO]: 	nb vectors: 2348
2025-03-13 12:04:00,630 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:00,630 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-13 12:04:00,630 [INFO]: }
2025-03-13 12:04:00,630 [INFO]: 	>>> Finished "Creating the index" in 51.1301 secs
2025-03-13 12:04:00,630 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1634 secs
2025-03-13 12:04:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 17374 [episode count 6/20]
[retrieval_preprocessing] for episode 74789 [episode count 7/20], we have num_retrieval=np.int64(2363) num_query=np.int64(92)
2025-03-13 12:04:01,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:02,566 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:02
2025-03-13 12:04:02,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2286.97it/s]
2025-03-13 12:04:02,598 [INFO]: There are 2363 embeddings of dim 49152
2025-03-13 12:04:02,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 12:04:02,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:02,599 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:04:02,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:02,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:04:02,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,600 [INFO]: 487.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:02,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:04:02,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:02
2025-03-13 12:04:02,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:02,601 [INFO]: 	Creating the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,601 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:02
2025-03-13 12:04:02,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 12:04:02,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:02
2025-03-13 12:04:02,604 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:04:02,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.76it/s] 70%|███████   | 7/10 [00:00<00:00, 36.59it/s]100%|██████████| 10/10 [00:01<00:00,  5.07it/s]
2025-03-13 12:04:04,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:04
2025-03-13 12:04:36,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0645 secs
2025-03-13 12:04:36,648 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 12:04:36,648 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-13 12:04:52,303 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6553 secs
2025-03-13 12:04:52,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7016 secs
2025-03-13 12:04:52,305 [INFO]: {
2025-03-13 12:04:52,305 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:52,305 [INFO]: 	index_param: efSearch=179
2025-03-13 12:04:52,305 [INFO]: 	index_path: knn.index
2025-03-13 12:04:52,305 [INFO]: 	size in bytes: 464905690
2025-03-13 12:04:52,305 [INFO]: 	avg_search_speed_ms: 8.31000728743844
2025-03-13 12:04:52,305 [INFO]: 	99p_search_speed_ms: 11.629316958133131
2025-03-13 12:04:52,305 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:52,305 [INFO]: 	nb vectors: 2363
2025-03-13 12:04:52,305 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:52,306 [INFO]: 	compression ratio: 0.9993095674952913
2025-03-13 12:04:52,306 [INFO]: }
2025-03-13 12:04:52,306 [INFO]: 	>>> Finished "Creating the index" in 49.7049 secs
2025-03-13 12:04:52,306 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7393 secs
2025-03-13 12:04:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 74789 [episode count 7/20]
[retrieval_preprocessing] for episode 85864 [episode count 8/20], we have num_retrieval=np.int64(2340) num_query=np.int64(115)
2025-03-13 12:04:53,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:53,635 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:53
2025-03-13 12:04:53,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-13 12:04:53,660 [INFO]: There are 2340 embeddings of dim 49152
2025-03-13 12:04:53,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 12:04:53,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:53
2025-03-13 12:04:53,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:53,660 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:04:53,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:53,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:04:53,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:53
2025-03-13 12:04:53,661 [INFO]: 482.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:53,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:53,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:53
2025-03-13 12:04:53,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:53,661 [INFO]: 	Creating the index 03/13/2025, 12:04:53
2025-03-13 12:04:53,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:53
2025-03-13 12:04:53,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:04:53,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:53
2025-03-13 12:04:53,662 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:04:53,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.55it/s] 60%|██████    | 6/10 [00:00<00:00, 27.37it/s]100%|██████████| 10/10 [00:01<00:00,  4.37it/s]100%|██████████| 10/10 [00:01<00:00,  5.18it/s]
2025-03-13 12:04:55,594 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:55
2025-03-13 12:05:26,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8560 secs
2025-03-13 12:05:26,451 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 12:05:26,451 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.51it/s]
2025-03-13 12:05:43,300 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8487 secs
2025-03-13 12:05:43,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6401 secs
2025-03-13 12:05:43,302 [INFO]: {
2025-03-13 12:05:43,302 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:43,302 [INFO]: 	index_param: efSearch=145
2025-03-13 12:05:43,302 [INFO]: 	index_path: knn.index
2025-03-13 12:05:43,302 [INFO]: 	size in bytes: 460380610
2025-03-13 12:05:43,302 [INFO]: 	avg_search_speed_ms: 6.911936171807262
2025-03-13 12:05:43,302 [INFO]: 	99p_search_speed_ms: 9.361097724176943
2025-03-13 12:05:43,302 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:43,302 [INFO]: 	nb vectors: 2340
2025-03-13 12:05:43,302 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:43,302 [INFO]: 	compression ratio: 0.9993095061062628
2025-03-13 12:05:43,302 [INFO]: }
2025-03-13 12:05:43,302 [INFO]: 	>>> Finished "Creating the index" in 49.6415 secs
2025-03-13 12:05:43,302 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6674 secs
2025-03-13 12:05:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 85864 [episode count 8/20]
[retrieval_preprocessing] for episode 79407 [episode count 9/20], we have num_retrieval=np.int64(2327) num_query=np.int64(128)
2025-03-13 12:05:45,204 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:45,522 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:45
2025-03-13 12:05:45,522 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1240.92it/s]
2025-03-13 12:05:45,555 [INFO]: There are 2327 embeddings of dim 49152
2025-03-13 12:05:45,556 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 12:05:45,556 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:45
2025-03-13 12:05:45,556 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:45,556 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:05:45,557 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:45,557 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:05:45,557 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:45
2025-03-13 12:05:45,557 [INFO]: 480.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:45,558 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:05:45,558 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:45
2025-03-13 12:05:45,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:45,558 [INFO]: 	Creating the index 03/13/2025, 12:05:45
2025-03-13 12:05:45,558 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:45
2025-03-13 12:05:45,561 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:05:45,561 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:45
2025-03-13 12:05:45,561 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:05:45,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.23it/s] 80%|████████  | 8/10 [00:00<00:00, 38.55it/s]100%|██████████| 10/10 [00:01<00:00,  5.34it/s]
2025-03-13 12:05:47,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:47
2025-03-13 12:06:15,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1843 secs
2025-03-13 12:06:15,624 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 12:06:15,624 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.49it/s]
2025-03-13 12:06:31,936 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3115 secs
2025-03-13 12:06:32,701 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1400 secs
2025-03-13 12:06:32,702 [INFO]: {
2025-03-13 12:06:32,702 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:32,702 [INFO]: 	index_param: efSearch=157
2025-03-13 12:06:32,702 [INFO]: 	index_path: knn.index
2025-03-13 12:06:32,702 [INFO]: 	size in bytes: 457822990
2025-03-13 12:06:32,702 [INFO]: 	avg_search_speed_ms: 9.128379252914298
2025-03-13 12:06:32,702 [INFO]: 	99p_search_speed_ms: 13.831396540626884
2025-03-13 12:06:32,702 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:32,702 [INFO]: 	nb vectors: 2327
2025-03-13 12:06:32,702 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:32,702 [INFO]: 	compression ratio: 0.9993093968478953
2025-03-13 12:06:32,702 [INFO]: }
2025-03-13 12:06:32,702 [INFO]: 	>>> Finished "Creating the index" in 47.1444 secs
2025-03-13 12:06:32,702 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1806 secs
2025-03-13 12:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 79407 [episode count 9/20]
[retrieval_preprocessing] for episode 30492 [episode count 10/20], we have num_retrieval=np.int64(2327) num_query=np.int64(128)
2025-03-13 12:06:33,807 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:34,170 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:34
2025-03-13 12:06:34,170 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2054.02it/s]
2025-03-13 12:06:34,198 [INFO]: There are 2327 embeddings of dim 49152
2025-03-13 12:06:34,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 12:06:34,199 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:34
2025-03-13 12:06:34,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:34,199 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:06:34,199 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:34,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:06:34,200 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:34
2025-03-13 12:06:34,200 [INFO]: 480.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:34,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:06:34,200 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:34
2025-03-13 12:06:34,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:34,200 [INFO]: 	Creating the index 03/13/2025, 12:06:34
2025-03-13 12:06:34,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:34
2025-03-13 12:06:34,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:06:34,204 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:34
2025-03-13 12:06:34,204 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:06:34,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.25it/s] 70%|███████   | 7/10 [00:00<00:00, 33.54it/s]100%|██████████| 10/10 [00:02<00:00,  4.81it/s]
2025-03-13 12:06:36,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:36
2025-03-13 12:07:08,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7278 secs
2025-03-13 12:07:08,016 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 12:07:08,016 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.26it/s]
2025-03-13 12:07:25,671 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6548 secs
2025-03-13 12:07:25,672 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4685 secs
2025-03-13 12:07:25,673 [INFO]: {
2025-03-13 12:07:25,673 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:25,673 [INFO]: 	index_param: efSearch=97
2025-03-13 12:07:25,673 [INFO]: 	index_path: knn.index
2025-03-13 12:07:25,673 [INFO]: 	size in bytes: 457822990
2025-03-13 12:07:25,673 [INFO]: 	avg_search_speed_ms: 5.3287744523335165
2025-03-13 12:07:25,673 [INFO]: 	99p_search_speed_ms: 7.3481689766049385
2025-03-13 12:07:25,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:25,673 [INFO]: 	nb vectors: 2327
2025-03-13 12:07:25,673 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:25,673 [INFO]: 	compression ratio: 0.9993093968478953
2025-03-13 12:07:25,673 [INFO]: }
2025-03-13 12:07:25,673 [INFO]: 	>>> Finished "Creating the index" in 51.4722 secs
2025-03-13 12:07:25,673 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5023 secs
2025-03-13 12:07:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 30492 [episode count 10/20]
[retrieval_preprocessing] for episode 92719 [episode count 11/20], we have num_retrieval=np.int64(2363) num_query=np.int64(92)
2025-03-13 12:07:26,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:26,820 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:26
2025-03-13 12:07:26,820 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-13 12:07:26,850 [INFO]: There are 2363 embeddings of dim 49152
2025-03-13 12:07:26,850 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 12:07:26,850 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,850 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:26,850 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:07:26,850 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:26,850 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:07:26,850 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,850 [INFO]: 487.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:26,850 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:07:26,850 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:26
2025-03-13 12:07:26,850 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:26,851 [INFO]: 	Creating the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,851 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:26
2025-03-13 12:07:26,852 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:07:26,852 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:26
2025-03-13 12:07:26,852 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:07:26,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.47it/s] 70%|███████   | 7/10 [00:00<00:00, 31.48it/s]100%|██████████| 10/10 [00:02<00:00,  4.84it/s]
2025-03-13 12:07:28,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:28
2025-03-13 12:07:56,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0565 secs
2025-03-13 12:07:56,979 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 12:07:56,979 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.14it/s]
2025-03-13 12:08:14,244 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2641 secs
2025-03-13 12:08:14,683 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8316 secs
2025-03-13 12:08:14,684 [INFO]: {
2025-03-13 12:08:14,684 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:14,684 [INFO]: 	index_param: efSearch=134
2025-03-13 12:08:14,684 [INFO]: 	index_path: knn.index
2025-03-13 12:08:14,684 [INFO]: 	size in bytes: 464905690
2025-03-13 12:08:14,684 [INFO]: 	avg_search_speed_ms: 7.2824526111848344
2025-03-13 12:08:14,684 [INFO]: 	99p_search_speed_ms: 11.417472260072824
2025-03-13 12:08:14,684 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:14,684 [INFO]: 	nb vectors: 2363
2025-03-13 12:08:14,684 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:14,684 [INFO]: 	compression ratio: 0.9993095674952913
2025-03-13 12:08:14,684 [INFO]: }
2025-03-13 12:08:14,684 [INFO]: 	>>> Finished "Creating the index" in 47.8338 secs
2025-03-13 12:08:14,684 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8643 secs
2025-03-13 12:08:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 92719 [episode count 11/20]
[retrieval_preprocessing] for episode 95358 [episode count 12/20], we have num_retrieval=np.int64(2306) num_query=np.int64(149)
2025-03-13 12:08:15,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:15,918 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:15
2025-03-13 12:08:15,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.78it/s]
2025-03-13 12:08:15,947 [INFO]: There are 2306 embeddings of dim 49152
2025-03-13 12:08:15,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:08:15,948 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:15
2025-03-13 12:08:15,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:15,948 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:08:15,948 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:15,948 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:08:15,948 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:15
2025-03-13 12:08:15,948 [INFO]: 475.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:15,948 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:08:15,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:15
2025-03-13 12:08:15,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:15,948 [INFO]: 	Creating the index 03/13/2025, 12:08:15
2025-03-13 12:08:15,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:15
2025-03-13 12:08:15,950 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:08:15,950 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:15
2025-03-13 12:08:15,950 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:08:15,950 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.87it/s] 60%|██████    | 6/10 [00:00<00:00, 29.19it/s]100%|██████████| 10/10 [00:01<00:00,  4.45it/s]100%|██████████| 10/10 [00:01<00:00,  5.28it/s]
2025-03-13 12:08:17,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:17
2025-03-13 12:08:45,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4424 secs
2025-03-13 12:08:45,293 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:08:45,293 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-13 12:09:02,043 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7503 secs
2025-03-13 12:09:02,045 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0948 secs
2025-03-13 12:09:02,045 [INFO]: {
2025-03-13 12:09:02,045 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:02,045 [INFO]: 	index_param: efSearch=208
2025-03-13 12:09:02,045 [INFO]: 	index_path: knn.index
2025-03-13 12:09:02,045 [INFO]: 	size in bytes: 453691330
2025-03-13 12:09:02,045 [INFO]: 	avg_search_speed_ms: 10.608244060922893
2025-03-13 12:09:02,045 [INFO]: 	99p_search_speed_ms: 14.03888719622046
2025-03-13 12:09:02,045 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:02,045 [INFO]: 	nb vectors: 2306
2025-03-13 12:09:02,045 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:02,045 [INFO]: 	compression ratio: 0.9993094820657031
2025-03-13 12:09:02,045 [INFO]: }
2025-03-13 12:09:02,045 [INFO]: 	>>> Finished "Creating the index" in 46.0966 secs
2025-03-13 12:09:02,045 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1268 secs
2025-03-13 12:09:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 95358 [episode count 12/20]
[retrieval_preprocessing] for episode 39748 [episode count 13/20], we have num_retrieval=np.int64(2325) num_query=np.int64(130)
2025-03-13 12:09:03,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:03,940 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:03
2025-03-13 12:09:03,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1580.37it/s]
2025-03-13 12:09:03,972 [INFO]: There are 2325 embeddings of dim 49152
2025-03-13 12:09:03,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 12:09:03,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:03
2025-03-13 12:09:03,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:03,973 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:09:03,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:03,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:09:03,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:03
2025-03-13 12:09:03,973 [INFO]: 479.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:03,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:09:03,973 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:03
2025-03-13 12:09:03,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:03,973 [INFO]: 	Creating the index 03/13/2025, 12:09:03
2025-03-13 12:09:03,973 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:03
2025-03-13 12:09:03,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:09:03,974 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:03
2025-03-13 12:09:03,974 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:09:03,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.26it/s] 60%|██████    | 6/10 [00:00<00:00, 27.91it/s]100%|██████████| 10/10 [00:02<00:00,  3.74it/s]100%|██████████| 10/10 [00:02<00:00,  4.47it/s]
2025-03-13 12:09:06,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:06
2025-03-13 12:09:35,556 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3421 secs
2025-03-13 12:09:35,556 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 12:09:35,556 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-13 12:09:51,723 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1669 secs
2025-03-13 12:09:51,725 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7505 secs
2025-03-13 12:09:51,725 [INFO]: {
2025-03-13 12:09:51,725 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:51,725 [INFO]: 	index_param: efSearch=184
2025-03-13 12:09:51,725 [INFO]: 	index_path: knn.index
2025-03-13 12:09:51,725 [INFO]: 	size in bytes: 457429510
2025-03-13 12:09:51,725 [INFO]: 	avg_search_speed_ms: 8.91941683749061
2025-03-13 12:09:51,725 [INFO]: 	99p_search_speed_ms: 13.240338023751972
2025-03-13 12:09:51,725 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:51,725 [INFO]: 	nb vectors: 2325
2025-03-13 12:09:51,725 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:51,725 [INFO]: 	compression ratio: 0.9993093799304728
2025-03-13 12:09:51,725 [INFO]: }
2025-03-13 12:09:51,725 [INFO]: 	>>> Finished "Creating the index" in 47.7520 secs
2025-03-13 12:09:51,725 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7852 secs
2025-03-13 12:09:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 39748 [episode count 13/20]
[retrieval_preprocessing] for episode 8878 [episode count 14/20], we have num_retrieval=np.int64(2301) num_query=np.int64(154)
2025-03-13 12:09:52,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:53,267 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:53
2025-03-13 12:09:53,267 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2101.35it/s]
2025-03-13 12:09:53,291 [INFO]: There are 2301 embeddings of dim 49152
2025-03-13 12:09:53,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 12:09:53,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:53
2025-03-13 12:09:53,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:53,291 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:09:53,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:53,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:09:53,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:53
2025-03-13 12:09:53,291 [INFO]: 474.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:53,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:09:53,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:53
2025-03-13 12:09:53,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:53,292 [INFO]: 	Creating the index 03/13/2025, 12:09:53
2025-03-13 12:09:53,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:53
2025-03-13 12:09:53,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:09:53,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:53
2025-03-13 12:09:53,293 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:09:53,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.72it/s] 60%|██████    | 6/10 [00:00<00:00, 31.87it/s]100%|██████████| 10/10 [00:01<00:00,  4.51it/s]100%|██████████| 10/10 [00:01<00:00,  5.38it/s]
2025-03-13 12:09:55,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:55
2025-03-13 12:10:24,401 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2464 secs
2025-03-13 12:10:24,401 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 12:10:24,401 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.31it/s]
2025-03-13 12:10:40,734 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3325 secs
2025-03-13 12:10:40,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4434 secs
2025-03-13 12:10:40,736 [INFO]: {
2025-03-13 12:10:40,736 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:40,736 [INFO]: 	index_param: efSearch=145
2025-03-13 12:10:40,736 [INFO]: 	index_path: knn.index
2025-03-13 12:10:40,736 [INFO]: 	size in bytes: 452707630
2025-03-13 12:10:40,736 [INFO]: 	avg_search_speed_ms: 9.05600262856389
2025-03-13 12:10:40,736 [INFO]: 	99p_search_speed_ms: 12.618096750229599
2025-03-13 12:10:40,736 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:40,736 [INFO]: 	nb vectors: 2301
2025-03-13 12:10:40,736 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:40,736 [INFO]: 	compression ratio: 0.999309439516184
2025-03-13 12:10:40,736 [INFO]: }
2025-03-13 12:10:40,736 [INFO]: 	>>> Finished "Creating the index" in 47.4447 secs
2025-03-13 12:10:40,736 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4693 secs
2025-03-13 12:10:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 8878 [episode count 14/20]
[retrieval_preprocessing] for episode 56275 [episode count 15/20], we have num_retrieval=np.int64(2317) num_query=np.int64(138)
2025-03-13 12:10:42,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:42,487 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:42
2025-03-13 12:10:42,487 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1366.22it/s]
2025-03-13 12:10:42,521 [INFO]: There are 2317 embeddings of dim 49152
2025-03-13 12:10:42,522 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 12:10:42,522 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:42
2025-03-13 12:10:42,523 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:42,523 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:10:42,523 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:42,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:10:42,523 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:42
2025-03-13 12:10:42,524 [INFO]: 478.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:42,524 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:10:42,524 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:42
2025-03-13 12:10:42,524 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:42,524 [INFO]: 	Creating the index 03/13/2025, 12:10:42
2025-03-13 12:10:42,525 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:42
2025-03-13 12:10:42,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:10:42,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:42
2025-03-13 12:10:42,528 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:10:42,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.94it/s] 70%|███████   | 7/10 [00:00<00:00, 34.35it/s]100%|██████████| 10/10 [00:01<00:00,  5.62it/s]
2025-03-13 12:10:44,313 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:44
2025-03-13 12:11:12,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6166 secs
2025-03-13 12:11:12,930 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 12:11:12,930 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.19it/s]
2025-03-13 12:11:26,482 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5519 secs
2025-03-13 12:11:26,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9557 secs
2025-03-13 12:11:26,483 [INFO]: {
2025-03-13 12:11:26,483 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:26,484 [INFO]: 	index_param: efSearch=182
2025-03-13 12:11:26,484 [INFO]: 	index_path: knn.index
2025-03-13 12:11:26,484 [INFO]: 	size in bytes: 455855530
2025-03-13 12:11:26,484 [INFO]: 	avg_search_speed_ms: 8.889876099924246
2025-03-13 12:11:26,484 [INFO]: 	99p_search_speed_ms: 12.610087133944035
2025-03-13 12:11:26,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:26,484 [INFO]: 	nb vectors: 2317
2025-03-13 12:11:26,484 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:26,484 [INFO]: 	compression ratio: 0.9993094434984698
2025-03-13 12:11:26,484 [INFO]: }
2025-03-13 12:11:26,484 [INFO]: 	>>> Finished "Creating the index" in 43.9597 secs
2025-03-13 12:11:26,484 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9976 secs
2025-03-13 12:11:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 56275 [episode count 15/20]
[retrieval_preprocessing] for episode 89036 [episode count 16/20], we have num_retrieval=np.int64(2342) num_query=np.int64(113)
2025-03-13 12:11:27,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:27,932 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:27
2025-03-13 12:11:27,932 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.21it/s]
2025-03-13 12:11:27,955 [INFO]: There are 2342 embeddings of dim 49152
2025-03-13 12:11:27,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 12:11:27,955 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:27
2025-03-13 12:11:27,955 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:27,955 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:11:27,955 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:27,955 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:27,955 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:27
2025-03-13 12:11:27,955 [INFO]: 483.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:27,955 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:27,955 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:27
2025-03-13 12:11:27,955 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:27,955 [INFO]: 	Creating the index 03/13/2025, 12:11:27
2025-03-13 12:11:27,955 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:27
2025-03-13 12:11:27,956 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:11:27,956 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:27
2025-03-13 12:11:27,956 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:11:27,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.69it/s] 80%|████████  | 8/10 [00:00<00:00, 38.77it/s]100%|██████████| 10/10 [00:01<00:00,  6.25it/s]
2025-03-13 12:11:29,560 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:29
2025-03-13 12:12:00,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6198 secs
2025-03-13 12:12:00,181 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 12:12:00,181 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-13 12:12:16,376 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1954 secs
2025-03-13 12:12:16,378 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4216 secs
2025-03-13 12:12:16,378 [INFO]: {
2025-03-13 12:12:16,378 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:16,378 [INFO]: 	index_param: efSearch=169
2025-03-13 12:12:16,378 [INFO]: 	index_path: knn.index
2025-03-13 12:12:16,378 [INFO]: 	size in bytes: 460774090
2025-03-13 12:12:16,378 [INFO]: 	avg_search_speed_ms: 8.8106436979042
2025-03-13 12:12:16,378 [INFO]: 	99p_search_speed_ms: 13.684764797799302
2025-03-13 12:12:16,378 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:16,378 [INFO]: 	nb vectors: 2342
2025-03-13 12:12:16,378 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:16,378 [INFO]: 	compression ratio: 0.9993095228075867
2025-03-13 12:12:16,378 [INFO]: }
2025-03-13 12:12:16,378 [INFO]: 	>>> Finished "Creating the index" in 48.4230 secs
2025-03-13 12:12:16,378 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4466 secs
2025-03-13 12:12:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 89036 [episode count 16/20]
[retrieval_preprocessing] for episode 91379 [episode count 17/20], we have num_retrieval=np.int64(2314) num_query=np.int64(141)
2025-03-13 12:12:17,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:17,952 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:17
2025-03-13 12:12:17,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1922.23it/s]
2025-03-13 12:12:17,982 [INFO]: There are 2314 embeddings of dim 49152
2025-03-13 12:12:17,982 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 12:12:17,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:17
2025-03-13 12:12:17,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:17,982 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:12:17,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:17,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:12:17,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:17
2025-03-13 12:12:17,982 [INFO]: 477.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:17,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:12:17,982 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:17
2025-03-13 12:12:17,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:17,982 [INFO]: 	Creating the index 03/13/2025, 12:12:17
2025-03-13 12:12:17,982 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:17
2025-03-13 12:12:17,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:12:17,984 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:17
2025-03-13 12:12:17,984 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:12:17,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.04it/s] 60%|██████    | 6/10 [00:00<00:00, 27.76it/s]100%|██████████| 10/10 [00:01<00:00,  4.47it/s]100%|██████████| 10/10 [00:01<00:00,  5.29it/s]
2025-03-13 12:12:19,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:19
2025-03-13 12:12:46,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5403 secs
2025-03-13 12:12:46,417 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 12:12:46,417 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.78it/s]
2025-03-13 12:13:01,662 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2446 secs
2025-03-13 12:13:01,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6801 secs
2025-03-13 12:13:01,664 [INFO]: {
2025-03-13 12:13:01,664 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:01,664 [INFO]: 	index_param: efSearch=169
2025-03-13 12:13:01,664 [INFO]: 	index_path: knn.index
2025-03-13 12:13:01,664 [INFO]: 	size in bytes: 455265310
2025-03-13 12:13:01,664 [INFO]: 	avg_search_speed_ms: 9.188493141601729
2025-03-13 12:13:01,664 [INFO]: 	99p_search_speed_ms: 13.933784952387146
2025-03-13 12:13:01,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:01,664 [INFO]: 	nb vectors: 2314
2025-03-13 12:13:01,664 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:01,664 [INFO]: 	compression ratio: 0.9993094180621844
2025-03-13 12:13:01,664 [INFO]: }
2025-03-13 12:13:01,664 [INFO]: 	>>> Finished "Creating the index" in 43.6816 secs
2025-03-13 12:13:01,664 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7118 secs
2025-03-13 12:13:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 91379 [episode count 17/20]
[retrieval_preprocessing] for episode 67391 [episode count 18/20], we have num_retrieval=np.int64(2326) num_query=np.int64(129)
2025-03-13 12:13:04,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:04,450 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:04
2025-03-13 12:13:04,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1696.72it/s]
2025-03-13 12:13:04,476 [INFO]: There are 2326 embeddings of dim 49152
2025-03-13 12:13:04,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:13:04,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:04
2025-03-13 12:13:04,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:04,476 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:13:04,476 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:04,476 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:04,476 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:04
2025-03-13 12:13:04,476 [INFO]: 480.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:04,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:13:04,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:04
2025-03-13 12:13:04,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:04,477 [INFO]: 	Creating the index 03/13/2025, 12:13:04
2025-03-13 12:13:04,477 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:04
2025-03-13 12:13:04,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:13:04,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:04
2025-03-13 12:13:04,478 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:13:04,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.46it/s] 60%|██████    | 6/10 [00:00<00:00, 29.89it/s]100%|██████████| 10/10 [00:02<00:00,  3.71it/s]100%|██████████| 10/10 [00:02<00:00,  4.46it/s]
2025-03-13 12:13:06,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:06
2025-03-13 12:13:33,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7865 secs
2025-03-13 12:13:33,514 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 12:13:33,514 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-13 12:13:49,948 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4334 secs
2025-03-13 12:13:49,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4717 secs
2025-03-13 12:13:49,949 [INFO]: {
2025-03-13 12:13:49,949 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:49,950 [INFO]: 	index_param: efSearch=159
2025-03-13 12:13:49,950 [INFO]: 	index_path: knn.index
2025-03-13 12:13:49,950 [INFO]: 	size in bytes: 457626250
2025-03-13 12:13:49,950 [INFO]: 	avg_search_speed_ms: 8.510911757166081
2025-03-13 12:13:49,950 [INFO]: 	99p_search_speed_ms: 13.486535712145269
2025-03-13 12:13:49,950 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:49,950 [INFO]: 	nb vectors: 2326
2025-03-13 12:13:49,950 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:49,950 [INFO]: 	compression ratio: 0.9993093883928206
2025-03-13 12:13:49,950 [INFO]: }
2025-03-13 12:13:49,950 [INFO]: 	>>> Finished "Creating the index" in 45.4730 secs
2025-03-13 12:13:49,950 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5000 secs
2025-03-13 12:13:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 67391 [episode count 18/20]
[retrieval_preprocessing] for episode 34706 [episode count 19/20], we have num_retrieval=np.int64(2352) num_query=np.int64(103)
2025-03-13 12:13:51,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:51,714 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:51
2025-03-13 12:13:51,714 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1486.29it/s]
2025-03-13 12:13:51,744 [INFO]: There are 2352 embeddings of dim 49152
2025-03-13 12:13:51,744 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 12:13:51,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:51
2025-03-13 12:13:51,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:51,744 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:13:51,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:51,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:51,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:51
2025-03-13 12:13:51,744 [INFO]: 485.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:51,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:13:51,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:51
2025-03-13 12:13:51,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:51,744 [INFO]: 	Creating the index 03/13/2025, 12:13:51
2025-03-13 12:13:51,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:51
2025-03-13 12:13:51,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:13:51,746 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:51
2025-03-13 12:13:51,746 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:13:51,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.99it/s] 60%|██████    | 6/10 [00:00<00:00, 31.68it/s]100%|██████████| 10/10 [00:02<00:00,  3.82it/s]100%|██████████| 10/10 [00:02<00:00,  4.59it/s]
2025-03-13 12:13:53,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:53
2025-03-13 12:14:26,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1551 secs
2025-03-13 12:14:26,083 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 12:14:26,083 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 12:14:42,315 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2314 secs
2025-03-13 12:14:42,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5706 secs
2025-03-13 12:14:42,316 [INFO]: {
2025-03-13 12:14:42,316 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:42,316 [INFO]: 	index_param: efSearch=149
2025-03-13 12:14:42,316 [INFO]: 	index_path: knn.index
2025-03-13 12:14:42,316 [INFO]: 	size in bytes: 462741490
2025-03-13 12:14:42,316 [INFO]: 	avg_search_speed_ms: 7.380877847085634
2025-03-13 12:14:42,316 [INFO]: 	99p_search_speed_ms: 11.747573558241132
2025-03-13 12:14:42,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:42,316 [INFO]: 	nb vectors: 2352
2025-03-13 12:14:42,316 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:42,317 [INFO]: 	compression ratio: 0.9993096058881602
2025-03-13 12:14:42,317 [INFO]: }
2025-03-13 12:14:42,317 [INFO]: 	>>> Finished "Creating the index" in 50.5721 secs
2025-03-13 12:14:42,317 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6026 secs
2025-03-13 12:14:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 34706 [episode count 19/20]
2025-03-13 12:14:42: [retrieval_preprocessing] finished for -1_remove_marker_from_mug [chosen_id count 4/260]
2025-03-13 12:14:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_cup [chosen_id count 5/260]
2025-03-13 12:14:44: [retrieval_preprocessing] we have num_total=2924 embedding_dim=49152
[retrieval_preprocessing] for episode 90190 [episode count 0/20], we have num_retrieval=np.int64(2818) num_query=np.int64(106)
2025-03-13 12:14:44,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:45,845 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:45
2025-03-13 12:14:45,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1301.77it/s]
2025-03-13 12:14:45,876 [INFO]: There are 2818 embeddings of dim 49152
2025-03-13 12:14:45,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 12:14:45,877 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:45
2025-03-13 12:14:45,877 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:45,877 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:14:45,877 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:45,877 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:14:45,877 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:45
2025-03-13 12:14:45,878 [INFO]: 581.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:45,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:14:45,878 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:45
2025-03-13 12:14:45,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:45,879 [INFO]: 	Creating the index 03/13/2025, 12:14:45
2025-03-13 12:14:45,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:45
2025-03-13 12:14:45,882 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:14:45,882 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:45
2025-03-13 12:14:45,882 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:14:45,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.55it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.37it/s]100%|██████████| 12/12 [00:02<00:00,  5.85it/s]
2025-03-13 12:14:47,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:47
2025-03-13 12:15:18,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1426 secs
2025-03-13 12:15:18,083 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 12:15:18,083 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-13 12:15:33,909 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8260 secs
2025-03-13 12:15:33,911 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0286 secs
2025-03-13 12:15:33,911 [INFO]: {
2025-03-13 12:15:33,911 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:33,911 [INFO]: 	index_param: efSearch=142
2025-03-13 12:15:33,911 [INFO]: 	index_path: knn.index
2025-03-13 12:15:33,911 [INFO]: 	size in bytes: 554424010
2025-03-13 12:15:33,911 [INFO]: 	avg_search_speed_ms: 6.39572132736926
2025-03-13 12:15:33,911 [INFO]: 	99p_search_speed_ms: 9.450321882031856
2025-03-13 12:15:33,911 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:33,911 [INFO]: 	nb vectors: 2818
2025-03-13 12:15:33,911 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:33,911 [INFO]: 	compression ratio: 0.9993097954037019
2025-03-13 12:15:33,911 [INFO]: }
2025-03-13 12:15:33,911 [INFO]: 	>>> Finished "Creating the index" in 48.0324 secs
2025-03-13 12:15:33,911 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0662 secs
2025-03-13 12:15:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 90190 [episode count 0/20]
[retrieval_preprocessing] for episode 45099 [episode count 1/20], we have num_retrieval=np.int64(2770) num_query=np.int64(154)
2025-03-13 12:15:34,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:35,208 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:35
2025-03-13 12:15:35,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2132.34it/s]
2025-03-13 12:15:35,235 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 12:15:35,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 12:15:35,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:35
2025-03-13 12:15:35,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:35,236 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:15:35,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:35,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:15:35,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:35
2025-03-13 12:15:35,237 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:35,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:15:35,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:35
2025-03-13 12:15:35,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:35,238 [INFO]: 	Creating the index 03/13/2025, 12:15:35
2025-03-13 12:15:35,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:35
2025-03-13 12:15:35,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:15:35,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:35
2025-03-13 12:15:35,241 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:15:35,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.28it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.03it/s]100%|██████████| 11/11 [00:02<00:00,  4.03it/s]100%|██████████| 11/11 [00:02<00:00,  5.00it/s]
2025-03-13 12:15:37,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:37
2025-03-13 12:16:06,493 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0443 secs
2025-03-13 12:16:06,493 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 12:16:06,493 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 12:16:21,409 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9158 secs
2025-03-13 12:16:21,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1696 secs
2025-03-13 12:16:21,411 [INFO]: {
2025-03-13 12:16:21,411 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:21,411 [INFO]: 	index_param: efSearch=187
2025-03-13 12:16:21,411 [INFO]: 	index_path: knn.index
2025-03-13 12:16:21,411 [INFO]: 	size in bytes: 544980310
2025-03-13 12:16:21,411 [INFO]: 	avg_search_speed_ms: 8.510542749130028
2025-03-13 12:16:21,411 [INFO]: 	99p_search_speed_ms: 11.385536519810557
2025-03-13 12:16:21,411 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:21,411 [INFO]: 	nb vectors: 2770
2025-03-13 12:16:21,411 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:21,411 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 12:16:21,411 [INFO]: }
2025-03-13 12:16:21,411 [INFO]: 	>>> Finished "Creating the index" in 46.1735 secs
2025-03-13 12:16:21,411 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2035 secs
2025-03-13 12:16:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 45099 [episode count 1/20]
[retrieval_preprocessing] for episode 1094 [episode count 2/20], we have num_retrieval=np.int64(2735) num_query=np.int64(189)
2025-03-13 12:16:22,785 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:23,223 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:23
2025-03-13 12:16:23,223 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1815.72it/s]
2025-03-13 12:16:23,250 [INFO]: There are 2735 embeddings of dim 49152
2025-03-13 12:16:23,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 12:16:23,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:23,251 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:16:23,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:23,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:16:23,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,251 [INFO]: 564.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:23,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:16:23,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:23
2025-03-13 12:16:23,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:23,251 [INFO]: 	Creating the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:23
2025-03-13 12:16:23,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:16:23,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:23
2025-03-13 12:16:23,252 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:16:23,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.05it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.04it/s]100%|██████████| 11/11 [00:02<00:00,  4.64it/s]100%|██████████| 11/11 [00:02<00:00,  5.41it/s]
2025-03-13 12:16:25,291 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:25
2025-03-13 12:16:51,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1157 secs
2025-03-13 12:16:51,407 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 12:16:51,407 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-13 12:17:10,214 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8067 secs
2025-03-13 12:17:10,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9634 secs
2025-03-13 12:17:10,216 [INFO]: {
2025-03-13 12:17:10,216 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:10,217 [INFO]: 	index_param: efSearch=191
2025-03-13 12:17:10,217 [INFO]: 	index_path: knn.index
2025-03-13 12:17:10,217 [INFO]: 	size in bytes: 538094230
2025-03-13 12:17:10,217 [INFO]: 	avg_search_speed_ms: 9.770577004246661
2025-03-13 12:17:10,217 [INFO]: 	99p_search_speed_ms: 15.656371081713585
2025-03-13 12:17:10,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:10,217 [INFO]: 	nb vectors: 2735
2025-03-13 12:17:10,217 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:10,217 [INFO]: 	compression ratio: 0.9993098792380658
2025-03-13 12:17:10,217 [INFO]: }
2025-03-13 12:17:10,217 [INFO]: 	>>> Finished "Creating the index" in 46.9655 secs
2025-03-13 12:17:10,217 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9940 secs
2025-03-13 12:17:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 1094 [episode count 2/20]
[retrieval_preprocessing] for episode 65886 [episode count 3/20], we have num_retrieval=np.int64(2776) num_query=np.int64(148)
2025-03-13 12:17:12,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:12,635 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:12
2025-03-13 12:17:12,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.66it/s]
2025-03-13 12:17:12,664 [INFO]: There are 2776 embeddings of dim 49152
2025-03-13 12:17:12,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:17:12,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:12,664 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:17:12,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:12,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:12,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,664 [INFO]: 572.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:12,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:12,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:12
2025-03-13 12:17:12,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:12,664 [INFO]: 	Creating the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:12
2025-03-13 12:17:12,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:17:12,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:12
2025-03-13 12:17:12,665 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:17:12,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.21it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.39it/s]100%|██████████| 11/11 [00:02<00:00,  5.15it/s]
2025-03-13 12:17:14,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:14
2025-03-13 12:17:46,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5874 secs
2025-03-13 12:17:46,391 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 12:17:46,391 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.07it/s]
2025-03-13 12:18:01,725 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3336 secs
2025-03-13 12:18:01,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0610 secs
2025-03-13 12:18:01,727 [INFO]: {
2025-03-13 12:18:01,727 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:01,727 [INFO]: 	index_param: efSearch=195
2025-03-13 12:18:01,727 [INFO]: 	index_path: knn.index
2025-03-13 12:18:01,727 [INFO]: 	size in bytes: 546160750
2025-03-13 12:18:01,727 [INFO]: 	avg_search_speed_ms: 9.272042622848433
2025-03-13 12:18:01,727 [INFO]: 	99p_search_speed_ms: 16.32275422103704
2025-03-13 12:18:01,727 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:01,727 [INFO]: 	nb vectors: 2776
2025-03-13 12:18:01,727 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:01,727 [INFO]: 	compression ratio: 0.9993098332313335
2025-03-13 12:18:01,727 [INFO]: }
2025-03-13 12:18:01,727 [INFO]: 	>>> Finished "Creating the index" in 49.0624 secs
2025-03-13 12:18:01,727 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0914 secs
2025-03-13 12:18:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 65886 [episode count 3/20]
[retrieval_preprocessing] for episode 25717 [episode count 4/20], we have num_retrieval=np.int64(2811) num_query=np.int64(113)
2025-03-13 12:18:03,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:03,795 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:03
2025-03-13 12:18:03,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.72it/s]
2025-03-13 12:18:03,825 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 12:18:03,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 12:18:03,825 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:03
2025-03-13 12:18:03,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:03,825 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:18:03,825 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:03,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:03,825 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:03
2025-03-13 12:18:03,825 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:03,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:18:03,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:03
2025-03-13 12:18:03,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:03,826 [INFO]: 	Creating the index 03/13/2025, 12:18:03
2025-03-13 12:18:03,826 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:03
2025-03-13 12:18:03,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:18:03,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:03
2025-03-13 12:18:03,827 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:18:03,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.06it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.98it/s]100%|██████████| 12/12 [00:01<00:00,  4.90it/s]100%|██████████| 12/12 [00:01<00:00,  6.09it/s]
2025-03-13 12:18:05,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:05
2025-03-13 12:18:37,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5898 secs
2025-03-13 12:18:37,390 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 12:18:37,390 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.90it/s]
2025-03-13 12:18:54,156 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7663 secs
2025-03-13 12:18:54,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3308 secs
2025-03-13 12:18:54,158 [INFO]: {
2025-03-13 12:18:54,158 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:54,158 [INFO]: 	index_param: efSearch=123
2025-03-13 12:18:54,158 [INFO]: 	index_path: knn.index
2025-03-13 12:18:54,158 [INFO]: 	size in bytes: 553046830
2025-03-13 12:18:54,158 [INFO]: 	avg_search_speed_ms: 5.516024422382354
2025-03-13 12:18:54,158 [INFO]: 	99p_search_speed_ms: 10.04274901002645
2025-03-13 12:18:54,158 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:54,158 [INFO]: 	nb vectors: 2811
2025-03-13 12:18:54,158 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:54,158 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 12:18:54,158 [INFO]: }
2025-03-13 12:18:54,158 [INFO]: 	>>> Finished "Creating the index" in 50.3323 secs
2025-03-13 12:18:54,158 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3627 secs
2025-03-13 12:18:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 25717 [episode count 4/20]
[retrieval_preprocessing] for episode 42627 [episode count 5/20], we have num_retrieval=np.int64(2800) num_query=np.int64(124)
2025-03-13 12:18:54,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:55,445 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:55
2025-03-13 12:18:55,445 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2268.42it/s]
2025-03-13 12:18:55,475 [INFO]: There are 2800 embeddings of dim 49152
2025-03-13 12:18:55,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 12:18:55,475 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:55,475 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:18:55,475 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:55,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:55,475 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,475 [INFO]: 577.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:55,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:18:55,475 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:55
2025-03-13 12:18:55,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:55,476 [INFO]: 	Creating the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:55
2025-03-13 12:18:55,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:18:55,476 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,476 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:18:55,477 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.05it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.81it/s]100%|██████████| 12/12 [00:02<00:00,  4.19it/s]100%|██████████| 12/12 [00:02<00:00,  5.25it/s]
2025-03-13 12:18:57,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:57
2025-03-13 12:19:28,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4752 secs
2025-03-13 12:19:28,241 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 12:19:28,241 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.29it/s]
2025-03-13 12:19:44,584 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3431 secs
2025-03-13 12:19:44,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1097 secs
2025-03-13 12:19:44,586 [INFO]: {
2025-03-13 12:19:44,586 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:44,586 [INFO]: 	index_param: efSearch=203
2025-03-13 12:19:44,586 [INFO]: 	index_path: knn.index
2025-03-13 12:19:44,586 [INFO]: 	size in bytes: 550882690
2025-03-13 12:19:44,586 [INFO]: 	avg_search_speed_ms: 9.351449798157212
2025-03-13 12:19:44,586 [INFO]: 	99p_search_speed_ms: 13.616839712485671
2025-03-13 12:19:44,586 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:44,586 [INFO]: 	nb vectors: 2800
2025-03-13 12:19:44,586 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:44,586 [INFO]: 	compression ratio: 0.9993096715382362
2025-03-13 12:19:44,586 [INFO]: }
2025-03-13 12:19:44,586 [INFO]: 	>>> Finished "Creating the index" in 49.1109 secs
2025-03-13 12:19:44,586 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1414 secs
2025-03-13 12:19:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 42627 [episode count 5/20]
[retrieval_preprocessing] for episode 94205 [episode count 6/20], we have num_retrieval=np.int64(2816) num_query=np.int64(108)
2025-03-13 12:19:45,737 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:46,128 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:46
2025-03-13 12:19:46,128 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2176.60it/s]
2025-03-13 12:19:46,154 [INFO]: There are 2816 embeddings of dim 49152
2025-03-13 12:19:46,155 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:19:46,155 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:46
2025-03-13 12:19:46,155 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:46,155 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:19:46,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:46,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:46,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:46
2025-03-13 12:19:46,155 [INFO]: 581.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:46,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:19:46,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:46
2025-03-13 12:19:46,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:46,155 [INFO]: 	Creating the index 03/13/2025, 12:19:46
2025-03-13 12:19:46,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:46
2025-03-13 12:19:46,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:19:46,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:46
2025-03-13 12:19:46,156 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:19:46,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.82it/s] 50%|█████     | 6/12 [00:00<00:00, 30.03it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.21it/s]100%|██████████| 12/12 [00:02<00:00,  5.77it/s]
2025-03-13 12:19:48,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:48
2025-03-13 12:20:17,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3071 secs
2025-03-13 12:20:17,547 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 12:20:17,547 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-13 12:20:35,857 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3096 secs
2025-03-13 12:20:35,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7022 secs
2025-03-13 12:20:35,859 [INFO]: {
2025-03-13 12:20:35,859 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:35,859 [INFO]: 	index_param: efSearch=129
2025-03-13 12:20:35,859 [INFO]: 	index_path: knn.index
2025-03-13 12:20:35,859 [INFO]: 	size in bytes: 554030530
2025-03-13 12:20:35,859 [INFO]: 	avg_search_speed_ms: 5.608381804567722
2025-03-13 12:20:35,859 [INFO]: 	99p_search_speed_ms: 11.657336829230273
2025-03-13 12:20:35,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:35,859 [INFO]: 	nb vectors: 2816
2025-03-13 12:20:35,859 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:35,859 [INFO]: 	compression ratio: 0.9993097817190688
2025-03-13 12:20:35,859 [INFO]: }
2025-03-13 12:20:35,859 [INFO]: 	>>> Finished "Creating the index" in 49.7036 secs
2025-03-13 12:20:35,859 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7310 secs
2025-03-13 12:20:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 94205 [episode count 6/20]
[retrieval_preprocessing] for episode 27623 [episode count 7/20], we have num_retrieval=np.int64(2746) num_query=np.int64(178)
2025-03-13 12:20:36,678 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:37,077 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:37
2025-03-13 12:20:37,077 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.13it/s]
2025-03-13 12:20:37,109 [INFO]: There are 2746 embeddings of dim 49152
2025-03-13 12:20:37,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 12:20:37,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:37,110 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:20:37,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:37,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:20:37,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,110 [INFO]: 566.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:37,111 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:20:37,111 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:37
2025-03-13 12:20:37,111 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:37,111 [INFO]: 	Creating the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,112 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:37
2025-03-13 12:20:37,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 12:20:37,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:37
2025-03-13 12:20:37,114 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:20:37,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.79it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.98it/s]
2025-03-13 12:20:39,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:39
2025-03-13 12:21:12,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9877 secs
2025-03-13 12:21:12,313 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 12:21:12,313 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 12:21:29,107 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7933 secs
2025-03-13 12:21:29,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9953 secs
2025-03-13 12:21:29,109 [INFO]: {
2025-03-13 12:21:29,109 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:29,109 [INFO]: 	index_param: efSearch=173
2025-03-13 12:21:29,109 [INFO]: 	index_path: knn.index
2025-03-13 12:21:29,109 [INFO]: 	size in bytes: 540258370
2025-03-13 12:21:29,109 [INFO]: 	avg_search_speed_ms: 8.078481372173496
2025-03-13 12:21:29,109 [INFO]: 	99p_search_speed_ms: 11.700771853793407
2025-03-13 12:21:29,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:29,109 [INFO]: 	nb vectors: 2746
2025-03-13 12:21:29,109 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:29,109 [INFO]: 	compression ratio: 0.9993099560863814
2025-03-13 12:21:29,109 [INFO]: }
2025-03-13 12:21:29,109 [INFO]: 	>>> Finished "Creating the index" in 51.9979 secs
2025-03-13 12:21:29,109 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0328 secs
2025-03-13 12:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 27623 [episode count 7/20]
[retrieval_preprocessing] for episode 11239 [episode count 8/20], we have num_retrieval=np.int64(2727) num_query=np.int64(197)
2025-03-13 12:21:30,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:31,419 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:31
2025-03-13 12:21:31,419 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1731.04it/s]
2025-03-13 12:21:31,447 [INFO]: There are 2727 embeddings of dim 49152
2025-03-13 12:21:31,447 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:21:31,447 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:31
2025-03-13 12:21:31,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:31,447 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:21:31,447 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:31,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:21:31,448 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:31
2025-03-13 12:21:31,448 [INFO]: 562.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:31,448 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:21:31,448 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:31
2025-03-13 12:21:31,448 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:31,448 [INFO]: 	Creating the index 03/13/2025, 12:21:31
2025-03-13 12:21:31,448 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:31
2025-03-13 12:21:31,449 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:21:31,449 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:31
2025-03-13 12:21:31,449 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:21:31,449 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.44it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.16it/s]100%|██████████| 11/11 [00:01<00:00,  4.87it/s]100%|██████████| 11/11 [00:01<00:00,  5.67it/s]
2025-03-13 12:21:33,392 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:33
2025-03-13 12:22:03,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1318 secs
2025-03-13 12:22:03,525 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 12:22:03,525 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.00it/s]
2025-03-13 12:22:19,102 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5770 secs
2025-03-13 12:22:19,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6550 secs
2025-03-13 12:22:19,104 [INFO]: {
2025-03-13 12:22:19,104 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:19,104 [INFO]: 	index_param: efSearch=123
2025-03-13 12:22:19,104 [INFO]: 	index_path: knn.index
2025-03-13 12:22:19,104 [INFO]: 	size in bytes: 536520310
2025-03-13 12:22:19,104 [INFO]: 	avg_search_speed_ms: 6.018486052380358
2025-03-13 12:22:19,104 [INFO]: 	99p_search_speed_ms: 9.594232868403207
2025-03-13 12:22:19,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:19,104 [INFO]: 	nb vectors: 2727
2025-03-13 12:22:19,104 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:19,104 [INFO]: 	compression ratio: 0.9993098229589855
2025-03-13 12:22:19,104 [INFO]: }
2025-03-13 12:22:19,104 [INFO]: 	>>> Finished "Creating the index" in 47.6564 secs
2025-03-13 12:22:19,104 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6853 secs
2025-03-13 12:22:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 11239 [episode count 8/20]
[retrieval_preprocessing] for episode 76765 [episode count 9/20], we have num_retrieval=np.int64(2774) num_query=np.int64(150)
2025-03-13 12:22:20,518 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:21,130 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:21
2025-03-13 12:22:21,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-13 12:22:21,160 [INFO]: There are 2774 embeddings of dim 49152
2025-03-13 12:22:21,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 12:22:21,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:21
2025-03-13 12:22:21,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:21,161 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:22:21,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:21,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:22:21,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:21
2025-03-13 12:22:21,162 [INFO]: 572.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:21,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:22:21,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:21
2025-03-13 12:22:21,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:21,163 [INFO]: 	Creating the index 03/13/2025, 12:22:21
2025-03-13 12:22:21,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:21
2025-03-13 12:22:21,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:22:21,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:21
2025-03-13 12:22:21,166 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:22:21,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 24.32it/s] 73%|███████▎  | 8/11 [00:00<00:00, 34.45it/s]100%|██████████| 11/11 [00:02<00:00,  4.77it/s]
2025-03-13 12:22:24,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:24
2025-03-13 12:22:53,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0444 secs
2025-03-13 12:22:53,433 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:22:53,433 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-13 12:23:09,085 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6523 secs
2025-03-13 12:23:09,088 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9218 secs
2025-03-13 12:23:09,088 [INFO]: {
2025-03-13 12:23:09,088 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:09,088 [INFO]: 	index_param: efSearch=208
2025-03-13 12:23:09,088 [INFO]: 	index_path: knn.index
2025-03-13 12:23:09,088 [INFO]: 	size in bytes: 545767270
2025-03-13 12:23:09,088 [INFO]: 	avg_search_speed_ms: 9.93470692185846
2025-03-13 12:23:09,088 [INFO]: 	99p_search_speed_ms: 13.986567123793064
2025-03-13 12:23:09,088 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:09,088 [INFO]: 	nb vectors: 2774
2025-03-13 12:23:09,088 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:09,088 [INFO]: 	compression ratio: 0.9993098193667788
2025-03-13 12:23:09,088 [INFO]: }
2025-03-13 12:23:09,088 [INFO]: 	>>> Finished "Creating the index" in 47.9254 secs
2025-03-13 12:23:09,088 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9582 secs
2025-03-13 12:23:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 76765 [episode count 9/20]
[retrieval_preprocessing] for episode 36930 [episode count 10/20], we have num_retrieval=np.int64(2775) num_query=np.int64(149)
2025-03-13 12:23:11,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:11,469 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:11
2025-03-13 12:23:11,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1598.44it/s]
2025-03-13 12:23:11,500 [INFO]: There are 2775 embeddings of dim 49152
2025-03-13 12:23:11,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 12:23:11,501 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:11
2025-03-13 12:23:11,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:11,502 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:23:11,502 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:11,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:23:11,502 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:11
2025-03-13 12:23:11,502 [INFO]: 572.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:11,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:23:11,503 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:11
2025-03-13 12:23:11,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:11,503 [INFO]: 	Creating the index 03/13/2025, 12:23:11
2025-03-13 12:23:11,503 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:11
2025-03-13 12:23:11,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:23:11,507 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:11
2025-03-13 12:23:11,507 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:23:11,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.18it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.41it/s]100%|██████████| 11/11 [00:02<00:00,  2.96it/s]100%|██████████| 11/11 [00:02<00:00,  3.71it/s]
2025-03-13 12:23:14,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:14
2025-03-13 12:23:46,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3232 secs
2025-03-13 12:23:46,803 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 12:23:46,803 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 12:24:02,237 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4348 secs
2025-03-13 12:24:02,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7323 secs
2025-03-13 12:24:02,240 [INFO]: {
2025-03-13 12:24:02,240 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:02,240 [INFO]: 	index_param: efSearch=158
2025-03-13 12:24:02,240 [INFO]: 	index_path: knn.index
2025-03-13 12:24:02,240 [INFO]: 	size in bytes: 545964010
2025-03-13 12:24:02,240 [INFO]: 	avg_search_speed_ms: 7.866078817304634
2025-03-13 12:24:02,240 [INFO]: 	99p_search_speed_ms: 14.30287088965997
2025-03-13 12:24:02,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:02,240 [INFO]: 	nb vectors: 2775
2025-03-13 12:24:02,240 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:02,240 [INFO]: 	compression ratio: 0.9993098263015542
2025-03-13 12:24:02,240 [INFO]: }
2025-03-13 12:24:02,240 [INFO]: 	>>> Finished "Creating the index" in 50.7366 secs
2025-03-13 12:24:02,240 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7705 secs
2025-03-13 12:24:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 36930 [episode count 10/20]
[retrieval_preprocessing] for episode 78662 [episode count 11/20], we have num_retrieval=np.int64(2720) num_query=np.int64(204)
2025-03-13 12:24:03,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:04,506 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:04
2025-03-13 12:24:04,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.21it/s]
2025-03-13 12:24:04,532 [INFO]: There are 2720 embeddings of dim 49152
2025-03-13 12:24:04,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 12:24:04,532 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:04
2025-03-13 12:24:04,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:04,533 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:24:04,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:04,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:24:04,533 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:04
2025-03-13 12:24:04,533 [INFO]: 561.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:04,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:04,533 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:04
2025-03-13 12:24:04,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:04,533 [INFO]: 	Creating the index 03/13/2025, 12:24:04
2025-03-13 12:24:04,533 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:04
2025-03-13 12:24:04,534 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:24:04,534 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:04
2025-03-13 12:24:04,534 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:24:04,534 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.68it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.64it/s]100%|██████████| 11/11 [00:01<00:00,  5.72it/s]
2025-03-13 12:24:06,460 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:06
2025-03-13 12:24:37,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3928 secs
2025-03-13 12:24:37,854 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 12:24:37,854 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.00it/s]
2025-03-13 12:24:52,372 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5182 secs
2025-03-13 12:24:52,374 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8403 secs
2025-03-13 12:24:52,374 [INFO]: {
2025-03-13 12:24:52,374 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:52,374 [INFO]: 	index_param: efSearch=182
2025-03-13 12:24:52,374 [INFO]: 	index_path: knn.index
2025-03-13 12:24:52,374 [INFO]: 	size in bytes: 535143130
2025-03-13 12:24:52,375 [INFO]: 	avg_search_speed_ms: 8.366316058926254
2025-03-13 12:24:52,375 [INFO]: 	99p_search_speed_ms: 12.64903570525348
2025-03-13 12:24:52,375 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:52,375 [INFO]: 	nb vectors: 2720
2025-03-13 12:24:52,375 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:52,375 [INFO]: 	compression ratio: 0.9993097734432281
2025-03-13 12:24:52,375 [INFO]: }
2025-03-13 12:24:52,375 [INFO]: 	>>> Finished "Creating the index" in 47.8416 secs
2025-03-13 12:24:52,375 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8685 secs
2025-03-13 12:24:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 78662 [episode count 11/20]
[retrieval_preprocessing] for episode 38873 [episode count 12/20], we have num_retrieval=np.int64(2779) num_query=np.int64(145)
2025-03-13 12:24:53,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:54,445 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:54
2025-03-13 12:24:54,445 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1941.81it/s]
2025-03-13 12:24:54,478 [INFO]: There are 2779 embeddings of dim 49152
2025-03-13 12:24:54,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 12:24:54,479 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:54
2025-03-13 12:24:54,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:54,479 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:24:54,479 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:54,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:24:54,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:54
2025-03-13 12:24:54,480 [INFO]: 573.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:54,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:24:54,480 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:54
2025-03-13 12:24:54,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:54,480 [INFO]: 	Creating the index 03/13/2025, 12:24:54
2025-03-13 12:24:54,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:54
2025-03-13 12:24:54,483 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:24:54,484 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:54
2025-03-13 12:24:54,484 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:24:54,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.56it/s] 82%|████████▏ | 9/11 [00:00<00:00, 42.40it/s]100%|██████████| 11/11 [00:02<00:00,  5.34it/s]
2025-03-13 12:24:56,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:56
2025-03-13 12:25:29,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8928 secs
2025-03-13 12:25:29,443 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 12:25:29,443 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
2025-03-13 12:25:47,274 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8312 secs
2025-03-13 12:25:47,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7923 secs
2025-03-13 12:25:47,276 [INFO]: {
2025-03-13 12:25:47,276 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:47,276 [INFO]: 	index_param: efSearch=156
2025-03-13 12:25:47,276 [INFO]: 	index_path: knn.index
2025-03-13 12:25:47,276 [INFO]: 	size in bytes: 546750970
2025-03-13 12:25:47,276 [INFO]: 	avg_search_speed_ms: 11.054398912360162
2025-03-13 12:25:47,276 [INFO]: 	99p_search_speed_ms: 16.745239049196247
2025-03-13 12:25:47,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:47,276 [INFO]: 	nb vectors: 2779
2025-03-13 12:25:47,276 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:47,276 [INFO]: 	compression ratio: 0.9993098539907483
2025-03-13 12:25:47,276 [INFO]: }
2025-03-13 12:25:47,276 [INFO]: 	>>> Finished "Creating the index" in 52.7960 secs
2025-03-13 12:25:47,276 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8313 secs
2025-03-13 12:25:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 38873 [episode count 12/20]
[retrieval_preprocessing] for episode 7396 [episode count 13/20], we have num_retrieval=np.int64(2772) num_query=np.int64(152)
2025-03-13 12:25:48,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:49,912 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:49
2025-03-13 12:25:49,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1517.48it/s]
2025-03-13 12:25:49,943 [INFO]: There are 2772 embeddings of dim 49152
2025-03-13 12:25:49,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 12:25:49,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:49,944 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:25:49,944 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:49,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:25:49,944 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,944 [INFO]: 572.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:49,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:25:49,945 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:49
2025-03-13 12:25:49,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:49,945 [INFO]: 	Creating the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,945 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:49
2025-03-13 12:25:49,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:25:49,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:49
2025-03-13 12:25:49,949 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:25:49,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.88it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.41it/s]100%|██████████| 11/11 [00:02<00:00,  3.65it/s]100%|██████████| 11/11 [00:02<00:00,  4.56it/s]
2025-03-13 12:25:52,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:52
2025-03-13 12:26:25,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0567 secs
2025-03-13 12:26:25,424 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 12:26:25,424 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-13 12:26:43,257 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8331 secs
2025-03-13 12:26:43,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3107 secs
2025-03-13 12:26:43,259 [INFO]: {
2025-03-13 12:26:43,259 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:43,260 [INFO]: 	index_param: efSearch=188
2025-03-13 12:26:43,260 [INFO]: 	index_path: knn.index
2025-03-13 12:26:43,260 [INFO]: 	size in bytes: 545373790
2025-03-13 12:26:43,260 [INFO]: 	avg_search_speed_ms: 10.227676550762496
2025-03-13 12:26:43,260 [INFO]: 	99p_search_speed_ms: 15.96884020837024
2025-03-13 12:26:43,260 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:43,260 [INFO]: 	nb vectors: 2772
2025-03-13 12:26:43,260 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:43,260 [INFO]: 	compression ratio: 0.999309805482218
2025-03-13 12:26:43,260 [INFO]: }
2025-03-13 12:26:43,260 [INFO]: 	>>> Finished "Creating the index" in 53.3146 secs
2025-03-13 12:26:43,260 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3478 secs
2025-03-13 12:26:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 7396 [episode count 13/20]
[retrieval_preprocessing] for episode 37282 [episode count 14/20], we have num_retrieval=np.int64(2820) num_query=np.int64(104)
2025-03-13 12:26:44,609 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:45,906 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:45
2025-03-13 12:26:45,906 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.86it/s]
2025-03-13 12:26:45,937 [INFO]: There are 2820 embeddings of dim 49152
2025-03-13 12:26:45,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 12:26:45,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:45
2025-03-13 12:26:45,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:45,937 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:26:45,938 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:45,938 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:45,938 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:45
2025-03-13 12:26:45,938 [INFO]: 582.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:45,938 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:26:45,938 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:45
2025-03-13 12:26:45,938 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:45,938 [INFO]: 	Creating the index 03/13/2025, 12:26:45
2025-03-13 12:26:45,938 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:45
2025-03-13 12:26:45,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:26:45,939 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:45
2025-03-13 12:26:45,939 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:26:45,939 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.88it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.49it/s]100%|██████████| 12/12 [00:02<00:00,  4.53it/s]100%|██████████| 12/12 [00:02<00:00,  5.48it/s]
2025-03-13 12:26:48,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:48
2025-03-13 12:27:23,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7921 secs
2025-03-13 12:27:23,925 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 12:27:23,925 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.15it/s]
2025-03-13 12:27:45,303 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3777 secs
2025-03-13 12:27:45,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3660 secs
2025-03-13 12:27:45,305 [INFO]: {
2025-03-13 12:27:45,305 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:45,305 [INFO]: 	index_param: efSearch=187
2025-03-13 12:27:45,306 [INFO]: 	index_path: knn.index
2025-03-13 12:27:45,306 [INFO]: 	size in bytes: 554817490
2025-03-13 12:27:45,306 [INFO]: 	avg_search_speed_ms: 9.115232308390961
2025-03-13 12:27:45,306 [INFO]: 	99p_search_speed_ms: 12.103151269257067
2025-03-13 12:27:45,306 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:45,306 [INFO]: 	nb vectors: 2820
2025-03-13 12:27:45,306 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:45,306 [INFO]: 	compression ratio: 0.9993098090689246
2025-03-13 12:27:45,306 [INFO]: }
2025-03-13 12:27:45,306 [INFO]: 	>>> Finished "Creating the index" in 59.3678 secs
2025-03-13 12:27:45,306 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3995 secs
2025-03-13 12:27:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 37282 [episode count 14/20]
[retrieval_preprocessing] for episode 45551 [episode count 15/20], we have num_retrieval=np.int64(2765) num_query=np.int64(159)
2025-03-13 12:27:46,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:46,801 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:46
2025-03-13 12:27:46,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1695.35it/s]
2025-03-13 12:27:46,839 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 12:27:46,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 12:27:46,840 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:46
2025-03-13 12:27:46,840 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:46,840 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:27:46,840 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:46,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:27:46,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:46
2025-03-13 12:27:46,841 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:46,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:27:46,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:46
2025-03-13 12:27:46,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:46,842 [INFO]: 	Creating the index 03/13/2025, 12:27:46
2025-03-13 12:27:46,842 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:46
2025-03-13 12:27:46,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:27:46,846 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:46
2025-03-13 12:27:46,846 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:27:46,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.06it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.18it/s]100%|██████████| 11/11 [00:02<00:00,  3.37it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]
2025-03-13 12:27:49,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:49
2025-03-13 12:28:20,771 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3154 secs
2025-03-13 12:28:20,771 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 12:28:20,771 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 12:28:36,680 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9081 secs
2025-03-13 12:28:36,681 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8355 secs
2025-03-13 12:28:36,681 [INFO]: {
2025-03-13 12:28:36,681 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:36,681 [INFO]: 	index_param: efSearch=112
2025-03-13 12:28:36,681 [INFO]: 	index_path: knn.index
2025-03-13 12:28:36,681 [INFO]: 	size in bytes: 543996610
2025-03-13 12:28:36,681 [INFO]: 	avg_search_speed_ms: 5.119487399681716
2025-03-13 12:28:36,681 [INFO]: 	99p_search_speed_ms: 7.832102291285993
2025-03-13 12:28:36,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:36,682 [INFO]: 	nb vectors: 2765
2025-03-13 12:28:36,682 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:36,682 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 12:28:36,682 [INFO]: }
2025-03-13 12:28:36,682 [INFO]: 	>>> Finished "Creating the index" in 49.8396 secs
2025-03-13 12:28:36,682 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8800 secs
2025-03-13 12:28:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 45551 [episode count 15/20]
[retrieval_preprocessing] for episode 89507 [episode count 16/20], we have num_retrieval=np.int64(2781) num_query=np.int64(143)
2025-03-13 12:28:37,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:38,159 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:38
2025-03-13 12:28:38,160 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2228.64it/s]
2025-03-13 12:28:38,186 [INFO]: There are 2781 embeddings of dim 49152
2025-03-13 12:28:38,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 12:28:38,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:38
2025-03-13 12:28:38,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:38,187 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:28:38,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:38,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:28:38,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:38
2025-03-13 12:28:38,188 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:38,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:28:38,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:38
2025-03-13 12:28:38,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:38,188 [INFO]: 	Creating the index 03/13/2025, 12:28:38
2025-03-13 12:28:38,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:38
2025-03-13 12:28:38,192 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:28:38,192 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:38
2025-03-13 12:28:38,192 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:28:38,192 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.86it/s] 73%|███████▎  | 8/11 [00:00<00:00, 39.26it/s]100%|██████████| 11/11 [00:02<00:00,  5.40it/s]
2025-03-13 12:28:40,235 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:40
2025-03-13 12:29:10,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4630 secs
2025-03-13 12:29:10,698 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 12:29:10,699 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.96it/s]
2025-03-13 12:29:31,086 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3876 secs
2025-03-13 12:29:31,088 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8962 secs
2025-03-13 12:29:31,088 [INFO]: {
2025-03-13 12:29:31,088 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:31,088 [INFO]: 	index_param: efSearch=236
2025-03-13 12:29:31,088 [INFO]: 	index_path: knn.index
2025-03-13 12:29:31,088 [INFO]: 	size in bytes: 547144450
2025-03-13 12:29:31,089 [INFO]: 	avg_search_speed_ms: 11.015311219946929
2025-03-13 12:29:31,089 [INFO]: 	99p_search_speed_ms: 17.127924687229097
2025-03-13 12:29:31,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:31,089 [INFO]: 	nb vectors: 2781
2025-03-13 12:29:31,089 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:31,089 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-13 12:29:31,089 [INFO]: }
2025-03-13 12:29:31,089 [INFO]: 	>>> Finished "Creating the index" in 52.9002 secs
2025-03-13 12:29:31,089 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9291 secs
2025-03-13 12:29:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 89507 [episode count 16/20]
[retrieval_preprocessing] for episode 12795 [episode count 17/20], we have num_retrieval=np.int64(2764) num_query=np.int64(160)
2025-03-13 12:29:32,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:33,290 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:33
2025-03-13 12:29:33,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.78it/s]
2025-03-13 12:29:33,330 [INFO]: There are 2764 embeddings of dim 49152
2025-03-13 12:29:33,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0399 secs
2025-03-13 12:29:33,331 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:33
2025-03-13 12:29:33,331 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:33,331 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:29:33,331 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:33,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:29:33,331 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:33
2025-03-13 12:29:33,332 [INFO]: 570.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:33,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:29:33,332 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:33
2025-03-13 12:29:33,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:33,332 [INFO]: 	Creating the index 03/13/2025, 12:29:33
2025-03-13 12:29:33,332 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:33
2025-03-13 12:29:33,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:29:33,335 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:33
2025-03-13 12:29:33,336 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:29:33,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.86it/s] 45%|████▌     | 5/11 [00:00<00:00, 26.08it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.95it/s]100%|██████████| 11/11 [00:02<00:00,  3.68it/s]
2025-03-13 12:29:36,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:36
2025-03-13 12:30:07,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4030 secs
2025-03-13 12:30:07,734 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 12:30:07,734 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.97it/s]
2025-03-13 12:30:24,797 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0625 secs
2025-03-13 12:30:24,798 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4628 secs
2025-03-13 12:30:24,798 [INFO]: {
2025-03-13 12:30:24,799 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:24,799 [INFO]: 	index_param: efSearch=151
2025-03-13 12:30:24,799 [INFO]: 	index_path: knn.index
2025-03-13 12:30:24,799 [INFO]: 	size in bytes: 543799810
2025-03-13 12:30:24,799 [INFO]: 	avg_search_speed_ms: 7.0715769677511195
2025-03-13 12:30:24,799 [INFO]: 	99p_search_speed_ms: 10.362450857646762
2025-03-13 12:30:24,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:24,799 [INFO]: 	nb vectors: 2764
2025-03-13 12:30:24,799 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:24,799 [INFO]: 	compression ratio: 0.9993098600016062
2025-03-13 12:30:24,799 [INFO]: }
2025-03-13 12:30:24,799 [INFO]: 	>>> Finished "Creating the index" in 51.4668 secs
2025-03-13 12:30:24,799 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5088 secs
2025-03-13 12:30:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 12795 [episode count 17/20]
[retrieval_preprocessing] for episode 89596 [episode count 18/20], we have num_retrieval=np.int64(2811) num_query=np.int64(113)
2025-03-13 12:30:25,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:26,313 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:26
2025-03-13 12:30:26,313 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-13 12:30:26,339 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 12:30:26,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 12:30:26,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:26
2025-03-13 12:30:26,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:26,339 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:30:26,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:26,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:26,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:26
2025-03-13 12:30:26,339 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:26,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:30:26,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:26
2025-03-13 12:30:26,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:26,339 [INFO]: 	Creating the index 03/13/2025, 12:30:26
2025-03-13 12:30:26,339 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:26
2025-03-13 12:30:26,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:30:26,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:26
2025-03-13 12:30:26,341 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:30:26,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.62it/s] 50%|█████     | 6/12 [00:00<00:00, 29.53it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.23it/s]100%|██████████| 12/12 [00:02<00:00,  5.55it/s]
2025-03-13 12:30:28,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:28
2025-03-13 12:30:58,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6538 secs
2025-03-13 12:30:58,162 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 12:30:58,162 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.01it/s]
2025-03-13 12:31:12,916 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7540 secs
2025-03-13 12:31:12,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5771 secs
2025-03-13 12:31:12,918 [INFO]: {
2025-03-13 12:31:12,918 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:12,918 [INFO]: 	index_param: efSearch=186
2025-03-13 12:31:12,918 [INFO]: 	index_path: knn.index
2025-03-13 12:31:12,918 [INFO]: 	size in bytes: 553046830
2025-03-13 12:31:12,918 [INFO]: 	avg_search_speed_ms: 8.38012198022936
2025-03-13 12:31:12,918 [INFO]: 	99p_search_speed_ms: 11.855878569185732
2025-03-13 12:31:12,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:12,918 [INFO]: 	nb vectors: 2811
2025-03-13 12:31:12,918 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:12,918 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 12:31:12,918 [INFO]: }
2025-03-13 12:31:12,918 [INFO]: 	>>> Finished "Creating the index" in 46.5786 secs
2025-03-13 12:31:12,918 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6053 secs
2025-03-13 12:31:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 89596 [episode count 18/20]
[retrieval_preprocessing] for episode 78404 [episode count 19/20], we have num_retrieval=np.int64(2796) num_query=np.int64(128)
2025-03-13 12:31:14,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:14,424 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:14
2025-03-13 12:31:14,425 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.28it/s]
2025-03-13 12:31:14,453 [INFO]: There are 2796 embeddings of dim 49152
2025-03-13 12:31:14,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:31:14,453 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,453 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:14,453 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:31:14,453 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:14,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:31:14,453 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,453 [INFO]: 577.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:14,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:31:14,453 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:14
2025-03-13 12:31:14,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:14,453 [INFO]: 	Creating the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:14
2025-03-13 12:31:14,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:31:14,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,454 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:31:14,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.31it/s] 50%|█████     | 6/12 [00:00<00:00, 32.11it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.38it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-13 12:31:16,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:16
2025-03-13 12:31:46,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6103 secs
2025-03-13 12:31:46,599 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 12:31:46,599 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.45it/s]
2025-03-13 12:32:06,551 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9520 secs
2025-03-13 12:32:06,553 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0982 secs
2025-03-13 12:32:06,553 [INFO]: {
2025-03-13 12:32:06,553 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:06,553 [INFO]: 	index_param: efSearch=209
2025-03-13 12:32:06,553 [INFO]: 	index_path: knn.index
2025-03-13 12:32:06,553 [INFO]: 	size in bytes: 550095610
2025-03-13 12:32:06,553 [INFO]: 	avg_search_speed_ms: 9.347840705799443
2025-03-13 12:32:06,553 [INFO]: 	99p_search_speed_ms: 13.156729801557939
2025-03-13 12:32:06,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:06,553 [INFO]: 	nb vectors: 2796
2025-03-13 12:32:06,553 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:06,553 [INFO]: 	compression ratio: 0.9993098617892988
2025-03-13 12:32:06,553 [INFO]: }
2025-03-13 12:32:06,553 [INFO]: 	>>> Finished "Creating the index" in 52.0996 secs
2025-03-13 12:32:06,553 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1285 secs
2025-03-13 12:32:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 78404 [episode count 19/20]
2025-03-13 12:32:07: [retrieval_preprocessing] finished for -1_remove_marker_from_cup [chosen_id count 5/260]
2025-03-13 12:32:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_bowl [chosen_id count 6/260]
2025-03-13 12:32:09: [retrieval_preprocessing] we have num_total=2923 embedding_dim=49152
[retrieval_preprocessing] for episode 41026 [episode count 0/20], we have num_retrieval=np.int64(2711) num_query=np.int64(212)
2025-03-13 12:32:09,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:09,835 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:09
2025-03-13 12:32:09,835 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.76it/s]
2025-03-13 12:32:09,862 [INFO]: There are 2711 embeddings of dim 49152
2025-03-13 12:32:09,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 12:32:09,862 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:09
2025-03-13 12:32:09,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:09,862 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:32:09,862 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:09,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:09,862 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:09
2025-03-13 12:32:09,862 [INFO]: 559.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:09,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:32:09,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:09
2025-03-13 12:32:09,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:09,862 [INFO]: 	Creating the index 03/13/2025, 12:32:09
2025-03-13 12:32:09,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:09
2025-03-13 12:32:09,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:32:09,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:09
2025-03-13 12:32:09,864 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:32:09,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.16it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.02it/s]100%|██████████| 11/11 [00:02<00:00,  4.30it/s]100%|██████████| 11/11 [00:02<00:00,  5.34it/s]
2025-03-13 12:32:11,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:11
2025-03-13 12:32:42,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1094 secs
2025-03-13 12:32:42,037 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 12:32:42,037 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.58it/s]
2025-03-13 12:33:02,262 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2254 secs
2025-03-13 12:33:02,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4008 secs
2025-03-13 12:33:02,265 [INFO]: {
2025-03-13 12:33:02,265 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:02,265 [INFO]: 	index_param: efSearch=193
2025-03-13 12:33:02,265 [INFO]: 	index_path: knn.index
2025-03-13 12:33:02,265 [INFO]: 	size in bytes: 533372470
2025-03-13 12:33:02,265 [INFO]: 	avg_search_speed_ms: 9.273260117372958
2025-03-13 12:33:02,265 [INFO]: 	99p_search_speed_ms: 14.018524233251812
2025-03-13 12:33:02,265 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:02,265 [INFO]: 	nb vectors: 2711
2025-03-13 12:33:02,265 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:02,265 [INFO]: 	compression ratio: 0.9993097094043868
2025-03-13 12:33:02,265 [INFO]: }
2025-03-13 12:33:02,265 [INFO]: 	>>> Finished "Creating the index" in 52.4023 secs
2025-03-13 12:33:02,265 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4299 secs
2025-03-13 12:33:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 41026 [episode count 0/20]
[retrieval_preprocessing] for episode 90346 [episode count 1/20], we have num_retrieval=np.int64(2745) num_query=np.int64(178)
2025-03-13 12:33:03,966 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:04,387 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:04
2025-03-13 12:33:04,387 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1518.57it/s]
2025-03-13 12:33:04,422 [INFO]: There are 2745 embeddings of dim 49152
2025-03-13 12:33:04,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 12:33:04,422 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:04,423 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:33:04,423 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:04,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:33:04,423 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,424 [INFO]: 566.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:04,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:33:04,424 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:04
2025-03-13 12:33:04,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:04,424 [INFO]: 	Creating the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,424 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:04
2025-03-13 12:33:04,427 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:33:04,427 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,427 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:33:04,428 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.32it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.58it/s]100%|██████████| 11/11 [00:02<00:00,  4.83it/s]
2025-03-13 12:33:06,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:06
2025-03-13 12:33:39,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9220 secs
2025-03-13 12:33:39,632 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 12:33:39,632 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.00it/s]
2025-03-13 12:34:00,568 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9353 secs
2025-03-13 12:34:00,569 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1419 secs
2025-03-13 12:34:00,569 [INFO]: {
2025-03-13 12:34:00,569 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:00,569 [INFO]: 	index_param: efSearch=275
2025-03-13 12:34:00,569 [INFO]: 	index_path: knn.index
2025-03-13 12:34:00,569 [INFO]: 	size in bytes: 540061630
2025-03-13 12:34:00,570 [INFO]: 	avg_search_speed_ms: 12.988832812490207
2025-03-13 12:34:00,570 [INFO]: 	99p_search_speed_ms: 17.701297008898106
2025-03-13 12:34:00,570 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:00,570 [INFO]: 	nb vectors: 2745
2025-03-13 12:34:00,570 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:00,570 [INFO]: 	compression ratio: 0.9993099491256211
2025-03-13 12:34:00,570 [INFO]: }
2025-03-13 12:34:00,570 [INFO]: 	>>> Finished "Creating the index" in 56.1454 secs
2025-03-13 12:34:00,570 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1822 secs
2025-03-13 12:34:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 90346 [episode count 1/20]
[retrieval_preprocessing] for episode 33017 [episode count 2/20], we have num_retrieval=np.int64(2824) num_query=np.int64(99)
2025-03-13 12:34:02,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:03,176 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:03
2025-03-13 12:34:03,177 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2202.89it/s]
2025-03-13 12:34:03,204 [INFO]: There are 2824 embeddings of dim 49152
2025-03-13 12:34:03,204 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 12:34:03,204 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:03
2025-03-13 12:34:03,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:03,205 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 12:34:03,205 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:03,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:34:03,205 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:03
2025-03-13 12:34:03,205 [INFO]: 582.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:03,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:34:03,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:03
2025-03-13 12:34:03,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:03,206 [INFO]: 	Creating the index 03/13/2025, 12:34:03
2025-03-13 12:34:03,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:03
2025-03-13 12:34:03,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:34:03,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:03
2025-03-13 12:34:03,210 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:34:03,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.51it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.31it/s]100%|██████████| 12/12 [00:02<00:00,  3.38it/s]100%|██████████| 12/12 [00:02<00:00,  4.14it/s]
2025-03-13 12:34:06,116 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:06
2025-03-13 12:34:39,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9452 secs
2025-03-13 12:34:39,062 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 12:34:39,062 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 12:34:57,708 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6454 secs
2025-03-13 12:34:57,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4997 secs
2025-03-13 12:34:57,710 [INFO]: {
2025-03-13 12:34:57,710 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:57,710 [INFO]: 	index_param: efSearch=257
2025-03-13 12:34:57,710 [INFO]: 	index_path: knn.index
2025-03-13 12:34:57,710 [INFO]: 	size in bytes: 555604450
2025-03-13 12:34:57,710 [INFO]: 	avg_search_speed_ms: 11.391126288733274
2025-03-13 12:34:57,710 [INFO]: 	99p_search_speed_ms: 15.876072002574801
2025-03-13 12:34:57,710 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:57,710 [INFO]: 	nb vectors: 2824
2025-03-13 12:34:57,710 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:57,710 [INFO]: 	compression ratio: 0.9993098363413035
2025-03-13 12:34:57,710 [INFO]: }
2025-03-13 12:34:57,710 [INFO]: 	>>> Finished "Creating the index" in 54.5038 secs
2025-03-13 12:34:57,710 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5336 secs
2025-03-13 12:34:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 33017 [episode count 2/20]
[retrieval_preprocessing] for episode 33093 [episode count 3/20], we have num_retrieval=np.int64(2797) num_query=np.int64(126)
2025-03-13 12:34:59,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:59,649 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:59
2025-03-13 12:34:59,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.13it/s]
2025-03-13 12:34:59,676 [INFO]: There are 2797 embeddings of dim 49152
2025-03-13 12:34:59,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:34:59,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:59
2025-03-13 12:34:59,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:59,676 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:34:59,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:59,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:59,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:59
2025-03-13 12:34:59,676 [INFO]: 577.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:59,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:34:59,676 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:59
2025-03-13 12:34:59,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:59,677 [INFO]: 	Creating the index 03/13/2025, 12:34:59
2025-03-13 12:34:59,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:59
2025-03-13 12:34:59,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:34:59,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:59
2025-03-13 12:34:59,678 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:34:59,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.72it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.70it/s]100%|██████████| 12/12 [00:02<00:00,  4.48it/s]100%|██████████| 12/12 [00:02<00:00,  5.32it/s]
2025-03-13 12:35:01,937 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:01
2025-03-13 12:35:33,845 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9068 secs
2025-03-13 12:35:33,845 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 12:35:33,845 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.40it/s]
2025-03-13 12:35:53,341 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4954 secs
2025-03-13 12:35:53,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6646 secs
2025-03-13 12:35:53,342 [INFO]: {
2025-03-13 12:35:53,342 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:53,342 [INFO]: 	index_param: efSearch=264
2025-03-13 12:35:53,342 [INFO]: 	index_path: knn.index
2025-03-13 12:35:53,342 [INFO]: 	size in bytes: 550292350
2025-03-13 12:35:53,342 [INFO]: 	avg_search_speed_ms: 11.572034507817417
2025-03-13 12:35:53,342 [INFO]: 	99p_search_speed_ms: 16.862856363877654
2025-03-13 12:35:53,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:53,342 [INFO]: 	nb vectors: 2797
2025-03-13 12:35:53,343 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:53,343 [INFO]: 	compression ratio: 0.9993098686543617
2025-03-13 12:35:53,343 [INFO]: }
2025-03-13 12:35:53,343 [INFO]: 	>>> Finished "Creating the index" in 53.6660 secs
2025-03-13 12:35:53,343 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6931 secs
2025-03-13 12:35:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 33093 [episode count 3/20]
[retrieval_preprocessing] for episode 83221 [episode count 4/20], we have num_retrieval=np.int64(2820) num_query=np.int64(103)
2025-03-13 12:35:54,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:55,260 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:55
2025-03-13 12:35:55,260 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-13 12:35:55,291 [INFO]: There are 2820 embeddings of dim 49152
2025-03-13 12:35:55,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 12:35:55,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:55
2025-03-13 12:35:55,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:55,291 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:35:55,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:55,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:35:55,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:55
2025-03-13 12:35:55,292 [INFO]: 582.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:55,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:35:55,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:55
2025-03-13 12:35:55,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:55,292 [INFO]: 	Creating the index 03/13/2025, 12:35:55
2025-03-13 12:35:55,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:55
2025-03-13 12:35:55,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:35:55,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:55
2025-03-13 12:35:55,293 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:35:55,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.98it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.47it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.53it/s]100%|██████████| 12/12 [00:02<00:00,  3.19it/s]100%|██████████| 12/12 [00:02<00:00,  4.44it/s]
2025-03-13 12:35:57,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:57
2025-03-13 12:36:28,118 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1208 secs
2025-03-13 12:36:28,118 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 12:36:28,118 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.41it/s]
2025-03-13 12:36:46,382 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2640 secs
2025-03-13 12:36:46,384 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0912 secs
2025-03-13 12:36:46,384 [INFO]: {
2025-03-13 12:36:46,384 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:46,384 [INFO]: 	index_param: efSearch=290
2025-03-13 12:36:46,384 [INFO]: 	index_path: knn.index
2025-03-13 12:36:46,384 [INFO]: 	size in bytes: 554817490
2025-03-13 12:36:46,384 [INFO]: 	avg_search_speed_ms: 13.541505418727944
2025-03-13 12:36:46,384 [INFO]: 	99p_search_speed_ms: 17.364813606254756
2025-03-13 12:36:46,385 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:46,385 [INFO]: 	nb vectors: 2820
2025-03-13 12:36:46,385 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:46,385 [INFO]: 	compression ratio: 0.9993098090689246
2025-03-13 12:36:46,385 [INFO]: }
2025-03-13 12:36:46,385 [INFO]: 	>>> Finished "Creating the index" in 51.0927 secs
2025-03-13 12:36:46,385 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1243 secs
2025-03-13 12:36:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 83221 [episode count 4/20]
[retrieval_preprocessing] for episode 11054 [episode count 5/20], we have num_retrieval=np.int64(2806) num_query=np.int64(117)
2025-03-13 12:36:47,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:48,108 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:48
2025-03-13 12:36:48,109 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1656.52it/s]
2025-03-13 12:36:48,136 [INFO]: There are 2806 embeddings of dim 49152
2025-03-13 12:36:48,137 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:36:48,137 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,137 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:48,137 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:36:48,137 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:48,137 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:36:48,137 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,137 [INFO]: 579.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:48,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:36:48,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:48
2025-03-13 12:36:48,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:48,137 [INFO]: 	Creating the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:48
2025-03-13 12:36:48,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:36:48,138 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:48
2025-03-13 12:36:48,138 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:36:48,139 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.70it/s] 50%|█████     | 6/12 [00:00<00:00, 27.43it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.44it/s]100%|██████████| 12/12 [00:02<00:00,  4.93it/s]
2025-03-13 12:36:50,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:50
2025-03-13 12:37:22,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5259 secs
2025-03-13 12:37:22,103 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 12:37:22,103 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.60it/s]
2025-03-13 12:37:36,589 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4864 secs
2025-03-13 12:37:36,591 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4530 secs
2025-03-13 12:37:36,592 [INFO]: {
2025-03-13 12:37:36,592 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:36,592 [INFO]: 	index_param: efSearch=200
2025-03-13 12:37:36,592 [INFO]: 	index_path: knn.index
2025-03-13 12:37:36,592 [INFO]: 	size in bytes: 552063130
2025-03-13 12:37:36,592 [INFO]: 	avg_search_speed_ms: 9.580292488748057
2025-03-13 12:37:36,592 [INFO]: 	99p_search_speed_ms: 13.300926741212606
2025-03-13 12:37:36,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:36,592 [INFO]: 	nb vectors: 2806
2025-03-13 12:37:36,592 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:36,592 [INFO]: 	compression ratio: 0.9993097130032936
2025-03-13 12:37:36,592 [INFO]: }
2025-03-13 12:37:36,592 [INFO]: 	>>> Finished "Creating the index" in 48.4545 secs
2025-03-13 12:37:36,592 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4834 secs
2025-03-13 12:37:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 11054 [episode count 5/20]
[retrieval_preprocessing] for episode 33536 [episode count 6/20], we have num_retrieval=np.int64(2824) num_query=np.int64(99)
2025-03-13 12:37:37,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:38,050 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:38
2025-03-13 12:37:38,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.57it/s]
2025-03-13 12:37:38,083 [INFO]: There are 2824 embeddings of dim 49152
2025-03-13 12:37:38,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 12:37:38,084 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:38
2025-03-13 12:37:38,084 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:38,084 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 12:37:38,084 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:38,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:37:38,084 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:38
2025-03-13 12:37:38,084 [INFO]: 582.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:38,085 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:37:38,085 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:38
2025-03-13 12:37:38,085 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:38,085 [INFO]: 	Creating the index 03/13/2025, 12:37:38
2025-03-13 12:37:38,085 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:38
2025-03-13 12:37:38,087 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 12:37:38,087 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:38
2025-03-13 12:37:38,087 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:37:38,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.49it/s] 50%|█████     | 6/12 [00:00<00:00, 31.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.54it/s]100%|██████████| 12/12 [00:02<00:00,  5.24it/s]
2025-03-13 12:37:40,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:40
2025-03-13 12:38:10,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3530 secs
2025-03-13 12:38:10,735 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 12:38:10,735 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.71it/s]
2025-03-13 12:38:30,518 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7831 secs
2025-03-13 12:38:31,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9193 secs
2025-03-13 12:38:31,007 [INFO]: {
2025-03-13 12:38:31,007 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:31,007 [INFO]: 	index_param: efSearch=176
2025-03-13 12:38:31,007 [INFO]: 	index_path: knn.index
2025-03-13 12:38:31,007 [INFO]: 	size in bytes: 555604450
2025-03-13 12:38:31,007 [INFO]: 	avg_search_speed_ms: 8.77336674623126
2025-03-13 12:38:31,007 [INFO]: 	99p_search_speed_ms: 12.714173595886674
2025-03-13 12:38:31,007 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:31,008 [INFO]: 	nb vectors: 2824
2025-03-13 12:38:31,008 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:31,008 [INFO]: 	compression ratio: 0.9993098363413035
2025-03-13 12:38:31,008 [INFO]: }
2025-03-13 12:38:31,008 [INFO]: 	>>> Finished "Creating the index" in 52.9228 secs
2025-03-13 12:38:31,008 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9577 secs
2025-03-13 12:38:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 33536 [episode count 6/20]
[retrieval_preprocessing] for episode 67424 [episode count 7/20], we have num_retrieval=np.int64(2677) num_query=np.int64(246)
2025-03-13 12:38:31,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:32,324 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:32
2025-03-13 12:38:32,324 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1309.49it/s]
2025-03-13 12:38:32,354 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 12:38:32,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 12:38:32,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:32
2025-03-13 12:38:32,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:32,355 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:38:32,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:32,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:38:32,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:32
2025-03-13 12:38:32,356 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:32,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:38:32,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:32
2025-03-13 12:38:32,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:32,356 [INFO]: 	Creating the index 03/13/2025, 12:38:32
2025-03-13 12:38:32,357 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:32
2025-03-13 12:38:32,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:38:32,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:32
2025-03-13 12:38:32,360 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:38:32,361 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.39it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.82it/s]100%|██████████| 11/11 [00:01<00:00,  4.45it/s]100%|██████████| 11/11 [00:01<00:00,  5.53it/s]
2025-03-13 12:38:34,356 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:34
2025-03-13 12:39:06,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0081 secs
2025-03-13 12:39:06,365 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:39:06,365 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.83it/s]
2025-03-13 12:39:24,305 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9402 secs
2025-03-13 12:39:24,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9471 secs
2025-03-13 12:39:24,308 [INFO]: {
2025-03-13 12:39:24,308 [INFO]: 	index_key: HNSW15
2025-03-13 12:39:24,308 [INFO]: 	index_param: efSearch=235
2025-03-13 12:39:24,308 [INFO]: 	index_path: knn.index
2025-03-13 12:39:24,308 [INFO]: 	size in bytes: 526683190
2025-03-13 12:39:24,308 [INFO]: 	avg_search_speed_ms: 11.478444340026133
2025-03-13 12:39:24,308 [INFO]: 	99p_search_speed_ms: 17.49123365152624
2025-03-13 12:39:24,308 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:24,308 [INFO]: 	nb vectors: 2677
2025-03-13 12:39:24,308 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:24,308 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 12:39:24,308 [INFO]: }
2025-03-13 12:39:24,308 [INFO]: 	>>> Finished "Creating the index" in 51.9512 secs
2025-03-13 12:39:24,308 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9837 secs
2025-03-13 12:39:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 67424 [episode count 7/20]
[retrieval_preprocessing] for episode 1969 [episode count 8/20], we have num_retrieval=np.int64(2790) num_query=np.int64(133)
2025-03-13 12:39:26,956 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:27,392 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:27
2025-03-13 12:39:27,392 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1218.92it/s]
2025-03-13 12:39:27,426 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 12:39:27,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 12:39:27,427 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,427 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:27,428 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:39:27,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:27,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:39:27,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,428 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:27,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:39:27,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:27
2025-03-13 12:39:27,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:27,429 [INFO]: 	Creating the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:27
2025-03-13 12:39:27,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 12:39:27,432 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,432 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:39:27,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.25it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.71it/s]100%|██████████| 11/11 [00:02<00:00,  3.40it/s]100%|██████████| 11/11 [00:02<00:00,  4.03it/s]
2025-03-13 12:39:30,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:30
2025-03-13 12:40:01,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1643 secs
2025-03-13 12:40:01,335 [INFO]: The best hyperparameters are: efSearch=313
2025-03-13 12:40:01,335 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.12it/s]
2025-03-13 12:40:29,290 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9552 secs
2025-03-13 12:40:29,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8606 secs
2025-03-13 12:40:29,293 [INFO]: {
2025-03-13 12:40:29,293 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:29,293 [INFO]: 	index_param: efSearch=313
2025-03-13 12:40:29,293 [INFO]: 	index_path: knn.index
2025-03-13 12:40:29,293 [INFO]: 	size in bytes: 548915110
2025-03-13 12:40:29,293 [INFO]: 	avg_search_speed_ms: 13.410842039587411
2025-03-13 12:40:29,293 [INFO]: 	99p_search_speed_ms: 20.611715980339792
2025-03-13 12:40:29,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:29,293 [INFO]: 	nb vectors: 2790
2025-03-13 12:40:29,293 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:29,293 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 12:40:29,293 [INFO]: }
2025-03-13 12:40:29,293 [INFO]: 	>>> Finished "Creating the index" in 61.8640 secs
2025-03-13 12:40:29,293 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9007 secs
2025-03-13 12:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 1969 [episode count 8/20]
[retrieval_preprocessing] for episode 59772 [episode count 9/20], we have num_retrieval=np.int64(2728) num_query=np.int64(195)
2025-03-13 12:40:31,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:31,884 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:31
2025-03-13 12:40:31,884 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.77it/s]
2025-03-13 12:40:31,915 [INFO]: There are 2728 embeddings of dim 49152
2025-03-13 12:40:31,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 12:40:31,916 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:31
2025-03-13 12:40:31,916 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:31,916 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:40:31,916 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:31,916 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:40:31,916 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:31
2025-03-13 12:40:31,916 [INFO]: 563.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:31,916 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:40:31,916 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:31
2025-03-13 12:40:31,916 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:31,916 [INFO]: 	Creating the index 03/13/2025, 12:40:31
2025-03-13 12:40:31,916 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:31
2025-03-13 12:40:31,918 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:40:31,918 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:31
2025-03-13 12:40:31,918 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:40:31,918 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.27it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.10it/s]100%|██████████| 11/11 [00:02<00:00,  5.23it/s]
2025-03-13 12:40:34,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:34
2025-03-13 12:41:09,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0328 secs
2025-03-13 12:41:09,059 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 12:41:09,059 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.36it/s]
2025-03-13 12:41:33,491 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4317 secs
2025-03-13 12:41:33,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5752 secs
2025-03-13 12:41:33,493 [INFO]: {
2025-03-13 12:41:33,493 [INFO]: 	index_key: HNSW15
2025-03-13 12:41:33,493 [INFO]: 	index_param: efSearch=243
2025-03-13 12:41:33,493 [INFO]: 	index_path: knn.index
2025-03-13 12:41:33,493 [INFO]: 	size in bytes: 536717050
2025-03-13 12:41:33,493 [INFO]: 	avg_search_speed_ms: 12.39961628684407
2025-03-13 12:41:33,493 [INFO]: 	99p_search_speed_ms: 16.386085874401033
2025-03-13 12:41:33,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:33,493 [INFO]: 	nb vectors: 2728
2025-03-13 12:41:33,493 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:33,493 [INFO]: 	compression ratio: 0.9993098300119215
2025-03-13 12:41:33,493 [INFO]: }
2025-03-13 12:41:33,493 [INFO]: 	>>> Finished "Creating the index" in 61.5768 secs
2025-03-13 12:41:33,493 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6089 secs
2025-03-13 12:41:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 59772 [episode count 9/20]
[retrieval_preprocessing] for episode 10667 [episode count 10/20], we have num_retrieval=np.int64(2828) num_query=np.int64(95)
2025-03-13 12:41:36,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:41:36,799 [INFO]: Launching the whole pipeline 03/13/2025, 12:41:36
2025-03-13 12:41:36,800 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:41:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.32it/s]
2025-03-13 12:41:36,840 [INFO]: There are 2828 embeddings of dim 49152
2025-03-13 12:41:36,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 12:41:36,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:41:36
2025-03-13 12:41:36,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:41:36,842 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 12:41:36,842 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:41:36,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:41:36,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:41:36
2025-03-13 12:41:36,842 [INFO]: 583.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:41:36,843 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:41:36,843 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:41:36
2025-03-13 12:41:36,843 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:41:36,843 [INFO]: 	Creating the index 03/13/2025, 12:41:36
2025-03-13 12:41:36,844 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:41:36
2025-03-13 12:41:36,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:41:36,845 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:41:36
2025-03-13 12:41:36,845 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:41:36,845 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.00it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.47it/s] 75%|███████▌  | 9/12 [00:00<00:00, 30.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.05it/s]
2025-03-13 12:41:39,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:41:39
2025-03-13 12:42:25,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9630 secs
2025-03-13 12:42:25,776 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 12:42:25,777 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.83it/s]
2025-03-13 12:42:42,771 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9940 secs
2025-03-13 12:42:42,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9285 secs
2025-03-13 12:42:42,774 [INFO]: {
2025-03-13 12:42:42,774 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:42,774 [INFO]: 	index_param: efSearch=234
2025-03-13 12:42:42,774 [INFO]: 	index_path: knn.index
2025-03-13 12:42:42,774 [INFO]: 	size in bytes: 556391470
2025-03-13 12:42:42,774 [INFO]: 	avg_search_speed_ms: 15.902122765459676
2025-03-13 12:42:42,774 [INFO]: 	99p_search_speed_ms: 23.095107730478055
2025-03-13 12:42:42,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:42,774 [INFO]: 	nb vectors: 2828
2025-03-13 12:42:42,774 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:42,774 [INFO]: 	compression ratio: 0.9993097557732149
2025-03-13 12:42:42,774 [INFO]: }
2025-03-13 12:42:42,774 [INFO]: 	>>> Finished "Creating the index" in 65.9307 secs
2025-03-13 12:42:42,774 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9746 secs
2025-03-13 12:42:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 10667 [episode count 10/20]
[retrieval_preprocessing] for episode 76313 [episode count 11/20], we have num_retrieval=np.int64(2788) num_query=np.int64(135)
2025-03-13 12:42:44,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:44,596 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:44
2025-03-13 12:42:44,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-13 12:42:44,628 [INFO]: There are 2788 embeddings of dim 49152
2025-03-13 12:42:44,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 12:42:44,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:44,629 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:42:44,629 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:44,629 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:42:44,629 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,629 [INFO]: 575.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:44,629 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:42:44,629 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:44
2025-03-13 12:42:44,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:44,629 [INFO]: 	Creating the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:44
2025-03-13 12:42:44,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:42:44,631 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,631 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:42:44,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.42it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.43it/s]100%|██████████| 11/11 [00:02<00:00,  3.19it/s]100%|██████████| 11/11 [00:02<00:00,  3.79it/s]
2025-03-13 12:42:47,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:47
2025-03-13 12:43:28,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5069 secs
2025-03-13 12:43:28,043 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 12:43:28,043 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.11it/s]
2025-03-13 12:43:44,842 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7997 secs
2025-03-13 12:43:44,845 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2138 secs
2025-03-13 12:43:44,845 [INFO]: {
2025-03-13 12:43:44,845 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:44,845 [INFO]: 	index_param: efSearch=267
2025-03-13 12:43:44,845 [INFO]: 	index_path: knn.index
2025-03-13 12:43:44,845 [INFO]: 	size in bytes: 548521630
2025-03-13 12:43:44,845 [INFO]: 	avg_search_speed_ms: 12.513079343058253
2025-03-13 12:43:44,845 [INFO]: 	99p_search_speed_ms: 15.84170816000551
2025-03-13 12:43:44,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:44,845 [INFO]: 	nb vectors: 2788
2025-03-13 12:43:44,845 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:44,845 [INFO]: 	compression ratio: 0.9993099160009424
2025-03-13 12:43:44,845 [INFO]: }
2025-03-13 12:43:44,845 [INFO]: 	>>> Finished "Creating the index" in 60.2157 secs
2025-03-13 12:43:44,845 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2491 secs
2025-03-13 12:43:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 76313 [episode count 11/20]
[retrieval_preprocessing] for episode 94717 [episode count 12/20], we have num_retrieval=np.int64(2770) num_query=np.int64(153)
2025-03-13 12:43:47,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:48,314 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:48
2025-03-13 12:43:48,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.67it/s]
2025-03-13 12:43:48,351 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 12:43:48,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0373 secs
2025-03-13 12:43:48,352 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:48
2025-03-13 12:43:48,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:48,353 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:43:48,353 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:48,353 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:43:48,353 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:48
2025-03-13 12:43:48,354 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:48,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 12:43:48,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:48
2025-03-13 12:43:48,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:48,354 [INFO]: 	Creating the index 03/13/2025, 12:43:48
2025-03-13 12:43:48,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:48
2025-03-13 12:43:48,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 12:43:48,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:48
2025-03-13 12:43:48,359 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:43:48,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.94it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.49it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.37it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.17it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.30it/s]100%|██████████| 11/11 [00:03<00:00,  2.02it/s]100%|██████████| 11/11 [00:03<00:00,  3.29it/s]
2025-03-13 12:43:51,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:51
2025-03-13 12:44:23,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9800 secs
2025-03-13 12:44:23,688 [INFO]: The best hyperparameters are: efSearch=285
2025-03-13 12:44:23,688 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-13 12:44:39,578 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8896 secs
2025-03-13 12:44:39,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2221 secs
2025-03-13 12:44:39,581 [INFO]: {
2025-03-13 12:44:39,581 [INFO]: 	index_key: HNSW15
2025-03-13 12:44:39,581 [INFO]: 	index_param: efSearch=285
2025-03-13 12:44:39,581 [INFO]: 	index_path: knn.index
2025-03-13 12:44:39,581 [INFO]: 	size in bytes: 544980310
2025-03-13 12:44:39,581 [INFO]: 	avg_search_speed_ms: 14.02103889789641
2025-03-13 12:44:39,581 [INFO]: 	99p_search_speed_ms: 18.438205649144948
2025-03-13 12:44:39,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:44:39,581 [INFO]: 	nb vectors: 2770
2025-03-13 12:44:39,581 [INFO]: 	vectors dimension: 49152
2025-03-13 12:44:39,581 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 12:44:39,581 [INFO]: }
2025-03-13 12:44:39,581 [INFO]: 	>>> Finished "Creating the index" in 51.2265 secs
2025-03-13 12:44:39,581 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2664 secs
2025-03-13 12:44:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 94717 [episode count 12/20]
[retrieval_preprocessing] for episode 12829 [episode count 13/20], we have num_retrieval=np.int64(2827) num_query=np.int64(96)
2025-03-13 12:44:41,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:41,900 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:41
2025-03-13 12:44:41,900 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-13 12:44:41,927 [INFO]: There are 2827 embeddings of dim 49152
2025-03-13 12:44:41,927 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 12:44:41,927 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:41
2025-03-13 12:44:41,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:41,927 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 12:44:41,927 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:41,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:44:41,927 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:41
2025-03-13 12:44:41,928 [INFO]: 583.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:41,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:44:41,928 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:41
2025-03-13 12:44:41,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:41,928 [INFO]: 	Creating the index 03/13/2025, 12:44:41
2025-03-13 12:44:41,928 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:41
2025-03-13 12:44:41,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:44:41,929 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:41
2025-03-13 12:44:41,929 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:44:41,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.28it/s] 67%|██████▋   | 8/12 [00:00<00:00, 40.00it/s]100%|██████████| 12/12 [00:02<00:00,  5.72it/s]
2025-03-13 12:44:44,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:44
2025-03-13 12:45:15,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2485 secs
2025-03-13 12:45:15,279 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 12:45:15,279 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-13 12:45:35,814 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5348 secs
2025-03-13 12:45:35,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8872 secs
2025-03-13 12:45:35,816 [INFO]: {
2025-03-13 12:45:35,816 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:35,816 [INFO]: 	index_param: efSearch=274
2025-03-13 12:45:35,816 [INFO]: 	index_path: knn.index
2025-03-13 12:45:35,816 [INFO]: 	size in bytes: 556194730
2025-03-13 12:45:35,816 [INFO]: 	avg_search_speed_ms: 13.21393797786776
2025-03-13 12:45:35,816 [INFO]: 	99p_search_speed_ms: 20.440081730484945
2025-03-13 12:45:35,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:35,816 [INFO]: 	nb vectors: 2827
2025-03-13 12:45:35,816 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:35,816 [INFO]: 	compression ratio: 0.999309748943504
2025-03-13 12:45:35,816 [INFO]: }
2025-03-13 12:45:35,816 [INFO]: 	>>> Finished "Creating the index" in 53.8887 secs
2025-03-13 12:45:35,816 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9160 secs
2025-03-13 12:45:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 12829 [episode count 13/20]
[retrieval_preprocessing] for episode 30242 [episode count 14/20], we have num_retrieval=np.int64(2761) num_query=np.int64(162)
2025-03-13 12:45:37,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:38,226 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:38
2025-03-13 12:45:38,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.82it/s]
2025-03-13 12:45:38,255 [INFO]: There are 2761 embeddings of dim 49152
2025-03-13 12:45:38,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:45:38,255 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:38
2025-03-13 12:45:38,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:38,255 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:45:38,255 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:38,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:45:38,255 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:38
2025-03-13 12:45:38,256 [INFO]: 569.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:38,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:45:38,256 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:38
2025-03-13 12:45:38,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:38,256 [INFO]: 	Creating the index 03/13/2025, 12:45:38
2025-03-13 12:45:38,256 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:38
2025-03-13 12:45:38,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 12:45:38,257 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:38
2025-03-13 12:45:38,257 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:45:38,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.84it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.05it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]100%|██████████| 11/11 [00:02<00:00,  4.90it/s]
2025-03-13 12:45:40,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:40
2025-03-13 12:46:13,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2134 secs
2025-03-13 12:46:13,718 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 12:46:13,718 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 12:46:32,024 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3057 secs
2025-03-13 12:46:32,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7695 secs
2025-03-13 12:46:32,026 [INFO]: {
2025-03-13 12:46:32,026 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:32,026 [INFO]: 	index_param: efSearch=275
2025-03-13 12:46:32,026 [INFO]: 	index_path: knn.index
2025-03-13 12:46:32,026 [INFO]: 	size in bytes: 543209530
2025-03-13 12:46:32,026 [INFO]: 	avg_search_speed_ms: 14.684356295362814
2025-03-13 12:46:32,026 [INFO]: 	99p_search_speed_ms: 20.65281174145639
2025-03-13 12:46:32,026 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:32,026 [INFO]: 	nb vectors: 2761
2025-03-13 12:46:32,026 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:32,026 [INFO]: 	compression ratio: 0.9993099495143246
2025-03-13 12:46:32,026 [INFO]: }
2025-03-13 12:46:32,027 [INFO]: 	>>> Finished "Creating the index" in 53.7708 secs
2025-03-13 12:46:32,027 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8007 secs
2025-03-13 12:46:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 30242 [episode count 14/20]
[retrieval_preprocessing] for episode 31807 [episode count 15/20], we have num_retrieval=np.int64(2762) num_query=np.int64(161)
2025-03-13 12:46:34,089 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:34,527 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:34
2025-03-13 12:46:34,527 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 12:46:34,559 [INFO]: There are 2762 embeddings of dim 49152
2025-03-13 12:46:34,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 12:46:34,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:34
2025-03-13 12:46:34,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:34,561 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:46:34,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:34,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:46:34,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:34
2025-03-13 12:46:34,561 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:34,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:46:34,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:34
2025-03-13 12:46:34,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:34,562 [INFO]: 	Creating the index 03/13/2025, 12:46:34
2025-03-13 12:46:34,562 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:34
2025-03-13 12:46:34,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:46:34,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:34
2025-03-13 12:46:34,566 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:46:34,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.35it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.48it/s]100%|██████████| 11/11 [00:02<00:00,  3.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.77it/s]
2025-03-13 12:46:36,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:36
2025-03-13 12:47:07,108 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2308 secs
2025-03-13 12:47:07,108 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 12:47:07,108 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 12:47:23,284 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1758 secs
2025-03-13 12:47:23,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7200 secs
2025-03-13 12:47:23,286 [INFO]: {
2025-03-13 12:47:23,286 [INFO]: 	index_key: HNSW15
2025-03-13 12:47:23,286 [INFO]: 	index_param: efSearch=300
2025-03-13 12:47:23,286 [INFO]: 	index_path: knn.index
2025-03-13 12:47:23,286 [INFO]: 	size in bytes: 543406270
2025-03-13 12:47:23,286 [INFO]: 	avg_search_speed_ms: 12.597610720935318
2025-03-13 12:47:23,286 [INFO]: 	99p_search_speed_ms: 16.72342235222458
2025-03-13 12:47:23,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:47:23,286 [INFO]: 	nb vectors: 2762
2025-03-13 12:47:23,286 [INFO]: 	vectors dimension: 49152
2025-03-13 12:47:23,286 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-13 12:47:23,286 [INFO]: }
2025-03-13 12:47:23,286 [INFO]: 	>>> Finished "Creating the index" in 48.7240 secs
2025-03-13 12:47:23,286 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7594 secs
2025-03-13 12:47:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:47:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 31807 [episode count 15/20]
[retrieval_preprocessing] for episode 80920 [episode count 16/20], we have num_retrieval=np.int64(2817) num_query=np.int64(106)
2025-03-13 12:47:25,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:47:27,141 [INFO]: Launching the whole pipeline 03/13/2025, 12:47:27
2025-03-13 12:47:27,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:47:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1766.02it/s]
2025-03-13 12:47:27,168 [INFO]: There are 2817 embeddings of dim 49152
2025-03-13 12:47:27,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 12:47:27,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:47:27
2025-03-13 12:47:27,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:47:27,168 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:47:27,168 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:47:27,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:47:27,168 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:47:27
2025-03-13 12:47:27,168 [INFO]: 581.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:47:27,168 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:47:27,168 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:47:27
2025-03-13 12:47:27,168 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:47:27,168 [INFO]: 	Creating the index 03/13/2025, 12:47:27
2025-03-13 12:47:27,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:47:27
2025-03-13 12:47:27,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:47:27,170 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:47:27
2025-03-13 12:47:27,170 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:47:27,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.65it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.13it/s]100%|██████████| 12/12 [00:01<00:00,  5.10it/s]100%|██████████| 12/12 [00:01<00:00,  6.04it/s]
2025-03-13 12:47:29,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:47:29
2025-03-13 12:48:01,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3447 secs
2025-03-13 12:48:01,503 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 12:48:01,503 [INFO]: 	Compute fast metrics 03/13/2025, 12:48:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:15,  5.04s/it] 50%|█████     | 2/4 [00:09<00:09,  4.79s/it] 75%|███████▌  | 3/4 [00:11<00:03,  3.62s/it] 75%|███████▌  | 3/4 [00:11<00:03,  3.97s/it]
2025-03-13 12:48:31,107 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6033 secs
2025-03-13 12:48:31,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9393 secs
2025-03-13 12:48:31,109 [INFO]: {
2025-03-13 12:48:31,109 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:31,109 [INFO]: 	index_param: efSearch=236
2025-03-13 12:48:31,109 [INFO]: 	index_path: knn.index
2025-03-13 12:48:31,109 [INFO]: 	size in bytes: 554227270
2025-03-13 12:48:31,109 [INFO]: 	avg_search_speed_ms: 12.165826051654589
2025-03-13 12:48:31,109 [INFO]: 	99p_search_speed_ms: 25.49122237134724
2025-03-13 12:48:31,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:31,109 [INFO]: 	nb vectors: 2817
2025-03-13 12:48:31,109 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:31,109 [INFO]: 	compression ratio: 0.9993097885638142
2025-03-13 12:48:31,109 [INFO]: }
2025-03-13 12:48:31,109 [INFO]: 	>>> Finished "Creating the index" in 63.9408 secs
2025-03-13 12:48:31,109 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9681 secs
2025-03-13 12:48:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 80920 [episode count 16/20]
[retrieval_preprocessing] for episode 62316 [episode count 17/20], we have num_retrieval=np.int64(2755) num_query=np.int64(168)
2025-03-13 12:48:32,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:32,789 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:32
2025-03-13 12:48:32,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1258.04it/s]
2025-03-13 12:48:32,822 [INFO]: There are 2755 embeddings of dim 49152
2025-03-13 12:48:32,822 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 12:48:32,822 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:32
2025-03-13 12:48:32,822 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:32,822 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:48:32,822 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:32,822 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:48:32,822 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:32
2025-03-13 12:48:32,823 [INFO]: 568.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:32,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:48:32,823 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:32
2025-03-13 12:48:32,823 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:32,823 [INFO]: 	Creating the index 03/13/2025, 12:48:32
2025-03-13 12:48:32,823 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:32
2025-03-13 12:48:32,824 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:48:32,824 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:32
2025-03-13 12:48:32,824 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:48:32,824 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.75it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.24it/s]100%|██████████| 11/11 [00:02<00:00,  4.08it/s]100%|██████████| 11/11 [00:02<00:00,  5.08it/s]
2025-03-13 12:48:35,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:35
2025-03-13 12:49:07,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9065 secs
2025-03-13 12:49:07,149 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 12:49:07,149 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:12,  4.19s/it] 50%|█████     | 2/4 [00:07<00:07,  3.82s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.50s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.63s/it]
2025-03-13 12:49:32,520 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3707 secs
2025-03-13 12:49:32,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6974 secs
2025-03-13 12:49:32,522 [INFO]: {
2025-03-13 12:49:32,522 [INFO]: 	index_key: HNSW15
2025-03-13 12:49:32,522 [INFO]: 	index_param: efSearch=277
2025-03-13 12:49:32,522 [INFO]: 	index_path: knn.index
2025-03-13 12:49:32,522 [INFO]: 	size in bytes: 542029030
2025-03-13 12:49:32,522 [INFO]: 	avg_search_speed_ms: 11.796765250180197
2025-03-13 12:49:32,522 [INFO]: 	99p_search_speed_ms: 16.170157601591196
2025-03-13 12:49:32,522 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:49:32,522 [INFO]: 	nb vectors: 2755
2025-03-13 12:49:32,522 [INFO]: 	vectors dimension: 49152
2025-03-13 12:49:32,522 [INFO]: 	compression ratio: 0.9993100185058353
2025-03-13 12:49:32,522 [INFO]: }
2025-03-13 12:49:32,522 [INFO]: 	>>> Finished "Creating the index" in 59.6989 secs
2025-03-13 12:49:32,522 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7331 secs
2025-03-13 12:49:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:49:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 62316 [episode count 17/20]
[retrieval_preprocessing] for episode 70282 [episode count 18/20], we have num_retrieval=np.int64(2753) num_query=np.int64(170)
2025-03-13 12:49:34,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:49:34,973 [INFO]: Launching the whole pipeline 03/13/2025, 12:49:34
2025-03-13 12:49:34,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:49:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1906.50it/s]
2025-03-13 12:49:34,999 [INFO]: There are 2753 embeddings of dim 49152
2025-03-13 12:49:34,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:49:34,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:49:34
2025-03-13 12:49:34,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:49:34,999 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:49:34,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:49:34,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:49:34,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:49:34
2025-03-13 12:49:34,999 [INFO]: 568.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:49:35,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:49:35,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:49:35
2025-03-13 12:49:35,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:49:35,000 [INFO]: 	Creating the index 03/13/2025, 12:49:35
2025-03-13 12:49:35,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:49:35
2025-03-13 12:49:35,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:49:35,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:49:35
2025-03-13 12:49:35,001 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:49:35,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.70it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.32it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]100%|██████████| 11/11 [00:02<00:00,  5.24it/s]
2025-03-13 12:49:37,103 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:49:37
2025-03-13 12:50:05,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9549 secs
2025-03-13 12:50:05,059 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 12:50:05,059 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.23it/s]
2025-03-13 12:50:23,531 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4717 secs
2025-03-13 12:50:23,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5322 secs
2025-03-13 12:50:23,533 [INFO]: {
2025-03-13 12:50:23,533 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:23,533 [INFO]: 	index_param: efSearch=317
2025-03-13 12:50:23,533 [INFO]: 	index_path: knn.index
2025-03-13 12:50:23,533 [INFO]: 	size in bytes: 541635550
2025-03-13 12:50:23,533 [INFO]: 	avg_search_speed_ms: 13.62639421734157
2025-03-13 12:50:23,533 [INFO]: 	99p_search_speed_ms: 21.931538723874837
2025-03-13 12:50:23,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:23,533 [INFO]: 	nb vectors: 2753
2025-03-13 12:50:23,533 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:23,533 [INFO]: 	compression ratio: 0.9993100046701144
2025-03-13 12:50:23,533 [INFO]: }
2025-03-13 12:50:23,533 [INFO]: 	>>> Finished "Creating the index" in 48.5336 secs
2025-03-13 12:50:23,533 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5605 secs
2025-03-13 12:50:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 70282 [episode count 18/20]
[retrieval_preprocessing] for episode 87216 [episode count 19/20], we have num_retrieval=np.int64(2754) num_query=np.int64(169)
2025-03-13 12:50:25,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:26,263 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:26
2025-03-13 12:50:26,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.17it/s]
2025-03-13 12:50:26,300 [INFO]: There are 2754 embeddings of dim 49152
2025-03-13 12:50:26,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 12:50:26,300 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:26
2025-03-13 12:50:26,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:26,300 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:50:26,300 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:26,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:50:26,300 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:26
2025-03-13 12:50:26,300 [INFO]: 568.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:26,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:50:26,301 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:26
2025-03-13 12:50:26,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:26,301 [INFO]: 	Creating the index 03/13/2025, 12:50:26
2025-03-13 12:50:26,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:26
2025-03-13 12:50:26,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:50:26,302 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:26
2025-03-13 12:50:26,302 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:50:26,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.53it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.83it/s]100%|██████████| 11/11 [00:02<00:00,  3.77it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]
2025-03-13 12:50:28,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:28
2025-03-13 12:51:05,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1583 secs
2025-03-13 12:51:05,944 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 12:51:05,944 [INFO]: 	Compute fast metrics 03/13/2025, 12:51:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.30it/s]
2025-03-13 12:51:20,956 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0118 secs
2025-03-13 12:51:20,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6563 secs
2025-03-13 12:51:20,958 [INFO]: {
2025-03-13 12:51:20,958 [INFO]: 	index_key: HNSW15
2025-03-13 12:51:20,958 [INFO]: 	index_param: efSearch=243
2025-03-13 12:51:20,958 [INFO]: 	index_path: knn.index
2025-03-13 12:51:20,958 [INFO]: 	size in bytes: 541832290
2025-03-13 12:51:20,958 [INFO]: 	avg_search_speed_ms: 12.547150809595939
2025-03-13 12:51:20,958 [INFO]: 	99p_search_speed_ms: 17.644086051732298
2025-03-13 12:51:20,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:51:20,958 [INFO]: 	nb vectors: 2754
2025-03-13 12:51:20,958 [INFO]: 	vectors dimension: 49152
2025-03-13 12:51:20,958 [INFO]: 	compression ratio: 0.9993100115904868
2025-03-13 12:51:20,958 [INFO]: }
2025-03-13 12:51:20,958 [INFO]: 	>>> Finished "Creating the index" in 54.6577 secs
2025-03-13 12:51:20,958 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6952 secs
2025-03-13 12:51:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:51:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 87216 [episode count 19/20]
2025-03-13 12:51:22: [retrieval_preprocessing] finished for -1_remove_marker_from_bowl [chosen_id count 6/260]
2025-03-13 12:51:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_pot [chosen_id count 7/260]
2025-03-13 12:51:24: [retrieval_preprocessing] we have num_total=3894 embedding_dim=49152
2025-03-13 12:51:24: [retrieval_preprocessing] skipping episode 41026 [episode count 0/20]
2025-03-13 12:51:24: [retrieval_preprocessing] skipping episode 90346 [episode count 1/20]
[retrieval_preprocessing] for episode 49387 [episode count 2/20], we have num_retrieval=np.int64(3683) num_query=np.int64(211)
2025-03-13 12:51:24,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:51:24,885 [INFO]: Launching the whole pipeline 03/13/2025, 12:51:24
2025-03-13 12:51:24,885 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:51:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1620.05it/s]
2025-03-13 12:51:24,908 [INFO]: There are 3683 embeddings of dim 49152
2025-03-13 12:51:24,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 12:51:24,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:51:24
2025-03-13 12:51:24,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:51:24,908 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:51:24,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:51:24,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:51:24,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:51:24
2025-03-13 12:51:24,908 [INFO]: 760.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:51:24,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:51:24,908 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:51:24
2025-03-13 12:51:24,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:51:24,909 [INFO]: 	Creating the index 03/13/2025, 12:51:24
2025-03-13 12:51:24,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:51:24
2025-03-13 12:51:24,910 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:51:24,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:51:24
2025-03-13 12:51:24,910 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:51:24,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.79it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.99it/s] 87%|████████▋ | 13/15 [00:00<00:00, 43.39it/s]100%|██████████| 15/15 [00:02<00:00,  5.14it/s]
2025-03-13 12:51:27,833 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:27
2025-03-13 12:52:06,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6393 secs
2025-03-13 12:52:06,473 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 12:52:06,473 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.50s/it] 50%|█████     | 2/4 [00:04<00:04,  2.09s/it] 75%|███████▌  | 3/4 [00:06<00:01,  1.78s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.09s/it]
2025-03-13 12:52:32,941 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4679 secs
2025-03-13 12:52:32,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0334 secs
2025-03-13 12:52:32,943 [INFO]: {
2025-03-13 12:52:32,943 [INFO]: 	index_key: HNSW15
2025-03-13 12:52:32,943 [INFO]: 	index_param: efSearch=228
2025-03-13 12:52:32,943 [INFO]: 	index_path: knn.index
2025-03-13 12:52:32,943 [INFO]: 	size in bytes: 724607710
2025-03-13 12:52:32,943 [INFO]: 	avg_search_speed_ms: 10.712523837234802
2025-03-13 12:52:32,943 [INFO]: 	99p_search_speed_ms: 16.176672666333616
2025-03-13 12:52:32,943 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:52:32,943 [INFO]: 	nb vectors: 3683
2025-03-13 12:52:32,943 [INFO]: 	vectors dimension: 49152
2025-03-13 12:52:32,943 [INFO]: 	compression ratio: 0.9993093559548242
2025-03-13 12:52:32,943 [INFO]: }
2025-03-13 12:52:32,943 [INFO]: 	>>> Finished "Creating the index" in 68.0348 secs
2025-03-13 12:52:32,943 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0582 secs
2025-03-13 12:52:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:52:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 49387 [episode count 2/20]
[retrieval_preprocessing] for episode 33193 [episode count 3/20], we have num_retrieval=np.int64(3728) num_query=np.int64(166)
2025-03-13 12:52:35,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:52:35,715 [INFO]: Launching the whole pipeline 03/13/2025, 12:52:35
2025-03-13 12:52:35,715 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:52:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.41it/s]
2025-03-13 12:52:35,744 [INFO]: There are 3728 embeddings of dim 49152
2025-03-13 12:52:35,744 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 12:52:35,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:52:35
2025-03-13 12:52:35,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:52:35,744 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:52:35,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:52:35,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:52:35,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:52:35
2025-03-13 12:52:35,745 [INFO]: 769.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:52:35,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:52:35,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:52:35
2025-03-13 12:52:35,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:52:35,745 [INFO]: 	Creating the index 03/13/2025, 12:52:35
2025-03-13 12:52:35,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:52:35
2025-03-13 12:52:35,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:52:35,746 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:52:35
2025-03-13 12:52:35,746 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:52:35,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.81it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.13it/s] 87%|████████▋ | 13/15 [00:00<00:00, 43.83it/s]100%|██████████| 15/15 [00:03<00:00,  4.89it/s]
2025-03-13 12:52:38,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:52:38
2025-03-13 12:53:31,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5848 secs
2025-03-13 12:53:31,404 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 12:53:31,404 [INFO]: 	Compute fast metrics 03/13/2025, 12:53:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s]
2025-03-13 12:53:55,815 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4101 secs
2025-03-13 12:53:55,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.0718 secs
2025-03-13 12:53:55,818 [INFO]: {
2025-03-13 12:53:55,818 [INFO]: 	index_key: HNSW15
2025-03-13 12:53:55,818 [INFO]: 	index_param: efSearch=218
2025-03-13 12:53:55,818 [INFO]: 	index_path: knn.index
2025-03-13 12:53:55,818 [INFO]: 	size in bytes: 733461250
2025-03-13 12:53:55,818 [INFO]: 	avg_search_speed_ms: 14.009164012668535
2025-03-13 12:53:55,818 [INFO]: 	99p_search_speed_ms: 23.041098373942077
2025-03-13 12:53:55,818 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:55,818 [INFO]: 	nb vectors: 3728
2025-03-13 12:53:55,818 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:55,818 [INFO]: 	compression ratio: 0.9993092668494757
2025-03-13 12:53:55,818 [INFO]: }
2025-03-13 12:53:55,818 [INFO]: 	>>> Finished "Creating the index" in 80.0733 secs
2025-03-13 12:53:55,818 [INFO]: >>> Finished "Launching the whole pipeline" in 80.1035 secs
2025-03-13 12:53:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 33193 [episode count 3/20]
[retrieval_preprocessing] for episode 90542 [episode count 4/20], we have num_retrieval=np.int64(3702) num_query=np.int64(192)
2025-03-13 12:53:57,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:58,592 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:58
2025-03-13 12:53:58,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.14it/s]
2025-03-13 12:53:58,623 [INFO]: There are 3702 embeddings of dim 49152
2025-03-13 12:53:58,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 12:53:58,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:58
2025-03-13 12:53:58,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:58,625 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:53:58,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:53:58,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:53:58,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:58
2025-03-13 12:53:58,626 [INFO]: 764.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:58,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:53:58,626 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:58
2025-03-13 12:53:58,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:58,627 [INFO]: 	Creating the index 03/13/2025, 12:53:58
2025-03-13 12:53:58,627 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:53:58
2025-03-13 12:53:58,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:53:58,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:58
2025-03-13 12:53:58,631 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:53:58,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.65it/s] 33%|███▎      | 5/15 [00:00<00:00, 27.09it/s] 60%|██████    | 9/15 [00:00<00:00, 32.70it/s] 93%|█████████▎| 14/15 [00:00<00:00, 36.00it/s]100%|██████████| 15/15 [00:04<00:00,  3.74it/s]
2025-03-13 12:54:02,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:54:02
2025-03-13 12:54:46,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1596 secs
2025-03-13 12:54:46,810 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 12:54:46,810 [INFO]: 	Compute fast metrics 03/13/2025, 12:54:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.24s/it] 50%|█████     | 2/4 [00:05<00:05,  2.65s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.21s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.29s/it]
2025-03-13 12:55:10,769 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9586 secs
2025-03-13 12:55:10,771 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1407 secs
2025-03-13 12:55:10,771 [INFO]: {
2025-03-13 12:55:10,771 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:10,771 [INFO]: 	index_param: efSearch=232
2025-03-13 12:55:10,771 [INFO]: 	index_path: knn.index
2025-03-13 12:55:10,771 [INFO]: 	size in bytes: 728345770
2025-03-13 12:55:10,772 [INFO]: 	avg_search_speed_ms: 10.863449115328386
2025-03-13 12:55:10,772 [INFO]: 	99p_search_speed_ms: 18.40094397775829
2025-03-13 12:55:10,772 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:10,772 [INFO]: 	nb vectors: 3702
2025-03-13 12:55:10,772 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:10,772 [INFO]: 	compression ratio: 0.9993094571003001
2025-03-13 12:55:10,772 [INFO]: }
2025-03-13 12:55:10,772 [INFO]: 	>>> Finished "Creating the index" in 72.1449 secs
2025-03-13 12:55:10,772 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1798 secs
2025-03-13 12:55:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 90542 [episode count 4/20]
[retrieval_preprocessing] for episode 16967 [episode count 5/20], we have num_retrieval=np.int64(3645) num_query=np.int64(249)
2025-03-13 12:55:12,787 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:13,306 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:13
2025-03-13 12:55:13,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.00it/s]
2025-03-13 12:55:13,336 [INFO]: There are 3645 embeddings of dim 49152
2025-03-13 12:55:13,337 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 12:55:13,337 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:13
2025-03-13 12:55:13,338 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:13,338 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:55:13,338 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:13,338 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:55:13,338 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:13
2025-03-13 12:55:13,339 [INFO]: 752.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:13,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:55:13,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:13
2025-03-13 12:55:13,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:13,340 [INFO]: 	Creating the index 03/13/2025, 12:55:13
2025-03-13 12:55:13,340 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:13
2025-03-13 12:55:13,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:55:13,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:13
2025-03-13 12:55:13,344 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:55:13,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.56it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.96it/s] 80%|████████  | 12/15 [00:00<00:00, 41.55it/s]100%|██████████| 15/15 [00:02<00:00,  5.52it/s]
2025-03-13 12:55:16,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:16
2025-03-13 12:55:59,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0638 secs
2025-03-13 12:55:59,130 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 12:55:59,130 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.00it/s]
2025-03-13 12:56:18,402 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2719 secs
2025-03-13 12:56:18,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0612 secs
2025-03-13 12:56:18,405 [INFO]: {
2025-03-13 12:56:18,405 [INFO]: 	index_key: HNSW15
2025-03-13 12:56:18,405 [INFO]: 	index_param: efSearch=220
2025-03-13 12:56:18,405 [INFO]: 	index_path: knn.index
2025-03-13 12:56:18,405 [INFO]: 	size in bytes: 717131530
2025-03-13 12:56:18,405 [INFO]: 	avg_search_speed_ms: 8.515854704461903
2025-03-13 12:56:18,405 [INFO]: 	99p_search_speed_ms: 11.885166682768611
2025-03-13 12:56:18,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:18,405 [INFO]: 	nb vectors: 3645
2025-03-13 12:56:18,405 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:18,405 [INFO]: 	compression ratio: 0.9993092341093969
2025-03-13 12:56:18,405 [INFO]: }
2025-03-13 12:56:18,405 [INFO]: 	>>> Finished "Creating the index" in 65.0653 secs
2025-03-13 12:56:18,405 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0984 secs
2025-03-13 12:56:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 16967 [episode count 5/20]
[retrieval_preprocessing] for episode 49507 [episode count 6/20], we have num_retrieval=np.int64(3703) num_query=np.int64(191)
2025-03-13 12:56:20,394 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:20,869 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:20
2025-03-13 12:56:20,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2302.03it/s]
2025-03-13 12:56:20,894 [INFO]: There are 3703 embeddings of dim 49152
2025-03-13 12:56:20,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 12:56:20,895 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:20
2025-03-13 12:56:20,895 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:20,895 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:56:20,895 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:56:20,895 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:56:20,895 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:20
2025-03-13 12:56:20,896 [INFO]: 764.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:20,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:56:20,896 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:20
2025-03-13 12:56:20,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:20,896 [INFO]: 	Creating the index 03/13/2025, 12:56:20
2025-03-13 12:56:20,897 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:56:20
2025-03-13 12:56:20,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:56:20,900 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:20
2025-03-13 12:56:20,900 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:56:20,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 26.47it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.85it/s] 93%|█████████▎| 14/15 [00:00<00:00, 45.75it/s]100%|██████████| 15/15 [00:02<00:00,  5.45it/s]
2025-03-13 12:56:23,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:23
2025-03-13 12:57:02,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4656 secs
2025-03-13 12:57:02,125 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:57:02,125 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 12:57:20,718 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5927 secs
2025-03-13 12:57:20,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8202 secs
2025-03-13 12:57:20,720 [INFO]: {
2025-03-13 12:57:20,720 [INFO]: 	index_key: HNSW15
2025-03-13 12:57:20,720 [INFO]: 	index_param: efSearch=207
2025-03-13 12:57:20,720 [INFO]: 	index_path: knn.index
2025-03-13 12:57:20,720 [INFO]: 	size in bytes: 728542510
2025-03-13 12:57:20,720 [INFO]: 	avg_search_speed_ms: 9.144908178195875
2025-03-13 12:57:20,720 [INFO]: 	99p_search_speed_ms: 13.50411907769738
2025-03-13 12:57:20,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:57:20,720 [INFO]: 	nb vectors: 3703
2025-03-13 12:57:20,720 [INFO]: 	vectors dimension: 49152
2025-03-13 12:57:20,720 [INFO]: 	compression ratio: 0.9993094623949946
2025-03-13 12:57:20,720 [INFO]: }
2025-03-13 12:57:20,720 [INFO]: 	>>> Finished "Creating the index" in 59.8239 secs
2025-03-13 12:57:20,720 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8514 secs
2025-03-13 12:57:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:57:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 49507 [episode count 6/20]
[retrieval_preprocessing] for episode 25424 [episode count 7/20], we have num_retrieval=np.int64(3673) num_query=np.int64(221)
2025-03-13 12:57:32,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:57:34,166 [INFO]: Launching the whole pipeline 03/13/2025, 12:57:34
2025-03-13 12:57:34,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:57:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.96it/s]
2025-03-13 12:57:34,191 [INFO]: There are 3673 embeddings of dim 49152
2025-03-13 12:57:34,191 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 12:57:34,191 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:57:34
2025-03-13 12:57:34,191 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:57:34,191 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:57:34,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:57:34,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:57:34,191 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:57:34
2025-03-13 12:57:34,191 [INFO]: 758.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:57:34,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:57:34,191 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:57:34
2025-03-13 12:57:34,191 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:57:34,191 [INFO]: 	Creating the index 03/13/2025, 12:57:34
2025-03-13 12:57:34,191 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:57:34
2025-03-13 12:57:34,192 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:57:34,192 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:57:34
2025-03-13 12:57:34,192 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:57:34,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.84it/s] 40%|████      | 6/15 [00:00<00:00, 29.71it/s] 80%|████████  | 12/15 [00:00<00:00, 39.85it/s]100%|██████████| 15/15 [00:03<00:00,  4.98it/s]
2025-03-13 12:57:37,206 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:57:37
2025-03-13 12:58:14,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5091 secs
2025-03-13 12:58:14,716 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 12:58:14,716 [INFO]: 	Compute fast metrics 03/13/2025, 12:58:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.90it/s]
2025-03-13 12:58:35,069 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3529 secs
2025-03-13 12:58:35,071 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8788 secs
2025-03-13 12:58:35,071 [INFO]: {
2025-03-13 12:58:35,071 [INFO]: 	index_key: HNSW15
2025-03-13 12:58:35,071 [INFO]: 	index_param: efSearch=250
2025-03-13 12:58:35,071 [INFO]: 	index_path: knn.index
2025-03-13 12:58:35,071 [INFO]: 	size in bytes: 722640310
2025-03-13 12:58:35,071 [INFO]: 	avg_search_speed_ms: 12.883302116493288
2025-03-13 12:58:35,071 [INFO]: 	99p_search_speed_ms: 20.903909504413605
2025-03-13 12:58:35,071 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:35,072 [INFO]: 	nb vectors: 3673
2025-03-13 12:58:35,072 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:35,072 [INFO]: 	compression ratio: 0.9993093023000613
2025-03-13 12:58:35,072 [INFO]: }
2025-03-13 12:58:35,072 [INFO]: 	>>> Finished "Creating the index" in 60.8801 secs
2025-03-13 12:58:35,072 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9055 secs
2025-03-13 12:58:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 25424 [episode count 7/20]
[retrieval_preprocessing] for episode 9495 [episode count 8/20], we have num_retrieval=np.int64(3717) num_query=np.int64(177)
2025-03-13 12:58:37,464 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:37,941 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:37
2025-03-13 12:58:37,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.84it/s]
2025-03-13 12:58:37,975 [INFO]: There are 3717 embeddings of dim 49152
2025-03-13 12:58:37,975 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 12:58:37,976 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:37,976 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:58:37,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:58:37,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 12:58:37,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,978 [INFO]: 767.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:37,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 12:58:37,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:37
2025-03-13 12:58:37,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:37,979 [INFO]: 	Creating the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:37
2025-03-13 12:58:37,985 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0052 secs
2025-03-13 12:58:37,985 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,985 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:58:37,986 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 15.96it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.21it/s] 80%|████████  | 12/15 [00:00<00:00, 37.58it/s]100%|██████████| 15/15 [00:03<00:00,  3.97it/s]
2025-03-13 12:58:41,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:41
2025-03-13 12:59:25,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0168 secs
2025-03-13 12:59:25,789 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 12:59:25,789 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 12:59:44,066 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2773 secs
2025-03-13 12:59:44,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0836 secs
2025-03-13 12:59:44,069 [INFO]: {
2025-03-13 12:59:44,069 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:44,069 [INFO]: 	index_param: efSearch=177
2025-03-13 12:59:44,069 [INFO]: 	index_path: knn.index
2025-03-13 12:59:44,069 [INFO]: 	size in bytes: 731296930
2025-03-13 12:59:44,069 [INFO]: 	avg_search_speed_ms: 8.05724091192979
2025-03-13 12:59:44,069 [INFO]: 	99p_search_speed_ms: 11.077110609039643
2025-03-13 12:59:44,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:44,069 [INFO]: 	nb vectors: 3717
2025-03-13 12:59:44,069 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:44,069 [INFO]: 	compression ratio: 0.9993094542322227
2025-03-13 12:59:44,069 [INFO]: }
2025-03-13 12:59:44,070 [INFO]: 	>>> Finished "Creating the index" in 66.0905 secs
2025-03-13 12:59:44,070 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1285 secs
2025-03-13 12:59:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 9495 [episode count 8/20]
[retrieval_preprocessing] for episode 1321 [episode count 9/20], we have num_retrieval=np.int64(3687) num_query=np.int64(207)
2025-03-13 12:59:45,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:46,431 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:46
2025-03-13 12:59:46,431 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1623.18it/s]
2025-03-13 12:59:46,456 [INFO]: There are 3687 embeddings of dim 49152
2025-03-13 12:59:46,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 12:59:46,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:46
2025-03-13 12:59:46,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:46,456 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:59:46,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:46,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:59:46,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:46
2025-03-13 12:59:46,457 [INFO]: 760.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:46,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:59:46,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:46
2025-03-13 12:59:46,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:46,457 [INFO]: 	Creating the index 03/13/2025, 12:59:46
2025-03-13 12:59:46,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:46
2025-03-13 12:59:46,458 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:59:46,458 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:46
2025-03-13 12:59:46,458 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:59:46,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.58it/s] 40%|████      | 6/15 [00:00<00:00, 27.22it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.69it/s]100%|██████████| 15/15 [00:02<00:00,  3.80it/s]100%|██████████| 15/15 [00:02<00:00,  5.19it/s]
2025-03-13 12:59:49,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:49
2025-03-13 13:00:26,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3420 secs
2025-03-13 13:00:26,694 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 13:00:26,694 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 13:00:44,316 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6219 secs
2025-03-13 13:00:44,709 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2513 secs
2025-03-13 13:00:44,709 [INFO]: {
2025-03-13 13:00:44,710 [INFO]: 	index_key: HNSW15
2025-03-13 13:00:44,710 [INFO]: 	index_param: efSearch=241
2025-03-13 13:00:44,710 [INFO]: 	index_path: knn.index
2025-03-13 13:00:44,710 [INFO]: 	size in bytes: 725394670
2025-03-13 13:00:44,710 [INFO]: 	avg_search_speed_ms: 13.973922977632421
2025-03-13 13:00:44,710 [INFO]: 	99p_search_speed_ms: 21.400124521460384
2025-03-13 13:00:44,710 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:44,710 [INFO]: 	nb vectors: 3687
2025-03-13 13:00:44,710 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:44,710 [INFO]: 	compression ratio: 0.9993093773352374
2025-03-13 13:00:44,710 [INFO]: }
2025-03-13 13:00:44,710 [INFO]: 	>>> Finished "Creating the index" in 58.2535 secs
2025-03-13 13:00:44,710 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2793 secs
2025-03-13 13:00:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 1321 [episode count 9/20]
[retrieval_preprocessing] for episode 66655 [episode count 10/20], we have num_retrieval=np.int64(3726) num_query=np.int64(168)
2025-03-13 13:00:47,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:48,012 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:48
2025-03-13 13:00:48,012 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2253.79it/s]
2025-03-13 13:00:48,040 [INFO]: There are 3726 embeddings of dim 49152
2025-03-13 13:00:48,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 13:00:48,040 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:48
2025-03-13 13:00:48,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:48,041 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:00:48,041 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:00:48,041 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:48,041 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:48
2025-03-13 13:00:48,041 [INFO]: 769.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:48,041 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:00:48,041 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:48
2025-03-13 13:00:48,041 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:48,041 [INFO]: 	Creating the index 03/13/2025, 13:00:48
2025-03-13 13:00:48,041 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:00:48
2025-03-13 13:00:48,042 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:00:48,042 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:48
2025-03-13 13:00:48,042 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:00:48,042 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.99it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.54it/s] 87%|████████▋ | 13/15 [00:00<00:00, 40.96it/s]100%|██████████| 15/15 [00:03<00:00,  4.50it/s]
2025-03-13 13:00:51,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:51
2025-03-13 13:01:27,136 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7589 secs
2025-03-13 13:01:27,137 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 13:01:27,137 [INFO]: 	Compute fast metrics 03/13/2025, 13:01:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.33it/s]
2025-03-13 13:02:04,163 [INFO]: 	>>> Finished "Compute fast metrics" in 37.0262 secs
2025-03-13 13:02:04,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1231 secs
2025-03-13 13:02:04,165 [INFO]: {
2025-03-13 13:02:04,165 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:04,165 [INFO]: 	index_param: efSearch=242
2025-03-13 13:02:04,165 [INFO]: 	index_path: knn.index
2025-03-13 13:02:04,165 [INFO]: 	size in bytes: 733067710
2025-03-13 13:02:04,165 [INFO]: 	avg_search_speed_ms: 11.911533588898324
2025-03-13 13:02:04,165 [INFO]: 	99p_search_speed_ms: 18.02185390144587
2025-03-13 13:02:04,165 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:04,165 [INFO]: 	nb vectors: 3726
2025-03-13 13:02:04,165 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:04,165 [INFO]: 	compression ratio: 0.999309338014629
2025-03-13 13:02:04,166 [INFO]: }
2025-03-13 13:02:04,166 [INFO]: 	>>> Finished "Creating the index" in 76.1246 secs
2025-03-13 13:02:04,166 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1536 secs
2025-03-13 13:02:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 66655 [episode count 10/20]
[retrieval_preprocessing] for episode 93980 [episode count 11/20], we have num_retrieval=np.int64(3666) num_query=np.int64(228)
2025-03-13 13:02:06,494 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:07,216 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:07
2025-03-13 13:02:07,216 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.38it/s]
2025-03-13 13:02:07,244 [INFO]: There are 3666 embeddings of dim 49152
2025-03-13 13:02:07,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 13:02:07,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:07
2025-03-13 13:02:07,245 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:07,245 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:02:07,245 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:07,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:02:07,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:07
2025-03-13 13:02:07,245 [INFO]: 756.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:07,246 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:02:07,246 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:07
2025-03-13 13:02:07,246 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:07,246 [INFO]: 	Creating the index 03/13/2025, 13:02:07
2025-03-13 13:02:07,246 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:07
2025-03-13 13:02:07,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 13:02:07,249 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:07
2025-03-13 13:02:07,249 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:02:07,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.13it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.99it/s] 80%|████████  | 12/15 [00:00<00:00, 36.71it/s]100%|██████████| 15/15 [00:03<00:00,  4.05it/s]
2025-03-13 13:02:10,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:10
2025-03-13 13:02:51,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1600 secs
2025-03-13 13:02:51,116 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 13:02:51,116 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-13 13:03:09,071 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9552 secs
2025-03-13 13:03:09,074 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8250 secs
2025-03-13 13:03:09,075 [INFO]: {
2025-03-13 13:03:09,075 [INFO]: 	index_key: HNSW15
2025-03-13 13:03:09,075 [INFO]: 	index_param: efSearch=251
2025-03-13 13:03:09,075 [INFO]: 	index_path: knn.index
2025-03-13 13:03:09,075 [INFO]: 	size in bytes: 721263130
2025-03-13 13:03:09,075 [INFO]: 	avg_search_speed_ms: 14.176658571370622
2025-03-13 13:03:09,075 [INFO]: 	99p_search_speed_ms: 20.954519754741344
2025-03-13 13:03:09,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:03:09,075 [INFO]: 	nb vectors: 3666
2025-03-13 13:03:09,075 [INFO]: 	vectors dimension: 49152
2025-03-13 13:03:09,075 [INFO]: 	compression ratio: 0.999309264567565
2025-03-13 13:03:09,075 [INFO]: }
2025-03-13 13:03:09,075 [INFO]: 	>>> Finished "Creating the index" in 61.8287 secs
2025-03-13 13:03:09,075 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8586 secs
2025-03-13 13:03:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:03:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 93980 [episode count 11/20]
[retrieval_preprocessing] for episode 26729 [episode count 12/20], we have num_retrieval=np.int64(3700) num_query=np.int64(194)
2025-03-13 13:03:13,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:03:14,125 [INFO]: Launching the whole pipeline 03/13/2025, 13:03:14
2025-03-13 13:03:14,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:03:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2022.33it/s]
2025-03-13 13:03:14,159 [INFO]: There are 3700 embeddings of dim 49152
2025-03-13 13:03:14,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 13:03:14,160 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:03:14
2025-03-13 13:03:14,160 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:03:14,160 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:03:14,160 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:03:14,160 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:03:14,160 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:03:14
2025-03-13 13:03:14,160 [INFO]: 763.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:03:14,160 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:03:14,160 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:03:14
2025-03-13 13:03:14,160 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:03:14,160 [INFO]: 	Creating the index 03/13/2025, 13:03:14
2025-03-13 13:03:14,160 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:03:14
2025-03-13 13:03:14,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:03:14,162 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:03:14
2025-03-13 13:03:14,162 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:03:14,162 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.17it/s] 40%|████      | 6/15 [00:00<00:00, 26.93it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.98it/s]100%|██████████| 15/15 [00:04<00:00,  2.32it/s]100%|██████████| 15/15 [00:04<00:00,  3.25it/s]
2025-03-13 13:03:18,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:18
2025-03-13 13:04:22,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.5058 secs
2025-03-13 13:04:22,292 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 13:04:22,292 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.03it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s]
2025-03-13 13:04:47,119 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8270 secs
2025-03-13 13:04:47,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.9604 secs
2025-03-13 13:04:47,122 [INFO]: {
2025-03-13 13:04:47,122 [INFO]: 	index_key: HNSW15
2025-03-13 13:04:47,122 [INFO]: 	index_param: efSearch=242
2025-03-13 13:04:47,122 [INFO]: 	index_path: knn.index
2025-03-13 13:04:47,122 [INFO]: 	size in bytes: 727952290
2025-03-13 13:04:47,122 [INFO]: 	avg_search_speed_ms: 11.233536692681524
2025-03-13 13:04:47,122 [INFO]: 	99p_search_speed_ms: 17.208387544378642
2025-03-13 13:04:47,122 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:47,122 [INFO]: 	nb vectors: 3700
2025-03-13 13:04:47,122 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:47,122 [INFO]: 	compression ratio: 0.999309446502325
2025-03-13 13:04:47,122 [INFO]: }
2025-03-13 13:04:47,122 [INFO]: 	>>> Finished "Creating the index" in 92.9621 secs
2025-03-13 13:04:47,122 [INFO]: >>> Finished "Launching the whole pipeline" in 92.9973 secs
2025-03-13 13:04:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:04:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 26729 [episode count 12/20]
[retrieval_preprocessing] for episode 43794 [episode count 13/20], we have num_retrieval=np.int64(3731) num_query=np.int64(163)
2025-03-13 13:04:49,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:50,182 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:50
2025-03-13 13:04:50,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1284.63it/s]
2025-03-13 13:04:50,211 [INFO]: There are 3731 embeddings of dim 49152
2025-03-13 13:04:50,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 13:04:50,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:50,211 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:04:50,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:04:50,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:04:50,211 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,211 [INFO]: 770.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:50,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:04:50,211 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:50
2025-03-13 13:04:50,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:50,211 [INFO]: 	Creating the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,211 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:04:50
2025-03-13 13:04:50,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:04:50,213 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,213 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:04:50,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.84it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.10it/s] 87%|████████▋ | 13/15 [00:00<00:00, 43.59it/s]100%|██████████| 15/15 [00:03<00:00,  4.23it/s]
2025-03-13 13:04:53,761 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:04:53
2025-03-13 13:05:39,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6784 secs
2025-03-13 13:05:39,440 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 13:05:39,440 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.06it/s]
2025-03-13 13:06:03,474 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0340 secs
2025-03-13 13:06:03,476 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2634 secs
2025-03-13 13:06:03,476 [INFO]: {
2025-03-13 13:06:03,476 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:03,476 [INFO]: 	index_param: efSearch=231
2025-03-13 13:06:03,476 [INFO]: 	index_path: knn.index
2025-03-13 13:06:03,476 [INFO]: 	size in bytes: 734051470
2025-03-13 13:06:03,476 [INFO]: 	avg_search_speed_ms: 9.391805217841842
2025-03-13 13:06:03,476 [INFO]: 	99p_search_speed_ms: 12.678714739158748
2025-03-13 13:06:03,476 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:03,476 [INFO]: 	nb vectors: 3731
2025-03-13 13:06:03,476 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:03,476 [INFO]: 	compression ratio: 0.9993092827673242
2025-03-13 13:06:03,476 [INFO]: }
2025-03-13 13:06:03,476 [INFO]: 	>>> Finished "Creating the index" in 73.2650 secs
2025-03-13 13:06:03,476 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2941 secs
2025-03-13 13:06:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 43794 [episode count 13/20]
[retrieval_preprocessing] for episode 87539 [episode count 14/20], we have num_retrieval=np.int64(3713) num_query=np.int64(181)
2025-03-13 13:06:05,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:06,434 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:06
2025-03-13 13:06:06,435 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.71it/s]
2025-03-13 13:06:06,466 [INFO]: There are 3713 embeddings of dim 49152
2025-03-13 13:06:06,466 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 13:06:06,466 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:06
2025-03-13 13:06:06,466 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:06,466 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:06:06,466 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:06,466 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:06:06,466 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:06
2025-03-13 13:06:06,466 [INFO]: 766.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:06,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:06:06,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:06
2025-03-13 13:06:06,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:06,467 [INFO]: 	Creating the index 03/13/2025, 13:06:06
2025-03-13 13:06:06,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:06
2025-03-13 13:06:06,467 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:06:06,468 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:06
2025-03-13 13:06:06,468 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:06:06,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.26it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.16it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.59it/s]100%|██████████| 15/15 [00:02<00:00,  5.22it/s]
2025-03-13 13:06:09,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:09
2025-03-13 13:06:48,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8748 secs
2025-03-13 13:06:48,222 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 13:06:48,222 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.13it/s]
2025-03-13 13:07:08,619 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3969 secs
2025-03-13 13:07:08,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1542 secs
2025-03-13 13:07:08,623 [INFO]: {
2025-03-13 13:07:08,623 [INFO]: 	index_key: HNSW15
2025-03-13 13:07:08,623 [INFO]: 	index_param: efSearch=218
2025-03-13 13:07:08,623 [INFO]: 	index_path: knn.index
2025-03-13 13:07:08,623 [INFO]: 	size in bytes: 730509970
2025-03-13 13:07:08,623 [INFO]: 	avg_search_speed_ms: 10.89938374465506
2025-03-13 13:07:08,623 [INFO]: 	99p_search_speed_ms: 15.48996023600921
2025-03-13 13:07:08,623 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:08,623 [INFO]: 	nb vectors: 3713
2025-03-13 13:07:08,623 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:08,623 [INFO]: 	compression ratio: 0.9993094331073948
2025-03-13 13:07:08,623 [INFO]: }
2025-03-13 13:07:08,623 [INFO]: 	>>> Finished "Creating the index" in 62.1564 secs
2025-03-13 13:07:08,623 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1884 secs
2025-03-13 13:07:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 87539 [episode count 14/20]
[retrieval_preprocessing] for episode 61385 [episode count 15/20], we have num_retrieval=np.int64(3741) num_query=np.int64(153)
2025-03-13 13:07:10,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:11,090 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:11
2025-03-13 13:07:11,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1173.89it/s]
2025-03-13 13:07:11,116 [INFO]: There are 3741 embeddings of dim 49152
2025-03-13 13:07:11,116 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 13:07:11,116 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:11
2025-03-13 13:07:11,117 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:11,117 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:07:11,117 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:07:11,117 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:07:11,117 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:11
2025-03-13 13:07:11,117 [INFO]: 772.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:11,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:07:11,117 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:11
2025-03-13 13:07:11,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:11,117 [INFO]: 	Creating the index 03/13/2025, 13:07:11
2025-03-13 13:07:11,117 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:07:11
2025-03-13 13:07:11,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:07:11,118 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:11
2025-03-13 13:07:11,118 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:07:11,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.83it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.49it/s] 87%|████████▋ | 13/15 [00:00<00:00, 44.76it/s]100%|██████████| 15/15 [00:02<00:00,  5.01it/s]
2025-03-13 13:07:14,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:14
2025-03-13 13:08:01,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8639 secs
2025-03-13 13:08:01,980 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 13:08:01,980 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 13:08:17,786 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8056 secs
2025-03-13 13:08:17,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6698 secs
2025-03-13 13:08:17,788 [INFO]: {
2025-03-13 13:08:17,788 [INFO]: 	index_key: HNSW15
2025-03-13 13:08:17,788 [INFO]: 	index_param: efSearch=220
2025-03-13 13:08:17,788 [INFO]: 	index_path: knn.index
2025-03-13 13:08:17,788 [INFO]: 	size in bytes: 736018990
2025-03-13 13:08:17,788 [INFO]: 	avg_search_speed_ms: 9.510769281924096
2025-03-13 13:08:17,788 [INFO]: 	99p_search_speed_ms: 15.806585710961372
2025-03-13 13:08:17,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:17,788 [INFO]: 	nb vectors: 3741
2025-03-13 13:08:17,788 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:17,788 [INFO]: 	compression ratio: 0.9993091727157747
2025-03-13 13:08:17,788 [INFO]: }
2025-03-13 13:08:17,788 [INFO]: 	>>> Finished "Creating the index" in 66.6714 secs
2025-03-13 13:08:17,788 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6985 secs
2025-03-13 13:08:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 61385 [episode count 15/20]
[retrieval_preprocessing] for episode 63010 [episode count 16/20], we have num_retrieval=np.int64(3700) num_query=np.int64(194)
2025-03-13 13:08:19,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:19,654 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:19
2025-03-13 13:08:19,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 13:08:19,685 [INFO]: There are 3700 embeddings of dim 49152
2025-03-13 13:08:19,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 13:08:19,685 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,685 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:19,685 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:08:19,685 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:08:19,685 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:08:19,685 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,685 [INFO]: 763.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:19,685 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:08:19,685 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:19
2025-03-13 13:08:19,685 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:19,686 [INFO]: 	Creating the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,686 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:08:19
2025-03-13 13:08:19,686 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:08:19,687 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:19
2025-03-13 13:08:19,687 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:08:19,687 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.14it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.94it/s] 87%|████████▋ | 13/15 [00:00<00:00, 44.76it/s]100%|██████████| 15/15 [00:03<00:00,  4.90it/s]
2025-03-13 13:08:22,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:22
2025-03-13 13:09:09,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3819 secs
2025-03-13 13:09:09,131 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 13:09:09,131 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.31it/s]
2025-03-13 13:09:23,760 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6294 secs
2025-03-13 13:09:23,762 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0757 secs
2025-03-13 13:09:23,762 [INFO]: {
2025-03-13 13:09:23,762 [INFO]: 	index_key: HNSW15
2025-03-13 13:09:23,762 [INFO]: 	index_param: efSearch=218
2025-03-13 13:09:23,762 [INFO]: 	index_path: knn.index
2025-03-13 13:09:23,762 [INFO]: 	size in bytes: 727952290
2025-03-13 13:09:23,762 [INFO]: 	avg_search_speed_ms: 9.769335703367688
2025-03-13 13:09:23,762 [INFO]: 	99p_search_speed_ms: 14.377035212237388
2025-03-13 13:09:23,762 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:23,763 [INFO]: 	nb vectors: 3700
2025-03-13 13:09:23,763 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:23,763 [INFO]: 	compression ratio: 0.999309446502325
2025-03-13 13:09:23,763 [INFO]: }
2025-03-13 13:09:23,763 [INFO]: 	>>> Finished "Creating the index" in 64.0770 secs
2025-03-13 13:09:23,763 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1083 secs
2025-03-13 13:09:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 63010 [episode count 16/20]
[retrieval_preprocessing] for episode 69888 [episode count 17/20], we have num_retrieval=np.int64(3659) num_query=np.int64(235)
2025-03-13 13:09:25,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:09:25,937 [INFO]: Launching the whole pipeline 03/13/2025, 13:09:25
2025-03-13 13:09:25,937 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:09:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2179.99it/s]
2025-03-13 13:09:25,962 [INFO]: There are 3659 embeddings of dim 49152
2025-03-13 13:09:25,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 13:09:25,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:09:25
2025-03-13 13:09:25,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:09:25,963 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:09:25,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:09:25,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:09:25,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:09:25
2025-03-13 13:09:25,964 [INFO]: 755.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:09:25,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:09:25,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:09:25
2025-03-13 13:09:25,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:09:25,965 [INFO]: 	Creating the index 03/13/2025, 13:09:25
2025-03-13 13:09:25,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:09:25
2025-03-13 13:09:25,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:09:25,968 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:09:25
2025-03-13 13:09:25,969 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:09:25,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 25.18it/s] 60%|██████    | 9/15 [00:00<00:00, 40.35it/s]100%|██████████| 15/15 [00:03<00:00,  3.81it/s]100%|██████████| 15/15 [00:03<00:00,  4.75it/s]
2025-03-13 13:09:29,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:09:29
2025-03-13 13:10:16,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5753 secs
2025-03-13 13:10:16,708 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 13:10:16,708 [INFO]: 	Compute fast metrics 03/13/2025, 13:10:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.01it/s]
2025-03-13 13:10:39,222 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5137 secs
2025-03-13 13:10:39,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2561 secs
2025-03-13 13:10:39,225 [INFO]: {
2025-03-13 13:10:39,225 [INFO]: 	index_key: HNSW15
2025-03-13 13:10:39,225 [INFO]: 	index_param: efSearch=241
2025-03-13 13:10:39,225 [INFO]: 	index_path: knn.index
2025-03-13 13:10:39,225 [INFO]: 	size in bytes: 719885950
2025-03-13 13:10:39,225 [INFO]: 	avg_search_speed_ms: 13.53146827462128
2025-03-13 13:10:39,225 [INFO]: 	99p_search_speed_ms: 20.29313320759684
2025-03-13 13:10:39,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:39,225 [INFO]: 	nb vectors: 3659
2025-03-13 13:10:39,225 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:39,225 [INFO]: 	compression ratio: 0.9993092266907001
2025-03-13 13:10:39,225 [INFO]: }
2025-03-13 13:10:39,225 [INFO]: 	>>> Finished "Creating the index" in 73.2602 secs
2025-03-13 13:10:39,225 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2879 secs
2025-03-13 13:10:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 69888 [episode count 17/20]
[retrieval_preprocessing] for episode 70217 [episode count 18/20], we have num_retrieval=np.int64(3719) num_query=np.int64(175)
2025-03-13 13:10:43,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:44,487 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:44
2025-03-13 13:10:44,487 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.01it/s]
2025-03-13 13:10:44,515 [INFO]: There are 3719 embeddings of dim 49152
2025-03-13 13:10:44,515 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 13:10:44,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:44
2025-03-13 13:10:44,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:44,516 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:10:44,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:44,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:10:44,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:44
2025-03-13 13:10:44,516 [INFO]: 767.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:44,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:10:44,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:44
2025-03-13 13:10:44,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:44,516 [INFO]: 	Creating the index 03/13/2025, 13:10:44
2025-03-13 13:10:44,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:44
2025-03-13 13:10:44,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:10:44,518 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:44
2025-03-13 13:10:44,518 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:10:44,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.91it/s] 33%|███▎      | 5/15 [00:00<00:00, 23.28it/s] 60%|██████    | 9/15 [00:00<00:00, 28.74it/s] 87%|████████▋ | 13/15 [00:00<00:00, 31.37it/s]100%|██████████| 15/15 [00:03<00:00,  3.99it/s]
2025-03-13 13:10:48,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:48
2025-03-13 13:11:29,806 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5188 secs
2025-03-13 13:11:29,806 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 13:11:29,806 [INFO]: 	Compute fast metrics 03/13/2025, 13:11:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 13:11:47,181 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3751 secs
2025-03-13 13:11:47,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6656 secs
2025-03-13 13:11:47,183 [INFO]: {
2025-03-13 13:11:47,183 [INFO]: 	index_key: HNSW15
2025-03-13 13:11:47,183 [INFO]: 	index_param: efSearch=241
2025-03-13 13:11:47,183 [INFO]: 	index_path: knn.index
2025-03-13 13:11:47,183 [INFO]: 	size in bytes: 731690410
2025-03-13 13:11:47,183 [INFO]: 	avg_search_speed_ms: 10.103724702176722
2025-03-13 13:11:47,183 [INFO]: 	99p_search_speed_ms: 14.820975079201164
2025-03-13 13:11:47,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:11:47,183 [INFO]: 	nb vectors: 3719
2025-03-13 13:11:47,183 [INFO]: 	vectors dimension: 49152
2025-03-13 13:11:47,183 [INFO]: 	compression ratio: 0.9993094647775963
2025-03-13 13:11:47,183 [INFO]: }
2025-03-13 13:11:47,183 [INFO]: 	>>> Finished "Creating the index" in 62.6672 secs
2025-03-13 13:11:47,184 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6962 secs
2025-03-13 13:11:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:11:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 70217 [episode count 18/20]
[retrieval_preprocessing] for episode 51215 [episode count 19/20], we have num_retrieval=np.int64(3695) num_query=np.int64(199)
2025-03-13 13:11:49,129 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:11:49,585 [INFO]: Launching the whole pipeline 03/13/2025, 13:11:49
2025-03-13 13:11:49,585 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:11:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1263.73it/s]
2025-03-13 13:11:49,616 [INFO]: There are 3695 embeddings of dim 49152
2025-03-13 13:11:49,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 13:11:49,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:11:49
2025-03-13 13:11:49,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:11:49,616 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:11:49,616 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:11:49,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:11:49,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:11:49
2025-03-13 13:11:49,617 [INFO]: 762.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:11:49,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:11:49,617 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:11:49
2025-03-13 13:11:49,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:11:49,617 [INFO]: 	Creating the index 03/13/2025, 13:11:49
2025-03-13 13:11:49,617 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:11:49
2025-03-13 13:11:49,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:11:49,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:11:49
2025-03-13 13:11:49,618 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:11:49,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.37it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.39it/s] 80%|████████  | 12/15 [00:00<00:00, 40.56it/s]100%|██████████| 15/15 [00:03<00:00,  4.88it/s]
2025-03-13 13:11:52,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:11:52
2025-03-13 13:12:39,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7111 secs
2025-03-13 13:12:39,409 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 13:12:39,409 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 13:13:06,083 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6740 secs
2025-03-13 13:13:06,526 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.9086 secs
2025-03-13 13:13:06,527 [INFO]: {
2025-03-13 13:13:06,527 [INFO]: 	index_key: HNSW15
2025-03-13 13:13:06,527 [INFO]: 	index_param: efSearch=242
2025-03-13 13:13:06,527 [INFO]: 	index_path: knn.index
2025-03-13 13:13:06,527 [INFO]: 	size in bytes: 726968590
2025-03-13 13:13:06,527 [INFO]: 	avg_search_speed_ms: 9.960109215374457
2025-03-13 13:13:06,527 [INFO]: 	99p_search_speed_ms: 13.454103288240734
2025-03-13 13:13:06,527 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:06,527 [INFO]: 	nb vectors: 3695
2025-03-13 13:13:06,527 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:06,527 [INFO]: 	compression ratio: 0.9993094199571951
2025-03-13 13:13:06,527 [INFO]: }
2025-03-13 13:13:06,527 [INFO]: 	>>> Finished "Creating the index" in 76.9106 secs
2025-03-13 13:13:06,527 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9428 secs
2025-03-13 13:13:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 51215 [episode count 19/20]
2025-03-13 13:13:08: [retrieval_preprocessing] finished for -1_remove_marker_from_pot [chosen_id count 7/260]
2025-03-13 13:13:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1058976383_put_item_on_windowsill [chosen_id count 8/260]
2025-03-13 13:13:10: [retrieval_preprocessing] we have num_total=3989 embedding_dim=49152
[retrieval_preprocessing] for episode 38941 [episode count 0/20], we have num_retrieval=np.int64(3801) num_query=np.int64(188)
2025-03-13 13:13:10,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:11,465 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:11
2025-03-13 13:13:11,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2357.68it/s]
2025-03-13 13:13:11,489 [INFO]: There are 3801 embeddings of dim 49152
2025-03-13 13:13:11,490 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 13:13:11,490 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:11
2025-03-13 13:13:11,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:11,490 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:13:11,490 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:13:11,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:13:11,490 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:11
2025-03-13 13:13:11,490 [INFO]: 784.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:11,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:13:11,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:11
2025-03-13 13:13:11,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:11,490 [INFO]: 	Creating the index 03/13/2025, 13:13:11
2025-03-13 13:13:11,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:13:11
2025-03-13 13:13:11,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:13:11,492 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:11
2025-03-13 13:13:11,492 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:13:11,492 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.19it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.61it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.79it/s]100%|██████████| 15/15 [00:03<00:00,  4.79it/s]
2025-03-13 13:13:14,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:14
2025-03-13 13:13:54,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1417 secs
2025-03-13 13:13:54,768 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 13:13:54,768 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.89it/s]
2025-03-13 13:14:09,929 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1614 secs
2025-03-13 13:14:09,931 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4396 secs
2025-03-13 13:14:09,931 [INFO]: {
2025-03-13 13:14:09,931 [INFO]: 	index_key: HNSW15
2025-03-13 13:14:09,932 [INFO]: 	index_param: efSearch=195
2025-03-13 13:14:09,932 [INFO]: 	index_path: knn.index
2025-03-13 13:14:09,932 [INFO]: 	size in bytes: 747823570
2025-03-13 13:14:09,932 [INFO]: 	avg_search_speed_ms: 9.808530828541182
2025-03-13 13:14:09,932 [INFO]: 	99p_search_speed_ms: 14.622014947235568
2025-03-13 13:14:09,932 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:09,932 [INFO]: 	nb vectors: 3801
2025-03-13 13:14:09,932 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:09,932 [INFO]: 	compression ratio: 0.9993092461635035
2025-03-13 13:14:09,932 [INFO]: }
2025-03-13 13:14:09,932 [INFO]: 	>>> Finished "Creating the index" in 58.4413 secs
2025-03-13 13:14:09,932 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4670 secs
2025-03-13 13:14:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 38941 [episode count 0/20]
[retrieval_preprocessing] for episode 55383 [episode count 1/20], we have num_retrieval=np.int64(3815) num_query=np.int64(174)
2025-03-13 13:14:11,614 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:14:12,062 [INFO]: Launching the whole pipeline 03/13/2025, 13:14:12
2025-03-13 13:14:12,063 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:14:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2322.43it/s]
2025-03-13 13:14:12,090 [INFO]: There are 3815 embeddings of dim 49152
2025-03-13 13:14:12,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 13:14:12,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:14:12
2025-03-13 13:14:12,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:14:12,090 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:14:12,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:14:12,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:14:12,090 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:14:12
2025-03-13 13:14:12,090 [INFO]: 787.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:14:12,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:14:12,090 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:14:12
2025-03-13 13:14:12,090 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:14:12,090 [INFO]: 	Creating the index 03/13/2025, 13:14:12
2025-03-13 13:14:12,091 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:14:12
2025-03-13 13:14:12,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:14:12,092 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:14:12
2025-03-13 13:14:12,092 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:14:12,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.69it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.36it/s] 81%|████████▏ | 13/16 [00:00<00:00, 44.18it/s]100%|██████████| 16/16 [00:02<00:00,  5.45it/s]
2025-03-13 13:14:15,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:14:15
2025-03-13 13:14:49,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3713 secs
2025-03-13 13:14:49,404 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 13:14:49,404 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.85it/s]
2025-03-13 13:15:11,202 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7982 secs
2025-03-13 13:15:11,204 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1128 secs
2025-03-13 13:15:11,205 [INFO]: {
2025-03-13 13:15:11,205 [INFO]: 	index_key: HNSW15
2025-03-13 13:15:11,205 [INFO]: 	index_param: efSearch=180
2025-03-13 13:15:11,205 [INFO]: 	index_path: knn.index
2025-03-13 13:15:11,205 [INFO]: 	size in bytes: 750578110
2025-03-13 13:15:11,205 [INFO]: 	avg_search_speed_ms: 11.31503075615153
2025-03-13 13:15:11,205 [INFO]: 	99p_search_speed_ms: 18.871013268362727
2025-03-13 13:15:11,205 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:15:11,205 [INFO]: 	nb vectors: 3815
2025-03-13 13:15:11,205 [INFO]: 	vectors dimension: 49152
2025-03-13 13:15:11,205 [INFO]: 	compression ratio: 0.9993090792376026
2025-03-13 13:15:11,205 [INFO]: }
2025-03-13 13:15:11,205 [INFO]: 	>>> Finished "Creating the index" in 59.1142 secs
2025-03-13 13:15:11,205 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1421 secs
2025-03-13 13:15:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 55383 [episode count 1/20]
[retrieval_preprocessing] for episode 86152 [episode count 2/20], we have num_retrieval=np.int64(3762) num_query=np.int64(227)
2025-03-13 13:15:13,641 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:14,536 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:14
2025-03-13 13:15:14,536 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.76it/s]
2025-03-13 13:15:14,566 [INFO]: There are 3762 embeddings of dim 49152
2025-03-13 13:15:14,566 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 13:15:14,566 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:14
2025-03-13 13:15:14,566 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:14,566 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:15:14,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:15:14,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:15:14,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:14
2025-03-13 13:15:14,566 [INFO]: 776.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:14,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:15:14,567 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:14
2025-03-13 13:15:14,567 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:14,567 [INFO]: 	Creating the index 03/13/2025, 13:15:14
2025-03-13 13:15:14,567 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:15:14
2025-03-13 13:15:14,568 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:15:14,568 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:14
2025-03-13 13:15:14,568 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:15:14,568 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.33it/s] 27%|██▋       | 4/15 [00:00<00:00, 13.96it/s] 53%|█████▎    | 8/15 [00:00<00:00, 21.14it/s] 80%|████████  | 12/15 [00:00<00:00, 25.27it/s]100%|██████████| 15/15 [00:03<00:00,  2.53it/s]100%|██████████| 15/15 [00:03<00:00,  3.83it/s]
2025-03-13 13:15:18,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:18
2025-03-13 13:15:58,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7326 secs
2025-03-13 13:15:58,223 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 13:15:58,224 [INFO]: 	Compute fast metrics 03/13/2025, 13:15:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.00it/s]
2025-03-13 13:16:15,987 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7630 secs
2025-03-13 13:16:15,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4202 secs
2025-03-13 13:16:15,989 [INFO]: {
2025-03-13 13:16:15,989 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:15,989 [INFO]: 	index_param: efSearch=153
2025-03-13 13:16:15,989 [INFO]: 	index_path: knn.index
2025-03-13 13:16:15,989 [INFO]: 	size in bytes: 740150650
2025-03-13 13:16:15,989 [INFO]: 	avg_search_speed_ms: 8.157965775767606
2025-03-13 13:16:15,989 [INFO]: 	99p_search_speed_ms: 13.431055471301079
2025-03-13 13:16:15,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:15,989 [INFO]: 	nb vectors: 3762
2025-03-13 13:16:15,989 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:15,989 [INFO]: 	compression ratio: 0.999309121730826
2025-03-13 13:16:15,989 [INFO]: }
2025-03-13 13:16:15,989 [INFO]: 	>>> Finished "Creating the index" in 61.4219 secs
2025-03-13 13:16:15,989 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4524 secs
2025-03-13 13:16:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 86152 [episode count 2/20]
[retrieval_preprocessing] for episode 20679 [episode count 3/20], we have num_retrieval=np.int64(3834) num_query=np.int64(155)
2025-03-13 13:16:17,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:18,841 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:18
2025-03-13 13:16:18,841 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.17it/s]
2025-03-13 13:16:18,872 [INFO]: There are 3834 embeddings of dim 49152
2025-03-13 13:16:18,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 13:16:18,873 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:18
2025-03-13 13:16:18,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:18,873 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:16:18,873 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:18,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:16:18,873 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:18
2025-03-13 13:16:18,873 [INFO]: 791.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:18,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:16:18,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:18
2025-03-13 13:16:18,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:18,874 [INFO]: 	Creating the index 03/13/2025, 13:16:18
2025-03-13 13:16:18,874 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:18
2025-03-13 13:16:18,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 13:16:18,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:18
2025-03-13 13:16:18,878 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:16:18,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 27.17it/s] 56%|█████▋    | 9/16 [00:00<00:00, 45.38it/s] 94%|█████████▍| 15/16 [00:00<00:00, 51.23it/s]100%|██████████| 16/16 [00:02<00:00,  5.47it/s]
2025-03-13 13:16:21,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:21
2025-03-13 13:17:03,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6473 secs
2025-03-13 13:17:03,457 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 13:17:03,457 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-13 13:17:23,738 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2813 secs
2025-03-13 13:17:23,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8628 secs
2025-03-13 13:17:23,740 [INFO]: {
2025-03-13 13:17:23,740 [INFO]: 	index_key: HNSW15
2025-03-13 13:17:23,741 [INFO]: 	index_param: efSearch=185
2025-03-13 13:17:23,741 [INFO]: 	index_path: knn.index
2025-03-13 13:17:23,741 [INFO]: 	size in bytes: 754316410
2025-03-13 13:17:23,741 [INFO]: 	avg_search_speed_ms: 9.016037263594251
2025-03-13 13:17:23,741 [INFO]: 	99p_search_speed_ms: 12.971545411273842
2025-03-13 13:17:23,741 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:17:23,741 [INFO]: 	nb vectors: 3834
2025-03-13 13:17:23,741 [INFO]: 	vectors dimension: 49152
2025-03-13 13:17:23,741 [INFO]: 	compression ratio: 0.9993088603229512
2025-03-13 13:17:23,741 [INFO]: }
2025-03-13 13:17:23,741 [INFO]: 	>>> Finished "Creating the index" in 64.8665 secs
2025-03-13 13:17:23,741 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8995 secs
2025-03-13 13:17:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 20679 [episode count 3/20]
[retrieval_preprocessing] for episode 51280 [episode count 4/20], we have num_retrieval=np.int64(3732) num_query=np.int64(257)
2025-03-13 13:17:25,301 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:17:25,804 [INFO]: Launching the whole pipeline 03/13/2025, 13:17:25
2025-03-13 13:17:25,804 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:17:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.00it/s]
2025-03-13 13:17:25,825 [INFO]: There are 3732 embeddings of dim 49152
2025-03-13 13:17:25,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-13 13:17:25,825 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:17:25,826 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:17:25,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:17:25,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:17:25,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,826 [INFO]: 770.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:17:25,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:17:25,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:17:25
2025-03-13 13:17:25,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:17:25,826 [INFO]: 	Creating the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,826 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:17:25
2025-03-13 13:17:25,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:17:25,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,827 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:17:25,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.15it/s] 53%|█████▎    | 8/15 [00:00<00:00, 39.81it/s] 93%|█████████▎| 14/15 [00:00<00:00, 47.07it/s]100%|██████████| 15/15 [00:03<00:00,  4.51it/s]
2025-03-13 13:17:29,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:29
2025-03-13 13:18:05,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9238 secs
2025-03-13 13:18:05,084 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 13:18:05,084 [INFO]: 	Compute fast metrics 03/13/2025, 13:18:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.91it/s]
2025-03-13 13:18:31,529 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4447 secs
2025-03-13 13:18:31,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7038 secs
2025-03-13 13:18:31,531 [INFO]: {
2025-03-13 13:18:31,531 [INFO]: 	index_key: HNSW15
2025-03-13 13:18:31,531 [INFO]: 	index_param: efSearch=185
2025-03-13 13:18:31,531 [INFO]: 	index_path: knn.index
2025-03-13 13:18:31,531 [INFO]: 	size in bytes: 734248210
2025-03-13 13:18:31,531 [INFO]: 	avg_search_speed_ms: 8.79642939733189
2025-03-13 13:18:31,531 [INFO]: 	99p_search_speed_ms: 14.535956606268888
2025-03-13 13:18:31,531 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:31,531 [INFO]: 	nb vectors: 3732
2025-03-13 13:18:31,531 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:31,531 [INFO]: 	compression ratio: 0.9993092880675869
2025-03-13 13:18:31,531 [INFO]: }
2025-03-13 13:18:31,531 [INFO]: 	>>> Finished "Creating the index" in 65.7057 secs
2025-03-13 13:18:31,532 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7277 secs
2025-03-13 13:18:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:18:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 51280 [episode count 4/20]
[retrieval_preprocessing] for episode 30836 [episode count 5/20], we have num_retrieval=np.int64(3789) num_query=np.int64(200)
2025-03-13 13:18:33,769 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:18:34,292 [INFO]: Launching the whole pipeline 03/13/2025, 13:18:34
2025-03-13 13:18:34,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:18:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-13 13:18:34,323 [INFO]: There are 3789 embeddings of dim 49152
2025-03-13 13:18:34,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 13:18:34,324 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,324 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:18:34,324 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:18:34,325 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:18:34,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:18:34,325 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,325 [INFO]: 782.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:18:34,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:18:34,326 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:18:34
2025-03-13 13:18:34,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:18:34,326 [INFO]: 	Creating the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,326 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:18:34
2025-03-13 13:18:34,329 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:18:34,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,329 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:18:34,330 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 26.56it/s] 60%|██████    | 9/15 [00:00<00:00, 42.65it/s]100%|██████████| 15/15 [00:03<00:00,  3.55it/s]100%|██████████| 15/15 [00:03<00:00,  4.44it/s]
2025-03-13 13:18:37,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:18:37
2025-03-13 13:19:22,628 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9163 secs
2025-03-13 13:19:22,629 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 13:19:22,629 [INFO]: 	Compute fast metrics 03/13/2025, 13:19:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.82it/s]
2025-03-13 13:19:43,414 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7854 secs
2025-03-13 13:19:43,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0877 secs
2025-03-13 13:19:43,417 [INFO]: {
2025-03-13 13:19:43,417 [INFO]: 	index_key: HNSW15
2025-03-13 13:19:43,417 [INFO]: 	index_param: efSearch=173
2025-03-13 13:19:43,417 [INFO]: 	index_path: knn.index
2025-03-13 13:19:43,417 [INFO]: 	size in bytes: 745462630
2025-03-13 13:19:43,417 [INFO]: 	avg_search_speed_ms: 10.650094679613321
2025-03-13 13:19:43,417 [INFO]: 	99p_search_speed_ms: 15.305592562071979
2025-03-13 13:19:43,417 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:43,417 [INFO]: 	nb vectors: 3789
2025-03-13 13:19:43,417 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:43,418 [INFO]: 	compression ratio: 0.9993092638325813
2025-03-13 13:19:43,418 [INFO]: }
2025-03-13 13:19:43,418 [INFO]: 	>>> Finished "Creating the index" in 69.0915 secs
2025-03-13 13:19:43,418 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1251 secs
2025-03-13 13:19:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 30836 [episode count 5/20]
[retrieval_preprocessing] for episode 14678 [episode count 6/20], we have num_retrieval=np.int64(3823) num_query=np.int64(166)
2025-03-13 13:19:45,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:46,869 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:46
2025-03-13 13:19:46,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2025.26it/s]
2025-03-13 13:19:46,899 [INFO]: There are 3823 embeddings of dim 49152
2025-03-13 13:19:46,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 13:19:46,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:46
2025-03-13 13:19:46,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:46,901 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:19:46,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:19:46,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:19:46,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:46
2025-03-13 13:19:46,901 [INFO]: 789.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:46,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:19:46,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:46
2025-03-13 13:19:46,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:46,902 [INFO]: 	Creating the index 03/13/2025, 13:19:46
2025-03-13 13:19:46,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:19:46
2025-03-13 13:19:46,905 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 13:19:46,905 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:46
2025-03-13 13:19:46,906 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:19:46,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.41it/s] 44%|████▍     | 7/16 [00:00<00:00, 31.87it/s] 75%|███████▌  | 12/16 [00:00<00:00, 36.07it/s]100%|██████████| 16/16 [00:04<00:00,  2.58it/s]100%|██████████| 16/16 [00:04<00:00,  3.73it/s]
2025-03-13 13:19:51,205 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:51
2025-03-13 13:20:34,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0147 secs
2025-03-13 13:20:34,220 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 13:20:34,220 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-13 13:20:51,072 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8519 secs
2025-03-13 13:20:51,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1691 secs
2025-03-13 13:20:51,075 [INFO]: {
2025-03-13 13:20:51,075 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:51,075 [INFO]: 	index_param: efSearch=195
2025-03-13 13:20:51,075 [INFO]: 	index_path: knn.index
2025-03-13 13:20:51,075 [INFO]: 	size in bytes: 752152030
2025-03-13 13:20:51,075 [INFO]: 	avg_search_speed_ms: 10.966953247317864
2025-03-13 13:20:51,075 [INFO]: 	99p_search_speed_ms: 15.200315157417208
2025-03-13 13:20:51,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:51,075 [INFO]: 	nb vectors: 3823
2025-03-13 13:20:51,075 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:51,075 [INFO]: 	compression ratio: 0.9993091210562843
2025-03-13 13:20:51,075 [INFO]: }
2025-03-13 13:20:51,075 [INFO]: 	>>> Finished "Creating the index" in 64.1729 secs
2025-03-13 13:20:51,075 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2059 secs
2025-03-13 13:20:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 14678 [episode count 6/20]
[retrieval_preprocessing] for episode 74086 [episode count 7/20], we have num_retrieval=np.int64(3779) num_query=np.int64(210)
2025-03-13 13:20:52,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:53,159 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:53
2025-03-13 13:20:53,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.67it/s]
2025-03-13 13:20:53,190 [INFO]: There are 3779 embeddings of dim 49152
2025-03-13 13:20:53,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 13:20:53,190 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:53
2025-03-13 13:20:53,191 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:53,191 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:20:53,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:53,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 13:20:53,192 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:53
2025-03-13 13:20:53,192 [INFO]: 779.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:53,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:20:53,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:53
2025-03-13 13:20:53,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:53,192 [INFO]: 	Creating the index 03/13/2025, 13:20:53
2025-03-13 13:20:53,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:53
2025-03-13 13:20:53,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 13:20:53,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:53
2025-03-13 13:20:53,194 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:20:53,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.77it/s] 40%|████      | 6/15 [00:00<00:00, 25.34it/s] 67%|██████▋   | 10/15 [00:00<00:00, 30.34it/s]100%|██████████| 15/15 [00:03<00:00,  2.91it/s]100%|██████████| 15/15 [00:03<00:00,  3.98it/s]
2025-03-13 13:20:56,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:20:56
2025-03-13 13:21:37,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9752 secs
2025-03-13 13:21:37,939 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 13:21:37,939 [INFO]: 	Compute fast metrics 03/13/2025, 13:21:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.71it/s]
2025-03-13 13:21:56,923 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9835 secs
2025-03-13 13:21:56,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7316 secs
2025-03-13 13:21:56,926 [INFO]: {
2025-03-13 13:21:56,926 [INFO]: 	index_key: HNSW15
2025-03-13 13:21:56,926 [INFO]: 	index_param: efSearch=194
2025-03-13 13:21:56,926 [INFO]: 	index_path: knn.index
2025-03-13 13:21:56,926 [INFO]: 	size in bytes: 743495230
2025-03-13 13:21:56,926 [INFO]: 	avg_search_speed_ms: 11.918551521375775
2025-03-13 13:21:56,926 [INFO]: 	99p_search_speed_ms: 16.424496825784445
2025-03-13 13:21:56,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:56,926 [INFO]: 	nb vectors: 3779
2025-03-13 13:21:56,926 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:56,926 [INFO]: 	compression ratio: 0.9993092114390566
2025-03-13 13:21:56,926 [INFO]: }
2025-03-13 13:21:56,926 [INFO]: 	>>> Finished "Creating the index" in 63.7340 secs
2025-03-13 13:21:56,926 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7666 secs
2025-03-13 13:21:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 74086 [episode count 7/20]
[retrieval_preprocessing] for episode 86410 [episode count 8/20], we have num_retrieval=np.int64(3858) num_query=np.int64(131)
2025-03-13 13:21:58,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:59,219 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:59
2025-03-13 13:21:59,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1605.78it/s]
2025-03-13 13:21:59,252 [INFO]: There are 3858 embeddings of dim 49152
2025-03-13 13:21:59,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 13:21:59,253 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:59,253 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:21:59,253 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:21:59,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 13:21:59,254 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,254 [INFO]: 796.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:59,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:21:59,254 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:59
2025-03-13 13:21:59,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:59,255 [INFO]: 	Creating the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,255 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:59
2025-03-13 13:21:59,258 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:21:59,258 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,259 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:21:59,259 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.56it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.60it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.44it/s]100%|██████████| 16/16 [00:03<00:00,  4.62it/s]
2025-03-13 13:22:02,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:22:02
2025-03-13 13:22:46,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5898 secs
2025-03-13 13:22:46,316 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 13:22:46,317 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.80it/s]
2025-03-13 13:23:03,893 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5761 secs
2025-03-13 13:23:03,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6377 secs
2025-03-13 13:23:03,896 [INFO]: {
2025-03-13 13:23:03,896 [INFO]: 	index_key: HNSW15
2025-03-13 13:23:03,896 [INFO]: 	index_param: efSearch=196
2025-03-13 13:23:03,896 [INFO]: 	index_path: knn.index
2025-03-13 13:23:03,896 [INFO]: 	size in bytes: 759038230
2025-03-13 13:23:03,896 [INFO]: 	avg_search_speed_ms: 12.373463481510205
2025-03-13 13:23:03,896 [INFO]: 	99p_search_speed_ms: 18.72061304980889
2025-03-13 13:23:03,896 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:23:03,896 [INFO]: 	nb vectors: 3858
2025-03-13 13:23:03,896 [INFO]: 	vectors dimension: 49152
2025-03-13 13:23:03,897 [INFO]: 	compression ratio: 0.9993089070098616
2025-03-13 13:23:03,897 [INFO]: }
2025-03-13 13:23:03,897 [INFO]: 	>>> Finished "Creating the index" in 64.6417 secs
2025-03-13 13:23:03,897 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6780 secs
2025-03-13 13:23:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:23:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 86410 [episode count 8/20]
[retrieval_preprocessing] for episode 6878 [episode count 9/20], we have num_retrieval=np.int64(3658) num_query=np.int64(331)
2025-03-13 13:23:05,688 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:23:06,257 [INFO]: Launching the whole pipeline 03/13/2025, 13:23:06
2025-03-13 13:23:06,257 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:23:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.40it/s]
2025-03-13 13:23:06,284 [INFO]: There are 3658 embeddings of dim 49152
2025-03-13 13:23:06,284 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 13:23:06,284 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:23:06
2025-03-13 13:23:06,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:23:06,284 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:23:06,284 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:23:06,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:23:06,284 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:23:06
2025-03-13 13:23:06,284 [INFO]: 754.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:23:06,284 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:23:06,284 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:23:06
2025-03-13 13:23:06,284 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:23:06,285 [INFO]: 	Creating the index 03/13/2025, 13:23:06
2025-03-13 13:23:06,285 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:23:06
2025-03-13 13:23:06,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:23:06,286 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:23:06
2025-03-13 13:23:06,286 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:23:06,286 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.19it/s] 40%|████      | 6/15 [00:00<00:00, 26.62it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.79it/s]100%|██████████| 15/15 [00:02<00:00,  3.68it/s]100%|██████████| 15/15 [00:02<00:00,  5.03it/s]
2025-03-13 13:23:09,270 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:09
2025-03-13 13:23:45,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6731 secs
2025-03-13 13:23:45,944 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 13:23:45,944 [INFO]: 	Compute fast metrics 03/13/2025, 13:23:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.89it/s]
2025-03-13 13:24:04,924 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9798 secs
2025-03-13 13:24:04,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6403 secs
2025-03-13 13:24:04,926 [INFO]: {
2025-03-13 13:24:04,926 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:04,926 [INFO]: 	index_param: efSearch=228
2025-03-13 13:24:04,926 [INFO]: 	index_path: knn.index
2025-03-13 13:24:04,926 [INFO]: 	size in bytes: 719689210
2025-03-13 13:24:04,926 [INFO]: 	avg_search_speed_ms: 10.92881556254267
2025-03-13 13:24:04,926 [INFO]: 	99p_search_speed_ms: 15.571563788689673
2025-03-13 13:24:04,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:04,926 [INFO]: 	nb vectors: 3658
2025-03-13 13:24:04,926 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:04,926 [INFO]: 	compression ratio: 0.9993092212678859
2025-03-13 13:24:04,926 [INFO]: }
2025-03-13 13:24:04,926 [INFO]: 	>>> Finished "Creating the index" in 58.6418 secs
2025-03-13 13:24:04,926 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6696 secs
2025-03-13 13:24:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 6878 [episode count 9/20]
[retrieval_preprocessing] for episode 76438 [episode count 10/20], we have num_retrieval=np.int64(3786) num_query=np.int64(203)
2025-03-13 13:24:08,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:09,108 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:09
2025-03-13 13:24:09,109 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.88it/s]
2025-03-13 13:24:09,149 [INFO]: There are 3786 embeddings of dim 49152
2025-03-13 13:24:09,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0411 secs
2025-03-13 13:24:09,150 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:09,150 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:24:09,150 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:09,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 13:24:09,150 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,150 [INFO]: 781.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:09,151 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:24:09,151 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:09
2025-03-13 13:24:09,151 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:09,151 [INFO]: 	Creating the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,151 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:09
2025-03-13 13:24:09,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 13:24:09,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:09
2025-03-13 13:24:09,153 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:24:09,153 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.92it/s] 40%|████      | 6/15 [00:00<00:00, 26.95it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.27it/s]100%|██████████| 15/15 [00:04<00:00,  2.48it/s]100%|██████████| 15/15 [00:04<00:00,  3.46it/s]
2025-03-13 13:24:13,492 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:13
2025-03-13 13:24:53,195 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7020 secs
2025-03-13 13:24:53,195 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 13:24:53,196 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 13:25:08,668 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4726 secs
2025-03-13 13:25:08,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5178 secs
2025-03-13 13:25:08,671 [INFO]: {
2025-03-13 13:25:08,671 [INFO]: 	index_key: HNSW15
2025-03-13 13:25:08,671 [INFO]: 	index_param: efSearch=184
2025-03-13 13:25:08,671 [INFO]: 	index_path: knn.index
2025-03-13 13:25:08,671 [INFO]: 	size in bytes: 744872410
2025-03-13 13:25:08,671 [INFO]: 	avg_search_speed_ms: 8.857171537900678
2025-03-13 13:25:08,671 [INFO]: 	99p_search_speed_ms: 14.095136048272252
2025-03-13 13:25:08,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:25:08,671 [INFO]: 	nb vectors: 3786
2025-03-13 13:25:08,671 [INFO]: 	vectors dimension: 49152
2025-03-13 13:25:08,671 [INFO]: 	compression ratio: 0.9993092481435848
2025-03-13 13:25:08,671 [INFO]: }
2025-03-13 13:25:08,671 [INFO]: 	>>> Finished "Creating the index" in 59.5199 secs
2025-03-13 13:25:08,671 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5624 secs
2025-03-13 13:25:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:25:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 76438 [episode count 10/20]
[retrieval_preprocessing] for episode 56106 [episode count 11/20], we have num_retrieval=np.int64(3803) num_query=np.int64(186)
2025-03-13 13:25:10,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:25:10,796 [INFO]: Launching the whole pipeline 03/13/2025, 13:25:10
2025-03-13 13:25:10,796 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:25:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.16it/s]
2025-03-13 13:25:10,821 [INFO]: There are 3803 embeddings of dim 49152
2025-03-13 13:25:10,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 13:25:10,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:25:10
2025-03-13 13:25:10,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:25:10,821 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:25:10,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:25:10,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:25:10,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:25:10
2025-03-13 13:25:10,821 [INFO]: 784.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:25:10,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:25:10,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:25:10
2025-03-13 13:25:10,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:25:10,821 [INFO]: 	Creating the index 03/13/2025, 13:25:10
2025-03-13 13:25:10,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:25:10
2025-03-13 13:25:10,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:25:10,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:25:10
2025-03-13 13:25:10,823 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:25:10,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.20it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.28it/s] 87%|████████▋ | 13/15 [00:00<00:00, 41.95it/s]100%|██████████| 15/15 [00:02<00:00,  5.03it/s]
2025-03-13 13:25:13,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:13
2025-03-13 13:25:55,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9816 secs
2025-03-13 13:25:55,792 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 13:25:55,793 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.35it/s]
2025-03-13 13:26:14,231 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4389 secs
2025-03-13 13:26:14,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4109 secs
2025-03-13 13:26:14,234 [INFO]: {
2025-03-13 13:26:14,234 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:14,234 [INFO]: 	index_param: efSearch=188
2025-03-13 13:26:14,234 [INFO]: 	index_path: knn.index
2025-03-13 13:26:14,234 [INFO]: 	size in bytes: 748217050
2025-03-13 13:26:14,234 [INFO]: 	avg_search_speed_ms: 10.035061697571827
2025-03-13 13:26:14,234 [INFO]: 	99p_search_speed_ms: 13.894934169948101
2025-03-13 13:26:14,234 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:14,234 [INFO]: 	nb vectors: 3803
2025-03-13 13:26:14,234 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:14,234 [INFO]: 	compression ratio: 0.9993092565853718
2025-03-13 13:26:14,234 [INFO]: }
2025-03-13 13:26:14,234 [INFO]: 	>>> Finished "Creating the index" in 63.4125 secs
2025-03-13 13:26:14,234 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4382 secs
2025-03-13 13:26:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 56106 [episode count 11/20]
[retrieval_preprocessing] for episode 80712 [episode count 12/20], we have num_retrieval=np.int64(3832) num_query=np.int64(157)
2025-03-13 13:26:15,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:16,424 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:16
2025-03-13 13:26:16,424 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2178.86it/s]
2025-03-13 13:26:16,453 [INFO]: There are 3832 embeddings of dim 49152
2025-03-13 13:26:16,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 13:26:16,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:16,454 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:26:16,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:26:16,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:26:16,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,454 [INFO]: 790.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:16,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:26:16,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:16
2025-03-13 13:26:16,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:16,454 [INFO]: 	Creating the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:16
2025-03-13 13:26:16,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:26:16,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:16
2025-03-13 13:26:16,455 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:26:16,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.94it/s] 50%|█████     | 8/16 [00:00<00:00, 37.53it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.94it/s]100%|██████████| 16/16 [00:02<00:00,  5.58it/s]
2025-03-13 13:26:19,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:19
2025-03-13 13:26:54,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3373 secs
2025-03-13 13:26:54,665 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 13:26:54,665 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 13:27:13,227 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5619 secs
2025-03-13 13:27:13,230 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7748 secs
2025-03-13 13:27:13,230 [INFO]: {
2025-03-13 13:27:13,230 [INFO]: 	index_key: HNSW15
2025-03-13 13:27:13,230 [INFO]: 	index_param: efSearch=167
2025-03-13 13:27:13,230 [INFO]: 	index_path: knn.index
2025-03-13 13:27:13,230 [INFO]: 	size in bytes: 753922870
2025-03-13 13:27:13,230 [INFO]: 	avg_search_speed_ms: 9.879779107196867
2025-03-13 13:27:13,230 [INFO]: 	99p_search_speed_ms: 16.574594334233527
2025-03-13 13:27:13,230 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:27:13,230 [INFO]: 	nb vectors: 3832
2025-03-13 13:27:13,230 [INFO]: 	vectors dimension: 49152
2025-03-13 13:27:13,230 [INFO]: 	compression ratio: 0.9993089293073176
2025-03-13 13:27:13,230 [INFO]: }
2025-03-13 13:27:13,230 [INFO]: 	>>> Finished "Creating the index" in 56.7764 secs
2025-03-13 13:27:13,230 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8068 secs
2025-03-13 13:27:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:27:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 80712 [episode count 12/20]
[retrieval_preprocessing] for episode 41433 [episode count 13/20], we have num_retrieval=np.int64(3856) num_query=np.int64(133)
2025-03-13 13:27:14,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:27:15,575 [INFO]: Launching the whole pipeline 03/13/2025, 13:27:15
2025-03-13 13:27:15,575 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:27:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.77it/s]
2025-03-13 13:27:15,602 [INFO]: There are 3856 embeddings of dim 49152
2025-03-13 13:27:15,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 13:27:15,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:27:15
2025-03-13 13:27:15,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:27:15,602 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:27:15,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:27:15,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:27:15,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:27:15
2025-03-13 13:27:15,602 [INFO]: 795.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:27:15,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:27:15,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:27:15
2025-03-13 13:27:15,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:27:15,603 [INFO]: 	Creating the index 03/13/2025, 13:27:15
2025-03-13 13:27:15,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:27:15
2025-03-13 13:27:15,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 13:27:15,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:27:15
2025-03-13 13:27:15,604 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:27:15,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.85it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.14it/s] 56%|█████▋    | 9/16 [00:00<00:00, 28.49it/s] 81%|████████▏ | 13/16 [00:00<00:00, 32.49it/s]100%|██████████| 16/16 [00:03<00:00,  4.31it/s]
2025-03-13 13:27:19,317 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:19
2025-03-13 13:27:58,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8830 secs
2025-03-13 13:27:58,200 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 13:27:58,200 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.72it/s]
2025-03-13 13:28:18,852 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6515 secs
2025-03-13 13:28:18,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2499 secs
2025-03-13 13:28:18,854 [INFO]: {
2025-03-13 13:28:18,854 [INFO]: 	index_key: HNSW15
2025-03-13 13:28:18,854 [INFO]: 	index_param: efSearch=212
2025-03-13 13:28:18,854 [INFO]: 	index_path: knn.index
2025-03-13 13:28:18,854 [INFO]: 	size in bytes: 758644750
2025-03-13 13:28:18,854 [INFO]: 	avg_search_speed_ms: 11.343983959991595
2025-03-13 13:28:18,854 [INFO]: 	99p_search_speed_ms: 16.64901775307953
2025-03-13 13:28:18,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:28:18,854 [INFO]: 	nb vectors: 3856
2025-03-13 13:28:18,854 [INFO]: 	vectors dimension: 49152
2025-03-13 13:28:18,854 [INFO]: 	compression ratio: 0.9993088965553376
2025-03-13 13:28:18,854 [INFO]: }
2025-03-13 13:28:18,854 [INFO]: 	>>> Finished "Creating the index" in 63.2518 secs
2025-03-13 13:28:18,854 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2791 secs
2025-03-13 13:28:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:28:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 41433 [episode count 13/20]
[retrieval_preprocessing] for episode 43490 [episode count 14/20], we have num_retrieval=np.int64(3720) num_query=np.int64(269)
2025-03-13 13:28:20,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:28:20,611 [INFO]: Launching the whole pipeline 03/13/2025, 13:28:20
2025-03-13 13:28:20,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:28:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1509.83it/s]
2025-03-13 13:28:20,644 [INFO]: There are 3720 embeddings of dim 49152
2025-03-13 13:28:20,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 13:28:20,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:28:20
2025-03-13 13:28:20,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:28:20,644 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 13:28:20,644 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:28:20,644 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:28:20,644 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:28:20
2025-03-13 13:28:20,644 [INFO]: 767.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:28:20,644 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:28:20,644 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:28:20
2025-03-13 13:28:20,644 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:28:20,644 [INFO]: 	Creating the index 03/13/2025, 13:28:20
2025-03-13 13:28:20,644 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:28:20
2025-03-13 13:28:20,645 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:28:20,645 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:28:20
2025-03-13 13:28:20,645 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:28:20,645 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.18it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.87it/s] 87%|████████▋ | 13/15 [00:00<00:00, 41.05it/s]100%|██████████| 15/15 [00:02<00:00,  5.30it/s]
2025-03-13 13:28:23,480 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:28:23
2025-03-13 13:28:57,941 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4601 secs
2025-03-13 13:28:57,941 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 13:28:57,941 [INFO]: 	Compute fast metrics 03/13/2025, 13:28:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.31it/s]
2025-03-13 13:29:15,807 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8663 secs
2025-03-13 13:29:15,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1643 secs
2025-03-13 13:29:15,810 [INFO]: {
2025-03-13 13:29:15,810 [INFO]: 	index_key: HNSW15
2025-03-13 13:29:15,810 [INFO]: 	index_param: efSearch=165
2025-03-13 13:29:15,810 [INFO]: 	index_path: knn.index
2025-03-13 13:29:15,810 [INFO]: 	size in bytes: 731887150
2025-03-13 13:29:15,810 [INFO]: 	avg_search_speed_ms: 7.849259587484331
2025-03-13 13:29:15,810 [INFO]: 	99p_search_speed_ms: 10.38100813748315
2025-03-13 13:29:15,810 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:29:15,810 [INFO]: 	nb vectors: 3720
2025-03-13 13:29:15,810 [INFO]: 	vectors dimension: 49152
2025-03-13 13:29:15,810 [INFO]: 	compression ratio: 0.999309470046031
2025-03-13 13:29:15,810 [INFO]: }
2025-03-13 13:29:15,810 [INFO]: 	>>> Finished "Creating the index" in 55.1657 secs
2025-03-13 13:29:15,810 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1991 secs
2025-03-13 13:29:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:29:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 43490 [episode count 14/20]
[retrieval_preprocessing] for episode 93632 [episode count 15/20], we have num_retrieval=np.int64(3777) num_query=np.int64(212)
2025-03-13 13:29:17,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:29:18,747 [INFO]: Launching the whole pipeline 03/13/2025, 13:29:18
2025-03-13 13:29:18,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:29:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1841.22it/s]
2025-03-13 13:29:18,773 [INFO]: There are 3777 embeddings of dim 49152
2025-03-13 13:29:18,773 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 13:29:18,773 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:29:18
2025-03-13 13:29:18,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:29:18,773 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:29:18,773 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:29:18,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:29:18,773 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:29:18
2025-03-13 13:29:18,773 [INFO]: 779.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:29:18,773 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:29:18,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:29:18
2025-03-13 13:29:18,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:29:18,774 [INFO]: 	Creating the index 03/13/2025, 13:29:18
2025-03-13 13:29:18,774 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:29:18
2025-03-13 13:29:18,774 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:29:18,775 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:29:18
2025-03-13 13:29:18,775 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:29:18,775 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.18it/s] 53%|█████▎    | 8/15 [00:00<00:00, 37.40it/s] 93%|█████████▎| 14/15 [00:00<00:00, 43.69it/s]100%|██████████| 15/15 [00:02<00:00,  5.21it/s]
2025-03-13 13:29:21,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:29:21
