2025-03-13 14:35:00: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_mug [chosen_id count 0/196]
2025-03-13 14:35:00: [retrieval_preprocessing] we have num_total=2760 embedding_dim=49152
[retrieval_preprocessing] for episode 24662 [episode count 0/20], we have num_retrieval=np.int64(2606) num_query=np.int64(154)
2025-03-13 14:35:01,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:01,496 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:01
2025-03-13 14:35:01,496 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1734.62it/s]
2025-03-13 14:35:01,542 [INFO]: There are 2606 embeddings of dim 49152
2025-03-13 14:35:01,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0457 secs
2025-03-13 14:35:01,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:01
2025-03-13 14:35:01,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:01,543 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:35:01,543 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:01,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:35:01,543 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:01
2025-03-13 14:35:01,545 [INFO]: 537.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:01,545 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0016 secs
2025-03-13 14:35:01,545 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:01
2025-03-13 14:35:01,545 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:01,546 [INFO]: 	Creating the index 03/13/2025, 14:35:01
2025-03-13 14:35:01,546 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:01
2025-03-13 14:35:01,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0042 secs
2025-03-13 14:35:01,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:01
2025-03-13 14:35:01,551 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:35:01,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.63it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.60it/s] 27%|██▋       | 3/11 [00:00<00:02,  3.95it/s] 45%|████▌     | 5/11 [00:00<00:01,  5.50it/s] 55%|█████▍    | 6/11 [00:01<00:00,  5.50it/s] 64%|██████▎   | 7/11 [00:01<00:00,  5.39it/s] 73%|███████▎  | 8/11 [00:01<00:00,  4.53it/s] 82%|████████▏ | 9/11 [00:01<00:00,  4.78it/s] 91%|█████████ | 10/11 [00:01<00:00,  5.08it/s]100%|██████████| 11/11 [00:03<00:00,  1.38it/s]100%|██████████| 11/11 [00:03<00:00,  2.78it/s]
2025-03-13 14:35:05,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:05
2025-03-13 14:35:50,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1693 secs
2025-03-13 14:35:50,686 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 14:35:50,686 [INFO]: 	Compute fast metrics 03/13/2025, 14:35:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 14:36:07,603 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9160 secs
2025-03-13 14:36:07,606 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0554 secs
2025-03-13 14:36:07,606 [INFO]: {
2025-03-13 14:36:07,606 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:07,606 [INFO]: 	index_param: efSearch=89
2025-03-13 14:36:07,606 [INFO]: 	index_path: knn.index
2025-03-13 14:36:07,606 [INFO]: 	size in bytes: 512714470
2025-03-13 14:36:07,606 [INFO]: 	avg_search_speed_ms: 5.576745945810607
2025-03-13 14:36:07,606 [INFO]: 	99p_search_speed_ms: 14.404312246479066
2025-03-13 14:36:07,606 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:07,606 [INFO]: 	nb vectors: 2606
2025-03-13 14:36:07,606 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:07,606 [INFO]: 	compression ratio: 0.9993095143189542
2025-03-13 14:36:07,606 [INFO]: }
2025-03-13 14:36:07,606 [INFO]: 	>>> Finished "Creating the index" in 66.0608 secs
2025-03-13 14:36:07,606 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1102 secs
2025-03-13 14:36:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 24662 [episode count 0/20]
[retrieval_preprocessing] for episode 41049 [episode count 1/20], we have num_retrieval=np.int64(2653) num_query=np.int64(107)
2025-03-13 14:36:09,369 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:09,981 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:09
2025-03-13 14:36:09,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.00it/s]
2025-03-13 14:36:10,011 [INFO]: There are 2653 embeddings of dim 49152
2025-03-13 14:36:10,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 14:36:10,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:10,012 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:36:10,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:10,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:10,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,012 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:10,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:10,012 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:10
2025-03-13 14:36:10,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:10,012 [INFO]: 	Creating the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:10
2025-03-13 14:36:10,014 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:36:10,014 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:10
2025-03-13 14:36:10,014 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:36:10,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.81it/s] 18%|█▊        | 2/11 [00:00<00:01,  8.84it/s] 27%|██▋       | 3/11 [00:00<00:02,  3.67it/s] 45%|████▌     | 5/11 [00:01<00:02,  2.88it/s] 55%|█████▍    | 6/11 [00:02<00:02,  2.23it/s] 73%|███████▎  | 8/11 [00:02<00:00,  3.67it/s] 91%|█████████ | 10/11 [00:02<00:00,  5.01it/s]100%|██████████| 11/11 [00:04<00:00,  1.79it/s]100%|██████████| 11/11 [00:04<00:00,  2.54it/s]
2025-03-13 14:36:14,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:14
2025-03-13 14:36:45,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1746 secs
2025-03-13 14:36:45,583 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 14:36:45,584 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 14:37:03,659 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0754 secs
2025-03-13 14:37:03,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6478 secs
2025-03-13 14:37:03,662 [INFO]: {
2025-03-13 14:37:03,662 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:03,662 [INFO]: 	index_param: efSearch=182
2025-03-13 14:37:03,662 [INFO]: 	index_path: knn.index
2025-03-13 14:37:03,662 [INFO]: 	size in bytes: 521961430
2025-03-13 14:37:03,662 [INFO]: 	avg_search_speed_ms: 8.936319524760194
2025-03-13 14:37:03,662 [INFO]: 	99p_search_speed_ms: 12.202300685457883
2025-03-13 14:37:03,662 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:03,662 [INFO]: 	nb vectors: 2653
2025-03-13 14:37:03,662 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:03,662 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-13 14:37:03,662 [INFO]: }
2025-03-13 14:37:03,662 [INFO]: 	>>> Finished "Creating the index" in 53.6495 secs
2025-03-13 14:37:03,662 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6808 secs
2025-03-13 14:37:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 41049 [episode count 1/20]
[retrieval_preprocessing] for episode 82031 [episode count 2/20], we have num_retrieval=np.int64(2621) num_query=np.int64(139)
2025-03-13 14:37:05,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:06,634 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:06
2025-03-13 14:37:06,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.33it/s]
2025-03-13 14:37:06,661 [INFO]: There are 2621 embeddings of dim 49152
2025-03-13 14:37:06,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 14:37:06,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:06,661 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:37:06,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:06,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:06,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,661 [INFO]: 540.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:06,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:06,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:06
2025-03-13 14:37:06,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:06,662 [INFO]: 	Creating the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:06
2025-03-13 14:37:06,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:37:06,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:06
2025-03-13 14:37:06,663 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:37:06,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.56it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.39it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.74it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.63it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.44it/s]100%|██████████| 11/11 [00:03<00:00,  2.11it/s]100%|██████████| 11/11 [00:03<00:00,  3.45it/s]
2025-03-13 14:37:09,856 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:09
2025-03-13 14:37:41,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4352 secs
2025-03-13 14:37:41,292 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 14:37:41,292 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.30it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.54it/s]
2025-03-13 14:37:56,812 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5202 secs
2025-03-13 14:37:56,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2037 secs
2025-03-13 14:37:56,867 [INFO]: {
2025-03-13 14:37:56,867 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:56,867 [INFO]: 	index_param: efSearch=143
2025-03-13 14:37:56,867 [INFO]: 	index_path: knn.index
2025-03-13 14:37:56,867 [INFO]: 	size in bytes: 515665690
2025-03-13 14:37:56,867 [INFO]: 	avg_search_speed_ms: 9.308598228015525
2025-03-13 14:37:56,867 [INFO]: 	99p_search_speed_ms: 16.920540868304666
2025-03-13 14:37:56,867 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:56,867 [INFO]: 	nb vectors: 2621
2025-03-13 14:37:56,867 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:56,867 [INFO]: 	compression ratio: 0.9993093936499828
2025-03-13 14:37:56,867 [INFO]: }
2025-03-13 14:37:56,867 [INFO]: 	>>> Finished "Creating the index" in 50.2058 secs
2025-03-13 14:37:56,867 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2331 secs
2025-03-13 14:37:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 82031 [episode count 2/20]
[retrieval_preprocessing] for episode 122 [episode count 3/20], we have num_retrieval=np.int64(2616) num_query=np.int64(144)
2025-03-13 14:37:58,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:59,124 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:59
2025-03-13 14:37:59,124 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.44it/s]
2025-03-13 14:37:59,148 [INFO]: There are 2616 embeddings of dim 49152
2025-03-13 14:37:59,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 14:37:59,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:59
2025-03-13 14:37:59,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:59,148 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:37:59,148 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:59,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:59,148 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:59
2025-03-13 14:37:59,148 [INFO]: 539.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:59,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:37:59,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:59
2025-03-13 14:37:59,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:59,148 [INFO]: 	Creating the index 03/13/2025, 14:37:59
2025-03-13 14:37:59,148 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:59
2025-03-13 14:37:59,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:37:59,149 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:59
2025-03-13 14:37:59,149 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:37:59,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.76it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.17it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.27it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.76it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.90it/s]100%|██████████| 11/11 [00:02<00:00,  2.75it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]
2025-03-13 14:38:01,761 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:01
2025-03-13 14:38:30,780 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0194 secs
2025-03-13 14:38:30,781 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 14:38:30,781 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 14:38:46,056 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2750 secs
2025-03-13 14:38:46,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9096 secs
2025-03-13 14:38:46,059 [INFO]: {
2025-03-13 14:38:46,059 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:46,059 [INFO]: 	index_param: efSearch=174
2025-03-13 14:38:46,059 [INFO]: 	index_path: knn.index
2025-03-13 14:38:46,059 [INFO]: 	size in bytes: 514681990
2025-03-13 14:38:46,059 [INFO]: 	avg_search_speed_ms: 9.57050671395467
2025-03-13 14:38:46,059 [INFO]: 	99p_search_speed_ms: 14.885699441656456
2025-03-13 14:38:46,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:46,059 [INFO]: 	nb vectors: 2616
2025-03-13 14:38:46,059 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:46,059 [INFO]: 	compression ratio: 0.9993093560549885
2025-03-13 14:38:46,059 [INFO]: }
2025-03-13 14:38:46,059 [INFO]: 	>>> Finished "Creating the index" in 46.9110 secs
2025-03-13 14:38:46,059 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9350 secs
2025-03-13 14:38:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 122 [episode count 3/20]
[retrieval_preprocessing] for episode 25058 [episode count 4/20], we have num_retrieval=np.int64(2585) num_query=np.int64(175)
2025-03-13 14:38:49,365 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:49,889 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:49
2025-03-13 14:38:49,890 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1073.81it/s]
2025-03-13 14:38:49,917 [INFO]: There are 2585 embeddings of dim 49152
2025-03-13 14:38:49,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 14:38:49,918 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:49
2025-03-13 14:38:49,918 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:49,918 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:38:49,918 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:49,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:49,918 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:49
2025-03-13 14:38:49,918 [INFO]: 533.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:49,918 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:38:49,918 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:49
2025-03-13 14:38:49,918 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:49,918 [INFO]: 	Creating the index 03/13/2025, 14:38:49
2025-03-13 14:38:49,918 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:49
2025-03-13 14:38:49,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:38:49,920 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:49
2025-03-13 14:38:49,920 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:38:49,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.46it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.82it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.43it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.16it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.94it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.78it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.66it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.63it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.63it/s]100%|██████████| 11/11 [00:03<00:00,  1.47it/s]100%|██████████| 11/11 [00:03<00:00,  3.43it/s]
2025-03-13 14:38:53,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:53
2025-03-13 14:39:24,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5134 secs
2025-03-13 14:39:24,642 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 14:39:24,642 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 14:39:45,574 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9319 secs
2025-03-13 14:39:45,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6567 secs
2025-03-13 14:39:45,577 [INFO]: {
2025-03-13 14:39:45,577 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:45,577 [INFO]: 	index_param: efSearch=177
2025-03-13 14:39:45,577 [INFO]: 	index_path: knn.index
2025-03-13 14:39:45,577 [INFO]: 	size in bytes: 508582870
2025-03-13 14:39:45,577 [INFO]: 	avg_search_speed_ms: 9.510616548572065
2025-03-13 14:39:45,577 [INFO]: 	99p_search_speed_ms: 12.728083529509604
2025-03-13 14:39:45,577 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:45,577 [INFO]: 	nb vectors: 2585
2025-03-13 14:39:45,577 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:45,577 [INFO]: 	compression ratio: 0.9993094734000774
2025-03-13 14:39:45,577 [INFO]: }
2025-03-13 14:39:45,577 [INFO]: 	>>> Finished "Creating the index" in 55.6587 secs
2025-03-13 14:39:45,577 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6874 secs
2025-03-13 14:39:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 25058 [episode count 4/20]
[retrieval_preprocessing] for episode 33314 [episode count 5/20], we have num_retrieval=np.int64(2621) num_query=np.int64(139)
2025-03-13 14:39:48,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:48,804 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:48
2025-03-13 14:39:48,804 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1651.30it/s]
2025-03-13 14:39:48,829 [INFO]: There are 2621 embeddings of dim 49152
2025-03-13 14:39:48,829 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 14:39:48,829 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:48
2025-03-13 14:39:48,829 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:48,829 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:39:48,829 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:48,829 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:39:48,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:48
2025-03-13 14:39:48,830 [INFO]: 540.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:48,830 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:39:48,830 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:48
2025-03-13 14:39:48,830 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:48,830 [INFO]: 	Creating the index 03/13/2025, 14:39:48
2025-03-13 14:39:48,830 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:48
2025-03-13 14:39:48,831 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:39:48,831 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:48
2025-03-13 14:39:48,831 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:39:48,831 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.83it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.67it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.92it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.86it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.44it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.94it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]
2025-03-13 14:39:51,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:51
2025-03-13 14:40:23,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9931 secs
2025-03-13 14:40:23,572 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 14:40:23,572 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 14:40:40,012 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4401 secs
2025-03-13 14:40:40,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1837 secs
2025-03-13 14:40:40,015 [INFO]: {
2025-03-13 14:40:40,015 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:40,015 [INFO]: 	index_param: efSearch=143
2025-03-13 14:40:40,015 [INFO]: 	index_path: knn.index
2025-03-13 14:40:40,015 [INFO]: 	size in bytes: 515665690
2025-03-13 14:40:40,015 [INFO]: 	avg_search_speed_ms: 8.983564647399927
2025-03-13 14:40:40,015 [INFO]: 	99p_search_speed_ms: 16.31514917127788
2025-03-13 14:40:40,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:40,015 [INFO]: 	nb vectors: 2621
2025-03-13 14:40:40,015 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:40,015 [INFO]: 	compression ratio: 0.9993093936499828
2025-03-13 14:40:40,015 [INFO]: }
2025-03-13 14:40:40,015 [INFO]: 	>>> Finished "Creating the index" in 51.1850 secs
2025-03-13 14:40:40,015 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2103 secs
2025-03-13 14:40:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 33314 [episode count 5/20]
[retrieval_preprocessing] for episode 33683 [episode count 6/20], we have num_retrieval=np.int64(2630) num_query=np.int64(130)
2025-03-13 14:40:41,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:42,468 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:42
2025-03-13 14:40:42,468 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.70it/s]
2025-03-13 14:40:42,494 [INFO]: There are 2630 embeddings of dim 49152
2025-03-13 14:40:42,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 14:40:42,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:42
2025-03-13 14:40:42,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:42,495 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:40:42,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:42,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:42,495 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:42
2025-03-13 14:40:42,495 [INFO]: 542.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:42,495 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:40:42,495 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:42
2025-03-13 14:40:42,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:42,495 [INFO]: 	Creating the index 03/13/2025, 14:40:42
2025-03-13 14:40:42,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:42
2025-03-13 14:40:42,497 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:40:42,497 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:42
2025-03-13 14:40:42,497 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:40:42,497 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.50it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.40it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.63it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.43it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.00it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.77it/s] 91%|█████████ | 10/11 [00:01<00:00, 12.51it/s]100%|██████████| 11/11 [00:03<00:00,  3.55it/s]
2025-03-13 14:40:45,600 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:45
2025-03-13 14:41:15,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2519 secs
2025-03-13 14:41:15,852 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 14:41:15,853 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.63s/it] 50%|█████     | 2/4 [00:04<00:04,  2.49s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.14s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.26s/it]
2025-03-13 14:41:46,894 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0408 secs
2025-03-13 14:41:46,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3996 secs
2025-03-13 14:41:46,896 [INFO]: {
2025-03-13 14:41:46,896 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:46,896 [INFO]: 	index_param: efSearch=207
2025-03-13 14:41:46,896 [INFO]: 	index_path: knn.index
2025-03-13 14:41:46,896 [INFO]: 	size in bytes: 517436410
2025-03-13 14:41:46,896 [INFO]: 	avg_search_speed_ms: 9.794372382020098
2025-03-13 14:41:46,897 [INFO]: 	99p_search_speed_ms: 12.860553665086623
2025-03-13 14:41:46,897 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:46,897 [INFO]: 	nb vectors: 2630
2025-03-13 14:41:46,897 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:46,897 [INFO]: 	compression ratio: 0.9993093450845486
2025-03-13 14:41:46,897 [INFO]: }
2025-03-13 14:41:46,897 [INFO]: 	>>> Finished "Creating the index" in 64.4014 secs
2025-03-13 14:41:46,897 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4283 secs
2025-03-13 14:41:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 33683 [episode count 6/20]
[retrieval_preprocessing] for episode 33705 [episode count 7/20], we have num_retrieval=np.int64(2628) num_query=np.int64(132)
2025-03-13 14:41:48,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:49,329 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:49
2025-03-13 14:41:49,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 820.96it/s]
2025-03-13 14:41:49,359 [INFO]: There are 2628 embeddings of dim 49152
2025-03-13 14:41:49,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 14:41:49,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:49
2025-03-13 14:41:49,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:49,360 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:41:49,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:49,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:41:49,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:49
2025-03-13 14:41:49,360 [INFO]: 542.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:49,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:41:49,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:49
2025-03-13 14:41:49,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:49,361 [INFO]: 	Creating the index 03/13/2025, 14:41:49
2025-03-13 14:41:49,362 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:49
2025-03-13 14:41:49,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 14:41:49,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:49
2025-03-13 14:41:49,366 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:41:49,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.98it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.55it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.92it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.42it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.74it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.87it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.07it/s]100%|██████████| 11/11 [00:03<00:00,  1.43it/s]100%|██████████| 11/11 [00:03<00:00,  3.02it/s]
2025-03-13 14:41:53,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:53
2025-03-13 14:42:24,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7774 secs
2025-03-13 14:42:24,792 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 14:42:24,792 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 14:42:42,877 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0843 secs
2025-03-13 14:42:43,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6481 secs
2025-03-13 14:42:43,014 [INFO]: {
2025-03-13 14:42:43,014 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:43,014 [INFO]: 	index_param: efSearch=160
2025-03-13 14:42:43,014 [INFO]: 	index_path: knn.index
2025-03-13 14:42:43,014 [INFO]: 	size in bytes: 517042930
2025-03-13 14:42:43,014 [INFO]: 	avg_search_speed_ms: 9.083961819693595
2025-03-13 14:42:43,015 [INFO]: 	99p_search_speed_ms: 12.476859847083688
2025-03-13 14:42:43,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:43,015 [INFO]: 	nb vectors: 2628
2025-03-13 14:42:43,015 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:43,015 [INFO]: 	compression ratio: 0.9993093300782587
2025-03-13 14:42:43,015 [INFO]: }
2025-03-13 14:42:43,015 [INFO]: 	>>> Finished "Creating the index" in 53.6534 secs
2025-03-13 14:42:43,015 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6860 secs
2025-03-13 14:42:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 33705 [episode count 7/20]
[retrieval_preprocessing] for episode 91066 [episode count 8/20], we have num_retrieval=np.int64(2652) num_query=np.int64(108)
2025-03-13 14:42:45,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:45,765 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:45
2025-03-13 14:42:45,765 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.73it/s]
2025-03-13 14:42:45,793 [INFO]: There are 2652 embeddings of dim 49152
2025-03-13 14:42:45,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 14:42:45,794 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:45
2025-03-13 14:42:45,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:45,794 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:42:45,794 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:45,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:42:45,795 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:45
2025-03-13 14:42:45,795 [INFO]: 547.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:45,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:42:45,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:45
2025-03-13 14:42:45,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:45,796 [INFO]: 	Creating the index 03/13/2025, 14:42:45
2025-03-13 14:42:45,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:45
2025-03-13 14:42:45,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 14:42:45,799 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:45
2025-03-13 14:42:45,799 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:42:45,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.15it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.55it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.55it/s] 55%|█████▍    | 6/11 [00:00<00:00, 11.16it/s] 73%|███████▎  | 8/11 [00:00<00:00, 12.29it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.91it/s]100%|██████████| 11/11 [00:02<00:00,  3.98it/s]
2025-03-13 14:42:48,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:48
2025-03-13 14:43:20,749 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1773 secs
2025-03-13 14:43:20,749 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 14:43:20,749 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 14:43:37,290 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5413 secs
2025-03-13 14:43:37,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4939 secs
2025-03-13 14:43:37,293 [INFO]: {
2025-03-13 14:43:37,293 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:37,293 [INFO]: 	index_param: efSearch=182
2025-03-13 14:43:37,293 [INFO]: 	index_path: knn.index
2025-03-13 14:43:37,293 [INFO]: 	size in bytes: 521764690
2025-03-13 14:43:37,293 [INFO]: 	avg_search_speed_ms: 11.334087718922282
2025-03-13 14:43:37,293 [INFO]: 	99p_search_speed_ms: 21.608403467107554
2025-03-13 14:43:37,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:37,293 [INFO]: 	nb vectors: 2652
2025-03-13 14:43:37,293 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:37,293 [INFO]: 	compression ratio: 0.9993095086599286
2025-03-13 14:43:37,293 [INFO]: }
2025-03-13 14:43:37,293 [INFO]: 	>>> Finished "Creating the index" in 51.4977 secs
2025-03-13 14:43:37,293 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5287 secs
2025-03-13 14:43:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 91066 [episode count 8/20]
[retrieval_preprocessing] for episode 41322 [episode count 9/20], we have num_retrieval=np.int64(2650) num_query=np.int64(110)
2025-03-13 14:43:39,278 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:39,701 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:39
2025-03-13 14:43:39,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1114.62it/s]
2025-03-13 14:43:39,729 [INFO]: There are 2650 embeddings of dim 49152
2025-03-13 14:43:39,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 14:43:39,730 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:39,730 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:43:39,730 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:39,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:43:39,730 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,731 [INFO]: 546.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:39,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:43:39,731 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:39
2025-03-13 14:43:39,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:39,731 [INFO]: 	Creating the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,731 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:39
2025-03-13 14:43:39,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:43:39,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:39
2025-03-13 14:43:39,735 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:43:39,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.79it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.71it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.82it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.34it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.73it/s]100%|██████████| 11/11 [00:03<00:00,  2.09it/s]100%|██████████| 11/11 [00:03<00:00,  3.35it/s]
2025-03-13 14:43:43,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:43
2025-03-13 14:44:10,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7858 secs
2025-03-13 14:44:10,813 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 14:44:10,813 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 14:44:28,016 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2024 secs
2025-03-13 14:44:28,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2829 secs
2025-03-13 14:44:28,018 [INFO]: {
2025-03-13 14:44:28,018 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:28,018 [INFO]: 	index_param: efSearch=191
2025-03-13 14:44:28,018 [INFO]: 	index_path: knn.index
2025-03-13 14:44:28,018 [INFO]: 	size in bytes: 521371210
2025-03-13 14:44:28,018 [INFO]: 	avg_search_speed_ms: 9.911465326580704
2025-03-13 14:44:28,018 [INFO]: 	99p_search_speed_ms: 13.580736480653284
2025-03-13 14:44:28,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:28,018 [INFO]: 	nb vectors: 2650
2025-03-13 14:44:28,018 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:28,018 [INFO]: 	compression ratio: 0.9993094939016675
2025-03-13 14:44:28,018 [INFO]: }
2025-03-13 14:44:28,018 [INFO]: 	>>> Finished "Creating the index" in 48.2869 secs
2025-03-13 14:44:28,018 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3173 secs
2025-03-13 14:44:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 41322 [episode count 9/20]
[retrieval_preprocessing] for episode 42437 [episode count 10/20], we have num_retrieval=np.int64(2575) num_query=np.int64(185)
2025-03-13 14:44:33,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:33,959 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:33
2025-03-13 14:44:33,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1389.76it/s]
2025-03-13 14:44:33,985 [INFO]: There are 2575 embeddings of dim 49152
2025-03-13 14:44:33,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 14:44:33,985 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:33
2025-03-13 14:44:33,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:33,986 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:44:33,986 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:33,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:44:33,986 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:33
2025-03-13 14:44:33,986 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:33,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:44:33,986 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:33
2025-03-13 14:44:33,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:33,986 [INFO]: 	Creating the index 03/13/2025, 14:44:33
2025-03-13 14:44:33,986 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:33
2025-03-13 14:44:33,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:44:33,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:33
2025-03-13 14:44:33,987 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:44:33,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.69it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.53it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.36it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.72it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.98it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.97it/s]100%|██████████| 11/11 [00:03<00:00,  1.57it/s]100%|██████████| 11/11 [00:03<00:00,  3.18it/s]
2025-03-13 14:44:37,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:37
2025-03-13 14:45:10,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9368 secs
2025-03-13 14:45:10,391 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 14:45:10,391 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 14:45:26,142 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7507 secs
2025-03-13 14:45:26,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1564 secs
2025-03-13 14:45:26,144 [INFO]: {
2025-03-13 14:45:26,144 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:26,144 [INFO]: 	index_param: efSearch=149
2025-03-13 14:45:26,144 [INFO]: 	index_path: knn.index
2025-03-13 14:45:26,144 [INFO]: 	size in bytes: 506615410
2025-03-13 14:45:26,144 [INFO]: 	avg_search_speed_ms: 8.698926598248635
2025-03-13 14:45:26,144 [INFO]: 	99p_search_speed_ms: 11.64558329619467
2025-03-13 14:45:26,144 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:26,144 [INFO]: 	nb vectors: 2575
2025-03-13 14:45:26,144 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:26,144 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-13 14:45:26,144 [INFO]: }
2025-03-13 14:45:26,144 [INFO]: 	>>> Finished "Creating the index" in 52.1581 secs
2025-03-13 14:45:26,144 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1850 secs
2025-03-13 14:45:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 42437 [episode count 10/20]
[retrieval_preprocessing] for episode 25647 [episode count 11/20], we have num_retrieval=np.int64(2629) num_query=np.int64(131)
2025-03-13 14:45:28,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:29,140 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:29
2025-03-13 14:45:29,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-13 14:45:29,169 [INFO]: There are 2629 embeddings of dim 49152
2025-03-13 14:45:29,169 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 14:45:29,169 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:29,170 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:45:29,170 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:29,170 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:29,170 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,170 [INFO]: 542.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:29,170 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:45:29,170 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:29
2025-03-13 14:45:29,170 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:29,170 [INFO]: 	Creating the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,170 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:29
2025-03-13 14:45:29,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 14:45:29,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,172 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:45:29,173 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 13.05it/s] 36%|███▋      | 4/11 [00:00<00:00, 15.93it/s] 64%|██████▎   | 7/11 [00:00<00:00, 17.56it/s] 91%|█████████ | 10/11 [00:00<00:00, 19.08it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]
2025-03-13 14:45:31,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:31
2025-03-13 14:46:00,170 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3883 secs
2025-03-13 14:46:00,171 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 14:46:00,171 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.50it/s]
2025-03-13 14:46:21,037 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8659 secs
2025-03-13 14:46:21,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8668 secs
2025-03-13 14:46:21,039 [INFO]: {
2025-03-13 14:46:21,039 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:21,039 [INFO]: 	index_param: efSearch=133
2025-03-13 14:46:21,039 [INFO]: 	index_path: knn.index
2025-03-13 14:46:21,039 [INFO]: 	size in bytes: 517239670
2025-03-13 14:46:21,039 [INFO]: 	avg_search_speed_ms: 7.861783296388205
2025-03-13 14:46:21,040 [INFO]: 	99p_search_speed_ms: 13.361018307041356
2025-03-13 14:46:21,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:21,040 [INFO]: 	nb vectors: 2629
2025-03-13 14:46:21,040 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:21,040 [INFO]: 	compression ratio: 0.9993093375842576
2025-03-13 14:46:21,040 [INFO]: }
2025-03-13 14:46:21,040 [INFO]: 	>>> Finished "Creating the index" in 51.8695 secs
2025-03-13 14:46:21,040 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8991 secs
2025-03-13 14:46:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 25647 [episode count 11/20]
[retrieval_preprocessing] for episode 91185 [episode count 12/20], we have num_retrieval=np.int64(2631) num_query=np.int64(129)
2025-03-13 14:46:22,693 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:23,106 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:23
2025-03-13 14:46:23,106 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1094.26it/s]
2025-03-13 14:46:23,132 [INFO]: There are 2631 embeddings of dim 49152
2025-03-13 14:46:23,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 14:46:23,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:23
2025-03-13 14:46:23,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:23,132 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:46:23,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:23,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:46:23,132 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:23
2025-03-13 14:46:23,133 [INFO]: 543.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:23,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:46:23,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:23
2025-03-13 14:46:23,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:23,133 [INFO]: 	Creating the index 03/13/2025, 14:46:23
2025-03-13 14:46:23,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:23
2025-03-13 14:46:23,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:46:23,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:23
2025-03-13 14:46:23,134 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:46:23,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.61it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.82it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.73it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.47it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.89it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.02it/s]100%|██████████| 11/11 [00:03<00:00,  1.94it/s]100%|██████████| 11/11 [00:03<00:00,  3.52it/s]
2025-03-13 14:46:26,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:26
2025-03-13 14:47:01,636 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3765 secs
2025-03-13 14:47:01,636 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 14:47:01,636 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 14:47:20,105 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4683 secs
2025-03-13 14:47:20,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4643 secs
2025-03-13 14:47:20,599 [INFO]: {
2025-03-13 14:47:20,599 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:20,599 [INFO]: 	index_param: efSearch=141
2025-03-13 14:47:20,599 [INFO]: 	index_path: knn.index
2025-03-13 14:47:20,599 [INFO]: 	size in bytes: 517633150
2025-03-13 14:47:20,599 [INFO]: 	avg_search_speed_ms: 7.874973598632991
2025-03-13 14:47:20,599 [INFO]: 	99p_search_speed_ms: 10.559849280398335
2025-03-13 14:47:20,599 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:20,599 [INFO]: 	nb vectors: 2631
2025-03-13 14:47:20,599 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:20,599 [INFO]: 	compression ratio: 0.9993093525791383
2025-03-13 14:47:20,599 [INFO]: }
2025-03-13 14:47:20,599 [INFO]: 	>>> Finished "Creating the index" in 57.4665 secs
2025-03-13 14:47:20,599 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4937 secs
2025-03-13 14:47:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 91185 [episode count 12/20]
[retrieval_preprocessing] for episode 35181 [episode count 13/20], we have num_retrieval=np.int64(2540) num_query=np.int64(220)
2025-03-13 14:47:22,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:22,805 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:22
2025-03-13 14:47:22,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.15it/s]
2025-03-13 14:47:22,829 [INFO]: There are 2540 embeddings of dim 49152
2025-03-13 14:47:22,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 14:47:22,830 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:22
2025-03-13 14:47:22,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:22,831 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:47:22,831 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:22,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:47:22,831 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:22
2025-03-13 14:47:22,832 [INFO]: 524.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:22,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:47:22,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:22
2025-03-13 14:47:22,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:22,832 [INFO]: 	Creating the index 03/13/2025, 14:47:22
2025-03-13 14:47:22,833 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:22
2025-03-13 14:47:22,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 14:47:22,836 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:22
2025-03-13 14:47:22,837 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:47:22,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.95it/s] 20%|██        | 2/10 [00:00<00:01,  7.60it/s] 30%|███       | 3/10 [00:00<00:00,  8.41it/s] 40%|████      | 4/10 [00:00<00:00,  8.62it/s] 50%|█████     | 5/10 [00:00<00:00,  8.61it/s] 60%|██████    | 6/10 [00:00<00:00,  8.49it/s] 70%|███████   | 7/10 [00:00<00:00,  8.37it/s] 80%|████████  | 8/10 [00:00<00:00,  8.34it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.30it/s]100%|██████████| 10/10 [00:02<00:00,  1.55it/s]100%|██████████| 10/10 [00:02<00:00,  3.43it/s]
2025-03-13 14:47:25,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:25
2025-03-13 14:47:56,704 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9442 secs
2025-03-13 14:47:56,704 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 14:47:56,704 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 14:48:16,226 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5213 secs
2025-03-13 14:48:16,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3978 secs
2025-03-13 14:48:16,234 [INFO]: {
2025-03-13 14:48:16,234 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:16,235 [INFO]: 	index_param: efSearch=179
2025-03-13 14:48:16,235 [INFO]: 	index_path: knn.index
2025-03-13 14:48:16,235 [INFO]: 	size in bytes: 499729270
2025-03-13 14:48:16,235 [INFO]: 	avg_search_speed_ms: 10.07596662029819
2025-03-13 14:48:16,235 [INFO]: 	99p_search_speed_ms: 16.90686945803464
2025-03-13 14:48:16,235 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:16,235 [INFO]: 	nb vectors: 2540
2025-03-13 14:48:16,235 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:16,235 [INFO]: 	compression ratio: 0.9993097262443723
2025-03-13 14:48:16,235 [INFO]: }
2025-03-13 14:48:16,235 [INFO]: 	>>> Finished "Creating the index" in 53.4022 secs
2025-03-13 14:48:16,235 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4296 secs
2025-03-13 14:48:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 35181 [episode count 13/20]
[retrieval_preprocessing] for episode 18810 [episode count 14/20], we have num_retrieval=np.int64(2628) num_query=np.int64(132)
2025-03-13 14:48:19,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:19,755 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:19
2025-03-13 14:48:19,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1339.61it/s]
2025-03-13 14:48:19,779 [INFO]: There are 2628 embeddings of dim 49152
2025-03-13 14:48:19,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 14:48:19,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:19
2025-03-13 14:48:19,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:19,779 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:48:19,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:19,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:48:19,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:19
2025-03-13 14:48:19,779 [INFO]: 542.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:19,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:48:19,780 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:19
2025-03-13 14:48:19,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:19,780 [INFO]: 	Creating the index 03/13/2025, 14:48:19
2025-03-13 14:48:19,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:19
2025-03-13 14:48:19,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:48:19,781 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:19
2025-03-13 14:48:19,781 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:48:19,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.85it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.00it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.73it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.69it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.84it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.67it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.42it/s]100%|██████████| 11/11 [00:03<00:00,  1.34it/s]100%|██████████| 11/11 [00:03<00:00,  3.06it/s]
2025-03-13 14:48:23,379 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:23
2025-03-13 14:48:52,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0956 secs
2025-03-13 14:48:52,475 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 14:48:52,475 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 14:49:09,589 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1139 secs
2025-03-13 14:49:09,591 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8104 secs
2025-03-13 14:49:09,591 [INFO]: {
2025-03-13 14:49:09,591 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:09,591 [INFO]: 	index_param: efSearch=150
2025-03-13 14:49:09,591 [INFO]: 	index_path: knn.index
2025-03-13 14:49:09,591 [INFO]: 	size in bytes: 517042930
2025-03-13 14:49:09,591 [INFO]: 	avg_search_speed_ms: 8.791788349825044
2025-03-13 14:49:09,591 [INFO]: 	99p_search_speed_ms: 13.488004785031078
2025-03-13 14:49:09,591 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:09,591 [INFO]: 	nb vectors: 2628
2025-03-13 14:49:09,591 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:09,591 [INFO]: 	compression ratio: 0.9993093300782587
2025-03-13 14:49:09,591 [INFO]: }
2025-03-13 14:49:09,591 [INFO]: 	>>> Finished "Creating the index" in 49.8118 secs
2025-03-13 14:49:09,591 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8360 secs
2025-03-13 14:49:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 18810 [episode count 14/20]
[retrieval_preprocessing] for episode 1642 [episode count 15/20], we have num_retrieval=np.int64(2629) num_query=np.int64(131)
2025-03-13 14:49:11,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:11,847 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:11
2025-03-13 14:49:11,847 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 774.00it/s]
2025-03-13 14:49:11,874 [INFO]: There are 2629 embeddings of dim 49152
2025-03-13 14:49:11,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 14:49:11,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:11
2025-03-13 14:49:11,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:11,874 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:49:11,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:11,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:11,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:11
2025-03-13 14:49:11,875 [INFO]: 542.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:11,875 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:49:11,875 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:11
2025-03-13 14:49:11,875 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:11,875 [INFO]: 	Creating the index 03/13/2025, 14:49:11
2025-03-13 14:49:11,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:11
2025-03-13 14:49:11,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:49:11,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:11
2025-03-13 14:49:11,876 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:49:11,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.79it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.42it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.56it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.22it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.66it/s]100%|██████████| 11/11 [00:02<00:00,  2.65it/s]100%|██████████| 11/11 [00:02<00:00,  4.12it/s]
2025-03-13 14:49:15,173 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:15
2025-03-13 14:49:42,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0440 secs
2025-03-13 14:49:42,217 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 14:49:42,217 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 14:50:08,223 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0051 secs
2025-03-13 14:50:08,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3491 secs
2025-03-13 14:50:08,225 [INFO]: {
2025-03-13 14:50:08,225 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:08,225 [INFO]: 	index_param: efSearch=162
2025-03-13 14:50:08,225 [INFO]: 	index_path: knn.index
2025-03-13 14:50:08,225 [INFO]: 	size in bytes: 517239670
2025-03-13 14:50:08,225 [INFO]: 	avg_search_speed_ms: 8.993468193543352
2025-03-13 14:50:08,225 [INFO]: 	99p_search_speed_ms: 15.959549404215101
2025-03-13 14:50:08,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:08,225 [INFO]: 	nb vectors: 2629
2025-03-13 14:50:08,225 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:08,225 [INFO]: 	compression ratio: 0.9993093375842576
2025-03-13 14:50:08,225 [INFO]: }
2025-03-13 14:50:08,226 [INFO]: 	>>> Finished "Creating the index" in 56.3506 secs
2025-03-13 14:50:08,226 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3789 secs
2025-03-13 14:50:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 1642 [episode count 15/20]
[retrieval_preprocessing] for episode 91464 [episode count 16/20], we have num_retrieval=np.int64(2649) num_query=np.int64(111)
2025-03-13 14:50:10,131 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:10,621 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:10
2025-03-13 14:50:10,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2049.00it/s]
2025-03-13 14:50:10,645 [INFO]: There are 2649 embeddings of dim 49152
2025-03-13 14:50:10,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 14:50:10,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:10
2025-03-13 14:50:10,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:10,645 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:50:10,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:10,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:50:10,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:10
2025-03-13 14:50:10,645 [INFO]: 546.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:10,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:50:10,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:10
2025-03-13 14:50:10,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:10,645 [INFO]: 	Creating the index 03/13/2025, 14:50:10
2025-03-13 14:50:10,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:10
2025-03-13 14:50:10,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:50:10,647 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:10
2025-03-13 14:50:10,647 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:50:10,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.84it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.13it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.69it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.03it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.18it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.31it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.36it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.12it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.19it/s]100%|██████████| 11/11 [00:03<00:00,  1.68it/s]100%|██████████| 11/11 [00:03<00:00,  3.28it/s]
2025-03-13 14:50:14,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:14
2025-03-13 14:50:46,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5963 secs
2025-03-13 14:50:46,598 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 14:50:46,598 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 14:51:02,771 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1728 secs
2025-03-13 14:51:02,773 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1266 secs
2025-03-13 14:51:02,773 [INFO]: {
2025-03-13 14:51:02,773 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:02,773 [INFO]: 	index_param: efSearch=161
2025-03-13 14:51:02,774 [INFO]: 	index_path: knn.index
2025-03-13 14:51:02,774 [INFO]: 	size in bytes: 521174470
2025-03-13 14:51:02,774 [INFO]: 	avg_search_speed_ms: 8.99405094959083
2025-03-13 14:51:02,774 [INFO]: 	99p_search_speed_ms: 14.957845308817927
2025-03-13 14:51:02,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:02,774 [INFO]: 	nb vectors: 2649
2025-03-13 14:51:02,774 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:02,774 [INFO]: 	compression ratio: 0.9993094865141802
2025-03-13 14:51:02,774 [INFO]: }
2025-03-13 14:51:02,774 [INFO]: 	>>> Finished "Creating the index" in 52.1282 secs
2025-03-13 14:51:02,774 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1531 secs
2025-03-13 14:51:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 91464 [episode count 16/20]
[retrieval_preprocessing] for episode 17949 [episode count 17/20], we have num_retrieval=np.int64(2636) num_query=np.int64(124)
2025-03-13 14:51:04,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:05,072 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:05
2025-03-13 14:51:05,072 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1693.98it/s]
2025-03-13 14:51:05,094 [INFO]: There are 2636 embeddings of dim 49152
2025-03-13 14:51:05,094 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 14:51:05,094 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:05
2025-03-13 14:51:05,095 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:05,095 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:51:05,095 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:05,095 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:05,095 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:05
2025-03-13 14:51:05,095 [INFO]: 544.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:05,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:51:05,095 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:05
2025-03-13 14:51:05,095 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:05,095 [INFO]: 	Creating the index 03/13/2025, 14:51:05
2025-03-13 14:51:05,095 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:05
2025-03-13 14:51:05,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:51:05,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:05
2025-03-13 14:51:05,096 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:51:05,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.32it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.79it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.37it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.96it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.25it/s]100%|██████████| 11/11 [00:02<00:00,  2.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.06it/s]
2025-03-13 14:51:07,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:07
2025-03-13 14:51:39,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0673 secs
2025-03-13 14:51:39,877 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 14:51:39,879 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 14:51:57,037 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1583 secs
2025-03-13 14:51:57,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9435 secs
2025-03-13 14:51:57,040 [INFO]: {
2025-03-13 14:51:57,040 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:57,040 [INFO]: 	index_param: efSearch=133
2025-03-13 14:51:57,040 [INFO]: 	index_path: knn.index
2025-03-13 14:51:57,040 [INFO]: 	size in bytes: 518616850
2025-03-13 14:51:57,040 [INFO]: 	avg_search_speed_ms: 7.933831280688682
2025-03-13 14:51:57,040 [INFO]: 	99p_search_speed_ms: 13.398734538350267
2025-03-13 14:51:57,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:57,040 [INFO]: 	nb vectors: 2636
2025-03-13 14:51:57,040 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:57,040 [INFO]: 	compression ratio: 0.9993093899667934
2025-03-13 14:51:57,040 [INFO]: }
2025-03-13 14:51:57,040 [INFO]: 	>>> Finished "Creating the index" in 51.9449 secs
2025-03-13 14:51:57,040 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9682 secs
2025-03-13 14:51:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 17949 [episode count 17/20]
[retrieval_preprocessing] for episode 42641 [episode count 18/20], we have num_retrieval=np.int64(2642) num_query=np.int64(118)
2025-03-13 14:51:58,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:59,410 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:59
2025-03-13 14:51:59,410 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1101.16it/s]
2025-03-13 14:51:59,435 [INFO]: There are 2642 embeddings of dim 49152
2025-03-13 14:51:59,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 14:51:59,435 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:59
2025-03-13 14:51:59,435 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:59,435 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:51:59,435 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:59,435 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:59,435 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:59
2025-03-13 14:51:59,435 [INFO]: 545.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:59,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:51:59,435 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:59
2025-03-13 14:51:59,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:59,435 [INFO]: 	Creating the index 03/13/2025, 14:51:59
2025-03-13 14:51:59,435 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:59
2025-03-13 14:51:59,436 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:51:59,436 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:59
2025-03-13 14:51:59,436 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:51:59,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.55it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.52it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.32it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.94it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.30it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.66it/s]
2025-03-13 14:52:02,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:02
2025-03-13 14:52:36,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7144 secs
2025-03-13 14:52:36,163 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 14:52:36,163 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 14:52:52,605 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4419 secs
2025-03-13 14:52:52,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1711 secs
2025-03-13 14:52:52,608 [INFO]: {
2025-03-13 14:52:52,608 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:52,608 [INFO]: 	index_param: efSearch=152
2025-03-13 14:52:52,608 [INFO]: 	index_path: knn.index
2025-03-13 14:52:52,608 [INFO]: 	size in bytes: 519797290
2025-03-13 14:52:52,608 [INFO]: 	avg_search_speed_ms: 9.883963503403656
2025-03-13 14:52:52,608 [INFO]: 	99p_search_speed_ms: 19.323118415195495
2025-03-13 14:52:52,608 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:52,608 [INFO]: 	nb vectors: 2642
2025-03-13 14:52:52,608 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:52,608 [INFO]: 	compression ratio: 0.9993094346451864
2025-03-13 14:52:52,608 [INFO]: }
2025-03-13 14:52:52,608 [INFO]: 	>>> Finished "Creating the index" in 53.1726 secs
2025-03-13 14:52:52,608 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1980 secs
2025-03-13 14:52:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 42641 [episode count 18/20]
[retrieval_preprocessing] for episode 58650 [episode count 19/20], we have num_retrieval=np.int64(2619) num_query=np.int64(141)
2025-03-13 14:52:54,558 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:54,980 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:54
2025-03-13 14:52:54,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.90it/s]
2025-03-13 14:52:55,006 [INFO]: There are 2619 embeddings of dim 49152
2025-03-13 14:52:55,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 14:52:55,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:55
2025-03-13 14:52:55,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:55,006 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:52:55,006 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:55,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:55,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:55
2025-03-13 14:52:55,006 [INFO]: 540.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:55,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:52:55,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:55
2025-03-13 14:52:55,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:55,006 [INFO]: 	Creating the index 03/13/2025, 14:52:55
2025-03-13 14:52:55,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:55
2025-03-13 14:52:55,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:52:55,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:55
2025-03-13 14:52:55,008 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:52:55,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.94it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.59it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.50it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.93it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.19it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.29it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.38it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.52it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.44it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.37it/s]100%|██████████| 11/11 [00:03<00:00,  1.32it/s]100%|██████████| 11/11 [00:03<00:00,  3.18it/s]
2025-03-13 14:52:58,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:58
2025-03-13 14:53:27,885 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4132 secs
2025-03-13 14:53:27,885 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 14:53:27,885 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 14:53:52,184 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2988 secs
2025-03-13 14:53:52,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3867 secs
2025-03-13 14:53:52,395 [INFO]: {
2025-03-13 14:53:52,395 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:52,395 [INFO]: 	index_param: efSearch=180
2025-03-13 14:53:52,395 [INFO]: 	index_path: knn.index
2025-03-13 14:53:52,395 [INFO]: 	size in bytes: 515272210
2025-03-13 14:53:52,395 [INFO]: 	avg_search_speed_ms: 10.11273118477085
2025-03-13 14:53:52,395 [INFO]: 	99p_search_speed_ms: 15.696996422484519
2025-03-13 14:53:52,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:52,395 [INFO]: 	nb vectors: 2619
2025-03-13 14:53:52,395 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:52,395 [INFO]: 	compression ratio: 0.9993093786292103
2025-03-13 14:53:52,395 [INFO]: }
2025-03-13 14:53:52,396 [INFO]: 	>>> Finished "Creating the index" in 57.3892 secs
2025-03-13 14:53:52,396 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4152 secs
2025-03-13 14:53:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 58650 [episode count 19/20]
2025-03-13 14:53:53: [retrieval_preprocessing] finished for -1_put_marker_in_mug [chosen_id count 0/196]
2025-03-13 14:53:56: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_cup [chosen_id count 1/196]
2025-03-13 14:53:56: [retrieval_preprocessing] we have num_total=2916 embedding_dim=49152
[retrieval_preprocessing] for episode 40961 [episode count 0/20], we have num_retrieval=np.int64(2778) num_query=np.int64(138)
2025-03-13 14:53:57,278 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:58,219 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:58
2025-03-13 14:53:58,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1079.06it/s]
2025-03-13 14:53:58,246 [INFO]: There are 2778 embeddings of dim 49152
2025-03-13 14:53:58,246 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 14:53:58,246 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:58
2025-03-13 14:53:58,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:58,246 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:53:58,246 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:58,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:58,246 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:58
2025-03-13 14:53:58,247 [INFO]: 573.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:58,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:58,247 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:58
2025-03-13 14:53:58,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:58,247 [INFO]: 	Creating the index 03/13/2025, 14:53:58
2025-03-13 14:53:58,247 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:58
2025-03-13 14:53:58,248 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:53:58,248 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:58
2025-03-13 14:53:58,248 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:53:58,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.98it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.61it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.08it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.47it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.51it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.60it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.82it/s]100%|██████████| 11/11 [00:03<00:00,  1.75it/s]100%|██████████| 11/11 [00:03<00:00,  3.47it/s]
2025-03-13 14:54:01,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:01
2025-03-13 14:54:33,238 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8104 secs
2025-03-13 14:54:33,238 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 14:54:33,238 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.39s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.44it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.92it/s]
2025-03-13 14:54:55,808 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5694 secs
2025-03-13 14:54:55,811 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5624 secs
2025-03-13 14:54:55,811 [INFO]: {
2025-03-13 14:54:55,811 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:55,811 [INFO]: 	index_param: efSearch=204
2025-03-13 14:54:55,811 [INFO]: 	index_path: knn.index
2025-03-13 14:54:55,811 [INFO]: 	size in bytes: 546554230
2025-03-13 14:54:55,811 [INFO]: 	avg_search_speed_ms: 12.426777969270667
2025-03-13 14:54:55,811 [INFO]: 	99p_search_speed_ms: 26.428483650088353
2025-03-13 14:54:55,811 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:55,811 [INFO]: 	nb vectors: 2778
2025-03-13 14:54:55,811 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:55,811 [INFO]: 	compression ratio: 0.9993098470759251
2025-03-13 14:54:55,811 [INFO]: }
2025-03-13 14:54:55,811 [INFO]: 	>>> Finished "Creating the index" in 57.5641 secs
2025-03-13 14:54:55,811 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5915 secs
2025-03-13 14:54:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 40961 [episode count 0/20]
[retrieval_preprocessing] for episode 8202 [episode count 1/20], we have num_retrieval=np.int64(2767) num_query=np.int64(149)
2025-03-13 14:55:29,414 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:30,064 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:30
2025-03-13 14:55:30,064 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.21it/s]
2025-03-13 14:55:30,104 [INFO]: There are 2767 embeddings of dim 49152
2025-03-13 14:55:30,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 14:55:30,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:30,105 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:55:30,105 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:30,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:55:30,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,106 [INFO]: 571.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:30,106 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:55:30,106 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:30
2025-03-13 14:55:30,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:30,106 [INFO]: 	Creating the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,106 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:30
2025-03-13 14:55:30,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 14:55:30,109 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,109 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:55:30,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.79it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.39it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.26it/s] 36%|███▋      | 4/11 [00:00<00:01,  5.38it/s] 45%|████▌     | 5/11 [00:00<00:01,  5.57it/s] 55%|█████▍    | 6/11 [00:01<00:00,  5.43it/s] 64%|██████▎   | 7/11 [00:01<00:00,  5.03it/s] 73%|███████▎  | 8/11 [00:01<00:00,  4.35it/s] 82%|████████▏ | 9/11 [00:02<00:00,  3.56it/s] 91%|█████████ | 10/11 [00:02<00:00,  4.26it/s]100%|██████████| 11/11 [00:04<00:00,  1.02s/it]100%|██████████| 11/11 [00:04<00:00,  2.22it/s]
2025-03-13 14:55:35,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:35
2025-03-13 14:56:24,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.3626 secs
2025-03-13 14:56:24,439 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 14:56:24,439 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.13s/it] 50%|█████     | 2/4 [00:04<00:04,  2.08s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.53s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.20s/it]
2025-03-13 14:56:56,897 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4576 secs
2025-03-13 14:56:56,900 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7905 secs
2025-03-13 14:56:56,900 [INFO]: {
2025-03-13 14:56:56,900 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:56,900 [INFO]: 	index_param: efSearch=183
2025-03-13 14:56:56,900 [INFO]: 	index_path: knn.index
2025-03-13 14:56:56,900 [INFO]: 	size in bytes: 544390090
2025-03-13 14:56:56,900 [INFO]: 	avg_search_speed_ms: 8.906099138478169
2025-03-13 14:56:56,900 [INFO]: 	99p_search_speed_ms: 11.881439923308788
2025-03-13 14:56:56,900 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:56,900 [INFO]: 	nb vectors: 2767
2025-03-13 14:56:56,900 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:56,900 [INFO]: 	compression ratio: 0.9993097706830042
2025-03-13 14:56:56,900 [INFO]: }
2025-03-13 14:56:56,900 [INFO]: 	>>> Finished "Creating the index" in 86.7939 secs
2025-03-13 14:56:56,900 [INFO]: >>> Finished "Launching the whole pipeline" in 86.8358 secs
2025-03-13 14:56:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 8202 [episode count 1/20]
[retrieval_preprocessing] for episode 32784 [episode count 2/20], we have num_retrieval=np.int64(2790) num_query=np.int64(126)
2025-03-13 14:57:00,558 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:01,091 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:01
2025-03-13 14:57:01,091 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.45it/s]
2025-03-13 14:57:01,118 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 14:57:01,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 14:57:01,119 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:01
2025-03-13 14:57:01,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:01,119 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:57:01,119 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:01,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:57:01,119 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:01
2025-03-13 14:57:01,120 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:01,120 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:57:01,120 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:01
2025-03-13 14:57:01,120 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:01,120 [INFO]: 	Creating the index 03/13/2025, 14:57:01
2025-03-13 14:57:01,120 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:01
2025-03-13 14:57:01,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:57:01,124 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:01
2025-03-13 14:57:01,124 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:57:01,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.44it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.60it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.15it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.43it/s] 45%|████▌     | 5/11 [00:00<00:00,  6.57it/s] 55%|█████▍    | 6/11 [00:00<00:00,  6.79it/s] 64%|██████▎   | 7/11 [00:01<00:00,  6.90it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.08it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.49it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.92it/s]100%|██████████| 11/11 [00:03<00:00,  1.27it/s]100%|██████████| 11/11 [00:03<00:00,  2.95it/s]
2025-03-13 14:57:04,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:04
2025-03-13 14:57:48,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6543 secs
2025-03-13 14:57:48,515 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 14:57:48,516 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  5.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.61it/s]
2025-03-13 14:58:11,946 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4306 secs
2025-03-13 14:58:11,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8251 secs
2025-03-13 14:58:11,949 [INFO]: {
2025-03-13 14:58:11,949 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:11,949 [INFO]: 	index_param: efSearch=164
2025-03-13 14:58:11,949 [INFO]: 	index_path: knn.index
2025-03-13 14:58:11,949 [INFO]: 	size in bytes: 548915110
2025-03-13 14:58:11,949 [INFO]: 	avg_search_speed_ms: 9.519127895612092
2025-03-13 14:58:11,949 [INFO]: 	99p_search_speed_ms: 15.893277633003889
2025-03-13 14:58:11,949 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:11,949 [INFO]: 	nb vectors: 2790
2025-03-13 14:58:11,949 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:11,949 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 14:58:11,949 [INFO]: }
2025-03-13 14:58:11,949 [INFO]: 	>>> Finished "Creating the index" in 70.8290 secs
2025-03-13 14:58:11,949 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8588 secs
2025-03-13 14:58:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 32784 [episode count 2/20]
[retrieval_preprocessing] for episode 24593 [episode count 3/20], we have num_retrieval=np.int64(2781) num_query=np.int64(135)
2025-03-13 14:58:14,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:15,034 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:15
2025-03-13 14:58:15,034 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.64it/s]
2025-03-13 14:58:15,063 [INFO]: There are 2781 embeddings of dim 49152
2025-03-13 14:58:15,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 14:58:15,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:15
2025-03-13 14:58:15,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:15,063 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:58:15,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:15,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:58:15,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:15
2025-03-13 14:58:15,064 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:15,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:58:15,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:15
2025-03-13 14:58:15,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:15,064 [INFO]: 	Creating the index 03/13/2025, 14:58:15
2025-03-13 14:58:15,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:15
2025-03-13 14:58:15,065 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:58:15,065 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:15
2025-03-13 14:58:15,065 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:58:15,065 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.61it/s] 18%|█▊        | 2/11 [00:00<00:00,  9.70it/s] 36%|███▋      | 4/11 [00:00<00:00, 10.69it/s] 55%|█████▍    | 6/11 [00:00<00:00, 11.11it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.43it/s] 91%|█████████ | 10/11 [00:00<00:00, 11.32it/s]100%|██████████| 11/11 [00:03<00:00,  3.24it/s]
2025-03-13 14:58:18,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:18
2025-03-13 14:58:57,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7030 secs
2025-03-13 14:58:57,175 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 14:58:57,175 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 14:59:18,914 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7381 secs
2025-03-13 14:59:18,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8515 secs
2025-03-13 14:59:18,917 [INFO]: {
2025-03-13 14:59:18,917 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:18,917 [INFO]: 	index_param: efSearch=167
2025-03-13 14:59:18,917 [INFO]: 	index_path: knn.index
2025-03-13 14:59:18,917 [INFO]: 	size in bytes: 547144450
2025-03-13 14:59:18,917 [INFO]: 	avg_search_speed_ms: 9.045996217107678
2025-03-13 14:59:18,917 [INFO]: 	99p_search_speed_ms: 13.09805008582771
2025-03-13 14:59:18,917 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:18,917 [INFO]: 	nb vectors: 2781
2025-03-13 14:59:18,917 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:18,917 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-13 14:59:18,917 [INFO]: }
2025-03-13 14:59:18,917 [INFO]: 	>>> Finished "Creating the index" in 63.8534 secs
2025-03-13 14:59:18,917 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8831 secs
2025-03-13 14:59:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 24593 [episode count 3/20]
[retrieval_preprocessing] for episode 24594 [episode count 4/20], we have num_retrieval=np.int64(2811) num_query=np.int64(105)
2025-03-13 14:59:20,773 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:21,207 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:21
2025-03-13 14:59:21,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.74it/s]
2025-03-13 14:59:21,232 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 14:59:21,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 14:59:21,233 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:21
2025-03-13 14:59:21,233 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:21,233 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:59:21,233 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:21,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:21,233 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:21
2025-03-13 14:59:21,233 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:21,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:21,233 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:21
2025-03-13 14:59:21,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:21,233 [INFO]: 	Creating the index 03/13/2025, 14:59:21
2025-03-13 14:59:21,233 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:21
2025-03-13 14:59:21,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:59:21,234 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:21
2025-03-13 14:59:21,234 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:59:21,235 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.93it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.16it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.78it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.98it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.09it/s] 50%|█████     | 6/12 [00:00<00:00,  7.13it/s] 58%|█████▊    | 7/12 [00:01<00:00,  7.33it/s] 67%|██████▋   | 8/12 [00:01<00:00,  6.97it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.16it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.29it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.37it/s]100%|██████████| 12/12 [00:03<00:00,  1.27it/s]100%|██████████| 12/12 [00:03<00:00,  3.12it/s]
2025-03-13 14:59:25,079 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:25
2025-03-13 15:00:01,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3782 secs
2025-03-13 15:00:01,458 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:00:01,459 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 15:00:27,191 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7323 secs
2025-03-13 15:00:27,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9592 secs
2025-03-13 15:00:27,194 [INFO]: {
2025-03-13 15:00:27,194 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:27,194 [INFO]: 	index_param: efSearch=185
2025-03-13 15:00:27,194 [INFO]: 	index_path: knn.index
2025-03-13 15:00:27,194 [INFO]: 	size in bytes: 553046830
2025-03-13 15:00:27,194 [INFO]: 	avg_search_speed_ms: 9.573940761294573
2025-03-13 15:00:27,194 [INFO]: 	99p_search_speed_ms: 15.250138749834138
2025-03-13 15:00:27,194 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:27,194 [INFO]: 	nb vectors: 2811
2025-03-13 15:00:27,194 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:27,194 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 15:00:27,194 [INFO]: }
2025-03-13 15:00:27,194 [INFO]: 	>>> Finished "Creating the index" in 65.9608 secs
2025-03-13 15:00:27,194 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9869 secs
2025-03-13 15:00:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 24594 [episode count 4/20]
[retrieval_preprocessing] for episode 73745 [episode count 5/20], we have num_retrieval=np.int64(2756) num_query=np.int64(160)
2025-03-13 15:00:28,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:29,477 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:29
2025-03-13 15:00:29,477 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.00it/s]
2025-03-13 15:00:29,504 [INFO]: There are 2756 embeddings of dim 49152
2025-03-13 15:00:29,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:00:29,504 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:29,504 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:00:29,504 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:29,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:00:29,504 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,504 [INFO]: 568.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:29,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:00:29,504 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:29
2025-03-13 15:00:29,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:29,505 [INFO]: 	Creating the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:29
2025-03-13 15:00:29,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:00:29,506 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,506 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:00:29,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.40it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.82it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.33it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.49it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.63it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.39it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.43it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.31it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.24it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.36it/s]100%|██████████| 11/11 [00:03<00:00,  1.23it/s]100%|██████████| 11/11 [00:03<00:00,  2.96it/s]
2025-03-13 15:00:33,237 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:33
2025-03-13 15:01:06,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6394 secs
2025-03-13 15:01:06,878 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:01:06,878 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.79it/s]
2025-03-13 15:01:26,751 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8735 secs
2025-03-13 15:01:26,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2482 secs
2025-03-13 15:01:26,754 [INFO]: {
2025-03-13 15:01:26,754 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:26,754 [INFO]: 	index_param: efSearch=191
2025-03-13 15:01:26,754 [INFO]: 	index_path: knn.index
2025-03-13 15:01:26,754 [INFO]: 	size in bytes: 542225770
2025-03-13 15:01:26,754 [INFO]: 	avg_search_speed_ms: 9.744076700254796
2025-03-13 15:01:26,754 [INFO]: 	99p_search_speed_ms: 13.215996965300292
2025-03-13 15:01:26,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:26,754 [INFO]: 	nb vectors: 2756
2025-03-13 15:01:26,754 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:26,754 [INFO]: 	compression ratio: 0.9993100254161656
2025-03-13 15:01:26,754 [INFO]: }
2025-03-13 15:01:26,754 [INFO]: 	>>> Finished "Creating the index" in 57.2498 secs
2025-03-13 15:01:26,754 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2776 secs
2025-03-13 15:01:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 73745 [episode count 5/20]
[retrieval_preprocessing] for episode 57370 [episode count 6/20], we have num_retrieval=np.int64(2780) num_query=np.int64(136)
2025-03-13 15:01:29,606 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:30,258 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:30
2025-03-13 15:01:30,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.00it/s]
2025-03-13 15:01:30,288 [INFO]: There are 2780 embeddings of dim 49152
2025-03-13 15:01:30,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 15:01:30,288 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:30,289 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:01:30,289 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:30,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:01:30,289 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,289 [INFO]: 573.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:30,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:01:30,290 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:30
2025-03-13 15:01:30,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:30,290 [INFO]: 	Creating the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,290 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:30
2025-03-13 15:01:30,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:01:30,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,293 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:01:30,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.61it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.93it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.45it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.71it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.08it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.17it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.77it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.90it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.08it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.92it/s]100%|██████████| 11/11 [00:03<00:00,  1.20it/s]100%|██████████| 11/11 [00:03<00:00,  2.89it/s]
2025-03-13 15:01:34,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:34
2025-03-13 15:02:04,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7270 secs
2025-03-13 15:02:04,840 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 15:02:04,840 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 15:02:33,734 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8944 secs
2025-03-13 15:02:33,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4435 secs
2025-03-13 15:02:33,737 [INFO]: {
2025-03-13 15:02:33,737 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:33,737 [INFO]: 	index_param: efSearch=225
2025-03-13 15:02:33,737 [INFO]: 	index_path: knn.index
2025-03-13 15:02:33,737 [INFO]: 	size in bytes: 546947710
2025-03-13 15:02:33,737 [INFO]: 	avg_search_speed_ms: 11.609452061372401
2025-03-13 15:02:33,737 [INFO]: 	99p_search_speed_ms: 18.562398073263463
2025-03-13 15:02:33,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:33,737 [INFO]: 	nb vectors: 2780
2025-03-13 15:02:33,737 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:33,737 [INFO]: 	compression ratio: 0.9993098609005969
2025-03-13 15:02:33,737 [INFO]: }
2025-03-13 15:02:33,737 [INFO]: 	>>> Finished "Creating the index" in 63.4472 secs
2025-03-13 15:02:33,737 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4789 secs
2025-03-13 15:02:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 57370 [episode count 6/20]
[retrieval_preprocessing] for episode 90167 [episode count 7/20], we have num_retrieval=np.int64(2765) num_query=np.int64(151)
2025-03-13 15:02:36,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:36,943 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:36
2025-03-13 15:02:36,943 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.74it/s]
2025-03-13 15:02:36,971 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 15:02:36,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:02:36,971 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:36,971 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:02:36,971 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:36,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:36,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,972 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:36,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:02:36,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:36
2025-03-13 15:02:36,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:36,972 [INFO]: 	Creating the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:36
2025-03-13 15:02:36,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:02:36,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:36
2025-03-13 15:02:36,973 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:02:36,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.40it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.30it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.34it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.15it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.91it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.32it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.43it/s]100%|██████████| 11/11 [00:03<00:00,  2.09it/s]100%|██████████| 11/11 [00:03<00:00,  3.33it/s]
2025-03-13 15:02:40,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:40
2025-03-13 15:03:15,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6376 secs
2025-03-13 15:03:15,923 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 15:03:15,923 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 15:03:40,167 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2434 secs
2025-03-13 15:03:40,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1966 secs
2025-03-13 15:03:40,170 [INFO]: {
2025-03-13 15:03:40,170 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:40,170 [INFO]: 	index_param: efSearch=226
2025-03-13 15:03:40,170 [INFO]: 	index_path: knn.index
2025-03-13 15:03:40,170 [INFO]: 	size in bytes: 543996610
2025-03-13 15:03:40,170 [INFO]: 	avg_search_speed_ms: 11.339990688749756
2025-03-13 15:03:40,170 [INFO]: 	99p_search_speed_ms: 18.9558980311267
2025-03-13 15:03:40,170 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:40,170 [INFO]: 	nb vectors: 2765
2025-03-13 15:03:40,170 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:40,170 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 15:03:40,170 [INFO]: }
2025-03-13 15:03:40,170 [INFO]: 	>>> Finished "Creating the index" in 63.1982 secs
2025-03-13 15:03:40,170 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2270 secs
2025-03-13 15:03:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 90167 [episode count 7/20]
[retrieval_preprocessing] for episode 8528 [episode count 8/20], we have num_retrieval=np.int64(2713) num_query=np.int64(203)
2025-03-13 15:03:43,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:43,745 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:43
2025-03-13 15:03:43,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.97it/s]
2025-03-13 15:03:43,768 [INFO]: There are 2713 embeddings of dim 49152
2025-03-13 15:03:43,769 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 15:03:43,769 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:43,769 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:03:43,769 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:43,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:03:43,769 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,769 [INFO]: 559.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:43,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:03:43,769 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:43
2025-03-13 15:03:43,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:43,769 [INFO]: 	Creating the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,769 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:43
2025-03-13 15:03:43,770 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:03:43,770 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,771 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:03:43,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.44it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.48it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.77it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.44it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.90it/s]100%|██████████| 11/11 [00:03<00:00,  1.99it/s]100%|██████████| 11/11 [00:03<00:00,  3.21it/s]
2025-03-13 15:03:47,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:47
2025-03-13 15:04:19,459 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2510 secs
2025-03-13 15:04:19,459 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 15:04:19,459 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.95it/s]
2025-03-13 15:04:42,881 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4217 secs
2025-03-13 15:04:42,884 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1135 secs
2025-03-13 15:04:42,884 [INFO]: {
2025-03-13 15:04:42,884 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:42,884 [INFO]: 	index_param: efSearch=198
2025-03-13 15:04:42,884 [INFO]: 	index_path: knn.index
2025-03-13 15:04:42,884 [INFO]: 	size in bytes: 533765950
2025-03-13 15:04:42,884 [INFO]: 	avg_search_speed_ms: 10.485196242302234
2025-03-13 15:04:42,884 [INFO]: 	99p_search_speed_ms: 15.845149548258657
2025-03-13 15:04:42,884 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:42,884 [INFO]: 	nb vectors: 2713
2025-03-13 15:04:42,884 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:42,884 [INFO]: 	compression ratio: 0.9993097236719577
2025-03-13 15:04:42,884 [INFO]: }
2025-03-13 15:04:42,884 [INFO]: 	>>> Finished "Creating the index" in 59.1153 secs
2025-03-13 15:04:42,885 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1396 secs
2025-03-13 15:04:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 8528 [episode count 8/20]
[retrieval_preprocessing] for episode 90207 [episode count 9/20], we have num_retrieval=np.int64(2765) num_query=np.int64(151)
2025-03-13 15:04:46,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:46,977 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:46
2025-03-13 15:04:46,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.98it/s]
2025-03-13 15:04:47,004 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 15:04:47,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:04:47,005 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:47
2025-03-13 15:04:47,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:47,005 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:04:47,005 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:47,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:04:47,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:47
2025-03-13 15:04:47,005 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:47,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:04:47,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:47
2025-03-13 15:04:47,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:47,006 [INFO]: 	Creating the index 03/13/2025, 15:04:47
2025-03-13 15:04:47,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:47
2025-03-13 15:04:47,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:04:47,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:47
2025-03-13 15:04:47,008 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:04:47,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.86it/s] 18%|█▊        | 2/11 [00:00<00:01,  4.80it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.78it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.07it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.29it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.38it/s]100%|██████████| 11/11 [00:04<00:00,  1.39it/s]100%|██████████| 11/11 [00:04<00:00,  2.62it/s]
2025-03-13 15:04:51,569 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:51
2025-03-13 15:05:31,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3391 secs
2025-03-13 15:05:31,909 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:05:31,909 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.33it/s] 50%|█████     | 2/4 [00:01<00:01,  1.68it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.32s/it]
2025-03-13 15:05:52,890 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9813 secs
2025-03-13 15:05:52,893 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8848 secs
2025-03-13 15:05:52,893 [INFO]: {
2025-03-13 15:05:52,893 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:52,893 [INFO]: 	index_param: efSearch=162
2025-03-13 15:05:52,893 [INFO]: 	index_path: knn.index
2025-03-13 15:05:52,893 [INFO]: 	size in bytes: 543996610
2025-03-13 15:05:52,893 [INFO]: 	avg_search_speed_ms: 8.296795753004702
2025-03-13 15:05:52,893 [INFO]: 	99p_search_speed_ms: 13.95242625847459
2025-03-13 15:05:52,893 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:52,893 [INFO]: 	nb vectors: 2765
2025-03-13 15:05:52,893 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:52,893 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 15:05:52,893 [INFO]: }
2025-03-13 15:05:52,893 [INFO]: 	>>> Finished "Creating the index" in 65.8876 secs
2025-03-13 15:05:52,893 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9163 secs
2025-03-13 15:05:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 90207 [episode count 9/20]
[retrieval_preprocessing] for episode 57447 [episode count 10/20], we have num_retrieval=np.int64(2762) num_query=np.int64(154)
2025-03-13 15:05:55,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:55,528 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:55
2025-03-13 15:05:55,528 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 889.00it/s]
2025-03-13 15:05:55,559 [INFO]: There are 2762 embeddings of dim 49152
2025-03-13 15:05:55,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 15:05:55,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:55
2025-03-13 15:05:55,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:55,560 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:05:55,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:55,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:05:55,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:55
2025-03-13 15:05:55,561 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:55,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:05:55,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:55
2025-03-13 15:05:55,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:55,562 [INFO]: 	Creating the index 03/13/2025, 15:05:55
2025-03-13 15:05:55,562 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:55
2025-03-13 15:05:55,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:05:55,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:55
2025-03-13 15:05:55,566 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:05:55,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:01<00:11,  1.15s/it] 18%|█▊        | 2/11 [00:01<00:06,  1.49it/s] 27%|██▋       | 3/11 [00:01<00:04,  1.70it/s] 45%|████▌     | 5/11 [00:02<00:01,  3.45it/s] 64%|██████▎   | 7/11 [00:02<00:00,  4.98it/s] 82%|████████▏ | 9/11 [00:02<00:00,  6.67it/s]100%|██████████| 11/11 [00:04<00:00,  2.12it/s]100%|██████████| 11/11 [00:04<00:00,  2.43it/s]
2025-03-13 15:06:00,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:00
2025-03-13 15:06:32,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9894 secs
2025-03-13 15:06:32,091 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:06:32,091 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 15:07:02,491 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4004 secs
2025-03-13 15:07:02,494 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9288 secs
2025-03-13 15:07:02,495 [INFO]: {
2025-03-13 15:07:02,495 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:02,495 [INFO]: 	index_param: efSearch=191
2025-03-13 15:07:02,495 [INFO]: 	index_path: knn.index
2025-03-13 15:07:02,495 [INFO]: 	size in bytes: 543406270
2025-03-13 15:07:02,495 [INFO]: 	avg_search_speed_ms: 9.877310468531821
2025-03-13 15:07:02,495 [INFO]: 	99p_search_speed_ms: 16.095105744898316
2025-03-13 15:07:02,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:02,495 [INFO]: 	nb vectors: 2762
2025-03-13 15:07:02,495 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:02,495 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-13 15:07:02,495 [INFO]: }
2025-03-13 15:07:02,495 [INFO]: 	>>> Finished "Creating the index" in 66.9328 secs
2025-03-13 15:07:02,495 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9669 secs
2025-03-13 15:07:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 57447 [episode count 10/20]
[retrieval_preprocessing] for episode 65748 [episode count 11/20], we have num_retrieval=np.int64(2764) num_query=np.int64(152)
2025-03-13 15:07:04,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:05,394 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:05
2025-03-13 15:07:05,394 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1021.75it/s]
2025-03-13 15:07:05,422 [INFO]: There are 2764 embeddings of dim 49152
2025-03-13 15:07:05,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:07:05,422 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:05
2025-03-13 15:07:05,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:05,422 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:07:05,422 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:05,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:05,422 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:05
2025-03-13 15:07:05,422 [INFO]: 570.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:05,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:07:05,422 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:05
2025-03-13 15:07:05,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:05,422 [INFO]: 	Creating the index 03/13/2025, 15:07:05
2025-03-13 15:07:05,423 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:05
2025-03-13 15:07:05,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:07:05,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:05
2025-03-13 15:07:05,424 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:07:05,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.36it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.34it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.82it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.04it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.12it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.33it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.70it/s]100%|██████████| 11/11 [00:03<00:00,  1.66it/s]100%|██████████| 11/11 [00:03<00:00,  3.30it/s]
2025-03-13 15:07:08,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:08
2025-03-13 15:07:46,127 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2458 secs
2025-03-13 15:07:46,128 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 15:07:46,128 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.60it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 15:08:06,498 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3700 secs
2025-03-13 15:08:06,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4386 secs
2025-03-13 15:08:06,863 [INFO]: {
2025-03-13 15:08:06,863 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:06,863 [INFO]: 	index_param: efSearch=122
2025-03-13 15:08:06,863 [INFO]: 	index_path: knn.index
2025-03-13 15:08:06,863 [INFO]: 	size in bytes: 543799810
2025-03-13 15:08:06,863 [INFO]: 	avg_search_speed_ms: 7.351006753057899
2025-03-13 15:08:06,863 [INFO]: 	99p_search_speed_ms: 10.84799166535959
2025-03-13 15:08:06,863 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:06,863 [INFO]: 	nb vectors: 2764
2025-03-13 15:08:06,863 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:06,863 [INFO]: 	compression ratio: 0.9993098600016062
2025-03-13 15:08:06,863 [INFO]: }
2025-03-13 15:08:06,863 [INFO]: 	>>> Finished "Creating the index" in 61.4408 secs
2025-03-13 15:08:06,863 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4693 secs
2025-03-13 15:08:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 65748 [episode count 11/20]
[retrieval_preprocessing] for episode 41187 [episode count 12/20], we have num_retrieval=np.int64(2761) num_query=np.int64(155)
2025-03-13 15:08:08,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:09,428 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:09
2025-03-13 15:08:09,428 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.82it/s]
2025-03-13 15:08:09,456 [INFO]: There are 2761 embeddings of dim 49152
2025-03-13 15:08:09,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:08:09,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:09
2025-03-13 15:08:09,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:09,456 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:08:09,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:09,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:09,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:09
2025-03-13 15:08:09,457 [INFO]: 569.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:09,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:08:09,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:09
2025-03-13 15:08:09,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:09,457 [INFO]: 	Creating the index 03/13/2025, 15:08:09
2025-03-13 15:08:09,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:09
2025-03-13 15:08:09,458 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:08:09,458 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:09
2025-03-13 15:08:09,458 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:08:09,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.72it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.39it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.28it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.45it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.61it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.58it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.80it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.93it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.00it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.08it/s]100%|██████████| 11/11 [00:03<00:00,  1.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.27it/s]
2025-03-13 15:08:12,830 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:12
2025-03-13 15:08:41,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8534 secs
2025-03-13 15:08:41,684 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 15:08:41,684 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 15:09:04,698 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0136 secs
2025-03-13 15:09:04,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2419 secs
2025-03-13 15:09:04,700 [INFO]: {
2025-03-13 15:09:04,700 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:04,700 [INFO]: 	index_param: efSearch=230
2025-03-13 15:09:04,700 [INFO]: 	index_path: knn.index
2025-03-13 15:09:04,700 [INFO]: 	size in bytes: 543209530
2025-03-13 15:09:04,700 [INFO]: 	avg_search_speed_ms: 12.05869545526488
2025-03-13 15:09:04,700 [INFO]: 	99p_search_speed_ms: 23.258579019457102
2025-03-13 15:09:04,700 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:04,700 [INFO]: 	nb vectors: 2761
2025-03-13 15:09:04,700 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:04,700 [INFO]: 	compression ratio: 0.9993099495143246
2025-03-13 15:09:04,701 [INFO]: }
2025-03-13 15:09:04,701 [INFO]: 	>>> Finished "Creating the index" in 55.2438 secs
2025-03-13 15:09:04,701 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2726 secs
2025-03-13 15:09:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 41187 [episode count 12/20]
[retrieval_preprocessing] for episode 8612 [episode count 13/20], we have num_retrieval=np.int64(2796) num_query=np.int64(120)
2025-03-13 15:09:07,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:08,397 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:08
2025-03-13 15:09:08,397 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.32it/s]
2025-03-13 15:09:08,422 [INFO]: There are 2796 embeddings of dim 49152
2025-03-13 15:09:08,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:09:08,422 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:08
2025-03-13 15:09:08,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:08,423 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:09:08,423 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:08,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:08,423 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:08
2025-03-13 15:09:08,423 [INFO]: 577.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:08,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:09:08,423 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:08
2025-03-13 15:09:08,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:08,423 [INFO]: 	Creating the index 03/13/2025, 15:09:08
2025-03-13 15:09:08,423 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:08
2025-03-13 15:09:08,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:09:08,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:08
2025-03-13 15:09:08,424 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:09:08,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.83it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.56it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.44it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.88it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.16it/s] 50%|█████     | 6/12 [00:00<00:00,  9.39it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.44it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.47it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.51it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.53it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.66it/s]100%|██████████| 12/12 [00:03<00:00,  1.54it/s]100%|██████████| 12/12 [00:03<00:00,  3.86it/s]
2025-03-13 15:09:11,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:11
2025-03-13 15:09:45,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6181 secs
2025-03-13 15:09:45,156 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 15:09:45,156 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 50%|█████     | 2/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
2025-03-13 15:10:05,249 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0932 secs
2025-03-13 15:10:05,252 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8274 secs
2025-03-13 15:10:05,252 [INFO]: {
2025-03-13 15:10:05,252 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:05,252 [INFO]: 	index_param: efSearch=142
2025-03-13 15:10:05,252 [INFO]: 	index_path: knn.index
2025-03-13 15:10:05,252 [INFO]: 	size in bytes: 550095610
2025-03-13 15:10:05,252 [INFO]: 	avg_search_speed_ms: 8.120913183162251
2025-03-13 15:10:05,252 [INFO]: 	99p_search_speed_ms: 12.235624971799558
2025-03-13 15:10:05,252 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:05,252 [INFO]: 	nb vectors: 2796
2025-03-13 15:10:05,252 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:05,252 [INFO]: 	compression ratio: 0.9993098617892988
2025-03-13 15:10:05,252 [INFO]: }
2025-03-13 15:10:05,252 [INFO]: 	>>> Finished "Creating the index" in 56.8289 secs
2025-03-13 15:10:05,252 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8544 secs
2025-03-13 15:10:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 8612 [episode count 13/20]
[retrieval_preprocessing] for episode 25015 [episode count 14/20], we have num_retrieval=np.int64(2747) num_query=np.int64(169)
2025-03-13 15:10:07,156 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:07,639 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:07
2025-03-13 15:10:07,639 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1071.34it/s]
2025-03-13 15:10:07,667 [INFO]: There are 2747 embeddings of dim 49152
2025-03-13 15:10:07,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:10:07,667 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:07
2025-03-13 15:10:07,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:07,668 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:10:07,668 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:07,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:10:07,668 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:07
2025-03-13 15:10:07,668 [INFO]: 566.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:07,669 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:10:07,669 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:07
2025-03-13 15:10:07,669 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:07,669 [INFO]: 	Creating the index 03/13/2025, 15:10:07
2025-03-13 15:10:07,669 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:07
2025-03-13 15:10:07,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:10:07,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:07
2025-03-13 15:10:07,673 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:10:07,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.53it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.73it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.96it/s] 55%|█████▍    | 6/11 [00:00<00:00, 11.02it/s] 73%|███████▎  | 8/11 [00:00<00:00, 12.54it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.06it/s]100%|██████████| 11/11 [00:03<00:00,  3.56it/s]
2025-03-13 15:10:11,073 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:11
2025-03-13 15:10:43,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7902 secs
2025-03-13 15:10:43,864 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:10:43,865 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 15:11:03,080 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2153 secs
2025-03-13 15:11:03,082 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4097 secs
2025-03-13 15:11:03,082 [INFO]: {
2025-03-13 15:11:03,082 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:03,082 [INFO]: 	index_param: efSearch=199
2025-03-13 15:11:03,082 [INFO]: 	index_path: knn.index
2025-03-13 15:11:03,082 [INFO]: 	size in bytes: 540455110
2025-03-13 15:11:03,082 [INFO]: 	avg_search_speed_ms: 10.760503651151199
2025-03-13 15:11:03,082 [INFO]: 	99p_search_speed_ms: 17.886791480705156
2025-03-13 15:11:03,082 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:03,082 [INFO]: 	nb vectors: 2747
2025-03-13 15:11:03,083 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:03,083 [INFO]: 	compression ratio: 0.999309963042074
2025-03-13 15:11:03,083 [INFO]: }
2025-03-13 15:11:03,083 [INFO]: 	>>> Finished "Creating the index" in 55.4135 secs
2025-03-13 15:11:03,083 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4438 secs
2025-03-13 15:11:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 25015 [episode count 14/20]
[retrieval_preprocessing] for episode 49620 [episode count 15/20], we have num_retrieval=np.int64(2760) num_query=np.int64(156)
2025-03-13 15:11:05,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:06,084 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:06
2025-03-13 15:11:06,084 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1706.39it/s]
2025-03-13 15:11:06,110 [INFO]: There are 2760 embeddings of dim 49152
2025-03-13 15:11:06,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:11:06,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:06
2025-03-13 15:11:06,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:06,110 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:11:06,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:06,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:06,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:06
2025-03-13 15:11:06,110 [INFO]: 569.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:06,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:11:06,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:06
2025-03-13 15:11:06,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:06,110 [INFO]: 	Creating the index 03/13/2025, 15:11:06
2025-03-13 15:11:06,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:06
2025-03-13 15:11:06,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:11:06,111 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:06
2025-03-13 15:11:06,111 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:11:06,111 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.01it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.52it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.23it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.65it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.85it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.99it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.07it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.08it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.39it/s]100%|██████████| 11/11 [00:03<00:00,  1.79it/s]100%|██████████| 11/11 [00:03<00:00,  3.38it/s]
2025-03-13 15:11:09,379 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:09
2025-03-13 15:11:46,401 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0217 secs
2025-03-13 15:11:46,401 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 15:11:46,401 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 15:12:05,241 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8392 secs
2025-03-13 15:12:05,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1319 secs
2025-03-13 15:12:05,244 [INFO]: {
2025-03-13 15:12:05,244 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:05,244 [INFO]: 	index_param: efSearch=172
2025-03-13 15:12:05,244 [INFO]: 	index_path: knn.index
2025-03-13 15:12:05,244 [INFO]: 	size in bytes: 543012790
2025-03-13 15:12:05,244 [INFO]: 	avg_search_speed_ms: 9.456959171326393
2025-03-13 15:12:05,244 [INFO]: 	99p_search_speed_ms: 12.030894458293929
2025-03-13 15:12:05,244 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:05,244 [INFO]: 	nb vectors: 2760
2025-03-13 15:12:05,244 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:05,244 [INFO]: 	compression ratio: 0.9993099425890134
2025-03-13 15:12:05,244 [INFO]: }
2025-03-13 15:12:05,244 [INFO]: 	>>> Finished "Creating the index" in 59.1335 secs
2025-03-13 15:12:05,244 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1601 secs
2025-03-13 15:12:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 49620 [episode count 15/20]
[retrieval_preprocessing] for episode 25076 [episode count 16/20], we have num_retrieval=np.int64(2795) num_query=np.int64(121)
2025-03-13 15:12:08,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:08,619 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:08
2025-03-13 15:12:08,619 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-13 15:12:08,650 [INFO]: There are 2795 embeddings of dim 49152
2025-03-13 15:12:08,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 15:12:08,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,651 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:08,651 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:12:08,651 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:08,651 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:12:08,651 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,651 [INFO]: 576.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:08,652 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:12:08,652 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:08
2025-03-13 15:12:08,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:08,652 [INFO]: 	Creating the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:08
2025-03-13 15:12:08,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:12:08,656 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,656 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:12:08,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.95it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.68it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.04it/s] 50%|█████     | 6/12 [00:00<00:00,  9.07it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.77it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.62it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.53it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.40it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.37it/s]100%|██████████| 12/12 [00:03<00:00,  1.33it/s]100%|██████████| 12/12 [00:03<00:00,  3.33it/s]
2025-03-13 15:12:12,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:12
2025-03-13 15:12:47,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2584 secs
2025-03-13 15:12:47,524 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:12:47,524 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 15:13:07,388 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8644 secs
2025-03-13 15:13:07,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7350 secs
2025-03-13 15:13:07,391 [INFO]: {
2025-03-13 15:13:07,391 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:07,391 [INFO]: 	index_param: efSearch=196
2025-03-13 15:13:07,391 [INFO]: 	index_path: knn.index
2025-03-13 15:13:07,391 [INFO]: 	size in bytes: 549898870
2025-03-13 15:13:07,391 [INFO]: 	avg_search_speed_ms: 11.453363998288467
2025-03-13 15:13:07,391 [INFO]: 	99p_search_speed_ms: 21.010856190696337
2025-03-13 15:13:07,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:07,391 [INFO]: 	nb vectors: 2795
2025-03-13 15:13:07,391 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:07,391 [INFO]: 	compression ratio: 0.9993098549193237
2025-03-13 15:13:07,391 [INFO]: }
2025-03-13 15:13:07,391 [INFO]: 	>>> Finished "Creating the index" in 58.7390 secs
2025-03-13 15:13:07,391 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7723 secs
2025-03-13 15:13:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 25076 [episode count 16/20]
[retrieval_preprocessing] for episode 49711 [episode count 17/20], we have num_retrieval=np.int64(2773) num_query=np.int64(143)
2025-03-13 15:13:09,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:09,832 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:09
2025-03-13 15:13:09,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1008.73it/s]
2025-03-13 15:13:09,858 [INFO]: There are 2773 embeddings of dim 49152
2025-03-13 15:13:09,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:13:09,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:09
2025-03-13 15:13:09,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:09,858 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:13:09,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:09,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:09,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:09
2025-03-13 15:13:09,859 [INFO]: 572.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:09,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:13:09,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:09
2025-03-13 15:13:09,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:09,859 [INFO]: 	Creating the index 03/13/2025, 15:13:09
2025-03-13 15:13:09,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:09
2025-03-13 15:13:09,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:13:09,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:09
2025-03-13 15:13:09,860 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:13:09,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.55it/s] 18%|█▊        | 2/11 [00:00<00:01,  4.74it/s] 27%|██▋       | 3/11 [00:00<00:01,  5.87it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.59it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.12it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.73it/s] 64%|██████▎   | 7/11 [00:01<00:00,  8.01it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.21it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.36it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.46it/s]100%|██████████| 11/11 [00:03<00:00,  1.43it/s]100%|██████████| 11/11 [00:03<00:00,  3.24it/s]
2025-03-13 15:13:13,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:13
2025-03-13 15:13:49,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9919 secs
2025-03-13 15:13:49,258 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 15:13:49,258 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 15:14:16,140 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8814 secs
2025-03-13 15:14:16,142 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2817 secs
2025-03-13 15:14:16,142 [INFO]: {
2025-03-13 15:14:16,142 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:16,142 [INFO]: 	index_param: efSearch=198
2025-03-13 15:14:16,142 [INFO]: 	index_path: knn.index
2025-03-13 15:14:16,142 [INFO]: 	size in bytes: 545570530
2025-03-13 15:14:16,142 [INFO]: 	avg_search_speed_ms: 9.429795285555059
2025-03-13 15:14:16,142 [INFO]: 	99p_search_speed_ms: 14.330716533586397
2025-03-13 15:14:16,142 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:16,142 [INFO]: 	nb vectors: 2773
2025-03-13 15:14:16,142 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:16,142 [INFO]: 	compression ratio: 0.9993098124270019
2025-03-13 15:14:16,142 [INFO]: }
2025-03-13 15:14:16,142 [INFO]: 	>>> Finished "Creating the index" in 66.2831 secs
2025-03-13 15:14:16,142 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3095 secs
2025-03-13 15:14:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 49711 [episode count 17/20]
[retrieval_preprocessing] for episode 49714 [episode count 18/20], we have num_retrieval=np.int64(2759) num_query=np.int64(157)
2025-03-13 15:14:18,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:18,576 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:18
2025-03-13 15:14:18,576 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.12it/s]
2025-03-13 15:14:18,603 [INFO]: There are 2759 embeddings of dim 49152
2025-03-13 15:14:18,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:14:18,604 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:18
2025-03-13 15:14:18,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:18,604 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:14:18,605 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:18,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:14:18,605 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:18
2025-03-13 15:14:18,605 [INFO]: 569.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:18,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:14:18,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:18
2025-03-13 15:14:18,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:18,606 [INFO]: 	Creating the index 03/13/2025, 15:14:18
2025-03-13 15:14:18,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:18
2025-03-13 15:14:18,609 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:14:18,609 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:18
2025-03-13 15:14:18,610 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:14:18,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.26it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.62it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.44it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.45it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.95it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.74it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.41it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.19it/s]100%|██████████| 11/11 [00:03<00:00,  1.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.29it/s]
2025-03-13 15:14:21,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:21
2025-03-13 15:14:53,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3086 secs
2025-03-13 15:14:53,277 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 15:14:53,277 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.30it/s] 50%|█████     | 2/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.82it/s]
2025-03-13 15:15:13,936 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6586 secs
2025-03-13 15:15:13,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3285 secs
2025-03-13 15:15:13,938 [INFO]: {
2025-03-13 15:15:13,938 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:13,938 [INFO]: 	index_param: efSearch=228
2025-03-13 15:15:13,938 [INFO]: 	index_path: knn.index
2025-03-13 15:15:13,938 [INFO]: 	size in bytes: 542815990
2025-03-13 15:15:13,938 [INFO]: 	avg_search_speed_ms: 11.86808286851199
2025-03-13 15:15:13,938 [INFO]: 	99p_search_speed_ms: 19.69489330891521
2025-03-13 15:15:13,938 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:13,938 [INFO]: 	nb vectors: 2759
2025-03-13 15:15:13,938 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:13,938 [INFO]: 	compression ratio: 0.9993100461171013
2025-03-13 15:15:13,938 [INFO]: }
2025-03-13 15:15:13,938 [INFO]: 	>>> Finished "Creating the index" in 55.3323 secs
2025-03-13 15:15:13,938 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3628 secs
2025-03-13 15:15:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 49714 [episode count 18/20]
[retrieval_preprocessing] for episode 1424 [episode count 19/20], we have num_retrieval=np.int64(2781) num_query=np.int64(135)
2025-03-13 15:15:16,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:17,180 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:17
2025-03-13 15:15:17,180 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.84it/s]
2025-03-13 15:15:17,206 [INFO]: There are 2781 embeddings of dim 49152
2025-03-13 15:15:17,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:15:17,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:17
2025-03-13 15:15:17,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:17,206 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:15:17,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:17,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:17,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:17
2025-03-13 15:15:17,206 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:17,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:15:17,207 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:17
2025-03-13 15:15:17,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:17,207 [INFO]: 	Creating the index 03/13/2025, 15:15:17
2025-03-13 15:15:17,207 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:17
2025-03-13 15:15:17,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:15:17,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:17
2025-03-13 15:15:17,208 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:15:17,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.32it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.22it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.93it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.61it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.37it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.45it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.46it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.00it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.39it/s]100%|██████████| 11/11 [00:03<00:00,  1.34it/s]100%|██████████| 11/11 [00:03<00:00,  3.21it/s]
2025-03-13 15:15:20,648 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:20
2025-03-13 15:15:54,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0346 secs
2025-03-13 15:15:54,684 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 15:15:54,684 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.12it/s]
2025-03-13 15:16:09,362 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6780 secs
2025-03-13 15:16:09,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1567 secs
2025-03-13 15:16:09,365 [INFO]: {
2025-03-13 15:16:09,365 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:09,365 [INFO]: 	index_param: efSearch=136
2025-03-13 15:16:09,365 [INFO]: 	index_path: knn.index
2025-03-13 15:16:09,365 [INFO]: 	size in bytes: 547144450
2025-03-13 15:16:09,365 [INFO]: 	avg_search_speed_ms: 8.394062137082656
2025-03-13 15:16:09,365 [INFO]: 	99p_search_speed_ms: 19.814947247505128
2025-03-13 15:16:09,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:09,365 [INFO]: 	nb vectors: 2781
2025-03-13 15:16:09,365 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:09,366 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-13 15:16:09,366 [INFO]: }
2025-03-13 15:16:09,366 [INFO]: 	>>> Finished "Creating the index" in 52.1590 secs
2025-03-13 15:16:09,366 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1856 secs
2025-03-13 15:16:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 1424 [episode count 19/20]
2025-03-13 15:16:10: [retrieval_preprocessing] finished for -1_put_marker_in_cup [chosen_id count 1/196]
2025-03-13 15:16:11: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_bowl [chosen_id count 2/196]
2025-03-13 15:16:11: [retrieval_preprocessing] we have num_total=2312 embedding_dim=49152
[retrieval_preprocessing] for episode 49174 [episode count 0/20], we have num_retrieval=np.int64(2188) num_query=np.int64(124)
2025-03-13 15:16:12,691 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:13,022 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:13
2025-03-13 15:16:13,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.85it/s]
2025-03-13 15:16:13,044 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 15:16:13,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 15:16:13,045 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:13
2025-03-13 15:16:13,045 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:13,045 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:16:13,045 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:13,045 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:16:13,045 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:13
2025-03-13 15:16:13,045 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:13,045 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:16:13,045 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:13
2025-03-13 15:16:13,045 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:13,045 [INFO]: 	Creating the index 03/13/2025, 15:16:13
2025-03-13 15:16:13,045 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:13
2025-03-13 15:16:13,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:16:13,046 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:13
2025-03-13 15:16:13,046 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:16:13,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.47it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.79it/s] 56%|█████▌    | 5/9 [00:00<00:00, 15.87it/s] 78%|███████▊  | 7/9 [00:00<00:00, 17.10it/s]100%|██████████| 9/9 [00:02<00:00,  2.81it/s]100%|██████████| 9/9 [00:02<00:00,  4.21it/s]
2025-03-13 15:16:15,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:15
2025-03-13 15:16:44,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7923 secs
2025-03-13 15:16:44,981 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:16:44,982 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s]
2025-03-13 15:17:09,433 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4516 secs
2025-03-13 15:17:09,435 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3891 secs
2025-03-13 15:17:09,436 [INFO]: {
2025-03-13 15:17:09,436 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:09,436 [INFO]: 	index_param: efSearch=207
2025-03-13 15:17:09,436 [INFO]: 	index_path: knn.index
2025-03-13 15:17:09,436 [INFO]: 	size in bytes: 430475830
2025-03-13 15:17:09,436 [INFO]: 	avg_search_speed_ms: 9.854820090818581
2025-03-13 15:17:09,436 [INFO]: 	99p_search_speed_ms: 12.388748382218182
2025-03-13 15:17:09,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:09,436 [INFO]: 	nb vectors: 2188
2025-03-13 15:17:09,436 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:09,436 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 15:17:09,436 [INFO]: }
2025-03-13 15:17:09,436 [INFO]: 	>>> Finished "Creating the index" in 56.3911 secs
2025-03-13 15:17:09,436 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4139 secs
2025-03-13 15:17:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 49174 [episode count 0/20]
[retrieval_preprocessing] for episode 49175 [episode count 1/20], we have num_retrieval=np.int64(2174) num_query=np.int64(138)
2025-03-13 15:17:11,348 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:11,651 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:11
2025-03-13 15:17:11,651 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1717.57it/s]
2025-03-13 15:17:11,675 [INFO]: There are 2174 embeddings of dim 49152
2025-03-13 15:17:11,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 15:17:11,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:11
2025-03-13 15:17:11,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:11,676 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:17:11,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:11,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:17:11,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:11
2025-03-13 15:17:11,676 [INFO]: 448.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:11,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:17:11,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:11
2025-03-13 15:17:11,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:11,677 [INFO]: 	Creating the index 03/13/2025, 15:17:11
2025-03-13 15:17:11,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:11
2025-03-13 15:17:11,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:17:11,680 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:11
2025-03-13 15:17:11,680 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:17:11,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.44it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.43it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.24it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.76it/s]100%|██████████| 9/9 [00:02<00:00,  2.98it/s]100%|██████████| 9/9 [00:02<00:00,  4.16it/s]
2025-03-13 15:17:13,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:13
2025-03-13 15:17:41,362 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5137 secs
2025-03-13 15:17:41,362 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 15:17:41,362 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 15:17:58,314 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9522 secs
2025-03-13 15:17:58,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6357 secs
2025-03-13 15:17:58,316 [INFO]: {
2025-03-13 15:17:58,316 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:58,316 [INFO]: 	index_param: efSearch=178
2025-03-13 15:17:58,316 [INFO]: 	index_path: knn.index
2025-03-13 15:17:58,316 [INFO]: 	size in bytes: 427721350
2025-03-13 15:17:58,316 [INFO]: 	avg_search_speed_ms: 10.317093081449393
2025-03-13 15:17:58,316 [INFO]: 	99p_search_speed_ms: 12.43890239857137
2025-03-13 15:17:58,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:58,316 [INFO]: 	nb vectors: 2174
2025-03-13 15:17:58,316 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:58,316 [INFO]: 	compression ratio: 0.9993089940448379
2025-03-13 15:17:58,316 [INFO]: }
2025-03-13 15:17:58,316 [INFO]: 	>>> Finished "Creating the index" in 46.6394 secs
2025-03-13 15:17:58,316 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6659 secs
2025-03-13 15:17:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 49175 [episode count 1/20]
[retrieval_preprocessing] for episode 32809 [episode count 2/20], we have num_retrieval=np.int64(2140) num_query=np.int64(172)
2025-03-13 15:18:00,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:00,749 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:00
2025-03-13 15:18:00,749 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1662.43it/s]
2025-03-13 15:18:01,191 [INFO]: There are 2140 embeddings of dim 49152
2025-03-13 15:18:01,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4422 secs
2025-03-13 15:18:01,192 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:01
2025-03-13 15:18:01,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:01,192 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:18:01,192 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:01,192 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:18:01,192 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:01
2025-03-13 15:18:01,192 [INFO]: 441.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:01,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:18:01,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:01
2025-03-13 15:18:01,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:01,192 [INFO]: 	Creating the index 03/13/2025, 15:18:01
2025-03-13 15:18:01,193 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:01
2025-03-13 15:18:01,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 15:18:01,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:01
2025-03-13 15:18:01,195 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:18:01,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.11it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.21it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.33it/s] 67%|██████▋   | 6/9 [00:00<00:00, 12.01it/s] 89%|████████▉ | 8/9 [00:00<00:00, 13.75it/s]100%|██████████| 9/9 [00:02<00:00,  4.33it/s]
2025-03-13 15:18:03,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:03
2025-03-13 15:18:29,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0776 secs
2025-03-13 15:18:29,356 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:18:29,356 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.67it/s]
2025-03-13 15:18:49,211 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8542 secs
2025-03-13 15:18:49,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0182 secs
2025-03-13 15:18:49,213 [INFO]: {
2025-03-13 15:18:49,213 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:49,213 [INFO]: 	index_param: efSearch=191
2025-03-13 15:18:49,213 [INFO]: 	index_path: knn.index
2025-03-13 15:18:49,213 [INFO]: 	size in bytes: 421032010
2025-03-13 15:18:49,213 [INFO]: 	avg_search_speed_ms: 9.707805786724881
2025-03-13 15:18:49,213 [INFO]: 	99p_search_speed_ms: 17.21370836487042
2025-03-13 15:18:49,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:49,213 [INFO]: 	nb vectors: 2140
2025-03-13 15:18:49,213 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:49,213 [INFO]: 	compression ratio: 0.999309102412427
2025-03-13 15:18:49,213 [INFO]: }
2025-03-13 15:18:49,213 [INFO]: 	>>> Finished "Creating the index" in 48.0207 secs
2025-03-13 15:18:49,213 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4639 secs
2025-03-13 15:18:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 32809 [episode count 2/20]
[retrieval_preprocessing] for episode 73826 [episode count 3/20], we have num_retrieval=np.int64(2218) num_query=np.int64(94)
2025-03-13 15:18:51,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:52,853 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:52
2025-03-13 15:18:52,853 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2168.72it/s]
2025-03-13 15:18:52,875 [INFO]: There are 2218 embeddings of dim 49152
2025-03-13 15:18:52,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 15:18:52,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:52
2025-03-13 15:18:52,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:52,876 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:18:52,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:52,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:18:52,876 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:52
2025-03-13 15:18:52,876 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:52,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:18:52,876 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:52
2025-03-13 15:18:52,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:52,876 [INFO]: 	Creating the index 03/13/2025, 15:18:52
2025-03-13 15:18:52,876 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:52
2025-03-13 15:18:52,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:18:52,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:52
2025-03-13 15:18:52,877 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:18:52,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.47it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.96it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.61it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.91it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.99it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.23it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.16it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.09it/s]100%|██████████| 9/9 [00:02<00:00,  1.72it/s]100%|██████████| 9/9 [00:02<00:00,  3.45it/s]
2025-03-13 15:18:55,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:55
2025-03-13 15:19:33,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1060 secs
2025-03-13 15:19:33,602 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 15:19:33,602 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 15:19:57,939 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3362 secs
2025-03-13 15:19:58,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3446 secs
2025-03-13 15:19:58,222 [INFO]: {
2025-03-13 15:19:58,223 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:58,223 [INFO]: 	index_param: efSearch=153
2025-03-13 15:19:58,223 [INFO]: 	index_path: knn.index
2025-03-13 15:19:58,223 [INFO]: 	size in bytes: 436378030
2025-03-13 15:19:58,223 [INFO]: 	avg_search_speed_ms: 12.562007824632914
2025-03-13 15:19:58,223 [INFO]: 	99p_search_speed_ms: 34.820554614998244
2025-03-13 15:19:58,223 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:58,223 [INFO]: 	nb vectors: 2218
2025-03-13 15:19:58,223 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:58,223 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-13 15:19:58,223 [INFO]: }
2025-03-13 15:19:58,223 [INFO]: 	>>> Finished "Creating the index" in 65.3471 secs
2025-03-13 15:19:58,223 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3701 secs
2025-03-13 15:19:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 73826 [episode count 3/20]
[retrieval_preprocessing] for episode 90291 [episode count 4/20], we have num_retrieval=np.int64(2143) num_query=np.int64(169)
2025-03-13 15:19:59,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:00,011 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:00
2025-03-13 15:20:00,011 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 894.12it/s]
2025-03-13 15:20:00,054 [INFO]: There are 2143 embeddings of dim 49152
2025-03-13 15:20:00,054 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0434 secs
2025-03-13 15:20:00,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:00,055 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:20:00,055 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:00,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:20:00,056 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,056 [INFO]: 442.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:00,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:20:00,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:00
2025-03-13 15:20:00,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:00,057 [INFO]: 	Creating the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:00
2025-03-13 15:20:00,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:20:00,061 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:00
2025-03-13 15:20:00,061 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:20:00,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.64it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.79it/s]
2025-03-13 15:20:02,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:02
2025-03-13 15:20:39,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7554 secs
2025-03-13 15:20:39,201 [INFO]: The best hyperparameters are: efSearch=104
2025-03-13 15:20:39,201 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s]
2025-03-13 15:21:06,168 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9668 secs
2025-03-13 15:21:06,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1101 secs
2025-03-13 15:21:06,171 [INFO]: {
2025-03-13 15:21:06,171 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:06,171 [INFO]: 	index_param: efSearch=104
2025-03-13 15:21:06,171 [INFO]: 	index_path: knn.index
2025-03-13 15:21:06,171 [INFO]: 	size in bytes: 421622230
2025-03-13 15:21:06,171 [INFO]: 	avg_search_speed_ms: 8.125244334542852
2025-03-13 15:21:06,171 [INFO]: 	99p_search_speed_ms: 13.33974488079548
2025-03-13 15:21:06,171 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:06,171 [INFO]: 	nb vectors: 2143
2025-03-13 15:21:06,171 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:06,171 [INFO]: 	compression ratio: 0.9993091303558638
2025-03-13 15:21:06,171 [INFO]: }
2025-03-13 15:21:06,171 [INFO]: 	>>> Finished "Creating the index" in 66.1142 secs
2025-03-13 15:21:06,171 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1605 secs
2025-03-13 15:21:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 90291 [episode count 4/20]
[retrieval_preprocessing] for episode 205 [episode count 5/20], we have num_retrieval=np.int64(2172) num_query=np.int64(140)
2025-03-13 15:21:08,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:08,709 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:08
2025-03-13 15:21:08,709 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 962.66it/s]
2025-03-13 15:21:08,737 [INFO]: There are 2172 embeddings of dim 49152
2025-03-13 15:21:08,737 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:21:08,737 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:08
2025-03-13 15:21:08,737 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:08,737 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:21:08,737 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:08,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:08,738 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:08
2025-03-13 15:21:08,738 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:08,738 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:21:08,738 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:08
2025-03-13 15:21:08,738 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:08,738 [INFO]: 	Creating the index 03/13/2025, 15:21:08
2025-03-13 15:21:08,738 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:08
2025-03-13 15:21:08,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:21:08,739 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:08
2025-03-13 15:21:08,739 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:21:08,739 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.73it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.53it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.45it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.55it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.17it/s]100%|██████████| 9/9 [00:02<00:00,  2.22it/s]100%|██████████| 9/9 [00:02<00:00,  3.27it/s]
2025-03-13 15:21:11,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:11
2025-03-13 15:21:39,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9394 secs
2025-03-13 15:21:39,439 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 15:21:39,440 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
2025-03-13 15:21:58,257 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8175 secs
2025-03-13 15:21:58,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5199 secs
2025-03-13 15:21:58,259 [INFO]: {
2025-03-13 15:21:58,259 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:58,259 [INFO]: 	index_param: efSearch=157
2025-03-13 15:21:58,259 [INFO]: 	index_path: knn.index
2025-03-13 15:21:58,259 [INFO]: 	size in bytes: 427327810
2025-03-13 15:21:58,259 [INFO]: 	avg_search_speed_ms: 9.019509282230162
2025-03-13 15:21:58,259 [INFO]: 	99p_search_speed_ms: 12.770608142018318
2025-03-13 15:21:58,259 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:58,259 [INFO]: 	nb vectors: 2172
2025-03-13 15:21:58,259 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:58,259 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-13 15:21:58,259 [INFO]: }
2025-03-13 15:21:58,259 [INFO]: 	>>> Finished "Creating the index" in 49.5213 secs
2025-03-13 15:21:58,259 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5503 secs
2025-03-13 15:21:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 205 [episode count 5/20]
[retrieval_preprocessing] for episode 33024 [episode count 6/20], we have num_retrieval=np.int64(2173) num_query=np.int64(139)
2025-03-13 15:22:00,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:01,586 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:01
2025-03-13 15:22:01,586 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1260.69it/s]
2025-03-13 15:22:01,613 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 15:22:01,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 15:22:01,613 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:01
2025-03-13 15:22:01,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:01,614 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:22:01,614 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:01,614 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:01,614 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:01
2025-03-13 15:22:01,614 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:01,614 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:22:01,614 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:01
2025-03-13 15:22:01,614 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:01,614 [INFO]: 	Creating the index 03/13/2025, 15:22:01
2025-03-13 15:22:01,614 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:01
2025-03-13 15:22:01,615 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:22:01,615 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:01
2025-03-13 15:22:01,616 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:22:01,616 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.74it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.52it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.21it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.41it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.78it/s]100%|██████████| 9/9 [00:02<00:00,  1.99it/s]100%|██████████| 9/9 [00:02<00:00,  3.39it/s]
2025-03-13 15:22:04,274 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:04
2025-03-13 15:22:29,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2309 secs
2025-03-13 15:22:29,505 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 15:22:29,505 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 15:22:51,072 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5664 secs
2025-03-13 15:22:51,074 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4587 secs
2025-03-13 15:22:51,074 [INFO]: {
2025-03-13 15:22:51,074 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:51,074 [INFO]: 	index_param: efSearch=223
2025-03-13 15:22:51,074 [INFO]: 	index_path: knn.index
2025-03-13 15:22:51,074 [INFO]: 	size in bytes: 427524550
2025-03-13 15:22:51,074 [INFO]: 	avg_search_speed_ms: 10.525451784120186
2025-03-13 15:22:51,074 [INFO]: 	99p_search_speed_ms: 14.475822069216518
2025-03-13 15:22:51,074 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:51,074 [INFO]: 	nb vectors: 2173
2025-03-13 15:22:51,074 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:51,074 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 15:22:51,074 [INFO]: }
2025-03-13 15:22:51,074 [INFO]: 	>>> Finished "Creating the index" in 49.4605 secs
2025-03-13 15:22:51,074 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4886 secs
2025-03-13 15:22:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 33024 [episode count 6/20]
[retrieval_preprocessing] for episode 74198 [episode count 7/20], we have num_retrieval=np.int64(2235) num_query=np.int64(77)
2025-03-13 15:22:52,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:53,248 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:53
2025-03-13 15:22:53,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 929.38it/s]
2025-03-13 15:22:53,274 [INFO]: There are 2235 embeddings of dim 49152
2025-03-13 15:22:53,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:22:53,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:53
2025-03-13 15:22:53,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:53,274 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:22:53,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:53,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:53,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:53
2025-03-13 15:22:53,275 [INFO]: 461.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:53,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:22:53,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:53
2025-03-13 15:22:53,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:53,275 [INFO]: 	Creating the index 03/13/2025, 15:22:53
2025-03-13 15:22:53,275 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:53
2025-03-13 15:22:53,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:22:53,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:53
2025-03-13 15:22:53,276 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:22:53,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.92it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.10it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.71it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.05it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.34it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.54it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.67it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.86it/s]100%|██████████| 9/9 [00:02<00:00,  1.81it/s]100%|██████████| 9/9 [00:02<00:00,  3.48it/s]
2025-03-13 15:22:55,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:55
2025-03-13 15:23:21,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7414 secs
2025-03-13 15:23:21,612 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 15:23:21,612 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.09it/s] 50%|█████     | 2/4 [00:00<00:00,  4.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.81it/s]
2025-03-13 15:23:43,531 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9191 secs
2025-03-13 15:23:43,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2571 secs
2025-03-13 15:23:43,533 [INFO]: {
2025-03-13 15:23:43,533 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:43,533 [INFO]: 	index_param: efSearch=130
2025-03-13 15:23:43,533 [INFO]: 	index_path: knn.index
2025-03-13 15:23:43,533 [INFO]: 	size in bytes: 439722610
2025-03-13 15:23:43,533 [INFO]: 	avg_search_speed_ms: 7.339283195050726
2025-03-13 15:23:43,533 [INFO]: 	99p_search_speed_ms: 9.624163410626354
2025-03-13 15:23:43,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:43,533 [INFO]: 	nb vectors: 2235
2025-03-13 15:23:43,533 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:43,533 [INFO]: 	compression ratio: 0.999309269086709
2025-03-13 15:23:43,533 [INFO]: }
2025-03-13 15:23:43,533 [INFO]: 	>>> Finished "Creating the index" in 50.2587 secs
2025-03-13 15:23:43,533 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2856 secs
2025-03-13 15:23:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 74198 [episode count 7/20]
[retrieval_preprocessing] for episode 25199 [episode count 8/20], we have num_retrieval=np.int64(2209) num_query=np.int64(103)
2025-03-13 15:23:44,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:45,281 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:45
2025-03-13 15:23:45,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1329.41it/s]
2025-03-13 15:23:45,308 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 15:23:45,308 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:23:45,308 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:45
2025-03-13 15:23:45,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:45,308 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:23:45,309 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:45,309 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:23:45,309 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:45
2025-03-13 15:23:45,309 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:45,309 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:23:45,309 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:45
2025-03-13 15:23:45,309 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:45,310 [INFO]: 	Creating the index 03/13/2025, 15:23:45
2025-03-13 15:23:45,310 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:45
2025-03-13 15:23:45,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:23:45,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:45
2025-03-13 15:23:45,313 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:23:45,314 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.72it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.85it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.87it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.14it/s]100%|██████████| 9/9 [00:02<00:00,  2.57it/s]100%|██████████| 9/9 [00:02<00:00,  3.65it/s]
2025-03-13 15:23:47,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:47
2025-03-13 15:24:19,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0798 secs
2025-03-13 15:24:19,869 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 15:24:19,869 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 15:24:40,983 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1146 secs
2025-03-13 15:24:40,985 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6721 secs
2025-03-13 15:24:40,986 [INFO]: {
2025-03-13 15:24:40,986 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:40,986 [INFO]: 	index_param: efSearch=125
2025-03-13 15:24:40,986 [INFO]: 	index_path: knn.index
2025-03-13 15:24:40,986 [INFO]: 	size in bytes: 434607370
2025-03-13 15:24:40,986 [INFO]: 	avg_search_speed_ms: 7.305735746182076
2025-03-13 15:24:40,986 [INFO]: 	99p_search_speed_ms: 10.033482913859187
2025-03-13 15:24:40,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:40,986 [INFO]: 	nb vectors: 2209
2025-03-13 15:24:40,986 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:40,986 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 15:24:40,986 [INFO]: }
2025-03-13 15:24:40,986 [INFO]: 	>>> Finished "Creating the index" in 55.6760 secs
2025-03-13 15:24:40,986 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7048 secs
2025-03-13 15:24:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 25199 [episode count 8/20]
[retrieval_preprocessing] for episode 90684 [episode count 9/20], we have num_retrieval=np.int64(2215) num_query=np.int64(97)
2025-03-13 15:24:42,528 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:42,939 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:42
2025-03-13 15:24:42,939 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.54it/s]
2025-03-13 15:24:42,965 [INFO]: There are 2215 embeddings of dim 49152
2025-03-13 15:24:42,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:24:42,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:42
2025-03-13 15:24:42,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:42,966 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:24:42,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:42,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:42,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:42
2025-03-13 15:24:42,966 [INFO]: 457.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:42,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:24:42,966 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:42
2025-03-13 15:24:42,966 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:42,966 [INFO]: 	Creating the index 03/13/2025, 15:24:42
2025-03-13 15:24:42,966 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:42
2025-03-13 15:24:42,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:24:42,967 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:42
2025-03-13 15:24:42,967 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:24:42,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.25it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.36it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.12it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.54it/s]100%|██████████| 9/9 [00:02<00:00,  2.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.82it/s]
2025-03-13 15:24:45,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:45
2025-03-13 15:25:10,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2991 secs
2025-03-13 15:25:10,634 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:25:10,634 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 15:25:25,943 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3093 secs
2025-03-13 15:25:25,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9777 secs
2025-03-13 15:25:25,945 [INFO]: {
2025-03-13 15:25:25,945 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:25,945 [INFO]: 	index_param: efSearch=206
2025-03-13 15:25:25,945 [INFO]: 	index_path: knn.index
2025-03-13 15:25:25,945 [INFO]: 	size in bytes: 435787810
2025-03-13 15:25:25,945 [INFO]: 	avg_search_speed_ms: 11.27823023676763
2025-03-13 15:25:25,945 [INFO]: 	99p_search_speed_ms: 20.423266119323667
2025-03-13 15:25:25,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:25,945 [INFO]: 	nb vectors: 2215
2025-03-13 15:25:25,945 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:25,945 [INFO]: 	compression ratio: 0.9993090903575297
2025-03-13 15:25:25,945 [INFO]: }
2025-03-13 15:25:25,945 [INFO]: 	>>> Finished "Creating the index" in 42.9793 secs
2025-03-13 15:25:25,945 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0060 secs
2025-03-13 15:25:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 90684 [episode count 9/20]
[retrieval_preprocessing] for episode 67579 [episode count 10/20], we have num_retrieval=np.int64(2188) num_query=np.int64(124)
2025-03-13 15:25:27,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:27,904 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:27
2025-03-13 15:25:27,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.97it/s]
2025-03-13 15:25:27,927 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 15:25:27,927 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 15:25:27,927 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:27
2025-03-13 15:25:27,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:27,927 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:25:27,927 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:27,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:27,927 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:27
2025-03-13 15:25:27,927 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:27,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:25:27,927 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:27
2025-03-13 15:25:27,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:27,927 [INFO]: 	Creating the index 03/13/2025, 15:25:27
2025-03-13 15:25:27,928 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:27
2025-03-13 15:25:27,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:25:27,928 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:27
2025-03-13 15:25:27,929 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:25:27,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.12it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.98it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.43it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.64it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.24it/s]100%|██████████| 9/9 [00:02<00:00,  3.35it/s]
2025-03-13 15:25:30,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:30
2025-03-13 15:25:59,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7446 secs
2025-03-13 15:25:59,367 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 15:25:59,367 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 15:26:24,999 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6320 secs
2025-03-13 15:26:25,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0740 secs
2025-03-13 15:26:25,003 [INFO]: {
2025-03-13 15:26:25,003 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:25,003 [INFO]: 	index_param: efSearch=194
2025-03-13 15:26:25,003 [INFO]: 	index_path: knn.index
2025-03-13 15:26:25,003 [INFO]: 	size in bytes: 430475830
2025-03-13 15:26:25,003 [INFO]: 	avg_search_speed_ms: 10.789643521013769
2025-03-13 15:26:25,003 [INFO]: 	99p_search_speed_ms: 19.23321865964681
2025-03-13 15:26:25,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:25,003 [INFO]: 	nb vectors: 2188
2025-03-13 15:26:25,003 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:25,003 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 15:26:25,003 [INFO]: }
2025-03-13 15:26:25,003 [INFO]: 	>>> Finished "Creating the index" in 57.0756 secs
2025-03-13 15:26:25,003 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0988 secs
2025-03-13 15:26:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 67579 [episode count 10/20]
[retrieval_preprocessing] for episode 59420 [episode count 11/20], we have num_retrieval=np.int64(2212) num_query=np.int64(100)
2025-03-13 15:26:27,639 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:28,172 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:28
2025-03-13 15:26:28,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.00it/s]
2025-03-13 15:26:28,202 [INFO]: There are 2212 embeddings of dim 49152
2025-03-13 15:26:28,202 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 15:26:28,202 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:28
2025-03-13 15:26:28,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:28,202 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:26:28,202 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:28,202 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:28,202 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:28
2025-03-13 15:26:28,203 [INFO]: 456.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:28,203 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:28,203 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:28
2025-03-13 15:26:28,203 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:28,203 [INFO]: 	Creating the index 03/13/2025, 15:26:28
2025-03-13 15:26:28,203 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:28
2025-03-13 15:26:28,204 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:26:28,204 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:28
2025-03-13 15:26:28,204 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:26:28,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.52it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.65it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.85it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.05it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.13it/s] 67%|██████▋   | 6/9 [00:01<00:00,  6.16it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.21it/s] 89%|████████▉ | 8/9 [00:01<00:00,  6.31it/s]100%|██████████| 9/9 [00:02<00:00,  1.59it/s]100%|██████████| 9/9 [00:02<00:00,  3.01it/s]
2025-03-13 15:26:31,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:31
2025-03-13 15:26:59,397 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1977 secs
2025-03-13 15:26:59,397 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 15:26:59,397 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s]
2025-03-13 15:27:18,605 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2079 secs
2025-03-13 15:27:18,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4033 secs
2025-03-13 15:27:18,608 [INFO]: {
2025-03-13 15:27:18,608 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:18,608 [INFO]: 	index_param: efSearch=197
2025-03-13 15:27:18,608 [INFO]: 	index_path: knn.index
2025-03-13 15:27:18,608 [INFO]: 	size in bytes: 435197590
2025-03-13 15:27:18,608 [INFO]: 	avg_search_speed_ms: 10.231792927264953
2025-03-13 15:27:18,608 [INFO]: 	99p_search_speed_ms: 14.763211281970143
2025-03-13 15:27:18,608 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:18,608 [INFO]: 	nb vectors: 2212
2025-03-13 15:27:18,608 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:18,608 [INFO]: 	compression ratio: 0.9993090632693991
2025-03-13 15:27:18,608 [INFO]: }
2025-03-13 15:27:18,608 [INFO]: 	>>> Finished "Creating the index" in 50.4051 secs
2025-03-13 15:27:18,608 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4359 secs
2025-03-13 15:27:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 59420 [episode count 11/20]
[retrieval_preprocessing] for episode 9320 [episode count 12/20], we have num_retrieval=np.int64(2188) num_query=np.int64(124)
2025-03-13 15:27:20,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:20,703 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:20
2025-03-13 15:27:20,704 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.21it/s]
2025-03-13 15:27:20,729 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 15:27:20,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:27:20,730 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:20
2025-03-13 15:27:20,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:20,730 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:27:20,730 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:20,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:20,730 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:20
2025-03-13 15:27:20,730 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:20,730 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:20,730 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:20
2025-03-13 15:27:20,730 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:20,730 [INFO]: 	Creating the index 03/13/2025, 15:27:20
2025-03-13 15:27:20,730 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:20
2025-03-13 15:27:20,731 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:27:20,732 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:20
2025-03-13 15:27:20,732 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:27:20,732 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.47it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.68it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.74it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.14it/s]100%|██████████| 9/9 [00:02<00:00,  2.42it/s]100%|██████████| 9/9 [00:02<00:00,  3.51it/s]
2025-03-13 15:27:23,901 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:23
2025-03-13 15:27:49,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7100 secs
2025-03-13 15:27:49,611 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:27:49,612 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 15:28:13,770 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1587 secs
2025-03-13 15:28:13,773 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0408 secs
2025-03-13 15:28:13,773 [INFO]: {
2025-03-13 15:28:13,774 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:13,774 [INFO]: 	index_param: efSearch=159
2025-03-13 15:28:13,774 [INFO]: 	index_path: knn.index
2025-03-13 15:28:13,774 [INFO]: 	size in bytes: 430475830
2025-03-13 15:28:13,774 [INFO]: 	avg_search_speed_ms: 10.033545375044048
2025-03-13 15:28:13,774 [INFO]: 	99p_search_speed_ms: 17.436941144987923
2025-03-13 15:28:13,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:13,774 [INFO]: 	nb vectors: 2188
2025-03-13 15:28:13,774 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:13,774 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 15:28:13,774 [INFO]: }
2025-03-13 15:28:13,774 [INFO]: 	>>> Finished "Creating the index" in 53.0436 secs
2025-03-13 15:28:13,774 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0703 secs
2025-03-13 15:28:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 9320 [episode count 12/20]
[retrieval_preprocessing] for episode 9598 [episode count 13/20], we have num_retrieval=np.int64(2210) num_query=np.int64(102)
2025-03-13 15:28:15,449 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:15,802 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:15
2025-03-13 15:28:15,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.81it/s]
2025-03-13 15:28:15,827 [INFO]: There are 2210 embeddings of dim 49152
2025-03-13 15:28:15,827 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:28:15,827 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,827 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:15,827 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:28:15,827 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:15,827 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:15,827 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,827 [INFO]: 456.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:15,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:28:15,827 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:15
2025-03-13 15:28:15,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:15,827 [INFO]: 	Creating the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:15
2025-03-13 15:28:15,829 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:28:15,829 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,829 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:28:15,829 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.78it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.65it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.42it/s] 78%|███████▊  | 7/9 [00:00<00:00, 14.41it/s]100%|██████████| 9/9 [00:02<00:00,  2.91it/s]100%|██████████| 9/9 [00:02<00:00,  4.24it/s]
2025-03-13 15:28:17,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:17
2025-03-13 15:28:46,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5630 secs
2025-03-13 15:28:46,522 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 15:28:46,522 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.38it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 15:29:03,495 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9726 secs
2025-03-13 15:29:03,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6680 secs
2025-03-13 15:29:03,497 [INFO]: {
2025-03-13 15:29:03,497 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:03,497 [INFO]: 	index_param: efSearch=138
2025-03-13 15:29:03,497 [INFO]: 	index_path: knn.index
2025-03-13 15:29:03,497 [INFO]: 	size in bytes: 434804110
2025-03-13 15:29:03,497 [INFO]: 	avg_search_speed_ms: 8.330004529367821
2025-03-13 15:29:03,497 [INFO]: 	99p_search_speed_ms: 12.816246731672436
2025-03-13 15:29:03,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:03,497 [INFO]: 	nb vectors: 2210
2025-03-13 15:29:03,497 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:03,497 [INFO]: 	compression ratio: 0.9993090451697892
2025-03-13 15:29:03,497 [INFO]: }
2025-03-13 15:29:03,498 [INFO]: 	>>> Finished "Creating the index" in 47.6700 secs
2025-03-13 15:29:03,498 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6954 secs
2025-03-13 15:29:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 9598 [episode count 13/20]
[retrieval_preprocessing] for episode 1520 [episode count 14/20], we have num_retrieval=np.int64(2204) num_query=np.int64(108)
2025-03-13 15:29:05,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:05,345 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:05
2025-03-13 15:29:05,345 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2216.86it/s]
2025-03-13 15:29:05,368 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 15:29:05,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 15:29:05,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:05
2025-03-13 15:29:05,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:05,368 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:29:05,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:05,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:29:05,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:05
2025-03-13 15:29:05,369 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:05,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:29:05,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:05
2025-03-13 15:29:05,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:05,369 [INFO]: 	Creating the index 03/13/2025, 15:29:05
2025-03-13 15:29:05,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:05
2025-03-13 15:29:05,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:29:05,370 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:05
2025-03-13 15:29:05,370 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:29:05,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.98it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.32it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.47it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.62it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.86it/s]100%|██████████| 9/9 [00:02<00:00,  2.57it/s]100%|██████████| 9/9 [00:02<00:00,  3.51it/s]
2025-03-13 15:29:07,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:07
2025-03-13 15:29:34,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8934 secs
2025-03-13 15:29:34,835 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:29:34,835 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.52it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 15:29:59,348 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5128 secs
2025-03-13 15:29:59,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9806 secs
2025-03-13 15:29:59,351 [INFO]: {
2025-03-13 15:29:59,351 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:59,351 [INFO]: 	index_param: efSearch=211
2025-03-13 15:29:59,351 [INFO]: 	index_path: knn.index
2025-03-13 15:29:59,351 [INFO]: 	size in bytes: 433623670
2025-03-13 15:29:59,351 [INFO]: 	avg_search_speed_ms: 11.129022034887925
2025-03-13 15:29:59,351 [INFO]: 	99p_search_speed_ms: 17.78506022877991
2025-03-13 15:29:59,351 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:59,351 [INFO]: 	nb vectors: 2204
2025-03-13 15:29:59,351 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:59,351 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 15:29:59,351 [INFO]: }
2025-03-13 15:29:59,351 [INFO]: 	>>> Finished "Creating the index" in 53.9820 secs
2025-03-13 15:29:59,351 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0060 secs
2025-03-13 15:29:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 1520 [episode count 14/20]
[retrieval_preprocessing] for episode 82926 [episode count 15/20], we have num_retrieval=np.int64(2226) num_query=np.int64(86)
2025-03-13 15:30:01,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:01,910 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:01
2025-03-13 15:30:01,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.72it/s]
2025-03-13 15:30:01,934 [INFO]: There are 2226 embeddings of dim 49152
2025-03-13 15:30:01,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 15:30:01,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:01,935 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:30:01,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:01,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:30:01,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,935 [INFO]: 459.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:01,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:30:01,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:01
2025-03-13 15:30:01,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:01,935 [INFO]: 	Creating the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,935 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:01
2025-03-13 15:30:01,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:30:01,936 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,936 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:30:01,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.13it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.97it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.73it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.98it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.72it/s]100%|██████████| 9/9 [00:02<00:00,  2.47it/s]100%|██████████| 9/9 [00:02<00:00,  3.53it/s]
2025-03-13 15:30:04,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:04
2025-03-13 15:30:35,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0981 secs
2025-03-13 15:30:35,589 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:30:35,589 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 15:30:56,642 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0535 secs
2025-03-13 15:30:56,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7079 secs
2025-03-13 15:30:56,644 [INFO]: {
2025-03-13 15:30:56,644 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:56,644 [INFO]: 	index_param: efSearch=202
2025-03-13 15:30:56,644 [INFO]: 	index_path: knn.index
2025-03-13 15:30:56,644 [INFO]: 	size in bytes: 437951950
2025-03-13 15:30:56,644 [INFO]: 	avg_search_speed_ms: 10.723204875768173
2025-03-13 15:30:56,644 [INFO]: 	99p_search_speed_ms: 14.318621782585973
2025-03-13 15:30:56,644 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:56,644 [INFO]: 	nb vectors: 2226
2025-03-13 15:30:56,644 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:56,644 [INFO]: 	compression ratio: 0.9993091890560141
2025-03-13 15:30:56,644 [INFO]: }
2025-03-13 15:30:56,644 [INFO]: 	>>> Finished "Creating the index" in 54.7094 secs
2025-03-13 15:30:56,644 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7348 secs
2025-03-13 15:30:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 82926 [episode count 15/20]
[retrieval_preprocessing] for episode 1384 [episode count 16/20], we have num_retrieval=np.int64(2224) num_query=np.int64(88)
2025-03-13 15:30:58,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:58,791 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:58
2025-03-13 15:30:58,791 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 15:30:58,998 [INFO]: There are 2224 embeddings of dim 49152
2025-03-13 15:30:58,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2072 secs
2025-03-13 15:30:58,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:58
2025-03-13 15:30:58,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:58,999 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:30:58,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:58,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:30:58,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:58
2025-03-13 15:30:58,999 [INFO]: 459.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:59,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:30:59,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:59
2025-03-13 15:30:59,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:59,000 [INFO]: 	Creating the index 03/13/2025, 15:30:59
2025-03-13 15:30:59,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:59
2025-03-13 15:30:59,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:30:59,003 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:59
2025-03-13 15:30:59,003 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:30:59,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.26it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.54it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.11it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.31it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.42it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.49it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.50it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.61it/s]100%|██████████| 9/9 [00:02<00:00,  1.56it/s]100%|██████████| 9/9 [00:02<00:00,  3.14it/s]
2025-03-13 15:31:01,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:01
2025-03-13 15:31:29,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1811 secs
2025-03-13 15:31:29,063 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:31:29,063 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 15:31:58,639 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5759 secs
2025-03-13 15:31:58,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6391 secs
2025-03-13 15:31:58,643 [INFO]: {
2025-03-13 15:31:58,643 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:58,643 [INFO]: 	index_param: efSearch=183
2025-03-13 15:31:58,643 [INFO]: 	index_path: knn.index
2025-03-13 15:31:58,643 [INFO]: 	size in bytes: 437558470
2025-03-13 15:31:58,643 [INFO]: 	avg_search_speed_ms: 9.778446130971638
2025-03-13 15:31:58,643 [INFO]: 	99p_search_speed_ms: 17.710505351424207
2025-03-13 15:31:58,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:58,643 [INFO]: 	nb vectors: 2224
2025-03-13 15:31:58,643 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:58,643 [INFO]: 	compression ratio: 0.9993091711834535
2025-03-13 15:31:58,643 [INFO]: }
2025-03-13 15:31:58,643 [INFO]: 	>>> Finished "Creating the index" in 59.6433 secs
2025-03-13 15:31:58,643 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8527 secs
2025-03-13 15:31:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 1384 [episode count 16/20]
[retrieval_preprocessing] for episode 18535 [episode count 17/20], we have num_retrieval=np.int64(2195) num_query=np.int64(117)
2025-03-13 15:32:00,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:00,719 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:00
2025-03-13 15:32:00,719 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1639.04it/s]
2025-03-13 15:32:00,739 [INFO]: There are 2195 embeddings of dim 49152
2025-03-13 15:32:00,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0196 secs
2025-03-13 15:32:00,739 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:00
2025-03-13 15:32:00,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:00,739 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:32:00,739 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:00,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:00,739 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:00
2025-03-13 15:32:00,739 [INFO]: 453.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:00,739 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:32:00,739 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:00
2025-03-13 15:32:00,739 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:00,739 [INFO]: 	Creating the index 03/13/2025, 15:32:00
2025-03-13 15:32:00,739 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:00
2025-03-13 15:32:00,740 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:32:00,740 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:00
2025-03-13 15:32:00,741 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:32:00,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.18it/s] 22%|██▏       | 2/9 [00:00<00:01,  4.91it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.67it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.24it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.87it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.48it/s] 89%|████████▉ | 8/9 [00:01<00:00,  9.02it/s]100%|██████████| 9/9 [00:02<00:00,  1.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.07it/s]
2025-03-13 15:32:03,677 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:03
2025-03-13 15:32:38,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5277 secs
2025-03-13 15:32:38,205 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 15:32:38,205 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-13 15:32:54,650 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4442 secs
2025-03-13 15:32:54,652 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9116 secs
2025-03-13 15:32:54,653 [INFO]: {
2025-03-13 15:32:54,653 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:54,653 [INFO]: 	index_param: efSearch=127
2025-03-13 15:32:54,653 [INFO]: 	index_path: knn.index
2025-03-13 15:32:54,653 [INFO]: 	size in bytes: 431853010
2025-03-13 15:32:54,653 [INFO]: 	avg_search_speed_ms: 8.749315956581388
2025-03-13 15:32:54,653 [INFO]: 	99p_search_speed_ms: 12.666837442666264
2025-03-13 15:32:54,653 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:54,653 [INFO]: 	nb vectors: 2195
2025-03-13 15:32:54,653 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:54,653 [INFO]: 	compression ratio: 0.9993089083713924
2025-03-13 15:32:54,653 [INFO]: }
2025-03-13 15:32:54,653 [INFO]: 	>>> Finished "Creating the index" in 53.9138 secs
2025-03-13 15:32:54,653 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9339 secs
2025-03-13 15:32:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 18535 [episode count 17/20]
[retrieval_preprocessing] for episode 35190 [episode count 18/20], we have num_retrieval=np.int64(2205) num_query=np.int64(107)
2025-03-13 15:32:56,737 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:57,141 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:57
2025-03-13 15:32:57,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.79it/s]
2025-03-13 15:32:57,168 [INFO]: There are 2205 embeddings of dim 49152
2025-03-13 15:32:57,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:32:57,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:57
2025-03-13 15:32:57,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:57,168 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:32:57,168 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:57,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:57,168 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:57
2025-03-13 15:32:57,169 [INFO]: 455.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:57,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:57,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:57
2025-03-13 15:32:57,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:57,169 [INFO]: 	Creating the index 03/13/2025, 15:32:57
2025-03-13 15:32:57,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:57
2025-03-13 15:32:57,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:32:57,170 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:57
2025-03-13 15:32:57,170 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:32:57,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.07it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.80it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.60it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.00it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.27it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.42it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.66it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.65it/s]100%|██████████| 9/9 [00:02<00:00,  1.42it/s]100%|██████████| 9/9 [00:02<00:00,  3.01it/s]
2025-03-13 15:33:00,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:00
2025-03-13 15:33:27,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8716 secs
2025-03-13 15:33:27,037 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:33:27,037 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s]
2025-03-13 15:33:51,926 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8883 secs
2025-03-13 15:33:52,505 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3349 secs
2025-03-13 15:33:52,505 [INFO]: {
2025-03-13 15:33:52,505 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:52,505 [INFO]: 	index_param: efSearch=176
2025-03-13 15:33:52,505 [INFO]: 	index_path: knn.index
2025-03-13 15:33:52,505 [INFO]: 	size in bytes: 433820410
2025-03-13 15:33:52,505 [INFO]: 	avg_search_speed_ms: 9.293269383553138
2025-03-13 15:33:52,505 [INFO]: 	99p_search_speed_ms: 15.165914490353316
2025-03-13 15:33:52,505 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:52,506 [INFO]: 	nb vectors: 2205
2025-03-13 15:33:52,506 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:52,506 [INFO]: 	compression ratio: 0.9993089997771197
2025-03-13 15:33:52,506 [INFO]: }
2025-03-13 15:33:52,506 [INFO]: 	>>> Finished "Creating the index" in 55.3370 secs
2025-03-13 15:33:52,506 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3648 secs
2025-03-13 15:33:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 35190 [episode count 18/20]
[retrieval_preprocessing] for episode 4117 [episode count 19/20], we have num_retrieval=np.int64(2209) num_query=np.int64(103)
2025-03-13 15:33:54,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:54,623 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:54
2025-03-13 15:33:54,624 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.08it/s]
2025-03-13 15:33:54,657 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 15:33:54,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 15:33:54,657 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:54,657 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:33:54,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:54,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:54,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,658 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:54,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:33:54,658 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:54
2025-03-13 15:33:54,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:54,658 [INFO]: 	Creating the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,658 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:54
2025-03-13 15:33:54,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:33:54,659 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,659 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:33:54,659 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.28it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.10it/s]100%|██████████| 9/9 [00:02<00:00,  3.27it/s]100%|██████████| 9/9 [00:02<00:00,  4.04it/s]
2025-03-13 15:33:56,891 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:56
2025-03-13 15:34:33,888 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9961 secs
2025-03-13 15:34:33,888 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 15:34:33,888 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 15:34:49,005 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1165 secs
2025-03-13 15:34:49,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3475 secs
2025-03-13 15:34:49,007 [INFO]: {
2025-03-13 15:34:49,007 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:49,007 [INFO]: 	index_param: efSearch=114
2025-03-13 15:34:49,007 [INFO]: 	index_path: knn.index
2025-03-13 15:34:49,007 [INFO]: 	size in bytes: 434607370
2025-03-13 15:34:49,007 [INFO]: 	avg_search_speed_ms: 9.413579322762521
2025-03-13 15:34:49,007 [INFO]: 	99p_search_speed_ms: 13.996738123241816
2025-03-13 15:34:49,007 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:49,007 [INFO]: 	nb vectors: 2209
2025-03-13 15:34:49,007 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:49,007 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 15:34:49,007 [INFO]: }
2025-03-13 15:34:49,007 [INFO]: 	>>> Finished "Creating the index" in 54.3494 secs
2025-03-13 15:34:49,007 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3836 secs
2025-03-13 15:34:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 4117 [episode count 19/20]
2025-03-13 15:34:49: [retrieval_preprocessing] finished for -1_put_marker_in_bowl [chosen_id count 2/196]
2025-03-13 15:34:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_put_marker_in_pot [chosen_id count 3/196]
2025-03-13 15:34:51: [retrieval_preprocessing] we have num_total=4222 embedding_dim=49152
[retrieval_preprocessing] for episode 49314 [episode count 0/20], we have num_retrieval=np.int64(4001) num_query=np.int64(221)
2025-03-13 15:34:52,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:52,973 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:52
2025-03-13 15:34:52,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 870.37it/s]
2025-03-13 15:34:53,008 [INFO]: There are 4001 embeddings of dim 49152
2025-03-13 15:34:53,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 15:34:53,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:53
2025-03-13 15:34:53,008 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:53,008 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:34:53,008 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:53,008 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:34:53,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:53
2025-03-13 15:34:53,009 [INFO]: 825.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:53,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:53,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:53
2025-03-13 15:34:53,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:53,009 [INFO]: 	Creating the index 03/13/2025, 15:34:53
2025-03-13 15:34:53,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:53
2025-03-13 15:34:53,010 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:34:53,011 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:53
2025-03-13 15:34:53,011 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:34:53,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.84it/s] 25%|██▌       | 4/16 [00:00<00:00, 19.84it/s] 44%|████▍     | 7/16 [00:00<00:00, 23.20it/s] 62%|██████▎   | 10/16 [00:00<00:00, 24.85it/s] 81%|████████▏ | 13/16 [00:00<00:00, 26.17it/s]100%|██████████| 16/16 [00:04<00:00,  1.85it/s]100%|██████████| 16/16 [00:04<00:00,  3.24it/s]
2025-03-13 15:34:58,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:58
2025-03-13 15:35:48,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.6011 secs
2025-03-13 15:35:48,805 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:35:48,805 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.25it/s]
2025-03-13 15:36:20,557 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7516 secs
2025-03-13 15:36:20,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5498 secs
2025-03-13 15:36:20,561 [INFO]: {
2025-03-13 15:36:20,561 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:20,561 [INFO]: 	index_param: efSearch=200
2025-03-13 15:36:20,561 [INFO]: 	index_path: knn.index
2025-03-13 15:36:20,561 [INFO]: 	size in bytes: 787172890
2025-03-13 15:36:20,561 [INFO]: 	avg_search_speed_ms: 11.695827273325177
2025-03-13 15:36:20,561 [INFO]: 	99p_search_speed_ms: 16.48919783066959
2025-03-13 15:36:20,561 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:20,561 [INFO]: 	nb vectors: 4001
2025-03-13 15:36:20,561 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:20,561 [INFO]: 	compression ratio: 0.9993085610455918
2025-03-13 15:36:20,561 [INFO]: }
2025-03-13 15:36:20,561 [INFO]: 	>>> Finished "Creating the index" in 87.5523 secs
2025-03-13 15:36:20,561 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5881 secs
2025-03-13 15:36:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 49314 [episode count 0/20]
[retrieval_preprocessing] for episode 41123 [episode count 1/20], we have num_retrieval=np.int64(4052) num_query=np.int64(170)
2025-03-13 15:36:23,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:24,812 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:24
2025-03-13 15:36:24,812 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.15it/s]
2025-03-13 15:36:24,849 [INFO]: There are 4052 embeddings of dim 49152
2025-03-13 15:36:24,850 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 15:36:24,850 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,850 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:24,850 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:36:24,850 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:24,850 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:24,850 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,850 [INFO]: 836.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:24,850 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:36:24,850 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:24
2025-03-13 15:36:24,850 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:24,850 [INFO]: 	Creating the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,850 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:24
2025-03-13 15:36:24,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:36:24,852 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,852 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:36:24,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.99it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.84it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.33it/s]100%|██████████| 16/16 [00:04<00:00,  2.92it/s]100%|██████████| 16/16 [00:04<00:00,  3.94it/s]
2025-03-13 15:36:28,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:28
2025-03-13 15:37:24,882 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.9679 secs
2025-03-13 15:37:24,883 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 15:37:24,883 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 15:37:46,266 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3832 secs
2025-03-13 15:37:46,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.4180 secs
2025-03-13 15:37:46,270 [INFO]: {
2025-03-13 15:37:46,270 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:46,270 [INFO]: 	index_param: efSearch=111
2025-03-13 15:37:46,270 [INFO]: 	index_path: knn.index
2025-03-13 15:37:46,270 [INFO]: 	size in bytes: 797206810
2025-03-13 15:37:46,270 [INFO]: 	avg_search_speed_ms: 11.307208732189821
2025-03-13 15:37:46,270 [INFO]: 	99p_search_speed_ms: 34.3418365693651
2025-03-13 15:37:46,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:46,270 [INFO]: 	nb vectors: 4052
2025-03-13 15:37:46,270 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:46,270 [INFO]: 	compression ratio: 0.9993085934627176
2025-03-13 15:37:46,270 [INFO]: }
2025-03-13 15:37:46,270 [INFO]: 	>>> Finished "Creating the index" in 81.4197 secs
2025-03-13 15:37:46,270 [INFO]: >>> Finished "Launching the whole pipeline" in 81.4583 secs
2025-03-13 15:37:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 41123 [episode count 1/20]
[retrieval_preprocessing] for episode 74202 [episode count 2/20], we have num_retrieval=np.int64(4026) num_query=np.int64(196)
2025-03-13 15:37:47,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:48,563 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:48
2025-03-13 15:37:48,563 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.81it/s]
2025-03-13 15:37:48,592 [INFO]: There are 4026 embeddings of dim 49152
2025-03-13 15:37:48,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 15:37:48,592 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:48
2025-03-13 15:37:48,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:48,592 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:37:48,592 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:48,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:37:48,592 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:48
2025-03-13 15:37:48,593 [INFO]: 830.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:48,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:37:48,593 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:48
2025-03-13 15:37:48,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:48,593 [INFO]: 	Creating the index 03/13/2025, 15:37:48
2025-03-13 15:37:48,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:48
2025-03-13 15:37:48,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:37:48,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:48
2025-03-13 15:37:48,594 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:37:48,594 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.65it/s] 31%|███▏      | 5/16 [00:00<00:00, 22.11it/s] 56%|█████▋    | 9/16 [00:00<00:00, 28.34it/s] 81%|████████▏ | 13/16 [00:00<00:00, 31.57it/s]100%|██████████| 16/16 [00:03<00:00,  4.15it/s]
2025-03-13 15:37:52,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:52
2025-03-13 15:38:39,478 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0216 secs
2025-03-13 15:38:39,479 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:38:39,479 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  3.00s/it] 50%|█████     | 2/4 [00:04<00:03,  1.89s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.45s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.23s/it]
2025-03-13 15:39:25,668 [INFO]: 	>>> Finished "Compute fast metrics" in 46.1894 secs
2025-03-13 15:39:25,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.0792 secs
2025-03-13 15:39:25,673 [INFO]: {
2025-03-13 15:39:25,673 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:25,673 [INFO]: 	index_param: efSearch=196
2025-03-13 15:39:25,674 [INFO]: 	index_path: knn.index
2025-03-13 15:39:25,674 [INFO]: 	size in bytes: 792091510
2025-03-13 15:39:25,674 [INFO]: 	avg_search_speed_ms: 9.796992162092936
2025-03-13 15:39:25,674 [INFO]: 	99p_search_speed_ms: 13.692795857787129
2025-03-13 15:39:25,674 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:25,674 [INFO]: 	nb vectors: 4026
2025-03-13 15:39:25,674 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:25,674 [INFO]: 	compression ratio: 0.9993085369643717
2025-03-13 15:39:25,674 [INFO]: }
2025-03-13 15:39:25,674 [INFO]: 	>>> Finished "Creating the index" in 97.0810 secs
2025-03-13 15:39:25,674 [INFO]: >>> Finished "Launching the whole pipeline" in 97.1109 secs
2025-03-13 15:39:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 74202 [episode count 2/20]
[retrieval_preprocessing] for episode 49448 [episode count 3/20], we have num_retrieval=np.int64(3993) num_query=np.int64(229)
2025-03-13 15:39:28,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:28,845 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:28
2025-03-13 15:39:28,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.22it/s]
2025-03-13 15:39:28,885 [INFO]: There are 3993 embeddings of dim 49152
2025-03-13 15:39:28,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 15:39:28,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:28,886 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:39:28,886 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:28,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:39:28,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,886 [INFO]: 824.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:28,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:39:28,886 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:28
2025-03-13 15:39:28,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:28,886 [INFO]: 	Creating the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,886 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:28
2025-03-13 15:39:28,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:39:28,887 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,888 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:39:28,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.51it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.86it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.12it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.85it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.41it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.74it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.28it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.53it/s]100%|██████████| 16/16 [00:07<00:00,  1.13s/it]100%|██████████| 16/16 [00:07<00:00,  2.23it/s]
2025-03-13 15:39:36,082 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:36
2025-03-13 15:40:22,427 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3453 secs
2025-03-13 15:40:22,428 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:40:22,428 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.68it/s]
2025-03-13 15:40:53,481 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0533 secs
2025-03-13 15:40:53,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9930 secs
2025-03-13 15:40:53,881 [INFO]: {
2025-03-13 15:40:53,881 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:53,881 [INFO]: 	index_param: efSearch=173
2025-03-13 15:40:53,881 [INFO]: 	index_path: knn.index
2025-03-13 15:40:53,881 [INFO]: 	size in bytes: 785598910
2025-03-13 15:40:53,882 [INFO]: 	avg_search_speed_ms: 10.008748510276323
2025-03-13 15:40:53,882 [INFO]: 	99p_search_speed_ms: 15.599170876666902
2025-03-13 15:40:53,882 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:53,882 [INFO]: 	nb vectors: 3993
2025-03-13 15:40:53,882 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:53,882 [INFO]: 	compression ratio: 0.9993085962912042
2025-03-13 15:40:53,882 [INFO]: }
2025-03-13 15:40:53,882 [INFO]: 	>>> Finished "Creating the index" in 84.9957 secs
2025-03-13 15:40:53,882 [INFO]: >>> Finished "Launching the whole pipeline" in 85.0372 secs
2025-03-13 15:40:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 49448 [episode count 3/20]
[retrieval_preprocessing] for episode 256 [episode count 4/20], we have num_retrieval=np.int64(4046) num_query=np.int64(176)
2025-03-13 15:40:55,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:56,534 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:56
2025-03-13 15:40:56,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-13 15:40:56,564 [INFO]: There are 4046 embeddings of dim 49152
2025-03-13 15:40:56,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 15:40:56,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:56
2025-03-13 15:40:56,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:56,565 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:40:56,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:56,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:40:56,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:56
2025-03-13 15:40:56,566 [INFO]: 835.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:56,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:40:56,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:56
2025-03-13 15:40:56,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:56,566 [INFO]: 	Creating the index 03/13/2025, 15:40:56
2025-03-13 15:40:56,567 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:56
2025-03-13 15:40:56,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:40:56,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:56
2025-03-13 15:40:56,570 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:40:56,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.04it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.39it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.73it/s] 94%|█████████▍| 15/16 [00:00<00:00, 35.77it/s]100%|██████████| 16/16 [00:04<00:00,  3.54it/s]
2025-03-13 15:41:01,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:01
2025-03-13 15:41:46,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3659 secs
2025-03-13 15:41:46,462 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:41:46,462 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.68it/s]
2025-03-13 15:42:11,775 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3135 secs
2025-03-13 15:42:11,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2090 secs
2025-03-13 15:42:11,779 [INFO]: {
2025-03-13 15:42:11,779 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:11,779 [INFO]: 	index_param: efSearch=183
2025-03-13 15:42:11,779 [INFO]: 	index_path: knn.index
2025-03-13 15:42:11,779 [INFO]: 	size in bytes: 796026370
2025-03-13 15:42:11,779 [INFO]: 	avg_search_speed_ms: 12.016188157968617
2025-03-13 15:42:11,779 [INFO]: 	99p_search_speed_ms: 21.750534402672194
2025-03-13 15:42:11,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:11,779 [INFO]: 	nb vectors: 4046
2025-03-13 15:42:11,779 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:11,779 [INFO]: 	compression ratio: 0.9993085631070237
2025-03-13 15:42:11,779 [INFO]: }
2025-03-13 15:42:11,779 [INFO]: 	>>> Finished "Creating the index" in 75.2127 secs
2025-03-13 15:42:11,779 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2446 secs
2025-03-13 15:42:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 256 [episode count 4/20]
[retrieval_preprocessing] for episode 90763 [episode count 5/20], we have num_retrieval=np.int64(4026) num_query=np.int64(196)
2025-03-13 15:42:14,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:15,769 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:15
2025-03-13 15:42:15,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 883.20it/s]
2025-03-13 15:42:15,800 [INFO]: There are 4026 embeddings of dim 49152
2025-03-13 15:42:15,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 15:42:15,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:15
2025-03-13 15:42:15,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:15,800 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:42:15,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:15,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:42:15,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:15
2025-03-13 15:42:15,800 [INFO]: 830.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:15,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:42:15,800 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:15
2025-03-13 15:42:15,800 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:15,801 [INFO]: 	Creating the index 03/13/2025, 15:42:15
2025-03-13 15:42:15,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:15
2025-03-13 15:42:15,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:42:15,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:15
2025-03-13 15:42:15,802 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:42:15,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.39it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.52it/s] 56%|█████▋    | 9/16 [00:00<00:00, 27.92it/s] 81%|████████▏ | 13/16 [00:00<00:00, 31.16it/s]100%|██████████| 16/16 [00:06<00:00,  2.52it/s]
2025-03-13 15:42:22,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:22
2025-03-13 15:43:14,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1182 secs
2025-03-13 15:43:14,271 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 15:43:14,271 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.85it/s]
2025-03-13 15:43:42,351 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0796 secs
2025-03-13 15:43:42,354 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.5522 secs
2025-03-13 15:43:42,354 [INFO]: {
2025-03-13 15:43:42,354 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:42,354 [INFO]: 	index_param: efSearch=172
2025-03-13 15:43:42,354 [INFO]: 	index_path: knn.index
2025-03-13 15:43:42,354 [INFO]: 	size in bytes: 792091510
2025-03-13 15:43:42,354 [INFO]: 	avg_search_speed_ms: 10.358565420685547
2025-03-13 15:43:42,354 [INFO]: 	99p_search_speed_ms: 13.897757325321436
2025-03-13 15:43:42,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:42,354 [INFO]: 	nb vectors: 4026
2025-03-13 15:43:42,354 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:42,355 [INFO]: 	compression ratio: 0.9993085369643717
2025-03-13 15:43:42,355 [INFO]: }
2025-03-13 15:43:42,355 [INFO]: 	>>> Finished "Creating the index" in 86.5540 secs
2025-03-13 15:43:42,355 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5856 secs
2025-03-13 15:43:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 90763 [episode count 5/20]
[retrieval_preprocessing] for episode 74396 [episode count 6/20], we have num_retrieval=np.int64(3987) num_query=np.int64(235)
2025-03-13 15:43:45,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:45,917 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:45
2025-03-13 15:43:45,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.22it/s]
2025-03-13 15:43:45,951 [INFO]: There are 3987 embeddings of dim 49152
2025-03-13 15:43:45,952 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 15:43:45,952 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,952 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:45,952 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:43:45,952 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:45,952 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:43:45,952 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,952 [INFO]: 822.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:45,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:43:45,952 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:45
2025-03-13 15:43:45,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:45,952 [INFO]: 	Creating the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,952 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:45
2025-03-13 15:43:45,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:43:45,953 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:45
2025-03-13 15:43:45,953 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:43:45,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.92it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.23it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.66it/s]100%|██████████| 16/16 [00:03<00:00,  3.29it/s]100%|██████████| 16/16 [00:03<00:00,  4.42it/s]
2025-03-13 15:43:49,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:49
2025-03-13 15:44:30,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7017 secs
2025-03-13 15:44:30,280 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 15:44:30,280 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.23it/s]
2025-03-13 15:45:07,439 [INFO]: 	>>> Finished "Compute fast metrics" in 37.1589 secs
2025-03-13 15:45:07,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.4893 secs
2025-03-13 15:45:07,443 [INFO]: {
2025-03-13 15:45:07,443 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:07,443 [INFO]: 	index_param: efSearch=141
2025-03-13 15:45:07,443 [INFO]: 	index_path: knn.index
2025-03-13 15:45:07,443 [INFO]: 	size in bytes: 784418470
2025-03-13 15:45:07,443 [INFO]: 	avg_search_speed_ms: 8.065516014035131
2025-03-13 15:45:07,443 [INFO]: 	99p_search_speed_ms: 11.453307366464285
2025-03-13 15:45:07,443 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:07,443 [INFO]: 	nb vectors: 3987
2025-03-13 15:45:07,443 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:07,443 [INFO]: 	compression ratio: 0.9993085654905601
2025-03-13 15:45:07,443 [INFO]: }
2025-03-13 15:45:07,443 [INFO]: 	>>> Finished "Creating the index" in 81.4908 secs
2025-03-13 15:45:07,443 [INFO]: >>> Finished "Launching the whole pipeline" in 81.5256 secs
2025-03-13 15:45:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 74396 [episode count 6/20]
[retrieval_preprocessing] for episode 90852 [episode count 7/20], we have num_retrieval=np.int64(3954) num_query=np.int64(268)
2025-03-13 15:45:09,462 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:10,229 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:10
2025-03-13 15:45:10,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 910.62it/s]
2025-03-13 15:45:10,260 [INFO]: There are 3954 embeddings of dim 49152
2025-03-13 15:45:10,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:45:10,260 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:10
2025-03-13 15:45:10,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:10,260 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:45:10,260 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:10,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:10,260 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:10
2025-03-13 15:45:10,260 [INFO]: 816.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:10,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:45:10,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:10
2025-03-13 15:45:10,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:10,260 [INFO]: 	Creating the index 03/13/2025, 15:45:10
2025-03-13 15:45:10,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:10
2025-03-13 15:45:10,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:45:10,262 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:10
2025-03-13 15:45:10,262 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:45:10,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.00it/s] 38%|███▊      | 6/16 [00:00<00:00, 31.16it/s] 69%|██████▉   | 11/16 [00:00<00:00, 38.26it/s]100%|██████████| 16/16 [00:03<00:00,  3.73it/s]100%|██████████| 16/16 [00:03<00:00,  5.01it/s]
2025-03-13 15:45:13,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:13
2025-03-13 15:46:05,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4919 secs
2025-03-13 15:46:05,949 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 15:46:05,949 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.16it/s]
2025-03-13 15:46:32,509 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5599 secs
2025-03-13 15:46:32,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.2503 secs
2025-03-13 15:46:32,512 [INFO]: {
2025-03-13 15:46:32,512 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:32,512 [INFO]: 	index_param: efSearch=115
2025-03-13 15:46:32,512 [INFO]: 	index_path: knn.index
2025-03-13 15:46:32,512 [INFO]: 	size in bytes: 777925990
2025-03-13 15:46:32,513 [INFO]: 	avg_search_speed_ms: 8.158575791484246
2025-03-13 15:46:32,513 [INFO]: 	99p_search_speed_ms: 12.197091476991773
2025-03-13 15:46:32,513 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:32,513 [INFO]: 	nb vectors: 3954
2025-03-13 15:46:32,513 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:32,513 [INFO]: 	compression ratio: 0.9993084714909705
2025-03-13 15:46:32,513 [INFO]: }
2025-03-13 15:46:32,513 [INFO]: 	>>> Finished "Creating the index" in 82.2522 secs
2025-03-13 15:46:32,513 [INFO]: >>> Finished "Launching the whole pipeline" in 82.2832 secs
2025-03-13 15:46:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 90852 [episode count 7/20]
[retrieval_preprocessing] for episode 25853 [episode count 8/20], we have num_retrieval=np.int64(4058) num_query=np.int64(164)
2025-03-13 15:46:34,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:35,004 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:35
2025-03-13 15:46:35,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1765.28it/s]
2025-03-13 15:46:35,035 [INFO]: There are 4058 embeddings of dim 49152
2025-03-13 15:46:35,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:46:35,035 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:35
2025-03-13 15:46:35,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:35,035 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:46:35,035 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:35,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:46:35,035 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:35
2025-03-13 15:46:35,035 [INFO]: 837.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:35,035 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:46:35,035 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:35
2025-03-13 15:46:35,035 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:35,035 [INFO]: 	Creating the index 03/13/2025, 15:46:35
2025-03-13 15:46:35,035 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:35
2025-03-13 15:46:35,036 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:46:35,036 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:35
2025-03-13 15:46:35,036 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:46:35,036 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.49it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.20it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.95it/s]100%|██████████| 16/16 [00:04<00:00,  3.89it/s]
2025-03-13 15:46:39,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:39
2025-03-13 15:47:31,082 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9240 secs
2025-03-13 15:47:31,083 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 15:47:31,083 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.12it/s]
2025-03-13 15:47:55,195 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1112 secs
2025-03-13 15:47:55,198 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.1615 secs
2025-03-13 15:47:55,198 [INFO]: {
2025-03-13 15:47:55,198 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:55,198 [INFO]: 	index_param: efSearch=160
2025-03-13 15:47:55,198 [INFO]: 	index_path: knn.index
2025-03-13 15:47:55,198 [INFO]: 	size in bytes: 798387250
2025-03-13 15:47:55,198 [INFO]: 	avg_search_speed_ms: 9.988840660089618
2025-03-13 15:47:55,198 [INFO]: 	99p_search_speed_ms: 14.269156148657203
2025-03-13 15:47:55,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:55,198 [INFO]: 	nb vectors: 4058
2025-03-13 15:47:55,198 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:55,198 [INFO]: 	compression ratio: 0.9993086237286479
2025-03-13 15:47:55,198 [INFO]: }
2025-03-13 15:47:55,198 [INFO]: 	>>> Finished "Creating the index" in 80.1629 secs
2025-03-13 15:47:55,198 [INFO]: >>> Finished "Launching the whole pipeline" in 80.1940 secs
2025-03-13 15:47:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 25853 [episode count 8/20]
[retrieval_preprocessing] for episode 17932 [episode count 9/20], we have num_retrieval=np.int64(4074) num_query=np.int64(148)
2025-03-13 15:47:57,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:58,204 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:58
2025-03-13 15:47:58,204 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 791.98it/s]
2025-03-13 15:47:58,239 [INFO]: There are 4074 embeddings of dim 49152
2025-03-13 15:47:58,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 15:47:58,239 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:58
2025-03-13 15:47:58,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:58,240 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:47:58,240 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:58,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:47:58,240 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:58
2025-03-13 15:47:58,240 [INFO]: 840.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:58,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:47:58,241 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:58
2025-03-13 15:47:58,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:47:58,241 [INFO]: 	Creating the index 03/13/2025, 15:47:58
2025-03-13 15:47:58,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:58
2025-03-13 15:47:58,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0037 secs
2025-03-13 15:47:58,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:58
2025-03-13 15:47:58,246 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:47:58,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.70it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.95it/s] 53%|█████▎    | 9/17 [00:00<00:00, 31.20it/s] 76%|███████▋  | 13/17 [00:00<00:00, 34.24it/s]100%|██████████| 17/17 [00:04<00:00,  2.63it/s]100%|██████████| 17/17 [00:04<00:00,  4.07it/s]
2025-03-13 15:48:02,434 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:02
2025-03-13 15:48:42,763 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3291 secs
2025-03-13 15:48:42,763 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 15:48:42,763 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 15:49:10,911 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1473 secs
2025-03-13 15:49:10,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6672 secs
2025-03-13 15:49:10,913 [INFO]: {
2025-03-13 15:49:10,914 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:10,914 [INFO]: 	index_param: efSearch=172
2025-03-13 15:49:10,914 [INFO]: 	index_path: knn.index
2025-03-13 15:49:10,914 [INFO]: 	size in bytes: 801535150
2025-03-13 15:49:10,914 [INFO]: 	avg_search_speed_ms: 9.594734632235989
2025-03-13 15:49:10,914 [INFO]: 	99p_search_speed_ms: 12.632907340303062
2025-03-13 15:49:10,914 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:10,914 [INFO]: 	nb vectors: 4074
2025-03-13 15:49:10,914 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:10,914 [INFO]: 	compression ratio: 0.9993086291973596
2025-03-13 15:49:10,914 [INFO]: }
2025-03-13 15:49:10,914 [INFO]: 	>>> Finished "Creating the index" in 72.6721 secs
2025-03-13 15:49:10,914 [INFO]: >>> Finished "Launching the whole pipeline" in 72.7099 secs
2025-03-13 15:49:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 17932 [episode count 9/20]
[retrieval_preprocessing] for episode 92572 [episode count 10/20], we have num_retrieval=np.int64(4049) num_query=np.int64(173)
2025-03-13 15:49:12,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:13,587 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:13
2025-03-13 15:49:13,587 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.78it/s]
2025-03-13 15:49:13,617 [INFO]: There are 4049 embeddings of dim 49152
2025-03-13 15:49:13,617 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 15:49:13,617 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,617 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:13,618 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:49:13,618 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:13,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:49:13,618 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,618 [INFO]: 835.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:13,618 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:49:13,618 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:13
2025-03-13 15:49:13,618 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:13,619 [INFO]: 	Creating the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,619 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:13
2025-03-13 15:49:13,621 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:49:13,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,622 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:49:13,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.80it/s] 31%|███▏      | 5/16 [00:00<00:00, 23.39it/s] 56%|█████▋    | 9/16 [00:00<00:00, 28.63it/s] 81%|████████▏ | 13/16 [00:00<00:00, 31.42it/s]100%|██████████| 16/16 [00:05<00:00,  3.03it/s]
2025-03-13 15:49:18,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:18
2025-03-13 15:49:59,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9971 secs
2025-03-13 15:49:59,909 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 15:49:59,910 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-13 15:50:28,478 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5679 secs
2025-03-13 15:50:28,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8593 secs
2025-03-13 15:50:28,481 [INFO]: {
2025-03-13 15:50:28,481 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:28,481 [INFO]: 	index_param: efSearch=164
2025-03-13 15:50:28,481 [INFO]: 	index_path: knn.index
2025-03-13 15:50:28,481 [INFO]: 	size in bytes: 796616590
2025-03-13 15:50:28,481 [INFO]: 	avg_search_speed_ms: 11.32659075147813
2025-03-13 15:50:28,481 [INFO]: 	99p_search_speed_ms: 19.842350580729534
2025-03-13 15:50:28,482 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:28,482 [INFO]: 	nb vectors: 4049
2025-03-13 15:50:28,482 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:28,482 [INFO]: 	compression ratio: 0.9993085782961161
2025-03-13 15:50:28,482 [INFO]: }
2025-03-13 15:50:28,482 [INFO]: 	>>> Finished "Creating the index" in 74.8630 secs
2025-03-13 15:50:28,482 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8943 secs
2025-03-13 15:50:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 92572 [episode count 10/20]
[retrieval_preprocessing] for episode 59795 [episode count 11/20], we have num_retrieval=np.int64(3994) num_query=np.int64(228)
2025-03-13 15:50:30,836 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:31,405 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:31
2025-03-13 15:50:31,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2063.11it/s]
2025-03-13 15:50:31,430 [INFO]: There are 3994 embeddings of dim 49152
2025-03-13 15:50:31,430 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 15:50:31,430 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:31
2025-03-13 15:50:31,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:31,430 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:50:31,430 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:31,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:50:31,430 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:31
2025-03-13 15:50:31,430 [INFO]: 824.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:31,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:50:31,430 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:31
2025-03-13 15:50:31,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:31,430 [INFO]: 	Creating the index 03/13/2025, 15:50:31
2025-03-13 15:50:31,430 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:31
2025-03-13 15:50:31,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:50:31,431 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:31
2025-03-13 15:50:31,431 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:50:31,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.18it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.67it/s] 75%|███████▌  | 12/16 [00:00<00:00, 36.78it/s]100%|██████████| 16/16 [00:03<00:00,  3.18it/s]100%|██████████| 16/16 [00:03<00:00,  4.55it/s]
2025-03-13 15:50:34,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:34
2025-03-13 15:51:23,362 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4048 secs
2025-03-13 15:51:23,362 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:51:23,362 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-13 15:51:51,744 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3812 secs
2025-03-13 15:51:51,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.3154 secs
2025-03-13 15:51:51,747 [INFO]: {
2025-03-13 15:51:51,747 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:51,747 [INFO]: 	index_param: efSearch=191
2025-03-13 15:51:51,747 [INFO]: 	index_path: knn.index
2025-03-13 15:51:51,747 [INFO]: 	size in bytes: 785795650
2025-03-13 15:51:51,747 [INFO]: 	avg_search_speed_ms: 10.99286029821487
2025-03-13 15:51:51,747 [INFO]: 	99p_search_speed_ms: 19.297822911757972
2025-03-13 15:51:51,747 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:51,747 [INFO]: 	nb vectors: 3994
2025-03-13 15:51:51,747 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:51,747 [INFO]: 	compression ratio: 0.9993086014156479
2025-03-13 15:51:51,747 [INFO]: }
2025-03-13 15:51:51,747 [INFO]: 	>>> Finished "Creating the index" in 80.3170 secs
2025-03-13 15:51:51,747 [INFO]: >>> Finished "Launching the whole pipeline" in 80.3418 secs
2025-03-13 15:51:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 59795 [episode count 11/20]
[retrieval_preprocessing] for episode 88236 [episode count 12/20], we have num_retrieval=np.int64(4019) num_query=np.int64(203)
2025-03-13 15:51:54,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:54,757 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:54
2025-03-13 15:51:54,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1693.30it/s]
2025-03-13 15:51:54,799 [INFO]: There are 4019 embeddings of dim 49152
2025-03-13 15:51:54,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 15:51:54,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:54
2025-03-13 15:51:54,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:54,800 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:51:54,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:54,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:51:54,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:54
2025-03-13 15:51:54,801 [INFO]: 829.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:54,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:51:54,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:54
2025-03-13 15:51:54,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:54,802 [INFO]: 	Creating the index 03/13/2025, 15:51:54
2025-03-13 15:51:54,803 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:54
2025-03-13 15:51:54,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:51:54,806 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:54
2025-03-13 15:51:54,806 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:51:54,807 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.74it/s] 31%|███▏      | 5/16 [00:00<00:00, 27.21it/s] 62%|██████▎   | 10/16 [00:00<00:00, 33.65it/s] 94%|█████████▍| 15/16 [00:00<00:00, 36.84it/s]100%|██████████| 16/16 [00:03<00:00,  4.66it/s]
2025-03-13 15:51:58,250 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:58
2025-03-13 15:52:53,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.2473 secs
2025-03-13 15:52:53,498 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:52:53,498 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.43s/it] 75%|███████▌  | 3/4 [00:01<00:00,  1.98it/s]
2025-03-13 15:53:17,612 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1140 secs
2025-03-13 15:53:17,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1441 secs
2025-03-13 15:53:17,951 [INFO]: {
2025-03-13 15:53:17,951 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:17,951 [INFO]: 	index_param: efSearch=168
2025-03-13 15:53:17,951 [INFO]: 	index_path: knn.index
2025-03-13 15:53:17,951 [INFO]: 	size in bytes: 790714330
2025-03-13 15:53:17,951 [INFO]: 	avg_search_speed_ms: 9.088927587675274
2025-03-13 15:53:17,951 [INFO]: 	99p_search_speed_ms: 12.598325032740831
2025-03-13 15:53:17,951 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:17,951 [INFO]: 	nb vectors: 4019
2025-03-13 15:53:17,951 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:17,952 [INFO]: 	compression ratio: 0.999308501213074
2025-03-13 15:53:17,952 [INFO]: }
2025-03-13 15:53:17,952 [INFO]: 	>>> Finished "Creating the index" in 83.1491 secs
2025-03-13 15:53:17,952 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1946 secs
2025-03-13 15:53:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 88236 [episode count 12/20]
[retrieval_preprocessing] for episode 35473 [episode count 13/20], we have num_retrieval=np.int64(3766) num_query=np.int64(456)
2025-03-13 15:53:25,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:26,162 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:26
2025-03-13 15:53:26,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-13 15:53:26,185 [INFO]: There are 3766 embeddings of dim 49152
2025-03-13 15:53:26,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 15:53:26,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:26
2025-03-13 15:53:26,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:26,186 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 15:53:26,186 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:26,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:26,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:26
2025-03-13 15:53:26,186 [INFO]: 777.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:26,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:53:26,186 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:26
2025-03-13 15:53:26,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:26,186 [INFO]: 	Creating the index 03/13/2025, 15:53:26
2025-03-13 15:53:26,186 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:26
2025-03-13 15:53:26,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:53:26,187 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:26
2025-03-13 15:53:26,187 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:53:26,187 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.02it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.75it/s] 80%|████████  | 12/15 [00:00<00:00, 36.35it/s]100%|██████████| 15/15 [00:04<00:00,  3.71it/s]
2025-03-13 15:53:30,232 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:30
2025-03-13 15:54:15,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7648 secs
2025-03-13 15:54:15,998 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 15:54:15,998 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 15:54:47,997 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9995 secs
2025-03-13 15:54:48,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.8135 secs
2025-03-13 15:54:48,001 [INFO]: {
2025-03-13 15:54:48,001 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:48,001 [INFO]: 	index_param: efSearch=219
2025-03-13 15:54:48,001 [INFO]: 	index_path: knn.index
2025-03-13 15:54:48,001 [INFO]: 	size in bytes: 740937610
2025-03-13 15:54:48,001 [INFO]: 	avg_search_speed_ms: 10.960349920720907
2025-03-13 15:54:48,001 [INFO]: 	99p_search_speed_ms: 15.533009227365255
2025-03-13 15:54:48,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:48,001 [INFO]: 	nb vectors: 3766
2025-03-13 15:54:48,001 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:48,001 [INFO]: 	compression ratio: 0.9993091429115064
2025-03-13 15:54:48,001 [INFO]: }
2025-03-13 15:54:48,001 [INFO]: 	>>> Finished "Creating the index" in 81.8152 secs
2025-03-13 15:54:48,001 [INFO]: >>> Finished "Launching the whole pipeline" in 81.8393 secs
2025-03-13 15:54:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 35473 [episode count 13/20]
[retrieval_preprocessing] for episode 75385 [episode count 14/20], we have num_retrieval=np.int64(4032) num_query=np.int64(190)
2025-03-13 15:54:52,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:52,984 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:52
2025-03-13 15:54:52,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1035.89it/s]
2025-03-13 15:54:53,022 [INFO]: There are 4032 embeddings of dim 49152
2025-03-13 15:54:53,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 15:54:53,022 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:53
2025-03-13 15:54:53,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:53,022 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:54:53,022 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:53,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:53,022 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:53
2025-03-13 15:54:53,022 [INFO]: 832.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:53,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:53,023 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:53
2025-03-13 15:54:53,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:53,023 [INFO]: 	Creating the index 03/13/2025, 15:54:53
2025-03-13 15:54:53,023 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:53
2025-03-13 15:54:53,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:54:53,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:53
2025-03-13 15:54:53,024 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:54:53,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.47it/s] 31%|███▏      | 5/16 [00:00<00:00, 19.83it/s] 62%|██████▎   | 10/16 [00:00<00:00, 28.52it/s] 94%|█████████▍| 15/16 [00:00<00:00, 32.87it/s]100%|██████████| 16/16 [00:04<00:00,  3.96it/s]
2025-03-13 15:54:57,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:57
2025-03-13 15:55:41,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8777 secs
2025-03-13 15:55:41,943 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 15:55:41,943 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.93it/s]
2025-03-13 15:56:05,659 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7161 secs
2025-03-13 15:56:05,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6388 secs
2025-03-13 15:56:05,663 [INFO]: {
2025-03-13 15:56:05,663 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:05,663 [INFO]: 	index_param: efSearch=186
2025-03-13 15:56:05,663 [INFO]: 	index_path: knn.index
2025-03-13 15:56:05,663 [INFO]: 	size in bytes: 793271950
2025-03-13 15:56:05,663 [INFO]: 	avg_search_speed_ms: 13.78190283985557
2025-03-13 15:56:05,663 [INFO]: 	99p_search_speed_ms: 21.220603899564594
2025-03-13 15:56:05,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:05,663 [INFO]: 	nb vectors: 4032
2025-03-13 15:56:05,663 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:05,663 [INFO]: 	compression ratio: 0.9993085675095407
2025-03-13 15:56:05,663 [INFO]: }
2025-03-13 15:56:05,663 [INFO]: 	>>> Finished "Creating the index" in 72.6405 secs
2025-03-13 15:56:05,663 [INFO]: >>> Finished "Launching the whole pipeline" in 72.6788 secs
2025-03-13 15:56:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 75385 [episode count 14/20]
[retrieval_preprocessing] for episode 26590 [episode count 15/20], we have num_retrieval=np.int64(4029) num_query=np.int64(193)
2025-03-13 15:56:07,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:08,637 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:08
2025-03-13 15:56:08,637 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-13 15:56:08,663 [INFO]: There are 4029 embeddings of dim 49152
2025-03-13 15:56:08,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 15:56:08,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:08
2025-03-13 15:56:08,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:08,664 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:56:08,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:08,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:08,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:08
2025-03-13 15:56:08,664 [INFO]: 831.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:08,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:56:08,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:08
2025-03-13 15:56:08,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:08,664 [INFO]: 	Creating the index 03/13/2025, 15:56:08
2025-03-13 15:56:08,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:08
2025-03-13 15:56:08,666 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:56:08,666 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:08
2025-03-13 15:56:08,666 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:56:08,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.04it/s] 31%|███▏      | 5/16 [00:00<00:00, 19.74it/s] 56%|█████▋    | 9/16 [00:00<00:00, 24.42it/s] 75%|███████▌  | 12/16 [00:00<00:00, 24.41it/s]100%|██████████| 16/16 [00:04<00:00,  2.15it/s]100%|██████████| 16/16 [00:04<00:00,  3.33it/s]
2025-03-13 15:56:13,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:13
2025-03-13 15:56:59,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2577 secs
2025-03-13 15:56:59,738 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 15:56:59,738 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.92it/s]
2025-03-13 15:57:25,209 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4712 secs
2025-03-13 15:57:25,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.5465 secs
2025-03-13 15:57:25,212 [INFO]: {
2025-03-13 15:57:25,212 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:25,213 [INFO]: 	index_param: efSearch=166
2025-03-13 15:57:25,213 [INFO]: 	index_path: knn.index
2025-03-13 15:57:25,213 [INFO]: 	size in bytes: 792681730
2025-03-13 15:57:25,213 [INFO]: 	avg_search_speed_ms: 10.157269191914025
2025-03-13 15:57:25,213 [INFO]: 	99p_search_speed_ms: 14.061923921108246
2025-03-13 15:57:25,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:25,213 [INFO]: 	nb vectors: 4029
2025-03-13 15:57:25,213 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:25,213 [INFO]: 	compression ratio: 0.9993085522483279
2025-03-13 15:57:25,213 [INFO]: }
2025-03-13 15:57:25,213 [INFO]: 	>>> Finished "Creating the index" in 76.5483 secs
2025-03-13 15:57:25,213 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5758 secs
2025-03-13 15:57:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 26590 [episode count 15/20]
[retrieval_preprocessing] for episode 89098 [episode count 16/20], we have num_retrieval=np.int64(4019) num_query=np.int64(203)
2025-03-13 15:57:27,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:27,839 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:27
2025-03-13 15:57:27,839 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1190.55it/s]
2025-03-13 15:57:27,874 [INFO]: There are 4019 embeddings of dim 49152
2025-03-13 15:57:27,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 15:57:27,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:27
2025-03-13 15:57:27,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:27,874 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:57:27,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:27,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:27,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:27
2025-03-13 15:57:27,874 [INFO]: 829.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:27,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:57:27,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:27
2025-03-13 15:57:27,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:27,874 [INFO]: 	Creating the index 03/13/2025, 15:57:27
2025-03-13 15:57:27,874 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:27
2025-03-13 15:57:27,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:57:27,875 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:27
2025-03-13 15:57:27,876 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:57:27,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.97it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.59it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.91it/s]100%|██████████| 16/16 [00:04<00:00,  2.64it/s]100%|██████████| 16/16 [00:04<00:00,  3.59it/s]
2025-03-13 15:57:32,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:32
2025-03-13 15:58:20,272 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9312 secs
2025-03-13 15:58:20,272 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:58:20,272 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.05it/s]
2025-03-13 15:58:54,586 [INFO]: 	>>> Finished "Compute fast metrics" in 34.3135 secs
2025-03-13 15:58:54,588 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7128 secs
2025-03-13 15:58:54,589 [INFO]: {
2025-03-13 15:58:54,589 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:54,589 [INFO]: 	index_param: efSearch=196
2025-03-13 15:58:54,589 [INFO]: 	index_path: knn.index
2025-03-13 15:58:54,589 [INFO]: 	size in bytes: 790714330
2025-03-13 15:58:54,589 [INFO]: 	avg_search_speed_ms: 10.9314349589391
2025-03-13 15:58:54,589 [INFO]: 	99p_search_speed_ms: 18.461105739697814
2025-03-13 15:58:54,589 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:54,589 [INFO]: 	nb vectors: 4019
2025-03-13 15:58:54,589 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:54,589 [INFO]: 	compression ratio: 0.999308501213074
2025-03-13 15:58:54,589 [INFO]: }
2025-03-13 15:58:54,589 [INFO]: 	>>> Finished "Creating the index" in 86.7147 secs
2025-03-13 15:58:54,589 [INFO]: >>> Finished "Launching the whole pipeline" in 86.7496 secs
2025-03-13 15:58:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 89098 [episode count 16/20]
[retrieval_preprocessing] for episode 21919 [episode count 17/20], we have num_retrieval=np.int64(3984) num_query=np.int64(238)
2025-03-13 15:58:59,324 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:00,030 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:00
2025-03-13 15:59:00,030 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.65it/s]
2025-03-13 15:59:00,056 [INFO]: There are 3984 embeddings of dim 49152
2025-03-13 15:59:00,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:59:00,057 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:00
2025-03-13 15:59:00,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:00,057 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 15:59:00,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:00,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:00,057 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:00
2025-03-13 15:59:00,057 [INFO]: 822.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:00,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:59:00,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:00
2025-03-13 15:59:00,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:00,057 [INFO]: 	Creating the index 03/13/2025, 15:59:00
2025-03-13 15:59:00,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:00
2025-03-13 15:59:00,058 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:59:00,058 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:00
2025-03-13 15:59:00,058 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:59:00,058 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.44it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.63it/s] 69%|██████▉   | 11/16 [00:00<00:00, 33.34it/s]100%|██████████| 16/16 [00:04<00:00,  2.96it/s]100%|██████████| 16/16 [00:04<00:00,  3.99it/s]
2025-03-13 15:59:04,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:04
2025-03-13 15:59:50,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2926 secs
2025-03-13 15:59:50,361 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 15:59:50,361 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.38it/s]
2025-03-13 16:00:13,651 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2898 secs
2025-03-13 16:00:13,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.5952 secs
2025-03-13 16:00:13,654 [INFO]: {
2025-03-13 16:00:13,654 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:13,654 [INFO]: 	index_param: efSearch=129
2025-03-13 16:00:13,654 [INFO]: 	index_path: knn.index
2025-03-13 16:00:13,654 [INFO]: 	size in bytes: 783828250
2025-03-13 16:00:13,654 [INFO]: 	avg_search_speed_ms: 7.923396627297669
2025-03-13 16:00:13,654 [INFO]: 	99p_search_speed_ms: 10.96060792449862
2025-03-13 16:00:13,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:13,654 [INFO]: 	nb vectors: 3984
2025-03-13 16:00:13,654 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:13,654 [INFO]: 	compression ratio: 0.999308550055449
2025-03-13 16:00:13,654 [INFO]: }
2025-03-13 16:00:13,654 [INFO]: 	>>> Finished "Creating the index" in 73.5972 secs
2025-03-13 16:00:13,654 [INFO]: >>> Finished "Launching the whole pipeline" in 73.6241 secs
2025-03-13 16:00:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 21919 [episode count 17/20]
[retrieval_preprocessing] for episode 13683 [episode count 18/20], we have num_retrieval=np.int64(4033) num_query=np.int64(189)
2025-03-13 16:00:15,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:16,282 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:16
2025-03-13 16:00:16,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.82it/s]
2025-03-13 16:00:16,320 [INFO]: There are 4033 embeddings of dim 49152
2025-03-13 16:00:16,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 16:00:16,321 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:16
2025-03-13 16:00:16,321 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:16,321 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:00:16,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:16,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:00:16,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:16
2025-03-13 16:00:16,322 [INFO]: 832.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:16,323 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:00:16,323 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:16
2025-03-13 16:00:16,323 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:16,323 [INFO]: 	Creating the index 03/13/2025, 16:00:16
2025-03-13 16:00:16,323 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:16
2025-03-13 16:00:16,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:00:16,327 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:16
2025-03-13 16:00:16,327 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:00:16,328 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 15.92it/s] 31%|███▏      | 5/16 [00:00<00:00, 22.64it/s] 56%|█████▋    | 9/16 [00:00<00:00, 29.90it/s] 81%|████████▏ | 13/16 [00:00<00:00, 33.28it/s]100%|██████████| 16/16 [00:04<00:00,  3.54it/s]
2025-03-13 16:00:20,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:20
2025-03-13 16:01:13,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2816 secs
2025-03-13 16:01:13,144 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 16:01:13,144 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 16:01:43,862 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7182 secs
2025-03-13 16:01:43,864 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5371 secs
2025-03-13 16:01:43,864 [INFO]: {
2025-03-13 16:01:43,865 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:43,865 [INFO]: 	index_param: efSearch=170
2025-03-13 16:01:43,865 [INFO]: 	index_path: knn.index
2025-03-13 16:01:43,865 [INFO]: 	size in bytes: 793468690
2025-03-13 16:01:43,865 [INFO]: 	avg_search_speed_ms: 9.550945610057033
2025-03-13 16:01:43,865 [INFO]: 	99p_search_speed_ms: 14.864665707573293
2025-03-13 16:01:43,865 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:43,865 [INFO]: 	nb vectors: 4033
2025-03-13 16:01:43,865 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:43,865 [INFO]: 	compression ratio: 0.9993085725915662
2025-03-13 16:01:43,865 [INFO]: }
2025-03-13 16:01:43,865 [INFO]: 	>>> Finished "Creating the index" in 87.5415 secs
2025-03-13 16:01:43,865 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5828 secs
2025-03-13 16:01:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 13683 [episode count 18/20]
[retrieval_preprocessing] for episode 29953 [episode count 19/20], we have num_retrieval=np.int64(4076) num_query=np.int64(146)
2025-03-13 16:01:45,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:46,669 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:46
2025-03-13 16:01:46,669 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.14it/s]
2025-03-13 16:01:46,699 [INFO]: There are 4076 embeddings of dim 49152
2025-03-13 16:01:46,700 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 16:01:46,700 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:46
2025-03-13 16:01:46,700 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:46,700 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:01:46,701 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:46,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:01:46,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:46
2025-03-13 16:01:46,701 [INFO]: 841.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:46,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:01:46,702 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:46
2025-03-13 16:01:46,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:46,702 [INFO]: 	Creating the index 03/13/2025, 16:01:46
2025-03-13 16:01:46,702 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:46
2025-03-13 16:01:46,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 16:01:46,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:46
2025-03-13 16:01:46,707 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:01:46,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.91it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.54it/s] 53%|█████▎    | 9/17 [00:00<00:00, 29.73it/s] 76%|███████▋  | 13/17 [00:00<00:00, 32.04it/s]100%|██████████| 17/17 [00:04<00:00,  2.69it/s]100%|██████████| 17/17 [00:04<00:00,  4.13it/s]
2025-03-13 16:01:50,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:50
2025-03-13 16:02:41,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2948 secs
2025-03-13 16:02:41,124 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:02:41,124 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.34it/s]
2025-03-13 16:03:12,554 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4301 secs
2025-03-13 16:03:12,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.8503 secs
2025-03-13 16:03:12,557 [INFO]: {
2025-03-13 16:03:12,557 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:12,557 [INFO]: 	index_param: efSearch=179
2025-03-13 16:03:12,557 [INFO]: 	index_path: knn.index
2025-03-13 16:03:12,557 [INFO]: 	size in bytes: 801928630
2025-03-13 16:03:12,557 [INFO]: 	avg_search_speed_ms: 8.837251525368975
2025-03-13 16:03:12,557 [INFO]: 	99p_search_speed_ms: 11.835385055746883
2025-03-13 16:03:12,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:12,557 [INFO]: 	nb vectors: 4076
2025-03-13 16:03:12,557 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:12,557 [INFO]: 	compression ratio: 0.999308639223917
2025-03-13 16:03:12,557 [INFO]: }
2025-03-13 16:03:12,557 [INFO]: 	>>> Finished "Creating the index" in 85.8550 secs
2025-03-13 16:03:12,557 [INFO]: >>> Finished "Launching the whole pipeline" in 85.8883 secs
2025-03-13 16:03:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 29953 [episode count 19/20]
2025-03-13 16:03:13: [retrieval_preprocessing] finished for -1_put_marker_in_pot [chosen_id count 3/196]
2025-03-13 16:03:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_mug [chosen_id count 4/196]
2025-03-13 16:03:14: [retrieval_preprocessing] we have num_total=2455 embedding_dim=49152
[retrieval_preprocessing] for episode 16469 [episode count 0/20], we have num_retrieval=np.int64(2339) num_query=np.int64(116)
2025-03-13 16:03:14,989 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:15,350 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:15
2025-03-13 16:03:15,350 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1545.43it/s]
2025-03-13 16:03:15,380 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 16:03:15,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 16:03:15,380 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:15
2025-03-13 16:03:15,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:15,380 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:03:15,380 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:15,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:15,380 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:15
2025-03-13 16:03:15,380 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:15,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:03:15,380 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:15
2025-03-13 16:03:15,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:15,380 [INFO]: 	Creating the index 03/13/2025, 16:03:15
2025-03-13 16:03:15,381 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:15
2025-03-13 16:03:15,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:03:15,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:15
2025-03-13 16:03:15,382 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:03:15,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.72it/s] 70%|███████   | 7/10 [00:00<00:00, 34.05it/s]100%|██████████| 10/10 [00:01<00:00,  5.37it/s]
2025-03-13 16:03:17,247 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:17
2025-03-13 16:03:42,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4544 secs
2025-03-13 16:03:42,702 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 16:03:42,703 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.91it/s]
2025-03-13 16:04:19,104 [INFO]: 	>>> Finished "Compute fast metrics" in 36.4009 secs
2025-03-13 16:04:19,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7250 secs
2025-03-13 16:04:19,107 [INFO]: {
2025-03-13 16:04:19,107 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:19,107 [INFO]: 	index_param: efSearch=181
2025-03-13 16:04:19,107 [INFO]: 	index_path: knn.index
2025-03-13 16:04:19,107 [INFO]: 	size in bytes: 460183870
2025-03-13 16:04:19,107 [INFO]: 	avg_search_speed_ms: 9.442048253292768
2025-03-13 16:04:19,107 [INFO]: 	99p_search_speed_ms: 12.688161898404369
2025-03-13 16:04:19,107 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:19,107 [INFO]: 	nb vectors: 2339
2025-03-13 16:04:19,107 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:19,107 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 16:04:19,107 [INFO]: }
2025-03-13 16:04:19,107 [INFO]: 	>>> Finished "Creating the index" in 63.7266 secs
2025-03-13 16:04:19,107 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7571 secs
2025-03-13 16:04:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 16469 [episode count 0/20]
[retrieval_preprocessing] for episode 16480 [episode count 1/20], we have num_retrieval=np.int64(2367) num_query=np.int64(88)
2025-03-13 16:04:20,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:21,287 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:21
2025-03-13 16:04:21,287 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.28it/s]
2025-03-13 16:04:21,330 [INFO]: There are 2367 embeddings of dim 49152
2025-03-13 16:04:21,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0431 secs
2025-03-13 16:04:21,330 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:21
2025-03-13 16:04:21,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:21,330 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:04:21,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:21,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:04:21,331 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:21
2025-03-13 16:04:21,331 [INFO]: 488.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:21,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:04:21,331 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:21
2025-03-13 16:04:21,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:21,332 [INFO]: 	Creating the index 03/13/2025, 16:04:21
2025-03-13 16:04:21,332 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:21
2025-03-13 16:04:21,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 16:04:21,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:21
2025-03-13 16:04:21,334 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:04:21,335 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.58it/s] 50%|█████     | 5/10 [00:00<00:00, 14.81it/s] 90%|█████████ | 9/10 [00:00<00:00, 21.54it/s]100%|██████████| 10/10 [00:03<00:00,  3.12it/s]
2025-03-13 16:04:24,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:24
2025-03-13 16:05:03,369 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8235 secs
2025-03-13 16:05:03,370 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 16:05:03,370 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 16:05:20,510 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1406 secs
2025-03-13 16:05:20,513 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1784 secs
2025-03-13 16:05:20,513 [INFO]: {
2025-03-13 16:05:20,513 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:20,513 [INFO]: 	index_param: efSearch=131
2025-03-13 16:05:20,513 [INFO]: 	index_path: knn.index
2025-03-13 16:05:20,513 [INFO]: 	size in bytes: 465692650
2025-03-13 16:05:20,513 [INFO]: 	avg_search_speed_ms: 8.360326647163559
2025-03-13 16:05:20,513 [INFO]: 	99p_search_speed_ms: 11.272607475984836
2025-03-13 16:05:20,513 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:20,513 [INFO]: 	nb vectors: 2367
2025-03-13 16:05:20,513 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:20,513 [INFO]: 	compression ratio: 0.999309600441407
2025-03-13 16:05:20,513 [INFO]: }
2025-03-13 16:05:20,513 [INFO]: 	>>> Finished "Creating the index" in 59.1816 secs
2025-03-13 16:05:20,513 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2263 secs
2025-03-13 16:05:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 16480 [episode count 1/20]
[retrieval_preprocessing] for episode 90768 [episode count 2/20], we have num_retrieval=np.int64(2309) num_query=np.int64(146)
2025-03-13 16:05:21,464 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:22,470 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:22
2025-03-13 16:05:22,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1990.65it/s]
2025-03-13 16:05:22,494 [INFO]: There are 2309 embeddings of dim 49152
2025-03-13 16:05:22,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 16:05:22,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:22
2025-03-13 16:05:22,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:22,495 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:05:22,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:22,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:05:22,495 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:22
2025-03-13 16:05:22,495 [INFO]: 476.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:22,495 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:05:22,495 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:22
2025-03-13 16:05:22,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:22,495 [INFO]: 	Creating the index 03/13/2025, 16:05:22
2025-03-13 16:05:22,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:22
2025-03-13 16:05:22,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:05:22,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:22
2025-03-13 16:05:22,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:05:22,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.82it/s] 60%|██████    | 6/10 [00:00<00:00, 27.93it/s]100%|██████████| 10/10 [00:02<00:00,  3.87it/s]100%|██████████| 10/10 [00:02<00:00,  4.61it/s]
2025-03-13 16:05:24,668 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:24
2025-03-13 16:05:56,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8568 secs
2025-03-13 16:05:56,525 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:05:56,525 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.05it/s]
2025-03-13 16:06:17,558 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0331 secs
2025-03-13 16:06:18,114 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6176 secs
2025-03-13 16:06:18,115 [INFO]: {
2025-03-13 16:06:18,115 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:18,115 [INFO]: 	index_param: efSearch=157
2025-03-13 16:06:18,115 [INFO]: 	index_path: knn.index
2025-03-13 16:06:18,115 [INFO]: 	size in bytes: 454281610
2025-03-13 16:06:18,115 [INFO]: 	avg_search_speed_ms: 9.282003966019166
2025-03-13 16:06:18,116 [INFO]: 	99p_search_speed_ms: 17.452607229351997
2025-03-13 16:06:18,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:18,116 [INFO]: 	nb vectors: 2309
2025-03-13 16:06:18,116 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:18,116 [INFO]: 	compression ratio: 0.9993093755214965
2025-03-13 16:06:18,116 [INFO]: }
2025-03-13 16:06:18,116 [INFO]: 	>>> Finished "Creating the index" in 55.6207 secs
2025-03-13 16:06:18,116 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6458 secs
2025-03-13 16:06:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 90768 [episode count 2/20]
[retrieval_preprocessing] for episode 837 [episode count 3/20], we have num_retrieval=np.int64(2347) num_query=np.int64(108)
2025-03-13 16:06:19,314 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:19,619 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:19
2025-03-13 16:06:19,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.68it/s]
2025-03-13 16:06:19,651 [INFO]: There are 2347 embeddings of dim 49152
2025-03-13 16:06:19,651 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 16:06:19,651 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:19
2025-03-13 16:06:19,651 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:19,651 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:06:19,651 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:19,651 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:19,652 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:19
2025-03-13 16:06:19,652 [INFO]: 484.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:19,652 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:06:19,652 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:19
2025-03-13 16:06:19,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:19,652 [INFO]: 	Creating the index 03/13/2025, 16:06:19
2025-03-13 16:06:19,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:19
2025-03-13 16:06:19,653 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:06:19,653 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:19
2025-03-13 16:06:19,653 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:06:19,653 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.60it/s] 80%|████████  | 8/10 [00:00<00:00, 37.84it/s]100%|██████████| 10/10 [00:01<00:00,  5.11it/s]
2025-03-13 16:06:21,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:21
2025-03-13 16:06:49,289 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6771 secs
2025-03-13 16:06:49,289 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 16:06:49,289 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 16:07:09,717 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4274 secs
2025-03-13 16:07:09,719 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0658 secs
2025-03-13 16:07:09,719 [INFO]: {
2025-03-13 16:07:09,719 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:09,719 [INFO]: 	index_param: efSearch=130
2025-03-13 16:07:09,719 [INFO]: 	index_path: knn.index
2025-03-13 16:07:09,719 [INFO]: 	size in bytes: 461757790
2025-03-13 16:07:09,719 [INFO]: 	avg_search_speed_ms: 8.422494342624388
2025-03-13 16:07:09,719 [INFO]: 	99p_search_speed_ms: 14.198431661352515
2025-03-13 16:07:09,719 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:09,719 [INFO]: 	nb vectors: 2347
2025-03-13 16:07:09,719 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:09,719 [INFO]: 	compression ratio: 0.9993095644363682
2025-03-13 16:07:09,719 [INFO]: }
2025-03-13 16:07:09,719 [INFO]: 	>>> Finished "Creating the index" in 50.0673 secs
2025-03-13 16:07:09,719 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0995 secs
2025-03-13 16:07:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 837 [episode count 3/20]
[retrieval_preprocessing] for episode 25942 [episode count 4/20], we have num_retrieval=np.int64(2310) num_query=np.int64(145)
2025-03-13 16:07:10,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:11,049 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:11
2025-03-13 16:07:11,049 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.72it/s]
2025-03-13 16:07:11,080 [INFO]: There are 2310 embeddings of dim 49152
2025-03-13 16:07:11,080 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 16:07:11,080 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:11
2025-03-13 16:07:11,080 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:11,080 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:07:11,080 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:11,080 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:11,080 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:11
2025-03-13 16:07:11,080 [INFO]: 476.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:11,080 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:07:11,080 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:11
2025-03-13 16:07:11,080 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:11,080 [INFO]: 	Creating the index 03/13/2025, 16:07:11
2025-03-13 16:07:11,080 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:11
2025-03-13 16:07:11,082 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:07:11,082 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:11
2025-03-13 16:07:11,082 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:07:11,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.30it/s] 60%|██████    | 6/10 [00:00<00:00, 31.44it/s]100%|██████████| 10/10 [00:01<00:00,  4.85it/s]100%|██████████| 10/10 [00:01<00:00,  5.76it/s]
2025-03-13 16:07:12,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:12
2025-03-13 16:07:44,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2220 secs
2025-03-13 16:07:44,044 [INFO]: The best hyperparameters are: efSearch=77
2025-03-13 16:07:44,044 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.94it/s]
2025-03-13 16:08:02,534 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4907 secs
2025-03-13 16:08:02,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4552 secs
2025-03-13 16:08:02,537 [INFO]: {
2025-03-13 16:08:02,537 [INFO]: 	index_key: HNSW15
2025-03-13 16:08:02,537 [INFO]: 	index_param: efSearch=77
2025-03-13 16:08:02,537 [INFO]: 	index_path: knn.index
2025-03-13 16:08:02,537 [INFO]: 	size in bytes: 454478350
2025-03-13 16:08:02,537 [INFO]: 	avg_search_speed_ms: 5.886501269672808
2025-03-13 16:08:02,537 [INFO]: 	99p_search_speed_ms: 10.126050650142131
2025-03-13 16:08:02,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:02,537 [INFO]: 	nb vectors: 2310
2025-03-13 16:08:02,537 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:02,537 [INFO]: 	compression ratio: 0.9993093840443664
2025-03-13 16:08:02,537 [INFO]: }
2025-03-13 16:08:02,537 [INFO]: 	>>> Finished "Creating the index" in 51.4569 secs
2025-03-13 16:08:02,537 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4882 secs
2025-03-13 16:08:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 25942 [episode count 4/20]
[retrieval_preprocessing] for episode 2000 [episode count 5/20], we have num_retrieval=np.int64(2322) num_query=np.int64(133)
2025-03-13 16:08:05,399 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:05,763 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:05
2025-03-13 16:08:05,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.60it/s]
2025-03-13 16:08:05,795 [INFO]: There are 2322 embeddings of dim 49152
2025-03-13 16:08:05,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 16:08:05,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:05
2025-03-13 16:08:05,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:05,796 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:08:05,796 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:05,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:08:05,796 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:05
2025-03-13 16:08:05,796 [INFO]: 479.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:05,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:08:05,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:05
2025-03-13 16:08:05,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:05,796 [INFO]: 	Creating the index 03/13/2025, 16:08:05
2025-03-13 16:08:05,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:05
2025-03-13 16:08:05,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:08:05,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:05
2025-03-13 16:08:05,797 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:08:05,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.30it/s] 50%|█████     | 5/10 [00:00<00:00, 25.37it/s]100%|██████████| 10/10 [00:02<00:00,  4.04it/s]100%|██████████| 10/10 [00:02<00:00,  4.66it/s]
2025-03-13 16:08:07,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:07
2025-03-13 16:08:38,811 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8650 secs
2025-03-13 16:08:38,812 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:08:38,812 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.28it/s]
2025-03-13 16:09:03,194 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3824 secs
2025-03-13 16:09:03,196 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3988 secs
2025-03-13 16:09:03,196 [INFO]: {
2025-03-13 16:09:03,196 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:03,196 [INFO]: 	index_param: efSearch=169
2025-03-13 16:09:03,196 [INFO]: 	index_path: knn.index
2025-03-13 16:09:03,196 [INFO]: 	size in bytes: 456839290
2025-03-13 16:09:03,196 [INFO]: 	avg_search_speed_ms: 8.731637786317405
2025-03-13 16:09:03,196 [INFO]: 	99p_search_speed_ms: 13.684593401849252
2025-03-13 16:09:03,196 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:03,196 [INFO]: 	nb vectors: 2322
2025-03-13 16:09:03,196 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:03,196 [INFO]: 	compression ratio: 0.9993093544996973
2025-03-13 16:09:03,196 [INFO]: }
2025-03-13 16:09:03,196 [INFO]: 	>>> Finished "Creating the index" in 57.4005 secs
2025-03-13 16:09:03,196 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4337 secs
2025-03-13 16:09:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 2000 [episode count 5/20]
[retrieval_preprocessing] for episode 17374 [episode count 6/20], we have num_retrieval=np.int64(2348) num_query=np.int64(107)
2025-03-13 16:09:05,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:06,298 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:06
2025-03-13 16:09:06,298 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1849.34it/s]
2025-03-13 16:09:06,335 [INFO]: There are 2348 embeddings of dim 49152
2025-03-13 16:09:06,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 16:09:06,336 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:06
2025-03-13 16:09:06,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:06,336 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:09:06,336 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:06,337 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:09:06,337 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:06
2025-03-13 16:09:06,337 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:06,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:09:06,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:06
2025-03-13 16:09:06,338 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:06,338 [INFO]: 	Creating the index 03/13/2025, 16:09:06
2025-03-13 16:09:06,338 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:06
2025-03-13 16:09:06,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:09:06,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:06
2025-03-13 16:09:06,342 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:09:06,342 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.37it/s] 70%|███████   | 7/10 [00:00<00:00, 35.88it/s]100%|██████████| 10/10 [00:01<00:00,  5.49it/s]
2025-03-13 16:09:08,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:08
2025-03-13 16:09:34,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7419 secs
2025-03-13 16:09:34,365 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 16:09:34,365 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-13 16:10:10,462 [INFO]: 	>>> Finished "Compute fast metrics" in 36.0969 secs
2025-03-13 16:10:10,466 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1240 secs
2025-03-13 16:10:10,466 [INFO]: {
2025-03-13 16:10:10,466 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:10,466 [INFO]: 	index_param: efSearch=241
2025-03-13 16:10:10,466 [INFO]: 	index_path: knn.index
2025-03-13 16:10:10,466 [INFO]: 	size in bytes: 461954530
2025-03-13 16:10:10,466 [INFO]: 	avg_search_speed_ms: 15.810581648760545
2025-03-13 16:10:10,466 [INFO]: 	99p_search_speed_ms: 21.50726043619214
2025-03-13 16:10:10,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:10,466 [INFO]: 	nb vectors: 2348
2025-03-13 16:10:10,466 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:10,466 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-13 16:10:10,466 [INFO]: }
2025-03-13 16:10:10,466 [INFO]: 	>>> Finished "Creating the index" in 64.1285 secs
2025-03-13 16:10:10,466 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1681 secs
2025-03-13 16:10:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 17374 [episode count 6/20]
[retrieval_preprocessing] for episode 74789 [episode count 7/20], we have num_retrieval=np.int64(2363) num_query=np.int64(92)
2025-03-13 16:10:13,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:14,316 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:14
2025-03-13 16:10:14,316 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.83it/s]
2025-03-13 16:10:14,354 [INFO]: There are 2363 embeddings of dim 49152
2025-03-13 16:10:14,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0373 secs
2025-03-13 16:10:14,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:14,354 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:10:14,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:14,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:14,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,354 [INFO]: 487.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:14,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:10:14,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:14
2025-03-13 16:10:14,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:14,354 [INFO]: 	Creating the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:14
2025-03-13 16:10:14,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:10:14,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,356 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:10:14,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.40it/s] 70%|███████   | 7/10 [00:00<00:00, 30.84it/s]100%|██████████| 10/10 [00:02<00:00,  4.50it/s]
2025-03-13 16:10:16,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:16
2025-03-13 16:10:56,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8027 secs
2025-03-13 16:10:56,387 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 16:10:56,387 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 16:11:16,644 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2568 secs
2025-03-13 16:11:16,646 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2903 secs
2025-03-13 16:11:16,647 [INFO]: {
2025-03-13 16:11:16,647 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:16,647 [INFO]: 	index_param: efSearch=141
2025-03-13 16:11:16,647 [INFO]: 	index_path: knn.index
2025-03-13 16:11:16,647 [INFO]: 	size in bytes: 464905690
2025-03-13 16:11:16,647 [INFO]: 	avg_search_speed_ms: 7.945348673562307
2025-03-13 16:11:16,647 [INFO]: 	99p_search_speed_ms: 11.681583225727085
2025-03-13 16:11:16,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:16,647 [INFO]: 	nb vectors: 2363
2025-03-13 16:11:16,647 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:16,647 [INFO]: 	compression ratio: 0.9993095674952913
2025-03-13 16:11:16,647 [INFO]: }
2025-03-13 16:11:16,647 [INFO]: 	>>> Finished "Creating the index" in 62.2923 secs
2025-03-13 16:11:16,647 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3303 secs
2025-03-13 16:11:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 74789 [episode count 7/20]
[retrieval_preprocessing] for episode 85864 [episode count 8/20], we have num_retrieval=np.int64(2340) num_query=np.int64(115)
2025-03-13 16:11:17,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:18,116 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:18
2025-03-13 16:11:18,116 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1255.40it/s]
2025-03-13 16:11:18,145 [INFO]: There are 2340 embeddings of dim 49152
2025-03-13 16:11:18,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 16:11:18,146 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:18
2025-03-13 16:11:18,146 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:18,146 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:11:18,146 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:18,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:11:18,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:18
2025-03-13 16:11:18,147 [INFO]: 482.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:18,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:11:18,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:18
2025-03-13 16:11:18,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:11:18,148 [INFO]: 	Creating the index 03/13/2025, 16:11:18
2025-03-13 16:11:18,148 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:18
2025-03-13 16:11:18,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:11:18,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:18
2025-03-13 16:11:18,152 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:11:18,153 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.26it/s] 60%|██████    | 6/10 [00:00<00:00, 27.88it/s]100%|██████████| 10/10 [00:02<00:00,  2.94it/s]100%|██████████| 10/10 [00:02<00:00,  3.64it/s]
2025-03-13 16:11:20,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:20
2025-03-13 16:11:56,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5010 secs
2025-03-13 16:11:56,409 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 16:11:56,409 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 16:12:19,610 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2004 secs
2025-03-13 16:12:19,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4591 secs
2025-03-13 16:12:19,611 [INFO]: {
2025-03-13 16:12:19,611 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:19,612 [INFO]: 	index_param: efSearch=175
2025-03-13 16:12:19,612 [INFO]: 	index_path: knn.index
2025-03-13 16:12:19,612 [INFO]: 	size in bytes: 460380610
2025-03-13 16:12:19,612 [INFO]: 	avg_search_speed_ms: 9.057317466890115
2025-03-13 16:12:19,612 [INFO]: 	99p_search_speed_ms: 11.991709712892773
2025-03-13 16:12:19,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:19,612 [INFO]: 	nb vectors: 2340
2025-03-13 16:12:19,612 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:19,612 [INFO]: 	compression ratio: 0.9993095061062628
2025-03-13 16:12:19,612 [INFO]: }
2025-03-13 16:12:19,612 [INFO]: 	>>> Finished "Creating the index" in 61.4633 secs
2025-03-13 16:12:19,612 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4960 secs
2025-03-13 16:12:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 85864 [episode count 8/20]
[retrieval_preprocessing] for episode 79407 [episode count 9/20], we have num_retrieval=np.int64(2327) num_query=np.int64(128)
2025-03-13 16:12:20,600 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:21,171 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:21
2025-03-13 16:12:21,171 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.33it/s]
2025-03-13 16:12:21,203 [INFO]: There are 2327 embeddings of dim 49152
2025-03-13 16:12:21,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:12:21,204 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,204 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:21,204 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:12:21,204 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:21,204 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:12:21,204 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,204 [INFO]: 480.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:21,205 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:12:21,205 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:21
2025-03-13 16:12:21,205 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:21,205 [INFO]: 	Creating the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,205 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:21
2025-03-13 16:12:21,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:12:21,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:21
2025-03-13 16:12:21,209 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:12:21,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.37it/s] 60%|██████    | 6/10 [00:00<00:00, 25.20it/s]100%|██████████| 10/10 [00:02<00:00,  3.77it/s]100%|██████████| 10/10 [00:02<00:00,  4.61it/s]
2025-03-13 16:12:23,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:23
2025-03-13 16:12:55,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1717 secs
2025-03-13 16:12:55,553 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 16:12:55,553 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.06s/it] 50%|█████     | 2/4 [00:05<00:05,  2.65s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.52s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.54s/it]
2025-03-13 16:13:55,485 [INFO]: 	>>> Finished "Compute fast metrics" in 59.9317 secs
2025-03-13 16:13:55,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.2793 secs
2025-03-13 16:13:55,488 [INFO]: {
2025-03-13 16:13:55,488 [INFO]: 	index_key: HNSW15
2025-03-13 16:13:55,488 [INFO]: 	index_param: efSearch=162
2025-03-13 16:13:55,488 [INFO]: 	index_path: knn.index
2025-03-13 16:13:55,488 [INFO]: 	size in bytes: 457822990
2025-03-13 16:13:55,488 [INFO]: 	avg_search_speed_ms: 10.077624196363162
2025-03-13 16:13:55,488 [INFO]: 	99p_search_speed_ms: 16.819796792697176
2025-03-13 16:13:55,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:13:55,488 [INFO]: 	nb vectors: 2327
2025-03-13 16:13:55,488 [INFO]: 	vectors dimension: 49152
2025-03-13 16:13:55,488 [INFO]: 	compression ratio: 0.9993093968478953
2025-03-13 16:13:55,488 [INFO]: }
2025-03-13 16:13:55,488 [INFO]: 	>>> Finished "Creating the index" in 94.2832 secs
2025-03-13 16:13:55,488 [INFO]: >>> Finished "Launching the whole pipeline" in 94.3169 secs
2025-03-13 16:13:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 79407 [episode count 9/20]
[retrieval_preprocessing] for episode 30492 [episode count 10/20], we have num_retrieval=np.int64(2327) num_query=np.int64(128)
2025-03-13 16:14:02,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:03,230 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:03
2025-03-13 16:14:03,230 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.25it/s]
2025-03-13 16:14:03,260 [INFO]: There are 2327 embeddings of dim 49152
2025-03-13 16:14:03,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 16:14:03,260 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:03
2025-03-13 16:14:03,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:03,261 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:14:03,261 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:03,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:14:03,261 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:03
2025-03-13 16:14:03,261 [INFO]: 480.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:03,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:14:03,261 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:03
2025-03-13 16:14:03,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:03,261 [INFO]: 	Creating the index 03/13/2025, 16:14:03
2025-03-13 16:14:03,261 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:03
2025-03-13 16:14:03,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:14:03,262 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:03
2025-03-13 16:14:03,262 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:14:03,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.16it/s] 60%|██████    | 6/10 [00:00<00:00, 30.58it/s]100%|██████████| 10/10 [00:02<00:00,  3.61it/s]100%|██████████| 10/10 [00:02<00:00,  4.34it/s]
2025-03-13 16:14:05,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:05
2025-03-13 16:14:36,370 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7975 secs
2025-03-13 16:14:36,370 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 16:14:36,371 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.19it/s]
2025-03-13 16:14:59,534 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1636 secs
2025-03-13 16:14:59,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2741 secs
2025-03-13 16:14:59,537 [INFO]: {
2025-03-13 16:14:59,537 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:59,537 [INFO]: 	index_param: efSearch=103
2025-03-13 16:14:59,537 [INFO]: 	index_path: knn.index
2025-03-13 16:14:59,537 [INFO]: 	size in bytes: 457822990
2025-03-13 16:14:59,537 [INFO]: 	avg_search_speed_ms: 6.24150057197124
2025-03-13 16:14:59,537 [INFO]: 	99p_search_speed_ms: 9.648230010643601
2025-03-13 16:14:59,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:59,537 [INFO]: 	nb vectors: 2327
2025-03-13 16:14:59,537 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:59,537 [INFO]: 	compression ratio: 0.9993093968478953
2025-03-13 16:14:59,537 [INFO]: }
2025-03-13 16:14:59,537 [INFO]: 	>>> Finished "Creating the index" in 56.2757 secs
2025-03-13 16:14:59,537 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3066 secs
2025-03-13 16:14:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 30492 [episode count 10/20]
[retrieval_preprocessing] for episode 92719 [episode count 11/20], we have num_retrieval=np.int64(2363) num_query=np.int64(92)
2025-03-13 16:15:00,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:01,799 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:01
2025-03-13 16:15:01,799 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1258.04it/s]
2025-03-13 16:15:01,835 [INFO]: There are 2363 embeddings of dim 49152
2025-03-13 16:15:01,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 16:15:01,835 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:01,835 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:15:01,835 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:01,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:01,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,836 [INFO]: 487.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:01,836 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:15:01,836 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:01
2025-03-13 16:15:01,836 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:01,836 [INFO]: 	Creating the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,836 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:01
2025-03-13 16:15:01,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:15:01,837 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,837 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:15:01,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.02it/s] 50%|█████     | 5/10 [00:00<00:00, 24.84it/s] 90%|█████████ | 9/10 [00:00<00:00, 31.29it/s]100%|██████████| 10/10 [00:02<00:00,  4.73it/s]
2025-03-13 16:15:03,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:03
2025-03-13 16:15:48,557 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6007 secs
2025-03-13 16:15:48,557 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 16:15:48,557 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.67s/it] 75%|███████▌  | 3/4 [00:01<00:00,  1.70it/s]
2025-03-13 16:16:09,625 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0680 secs
2025-03-13 16:16:09,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7899 secs
2025-03-13 16:16:09,627 [INFO]: {
2025-03-13 16:16:09,627 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:09,627 [INFO]: 	index_param: efSearch=167
2025-03-13 16:16:09,627 [INFO]: 	index_path: knn.index
2025-03-13 16:16:09,627 [INFO]: 	size in bytes: 464905690
2025-03-13 16:16:09,627 [INFO]: 	avg_search_speed_ms: 8.687541495036045
2025-03-13 16:16:09,627 [INFO]: 	99p_search_speed_ms: 13.337370473891497
2025-03-13 16:16:09,627 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:09,627 [INFO]: 	nb vectors: 2363
2025-03-13 16:16:09,627 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:09,627 [INFO]: 	compression ratio: 0.9993095674952913
2025-03-13 16:16:09,627 [INFO]: }
2025-03-13 16:16:09,627 [INFO]: 	>>> Finished "Creating the index" in 67.7915 secs
2025-03-13 16:16:09,627 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8282 secs
2025-03-13 16:16:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:16:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 92719 [episode count 11/20]
[retrieval_preprocessing] for episode 95358 [episode count 12/20], we have num_retrieval=np.int64(2306) num_query=np.int64(149)
2025-03-13 16:16:10,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:16:10,861 [INFO]: Launching the whole pipeline 03/13/2025, 16:16:10
2025-03-13 16:16:10,861 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:16:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.00it/s]
2025-03-13 16:16:10,886 [INFO]: There are 2306 embeddings of dim 49152
2025-03-13 16:16:10,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:16:10,887 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:16:10
2025-03-13 16:16:10,887 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:16:10,887 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:16:10,887 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:16:10,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:16:10,887 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:16:10
2025-03-13 16:16:10,887 [INFO]: 475.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:16:10,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:16:10,888 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:16:10
2025-03-13 16:16:10,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:16:10,888 [INFO]: 	Creating the index 03/13/2025, 16:16:10
2025-03-13 16:16:10,888 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:16:10
2025-03-13 16:16:10,889 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:16:10,889 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:16:10
2025-03-13 16:16:10,889 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:16:10,889 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.56it/s] 80%|████████  | 8/10 [00:00<00:00, 38.05it/s]100%|██████████| 10/10 [00:01<00:00,  5.69it/s]
2025-03-13 16:16:12,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:16:12
2025-03-13 16:16:39,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9030 secs
2025-03-13 16:16:39,553 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 16:16:39,553 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.96it/s]
2025-03-13 16:17:05,525 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9720 secs
2025-03-13 16:17:05,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7966 secs
2025-03-13 16:17:05,686 [INFO]: {
2025-03-13 16:17:05,686 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:05,686 [INFO]: 	index_param: efSearch=211
2025-03-13 16:17:05,686 [INFO]: 	index_path: knn.index
2025-03-13 16:17:05,686 [INFO]: 	size in bytes: 453691330
2025-03-13 16:17:05,686 [INFO]: 	avg_search_speed_ms: 9.297286796246803
2025-03-13 16:17:05,686 [INFO]: 	99p_search_speed_ms: 12.675147503614426
2025-03-13 16:17:05,686 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:05,686 [INFO]: 	nb vectors: 2306
2025-03-13 16:17:05,686 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:05,686 [INFO]: 	compression ratio: 0.9993094820657031
2025-03-13 16:17:05,686 [INFO]: }
2025-03-13 16:17:05,686 [INFO]: 	>>> Finished "Creating the index" in 54.7986 secs
2025-03-13 16:17:05,686 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8256 secs
2025-03-13 16:17:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 95358 [episode count 12/20]
[retrieval_preprocessing] for episode 39748 [episode count 13/20], we have num_retrieval=np.int64(2325) num_query=np.int64(130)
2025-03-13 16:17:07,138 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:07,488 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:07
2025-03-13 16:17:07,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2322.43it/s]
2025-03-13 16:17:07,517 [INFO]: There are 2325 embeddings of dim 49152
2025-03-13 16:17:07,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 16:17:07,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:07
2025-03-13 16:17:07,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:07,518 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:17:07,518 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:07,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:17:07,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:07
2025-03-13 16:17:07,518 [INFO]: 479.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:07,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:17:07,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:07
2025-03-13 16:17:07,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:07,518 [INFO]: 	Creating the index 03/13/2025, 16:17:07
2025-03-13 16:17:07,518 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:07
2025-03-13 16:17:07,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:17:07,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:07
2025-03-13 16:17:07,519 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:17:07,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.58it/s] 60%|██████    | 6/10 [00:00<00:00, 30.60it/s]100%|██████████| 10/10 [00:02<00:00,  3.71it/s]100%|██████████| 10/10 [00:02<00:00,  4.46it/s]
2025-03-13 16:17:09,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:09
2025-03-13 16:17:44,806 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0433 secs
2025-03-13 16:17:44,807 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 16:17:44,807 [INFO]: 	Compute fast metrics 03/13/2025, 16:17:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.15it/s]
2025-03-13 16:18:01,173 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3651 secs
2025-03-13 16:18:01,175 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6557 secs
2025-03-13 16:18:01,175 [INFO]: {
2025-03-13 16:18:01,175 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:01,175 [INFO]: 	index_param: efSearch=125
2025-03-13 16:18:01,175 [INFO]: 	index_path: knn.index
2025-03-13 16:18:01,175 [INFO]: 	size in bytes: 457429510
2025-03-13 16:18:01,175 [INFO]: 	avg_search_speed_ms: 11.537213474909551
2025-03-13 16:18:01,175 [INFO]: 	99p_search_speed_ms: 21.432336722500622
2025-03-13 16:18:01,175 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:01,175 [INFO]: 	nb vectors: 2325
2025-03-13 16:18:01,175 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:01,175 [INFO]: 	compression ratio: 0.9993093799304728
2025-03-13 16:18:01,175 [INFO]: }
2025-03-13 16:18:01,175 [INFO]: 	>>> Finished "Creating the index" in 53.6572 secs
2025-03-13 16:18:01,176 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6873 secs
2025-03-13 16:18:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 39748 [episode count 13/20]
[retrieval_preprocessing] for episode 8878 [episode count 14/20], we have num_retrieval=np.int64(2301) num_query=np.int64(154)
2025-03-13 16:18:02,681 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:18:03,140 [INFO]: Launching the whole pipeline 03/13/2025, 16:18:03
2025-03-13 16:18:03,140 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:18:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.12it/s]
2025-03-13 16:18:03,177 [INFO]: There are 2301 embeddings of dim 49152
2025-03-13 16:18:03,177 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 16:18:03,177 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:18:03
2025-03-13 16:18:03,177 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:18:03,177 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:18:03,177 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:18:03,177 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:18:03,177 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:18:03
2025-03-13 16:18:03,177 [INFO]: 474.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:18:03,177 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:18:03,177 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:18:03
2025-03-13 16:18:03,177 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:18:03,177 [INFO]: 	Creating the index 03/13/2025, 16:18:03
2025-03-13 16:18:03,177 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:18:03
2025-03-13 16:18:03,178 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:18:03,179 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:18:03
2025-03-13 16:18:03,179 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:18:03,179 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.45it/s] 50%|█████     | 5/10 [00:00<00:00, 25.59it/s] 90%|█████████ | 9/10 [00:00<00:00, 31.79it/s]100%|██████████| 10/10 [00:02<00:00,  3.96it/s]
2025-03-13 16:18:05,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:05
2025-03-13 16:18:36,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4688 secs
2025-03-13 16:18:36,178 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 16:18:36,178 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.83it/s]
2025-03-13 16:18:58,754 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5760 secs
2025-03-13 16:18:58,756 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5775 secs
2025-03-13 16:18:58,756 [INFO]: {
2025-03-13 16:18:58,756 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:58,756 [INFO]: 	index_param: efSearch=186
2025-03-13 16:18:58,756 [INFO]: 	index_path: knn.index
2025-03-13 16:18:58,756 [INFO]: 	size in bytes: 452707630
2025-03-13 16:18:58,756 [INFO]: 	avg_search_speed_ms: 9.584823182193796
2025-03-13 16:18:58,756 [INFO]: 	99p_search_speed_ms: 13.278254889883092
2025-03-13 16:18:58,756 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:58,756 [INFO]: 	nb vectors: 2301
2025-03-13 16:18:58,756 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:58,756 [INFO]: 	compression ratio: 0.999309439516184
2025-03-13 16:18:58,756 [INFO]: }
2025-03-13 16:18:58,756 [INFO]: 	>>> Finished "Creating the index" in 55.5791 secs
2025-03-13 16:18:58,757 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6161 secs
2025-03-13 16:18:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 8878 [episode count 14/20]
[retrieval_preprocessing] for episode 56275 [episode count 15/20], we have num_retrieval=np.int64(2317) num_query=np.int64(138)
2025-03-13 16:19:00,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:00,799 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:00
2025-03-13 16:19:00,799 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.61it/s]
2025-03-13 16:19:00,823 [INFO]: There are 2317 embeddings of dim 49152
2025-03-13 16:19:00,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 16:19:00,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:00
2025-03-13 16:19:00,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:00,824 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:19:00,824 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:00,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:00,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:00
2025-03-13 16:19:00,824 [INFO]: 478.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:00,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:19:00,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:00
2025-03-13 16:19:00,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:00,824 [INFO]: 	Creating the index 03/13/2025, 16:19:00
2025-03-13 16:19:00,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:00
2025-03-13 16:19:00,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:19:00,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:00
2025-03-13 16:19:00,825 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:19:00,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.31it/s] 80%|████████  | 8/10 [00:00<00:00, 38.64it/s]100%|██████████| 10/10 [00:01<00:00,  5.85it/s]
2025-03-13 16:19:02,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:02
2025-03-13 16:19:37,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3759 secs
2025-03-13 16:19:37,914 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 16:19:37,914 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.68it/s]
2025-03-13 16:20:02,238 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3235 secs
2025-03-13 16:20:02,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4143 secs
2025-03-13 16:20:02,240 [INFO]: {
2025-03-13 16:20:02,240 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:02,240 [INFO]: 	index_param: efSearch=119
2025-03-13 16:20:02,240 [INFO]: 	index_path: knn.index
2025-03-13 16:20:02,240 [INFO]: 	size in bytes: 455855530
2025-03-13 16:20:02,240 [INFO]: 	avg_search_speed_ms: 7.121515734435624
2025-03-13 16:20:02,240 [INFO]: 	99p_search_speed_ms: 11.242589349858465
2025-03-13 16:20:02,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:02,240 [INFO]: 	nb vectors: 2317
2025-03-13 16:20:02,240 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:02,240 [INFO]: 	compression ratio: 0.9993094434984698
2025-03-13 16:20:02,240 [INFO]: }
2025-03-13 16:20:02,240 [INFO]: 	>>> Finished "Creating the index" in 61.4159 secs
2025-03-13 16:20:02,240 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4411 secs
2025-03-13 16:20:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 56275 [episode count 15/20]
[retrieval_preprocessing] for episode 89036 [episode count 16/20], we have num_retrieval=np.int64(2342) num_query=np.int64(113)
2025-03-13 16:20:03,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:03,687 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:03
2025-03-13 16:20:03,688 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 663.97it/s]
2025-03-13 16:20:03,727 [INFO]: There are 2342 embeddings of dim 49152
2025-03-13 16:20:03,728 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 16:20:03,728 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:03
2025-03-13 16:20:03,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:03,729 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:20:03,729 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:03,729 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:20:03,729 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:03
2025-03-13 16:20:03,730 [INFO]: 483.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:03,730 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:20:03,730 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:03
2025-03-13 16:20:03,730 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:03,730 [INFO]: 	Creating the index 03/13/2025, 16:20:03
2025-03-13 16:20:03,731 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:03
2025-03-13 16:20:03,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:20:03,734 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:03
2025-03-13 16:20:03,734 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:20:03,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.79it/s] 70%|███████   | 7/10 [00:00<00:00, 32.10it/s]100%|██████████| 10/10 [00:01<00:00,  5.60it/s]
2025-03-13 16:20:05,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:05
2025-03-13 16:20:40,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9322 secs
2025-03-13 16:20:40,458 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 16:20:40,458 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.08it/s]
2025-03-13 16:20:59,718 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2602 secs
2025-03-13 16:20:59,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9860 secs
2025-03-13 16:20:59,720 [INFO]: {
2025-03-13 16:20:59,720 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:59,720 [INFO]: 	index_param: efSearch=139
2025-03-13 16:20:59,720 [INFO]: 	index_path: knn.index
2025-03-13 16:20:59,720 [INFO]: 	size in bytes: 460774090
2025-03-13 16:20:59,720 [INFO]: 	avg_search_speed_ms: 7.4702255800644615
2025-03-13 16:20:59,720 [INFO]: 	99p_search_speed_ms: 10.232183313928537
2025-03-13 16:20:59,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:59,720 [INFO]: 	nb vectors: 2342
2025-03-13 16:20:59,720 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:59,720 [INFO]: 	compression ratio: 0.9993095228075867
2025-03-13 16:20:59,720 [INFO]: }
2025-03-13 16:20:59,720 [INFO]: 	>>> Finished "Creating the index" in 55.9899 secs
2025-03-13 16:20:59,720 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0329 secs
2025-03-13 16:21:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 89036 [episode count 16/20]
[retrieval_preprocessing] for episode 91379 [episode count 17/20], we have num_retrieval=np.int64(2314) num_query=np.int64(141)
2025-03-13 16:21:00,901 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:01,335 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:01
2025-03-13 16:21:01,335 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.69it/s]
2025-03-13 16:21:01,362 [INFO]: There are 2314 embeddings of dim 49152
2025-03-13 16:21:01,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 16:21:01,362 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:01
2025-03-13 16:21:01,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:01,362 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:21:01,363 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:01,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:01,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:01
2025-03-13 16:21:01,363 [INFO]: 477.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:01,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:21:01,363 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:01
2025-03-13 16:21:01,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:01,363 [INFO]: 	Creating the index 03/13/2025, 16:21:01
2025-03-13 16:21:01,363 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:01
2025-03-13 16:21:01,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:21:01,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:01
2025-03-13 16:21:01,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:21:01,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.82it/s] 60%|██████    | 6/10 [00:00<00:00, 30.53it/s]100%|██████████| 10/10 [00:01<00:00,  4.29it/s]100%|██████████| 10/10 [00:01<00:00,  5.12it/s]
2025-03-13 16:21:03,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:03
2025-03-13 16:21:39,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3303 secs
2025-03-13 16:21:39,653 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 16:21:39,653 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 16:21:58,181 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5279 secs
2025-03-13 16:21:58,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8189 secs
2025-03-13 16:21:58,183 [INFO]: {
2025-03-13 16:21:58,183 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:58,183 [INFO]: 	index_param: efSearch=115
2025-03-13 16:21:58,183 [INFO]: 	index_path: knn.index
2025-03-13 16:21:58,183 [INFO]: 	size in bytes: 455265310
2025-03-13 16:21:58,183 [INFO]: 	avg_search_speed_ms: 7.555419042916266
2025-03-13 16:21:58,183 [INFO]: 	99p_search_speed_ms: 12.841264083981514
2025-03-13 16:21:58,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:58,183 [INFO]: 	nb vectors: 2314
2025-03-13 16:21:58,184 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:58,184 [INFO]: 	compression ratio: 0.9993094180621844
2025-03-13 16:21:58,184 [INFO]: }
2025-03-13 16:21:58,184 [INFO]: 	>>> Finished "Creating the index" in 56.8205 secs
2025-03-13 16:21:58,184 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8485 secs
2025-03-13 16:21:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 91379 [episode count 17/20]
[retrieval_preprocessing] for episode 67391 [episode count 18/20], we have num_retrieval=np.int64(2326) num_query=np.int64(129)
2025-03-13 16:21:59,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:59,876 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:59
2025-03-13 16:21:59,877 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.74it/s]
2025-03-13 16:21:59,914 [INFO]: There are 2326 embeddings of dim 49152
2025-03-13 16:21:59,914 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 16:21:59,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:59
2025-03-13 16:21:59,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:59,914 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:21:59,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:59,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:21:59,915 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:59
2025-03-13 16:21:59,915 [INFO]: 480.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:59,915 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:21:59,915 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:59
2025-03-13 16:21:59,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:59,915 [INFO]: 	Creating the index 03/13/2025, 16:21:59
2025-03-13 16:21:59,915 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:59
2025-03-13 16:21:59,918 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:21:59,918 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:59
2025-03-13 16:21:59,918 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:21:59,918 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.62it/s] 70%|███████   | 7/10 [00:00<00:00, 31.78it/s]100%|██████████| 10/10 [00:01<00:00,  5.21it/s]
2025-03-13 16:22:01,841 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:01
2025-03-13 16:22:29,771 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9297 secs
2025-03-13 16:22:29,771 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 16:22:29,771 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]
2025-03-13 16:23:05,742 [INFO]: 	>>> Finished "Compute fast metrics" in 35.9712 secs
2025-03-13 16:23:05,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8262 secs
2025-03-13 16:23:05,744 [INFO]: {
2025-03-13 16:23:05,744 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:05,744 [INFO]: 	index_param: efSearch=124
2025-03-13 16:23:05,744 [INFO]: 	index_path: knn.index
2025-03-13 16:23:05,744 [INFO]: 	size in bytes: 457626250
2025-03-13 16:23:05,744 [INFO]: 	avg_search_speed_ms: 6.103750643228273
2025-03-13 16:23:05,744 [INFO]: 	99p_search_speed_ms: 8.41419570147991
2025-03-13 16:23:05,744 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:05,744 [INFO]: 	nb vectors: 2326
2025-03-13 16:23:05,744 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:05,744 [INFO]: 	compression ratio: 0.9993093883928206
2025-03-13 16:23:05,744 [INFO]: }
2025-03-13 16:23:05,744 [INFO]: 	>>> Finished "Creating the index" in 65.8291 secs
2025-03-13 16:23:05,744 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8678 secs
2025-03-13 16:23:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 67391 [episode count 18/20]
[retrieval_preprocessing] for episode 34706 [episode count 19/20], we have num_retrieval=np.int64(2352) num_query=np.int64(103)
2025-03-13 16:23:06,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:07,721 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:07
2025-03-13 16:23:07,721 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.94it/s]
2025-03-13 16:23:07,748 [INFO]: There are 2352 embeddings of dim 49152
2025-03-13 16:23:07,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 16:23:07,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:07
2025-03-13 16:23:07,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:07,749 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:23:07,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:07,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:23:07,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:07
2025-03-13 16:23:07,750 [INFO]: 485.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:07,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:23:07,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:07
2025-03-13 16:23:07,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:07,751 [INFO]: 	Creating the index 03/13/2025, 16:23:07
2025-03-13 16:23:07,751 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:07
2025-03-13 16:23:07,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:23:07,754 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:07
2025-03-13 16:23:07,754 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:23:07,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.33it/s] 70%|███████   | 7/10 [00:00<00:00, 33.17it/s]100%|██████████| 10/10 [00:02<00:00,  4.96it/s]
2025-03-13 16:23:09,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:09
2025-03-13 16:23:39,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0230 secs
2025-03-13 16:23:39,798 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 16:23:39,798 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-13 16:24:05,555 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7570 secs
2025-03-13 16:24:05,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8030 secs
2025-03-13 16:24:05,558 [INFO]: {
2025-03-13 16:24:05,558 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:05,558 [INFO]: 	index_param: efSearch=91
2025-03-13 16:24:05,558 [INFO]: 	index_path: knn.index
2025-03-13 16:24:05,558 [INFO]: 	size in bytes: 462741490
2025-03-13 16:24:05,558 [INFO]: 	avg_search_speed_ms: 5.533185988374974
2025-03-13 16:24:05,558 [INFO]: 	99p_search_speed_ms: 7.919912226498129
2025-03-13 16:24:05,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:05,558 [INFO]: 	nb vectors: 2352
2025-03-13 16:24:05,558 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:05,558 [INFO]: 	compression ratio: 0.9993096058881602
2025-03-13 16:24:05,558 [INFO]: }
2025-03-13 16:24:05,558 [INFO]: 	>>> Finished "Creating the index" in 57.8071 secs
2025-03-13 16:24:05,558 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8375 secs
2025-03-13 16:24:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 34706 [episode count 19/20]
2025-03-13 16:24:06: [retrieval_preprocessing] finished for -1_remove_marker_from_mug [chosen_id count 4/196]
2025-03-13 16:24:07: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_cup [chosen_id count 5/196]
2025-03-13 16:24:07: [retrieval_preprocessing] we have num_total=2924 embedding_dim=49152
[retrieval_preprocessing] for episode 90190 [episode count 0/20], we have num_retrieval=np.int64(2818) num_query=np.int64(106)
2025-03-13 16:24:07,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:08,159 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:08
2025-03-13 16:24:08,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1040.25it/s]
2025-03-13 16:24:08,193 [INFO]: There are 2818 embeddings of dim 49152
2025-03-13 16:24:08,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 16:24:08,193 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:08
2025-03-13 16:24:08,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:08,194 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:24:08,194 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:08,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:08,194 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:08
2025-03-13 16:24:08,194 [INFO]: 581.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:08,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:24:08,194 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:08
2025-03-13 16:24:08,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:08,194 [INFO]: 	Creating the index 03/13/2025, 16:24:08
2025-03-13 16:24:08,194 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:08
2025-03-13 16:24:08,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:24:08,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:08
2025-03-13 16:24:08,195 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:24:08,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.26it/s] 50%|█████     | 6/12 [00:00<00:00, 30.54it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.94it/s]100%|██████████| 12/12 [00:02<00:00,  4.84it/s]
2025-03-13 16:24:10,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:10
2025-03-13 16:24:52,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9243 secs
2025-03-13 16:24:52,603 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 16:24:52,603 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.22it/s]
2025-03-13 16:25:08,707 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1037 secs
2025-03-13 16:25:08,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5133 secs
2025-03-13 16:25:08,709 [INFO]: {
2025-03-13 16:25:08,709 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:08,709 [INFO]: 	index_param: efSearch=178
2025-03-13 16:25:08,709 [INFO]: 	index_path: knn.index
2025-03-13 16:25:08,709 [INFO]: 	size in bytes: 554424010
2025-03-13 16:25:08,709 [INFO]: 	avg_search_speed_ms: 9.815709135779366
2025-03-13 16:25:08,709 [INFO]: 	99p_search_speed_ms: 15.100776245817531
2025-03-13 16:25:08,709 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:08,709 [INFO]: 	nb vectors: 2818
2025-03-13 16:25:08,709 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:08,709 [INFO]: 	compression ratio: 0.9993097954037019
2025-03-13 16:25:08,709 [INFO]: }
2025-03-13 16:25:08,709 [INFO]: 	>>> Finished "Creating the index" in 60.5149 secs
2025-03-13 16:25:08,709 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5495 secs
2025-03-13 16:25:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 90190 [episode count 0/20]
[retrieval_preprocessing] for episode 45099 [episode count 1/20], we have num_retrieval=np.int64(2770) num_query=np.int64(154)
2025-03-13 16:25:09,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:10,386 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:10
2025-03-13 16:25:10,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2166.48it/s]
2025-03-13 16:25:10,411 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 16:25:10,411 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:25:10,411 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:10
2025-03-13 16:25:10,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:10,411 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:25:10,411 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:10,411 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:10,411 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:10
2025-03-13 16:25:10,412 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:10,412 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:25:10,412 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:10
2025-03-13 16:25:10,412 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:10,412 [INFO]: 	Creating the index 03/13/2025, 16:25:10
2025-03-13 16:25:10,412 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:10
2025-03-13 16:25:10,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:25:10,413 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:10
2025-03-13 16:25:10,413 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:25:10,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.56it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.18it/s]100%|██████████| 11/11 [00:02<00:00,  3.63it/s]100%|██████████| 11/11 [00:02<00:00,  4.27it/s]
2025-03-13 16:25:12,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:12
2025-03-13 16:25:44,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7512 secs
2025-03-13 16:25:44,743 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 16:25:44,743 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.56it/s]
2025-03-13 16:26:17,452 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7082 secs
2025-03-13 16:26:17,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0406 secs
2025-03-13 16:26:17,453 [INFO]: {
2025-03-13 16:26:17,454 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:17,454 [INFO]: 	index_param: efSearch=160
2025-03-13 16:26:17,454 [INFO]: 	index_path: knn.index
2025-03-13 16:26:17,454 [INFO]: 	size in bytes: 544980310
2025-03-13 16:26:17,454 [INFO]: 	avg_search_speed_ms: 6.482658312642103
2025-03-13 16:26:17,454 [INFO]: 	99p_search_speed_ms: 11.284285192377864
2025-03-13 16:26:17,454 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:17,454 [INFO]: 	nb vectors: 2770
2025-03-13 16:26:17,454 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:17,454 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 16:26:17,454 [INFO]: }
2025-03-13 16:26:17,454 [INFO]: 	>>> Finished "Creating the index" in 67.0420 secs
2025-03-13 16:26:17,454 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0680 secs
2025-03-13 16:26:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 45099 [episode count 1/20]
[retrieval_preprocessing] for episode 1094 [episode count 2/20], we have num_retrieval=np.int64(2735) num_query=np.int64(189)
2025-03-13 16:26:18,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:19,541 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:19
2025-03-13 16:26:19,541 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.01it/s]
2025-03-13 16:26:19,576 [INFO]: There are 2735 embeddings of dim 49152
2025-03-13 16:26:19,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 16:26:19,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:19
2025-03-13 16:26:19,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:19,576 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:26:19,576 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:19,576 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:19,576 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:19
2025-03-13 16:26:19,577 [INFO]: 564.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:19,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:19,577 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:19
2025-03-13 16:26:19,577 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:19,577 [INFO]: 	Creating the index 03/13/2025, 16:26:19
2025-03-13 16:26:19,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:19
2025-03-13 16:26:19,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:26:19,578 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:19
2025-03-13 16:26:19,578 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:26:19,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.27it/s] 82%|████████▏ | 9/11 [00:00<00:00, 41.49it/s]100%|██████████| 11/11 [00:01<00:00,  6.01it/s]
2025-03-13 16:26:21,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:21
2025-03-13 16:26:51,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1119 secs
2025-03-13 16:26:51,080 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 16:26:51,080 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 16:27:09,811 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7312 secs
2025-03-13 16:27:09,814 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2361 secs
2025-03-13 16:27:09,814 [INFO]: {
2025-03-13 16:27:09,814 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:09,814 [INFO]: 	index_param: efSearch=148
2025-03-13 16:27:09,814 [INFO]: 	index_path: knn.index
2025-03-13 16:27:09,814 [INFO]: 	size in bytes: 538094230
2025-03-13 16:27:09,814 [INFO]: 	avg_search_speed_ms: 8.833348923222928
2025-03-13 16:27:09,814 [INFO]: 	99p_search_speed_ms: 16.192594519816385
2025-03-13 16:27:09,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:09,814 [INFO]: 	nb vectors: 2735
2025-03-13 16:27:09,814 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:09,815 [INFO]: 	compression ratio: 0.9993098792380658
2025-03-13 16:27:09,815 [INFO]: }
2025-03-13 16:27:09,815 [INFO]: 	>>> Finished "Creating the index" in 50.2378 secs
2025-03-13 16:27:09,815 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2736 secs
2025-03-13 16:27:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 1094 [episode count 2/20]
[retrieval_preprocessing] for episode 65886 [episode count 3/20], we have num_retrieval=np.int64(2776) num_query=np.int64(148)
2025-03-13 16:27:12,800 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:13,668 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:13
2025-03-13 16:27:13,668 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 583.03it/s]
2025-03-13 16:27:13,707 [INFO]: There are 2776 embeddings of dim 49152
2025-03-13 16:27:13,708 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 16:27:13,708 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:13
2025-03-13 16:27:13,709 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:13,709 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:27:13,709 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:13,709 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:27:13,709 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:13
2025-03-13 16:27:13,709 [INFO]: 572.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:13,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 16:27:13,710 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:13
2025-03-13 16:27:13,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:13,710 [INFO]: 	Creating the index 03/13/2025, 16:27:13
2025-03-13 16:27:13,711 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:13
2025-03-13 16:27:13,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0043 secs
2025-03-13 16:27:13,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:13
2025-03-13 16:27:13,716 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:27:13,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.75it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.73it/s] 55%|█████▍    | 6/11 [00:00<00:00, 16.05it/s] 82%|████████▏ | 9/11 [00:00<00:00, 18.87it/s]100%|██████████| 11/11 [00:03<00:00,  3.09it/s]
2025-03-13 16:27:17,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:17
2025-03-13 16:27:51,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7857 secs
2025-03-13 16:27:51,069 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 16:27:51,069 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.54it/s]
2025-03-13 16:28:23,840 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7713 secs
2025-03-13 16:28:23,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1265 secs
2025-03-13 16:28:23,842 [INFO]: {
2025-03-13 16:28:23,842 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:23,843 [INFO]: 	index_param: efSearch=190
2025-03-13 16:28:23,843 [INFO]: 	index_path: knn.index
2025-03-13 16:28:23,843 [INFO]: 	size in bytes: 546160750
2025-03-13 16:28:23,843 [INFO]: 	avg_search_speed_ms: 8.235250594887631
2025-03-13 16:28:23,843 [INFO]: 	99p_search_speed_ms: 13.26283557340502
2025-03-13 16:28:23,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:23,843 [INFO]: 	nb vectors: 2776
2025-03-13 16:28:23,843 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:23,843 [INFO]: 	compression ratio: 0.9993098332313335
2025-03-13 16:28:23,843 [INFO]: }
2025-03-13 16:28:23,843 [INFO]: 	>>> Finished "Creating the index" in 70.1321 secs
2025-03-13 16:28:23,843 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1749 secs
2025-03-13 16:28:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65886 [episode count 3/20]
[retrieval_preprocessing] for episode 25717 [episode count 4/20], we have num_retrieval=np.int64(2811) num_query=np.int64(113)
2025-03-13 16:28:25,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:25,502 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:25
2025-03-13 16:28:25,502 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.34it/s]
2025-03-13 16:28:25,530 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 16:28:25,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:28:25,530 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:25
2025-03-13 16:28:25,530 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:25,530 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:28:25,530 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:25,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:28:25,530 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:25
2025-03-13 16:28:25,530 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:25,530 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:28:25,530 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:25
2025-03-13 16:28:25,530 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:25,530 [INFO]: 	Creating the index 03/13/2025, 16:28:25
2025-03-13 16:28:25,530 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:25
2025-03-13 16:28:25,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:28:25,532 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:25
2025-03-13 16:28:25,532 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:28:25,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.26it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.77it/s]100%|██████████| 12/12 [00:01<00:00,  4.89it/s]100%|██████████| 12/12 [00:01<00:00,  6.09it/s]
2025-03-13 16:28:27,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:28:27
2025-03-13 16:28:55,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7208 secs
2025-03-13 16:28:55,228 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 16:28:55,228 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.31it/s]
2025-03-13 16:29:22,299 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0707 secs
2025-03-13 16:29:22,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7697 secs
2025-03-13 16:29:22,302 [INFO]: {
2025-03-13 16:29:22,302 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:22,302 [INFO]: 	index_param: efSearch=156
2025-03-13 16:29:22,302 [INFO]: 	index_path: knn.index
2025-03-13 16:29:22,302 [INFO]: 	size in bytes: 553046830
2025-03-13 16:29:22,302 [INFO]: 	avg_search_speed_ms: 7.70164079725949
2025-03-13 16:29:22,302 [INFO]: 	99p_search_speed_ms: 11.493335703853518
2025-03-13 16:29:22,302 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:22,302 [INFO]: 	nb vectors: 2811
2025-03-13 16:29:22,302 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:22,302 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 16:29:22,302 [INFO]: }
2025-03-13 16:29:22,302 [INFO]: 	>>> Finished "Creating the index" in 56.7714 secs
2025-03-13 16:29:22,302 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7999 secs
2025-03-13 16:29:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 25717 [episode count 4/20]
[retrieval_preprocessing] for episode 42627 [episode count 5/20], we have num_retrieval=np.int64(2800) num_query=np.int64(124)
2025-03-13 16:29:25,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:26,204 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:26
2025-03-13 16:29:26,204 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.91it/s]
2025-03-13 16:29:26,246 [INFO]: There are 2800 embeddings of dim 49152
2025-03-13 16:29:26,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0423 secs
2025-03-13 16:29:26,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:26
2025-03-13 16:29:26,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:26,247 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:29:26,247 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:26,247 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:29:26,247 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:26
2025-03-13 16:29:26,247 [INFO]: 577.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:26,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:26,247 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:26
2025-03-13 16:29:26,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:26,247 [INFO]: 	Creating the index 03/13/2025, 16:29:26
2025-03-13 16:29:26,247 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:26
2025-03-13 16:29:26,248 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:29:26,248 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:26
2025-03-13 16:29:26,248 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:29:26,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.87it/s] 42%|████▏     | 5/12 [00:00<00:00, 17.59it/s] 75%|███████▌  | 9/12 [00:00<00:00, 23.52it/s]100%|██████████| 12/12 [00:02<00:00,  3.04it/s]100%|██████████| 12/12 [00:02<00:00,  4.14it/s]
2025-03-13 16:29:29,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:29
2025-03-13 16:30:06,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2500 secs
2025-03-13 16:30:06,402 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 16:30:06,402 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.74it/s]
2025-03-13 16:30:24,066 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6635 secs
2025-03-13 16:30:24,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8197 secs
2025-03-13 16:30:24,068 [INFO]: {
2025-03-13 16:30:24,068 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:24,068 [INFO]: 	index_param: efSearch=106
2025-03-13 16:30:24,068 [INFO]: 	index_path: knn.index
2025-03-13 16:30:24,068 [INFO]: 	size in bytes: 550882690
2025-03-13 16:30:24,068 [INFO]: 	avg_search_speed_ms: 5.537356234122058
2025-03-13 16:30:24,068 [INFO]: 	99p_search_speed_ms: 12.858919519931085
2025-03-13 16:30:24,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:24,068 [INFO]: 	nb vectors: 2800
2025-03-13 16:30:24,068 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:24,068 [INFO]: 	compression ratio: 0.9993096715382362
2025-03-13 16:30:24,068 [INFO]: }
2025-03-13 16:30:24,068 [INFO]: 	>>> Finished "Creating the index" in 57.8210 secs
2025-03-13 16:30:24,068 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8641 secs
2025-03-13 16:30:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 42627 [episode count 5/20]
[retrieval_preprocessing] for episode 94205 [episode count 6/20], we have num_retrieval=np.int64(2816) num_query=np.int64(108)
2025-03-13 16:30:25,072 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:25,457 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:25
2025-03-13 16:30:25,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1768.26it/s]
2025-03-13 16:30:25,485 [INFO]: There are 2816 embeddings of dim 49152
2025-03-13 16:30:25,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 16:30:25,486 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:25
2025-03-13 16:30:25,486 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:25,486 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:30:25,486 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:25,486 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:30:25,486 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:25
2025-03-13 16:30:25,487 [INFO]: 581.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:25,487 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:30:25,487 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:25
2025-03-13 16:30:25,487 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:25,487 [INFO]: 	Creating the index 03/13/2025, 16:30:25
2025-03-13 16:30:25,488 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:25
2025-03-13 16:30:25,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:30:25,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:25
2025-03-13 16:30:25,491 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:30:25,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.12it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.32it/s]100%|██████████| 12/12 [00:02<00:00,  4.58it/s]100%|██████████| 12/12 [00:02<00:00,  5.84it/s]
2025-03-13 16:30:27,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:27
2025-03-13 16:31:00,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7691 secs
2025-03-13 16:31:00,320 [INFO]: The best hyperparameters are: efSearch=118
2025-03-13 16:31:00,320 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-13 16:31:22,465 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1446 secs
2025-03-13 16:31:22,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9760 secs
2025-03-13 16:31:22,467 [INFO]: {
2025-03-13 16:31:22,467 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:22,467 [INFO]: 	index_param: efSearch=118
2025-03-13 16:31:22,467 [INFO]: 	index_path: knn.index
2025-03-13 16:31:22,467 [INFO]: 	size in bytes: 554030530
2025-03-13 16:31:22,467 [INFO]: 	avg_search_speed_ms: 5.828893955650335
2025-03-13 16:31:22,467 [INFO]: 	99p_search_speed_ms: 9.212929201312356
2025-03-13 16:31:22,467 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:22,467 [INFO]: 	nb vectors: 2816
2025-03-13 16:31:22,467 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:22,467 [INFO]: 	compression ratio: 0.9993097817190688
2025-03-13 16:31:22,467 [INFO]: }
2025-03-13 16:31:22,467 [INFO]: 	>>> Finished "Creating the index" in 56.9794 secs
2025-03-13 16:31:22,467 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0096 secs
2025-03-13 16:31:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 94205 [episode count 6/20]
[retrieval_preprocessing] for episode 27623 [episode count 7/20], we have num_retrieval=np.int64(2746) num_query=np.int64(178)
2025-03-13 16:31:23,426 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:24,993 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:24
2025-03-13 16:31:24,993 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.97it/s]
2025-03-13 16:31:25,020 [INFO]: There are 2746 embeddings of dim 49152
2025-03-13 16:31:25,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:31:25,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:25,021 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:31:25,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:25,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:25,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,021 [INFO]: 566.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:25,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:31:25,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:25
2025-03-13 16:31:25,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:25,021 [INFO]: 	Creating the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:25
2025-03-13 16:31:25,022 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:31:25,022 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,022 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:31:25,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.60it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.58it/s]100%|██████████| 11/11 [00:02<00:00,  4.59it/s]100%|██████████| 11/11 [00:02<00:00,  5.36it/s]
2025-03-13 16:31:27,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:27
2025-03-13 16:32:02,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4312 secs
2025-03-13 16:32:02,508 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 16:32:02,508 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.05it/s]
2025-03-13 16:32:29,939 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4309 secs
2025-03-13 16:32:29,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9189 secs
2025-03-13 16:32:29,941 [INFO]: {
2025-03-13 16:32:29,941 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:29,941 [INFO]: 	index_param: efSearch=165
2025-03-13 16:32:29,941 [INFO]: 	index_path: knn.index
2025-03-13 16:32:29,941 [INFO]: 	size in bytes: 540258370
2025-03-13 16:32:29,941 [INFO]: 	avg_search_speed_ms: 7.296724626549909
2025-03-13 16:32:29,941 [INFO]: 	99p_search_speed_ms: 10.011531761847436
2025-03-13 16:32:29,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:29,941 [INFO]: 	nb vectors: 2746
2025-03-13 16:32:29,941 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:29,941 [INFO]: 	compression ratio: 0.9993099560863814
2025-03-13 16:32:29,941 [INFO]: }
2025-03-13 16:32:29,941 [INFO]: 	>>> Finished "Creating the index" in 64.9203 secs
2025-03-13 16:32:29,941 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9484 secs
2025-03-13 16:32:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 27623 [episode count 7/20]
[retrieval_preprocessing] for episode 11239 [episode count 8/20], we have num_retrieval=np.int64(2727) num_query=np.int64(197)
2025-03-13 16:32:31,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:31,869 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:31
2025-03-13 16:32:31,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2079.48it/s]
2025-03-13 16:32:31,901 [INFO]: There are 2727 embeddings of dim 49152
2025-03-13 16:32:31,901 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 16:32:31,901 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:31
2025-03-13 16:32:31,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:31,901 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:32:31,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:31,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:32:31,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:31
2025-03-13 16:32:31,901 [INFO]: 562.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:31,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:32:31,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:31
2025-03-13 16:32:31,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:31,901 [INFO]: 	Creating the index 03/13/2025, 16:32:31
2025-03-13 16:32:31,901 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:31
2025-03-13 16:32:31,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:32:31,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:31
2025-03-13 16:32:31,902 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:32:31,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.60it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.06it/s]100%|██████████| 11/11 [00:02<00:00,  4.23it/s]100%|██████████| 11/11 [00:02<00:00,  4.95it/s]
2025-03-13 16:32:34,126 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:34
2025-03-13 16:33:07,887 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7601 secs
2025-03-13 16:33:07,887 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 16:33:07,887 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 16:33:37,561 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6738 secs
2025-03-13 16:33:37,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6608 secs
2025-03-13 16:33:37,563 [INFO]: {
2025-03-13 16:33:37,563 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:37,563 [INFO]: 	index_param: efSearch=123
2025-03-13 16:33:37,563 [INFO]: 	index_path: knn.index
2025-03-13 16:33:37,563 [INFO]: 	size in bytes: 536520310
2025-03-13 16:33:37,563 [INFO]: 	avg_search_speed_ms: 6.036067763928342
2025-03-13 16:33:37,563 [INFO]: 	99p_search_speed_ms: 8.893313945736736
2025-03-13 16:33:37,563 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:37,564 [INFO]: 	nb vectors: 2727
2025-03-13 16:33:37,564 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:37,564 [INFO]: 	compression ratio: 0.9993098229589855
2025-03-13 16:33:37,564 [INFO]: }
2025-03-13 16:33:37,564 [INFO]: 	>>> Finished "Creating the index" in 65.6621 secs
2025-03-13 16:33:37,564 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6944 secs
2025-03-13 16:33:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 11239 [episode count 8/20]
[retrieval_preprocessing] for episode 76765 [episode count 9/20], we have num_retrieval=np.int64(2774) num_query=np.int64(150)
2025-03-13 16:33:38,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:39,416 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:39
2025-03-13 16:33:39,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2511.56it/s]
2025-03-13 16:33:39,443 [INFO]: There are 2774 embeddings of dim 49152
2025-03-13 16:33:39,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 16:33:39,443 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:39
2025-03-13 16:33:39,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:39,443 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:33:39,443 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:39,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:33:39,443 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:39
2025-03-13 16:33:39,444 [INFO]: 572.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:39,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:33:39,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:39
2025-03-13 16:33:39,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:39,444 [INFO]: 	Creating the index 03/13/2025, 16:33:39
2025-03-13 16:33:39,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:39
2025-03-13 16:33:39,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:33:39,445 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:39
2025-03-13 16:33:39,445 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:33:39,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.70it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.14it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]100%|██████████| 11/11 [00:02<00:00,  4.87it/s]
2025-03-13 16:33:41,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:41
2025-03-13 16:34:17,593 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8838 secs
2025-03-13 16:34:17,593 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 16:34:17,593 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.17it/s]
2025-03-13 16:34:40,263 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6696 secs
2025-03-13 16:34:40,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8196 secs
2025-03-13 16:34:40,265 [INFO]: {
2025-03-13 16:34:40,265 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:40,265 [INFO]: 	index_param: efSearch=152
2025-03-13 16:34:40,265 [INFO]: 	index_path: knn.index
2025-03-13 16:34:40,265 [INFO]: 	size in bytes: 545767270
2025-03-13 16:34:40,265 [INFO]: 	avg_search_speed_ms: 8.184191554597291
2025-03-13 16:34:40,265 [INFO]: 	99p_search_speed_ms: 16.441664686426474
2025-03-13 16:34:40,265 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:40,265 [INFO]: 	nb vectors: 2774
2025-03-13 16:34:40,265 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:40,265 [INFO]: 	compression ratio: 0.9993098193667788
2025-03-13 16:34:40,265 [INFO]: }
2025-03-13 16:34:40,265 [INFO]: 	>>> Finished "Creating the index" in 60.8214 secs
2025-03-13 16:34:40,265 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8495 secs
2025-03-13 16:34:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 76765 [episode count 9/20]
[retrieval_preprocessing] for episode 36930 [episode count 10/20], we have num_retrieval=np.int64(2775) num_query=np.int64(149)
2025-03-13 16:34:41,548 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:41,967 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:41
2025-03-13 16:34:41,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.89it/s]
2025-03-13 16:34:42,000 [INFO]: There are 2775 embeddings of dim 49152
2025-03-13 16:34:42,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 16:34:42,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:42
2025-03-13 16:34:42,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:42,000 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:34:42,001 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:42,001 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:34:42,001 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:42
2025-03-13 16:34:42,001 [INFO]: 572.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:42,001 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:34:42,001 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:42
2025-03-13 16:34:42,001 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:42,001 [INFO]: 	Creating the index 03/13/2025, 16:34:42
2025-03-13 16:34:42,001 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:42
2025-03-13 16:34:42,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:34:42,002 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:42
2025-03-13 16:34:42,002 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:34:42,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.51it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.31it/s]100%|██████████| 11/11 [00:02<00:00,  3.28it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]
2025-03-13 16:34:44,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:44
2025-03-13 16:35:19,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1866 secs
2025-03-13 16:35:19,031 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:35:19,032 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 16:35:48,411 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3791 secs
2025-03-13 16:35:48,413 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4110 secs
2025-03-13 16:35:48,413 [INFO]: {
2025-03-13 16:35:48,413 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:48,413 [INFO]: 	index_param: efSearch=157
2025-03-13 16:35:48,413 [INFO]: 	index_path: knn.index
2025-03-13 16:35:48,413 [INFO]: 	size in bytes: 545964010
2025-03-13 16:35:48,413 [INFO]: 	avg_search_speed_ms: 7.283123387111988
2025-03-13 16:35:48,413 [INFO]: 	99p_search_speed_ms: 10.68255206570029
2025-03-13 16:35:48,413 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:48,413 [INFO]: 	nb vectors: 2775
2025-03-13 16:35:48,413 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:48,413 [INFO]: 	compression ratio: 0.9993098263015542
2025-03-13 16:35:48,413 [INFO]: }
2025-03-13 16:35:48,413 [INFO]: 	>>> Finished "Creating the index" in 66.4124 secs
2025-03-13 16:35:48,413 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4466 secs
2025-03-13 16:35:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 36930 [episode count 10/20]
[retrieval_preprocessing] for episode 78662 [episode count 11/20], we have num_retrieval=np.int64(2720) num_query=np.int64(204)
2025-03-13 16:35:50,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:51,192 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:51
2025-03-13 16:35:51,192 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-13 16:35:51,220 [INFO]: There are 2720 embeddings of dim 49152
2025-03-13 16:35:51,220 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:35:51,220 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:51
2025-03-13 16:35:51,220 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:51,220 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:35:51,220 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:51,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:51,220 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:51
2025-03-13 16:35:51,220 [INFO]: 561.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:51,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:35:51,220 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:51
2025-03-13 16:35:51,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:51,220 [INFO]: 	Creating the index 03/13/2025, 16:35:51
2025-03-13 16:35:51,220 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:51
2025-03-13 16:35:51,221 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:35:51,221 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:51
2025-03-13 16:35:51,221 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:35:51,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.47it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.09it/s]100%|██████████| 11/11 [00:01<00:00,  5.65it/s]
2025-03-13 16:35:53,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:53
2025-03-13 16:36:25,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9171 secs
2025-03-13 16:36:25,088 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 16:36:25,088 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.11it/s]
2025-03-13 16:36:49,046 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9574 secs
2025-03-13 16:36:49,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8272 secs
2025-03-13 16:36:49,049 [INFO]: {
2025-03-13 16:36:49,049 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:49,049 [INFO]: 	index_param: efSearch=175
2025-03-13 16:36:49,049 [INFO]: 	index_path: knn.index
2025-03-13 16:36:49,049 [INFO]: 	size in bytes: 535143130
2025-03-13 16:36:49,049 [INFO]: 	avg_search_speed_ms: 10.088500523828946
2025-03-13 16:36:49,049 [INFO]: 	99p_search_speed_ms: 19.561237869784236
2025-03-13 16:36:49,049 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:49,049 [INFO]: 	nb vectors: 2720
2025-03-13 16:36:49,049 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:49,049 [INFO]: 	compression ratio: 0.9993097734432281
2025-03-13 16:36:49,049 [INFO]: }
2025-03-13 16:36:49,049 [INFO]: 	>>> Finished "Creating the index" in 57.8289 secs
2025-03-13 16:36:49,049 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8573 secs
2025-03-13 16:36:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 78662 [episode count 11/20]
[retrieval_preprocessing] for episode 38873 [episode count 12/20], we have num_retrieval=np.int64(2779) num_query=np.int64(145)
2025-03-13 16:36:52,101 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:52,654 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:52
2025-03-13 16:36:52,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.08it/s]
2025-03-13 16:36:52,691 [INFO]: There are 2779 embeddings of dim 49152
2025-03-13 16:36:52,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 16:36:52,692 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:52
2025-03-13 16:36:52,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:52,692 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:36:52,692 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:52,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:52,692 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:52
2025-03-13 16:36:52,692 [INFO]: 573.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:52,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:36:52,692 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:52
2025-03-13 16:36:52,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:52,692 [INFO]: 	Creating the index 03/13/2025, 16:36:52
2025-03-13 16:36:52,692 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:52
2025-03-13 16:36:52,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:36:52,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:52
2025-03-13 16:36:52,695 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:36:52,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.35it/s] 45%|████▌     | 5/11 [00:00<00:00, 22.78it/s] 82%|████████▏ | 9/11 [00:00<00:00, 28.26it/s]100%|██████████| 11/11 [00:03<00:00,  3.57it/s]
2025-03-13 16:36:55,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:55
2025-03-13 16:37:28,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9938 secs
2025-03-13 16:37:28,783 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:37:28,783 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.07it/s]
2025-03-13 16:37:58,190 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4073 secs
2025-03-13 16:37:58,192 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4971 secs
2025-03-13 16:37:58,192 [INFO]: {
2025-03-13 16:37:58,192 [INFO]: 	index_key: HNSW15
2025-03-13 16:37:58,192 [INFO]: 	index_param: efSearch=145
2025-03-13 16:37:58,192 [INFO]: 	index_path: knn.index
2025-03-13 16:37:58,192 [INFO]: 	size in bytes: 546750970
2025-03-13 16:37:58,192 [INFO]: 	avg_search_speed_ms: 6.52296641514687
2025-03-13 16:37:58,192 [INFO]: 	99p_search_speed_ms: 11.921280408278118
2025-03-13 16:37:58,192 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:58,192 [INFO]: 	nb vectors: 2779
2025-03-13 16:37:58,192 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:58,192 [INFO]: 	compression ratio: 0.9993098539907483
2025-03-13 16:37:58,192 [INFO]: }
2025-03-13 16:37:58,192 [INFO]: 	>>> Finished "Creating the index" in 65.5001 secs
2025-03-13 16:37:58,193 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5382 secs
2025-03-13 16:37:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 38873 [episode count 12/20]
[retrieval_preprocessing] for episode 7396 [episode count 13/20], we have num_retrieval=np.int64(2772) num_query=np.int64(152)
2025-03-13 16:37:59,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:59,596 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:59
2025-03-13 16:37:59,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1303.79it/s]
2025-03-13 16:37:59,623 [INFO]: There are 2772 embeddings of dim 49152
2025-03-13 16:37:59,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:37:59,623 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:59
2025-03-13 16:37:59,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:59,623 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:37:59,623 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:37:59,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:37:59,623 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:59
2025-03-13 16:37:59,623 [INFO]: 572.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:59,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:37:59,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:59
2025-03-13 16:37:59,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:59,623 [INFO]: 	Creating the index 03/13/2025, 16:37:59
2025-03-13 16:37:59,624 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:37:59
2025-03-13 16:37:59,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:37:59,625 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:59
2025-03-13 16:37:59,625 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:37:59,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.89it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.21it/s]100%|██████████| 11/11 [00:02<00:00,  5.23it/s]
2025-03-13 16:38:01,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:01
2025-03-13 16:38:45,714 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9827 secs
2025-03-13 16:38:45,714 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 16:38:45,714 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.06it/s]
2025-03-13 16:39:02,501 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7872 secs
2025-03-13 16:39:02,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8797 secs
2025-03-13 16:39:02,504 [INFO]: {
2025-03-13 16:39:02,505 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:02,505 [INFO]: 	index_param: efSearch=89
2025-03-13 16:39:02,505 [INFO]: 	index_path: knn.index
2025-03-13 16:39:02,505 [INFO]: 	size in bytes: 545373790
2025-03-13 16:39:02,505 [INFO]: 	avg_search_speed_ms: 6.0572456579768295
2025-03-13 16:39:02,505 [INFO]: 	99p_search_speed_ms: 11.198908309452236
2025-03-13 16:39:02,505 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:02,505 [INFO]: 	nb vectors: 2772
2025-03-13 16:39:02,505 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:02,505 [INFO]: 	compression ratio: 0.999309805482218
2025-03-13 16:39:02,505 [INFO]: }
2025-03-13 16:39:02,505 [INFO]: 	>>> Finished "Creating the index" in 62.8812 secs
2025-03-13 16:39:02,505 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9087 secs
2025-03-13 16:39:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 7396 [episode count 13/20]
[retrieval_preprocessing] for episode 37282 [episode count 14/20], we have num_retrieval=np.int64(2820) num_query=np.int64(104)
2025-03-13 16:39:03,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:05,068 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:05
2025-03-13 16:39:05,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2104.52it/s]
2025-03-13 16:39:05,102 [INFO]: There are 2820 embeddings of dim 49152
2025-03-13 16:39:05,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 16:39:05,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:05
2025-03-13 16:39:05,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:05,102 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:39:05,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:05,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:39:05,102 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:05
2025-03-13 16:39:05,102 [INFO]: 582.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:05,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:39:05,103 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:05
2025-03-13 16:39:05,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:05,103 [INFO]: 	Creating the index 03/13/2025, 16:39:05
2025-03-13 16:39:05,103 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:05
2025-03-13 16:39:05,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:39:05,104 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:05
2025-03-13 16:39:05,104 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:39:05,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.28it/s] 50%|█████     | 6/12 [00:00<00:00, 27.73it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.00it/s]100%|██████████| 12/12 [00:02<00:00,  4.48it/s]
2025-03-13 16:39:07,784 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:07
2025-03-13 16:39:45,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6012 secs
2025-03-13 16:39:45,386 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 16:39:45,386 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-13 16:40:20,612 [INFO]: 	>>> Finished "Compute fast metrics" in 35.2258 secs
2025-03-13 16:40:20,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5106 secs
2025-03-13 16:40:20,615 [INFO]: {
2025-03-13 16:40:20,615 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:20,615 [INFO]: 	index_param: efSearch=155
2025-03-13 16:40:20,615 [INFO]: 	index_path: knn.index
2025-03-13 16:40:20,615 [INFO]: 	size in bytes: 554817490
2025-03-13 16:40:20,615 [INFO]: 	avg_search_speed_ms: 6.832750102757175
2025-03-13 16:40:20,615 [INFO]: 	99p_search_speed_ms: 11.005990463308988
2025-03-13 16:40:20,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:20,615 [INFO]: 	nb vectors: 2820
2025-03-13 16:40:20,615 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:20,615 [INFO]: 	compression ratio: 0.9993098090689246
2025-03-13 16:40:20,615 [INFO]: }
2025-03-13 16:40:20,615 [INFO]: 	>>> Finished "Creating the index" in 75.5123 secs
2025-03-13 16:40:20,615 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5471 secs
2025-03-13 16:40:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 37282 [episode count 14/20]
[retrieval_preprocessing] for episode 45551 [episode count 15/20], we have num_retrieval=np.int64(2765) num_query=np.int64(159)
2025-03-13 16:40:21,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:21,984 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:21
2025-03-13 16:40:21,985 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1362.67it/s]
2025-03-13 16:40:22,014 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 16:40:22,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 16:40:22,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:22
2025-03-13 16:40:22,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:22,015 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:40:22,016 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:22,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:40:22,016 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:22
2025-03-13 16:40:22,016 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:22,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:40:22,017 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:22
2025-03-13 16:40:22,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:22,017 [INFO]: 	Creating the index 03/13/2025, 16:40:22
2025-03-13 16:40:22,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:22
2025-03-13 16:40:22,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 16:40:22,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:22
2025-03-13 16:40:22,020 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:40:22,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.79it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.59it/s]100%|██████████| 11/11 [00:02<00:00,  4.32it/s]100%|██████████| 11/11 [00:02<00:00,  5.37it/s]
2025-03-13 16:40:24,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:24
2025-03-13 16:40:51,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6129 secs
2025-03-13 16:40:51,687 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 16:40:51,687 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.28it/s]
2025-03-13 16:41:19,958 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2702 secs
2025-03-13 16:41:19,960 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9399 secs
2025-03-13 16:41:19,960 [INFO]: {
2025-03-13 16:41:19,960 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:19,960 [INFO]: 	index_param: efSearch=208
2025-03-13 16:41:19,960 [INFO]: 	index_path: knn.index
2025-03-13 16:41:19,960 [INFO]: 	size in bytes: 543996610
2025-03-13 16:41:19,960 [INFO]: 	avg_search_speed_ms: 12.254607652864127
2025-03-13 16:41:19,960 [INFO]: 	99p_search_speed_ms: 19.604733190499246
2025-03-13 16:41:19,960 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:19,960 [INFO]: 	nb vectors: 2765
2025-03-13 16:41:19,960 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:19,960 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 16:41:19,960 [INFO]: }
2025-03-13 16:41:19,960 [INFO]: 	>>> Finished "Creating the index" in 57.9433 secs
2025-03-13 16:41:19,961 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9760 secs
2025-03-13 16:41:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 45551 [episode count 15/20]
[retrieval_preprocessing] for episode 89507 [episode count 16/20], we have num_retrieval=np.int64(2781) num_query=np.int64(143)
2025-03-13 16:41:22,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:22,831 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:22
2025-03-13 16:41:22,831 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1371.14it/s]
2025-03-13 16:41:22,863 [INFO]: There are 2781 embeddings of dim 49152
2025-03-13 16:41:22,864 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 16:41:22,864 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:22
2025-03-13 16:41:22,864 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:22,864 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:41:22,865 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:22,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:41:22,865 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:22
2025-03-13 16:41:22,865 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:22,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:22,865 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:22
2025-03-13 16:41:22,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:22,866 [INFO]: 	Creating the index 03/13/2025, 16:41:22
2025-03-13 16:41:22,866 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:22
2025-03-13 16:41:22,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:41:22,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:22
2025-03-13 16:41:22,870 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:41:22,870 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.30it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.34it/s] 91%|█████████ | 10/11 [00:00<00:00, 32.65it/s]100%|██████████| 11/11 [00:03<00:00,  3.51it/s]
2025-03-13 16:41:26,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:26
2025-03-13 16:42:03,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0956 secs
2025-03-13 16:42:03,108 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 16:42:03,108 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-13 16:42:24,299 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1916 secs
2025-03-13 16:42:24,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4318 secs
2025-03-13 16:42:24,301 [INFO]: {
2025-03-13 16:42:24,301 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:24,301 [INFO]: 	index_param: efSearch=122
2025-03-13 16:42:24,301 [INFO]: 	index_path: knn.index
2025-03-13 16:42:24,301 [INFO]: 	size in bytes: 547144450
2025-03-13 16:42:24,301 [INFO]: 	avg_search_speed_ms: 6.746493931608363
2025-03-13 16:42:24,301 [INFO]: 	99p_search_speed_ms: 12.198763918131592
2025-03-13 16:42:24,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:24,301 [INFO]: 	nb vectors: 2781
2025-03-13 16:42:24,302 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:24,302 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-13 16:42:24,302 [INFO]: }
2025-03-13 16:42:24,302 [INFO]: 	>>> Finished "Creating the index" in 61.4357 secs
2025-03-13 16:42:24,302 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4706 secs
2025-03-13 16:42:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 89507 [episode count 16/20]
[retrieval_preprocessing] for episode 12795 [episode count 17/20], we have num_retrieval=np.int64(2764) num_query=np.int64(160)
2025-03-13 16:42:25,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:26,154 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:26
2025-03-13 16:42:26,154 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 16:42:26,182 [INFO]: There are 2764 embeddings of dim 49152
2025-03-13 16:42:26,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 16:42:26,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:26
2025-03-13 16:42:26,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:26,182 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:42:26,182 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:26,182 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:42:26,182 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:26
2025-03-13 16:42:26,182 [INFO]: 570.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:26,182 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:42:26,182 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:26
2025-03-13 16:42:26,182 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:26,182 [INFO]: 	Creating the index 03/13/2025, 16:42:26
2025-03-13 16:42:26,182 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:26
2025-03-13 16:42:26,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:42:26,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:26
2025-03-13 16:42:26,184 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:42:26,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.65it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.05it/s]100%|██████████| 11/11 [00:02<00:00,  3.70it/s]100%|██████████| 11/11 [00:02<00:00,  4.37it/s]
2025-03-13 16:42:28,703 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:28
2025-03-13 16:43:00,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4620 secs
2025-03-13 16:43:00,166 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 16:43:00,166 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.07it/s]
2025-03-13 16:43:37,667 [INFO]: 	>>> Finished "Compute fast metrics" in 37.5014 secs
2025-03-13 16:43:37,670 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4860 secs
2025-03-13 16:43:37,670 [INFO]: {
2025-03-13 16:43:37,670 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:37,670 [INFO]: 	index_param: efSearch=131
2025-03-13 16:43:37,670 [INFO]: 	index_path: knn.index
2025-03-13 16:43:37,670 [INFO]: 	size in bytes: 543799810
2025-03-13 16:43:37,670 [INFO]: 	avg_search_speed_ms: 8.75204594109993
2025-03-13 16:43:37,670 [INFO]: 	99p_search_speed_ms: 16.7689773067832
2025-03-13 16:43:37,670 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:37,670 [INFO]: 	nb vectors: 2764
2025-03-13 16:43:37,670 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:37,670 [INFO]: 	compression ratio: 0.9993098600016062
2025-03-13 16:43:37,670 [INFO]: }
2025-03-13 16:43:37,670 [INFO]: 	>>> Finished "Creating the index" in 71.4877 secs
2025-03-13 16:43:37,670 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5166 secs
2025-03-13 16:43:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 12795 [episode count 17/20]
[retrieval_preprocessing] for episode 89596 [episode count 18/20], we have num_retrieval=np.int64(2811) num_query=np.int64(113)
2025-03-13 16:43:38,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:39,212 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:39
2025-03-13 16:43:39,212 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.92it/s]
2025-03-13 16:43:39,248 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 16:43:39,249 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 16:43:39,249 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:39
2025-03-13 16:43:39,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:39,249 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:43:39,249 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:39,249 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:39,249 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:39
2025-03-13 16:43:39,249 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:39,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:43:39,249 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:39
2025-03-13 16:43:39,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:39,249 [INFO]: 	Creating the index 03/13/2025, 16:43:39
2025-03-13 16:43:39,249 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:39
2025-03-13 16:43:39,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:43:39,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:39
2025-03-13 16:43:39,250 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:43:39,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.53it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.70it/s] 75%|███████▌  | 9/12 [00:00<00:00, 31.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.91it/s]
2025-03-13 16:43:41,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:41
2025-03-13 16:44:15,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7107 secs
2025-03-13 16:44:15,409 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 16:44:15,409 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.12it/s]
2025-03-13 16:44:31,583 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1742 secs
2025-03-13 16:44:31,586 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3362 secs
2025-03-13 16:44:31,587 [INFO]: {
2025-03-13 16:44:31,587 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:31,587 [INFO]: 	index_param: efSearch=143
2025-03-13 16:44:31,587 [INFO]: 	index_path: knn.index
2025-03-13 16:44:31,587 [INFO]: 	size in bytes: 553046830
2025-03-13 16:44:31,587 [INFO]: 	avg_search_speed_ms: 8.518562324820682
2025-03-13 16:44:31,587 [INFO]: 	99p_search_speed_ms: 14.366920315660536
2025-03-13 16:44:31,587 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:31,587 [INFO]: 	nb vectors: 2811
2025-03-13 16:44:31,587 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:31,587 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 16:44:31,587 [INFO]: }
2025-03-13 16:44:31,587 [INFO]: 	>>> Finished "Creating the index" in 52.3379 secs
2025-03-13 16:44:31,587 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3749 secs
2025-03-13 16:44:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 89596 [episode count 18/20]
[retrieval_preprocessing] for episode 78404 [episode count 19/20], we have num_retrieval=np.int64(2796) num_query=np.int64(128)
2025-03-13 16:44:33,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:34,211 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:34
2025-03-13 16:44:34,211 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 16:44:34,242 [INFO]: There are 2796 embeddings of dim 49152
2025-03-13 16:44:34,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 16:44:34,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:34
2025-03-13 16:44:34,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:34,243 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:44:34,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:34,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:44:34,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:34
2025-03-13 16:44:34,243 [INFO]: 577.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:34,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:44:34,243 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:34
2025-03-13 16:44:34,243 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:34,243 [INFO]: 	Creating the index 03/13/2025, 16:44:34
2025-03-13 16:44:34,243 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:34
2025-03-13 16:44:34,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:44:34,244 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:34
2025-03-13 16:44:34,244 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:44:34,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.17it/s] 33%|███▎      | 4/12 [00:00<00:00, 17.01it/s] 58%|█████▊    | 7/12 [00:00<00:00, 21.60it/s] 83%|████████▎ | 10/12 [00:00<00:00, 24.58it/s]100%|██████████| 12/12 [00:03<00:00,  3.33it/s]
2025-03-13 16:44:37,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:37
2025-03-13 16:45:11,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9280 secs
2025-03-13 16:45:11,778 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 16:45:11,778 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-13 16:45:40,265 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4871 secs
2025-03-13 16:45:40,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0232 secs
2025-03-13 16:45:40,268 [INFO]: {
2025-03-13 16:45:40,268 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:40,268 [INFO]: 	index_param: efSearch=177
2025-03-13 16:45:40,268 [INFO]: 	index_path: knn.index
2025-03-13 16:45:40,268 [INFO]: 	size in bytes: 550095610
2025-03-13 16:45:40,268 [INFO]: 	avg_search_speed_ms: 8.049577793845796
2025-03-13 16:45:40,268 [INFO]: 	99p_search_speed_ms: 11.988427327014502
2025-03-13 16:45:40,268 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:40,268 [INFO]: 	nb vectors: 2796
2025-03-13 16:45:40,268 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:40,268 [INFO]: 	compression ratio: 0.9993098617892988
2025-03-13 16:45:40,268 [INFO]: }
2025-03-13 16:45:40,268 [INFO]: 	>>> Finished "Creating the index" in 66.0246 secs
2025-03-13 16:45:40,268 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0564 secs
2025-03-13 16:45:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 78404 [episode count 19/20]
2025-03-13 16:45:41: [retrieval_preprocessing] finished for -1_remove_marker_from_cup [chosen_id count 5/196]
2025-03-13 16:45:42: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_bowl [chosen_id count 6/196]
2025-03-13 16:45:42: [retrieval_preprocessing] we have num_total=2923 embedding_dim=49152
[retrieval_preprocessing] for episode 41026 [episode count 0/20], we have num_retrieval=np.int64(2711) num_query=np.int64(212)
2025-03-13 16:45:42,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:42,983 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:42
2025-03-13 16:45:42,983 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.17it/s]
2025-03-13 16:45:43,015 [INFO]: There are 2711 embeddings of dim 49152
2025-03-13 16:45:43,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 16:45:43,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:43
2025-03-13 16:45:43,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:43,015 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:45:43,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:43,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:43,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:43
2025-03-13 16:45:43,015 [INFO]: 559.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:43,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:43,015 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:43
2025-03-13 16:45:43,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:43,015 [INFO]: 	Creating the index 03/13/2025, 16:45:43
2025-03-13 16:45:43,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:43
2025-03-13 16:45:43,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:45:43,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:43
2025-03-13 16:45:43,017 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:45:43,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.36it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.21it/s]100%|██████████| 11/11 [00:02<00:00,  5.23it/s]
2025-03-13 16:45:45,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:45
2025-03-13 16:46:29,307 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1840 secs
2025-03-13 16:46:29,308 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:46:29,308 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-13 16:46:50,898 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5900 secs
2025-03-13 16:46:50,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9468 secs
2025-03-13 16:46:50,964 [INFO]: {
2025-03-13 16:46:50,964 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:50,964 [INFO]: 	index_param: efSearch=157
2025-03-13 16:46:50,964 [INFO]: 	index_path: knn.index
2025-03-13 16:46:50,964 [INFO]: 	size in bytes: 533372470
2025-03-13 16:46:50,964 [INFO]: 	avg_search_speed_ms: 8.488930298129322
2025-03-13 16:46:50,964 [INFO]: 	99p_search_speed_ms: 13.447729656472806
2025-03-13 16:46:50,964 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:50,964 [INFO]: 	nb vectors: 2711
2025-03-13 16:46:50,964 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:50,964 [INFO]: 	compression ratio: 0.9993097094043868
2025-03-13 16:46:50,964 [INFO]: }
2025-03-13 16:46:50,964 [INFO]: 	>>> Finished "Creating the index" in 67.9489 secs
2025-03-13 16:46:50,965 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9817 secs
2025-03-13 16:46:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 41026 [episode count 0/20]
[retrieval_preprocessing] for episode 90346 [episode count 1/20], we have num_retrieval=np.int64(2745) num_query=np.int64(178)
2025-03-13 16:46:52,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:52,919 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:52
2025-03-13 16:46:52,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1280.31it/s]
2025-03-13 16:46:52,946 [INFO]: There are 2745 embeddings of dim 49152
2025-03-13 16:46:52,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 16:46:52,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:52
2025-03-13 16:46:52,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:52,947 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:46:52,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:52,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:52,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:52
2025-03-13 16:46:52,947 [INFO]: 566.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:52,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:46:52,947 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:52
2025-03-13 16:46:52,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:52,947 [INFO]: 	Creating the index 03/13/2025, 16:46:52
2025-03-13 16:46:52,947 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:52
2025-03-13 16:46:52,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:46:52,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:52
2025-03-13 16:46:52,948 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:46:52,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.81it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.15it/s]100%|██████████| 11/11 [00:02<00:00,  5.16it/s]
2025-03-13 16:46:55,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:55
2025-03-13 16:47:26,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0395 secs
2025-03-13 16:47:26,126 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 16:47:26,126 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.27it/s]
2025-03-13 16:48:03,917 [INFO]: 	>>> Finished "Compute fast metrics" in 37.7914 secs
2025-03-13 16:48:03,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9721 secs
2025-03-13 16:48:03,921 [INFO]: {
2025-03-13 16:48:03,921 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:03,921 [INFO]: 	index_param: efSearch=170
2025-03-13 16:48:03,921 [INFO]: 	index_path: knn.index
2025-03-13 16:48:03,921 [INFO]: 	size in bytes: 540061630
2025-03-13 16:48:03,921 [INFO]: 	avg_search_speed_ms: 10.092430167965869
2025-03-13 16:48:03,921 [INFO]: 	99p_search_speed_ms: 19.62310974486173
2025-03-13 16:48:03,921 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:03,921 [INFO]: 	nb vectors: 2745
2025-03-13 16:48:03,921 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:03,921 [INFO]: 	compression ratio: 0.9993099491256211
2025-03-13 16:48:03,921 [INFO]: }
2025-03-13 16:48:03,921 [INFO]: 	>>> Finished "Creating the index" in 70.9739 secs
2025-03-13 16:48:03,921 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0022 secs
2025-03-13 16:48:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 90346 [episode count 1/20]
[retrieval_preprocessing] for episode 33017 [episode count 2/20], we have num_retrieval=np.int64(2824) num_query=np.int64(99)
2025-03-13 16:48:06,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:07,363 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:07
2025-03-13 16:48:07,363 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.81it/s]
2025-03-13 16:48:07,418 [INFO]: There are 2824 embeddings of dim 49152
2025-03-13 16:48:07,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0554 secs
2025-03-13 16:48:07,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:07
2025-03-13 16:48:07,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:07,419 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 16:48:07,419 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:07,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:48:07,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:07
2025-03-13 16:48:07,420 [INFO]: 582.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:07,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:48:07,420 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:07
2025-03-13 16:48:07,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:07,420 [INFO]: 	Creating the index 03/13/2025, 16:48:07
2025-03-13 16:48:07,420 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:07
2025-03-13 16:48:07,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 16:48:07,422 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:07
2025-03-13 16:48:07,422 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:48:07,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.99it/s] 42%|████▏     | 5/12 [00:00<00:00, 18.98it/s] 75%|███████▌  | 9/12 [00:00<00:00, 23.75it/s]100%|██████████| 12/12 [00:04<00:00,  2.10it/s]100%|██████████| 12/12 [00:04<00:00,  2.95it/s]
2025-03-13 16:48:11,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:11
2025-03-13 16:48:49,289 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7918 secs
2025-03-13 16:48:49,289 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 16:48:49,290 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 16:49:05,355 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0646 secs
2025-03-13 16:49:05,357 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9348 secs
2025-03-13 16:49:05,357 [INFO]: {
2025-03-13 16:49:05,357 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:05,357 [INFO]: 	index_param: efSearch=166
2025-03-13 16:49:05,357 [INFO]: 	index_path: knn.index
2025-03-13 16:49:05,357 [INFO]: 	size in bytes: 555604450
2025-03-13 16:49:05,357 [INFO]: 	avg_search_speed_ms: 9.423056852184834
2025-03-13 16:49:05,357 [INFO]: 	99p_search_speed_ms: 12.47271201573313
2025-03-13 16:49:05,357 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:05,357 [INFO]: 	nb vectors: 2824
2025-03-13 16:49:05,357 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:05,357 [INFO]: 	compression ratio: 0.9993098363413035
2025-03-13 16:49:05,357 [INFO]: }
2025-03-13 16:49:05,357 [INFO]: 	>>> Finished "Creating the index" in 57.9376 secs
2025-03-13 16:49:05,358 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9942 secs
2025-03-13 16:49:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 33017 [episode count 2/20]
[retrieval_preprocessing] for episode 33093 [episode count 3/20], we have num_retrieval=np.int64(2797) num_query=np.int64(126)
2025-03-13 16:49:06,613 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:07,110 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:07
2025-03-13 16:49:07,111 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.30it/s]
2025-03-13 16:49:07,143 [INFO]: There are 2797 embeddings of dim 49152
2025-03-13 16:49:07,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 16:49:07,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:07
2025-03-13 16:49:07,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:07,144 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:49:07,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:07,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:49:07,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:07
2025-03-13 16:49:07,144 [INFO]: 577.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:07,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:49:07,144 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:07
2025-03-13 16:49:07,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:07,144 [INFO]: 	Creating the index 03/13/2025, 16:49:07
2025-03-13 16:49:07,144 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:07
2025-03-13 16:49:07,145 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:49:07,145 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:07
2025-03-13 16:49:07,145 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:49:07,145 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.04it/s] 33%|███▎      | 4/12 [00:00<00:00, 15.91it/s] 67%|██████▋   | 8/12 [00:00<00:00, 24.03it/s]100%|██████████| 12/12 [00:02<00:00,  3.31it/s]100%|██████████| 12/12 [00:02<00:00,  4.28it/s]
2025-03-13 16:49:09,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:09
2025-03-13 16:49:42,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6820 secs
2025-03-13 16:49:42,636 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 16:49:42,636 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 16:50:15,706 [INFO]: 	>>> Finished "Compute fast metrics" in 33.0705 secs
2025-03-13 16:50:15,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5631 secs
2025-03-13 16:50:15,708 [INFO]: {
2025-03-13 16:50:15,709 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:15,709 [INFO]: 	index_param: efSearch=288
2025-03-13 16:50:15,709 [INFO]: 	index_path: knn.index
2025-03-13 16:50:15,709 [INFO]: 	size in bytes: 550292350
2025-03-13 16:50:15,709 [INFO]: 	avg_search_speed_ms: 12.297646560377428
2025-03-13 16:50:15,709 [INFO]: 	99p_search_speed_ms: 15.51384499296546
2025-03-13 16:50:15,709 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:15,709 [INFO]: 	nb vectors: 2797
2025-03-13 16:50:15,709 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:15,709 [INFO]: 	compression ratio: 0.9993098686543617
2025-03-13 16:50:15,709 [INFO]: }
2025-03-13 16:50:15,709 [INFO]: 	>>> Finished "Creating the index" in 68.5645 secs
2025-03-13 16:50:15,709 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5981 secs
2025-03-13 16:50:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 33093 [episode count 3/20]
[retrieval_preprocessing] for episode 83221 [episode count 4/20], we have num_retrieval=np.int64(2820) num_query=np.int64(103)
2025-03-13 16:50:17,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:17,876 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:17
2025-03-13 16:50:17,876 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.48it/s]
2025-03-13 16:50:17,908 [INFO]: There are 2820 embeddings of dim 49152
2025-03-13 16:50:17,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 16:50:17,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:17
2025-03-13 16:50:17,909 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:17,909 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:50:17,909 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:17,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:17,909 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:17
2025-03-13 16:50:17,909 [INFO]: 582.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:17,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:50:17,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:17
2025-03-13 16:50:17,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:17,909 [INFO]: 	Creating the index 03/13/2025, 16:50:17
2025-03-13 16:50:17,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:17
2025-03-13 16:50:17,910 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:50:17,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:17
2025-03-13 16:50:17,910 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:50:17,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.10it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.36it/s]100%|██████████| 12/12 [00:02<00:00,  4.80it/s]100%|██████████| 12/12 [00:02<00:00,  5.99it/s]
2025-03-13 16:50:20,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:20
2025-03-13 16:50:57,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7458 secs
2025-03-13 16:50:57,689 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 16:50:57,689 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 16:51:25,490 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8018 secs
2025-03-13 16:51:25,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5829 secs
2025-03-13 16:51:25,493 [INFO]: {
2025-03-13 16:51:25,493 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:25,493 [INFO]: 	index_param: efSearch=190
2025-03-13 16:51:25,493 [INFO]: 	index_path: knn.index
2025-03-13 16:51:25,493 [INFO]: 	size in bytes: 554817490
2025-03-13 16:51:25,493 [INFO]: 	avg_search_speed_ms: 9.938075909137385
2025-03-13 16:51:25,493 [INFO]: 	99p_search_speed_ms: 13.887482730206106
2025-03-13 16:51:25,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:25,493 [INFO]: 	nb vectors: 2820
2025-03-13 16:51:25,493 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:25,493 [INFO]: 	compression ratio: 0.9993098090689246
2025-03-13 16:51:25,493 [INFO]: }
2025-03-13 16:51:25,493 [INFO]: 	>>> Finished "Creating the index" in 67.5846 secs
2025-03-13 16:51:25,494 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6175 secs
2025-03-13 16:51:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 83221 [episode count 4/20]
[retrieval_preprocessing] for episode 11054 [episode count 5/20], we have num_retrieval=np.int64(2806) num_query=np.int64(117)
2025-03-13 16:51:26,943 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:27,458 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:27
2025-03-13 16:51:27,459 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.53it/s]
2025-03-13 16:51:27,491 [INFO]: There are 2806 embeddings of dim 49152
2025-03-13 16:51:27,492 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 16:51:27,492 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:27
2025-03-13 16:51:27,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:27,493 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:51:27,493 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:27,493 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:51:27,493 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:27
2025-03-13 16:51:27,493 [INFO]: 579.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:27,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:51:27,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:27
2025-03-13 16:51:27,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:27,494 [INFO]: 	Creating the index 03/13/2025, 16:51:27
2025-03-13 16:51:27,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:27
2025-03-13 16:51:27,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 16:51:27,499 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:27
2025-03-13 16:51:27,499 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:51:27,499 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 15.54it/s] 50%|█████     | 6/12 [00:00<00:00, 25.77it/s] 83%|████████▎ | 10/12 [00:00<00:00, 29.54it/s]100%|██████████| 12/12 [00:02<00:00,  4.60it/s]
2025-03-13 16:51:30,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:30
2025-03-13 16:52:07,543 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4313 secs
2025-03-13 16:52:07,544 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 16:52:07,544 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s]
2025-03-13 16:52:30,055 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5105 secs
2025-03-13 16:52:30,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5588 secs
2025-03-13 16:52:30,058 [INFO]: {
2025-03-13 16:52:30,058 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:30,058 [INFO]: 	index_param: efSearch=156
2025-03-13 16:52:30,058 [INFO]: 	index_path: knn.index
2025-03-13 16:52:30,058 [INFO]: 	size in bytes: 552063130
2025-03-13 16:52:30,058 [INFO]: 	avg_search_speed_ms: 10.280982464387293
2025-03-13 16:52:30,058 [INFO]: 	99p_search_speed_ms: 15.873543294146655
2025-03-13 16:52:30,058 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:30,058 [INFO]: 	nb vectors: 2806
2025-03-13 16:52:30,058 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:30,058 [INFO]: 	compression ratio: 0.9993097130032936
2025-03-13 16:52:30,058 [INFO]: }
2025-03-13 16:52:30,058 [INFO]: 	>>> Finished "Creating the index" in 62.5636 secs
2025-03-13 16:52:30,058 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5996 secs
2025-03-13 16:52:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 11054 [episode count 5/20]
[retrieval_preprocessing] for episode 33536 [episode count 6/20], we have num_retrieval=np.int64(2824) num_query=np.int64(99)
2025-03-13 16:52:31,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:32,471 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:32
2025-03-13 16:52:32,472 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 921.22it/s]
2025-03-13 16:52:32,504 [INFO]: There are 2824 embeddings of dim 49152
2025-03-13 16:52:32,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 16:52:32,505 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:32
2025-03-13 16:52:32,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:32,505 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 16:52:32,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:32,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:52:32,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:32
2025-03-13 16:52:32,506 [INFO]: 582.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:32,507 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:52:32,507 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:32
2025-03-13 16:52:32,507 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:32,507 [INFO]: 	Creating the index 03/13/2025, 16:52:32
2025-03-13 16:52:32,507 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:32
2025-03-13 16:52:32,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:52:32,511 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:32
2025-03-13 16:52:32,511 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:52:32,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.32it/s] 50%|█████     | 6/12 [00:00<00:00, 29.62it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.58it/s]100%|██████████| 12/12 [00:03<00:00,  3.96it/s]
2025-03-13 16:52:35,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:35
2025-03-13 16:53:05,744 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1946 secs
2025-03-13 16:53:05,744 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 16:53:05,744 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.19it/s]
2025-03-13 16:53:34,147 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4024 secs
2025-03-13 16:53:34,149 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6382 secs
2025-03-13 16:53:34,149 [INFO]: {
2025-03-13 16:53:34,149 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:34,149 [INFO]: 	index_param: efSearch=222
2025-03-13 16:53:34,149 [INFO]: 	index_path: knn.index
2025-03-13 16:53:34,149 [INFO]: 	size in bytes: 555604450
2025-03-13 16:53:34,149 [INFO]: 	avg_search_speed_ms: 11.895427668044137
2025-03-13 16:53:34,149 [INFO]: 	99p_search_speed_ms: 19.43037039600313
2025-03-13 16:53:34,149 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:34,149 [INFO]: 	nb vectors: 2824
2025-03-13 16:53:34,149 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:34,149 [INFO]: 	compression ratio: 0.9993098363413035
2025-03-13 16:53:34,149 [INFO]: }
2025-03-13 16:53:34,149 [INFO]: 	>>> Finished "Creating the index" in 61.6419 secs
2025-03-13 16:53:34,149 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6777 secs
2025-03-13 16:53:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 33536 [episode count 6/20]
[retrieval_preprocessing] for episode 67424 [episode count 7/20], we have num_retrieval=np.int64(2677) num_query=np.int64(246)
2025-03-13 16:53:35,216 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:35,579 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:35
2025-03-13 16:53:35,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.82it/s]
2025-03-13 16:53:35,608 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 16:53:35,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 16:53:35,608 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:35
2025-03-13 16:53:35,608 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:35,608 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:53:35,608 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:35,608 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:35,608 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:35
2025-03-13 16:53:35,608 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:35,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:53:35,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:35
2025-03-13 16:53:35,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:35,609 [INFO]: 	Creating the index 03/13/2025, 16:53:35
2025-03-13 16:53:35,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:35
2025-03-13 16:53:35,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:53:35,610 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:35
2025-03-13 16:53:35,610 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:53:35,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.02it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.02it/s]100%|██████████| 11/11 [00:02<00:00,  4.23it/s]100%|██████████| 11/11 [00:02<00:00,  5.23it/s]
2025-03-13 16:53:37,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:37
2025-03-13 16:54:10,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4137 secs
2025-03-13 16:54:10,128 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 16:54:10,129 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 16:54:27,720 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5910 secs
2025-03-13 16:54:27,722 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1123 secs
2025-03-13 16:54:27,722 [INFO]: {
2025-03-13 16:54:27,722 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:27,722 [INFO]: 	index_param: efSearch=143
2025-03-13 16:54:27,722 [INFO]: 	index_path: knn.index
2025-03-13 16:54:27,722 [INFO]: 	size in bytes: 526683190
2025-03-13 16:54:27,722 [INFO]: 	avg_search_speed_ms: 10.359415080683695
2025-03-13 16:54:27,722 [INFO]: 	99p_search_speed_ms: 19.165566330775622
2025-03-13 16:54:27,722 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:27,722 [INFO]: 	nb vectors: 2677
2025-03-13 16:54:27,722 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:27,722 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 16:54:27,722 [INFO]: }
2025-03-13 16:54:27,722 [INFO]: 	>>> Finished "Creating the index" in 52.1137 secs
2025-03-13 16:54:27,722 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1430 secs
2025-03-13 16:54:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 67424 [episode count 7/20]
[retrieval_preprocessing] for episode 1969 [episode count 8/20], we have num_retrieval=np.int64(2790) num_query=np.int64(133)
2025-03-13 16:54:31,132 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:31,631 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:31
2025-03-13 16:54:31,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2106.63it/s]
2025-03-13 16:54:31,664 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 16:54:31,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 16:54:31,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:31,664 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:54:31,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:31,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:31,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,664 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:31,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:54:31,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:31
2025-03-13 16:54:31,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:31,664 [INFO]: 	Creating the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:31
2025-03-13 16:54:31,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:54:31,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,665 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:54:31,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.54it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.05it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.95it/s]100%|██████████| 11/11 [00:02<00:00,  5.11it/s]
2025-03-13 16:54:33,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:33
2025-03-13 16:55:12,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3744 secs
2025-03-13 16:55:12,199 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:55:12,199 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.33it/s]
2025-03-13 16:55:33,797 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5984 secs
2025-03-13 16:55:33,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1336 secs
2025-03-13 16:55:33,799 [INFO]: {
2025-03-13 16:55:33,799 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:33,799 [INFO]: 	index_param: efSearch=197
2025-03-13 16:55:33,799 [INFO]: 	index_path: knn.index
2025-03-13 16:55:33,799 [INFO]: 	size in bytes: 548915110
2025-03-13 16:55:33,799 [INFO]: 	avg_search_speed_ms: 9.542567103360033
2025-03-13 16:55:33,799 [INFO]: 	99p_search_speed_ms: 13.502451614476739
2025-03-13 16:55:33,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:33,799 [INFO]: 	nb vectors: 2790
2025-03-13 16:55:33,799 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:33,799 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 16:55:33,799 [INFO]: }
2025-03-13 16:55:33,799 [INFO]: 	>>> Finished "Creating the index" in 62.1350 secs
2025-03-13 16:55:33,799 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1682 secs
2025-03-13 16:55:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 1969 [episode count 8/20]
[retrieval_preprocessing] for episode 59772 [episode count 9/20], we have num_retrieval=np.int64(2728) num_query=np.int64(195)
2025-03-13 16:55:35,101 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:35,538 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:35
2025-03-13 16:55:35,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2221.56it/s]
2025-03-13 16:55:35,564 [INFO]: There are 2728 embeddings of dim 49152
2025-03-13 16:55:35,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:55:35,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:35
2025-03-13 16:55:35,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:35,565 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:55:35,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:35,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:55:35,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:35
2025-03-13 16:55:35,565 [INFO]: 563.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:35,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:55:35,565 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:35
2025-03-13 16:55:35,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:35,565 [INFO]: 	Creating the index 03/13/2025, 16:55:35
2025-03-13 16:55:35,565 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:35
2025-03-13 16:55:35,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:55:35,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:35
2025-03-13 16:55:35,566 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:55:35,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.17it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.51it/s]100%|██████████| 11/11 [00:02<00:00,  5.46it/s]
2025-03-13 16:55:37,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:37
2025-03-13 16:56:07,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6341 secs
2025-03-13 16:56:07,220 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 16:56:07,220 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.78it/s]
2025-03-13 16:56:47,303 [INFO]: 	>>> Finished "Compute fast metrics" in 40.0831 secs
2025-03-13 16:56:47,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7393 secs
2025-03-13 16:56:47,306 [INFO]: {
2025-03-13 16:56:47,306 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:47,306 [INFO]: 	index_param: efSearch=262
2025-03-13 16:56:47,306 [INFO]: 	index_path: knn.index
2025-03-13 16:56:47,306 [INFO]: 	size in bytes: 536717050
2025-03-13 16:56:47,306 [INFO]: 	avg_search_speed_ms: 11.361738619796762
2025-03-13 16:56:47,306 [INFO]: 	99p_search_speed_ms: 13.735089658293873
2025-03-13 16:56:47,306 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:47,306 [INFO]: 	nb vectors: 2728
2025-03-13 16:56:47,306 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:47,306 [INFO]: 	compression ratio: 0.9993098300119215
2025-03-13 16:56:47,306 [INFO]: }
2025-03-13 16:56:47,306 [INFO]: 	>>> Finished "Creating the index" in 71.7407 secs
2025-03-13 16:56:47,306 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7674 secs
2025-03-13 16:56:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 59772 [episode count 9/20]
[retrieval_preprocessing] for episode 10667 [episode count 10/20], we have num_retrieval=np.int64(2828) num_query=np.int64(95)
2025-03-13 16:56:49,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:50,161 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:50
2025-03-13 16:56:50,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2025.26it/s]
2025-03-13 16:56:50,196 [INFO]: There are 2828 embeddings of dim 49152
2025-03-13 16:56:50,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 16:56:50,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:50
2025-03-13 16:56:50,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:50,196 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 16:56:50,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:50,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:56:50,197 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:50
2025-03-13 16:56:50,197 [INFO]: 583.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:50,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:56:50,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:50
2025-03-13 16:56:50,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:50,197 [INFO]: 	Creating the index 03/13/2025, 16:56:50
2025-03-13 16:56:50,197 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:50
2025-03-13 16:56:50,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:56:50,198 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:50
2025-03-13 16:56:50,198 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:56:50,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.77it/s] 33%|███▎      | 4/12 [00:00<00:00, 19.96it/s] 58%|█████▊    | 7/12 [00:00<00:00, 24.11it/s] 83%|████████▎ | 10/12 [00:00<00:00, 26.32it/s]100%|██████████| 12/12 [00:02<00:00,  5.04it/s]
2025-03-13 16:56:52,582 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:52
2025-03-13 16:57:36,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5126 secs
2025-03-13 16:57:36,095 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 16:57:36,095 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.27it/s]
2025-03-13 16:57:57,239 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1433 secs
2025-03-13 16:57:57,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0434 secs
2025-03-13 16:57:57,241 [INFO]: {
2025-03-13 16:57:57,241 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:57,241 [INFO]: 	index_param: efSearch=134
2025-03-13 16:57:57,242 [INFO]: 	index_path: knn.index
2025-03-13 16:57:57,242 [INFO]: 	size in bytes: 556391470
2025-03-13 16:57:57,242 [INFO]: 	avg_search_speed_ms: 9.146633340056034
2025-03-13 16:57:57,242 [INFO]: 	99p_search_speed_ms: 13.990532439202063
2025-03-13 16:57:57,242 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:57,242 [INFO]: 	nb vectors: 2828
2025-03-13 16:57:57,242 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:57,242 [INFO]: 	compression ratio: 0.9993097557732149
2025-03-13 16:57:57,242 [INFO]: }
2025-03-13 16:57:57,242 [INFO]: 	>>> Finished "Creating the index" in 67.0448 secs
2025-03-13 16:57:57,242 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0801 secs
2025-03-13 16:57:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 10667 [episode count 10/20]
[retrieval_preprocessing] for episode 76313 [episode count 11/20], we have num_retrieval=np.int64(2788) num_query=np.int64(135)
2025-03-13 16:57:58,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:58,818 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:58
2025-03-13 16:57:58,818 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1385.17it/s]
2025-03-13 16:57:58,846 [INFO]: There are 2788 embeddings of dim 49152
2025-03-13 16:57:58,846 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 16:57:58,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:58
2025-03-13 16:57:58,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:58,847 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:57:58,847 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:58,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:58,847 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:58
2025-03-13 16:57:58,847 [INFO]: 575.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:58,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:57:58,847 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:58
2025-03-13 16:57:58,847 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:58,847 [INFO]: 	Creating the index 03/13/2025, 16:57:58
2025-03-13 16:57:58,847 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:58
2025-03-13 16:57:58,848 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:57:58,848 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:58
2025-03-13 16:57:58,848 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:57:58,848 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.05it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.48it/s]100%|██████████| 11/11 [00:02<00:00,  3.63it/s]100%|██████████| 11/11 [00:02<00:00,  4.27it/s]
2025-03-13 16:58:01,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:01
2025-03-13 16:58:37,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7821 secs
2025-03-13 16:58:37,212 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:58:37,212 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 16:58:59,525 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3128 secs
2025-03-13 16:58:59,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6794 secs
2025-03-13 16:58:59,528 [INFO]: {
2025-03-13 16:58:59,528 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:59,528 [INFO]: 	index_param: efSearch=237
2025-03-13 16:58:59,528 [INFO]: 	index_path: knn.index
2025-03-13 16:58:59,528 [INFO]: 	size in bytes: 548521630
2025-03-13 16:58:59,528 [INFO]: 	avg_search_speed_ms: 11.524978781833575
2025-03-13 16:58:59,528 [INFO]: 	99p_search_speed_ms: 14.520087405107917
2025-03-13 16:58:59,528 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:59,528 [INFO]: 	nb vectors: 2788
2025-03-13 16:58:59,528 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:59,528 [INFO]: 	compression ratio: 0.9993099160009424
2025-03-13 16:58:59,528 [INFO]: }
2025-03-13 16:58:59,528 [INFO]: 	>>> Finished "Creating the index" in 60.6810 secs
2025-03-13 16:58:59,528 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7097 secs
2025-03-13 16:59:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 76313 [episode count 11/20]
[retrieval_preprocessing] for episode 94717 [episode count 12/20], we have num_retrieval=np.int64(2770) num_query=np.int64(153)
2025-03-13 16:59:02,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:02,860 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:02
2025-03-13 16:59:02,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 796.79it/s]
2025-03-13 16:59:02,896 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 16:59:02,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 16:59:02,897 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:02
2025-03-13 16:59:02,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:02,897 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:59:02,897 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:02,897 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:59:02,898 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:02
2025-03-13 16:59:02,898 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:02,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:59:02,899 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:02
2025-03-13 16:59:02,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:02,899 [INFO]: 	Creating the index 03/13/2025, 16:59:02
2025-03-13 16:59:02,899 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:02
2025-03-13 16:59:02,903 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 16:59:02,903 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:02
2025-03-13 16:59:02,903 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:59:02,904 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.79it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.29it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.50it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.66it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.76it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.87it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.86it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.86it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.23it/s]100%|██████████| 11/11 [00:03<00:00,  1.31it/s]100%|██████████| 11/11 [00:03<00:00,  3.13it/s]
2025-03-13 16:59:06,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:06
2025-03-13 16:59:44,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6292 secs
2025-03-13 16:59:44,062 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:59:44,063 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 17:00:06,875 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8124 secs
2025-03-13 17:00:06,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9752 secs
2025-03-13 17:00:06,879 [INFO]: {
2025-03-13 17:00:06,879 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:06,879 [INFO]: 	index_param: efSearch=193
2025-03-13 17:00:06,879 [INFO]: 	index_path: knn.index
2025-03-13 17:00:06,879 [INFO]: 	size in bytes: 544980310
2025-03-13 17:00:06,879 [INFO]: 	avg_search_speed_ms: 11.978668266695417
2025-03-13 17:00:06,879 [INFO]: 	99p_search_speed_ms: 25.815791208296993
2025-03-13 17:00:06,879 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:06,879 [INFO]: 	nb vectors: 2770
2025-03-13 17:00:06,879 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:06,879 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 17:00:06,879 [INFO]: }
2025-03-13 17:00:06,879 [INFO]: 	>>> Finished "Creating the index" in 63.9799 secs
2025-03-13 17:00:06,879 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0187 secs
2025-03-13 17:00:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 94717 [episode count 12/20]
[retrieval_preprocessing] for episode 12829 [episode count 13/20], we have num_retrieval=np.int64(2827) num_query=np.int64(96)
2025-03-13 17:00:08,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:09,226 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:09
2025-03-13 17:00:09,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.49it/s]
2025-03-13 17:00:09,259 [INFO]: There are 2827 embeddings of dim 49152
2025-03-13 17:00:09,259 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 17:00:09,259 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:09
2025-03-13 17:00:09,259 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:09,259 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:00:09,259 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:09,259 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:09,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:09
2025-03-13 17:00:09,259 [INFO]: 583.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:09,259 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:00:09,259 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:09
2025-03-13 17:00:09,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:09,260 [INFO]: 	Creating the index 03/13/2025, 17:00:09
2025-03-13 17:00:09,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:09
2025-03-13 17:00:09,261 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:00:09,261 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:09
2025-03-13 17:00:09,261 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:00:09,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.89it/s] 25%|██▌       | 3/12 [00:00<00:00, 11.69it/s] 42%|████▏     | 5/12 [00:00<00:00, 12.40it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.08it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.87it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.48it/s]100%|██████████| 12/12 [00:03<00:00,  3.69it/s]
2025-03-13 17:00:12,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:12
2025-03-13 17:00:50,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0409 secs
2025-03-13 17:00:50,561 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 17:00:50,561 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 17:01:20,780 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2184 secs
2025-03-13 17:01:20,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5219 secs
2025-03-13 17:01:20,783 [INFO]: {
2025-03-13 17:01:20,783 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:20,783 [INFO]: 	index_param: efSearch=290
2025-03-13 17:01:20,783 [INFO]: 	index_path: knn.index
2025-03-13 17:01:20,783 [INFO]: 	size in bytes: 556194730
2025-03-13 17:01:20,783 [INFO]: 	avg_search_speed_ms: 13.770605510898632
2025-03-13 17:01:20,783 [INFO]: 	99p_search_speed_ms: 21.136820199899375
2025-03-13 17:01:20,783 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:20,783 [INFO]: 	nb vectors: 2827
2025-03-13 17:01:20,783 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:20,783 [INFO]: 	compression ratio: 0.999309748943504
2025-03-13 17:01:20,783 [INFO]: }
2025-03-13 17:01:20,783 [INFO]: 	>>> Finished "Creating the index" in 71.5238 secs
2025-03-13 17:01:20,783 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5570 secs
2025-03-13 17:01:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 12829 [episode count 13/20]
[retrieval_preprocessing] for episode 30242 [episode count 14/20], we have num_retrieval=np.int64(2761) num_query=np.int64(162)
2025-03-13 17:01:23,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:23,717 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:23
2025-03-13 17:01:23,717 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.86it/s]
2025-03-13 17:01:23,743 [INFO]: There are 2761 embeddings of dim 49152
2025-03-13 17:01:23,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:01:23,743 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:23,743 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:01:23,743 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:23,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:01:23,743 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,743 [INFO]: 569.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:23,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:01:23,743 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:23
2025-03-13 17:01:23,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:23,743 [INFO]: 	Creating the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,743 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:23
2025-03-13 17:01:23,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:01:23,744 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,745 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:01:23,745 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.76it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.86it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.92it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.52it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.78it/s]100%|██████████| 11/11 [00:02<00:00,  2.48it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-13 17:01:27,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:27
2025-03-13 17:01:56,615 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5935 secs
2025-03-13 17:01:56,615 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 17:01:56,615 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 17:02:22,290 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6750 secs
2025-03-13 17:02:22,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5481 secs
2025-03-13 17:02:22,293 [INFO]: {
2025-03-13 17:02:22,293 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:22,293 [INFO]: 	index_param: efSearch=284
2025-03-13 17:02:22,293 [INFO]: 	index_path: knn.index
2025-03-13 17:02:22,293 [INFO]: 	size in bytes: 543209530
2025-03-13 17:02:22,293 [INFO]: 	avg_search_speed_ms: 14.392292201720018
2025-03-13 17:02:22,293 [INFO]: 	99p_search_speed_ms: 19.81683151330798
2025-03-13 17:02:22,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:22,293 [INFO]: 	nb vectors: 2761
2025-03-13 17:02:22,293 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:22,293 [INFO]: 	compression ratio: 0.9993099495143246
2025-03-13 17:02:22,293 [INFO]: }
2025-03-13 17:02:22,293 [INFO]: 	>>> Finished "Creating the index" in 58.5496 secs
2025-03-13 17:02:22,293 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5759 secs
2025-03-13 17:02:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 30242 [episode count 14/20]
[retrieval_preprocessing] for episode 31807 [episode count 15/20], we have num_retrieval=np.int64(2762) num_query=np.int64(161)
2025-03-13 17:02:26,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:26,699 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:26
2025-03-13 17:02:26,699 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 656.49it/s]
2025-03-13 17:02:26,732 [INFO]: There are 2762 embeddings of dim 49152
2025-03-13 17:02:26,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 17:02:26,733 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:26
2025-03-13 17:02:26,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:26,733 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:02:26,733 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:26,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:02:26,734 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:26
2025-03-13 17:02:26,734 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:26,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:02:26,734 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:26
2025-03-13 17:02:26,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:26,734 [INFO]: 	Creating the index 03/13/2025, 17:02:26
2025-03-13 17:02:26,734 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:26
2025-03-13 17:02:26,736 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:02:26,737 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:26
2025-03-13 17:02:26,737 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:02:26,737 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.80it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.56it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.33it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.78it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.11it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.34it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.67it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.86it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.99it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.13it/s]100%|██████████| 11/11 [00:04<00:00,  1.14s/it]100%|██████████| 11/11 [00:04<00:00,  2.35it/s]
2025-03-13 17:02:31,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:31
2025-03-13 17:03:09,846 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4143 secs
2025-03-13 17:03:09,847 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 17:03:09,847 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s]
2025-03-13 17:03:36,020 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1729 secs
2025-03-13 17:03:36,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2855 secs
2025-03-13 17:03:36,022 [INFO]: {
2025-03-13 17:03:36,022 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:36,022 [INFO]: 	index_param: efSearch=190
2025-03-13 17:03:36,022 [INFO]: 	index_path: knn.index
2025-03-13 17:03:36,022 [INFO]: 	size in bytes: 543406270
2025-03-13 17:03:36,022 [INFO]: 	avg_search_speed_ms: 8.770614129229726
2025-03-13 17:03:36,022 [INFO]: 	99p_search_speed_ms: 11.843549064360559
2025-03-13 17:03:36,022 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:36,022 [INFO]: 	nb vectors: 2762
2025-03-13 17:03:36,022 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:36,023 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-13 17:03:36,023 [INFO]: }
2025-03-13 17:03:36,023 [INFO]: 	>>> Finished "Creating the index" in 69.2882 secs
2025-03-13 17:03:36,023 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3234 secs
2025-03-13 17:03:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 31807 [episode count 15/20]
[retrieval_preprocessing] for episode 80920 [episode count 16/20], we have num_retrieval=np.int64(2817) num_query=np.int64(106)
2025-03-13 17:03:38,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:38,737 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:38
2025-03-13 17:03:38,738 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.25it/s]
2025-03-13 17:03:38,765 [INFO]: There are 2817 embeddings of dim 49152
2025-03-13 17:03:38,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:03:38,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:38
2025-03-13 17:03:38,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:38,767 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:03:38,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:38,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:03:38,768 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:38
2025-03-13 17:03:38,768 [INFO]: 581.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:38,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:03:38,768 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:38
2025-03-13 17:03:38,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:38,769 [INFO]: 	Creating the index 03/13/2025, 17:03:38
2025-03-13 17:03:38,769 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:38
2025-03-13 17:03:38,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:03:38,773 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:38
2025-03-13 17:03:38,773 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:03:38,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.34it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.78it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.35it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.58it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.85it/s] 50%|█████     | 6/12 [00:00<00:00,  8.27it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.44it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.43it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.45it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.45it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.55it/s]100%|██████████| 12/12 [00:03<00:00,  1.47it/s]100%|██████████| 12/12 [00:03<00:00,  3.59it/s]
2025-03-13 17:03:42,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:42
2025-03-13 17:04:13,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9432 secs
2025-03-13 17:04:13,064 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:04:13,064 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s]
2025-03-13 17:04:31,731 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6676 secs
2025-03-13 17:04:31,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9609 secs
2025-03-13 17:04:31,734 [INFO]: {
2025-03-13 17:04:31,734 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:31,734 [INFO]: 	index_param: efSearch=251
2025-03-13 17:04:31,734 [INFO]: 	index_path: knn.index
2025-03-13 17:04:31,734 [INFO]: 	size in bytes: 554227270
2025-03-13 17:04:31,734 [INFO]: 	avg_search_speed_ms: 12.885238200584523
2025-03-13 17:04:31,734 [INFO]: 	99p_search_speed_ms: 18.672520818654448
2025-03-13 17:04:31,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:31,734 [INFO]: 	nb vectors: 2817
2025-03-13 17:04:31,734 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:31,734 [INFO]: 	compression ratio: 0.9993097885638142
2025-03-13 17:04:31,734 [INFO]: }
2025-03-13 17:04:31,734 [INFO]: 	>>> Finished "Creating the index" in 52.9653 secs
2025-03-13 17:04:31,734 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9964 secs
2025-03-13 17:04:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 80920 [episode count 16/20]
[retrieval_preprocessing] for episode 62316 [episode count 17/20], we have num_retrieval=np.int64(2755) num_query=np.int64(168)
2025-03-13 17:04:34,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:34,958 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:34
2025-03-13 17:04:34,958 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.84it/s]
2025-03-13 17:04:34,987 [INFO]: There are 2755 embeddings of dim 49152
2025-03-13 17:04:34,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:04:34,987 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:34
2025-03-13 17:04:34,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:34,987 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:04:34,987 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:34,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:34,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:34
2025-03-13 17:04:34,988 [INFO]: 568.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:34,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:04:34,988 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:34
2025-03-13 17:04:34,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:34,988 [INFO]: 	Creating the index 03/13/2025, 17:04:34
2025-03-13 17:04:34,988 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:34
2025-03-13 17:04:34,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:04:34,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:34
2025-03-13 17:04:34,989 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:04:34,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.03it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.13it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.98it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.17it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.32it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.34it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.89it/s]100%|██████████| 11/11 [00:03<00:00,  1.69it/s]100%|██████████| 11/11 [00:03<00:00,  3.44it/s]
2025-03-13 17:04:38,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:38
2025-03-13 17:05:08,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2317 secs
2025-03-13 17:05:08,431 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 17:05:08,431 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 17:05:46,957 [INFO]: 	>>> Finished "Compute fast metrics" in 38.5259 secs
2025-03-13 17:05:46,961 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9719 secs
2025-03-13 17:05:46,961 [INFO]: {
2025-03-13 17:05:46,961 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:46,961 [INFO]: 	index_param: efSearch=276
2025-03-13 17:05:46,961 [INFO]: 	index_path: knn.index
2025-03-13 17:05:46,962 [INFO]: 	size in bytes: 542029030
2025-03-13 17:05:46,962 [INFO]: 	avg_search_speed_ms: 12.757667966367563
2025-03-13 17:05:46,962 [INFO]: 	99p_search_speed_ms: 15.74150497326627
2025-03-13 17:05:46,962 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:46,962 [INFO]: 	nb vectors: 2755
2025-03-13 17:05:46,962 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:46,962 [INFO]: 	compression ratio: 0.9993100185058353
2025-03-13 17:05:46,962 [INFO]: }
2025-03-13 17:05:46,962 [INFO]: 	>>> Finished "Creating the index" in 71.9738 secs
2025-03-13 17:05:46,962 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0039 secs
2025-03-13 17:05:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 62316 [episode count 17/20]
[retrieval_preprocessing] for episode 70282 [episode count 18/20], we have num_retrieval=np.int64(2753) num_query=np.int64(170)
2025-03-13 17:05:50,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:51,090 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:51
2025-03-13 17:05:51,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.62it/s]
2025-03-13 17:05:51,120 [INFO]: There are 2753 embeddings of dim 49152
2025-03-13 17:05:51,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:05:51,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:51,121 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:05:51,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:51,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:05:51,122 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,122 [INFO]: 568.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:51,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:05:51,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:51
2025-03-13 17:05:51,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:51,123 [INFO]: 	Creating the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:51
2025-03-13 17:05:51,126 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:05:51,127 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:51
2025-03-13 17:05:51,127 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:05:51,127 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.46it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.38it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.92it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.69it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.17it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.41it/s]100%|██████████| 11/11 [00:03<00:00,  3.15it/s]
2025-03-13 17:05:54,638 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:54
2025-03-13 17:06:31,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3411 secs
2025-03-13 17:06:31,981 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:06:31,981 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 17:06:56,806 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8251 secs
2025-03-13 17:06:56,809 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6817 secs
2025-03-13 17:06:56,809 [INFO]: {
2025-03-13 17:06:56,809 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:56,809 [INFO]: 	index_param: efSearch=227
2025-03-13 17:06:56,809 [INFO]: 	index_path: knn.index
2025-03-13 17:06:56,809 [INFO]: 	size in bytes: 541635550
2025-03-13 17:06:56,809 [INFO]: 	avg_search_speed_ms: 16.73068083125014
2025-03-13 17:06:56,809 [INFO]: 	99p_search_speed_ms: 24.75735230604186
2025-03-13 17:06:56,809 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:56,809 [INFO]: 	nb vectors: 2753
2025-03-13 17:06:56,809 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:56,809 [INFO]: 	compression ratio: 0.9993100046701144
2025-03-13 17:06:56,809 [INFO]: }
2025-03-13 17:06:56,809 [INFO]: 	>>> Finished "Creating the index" in 65.6859 secs
2025-03-13 17:06:56,809 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7187 secs
2025-03-13 17:06:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 70282 [episode count 18/20]
[retrieval_preprocessing] for episode 87216 [episode count 19/20], we have num_retrieval=np.int64(2754) num_query=np.int64(169)
2025-03-13 17:06:58,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:59,517 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:59
2025-03-13 17:06:59,517 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.50it/s]
2025-03-13 17:06:59,553 [INFO]: There are 2754 embeddings of dim 49152
2025-03-13 17:06:59,553 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 17:06:59,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:59
2025-03-13 17:06:59,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:59,554 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:06:59,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:59,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:06:59,555 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:59
2025-03-13 17:06:59,555 [INFO]: 568.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:59,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:06:59,555 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:59
2025-03-13 17:06:59,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:59,556 [INFO]: 	Creating the index 03/13/2025, 17:06:59
2025-03-13 17:06:59,556 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:59
2025-03-13 17:06:59,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:06:59,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:59
2025-03-13 17:06:59,560 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:06:59,561 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.37it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.44it/s] 91%|█████████ | 10/11 [00:00<00:00, 32.04it/s]100%|██████████| 11/11 [00:03<00:00,  3.27it/s]
2025-03-13 17:07:02,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:02
2025-03-13 17:07:38,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9293 secs
2025-03-13 17:07:38,861 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 17:07:38,861 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.78it/s]
2025-03-13 17:08:10,333 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4718 secs
2025-03-13 17:08:10,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7753 secs
2025-03-13 17:08:10,336 [INFO]: {
2025-03-13 17:08:10,336 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:10,336 [INFO]: 	index_param: efSearch=292
2025-03-13 17:08:10,336 [INFO]: 	index_path: knn.index
2025-03-13 17:08:10,336 [INFO]: 	size in bytes: 541832290
2025-03-13 17:08:10,336 [INFO]: 	avg_search_speed_ms: 14.174245573941713
2025-03-13 17:08:10,336 [INFO]: 	99p_search_speed_ms: 21.97115469025449
2025-03-13 17:08:10,336 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:10,336 [INFO]: 	nb vectors: 2754
2025-03-13 17:08:10,336 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:10,336 [INFO]: 	compression ratio: 0.9993100115904868
2025-03-13 17:08:10,336 [INFO]: }
2025-03-13 17:08:10,336 [INFO]: 	>>> Finished "Creating the index" in 70.7800 secs
2025-03-13 17:08:10,336 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8189 secs
2025-03-13 17:08:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 87216 [episode count 19/20]
2025-03-13 17:08:12: [retrieval_preprocessing] finished for -1_remove_marker_from_bowl [chosen_id count 6/196]
2025-03-13 17:08:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for -1_remove_marker_from_pot [chosen_id count 7/196]
2025-03-13 17:08:13: [retrieval_preprocessing] we have num_total=3894 embedding_dim=49152
2025-03-13 17:08:13: [retrieval_preprocessing] skipping episode 41026 [episode count 0/20]
2025-03-13 17:08:13: [retrieval_preprocessing] skipping episode 90346 [episode count 1/20]
[retrieval_preprocessing] for episode 49387 [episode count 2/20], we have num_retrieval=np.int64(3683) num_query=np.int64(211)
2025-03-13 17:08:14,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:15,165 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:15
2025-03-13 17:08:15,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1308.68it/s]
2025-03-13 17:08:15,199 [INFO]: There are 3683 embeddings of dim 49152
2025-03-13 17:08:15,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 17:08:15,199 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,200 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:15,200 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:08:15,200 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:15,200 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:15,200 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,200 [INFO]: 760.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:15,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:08:15,200 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:15
2025-03-13 17:08:15,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:15,200 [INFO]: 	Creating the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,200 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:15
2025-03-13 17:08:15,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:08:15,201 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,201 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:08:15,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.81it/s] 40%|████      | 6/15 [00:00<00:00, 28.25it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.94it/s]100%|██████████| 15/15 [00:04<00:00,  2.62it/s]100%|██████████| 15/15 [00:04<00:00,  3.66it/s]
2025-03-13 17:08:19,303 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:19
2025-03-13 17:09:22,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.2047 secs
2025-03-13 17:09:22,508 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 17:09:22,508 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.20it/s]
2025-03-13 17:09:53,176 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6671 secs
2025-03-13 17:09:53,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.9768 secs
2025-03-13 17:09:53,178 [INFO]: {
2025-03-13 17:09:53,178 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:53,178 [INFO]: 	index_param: efSearch=161
2025-03-13 17:09:53,178 [INFO]: 	index_path: knn.index
2025-03-13 17:09:53,179 [INFO]: 	size in bytes: 724607710
2025-03-13 17:09:53,179 [INFO]: 	avg_search_speed_ms: 8.925719211609769
2025-03-13 17:09:53,179 [INFO]: 	99p_search_speed_ms: 15.196289201267058
2025-03-13 17:09:53,179 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:53,179 [INFO]: 	nb vectors: 3683
2025-03-13 17:09:53,179 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:53,179 [INFO]: 	compression ratio: 0.9993093559548242
2025-03-13 17:09:53,179 [INFO]: }
2025-03-13 17:09:53,179 [INFO]: 	>>> Finished "Creating the index" in 97.9786 secs
2025-03-13 17:09:53,179 [INFO]: >>> Finished "Launching the whole pipeline" in 98.0131 secs
2025-03-13 17:09:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 49387 [episode count 2/20]
[retrieval_preprocessing] for episode 33193 [episode count 3/20], we have num_retrieval=np.int64(3728) num_query=np.int64(166)
2025-03-13 17:09:54,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:55,347 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:55
2025-03-13 17:09:55,347 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.27it/s]
2025-03-13 17:09:55,384 [INFO]: There are 3728 embeddings of dim 49152
2025-03-13 17:09:55,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 17:09:55,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:55
2025-03-13 17:09:55,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:55,385 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:09:55,385 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:55,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:09:55,385 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:55
2025-03-13 17:09:55,386 [INFO]: 769.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:55,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:09:55,386 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:55
2025-03-13 17:09:55,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:55,386 [INFO]: 	Creating the index 03/13/2025, 17:09:55
2025-03-13 17:09:55,387 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:55
2025-03-13 17:09:55,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:09:55,390 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:55
2025-03-13 17:09:55,390 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:09:55,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.67it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.89it/s] 80%|████████  | 12/15 [00:00<00:00, 40.67it/s]100%|██████████| 15/15 [00:03<00:00,  4.07it/s]
2025-03-13 17:09:59,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:59
2025-03-13 17:10:49,914 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8298 secs
2025-03-13 17:10:49,914 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:10:49,914 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.03it/s]
2025-03-13 17:11:27,248 [INFO]: 	>>> Finished "Compute fast metrics" in 37.3336 secs
2025-03-13 17:11:27,252 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.8617 secs
2025-03-13 17:11:27,252 [INFO]: {
2025-03-13 17:11:27,252 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:27,252 [INFO]: 	index_param: efSearch=183
2025-03-13 17:11:27,252 [INFO]: 	index_path: knn.index
2025-03-13 17:11:27,252 [INFO]: 	size in bytes: 733461250
2025-03-13 17:11:27,252 [INFO]: 	avg_search_speed_ms: 10.340002022544933
2025-03-13 17:11:27,252 [INFO]: 	99p_search_speed_ms: 15.040692430920904
2025-03-13 17:11:27,252 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:27,252 [INFO]: 	nb vectors: 3728
2025-03-13 17:11:27,252 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:27,252 [INFO]: 	compression ratio: 0.9993092668494757
2025-03-13 17:11:27,252 [INFO]: }
2025-03-13 17:11:27,252 [INFO]: 	>>> Finished "Creating the index" in 91.8659 secs
2025-03-13 17:11:27,252 [INFO]: >>> Finished "Launching the whole pipeline" in 91.9056 secs
2025-03-13 17:11:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 33193 [episode count 3/20]
[retrieval_preprocessing] for episode 90542 [episode count 4/20], we have num_retrieval=np.int64(3702) num_query=np.int64(192)
2025-03-13 17:11:29,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:29,704 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:29
2025-03-13 17:11:29,704 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.84it/s]
2025-03-13 17:11:29,735 [INFO]: There are 3702 embeddings of dim 49152
2025-03-13 17:11:29,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 17:11:29,736 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:29
2025-03-13 17:11:29,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:29,736 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:11:29,736 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:29,736 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:29,736 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:29
2025-03-13 17:11:29,736 [INFO]: 764.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:29,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:29,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:29
2025-03-13 17:11:29,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:29,736 [INFO]: 	Creating the index 03/13/2025, 17:11:29
2025-03-13 17:11:29,736 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:29
2025-03-13 17:11:29,737 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:11:29,737 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:29
2025-03-13 17:11:29,737 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:11:29,737 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.97it/s] 40%|████      | 6/15 [00:00<00:00, 28.58it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.89it/s]100%|██████████| 15/15 [00:03<00:00,  2.94it/s]100%|██████████| 15/15 [00:03<00:00,  4.08it/s]
2025-03-13 17:11:33,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:33
2025-03-13 17:12:29,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4216 secs
2025-03-13 17:12:29,840 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 17:12:29,840 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 17:12:54,395 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5548 secs
2025-03-13 17:12:54,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.6602 secs
2025-03-13 17:12:54,398 [INFO]: {
2025-03-13 17:12:54,398 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:54,398 [INFO]: 	index_param: efSearch=120
2025-03-13 17:12:54,398 [INFO]: 	index_path: knn.index
2025-03-13 17:12:54,398 [INFO]: 	size in bytes: 728345770
2025-03-13 17:12:54,398 [INFO]: 	avg_search_speed_ms: 6.520453344912688
2025-03-13 17:12:54,398 [INFO]: 	99p_search_speed_ms: 10.446190023794776
2025-03-13 17:12:54,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:54,398 [INFO]: 	nb vectors: 3702
2025-03-13 17:12:54,398 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:54,398 [INFO]: 	compression ratio: 0.9993094571003001
2025-03-13 17:12:54,398 [INFO]: }
2025-03-13 17:12:54,398 [INFO]: 	>>> Finished "Creating the index" in 84.6618 secs
2025-03-13 17:12:54,398 [INFO]: >>> Finished "Launching the whole pipeline" in 84.6941 secs
2025-03-13 17:12:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 90542 [episode count 4/20]
[retrieval_preprocessing] for episode 16967 [episode count 5/20], we have num_retrieval=np.int64(3645) num_query=np.int64(249)
2025-03-13 17:12:57,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:58,021 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:58
2025-03-13 17:12:58,021 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.03it/s]
2025-03-13 17:12:58,058 [INFO]: There are 3645 embeddings of dim 49152
2025-03-13 17:12:58,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-13 17:12:58,059 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,060 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:58,060 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:12:58,060 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:58,060 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:12:58,060 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,060 [INFO]: 752.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:58,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:12:58,061 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:58
2025-03-13 17:12:58,061 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:58,061 [INFO]: 	Creating the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,061 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:58
2025-03-13 17:12:58,064 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:12:58,064 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,064 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:12:58,065 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.89it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.62it/s] 80%|████████  | 12/15 [00:00<00:00, 36.45it/s]100%|██████████| 15/15 [00:03<00:00,  4.43it/s]
2025-03-13 17:13:01,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:01
2025-03-13 17:13:47,066 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6122 secs
2025-03-13 17:13:47,066 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:13:47,066 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.32it/s]
2025-03-13 17:14:16,097 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0309 secs
2025-03-13 17:14:16,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.0357 secs
2025-03-13 17:14:16,101 [INFO]: {
2025-03-13 17:14:16,101 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:16,101 [INFO]: 	index_param: efSearch=199
2025-03-13 17:14:16,101 [INFO]: 	index_path: knn.index
2025-03-13 17:14:16,101 [INFO]: 	size in bytes: 717131530
2025-03-13 17:14:16,101 [INFO]: 	avg_search_speed_ms: 10.416787039866904
2025-03-13 17:14:16,101 [INFO]: 	99p_search_speed_ms: 15.28768675168976
2025-03-13 17:14:16,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:16,101 [INFO]: 	nb vectors: 3645
2025-03-13 17:14:16,101 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:16,101 [INFO]: 	compression ratio: 0.9993092341093969
2025-03-13 17:14:16,101 [INFO]: }
2025-03-13 17:14:16,101 [INFO]: 	>>> Finished "Creating the index" in 78.0402 secs
2025-03-13 17:14:16,101 [INFO]: >>> Finished "Launching the whole pipeline" in 78.0799 secs
2025-03-13 17:14:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 16967 [episode count 5/20]
[retrieval_preprocessing] for episode 49507 [episode count 6/20], we have num_retrieval=np.int64(3703) num_query=np.int64(191)
2025-03-13 17:14:19,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:20,912 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:20
2025-03-13 17:14:20,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.25it/s]
2025-03-13 17:14:20,955 [INFO]: There are 3703 embeddings of dim 49152
2025-03-13 17:14:20,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0431 secs
2025-03-13 17:14:20,955 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,955 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:20,956 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:14:20,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:20,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:14:20,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,956 [INFO]: 764.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:20,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:14:20,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:20
2025-03-13 17:14:20,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:20,956 [INFO]: 	Creating the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,956 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:20
2025-03-13 17:14:20,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:14:20,958 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,958 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:14:20,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.10it/s] 40%|████      | 6/15 [00:00<00:00, 26.58it/s] 60%|██████    | 9/15 [00:00<00:00, 24.61it/s] 80%|████████  | 12/15 [00:00<00:00, 25.52it/s]100%|██████████| 15/15 [00:03<00:00,  2.37it/s]100%|██████████| 15/15 [00:03<00:00,  3.86it/s]
2025-03-13 17:14:24,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:24
2025-03-13 17:15:12,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6876 secs
2025-03-13 17:15:12,535 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 17:15:12,536 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 17:15:53,682 [INFO]: 	>>> Finished "Compute fast metrics" in 41.1461 secs
2025-03-13 17:15:53,684 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.7261 secs
2025-03-13 17:15:53,685 [INFO]: {
2025-03-13 17:15:53,685 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:53,685 [INFO]: 	index_param: efSearch=249
2025-03-13 17:15:53,685 [INFO]: 	index_path: knn.index
2025-03-13 17:15:53,685 [INFO]: 	size in bytes: 728542510
2025-03-13 17:15:53,685 [INFO]: 	avg_search_speed_ms: 11.781114310704092
2025-03-13 17:15:53,685 [INFO]: 	99p_search_speed_ms: 16.609016442671415
2025-03-13 17:15:53,685 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:53,685 [INFO]: 	nb vectors: 3703
2025-03-13 17:15:53,685 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:53,685 [INFO]: 	compression ratio: 0.9993094623949946
2025-03-13 17:15:53,685 [INFO]: }
2025-03-13 17:15:53,685 [INFO]: 	>>> Finished "Creating the index" in 92.7285 secs
2025-03-13 17:15:53,685 [INFO]: >>> Finished "Launching the whole pipeline" in 92.7726 secs
2025-03-13 17:15:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 49507 [episode count 6/20]
[retrieval_preprocessing] for episode 25424 [episode count 7/20], we have num_retrieval=np.int64(3673) num_query=np.int64(221)
2025-03-13 17:15:56,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:56,737 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:56
2025-03-13 17:15:56,737 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.76it/s]
2025-03-13 17:15:56,769 [INFO]: There are 3673 embeddings of dim 49152
2025-03-13 17:15:56,769 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 17:15:56,769 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:56
2025-03-13 17:15:56,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:56,769 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:15:56,769 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:56,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:56,769 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:56
2025-03-13 17:15:56,769 [INFO]: 758.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:56,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:15:56,770 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:56
2025-03-13 17:15:56,770 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:56,770 [INFO]: 	Creating the index 03/13/2025, 17:15:56
2025-03-13 17:15:56,770 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:56
2025-03-13 17:15:56,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:15:56,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:56
2025-03-13 17:15:56,771 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:15:56,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.86it/s] 40%|████      | 6/15 [00:00<00:00, 29.57it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.41it/s]100%|██████████| 15/15 [00:03<00:00,  3.26it/s]100%|██████████| 15/15 [00:03<00:00,  4.52it/s]
2025-03-13 17:16:00,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:00
2025-03-13 17:16:43,807 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7104 secs
2025-03-13 17:16:43,807 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:16:43,807 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.74it/s]
2025-03-13 17:17:03,138 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3309 secs
2025-03-13 17:17:03,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3694 secs
2025-03-13 17:17:03,141 [INFO]: {
2025-03-13 17:17:03,141 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:03,141 [INFO]: 	index_param: efSearch=202
2025-03-13 17:17:03,141 [INFO]: 	index_path: knn.index
2025-03-13 17:17:03,141 [INFO]: 	size in bytes: 722640310
2025-03-13 17:17:03,141 [INFO]: 	avg_search_speed_ms: 11.525392143939909
2025-03-13 17:17:03,141 [INFO]: 	99p_search_speed_ms: 17.659996442962438
2025-03-13 17:17:03,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:03,141 [INFO]: 	nb vectors: 3673
2025-03-13 17:17:03,141 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:03,141 [INFO]: 	compression ratio: 0.9993093023000613
2025-03-13 17:17:03,141 [INFO]: }
2025-03-13 17:17:03,141 [INFO]: 	>>> Finished "Creating the index" in 66.3713 secs
2025-03-13 17:17:03,141 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4042 secs
2025-03-13 17:17:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 25424 [episode count 7/20]
[retrieval_preprocessing] for episode 9495 [episode count 8/20], we have num_retrieval=np.int64(3717) num_query=np.int64(177)
2025-03-13 17:17:05,186 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:05,820 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:05
2025-03-13 17:17:05,820 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1951.75it/s]
2025-03-13 17:17:05,978 [INFO]: There are 3717 embeddings of dim 49152
2025-03-13 17:17:05,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1578 secs
2025-03-13 17:17:05,978 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:05
2025-03-13 17:17:05,978 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:05,978 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:17:05,978 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:05,978 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:17:05,979 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:05
2025-03-13 17:17:05,979 [INFO]: 767.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:05,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:17:05,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:05
2025-03-13 17:17:05,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:05,979 [INFO]: 	Creating the index 03/13/2025, 17:17:05
2025-03-13 17:17:05,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:05
2025-03-13 17:17:05,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:17:05,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:05
2025-03-13 17:17:05,982 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:17:05,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.60it/s] 40%|████      | 6/15 [00:00<00:00, 28.79it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.29it/s]100%|██████████| 15/15 [00:03<00:00,  3.26it/s]100%|██████████| 15/15 [00:03<00:00,  4.50it/s]
2025-03-13 17:17:09,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:09
2025-03-13 17:17:58,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9909 secs
2025-03-13 17:17:58,310 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 17:17:58,310 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.03it/s]
2025-03-13 17:18:15,919 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6090 secs
2025-03-13 17:18:15,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9394 secs
2025-03-13 17:18:15,921 [INFO]: {
2025-03-13 17:18:15,921 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:15,921 [INFO]: 	index_param: efSearch=197
2025-03-13 17:18:15,921 [INFO]: 	index_path: knn.index
2025-03-13 17:18:15,921 [INFO]: 	size in bytes: 731296930
2025-03-13 17:18:15,921 [INFO]: 	avg_search_speed_ms: 9.70940389580012
2025-03-13 17:18:15,921 [INFO]: 	99p_search_speed_ms: 14.847057694569234
2025-03-13 17:18:15,921 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:15,921 [INFO]: 	nb vectors: 3717
2025-03-13 17:18:15,921 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:15,921 [INFO]: 	compression ratio: 0.9993094542322227
2025-03-13 17:18:15,921 [INFO]: }
2025-03-13 17:18:15,921 [INFO]: 	>>> Finished "Creating the index" in 69.9421 secs
2025-03-13 17:18:15,921 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1011 secs
2025-03-13 17:18:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 9495 [episode count 8/20]
[retrieval_preprocessing] for episode 1321 [episode count 9/20], we have num_retrieval=np.int64(3687) num_query=np.int64(207)
2025-03-13 17:18:17,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:18,193 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:18
2025-03-13 17:18:18,193 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2214.52it/s]
2025-03-13 17:18:18,226 [INFO]: There are 3687 embeddings of dim 49152
2025-03-13 17:18:18,227 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 17:18:18,227 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:18
2025-03-13 17:18:18,227 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:18,227 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:18:18,227 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:18,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:18:18,228 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:18
2025-03-13 17:18:18,228 [INFO]: 760.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:18,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:18:18,229 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:18
2025-03-13 17:18:18,229 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:18,229 [INFO]: 	Creating the index 03/13/2025, 17:18:18
2025-03-13 17:18:18,229 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:18
2025-03-13 17:18:18,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:18:18,233 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:18
2025-03-13 17:18:18,233 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:18:18,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.41it/s] 33%|███▎      | 5/15 [00:00<00:00, 26.22it/s] 67%|██████▋   | 10/15 [00:00<00:00, 34.81it/s]100%|██████████| 15/15 [00:03<00:00,  3.41it/s]100%|██████████| 15/15 [00:03<00:00,  4.50it/s]
2025-03-13 17:18:21,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:21
2025-03-13 17:19:02,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9784 secs
2025-03-13 17:19:02,547 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:19:02,547 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.81it/s]
2025-03-13 17:19:26,309 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7611 secs
2025-03-13 17:19:26,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0781 secs
2025-03-13 17:19:26,311 [INFO]: {
2025-03-13 17:19:26,311 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:26,311 [INFO]: 	index_param: efSearch=206
2025-03-13 17:19:26,311 [INFO]: 	index_path: knn.index
2025-03-13 17:19:26,311 [INFO]: 	size in bytes: 725394670
2025-03-13 17:19:26,311 [INFO]: 	avg_search_speed_ms: 10.65841410060856
2025-03-13 17:19:26,311 [INFO]: 	99p_search_speed_ms: 14.472848977893591
2025-03-13 17:19:26,311 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:26,311 [INFO]: 	nb vectors: 3687
2025-03-13 17:19:26,311 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:26,311 [INFO]: 	compression ratio: 0.9993093773352374
2025-03-13 17:19:26,311 [INFO]: }
2025-03-13 17:19:26,311 [INFO]: 	>>> Finished "Creating the index" in 68.0822 secs
2025-03-13 17:19:26,311 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1178 secs
2025-03-13 17:19:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 1321 [episode count 9/20]
[retrieval_preprocessing] for episode 66655 [episode count 10/20], we have num_retrieval=np.int64(3726) num_query=np.int64(168)
2025-03-13 17:19:28,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:29,518 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:29
2025-03-13 17:19:29,518 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.03it/s]
2025-03-13 17:19:29,549 [INFO]: There are 3726 embeddings of dim 49152
2025-03-13 17:19:29,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:19:29,550 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:29
2025-03-13 17:19:29,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:29,550 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:19:29,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:29,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:29,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:29
2025-03-13 17:19:29,550 [INFO]: 769.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:29,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:19:29,550 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:29
2025-03-13 17:19:29,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:29,550 [INFO]: 	Creating the index 03/13/2025, 17:19:29
2025-03-13 17:19:29,550 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:29
2025-03-13 17:19:29,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:19:29,551 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:29
2025-03-13 17:19:29,551 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:19:29,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.62it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.35it/s] 80%|████████  | 12/15 [00:00<00:00, 39.26it/s]100%|██████████| 15/15 [00:02<00:00,  5.26it/s]
2025-03-13 17:19:32,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:32
2025-03-13 17:20:14,928 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5222 secs
2025-03-13 17:20:14,928 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 17:20:14,928 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 17:20:44,625 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6966 secs
2025-03-13 17:20:44,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.0768 secs
2025-03-13 17:20:44,628 [INFO]: {
2025-03-13 17:20:44,629 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:44,629 [INFO]: 	index_param: efSearch=151
2025-03-13 17:20:44,629 [INFO]: 	index_path: knn.index
2025-03-13 17:20:44,629 [INFO]: 	size in bytes: 733067710
2025-03-13 17:20:44,629 [INFO]: 	avg_search_speed_ms: 8.061829506547928
2025-03-13 17:20:44,629 [INFO]: 	99p_search_speed_ms: 12.802022369578474
2025-03-13 17:20:44,629 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:44,629 [INFO]: 	nb vectors: 3726
2025-03-13 17:20:44,629 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:44,629 [INFO]: 	compression ratio: 0.999309338014629
2025-03-13 17:20:44,629 [INFO]: }
2025-03-13 17:20:44,629 [INFO]: 	>>> Finished "Creating the index" in 75.0786 secs
2025-03-13 17:20:44,629 [INFO]: >>> Finished "Launching the whole pipeline" in 75.1104 secs
2025-03-13 17:20:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 66655 [episode count 10/20]
[retrieval_preprocessing] for episode 93980 [episode count 11/20], we have num_retrieval=np.int64(3666) num_query=np.int64(228)
2025-03-13 17:20:48,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:49,321 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:49
2025-03-13 17:20:49,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 993.44it/s]
2025-03-13 17:20:49,354 [INFO]: There are 3666 embeddings of dim 49152
2025-03-13 17:20:49,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 17:20:49,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:49
2025-03-13 17:20:49,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:49,354 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:20:49,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:49,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:20:49,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:49
2025-03-13 17:20:49,354 [INFO]: 756.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:49,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:20:49,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:49
2025-03-13 17:20:49,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:49,354 [INFO]: 	Creating the index 03/13/2025, 17:20:49
2025-03-13 17:20:49,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:49
2025-03-13 17:20:49,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:20:49,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:49
2025-03-13 17:20:49,356 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:20:49,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.30it/s] 40%|████      | 6/15 [00:00<00:00, 27.15it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.57it/s]100%|██████████| 15/15 [00:03<00:00,  3.18it/s]100%|██████████| 15/15 [00:03<00:00,  4.38it/s]
2025-03-13 17:20:52,783 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:52
2025-03-13 17:21:42,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0980 secs
2025-03-13 17:21:42,881 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:21:42,881 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 17:22:04,148 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2663 secs
2025-03-13 17:22:04,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7942 secs
2025-03-13 17:22:04,150 [INFO]: {
2025-03-13 17:22:04,150 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:04,150 [INFO]: 	index_param: efSearch=183
2025-03-13 17:22:04,150 [INFO]: 	index_path: knn.index
2025-03-13 17:22:04,150 [INFO]: 	size in bytes: 721263130
2025-03-13 17:22:04,150 [INFO]: 	avg_search_speed_ms: 10.838836983435526
2025-03-13 17:22:04,150 [INFO]: 	99p_search_speed_ms: 19.61969445925206
2025-03-13 17:22:04,150 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:04,150 [INFO]: 	nb vectors: 3666
2025-03-13 17:22:04,150 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:04,150 [INFO]: 	compression ratio: 0.999309264567565
2025-03-13 17:22:04,150 [INFO]: }
2025-03-13 17:22:04,150 [INFO]: 	>>> Finished "Creating the index" in 74.7959 secs
2025-03-13 17:22:04,150 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8294 secs
2025-03-13 17:22:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 93980 [episode count 11/20]
[retrieval_preprocessing] for episode 26729 [episode count 12/20], we have num_retrieval=np.int64(3700) num_query=np.int64(194)
2025-03-13 17:22:07,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:08,308 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:08
2025-03-13 17:22:08,308 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.89it/s]
2025-03-13 17:22:08,339 [INFO]: There are 3700 embeddings of dim 49152
2025-03-13 17:22:08,340 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 17:22:08,340 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:08
2025-03-13 17:22:08,340 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:08,340 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:22:08,340 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:08,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:08,340 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:08
2025-03-13 17:22:08,340 [INFO]: 763.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:08,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:08,340 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:08
2025-03-13 17:22:08,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:08,340 [INFO]: 	Creating the index 03/13/2025, 17:22:08
2025-03-13 17:22:08,340 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:08
2025-03-13 17:22:08,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:22:08,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:08
2025-03-13 17:22:08,341 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:22:08,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.13it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.97it/s] 80%|████████  | 12/15 [00:00<00:00, 38.54it/s]100%|██████████| 15/15 [00:03<00:00,  4.65it/s]
2025-03-13 17:22:11,574 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:11
2025-03-13 17:23:03,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8452 secs
2025-03-13 17:23:03,420 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 17:23:03,420 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-13 17:23:25,462 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0425 secs
2025-03-13 17:23:25,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.1242 secs
2025-03-13 17:23:25,466 [INFO]: {
2025-03-13 17:23:25,466 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:25,466 [INFO]: 	index_param: efSearch=159
2025-03-13 17:23:25,466 [INFO]: 	index_path: knn.index
2025-03-13 17:23:25,466 [INFO]: 	size in bytes: 727952290
2025-03-13 17:23:25,466 [INFO]: 	avg_search_speed_ms: 9.595228519760816
2025-03-13 17:23:25,466 [INFO]: 	99p_search_speed_ms: 14.46464017266407
2025-03-13 17:23:25,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:25,466 [INFO]: 	nb vectors: 3700
2025-03-13 17:23:25,466 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:25,466 [INFO]: 	compression ratio: 0.999309446502325
2025-03-13 17:23:25,466 [INFO]: }
2025-03-13 17:23:25,466 [INFO]: 	>>> Finished "Creating the index" in 77.1257 secs
2025-03-13 17:23:25,466 [INFO]: >>> Finished "Launching the whole pipeline" in 77.1577 secs
2025-03-13 17:23:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 26729 [episode count 12/20]
[retrieval_preprocessing] for episode 43794 [episode count 13/20], we have num_retrieval=np.int64(3731) num_query=np.int64(163)
2025-03-13 17:23:27,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:28,515 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:28
2025-03-13 17:23:28,516 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.90it/s]
2025-03-13 17:23:28,554 [INFO]: There are 3731 embeddings of dim 49152
2025-03-13 17:23:28,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-13 17:23:28,555 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:28
2025-03-13 17:23:28,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:28,555 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:23:28,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:28,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:23:28,556 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:28
2025-03-13 17:23:28,556 [INFO]: 770.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:28,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:23:28,556 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:28
2025-03-13 17:23:28,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:28,557 [INFO]: 	Creating the index 03/13/2025, 17:23:28
2025-03-13 17:23:28,557 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:28
2025-03-13 17:23:28,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:23:28,561 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:28
2025-03-13 17:23:28,561 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:23:28,561 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.39it/s] 33%|███▎      | 5/15 [00:00<00:00, 24.58it/s] 60%|██████    | 9/15 [00:00<00:00, 28.09it/s] 87%|████████▋ | 13/15 [00:00<00:00, 29.74it/s]100%|██████████| 15/15 [00:04<00:00,  3.21it/s]
2025-03-13 17:23:33,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:33
2025-03-13 17:24:18,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2721 secs
2025-03-13 17:24:18,509 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 17:24:18,509 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.76it/s]
2025-03-13 17:24:40,731 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2215 secs
2025-03-13 17:24:40,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1726 secs
2025-03-13 17:24:40,733 [INFO]: {
2025-03-13 17:24:40,733 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:40,733 [INFO]: 	index_param: efSearch=179
2025-03-13 17:24:40,733 [INFO]: 	index_path: knn.index
2025-03-13 17:24:40,734 [INFO]: 	size in bytes: 734051470
2025-03-13 17:24:40,734 [INFO]: 	avg_search_speed_ms: 8.975543834175413
2025-03-13 17:24:40,734 [INFO]: 	99p_search_speed_ms: 13.780767710413762
2025-03-13 17:24:40,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:40,734 [INFO]: 	nb vectors: 3731
2025-03-13 17:24:40,734 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:40,734 [INFO]: 	compression ratio: 0.9993092827673242
2025-03-13 17:24:40,734 [INFO]: }
2025-03-13 17:24:40,734 [INFO]: 	>>> Finished "Creating the index" in 72.1770 secs
2025-03-13 17:24:40,734 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2181 secs
2025-03-13 17:24:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 43794 [episode count 13/20]
[retrieval_preprocessing] for episode 87539 [episode count 14/20], we have num_retrieval=np.int64(3713) num_query=np.int64(181)
2025-03-13 17:24:42,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:44,116 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:44
2025-03-13 17:24:44,116 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1065.63it/s]
2025-03-13 17:24:44,145 [INFO]: There are 3713 embeddings of dim 49152
2025-03-13 17:24:44,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 17:24:44,145 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:44
2025-03-13 17:24:44,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:44,145 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:24:44,145 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:44,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:44,145 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:44
2025-03-13 17:24:44,145 [INFO]: 766.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:44,146 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:24:44,146 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:44
2025-03-13 17:24:44,146 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:44,146 [INFO]: 	Creating the index 03/13/2025, 17:24:44
2025-03-13 17:24:44,146 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:44
2025-03-13 17:24:44,147 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:24:44,147 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:44
2025-03-13 17:24:44,147 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:24:44,147 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.53it/s] 53%|█████▎    | 8/15 [00:00<00:00, 40.50it/s] 87%|████████▋ | 13/15 [00:00<00:00, 44.13it/s]100%|██████████| 15/15 [00:02<00:00,  5.44it/s]
2025-03-13 17:24:46,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:46
2025-03-13 17:25:40,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8162 secs
2025-03-13 17:25:40,723 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:25:40,723 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 17:26:03,010 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2870 secs
2025-03-13 17:26:03,013 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.8665 secs
2025-03-13 17:26:03,014 [INFO]: {
2025-03-13 17:26:03,014 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:03,014 [INFO]: 	index_param: efSearch=170
2025-03-13 17:26:03,014 [INFO]: 	index_path: knn.index
2025-03-13 17:26:03,014 [INFO]: 	size in bytes: 730509970
2025-03-13 17:26:03,014 [INFO]: 	avg_search_speed_ms: 10.576340789270704
2025-03-13 17:26:03,014 [INFO]: 	99p_search_speed_ms: 17.286758369300514
2025-03-13 17:26:03,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:03,014 [INFO]: 	nb vectors: 3713
2025-03-13 17:26:03,014 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:03,014 [INFO]: 	compression ratio: 0.9993094331073948
2025-03-13 17:26:03,014 [INFO]: }
2025-03-13 17:26:03,014 [INFO]: 	>>> Finished "Creating the index" in 78.8687 secs
2025-03-13 17:26:03,014 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8980 secs
2025-03-13 17:26:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 87539 [episode count 14/20]
[retrieval_preprocessing] for episode 61385 [episode count 15/20], we have num_retrieval=np.int64(3741) num_query=np.int64(153)
2025-03-13 17:26:05,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:06,340 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:06
2025-03-13 17:26:06,340 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.12it/s]
2025-03-13 17:26:06,376 [INFO]: There are 3741 embeddings of dim 49152
2025-03-13 17:26:06,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 17:26:06,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:06
2025-03-13 17:26:06,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:06,377 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:26:06,377 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:06,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:06,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:06
2025-03-13 17:26:06,377 [INFO]: 772.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:06,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:26:06,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:06
2025-03-13 17:26:06,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:06,377 [INFO]: 	Creating the index 03/13/2025, 17:26:06
2025-03-13 17:26:06,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:06
2025-03-13 17:26:06,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:26:06,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:06
2025-03-13 17:26:06,378 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:26:06,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.53it/s] 33%|███▎      | 5/15 [00:00<00:00, 22.42it/s] 60%|██████    | 9/15 [00:00<00:00, 28.60it/s] 80%|████████  | 12/15 [00:00<00:00, 28.37it/s]100%|██████████| 15/15 [00:03<00:00,  2.54it/s]100%|██████████| 15/15 [00:03<00:00,  4.08it/s]
2025-03-13 17:26:10,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:10
2025-03-13 17:27:05,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0005 secs
2025-03-13 17:27:05,058 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:27:05,059 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 17:27:33,226 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1673 secs
2025-03-13 17:27:33,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.8507 secs
2025-03-13 17:27:33,229 [INFO]: {
2025-03-13 17:27:33,229 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:33,229 [INFO]: 	index_param: efSearch=200
2025-03-13 17:27:33,229 [INFO]: 	index_path: knn.index
2025-03-13 17:27:33,229 [INFO]: 	size in bytes: 736018990
2025-03-13 17:27:33,229 [INFO]: 	avg_search_speed_ms: 11.198015235915095
2025-03-13 17:27:33,229 [INFO]: 	99p_search_speed_ms: 19.606165001168847
2025-03-13 17:27:33,229 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:33,229 [INFO]: 	nb vectors: 3741
2025-03-13 17:27:33,229 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:33,229 [INFO]: 	compression ratio: 0.9993091727157747
2025-03-13 17:27:33,229 [INFO]: }
2025-03-13 17:27:33,229 [INFO]: 	>>> Finished "Creating the index" in 86.8522 secs
2025-03-13 17:27:33,229 [INFO]: >>> Finished "Launching the whole pipeline" in 86.8890 secs
2025-03-13 17:27:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 61385 [episode count 15/20]
[retrieval_preprocessing] for episode 63010 [episode count 16/20], we have num_retrieval=np.int64(3700) num_query=np.int64(194)
2025-03-13 17:27:36,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:37,127 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:37
2025-03-13 17:27:37,127 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.48it/s]
2025-03-13 17:27:37,162 [INFO]: There are 3700 embeddings of dim 49152
2025-03-13 17:27:37,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 17:27:37,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:37,162 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:27:37,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:37,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:37,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,163 [INFO]: 763.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:37,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:27:37,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:37
2025-03-13 17:27:37,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:37,163 [INFO]: 	Creating the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:37
2025-03-13 17:27:37,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:27:37,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,164 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:27:37,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.91it/s] 33%|███▎      | 5/15 [00:00<00:00, 22.46it/s] 60%|██████    | 9/15 [00:00<00:00, 29.20it/s] 87%|████████▋ | 13/15 [00:00<00:00, 32.69it/s]100%|██████████| 15/15 [00:04<00:00,  3.41it/s]
2025-03-13 17:27:41,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:41
2025-03-13 17:28:32,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9667 secs
2025-03-13 17:28:32,534 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 17:28:32,534 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 17:29:10,786 [INFO]: 	>>> Finished "Compute fast metrics" in 38.2521 secs
2025-03-13 17:29:10,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.6262 secs
2025-03-13 17:29:10,790 [INFO]: {
2025-03-13 17:29:10,790 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:10,790 [INFO]: 	index_param: efSearch=222
2025-03-13 17:29:10,790 [INFO]: 	index_path: knn.index
2025-03-13 17:29:10,790 [INFO]: 	size in bytes: 727952290
2025-03-13 17:29:10,791 [INFO]: 	avg_search_speed_ms: 12.219384700965058
2025-03-13 17:29:10,791 [INFO]: 	99p_search_speed_ms: 19.73362720571458
2025-03-13 17:29:10,791 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:10,791 [INFO]: 	nb vectors: 3700
2025-03-13 17:29:10,791 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:10,791 [INFO]: 	compression ratio: 0.999309446502325
2025-03-13 17:29:10,791 [INFO]: }
2025-03-13 17:29:10,791 [INFO]: 	>>> Finished "Creating the index" in 93.6279 secs
2025-03-13 17:29:10,791 [INFO]: >>> Finished "Launching the whole pipeline" in 93.6639 secs
2025-03-13 17:29:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 63010 [episode count 16/20]
[retrieval_preprocessing] for episode 69888 [episode count 17/20], we have num_retrieval=np.int64(3659) num_query=np.int64(235)
2025-03-13 17:29:13,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:13,749 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:13
2025-03-13 17:29:13,749 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.76it/s]
2025-03-13 17:29:13,781 [INFO]: There are 3659 embeddings of dim 49152
2025-03-13 17:29:13,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 17:29:13,782 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:13
2025-03-13 17:29:13,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:13,782 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:29:13,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:13,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:13,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:13
2025-03-13 17:29:13,782 [INFO]: 755.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:13,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:29:13,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:13
2025-03-13 17:29:13,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:13,782 [INFO]: 	Creating the index 03/13/2025, 17:29:13
2025-03-13 17:29:13,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:13
2025-03-13 17:29:13,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:29:13,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:13
2025-03-13 17:29:13,783 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:29:13,783 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.65it/s] 40%|████      | 6/15 [00:00<00:00, 26.97it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.07it/s]100%|██████████| 15/15 [00:02<00:00,  3.67it/s]100%|██████████| 15/15 [00:02<00:00,  5.02it/s]
2025-03-13 17:29:16,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:16
2025-03-13 17:30:01,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7942 secs
2025-03-13 17:30:01,570 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:30:01,570 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-13 17:30:29,493 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9229 secs
2025-03-13 17:30:29,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.7127 secs
2025-03-13 17:30:29,496 [INFO]: {
2025-03-13 17:30:29,496 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:29,496 [INFO]: 	index_param: efSearch=206
2025-03-13 17:30:29,496 [INFO]: 	index_path: knn.index
2025-03-13 17:30:29,496 [INFO]: 	size in bytes: 719885950
2025-03-13 17:30:29,496 [INFO]: 	avg_search_speed_ms: 10.228304713554985
2025-03-13 17:30:29,496 [INFO]: 	99p_search_speed_ms: 14.632998991291972
2025-03-13 17:30:29,496 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:29,496 [INFO]: 	nb vectors: 3659
2025-03-13 17:30:29,496 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:29,496 [INFO]: 	compression ratio: 0.9993092266907001
2025-03-13 17:30:29,496 [INFO]: }
2025-03-13 17:30:29,496 [INFO]: 	>>> Finished "Creating the index" in 75.7144 secs
2025-03-13 17:30:29,496 [INFO]: >>> Finished "Launching the whole pipeline" in 75.7475 secs
2025-03-13 17:30:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 69888 [episode count 17/20]
[retrieval_preprocessing] for episode 70217 [episode count 18/20], we have num_retrieval=np.int64(3719) num_query=np.int64(175)
2025-03-13 17:30:31,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:32,213 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:32
2025-03-13 17:30:32,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1588.75it/s]
2025-03-13 17:30:32,424 [INFO]: There are 3719 embeddings of dim 49152
2025-03-13 17:30:32,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2111 secs
2025-03-13 17:30:32,424 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:32
2025-03-13 17:30:32,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:32,424 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:30:32,424 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:32,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:32,424 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:32
2025-03-13 17:30:32,424 [INFO]: 767.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:32,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:30:32,424 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:32
2025-03-13 17:30:32,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:32,424 [INFO]: 	Creating the index 03/13/2025, 17:30:32
2025-03-13 17:30:32,424 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:32
2025-03-13 17:30:32,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:30:32,425 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:32
2025-03-13 17:30:32,425 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:30:32,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.07it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.87it/s] 80%|████████  | 12/15 [00:00<00:00, 36.45it/s]100%|██████████| 15/15 [00:03<00:00,  3.90it/s]
2025-03-13 17:30:36,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:36
2025-03-13 17:31:31,322 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0452 secs
2025-03-13 17:31:31,322 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:31:31,322 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 17:31:56,469 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1470 secs
2025-03-13 17:31:56,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.0462 secs
2025-03-13 17:31:56,472 [INFO]: {
2025-03-13 17:31:56,472 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:56,472 [INFO]: 	index_param: efSearch=178
2025-03-13 17:31:56,472 [INFO]: 	index_path: knn.index
2025-03-13 17:31:56,472 [INFO]: 	size in bytes: 731690410
2025-03-13 17:31:56,472 [INFO]: 	avg_search_speed_ms: 9.810960741477842
2025-03-13 17:31:56,472 [INFO]: 	99p_search_speed_ms: 16.917674457654353
2025-03-13 17:31:56,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:56,472 [INFO]: 	nb vectors: 3719
2025-03-13 17:31:56,472 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:56,472 [INFO]: 	compression ratio: 0.9993094647775963
2025-03-13 17:31:56,472 [INFO]: }
2025-03-13 17:31:56,472 [INFO]: 	>>> Finished "Creating the index" in 84.0476 secs
2025-03-13 17:31:56,472 [INFO]: >>> Finished "Launching the whole pipeline" in 84.2592 secs
2025-03-13 17:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 70217 [episode count 18/20]
[retrieval_preprocessing] for episode 51215 [episode count 19/20], we have num_retrieval=np.int64(3695) num_query=np.int64(199)
2025-03-13 17:31:58,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:58,801 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:58
2025-03-13 17:31:58,801 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1639.04it/s]
2025-03-13 17:31:58,833 [INFO]: There are 3695 embeddings of dim 49152
2025-03-13 17:31:58,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 17:31:58,834 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,834 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:58,834 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:31:58,834 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:58,834 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:31:58,834 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,834 [INFO]: 762.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:58,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:31:58,834 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:58
2025-03-13 17:31:58,834 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:58,834 [INFO]: 	Creating the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,834 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:58
2025-03-13 17:31:58,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:31:58,836 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,836 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:31:58,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.42it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.85it/s] 80%|████████  | 12/15 [00:00<00:00, 39.40it/s]100%|██████████| 15/15 [00:04<00:00,  3.66it/s]
2025-03-13 17:32:02,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:02
2025-03-13 17:32:41,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7590 secs
2025-03-13 17:32:41,700 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:32:41,700 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-13 17:33:08,388 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6872 secs
2025-03-13 17:33:08,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5542 secs
2025-03-13 17:33:08,390 [INFO]: {
2025-03-13 17:33:08,390 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:08,390 [INFO]: 	index_param: efSearch=171
2025-03-13 17:33:08,390 [INFO]: 	index_path: knn.index
2025-03-13 17:33:08,390 [INFO]: 	size in bytes: 726968590
2025-03-13 17:33:08,390 [INFO]: 	avg_search_speed_ms: 9.13652276331091
2025-03-13 17:33:08,390 [INFO]: 	99p_search_speed_ms: 13.069317070767282
2025-03-13 17:33:08,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:08,391 [INFO]: 	nb vectors: 3695
2025-03-13 17:33:08,391 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:08,391 [INFO]: 	compression ratio: 0.9993094199571951
2025-03-13 17:33:08,391 [INFO]: }
2025-03-13 17:33:08,391 [INFO]: 	>>> Finished "Creating the index" in 69.5564 secs
2025-03-13 17:33:08,391 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5893 secs
2025-03-13 17:33:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 51215 [episode count 19/20]
2025-03-13 17:33:12: [retrieval_preprocessing] finished for -1_remove_marker_from_pot [chosen_id count 7/196]
2025-03-13 17:33:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1477699675_put_marker_in_mug [chosen_id count 8/196]
2025-03-13 17:33:13: [retrieval_preprocessing] we have num_total=3770 embedding_dim=49152
[retrieval_preprocessing] for episode 51206 [episode count 0/20], we have num_retrieval=np.int64(3437) num_query=np.int64(333)
2025-03-13 17:33:14,068 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:14,720 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:14
2025-03-13 17:33:14,720 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1869.95it/s]
2025-03-13 17:33:14,754 [INFO]: There are 3437 embeddings of dim 49152
2025-03-13 17:33:14,755 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 17:33:14,755 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:14
2025-03-13 17:33:14,755 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:14,755 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:33:14,755 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:14,755 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:33:14,755 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:14
2025-03-13 17:33:14,755 [INFO]: 709.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:14,755 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:33:14,755 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:14
2025-03-13 17:33:14,755 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:14,755 [INFO]: 	Creating the index 03/13/2025, 17:33:14
2025-03-13 17:33:14,755 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:14
2025-03-13 17:33:14,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:33:14,757 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:14
2025-03-13 17:33:14,757 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:33:14,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.39it/s] 50%|█████     | 7/14 [00:00<00:00, 32.79it/s] 86%|████████▌ | 12/14 [00:00<00:00, 36.94it/s]100%|██████████| 14/14 [00:03<00:00,  4.20it/s]
2025-03-13 17:33:18,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:18
2025-03-13 17:33:59,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5046 secs
2025-03-13 17:33:59,595 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 17:33:59,596 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 17:34:30,341 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7451 secs
2025-03-13 17:34:30,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5863 secs
2025-03-13 17:34:30,343 [INFO]: {
2025-03-13 17:34:30,343 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:30,343 [INFO]: 	index_param: efSearch=219
2025-03-13 17:34:30,343 [INFO]: 	index_path: knn.index
2025-03-13 17:34:30,343 [INFO]: 	size in bytes: 676208710
2025-03-13 17:34:30,343 [INFO]: 	avg_search_speed_ms: 11.518742626829047
2025-03-13 17:34:30,343 [INFO]: 	99p_search_speed_ms: 15.474786134436728
2025-03-13 17:34:30,343 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:30,343 [INFO]: 	nb vectors: 3437
2025-03-13 17:34:30,343 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:30,343 [INFO]: 	compression ratio: 0.9993093641162948
2025-03-13 17:34:30,343 [INFO]: }
2025-03-13 17:34:30,343 [INFO]: 	>>> Finished "Creating the index" in 75.5880 secs
2025-03-13 17:34:30,343 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6234 secs
2025-03-13 17:34:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 51206 [episode count 0/20]
[retrieval_preprocessing] for episode 82472 [episode count 1/20], we have num_retrieval=np.int64(3585) num_query=np.int64(185)
2025-03-13 17:34:33,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:34,282 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:34
2025-03-13 17:34:34,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.15it/s]
2025-03-13 17:34:34,318 [INFO]: There are 3585 embeddings of dim 49152
2025-03-13 17:34:34,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 17:34:34,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:34
2025-03-13 17:34:34,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:34,319 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:34:34,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:34,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:34:34,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:34
2025-03-13 17:34:34,320 [INFO]: 739.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:34,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:34:34,321 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:34
2025-03-13 17:34:34,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:34,322 [INFO]: 	Creating the index 03/13/2025, 17:34:34
2025-03-13 17:34:34,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:34
2025-03-13 17:34:34,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:34:34,326 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:34
2025-03-13 17:34:34,326 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:34:34,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.45it/s] 40%|████      | 6/15 [00:00<00:00, 29.90it/s] 67%|██████▋   | 10/15 [00:00<00:00, 33.70it/s] 93%|█████████▎| 14/15 [00:00<00:00, 35.01it/s]100%|██████████| 15/15 [00:04<00:00,  3.72it/s]
2025-03-13 17:34:38,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:38
2025-03-13 17:35:20,239 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7654 secs
2025-03-13 17:35:20,240 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:35:20,240 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.09it/s]
2025-03-13 17:35:46,762 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5222 secs
2025-03-13 17:35:46,765 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4393 secs
2025-03-13 17:35:46,765 [INFO]: {
2025-03-13 17:35:46,765 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:46,765 [INFO]: 	index_param: efSearch=227
2025-03-13 17:35:46,765 [INFO]: 	index_path: knn.index
2025-03-13 17:35:46,765 [INFO]: 	size in bytes: 705326650
2025-03-13 17:35:46,766 [INFO]: 	avg_search_speed_ms: 12.364580951301825
2025-03-13 17:35:46,766 [INFO]: 	99p_search_speed_ms: 20.240953927859657
2025-03-13 17:35:46,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:46,766 [INFO]: 	nb vectors: 3585
2025-03-13 17:35:46,766 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:46,766 [INFO]: 	compression ratio: 0.9993095823048795
2025-03-13 17:35:46,766 [INFO]: }
2025-03-13 17:35:46,766 [INFO]: 	>>> Finished "Creating the index" in 72.4440 secs
2025-03-13 17:35:46,766 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4833 secs
2025-03-13 17:35:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 82472 [episode count 1/20]
[retrieval_preprocessing] for episode 19002 [episode count 2/20], we have num_retrieval=np.int64(3576) num_query=np.int64(194)
2025-03-13 17:35:49,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:49,746 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:49
2025-03-13 17:35:49,746 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.80it/s]
2025-03-13 17:35:49,777 [INFO]: There are 3576 embeddings of dim 49152
2025-03-13 17:35:49,777 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:35:49,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:49
2025-03-13 17:35:49,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:49,778 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:35:49,778 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:49,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:35:49,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:49
2025-03-13 17:35:49,778 [INFO]: 738.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:49,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:35:49,778 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:49
2025-03-13 17:35:49,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:49,778 [INFO]: 	Creating the index 03/13/2025, 17:35:49
2025-03-13 17:35:49,778 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:49
2025-03-13 17:35:49,779 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:35:49,779 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:49
2025-03-13 17:35:49,779 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:35:49,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.90it/s] 40%|████      | 6/15 [00:00<00:00, 27.90it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.88it/s]100%|██████████| 15/15 [00:02<00:00,  3.86it/s]100%|██████████| 15/15 [00:02<00:00,  5.27it/s]
2025-03-13 17:35:52,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:52
2025-03-13 17:36:30,001 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3735 secs
2025-03-13 17:36:30,001 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 17:36:30,001 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.24it/s]
2025-03-13 17:36:53,693 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6918 secs
2025-03-13 17:36:53,697 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9173 secs
2025-03-13 17:36:53,697 [INFO]: {
2025-03-13 17:36:53,697 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:53,697 [INFO]: 	index_param: efSearch=266
2025-03-13 17:36:53,697 [INFO]: 	index_path: knn.index
2025-03-13 17:36:53,697 [INFO]: 	size in bytes: 703555930
2025-03-13 17:36:53,697 [INFO]: 	avg_search_speed_ms: 13.94837706908843
2025-03-13 17:36:53,697 [INFO]: 	99p_search_speed_ms: 21.818253148812808
2025-03-13 17:36:53,697 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:53,697 [INFO]: 	nb vectors: 3576
2025-03-13 17:36:53,697 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:53,697 [INFO]: 	compression ratio: 0.9993096184975656
2025-03-13 17:36:53,697 [INFO]: }
2025-03-13 17:36:53,697 [INFO]: 	>>> Finished "Creating the index" in 63.9191 secs
2025-03-13 17:36:53,697 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9510 secs
2025-03-13 17:36:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 19002 [episode count 2/20]
[retrieval_preprocessing] for episode 37961 [episode count 3/20], we have num_retrieval=np.int64(3630) num_query=np.int64(140)
2025-03-13 17:36:56,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:57,429 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:57
2025-03-13 17:36:57,429 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 924.67it/s]
2025-03-13 17:36:57,464 [INFO]: There are 3630 embeddings of dim 49152
2025-03-13 17:36:57,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 17:36:57,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:57,464 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:36:57,464 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:57,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:57,464 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,464 [INFO]: 749.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:57,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:57,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:57
2025-03-13 17:36:57,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:57,465 [INFO]: 	Creating the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,465 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:57
2025-03-13 17:36:57,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:36:57,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,466 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:36:57,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.01it/s] 40%|████      | 6/15 [00:00<00:00, 29.24it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.02it/s]100%|██████████| 15/15 [00:03<00:00,  2.88it/s]100%|██████████| 15/15 [00:03<00:00,  4.00it/s]
2025-03-13 17:37:01,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:01
2025-03-13 17:37:42,172 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9559 secs
2025-03-13 17:37:42,173 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:37:42,174 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.77it/s]
2025-03-13 17:38:10,965 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7913 secs
2025-03-13 17:38:11,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2976 secs
2025-03-13 17:38:11,764 [INFO]: {
2025-03-13 17:38:11,764 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:11,764 [INFO]: 	index_param: efSearch=194
2025-03-13 17:38:11,764 [INFO]: 	index_path: knn.index
2025-03-13 17:38:11,764 [INFO]: 	size in bytes: 714180250
2025-03-13 17:38:11,764 [INFO]: 	avg_search_speed_ms: 9.40839585262024
2025-03-13 17:38:11,764 [INFO]: 	99p_search_speed_ms: 13.330048741772767
2025-03-13 17:38:11,764 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:11,764 [INFO]: 	nb vectors: 3630
2025-03-13 17:38:11,765 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:11,765 [INFO]: 	compression ratio: 0.9993094040335055
2025-03-13 17:38:11,765 [INFO]: }
2025-03-13 17:38:11,765 [INFO]: 	>>> Finished "Creating the index" in 74.2999 secs
2025-03-13 17:38:11,765 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3359 secs
2025-03-13 17:38:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 37961 [episode count 3/20]
[retrieval_preprocessing] for episode 42597 [episode count 4/20], we have num_retrieval=np.int64(3592) num_query=np.int64(178)
2025-03-13 17:38:13,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:14,395 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:14
2025-03-13 17:38:14,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 17:38:14,431 [INFO]: There are 3592 embeddings of dim 49152
2025-03-13 17:38:14,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 17:38:14,431 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:14,431 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:38:14,431 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:14,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:14,431 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,431 [INFO]: 741.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:14,431 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:38:14,432 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:14
2025-03-13 17:38:14,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:14,432 [INFO]: 	Creating the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,432 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:14
2025-03-13 17:38:14,433 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:38:14,433 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,433 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:38:14,433 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.11it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.46it/s] 80%|████████  | 12/15 [00:00<00:00, 37.99it/s]100%|██████████| 15/15 [00:03<00:00,  4.38it/s]
2025-03-13 17:38:17,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:17
2025-03-13 17:38:52,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8855 secs
2025-03-13 17:38:52,747 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 17:38:52,747 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.74it/s]
2025-03-13 17:39:16,022 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2747 secs
2025-03-13 17:39:16,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5915 secs
2025-03-13 17:39:16,025 [INFO]: {
2025-03-13 17:39:16,025 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:16,025 [INFO]: 	index_param: efSearch=208
2025-03-13 17:39:16,025 [INFO]: 	index_path: knn.index
2025-03-13 17:39:16,025 [INFO]: 	size in bytes: 706703830
2025-03-13 17:39:16,025 [INFO]: 	avg_search_speed_ms: 9.59192989269059
2025-03-13 17:39:16,025 [INFO]: 	99p_search_speed_ms: 16.277627521194518
2025-03-13 17:39:16,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:16,025 [INFO]: 	nb vectors: 3592
2025-03-13 17:39:16,025 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:16,025 [INFO]: 	compression ratio: 0.9993096202690737
2025-03-13 17:39:16,025 [INFO]: }
2025-03-13 17:39:16,025 [INFO]: 	>>> Finished "Creating the index" in 61.5932 secs
2025-03-13 17:39:16,025 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6299 secs
2025-03-13 17:39:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 42597 [episode count 4/20]
[retrieval_preprocessing] for episode 80501 [episode count 5/20], we have num_retrieval=np.int64(3602) num_query=np.int64(168)
2025-03-13 17:39:17,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:18,918 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:18
2025-03-13 17:39:18,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1005.11it/s]
2025-03-13 17:39:18,949 [INFO]: There are 3602 embeddings of dim 49152
2025-03-13 17:39:18,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:39:18,950 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:18
2025-03-13 17:39:18,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:18,950 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:39:18,950 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:18,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:18,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:18
2025-03-13 17:39:18,950 [INFO]: 743.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:18,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:39:18,950 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:18
2025-03-13 17:39:18,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:18,950 [INFO]: 	Creating the index 03/13/2025, 17:39:18
2025-03-13 17:39:18,950 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:18
2025-03-13 17:39:18,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:39:18,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:18
2025-03-13 17:39:18,951 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:39:18,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.87it/s] 27%|██▋       | 4/15 [00:00<00:00, 19.28it/s] 53%|█████▎    | 8/15 [00:00<00:00, 27.58it/s] 87%|████████▋ | 13/15 [00:00<00:00, 34.44it/s]100%|██████████| 15/15 [00:03<00:00,  4.24it/s]
2025-03-13 17:39:22,493 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:22
2025-03-13 17:39:59,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1250 secs
2025-03-13 17:39:59,619 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 17:39:59,619 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-13 17:40:34,373 [INFO]: 	>>> Finished "Compute fast metrics" in 34.7539 secs
2025-03-13 17:40:34,376 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4244 secs
2025-03-13 17:40:34,376 [INFO]: {
2025-03-13 17:40:34,376 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:34,376 [INFO]: 	index_param: efSearch=282
2025-03-13 17:40:34,376 [INFO]: 	index_path: knn.index
2025-03-13 17:40:34,376 [INFO]: 	size in bytes: 708671230
2025-03-13 17:40:34,376 [INFO]: 	avg_search_speed_ms: 14.44212385906178
2025-03-13 17:40:34,376 [INFO]: 	99p_search_speed_ms: 20.885472623631358
2025-03-13 17:40:34,376 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:34,376 [INFO]: 	nb vectors: 3602
2025-03-13 17:40:34,376 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:34,376 [INFO]: 	compression ratio: 0.9993096742476761
2025-03-13 17:40:34,376 [INFO]: }
2025-03-13 17:40:34,376 [INFO]: 	>>> Finished "Creating the index" in 75.4259 secs
2025-03-13 17:40:34,376 [INFO]: >>> Finished "Launching the whole pipeline" in 75.4583 secs
2025-03-13 17:40:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 80501 [episode count 5/20]
[retrieval_preprocessing] for episode 29819 [episode count 6/20], we have num_retrieval=np.int64(3572) num_query=np.int64(198)
2025-03-13 17:40:36,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:37,221 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:37
2025-03-13 17:40:37,221 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.88it/s]
2025-03-13 17:40:37,252 [INFO]: There are 3572 embeddings of dim 49152
2025-03-13 17:40:37,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 17:40:37,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:37
2025-03-13 17:40:37,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:37,252 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:40:37,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:37,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:40:37,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:37
2025-03-13 17:40:37,252 [INFO]: 737.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:37,252 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:40:37,252 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:37
2025-03-13 17:40:37,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:37,252 [INFO]: 	Creating the index 03/13/2025, 17:40:37
2025-03-13 17:40:37,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:37
2025-03-13 17:40:37,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:40:37,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:37
2025-03-13 17:40:37,254 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:40:37,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.25it/s] 40%|████      | 6/15 [00:00<00:00, 30.03it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.10it/s]100%|██████████| 15/15 [00:02<00:00,  3.94it/s]100%|██████████| 15/15 [00:02<00:00,  5.40it/s]
2025-03-13 17:40:40,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:40
2025-03-13 17:41:19,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4872 secs
2025-03-13 17:41:19,524 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 17:41:19,524 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.74it/s]
2025-03-13 17:41:41,029 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5049 secs
2025-03-13 17:41:41,032 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7789 secs
2025-03-13 17:41:41,033 [INFO]: {
2025-03-13 17:41:41,033 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:41,033 [INFO]: 	index_param: efSearch=179
2025-03-13 17:41:41,033 [INFO]: 	index_path: knn.index
2025-03-13 17:41:41,033 [INFO]: 	size in bytes: 702768970
2025-03-13 17:41:41,033 [INFO]: 	avg_search_speed_ms: 10.481540522727514
2025-03-13 17:41:41,033 [INFO]: 	99p_search_speed_ms: 17.22088388167322
2025-03-13 17:41:41,033 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:41,033 [INFO]: 	nb vectors: 3572
2025-03-13 17:41:41,033 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:41,033 [INFO]: 	compression ratio: 0.9993095967228035
2025-03-13 17:41:41,033 [INFO]: }
2025-03-13 17:41:41,033 [INFO]: 	>>> Finished "Creating the index" in 63.7804 secs
2025-03-13 17:41:41,033 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8118 secs
2025-03-13 17:41:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 29819 [episode count 6/20]
[retrieval_preprocessing] for episode 95438 [episode count 7/20], we have num_retrieval=np.int64(3599) num_query=np.int64(171)
2025-03-13 17:41:43,249 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:43,905 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:43
2025-03-13 17:41:43,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1043.88it/s]
2025-03-13 17:41:43,937 [INFO]: There are 3599 embeddings of dim 49152
2025-03-13 17:41:43,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 17:41:43,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:43,937 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:41:43,937 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:43,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:43,937 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,938 [INFO]: 742.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:43,938 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:43,938 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:43
2025-03-13 17:41:43,938 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:43,938 [INFO]: 	Creating the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,938 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:43
2025-03-13 17:41:43,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:41:43,939 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,939 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:41:43,939 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.88it/s] 40%|████      | 6/15 [00:00<00:00, 31.74it/s] 73%|███████▎  | 11/15 [00:00<00:00, 39.01it/s]100%|██████████| 15/15 [00:03<00:00,  2.95it/s]100%|██████████| 15/15 [00:03<00:00,  4.12it/s]
2025-03-13 17:41:47,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:47
2025-03-13 17:42:27,262 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6755 secs
2025-03-13 17:42:27,262 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:42:27,262 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 17:43:03,051 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7880 secs
2025-03-13 17:43:03,054 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.1144 secs
2025-03-13 17:43:03,054 [INFO]: {
2025-03-13 17:43:03,054 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:03,054 [INFO]: 	index_param: efSearch=184
2025-03-13 17:43:03,054 [INFO]: 	index_path: knn.index
2025-03-13 17:43:03,054 [INFO]: 	size in bytes: 708081010
2025-03-13 17:43:03,054 [INFO]: 	avg_search_speed_ms: 8.911956536190155
2025-03-13 17:43:03,054 [INFO]: 	99p_search_speed_ms: 15.741474039386944
2025-03-13 17:43:03,054 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:03,054 [INFO]: 	nb vectors: 3599
2025-03-13 17:43:03,054 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:03,054 [INFO]: 	compression ratio: 0.9993096580855911
2025-03-13 17:43:03,054 [INFO]: }
2025-03-13 17:43:03,054 [INFO]: 	>>> Finished "Creating the index" in 79.1162 secs
2025-03-13 17:43:03,054 [INFO]: >>> Finished "Launching the whole pipeline" in 79.1493 secs
2025-03-13 17:43:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 95438 [episode count 7/20]
[retrieval_preprocessing] for episode 76615 [episode count 8/20], we have num_retrieval=np.int64(3622) num_query=np.int64(148)
2025-03-13 17:43:04,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:05,771 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:05
2025-03-13 17:43:05,771 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.63it/s]
2025-03-13 17:43:05,810 [INFO]: There are 3622 embeddings of dim 49152
2025-03-13 17:43:05,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 17:43:05,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:05
2025-03-13 17:43:05,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:05,811 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:43:05,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:05,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:43:05,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:05
2025-03-13 17:43:05,812 [INFO]: 747.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:05,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:43:05,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:05
2025-03-13 17:43:05,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:05,812 [INFO]: 	Creating the index 03/13/2025, 17:43:05
2025-03-13 17:43:05,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:05
2025-03-13 17:43:05,816 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:43:05,816 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:05
2025-03-13 17:43:05,816 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:43:05,816 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.55it/s] 47%|████▋     | 7/15 [00:00<00:00, 30.93it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.48it/s]100%|██████████| 15/15 [00:03<00:00,  3.24it/s]100%|██████████| 15/15 [00:03<00:00,  4.63it/s]
2025-03-13 17:43:09,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:09
2025-03-13 17:43:48,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9941 secs
2025-03-13 17:43:48,540 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 17:43:48,540 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.48it/s]
2025-03-13 17:44:31,595 [INFO]: 	>>> Finished "Compute fast metrics" in 43.0546 secs
2025-03-13 17:44:31,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7821 secs
2025-03-13 17:44:31,598 [INFO]: {
2025-03-13 17:44:31,598 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:31,598 [INFO]: 	index_param: efSearch=262
2025-03-13 17:44:31,598 [INFO]: 	index_path: knn.index
2025-03-13 17:44:31,598 [INFO]: 	size in bytes: 712606270
2025-03-13 17:44:31,599 [INFO]: 	avg_search_speed_ms: 11.418255120430771
2025-03-13 17:44:31,599 [INFO]: 	99p_search_speed_ms: 16.11727476119995
2025-03-13 17:44:31,599 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:31,599 [INFO]: 	nb vectors: 3622
2025-03-13 17:44:31,599 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:31,599 [INFO]: 	compression ratio: 0.999309444751307
2025-03-13 17:44:31,599 [INFO]: }
2025-03-13 17:44:31,599 [INFO]: 	>>> Finished "Creating the index" in 85.7863 secs
2025-03-13 17:44:31,599 [INFO]: >>> Finished "Launching the whole pipeline" in 85.8275 secs
2025-03-13 17:44:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 76615 [episode count 8/20]
[retrieval_preprocessing] for episode 68569 [episode count 9/20], we have num_retrieval=np.int64(3609) num_query=np.int64(161)
2025-03-13 17:44:33,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:34,391 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:34
2025-03-13 17:44:34,391 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1038.97it/s]
2025-03-13 17:44:34,426 [INFO]: There are 3609 embeddings of dim 49152
2025-03-13 17:44:34,426 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 17:44:34,426 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:34
2025-03-13 17:44:34,426 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:34,426 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:44:34,426 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:34,426 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:34,427 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:34
2025-03-13 17:44:34,427 [INFO]: 744.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:34,427 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:34,427 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:34
2025-03-13 17:44:34,427 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:34,427 [INFO]: 	Creating the index 03/13/2025, 17:44:34
2025-03-13 17:44:34,427 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:34
2025-03-13 17:44:34,428 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:44:34,428 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:34
2025-03-13 17:44:34,428 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:44:34,428 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.66it/s] 40%|████      | 6/15 [00:00<00:00, 30.00it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.25it/s]100%|██████████| 15/15 [00:02<00:00,  3.65it/s]100%|██████████| 15/15 [00:02<00:00,  5.02it/s]
2025-03-13 17:44:37,419 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:37
2025-03-13 17:45:19,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4052 secs
2025-03-13 17:45:19,825 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:45:19,825 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 17:45:38,503 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6780 secs
2025-03-13 17:45:38,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0772 secs
2025-03-13 17:45:38,506 [INFO]: {
2025-03-13 17:45:38,506 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:38,506 [INFO]: 	index_param: efSearch=185
2025-03-13 17:45:38,506 [INFO]: 	index_path: knn.index
2025-03-13 17:45:38,506 [INFO]: 	size in bytes: 710048530
2025-03-13 17:45:38,506 [INFO]: 	avg_search_speed_ms: 9.084852351227624
2025-03-13 17:45:38,506 [INFO]: 	99p_search_speed_ms: 13.300348073244095
2025-03-13 17:45:38,506 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:38,506 [INFO]: 	nb vectors: 3609
2025-03-13 17:45:38,506 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:38,506 [INFO]: 	compression ratio: 0.9993095429688447
2025-03-13 17:45:38,506 [INFO]: }
2025-03-13 17:45:38,506 [INFO]: 	>>> Finished "Creating the index" in 64.0789 secs
2025-03-13 17:45:38,506 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1145 secs
2025-03-13 17:45:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 68569 [episode count 9/20]
[retrieval_preprocessing] for episode 37298 [episode count 10/20], we have num_retrieval=np.int64(3581) num_query=np.int64(189)
2025-03-13 17:45:39,981 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:40,506 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:40
2025-03-13 17:45:40,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 882.45it/s]
2025-03-13 17:45:40,538 [INFO]: There are 3581 embeddings of dim 49152
2025-03-13 17:45:40,538 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 17:45:40,539 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:40
2025-03-13 17:45:40,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:40,539 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:45:40,539 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:40,539 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:45:40,539 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:40
2025-03-13 17:45:40,540 [INFO]: 739.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:40,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:45:40,540 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:40
2025-03-13 17:45:40,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:40,540 [INFO]: 	Creating the index 03/13/2025, 17:45:40
2025-03-13 17:45:40,540 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:40
2025-03-13 17:45:40,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:45:40,543 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:40
2025-03-13 17:45:40,543 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:45:40,543 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.30it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.82it/s] 80%|████████  | 12/15 [00:00<00:00, 41.03it/s]100%|██████████| 15/15 [00:02<00:00,  5.05it/s]
2025-03-13 17:45:43,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:43
2025-03-13 17:46:23,513 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9958 secs
2025-03-13 17:46:23,513 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 17:46:23,514 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 17:46:40,205 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6915 secs
2025-03-13 17:46:40,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6645 secs
2025-03-13 17:46:40,208 [INFO]: {
2025-03-13 17:46:40,208 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:40,208 [INFO]: 	index_param: efSearch=241
2025-03-13 17:46:40,208 [INFO]: 	index_path: knn.index
2025-03-13 17:46:40,208 [INFO]: 	size in bytes: 704539630
2025-03-13 17:46:40,208 [INFO]: 	avg_search_speed_ms: 12.633945438963822
2025-03-13 17:46:40,208 [INFO]: 	99p_search_speed_ms: 17.622223261278123
2025-03-13 17:46:40,208 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:40,208 [INFO]: 	nb vectors: 3581
2025-03-13 17:46:40,208 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:40,208 [INFO]: 	compression ratio: 0.9993096456476125
2025-03-13 17:46:40,208 [INFO]: }
2025-03-13 17:46:40,208 [INFO]: 	>>> Finished "Creating the index" in 59.6674 secs
2025-03-13 17:46:40,208 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7021 secs
2025-03-13 17:46:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 37298 [episode count 10/20]
[retrieval_preprocessing] for episode 56759 [episode count 11/20], we have num_retrieval=np.int64(3584) num_query=np.int64(186)
2025-03-13 17:46:42,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:43,174 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:43
2025-03-13 17:46:43,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2369.66it/s]
2025-03-13 17:46:43,201 [INFO]: There are 3584 embeddings of dim 49152
2025-03-13 17:46:43,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:46:43,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:43
2025-03-13 17:46:43,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:43,201 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:46:43,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:43,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:43,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:43
2025-03-13 17:46:43,201 [INFO]: 739.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:43,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:43,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:43
2025-03-13 17:46:43,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:43,201 [INFO]: 	Creating the index 03/13/2025, 17:46:43
2025-03-13 17:46:43,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:43
2025-03-13 17:46:43,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:46:43,202 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:43
2025-03-13 17:46:43,203 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:46:43,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.79it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.42it/s] 80%|████████  | 12/15 [00:00<00:00, 39.19it/s]100%|██████████| 15/15 [00:03<00:00,  4.78it/s]
2025-03-13 17:46:46,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:46
2025-03-13 17:47:25,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2539 secs
2025-03-13 17:47:25,600 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 17:47:25,600 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-13 17:47:50,691 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0909 secs
2025-03-13 17:47:51,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9518 secs
2025-03-13 17:47:51,155 [INFO]: {
2025-03-13 17:47:51,155 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:51,155 [INFO]: 	index_param: efSearch=237
2025-03-13 17:47:51,155 [INFO]: 	index_path: knn.index
2025-03-13 17:47:51,155 [INFO]: 	size in bytes: 705129850
2025-03-13 17:47:51,155 [INFO]: 	avg_search_speed_ms: 8.775425060211044
2025-03-13 17:47:51,155 [INFO]: 	99p_search_speed_ms: 11.746832721400997
2025-03-13 17:47:51,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:51,155 [INFO]: 	nb vectors: 3584
2025-03-13 17:47:51,155 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:51,155 [INFO]: 	compression ratio: 0.9993096619012796
2025-03-13 17:47:51,155 [INFO]: }
2025-03-13 17:47:51,155 [INFO]: 	>>> Finished "Creating the index" in 67.9540 secs
2025-03-13 17:47:51,155 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9811 secs
2025-03-13 17:47:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 56759 [episode count 11/20]
[retrieval_preprocessing] for episode 5621 [episode count 12/20], we have num_retrieval=np.int64(3583) num_query=np.int64(187)
2025-03-13 17:47:52,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:53,359 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:53
2025-03-13 17:47:53,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1523.54it/s]
2025-03-13 17:47:53,388 [INFO]: There are 3583 embeddings of dim 49152
2025-03-13 17:47:53,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 17:47:53,388 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:53
2025-03-13 17:47:53,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:53,389 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:47:53,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:53,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:53,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:53
2025-03-13 17:47:53,389 [INFO]: 739.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:53,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:47:53,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:53
2025-03-13 17:47:53,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:53,389 [INFO]: 	Creating the index 03/13/2025, 17:47:53
2025-03-13 17:47:53,389 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:53
2025-03-13 17:47:53,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:47:53,390 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:53
2025-03-13 17:47:53,390 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:47:53,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.80it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.16it/s] 87%|████████▋ | 13/15 [00:00<00:00, 40.57it/s]100%|██████████| 15/15 [00:03<00:00,  4.93it/s]
2025-03-13 17:47:56,434 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:56
2025-03-13 17:48:31,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5448 secs
2025-03-13 17:48:31,980 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 17:48:31,980 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.21it/s]
2025-03-13 17:48:55,441 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4611 secs
2025-03-13 17:48:55,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0532 secs
2025-03-13 17:48:55,443 [INFO]: {
2025-03-13 17:48:55,443 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:55,443 [INFO]: 	index_param: efSearch=249
2025-03-13 17:48:55,443 [INFO]: 	index_path: knn.index
2025-03-13 17:48:55,443 [INFO]: 	size in bytes: 704933110
2025-03-13 17:48:55,443 [INFO]: 	avg_search_speed_ms: 13.741211485307009
2025-03-13 17:48:55,443 [INFO]: 	99p_search_speed_ms: 22.814368952531368
2025-03-13 17:48:55,443 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:55,443 [INFO]: 	nb vectors: 3583
2025-03-13 17:48:55,443 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:55,444 [INFO]: 	compression ratio: 0.9993096564864147
2025-03-13 17:48:55,444 [INFO]: }
2025-03-13 17:48:55,444 [INFO]: 	>>> Finished "Creating the index" in 62.0546 secs
2025-03-13 17:48:55,444 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0849 secs
2025-03-13 17:48:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 5621 [episode count 12/20]
[retrieval_preprocessing] for episode 45428 [episode count 13/20], we have num_retrieval=np.int64(3618) num_query=np.int64(152)
2025-03-13 17:48:57,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:58,404 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:58
2025-03-13 17:48:58,404 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1708.47it/s]
2025-03-13 17:48:58,438 [INFO]: There are 3618 embeddings of dim 49152
2025-03-13 17:48:58,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 17:48:58,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:58
2025-03-13 17:48:58,439 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:58,439 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:48:58,439 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:58,439 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:48:58,439 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:58
2025-03-13 17:48:58,439 [INFO]: 746.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:58,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:48:58,439 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:58
2025-03-13 17:48:58,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:58,439 [INFO]: 	Creating the index 03/13/2025, 17:48:58
2025-03-13 17:48:58,440 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:58
2025-03-13 17:48:58,441 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:48:58,442 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:58
2025-03-13 17:48:58,442 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:48:58,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.51it/s] 27%|██▋       | 4/15 [00:00<00:00, 19.93it/s] 60%|██████    | 9/15 [00:00<00:00, 30.13it/s] 93%|█████████▎| 14/15 [00:00<00:00, 34.52it/s]100%|██████████| 15/15 [00:03<00:00,  4.45it/s]
2025-03-13 17:49:01,819 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:01
2025-03-13 17:49:39,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9884 secs
2025-03-13 17:49:39,808 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 17:49:39,808 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.47it/s]
2025-03-13 17:50:10,074 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2661 secs
2025-03-13 17:50:10,076 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6342 secs
2025-03-13 17:50:10,076 [INFO]: {
2025-03-13 17:50:10,076 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:10,076 [INFO]: 	index_param: efSearch=208
2025-03-13 17:50:10,076 [INFO]: 	index_path: knn.index
2025-03-13 17:50:10,076 [INFO]: 	size in bytes: 711819310
2025-03-13 17:50:10,076 [INFO]: 	avg_search_speed_ms: 7.547867917367872
2025-03-13 17:50:10,076 [INFO]: 	99p_search_speed_ms: 10.37762283347547
2025-03-13 17:50:10,076 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:10,076 [INFO]: 	nb vectors: 3618
2025-03-13 17:50:10,076 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:10,076 [INFO]: 	compression ratio: 0.9993094230613103
2025-03-13 17:50:10,076 [INFO]: }
2025-03-13 17:50:10,076 [INFO]: 	>>> Finished "Creating the index" in 71.6369 secs
2025-03-13 17:50:10,076 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6721 secs
2025-03-13 17:50:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 45428 [episode count 13/20]
[retrieval_preprocessing] for episode 44442 [episode count 14/20], we have num_retrieval=np.int64(3553) num_query=np.int64(217)
2025-03-13 17:50:11,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:11,730 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:11
2025-03-13 17:50:11,730 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.17it/s]
2025-03-13 17:50:11,758 [INFO]: There are 3553 embeddings of dim 49152
2025-03-13 17:50:11,759 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:50:11,759 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:11
2025-03-13 17:50:11,759 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:11,759 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:50:11,759 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:11,759 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:50:11,759 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:11
2025-03-13 17:50:11,759 [INFO]: 733.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:11,759 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:50:11,759 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:11
2025-03-13 17:50:11,759 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:11,759 [INFO]: 	Creating the index 03/13/2025, 17:50:11
2025-03-13 17:50:11,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:11
2025-03-13 17:50:11,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:50:11,760 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:11
2025-03-13 17:50:11,760 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:50:11,760 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.76it/s] 50%|█████     | 7/14 [00:00<00:00, 36.87it/s] 93%|█████████▎| 13/14 [00:00<00:00, 45.31it/s]100%|██████████| 14/14 [00:02<00:00,  5.55it/s]
2025-03-13 17:50:14,287 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:14
2025-03-13 17:50:54,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8511 secs
2025-03-13 17:50:54,139 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 17:50:54,139 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.81it/s]
2025-03-13 17:51:17,373 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2336 secs
2025-03-13 17:51:17,376 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6153 secs
2025-03-13 17:51:17,376 [INFO]: {
2025-03-13 17:51:17,376 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:17,376 [INFO]: 	index_param: efSearch=210
2025-03-13 17:51:17,376 [INFO]: 	index_path: knn.index
2025-03-13 17:51:17,376 [INFO]: 	size in bytes: 699030910
2025-03-13 17:51:17,376 [INFO]: 	avg_search_speed_ms: 9.342999598202683
2025-03-13 17:51:17,376 [INFO]: 	99p_search_speed_ms: 12.291113683022555
2025-03-13 17:51:17,376 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:17,376 [INFO]: 	nb vectors: 3553
2025-03-13 17:51:17,376 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:17,376 [INFO]: 	compression ratio: 0.9993094926231517
2025-03-13 17:51:17,376 [INFO]: }
2025-03-13 17:51:17,376 [INFO]: 	>>> Finished "Creating the index" in 65.6167 secs
2025-03-13 17:51:17,376 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6459 secs
2025-03-13 17:51:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 44442 [episode count 14/20]
[retrieval_preprocessing] for episode 67411 [episode count 15/20], we have num_retrieval=np.int64(3599) num_query=np.int64(171)
2025-03-13 17:51:19,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:19,875 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:19
2025-03-13 17:51:19,875 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.45it/s]
2025-03-13 17:51:19,906 [INFO]: There are 3599 embeddings of dim 49152
2025-03-13 17:51:19,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 17:51:19,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:19
2025-03-13 17:51:19,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:19,907 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:51:19,907 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:19,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:51:19,907 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:19
2025-03-13 17:51:19,907 [INFO]: 742.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:19,907 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:51:19,907 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:19
2025-03-13 17:51:19,907 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:19,907 [INFO]: 	Creating the index 03/13/2025, 17:51:19
2025-03-13 17:51:19,907 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:19
2025-03-13 17:51:19,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:51:19,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:19
2025-03-13 17:51:19,908 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:51:19,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.95it/s] 40%|████      | 6/15 [00:00<00:00, 29.98it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.86it/s]100%|██████████| 15/15 [00:02<00:00,  3.74it/s]100%|██████████| 15/15 [00:02<00:00,  5.14it/s]
2025-03-13 17:51:22,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:22
2025-03-13 17:52:00,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1141 secs
2025-03-13 17:52:00,943 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 17:52:00,943 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.42it/s]
2025-03-13 17:52:19,098 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1545 secs
2025-03-13 17:52:19,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1922 secs
2025-03-13 17:52:19,101 [INFO]: {
2025-03-13 17:52:19,101 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:19,101 [INFO]: 	index_param: efSearch=254
2025-03-13 17:52:19,101 [INFO]: 	index_path: knn.index
2025-03-13 17:52:19,101 [INFO]: 	size in bytes: 708081010
2025-03-13 17:52:19,101 [INFO]: 	avg_search_speed_ms: 12.879026927859396
2025-03-13 17:52:19,101 [INFO]: 	99p_search_speed_ms: 17.65639933757484
2025-03-13 17:52:19,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:19,101 [INFO]: 	nb vectors: 3599
2025-03-13 17:52:19,101 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:19,101 [INFO]: 	compression ratio: 0.9993096580855911
2025-03-13 17:52:19,101 [INFO]: }
2025-03-13 17:52:19,101 [INFO]: 	>>> Finished "Creating the index" in 59.1937 secs
2025-03-13 17:52:19,101 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2259 secs
2025-03-13 17:52:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 67411 [episode count 15/20]
[retrieval_preprocessing] for episode 77528 [episode count 16/20], we have num_retrieval=np.int64(3610) num_query=np.int64(160)
2025-03-13 17:52:24,990 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:26,473 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:26
2025-03-13 17:52:26,474 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.84it/s]
2025-03-13 17:52:26,509 [INFO]: There are 3610 embeddings of dim 49152
2025-03-13 17:52:26,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 17:52:26,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:26
2025-03-13 17:52:26,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:26,510 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:52:26,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:26,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:52:26,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:26
2025-03-13 17:52:26,510 [INFO]: 745.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:26,510 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:52:26,510 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:26
2025-03-13 17:52:26,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:26,511 [INFO]: 	Creating the index 03/13/2025, 17:52:26
2025-03-13 17:52:26,511 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:26
2025-03-13 17:52:26,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:52:26,512 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:26
2025-03-13 17:52:26,512 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:52:26,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.26it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.78it/s] 20%|██        | 3/15 [00:00<00:01,  6.67it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.27it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.78it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.04it/s] 60%|██████    | 9/15 [00:01<00:00,  9.53it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.41it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.26it/s] 80%|████████  | 12/15 [00:01<00:00,  9.17it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.33it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.22it/s]100%|██████████| 15/15 [00:05<00:00,  1.07s/it]100%|██████████| 15/15 [00:05<00:00,  2.93it/s]
2025-03-13 17:52:31,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:31
2025-03-13 17:53:15,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0592 secs
2025-03-13 17:53:15,705 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 17:53:15,705 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-13 17:53:36,217 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5113 secs
2025-03-13 17:53:36,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3060 secs
2025-03-13 17:53:36,819 [INFO]: {
2025-03-13 17:53:36,820 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:36,820 [INFO]: 	index_param: efSearch=229
2025-03-13 17:53:36,820 [INFO]: 	index_path: knn.index
2025-03-13 17:53:36,820 [INFO]: 	size in bytes: 710245270
2025-03-13 17:53:36,820 [INFO]: 	avg_search_speed_ms: 10.295262269150124
2025-03-13 17:53:36,820 [INFO]: 	99p_search_speed_ms: 14.354769513010975
2025-03-13 17:53:36,820 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:36,820 [INFO]: 	nb vectors: 3610
2025-03-13 17:53:36,820 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:36,820 [INFO]: 	compression ratio: 0.9993095483761546
2025-03-13 17:53:36,820 [INFO]: }
2025-03-13 17:53:36,820 [INFO]: 	>>> Finished "Creating the index" in 70.3095 secs
2025-03-13 17:53:36,820 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3466 secs
2025-03-13 17:53:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 77528 [episode count 16/20]
[retrieval_preprocessing] for episode 6374 [episode count 17/20], we have num_retrieval=np.int64(3596) num_query=np.int64(174)
2025-03-13 17:53:38,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:39,525 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:39
2025-03-13 17:53:39,526 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2060.07it/s]
2025-03-13 17:53:39,558 [INFO]: There are 3596 embeddings of dim 49152
2025-03-13 17:53:39,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 17:53:39,558 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:39
2025-03-13 17:53:39,558 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:39,558 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:53:39,558 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:39,558 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:39,558 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:39
2025-03-13 17:53:39,558 [INFO]: 742.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:39,558 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:39,558 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:39
2025-03-13 17:53:39,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:39,559 [INFO]: 	Creating the index 03/13/2025, 17:53:39
2025-03-13 17:53:39,559 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:39
2025-03-13 17:53:39,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:53:39,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:39
2025-03-13 17:53:39,560 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:53:39,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.00it/s] 40%|████      | 6/15 [00:00<00:00, 30.39it/s] 80%|████████  | 12/15 [00:00<00:00, 39.81it/s]100%|██████████| 15/15 [00:02<00:00,  5.21it/s]
2025-03-13 17:53:42,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:42
2025-03-13 17:54:18,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1033 secs
2025-03-13 17:54:18,549 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:54:18,549 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 17:54:50,533 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9844 secs
2025-03-13 17:54:50,535 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9751 secs
2025-03-13 17:54:50,535 [INFO]: {
2025-03-13 17:54:50,535 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:50,535 [INFO]: 	index_param: efSearch=170
2025-03-13 17:54:50,535 [INFO]: 	index_path: knn.index
2025-03-13 17:54:50,535 [INFO]: 	size in bytes: 707490790
2025-03-13 17:54:50,536 [INFO]: 	avg_search_speed_ms: 7.204466212543549
2025-03-13 17:54:50,536 [INFO]: 	99p_search_speed_ms: 11.077898771036415
2025-03-13 17:54:50,536 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:50,536 [INFO]: 	nb vectors: 3596
2025-03-13 17:54:50,536 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:50,536 [INFO]: 	compression ratio: 0.9993096418965397
2025-03-13 17:54:50,536 [INFO]: }
2025-03-13 17:54:50,536 [INFO]: 	>>> Finished "Creating the index" in 70.9769 secs
2025-03-13 17:54:50,536 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0101 secs
2025-03-13 17:54:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 6374 [episode count 17/20]
[retrieval_preprocessing] for episode 42886 [episode count 18/20], we have num_retrieval=np.int64(3562) num_query=np.int64(208)
2025-03-13 17:54:51,963 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:52,609 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:52
2025-03-13 17:54:52,610 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.89it/s]
2025-03-13 17:54:52,644 [INFO]: There are 3562 embeddings of dim 49152
2025-03-13 17:54:52,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 17:54:52,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:52
2025-03-13 17:54:52,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:52,645 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:54:52,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:52,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:54:52,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:52
2025-03-13 17:54:52,646 [INFO]: 735.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:52,646 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:54:52,646 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:52
2025-03-13 17:54:52,646 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:52,647 [INFO]: 	Creating the index 03/13/2025, 17:54:52
2025-03-13 17:54:52,647 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:52
2025-03-13 17:54:52,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 17:54:52,650 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:52
2025-03-13 17:54:52,650 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:54:52,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.99it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.59it/s] 80%|████████  | 12/15 [00:00<00:00, 41.70it/s]100%|██████████| 15/15 [00:02<00:00,  6.07it/s]
2025-03-13 17:54:55,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:55
2025-03-13 17:55:31,388 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7350 secs
2025-03-13 17:55:31,388 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 17:55:31,388 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.60it/s]
2025-03-13 17:55:55,426 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0374 secs
2025-03-13 17:55:55,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7787 secs
2025-03-13 17:55:55,429 [INFO]: {
2025-03-13 17:55:55,429 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:55,429 [INFO]: 	index_param: efSearch=209
2025-03-13 17:55:55,429 [INFO]: 	index_path: knn.index
2025-03-13 17:55:55,429 [INFO]: 	size in bytes: 700801570
2025-03-13 17:55:55,429 [INFO]: 	avg_search_speed_ms: 11.123767620920141
2025-03-13 17:55:55,429 [INFO]: 	99p_search_speed_ms: 23.2391097722575
2025-03-13 17:55:55,429 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:55,429 [INFO]: 	nb vectors: 3562
2025-03-13 17:55:55,429 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:55,430 [INFO]: 	compression ratio: 0.9993095420719449
2025-03-13 17:55:55,430 [INFO]: }
2025-03-13 17:55:55,430 [INFO]: 	>>> Finished "Creating the index" in 62.7828 secs
2025-03-13 17:55:55,430 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8201 secs
2025-03-13 17:55:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 42886 [episode count 18/20]
[retrieval_preprocessing] for episode 9678 [episode count 19/20], we have num_retrieval=np.int64(3520) num_query=np.int64(250)
2025-03-13 17:55:57,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:59,223 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:59
2025-03-13 17:55:59,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1304.60it/s]
2025-03-13 17:55:59,256 [INFO]: There are 3520 embeddings of dim 49152
2025-03-13 17:55:59,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 17:55:59,257 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:59,257 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:55:59,257 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:59,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:59,257 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,257 [INFO]: 726.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:59,257 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:59,257 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:59
2025-03-13 17:55:59,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:59,257 [INFO]: 	Creating the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,257 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:59
2025-03-13 17:55:59,258 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:55:59,258 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,258 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:55:59,258 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.14it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.11it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.14it/s]100%|██████████| 14/14 [00:03<00:00,  4.09it/s]
2025-03-13 17:56:02,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:02
2025-03-13 17:56:43,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3743 secs
2025-03-13 17:56:43,061 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:56:43,062 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.58it/s]
2025-03-13 17:57:13,937 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8757 secs
2025-03-13 17:57:13,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6812 secs
2025-03-13 17:57:13,940 [INFO]: {
2025-03-13 17:57:13,940 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:13,940 [INFO]: 	index_param: efSearch=223
2025-03-13 17:57:13,940 [INFO]: 	index_path: knn.index
2025-03-13 17:57:13,940 [INFO]: 	size in bytes: 692538310
2025-03-13 17:57:13,940 [INFO]: 	avg_search_speed_ms: 8.99424739186183
2025-03-13 17:57:13,940 [INFO]: 	99p_search_speed_ms: 12.83392280340196
2025-03-13 17:57:13,940 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:13,940 [INFO]: 	nb vectors: 3520
2025-03-13 17:57:13,940 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:13,940 [INFO]: 	compression ratio: 0.9993095688814674
2025-03-13 17:57:13,940 [INFO]: }
2025-03-13 17:57:13,940 [INFO]: 	>>> Finished "Creating the index" in 74.6828 secs
2025-03-13 17:57:13,940 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7165 secs
2025-03-13 17:57:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 9678 [episode count 19/20]
2025-03-13 17:57:15: [retrieval_preprocessing] finished for 1477699675_put_marker_in_mug [chosen_id count 8/196]
2025-03-13 17:57:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1477699675_put_spoon_in_mug [chosen_id count 9/196]
2025-03-13 17:57:17: [retrieval_preprocessing] we have num_total=5078 embedding_dim=49152
[retrieval_preprocessing] for episode 37914 [episode count 0/20], we have num_retrieval=np.int64(4859) num_query=np.int64(219)
2025-03-13 17:57:18,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:18,864 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:18
2025-03-13 17:57:18,865 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.04it/s]
2025-03-13 17:57:18,892 [INFO]: There are 4859 embeddings of dim 49152
2025-03-13 17:57:18,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:57:18,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:18,893 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:57:18,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:18,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:57:18,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,893 [INFO]: 1002.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:18,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:18,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:18
2025-03-13 17:57:18,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:18,893 [INFO]: 	Creating the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:18
2025-03-13 17:57:18,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:57:18,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,895 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:57:18,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.78it/s] 30%|███       | 6/20 [00:00<00:00, 30.48it/s] 55%|█████▌    | 11/20 [00:00<00:00, 38.37it/s] 80%|████████  | 16/20 [00:00<00:00, 42.02it/s]100%|██████████| 20/20 [00:04<00:00,  4.36it/s]
2025-03-13 17:57:23,485 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:23
2025-03-13 17:58:11,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9330 secs
2025-03-13 17:58:11,419 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 17:58:11,419 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.43it/s]
2025-03-13 17:58:43,195 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7765 secs
2025-03-13 17:58:43,198 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.3034 secs
2025-03-13 17:58:43,199 [INFO]: {
2025-03-13 17:58:43,199 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:43,199 [INFO]: 	index_param: efSearch=159
2025-03-13 17:58:43,199 [INFO]: 	index_path: knn.index
2025-03-13 17:58:43,199 [INFO]: 	size in bytes: 955979170
2025-03-13 17:58:43,199 [INFO]: 	avg_search_speed_ms: 9.271227609645834
2025-03-13 17:58:43,199 [INFO]: 	99p_search_speed_ms: 16.136664883233607
2025-03-13 17:58:43,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:43,199 [INFO]: 	nb vectors: 4859
2025-03-13 17:58:43,199 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:43,199 [INFO]: 	compression ratio: 0.9993086690372134
2025-03-13 17:58:43,199 [INFO]: }
2025-03-13 17:58:43,199 [INFO]: 	>>> Finished "Creating the index" in 84.3055 secs
2025-03-13 17:58:43,199 [INFO]: >>> Finished "Launching the whole pipeline" in 84.3343 secs
2025-03-13 17:58:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 37914 [episode count 0/20]
[retrieval_preprocessing] for episode 39991 [episode count 1/20], we have num_retrieval=np.int64(4830) num_query=np.int64(248)
2025-03-13 17:58:45,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:45,687 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:45
2025-03-13 17:58:45,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.53it/s]
2025-03-13 17:58:45,711 [INFO]: There are 4830 embeddings of dim 49152
2025-03-13 17:58:45,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 17:58:45,711 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:45
2025-03-13 17:58:45,711 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:45,711 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 17:58:45,711 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:45,711 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:45,711 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:45
2025-03-13 17:58:45,712 [INFO]: 996.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:45,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:58:45,712 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:45
2025-03-13 17:58:45,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:45,712 [INFO]: 	Creating the index 03/13/2025, 17:58:45
2025-03-13 17:58:45,712 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:45
2025-03-13 17:58:45,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:58:45,713 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:45
2025-03-13 17:58:45,713 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:58:45,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.88it/s] 30%|███       | 6/20 [00:00<00:00, 30.82it/s] 55%|█████▌    | 11/20 [00:00<00:00, 38.27it/s] 80%|████████  | 16/20 [00:00<00:00, 42.13it/s]100%|██████████| 20/20 [00:04<00:00,  4.70it/s]
2025-03-13 17:58:49,972 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:49
2025-03-13 17:59:38,117 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1446 secs
2025-03-13 17:59:38,117 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 17:59:38,117 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 18:00:07,608 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4909 secs
2025-03-13 18:00:07,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.8983 secs
2025-03-13 18:00:07,611 [INFO]: {
2025-03-13 18:00:07,612 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:07,612 [INFO]: 	index_param: efSearch=211
2025-03-13 18:00:07,612 [INFO]: 	index_path: knn.index
2025-03-13 18:00:07,612 [INFO]: 	size in bytes: 950273650
2025-03-13 18:00:07,612 [INFO]: 	avg_search_speed_ms: 13.733247286066986
2025-03-13 18:00:07,612 [INFO]: 	99p_search_speed_ms: 25.640826562885195
2025-03-13 18:00:07,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:07,612 [INFO]: 	nb vectors: 4830
2025-03-13 18:00:07,612 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:07,612 [INFO]: 	compression ratio: 0.999308609683116
2025-03-13 18:00:07,612 [INFO]: }
2025-03-13 18:00:07,612 [INFO]: 	>>> Finished "Creating the index" in 81.8999 secs
2025-03-13 18:00:07,612 [INFO]: >>> Finished "Launching the whole pipeline" in 81.9250 secs
2025-03-13 18:00:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 39991 [episode count 1/20]
[retrieval_preprocessing] for episode 80003 [episode count 2/20], we have num_retrieval=np.int64(4733) num_query=np.int64(345)
2025-03-13 18:00:10,010 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:10,720 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:10
2025-03-13 18:00:10,720 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.96it/s]
2025-03-13 18:00:10,749 [INFO]: There are 4733 embeddings of dim 49152
2025-03-13 18:00:10,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:00:10,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:10
2025-03-13 18:00:10,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:10,750 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:00:10,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:10,751 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:00:10,751 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:10
2025-03-13 18:00:10,751 [INFO]: 976.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:10,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:00:10,752 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:10
2025-03-13 18:00:10,752 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:10,752 [INFO]: 	Creating the index 03/13/2025, 18:00:10
2025-03-13 18:00:10,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:10
2025-03-13 18:00:10,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:00:10,756 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:10
2025-03-13 18:00:10,756 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:00:10,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.09it/s] 37%|███▋      | 7/19 [00:00<00:00, 34.91it/s] 63%|██████▎   | 12/19 [00:00<00:00, 40.42it/s] 89%|████████▉ | 17/19 [00:00<00:00, 43.15it/s]100%|██████████| 19/19 [00:04<00:00,  4.63it/s]
2025-03-13 18:00:15,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:15
2025-03-13 18:01:04,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2977 secs
2025-03-13 18:01:04,399 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:01:04,399 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 18:01:34,124 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7253 secs
2025-03-13 18:01:34,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3722 secs
2025-03-13 18:01:34,128 [INFO]: {
2025-03-13 18:01:34,128 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:34,128 [INFO]: 	index_param: efSearch=224
2025-03-13 18:01:34,128 [INFO]: 	index_path: knn.index
2025-03-13 18:01:34,128 [INFO]: 	size in bytes: 931189390
2025-03-13 18:01:34,128 [INFO]: 	avg_search_speed_ms: 11.3082037633548
2025-03-13 18:01:34,128 [INFO]: 	99p_search_speed_ms: 18.4760592225939
2025-03-13 18:01:34,128 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:34,128 [INFO]: 	nb vectors: 4733
2025-03-13 18:01:34,128 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:34,128 [INFO]: 	compression ratio: 0.9993087056114331
2025-03-13 18:01:34,128 [INFO]: }
2025-03-13 18:01:34,128 [INFO]: 	>>> Finished "Creating the index" in 83.3764 secs
2025-03-13 18:01:34,129 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4082 secs
2025-03-13 18:01:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 80003 [episode count 2/20]
[retrieval_preprocessing] for episode 94340 [episode count 3/20], we have num_retrieval=np.int64(4800) num_query=np.int64(278)
2025-03-13 18:01:37,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:38,591 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:38
2025-03-13 18:01:38,591 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 886.18it/s]
2025-03-13 18:01:38,630 [INFO]: There are 4800 embeddings of dim 49152
2025-03-13 18:01:38,630 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 18:01:38,630 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:38
2025-03-13 18:01:38,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:38,631 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:01:38,631 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:38,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:01:38,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:38
2025-03-13 18:01:38,631 [INFO]: 990.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:38,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:01:38,632 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:38
2025-03-13 18:01:38,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:38,632 [INFO]: 	Creating the index 03/13/2025, 18:01:38
2025-03-13 18:01:38,633 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:38
2025-03-13 18:01:38,636 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:01:38,636 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:38
2025-03-13 18:01:38,636 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:01:38,636 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.93it/s] 37%|███▋      | 7/19 [00:00<00:00, 36.30it/s] 68%|██████▊   | 13/19 [00:00<00:00, 43.09it/s]100%|██████████| 19/19 [00:04<00:00,  3.15it/s]100%|██████████| 19/19 [00:04<00:00,  4.33it/s]
2025-03-13 18:01:43,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:43
2025-03-13 18:02:27,195 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1627 secs
2025-03-13 18:02:27,195 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:02:27,195 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 18:02:56,618 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4229 secs
2025-03-13 18:02:56,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9857 secs
2025-03-13 18:02:56,622 [INFO]: {
2025-03-13 18:02:56,622 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:56,622 [INFO]: 	index_param: efSearch=222
2025-03-13 18:02:56,622 [INFO]: 	index_path: knn.index
2025-03-13 18:02:56,622 [INFO]: 	size in bytes: 944371270
2025-03-13 18:02:56,622 [INFO]: 	avg_search_speed_ms: 13.873865848262477
2025-03-13 18:02:56,622 [INFO]: 	99p_search_speed_ms: 21.360839437693347
2025-03-13 18:02:56,622 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:56,622 [INFO]: 	nb vectors: 4800
2025-03-13 18:02:56,622 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:56,622 [INFO]: 	compression ratio: 0.9993086723190976
2025-03-13 18:02:56,622 [INFO]: }
2025-03-13 18:02:56,622 [INFO]: 	>>> Finished "Creating the index" in 77.9899 secs
2025-03-13 18:02:56,622 [INFO]: >>> Finished "Launching the whole pipeline" in 78.0315 secs
2025-03-13 18:02:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 94340 [episode count 3/20]
[retrieval_preprocessing] for episode 39057 [episode count 4/20], we have num_retrieval=np.int64(4829) num_query=np.int64(249)
2025-03-13 18:02:59,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:00,402 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:00
2025-03-13 18:03:00,402 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1884.23it/s]
2025-03-13 18:03:00,425 [INFO]: There are 4829 embeddings of dim 49152
2025-03-13 18:03:00,425 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 18:03:00,425 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,426 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:00,426 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:03:00,426 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:00,426 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:00,426 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,426 [INFO]: 996.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:00,426 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:03:00,426 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:00
2025-03-13 18:03:00,426 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:00,426 [INFO]: 	Creating the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,426 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:00
2025-03-13 18:03:00,427 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:03:00,427 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,427 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:03:00,427 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.06it/s] 25%|██▌       | 5/20 [00:00<00:00, 24.72it/s] 50%|█████     | 10/20 [00:00<00:00, 33.53it/s] 75%|███████▌  | 15/20 [00:00<00:00, 37.05it/s] 95%|█████████▌| 19/20 [00:00<00:00, 37.98it/s]100%|██████████| 20/20 [00:04<00:00,  4.35it/s]
2025-03-13 18:03:05,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:05
2025-03-13 18:04:00,697 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6650 secs
2025-03-13 18:04:00,697 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:04:00,697 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 18:04:28,565 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8676 secs
2025-03-13 18:04:28,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1425 secs
2025-03-13 18:04:28,570 [INFO]: {
2025-03-13 18:04:28,570 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:28,570 [INFO]: 	index_param: efSearch=211
2025-03-13 18:04:28,570 [INFO]: 	index_path: knn.index
2025-03-13 18:04:28,570 [INFO]: 	size in bytes: 950076910
2025-03-13 18:04:28,570 [INFO]: 	avg_search_speed_ms: 11.945816422306367
2025-03-13 18:04:28,570 [INFO]: 	99p_search_speed_ms: 18.928902382031083
2025-03-13 18:04:28,570 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:28,570 [INFO]: 	nb vectors: 4829
2025-03-13 18:04:28,570 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:28,570 [INFO]: 	compression ratio: 0.9993086054475316
2025-03-13 18:04:28,570 [INFO]: }
2025-03-13 18:04:28,570 [INFO]: 	>>> Finished "Creating the index" in 88.1441 secs
2025-03-13 18:04:28,570 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1679 secs
2025-03-13 18:04:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 39057 [episode count 4/20]
[retrieval_preprocessing] for episode 92304 [episode count 5/20], we have num_retrieval=np.int64(4751) num_query=np.int64(327)
2025-03-13 18:04:31,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:32,546 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:32
2025-03-13 18:04:32,547 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 985.27it/s]
2025-03-13 18:04:32,584 [INFO]: There are 4751 embeddings of dim 49152
2025-03-13 18:04:32,585 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 18:04:32,585 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:32
2025-03-13 18:04:32,585 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:32,585 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:04:32,585 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:32,585 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:04:32,585 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:32
2025-03-13 18:04:32,586 [INFO]: 980.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:32,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:04:32,586 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:32
2025-03-13 18:04:32,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:32,586 [INFO]: 	Creating the index 03/13/2025, 18:04:32
2025-03-13 18:04:32,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:32
2025-03-13 18:04:32,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:04:32,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:32
2025-03-13 18:04:32,589 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:04:32,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.04it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.66it/s] 53%|█████▎    | 10/19 [00:00<00:00, 33.53it/s] 79%|███████▉  | 15/19 [00:00<00:00, 36.23it/s]100%|██████████| 19/19 [00:04<00:00,  2.65it/s]100%|██████████| 19/19 [00:04<00:00,  4.20it/s]
2025-03-13 18:04:37,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:37
2025-03-13 18:05:28,549 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3882 secs
2025-03-13 18:05:28,549 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 18:05:28,550 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
2025-03-13 18:05:58,225 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6756 secs
2025-03-13 18:05:58,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.2830 secs
2025-03-13 18:05:58,873 [INFO]: {
2025-03-13 18:05:58,873 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:58,873 [INFO]: 	index_param: efSearch=154
2025-03-13 18:05:58,873 [INFO]: 	index_path: knn.index
2025-03-13 18:05:58,873 [INFO]: 	size in bytes: 934730770
2025-03-13 18:05:58,873 [INFO]: 	avg_search_speed_ms: 9.028394601479281
2025-03-13 18:05:58,873 [INFO]: 	99p_search_speed_ms: 13.782694470137361
2025-03-13 18:05:58,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:58,873 [INFO]: 	nb vectors: 4751
2025-03-13 18:05:58,873 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:58,873 [INFO]: 	compression ratio: 0.999308718594981
2025-03-13 18:05:58,873 [INFO]: }
2025-03-13 18:05:58,873 [INFO]: 	>>> Finished "Creating the index" in 86.2868 secs
2025-03-13 18:05:58,873 [INFO]: >>> Finished "Launching the whole pipeline" in 86.3269 secs
2025-03-13 18:05:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 92304 [episode count 5/20]
[retrieval_preprocessing] for episode 13979 [episode count 6/20], we have num_retrieval=np.int64(4819) num_query=np.int64(259)
2025-03-13 18:06:01,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:02,012 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:02
2025-03-13 18:06:02,012 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.00it/s]
2025-03-13 18:06:02,049 [INFO]: There are 4819 embeddings of dim 49152
2025-03-13 18:06:02,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 18:06:02,050 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:02
2025-03-13 18:06:02,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:02,050 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:06:02,050 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:02,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:06:02,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:02
2025-03-13 18:06:02,050 [INFO]: 994.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:02,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:06:02,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:02
2025-03-13 18:06:02,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:02,051 [INFO]: 	Creating the index 03/13/2025, 18:06:02
2025-03-13 18:06:02,052 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:02
2025-03-13 18:06:02,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:06:02,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:02
2025-03-13 18:06:02,055 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:06:02,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.77it/s] 42%|████▏     | 8/19 [00:00<00:00, 40.02it/s] 74%|███████▎  | 14/19 [00:00<00:00, 45.61it/s]100%|██████████| 19/19 [00:03<00:00,  3.55it/s]100%|██████████| 19/19 [00:03<00:00,  5.03it/s]
2025-03-13 18:06:05,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:05
2025-03-13 18:07:08,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.5782 secs
2025-03-13 18:07:08,416 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 18:07:08,416 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.28it/s]
2025-03-13 18:07:30,433 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0168 secs
2025-03-13 18:07:30,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.7582 secs
2025-03-13 18:07:30,814 [INFO]: {
2025-03-13 18:07:30,814 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:30,814 [INFO]: 	index_param: efSearch=139
2025-03-13 18:07:30,814 [INFO]: 	index_path: knn.index
2025-03-13 18:07:30,814 [INFO]: 	size in bytes: 948109510
2025-03-13 18:07:30,814 [INFO]: 	avg_search_speed_ms: 8.207778939755546
2025-03-13 18:07:30,814 [INFO]: 	99p_search_speed_ms: 13.899784255772826
2025-03-13 18:07:30,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:30,814 [INFO]: 	nb vectors: 4819
2025-03-13 18:07:30,814 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:30,814 [INFO]: 	compression ratio: 0.9993085629950068
2025-03-13 18:07:30,814 [INFO]: }
2025-03-13 18:07:30,814 [INFO]: 	>>> Finished "Creating the index" in 88.7628 secs
2025-03-13 18:07:30,814 [INFO]: >>> Finished "Launching the whole pipeline" in 88.8025 secs
2025-03-13 18:07:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 13979 [episode count 6/20]
[retrieval_preprocessing] for episode 25250 [episode count 7/20], we have num_retrieval=np.int64(4832) num_query=np.int64(246)
2025-03-13 18:07:33,195 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:34,001 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:34
2025-03-13 18:07:34,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2088.80it/s]
2025-03-13 18:07:34,026 [INFO]: There are 4832 embeddings of dim 49152
2025-03-13 18:07:34,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 18:07:34,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:34
2025-03-13 18:07:34,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:34,026 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:07:34,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:34,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:34,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:34
2025-03-13 18:07:34,026 [INFO]: 997.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:34,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:34,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:34
2025-03-13 18:07:34,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:34,026 [INFO]: 	Creating the index 03/13/2025, 18:07:34
2025-03-13 18:07:34,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:34
2025-03-13 18:07:34,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:34,027 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:34
2025-03-13 18:07:34,027 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:07:34,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.26it/s] 30%|███       | 6/20 [00:00<00:00, 29.99it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.89it/s] 80%|████████  | 16/20 [00:00<00:00, 40.12it/s]100%|██████████| 20/20 [00:04<00:00,  2.71it/s]100%|██████████| 20/20 [00:04<00:00,  4.31it/s]
2025-03-13 18:07:38,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:38
2025-03-13 18:08:31,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1972 secs
2025-03-13 18:08:31,873 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 18:08:31,873 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 18:09:00,900 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0268 secs
2025-03-13 18:09:00,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.8756 secs
2025-03-13 18:09:00,903 [INFO]: {
2025-03-13 18:09:00,903 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:00,903 [INFO]: 	index_param: efSearch=201
2025-03-13 18:09:00,903 [INFO]: 	index_path: knn.index
2025-03-13 18:09:00,903 [INFO]: 	size in bytes: 950667130
2025-03-13 18:09:00,903 [INFO]: 	avg_search_speed_ms: 10.404432734908704
2025-03-13 18:09:00,903 [INFO]: 	99p_search_speed_ms: 15.435269847512243
2025-03-13 18:09:00,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:00,903 [INFO]: 	nb vectors: 4832
2025-03-13 18:09:00,903 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:00,903 [INFO]: 	compression ratio: 0.9993086181490255
2025-03-13 18:09:00,903 [INFO]: }
2025-03-13 18:09:00,903 [INFO]: 	>>> Finished "Creating the index" in 86.8772 secs
2025-03-13 18:09:00,903 [INFO]: >>> Finished "Launching the whole pipeline" in 86.9028 secs
2025-03-13 18:09:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 25250 [episode count 7/20]
[retrieval_preprocessing] for episode 38564 [episode count 8/20], we have num_retrieval=np.int64(4761) num_query=np.int64(317)
2025-03-13 18:09:03,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:04,208 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:04
2025-03-13 18:09:04,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.62it/s]
2025-03-13 18:09:04,237 [INFO]: There are 4761 embeddings of dim 49152
2025-03-13 18:09:04,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 18:09:04,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:04
2025-03-13 18:09:04,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:04,238 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:09:04,238 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:04,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:09:04,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:04
2025-03-13 18:09:04,239 [INFO]: 982.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:04,239 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:09:04,239 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:04
2025-03-13 18:09:04,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:04,240 [INFO]: 	Creating the index 03/13/2025, 18:09:04
2025-03-13 18:09:04,240 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:04
2025-03-13 18:09:04,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:09:04,243 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:04
2025-03-13 18:09:04,243 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:09:04,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.24it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.01it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.97it/s] 89%|████████▉ | 17/19 [00:00<00:00, 40.43it/s]100%|██████████| 19/19 [00:04<00:00,  4.20it/s]
2025-03-13 18:09:08,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:08
2025-03-13 18:10:01,724 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9499 secs
2025-03-13 18:10:01,725 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 18:10:01,725 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 18:10:22,526 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8011 secs
2025-03-13 18:10:22,798 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5545 secs
2025-03-13 18:10:22,798 [INFO]: {
2025-03-13 18:10:22,798 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:22,798 [INFO]: 	index_param: efSearch=159
2025-03-13 18:10:22,798 [INFO]: 	index_path: knn.index
2025-03-13 18:10:22,798 [INFO]: 	size in bytes: 936698290
2025-03-13 18:10:22,799 [INFO]: 	avg_search_speed_ms: 10.05903763651578
2025-03-13 18:10:22,799 [INFO]: 	99p_search_speed_ms: 18.055167449638247
2025-03-13 18:10:22,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:22,799 [INFO]: 	nb vectors: 4761
2025-03-13 18:10:22,799 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:22,799 [INFO]: 	compression ratio: 0.9993086333060349
2025-03-13 18:10:22,799 [INFO]: }
2025-03-13 18:10:22,799 [INFO]: 	>>> Finished "Creating the index" in 78.5592 secs
2025-03-13 18:10:22,799 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5904 secs
2025-03-13 18:10:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 38564 [episode count 8/20]
[retrieval_preprocessing] for episode 94385 [episode count 9/20], we have num_retrieval=np.int64(4852) num_query=np.int64(226)
2025-03-13 18:10:26,019 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:26,909 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:26
2025-03-13 18:10:26,909 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.33it/s]
2025-03-13 18:10:26,936 [INFO]: There are 4852 embeddings of dim 49152
2025-03-13 18:10:26,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:10:26,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:26
2025-03-13 18:10:26,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:26,937 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:10:26,937 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:26,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:26,937 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:26
2025-03-13 18:10:26,937 [INFO]: 1001.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:26,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:10:26,937 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:26
2025-03-13 18:10:26,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:26,937 [INFO]: 	Creating the index 03/13/2025, 18:10:26
2025-03-13 18:10:26,937 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:26
2025-03-13 18:10:26,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:10:26,939 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:26
2025-03-13 18:10:26,939 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:10:26,939 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.03it/s] 30%|███       | 6/20 [00:00<00:00, 28.59it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.08it/s] 80%|████████  | 16/20 [00:00<00:00, 40.04it/s]100%|██████████| 20/20 [00:04<00:00,  4.33it/s]
2025-03-13 18:10:31,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:31
2025-03-13 18:11:17,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4081 secs
2025-03-13 18:11:17,974 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 18:11:17,974 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.97it/s]
2025-03-13 18:11:54,953 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9787 secs
2025-03-13 18:11:55,573 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.6345 secs
2025-03-13 18:11:55,574 [INFO]: {
2025-03-13 18:11:55,574 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:55,574 [INFO]: 	index_param: efSearch=220
2025-03-13 18:11:55,574 [INFO]: 	index_path: knn.index
2025-03-13 18:11:55,574 [INFO]: 	size in bytes: 954601990
2025-03-13 18:11:55,574 [INFO]: 	avg_search_speed_ms: 10.537157972118532
2025-03-13 18:11:55,574 [INFO]: 	99p_search_speed_ms: 14.7925313282758
2025-03-13 18:11:55,574 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:55,574 [INFO]: 	nb vectors: 4852
2025-03-13 18:11:55,574 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:55,574 [INFO]: 	compression ratio: 0.9993086396142962
2025-03-13 18:11:55,574 [INFO]: }
2025-03-13 18:11:55,574 [INFO]: 	>>> Finished "Creating the index" in 88.6371 secs
2025-03-13 18:11:55,575 [INFO]: >>> Finished "Launching the whole pipeline" in 88.6658 secs
2025-03-13 18:11:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 94385 [episode count 9/20]
[retrieval_preprocessing] for episode 78949 [episode count 10/20], we have num_retrieval=np.int64(4848) num_query=np.int64(230)
2025-03-13 18:11:58,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:58,825 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:58
2025-03-13 18:11:58,825 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2293.22it/s]
2025-03-13 18:11:58,855 [INFO]: There are 4848 embeddings of dim 49152
2025-03-13 18:11:58,855 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 18:11:58,855 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:58
2025-03-13 18:11:58,855 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:58,855 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:11:58,855 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:58,855 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:58,855 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:58
2025-03-13 18:11:58,855 [INFO]: 1000.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:58,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:58,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:58
2025-03-13 18:11:58,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:58,856 [INFO]: 	Creating the index 03/13/2025, 18:11:58
2025-03-13 18:11:58,856 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:58
2025-03-13 18:11:58,857 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:11:58,857 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:58
2025-03-13 18:11:58,857 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:11:58,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.91it/s] 25%|██▌       | 5/20 [00:00<00:00, 21.11it/s] 45%|████▌     | 9/20 [00:00<00:00, 28.40it/s] 65%|██████▌   | 13/20 [00:00<00:00, 32.50it/s] 85%|████████▌ | 17/20 [00:00<00:00, 34.96it/s]100%|██████████| 20/20 [00:05<00:00,  3.91it/s]
2025-03-13 18:12:03,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:03
2025-03-13 18:13:07,772 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7938 secs
2025-03-13 18:13:07,772 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 18:13:07,772 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-13 18:13:35,787 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0143 secs
2025-03-13 18:13:35,791 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.9335 secs
2025-03-13 18:13:35,791 [INFO]: {
2025-03-13 18:13:35,791 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:35,791 [INFO]: 	index_param: efSearch=122
2025-03-13 18:13:35,791 [INFO]: 	index_path: knn.index
2025-03-13 18:13:35,791 [INFO]: 	size in bytes: 953815030
2025-03-13 18:13:35,791 [INFO]: 	avg_search_speed_ms: 7.4970477995095495
2025-03-13 18:13:35,791 [INFO]: 	99p_search_speed_ms: 11.737405541352931
2025-03-13 18:13:35,791 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:35,791 [INFO]: 	nb vectors: 4848
2025-03-13 18:13:35,791 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:35,791 [INFO]: 	compression ratio: 0.9993086227630529
2025-03-13 18:13:35,791 [INFO]: }
2025-03-13 18:13:35,791 [INFO]: 	>>> Finished "Creating the index" in 96.9357 secs
2025-03-13 18:13:35,791 [INFO]: >>> Finished "Launching the whole pipeline" in 96.9660 secs
2025-03-13 18:13:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 78949 [episode count 10/20]
[retrieval_preprocessing] for episode 66234 [episode count 11/20], we have num_retrieval=np.int64(4834) num_query=np.int64(244)
2025-03-13 18:13:37,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:38,362 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:38
2025-03-13 18:13:38,362 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.34it/s]
2025-03-13 18:13:38,389 [INFO]: There are 4834 embeddings of dim 49152
2025-03-13 18:13:38,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:13:38,389 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:38
2025-03-13 18:13:38,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:38,389 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:13:38,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:38,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:13:38,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:38
2025-03-13 18:13:38,389 [INFO]: 997.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:38,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:13:38,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:38
2025-03-13 18:13:38,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:38,390 [INFO]: 	Creating the index 03/13/2025, 18:13:38
2025-03-13 18:13:38,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:38
2025-03-13 18:13:38,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:13:38,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:38
2025-03-13 18:13:38,391 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:13:38,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.37it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.74it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.64it/s] 90%|█████████ | 18/20 [00:00<00:00, 44.77it/s]100%|██████████| 20/20 [00:03<00:00,  5.24it/s]
2025-03-13 18:13:42,210 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:42
2025-03-13 18:14:46,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.7006 secs
2025-03-13 18:14:46,912 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 18:14:46,912 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
2025-03-13 18:15:26,378 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4664 secs
2025-03-13 18:15:26,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.9904 secs
2025-03-13 18:15:26,382 [INFO]: {
2025-03-13 18:15:26,382 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:26,382 [INFO]: 	index_param: efSearch=122
2025-03-13 18:15:26,382 [INFO]: 	index_path: knn.index
2025-03-13 18:15:26,382 [INFO]: 	size in bytes: 951060610
2025-03-13 18:15:26,382 [INFO]: 	avg_search_speed_ms: 7.125820052668622
2025-03-13 18:15:26,382 [INFO]: 	99p_search_speed_ms: 10.69249352440238
2025-03-13 18:15:26,382 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:26,382 [INFO]: 	nb vectors: 4834
2025-03-13 18:15:26,382 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:26,382 [INFO]: 	compression ratio: 0.9993086266079299
2025-03-13 18:15:26,382 [INFO]: }
2025-03-13 18:15:26,382 [INFO]: 	>>> Finished "Creating the index" in 107.9922 secs
2025-03-13 18:15:26,382 [INFO]: >>> Finished "Launching the whole pipeline" in 108.0197 secs
2025-03-13 18:15:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 66234 [episode count 11/20]
[retrieval_preprocessing] for episode 71381 [episode count 12/20], we have num_retrieval=np.int64(4839) num_query=np.int64(239)
2025-03-13 18:15:28,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:28,923 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:28
2025-03-13 18:15:28,923 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.23it/s]
2025-03-13 18:15:28,949 [INFO]: There are 4839 embeddings of dim 49152
2025-03-13 18:15:28,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:15:28,949 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:28
2025-03-13 18:15:28,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:28,949 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:15:28,949 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:28,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:28,949 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:28
2025-03-13 18:15:28,949 [INFO]: 998.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:28,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:15:28,949 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:28
2025-03-13 18:15:28,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:28,950 [INFO]: 	Creating the index 03/13/2025, 18:15:28
2025-03-13 18:15:28,950 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:28
2025-03-13 18:15:28,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:15:28,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:28
2025-03-13 18:15:28,951 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:15:28,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.72it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.41it/s] 60%|██████    | 12/20 [00:00<00:00, 40.46it/s] 85%|████████▌ | 17/20 [00:00<00:00, 42.82it/s]100%|██████████| 20/20 [00:05<00:00,  3.63it/s]
2025-03-13 18:15:34,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:34
2025-03-13 18:16:30,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3162 secs
2025-03-13 18:16:30,200 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:16:30,200 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.45it/s]
2025-03-13 18:17:14,230 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0295 secs
2025-03-13 18:17:14,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.2828 secs
2025-03-13 18:17:14,234 [INFO]: {
2025-03-13 18:17:14,234 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:14,234 [INFO]: 	index_param: efSearch=206
2025-03-13 18:17:14,234 [INFO]: 	index_path: knn.index
2025-03-13 18:17:14,234 [INFO]: 	size in bytes: 952044370
2025-03-13 18:17:14,234 [INFO]: 	avg_search_speed_ms: 11.052326567326956
2025-03-13 18:17:14,234 [INFO]: 	99p_search_speed_ms: 16.10798055306078
2025-03-13 18:17:14,234 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:14,234 [INFO]: 	nb vectors: 4839
2025-03-13 18:17:14,234 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:14,234 [INFO]: 	compression ratio: 0.9993085847458979
2025-03-13 18:17:14,234 [INFO]: }
2025-03-13 18:17:14,234 [INFO]: 	>>> Finished "Creating the index" in 105.2843 secs
2025-03-13 18:17:14,234 [INFO]: >>> Finished "Launching the whole pipeline" in 105.3109 secs
2025-03-13 18:17:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 71381 [episode count 12/20]
[retrieval_preprocessing] for episode 58625 [episode count 13/20], we have num_retrieval=np.int64(4825) num_query=np.int64(253)
2025-03-13 18:17:16,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:17,430 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:17
2025-03-13 18:17:17,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1635.84it/s]
2025-03-13 18:17:17,472 [INFO]: There are 4825 embeddings of dim 49152
2025-03-13 18:17:17,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0419 secs
2025-03-13 18:17:17,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:17
2025-03-13 18:17:17,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:17,472 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:17:17,472 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:17,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:17:17,472 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:17
2025-03-13 18:17:17,473 [INFO]: 995.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:17,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:17,473 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:17
2025-03-13 18:17:17,473 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:17,473 [INFO]: 	Creating the index 03/13/2025, 18:17:17
2025-03-13 18:17:17,473 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:17
2025-03-13 18:17:17,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:17:17,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:17
2025-03-13 18:17:17,474 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:17:17,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.35it/s] 26%|██▋       | 5/19 [00:00<00:00, 25.49it/s] 47%|████▋     | 9/19 [00:00<00:00, 30.75it/s] 68%|██████▊   | 13/19 [00:00<00:00, 33.81it/s] 89%|████████▉ | 17/19 [00:00<00:00, 35.84it/s]100%|██████████| 19/19 [00:04<00:00,  4.16it/s]
2025-03-13 18:17:22,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:22
2025-03-13 18:18:17,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9988 secs
2025-03-13 18:18:17,048 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 18:18:17,048 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-13 18:18:55,018 [INFO]: 	>>> Finished "Compute fast metrics" in 37.9693 secs
2025-03-13 18:18:55,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.7201 secs
2025-03-13 18:18:55,194 [INFO]: {
2025-03-13 18:18:55,194 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:55,194 [INFO]: 	index_param: efSearch=207
2025-03-13 18:18:55,195 [INFO]: 	index_path: knn.index
2025-03-13 18:18:55,195 [INFO]: 	size in bytes: 949289950
2025-03-13 18:18:55,195 [INFO]: 	avg_search_speed_ms: 11.073296485367672
2025-03-13 18:18:55,195 [INFO]: 	99p_search_speed_ms: 16.561998766846955
2025-03-13 18:18:55,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:55,195 [INFO]: 	nb vectors: 4825
2025-03-13 18:18:55,195 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:55,195 [INFO]: 	compression ratio: 0.9993085884876375
2025-03-13 18:18:55,195 [INFO]: }
2025-03-13 18:18:55,195 [INFO]: 	>>> Finished "Creating the index" in 97.7223 secs
2025-03-13 18:18:55,195 [INFO]: >>> Finished "Launching the whole pipeline" in 97.7650 secs
2025-03-13 18:18:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 58625 [episode count 13/20]
[retrieval_preprocessing] for episode 70967 [episode count 14/20], we have num_retrieval=np.int64(4766) num_query=np.int64(312)
2025-03-13 18:18:57,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:59,398 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:59
2025-03-13 18:18:59,398 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1848.53it/s]
2025-03-13 18:18:59,424 [INFO]: There are 4766 embeddings of dim 49152
2025-03-13 18:18:59,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:18:59,425 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:59,425 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:18:59,425 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:59,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:59,425 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,425 [INFO]: 983.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:59,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:18:59,425 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:59
2025-03-13 18:18:59,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:59,425 [INFO]: 	Creating the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,425 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:59
2025-03-13 18:18:59,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:18:59,426 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,426 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:18:59,427 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.35it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.60it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.32it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.79it/s]100%|██████████| 19/19 [00:04<00:00,  4.64it/s]
2025-03-13 18:19:03,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:03
2025-03-13 18:19:51,111 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5873 secs
2025-03-13 18:19:51,111 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:19:51,111 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.53it/s]
2025-03-13 18:20:23,664 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5525 secs
2025-03-13 18:20:23,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.2410 secs
2025-03-13 18:20:23,668 [INFO]: {
2025-03-13 18:20:23,668 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:23,668 [INFO]: 	index_param: efSearch=204
2025-03-13 18:20:23,668 [INFO]: 	index_path: knn.index
2025-03-13 18:20:23,668 [INFO]: 	size in bytes: 937682050
2025-03-13 18:20:23,668 [INFO]: 	avg_search_speed_ms: 12.43867633275836
2025-03-13 18:20:23,668 [INFO]: 	99p_search_speed_ms: 20.265141548588872
2025-03-13 18:20:23,668 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:23,668 [INFO]: 	nb vectors: 4766
2025-03-13 18:20:23,668 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:23,668 [INFO]: 	compression ratio: 0.999308590795782
2025-03-13 18:20:23,668 [INFO]: }
2025-03-13 18:20:23,668 [INFO]: 	>>> Finished "Creating the index" in 84.2427 secs
2025-03-13 18:20:23,668 [INFO]: >>> Finished "Launching the whole pipeline" in 84.2696 secs
2025-03-13 18:20:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 70967 [episode count 14/20]
[retrieval_preprocessing] for episode 23271 [episode count 15/20], we have num_retrieval=np.int64(4909) num_query=np.int64(169)
2025-03-13 18:20:27,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:28,592 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:28
2025-03-13 18:20:28,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.85it/s]
2025-03-13 18:20:28,620 [INFO]: There are 4909 embeddings of dim 49152
2025-03-13 18:20:28,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:20:28,620 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:28
2025-03-13 18:20:28,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:28,620 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:20:28,620 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:28,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:28,620 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:28
2025-03-13 18:20:28,620 [INFO]: 1013.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:28,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:28,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:28
2025-03-13 18:20:28,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:28,621 [INFO]: 	Creating the index 03/13/2025, 18:20:28
2025-03-13 18:20:28,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:28
2025-03-13 18:20:28,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:20:28,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:28
2025-03-13 18:20:28,622 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:20:28,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.95it/s] 30%|███       | 6/20 [00:00<00:00, 27.83it/s] 55%|█████▌    | 11/20 [00:00<00:00, 34.95it/s] 80%|████████  | 16/20 [00:00<00:00, 37.85it/s]100%|██████████| 20/20 [00:04<00:00,  2.61it/s]100%|██████████| 20/20 [00:04<00:00,  4.14it/s]
2025-03-13 18:20:33,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:33
2025-03-13 18:21:19,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1091 secs
2025-03-13 18:21:19,561 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 18:21:19,561 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 18:21:50,989 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4273 secs
2025-03-13 18:21:50,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3703 secs
2025-03-13 18:21:50,992 [INFO]: {
2025-03-13 18:21:50,992 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:50,992 [INFO]: 	index_param: efSearch=260
2025-03-13 18:21:50,992 [INFO]: 	index_path: knn.index
2025-03-13 18:21:50,992 [INFO]: 	size in bytes: 965816290
2025-03-13 18:21:50,992 [INFO]: 	avg_search_speed_ms: 12.766799468390301
2025-03-13 18:21:50,992 [INFO]: 	99p_search_speed_ms: 21.831443773116913
2025-03-13 18:21:50,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:50,992 [INFO]: 	nb vectors: 4909
2025-03-13 18:21:50,992 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:50,992 [INFO]: 	compression ratio: 0.9993087525993168
2025-03-13 18:21:50,992 [INFO]: }
2025-03-13 18:21:50,992 [INFO]: 	>>> Finished "Creating the index" in 82.3718 secs
2025-03-13 18:21:50,992 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4007 secs
2025-03-13 18:21:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 23271 [episode count 15/20]
[retrieval_preprocessing] for episode 74014 [episode count 16/20], we have num_retrieval=np.int64(4857) num_query=np.int64(221)
2025-03-13 18:21:53,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:54,065 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:54
2025-03-13 18:21:54,065 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.86it/s]
2025-03-13 18:21:54,093 [INFO]: There are 4857 embeddings of dim 49152
2025-03-13 18:21:54,093 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:21:54,094 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:54
2025-03-13 18:21:54,094 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:54,094 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:21:54,094 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:54,094 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:54,094 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:54
2025-03-13 18:21:54,094 [INFO]: 1002.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:54,094 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:21:54,094 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:54
2025-03-13 18:21:54,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:54,094 [INFO]: 	Creating the index 03/13/2025, 18:21:54
2025-03-13 18:21:54,094 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:54
2025-03-13 18:21:54,095 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:21:54,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:54
2025-03-13 18:21:54,096 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:21:54,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.74it/s] 30%|███       | 6/20 [00:00<00:00, 26.91it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.51it/s] 80%|████████  | 16/20 [00:00<00:00, 40.37it/s]100%|██████████| 20/20 [00:03<00:00,  5.42it/s]
2025-03-13 18:21:57,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:57
2025-03-13 18:22:42,078 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2899 secs
2025-03-13 18:22:42,079 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:22:42,079 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.08it/s]
2025-03-13 18:23:04,151 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0716 secs
2025-03-13 18:23:04,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0594 secs
2025-03-13 18:23:04,155 [INFO]: {
2025-03-13 18:23:04,155 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:04,155 [INFO]: 	index_param: efSearch=174
2025-03-13 18:23:04,155 [INFO]: 	index_path: knn.index
2025-03-13 18:23:04,155 [INFO]: 	size in bytes: 955585690
2025-03-13 18:23:04,155 [INFO]: 	avg_search_speed_ms: 13.528205514211253
2025-03-13 18:23:04,155 [INFO]: 	99p_search_speed_ms: 20.20929045509547
2025-03-13 18:23:04,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:04,155 [INFO]: 	nb vectors: 4857
2025-03-13 18:23:04,155 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:04,155 [INFO]: 	compression ratio: 0.9993086606393196
2025-03-13 18:23:04,155 [INFO]: }
2025-03-13 18:23:04,156 [INFO]: 	>>> Finished "Creating the index" in 70.0614 secs
2025-03-13 18:23:04,156 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0901 secs
2025-03-13 18:23:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 74014 [episode count 16/20]
[retrieval_preprocessing] for episode 41975 [episode count 17/20], we have num_retrieval=np.int64(4816) num_query=np.int64(262)
2025-03-13 18:23:07,168 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:07,882 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:07
2025-03-13 18:23:07,882 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1775.74it/s]
2025-03-13 18:23:07,909 [INFO]: There are 4816 embeddings of dim 49152
2025-03-13 18:23:07,909 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 18:23:07,910 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:07
2025-03-13 18:23:07,910 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:07,910 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:23:07,910 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:07,910 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:23:07,910 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:07
2025-03-13 18:23:07,910 [INFO]: 993.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:07,910 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:23:07,910 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:07
2025-03-13 18:23:07,910 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:07,910 [INFO]: 	Creating the index 03/13/2025, 18:23:07
2025-03-13 18:23:07,910 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:07
2025-03-13 18:23:07,911 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:23:07,911 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:07
2025-03-13 18:23:07,911 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:23:07,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.43it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.40it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.00it/s] 84%|████████▍ | 16/19 [00:00<00:00, 40.46it/s]100%|██████████| 19/19 [00:05<00:00,  3.62it/s]
2025-03-13 18:23:13,159 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:13
2025-03-13 18:24:05,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4090 secs
2025-03-13 18:24:05,568 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 18:24:05,568 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 18:24:31,613 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0445 secs
2025-03-13 18:24:31,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.7046 secs
2025-03-13 18:24:31,616 [INFO]: {
2025-03-13 18:24:31,616 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:31,616 [INFO]: 	index_param: efSearch=187
2025-03-13 18:24:31,616 [INFO]: 	index_path: knn.index
2025-03-13 18:24:31,616 [INFO]: 	size in bytes: 947519230
2025-03-13 18:24:31,616 [INFO]: 	avg_search_speed_ms: 11.166837081483598
2025-03-13 18:24:31,616 [INFO]: 	99p_search_speed_ms: 15.567177010234442
2025-03-13 18:24:31,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:31,616 [INFO]: 	nb vectors: 4816
2025-03-13 18:24:31,617 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:31,617 [INFO]: 	compression ratio: 0.9993086135043402
2025-03-13 18:24:31,617 [INFO]: }
2025-03-13 18:24:31,617 [INFO]: 	>>> Finished "Creating the index" in 83.7065 secs
2025-03-13 18:24:31,617 [INFO]: >>> Finished "Launching the whole pipeline" in 83.7341 secs
2025-03-13 18:24:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 41975 [episode count 17/20]
[retrieval_preprocessing] for episode 72167 [episode count 18/20], we have num_retrieval=np.int64(4864) num_query=np.int64(214)
2025-03-13 18:24:34,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:35,534 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:35
2025-03-13 18:24:35,534 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.83it/s]
2025-03-13 18:24:35,560 [INFO]: There are 4864 embeddings of dim 49152
2025-03-13 18:24:35,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:24:35,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:35,560 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:24:35,560 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:35,560 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:35,560 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,561 [INFO]: 1003.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:35,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:24:35,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:35
2025-03-13 18:24:35,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:35,561 [INFO]: 	Creating the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:35
2025-03-13 18:24:35,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:24:35,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,562 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:24:35,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.73it/s] 30%|███       | 6/20 [00:00<00:00, 29.95it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.81it/s] 80%|████████  | 16/20 [00:00<00:00, 39.95it/s]100%|██████████| 20/20 [00:04<00:00,  4.12it/s]
2025-03-13 18:24:40,426 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:40
2025-03-13 18:25:24,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7613 secs
2025-03-13 18:25:24,188 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:25:24,188 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 18:26:00,655 [INFO]: 	>>> Finished "Compute fast metrics" in 36.4671 secs
2025-03-13 18:26:00,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.0955 secs
2025-03-13 18:26:00,658 [INFO]: {
2025-03-13 18:26:00,658 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:00,658 [INFO]: 	index_param: efSearch=212
2025-03-13 18:26:00,658 [INFO]: 	index_path: knn.index
2025-03-13 18:26:00,658 [INFO]: 	size in bytes: 956962870
2025-03-13 18:26:00,658 [INFO]: 	avg_search_speed_ms: 9.610229194625912
2025-03-13 18:26:00,658 [INFO]: 	99p_search_speed_ms: 14.617694215849026
2025-03-13 18:26:00,658 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:00,658 [INFO]: 	nb vectors: 4864
2025-03-13 18:26:00,658 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:00,658 [INFO]: 	compression ratio: 0.9993086900017344
2025-03-13 18:26:00,658 [INFO]: }
2025-03-13 18:26:00,658 [INFO]: 	>>> Finished "Creating the index" in 85.0970 secs
2025-03-13 18:26:00,658 [INFO]: >>> Finished "Launching the whole pipeline" in 85.1237 secs
2025-03-13 18:26:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 72167 [episode count 18/20]
[retrieval_preprocessing] for episode 24990 [episode count 19/20], we have num_retrieval=np.int64(4858) num_query=np.int64(220)
2025-03-13 18:26:02,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:03,688 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:03
2025-03-13 18:26:03,689 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2216.86it/s]
2025-03-13 18:26:03,714 [INFO]: There are 4858 embeddings of dim 49152
2025-03-13 18:26:03,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:26:03,714 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:03
2025-03-13 18:26:03,714 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:03,714 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:26:03,714 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:03,714 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:03,714 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:03
2025-03-13 18:26:03,714 [INFO]: 1002.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:03,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:26:03,714 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:03
2025-03-13 18:26:03,715 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:03,715 [INFO]: 	Creating the index 03/13/2025, 18:26:03
2025-03-13 18:26:03,715 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:03
2025-03-13 18:26:03,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:26:03,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:03
2025-03-13 18:26:03,716 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:26:03,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.15it/s] 40%|████      | 8/20 [00:00<00:00, 40.36it/s] 70%|███████   | 14/20 [00:00<00:00, 47.24it/s]100%|██████████| 20/20 [00:03<00:00,  3.90it/s]100%|██████████| 20/20 [00:03<00:00,  5.40it/s]
2025-03-13 18:26:08,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:08
2025-03-13 18:26:58,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2219 secs
2025-03-13 18:26:58,277 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 18:26:58,277 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.50it/s]
2025-03-13 18:27:19,564 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2862 secs
2025-03-13 18:27:19,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8506 secs
2025-03-13 18:27:19,567 [INFO]: {
2025-03-13 18:27:19,567 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:19,567 [INFO]: 	index_param: efSearch=182
2025-03-13 18:27:19,567 [INFO]: 	index_path: knn.index
2025-03-13 18:27:19,567 [INFO]: 	size in bytes: 955782430
2025-03-13 18:27:19,567 [INFO]: 	avg_search_speed_ms: 10.134293165118287
2025-03-13 18:27:19,567 [INFO]: 	99p_search_speed_ms: 13.979875654913485
2025-03-13 18:27:19,567 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:19,567 [INFO]: 	nb vectors: 4858
2025-03-13 18:27:19,567 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:19,567 [INFO]: 	compression ratio: 0.9993086648391308
2025-03-13 18:27:19,567 [INFO]: }
2025-03-13 18:27:19,567 [INFO]: 	>>> Finished "Creating the index" in 75.8523 secs
2025-03-13 18:27:19,567 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8782 secs
2025-03-13 18:27:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 24990 [episode count 19/20]
2025-03-13 18:27:21: [retrieval_preprocessing] finished for 1477699675_put_spoon_in_mug [chosen_id count 9/196]
2025-03-13 18:27:21: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
