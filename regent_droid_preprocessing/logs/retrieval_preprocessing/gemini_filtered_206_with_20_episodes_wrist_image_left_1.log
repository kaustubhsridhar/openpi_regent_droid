nohup: ignoring input
2025-03-13 10:49:47: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:49:55: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 164628080_put_rubber_duck_in_pot [chosen_id count 0/260]
2025-03-13 10:49:55: [retrieval_preprocessing] we have num_total=2119 embedding_dim=49152
[retrieval_preprocessing] for episode 7174 [episode count 0/20], we have num_retrieval=np.int64(2018) num_query=np.int64(101)
2025-03-13 10:49:58,141 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:49:58,384 [INFO]: Launching the whole pipeline 03/13/2025, 10:49:58
2025-03-13 10:49:58,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:49:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 654.64it/s]
2025-03-13 10:49:58,429 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 10:49:58,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0453 secs
2025-03-13 10:49:58,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:49:58
2025-03-13 10:49:58,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:49:58,429 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:49:58,429 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:49:58,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:49:58,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:49:58
2025-03-13 10:49:58,430 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:49:58,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 10:49:58,430 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:49:58
2025-03-13 10:49:58,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:49:58,430 [INFO]: 	Creating the index 03/13/2025, 10:49:58
2025-03-13 10:49:58,430 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:49:58
2025-03-13 10:49:58,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 10:49:58,432 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:49:58
2025-03-13 10:49:58,432 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:49:58,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.69it/s] 50%|█████     | 4/8 [00:00<00:00, 17.78it/s] 75%|███████▌  | 6/8 [00:01<00:00,  3.26it/s]100%|██████████| 8/8 [00:05<00:00,  1.16it/s]100%|██████████| 8/8 [00:05<00:00,  1.59it/s]
2025-03-13 10:50:03,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:03
2025-03-13 10:50:32,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8636 secs
2025-03-13 10:50:32,338 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 10:50:32,338 [INFO]: 	Compute fast metrics 03/13/2025, 10:50:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s]
2025-03-13 10:50:44,056 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7177 secs
2025-03-13 10:50:44,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6251 secs
2025-03-13 10:50:44,057 [INFO]: {
2025-03-13 10:50:44,057 [INFO]: 	index_key: HNSW15
2025-03-13 10:50:44,057 [INFO]: 	index_param: efSearch=280
2025-03-13 10:50:44,057 [INFO]: 	index_path: knn.index
2025-03-13 10:50:44,057 [INFO]: 	size in bytes: 397029310
2025-03-13 10:50:44,057 [INFO]: 	avg_search_speed_ms: 10.025411436449968
2025-03-13 10:50:44,057 [INFO]: 	99p_search_speed_ms: 17.44954975787549
2025-03-13 10:50:44,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:50:44,058 [INFO]: 	nb vectors: 2018
2025-03-13 10:50:44,058 [INFO]: 	vectors dimension: 49152
2025-03-13 10:50:44,058 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 10:50:44,058 [INFO]: }
2025-03-13 10:50:44,058 [INFO]: 	>>> Finished "Creating the index" in 45.6272 secs
2025-03-13 10:50:44,058 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6740 secs
2025-03-13 10:50:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:50:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 7174 [episode count 0/20]
[retrieval_preprocessing] for episode 22046 [episode count 1/20], we have num_retrieval=np.int64(1985) num_query=np.int64(134)
2025-03-13 10:50:45,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:45,945 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:45
2025-03-13 10:50:45,945 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1558.64it/s]
2025-03-13 10:50:45,971 [INFO]: There are 1985 embeddings of dim 49152
2025-03-13 10:50:45,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 10:50:45,972 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:45,972 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:50:45,972 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:45,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:50:45,972 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,972 [INFO]: 409.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:45,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:50:45,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:45
2025-03-13 10:50:45,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:45,972 [INFO]: 	Creating the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:45
2025-03-13 10:50:45,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:50:45,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:45
2025-03-13 10:50:45,973 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:50:45,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:05,  1.26it/s] 25%|██▌       | 2/8 [00:04<00:16,  2.78s/it] 50%|█████     | 4/8 [00:05<00:04,  1.09s/it] 75%|███████▌  | 6/8 [00:05<00:01,  1.65it/s]100%|██████████| 8/8 [00:06<00:00,  1.62it/s]100%|██████████| 8/8 [00:06<00:00,  1.22it/s]
2025-03-13 10:50:52,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:52
2025-03-13 10:51:16,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7010 secs
2025-03-13 10:51:16,225 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 10:51:16,225 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.03it/s]
2025-03-13 10:51:28,443 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2186 secs
2025-03-13 10:51:28,447 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4744 secs
2025-03-13 10:51:28,447 [INFO]: {
2025-03-13 10:51:28,448 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:28,448 [INFO]: 	index_param: efSearch=260
2025-03-13 10:51:28,448 [INFO]: 	index_path: knn.index
2025-03-13 10:51:28,448 [INFO]: 	size in bytes: 390536770
2025-03-13 10:51:28,448 [INFO]: 	avg_search_speed_ms: 10.999223931484556
2025-03-13 10:51:28,448 [INFO]: 	99p_search_speed_ms: 17.806197935715307
2025-03-13 10:51:28,448 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:28,448 [INFO]: 	nb vectors: 1985
2025-03-13 10:51:28,448 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:28,448 [INFO]: 	compression ratio: 0.9993089255078338
2025-03-13 10:51:28,448 [INFO]: }
2025-03-13 10:51:28,448 [INFO]: 	>>> Finished "Creating the index" in 42.4757 secs
2025-03-13 10:51:28,448 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5029 secs
2025-03-13 10:51:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 22046 [episode count 1/20]
[retrieval_preprocessing] for episode 36920 [episode count 2/20], we have num_retrieval=np.int64(2004) num_query=np.int64(115)
2025-03-13 10:51:31,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:31,854 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:31
2025-03-13 10:51:31,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1528.54it/s]
2025-03-13 10:51:31,881 [INFO]: There are 2004 embeddings of dim 49152
2025-03-13 10:51:31,881 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 10:51:31,882 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:31
2025-03-13 10:51:31,882 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:31,882 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:51:31,882 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:31,882 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:51:31,882 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:31
2025-03-13 10:51:31,882 [INFO]: 413.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:31,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:51:31,883 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:31
2025-03-13 10:51:31,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:31,883 [INFO]: 	Creating the index 03/13/2025, 10:51:31
2025-03-13 10:51:31,883 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:31
2025-03-13 10:51:31,885 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 10:51:31,886 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:31
2025-03-13 10:51:31,886 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:51:31,886 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:04,  1.59it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.56it/s]100%|██████████| 8/8 [00:02<00:00,  3.21it/s]100%|██████████| 8/8 [00:02<00:00,  3.45it/s]
2025-03-13 10:51:34,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:34
2025-03-13 10:52:05,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8273 secs
2025-03-13 10:52:05,042 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 10:52:05,042 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.50it/s]
2025-03-13 10:52:16,361 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3183 secs
2025-03-13 10:52:16,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4768 secs
2025-03-13 10:52:16,363 [INFO]: {
2025-03-13 10:52:16,363 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:16,363 [INFO]: 	index_param: efSearch=239
2025-03-13 10:52:16,363 [INFO]: 	index_path: knn.index
2025-03-13 10:52:16,363 [INFO]: 	size in bytes: 394274890
2025-03-13 10:52:16,363 [INFO]: 	avg_search_speed_ms: 10.236201425604408
2025-03-13 10:52:16,363 [INFO]: 	99p_search_speed_ms: 14.131620517000556
2025-03-13 10:52:16,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:16,363 [INFO]: 	nb vectors: 2004
2025-03-13 10:52:16,363 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:16,363 [INFO]: 	compression ratio: 0.9993089643624021
2025-03-13 10:52:16,363 [INFO]: }
2025-03-13 10:52:16,363 [INFO]: 	>>> Finished "Creating the index" in 44.4798 secs
2025-03-13 10:52:16,363 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5084 secs
2025-03-13 10:52:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 36920 [episode count 2/20]
[retrieval_preprocessing] for episode 31802 [episode count 3/20], we have num_retrieval=np.int64(2027) num_query=np.int64(92)
2025-03-13 10:52:17,744 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:18,095 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:18
2025-03-13 10:52:18,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1608.86it/s]
2025-03-13 10:52:18,127 [INFO]: There are 2027 embeddings of dim 49152
2025-03-13 10:52:18,127 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 10:52:18,127 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:18
2025-03-13 10:52:18,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:18,127 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:52:18,127 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:18,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:52:18,127 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:18
2025-03-13 10:52:18,127 [INFO]: 418.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:18,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:52:18,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:18
2025-03-13 10:52:18,128 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:18,128 [INFO]: 	Creating the index 03/13/2025, 10:52:18
2025-03-13 10:52:18,128 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:18
2025-03-13 10:52:18,129 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:52:18,129 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:18
2025-03-13 10:52:18,129 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:52:18,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.08it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.25it/s]100%|██████████| 8/8 [00:01<00:00,  4.41it/s]
2025-03-13 10:52:19,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:19
2025-03-13 10:52:47,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7015 secs
2025-03-13 10:52:47,649 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 10:52:47,649 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.62it/s]
2025-03-13 10:53:01,013 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3635 secs
2025-03-13 10:53:01,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8856 secs
2025-03-13 10:53:01,014 [INFO]: {
2025-03-13 10:53:01,014 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:01,014 [INFO]: 	index_param: efSearch=244
2025-03-13 10:53:01,014 [INFO]: 	index_path: knn.index
2025-03-13 10:53:01,014 [INFO]: 	size in bytes: 398800090
2025-03-13 10:53:01,014 [INFO]: 	avg_search_speed_ms: 9.925622349588334
2025-03-13 10:53:01,014 [INFO]: 	99p_search_speed_ms: 19.172927949111905
2025-03-13 10:53:01,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:01,015 [INFO]: 	nb vectors: 2027
2025-03-13 10:53:01,015 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:01,015 [INFO]: 	compression ratio: 0.9993087413796722
2025-03-13 10:53:01,015 [INFO]: }
2025-03-13 10:53:01,015 [INFO]: 	>>> Finished "Creating the index" in 42.8869 secs
2025-03-13 10:53:01,015 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9197 secs
2025-03-13 10:53:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 31802 [episode count 3/20]
[retrieval_preprocessing] for episode 77377 [episode count 4/20], we have num_retrieval=np.int64(1998) num_query=np.int64(121)
2025-03-13 10:53:02,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:02,330 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:02
2025-03-13 10:53:02,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.17it/s]
2025-03-13 10:53:02,359 [INFO]: There are 1998 embeddings of dim 49152
2025-03-13 10:53:02,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 10:53:02,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:02
2025-03-13 10:53:02,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:02,359 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:53:02,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:02,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:02,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:02
2025-03-13 10:53:02,360 [INFO]: 412.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:02,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:53:02,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:02
2025-03-13 10:53:02,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:02,360 [INFO]: 	Creating the index 03/13/2025, 10:53:02
2025-03-13 10:53:02,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:02
2025-03-13 10:53:02,361 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:53:02,361 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:02
2025-03-13 10:53:02,361 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:53:02,361 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.12it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.82it/s]100%|██████████| 8/8 [00:01<00:00,  4.25it/s]
2025-03-13 10:53:04,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:04
2025-03-13 10:53:36,697 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4501 secs
2025-03-13 10:53:36,697 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 10:53:36,697 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.44it/s]
2025-03-13 10:53:48,717 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0203 secs
2025-03-13 10:53:48,719 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3581 secs
2025-03-13 10:53:48,719 [INFO]: {
2025-03-13 10:53:48,719 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:48,719 [INFO]: 	index_param: efSearch=243
2025-03-13 10:53:48,719 [INFO]: 	index_path: knn.index
2025-03-13 10:53:48,719 [INFO]: 	size in bytes: 393094450
2025-03-13 10:53:48,719 [INFO]: 	avg_search_speed_ms: 9.827481841664827
2025-03-13 10:53:48,719 [INFO]: 	99p_search_speed_ms: 13.85267770849169
2025-03-13 10:53:48,719 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:48,719 [INFO]: 	nb vectors: 1998
2025-03-13 10:53:48,719 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:48,719 [INFO]: 	compression ratio: 0.9993089040051316
2025-03-13 10:53:48,719 [INFO]: }
2025-03-13 10:53:48,719 [INFO]: 	>>> Finished "Creating the index" in 46.3595 secs
2025-03-13 10:53:48,719 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3887 secs
2025-03-13 10:53:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 77377 [episode count 4/20]
[retrieval_preprocessing] for episode 92245 [episode count 5/20], we have num_retrieval=np.int64(2010) num_query=np.int64(109)
2025-03-13 10:53:49,979 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:50,247 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:50
2025-03-13 10:53:50,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1405.13it/s]
2025-03-13 10:53:50,280 [INFO]: There are 2010 embeddings of dim 49152
2025-03-13 10:53:50,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 10:53:50,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:50
2025-03-13 10:53:50,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:50,280 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:53:50,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:50,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:50,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:50
2025-03-13 10:53:50,280 [INFO]: 414.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:50,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:53:50,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:50
2025-03-13 10:53:50,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:50,280 [INFO]: 	Creating the index 03/13/2025, 10:53:50
2025-03-13 10:53:50,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:50
2025-03-13 10:53:50,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:53:50,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:50
2025-03-13 10:53:50,281 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:53:50,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.84it/s] 75%|███████▌  | 6/8 [00:00<00:00, 26.20it/s]100%|██████████| 8/8 [00:01<00:00,  4.45it/s]
2025-03-13 10:53:52,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:52
2025-03-13 10:54:16,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9744 secs
2025-03-13 10:54:16,058 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 10:54:16,058 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 10:54:27,478 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4199 secs
2025-03-13 10:54:27,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.1981 secs
2025-03-13 10:54:27,480 [INFO]: {
2025-03-13 10:54:27,480 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:27,480 [INFO]: 	index_param: efSearch=237
2025-03-13 10:54:27,480 [INFO]: 	index_path: knn.index
2025-03-13 10:54:27,480 [INFO]: 	size in bytes: 395455390
2025-03-13 10:54:27,480 [INFO]: 	avg_search_speed_ms: 9.505746884144141
2025-03-13 10:54:27,480 [INFO]: 	99p_search_speed_ms: 12.768809618428353
2025-03-13 10:54:27,480 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:27,480 [INFO]: 	nb vectors: 2010
2025-03-13 10:54:27,480 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:27,480 [INFO]: 	compression ratio: 0.9993088727403614
2025-03-13 10:54:27,480 [INFO]: }
2025-03-13 10:54:27,480 [INFO]: 	>>> Finished "Creating the index" in 37.1995 secs
2025-03-13 10:54:27,480 [INFO]: >>> Finished "Launching the whole pipeline" in 37.2322 secs
2025-03-13 10:54:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 92245 [episode count 5/20]
[retrieval_preprocessing] for episode 58971 [episode count 6/20], we have num_retrieval=np.int64(2025) num_query=np.int64(94)
2025-03-13 10:54:30,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:30,366 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:30
2025-03-13 10:54:30,366 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.48it/s]
2025-03-13 10:54:30,402 [INFO]: There are 2025 embeddings of dim 49152
2025-03-13 10:54:30,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 10:54:30,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:30
2025-03-13 10:54:30,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:30,403 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:54:30,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:30,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:30,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:30
2025-03-13 10:54:30,403 [INFO]: 417.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:30,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:54:30,403 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:30
2025-03-13 10:54:30,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:30,403 [INFO]: 	Creating the index 03/13/2025, 10:54:30
2025-03-13 10:54:30,403 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:30
2025-03-13 10:54:30,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:54:30,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:30
2025-03-13 10:54:30,405 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:54:30,406 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.61it/s] 62%|██████▎   | 5/8 [00:00<00:00, 22.87it/s]100%|██████████| 8/8 [00:02<00:00,  2.73it/s]100%|██████████| 8/8 [00:02<00:00,  3.33it/s]
2025-03-13 10:54:32,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:32
2025-03-13 10:54:57,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1276 secs
2025-03-13 10:54:57,945 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 10:54:57,945 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 10:55:10,243 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2982 secs
2025-03-13 10:55:10,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8397 secs
2025-03-13 10:55:10,245 [INFO]: {
2025-03-13 10:55:10,245 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:10,245 [INFO]: 	index_param: efSearch=252
2025-03-13 10:55:10,245 [INFO]: 	index_path: knn.index
2025-03-13 10:55:10,245 [INFO]: 	size in bytes: 398406610
2025-03-13 10:55:10,245 [INFO]: 	avg_search_speed_ms: 9.506107896244146
2025-03-13 10:55:10,245 [INFO]: 	99p_search_speed_ms: 12.594106534961611
2025-03-13 10:55:10,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:10,245 [INFO]: 	nb vectors: 2025
2025-03-13 10:55:10,245 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:10,245 [INFO]: 	compression ratio: 0.9993087213086148
2025-03-13 10:55:10,245 [INFO]: }
2025-03-13 10:55:10,245 [INFO]: 	>>> Finished "Creating the index" in 39.8419 secs
2025-03-13 10:55:10,245 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8793 secs
2025-03-13 10:55:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 58971 [episode count 6/20]
[retrieval_preprocessing] for episode 45150 [episode count 7/20], we have num_retrieval=np.int64(2031) num_query=np.int64(88)
2025-03-13 10:55:11,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:11,560 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:11
2025-03-13 10:55:11,560 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.52it/s]
2025-03-13 10:55:11,591 [INFO]: There are 2031 embeddings of dim 49152
2025-03-13 10:55:11,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 10:55:11,591 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:11
2025-03-13 10:55:11,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:11,592 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:55:11,592 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:11,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:55:11,592 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:11
2025-03-13 10:55:11,592 [INFO]: 419.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:11,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 10:55:11,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:11
2025-03-13 10:55:11,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:11,592 [INFO]: 	Creating the index 03/13/2025, 10:55:11
2025-03-13 10:55:11,592 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:11
2025-03-13 10:55:11,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 10:55:11,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:11
2025-03-13 10:55:11,594 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:55:11,594 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.06it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.77it/s]100%|██████████| 8/8 [00:01<00:00,  4.28it/s]
2025-03-13 10:55:13,469 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:13
2025-03-13 10:55:39,771 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3018 secs
2025-03-13 10:55:39,771 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 10:55:39,771 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.64it/s]
2025-03-13 10:55:51,138 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3661 secs
2025-03-13 10:55:51,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5449 secs
2025-03-13 10:55:51,139 [INFO]: {
2025-03-13 10:55:51,139 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:51,139 [INFO]: 	index_param: efSearch=271
2025-03-13 10:55:51,139 [INFO]: 	index_path: knn.index
2025-03-13 10:55:51,139 [INFO]: 	size in bytes: 399587050
2025-03-13 10:55:51,139 [INFO]: 	avg_search_speed_ms: 11.684861831654246
2025-03-13 10:55:51,139 [INFO]: 	99p_search_speed_ms: 17.0353880035691
2025-03-13 10:55:51,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:51,139 [INFO]: 	nb vectors: 2031
2025-03-13 10:55:51,139 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:51,139 [INFO]: 	compression ratio: 0.9993087814032011
2025-03-13 10:55:51,139 [INFO]: }
2025-03-13 10:55:51,139 [INFO]: 	>>> Finished "Creating the index" in 39.5470 secs
2025-03-13 10:55:51,139 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5796 secs
2025-03-13 10:55:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 45150 [episode count 7/20]
[retrieval_preprocessing] for episode 70243 [episode count 8/20], we have num_retrieval=np.int64(2005) num_query=np.int64(114)
2025-03-13 10:55:52,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:52,490 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:52
2025-03-13 10:55:52,490 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.37it/s]
2025-03-13 10:55:52,521 [INFO]: There are 2005 embeddings of dim 49152
2025-03-13 10:55:52,522 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 10:55:52,522 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:52,522 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:55:52,522 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:52,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:52,522 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,522 [INFO]: 413.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:52,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:55:52,522 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:52
2025-03-13 10:55:52,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:52,522 [INFO]: 	Creating the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,522 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:52
2025-03-13 10:55:52,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:55:52,523 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,523 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:55:52,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.55it/s] 88%|████████▊ | 7/8 [00:00<00:00, 32.97it/s]100%|██████████| 8/8 [00:01<00:00,  4.72it/s]
2025-03-13 10:55:54,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:54
2025-03-13 10:56:23,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3649 secs
2025-03-13 10:56:23,587 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 10:56:23,587 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 10:56:35,579 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9925 secs
2025-03-13 10:56:35,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0575 secs
2025-03-13 10:56:35,581 [INFO]: {
2025-03-13 10:56:35,581 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:35,581 [INFO]: 	index_param: efSearch=224
2025-03-13 10:56:35,581 [INFO]: 	index_path: knn.index
2025-03-13 10:56:35,581 [INFO]: 	size in bytes: 394471630
2025-03-13 10:56:35,581 [INFO]: 	avg_search_speed_ms: 9.760382217014344
2025-03-13 10:56:35,581 [INFO]: 	99p_search_speed_ms: 13.818921176716685
2025-03-13 10:56:35,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:35,581 [INFO]: 	nb vectors: 2005
2025-03-13 10:56:35,581 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:35,581 [INFO]: 	compression ratio: 0.9993089743868273
2025-03-13 10:56:35,581 [INFO]: }
2025-03-13 10:56:35,581 [INFO]: 	>>> Finished "Creating the index" in 43.0590 secs
2025-03-13 10:56:35,581 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0915 secs
2025-03-13 10:56:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 70243 [episode count 8/20]
[retrieval_preprocessing] for episode 30319 [episode count 9/20], we have num_retrieval=np.int64(2009) num_query=np.int64(110)
2025-03-13 10:56:36,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:36,894 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:36
2025-03-13 10:56:36,894 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1798.59it/s]
2025-03-13 10:56:36,925 [INFO]: There are 2009 embeddings of dim 49152
2025-03-13 10:56:36,925 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 10:56:36,926 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,926 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:36,926 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:56:36,926 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:36,926 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:36,926 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,926 [INFO]: 414.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:36,926 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:56:36,926 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:36
2025-03-13 10:56:36,926 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:36,926 [INFO]: 	Creating the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,926 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:36
2025-03-13 10:56:36,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:56:36,927 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,927 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:56:36,927 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.78it/s]100%|██████████| 8/8 [00:01<00:00,  4.32it/s]100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
2025-03-13 10:56:38,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:38
2025-03-13 10:57:08,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2781 secs
2025-03-13 10:57:08,959 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 10:57:08,959 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 10:57:20,240 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2808 secs
2025-03-13 10:57:20,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3140 secs
2025-03-13 10:57:20,241 [INFO]: {
2025-03-13 10:57:20,241 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:20,241 [INFO]: 	index_param: efSearch=235
2025-03-13 10:57:20,241 [INFO]: 	index_path: knn.index
2025-03-13 10:57:20,241 [INFO]: 	size in bytes: 395258650
2025-03-13 10:57:20,241 [INFO]: 	avg_search_speed_ms: 8.811815256367762
2025-03-13 10:57:20,241 [INFO]: 	99p_search_speed_ms: 11.90402690321208
2025-03-13 10:57:20,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:20,241 [INFO]: 	nb vectors: 2009
2025-03-13 10:57:20,241 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:20,241 [INFO]: 	compression ratio: 0.9993088626902915
2025-03-13 10:57:20,241 [INFO]: }
2025-03-13 10:57:20,241 [INFO]: 	>>> Finished "Creating the index" in 43.3155 secs
2025-03-13 10:57:20,241 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3476 secs
2025-03-13 10:57:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 30319 [episode count 9/20]
[retrieval_preprocessing] for episode 5751 [episode count 10/20], we have num_retrieval=np.int64(2030) num_query=np.int64(89)
2025-03-13 10:57:21,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:21,712 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:21
2025-03-13 10:57:21,712 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.76it/s]
2025-03-13 10:57:21,744 [INFO]: There are 2030 embeddings of dim 49152
2025-03-13 10:57:21,744 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 10:57:21,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:21
2025-03-13 10:57:21,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:21,744 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:57:21,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:21,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:21,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:21
2025-03-13 10:57:21,744 [INFO]: 418.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:21,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:21,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:21
2025-03-13 10:57:21,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:21,744 [INFO]: 	Creating the index 03/13/2025, 10:57:21
2025-03-13 10:57:21,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:21
2025-03-13 10:57:21,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:57:21,746 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:21
2025-03-13 10:57:21,746 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:57:21,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.19it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.32it/s]100%|██████████| 8/8 [00:01<00:00,  4.55it/s]
2025-03-13 10:57:23,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:23
2025-03-13 10:57:51,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7783 secs
2025-03-13 10:57:51,286 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 10:57:51,286 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s]
2025-03-13 10:58:04,080 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7941 secs
2025-03-13 10:58:04,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3356 secs
2025-03-13 10:58:04,081 [INFO]: {
2025-03-13 10:58:04,081 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:04,082 [INFO]: 	index_param: efSearch=265
2025-03-13 10:58:04,082 [INFO]: 	index_path: knn.index
2025-03-13 10:58:04,082 [INFO]: 	size in bytes: 399390310
2025-03-13 10:58:04,082 [INFO]: 	avg_search_speed_ms: 12.323608122458635
2025-03-13 10:58:04,082 [INFO]: 	99p_search_speed_ms: 17.072329192887988
2025-03-13 10:58:04,082 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:04,082 [INFO]: 	nb vectors: 2030
2025-03-13 10:58:04,082 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:04,082 [INFO]: 	compression ratio: 0.9993087714121056
2025-03-13 10:58:04,082 [INFO]: }
2025-03-13 10:58:04,082 [INFO]: 	>>> Finished "Creating the index" in 42.3371 secs
2025-03-13 10:58:04,082 [INFO]: >>> Finished "Launching the whole pipeline" in 42.3699 secs
2025-03-13 10:58:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 5751 [episode count 10/20]
[retrieval_preprocessing] for episode 62589 [episode count 11/20], we have num_retrieval=np.int64(2001) num_query=np.int64(118)
2025-03-13 10:58:05,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:05,261 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:05
2025-03-13 10:58:05,261 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1405.60it/s]
2025-03-13 10:58:05,293 [INFO]: There are 2001 embeddings of dim 49152
2025-03-13 10:58:05,293 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 10:58:05,293 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:05
2025-03-13 10:58:05,293 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:05,293 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:58:05,293 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:05,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:05,293 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:05
2025-03-13 10:58:05,293 [INFO]: 413.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:05,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:58:05,293 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:05
2025-03-13 10:58:05,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:05,294 [INFO]: 	Creating the index 03/13/2025, 10:58:05
2025-03-13 10:58:05,294 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:05
2025-03-13 10:58:05,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:58:05,295 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:05
2025-03-13 10:58:05,295 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:58:05,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.94it/s]100%|██████████| 8/8 [00:01<00:00,  5.24it/s]100%|██████████| 8/8 [00:01<00:00,  5.53it/s]
2025-03-13 10:58:06,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:06
2025-03-13 10:58:33,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2867 secs
2025-03-13 10:58:33,032 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 10:58:33,032 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 10:58:44,495 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4633 secs
2025-03-13 10:58:44,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2023 secs
2025-03-13 10:58:44,497 [INFO]: {
2025-03-13 10:58:44,497 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:44,497 [INFO]: 	index_param: efSearch=282
2025-03-13 10:58:44,497 [INFO]: 	index_path: knn.index
2025-03-13 10:58:44,497 [INFO]: 	size in bytes: 393684670
2025-03-13 10:58:44,497 [INFO]: 	avg_search_speed_ms: 11.375664447603578
2025-03-13 10:58:44,497 [INFO]: 	99p_search_speed_ms: 15.87576520163566
2025-03-13 10:58:44,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:44,497 [INFO]: 	nb vectors: 2001
2025-03-13 10:58:44,497 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:44,498 [INFO]: 	compression ratio: 0.9993089342290112
2025-03-13 10:58:44,498 [INFO]: }
2025-03-13 10:58:44,498 [INFO]: 	>>> Finished "Creating the index" in 39.2039 secs
2025-03-13 10:58:44,498 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2367 secs
2025-03-13 10:58:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 62589 [episode count 11/20]
[retrieval_preprocessing] for episode 26251 [episode count 12/20], we have num_retrieval=np.int64(1994) num_query=np.int64(125)
2025-03-13 10:58:45,947 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:46,241 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:46
2025-03-13 10:58:46,241 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.38it/s]
2025-03-13 10:58:46,274 [INFO]: There are 1994 embeddings of dim 49152
2025-03-13 10:58:46,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 10:58:46,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:46
2025-03-13 10:58:46,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:46,274 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:58:46,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:46,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:46,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:46
2025-03-13 10:58:46,274 [INFO]: 411.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:46,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:58:46,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:46
2025-03-13 10:58:46,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:46,274 [INFO]: 	Creating the index 03/13/2025, 10:58:46
2025-03-13 10:58:46,274 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:46
2025-03-13 10:58:46,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:58:46,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:46
2025-03-13 10:58:46,276 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:58:46,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.70it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.39it/s]100%|██████████| 8/8 [00:01<00:00,  4.92it/s]
2025-03-13 10:58:47,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:47
2025-03-13 10:59:16,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2958 secs
2025-03-13 10:59:16,200 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 10:59:16,201 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 10:59:27,470 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2686 secs
2025-03-13 10:59:27,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1953 secs
2025-03-13 10:59:27,472 [INFO]: {
2025-03-13 10:59:27,472 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:27,472 [INFO]: 	index_param: efSearch=254
2025-03-13 10:59:27,472 [INFO]: 	index_path: knn.index
2025-03-13 10:59:27,472 [INFO]: 	size in bytes: 392307490
2025-03-13 10:59:27,472 [INFO]: 	avg_search_speed_ms: 9.823925359758286
2025-03-13 10:59:27,472 [INFO]: 	99p_search_speed_ms: 14.268549412954647
2025-03-13 10:59:27,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:27,472 [INFO]: 	nb vectors: 1994
2025-03-13 10:59:27,472 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:27,472 [INFO]: 	compression ratio: 0.999308863565159
2025-03-13 10:59:27,472 [INFO]: }
2025-03-13 10:59:27,472 [INFO]: 	>>> Finished "Creating the index" in 41.1974 secs
2025-03-13 10:59:27,472 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2308 secs
2025-03-13 10:59:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 26251 [episode count 12/20]
[retrieval_preprocessing] for episode 35483 [episode count 13/20], we have num_retrieval=np.int64(2004) num_query=np.int64(115)
2025-03-13 10:59:28,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:29,330 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:29
2025-03-13 10:59:29,330 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2066.16it/s]
2025-03-13 10:59:29,359 [INFO]: There are 2004 embeddings of dim 49152
2025-03-13 10:59:29,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 10:59:29,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:29
2025-03-13 10:59:29,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:29,360 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 10:59:29,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:29,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:59:29,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:29
2025-03-13 10:59:29,360 [INFO]: 413.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:29,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:59:29,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:29
2025-03-13 10:59:29,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:29,361 [INFO]: 	Creating the index 03/13/2025, 10:59:29
2025-03-13 10:59:29,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:29
2025-03-13 10:59:29,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 10:59:29,363 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:29
2025-03-13 10:59:29,363 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:59:29,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.75it/s]100%|██████████| 8/8 [00:01<00:00,  4.75it/s]100%|██████████| 8/8 [00:01<00:00,  5.23it/s]
2025-03-13 10:59:30,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:30
2025-03-13 11:00:00,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4586 secs
2025-03-13 11:00:00,357 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 11:00:00,357 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.56it/s]
2025-03-13 11:00:11,754 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3976 secs
2025-03-13 11:00:11,756 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3927 secs
2025-03-13 11:00:11,756 [INFO]: {
2025-03-13 11:00:11,756 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:11,756 [INFO]: 	index_param: efSearch=267
2025-03-13 11:00:11,756 [INFO]: 	index_path: knn.index
2025-03-13 11:00:11,756 [INFO]: 	size in bytes: 394274890
2025-03-13 11:00:11,756 [INFO]: 	avg_search_speed_ms: 9.929901281882229
2025-03-13 11:00:11,756 [INFO]: 	99p_search_speed_ms: 13.854530001990495
2025-03-13 11:00:11,756 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:11,756 [INFO]: 	nb vectors: 2004
2025-03-13 11:00:11,756 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:11,756 [INFO]: 	compression ratio: 0.9993089643624021
2025-03-13 11:00:11,756 [INFO]: }
2025-03-13 11:00:11,756 [INFO]: 	>>> Finished "Creating the index" in 42.3956 secs
2025-03-13 11:00:11,756 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4260 secs
2025-03-13 11:00:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 35483 [episode count 13/20]
[retrieval_preprocessing] for episode 18590 [episode count 14/20], we have num_retrieval=np.int64(2030) num_query=np.int64(89)
2025-03-13 11:00:13,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:13,321 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:13
2025-03-13 11:00:13,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 11:00:13,356 [INFO]: There are 2030 embeddings of dim 49152
2025-03-13 11:00:13,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 11:00:13,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:13
2025-03-13 11:00:13,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:13,357 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:00:13,358 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:13,358 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:00:13,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:13
2025-03-13 11:00:13,358 [INFO]: 418.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:13,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:00:13,359 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:13
2025-03-13 11:00:13,359 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:13,359 [INFO]: 	Creating the index 03/13/2025, 11:00:13
2025-03-13 11:00:13,359 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:13
2025-03-13 11:00:13,362 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:00:13,362 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:13
2025-03-13 11:00:13,363 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:13,363 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.04it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.94it/s]100%|██████████| 8/8 [00:01<00:00,  5.33it/s]
2025-03-13 11:00:14,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:14
2025-03-13 11:00:44,615 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7454 secs
2025-03-13 11:00:44,615 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 11:00:44,616 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-13 11:00:57,773 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1575 secs
2025-03-13 11:00:57,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4123 secs
2025-03-13 11:00:57,775 [INFO]: {
2025-03-13 11:00:57,775 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:57,775 [INFO]: 	index_param: efSearch=254
2025-03-13 11:00:57,775 [INFO]: 	index_path: knn.index
2025-03-13 11:00:57,775 [INFO]: 	size in bytes: 399390310
2025-03-13 11:00:57,775 [INFO]: 	avg_search_speed_ms: 11.16620005450386
2025-03-13 11:00:57,775 [INFO]: 	99p_search_speed_ms: 20.549908862449218
2025-03-13 11:00:57,775 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:57,775 [INFO]: 	nb vectors: 2030
2025-03-13 11:00:57,775 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:57,775 [INFO]: 	compression ratio: 0.9993087714121056
2025-03-13 11:00:57,775 [INFO]: }
2025-03-13 11:00:57,775 [INFO]: 	>>> Finished "Creating the index" in 44.4162 secs
2025-03-13 11:00:57,775 [INFO]: >>> Finished "Launching the whole pipeline" in 44.4548 secs
2025-03-13 11:00:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18590 [episode count 14/20]
[retrieval_preprocessing] for episode 86698 [episode count 15/20], we have num_retrieval=np.int64(2018) num_query=np.int64(101)
2025-03-13 11:00:58,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:59,233 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:59
2025-03-13 11:00:59,233 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1785.57it/s]
2025-03-13 11:00:59,268 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 11:00:59,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 11:00:59,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:59
2025-03-13 11:00:59,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:59,269 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:00:59,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:59,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:59,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:59
2025-03-13 11:00:59,269 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:59,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:00:59,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:59
2025-03-13 11:00:59,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:59,269 [INFO]: 	Creating the index 03/13/2025, 11:00:59
2025-03-13 11:00:59,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:59
2025-03-13 11:00:59,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:00:59,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:59
2025-03-13 11:00:59,271 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:59,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.07it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.30it/s]100%|██████████| 8/8 [00:01<00:00,  5.39it/s]
2025-03-13 11:01:00,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:00
2025-03-13 11:01:30,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3392 secs
2025-03-13 11:01:30,099 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 11:01:30,100 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-13 11:01:41,430 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3308 secs
2025-03-13 11:01:41,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1611 secs
2025-03-13 11:01:41,432 [INFO]: {
2025-03-13 11:01:41,432 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:41,432 [INFO]: 	index_param: efSearch=259
2025-03-13 11:01:41,432 [INFO]: 	index_path: knn.index
2025-03-13 11:01:41,432 [INFO]: 	size in bytes: 397029310
2025-03-13 11:01:41,432 [INFO]: 	avg_search_speed_ms: 9.600925645630113
2025-03-13 11:01:41,432 [INFO]: 	99p_search_speed_ms: 12.826101938262578
2025-03-13 11:01:41,432 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:41,432 [INFO]: 	nb vectors: 2018
2025-03-13 11:01:41,432 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:41,432 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 11:01:41,432 [INFO]: }
2025-03-13 11:01:41,432 [INFO]: 	>>> Finished "Creating the index" in 42.1626 secs
2025-03-13 11:01:41,432 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1986 secs
2025-03-13 11:01:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 86698 [episode count 15/20]
[retrieval_preprocessing] for episode 22189 [episode count 16/20], we have num_retrieval=np.int64(2018) num_query=np.int64(101)
2025-03-13 11:01:42,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:42,821 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:42
2025-03-13 11:01:42,821 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2247.75it/s]
2025-03-13 11:01:42,849 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 11:01:42,849 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:01:42,850 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:42
2025-03-13 11:01:42,850 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:42,850 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:01:42,850 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:42,850 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:01:42,850 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:42
2025-03-13 11:01:42,850 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:42,850 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:01:42,850 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:42
2025-03-13 11:01:42,850 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:42,850 [INFO]: 	Creating the index 03/13/2025, 11:01:42
2025-03-13 11:01:42,850 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:42
2025-03-13 11:01:42,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:01:42,851 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:42
2025-03-13 11:01:42,851 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:01:42,851 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.68it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.98it/s]100%|██████████| 8/8 [00:01<00:00,  5.23it/s]
2025-03-13 11:01:44,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:44
2025-03-13 11:02:10,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0288 secs
2025-03-13 11:02:10,413 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 11:02:10,413 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 11:02:24,176 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7632 secs
2025-03-13 11:02:24,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3265 secs
2025-03-13 11:02:24,178 [INFO]: {
2025-03-13 11:02:24,178 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:24,178 [INFO]: 	index_param: efSearch=250
2025-03-13 11:02:24,178 [INFO]: 	index_path: knn.index
2025-03-13 11:02:24,178 [INFO]: 	size in bytes: 397029310
2025-03-13 11:02:24,178 [INFO]: 	avg_search_speed_ms: 9.78762146501042
2025-03-13 11:02:24,178 [INFO]: 	99p_search_speed_ms: 14.355372546706343
2025-03-13 11:02:24,178 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:24,178 [INFO]: 	nb vectors: 2018
2025-03-13 11:02:24,178 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:24,178 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 11:02:24,178 [INFO]: }
2025-03-13 11:02:24,178 [INFO]: 	>>> Finished "Creating the index" in 41.3280 secs
2025-03-13 11:02:24,178 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3575 secs
2025-03-13 11:02:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 22189 [episode count 16/20]
[retrieval_preprocessing] for episode 90816 [episode count 17/20], we have num_retrieval=np.int64(2012) num_query=np.int64(107)
2025-03-13 11:02:25,242 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:25,540 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:25
2025-03-13 11:02:25,540 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1850.97it/s]
2025-03-13 11:02:25,573 [INFO]: There are 2012 embeddings of dim 49152
2025-03-13 11:02:25,573 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 11:02:25,574 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:25,574 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:02:25,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:25,575 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 11:02:25,575 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,576 [INFO]: 415.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:25,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:02:25,576 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:25
2025-03-13 11:02:25,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:25,577 [INFO]: 	Creating the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:25
2025-03-13 11:02:25,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0040 secs
2025-03-13 11:02:25,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:25
2025-03-13 11:02:25,582 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:02:25,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.03it/s] 75%|███████▌  | 6/8 [00:00<00:00, 27.50it/s]100%|██████████| 8/8 [00:01<00:00,  4.37it/s]
2025-03-13 11:02:27,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:27
2025-03-13 11:02:52,304 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8823 secs
2025-03-13 11:02:52,304 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:02:52,304 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 11:03:03,718 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4132 secs
2025-03-13 11:03:03,719 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.1378 secs
2025-03-13 11:03:03,720 [INFO]: {
2025-03-13 11:03:03,720 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:03,720 [INFO]: 	index_param: efSearch=216
2025-03-13 11:03:03,720 [INFO]: 	index_path: knn.index
2025-03-13 11:03:03,720 [INFO]: 	size in bytes: 395848870
2025-03-13 11:03:03,720 [INFO]: 	avg_search_speed_ms: 9.300613034040083
2025-03-13 11:03:03,720 [INFO]: 	99p_search_speed_ms: 14.703408982604742
2025-03-13 11:03:03,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:03,720 [INFO]: 	nb vectors: 2012
2025-03-13 11:03:03,720 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:03,720 [INFO]: 	compression ratio: 0.9993088928105315
2025-03-13 11:03:03,720 [INFO]: }
2025-03-13 11:03:03,720 [INFO]: 	>>> Finished "Creating the index" in 38.1430 secs
2025-03-13 11:03:03,720 [INFO]: >>> Finished "Launching the whole pipeline" in 38.1800 secs
2025-03-13 11:03:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 90816 [episode count 17/20]
[retrieval_preprocessing] for episode 66247 [episode count 18/20], we have num_retrieval=np.int64(2022) num_query=np.int64(97)
2025-03-13 11:03:04,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:05,138 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:05
2025-03-13 11:03:05,138 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2154.24it/s]
2025-03-13 11:03:05,173 [INFO]: There are 2022 embeddings of dim 49152
2025-03-13 11:03:05,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 11:03:05,174 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:05
2025-03-13 11:03:05,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:05,174 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:03:05,174 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:05,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:05,174 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:05
2025-03-13 11:03:05,174 [INFO]: 417.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:05,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:05,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:05
2025-03-13 11:03:05,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:05,174 [INFO]: 	Creating the index 03/13/2025, 11:03:05
2025-03-13 11:03:05,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:05
2025-03-13 11:03:05,175 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 11:03:05,175 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:05
2025-03-13 11:03:05,175 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:05,175 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.30it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.15it/s]100%|██████████| 8/8 [00:02<00:00,  3.87it/s]
2025-03-13 11:03:07,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:07
2025-03-13 11:03:37,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8413 secs
2025-03-13 11:03:37,088 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 11:03:37,088 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-13 11:03:49,266 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1773 secs
2025-03-13 11:03:49,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0924 secs
2025-03-13 11:03:49,268 [INFO]: {
2025-03-13 11:03:49,268 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:49,268 [INFO]: 	index_param: efSearch=243
2025-03-13 11:03:49,268 [INFO]: 	index_path: knn.index
2025-03-13 11:03:49,268 [INFO]: 	size in bytes: 397816330
2025-03-13 11:03:49,268 [INFO]: 	avg_search_speed_ms: 9.879737786042181
2025-03-13 11:03:49,268 [INFO]: 	99p_search_speed_ms: 16.786600947380062
2025-03-13 11:03:49,268 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:49,268 [INFO]: 	nb vectors: 2022
2025-03-13 11:03:49,268 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:49,268 [INFO]: 	compression ratio: 0.9993088418466884
2025-03-13 11:03:49,268 [INFO]: }
2025-03-13 11:03:49,268 [INFO]: 	>>> Finished "Creating the index" in 44.0938 secs
2025-03-13 11:03:49,268 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1298 secs
2025-03-13 11:03:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 66247 [episode count 18/20]
[retrieval_preprocessing] for episode 55519 [episode count 19/20], we have num_retrieval=np.int64(2020) num_query=np.int64(99)
2025-03-13 11:03:50,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:50,955 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:50
2025-03-13 11:03:50,955 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1682.43it/s]
2025-03-13 11:03:50,987 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 11:03:50,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 11:03:50,988 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:50,988 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:03:50,988 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:50,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:50,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,988 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:50,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:50,988 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:50
2025-03-13 11:03:50,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:50,988 [INFO]: 	Creating the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,988 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:50
2025-03-13 11:03:50,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:03:50,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:50
2025-03-13 11:03:50,990 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:50,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.83it/s]100%|██████████| 8/8 [00:01<00:00,  4.55it/s]100%|██████████| 8/8 [00:01<00:00,  4.82it/s]
2025-03-13 11:03:52,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:52
2025-03-13 11:04:23,304 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6486 secs
2025-03-13 11:04:23,304 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 11:04:23,304 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.54it/s]
2025-03-13 11:04:35,492 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1875 secs
2025-03-13 11:04:35,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.5034 secs
2025-03-13 11:04:35,493 [INFO]: {
2025-03-13 11:04:35,493 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:35,493 [INFO]: 	index_param: efSearch=242
2025-03-13 11:04:35,493 [INFO]: 	index_path: knn.index
2025-03-13 11:04:35,493 [INFO]: 	size in bytes: 397422850
2025-03-13 11:04:35,493 [INFO]: 	avg_search_speed_ms: 9.491837102357842
2025-03-13 11:04:35,493 [INFO]: 	99p_search_speed_ms: 13.558176585938781
2025-03-13 11:04:35,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:35,493 [INFO]: 	nb vectors: 2020
2025-03-13 11:04:35,493 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:35,493 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 11:04:35,493 [INFO]: }
2025-03-13 11:04:35,493 [INFO]: 	>>> Finished "Creating the index" in 44.5051 secs
2025-03-13 11:04:35,493 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5385 secs
2025-03-13 11:04:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 55519 [episode count 19/20]
2025-03-13 11:04:36: [retrieval_preprocessing] finished for 164628080_put_rubber_duck_in_pot [chosen_id count 0/260]
2025-03-13 11:04:38: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_can_in_bowl [chosen_id count 1/260]
2025-03-13 11:04:38: [retrieval_preprocessing] we have num_total=4535 embedding_dim=49152
[retrieval_preprocessing] for episode 20490 [episode count 0/20], we have num_retrieval=np.int64(4275) num_query=np.int64(260)
2025-03-13 11:04:38,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:39,058 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:39
2025-03-13 11:04:39,058 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1869.95it/s]
2025-03-13 11:04:39,094 [INFO]: There are 4275 embeddings of dim 49152
2025-03-13 11:04:39,095 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 11:04:39,095 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:39
2025-03-13 11:04:39,095 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:39,096 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:04:39,096 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:39,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:04:39,096 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:39
2025-03-13 11:04:39,096 [INFO]: 882.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:39,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:04:39,097 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:39
2025-03-13 11:04:39,097 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:39,097 [INFO]: 	Creating the index 03/13/2025, 11:04:39
2025-03-13 11:04:39,097 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:39
2025-03-13 11:04:39,100 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:04:39,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:39
2025-03-13 11:04:39,101 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:04:39,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.27it/s] 47%|████▋     | 8/17 [00:00<00:00, 38.71it/s] 82%|████████▏ | 14/17 [00:00<00:00, 44.36it/s]100%|██████████| 17/17 [00:03<00:00,  4.70it/s]
2025-03-13 11:04:42,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:42
2025-03-13 11:05:30,303 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5778 secs
2025-03-13 11:05:30,303 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 11:05:30,303 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.77it/s]
2025-03-13 11:05:42,656 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3529 secs
2025-03-13 11:05:42,659 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5580 secs
2025-03-13 11:05:42,659 [INFO]: {
2025-03-13 11:05:42,659 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:42,659 [INFO]: 	index_param: efSearch=267
2025-03-13 11:05:42,659 [INFO]: 	index_path: knn.index
2025-03-13 11:05:42,659 [INFO]: 	size in bytes: 841080610
2025-03-13 11:05:42,659 [INFO]: 	avg_search_speed_ms: 12.012281639016226
2025-03-13 11:05:42,659 [INFO]: 	99p_search_speed_ms: 20.419101435691108
2025-03-13 11:05:42,659 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:42,659 [INFO]: 	nb vectors: 4275
2025-03-13 11:05:42,659 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:42,659 [INFO]: 	compression ratio: 0.9993087345100014
2025-03-13 11:05:42,659 [INFO]: }
2025-03-13 11:05:42,659 [INFO]: 	>>> Finished "Creating the index" in 63.5620 secs
2025-03-13 11:05:42,659 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6011 secs
2025-03-13 11:05:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 20490 [episode count 0/20]
[retrieval_preprocessing] for episode 81964 [episode count 1/20], we have num_retrieval=np.int64(4324) num_query=np.int64(211)
2025-03-13 11:05:46,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:46,887 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:46
2025-03-13 11:05:46,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1765.28it/s]
2025-03-13 11:05:46,921 [INFO]: There are 4324 embeddings of dim 49152
2025-03-13 11:05:46,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 11:05:46,921 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:46
2025-03-13 11:05:46,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:46,921 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:05:46,921 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:46,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:46,921 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:46
2025-03-13 11:05:46,922 [INFO]: 892.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:46,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:05:46,922 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:46
2025-03-13 11:05:46,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:46,922 [INFO]: 	Creating the index 03/13/2025, 11:05:46
2025-03-13 11:05:46,922 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:46
2025-03-13 11:05:46,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:05:46,923 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:46
2025-03-13 11:05:46,923 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:05:46,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.96it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.06it/s] 61%|██████    | 11/18 [00:00<00:00, 36.45it/s] 89%|████████▉ | 16/18 [00:00<00:00, 40.12it/s]100%|██████████| 18/18 [00:03<00:00,  5.28it/s]
2025-03-13 11:05:50,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:50
2025-03-13 11:06:31,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0131 secs
2025-03-13 11:06:31,347 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 11:06:31,347 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.77it/s]
2025-03-13 11:06:43,619 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2719 secs
2025-03-13 11:06:43,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6984 secs
2025-03-13 11:06:43,622 [INFO]: {
2025-03-13 11:06:43,622 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:43,622 [INFO]: 	index_param: efSearch=225
2025-03-13 11:06:43,622 [INFO]: 	index_path: knn.index
2025-03-13 11:06:43,622 [INFO]: 	size in bytes: 850721170
2025-03-13 11:06:43,622 [INFO]: 	avg_search_speed_ms: 10.860828767721738
2025-03-13 11:06:43,622 [INFO]: 	99p_search_speed_ms: 16.412784764543172
2025-03-13 11:06:43,622 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:43,622 [INFO]: 	nb vectors: 4324
2025-03-13 11:06:43,622 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:43,622 [INFO]: 	compression ratio: 0.9993086124799269
2025-03-13 11:06:43,622 [INFO]: }
2025-03-13 11:06:43,622 [INFO]: 	>>> Finished "Creating the index" in 56.7002 secs
2025-03-13 11:06:43,622 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7350 secs
2025-03-13 11:06:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 81964 [episode count 1/20]
[retrieval_preprocessing] for episode 34872 [episode count 2/20], we have num_retrieval=np.int64(4313) num_query=np.int64(222)
2025-03-13 11:06:45,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:46,213 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:46
2025-03-13 11:06:46,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1888.48it/s]
2025-03-13 11:06:46,243 [INFO]: There are 4313 embeddings of dim 49152
2025-03-13 11:06:46,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 11:06:46,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:46
2025-03-13 11:06:46,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:46,243 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:06:46,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:46,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:46,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:46
2025-03-13 11:06:46,244 [INFO]: 890.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:46,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:46,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:46
2025-03-13 11:06:46,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:46,244 [INFO]: 	Creating the index 03/13/2025, 11:06:46
2025-03-13 11:06:46,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:46
2025-03-13 11:06:46,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:06:46,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:46
2025-03-13 11:06:46,245 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:06:46,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.22it/s] 47%|████▋     | 8/17 [00:00<00:00, 37.88it/s] 82%|████████▏ | 14/17 [00:00<00:00, 44.45it/s]100%|██████████| 17/17 [00:03<00:00,  4.86it/s]
2025-03-13 11:06:49,743 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:49
2025-03-13 11:07:32,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1936 secs
2025-03-13 11:07:32,937 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 11:07:32,937 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-13 11:07:48,383 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4461 secs
2025-03-13 11:07:48,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1406 secs
2025-03-13 11:07:48,386 [INFO]: {
2025-03-13 11:07:48,386 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:48,386 [INFO]: 	index_param: efSearch=187
2025-03-13 11:07:48,386 [INFO]: 	index_path: knn.index
2025-03-13 11:07:48,386 [INFO]: 	size in bytes: 848556970
2025-03-13 11:07:48,386 [INFO]: 	avg_search_speed_ms: 8.481535507623578
2025-03-13 11:07:48,386 [INFO]: 	99p_search_speed_ms: 12.142986967228357
2025-03-13 11:07:48,386 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:48,386 [INFO]: 	nb vectors: 4313
2025-03-13 11:07:48,386 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:48,386 [INFO]: 	compression ratio: 0.9993086309808993
2025-03-13 11:07:48,386 [INFO]: }
2025-03-13 11:07:48,386 [INFO]: 	>>> Finished "Creating the index" in 62.1419 secs
2025-03-13 11:07:48,386 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1724 secs
2025-03-13 11:07:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 34872 [episode count 2/20]
[retrieval_preprocessing] for episode 26723 [episode count 3/20], we have num_retrieval=np.int64(4296) num_query=np.int64(239)
2025-03-13 11:07:50,563 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:51,277 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:51
2025-03-13 11:07:51,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2015.52it/s]
2025-03-13 11:07:51,315 [INFO]: There are 4296 embeddings of dim 49152
2025-03-13 11:07:51,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 11:07:51,316 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:51
2025-03-13 11:07:51,316 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:51,317 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:07:51,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:51,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:07:51,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:51
2025-03-13 11:07:51,318 [INFO]: 886.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:51,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:07:51,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:51
2025-03-13 11:07:51,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:51,319 [INFO]: 	Creating the index 03/13/2025, 11:07:51
2025-03-13 11:07:51,319 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:51
2025-03-13 11:07:51,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 11:07:51,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:51
2025-03-13 11:07:51,324 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:07:51,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.58it/s] 29%|██▉       | 5/17 [00:00<00:00, 25.99it/s] 53%|█████▎    | 9/17 [00:00<00:00, 31.01it/s] 76%|███████▋  | 13/17 [00:00<00:00, 33.38it/s]100%|██████████| 17/17 [00:03<00:00,  3.28it/s]100%|██████████| 17/17 [00:03<00:00,  5.00it/s]
2025-03-13 11:07:54,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:54
2025-03-13 11:08:35,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1425 secs
2025-03-13 11:08:35,871 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:08:35,871 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 11:08:48,292 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4207 secs
2025-03-13 11:08:48,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9712 secs
2025-03-13 11:08:48,295 [INFO]: {
2025-03-13 11:08:48,295 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:48,295 [INFO]: 	index_param: efSearch=216
2025-03-13 11:08:48,295 [INFO]: 	index_path: knn.index
2025-03-13 11:08:48,295 [INFO]: 	size in bytes: 845212330
2025-03-13 11:08:48,295 [INFO]: 	avg_search_speed_ms: 10.267674832344744
2025-03-13 11:08:48,295 [INFO]: 	99p_search_speed_ms: 14.35491192387417
2025-03-13 11:08:48,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:48,295 [INFO]: 	nb vectors: 4296
2025-03-13 11:08:48,295 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:48,295 [INFO]: 	compression ratio: 0.9993086210656676
2025-03-13 11:08:48,295 [INFO]: }
2025-03-13 11:08:48,295 [INFO]: 	>>> Finished "Creating the index" in 56.9759 secs
2025-03-13 11:08:48,295 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0179 secs
2025-03-13 11:08:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 26723 [episode count 3/20]
[retrieval_preprocessing] for episode 92396 [episode count 4/20], we have num_retrieval=np.int64(4336) num_query=np.int64(199)
2025-03-13 11:08:50,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:50,952 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:50
2025-03-13 11:08:50,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.90it/s]
2025-03-13 11:08:50,984 [INFO]: There are 4336 embeddings of dim 49152
2025-03-13 11:08:50,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 11:08:50,985 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:50,985 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:08:50,985 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:50,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:50,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,985 [INFO]: 894.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:50,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:08:50,985 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:50
2025-03-13 11:08:50,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:50,985 [INFO]: 	Creating the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,985 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:50
2025-03-13 11:08:50,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:08:50,986 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:50
2025-03-13 11:08:50,986 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:08:50,986 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.69it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.56it/s] 61%|██████    | 11/18 [00:00<00:00, 37.70it/s] 89%|████████▉ | 16/18 [00:00<00:00, 38.97it/s]100%|██████████| 18/18 [00:03<00:00,  4.55it/s]
2025-03-13 11:08:54,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:54
2025-03-13 11:09:39,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3767 secs
2025-03-13 11:09:39,324 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:09:39,325 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.06it/s]
2025-03-13 11:09:51,638 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3139 secs
2025-03-13 11:09:51,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6553 secs
2025-03-13 11:09:51,642 [INFO]: {
2025-03-13 11:09:51,642 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:51,642 [INFO]: 	index_param: efSearch=216
2025-03-13 11:09:51,642 [INFO]: 	index_path: knn.index
2025-03-13 11:09:51,642 [INFO]: 	size in bytes: 853082110
2025-03-13 11:09:51,642 [INFO]: 	avg_search_speed_ms: 10.356624052748007
2025-03-13 11:09:51,642 [INFO]: 	99p_search_speed_ms: 15.448201098479332
2025-03-13 11:09:51,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:51,642 [INFO]: 	nb vectors: 4336
2025-03-13 11:09:51,642 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:51,642 [INFO]: 	compression ratio: 0.9993085987936143
2025-03-13 11:09:51,642 [INFO]: }
2025-03-13 11:09:51,642 [INFO]: 	>>> Finished "Creating the index" in 60.6567 secs
2025-03-13 11:09:51,642 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6900 secs
2025-03-13 11:09:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 92396 [episode count 4/20]
[retrieval_preprocessing] for episode 4347 [episode count 5/20], we have num_retrieval=np.int64(4375) num_query=np.int64(160)
2025-03-13 11:09:54,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:54,728 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:54
2025-03-13 11:09:54,728 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.95it/s]
2025-03-13 11:09:54,765 [INFO]: There are 4375 embeddings of dim 49152
2025-03-13 11:09:54,765 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 11:09:54,765 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:54
2025-03-13 11:09:54,765 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:54,766 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:09:54,766 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:54,766 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:09:54,766 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:54
2025-03-13 11:09:54,767 [INFO]: 902.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:54,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:09:54,767 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:54
2025-03-13 11:09:54,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:54,767 [INFO]: 	Creating the index 03/13/2025, 11:09:54
2025-03-13 11:09:54,767 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:54
2025-03-13 11:09:54,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:09:54,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:54
2025-03-13 11:09:54,771 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:09:54,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.23it/s] 39%|███▉      | 7/18 [00:00<00:00, 36.59it/s] 67%|██████▋   | 12/18 [00:00<00:00, 42.35it/s] 94%|█████████▍| 17/18 [00:00<00:00, 16.52it/s]100%|██████████| 18/18 [00:04<00:00,  4.42it/s]
2025-03-13 11:09:58,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:58
2025-03-13 11:10:41,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6901 secs
2025-03-13 11:10:41,540 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 11:10:41,540 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.91it/s]
2025-03-13 11:10:55,167 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6262 secs
2025-03-13 11:10:55,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3990 secs
2025-03-13 11:10:55,170 [INFO]: {
2025-03-13 11:10:55,171 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:55,171 [INFO]: 	index_param: efSearch=171
2025-03-13 11:10:55,171 [INFO]: 	index_path: knn.index
2025-03-13 11:10:55,171 [INFO]: 	size in bytes: 860755150
2025-03-13 11:10:55,171 [INFO]: 	avg_search_speed_ms: 8.387180571018876
2025-03-13 11:10:55,171 [INFO]: 	99p_search_speed_ms: 12.795775504782794
2025-03-13 11:10:55,171 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:55,171 [INFO]: 	nb vectors: 4375
2025-03-13 11:10:55,171 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:55,171 [INFO]: 	compression ratio: 0.999308572246126
2025-03-13 11:10:55,171 [INFO]: }
2025-03-13 11:10:55,171 [INFO]: 	>>> Finished "Creating the index" in 60.4033 secs
2025-03-13 11:10:55,171 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4428 secs
2025-03-13 11:10:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 4347 [episode count 5/20]
[retrieval_preprocessing] for episode 8448 [episode count 6/20], we have num_retrieval=np.int64(4275) num_query=np.int64(260)
2025-03-13 11:10:57,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:57,811 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:57
2025-03-13 11:10:57,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 11:10:57,848 [INFO]: There are 4275 embeddings of dim 49152
2025-03-13 11:10:57,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 11:10:57,848 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:57
2025-03-13 11:10:57,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:57,848 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:10:57,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:57,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:57,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:57
2025-03-13 11:10:57,848 [INFO]: 882.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:57,848 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:10:57,848 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:57
2025-03-13 11:10:57,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:57,848 [INFO]: 	Creating the index 03/13/2025, 11:10:57
2025-03-13 11:10:57,848 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:57
2025-03-13 11:10:57,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:10:57,850 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:57
2025-03-13 11:10:57,850 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:10:57,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.73it/s] 47%|████▋     | 8/17 [00:00<00:00, 38.25it/s] 82%|████████▏ | 14/17 [00:00<00:00, 43.88it/s]100%|██████████| 17/17 [00:03<00:00,  4.70it/s]
2025-03-13 11:11:01,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:01
2025-03-13 11:11:42,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3362 secs
2025-03-13 11:11:42,805 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:11:42,805 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.32it/s]
2025-03-13 11:11:58,505 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7001 secs
2025-03-13 11:11:58,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6589 secs
2025-03-13 11:11:58,509 [INFO]: {
2025-03-13 11:11:58,509 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:58,509 [INFO]: 	index_param: efSearch=215
2025-03-13 11:11:58,509 [INFO]: 	index_path: knn.index
2025-03-13 11:11:58,509 [INFO]: 	size in bytes: 841080610
2025-03-13 11:11:58,509 [INFO]: 	avg_search_speed_ms: 11.186976780358627
2025-03-13 11:11:58,509 [INFO]: 	99p_search_speed_ms: 15.718455563765017
2025-03-13 11:11:58,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:58,509 [INFO]: 	nb vectors: 4275
2025-03-13 11:11:58,509 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:58,509 [INFO]: 	compression ratio: 0.9993087345100014
2025-03-13 11:11:58,509 [INFO]: }
2025-03-13 11:11:58,509 [INFO]: 	>>> Finished "Creating the index" in 60.6606 secs
2025-03-13 11:11:58,509 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6982 secs
2025-03-13 11:12:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 8448 [episode count 6/20]
[retrieval_preprocessing] for episode 82201 [episode count 7/20], we have num_retrieval=np.int64(4310) num_query=np.int64(225)
2025-03-13 11:12:01,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:02,710 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:02
2025-03-13 11:12:02,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-13 11:12:02,750 [INFO]: There are 4310 embeddings of dim 49152
2025-03-13 11:12:02,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0395 secs
2025-03-13 11:12:02,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:02
2025-03-13 11:12:02,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:02,750 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:12:02,751 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:02,751 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:12:02,751 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:02
2025-03-13 11:12:02,751 [INFO]: 889.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:02,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:12:02,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:02
2025-03-13 11:12:02,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:02,751 [INFO]: 	Creating the index 03/13/2025, 11:12:02
2025-03-13 11:12:02,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:02
2025-03-13 11:12:02,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:12:02,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:02
2025-03-13 11:12:02,755 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:12:02,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.14it/s] 41%|████      | 7/17 [00:00<00:00, 34.51it/s] 71%|███████   | 12/17 [00:00<00:00, 39.93it/s]100%|██████████| 17/17 [00:04<00:00,  2.96it/s]100%|██████████| 17/17 [00:04<00:00,  4.15it/s]
2025-03-13 11:12:06,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:06
2025-03-13 11:12:48,549 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6936 secs
2025-03-13 11:12:48,549 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 11:12:48,549 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 11:13:02,597 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0474 secs
2025-03-13 11:13:02,600 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8457 secs
2025-03-13 11:13:02,601 [INFO]: {
2025-03-13 11:13:02,601 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:02,601 [INFO]: 	index_param: efSearch=188
2025-03-13 11:13:02,601 [INFO]: 	index_path: knn.index
2025-03-13 11:13:02,601 [INFO]: 	size in bytes: 847966750
2025-03-13 11:13:02,601 [INFO]: 	avg_search_speed_ms: 9.241238890201995
2025-03-13 11:13:02,601 [INFO]: 	99p_search_speed_ms: 13.026316612958919
2025-03-13 11:13:02,601 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:02,601 [INFO]: 	nb vectors: 4310
2025-03-13 11:13:02,601 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:02,601 [INFO]: 	compression ratio: 0.9993086167588529
2025-03-13 11:13:02,601 [INFO]: }
2025-03-13 11:13:02,601 [INFO]: 	>>> Finished "Creating the index" in 59.8493 secs
2025-03-13 11:13:02,601 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8905 secs
2025-03-13 11:13:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 82201 [episode count 7/20]
[retrieval_preprocessing] for episode 49426 [episode count 8/20], we have num_retrieval=np.int64(4338) num_query=np.int64(197)
2025-03-13 11:13:05,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:05,659 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:05
2025-03-13 11:13:05,659 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1258.79it/s]
2025-03-13 11:13:05,692 [INFO]: There are 4338 embeddings of dim 49152
2025-03-13 11:13:05,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 11:13:05,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:05
2025-03-13 11:13:05,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:05,693 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:13:05,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:05,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:05,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:05
2025-03-13 11:13:05,693 [INFO]: 895.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:05,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:05,693 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:05
2025-03-13 11:13:05,693 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:05,693 [INFO]: 	Creating the index 03/13/2025, 11:13:05
2025-03-13 11:13:05,693 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:05
2025-03-13 11:13:05,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:13:05,694 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:05
2025-03-13 11:13:05,694 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:13:05,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.18it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.63it/s] 61%|██████    | 11/18 [00:00<00:00, 35.38it/s] 89%|████████▉ | 16/18 [00:00<00:00, 38.91it/s]100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
2025-03-13 11:13:09,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:09
2025-03-13 11:13:54,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4639 secs
2025-03-13 11:13:54,369 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:13:54,369 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.23it/s]
2025-03-13 11:14:06,903 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5338 secs
2025-03-13 11:14:06,906 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2115 secs
2025-03-13 11:14:06,906 [INFO]: {
2025-03-13 11:14:06,906 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:06,906 [INFO]: 	index_param: efSearch=166
2025-03-13 11:14:06,906 [INFO]: 	index_path: knn.index
2025-03-13 11:14:06,906 [INFO]: 	size in bytes: 853475590
2025-03-13 11:14:06,906 [INFO]: 	avg_search_speed_ms: 8.050045459876182
2025-03-13 11:14:06,906 [INFO]: 	99p_search_speed_ms: 11.610543120186776
2025-03-13 11:14:06,906 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:06,906 [INFO]: 	nb vectors: 4338
2025-03-13 11:14:06,906 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:06,906 [INFO]: 	compression ratio: 0.9993086082286197
2025-03-13 11:14:06,906 [INFO]: }
2025-03-13 11:14:06,906 [INFO]: 	>>> Finished "Creating the index" in 61.2130 secs
2025-03-13 11:14:06,906 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2470 secs
2025-03-13 11:14:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 49426 [episode count 8/20]
[retrieval_preprocessing] for episode 10534 [episode count 9/20], we have num_retrieval=np.int64(4322) num_query=np.int64(213)
2025-03-13 11:14:08,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:09,297 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:09
2025-03-13 11:14:09,297 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.13it/s]
2025-03-13 11:14:09,335 [INFO]: There are 4322 embeddings of dim 49152
2025-03-13 11:14:09,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0381 secs
2025-03-13 11:14:09,335 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:09
2025-03-13 11:14:09,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:09,335 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:14:09,335 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:09,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:14:09,335 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:09
2025-03-13 11:14:09,336 [INFO]: 892.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:09,336 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:14:09,336 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:09
2025-03-13 11:14:09,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:09,336 [INFO]: 	Creating the index 03/13/2025, 11:14:09
2025-03-13 11:14:09,336 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:09
2025-03-13 11:14:09,337 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:14:09,337 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:09
2025-03-13 11:14:09,337 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:14:09,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.43it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.36it/s] 67%|██████▋   | 12/18 [00:00<00:00, 37.60it/s]100%|██████████| 18/18 [00:03<00:00,  3.71it/s]100%|██████████| 18/18 [00:03<00:00,  4.88it/s]
2025-03-13 11:14:13,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:13
2025-03-13 11:14:59,286 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2567 secs
2025-03-13 11:14:59,286 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 11:14:59,287 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.01it/s]
2025-03-13 11:15:11,701 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4142 secs
2025-03-13 11:15:11,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3666 secs
2025-03-13 11:15:11,704 [INFO]: {
2025-03-13 11:15:11,704 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:11,704 [INFO]: 	index_param: efSearch=222
2025-03-13 11:15:11,704 [INFO]: 	index_path: knn.index
2025-03-13 11:15:11,704 [INFO]: 	size in bytes: 850327690
2025-03-13 11:15:11,704 [INFO]: 	avg_search_speed_ms: 9.488961836093404
2025-03-13 11:15:11,704 [INFO]: 	99p_search_speed_ms: 12.822189256548882
2025-03-13 11:15:11,704 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:11,704 [INFO]: 	nb vectors: 4322
2025-03-13 11:15:11,704 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:11,704 [INFO]: 	compression ratio: 0.9993086030163265
2025-03-13 11:15:11,704 [INFO]: }
2025-03-13 11:15:11,704 [INFO]: 	>>> Finished "Creating the index" in 62.3681 secs
2025-03-13 11:15:11,704 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4070 secs
2025-03-13 11:15:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 10534 [episode count 9/20]
[retrieval_preprocessing] for episode 71995 [episode count 10/20], we have num_retrieval=np.int64(4317) num_query=np.int64(218)
2025-03-13 11:15:13,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:14,452 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:14
2025-03-13 11:15:14,452 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.24it/s]
2025-03-13 11:15:14,485 [INFO]: There are 4317 embeddings of dim 49152
2025-03-13 11:15:14,486 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 11:15:14,486 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:14
2025-03-13 11:15:14,486 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:14,486 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:15:14,486 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:14,486 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:14,486 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:14
2025-03-13 11:15:14,486 [INFO]: 890.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:14,486 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:15:14,486 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:14
2025-03-13 11:15:14,486 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:14,486 [INFO]: 	Creating the index 03/13/2025, 11:15:14
2025-03-13 11:15:14,486 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:14
2025-03-13 11:15:14,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:15:14,487 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:14
2025-03-13 11:15:14,487 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:15:14,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.45it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.54it/s] 65%|██████▍   | 11/17 [00:00<00:00, 36.65it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.93it/s]100%|██████████| 17/17 [00:03<00:00,  4.86it/s]
2025-03-13 11:15:17,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:17
2025-03-13 11:16:01,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6034 secs
2025-03-13 11:16:01,595 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 11:16:01,596 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.27it/s]
2025-03-13 11:16:14,783 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1868 secs
2025-03-13 11:16:14,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2986 secs
2025-03-13 11:16:14,786 [INFO]: {
2025-03-13 11:16:14,786 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:14,786 [INFO]: 	index_param: efSearch=170
2025-03-13 11:16:14,786 [INFO]: 	index_path: knn.index
2025-03-13 11:16:14,786 [INFO]: 	size in bytes: 849343930
2025-03-13 11:16:14,786 [INFO]: 	avg_search_speed_ms: 7.911135320060981
2025-03-13 11:16:14,786 [INFO]: 	99p_search_speed_ms: 11.282983070705084
2025-03-13 11:16:14,786 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:14,786 [INFO]: 	nb vectors: 4317
2025-03-13 11:16:14,786 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:14,786 [INFO]: 	compression ratio: 0.9993086499128804
2025-03-13 11:16:14,786 [INFO]: }
2025-03-13 11:16:14,786 [INFO]: 	>>> Finished "Creating the index" in 60.3001 secs
2025-03-13 11:16:14,786 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3341 secs
2025-03-13 11:16:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 71995 [episode count 10/20]
[retrieval_preprocessing] for episode 6505 [episode count 11/20], we have num_retrieval=np.int64(4282) num_query=np.int64(253)
2025-03-13 11:16:17,036 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:17,749 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:17
2025-03-13 11:16:17,749 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 11:16:17,784 [INFO]: There are 4282 embeddings of dim 49152
2025-03-13 11:16:17,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 11:16:17,785 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:17
2025-03-13 11:16:17,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:17,785 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:16:17,785 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:17,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:17,785 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:17
2025-03-13 11:16:17,785 [INFO]: 883.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:17,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:16:17,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:17
2025-03-13 11:16:17,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:17,785 [INFO]: 	Creating the index 03/13/2025, 11:16:17
2025-03-13 11:16:17,786 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:17
2025-03-13 11:16:17,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:16:17,787 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:17
2025-03-13 11:16:17,787 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:16:17,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.13it/s] 35%|███▌      | 6/17 [00:00<00:00, 25.95it/s] 65%|██████▍   | 11/17 [00:00<00:00, 32.70it/s] 94%|█████████▍| 16/17 [00:00<00:00, 35.82it/s]100%|██████████| 17/17 [00:03<00:00,  4.80it/s]
2025-03-13 11:16:21,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:21
2025-03-13 11:17:02,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6836 secs
2025-03-13 11:17:02,019 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:17:02,019 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 50%|█████     | 2/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-13 11:17:15,587 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5679 secs
2025-03-13 11:17:15,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8030 secs
2025-03-13 11:17:15,590 [INFO]: {
2025-03-13 11:17:15,590 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:15,590 [INFO]: 	index_param: efSearch=238
2025-03-13 11:17:15,590 [INFO]: 	index_path: knn.index
2025-03-13 11:17:15,590 [INFO]: 	size in bytes: 842457850
2025-03-13 11:17:15,590 [INFO]: 	avg_search_speed_ms: 13.021633953637016
2025-03-13 11:17:15,590 [INFO]: 	99p_search_speed_ms: 18.322775729466237
2025-03-13 11:17:15,590 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:15,590 [INFO]: 	nb vectors: 4282
2025-03-13 11:17:15,590 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:15,590 [INFO]: 	compression ratio: 0.9993086965715852
2025-03-13 11:17:15,590 [INFO]: }
2025-03-13 11:17:15,590 [INFO]: 	>>> Finished "Creating the index" in 57.8049 secs
2025-03-13 11:17:15,590 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8412 secs
2025-03-13 11:17:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 6505 [episode count 11/20]
[retrieval_preprocessing] for episode 43349 [episode count 12/20], we have num_retrieval=np.int64(4299) num_query=np.int64(236)
2025-03-13 11:17:19,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:19,720 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:19
2025-03-13 11:17:19,720 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.00it/s]
2025-03-13 11:17:19,749 [INFO]: There are 4299 embeddings of dim 49152
2025-03-13 11:17:19,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:17:19,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:19
2025-03-13 11:17:19,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:19,750 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:17:19,751 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:19,751 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:17:19,751 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:19
2025-03-13 11:17:19,751 [INFO]: 887.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:19,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:17:19,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:19
2025-03-13 11:17:19,752 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:19,752 [INFO]: 	Creating the index 03/13/2025, 11:17:19
2025-03-13 11:17:19,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:19
2025-03-13 11:17:19,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:17:19,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:19
2025-03-13 11:17:19,755 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:17:19,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.75it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.10it/s] 24%|██▎       | 4/17 [00:00<00:01,  9.36it/s] 35%|███▌      | 6/17 [00:00<00:01, 10.25it/s] 47%|████▋     | 8/17 [00:00<00:00, 10.77it/s] 59%|█████▉    | 10/17 [00:00<00:00, 10.78it/s] 71%|███████   | 12/17 [00:01<00:00, 10.15it/s] 82%|████████▏ | 14/17 [00:01<00:00, 10.03it/s] 94%|█████████▍| 16/17 [00:01<00:00, 10.02it/s]100%|██████████| 17/17 [00:05<00:00,  3.16it/s]
2025-03-13 11:17:25,150 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:25
2025-03-13 11:18:14,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1100 secs
2025-03-13 11:18:14,261 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 11:18:14,261 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.82it/s]
2025-03-13 11:18:27,492 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2309 secs
2025-03-13 11:18:27,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7407 secs
2025-03-13 11:18:27,496 [INFO]: {
2025-03-13 11:18:27,496 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:27,496 [INFO]: 	index_param: efSearch=221
2025-03-13 11:18:27,496 [INFO]: 	index_path: knn.index
2025-03-13 11:18:27,496 [INFO]: 	size in bytes: 845802550
2025-03-13 11:18:27,496 [INFO]: 	avg_search_speed_ms: 11.490559194172764
2025-03-13 11:18:27,496 [INFO]: 	99p_search_speed_ms: 17.894973084330527
2025-03-13 11:18:27,496 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:27,496 [INFO]: 	nb vectors: 4299
2025-03-13 11:18:27,496 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:27,496 [INFO]: 	compression ratio: 0.9993086353310238
2025-03-13 11:18:27,497 [INFO]: }
2025-03-13 11:18:27,497 [INFO]: 	>>> Finished "Creating the index" in 67.7447 secs
2025-03-13 11:18:27,497 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7761 secs
2025-03-13 11:18:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 43349 [episode count 12/20]
[retrieval_preprocessing] for episode 6491 [episode count 13/20], we have num_retrieval=np.int64(4306) num_query=np.int64(229)
2025-03-13 11:18:29,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:30,541 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:30
2025-03-13 11:18:30,541 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1287.78it/s]
2025-03-13 11:18:30,575 [INFO]: There are 4306 embeddings of dim 49152
2025-03-13 11:18:30,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 11:18:30,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:30,576 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:18:30,576 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:30,576 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:30,576 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,576 [INFO]: 888.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:30,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:18:30,576 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:30
2025-03-13 11:18:30,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:30,576 [INFO]: 	Creating the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,576 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:30
2025-03-13 11:18:30,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:18:30,577 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,577 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:18:30,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.70it/s] 41%|████      | 7/17 [00:00<00:00, 33.12it/s] 76%|███████▋  | 13/17 [00:00<00:00, 42.79it/s]100%|██████████| 17/17 [00:03<00:00,  4.46it/s]
2025-03-13 11:18:34,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:34
2025-03-13 11:19:13,758 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3679 secs
2025-03-13 11:19:13,759 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 11:19:13,759 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 11:19:29,538 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7792 secs
2025-03-13 11:19:29,541 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9637 secs
2025-03-13 11:19:29,541 [INFO]: {
2025-03-13 11:19:29,541 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:29,541 [INFO]: 	index_param: efSearch=178
2025-03-13 11:19:29,541 [INFO]: 	index_path: knn.index
2025-03-13 11:19:29,541 [INFO]: 	size in bytes: 847179790
2025-03-13 11:19:29,541 [INFO]: 	avg_search_speed_ms: 8.059346873356715
2025-03-13 11:19:29,541 [INFO]: 	99p_search_speed_ms: 11.949281441047775
2025-03-13 11:19:29,541 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:29,541 [INFO]: 	nb vectors: 4306
2025-03-13 11:19:29,541 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:29,541 [INFO]: 	compression ratio: 0.9993085977652985
2025-03-13 11:19:29,541 [INFO]: }
2025-03-13 11:19:29,541 [INFO]: 	>>> Finished "Creating the index" in 58.9652 secs
2025-03-13 11:19:29,541 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0004 secs
2025-03-13 11:19:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 6491 [episode count 13/20]
[retrieval_preprocessing] for episode 25405 [episode count 14/20], we have num_retrieval=np.int64(4287) num_query=np.int64(248)
2025-03-13 11:19:31,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:32,417 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:32
2025-03-13 11:19:32,417 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 779.03it/s]
2025-03-13 11:19:32,455 [INFO]: There are 4287 embeddings of dim 49152
2025-03-13 11:19:32,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-13 11:19:32,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:32
2025-03-13 11:19:32,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:32,456 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:19:32,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:32,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:19:32,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:32
2025-03-13 11:19:32,457 [INFO]: 884.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:32,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:19:32,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:32
2025-03-13 11:19:32,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:32,457 [INFO]: 	Creating the index 03/13/2025, 11:19:32
2025-03-13 11:19:32,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:32
2025-03-13 11:19:32,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:19:32,460 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:32
2025-03-13 11:19:32,460 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:19:32,460 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.83it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.87it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.85it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.67it/s]100%|██████████| 17/17 [00:03<00:00,  4.53it/s]
2025-03-13 11:19:36,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:36
2025-03-13 11:20:20,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9478 secs
2025-03-13 11:20:20,164 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:20:20,164 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.04it/s]
2025-03-13 11:20:35,850 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6858 secs
2025-03-13 11:20:35,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3939 secs
2025-03-13 11:20:35,854 [INFO]: {
2025-03-13 11:20:35,854 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:35,854 [INFO]: 	index_param: efSearch=219
2025-03-13 11:20:35,854 [INFO]: 	index_path: knn.index
2025-03-13 11:20:35,854 [INFO]: 	size in bytes: 843441550
2025-03-13 11:20:35,854 [INFO]: 	avg_search_speed_ms: 12.22085086452537
2025-03-13 11:20:35,854 [INFO]: 	99p_search_speed_ms: 21.103349714539913
2025-03-13 11:20:35,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:35,854 [INFO]: 	nb vectors: 4287
2025-03-13 11:20:35,854 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:35,854 [INFO]: 	compression ratio: 0.9993087203256704
2025-03-13 11:20:35,854 [INFO]: }
2025-03-13 11:20:35,854 [INFO]: 	>>> Finished "Creating the index" in 63.3972 secs
2025-03-13 11:20:35,854 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4377 secs
2025-03-13 11:20:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 25405 [episode count 14/20]
[retrieval_preprocessing] for episode 58191 [episode count 15/20], we have num_retrieval=np.int64(4357) num_query=np.int64(178)
2025-03-13 11:20:39,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:40,255 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:40
2025-03-13 11:20:40,255 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1006.31it/s]
2025-03-13 11:20:40,305 [INFO]: There are 4357 embeddings of dim 49152
2025-03-13 11:20:40,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0504 secs
2025-03-13 11:20:40,306 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:40
2025-03-13 11:20:40,306 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:40,307 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:20:40,307 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:40,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:20:40,307 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:40
2025-03-13 11:20:40,307 [INFO]: 899.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:40,308 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:20:40,308 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:40
2025-03-13 11:20:40,308 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:40,308 [INFO]: 	Creating the index 03/13/2025, 11:20:40
2025-03-13 11:20:40,308 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:40
2025-03-13 11:20:40,311 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:20:40,312 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:40
2025-03-13 11:20:40,312 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:20:40,312 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.38it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.67it/s] 67%|██████▋   | 12/18 [00:00<00:00, 39.78it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.22it/s]100%|██████████| 18/18 [00:03<00:00,  4.87it/s]
2025-03-13 11:20:44,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:44
2025-03-13 11:21:26,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0106 secs
2025-03-13 11:21:26,027 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 11:21:26,027 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-13 11:21:39,307 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2797 secs
2025-03-13 11:21:39,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9980 secs
2025-03-13 11:21:39,310 [INFO]: {
2025-03-13 11:21:39,310 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:39,310 [INFO]: 	index_param: efSearch=192
2025-03-13 11:21:39,310 [INFO]: 	index_path: knn.index
2025-03-13 11:21:39,310 [INFO]: 	size in bytes: 857213770
2025-03-13 11:21:39,310 [INFO]: 	avg_search_speed_ms: 9.760781869110538
2025-03-13 11:21:39,310 [INFO]: 	99p_search_speed_ms: 15.485518872737885
2025-03-13 11:21:39,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:39,310 [INFO]: 	nb vectors: 4357
2025-03-13 11:21:39,310 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:39,310 [INFO]: 	compression ratio: 0.9993085575375207
2025-03-13 11:21:39,310 [INFO]: }
2025-03-13 11:21:39,310 [INFO]: 	>>> Finished "Creating the index" in 59.0020 secs
2025-03-13 11:21:39,310 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0549 secs
2025-03-13 11:21:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 58191 [episode count 15/20]
[retrieval_preprocessing] for episode 2909 [episode count 16/20], we have num_retrieval=np.int64(4309) num_query=np.int64(226)
2025-03-13 11:21:40,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:41,606 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:41
2025-03-13 11:21:41,606 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1877.49it/s]
2025-03-13 11:21:41,639 [INFO]: There are 4309 embeddings of dim 49152
2025-03-13 11:21:41,639 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 11:21:41,639 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:41
2025-03-13 11:21:41,639 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:41,639 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:21:41,639 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:41,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:41,639 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:41
2025-03-13 11:21:41,640 [INFO]: 889.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:41,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:41,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:41
2025-03-13 11:21:41,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:41,640 [INFO]: 	Creating the index 03/13/2025, 11:21:41
2025-03-13 11:21:41,640 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:41
2025-03-13 11:21:41,641 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:21:41,641 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:41
2025-03-13 11:21:41,641 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:21:41,641 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.29it/s] 41%|████      | 7/17 [00:00<00:00, 32.72it/s] 71%|███████   | 12/17 [00:00<00:00, 36.65it/s]100%|██████████| 17/17 [00:03<00:00,  3.18it/s]100%|██████████| 17/17 [00:03<00:00,  4.44it/s]
2025-03-13 11:21:45,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:45
2025-03-13 11:22:28,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8405 secs
2025-03-13 11:22:28,315 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:22:28,315 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.41it/s]
2025-03-13 11:22:41,051 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7364 secs
2025-03-13 11:22:41,054 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4133 secs
2025-03-13 11:22:41,054 [INFO]: {
2025-03-13 11:22:41,054 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:41,054 [INFO]: 	index_param: efSearch=219
2025-03-13 11:22:41,054 [INFO]: 	index_path: knn.index
2025-03-13 11:22:41,054 [INFO]: 	size in bytes: 847770010
2025-03-13 11:22:41,054 [INFO]: 	avg_search_speed_ms: 9.983184008939032
2025-03-13 11:22:41,054 [INFO]: 	99p_search_speed_ms: 14.415865147020668
2025-03-13 11:22:41,054 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:41,054 [INFO]: 	nb vectors: 4309
2025-03-13 11:22:41,054 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:41,054 [INFO]: 	compression ratio: 0.9993086120137701
2025-03-13 11:22:41,054 [INFO]: }
2025-03-13 11:22:41,054 [INFO]: 	>>> Finished "Creating the index" in 59.4148 secs
2025-03-13 11:22:41,054 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4483 secs
2025-03-13 11:22:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 2909 [episode count 16/20]
[retrieval_preprocessing] for episode 72110 [episode count 17/20], we have num_retrieval=np.int64(4316) num_query=np.int64(219)
2025-03-13 11:22:44,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:45,449 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:45
2025-03-13 11:22:45,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.78it/s]
2025-03-13 11:22:45,476 [INFO]: There are 4316 embeddings of dim 49152
2025-03-13 11:22:45,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:22:45,477 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:45
2025-03-13 11:22:45,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:45,477 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:22:45,477 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:45,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:45,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:45
2025-03-13 11:22:45,477 [INFO]: 890.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:45,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:22:45,477 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:45
2025-03-13 11:22:45,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:45,477 [INFO]: 	Creating the index 03/13/2025, 11:22:45
2025-03-13 11:22:45,477 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:45
2025-03-13 11:22:45,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:22:45,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:45
2025-03-13 11:22:45,478 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:22:45,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.04it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.63it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.33it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.73it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.08it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.16it/s] 41%|████      | 7/17 [00:00<00:01,  8.41it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.12it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.11it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.01it/s] 71%|███████   | 12/17 [00:01<00:00,  8.91it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.86it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.80it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.78it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.95it/s]100%|██████████| 17/17 [00:05<00:00,  1.09s/it]100%|██████████| 17/17 [00:05<00:00,  3.20it/s]
2025-03-13 11:22:50,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:50
2025-03-13 11:23:30,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9582 secs
2025-03-13 11:23:30,752 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:23:30,752 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s]
2025-03-13 11:23:45,984 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2315 secs
2025-03-13 11:23:45,987 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5088 secs
2025-03-13 11:23:45,987 [INFO]: {
2025-03-13 11:23:45,987 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:45,987 [INFO]: 	index_param: efSearch=204
2025-03-13 11:23:45,987 [INFO]: 	index_path: knn.index
2025-03-13 11:23:45,987 [INFO]: 	size in bytes: 849147190
2025-03-13 11:23:45,987 [INFO]: 	avg_search_speed_ms: 9.02583835195138
2025-03-13 11:23:45,987 [INFO]: 	99p_search_speed_ms: 14.87402121303605
2025-03-13 11:23:45,987 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:45,988 [INFO]: 	nb vectors: 4316
2025-03-13 11:23:45,988 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:45,988 [INFO]: 	compression ratio: 0.9993086451831749
2025-03-13 11:23:45,988 [INFO]: }
2025-03-13 11:23:45,988 [INFO]: 	>>> Finished "Creating the index" in 60.5104 secs
2025-03-13 11:23:45,988 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5388 secs
2025-03-13 11:23:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 72110 [episode count 17/20]
[retrieval_preprocessing] for episode 37744 [episode count 18/20], we have num_retrieval=np.int64(4247) num_query=np.int64(288)
2025-03-13 11:23:49,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:50,568 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:50
2025-03-13 11:23:50,568 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1603.94it/s]
2025-03-13 11:23:50,594 [INFO]: There are 4247 embeddings of dim 49152
2025-03-13 11:23:50,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:23:50,594 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:50,594 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 11:23:50,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:50,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:50,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,594 [INFO]: 876.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:50,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:23:50,594 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:50
2025-03-13 11:23:50,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:50,594 [INFO]: 	Creating the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,594 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:50
2025-03-13 11:23:50,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:23:50,596 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:50
2025-03-13 11:23:50,596 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:23:50,596 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.31it/s] 18%|█▊        | 3/17 [00:00<00:01, 12.19it/s] 29%|██▉       | 5/17 [00:00<00:00, 13.85it/s] 41%|████      | 7/17 [00:00<00:00, 14.74it/s] 53%|█████▎    | 9/17 [00:00<00:00, 14.83it/s] 65%|██████▍   | 11/17 [00:00<00:00, 15.00it/s] 76%|███████▋  | 13/17 [00:00<00:00, 15.17it/s] 88%|████████▊ | 15/17 [00:01<00:00, 15.29it/s]100%|██████████| 17/17 [00:04<00:00,  1.53it/s]100%|██████████| 17/17 [00:04<00:00,  3.47it/s]
2025-03-13 11:23:55,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:55
2025-03-13 11:24:41,621 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1170 secs
2025-03-13 11:24:41,622 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 11:24:41,622 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.95it/s]
2025-03-13 11:24:56,481 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8590 secs
2025-03-13 11:24:56,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8881 secs
2025-03-13 11:24:56,484 [INFO]: {
2025-03-13 11:24:56,484 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:56,484 [INFO]: 	index_param: efSearch=237
2025-03-13 11:24:56,484 [INFO]: 	index_path: knn.index
2025-03-13 11:24:56,484 [INFO]: 	size in bytes: 835571830
2025-03-13 11:24:56,484 [INFO]: 	avg_search_speed_ms: 9.689110295590764
2025-03-13 11:24:56,484 [INFO]: 	99p_search_speed_ms: 12.928175516426545
2025-03-13 11:24:56,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:56,484 [INFO]: 	nb vectors: 4247
2025-03-13 11:24:56,484 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:56,484 [INFO]: 	compression ratio: 0.9993086722418586
2025-03-13 11:24:56,484 [INFO]: }
2025-03-13 11:24:56,484 [INFO]: 	>>> Finished "Creating the index" in 65.8899 secs
2025-03-13 11:24:56,484 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9161 secs
2025-03-13 11:24:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 37744 [episode count 18/20]
[retrieval_preprocessing] for episode 13169 [episode count 19/20], we have num_retrieval=np.int64(4281) num_query=np.int64(254)
2025-03-13 11:25:01,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:01,826 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:01
2025-03-13 11:25:01,826 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2052.01it/s]
2025-03-13 11:25:01,851 [INFO]: There are 4281 embeddings of dim 49152
2025-03-13 11:25:01,852 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 11:25:01,852 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:01
2025-03-13 11:25:01,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:01,852 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 11:25:01,853 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:01,853 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:25:01,853 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:01
2025-03-13 11:25:01,853 [INFO]: 883.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:01,854 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:25:01,854 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:01
2025-03-13 11:25:01,854 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:01,854 [INFO]: 	Creating the index 03/13/2025, 11:25:01
2025-03-13 11:25:01,854 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:01
2025-03-13 11:25:01,857 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:25:01,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:01
2025-03-13 11:25:01,858 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 11:25:01,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.95it/s] 12%|█▏        | 2/17 [00:00<00:01,  7.58it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.47it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.93it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.25it/s] 41%|████      | 7/17 [00:00<00:01,  9.63it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.68it/s] 53%|█████▎    | 9/17 [00:00<00:00,  9.70it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.74it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.78it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.89it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.96it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.95it/s]100%|██████████| 17/17 [00:04<00:00,  1.29it/s]100%|██████████| 17/17 [00:04<00:00,  3.68it/s]
2025-03-13 11:25:06,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:06
2025-03-13 11:25:48,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8780 secs
2025-03-13 11:25:48,369 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 11:25:48,369 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 11:26:01,996 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6266 secs
2025-03-13 11:26:01,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1409 secs
2025-03-13 11:26:01,999 [INFO]: {
2025-03-13 11:26:01,999 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:01,999 [INFO]: 	index_param: efSearch=243
2025-03-13 11:26:01,999 [INFO]: 	index_path: knn.index
2025-03-13 11:26:01,999 [INFO]: 	size in bytes: 842261110
2025-03-13 11:26:01,999 [INFO]: 	avg_search_speed_ms: 10.725446999954388
2025-03-13 11:26:01,999 [INFO]: 	99p_search_speed_ms: 16.11887489212677
2025-03-13 11:26:01,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:01,999 [INFO]: 	nb vectors: 4281
2025-03-13 11:26:01,999 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:01,999 [INFO]: 	compression ratio: 0.9993086918141098
2025-03-13 11:26:01,999 [INFO]: }
2025-03-13 11:26:01,999 [INFO]: 	>>> Finished "Creating the index" in 60.1449 secs
2025-03-13 11:26:01,999 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1729 secs
2025-03-13 11:26:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 13169 [episode count 19/20]
2025-03-13 11:26:04: [retrieval_preprocessing] finished for 1656877278_put_can_in_bowl [chosen_id count 1/260]
2025-03-13 11:26:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_bowl_in_sink [chosen_id count 2/260]
2025-03-13 11:26:09: [retrieval_preprocessing] we have num_total=5269 embedding_dim=49152
[retrieval_preprocessing] for episode 69639 [episode count 0/20], we have num_retrieval=np.int64(5006) num_query=np.int64(263)
2025-03-13 11:26:11,206 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:11,905 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:11
2025-03-13 11:26:11,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.18it/s]
2025-03-13 11:26:11,930 [INFO]: There are 5006 embeddings of dim 49152
2025-03-13 11:26:11,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:26:11,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:11
2025-03-13 11:26:11,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:11,931 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:26:11,931 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:11,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:26:11,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:11
2025-03-13 11:26:11,931 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:11,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:26:11,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:11
2025-03-13 11:26:11,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:11,931 [INFO]: 	Creating the index 03/13/2025, 11:26:11
2025-03-13 11:26:11,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:11
2025-03-13 11:26:11,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:26:11,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:11
2025-03-13 11:26:11,932 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:26:11,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.06it/s] 10%|█         | 2/20 [00:00<00:02,  6.68it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.47it/s] 20%|██        | 4/20 [00:00<00:02,  7.90it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.14it/s] 30%|███       | 6/20 [00:00<00:01,  8.32it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.44it/s] 40%|████      | 8/20 [00:00<00:01,  8.67it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.79it/s] 50%|█████     | 10/20 [00:01<00:01,  8.86it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.68it/s] 60%|██████    | 12/20 [00:01<00:00,  8.59it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.69it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.10it/s] 80%|████████  | 16/20 [00:01<00:00,  9.00it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.59it/s]100%|██████████| 20/20 [00:05<00:00,  1.42it/s]100%|██████████| 20/20 [00:05<00:00,  3.63it/s]
2025-03-13 11:26:17,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:17
2025-03-13 11:26:58,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0905 secs
2025-03-13 11:26:58,535 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 11:26:58,535 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-13 11:27:13,333 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7974 secs
2025-03-13 11:27:13,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4040 secs
2025-03-13 11:27:13,337 [INFO]: {
2025-03-13 11:27:13,337 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:13,337 [INFO]: 	index_param: efSearch=246
2025-03-13 11:27:13,337 [INFO]: 	index_path: knn.index
2025-03-13 11:27:13,337 [INFO]: 	size in bytes: 984900670
2025-03-13 11:27:13,337 [INFO]: 	avg_search_speed_ms: 8.828306778408884
2025-03-13 11:27:13,337 [INFO]: 	99p_search_speed_ms: 13.157503278926017
2025-03-13 11:27:13,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:13,337 [INFO]: 	nb vectors: 5006
2025-03-13 11:27:13,337 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:13,337 [INFO]: 	compression ratio: 0.999308537377683
2025-03-13 11:27:13,337 [INFO]: }
2025-03-13 11:27:13,337 [INFO]: 	>>> Finished "Creating the index" in 61.4061 secs
2025-03-13 11:27:13,337 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4320 secs
2025-03-13 11:27:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 69639 [episode count 0/20]
[retrieval_preprocessing] for episode 57464 [episode count 1/20], we have num_retrieval=np.int64(5033) num_query=np.int64(236)
2025-03-13 11:27:17,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:18,162 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:18
2025-03-13 11:27:18,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.69it/s]
2025-03-13 11:27:18,190 [INFO]: There are 5033 embeddings of dim 49152
2025-03-13 11:27:18,191 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 11:27:18,191 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:18
2025-03-13 11:27:18,191 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:18,191 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:27:18,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:18,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:27:18,191 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:18
2025-03-13 11:27:18,192 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:18,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:27:18,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:18
2025-03-13 11:27:18,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:18,192 [INFO]: 	Creating the index 03/13/2025, 11:27:18
2025-03-13 11:27:18,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:18
2025-03-13 11:27:18,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:27:18,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:18
2025-03-13 11:27:18,195 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:27:18,196 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.20it/s] 10%|█         | 2/20 [00:00<00:02,  6.79it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.44it/s] 20%|██        | 4/20 [00:00<00:02,  7.79it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.04it/s] 30%|███       | 6/20 [00:00<00:01,  8.22it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.44it/s] 40%|████      | 8/20 [00:01<00:01,  8.48it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.53it/s] 50%|█████     | 10/20 [00:01<00:01,  8.56it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.60it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.33it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.72it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.00it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.87it/s]100%|██████████| 20/20 [00:05<00:00,  1.48it/s]100%|██████████| 20/20 [00:05<00:00,  3.74it/s]
2025-03-13 11:27:23,555 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:23
2025-03-13 11:28:06,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3005 secs
2025-03-13 11:28:06,856 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 11:28:06,856 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 11:28:25,772 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9157 secs
2025-03-13 11:28:25,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5805 secs
2025-03-13 11:28:25,776 [INFO]: {
2025-03-13 11:28:25,776 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:25,776 [INFO]: 	index_param: efSearch=308
2025-03-13 11:28:25,776 [INFO]: 	index_path: knn.index
2025-03-13 11:28:25,776 [INFO]: 	size in bytes: 990212770
2025-03-13 11:28:25,776 [INFO]: 	avg_search_speed_ms: 9.736829102238842
2025-03-13 11:28:25,776 [INFO]: 	99p_search_speed_ms: 13.456842959858477
2025-03-13 11:28:25,776 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:25,776 [INFO]: 	nb vectors: 5033
2025-03-13 11:28:25,776 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:25,776 [INFO]: 	compression ratio: 0.9993085263887276
2025-03-13 11:28:25,776 [INFO]: }
2025-03-13 11:28:25,776 [INFO]: 	>>> Finished "Creating the index" in 67.5841 secs
2025-03-13 11:28:25,776 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6141 secs
2025-03-13 11:28:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 57464 [episode count 1/20]
[retrieval_preprocessing] for episode 51350 [episode count 2/20], we have num_retrieval=np.int64(4971) num_query=np.int64(298)
2025-03-13 11:28:30,050 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:30,888 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:30
2025-03-13 11:28:30,888 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.55it/s]
2025-03-13 11:28:30,913 [INFO]: There are 4971 embeddings of dim 49152
2025-03-13 11:28:30,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:28:30,913 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:30,913 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:28:30,913 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:30,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:30,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,913 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:30,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:28:30,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:30
2025-03-13 11:28:30,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:30,913 [INFO]: 	Creating the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:30
2025-03-13 11:28:30,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:28:30,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,915 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:28:30,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.23it/s] 10%|█         | 2/20 [00:00<00:02,  6.83it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.47it/s] 20%|██        | 4/20 [00:00<00:01,  8.01it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.29it/s] 30%|███       | 6/20 [00:00<00:01,  8.57it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.68it/s] 40%|████      | 8/20 [00:00<00:01,  8.67it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.70it/s] 50%|█████     | 10/20 [00:01<00:01,  8.77it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.91it/s] 60%|██████    | 12/20 [00:01<00:00,  8.86it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.79it/s] 70%|███████   | 14/20 [00:01<00:00,  8.67it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.60it/s] 80%|████████  | 16/20 [00:01<00:00,  8.52it/s] 85%|████████▌ | 17/20 [00:02<00:00,  8.28it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.24it/s]100%|██████████| 20/20 [00:05<00:00,  1.07it/s]100%|██████████| 20/20 [00:05<00:00,  3.53it/s]
2025-03-13 11:28:36,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:36
2025-03-13 11:29:22,690 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1069 secs
2025-03-13 11:29:22,690 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 11:29:22,690 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.57it/s] 50%|█████     | 2/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.86it/s]
2025-03-13 11:29:36,722 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0319 secs
2025-03-13 11:29:36,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8108 secs
2025-03-13 11:29:36,726 [INFO]: {
2025-03-13 11:29:36,726 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:36,726 [INFO]: 	index_param: efSearch=256
2025-03-13 11:29:36,726 [INFO]: 	index_path: knn.index
2025-03-13 11:29:36,726 [INFO]: 	size in bytes: 978014470
2025-03-13 11:29:36,726 [INFO]: 	avg_search_speed_ms: 9.501445467031415
2025-03-13 11:29:36,726 [INFO]: 	99p_search_speed_ms: 16.91086648730562
2025-03-13 11:29:36,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:36,726 [INFO]: 	nb vectors: 4971
2025-03-13 11:29:36,726 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:36,726 [INFO]: 	compression ratio: 0.9993086993896931
2025-03-13 11:29:36,726 [INFO]: }
2025-03-13 11:29:36,726 [INFO]: 	>>> Finished "Creating the index" in 65.8124 secs
2025-03-13 11:29:36,726 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8382 secs
2025-03-13 11:29:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 51350 [episode count 2/20]
[retrieval_preprocessing] for episode 6356 [episode count 3/20], we have num_retrieval=np.int64(4921) num_query=np.int64(348)
2025-03-13 11:29:40,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:41,540 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:41
2025-03-13 11:29:41,540 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 894.12it/s]
2025-03-13 11:29:41,578 [INFO]: There are 4921 embeddings of dim 49152
2025-03-13 11:29:41,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0390 secs
2025-03-13 11:29:41,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:41
2025-03-13 11:29:41,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:41,579 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:29:41,580 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:41,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:29:41,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:41
2025-03-13 11:29:41,580 [INFO]: 1015.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:41,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:29:41,581 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:41
2025-03-13 11:29:41,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:41,581 [INFO]: 	Creating the index 03/13/2025, 11:29:41
2025-03-13 11:29:41,581 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:41
2025-03-13 11:29:41,584 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:29:41,584 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:41
2025-03-13 11:29:41,585 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:29:41,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.19it/s] 35%|███▌      | 7/20 [00:00<00:00, 36.71it/s] 60%|██████    | 12/20 [00:00<00:00, 42.41it/s] 85%|████████▌ | 17/20 [00:00<00:00, 45.08it/s]100%|██████████| 20/20 [00:04<00:00,  4.67it/s]
2025-03-13 11:29:45,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:45
2025-03-13 11:30:35,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4617 secs
2025-03-13 11:30:35,338 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 11:30:35,338 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-13 11:30:49,132 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7940 secs
2025-03-13 11:30:49,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5512 secs
2025-03-13 11:30:49,136 [INFO]: {
2025-03-13 11:30:49,136 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:49,136 [INFO]: 	index_param: efSearch=239
2025-03-13 11:30:49,136 [INFO]: 	index_path: knn.index
2025-03-13 11:30:49,136 [INFO]: 	size in bytes: 968177230
2025-03-13 11:30:49,136 [INFO]: 	avg_search_speed_ms: 9.353967428588987
2025-03-13 11:30:49,136 [INFO]: 	99p_search_speed_ms: 13.411754537373776
2025-03-13 11:30:49,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:49,136 [INFO]: 	nb vectors: 4921
2025-03-13 11:30:49,136 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:49,136 [INFO]: 	compression ratio: 0.9993087401983209
2025-03-13 11:30:49,136 [INFO]: }
2025-03-13 11:30:49,136 [INFO]: 	>>> Finished "Creating the index" in 67.5551 secs
2025-03-13 11:30:49,136 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5964 secs
2025-03-13 11:30:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 6356 [episode count 3/20]
[retrieval_preprocessing] for episode 47338 [episode count 4/20], we have num_retrieval=np.int64(5027) num_query=np.int64(242)
2025-03-13 11:30:52,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:53,227 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:53
2025-03-13 11:30:53,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1347.78it/s]
2025-03-13 11:30:53,263 [INFO]: There are 5027 embeddings of dim 49152
2025-03-13 11:30:53,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 11:30:53,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:53
2025-03-13 11:30:53,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:53,264 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:30:53,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:53,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:30:53,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:53
2025-03-13 11:30:53,264 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:53,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:30:53,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:53
2025-03-13 11:30:53,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:53,264 [INFO]: 	Creating the index 03/13/2025, 11:30:53
2025-03-13 11:30:53,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:53
2025-03-13 11:30:53,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:30:53,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:53
2025-03-13 11:30:53,265 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:30:53,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.20it/s] 35%|███▌      | 7/20 [00:00<00:00, 32.87it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.10it/s] 95%|█████████▌| 19/20 [00:00<00:00, 45.12it/s]100%|██████████| 20/20 [00:03<00:00,  5.20it/s]
2025-03-13 11:30:57,114 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:57
2025-03-13 11:31:40,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2399 secs
2025-03-13 11:31:40,355 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 11:31:40,355 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 11:31:55,665 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3095 secs
2025-03-13 11:31:55,668 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4029 secs
2025-03-13 11:31:55,669 [INFO]: {
2025-03-13 11:31:55,669 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:55,669 [INFO]: 	index_param: efSearch=242
2025-03-13 11:31:55,669 [INFO]: 	index_path: knn.index
2025-03-13 11:31:55,669 [INFO]: 	size in bytes: 989032330
2025-03-13 11:31:55,669 [INFO]: 	avg_search_speed_ms: 9.33600092231949
2025-03-13 11:31:55,669 [INFO]: 	99p_search_speed_ms: 13.978039124049241
2025-03-13 11:31:55,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:55,669 [INFO]: 	nb vectors: 5027
2025-03-13 11:31:55,669 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:55,669 [INFO]: 	compression ratio: 0.9993085018767789
2025-03-13 11:31:55,669 [INFO]: }
2025-03-13 11:31:55,669 [INFO]: 	>>> Finished "Creating the index" in 62.4046 secs
2025-03-13 11:31:55,669 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4414 secs
2025-03-13 11:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 47338 [episode count 4/20]
[retrieval_preprocessing] for episode 21447 [episode count 5/20], we have num_retrieval=np.int64(5015) num_query=np.int64(254)
2025-03-13 11:31:58,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:59,793 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:59
2025-03-13 11:31:59,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1726.05it/s]
2025-03-13 11:31:59,831 [INFO]: There are 5015 embeddings of dim 49152
2025-03-13 11:31:59,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 11:31:59,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:59
2025-03-13 11:31:59,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:59,832 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:31:59,832 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:59,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:59,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:59
2025-03-13 11:31:59,832 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:59,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:59,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:59
2025-03-13 11:31:59,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:59,832 [INFO]: 	Creating the index 03/13/2025, 11:31:59
2025-03-13 11:31:59,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:59
2025-03-13 11:31:59,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:31:59,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:59
2025-03-13 11:31:59,833 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:31:59,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.99it/s] 25%|██▌       | 5/20 [00:00<00:00, 21.46it/s] 45%|████▌     | 9/20 [00:00<00:00, 28.44it/s] 65%|██████▌   | 13/20 [00:00<00:00, 31.99it/s] 85%|████████▌ | 17/20 [00:00<00:00, 34.23it/s]100%|██████████| 20/20 [00:04<00:00,  4.42it/s]
2025-03-13 11:32:04,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:04
2025-03-13 11:32:46,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7885 secs
2025-03-13 11:32:46,155 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 11:32:46,155 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.31it/s]
2025-03-13 11:32:59,178 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0226 secs
2025-03-13 11:32:59,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3478 secs
2025-03-13 11:32:59,181 [INFO]: {
2025-03-13 11:32:59,181 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:59,181 [INFO]: 	index_param: efSearch=241
2025-03-13 11:32:59,181 [INFO]: 	index_path: knn.index
2025-03-13 11:32:59,181 [INFO]: 	size in bytes: 986671330
2025-03-13 11:32:59,181 [INFO]: 	avg_search_speed_ms: 9.04966058584596
2025-03-13 11:32:59,181 [INFO]: 	99p_search_speed_ms: 15.63194264657796
2025-03-13 11:32:59,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:59,181 [INFO]: 	nb vectors: 5015
2025-03-13 11:32:59,181 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:59,181 [INFO]: 	compression ratio: 0.9993085742138671
2025-03-13 11:32:59,181 [INFO]: }
2025-03-13 11:32:59,181 [INFO]: 	>>> Finished "Creating the index" in 59.3492 secs
2025-03-13 11:32:59,181 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3882 secs
2025-03-13 11:33:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 21447 [episode count 5/20]
[retrieval_preprocessing] for episode 58317 [episode count 6/20], we have num_retrieval=np.int64(5016) num_query=np.int64(253)
2025-03-13 11:33:01,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:02,584 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:02
2025-03-13 11:33:02,584 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.82it/s]
2025-03-13 11:33:02,620 [INFO]: There are 5016 embeddings of dim 49152
2025-03-13 11:33:02,621 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 11:33:02,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:02
2025-03-13 11:33:02,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:02,621 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:33:02,622 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:02,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:33:02,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:02
2025-03-13 11:33:02,622 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:02,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:33:02,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:02
2025-03-13 11:33:02,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:02,623 [INFO]: 	Creating the index 03/13/2025, 11:33:02
2025-03-13 11:33:02,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:02
2025-03-13 11:33:02,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:33:02,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:02
2025-03-13 11:33:02,626 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:33:02,626 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.22it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.44it/s] 60%|██████    | 12/20 [00:00<00:00, 39.98it/s] 85%|████████▌ | 17/20 [00:00<00:00, 42.60it/s]100%|██████████| 20/20 [00:04<00:00,  4.89it/s]
2025-03-13 11:33:06,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:06
2025-03-13 11:33:49,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9213 secs
2025-03-13 11:33:49,648 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 11:33:49,648 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.04it/s]
2025-03-13 11:34:06,730 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0815 secs
2025-03-13 11:34:06,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2520 secs
2025-03-13 11:34:06,878 [INFO]: {
2025-03-13 11:34:06,878 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:06,878 [INFO]: 	index_param: efSearch=282
2025-03-13 11:34:06,879 [INFO]: 	index_path: knn.index
2025-03-13 11:34:06,879 [INFO]: 	size in bytes: 986868070
2025-03-13 11:34:06,879 [INFO]: 	avg_search_speed_ms: 9.722232609304832
2025-03-13 11:34:06,879 [INFO]: 	99p_search_speed_ms: 13.069650903344156
2025-03-13 11:34:06,879 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:06,879 [INFO]: 	nb vectors: 5016
2025-03-13 11:34:06,879 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:06,879 [INFO]: 	compression ratio: 0.999308578298617
2025-03-13 11:34:06,879 [INFO]: }
2025-03-13 11:34:06,879 [INFO]: 	>>> Finished "Creating the index" in 64.2561 secs
2025-03-13 11:34:06,879 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2949 secs
2025-03-13 11:34:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 58317 [episode count 6/20]
[retrieval_preprocessing] for episode 91111 [episode count 7/20], we have num_retrieval=np.int64(5031) num_query=np.int64(238)
2025-03-13 11:34:09,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:09,959 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:09
2025-03-13 11:34:09,960 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2157.56it/s]
2025-03-13 11:34:09,992 [INFO]: There are 5031 embeddings of dim 49152
2025-03-13 11:34:09,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 11:34:09,992 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:09
2025-03-13 11:34:09,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:09,992 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:34:09,992 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:09,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:09,992 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:09
2025-03-13 11:34:09,992 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:09,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:09,992 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:09
2025-03-13 11:34:09,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:09,993 [INFO]: 	Creating the index 03/13/2025, 11:34:09
2025-03-13 11:34:09,993 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:09
2025-03-13 11:34:09,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:34:09,994 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:09
2025-03-13 11:34:09,994 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:34:09,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.35it/s] 35%|███▌      | 7/20 [00:00<00:00, 32.27it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.33it/s] 95%|█████████▌| 19/20 [00:00<00:00, 45.21it/s]100%|██████████| 20/20 [00:04<00:00,  4.88it/s]
2025-03-13 11:34:14,092 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:14
2025-03-13 11:34:58,047 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9545 secs
2025-03-13 11:34:58,047 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 11:34:58,047 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.15it/s]
2025-03-13 11:35:16,137 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0894 secs
2025-03-13 11:35:16,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1465 secs
2025-03-13 11:35:16,140 [INFO]: {
2025-03-13 11:35:16,140 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:16,141 [INFO]: 	index_param: efSearch=259
2025-03-13 11:35:16,141 [INFO]: 	index_path: knn.index
2025-03-13 11:35:16,141 [INFO]: 	size in bytes: 989819290
2025-03-13 11:35:16,141 [INFO]: 	avg_search_speed_ms: 10.35718603385516
2025-03-13 11:35:16,141 [INFO]: 	99p_search_speed_ms: 15.359087253455073
2025-03-13 11:35:16,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:16,141 [INFO]: 	nb vectors: 5031
2025-03-13 11:35:16,141 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:16,141 [INFO]: 	compression ratio: 0.9993085182245741
2025-03-13 11:35:16,141 [INFO]: }
2025-03-13 11:35:16,141 [INFO]: 	>>> Finished "Creating the index" in 66.1481 secs
2025-03-13 11:35:16,141 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1812 secs
2025-03-13 11:35:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 91111 [episode count 7/20]
[retrieval_preprocessing] for episode 91145 [episode count 8/20], we have num_retrieval=np.int64(5009) num_query=np.int64(260)
2025-03-13 11:35:18,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:19,565 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:19
2025-03-13 11:35:19,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1851.79it/s]
2025-03-13 11:35:19,599 [INFO]: There are 5009 embeddings of dim 49152
2025-03-13 11:35:19,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 11:35:19,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:19
2025-03-13 11:35:19,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:19,599 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:35:19,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:19,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:19,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:19
2025-03-13 11:35:19,599 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:19,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:35:19,599 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:19
2025-03-13 11:35:19,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:19,599 [INFO]: 	Creating the index 03/13/2025, 11:35:19
2025-03-13 11:35:19,599 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:19
2025-03-13 11:35:19,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:35:19,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:19
2025-03-13 11:35:19,601 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:35:19,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.32it/s] 30%|███       | 6/20 [00:00<00:00, 29.78it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.51it/s] 80%|████████  | 16/20 [00:00<00:00, 41.65it/s]100%|██████████| 20/20 [00:03<00:00,  5.19it/s]
2025-03-13 11:35:23,461 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:23
2025-03-13 11:36:04,878 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4166 secs
2025-03-13 11:36:04,879 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 11:36:04,879 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.48it/s]
2025-03-13 11:36:18,295 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4167 secs
2025-03-13 11:36:18,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6977 secs
2025-03-13 11:36:18,298 [INFO]: {
2025-03-13 11:36:18,298 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:18,298 [INFO]: 	index_param: efSearch=167
2025-03-13 11:36:18,298 [INFO]: 	index_path: knn.index
2025-03-13 11:36:18,299 [INFO]: 	size in bytes: 985490890
2025-03-13 11:36:18,299 [INFO]: 	avg_search_speed_ms: 7.21143465354856
2025-03-13 11:36:18,299 [INFO]: 	99p_search_speed_ms: 10.606119884178042
2025-03-13 11:36:18,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:18,299 [INFO]: 	nb vectors: 5009
2025-03-13 11:36:18,299 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:18,299 [INFO]: 	compression ratio: 0.9993085496711187
2025-03-13 11:36:18,299 [INFO]: }
2025-03-13 11:36:18,299 [INFO]: 	>>> Finished "Creating the index" in 58.6992 secs
2025-03-13 11:36:18,299 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7332 secs
2025-03-13 11:36:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 91145 [episode count 8/20]
[retrieval_preprocessing] for episode 44555 [episode count 9/20], we have num_retrieval=np.int64(4980) num_query=np.int64(289)
2025-03-13 11:36:20,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:20,736 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:20
2025-03-13 11:36:20,736 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 11:36:20,771 [INFO]: There are 4980 embeddings of dim 49152
2025-03-13 11:36:20,771 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 11:36:20,772 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:20
2025-03-13 11:36:20,772 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:20,772 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:36:20,772 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:20,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:36:20,772 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:20
2025-03-13 11:36:20,773 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:20,773 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:36:20,773 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:20
2025-03-13 11:36:20,773 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:20,774 [INFO]: 	Creating the index 03/13/2025, 11:36:20
2025-03-13 11:36:20,774 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:20
2025-03-13 11:36:20,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:36:20,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:20
2025-03-13 11:36:20,777 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:36:20,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.62it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.72it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.63it/s] 90%|█████████ | 18/20 [00:00<00:00, 45.33it/s]100%|██████████| 20/20 [00:03<00:00,  5.57it/s]
2025-03-13 11:36:24,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:24
2025-03-13 11:37:07,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9356 secs
2025-03-13 11:37:07,310 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 11:37:07,310 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 11:37:29,108 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7981 secs
2025-03-13 11:37:29,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3346 secs
2025-03-13 11:37:29,112 [INFO]: {
2025-03-13 11:37:29,112 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:29,112 [INFO]: 	index_param: efSearch=257
2025-03-13 11:37:29,112 [INFO]: 	index_path: knn.index
2025-03-13 11:37:29,112 [INFO]: 	size in bytes: 979785190
2025-03-13 11:37:29,112 [INFO]: 	avg_search_speed_ms: 9.17121557553839
2025-03-13 11:37:29,112 [INFO]: 	99p_search_speed_ms: 12.487400881946082
2025-03-13 11:37:29,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:29,112 [INFO]: 	nb vectors: 4980
2025-03-13 11:37:29,112 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:29,112 [INFO]: 	compression ratio: 0.9993086749964041
2025-03-13 11:37:29,112 [INFO]: }
2025-03-13 11:37:29,112 [INFO]: 	>>> Finished "Creating the index" in 68.3382 secs
2025-03-13 11:37:29,112 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3761 secs
2025-03-13 11:37:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 44555 [episode count 9/20]
[retrieval_preprocessing] for episode 24130 [episode count 10/20], we have num_retrieval=np.int64(5029) num_query=np.int64(240)
2025-03-13 11:37:32,038 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:32,705 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:32
2025-03-13 11:37:32,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.86it/s]
2025-03-13 11:37:33,560 [INFO]: There are 5029 embeddings of dim 49152
2025-03-13 11:37:33,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.8559 secs
2025-03-13 11:37:33,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:33
2025-03-13 11:37:33,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:33,561 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:37:33,562 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:33,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:37:33,562 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:33
2025-03-13 11:37:33,562 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:33,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:37:33,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:33
2025-03-13 11:37:33,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:33,563 [INFO]: 	Creating the index 03/13/2025, 11:37:33
2025-03-13 11:37:33,563 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:33
2025-03-13 11:37:33,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:37:33,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:33
2025-03-13 11:37:33,567 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:37:33,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.54it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.67it/s] 60%|██████    | 12/20 [00:00<00:00, 38.44it/s] 85%|████████▌ | 17/20 [00:00<00:00, 39.88it/s]100%|██████████| 20/20 [00:03<00:00,  5.07it/s]
2025-03-13 11:37:37,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:37
2025-03-13 11:38:24,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5902 secs
2025-03-13 11:38:24,106 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 11:38:24,106 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-13 11:38:39,999 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8930 secs
2025-03-13 11:38:40,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4357 secs
2025-03-13 11:38:40,003 [INFO]: {
2025-03-13 11:38:40,003 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:40,003 [INFO]: 	index_param: efSearch=254
2025-03-13 11:38:40,003 [INFO]: 	index_path: knn.index
2025-03-13 11:38:40,003 [INFO]: 	size in bytes: 989425810
2025-03-13 11:38:40,003 [INFO]: 	avg_search_speed_ms: 10.76185334583121
2025-03-13 11:38:40,003 [INFO]: 	99p_search_speed_ms: 16.1131398472935
2025-03-13 11:38:40,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:40,003 [INFO]: 	nb vectors: 5029
2025-03-13 11:38:40,003 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:40,003 [INFO]: 	compression ratio: 0.9993085100539272
2025-03-13 11:38:40,003 [INFO]: }
2025-03-13 11:38:40,003 [INFO]: 	>>> Finished "Creating the index" in 66.4402 secs
2025-03-13 11:38:40,003 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2980 secs
2025-03-13 11:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 24130 [episode count 10/20]
[retrieval_preprocessing] for episode 58818 [episode count 11/20], we have num_retrieval=np.int64(5041) num_query=np.int64(228)
2025-03-13 11:38:42,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:43,463 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:43
2025-03-13 11:38:43,463 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1879.17it/s]
2025-03-13 11:38:43,496 [INFO]: There are 5041 embeddings of dim 49152
2025-03-13 11:38:43,496 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 11:38:43,496 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:43
2025-03-13 11:38:43,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:43,496 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:38:43,496 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:43,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:43,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:43
2025-03-13 11:38:43,496 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:43,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:38:43,497 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:43
2025-03-13 11:38:43,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:43,497 [INFO]: 	Creating the index 03/13/2025, 11:38:43
2025-03-13 11:38:43,497 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:43
2025-03-13 11:38:43,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:38:43,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:43
2025-03-13 11:38:43,498 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:38:43,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.90it/s] 30%|███       | 6/20 [00:00<00:00, 29.19it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.92it/s] 80%|████████  | 16/20 [00:00<00:00, 40.83it/s]100%|██████████| 20/20 [00:03<00:00,  5.32it/s]
2025-03-13 11:38:47,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:47
2025-03-13 11:39:31,951 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6880 secs
2025-03-13 11:39:31,952 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 11:39:31,952 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-13 11:39:47,347 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3952 secs
2025-03-13 11:39:47,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8525 secs
2025-03-13 11:39:47,350 [INFO]: {
2025-03-13 11:39:47,350 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:47,350 [INFO]: 	index_param: efSearch=211
2025-03-13 11:39:47,350 [INFO]: 	index_path: knn.index
2025-03-13 11:39:47,350 [INFO]: 	size in bytes: 991786810
2025-03-13 11:39:47,350 [INFO]: 	avg_search_speed_ms: 8.503406564586284
2025-03-13 11:39:47,350 [INFO]: 	99p_search_speed_ms: 16.202042053919286
2025-03-13 11:39:47,350 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:47,350 [INFO]: 	nb vectors: 5041
2025-03-13 11:39:47,350 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:47,350 [INFO]: 	compression ratio: 0.9993084380704761
2025-03-13 11:39:47,350 [INFO]: }
2025-03-13 11:39:47,350 [INFO]: 	>>> Finished "Creating the index" in 63.8539 secs
2025-03-13 11:39:47,351 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8871 secs
2025-03-13 11:39:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 58818 [episode count 11/20]
[retrieval_preprocessing] for episode 18067 [episode count 12/20], we have num_retrieval=np.int64(4970) num_query=np.int64(299)
2025-03-13 11:39:49,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:50,502 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:50
2025-03-13 11:39:50,503 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.79it/s]
2025-03-13 11:39:50,553 [INFO]: There are 4970 embeddings of dim 49152
2025-03-13 11:39:50,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0510 secs
2025-03-13 11:39:50,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:50
2025-03-13 11:39:50,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:50,554 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:39:50,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:50,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:39:50,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:50
2025-03-13 11:39:50,554 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:50,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:39:50,555 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:50
2025-03-13 11:39:50,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:50,555 [INFO]: 	Creating the index 03/13/2025, 11:39:50
2025-03-13 11:39:50,555 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:50
2025-03-13 11:39:50,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 11:39:50,558 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:50
2025-03-13 11:39:50,558 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:39:50,558 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.82it/s] 25%|██▌       | 5/20 [00:00<00:00, 23.14it/s] 45%|████▌     | 9/20 [00:00<00:00, 27.77it/s] 65%|██████▌   | 13/20 [00:00<00:00, 30.80it/s] 90%|█████████ | 18/20 [00:00<00:00, 34.87it/s]100%|██████████| 20/20 [00:04<00:00,  4.48it/s]
2025-03-13 11:39:55,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:55
2025-03-13 11:40:36,564 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5318 secs
2025-03-13 11:40:36,564 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 11:40:36,564 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 11:40:58,840 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2759 secs
2025-03-13 11:40:58,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2858 secs
2025-03-13 11:40:58,844 [INFO]: {
2025-03-13 11:40:58,844 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:58,844 [INFO]: 	index_param: efSearch=263
2025-03-13 11:40:58,844 [INFO]: 	index_path: knn.index
2025-03-13 11:40:58,844 [INFO]: 	size in bytes: 977817730
2025-03-13 11:40:58,844 [INFO]: 	avg_search_speed_ms: 9.665831932033173
2025-03-13 11:40:58,844 [INFO]: 	99p_search_speed_ms: 13.60297027043998
2025-03-13 11:40:58,844 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:58,844 [INFO]: 	nb vectors: 4970
2025-03-13 11:40:58,844 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:58,844 [INFO]: 	compression ratio: 0.999308695292322
2025-03-13 11:40:58,844 [INFO]: }
2025-03-13 11:40:58,844 [INFO]: 	>>> Finished "Creating the index" in 68.2889 secs
2025-03-13 11:40:58,844 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3415 secs
2025-03-13 11:41:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 18067 [episode count 12/20]
[retrieval_preprocessing] for episode 19697 [episode count 13/20], we have num_retrieval=np.int64(5040) num_query=np.int64(229)
2025-03-13 11:41:02,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:03,547 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:03
2025-03-13 11:41:03,547 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1973.79it/s]
2025-03-13 11:41:03,595 [INFO]: There are 5040 embeddings of dim 49152
2025-03-13 11:41:03,596 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0481 secs
2025-03-13 11:41:03,596 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:03,596 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:41:03,596 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:03,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:41:03,596 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,596 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:03,597 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:41:03,597 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:03
2025-03-13 11:41:03,597 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:03,597 [INFO]: 	Creating the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,597 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:03
2025-03-13 11:41:03,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 11:41:03,600 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,600 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:41:03,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.79it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.67it/s] 60%|██████    | 12/20 [00:00<00:00, 38.42it/s] 85%|████████▌ | 17/20 [00:00<00:00, 40.61it/s]100%|██████████| 20/20 [00:04<00:00,  4.38it/s]
2025-03-13 11:41:08,176 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:08
2025-03-13 11:41:50,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2626 secs
2025-03-13 11:41:50,439 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 11:41:50,439 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 11:42:08,121 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6819 secs
2025-03-13 11:42:08,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5247 secs
2025-03-13 11:42:08,125 [INFO]: {
2025-03-13 11:42:08,125 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:08,125 [INFO]: 	index_param: efSearch=270
2025-03-13 11:42:08,125 [INFO]: 	index_path: knn.index
2025-03-13 11:42:08,125 [INFO]: 	size in bytes: 991590070
2025-03-13 11:42:08,125 [INFO]: 	avg_search_speed_ms: 10.652831103454352
2025-03-13 11:42:08,125 [INFO]: 	99p_search_speed_ms: 17.263567023910582
2025-03-13 11:42:08,125 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:08,125 [INFO]: 	nb vectors: 5040
2025-03-13 11:42:08,125 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:08,125 [INFO]: 	compression ratio: 0.999308433978166
2025-03-13 11:42:08,125 [INFO]: }
2025-03-13 11:42:08,125 [INFO]: 	>>> Finished "Creating the index" in 64.5280 secs
2025-03-13 11:42:08,125 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5774 secs
2025-03-13 11:42:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 19697 [episode count 13/20]
[retrieval_preprocessing] for episode 23795 [episode count 14/20], we have num_retrieval=np.int64(4953) num_query=np.int64(316)
2025-03-13 11:42:10,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:11,168 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:11
2025-03-13 11:42:11,168 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1486.29it/s]
2025-03-13 11:42:11,202 [INFO]: There are 4953 embeddings of dim 49152
2025-03-13 11:42:11,202 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 11:42:11,202 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:11
2025-03-13 11:42:11,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:11,202 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:42:11,202 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:11,202 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:42:11,202 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:11
2025-03-13 11:42:11,202 [INFO]: 1022.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:11,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:42:11,202 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:11
2025-03-13 11:42:11,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:11,202 [INFO]: 	Creating the index 03/13/2025, 11:42:11
2025-03-13 11:42:11,203 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:11
2025-03-13 11:42:11,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:42:11,204 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:11
2025-03-13 11:42:11,204 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:42:11,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.84it/s] 30%|███       | 6/20 [00:00<00:00, 31.61it/s] 55%|█████▌    | 11/20 [00:00<00:00, 38.81it/s] 80%|████████  | 16/20 [00:00<00:00, 41.64it/s]100%|██████████| 20/20 [00:03<00:00,  5.04it/s]
2025-03-13 11:42:15,176 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:15
2025-03-13 11:43:00,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2015 secs
2025-03-13 11:43:00,379 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 11:43:00,379 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 11:43:14,816 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4373 secs
2025-03-13 11:43:14,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7198 secs
2025-03-13 11:43:14,924 [INFO]: {
2025-03-13 11:43:14,924 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:14,924 [INFO]: 	index_param: efSearch=230
2025-03-13 11:43:14,924 [INFO]: 	index_path: knn.index
2025-03-13 11:43:14,924 [INFO]: 	size in bytes: 974473150
2025-03-13 11:43:14,924 [INFO]: 	avg_search_speed_ms: 8.618977120985228
2025-03-13 11:43:14,924 [INFO]: 	99p_search_speed_ms: 12.333816615864638
2025-03-13 11:43:14,924 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:14,924 [INFO]: 	nb vectors: 4953
2025-03-13 11:43:14,924 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:14,924 [INFO]: 	compression ratio: 0.9993086253838805
2025-03-13 11:43:14,924 [INFO]: }
2025-03-13 11:43:14,925 [INFO]: 	>>> Finished "Creating the index" in 63.7220 secs
2025-03-13 11:43:14,925 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7569 secs
2025-03-13 11:43:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 23795 [episode count 14/20]
[retrieval_preprocessing] for episode 63235 [episode count 15/20], we have num_retrieval=np.int64(5045) num_query=np.int64(224)
2025-03-13 11:43:18,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:19,196 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:19
2025-03-13 11:43:19,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.87it/s]
2025-03-13 11:43:19,231 [INFO]: There are 5045 embeddings of dim 49152
2025-03-13 11:43:19,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 11:43:19,231 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:19
2025-03-13 11:43:19,231 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:19,231 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:43:19,231 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:19,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:43:19,231 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:19
2025-03-13 11:43:19,231 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:19,231 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:43:19,231 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:19
2025-03-13 11:43:19,231 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:19,231 [INFO]: 	Creating the index 03/13/2025, 11:43:19
2025-03-13 11:43:19,231 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:19
2025-03-13 11:43:19,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:43:19,232 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:19
2025-03-13 11:43:19,233 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:43:19,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.21it/s] 30%|███       | 6/20 [00:00<00:00, 27.78it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.64it/s] 80%|████████  | 16/20 [00:00<00:00, 39.55it/s]100%|██████████| 20/20 [00:04<00:00,  4.88it/s]
2025-03-13 11:43:23,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:23
2025-03-13 11:44:07,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2127 secs
2025-03-13 11:44:07,548 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 11:44:07,548 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.22it/s]
2025-03-13 11:44:30,514 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9662 secs
2025-03-13 11:44:30,518 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2851 secs
2025-03-13 11:44:30,518 [INFO]: {
2025-03-13 11:44:30,518 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:30,518 [INFO]: 	index_param: efSearch=122
2025-03-13 11:44:30,518 [INFO]: 	index_path: knn.index
2025-03-13 11:44:30,518 [INFO]: 	size in bytes: 992573770
2025-03-13 11:44:30,518 [INFO]: 	avg_search_speed_ms: 6.030275930585374
2025-03-13 11:44:30,518 [INFO]: 	99p_search_speed_ms: 10.422376478090882
2025-03-13 11:44:30,518 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:30,518 [INFO]: 	nb vectors: 5045
2025-03-13 11:44:30,518 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:30,518 [INFO]: 	compression ratio: 0.9993084544234934
2025-03-13 11:44:30,518 [INFO]: }
2025-03-13 11:44:30,518 [INFO]: 	>>> Finished "Creating the index" in 71.2867 secs
2025-03-13 11:44:30,518 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3225 secs
2025-03-13 11:44:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 63235 [episode count 15/20]
[retrieval_preprocessing] for episode 91910 [episode count 16/20], we have num_retrieval=np.int64(4994) num_query=np.int64(275)
2025-03-13 11:44:32,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:32,975 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:32
2025-03-13 11:44:32,976 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.47it/s]
2025-03-13 11:44:33,016 [INFO]: There are 4994 embeddings of dim 49152
2025-03-13 11:44:33,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0412 secs
2025-03-13 11:44:33,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:33,018 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:44:33,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:33,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:44:33,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,018 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:33,019 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:44:33,019 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:33
2025-03-13 11:44:33,019 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:33,019 [INFO]: 	Creating the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,020 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:33
2025-03-13 11:44:33,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 11:44:33,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,024 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:44:33,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.32it/s] 40%|████      | 8/20 [00:00<00:00, 38.82it/s] 70%|███████   | 14/20 [00:00<00:00, 45.16it/s]100%|██████████| 20/20 [00:03<00:00,  3.85it/s]100%|██████████| 20/20 [00:03<00:00,  5.33it/s]
2025-03-13 11:44:36,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:36
2025-03-13 11:45:18,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7313 secs
2025-03-13 11:45:18,517 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 11:45:18,517 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.95it/s]
2025-03-13 11:45:32,874 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3568 secs
2025-03-13 11:45:32,877 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8531 secs
2025-03-13 11:45:32,877 [INFO]: {
2025-03-13 11:45:32,877 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:32,877 [INFO]: 	index_param: efSearch=286
2025-03-13 11:45:32,877 [INFO]: 	index_path: knn.index
2025-03-13 11:45:32,877 [INFO]: 	size in bytes: 982539790
2025-03-13 11:45:32,877 [INFO]: 	avg_search_speed_ms: 11.756239076430628
2025-03-13 11:45:32,877 [INFO]: 	99p_search_speed_ms: 16.551307984627783
2025-03-13 11:45:32,877 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:32,877 [INFO]: 	nb vectors: 4994
2025-03-13 11:45:32,877 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:32,877 [INFO]: 	compression ratio: 0.9993084880562445
2025-03-13 11:45:32,877 [INFO]: }
2025-03-13 11:45:32,877 [INFO]: 	>>> Finished "Creating the index" in 59.8575 secs
2025-03-13 11:45:32,877 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9015 secs
2025-03-13 11:45:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 91910 [episode count 16/20]
[retrieval_preprocessing] for episode 89869 [episode count 17/20], we have num_retrieval=np.int64(5008) num_query=np.int64(261)
2025-03-13 11:45:37,161 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:38,113 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:38
2025-03-13 11:45:38,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.43it/s]
2025-03-13 11:45:38,160 [INFO]: There are 5008 embeddings of dim 49152
2025-03-13 11:45:38,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0476 secs
2025-03-13 11:45:38,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:38
2025-03-13 11:45:38,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:38,161 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:45:38,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:38,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:45:38,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:38
2025-03-13 11:45:38,162 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:38,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:45:38,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:38
2025-03-13 11:45:38,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:38,163 [INFO]: 	Creating the index 03/13/2025, 11:45:38
2025-03-13 11:45:38,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:38
2025-03-13 11:45:38,167 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 11:45:38,167 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:38
2025-03-13 11:45:38,167 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:45:38,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.78it/s] 30%|███       | 6/20 [00:00<00:00, 28.08it/s] 55%|█████▌    | 11/20 [00:00<00:00, 33.84it/s] 80%|████████  | 16/20 [00:00<00:00, 36.40it/s]100%|██████████| 20/20 [00:04<00:00,  2.66it/s]100%|██████████| 20/20 [00:04<00:00,  4.22it/s]
2025-03-13 11:45:42,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:42
2025-03-13 11:46:28,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6492 secs
2025-03-13 11:46:28,566 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:46:28,566 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.63it/s]
2025-03-13 11:46:45,608 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0423 secs
2025-03-13 11:46:45,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5769 secs
2025-03-13 11:46:45,745 [INFO]: {
2025-03-13 11:46:45,745 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:45,745 [INFO]: 	index_param: efSearch=251
2025-03-13 11:46:45,745 [INFO]: 	index_path: knn.index
2025-03-13 11:46:45,745 [INFO]: 	size in bytes: 985294150
2025-03-13 11:46:45,745 [INFO]: 	avg_search_speed_ms: 9.391822331877941
2025-03-13 11:46:45,745 [INFO]: 	99p_search_speed_ms: 14.454199308529494
2025-03-13 11:46:45,745 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:45,745 [INFO]: 	nb vectors: 5008
2025-03-13 11:46:45,745 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:45,745 [INFO]: 	compression ratio: 0.9993085455749433
2025-03-13 11:46:45,745 [INFO]: }
2025-03-13 11:46:45,745 [INFO]: 	>>> Finished "Creating the index" in 67.5820 secs
2025-03-13 11:46:45,745 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6322 secs
2025-03-13 11:46:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 89869 [episode count 17/20]
[retrieval_preprocessing] for episode 46206 [episode count 18/20], we have num_retrieval=np.int64(5037) num_query=np.int64(232)
2025-03-13 11:46:48,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:49,092 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:49
2025-03-13 11:46:49,092 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.33it/s]
2025-03-13 11:46:49,126 [INFO]: There are 5037 embeddings of dim 49152
2025-03-13 11:46:49,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 11:46:49,127 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:49
2025-03-13 11:46:49,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:49,127 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:46:49,127 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:49,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:46:49,128 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:49
2025-03-13 11:46:49,128 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:49,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:46:49,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:49
2025-03-13 11:46:49,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:49,129 [INFO]: 	Creating the index 03/13/2025, 11:46:49
2025-03-13 11:46:49,129 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:49
2025-03-13 11:46:49,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:46:49,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:49
2025-03-13 11:46:49,133 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:46:49,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.21it/s] 35%|███▌      | 7/20 [00:00<00:00, 36.45it/s] 60%|██████    | 12/20 [00:00<00:00, 41.91it/s] 85%|████████▌ | 17/20 [00:00<00:00, 44.33it/s]100%|██████████| 20/20 [00:03<00:00,  5.74it/s]
2025-03-13 11:46:52,623 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:52
2025-03-13 11:47:38,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4054 secs
2025-03-13 11:47:38,030 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:47:38,030 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.85it/s]
2025-03-13 11:47:55,546 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5161 secs
2025-03-13 11:47:55,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4166 secs
2025-03-13 11:47:55,549 [INFO]: {
2025-03-13 11:47:55,549 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:55,549 [INFO]: 	index_param: efSearch=238
2025-03-13 11:47:55,549 [INFO]: 	index_path: knn.index
2025-03-13 11:47:55,549 [INFO]: 	size in bytes: 990999850
2025-03-13 11:47:55,549 [INFO]: 	avg_search_speed_ms: 9.997858686605468
2025-03-13 11:47:55,549 [INFO]: 	99p_search_speed_ms: 18.4588860347867
2025-03-13 11:47:55,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:55,549 [INFO]: 	nb vectors: 5037
2025-03-13 11:47:55,549 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:55,549 [INFO]: 	compression ratio: 0.9993084216914866
2025-03-13 11:47:55,549 [INFO]: }
2025-03-13 11:47:55,549 [INFO]: 	>>> Finished "Creating the index" in 66.4206 secs
2025-03-13 11:47:55,550 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4578 secs
2025-03-13 11:47:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 46206 [episode count 18/20]
[retrieval_preprocessing] for episode 43690 [episode count 19/20], we have num_retrieval=np.int64(4985) num_query=np.int64(284)
2025-03-13 11:47:58,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:59,535 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:59
2025-03-13 11:47:59,536 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.76it/s]
2025-03-13 11:47:59,575 [INFO]: There are 4985 embeddings of dim 49152
2025-03-13 11:47:59,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 11:47:59,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:59
2025-03-13 11:47:59,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:59,577 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:47:59,577 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:59,577 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:47:59,577 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:59
2025-03-13 11:47:59,577 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:59,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:47:59,578 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:59
2025-03-13 11:47:59,578 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:59,578 [INFO]: 	Creating the index 03/13/2025, 11:47:59
2025-03-13 11:47:59,578 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:59
2025-03-13 11:47:59,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:47:59,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:59
2025-03-13 11:47:59,581 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:47:59,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.25it/s] 40%|████      | 8/20 [00:00<00:00, 37.71it/s] 70%|███████   | 14/20 [00:00<00:00, 43.75it/s]100%|██████████| 20/20 [00:03<00:00,  3.87it/s]100%|██████████| 20/20 [00:03<00:00,  5.34it/s]
2025-03-13 11:48:03,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:03
2025-03-13 11:48:43,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0670 secs
2025-03-13 11:48:43,400 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:48:43,400 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-13 11:49:07,249 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8487 secs
2025-03-13 11:49:07,252 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6705 secs
2025-03-13 11:49:07,252 [INFO]: {
2025-03-13 11:49:07,252 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:07,252 [INFO]: 	index_param: efSearch=294
2025-03-13 11:49:07,252 [INFO]: 	index_path: knn.index
2025-03-13 11:49:07,252 [INFO]: 	size in bytes: 980768950
2025-03-13 11:49:07,252 [INFO]: 	avg_search_speed_ms: 12.80438012763066
2025-03-13 11:49:07,252 [INFO]: 	99p_search_speed_ms: 20.44858075678349
2025-03-13 11:49:07,252 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:07,252 [INFO]: 	nb vectors: 4985
2025-03-13 11:49:07,252 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:07,252 [INFO]: 	compression ratio: 0.9993086343118835
2025-03-13 11:49:07,252 [INFO]: }
2025-03-13 11:49:07,252 [INFO]: 	>>> Finished "Creating the index" in 67.6742 secs
2025-03-13 11:49:07,252 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7166 secs
2025-03-13 11:49:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 43690 [episode count 19/20]
2025-03-13 11:49:09: [retrieval_preprocessing] finished for 1656877278_put_bowl_in_sink [chosen_id count 2/260]
2025-03-13 11:49:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_cans_on_tray [chosen_id count 3/260]
2025-03-13 11:49:12: [retrieval_preprocessing] we have num_total=7253 embedding_dim=49152
[retrieval_preprocessing] for episode 16394 [episode count 0/20], we have num_retrieval=np.int64(6885) num_query=np.int64(368)
2025-03-13 11:49:13,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:14,732 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:14
2025-03-13 11:49:14,732 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.75it/s]
2025-03-13 11:49:14,769 [INFO]: There are 6885 embeddings of dim 49152
2025-03-13 11:49:14,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 11:49:14,770 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:14
2025-03-13 11:49:14,770 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:14,770 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 11:49:14,770 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:14,770 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:14,770 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:14
2025-03-13 11:49:14,770 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:14,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:49:14,770 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:14
2025-03-13 11:49:14,770 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:14,770 [INFO]: 	Creating the index 03/13/2025, 11:49:14
2025-03-13 11:49:14,770 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:14
2025-03-13 11:49:14,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:49:14,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:14
2025-03-13 11:49:14,771 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 11:49:14,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.64it/s] 24%|██▍       | 7/29 [00:00<00:00, 31.01it/s] 45%|████▍     | 13/29 [00:00<00:00, 40.16it/s] 66%|██████▌   | 19/29 [00:00<00:00, 45.12it/s] 83%|████████▎ | 24/29 [00:05<00:01,  2.63it/s]100%|██████████| 29/29 [00:07<00:00,  2.57it/s]100%|██████████| 29/29 [00:07<00:00,  3.71it/s]
2025-03-13 11:49:22,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:22
2025-03-13 11:50:17,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.5775 secs
2025-03-13 11:50:17,163 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 11:50:17,163 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 11:50:51,860 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6963 secs
2025-03-13 11:50:51,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.0899 secs
2025-03-13 11:50:51,861 [INFO]: {
2025-03-13 11:50:51,862 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:51,862 [INFO]: 	index_param: efSearch=255
2025-03-13 11:50:51,862 [INFO]: 	index_path: knn.index
2025-03-13 11:50:51,862 [INFO]: 	size in bytes: 1354582810
2025-03-13 11:50:51,862 [INFO]: 	avg_search_speed_ms: 12.523557827021175
2025-03-13 11:50:51,862 [INFO]: 	99p_search_speed_ms: 17.727287746965885
2025-03-13 11:50:51,862 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:51,862 [INFO]: 	nb vectors: 6885
2025-03-13 11:50:51,862 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:51,862 [INFO]: 	compression ratio: 0.9993084734332337
2025-03-13 11:50:51,862 [INFO]: }
2025-03-13 11:50:51,862 [INFO]: 	>>> Finished "Creating the index" in 97.0915 secs
2025-03-13 11:50:51,862 [INFO]: >>> Finished "Launching the whole pipeline" in 97.1300 secs
2025-03-13 11:50:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 16394 [episode count 0/20]
[retrieval_preprocessing] for episode 59405 [episode count 1/20], we have num_retrieval=np.int64(6708) num_query=np.int64(545)
2025-03-13 11:50:56,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:58,314 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:58
2025-03-13 11:50:58,314 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.04it/s]
2025-03-13 11:50:58,358 [INFO]: There are 6708 embeddings of dim 49152
2025-03-13 11:50:58,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0443 secs
2025-03-13 11:50:58,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:58
2025-03-13 11:50:58,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:58,360 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 11:50:58,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:58,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:50:58,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:58
2025-03-13 11:50:58,360 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:58,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:50:58,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:58
2025-03-13 11:50:58,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:58,361 [INFO]: 	Creating the index 03/13/2025, 11:50:58
2025-03-13 11:50:58,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:58
2025-03-13 11:50:58,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:50:58,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:58
2025-03-13 11:50:58,365 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 11:50:58,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.75it/s] 21%|██▏       | 6/28 [00:00<00:00, 28.04it/s] 36%|███▌      | 10/28 [00:00<00:00, 32.53it/s] 54%|█████▎    | 15/28 [00:00<00:00, 36.68it/s] 71%|███████▏  | 20/28 [00:00<00:00, 38.88it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.55it/s]100%|██████████| 28/28 [00:07<00:00,  2.42it/s]100%|██████████| 28/28 [00:07<00:00,  3.90it/s]
2025-03-13 11:51:05,547 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:05
2025-03-13 11:52:02,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.2355 secs
2025-03-13 11:52:02,783 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:52:02,783 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.27it/s]
2025-03-13 11:52:29,971 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1871 secs
2025-03-13 11:52:29,972 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6074 secs
2025-03-13 11:52:29,972 [INFO]: {
2025-03-13 11:52:29,972 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:29,972 [INFO]: 	index_param: efSearch=202
2025-03-13 11:52:29,972 [INFO]: 	index_path: knn.index
2025-03-13 11:52:29,972 [INFO]: 	size in bytes: 1319759230
2025-03-13 11:52:29,972 [INFO]: 	avg_search_speed_ms: 11.19459379319585
2025-03-13 11:52:29,972 [INFO]: 	99p_search_speed_ms: 14.215892646461722
2025-03-13 11:52:29,972 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:29,972 [INFO]: 	nb vectors: 6708
2025-03-13 11:52:29,972 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:29,972 [INFO]: 	compression ratio: 0.9993083844543372
2025-03-13 11:52:29,972 [INFO]: }
2025-03-13 11:52:29,972 [INFO]: 	>>> Finished "Creating the index" in 91.6111 secs
2025-03-13 11:52:29,972 [INFO]: >>> Finished "Launching the whole pipeline" in 91.6580 secs
2025-03-13 11:52:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 59405 [episode count 1/20]
[retrieval_preprocessing] for episode 86031 [episode count 2/20], we have num_retrieval=np.int64(6726) num_query=np.int64(527)
2025-03-13 11:52:36,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:37,222 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:37
2025-03-13 11:52:37,222 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.34it/s]
2025-03-13 11:52:37,259 [INFO]: There are 6726 embeddings of dim 49152
2025-03-13 11:52:37,259 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 11:52:37,259 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:37,260 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 11:52:37,260 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:37,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:52:37,260 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,260 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:37,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:52:37,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:37
2025-03-13 11:52:37,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:37,260 [INFO]: 	Creating the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:37
2025-03-13 11:52:37,261 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:52:37,261 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,261 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 11:52:37,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  6.86it/s] 21%|██▏       | 6/28 [00:00<00:00, 26.87it/s] 39%|███▉      | 11/28 [00:00<00:00, 34.84it/s] 57%|█████▋    | 16/28 [00:00<00:00, 39.02it/s] 75%|███████▌  | 21/28 [00:04<00:02,  2.88it/s] 89%|████████▉ | 25/28 [00:04<00:00,  4.02it/s]100%|██████████| 28/28 [00:06<00:00,  4.06it/s]
2025-03-13 11:52:44,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:44
2025-03-13 11:53:41,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.6643 secs
2025-03-13 11:53:41,829 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 11:53:41,829 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 11:54:09,509 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6800 secs
2025-03-13 11:54:09,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.2490 secs
2025-03-13 11:54:09,510 [INFO]: {
2025-03-13 11:54:09,510 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:09,510 [INFO]: 	index_param: efSearch=172
2025-03-13 11:54:09,510 [INFO]: 	index_path: knn.index
2025-03-13 11:54:09,510 [INFO]: 	size in bytes: 1323300610
2025-03-13 11:54:09,510 [INFO]: 	avg_search_speed_ms: 8.602225758225007
2025-03-13 11:54:09,511 [INFO]: 	99p_search_speed_ms: 13.264195779338474
2025-03-13 11:54:09,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:09,511 [INFO]: 	nb vectors: 6726
2025-03-13 11:54:09,511 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:09,511 [INFO]: 	compression ratio: 0.9993083944849085
2025-03-13 11:54:09,511 [INFO]: }
2025-03-13 11:54:09,511 [INFO]: 	>>> Finished "Creating the index" in 92.2506 secs
2025-03-13 11:54:09,511 [INFO]: >>> Finished "Launching the whole pipeline" in 92.2883 secs
2025-03-13 11:54:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 86031 [episode count 2/20]
[retrieval_preprocessing] for episode 49192 [episode count 3/20], we have num_retrieval=np.int64(7080) num_query=np.int64(173)
2025-03-13 11:54:14,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:15,792 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:15
2025-03-13 11:54:15,792 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.50it/s]
2025-03-13 11:54:15,835 [INFO]: There are 7080 embeddings of dim 49152
2025-03-13 11:54:15,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0435 secs
2025-03-13 11:54:15,836 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:15
2025-03-13 11:54:15,836 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:15,837 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 11:54:15,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:15,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:54:15,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:15
2025-03-13 11:54:15,837 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:15,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:54:15,837 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:15
2025-03-13 11:54:15,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:15,838 [INFO]: 	Creating the index 03/13/2025, 11:54:15
2025-03-13 11:54:15,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:15
2025-03-13 11:54:15,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:54:15,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:15
2025-03-13 11:54:15,842 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 11:54:15,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.98it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.33it/s] 41%|████▏     | 12/29 [00:00<00:00, 40.06it/s] 59%|█████▊    | 17/29 [00:00<00:00, 42.95it/s] 76%|███████▌  | 22/29 [00:04<00:02,  2.89it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.30it/s]100%|██████████| 29/29 [00:07<00:00,  3.88it/s]
2025-03-13 11:54:23,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:23
2025-03-13 11:55:24,352 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0316 secs
2025-03-13 11:55:24,353 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 11:55:24,353 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.56it/s]
2025-03-13 11:55:54,170 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8174 secs
2025-03-13 11:55:54,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.3299 secs
2025-03-13 11:55:54,172 [INFO]: {
2025-03-13 11:55:54,172 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:54,172 [INFO]: 	index_param: efSearch=219
2025-03-13 11:55:54,172 [INFO]: 	index_path: knn.index
2025-03-13 11:55:54,172 [INFO]: 	size in bytes: 1392948070
2025-03-13 11:55:54,172 [INFO]: 	avg_search_speed_ms: 10.910225944794641
2025-03-13 11:55:54,172 [INFO]: 	99p_search_speed_ms: 17.161761466413736
2025-03-13 11:55:54,172 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:54,172 [INFO]: 	nb vectors: 7080
2025-03-13 11:55:54,172 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:54,172 [INFO]: 	compression ratio: 0.9993083518181693
2025-03-13 11:55:54,172 [INFO]: }
2025-03-13 11:55:54,172 [INFO]: 	>>> Finished "Creating the index" in 98.3342 secs
2025-03-13 11:55:54,172 [INFO]: >>> Finished "Launching the whole pipeline" in 98.3797 secs
2025-03-13 11:55:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 49192 [episode count 3/20]
[retrieval_preprocessing] for episode 53294 [episode count 4/20], we have num_retrieval=np.int64(7008) num_query=np.int64(245)
2025-03-13 11:55:56,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:57,381 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:57
2025-03-13 11:55:57,381 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2145.42it/s]
2025-03-13 11:55:57,416 [INFO]: There are 7008 embeddings of dim 49152
2025-03-13 11:55:57,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 11:55:57,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:57,417 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 11:55:57,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:57,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:55:57,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,418 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:57,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:55:57,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:57
2025-03-13 11:55:57,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:57,418 [INFO]: 	Creating the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:57
2025-03-13 11:55:57,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:55:57,422 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,422 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 11:55:57,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.09it/s] 21%|██        | 6/29 [00:00<00:00, 29.88it/s] 38%|███▊      | 11/29 [00:00<00:00, 37.74it/s] 55%|█████▌    | 16/29 [00:00<00:00, 41.65it/s] 72%|███████▏  | 21/29 [00:04<00:02,  2.96it/s] 86%|████████▌ | 25/29 [00:04<00:00,  4.12it/s]100%|██████████| 29/29 [00:07<00:00,  2.90it/s]100%|██████████| 29/29 [00:07<00:00,  4.12it/s]
2025-03-13 11:56:04,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:04
2025-03-13 11:57:04,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.9470 secs
2025-03-13 11:57:04,415 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:57:04,415 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-13 11:57:23,497 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0814 secs
2025-03-13 11:57:23,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.0762 secs
2025-03-13 11:57:23,498 [INFO]: {
2025-03-13 11:57:23,498 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:23,498 [INFO]: 	index_param: efSearch=166
2025-03-13 11:57:23,498 [INFO]: 	index_path: knn.index
2025-03-13 11:57:23,498 [INFO]: 	size in bytes: 1378782610
2025-03-13 11:57:23,498 [INFO]: 	avg_search_speed_ms: 8.648497173739887
2025-03-13 11:57:23,498 [INFO]: 	99p_search_speed_ms: 12.534237699583176
2025-03-13 11:57:23,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:23,498 [INFO]: 	nb vectors: 7008
2025-03-13 11:57:23,498 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:23,498 [INFO]: 	compression ratio: 0.9993082694885455
2025-03-13 11:57:23,498 [INFO]: }
2025-03-13 11:57:23,498 [INFO]: 	>>> Finished "Creating the index" in 86.0800 secs
2025-03-13 11:57:23,498 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1178 secs
2025-03-13 11:57:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 53294 [episode count 4/20]
[retrieval_preprocessing] for episode 94285 [episode count 5/20], we have num_retrieval=np.int64(6858) num_query=np.int64(395)
2025-03-13 11:57:26,197 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:27,484 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:27
2025-03-13 11:57:27,484 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-13 11:57:27,520 [INFO]: There are 6858 embeddings of dim 49152
2025-03-13 11:57:27,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 11:57:27,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:27
2025-03-13 11:57:27,521 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:27,521 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 11:57:27,521 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:27,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:57:27,522 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:27
2025-03-13 11:57:27,522 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:27,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:57:27,522 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:27
2025-03-13 11:57:27,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:27,522 [INFO]: 	Creating the index 03/13/2025, 11:57:27
2025-03-13 11:57:27,522 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:27
2025-03-13 11:57:27,525 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 11:57:27,525 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:27
2025-03-13 11:57:27,525 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 11:57:27,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.02it/s] 18%|█▊        | 5/28 [00:00<00:00, 24.94it/s] 36%|███▌      | 10/28 [00:00<00:00, 35.17it/s] 57%|█████▋    | 16/28 [00:00<00:00, 42.70it/s] 75%|███████▌  | 21/28 [00:04<00:02,  2.99it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.43it/s]100%|██████████| 28/28 [00:06<00:00,  4.19it/s]
2025-03-13 11:57:34,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:34
2025-03-13 11:58:32,579 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7975 secs
2025-03-13 11:58:32,579 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 11:58:32,579 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 11:58:54,834 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2547 secs
2025-03-13 11:58:54,836 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.3106 secs
2025-03-13 11:58:54,836 [INFO]: {
2025-03-13 11:58:54,836 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:54,836 [INFO]: 	index_param: efSearch=194
2025-03-13 11:58:54,836 [INFO]: 	index_path: knn.index
2025-03-13 11:58:54,836 [INFO]: 	size in bytes: 1349270770
2025-03-13 11:58:54,836 [INFO]: 	avg_search_speed_ms: 9.91003689166007
2025-03-13 11:58:54,836 [INFO]: 	99p_search_speed_ms: 13.858404932543635
2025-03-13 11:58:54,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:54,836 [INFO]: 	nb vectors: 6858
2025-03-13 11:58:54,836 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:54,836 [INFO]: 	compression ratio: 0.9993084368084251
2025-03-13 11:58:54,836 [INFO]: }
2025-03-13 11:58:54,836 [INFO]: 	>>> Finished "Creating the index" in 87.3137 secs
2025-03-13 11:58:54,836 [INFO]: >>> Finished "Launching the whole pipeline" in 87.3522 secs
2025-03-13 11:58:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 94285 [episode count 5/20]
[retrieval_preprocessing] for episode 34940 [episode count 6/20], we have num_retrieval=np.int64(6849) num_query=np.int64(404)
2025-03-13 11:58:59,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:00,068 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:00
2025-03-13 11:59:00,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1858.35it/s]
2025-03-13 11:59:00,103 [INFO]: There are 6849 embeddings of dim 49152
2025-03-13 11:59:00,104 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 11:59:00,104 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:00
2025-03-13 11:59:00,104 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:00,104 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 11:59:00,105 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:00,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:59:00,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:00
2025-03-13 11:59:00,105 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:00,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:59:00,106 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:00
2025-03-13 11:59:00,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:00,106 [INFO]: 	Creating the index 03/13/2025, 11:59:00
2025-03-13 11:59:00,106 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:00
2025-03-13 11:59:00,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:59:00,109 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:00
2025-03-13 11:59:00,109 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 11:59:00,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.57it/s] 25%|██▌       | 7/28 [00:00<00:00, 34.21it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.62it/s] 54%|█████▎    | 15/28 [00:00<00:00, 36.33it/s] 71%|███████▏  | 20/28 [00:00<00:00, 39.46it/s] 86%|████████▌ | 24/28 [00:04<00:01,  2.78it/s]100%|██████████| 28/28 [00:07<00:00,  2.37it/s]100%|██████████| 28/28 [00:07<00:00,  3.98it/s]
2025-03-13 11:59:07,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:07
2025-03-13 12:00:02,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.5403 secs
2025-03-13 12:00:02,696 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 12:00:02,696 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 12:00:30,916 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2198 secs
2025-03-13 12:00:30,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8079 secs
2025-03-13 12:00:30,917 [INFO]: {
2025-03-13 12:00:30,917 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:30,918 [INFO]: 	index_param: efSearch=190
2025-03-13 12:00:30,918 [INFO]: 	index_path: knn.index
2025-03-13 12:00:30,918 [INFO]: 	size in bytes: 1347500050
2025-03-13 12:00:30,918 [INFO]: 	avg_search_speed_ms: 10.047957894437195
2025-03-13 12:00:30,918 [INFO]: 	99p_search_speed_ms: 15.42824916541575
2025-03-13 12:00:30,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:30,918 [INFO]: 	nb vectors: 6849
2025-03-13 12:00:30,918 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:30,918 [INFO]: 	compression ratio: 0.9993084542000573
2025-03-13 12:00:30,918 [INFO]: }
2025-03-13 12:00:30,918 [INFO]: 	>>> Finished "Creating the index" in 90.8117 secs
2025-03-13 12:00:30,918 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8495 secs
2025-03-13 12:00:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 34940 [episode count 6/20]
[retrieval_preprocessing] for episode 41052 [episode count 7/20], we have num_retrieval=np.int64(6788) num_query=np.int64(465)
2025-03-13 12:00:34,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:36,189 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:36
2025-03-13 12:00:36,189 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1183.16it/s]
2025-03-13 12:00:36,222 [INFO]: There are 6788 embeddings of dim 49152
2025-03-13 12:00:36,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 12:00:36,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:36
2025-03-13 12:00:36,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:36,223 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:00:36,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:36,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:00:36,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:36
2025-03-13 12:00:36,223 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:36,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:00:36,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:36
2025-03-13 12:00:36,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:36,223 [INFO]: 	Creating the index 03/13/2025, 12:00:36
2025-03-13 12:00:36,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:36
2025-03-13 12:00:36,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:00:36,224 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:36
2025-03-13 12:00:36,224 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:00:36,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.28it/s] 21%|██▏       | 6/28 [00:00<00:00, 30.87it/s] 43%|████▎     | 12/28 [00:00<00:00, 40.12it/s] 64%|██████▍   | 18/28 [00:00<00:00, 44.83it/s] 82%|████████▏ | 23/28 [00:04<00:01,  3.22it/s]100%|██████████| 28/28 [00:07<00:00,  2.68it/s]100%|██████████| 28/28 [00:07<00:00,  3.93it/s]
2025-03-13 12:00:43,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:43
2025-03-13 12:01:41,394 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0471 secs
2025-03-13 12:01:41,394 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 12:01:41,394 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.08it/s]
2025-03-13 12:02:08,805 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4114 secs
2025-03-13 12:02:08,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.5823 secs
2025-03-13 12:02:08,807 [INFO]: {
2025-03-13 12:02:08,807 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:08,807 [INFO]: 	index_param: efSearch=182
2025-03-13 12:02:08,807 [INFO]: 	index_path: knn.index
2025-03-13 12:02:08,807 [INFO]: 	size in bytes: 1335498670
2025-03-13 12:02:08,807 [INFO]: 	avg_search_speed_ms: 8.982631253727329
2025-03-13 12:02:08,807 [INFO]: 	99p_search_speed_ms: 12.028759142849587
2025-03-13 12:02:08,807 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:08,807 [INFO]: 	nb vectors: 6788
2025-03-13 12:02:08,807 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:08,807 [INFO]: 	compression ratio: 0.9993084485812329
2025-03-13 12:02:08,807 [INFO]: }
2025-03-13 12:02:08,807 [INFO]: 	>>> Finished "Creating the index" in 92.5836 secs
2025-03-13 12:02:08,807 [INFO]: >>> Finished "Launching the whole pipeline" in 92.6178 secs
2025-03-13 12:02:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 41052 [episode count 7/20]
[retrieval_preprocessing] for episode 2160 [episode count 8/20], we have num_retrieval=np.int64(6921) num_query=np.int64(332)
2025-03-13 12:02:13,588 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:14,613 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:14
2025-03-13 12:02:14,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.89it/s]
2025-03-13 12:02:14,648 [INFO]: There are 6921 embeddings of dim 49152
2025-03-13 12:02:14,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 12:02:14,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:14
2025-03-13 12:02:14,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:14,648 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:02:14,648 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:14,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:02:14,648 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:14
2025-03-13 12:02:14,648 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:14,648 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:02:14,648 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:14
2025-03-13 12:02:14,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:14,648 [INFO]: 	Creating the index 03/13/2025, 12:02:14
2025-03-13 12:02:14,648 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:14
2025-03-13 12:02:14,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:02:14,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:14
2025-03-13 12:02:14,649 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:02:14,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  9.26it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.57it/s] 41%|████▏     | 12/29 [00:00<00:00, 40.61it/s] 59%|█████▊    | 17/29 [00:00<00:00, 43.58it/s] 76%|███████▌  | 22/29 [00:04<00:02,  2.90it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.31it/s]100%|██████████| 29/29 [00:06<00:00,  4.34it/s]
2025-03-13 12:02:21,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:21
2025-03-13 12:03:24,257 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.9159 secs
2025-03-13 12:03:24,257 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 12:03:24,257 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.05it/s]
2025-03-13 12:03:49,033 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7753 secs
2025-03-13 12:03:49,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.3846 secs
2025-03-13 12:03:49,034 [INFO]: {
2025-03-13 12:03:49,034 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:49,034 [INFO]: 	index_param: efSearch=194
2025-03-13 12:03:49,034 [INFO]: 	index_path: knn.index
2025-03-13 12:03:49,034 [INFO]: 	size in bytes: 1361665810
2025-03-13 12:03:49,034 [INFO]: 	avg_search_speed_ms: 9.326385038317557
2025-03-13 12:03:49,034 [INFO]: 	99p_search_speed_ms: 13.22248352691531
2025-03-13 12:03:49,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:49,034 [INFO]: 	nb vectors: 6921
2025-03-13 12:03:49,034 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:49,034 [INFO]: 	compression ratio: 0.9993083163335063
2025-03-13 12:03:49,034 [INFO]: }
2025-03-13 12:03:49,034 [INFO]: 	>>> Finished "Creating the index" in 94.3860 secs
2025-03-13 12:03:49,034 [INFO]: >>> Finished "Launching the whole pipeline" in 94.4208 secs
2025-03-13 12:03:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 2160 [episode count 8/20]
[retrieval_preprocessing] for episode 77993 [episode count 9/20], we have num_retrieval=np.int64(6920) num_query=np.int64(333)
2025-03-13 12:03:52,103 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:53,207 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:53
2025-03-13 12:03:53,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.74it/s]
2025-03-13 12:03:53,243 [INFO]: There are 6920 embeddings of dim 49152
2025-03-13 12:03:53,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-13 12:03:53,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:53
2025-03-13 12:03:53,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:53,244 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:03:53,244 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:53,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:53,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:53
2025-03-13 12:03:53,244 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:53,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:03:53,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:53
2025-03-13 12:03:53,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:53,244 [INFO]: 	Creating the index 03/13/2025, 12:03:53
2025-03-13 12:03:53,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:53
2025-03-13 12:03:53,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:03:53,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:53
2025-03-13 12:03:53,245 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:03:53,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.16it/s] 21%|██        | 6/29 [00:00<00:00, 30.29it/s] 38%|███▊      | 11/29 [00:00<00:00, 38.13it/s] 55%|█████▌    | 16/29 [00:00<00:00, 41.91it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.21it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.80it/s]100%|██████████| 29/29 [00:06<00:00,  4.62it/s]
2025-03-13 12:03:59,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:59
2025-03-13 12:05:03,995 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.4700 secs
2025-03-13 12:05:03,995 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 12:05:03,995 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.82it/s]
2025-03-13 12:05:20,827 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8320 secs
2025-03-13 12:05:20,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5839 secs
2025-03-13 12:05:20,829 [INFO]: {
2025-03-13 12:05:20,829 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:20,829 [INFO]: 	index_param: efSearch=149
2025-03-13 12:05:20,829 [INFO]: 	index_path: knn.index
2025-03-13 12:05:20,829 [INFO]: 	size in bytes: 1361469010
2025-03-13 12:05:20,829 [INFO]: 	avg_search_speed_ms: 8.470385214928964
2025-03-13 12:05:20,829 [INFO]: 	99p_search_speed_ms: 11.983265820890665
2025-03-13 12:05:20,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:20,829 [INFO]: 	nb vectors: 6920
2025-03-13 12:05:20,829 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:20,829 [INFO]: 	compression ratio: 0.9993083573749505
2025-03-13 12:05:20,829 [INFO]: }
2025-03-13 12:05:20,829 [INFO]: 	>>> Finished "Creating the index" in 87.5853 secs
2025-03-13 12:05:20,829 [INFO]: >>> Finished "Launching the whole pipeline" in 87.6217 secs
2025-03-13 12:05:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 77993 [episode count 9/20]
[retrieval_preprocessing] for episode 28874 [episode count 10/20], we have num_retrieval=np.int64(6900) num_query=np.int64(353)
2025-03-13 12:05:23,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:24,742 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:24
2025-03-13 12:05:24,742 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.43it/s]
2025-03-13 12:05:24,785 [INFO]: There are 6900 embeddings of dim 49152
2025-03-13 12:05:24,786 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0441 secs
2025-03-13 12:05:24,786 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,787 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:24,787 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:05:24,787 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:24,787 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:05:24,787 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,788 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:24,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:05:24,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:24
2025-03-13 12:05:24,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:24,788 [INFO]: 	Creating the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:24
2025-03-13 12:05:24,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:05:24,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:24
2025-03-13 12:05:24,792 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:05:24,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.45it/s] 21%|██        | 6/29 [00:00<00:00, 29.27it/s] 41%|████▏     | 12/29 [00:00<00:00, 39.17it/s] 62%|██████▏   | 18/29 [00:00<00:00, 43.62it/s] 79%|███████▉  | 23/29 [00:04<00:01,  3.74it/s]100%|██████████| 29/29 [00:05<00:00,  3.68it/s]100%|██████████| 29/29 [00:05<00:00,  5.08it/s]
2025-03-13 12:05:30,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:30
2025-03-13 12:06:29,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2859 secs
2025-03-13 12:06:29,794 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 12:06:29,795 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.41it/s]
2025-03-13 12:06:54,198 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4028 secs
2025-03-13 12:06:54,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.4077 secs
2025-03-13 12:06:54,200 [INFO]: {
2025-03-13 12:06:54,200 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:54,200 [INFO]: 	index_param: efSearch=171
2025-03-13 12:06:54,200 [INFO]: 	index_path: knn.index
2025-03-13 12:06:54,200 [INFO]: 	size in bytes: 1357534030
2025-03-13 12:06:54,200 [INFO]: 	avg_search_speed_ms: 11.009855254279701
2025-03-13 12:06:54,200 [INFO]: 	99p_search_speed_ms: 20.79549444839358
2025-03-13 12:06:54,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:54,200 [INFO]: 	nb vectors: 6900
2025-03-13 12:06:54,200 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:54,200 [INFO]: 	compression ratio: 0.9993084298593974
2025-03-13 12:06:54,200 [INFO]: }
2025-03-13 12:06:54,200 [INFO]: 	>>> Finished "Creating the index" in 89.4121 secs
2025-03-13 12:06:54,200 [INFO]: >>> Finished "Launching the whole pipeline" in 89.4584 secs
2025-03-13 12:06:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 28874 [episode count 10/20]
[retrieval_preprocessing] for episode 82300 [episode count 11/20], we have num_retrieval=np.int64(6727) num_query=np.int64(526)
2025-03-13 12:06:57,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:59,043 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:59
2025-03-13 12:06:59,043 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1456.86it/s]
2025-03-13 12:06:59,079 [INFO]: There are 6727 embeddings of dim 49152
2025-03-13 12:06:59,079 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 12:06:59,079 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:59
2025-03-13 12:06:59,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:59,079 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:06:59,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:59,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:06:59,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:59
2025-03-13 12:06:59,079 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:59,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:06:59,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:59
2025-03-13 12:06:59,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:59,079 [INFO]: 	Creating the index 03/13/2025, 12:06:59
2025-03-13 12:06:59,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:59
2025-03-13 12:06:59,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:06:59,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:59
2025-03-13 12:06:59,080 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:06:59,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 16.37it/s] 25%|██▌       | 7/28 [00:00<00:00, 33.63it/s] 43%|████▎     | 12/28 [00:00<00:00, 39.60it/s] 61%|██████    | 17/28 [00:00<00:00, 42.66it/s] 79%|███████▊  | 22/28 [00:05<00:02,  2.35it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.28it/s]100%|██████████| 28/28 [00:08<00:00,  3.45it/s]
2025-03-13 12:07:07,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:07
2025-03-13 12:08:08,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7272 secs
2025-03-13 12:08:08,928 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 12:08:08,928 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.08it/s]
2025-03-13 12:08:29,423 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4951 secs
2025-03-13 12:08:29,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.3443 secs
2025-03-13 12:08:29,425 [INFO]: {
2025-03-13 12:08:29,425 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:29,425 [INFO]: 	index_param: efSearch=185
2025-03-13 12:08:29,425 [INFO]: 	index_path: knn.index
2025-03-13 12:08:29,425 [INFO]: 	size in bytes: 1323497350
2025-03-13 12:08:29,425 [INFO]: 	avg_search_speed_ms: 9.934291203091034
2025-03-13 12:08:29,425 [INFO]: 	99p_search_speed_ms: 13.884455580264328
2025-03-13 12:08:29,425 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:29,425 [INFO]: 	nb vectors: 6727
2025-03-13 12:08:29,425 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:29,425 [INFO]: 	compression ratio: 0.9993083975574262
2025-03-13 12:08:29,425 [INFO]: }
2025-03-13 12:08:29,425 [INFO]: 	>>> Finished "Creating the index" in 90.3457 secs
2025-03-13 12:08:29,425 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3816 secs
2025-03-13 12:08:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 82300 [episode count 11/20]
[retrieval_preprocessing] for episode 67965 [episode count 12/20], we have num_retrieval=np.int64(7045) num_query=np.int64(208)
2025-03-13 12:08:33,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:34,847 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:34
2025-03-13 12:08:34,847 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1528.54it/s]
2025-03-13 12:08:34,887 [INFO]: There are 7045 embeddings of dim 49152
2025-03-13 12:08:34,888 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 12:08:34,888 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:34
2025-03-13 12:08:34,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:34,888 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:08:34,888 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:34,888 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:08:34,888 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:34
2025-03-13 12:08:34,888 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:34,888 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:08:34,888 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:34
2025-03-13 12:08:34,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:34,888 [INFO]: 	Creating the index 03/13/2025, 12:08:34
2025-03-13 12:08:34,888 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:34
2025-03-13 12:08:34,889 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:08:34,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:34
2025-03-13 12:08:34,890 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:08:34,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.74it/s] 21%|██        | 6/29 [00:00<00:00, 25.10it/s] 38%|███▊      | 11/29 [00:00<00:00, 33.86it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.67it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.10it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.64it/s]100%|██████████| 29/29 [00:06<00:00,  4.35it/s]
2025-03-13 12:08:41,555 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:41
2025-03-13 12:09:45,246 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6908 secs
2025-03-13 12:09:45,246 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 12:09:45,247 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 12:10:08,254 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0071 secs
2025-03-13 12:10:08,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.3662 secs
2025-03-13 12:10:08,256 [INFO]: {
2025-03-13 12:10:08,256 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:08,256 [INFO]: 	index_param: efSearch=188
2025-03-13 12:10:08,256 [INFO]: 	index_path: knn.index
2025-03-13 12:10:08,256 [INFO]: 	size in bytes: 1386062050
2025-03-13 12:10:08,256 [INFO]: 	avg_search_speed_ms: 9.759276690097844
2025-03-13 12:10:08,256 [INFO]: 	99p_search_speed_ms: 14.143645660951732
2025-03-13 12:10:08,256 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:08,256 [INFO]: 	nb vectors: 7045
2025-03-13 12:10:08,256 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:08,256 [INFO]: 	compression ratio: 0.999308335438518
2025-03-13 12:10:08,256 [INFO]: }
2025-03-13 12:10:08,256 [INFO]: 	>>> Finished "Creating the index" in 93.3679 secs
2025-03-13 12:10:08,256 [INFO]: >>> Finished "Launching the whole pipeline" in 93.4091 secs
2025-03-13 12:10:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 67965 [episode count 12/20]
[retrieval_preprocessing] for episode 80263 [episode count 13/20], we have num_retrieval=np.int64(6846) num_query=np.int64(407)
2025-03-13 12:10:11,431 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:13,295 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:13
2025-03-13 12:10:13,296 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.93it/s]
2025-03-13 12:10:13,338 [INFO]: There are 6846 embeddings of dim 49152
2025-03-13 12:10:13,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0428 secs
2025-03-13 12:10:13,338 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:13
2025-03-13 12:10:13,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:13,339 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:10:13,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:13,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:13,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:13
2025-03-13 12:10:13,339 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:13,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:10:13,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:13
2025-03-13 12:10:13,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:13,339 [INFO]: 	Creating the index 03/13/2025, 12:10:13
2025-03-13 12:10:13,339 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:13
2025-03-13 12:10:13,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:10:13,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:13
2025-03-13 12:10:13,341 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:10:13,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.11it/s] 21%|██▏       | 6/28 [00:00<00:00, 24.42it/s] 39%|███▉      | 11/28 [00:00<00:00, 31.63it/s] 57%|█████▋    | 16/28 [00:00<00:00, 35.68it/s] 75%|███████▌  | 21/28 [00:05<00:02,  2.65it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.98it/s]100%|██████████| 28/28 [00:07<00:00,  3.76it/s]
2025-03-13 12:10:20,791 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:20
2025-03-13 12:11:25,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.2288 secs
2025-03-13 12:11:25,021 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 12:11:25,021 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 12:11:50,554 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5328 secs
2025-03-13 12:11:50,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.2143 secs
2025-03-13 12:11:50,555 [INFO]: {
2025-03-13 12:11:50,555 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:50,555 [INFO]: 	index_param: efSearch=187
2025-03-13 12:11:50,555 [INFO]: 	index_path: knn.index
2025-03-13 12:11:50,555 [INFO]: 	size in bytes: 1346909830
2025-03-13 12:11:50,555 [INFO]: 	avg_search_speed_ms: 9.765407612576382
2025-03-13 12:11:50,555 [INFO]: 	99p_search_speed_ms: 14.69378529349342
2025-03-13 12:11:50,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:50,555 [INFO]: 	nb vectors: 6846
2025-03-13 12:11:50,555 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:50,555 [INFO]: 	compression ratio: 0.9993084451688945
2025-03-13 12:11:50,555 [INFO]: }
2025-03-13 12:11:50,555 [INFO]: 	>>> Finished "Creating the index" in 97.2162 secs
2025-03-13 12:11:50,555 [INFO]: >>> Finished "Launching the whole pipeline" in 97.2599 secs
2025-03-13 12:11:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 80263 [episode count 13/20]
[retrieval_preprocessing] for episode 65958 [episode count 14/20], we have num_retrieval=np.int64(6890) num_query=np.int64(363)
2025-03-13 12:11:54,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:55,209 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:55
2025-03-13 12:11:55,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1527.98it/s]
2025-03-13 12:11:55,243 [INFO]: There are 6890 embeddings of dim 49152
2025-03-13 12:11:55,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 12:11:55,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:55
2025-03-13 12:11:55,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:55,244 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:11:55,244 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:55,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:55,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:55
2025-03-13 12:11:55,244 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:55,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:55,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:55
2025-03-13 12:11:55,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:55,244 [INFO]: 	Creating the index 03/13/2025, 12:11:55
2025-03-13 12:11:55,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:55
2025-03-13 12:11:55,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:11:55,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:55
2025-03-13 12:11:55,245 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:11:55,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 17.19it/s] 28%|██▊       | 8/29 [00:00<00:00, 37.13it/s] 48%|████▊     | 14/29 [00:00<00:00, 43.62it/s] 69%|██████▉   | 20/29 [00:00<00:00, 46.74it/s] 86%|████████▌ | 25/29 [00:04<00:01,  3.66it/s]100%|██████████| 29/29 [00:06<00:00,  3.06it/s]100%|██████████| 29/29 [00:06<00:00,  4.73it/s]
2025-03-13 12:12:01,441 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:01
2025-03-13 12:13:01,731 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.2901 secs
2025-03-13 12:13:01,731 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 12:13:01,732 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 12:13:26,127 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3950 secs
2025-03-13 12:13:26,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8828 secs
2025-03-13 12:13:26,128 [INFO]: {
2025-03-13 12:13:26,128 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:26,128 [INFO]: 	index_param: efSearch=170
2025-03-13 12:13:26,128 [INFO]: 	index_path: knn.index
2025-03-13 12:13:26,128 [INFO]: 	size in bytes: 1355566570
2025-03-13 12:13:26,128 [INFO]: 	avg_search_speed_ms: 8.810617583537153
2025-03-13 12:13:26,128 [INFO]: 	99p_search_speed_ms: 11.662146938033402
2025-03-13 12:13:26,128 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:26,128 [INFO]: 	nb vectors: 6890
2025-03-13 12:13:26,128 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:26,128 [INFO]: 	compression ratio: 0.999308444143765
2025-03-13 12:13:26,128 [INFO]: }
2025-03-13 12:13:26,128 [INFO]: 	>>> Finished "Creating the index" in 90.8841 secs
2025-03-13 12:13:26,128 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9196 secs
2025-03-13 12:13:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 65958 [episode count 14/20]
[retrieval_preprocessing] for episode 8613 [episode count 15/20], we have num_retrieval=np.int64(6817) num_query=np.int64(436)
2025-03-13 12:13:29,350 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:30,416 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:30
2025-03-13 12:13:30,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-13 12:13:30,455 [INFO]: There are 6817 embeddings of dim 49152
2025-03-13 12:13:30,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0390 secs
2025-03-13 12:13:30,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:30
2025-03-13 12:13:30,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:30,456 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:13:30,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:30,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:13:30,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:30
2025-03-13 12:13:30,457 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:30,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:13:30,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:30
2025-03-13 12:13:30,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:30,457 [INFO]: 	Creating the index 03/13/2025, 12:13:30
2025-03-13 12:13:30,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:30
2025-03-13 12:13:30,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:13:30,460 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:30
2025-03-13 12:13:30,461 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:13:30,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 17.11it/s] 29%|██▊       | 8/28 [00:00<00:00, 37.18it/s] 50%|█████     | 14/28 [00:00<00:00, 43.86it/s] 71%|███████▏  | 20/28 [00:00<00:00, 47.07it/s] 89%|████████▉ | 25/28 [00:04<00:00,  3.70it/s]100%|██████████| 28/28 [00:05<00:00,  4.79it/s]
2025-03-13 12:13:36,316 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:36
2025-03-13 12:14:35,952 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6351 secs
2025-03-13 12:14:35,952 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 12:14:35,952 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 12:15:06,836 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8832 secs
2025-03-13 12:15:06,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.3766 secs
2025-03-13 12:15:06,837 [INFO]: {
2025-03-13 12:15:06,837 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:06,837 [INFO]: 	index_param: efSearch=201
2025-03-13 12:15:06,837 [INFO]: 	index_path: knn.index
2025-03-13 12:15:06,837 [INFO]: 	size in bytes: 1341204250
2025-03-13 12:15:06,837 [INFO]: 	avg_search_speed_ms: 10.460139204316862
2025-03-13 12:15:06,837 [INFO]: 	99p_search_speed_ms: 17.42168043740093
2025-03-13 12:15:06,837 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:06,837 [INFO]: 	nb vectors: 6817
2025-03-13 12:15:06,837 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:06,837 [INFO]: 	compression ratio: 0.9993084468678055
2025-03-13 12:15:06,837 [INFO]: }
2025-03-13 12:15:06,837 [INFO]: 	>>> Finished "Creating the index" in 96.3804 secs
2025-03-13 12:15:06,837 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4212 secs
2025-03-13 12:15:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 8613 [episode count 15/20]
[retrieval_preprocessing] for episode 35749 [episode count 16/20], we have num_retrieval=np.int64(7101) num_query=np.int64(152)
2025-03-13 12:15:11,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:13,281 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:13
2025-03-13 12:15:13,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.32it/s]
2025-03-13 12:15:13,851 [INFO]: There are 7101 embeddings of dim 49152
2025-03-13 12:15:13,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5696 secs
2025-03-13 12:15:13,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:13
2025-03-13 12:15:13,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:13,851 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:15:13,851 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:13,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:13,851 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:13
2025-03-13 12:15:13,852 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:13,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:15:13,852 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:13
2025-03-13 12:15:13,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:13,852 [INFO]: 	Creating the index 03/13/2025, 12:15:13
2025-03-13 12:15:13,852 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:13
2025-03-13 12:15:13,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:15:13,853 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:13
2025-03-13 12:15:13,853 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:15:13,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  4.72it/s] 17%|█▋        | 5/29 [00:00<00:01, 17.36it/s] 31%|███       | 9/29 [00:00<00:00, 25.07it/s] 45%|████▍     | 13/29 [00:00<00:00, 29.89it/s] 59%|█████▊    | 17/29 [00:00<00:00, 32.62it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.24it/s] 90%|████████▉ | 26/29 [00:05<00:00,  3.55it/s]100%|██████████| 29/29 [00:07<00:00,  3.76it/s]
2025-03-13 12:15:21,581 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:21
2025-03-13 12:16:27,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9037 secs
2025-03-13 12:16:27,486 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 12:16:27,486 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.19it/s]
2025-03-13 12:16:58,635 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1488 secs
2025-03-13 12:16:58,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.7834 secs
2025-03-13 12:16:58,636 [INFO]: {
2025-03-13 12:16:58,637 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:58,637 [INFO]: 	index_param: efSearch=156
2025-03-13 12:16:58,637 [INFO]: 	index_path: knn.index
2025-03-13 12:16:58,637 [INFO]: 	size in bytes: 1397079670
2025-03-13 12:16:58,637 [INFO]: 	avg_search_speed_ms: 8.032141228853519
2025-03-13 12:16:58,637 [INFO]: 	99p_search_speed_ms: 11.579495742917056
2025-03-13 12:16:58,637 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:58,637 [INFO]: 	nb vectors: 7101
2025-03-13 12:16:58,637 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:58,637 [INFO]: 	compression ratio: 0.9993083701518611
2025-03-13 12:16:58,637 [INFO]: }
2025-03-13 12:16:58,637 [INFO]: 	>>> Finished "Creating the index" in 104.7849 secs
2025-03-13 12:16:58,637 [INFO]: >>> Finished "Launching the whole pipeline" in 105.3553 secs
2025-03-13 12:16:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 35749 [episode count 16/20]
[retrieval_preprocessing] for episode 75770 [episode count 17/20], we have num_retrieval=np.int64(6922) num_query=np.int64(331)
2025-03-13 12:17:00,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:01,946 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:01
2025-03-13 12:17:01,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.76it/s]
2025-03-13 12:17:01,981 [INFO]: There are 6922 embeddings of dim 49152
2025-03-13 12:17:01,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 12:17:01,981 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:01
2025-03-13 12:17:01,981 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:01,981 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:17:01,981 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:01,981 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:01,981 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:01
2025-03-13 12:17:01,981 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:01,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:01,981 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:01
2025-03-13 12:17:01,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:01,982 [INFO]: 	Creating the index 03/13/2025, 12:17:01
2025-03-13 12:17:01,982 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:01
2025-03-13 12:17:01,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:17:01,983 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:01
2025-03-13 12:17:01,983 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:17:01,983 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.12it/s] 21%|██        | 6/29 [00:00<00:00, 29.54it/s] 41%|████▏     | 12/29 [00:00<00:00, 40.04it/s] 62%|██████▏   | 18/29 [00:00<00:00, 45.01it/s] 79%|███████▉  | 23/29 [00:04<00:01,  3.35it/s]100%|██████████| 29/29 [00:06<00:00,  2.99it/s]100%|██████████| 29/29 [00:06<00:00,  4.25it/s]
2025-03-13 12:17:08,806 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:08
2025-03-13 12:18:13,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.8616 secs
2025-03-13 12:18:13,669 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 12:18:13,669 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 12:18:35,016 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3471 secs
2025-03-13 12:18:35,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.0349 secs
2025-03-13 12:18:35,018 [INFO]: {
2025-03-13 12:18:35,018 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:35,018 [INFO]: 	index_param: efSearch=174
2025-03-13 12:18:35,018 [INFO]: 	index_path: knn.index
2025-03-13 12:18:35,018 [INFO]: 	size in bytes: 1361862550
2025-03-13 12:18:35,018 [INFO]: 	avg_search_speed_ms: 10.856038067655701
2025-03-13 12:18:35,018 [INFO]: 	99p_search_speed_ms: 15.657334169372916
2025-03-13 12:18:35,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:35,018 [INFO]: 	nb vectors: 6922
2025-03-13 12:18:35,018 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:35,018 [INFO]: 	compression ratio: 0.9993083193307577
2025-03-13 12:18:35,018 [INFO]: }
2025-03-13 12:18:35,018 [INFO]: 	>>> Finished "Creating the index" in 93.0365 secs
2025-03-13 12:18:35,018 [INFO]: >>> Finished "Launching the whole pipeline" in 93.0724 secs
2025-03-13 12:18:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 75770 [episode count 17/20]
[retrieval_preprocessing] for episode 82913 [episode count 18/20], we have num_retrieval=np.int64(7035) num_query=np.int64(218)
2025-03-13 12:18:38,465 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:39,551 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:39
2025-03-13 12:18:39,551 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.45it/s]
2025-03-13 12:18:39,592 [INFO]: There are 7035 embeddings of dim 49152
2025-03-13 12:18:39,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0415 secs
2025-03-13 12:18:39,593 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:39
2025-03-13 12:18:39,593 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:39,594 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 12:18:39,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:39,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:18:39,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:39
2025-03-13 12:18:39,594 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:39,595 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:18:39,595 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:39
2025-03-13 12:18:39,595 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:39,595 [INFO]: 	Creating the index 03/13/2025, 12:18:39
2025-03-13 12:18:39,595 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:39
2025-03-13 12:18:39,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0038 secs
2025-03-13 12:18:39,600 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:39
2025-03-13 12:18:39,600 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:18:39,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.50it/s] 21%|██        | 6/29 [00:00<00:00, 29.81it/s] 38%|███▊      | 11/29 [00:00<00:00, 37.91it/s] 55%|█████▌    | 16/29 [00:00<00:00, 42.15it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.42it/s] 90%|████████▉ | 26/29 [00:04<00:00,  5.10it/s]100%|██████████| 29/29 [00:06<00:00,  4.83it/s]
2025-03-13 12:18:46,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:46
2025-03-13 12:19:51,603 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.5098 secs
2025-03-13 12:19:51,603 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 12:19:51,604 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 12:20:09,153 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5490 secs
2025-03-13 12:20:09,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.5543 secs
2025-03-13 12:20:09,154 [INFO]: {
2025-03-13 12:20:09,154 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:09,154 [INFO]: 	index_param: efSearch=173
2025-03-13 12:20:09,154 [INFO]: 	index_path: knn.index
2025-03-13 12:20:09,154 [INFO]: 	size in bytes: 1384094590
2025-03-13 12:20:09,154 [INFO]: 	avg_search_speed_ms: 9.11954229395351
2025-03-13 12:20:09,154 [INFO]: 	99p_search_speed_ms: 15.169969573616974
2025-03-13 12:20:09,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:09,154 [INFO]: 	nb vectors: 7035
2025-03-13 12:20:09,154 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:09,155 [INFO]: 	compression ratio: 0.9993083492942487
2025-03-13 12:20:09,155 [INFO]: }
2025-03-13 12:20:09,155 [INFO]: 	>>> Finished "Creating the index" in 89.5592 secs
2025-03-13 12:20:09,155 [INFO]: >>> Finished "Launching the whole pipeline" in 89.6033 secs
2025-03-13 12:20:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 82913 [episode count 18/20]
[retrieval_preprocessing] for episode 50230 [episode count 19/20], we have num_retrieval=np.int64(6781) num_query=np.int64(472)
2025-03-13 12:20:11,231 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:12,142 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:12
2025-03-13 12:20:12,142 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.03it/s]
2025-03-13 12:20:12,179 [INFO]: There are 6781 embeddings of dim 49152
2025-03-13 12:20:12,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 12:20:12,180 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:12
2025-03-13 12:20:12,180 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:12,180 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:20:12,180 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:12,181 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:20:12,181 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:12
2025-03-13 12:20:12,181 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:12,181 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:20:12,181 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:12
2025-03-13 12:20:12,181 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:12,181 [INFO]: 	Creating the index 03/13/2025, 12:20:12
2025-03-13 12:20:12,182 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:12
2025-03-13 12:20:12,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 12:20:12,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:12
2025-03-13 12:20:12,185 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:20:12,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.81it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.55it/s] 43%|████▎     | 12/28 [00:00<00:00, 39.31it/s] 64%|██████▍   | 18/28 [00:00<00:00, 43.73it/s] 82%|████████▏ | 23/28 [00:04<00:01,  3.48it/s]100%|██████████| 28/28 [00:06<00:00,  3.12it/s]100%|██████████| 28/28 [00:06<00:00,  4.48it/s]
2025-03-13 12:20:18,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:18
2025-03-13 12:21:19,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6874 secs
2025-03-13 12:21:19,130 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 12:21:19,130 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.30it/s]
2025-03-13 12:21:37,905 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7750 secs
2025-03-13 12:21:37,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7223 secs
2025-03-13 12:21:37,907 [INFO]: {
2025-03-13 12:21:37,907 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:37,907 [INFO]: 	index_param: efSearch=191
2025-03-13 12:21:37,907 [INFO]: 	index_path: knn.index
2025-03-13 12:21:37,907 [INFO]: 	size in bytes: 1334121490
2025-03-13 12:21:37,907 [INFO]: 	avg_search_speed_ms: 10.278229120465996
2025-03-13 12:21:37,907 [INFO]: 	99p_search_speed_ms: 15.313640572130678
2025-03-13 12:21:37,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:37,907 [INFO]: 	nb vectors: 6781
2025-03-13 12:21:37,907 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:37,907 [INFO]: 	compression ratio: 0.9993084273007251
2025-03-13 12:21:37,907 [INFO]: }
2025-03-13 12:21:37,907 [INFO]: 	>>> Finished "Creating the index" in 85.7255 secs
2025-03-13 12:21:37,907 [INFO]: >>> Finished "Launching the whole pipeline" in 85.7651 secs
2025-03-13 12:21:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 50230 [episode count 19/20]
2025-03-13 12:21:41: [retrieval_preprocessing] finished for 1656877278_put_cans_on_tray [chosen_id count 3/260]
2025-03-13 12:21:43: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_packet_in_bowl [chosen_id count 4/260]
2025-03-13 12:21:43: [retrieval_preprocessing] we have num_total=3831 embedding_dim=49152
[retrieval_preprocessing] for episode 55333 [episode count 0/20], we have num_retrieval=np.int64(3653) num_query=np.int64(178)
2025-03-13 12:21:43,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:44,014 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:44
2025-03-13 12:21:44,014 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1108.72it/s]
2025-03-13 12:21:44,048 [INFO]: There are 3653 embeddings of dim 49152
2025-03-13 12:21:44,048 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 12:21:44,048 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:44
2025-03-13 12:21:44,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:44,048 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:21:44,048 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:44,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:21:44,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:44
2025-03-13 12:21:44,048 [INFO]: 753.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:44,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:21:44,049 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:44
2025-03-13 12:21:44,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:44,049 [INFO]: 	Creating the index 03/13/2025, 12:21:44
2025-03-13 12:21:44,049 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:44
2025-03-13 12:21:44,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:21:44,050 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:44
2025-03-13 12:21:44,050 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:21:44,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.43it/s] 40%|████      | 6/15 [00:00<00:00, 31.53it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.80it/s]100%|██████████| 15/15 [00:03<00:00,  3.51it/s]100%|██████████| 15/15 [00:03<00:00,  4.86it/s]
2025-03-13 12:21:47,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:47
2025-03-13 12:22:27,733 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5953 secs
2025-03-13 12:22:27,734 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 12:22:27,734 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.98it/s]
2025-03-13 12:22:47,123 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3892 secs
2025-03-13 12:22:47,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3856 secs
2025-03-13 12:22:47,436 [INFO]: {
2025-03-13 12:22:47,436 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:47,436 [INFO]: 	index_param: efSearch=204
2025-03-13 12:22:47,436 [INFO]: 	index_path: knn.index
2025-03-13 12:22:47,436 [INFO]: 	size in bytes: 718705510
2025-03-13 12:22:47,436 [INFO]: 	avg_search_speed_ms: 8.603339907416686
2025-03-13 12:22:47,436 [INFO]: 	99p_search_speed_ms: 11.38455608393997
2025-03-13 12:22:47,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:47,436 [INFO]: 	nb vectors: 3653
2025-03-13 12:22:47,436 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:47,436 [INFO]: 	compression ratio: 0.9993091941092813
2025-03-13 12:22:47,436 [INFO]: }
2025-03-13 12:22:47,437 [INFO]: 	>>> Finished "Creating the index" in 63.3879 secs
2025-03-13 12:22:47,437 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4224 secs
2025-03-13 12:22:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 55333 [episode count 0/20]
[retrieval_preprocessing] for episode 32810 [episode count 1/20], we have num_retrieval=np.int64(3668) num_query=np.int64(163)
2025-03-13 12:22:48,895 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:49,344 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:49
2025-03-13 12:22:49,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1863.31it/s]
2025-03-13 12:22:49,371 [INFO]: There are 3668 embeddings of dim 49152
2025-03-13 12:22:49,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 12:22:49,372 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:49
2025-03-13 12:22:49,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:49,372 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:22:49,372 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:49,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:22:49,372 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:49
2025-03-13 12:22:49,372 [INFO]: 757.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:49,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:22:49,372 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:49
2025-03-13 12:22:49,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:49,372 [INFO]: 	Creating the index 03/13/2025, 12:22:49
2025-03-13 12:22:49,372 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:49
2025-03-13 12:22:49,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:22:49,373 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:49
2025-03-13 12:22:49,373 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:22:49,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.48it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.86it/s] 87%|████████▋ | 13/15 [00:00<00:00, 46.86it/s]100%|██████████| 15/15 [00:03<00:00,  5.00it/s]
2025-03-13 12:22:52,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:52
2025-03-13 12:23:37,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5640 secs
2025-03-13 12:23:37,943 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 12:23:37,943 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 12:23:55,279 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3364 secs
2025-03-13 12:23:55,283 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9095 secs
2025-03-13 12:23:55,283 [INFO]: {
2025-03-13 12:23:55,283 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:55,283 [INFO]: 	index_param: efSearch=204
2025-03-13 12:23:55,283 [INFO]: 	index_path: knn.index
2025-03-13 12:23:55,283 [INFO]: 	size in bytes: 721656610
2025-03-13 12:23:55,283 [INFO]: 	avg_search_speed_ms: 9.562088941209673
2025-03-13 12:23:55,283 [INFO]: 	99p_search_speed_ms: 13.715605600737033
2025-03-13 12:23:55,283 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:55,283 [INFO]: 	nb vectors: 3668
2025-03-13 12:23:55,283 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:55,283 [INFO]: 	compression ratio: 0.9993092753629735
2025-03-13 12:23:55,283 [INFO]: }
2025-03-13 12:23:55,283 [INFO]: 	>>> Finished "Creating the index" in 65.9109 secs
2025-03-13 12:23:55,283 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9387 secs
2025-03-13 12:23:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 32810 [episode count 1/20]
[retrieval_preprocessing] for episode 38956 [episode count 2/20], we have num_retrieval=np.int64(3614) num_query=np.int64(217)
2025-03-13 12:23:56,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:57,447 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:57
2025-03-13 12:23:57,447 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 12:23:57,477 [INFO]: There are 3614 embeddings of dim 49152
2025-03-13 12:23:57,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 12:23:57,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:57
2025-03-13 12:23:57,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:57,478 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:23:57,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:57,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:57,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:57
2025-03-13 12:23:57,478 [INFO]: 745.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:57,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:23:57,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:57
2025-03-13 12:23:57,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:57,478 [INFO]: 	Creating the index 03/13/2025, 12:23:57
2025-03-13 12:23:57,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:57
2025-03-13 12:23:57,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:23:57,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:57
2025-03-13 12:23:57,479 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:23:57,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.03it/s] 33%|███▎      | 5/15 [00:00<00:00, 21.83it/s] 67%|██████▋   | 10/15 [00:00<00:00, 31.77it/s]100%|██████████| 15/15 [00:03<00:00,  3.13it/s]100%|██████████| 15/15 [00:03<00:00,  4.12it/s]
2025-03-13 12:24:01,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:01
2025-03-13 12:24:40,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7435 secs
2025-03-13 12:24:40,865 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:24:40,865 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.20it/s]
2025-03-13 12:25:00,611 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7462 secs
2025-03-13 12:25:00,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1338 secs
2025-03-13 12:25:00,613 [INFO]: {
2025-03-13 12:25:00,613 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:00,613 [INFO]: 	index_param: efSearch=231
2025-03-13 12:25:00,613 [INFO]: 	index_path: knn.index
2025-03-13 12:25:00,613 [INFO]: 	size in bytes: 711032290
2025-03-13 12:25:00,613 [INFO]: 	avg_search_speed_ms: 11.261424852056882
2025-03-13 12:25:00,613 [INFO]: 	99p_search_speed_ms: 17.529446959961206
2025-03-13 12:25:00,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:00,613 [INFO]: 	nb vectors: 3614
2025-03-13 12:25:00,614 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:00,614 [INFO]: 	compression ratio: 0.9993094856493788
2025-03-13 12:25:00,614 [INFO]: }
2025-03-13 12:25:00,614 [INFO]: 	>>> Finished "Creating the index" in 63.1354 secs
2025-03-13 12:25:00,614 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1667 secs
2025-03-13 12:25:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 38956 [episode count 2/20]
[retrieval_preprocessing] for episode 6191 [episode count 3/20], we have num_retrieval=np.int64(3661) num_query=np.int64(170)
2025-03-13 12:25:02,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:03,445 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:03
2025-03-13 12:25:03,445 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1893.59it/s]
2025-03-13 12:25:03,475 [INFO]: There are 3661 embeddings of dim 49152
2025-03-13 12:25:03,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 12:25:03,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:03
2025-03-13 12:25:03,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:03,476 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:25:03,476 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:03,476 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:03,476 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:03
2025-03-13 12:25:03,476 [INFO]: 755.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:03,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:25:03,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:03
2025-03-13 12:25:03,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:03,476 [INFO]: 	Creating the index 03/13/2025, 12:25:03
2025-03-13 12:25:03,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:03
2025-03-13 12:25:03,477 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:25:03,477 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:03
2025-03-13 12:25:03,477 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:25:03,477 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.32it/s] 40%|████      | 6/15 [00:00<00:00, 27.67it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.00it/s]100%|██████████| 15/15 [00:03<00:00,  3.02it/s]100%|██████████| 15/15 [00:03<00:00,  4.17it/s]
2025-03-13 12:25:07,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:07
2025-03-13 12:25:47,620 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5413 secs
2025-03-13 12:25:47,620 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 12:25:47,620 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.99it/s]
2025-03-13 12:26:06,495 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8746 secs
2025-03-13 12:26:06,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0205 secs
2025-03-13 12:26:06,498 [INFO]: {
2025-03-13 12:26:06,498 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:06,498 [INFO]: 	index_param: efSearch=134
2025-03-13 12:26:06,498 [INFO]: 	index_path: knn.index
2025-03-13 12:26:06,498 [INFO]: 	size in bytes: 720279430
2025-03-13 12:26:06,498 [INFO]: 	avg_search_speed_ms: 7.791787114274555
2025-03-13 12:26:06,498 [INFO]: 	99p_search_speed_ms: 11.418782533146446
2025-03-13 12:26:06,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:06,498 [INFO]: 	nb vectors: 3661
2025-03-13 12:26:06,498 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:06,498 [INFO]: 	compression ratio: 0.9993092375274413
2025-03-13 12:26:06,498 [INFO]: }
2025-03-13 12:26:06,498 [INFO]: 	>>> Finished "Creating the index" in 63.0219 secs
2025-03-13 12:26:06,498 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0533 secs
2025-03-13 12:26:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 6191 [episode count 3/20]
[retrieval_preprocessing] for episode 20597 [episode count 4/20], we have num_retrieval=np.int64(3616) num_query=np.int64(215)
2025-03-13 12:26:08,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:08,739 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:08
2025-03-13 12:26:08,739 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2109.81it/s]
2025-03-13 12:26:08,770 [INFO]: There are 3616 embeddings of dim 49152
2025-03-13 12:26:08,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 12:26:08,770 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:08
2025-03-13 12:26:08,770 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:08,770 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:26:08,770 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:08,770 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:08,771 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:08
2025-03-13 12:26:08,771 [INFO]: 746.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:08,771 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:26:08,771 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:08
2025-03-13 12:26:08,771 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:08,771 [INFO]: 	Creating the index 03/13/2025, 12:26:08
2025-03-13 12:26:08,771 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:08
2025-03-13 12:26:08,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:26:08,772 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:08
2025-03-13 12:26:08,772 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:26:08,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.62it/s] 40%|████      | 6/15 [00:00<00:00, 25.81it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.56it/s]100%|██████████| 15/15 [00:03<00:00,  3.04it/s]100%|██████████| 15/15 [00:03<00:00,  4.18it/s]
2025-03-13 12:26:12,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:12
2025-03-13 12:26:53,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8561 secs
2025-03-13 12:26:53,217 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 12:26:53,217 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.30it/s]
2025-03-13 12:27:09,369 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1519 secs
2025-03-13 12:27:09,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5999 secs
2025-03-13 12:27:09,372 [INFO]: {
2025-03-13 12:27:09,372 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:09,372 [INFO]: 	index_param: efSearch=205
2025-03-13 12:27:09,372 [INFO]: 	index_path: knn.index
2025-03-13 12:27:09,372 [INFO]: 	size in bytes: 711425770
2025-03-13 12:27:09,372 [INFO]: 	avg_search_speed_ms: 12.436829384854203
2025-03-13 12:27:09,372 [INFO]: 	99p_search_speed_ms: 18.51638089166954
2025-03-13 12:27:09,372 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:09,372 [INFO]: 	nb vectors: 3616
2025-03-13 12:27:09,372 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:09,372 [INFO]: 	compression ratio: 0.9993094964777562
2025-03-13 12:27:09,372 [INFO]: }
2025-03-13 12:27:09,372 [INFO]: 	>>> Finished "Creating the index" in 60.6015 secs
2025-03-13 12:27:09,372 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6338 secs
2025-03-13 12:27:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 20597 [episode count 4/20]
[retrieval_preprocessing] for episode 55417 [episode count 5/20], we have num_retrieval=np.int64(3624) num_query=np.int64(207)
2025-03-13 12:27:12,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:12,790 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:12
2025-03-13 12:27:12,791 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.76it/s]
2025-03-13 12:27:12,841 [INFO]: There are 3624 embeddings of dim 49152
2025-03-13 12:27:12,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0506 secs
2025-03-13 12:27:12,842 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:12
2025-03-13 12:27:12,842 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:12,842 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:27:12,842 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:12,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:27:12,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:12
2025-03-13 12:27:12,842 [INFO]: 747.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:12,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:27:12,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:12
2025-03-13 12:27:12,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:12,842 [INFO]: 	Creating the index 03/13/2025, 12:27:12
2025-03-13 12:27:12,842 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:12
2025-03-13 12:27:12,844 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 12:27:12,844 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:12
2025-03-13 12:27:12,844 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:27:12,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.37it/s] 40%|████      | 6/15 [00:00<00:00, 30.05it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.14it/s]100%|██████████| 15/15 [00:03<00:00,  3.34it/s]100%|██████████| 15/15 [00:03<00:00,  4.62it/s]
2025-03-13 12:27:16,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:16
2025-03-13 12:27:50,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9206 secs
2025-03-13 12:27:50,018 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 12:27:50,018 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 12:28:10,370 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3519 secs
2025-03-13 12:28:10,374 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5293 secs
2025-03-13 12:28:10,374 [INFO]: {
2025-03-13 12:28:10,374 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:10,374 [INFO]: 	index_param: efSearch=157
2025-03-13 12:28:10,374 [INFO]: 	index_path: knn.index
2025-03-13 12:28:10,374 [INFO]: 	size in bytes: 712999750
2025-03-13 12:28:10,374 [INFO]: 	avg_search_speed_ms: 8.951264704538438
2025-03-13 12:28:10,374 [INFO]: 	99p_search_speed_ms: 13.013872532173991
2025-03-13 12:28:10,374 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:10,374 [INFO]: 	nb vectors: 3624
2025-03-13 12:28:10,374 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:10,374 [INFO]: 	compression ratio: 0.9993094555783505
2025-03-13 12:28:10,374 [INFO]: }
2025-03-13 12:28:10,374 [INFO]: 	>>> Finished "Creating the index" in 57.5315 secs
2025-03-13 12:28:10,374 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5833 secs
2025-03-13 12:28:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 55417 [episode count 5/20]
[retrieval_preprocessing] for episode 65727 [episode count 6/20], we have num_retrieval=np.int64(3649) num_query=np.int64(182)
2025-03-13 12:28:12,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:15,155 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:15
2025-03-13 12:28:15,155 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1176.85it/s]
2025-03-13 12:28:15,189 [INFO]: There are 3649 embeddings of dim 49152
2025-03-13 12:28:15,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 12:28:15,190 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,190 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:15,190 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:28:15,190 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:15,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:28:15,190 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,191 [INFO]: 753.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:15,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:28:15,191 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:15
2025-03-13 12:28:15,191 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:15,192 [INFO]: 	Creating the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:15
2025-03-13 12:28:15,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:28:15,195 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:15
2025-03-13 12:28:15,195 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:28:15,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.53it/s] 20%|██        | 3/15 [00:00<00:01,  9.49it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.72it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.23it/s] 60%|██████    | 9/15 [00:00<00:00, 11.47it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.41it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.60it/s]100%|██████████| 15/15 [00:04<00:00,  1.57it/s]100%|██████████| 15/15 [00:04<00:00,  3.16it/s]
2025-03-13 12:28:19,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:19
2025-03-13 12:29:01,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3529 secs
2025-03-13 12:29:01,306 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 12:29:01,306 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 12:29:22,835 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5286 secs
2025-03-13 12:29:22,838 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6426 secs
2025-03-13 12:29:22,838 [INFO]: {
2025-03-13 12:29:22,838 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:22,838 [INFO]: 	index_param: efSearch=265
2025-03-13 12:29:22,838 [INFO]: 	index_path: knn.index
2025-03-13 12:29:22,838 [INFO]: 	size in bytes: 717918490
2025-03-13 12:29:22,838 [INFO]: 	avg_search_speed_ms: 10.800053321072246
2025-03-13 12:29:22,838 [INFO]: 	99p_search_speed_ms: 18.08869213331491
2025-03-13 12:29:22,838 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:22,838 [INFO]: 	nb vectors: 3649
2025-03-13 12:29:22,838 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:22,838 [INFO]: 	compression ratio: 0.9993092558460223
2025-03-13 12:29:22,838 [INFO]: }
2025-03-13 12:29:22,838 [INFO]: 	>>> Finished "Creating the index" in 67.6464 secs
2025-03-13 12:29:22,838 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6833 secs
2025-03-13 12:29:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 65727 [episode count 6/20]
[retrieval_preprocessing] for episode 37124 [episode count 7/20], we have num_retrieval=np.int64(3632) num_query=np.int64(199)
2025-03-13 12:29:26,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:26,956 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:26
2025-03-13 12:29:26,956 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.78it/s]
2025-03-13 12:29:26,983 [INFO]: There are 3632 embeddings of dim 49152
2025-03-13 12:29:26,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 12:29:26,983 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:26
2025-03-13 12:29:26,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:26,984 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:29:26,984 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:26,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:29:26,984 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:26
2025-03-13 12:29:26,984 [INFO]: 749.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:26,984 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:29:26,984 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:26
2025-03-13 12:29:26,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:26,984 [INFO]: 	Creating the index 03/13/2025, 12:29:26
2025-03-13 12:29:26,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:26
2025-03-13 12:29:26,985 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:29:26,985 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:26
2025-03-13 12:29:26,985 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:29:26,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.01it/s] 20%|██        | 3/15 [00:00<00:01,  9.60it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.28it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.56it/s] 60%|██████    | 9/15 [00:00<00:00, 11.59it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.43it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.52it/s]100%|██████████| 15/15 [00:03<00:00,  1.97it/s]100%|██████████| 15/15 [00:03<00:00,  3.80it/s]
2025-03-13 12:29:30,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:30
2025-03-13 12:30:08,836 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8977 secs
2025-03-13 12:30:08,836 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 12:30:08,836 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 12:30:30,949 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1124 secs
2025-03-13 12:30:30,952 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9669 secs
2025-03-13 12:30:30,952 [INFO]: {
2025-03-13 12:30:30,952 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:30,952 [INFO]: 	index_param: efSearch=190
2025-03-13 12:30:30,952 [INFO]: 	index_path: knn.index
2025-03-13 12:30:30,952 [INFO]: 	size in bytes: 714573730
2025-03-13 12:30:30,952 [INFO]: 	avg_search_speed_ms: 9.630603087044937
2025-03-13 12:30:30,952 [INFO]: 	99p_search_speed_ms: 16.63597548380492
2025-03-13 12:30:30,952 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:30,952 [INFO]: 	nb vectors: 3632
2025-03-13 12:30:30,953 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:30,953 [INFO]: 	compression ratio: 0.9993094148591217
2025-03-13 12:30:30,953 [INFO]: }
2025-03-13 12:30:30,953 [INFO]: 	>>> Finished "Creating the index" in 63.9686 secs
2025-03-13 12:30:30,953 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9967 secs
2025-03-13 12:30:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 37124 [episode count 7/20]
[retrieval_preprocessing] for episode 18723 [episode count 8/20], we have num_retrieval=np.int64(3627) num_query=np.int64(204)
2025-03-13 12:30:33,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:34,395 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:34
2025-03-13 12:30:34,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.25it/s]
2025-03-13 12:30:34,421 [INFO]: There are 3627 embeddings of dim 49152
2025-03-13 12:30:34,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 12:30:34,421 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:34
2025-03-13 12:30:34,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:34,421 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:30:34,421 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:34,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:34,421 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:34
2025-03-13 12:30:34,421 [INFO]: 748.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:34,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:30:34,421 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:34
2025-03-13 12:30:34,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:34,422 [INFO]: 	Creating the index 03/13/2025, 12:30:34
2025-03-13 12:30:34,422 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:34
2025-03-13 12:30:34,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:30:34,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:34
2025-03-13 12:30:34,424 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:30:34,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.07it/s] 20%|██        | 3/15 [00:00<00:01,  8.80it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.62it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.76it/s] 60%|██████    | 9/15 [00:00<00:00, 11.18it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.49it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.55it/s]100%|██████████| 15/15 [00:03<00:00,  2.06it/s]100%|██████████| 15/15 [00:03<00:00,  3.89it/s]
2025-03-13 12:30:38,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:38
2025-03-13 12:31:19,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5393 secs
2025-03-13 12:31:19,826 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 12:31:19,826 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.99it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 12:31:37,716 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8902 secs
2025-03-13 12:31:37,719 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2953 secs
2025-03-13 12:31:37,719 [INFO]: {
2025-03-13 12:31:37,719 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:37,719 [INFO]: 	index_param: efSearch=215
2025-03-13 12:31:37,719 [INFO]: 	index_path: knn.index
2025-03-13 12:31:37,719 [INFO]: 	size in bytes: 713589970
2025-03-13 12:31:37,719 [INFO]: 	avg_search_speed_ms: 9.552627190575715
2025-03-13 12:31:37,719 [INFO]: 	99p_search_speed_ms: 15.345829417929053
2025-03-13 12:31:37,719 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:37,719 [INFO]: 	nb vectors: 3627
2025-03-13 12:31:37,719 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:37,719 [INFO]: 	compression ratio: 0.9993094717965276
2025-03-13 12:31:37,719 [INFO]: }
2025-03-13 12:31:37,719 [INFO]: 	>>> Finished "Creating the index" in 63.2970 secs
2025-03-13 12:31:37,719 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3238 secs
2025-03-13 12:31:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 18723 [episode count 8/20]
[retrieval_preprocessing] for episode 12833 [episode count 9/20], we have num_retrieval=np.int64(3659) num_query=np.int64(172)
2025-03-13 12:31:40,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:41,468 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:41
2025-03-13 12:31:41,468 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.96it/s]
2025-03-13 12:31:41,496 [INFO]: There are 3659 embeddings of dim 49152
2025-03-13 12:31:41,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:31:41,497 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:41
2025-03-13 12:31:41,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:41,497 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:31:41,498 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:41,498 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:31:41,498 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:41
2025-03-13 12:31:41,498 [INFO]: 755.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:41,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:31:41,499 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:41
2025-03-13 12:31:41,499 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:41,499 [INFO]: 	Creating the index 03/13/2025, 12:31:41
2025-03-13 12:31:41,499 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:41
2025-03-13 12:31:41,502 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:31:41,503 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:41
2025-03-13 12:31:41,503 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:31:41,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.40it/s] 20%|██        | 3/15 [00:00<00:01,  9.78it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.98it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.29it/s] 60%|██████    | 9/15 [00:00<00:00, 11.63it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.91it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.08it/s]100%|██████████| 15/15 [00:03<00:00,  2.10it/s]100%|██████████| 15/15 [00:03<00:00,  4.00it/s]
2025-03-13 12:31:45,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:45
2025-03-13 12:32:24,322 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0676 secs
2025-03-13 12:32:24,322 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 12:32:24,322 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 12:32:41,988 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6652 secs
2025-03-13 12:32:41,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4877 secs
2025-03-13 12:32:41,991 [INFO]: {
2025-03-13 12:32:41,991 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:41,991 [INFO]: 	index_param: efSearch=221
2025-03-13 12:32:41,991 [INFO]: 	index_path: knn.index
2025-03-13 12:32:41,991 [INFO]: 	size in bytes: 719885950
2025-03-13 12:32:41,991 [INFO]: 	avg_search_speed_ms: 10.451081334666787
2025-03-13 12:32:41,991 [INFO]: 	99p_search_speed_ms: 17.027373891323794
2025-03-13 12:32:41,991 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:41,991 [INFO]: 	nb vectors: 3659
2025-03-13 12:32:41,991 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:41,991 [INFO]: 	compression ratio: 0.9993092266907001
2025-03-13 12:32:41,991 [INFO]: }
2025-03-13 12:32:41,991 [INFO]: 	>>> Finished "Creating the index" in 60.4914 secs
2025-03-13 12:32:41,991 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5231 secs
2025-03-13 12:32:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 12833 [episode count 9/20]
[retrieval_preprocessing] for episode 25053 [episode count 10/20], we have num_retrieval=np.int64(3661) num_query=np.int64(170)
2025-03-13 12:32:44,406 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:44,894 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:44
2025-03-13 12:32:44,894 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.09it/s]
2025-03-13 12:32:44,918 [INFO]: There are 3661 embeddings of dim 49152
2025-03-13 12:32:44,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:32:44,918 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:44
2025-03-13 12:32:44,918 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:44,918 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:32:44,918 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:44,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:44,918 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:44
2025-03-13 12:32:44,918 [INFO]: 755.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:44,918 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:44,918 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:44
2025-03-13 12:32:44,918 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:44,918 [INFO]: 	Creating the index 03/13/2025, 12:32:44
2025-03-13 12:32:44,918 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:44
2025-03-13 12:32:44,919 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:32:44,920 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:44
2025-03-13 12:32:44,920 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:32:44,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.61it/s] 20%|██        | 3/15 [00:00<00:01,  8.68it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.69it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.60it/s] 40%|████      | 6/15 [00:00<00:01,  8.99it/s] 53%|█████▎    | 8/15 [00:00<00:00, 10.53it/s] 67%|██████▋   | 10/15 [00:01<00:00, 10.06it/s] 80%|████████  | 12/15 [00:01<00:00,  9.78it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.74it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.64it/s]100%|██████████| 15/15 [00:03<00:00,  1.52it/s]100%|██████████| 15/15 [00:03<00:00,  3.90it/s]
2025-03-13 12:32:48,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:48
2025-03-13 12:33:28,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7440 secs
2025-03-13 12:33:28,511 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:33:28,511 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 12:33:49,854 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3426 secs
2025-03-13 12:33:49,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9373 secs
2025-03-13 12:33:49,857 [INFO]: {
2025-03-13 12:33:49,857 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:49,857 [INFO]: 	index_param: efSearch=241
2025-03-13 12:33:49,857 [INFO]: 	index_path: knn.index
2025-03-13 12:33:49,857 [INFO]: 	size in bytes: 720279430
2025-03-13 12:33:49,857 [INFO]: 	avg_search_speed_ms: 10.839583198585318
2025-03-13 12:33:49,857 [INFO]: 	99p_search_speed_ms: 16.439624140039076
2025-03-13 12:33:49,857 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:49,857 [INFO]: 	nb vectors: 3661
2025-03-13 12:33:49,857 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:49,857 [INFO]: 	compression ratio: 0.9993092375274413
2025-03-13 12:33:49,857 [INFO]: }
2025-03-13 12:33:49,857 [INFO]: 	>>> Finished "Creating the index" in 64.9389 secs
2025-03-13 12:33:49,857 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9635 secs
2025-03-13 12:33:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 25053 [episode count 10/20]
[retrieval_preprocessing] for episode 61924 [episode count 11/20], we have num_retrieval=np.int64(3649) num_query=np.int64(182)
2025-03-13 12:33:53,133 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:53,801 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:53
2025-03-13 12:33:53,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.65it/s]
2025-03-13 12:33:53,825 [INFO]: There are 3649 embeddings of dim 49152
2025-03-13 12:33:53,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 12:33:53,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:53
2025-03-13 12:33:53,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:53,826 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:33:53,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:53,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:33:53,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:53
2025-03-13 12:33:53,826 [INFO]: 753.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:53,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:33:53,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:53
2025-03-13 12:33:53,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:53,826 [INFO]: 	Creating the index 03/13/2025, 12:33:53
2025-03-13 12:33:53,826 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:53
2025-03-13 12:33:53,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:33:53,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:53
2025-03-13 12:33:53,827 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:33:53,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.49it/s] 33%|███▎      | 5/15 [00:00<00:00, 22.15it/s] 60%|██████    | 9/15 [00:00<00:00, 26.92it/s] 87%|████████▋ | 13/15 [00:00<00:00, 29.77it/s]100%|██████████| 15/15 [00:04<00:00,  3.68it/s]
2025-03-13 12:33:57,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:57
2025-03-13 12:34:41,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8226 secs
2025-03-13 12:34:41,735 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 12:34:41,735 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.24it/s]
2025-03-13 12:35:01,946 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2106 secs
2025-03-13 12:35:01,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1211 secs
2025-03-13 12:35:01,948 [INFO]: {
2025-03-13 12:35:01,948 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:01,948 [INFO]: 	index_param: efSearch=210
2025-03-13 12:35:01,948 [INFO]: 	index_path: knn.index
2025-03-13 12:35:01,948 [INFO]: 	size in bytes: 717918490
2025-03-13 12:35:01,948 [INFO]: 	avg_search_speed_ms: 8.898115623659484
2025-03-13 12:35:01,948 [INFO]: 	99p_search_speed_ms: 12.752148709259922
2025-03-13 12:35:01,948 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:01,948 [INFO]: 	nb vectors: 3649
2025-03-13 12:35:01,949 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:01,949 [INFO]: 	compression ratio: 0.9993092558460223
2025-03-13 12:35:01,949 [INFO]: }
2025-03-13 12:35:01,949 [INFO]: 	>>> Finished "Creating the index" in 68.1226 secs
2025-03-13 12:35:01,949 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1470 secs
2025-03-13 12:35:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 61924 [episode count 11/20]
[retrieval_preprocessing] for episode 16909 [episode count 12/20], we have num_retrieval=np.int64(3644) num_query=np.int64(187)
2025-03-13 12:35:04,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:05,266 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:05
2025-03-13 12:35:05,266 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1946.31it/s]
2025-03-13 12:35:05,364 [INFO]: There are 3644 embeddings of dim 49152
2025-03-13 12:35:05,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0976 secs
2025-03-13 12:35:05,364 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:05,364 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:35:05,364 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:05,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:35:05,365 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,365 [INFO]: 752.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:05,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:35:05,365 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:05
2025-03-13 12:35:05,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:05,365 [INFO]: 	Creating the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,365 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:05
2025-03-13 12:35:05,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 12:35:05,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:05
2025-03-13 12:35:05,368 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:35:05,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.57it/s] 20%|██        | 3/15 [00:00<00:01,  8.85it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.95it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.46it/s] 60%|██████    | 9/15 [00:00<00:00, 10.70it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.53it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.37it/s]100%|██████████| 15/15 [00:03<00:00,  2.02it/s]100%|██████████| 15/15 [00:03<00:00,  3.79it/s]
2025-03-13 12:35:09,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:09
2025-03-13 12:35:47,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9984 secs
2025-03-13 12:35:47,330 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 12:35:47,330 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 12:36:01,794 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4638 secs
2025-03-13 12:36:01,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4285 secs
2025-03-13 12:36:01,796 [INFO]: {
2025-03-13 12:36:01,796 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:01,796 [INFO]: 	index_param: efSearch=226
2025-03-13 12:36:01,796 [INFO]: 	index_path: knn.index
2025-03-13 12:36:01,796 [INFO]: 	size in bytes: 716934790
2025-03-13 12:36:01,796 [INFO]: 	avg_search_speed_ms: 9.547131244254917
2025-03-13 12:36:01,796 [INFO]: 	99p_search_speed_ms: 13.506595047656447
2025-03-13 12:36:01,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:01,796 [INFO]: 	nb vectors: 3644
2025-03-13 12:36:01,796 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:01,797 [INFO]: 	compression ratio: 0.9993092286677844
2025-03-13 12:36:01,797 [INFO]: }
2025-03-13 12:36:01,797 [INFO]: 	>>> Finished "Creating the index" in 56.4313 secs
2025-03-13 12:36:01,797 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5302 secs
2025-03-13 12:36:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 16909 [episode count 12/20]
[retrieval_preprocessing] for episode 78188 [episode count 13/20], we have num_retrieval=np.int64(3663) num_query=np.int64(168)
2025-03-13 12:36:04,048 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:04,648 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:04
2025-03-13 12:36:04,648 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.86it/s]
2025-03-13 12:36:04,682 [INFO]: There are 3663 embeddings of dim 49152
2025-03-13 12:36:04,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 12:36:04,683 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:04
2025-03-13 12:36:04,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:04,683 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:36:04,683 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:04,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:36:04,683 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:04
2025-03-13 12:36:04,683 [INFO]: 756.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:04,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:36:04,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:04
2025-03-13 12:36:04,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:04,683 [INFO]: 	Creating the index 03/13/2025, 12:36:04
2025-03-13 12:36:04,684 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:04
2025-03-13 12:36:04,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:36:04,685 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:04
2025-03-13 12:36:04,685 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:36:04,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.56it/s] 40%|████      | 6/15 [00:00<00:00, 30.29it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.83it/s]100%|██████████| 15/15 [00:03<00:00,  3.21it/s]100%|██████████| 15/15 [00:03<00:00,  4.44it/s]
2025-03-13 12:36:08,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:08
2025-03-13 12:36:54,331 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2646 secs
2025-03-13 12:36:54,332 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 12:36:54,332 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.65it/s]
2025-03-13 12:37:15,476 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1437 secs
2025-03-13 12:37:15,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7944 secs
2025-03-13 12:37:15,480 [INFO]: {
2025-03-13 12:37:15,480 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:15,480 [INFO]: 	index_param: efSearch=209
2025-03-13 12:37:15,480 [INFO]: 	index_path: knn.index
2025-03-13 12:37:15,480 [INFO]: 	size in bytes: 720672910
2025-03-13 12:37:15,480 [INFO]: 	avg_search_speed_ms: 10.28830825757017
2025-03-13 12:37:15,480 [INFO]: 	99p_search_speed_ms: 16.462184526026245
2025-03-13 12:37:15,480 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:15,480 [INFO]: 	nb vectors: 3663
2025-03-13 12:37:15,480 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:15,480 [INFO]: 	compression ratio: 0.9993092483523489
2025-03-13 12:37:15,480 [INFO]: }
2025-03-13 12:37:15,480 [INFO]: 	>>> Finished "Creating the index" in 70.7966 secs
2025-03-13 12:37:15,480 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8320 secs
2025-03-13 12:37:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 78188 [episode count 13/20]
[retrieval_preprocessing] for episode 82296 [episode count 14/20], we have num_retrieval=np.int64(3572) num_query=np.int64(259)
2025-03-13 12:37:18,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:18,561 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:18
2025-03-13 12:37:18,561 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.45it/s]
2025-03-13 12:37:18,598 [INFO]: There are 3572 embeddings of dim 49152
2025-03-13 12:37:18,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 12:37:18,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:18
2025-03-13 12:37:18,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:18,599 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:37:18,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:18,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:37:18,599 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:18
2025-03-13 12:37:18,599 [INFO]: 737.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:18,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:37:18,599 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:18
2025-03-13 12:37:18,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:18,599 [INFO]: 	Creating the index 03/13/2025, 12:37:18
2025-03-13 12:37:18,599 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:18
2025-03-13 12:37:18,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:37:18,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:18
2025-03-13 12:37:18,601 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:37:18,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.68it/s] 40%|████      | 6/15 [00:00<00:00, 27.28it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.96it/s]100%|██████████| 15/15 [00:03<00:00,  2.94it/s]100%|██████████| 15/15 [00:03<00:00,  4.07it/s]
2025-03-13 12:37:22,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:22
2025-03-13 12:37:59,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2160 secs
2025-03-13 12:37:59,503 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 12:37:59,503 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 12:38:17,391 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8879 secs
2025-03-13 12:38:17,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7934 secs
2025-03-13 12:38:17,394 [INFO]: {
2025-03-13 12:38:17,394 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:17,394 [INFO]: 	index_param: efSearch=206
2025-03-13 12:38:17,394 [INFO]: 	index_path: knn.index
2025-03-13 12:38:17,394 [INFO]: 	size in bytes: 702768970
2025-03-13 12:38:17,394 [INFO]: 	avg_search_speed_ms: 11.765447513693395
2025-03-13 12:38:17,394 [INFO]: 	99p_search_speed_ms: 18.68206013692543
2025-03-13 12:38:17,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:17,394 [INFO]: 	nb vectors: 3572
2025-03-13 12:38:17,394 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:17,394 [INFO]: 	compression ratio: 0.9993095967228035
2025-03-13 12:38:17,394 [INFO]: }
2025-03-13 12:38:17,395 [INFO]: 	>>> Finished "Creating the index" in 58.7951 secs
2025-03-13 12:38:17,395 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8332 secs
2025-03-13 12:38:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 82296 [episode count 14/20]
[retrieval_preprocessing] for episode 384 [episode count 15/20], we have num_retrieval=np.int64(3611) num_query=np.int64(220)
2025-03-13 12:38:19,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:20,022 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:20
2025-03-13 12:38:20,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1820.44it/s]
2025-03-13 12:38:20,058 [INFO]: There are 3611 embeddings of dim 49152
2025-03-13 12:38:20,058 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 12:38:20,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:20
2025-03-13 12:38:20,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:20,059 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:38:20,059 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:20,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:38:20,059 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:20
2025-03-13 12:38:20,059 [INFO]: 745.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:20,059 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:38:20,060 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:20
2025-03-13 12:38:20,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:20,060 [INFO]: 	Creating the index 03/13/2025, 12:38:20
2025-03-13 12:38:20,060 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:20
2025-03-13 12:38:20,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 12:38:20,062 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:20
2025-03-13 12:38:20,062 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:38:20,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.96it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.02it/s] 87%|████████▋ | 13/15 [00:00<00:00, 43.50it/s]100%|██████████| 15/15 [00:02<00:00,  5.36it/s]
2025-03-13 12:38:22,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:22
2025-03-13 12:39:06,478 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6124 secs
2025-03-13 12:39:06,479 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 12:39:06,479 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-13 12:39:27,177 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6986 secs
2025-03-13 12:39:27,180 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1175 secs
2025-03-13 12:39:27,180 [INFO]: {
2025-03-13 12:39:27,180 [INFO]: 	index_key: HNSW15
2025-03-13 12:39:27,180 [INFO]: 	index_param: efSearch=201
2025-03-13 12:39:27,180 [INFO]: 	index_path: knn.index
2025-03-13 12:39:27,180 [INFO]: 	size in bytes: 710442070
2025-03-13 12:39:27,180 [INFO]: 	avg_search_speed_ms: 10.065720035503404
2025-03-13 12:39:27,180 [INFO]: 	99p_search_speed_ms: 14.466741716023531
2025-03-13 12:39:27,180 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:27,180 [INFO]: 	nb vectors: 3611
2025-03-13 12:39:27,180 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:27,180 [INFO]: 	compression ratio: 0.999309469384323
2025-03-13 12:39:27,180 [INFO]: }
2025-03-13 12:39:27,180 [INFO]: 	>>> Finished "Creating the index" in 67.1203 secs
2025-03-13 12:39:27,180 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1583 secs
2025-03-13 12:39:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 384 [episode count 15/20]
[retrieval_preprocessing] for episode 70039 [episode count 16/20], we have num_retrieval=np.int64(3653) num_query=np.int64(178)
2025-03-13 12:39:29,953 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:30,508 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:30
2025-03-13 12:39:30,508 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.26it/s]
2025-03-13 12:39:30,541 [INFO]: There are 3653 embeddings of dim 49152
2025-03-13 12:39:30,541 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 12:39:30,541 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,541 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:30,541 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:39:30,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:30,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:39:30,541 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,541 [INFO]: 753.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:30,541 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:39:30,541 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:30
2025-03-13 12:39:30,541 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:30,541 [INFO]: 	Creating the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,541 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:30
2025-03-13 12:39:30,542 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:39:30,542 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:30
2025-03-13 12:39:30,542 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:39:30,542 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.59it/s] 40%|████      | 6/15 [00:00<00:00, 32.27it/s] 80%|████████  | 12/15 [00:00<00:00, 41.15it/s]100%|██████████| 15/15 [00:03<00:00,  4.51it/s]
2025-03-13 12:39:33,873 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:33
2025-03-13 12:40:14,575 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7010 secs
2025-03-13 12:40:14,575 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 12:40:14,575 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 12:40:37,888 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3125 secs
2025-03-13 12:40:37,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3475 secs
2025-03-13 12:40:37,890 [INFO]: {
2025-03-13 12:40:37,890 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:37,890 [INFO]: 	index_param: efSearch=251
2025-03-13 12:40:37,890 [INFO]: 	index_path: knn.index
2025-03-13 12:40:37,890 [INFO]: 	size in bytes: 718705510
2025-03-13 12:40:37,890 [INFO]: 	avg_search_speed_ms: 13.612754528290358
2025-03-13 12:40:37,890 [INFO]: 	99p_search_speed_ms: 20.49450995866209
2025-03-13 12:40:37,890 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:37,890 [INFO]: 	nb vectors: 3653
2025-03-13 12:40:37,890 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:37,890 [INFO]: 	compression ratio: 0.9993091941092813
2025-03-13 12:40:37,890 [INFO]: }
2025-03-13 12:40:37,890 [INFO]: 	>>> Finished "Creating the index" in 67.3491 secs
2025-03-13 12:40:37,890 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3822 secs
2025-03-13 12:40:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 70039 [episode count 16/20]
[retrieval_preprocessing] for episode 82391 [episode count 17/20], we have num_retrieval=np.int64(3617) num_query=np.int64(214)
2025-03-13 12:40:43,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:44,323 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:44
2025-03-13 12:40:44,323 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.49it/s]
2025-03-13 12:40:44,359 [INFO]: There are 3617 embeddings of dim 49152
2025-03-13 12:40:44,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 12:40:44,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:44,360 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:40:44,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:44,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:40:44,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,361 [INFO]: 746.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:44,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:40:44,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:44
2025-03-13 12:40:44,362 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:44,362 [INFO]: 	Creating the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,362 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:44
2025-03-13 12:40:44,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:40:44,366 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,366 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:40:44,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.87it/s] 47%|████▋     | 7/15 [00:00<00:00, 37.49it/s] 87%|████████▋ | 13/15 [00:00<00:00, 44.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.82it/s]
2025-03-13 12:40:49,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:49
2025-03-13 12:41:43,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.7474 secs
2025-03-13 12:41:43,438 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 12:41:43,438 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 12:41:59,546 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1079 secs
2025-03-13 12:41:59,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.1829 secs
2025-03-13 12:41:59,549 [INFO]: {
2025-03-13 12:41:59,549 [INFO]: 	index_key: HNSW15
2025-03-13 12:41:59,549 [INFO]: 	index_param: efSearch=191
2025-03-13 12:41:59,549 [INFO]: 	index_path: knn.index
2025-03-13 12:41:59,549 [INFO]: 	size in bytes: 711622510
2025-03-13 12:41:59,549 [INFO]: 	avg_search_speed_ms: 9.475756393592086
2025-03-13 12:41:59,549 [INFO]: 	99p_search_speed_ms: 12.76999549008906
2025-03-13 12:41:59,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:59,549 [INFO]: 	nb vectors: 3617
2025-03-13 12:41:59,549 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:59,549 [INFO]: 	compression ratio: 0.9993095018874544
2025-03-13 12:41:59,549 [INFO]: }
2025-03-13 12:41:59,549 [INFO]: 	>>> Finished "Creating the index" in 75.1871 secs
2025-03-13 12:41:59,549 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2257 secs
2025-03-13 12:42:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 82391 [episode count 17/20]
[retrieval_preprocessing] for episode 90474 [episode count 18/20], we have num_retrieval=np.int64(3659) num_query=np.int64(172)
2025-03-13 12:42:01,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:02,158 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:02
2025-03-13 12:42:02,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1010.19it/s]
2025-03-13 12:42:02,192 [INFO]: There are 3659 embeddings of dim 49152
2025-03-13 12:42:02,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 12:42:02,192 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:02
2025-03-13 12:42:02,193 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:02,193 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:42:02,193 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:02,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:42:02,193 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:02
2025-03-13 12:42:02,193 [INFO]: 755.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:02,193 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:42:02,193 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:02
2025-03-13 12:42:02,193 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:02,193 [INFO]: 	Creating the index 03/13/2025, 12:42:02
2025-03-13 12:42:02,193 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:02
2025-03-13 12:42:02,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:42:02,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:02
2025-03-13 12:42:02,194 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:42:02,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.77it/s] 33%|███▎      | 5/15 [00:00<00:00, 26.14it/s] 60%|██████    | 9/15 [00:00<00:00, 31.84it/s] 87%|████████▋ | 13/15 [00:00<00:00, 34.44it/s]100%|██████████| 15/15 [00:04<00:00,  3.30it/s]
2025-03-13 12:42:06,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:06
2025-03-13 12:42:44,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4305 secs
2025-03-13 12:42:44,173 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 12:42:44,173 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 12:43:02,334 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1610 secs
2025-03-13 12:43:02,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1424 secs
2025-03-13 12:43:02,337 [INFO]: {
2025-03-13 12:43:02,337 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:02,337 [INFO]: 	index_param: efSearch=192
2025-03-13 12:43:02,337 [INFO]: 	index_path: knn.index
2025-03-13 12:43:02,337 [INFO]: 	size in bytes: 719885950
2025-03-13 12:43:02,337 [INFO]: 	avg_search_speed_ms: 10.95476099147144
2025-03-13 12:43:02,337 [INFO]: 	99p_search_speed_ms: 15.408879043534398
2025-03-13 12:43:02,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:02,337 [INFO]: 	nb vectors: 3659
2025-03-13 12:43:02,337 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:02,337 [INFO]: 	compression ratio: 0.9993092266907001
2025-03-13 12:43:02,337 [INFO]: }
2025-03-13 12:43:02,337 [INFO]: 	>>> Finished "Creating the index" in 60.1438 secs
2025-03-13 12:43:02,337 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1793 secs
2025-03-13 12:43:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 90474 [episode count 18/20]
[retrieval_preprocessing] for episode 33144 [episode count 19/20], we have num_retrieval=np.int64(3657) num_query=np.int64(174)
2025-03-13 12:43:03,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:04,441 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:04
2025-03-13 12:43:04,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 12:43:04,475 [INFO]: There are 3657 embeddings of dim 49152
2025-03-13 12:43:04,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 12:43:04,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:04
2025-03-13 12:43:04,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:04,476 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:43:04,477 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:04,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:43:04,477 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:04
2025-03-13 12:43:04,477 [INFO]: 754.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:04,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:43:04,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:04
2025-03-13 12:43:04,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:04,478 [INFO]: 	Creating the index 03/13/2025, 12:43:04
2025-03-13 12:43:04,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:04
2025-03-13 12:43:04,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:43:04,481 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:04
2025-03-13 12:43:04,482 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:43:04,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.22it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.34it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.53it/s]100%|██████████| 15/15 [00:03<00:00,  4.46it/s]
2025-03-13 12:43:07,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:07
2025-03-13 12:43:49,288 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4338 secs
2025-03-13 12:43:49,288 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 12:43:49,289 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.62it/s]
2025-03-13 12:44:05,581 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2926 secs
2025-03-13 12:44:05,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1023 secs
2025-03-13 12:44:05,584 [INFO]: {
2025-03-13 12:44:05,584 [INFO]: 	index_key: HNSW15
2025-03-13 12:44:05,584 [INFO]: 	index_param: efSearch=229
2025-03-13 12:44:05,584 [INFO]: 	index_path: knn.index
2025-03-13 12:44:05,584 [INFO]: 	size in bytes: 719492470
2025-03-13 12:44:05,584 [INFO]: 	avg_search_speed_ms: 11.187032159674137
2025-03-13 12:44:05,584 [INFO]: 	99p_search_speed_ms: 15.287858704105014
2025-03-13 12:44:05,584 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:44:05,584 [INFO]: 	nb vectors: 3657
2025-03-13 12:44:05,584 [INFO]: 	vectors dimension: 49152
2025-03-13 12:44:05,584 [INFO]: 	compression ratio: 0.9993092158421061
2025-03-13 12:44:05,584 [INFO]: }
2025-03-13 12:44:05,584 [INFO]: 	>>> Finished "Creating the index" in 61.1061 secs
2025-03-13 12:44:05,584 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1430 secs
2025-03-13 12:44:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 33144 [episode count 19/20]
2025-03-13 12:44:07: [retrieval_preprocessing] finished for 1656877278_put_packet_in_bowl [chosen_id count 4/260]
2025-03-13 12:44:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_towel_in_bowl [chosen_id count 5/260]
2025-03-13 12:44:09: [retrieval_preprocessing] we have num_total=4922 embedding_dim=49152
[retrieval_preprocessing] for episode 14 [episode count 0/20], we have num_retrieval=np.int64(4705) num_query=np.int64(217)
2025-03-13 12:44:10,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:10,694 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:10
2025-03-13 12:44:10,694 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.91it/s]
2025-03-13 12:44:10,727 [INFO]: There are 4705 embeddings of dim 49152
2025-03-13 12:44:10,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 12:44:10,727 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:10
2025-03-13 12:44:10,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:10,727 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:44:10,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:10,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:44:10,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:10
2025-03-13 12:44:10,727 [INFO]: 971.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:10,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:44:10,727 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:10
2025-03-13 12:44:10,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:10,727 [INFO]: 	Creating the index 03/13/2025, 12:44:10
2025-03-13 12:44:10,727 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:10
2025-03-13 12:44:10,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:44:10,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:10
2025-03-13 12:44:10,728 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:44:10,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.57it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.87it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.64it/s] 84%|████████▍ | 16/19 [00:00<00:00, 42.12it/s]100%|██████████| 19/19 [00:04<00:00,  4.56it/s]
2025-03-13 12:44:14,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:14
2025-03-13 12:45:14,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6251 secs
2025-03-13 12:45:14,524 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:45:14,524 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 12:45:38,784 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2597 secs
2025-03-13 12:45:38,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.0580 secs
2025-03-13 12:45:38,786 [INFO]: {
2025-03-13 12:45:38,787 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:38,787 [INFO]: 	index_param: efSearch=208
2025-03-13 12:45:38,787 [INFO]: 	index_path: knn.index
2025-03-13 12:45:38,787 [INFO]: 	size in bytes: 925680610
2025-03-13 12:45:38,787 [INFO]: 	avg_search_speed_ms: 10.226064557323884
2025-03-13 12:45:38,787 [INFO]: 	99p_search_speed_ms: 16.27794016385451
2025-03-13 12:45:38,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:38,787 [INFO]: 	nb vectors: 4705
2025-03-13 12:45:38,787 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:38,787 [INFO]: 	compression ratio: 0.9993086492326981
2025-03-13 12:45:38,787 [INFO]: }
2025-03-13 12:45:38,787 [INFO]: 	>>> Finished "Creating the index" in 88.0593 secs
2025-03-13 12:45:38,787 [INFO]: >>> Finished "Launching the whole pipeline" in 88.0927 secs
2025-03-13 12:45:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 14 [episode count 0/20]
[retrieval_preprocessing] for episode 55310 [episode count 1/20], we have num_retrieval=np.int64(4682) num_query=np.int64(240)
2025-03-13 12:45:41,660 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:42,509 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:42
2025-03-13 12:45:42,509 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 883.94it/s]
2025-03-13 12:45:42,550 [INFO]: There are 4682 embeddings of dim 49152
2025-03-13 12:45:42,551 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0420 secs
2025-03-13 12:45:42,551 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:42
2025-03-13 12:45:42,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:42,552 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:45:42,552 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:42,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:45:42,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:42
2025-03-13 12:45:42,552 [INFO]: 966.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:42,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:45:42,552 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:42
2025-03-13 12:45:42,553 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:42,553 [INFO]: 	Creating the index 03/13/2025, 12:45:42
2025-03-13 12:45:42,553 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:42
2025-03-13 12:45:42,556 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 12:45:42,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:42
2025-03-13 12:45:42,557 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:45:42,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.53it/s] 26%|██▋       | 5/19 [00:00<00:00, 26.27it/s] 47%|████▋     | 9/19 [00:00<00:00, 31.65it/s] 68%|██████▊   | 13/19 [00:00<00:00, 34.32it/s] 89%|████████▉ | 17/19 [00:00<00:00, 35.66it/s]100%|██████████| 19/19 [00:04<00:00,  4.26it/s]
2025-03-13 12:45:47,367 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:47
2025-03-13 12:46:30,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3550 secs
2025-03-13 12:46:30,722 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 12:46:30,722 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.26it/s]
2025-03-13 12:46:48,356 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6338 secs
2025-03-13 12:46:48,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2943 secs
2025-03-13 12:46:48,851 [INFO]: {
2025-03-13 12:46:48,851 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:48,852 [INFO]: 	index_param: efSearch=190
2025-03-13 12:46:48,852 [INFO]: 	index_path: knn.index
2025-03-13 12:46:48,852 [INFO]: 	size in bytes: 921155410
2025-03-13 12:46:48,852 [INFO]: 	avg_search_speed_ms: 9.257029113144165
2025-03-13 12:46:48,852 [INFO]: 	99p_search_speed_ms: 14.967846747022124
2025-03-13 12:46:48,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:48,852 [INFO]: 	nb vectors: 4682
2025-03-13 12:46:48,852 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:48,852 [INFO]: 	compression ratio: 0.9993087442215641
2025-03-13 12:46:48,852 [INFO]: }
2025-03-13 12:46:48,852 [INFO]: 	>>> Finished "Creating the index" in 66.2994 secs
2025-03-13 12:46:48,852 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3432 secs
2025-03-13 12:46:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 55310 [episode count 1/20]
[retrieval_preprocessing] for episode 75862 [episode count 2/20], we have num_retrieval=np.int64(4622) num_query=np.int64(300)
2025-03-13 12:46:51,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:52,007 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:52
2025-03-13 12:46:52,007 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.81it/s]
2025-03-13 12:46:52,047 [INFO]: There are 4622 embeddings of dim 49152
2025-03-13 12:46:52,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 12:46:52,048 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:52
2025-03-13 12:46:52,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:52,048 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 12:46:52,048 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:52,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:46:52,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:52
2025-03-13 12:46:52,048 [INFO]: 953.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:52,049 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:46:52,049 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:52
2025-03-13 12:46:52,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:52,049 [INFO]: 	Creating the index 03/13/2025, 12:46:52
2025-03-13 12:46:52,049 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:52
2025-03-13 12:46:52,051 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 12:46:52,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:52
2025-03-13 12:46:52,052 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:46:52,052 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.82it/s] 21%|██        | 4/19 [00:00<00:00, 19.46it/s] 47%|████▋     | 9/19 [00:00<00:00, 30.08it/s] 74%|███████▎  | 14/19 [00:00<00:00, 35.28it/s]100%|██████████| 19/19 [00:03<00:00,  3.39it/s]100%|██████████| 19/19 [00:03<00:00,  4.92it/s]
2025-03-13 12:46:55,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:55
2025-03-13 12:48:00,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.6985 secs
2025-03-13 12:48:00,637 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 12:48:00,637 [INFO]: 	Compute fast metrics 03/13/2025, 12:48:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.95s/it] 50%|█████     | 2/4 [00:07<00:07,  3.73s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.09s/it] 75%|███████▌  | 3/4 [00:11<00:03,  3.77s/it]
2025-03-13 12:48:32,861 [INFO]: 	>>> Finished "Compute fast metrics" in 32.2240 secs
2025-03-13 12:48:33,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.0228 secs
2025-03-13 12:48:33,075 [INFO]: {
2025-03-13 12:48:33,075 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:33,075 [INFO]: 	index_param: efSearch=160
2025-03-13 12:48:33,075 [INFO]: 	index_path: knn.index
2025-03-13 12:48:33,075 [INFO]: 	size in bytes: 909350650
2025-03-13 12:48:33,075 [INFO]: 	avg_search_speed_ms: 8.355003782394736
2025-03-13 12:48:33,075 [INFO]: 	99p_search_speed_ms: 13.609356274828304
2025-03-13 12:48:33,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:33,075 [INFO]: 	nb vectors: 4622
2025-03-13 12:48:33,075 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:33,076 [INFO]: 	compression ratio: 0.9993088760644753
2025-03-13 12:48:33,076 [INFO]: }
2025-03-13 12:48:33,076 [INFO]: 	>>> Finished "Creating the index" in 101.0267 secs
2025-03-13 12:48:33,076 [INFO]: >>> Finished "Launching the whole pipeline" in 101.0690 secs
2025-03-13 12:48:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 75862 [episode count 2/20]
[retrieval_preprocessing] for episode 2140 [episode count 3/20], we have num_retrieval=np.int64(4711) num_query=np.int64(211)
2025-03-13 12:48:35,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:36,279 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:36
2025-03-13 12:48:36,279 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1312.36it/s]
2025-03-13 12:48:36,322 [INFO]: There are 4711 embeddings of dim 49152
2025-03-13 12:48:36,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0433 secs
2025-03-13 12:48:36,323 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:36,323 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:48:36,323 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:36,323 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:48:36,324 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,324 [INFO]: 972.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:36,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:48:36,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:36
2025-03-13 12:48:36,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:36,325 [INFO]: 	Creating the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:36
2025-03-13 12:48:36,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:48:36,328 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,329 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:48:36,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.03it/s] 37%|███▋      | 7/19 [00:00<00:00, 31.75it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.10it/s] 89%|████████▉ | 17/19 [00:00<00:00, 39.29it/s]100%|██████████| 19/19 [00:04<00:00,  4.73it/s]
2025-03-13 12:48:40,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:40
2025-03-13 12:49:27,353 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0007 secs
2025-03-13 12:49:27,353 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 12:49:27,353 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:15,  5.27s/it] 50%|█████     | 2/4 [00:09<00:09,  4.73s/it] 75%|███████▌  | 3/4 [00:13<00:04,  4.47s/it] 75%|███████▌  | 3/4 [00:13<00:04,  4.63s/it]
2025-03-13 12:50:03,037 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6838 secs
2025-03-13 12:50:03,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7118 secs
2025-03-13 12:50:03,040 [INFO]: {
2025-03-13 12:50:03,041 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:03,041 [INFO]: 	index_param: efSearch=176
2025-03-13 12:50:03,041 [INFO]: 	index_path: knn.index
2025-03-13 12:50:03,041 [INFO]: 	size in bytes: 926861110
2025-03-13 12:50:03,041 [INFO]: 	avg_search_speed_ms: 7.497754460584646
2025-03-13 12:50:03,041 [INFO]: 	99p_search_speed_ms: 16.383778341114542
2025-03-13 12:50:03,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:03,041 [INFO]: 	nb vectors: 4711
2025-03-13 12:50:03,041 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:03,041 [INFO]: 	compression ratio: 0.9993086105425224
2025-03-13 12:50:03,041 [INFO]: }
2025-03-13 12:50:03,041 [INFO]: 	>>> Finished "Creating the index" in 86.7158 secs
2025-03-13 12:50:03,041 [INFO]: >>> Finished "Launching the whole pipeline" in 86.7618 secs
2025-03-13 12:50:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 2140 [episode count 3/20]
[retrieval_preprocessing] for episode 77958 [episode count 4/20], we have num_retrieval=np.int64(4685) num_query=np.int64(237)
2025-03-13 12:50:05,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:05,892 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:05
2025-03-13 12:50:05,892 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 956.29it/s]
2025-03-13 12:50:05,929 [INFO]: There are 4685 embeddings of dim 49152
2025-03-13 12:50:05,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 12:50:05,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:05,930 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:50:05,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:05,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:50:05,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,931 [INFO]: 966.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:05,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:50:05,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:05
2025-03-13 12:50:05,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:05,931 [INFO]: 	Creating the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:05
2025-03-13 12:50:05,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:50:05,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,935 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:50:05,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 26.67it/s] 47%|████▋     | 9/19 [00:00<00:00, 42.96it/s] 79%|███████▉  | 15/19 [00:00<00:00, 48.20it/s]100%|██████████| 19/19 [00:03<00:00,  4.96it/s]
2025-03-13 12:50:09,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:09
2025-03-13 12:50:51,158 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3879 secs
2025-03-13 12:50:51,158 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 12:50:51,159 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-13 12:51:10,695 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5367 secs
2025-03-13 12:51:10,699 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7640 secs
2025-03-13 12:51:10,699 [INFO]: {
2025-03-13 12:51:10,699 [INFO]: 	index_key: HNSW15
2025-03-13 12:51:10,699 [INFO]: 	index_param: efSearch=172
2025-03-13 12:51:10,699 [INFO]: 	index_path: knn.index
2025-03-13 12:51:10,699 [INFO]: 	size in bytes: 921745630
2025-03-13 12:51:10,699 [INFO]: 	avg_search_speed_ms: 10.79028121928133
2025-03-13 12:51:10,699 [INFO]: 	99p_search_speed_ms: 18.482783529907465
2025-03-13 12:51:10,699 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:51:10,699 [INFO]: 	nb vectors: 4685
2025-03-13 12:51:10,699 [INFO]: 	vectors dimension: 49152
2025-03-13 12:51:10,699 [INFO]: 	compression ratio: 0.9993087572327303
2025-03-13 12:51:10,699 [INFO]: }
2025-03-13 12:51:10,699 [INFO]: 	>>> Finished "Creating the index" in 64.7680 secs
2025-03-13 12:51:10,699 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8077 secs
2025-03-13 12:51:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 77958 [episode count 4/20]
[retrieval_preprocessing] for episode 88380 [episode count 5/20], we have num_retrieval=np.int64(4680) num_query=np.int64(242)
2025-03-13 12:51:13,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:51:13,975 [INFO]: Launching the whole pipeline 03/13/2025, 12:51:13
2025-03-13 12:51:13,975 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:51:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-13 12:51:14,008 [INFO]: There are 4680 embeddings of dim 49152
2025-03-13 12:51:14,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 12:51:14,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:51:14
2025-03-13 12:51:14,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:51:14,009 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:51:14,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:51:14,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:51:14,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:51:14
2025-03-13 12:51:14,009 [INFO]: 965.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:51:14,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:51:14,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:51:14
2025-03-13 12:51:14,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:51:14,009 [INFO]: 	Creating the index 03/13/2025, 12:51:14
2025-03-13 12:51:14,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:51:14
2025-03-13 12:51:14,010 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:51:14,010 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:51:14
2025-03-13 12:51:14,010 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:51:14,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.75it/s] 37%|███▋      | 7/19 [00:00<00:00, 32.47it/s] 68%|██████▊   | 13/19 [00:00<00:00, 41.34it/s]100%|██████████| 19/19 [00:03<00:00,  3.78it/s]100%|██████████| 19/19 [00:03<00:00,  5.07it/s]
2025-03-13 12:51:17,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:17
2025-03-13 12:52:00,666 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9059 secs
2025-03-13 12:52:00,666 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:52:00,667 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.89it/s]
2025-03-13 12:52:23,915 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2479 secs
2025-03-13 12:52:23,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9077 secs
2025-03-13 12:52:23,918 [INFO]: {
2025-03-13 12:52:23,918 [INFO]: 	index_key: HNSW15
2025-03-13 12:52:23,918 [INFO]: 	index_param: efSearch=239
2025-03-13 12:52:23,918 [INFO]: 	index_path: knn.index
2025-03-13 12:52:23,918 [INFO]: 	size in bytes: 920761870
2025-03-13 12:52:23,918 [INFO]: 	avg_search_speed_ms: 9.845052266907768
2025-03-13 12:52:23,918 [INFO]: 	99p_search_speed_ms: 12.999923585448414
2025-03-13 12:52:23,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:52:23,918 [INFO]: 	nb vectors: 4680
2025-03-13 12:52:23,918 [INFO]: 	vectors dimension: 49152
2025-03-13 12:52:23,918 [INFO]: 	compression ratio: 0.9993088006565694
2025-03-13 12:52:23,918 [INFO]: }
2025-03-13 12:52:23,918 [INFO]: 	>>> Finished "Creating the index" in 69.9091 secs
2025-03-13 12:52:23,918 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9432 secs
2025-03-13 12:52:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:52:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 88380 [episode count 5/20]
[retrieval_preprocessing] for episode 65830 [episode count 6/20], we have num_retrieval=np.int64(4659) num_query=np.int64(263)
2025-03-13 12:52:26,835 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:52:27,510 [INFO]: Launching the whole pipeline 03/13/2025, 12:52:27
2025-03-13 12:52:27,511 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:52:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1578.59it/s]
2025-03-13 12:52:27,542 [INFO]: There are 4659 embeddings of dim 49152
2025-03-13 12:52:27,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 12:52:27,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:52:27
2025-03-13 12:52:27,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:52:27,542 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:52:27,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:52:27,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:52:27,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:52:27
2025-03-13 12:52:27,542 [INFO]: 961.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:52:27,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:52:27,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:52:27
2025-03-13 12:52:27,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:52:27,542 [INFO]: 	Creating the index 03/13/2025, 12:52:27
2025-03-13 12:52:27,542 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:52:27
2025-03-13 12:52:27,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:52:27,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:52:27
2025-03-13 12:52:27,544 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:52:27,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.39it/s] 32%|███▏      | 6/19 [00:00<00:00, 26.28it/s] 58%|█████▊    | 11/19 [00:00<00:00, 33.63it/s] 84%|████████▍ | 16/19 [00:00<00:00, 37.09it/s]100%|██████████| 19/19 [00:04<00:00,  4.15it/s]
2025-03-13 12:52:32,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:52:32
2025-03-13 12:53:24,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.7636 secs
2025-03-13 12:53:24,886 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:53:24,886 [INFO]: 	Compute fast metrics 03/13/2025, 12:53:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 12:53:55,801 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9147 secs
2025-03-13 12:53:55,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.2602 secs
2025-03-13 12:53:55,804 [INFO]: {
2025-03-13 12:53:55,804 [INFO]: 	index_key: HNSW15
2025-03-13 12:53:55,804 [INFO]: 	index_param: efSearch=235
2025-03-13 12:53:55,804 [INFO]: 	index_path: knn.index
2025-03-13 12:53:55,804 [INFO]: 	size in bytes: 916630210
2025-03-13 12:53:55,804 [INFO]: 	avg_search_speed_ms: 14.520255712581411
2025-03-13 12:53:55,804 [INFO]: 	99p_search_speed_ms: 22.276983028277762
2025-03-13 12:53:55,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:55,804 [INFO]: 	nb vectors: 4659
2025-03-13 12:53:55,804 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:55,804 [INFO]: 	compression ratio: 0.999308840148308
2025-03-13 12:53:55,804 [INFO]: }
2025-03-13 12:53:55,804 [INFO]: 	>>> Finished "Creating the index" in 88.2617 secs
2025-03-13 12:53:55,804 [INFO]: >>> Finished "Launching the whole pipeline" in 88.2936 secs
2025-03-13 12:53:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 65830 [episode count 6/20]
[retrieval_preprocessing] for episode 33073 [episode count 7/20], we have num_retrieval=np.int64(4630) num_query=np.int64(292)
2025-03-13 12:54:00,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:54:01,400 [INFO]: Launching the whole pipeline 03/13/2025, 12:54:01
2025-03-13 12:54:01,400 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:54:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 662.50it/s]
2025-03-13 12:54:01,459 [INFO]: There are 4630 embeddings of dim 49152
2025-03-13 12:54:01,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0593 secs
2025-03-13 12:54:01,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:54:01
2025-03-13 12:54:01,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:54:01,460 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 12:54:01,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:54:01,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:54:01,461 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:54:01
2025-03-13 12:54:01,461 [INFO]: 955.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:54:01,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:54:01,461 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:54:01
2025-03-13 12:54:01,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:54:01,461 [INFO]: 	Creating the index 03/13/2025, 12:54:01
2025-03-13 12:54:01,462 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:54:01
2025-03-13 12:54:01,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:54:01,465 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:54:01
2025-03-13 12:54:01,465 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:54:01,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.85it/s] 21%|██        | 4/19 [00:00<00:01, 14.03it/s] 37%|███▋      | 7/19 [00:00<00:00, 17.79it/s] 53%|█████▎    | 10/19 [00:00<00:00, 20.73it/s] 68%|██████▊   | 13/19 [00:00<00:00, 23.50it/s] 89%|████████▉ | 17/19 [00:00<00:00, 26.81it/s]100%|██████████| 19/19 [00:04<00:00,  3.80it/s]
2025-03-13 12:54:06,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:54:06
2025-03-13 12:55:01,419 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.5739 secs
2025-03-13 12:55:01,419 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 12:55:01,419 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.97it/s]
2025-03-13 12:55:21,765 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3459 secs
2025-03-13 12:55:21,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.3024 secs
2025-03-13 12:55:21,768 [INFO]: {
2025-03-13 12:55:21,768 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:21,768 [INFO]: 	index_param: efSearch=242
2025-03-13 12:55:21,768 [INFO]: 	index_path: knn.index
2025-03-13 12:55:21,768 [INFO]: 	size in bytes: 910924570
2025-03-13 12:55:21,768 [INFO]: 	avg_search_speed_ms: 10.096696896175924
2025-03-13 12:55:21,768 [INFO]: 	99p_search_speed_ms: 14.544426696375012
2025-03-13 12:55:21,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:21,768 [INFO]: 	nb vectors: 4630
2025-03-13 12:55:21,768 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:21,768 [INFO]: 	compression ratio: 0.9993089109452827
2025-03-13 12:55:21,768 [INFO]: }
2025-03-13 12:55:21,768 [INFO]: 	>>> Finished "Creating the index" in 80.3065 secs
2025-03-13 12:55:21,768 [INFO]: >>> Finished "Launching the whole pipeline" in 80.3681 secs
2025-03-13 12:55:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 33073 [episode count 7/20]
[retrieval_preprocessing] for episode 29011 [episode count 8/20], we have num_retrieval=np.int64(4651) num_query=np.int64(271)
2025-03-13 12:55:26,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:26,966 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:26
2025-03-13 12:55:26,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.79it/s]
2025-03-13 12:55:26,999 [INFO]: There are 4651 embeddings of dim 49152
2025-03-13 12:55:26,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 12:55:26,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:26
2025-03-13 12:55:27,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:27,000 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:55:27,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:27,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:55:27,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:27
2025-03-13 12:55:27,000 [INFO]: 959.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:27,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:55:27,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:27
2025-03-13 12:55:27,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:27,000 [INFO]: 	Creating the index 03/13/2025, 12:55:27
2025-03-13 12:55:27,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:27
2025-03-13 12:55:27,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:55:27,002 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:27
2025-03-13 12:55:27,002 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:55:27,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.57it/s] 21%|██        | 4/19 [00:00<00:00, 16.71it/s] 37%|███▋      | 7/19 [00:00<00:00, 18.89it/s] 47%|████▋     | 9/19 [00:00<00:00, 17.63it/s] 58%|█████▊    | 11/19 [00:00<00:00, 12.46it/s] 68%|██████▊   | 13/19 [00:00<00:00, 12.25it/s] 95%|█████████▍| 18/19 [00:01<00:00, 19.58it/s]100%|██████████| 19/19 [00:04<00:00,  4.33it/s]
2025-03-13 12:55:31,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:31
2025-03-13 12:56:14,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7351 secs
2025-03-13 12:56:14,132 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 12:56:14,132 [INFO]: 	Compute fast metrics 03/13/2025, 12:56:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 12:56:34,120 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9881 secs
2025-03-13 12:56:34,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1235 secs
2025-03-13 12:56:34,125 [INFO]: {
2025-03-13 12:56:34,125 [INFO]: 	index_key: HNSW15
2025-03-13 12:56:34,126 [INFO]: 	index_param: efSearch=270
2025-03-13 12:56:34,126 [INFO]: 	index_path: knn.index
2025-03-13 12:56:34,126 [INFO]: 	size in bytes: 915056290
2025-03-13 12:56:34,126 [INFO]: 	avg_search_speed_ms: 12.104918557515383
2025-03-13 12:56:34,126 [INFO]: 	99p_search_speed_ms: 18.55675154365599
2025-03-13 12:56:34,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:34,126 [INFO]: 	nb vectors: 4651
2025-03-13 12:56:34,126 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:34,126 [INFO]: 	compression ratio: 0.9993088053632198
2025-03-13 12:56:34,126 [INFO]: }
2025-03-13 12:56:34,126 [INFO]: 	>>> Finished "Creating the index" in 67.1256 secs
2025-03-13 12:56:34,126 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1595 secs
2025-03-13 12:56:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 29011 [episode count 8/20]
[retrieval_preprocessing] for episode 59657 [episode count 9/20], we have num_retrieval=np.int64(4685) num_query=np.int64(237)
2025-03-13 12:56:38,185 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:39,405 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:39
2025-03-13 12:56:39,405 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.40it/s]
2025-03-13 12:56:39,444 [INFO]: There are 4685 embeddings of dim 49152
2025-03-13 12:56:39,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 12:56:39,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:39
2025-03-13 12:56:39,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:39,444 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:56:39,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:56:39,445 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:56:39,445 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:39
2025-03-13 12:56:39,445 [INFO]: 966.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:39,445 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:56:39,445 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:39
2025-03-13 12:56:39,445 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:39,445 [INFO]: 	Creating the index 03/13/2025, 12:56:39
2025-03-13 12:56:39,445 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:56:39
2025-03-13 12:56:39,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:56:39,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:39
2025-03-13 12:56:39,446 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:56:39,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.31it/s] 42%|████▏     | 8/19 [00:00<00:00, 37.76it/s] 74%|███████▎  | 14/19 [00:00<00:00, 44.16it/s]100%|██████████| 19/19 [00:04<00:00,  2.95it/s]100%|██████████| 19/19 [00:04<00:00,  4.20it/s]
2025-03-13 12:56:43,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:43
2025-03-13 12:57:37,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8937 secs
2025-03-13 12:57:37,875 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 12:57:37,876 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.59it/s]
2025-03-13 12:58:03,670 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7947 secs
2025-03-13 12:58:04,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9945 secs
2025-03-13 12:58:04,441 [INFO]: {
2025-03-13 12:58:04,441 [INFO]: 	index_key: HNSW15
2025-03-13 12:58:04,441 [INFO]: 	index_param: efSearch=224
2025-03-13 12:58:04,441 [INFO]: 	index_path: knn.index
2025-03-13 12:58:04,442 [INFO]: 	size in bytes: 921745630
2025-03-13 12:58:04,442 [INFO]: 	avg_search_speed_ms: 8.79981789288251
2025-03-13 12:58:04,442 [INFO]: 	99p_search_speed_ms: 11.529864436015488
2025-03-13 12:58:04,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:04,442 [INFO]: 	nb vectors: 4685
2025-03-13 12:58:04,442 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:04,442 [INFO]: 	compression ratio: 0.9993087572327303
2025-03-13 12:58:04,442 [INFO]: }
2025-03-13 12:58:04,442 [INFO]: 	>>> Finished "Creating the index" in 84.9971 secs
2025-03-13 12:58:04,442 [INFO]: >>> Finished "Launching the whole pipeline" in 85.0371 secs
2025-03-13 12:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 59657 [episode count 9/20]
[retrieval_preprocessing] for episode 57642 [episode count 10/20], we have num_retrieval=np.int64(4714) num_query=np.int64(208)
2025-03-13 12:58:06,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:07,233 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:07
2025-03-13 12:58:07,233 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-13 12:58:07,270 [INFO]: There are 4714 embeddings of dim 49152
2025-03-13 12:58:07,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 12:58:07,270 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:07
2025-03-13 12:58:07,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:07,270 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:58:07,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:58:07,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:07,270 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:07
2025-03-13 12:58:07,270 [INFO]: 972.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:07,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:07,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:07
2025-03-13 12:58:07,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:07,271 [INFO]: 	Creating the index 03/13/2025, 12:58:07
2025-03-13 12:58:07,271 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:07
2025-03-13 12:58:07,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:58:07,272 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:07
2025-03-13 12:58:07,272 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:58:07,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.60it/s] 42%|████▏     | 8/19 [00:00<00:00, 39.43it/s] 74%|███████▎  | 14/19 [00:00<00:00, 45.98it/s]100%|██████████| 19/19 [00:03<00:00,  3.43it/s]100%|██████████| 19/19 [00:03<00:00,  4.87it/s]
2025-03-13 12:58:11,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:11
2025-03-13 12:58:54,711 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5334 secs
2025-03-13 12:58:54,712 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 12:58:54,712 [INFO]: 	Compute fast metrics 03/13/2025, 12:58:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.03it/s]
2025-03-13 12:59:13,738 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0268 secs
2025-03-13 12:59:13,743 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4707 secs
2025-03-13 12:59:13,744 [INFO]: {
2025-03-13 12:59:13,744 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:13,744 [INFO]: 	index_param: efSearch=230
2025-03-13 12:59:13,744 [INFO]: 	index_path: knn.index
2025-03-13 12:59:13,744 [INFO]: 	size in bytes: 927451330
2025-03-13 12:59:13,744 [INFO]: 	avg_search_speed_ms: 14.038406600483379
2025-03-13 12:59:13,744 [INFO]: 	99p_search_speed_ms: 20.331567758694288
2025-03-13 12:59:13,744 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:13,744 [INFO]: 	nb vectors: 4714
2025-03-13 12:59:13,744 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:13,744 [INFO]: 	compression ratio: 0.9993086235587155
2025-03-13 12:59:13,744 [INFO]: }
2025-03-13 12:59:13,744 [INFO]: 	>>> Finished "Creating the index" in 66.4734 secs
2025-03-13 12:59:13,744 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5113 secs
2025-03-13 12:59:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 57642 [episode count 10/20]
[retrieval_preprocessing] for episode 59991 [episode count 11/20], we have num_retrieval=np.int64(4707) num_query=np.int64(215)
2025-03-13 12:59:17,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:17,904 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:17
2025-03-13 12:59:17,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2270.87it/s]
2025-03-13 12:59:17,939 [INFO]: There are 4707 embeddings of dim 49152
2025-03-13 12:59:17,940 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 12:59:17,940 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:17
2025-03-13 12:59:17,940 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:17,940 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 12:59:17,940 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:17,940 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:59:17,940 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:17
2025-03-13 12:59:17,940 [INFO]: 971.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:17,940 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:59:17,940 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:17
2025-03-13 12:59:17,940 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:17,940 [INFO]: 	Creating the index 03/13/2025, 12:59:17
2025-03-13 12:59:17,940 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:17
2025-03-13 12:59:17,941 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:59:17,941 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:17
2025-03-13 12:59:17,941 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 12:59:17,941 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.25it/s] 26%|██▋       | 5/19 [00:00<00:00, 25.97it/s] 47%|████▋     | 9/19 [00:00<00:00, 31.23it/s] 68%|██████▊   | 13/19 [00:00<00:00, 33.78it/s] 89%|████████▉ | 17/19 [00:00<00:00, 34.69it/s]100%|██████████| 19/19 [00:05<00:00,  3.24it/s]
2025-03-13 12:59:24,167 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:24
2025-03-13 13:00:07,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8510 secs
2025-03-13 13:00:07,019 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 13:00:07,020 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.30it/s]
2025-03-13 13:00:30,466 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4459 secs
2025-03-13 13:00:30,468 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5268 secs
2025-03-13 13:00:30,468 [INFO]: {
2025-03-13 13:00:30,468 [INFO]: 	index_key: HNSW15
2025-03-13 13:00:30,468 [INFO]: 	index_param: efSearch=251
2025-03-13 13:00:30,468 [INFO]: 	index_path: knn.index
2025-03-13 13:00:30,468 [INFO]: 	size in bytes: 926074090
2025-03-13 13:00:30,468 [INFO]: 	avg_search_speed_ms: 10.36527752659134
2025-03-13 13:00:30,468 [INFO]: 	99p_search_speed_ms: 15.001589935272932
2025-03-13 13:00:30,468 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:30,468 [INFO]: 	nb vectors: 4707
2025-03-13 13:00:30,468 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:30,468 [INFO]: 	compression ratio: 0.999308657906626
2025-03-13 13:00:30,468 [INFO]: }
2025-03-13 13:00:30,468 [INFO]: 	>>> Finished "Creating the index" in 72.5281 secs
2025-03-13 13:00:30,468 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5644 secs
2025-03-13 13:00:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 59991 [episode count 11/20]
[retrieval_preprocessing] for episode 8656 [episode count 12/20], we have num_retrieval=np.int64(4704) num_query=np.int64(218)
2025-03-13 13:00:32,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:33,341 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:33
2025-03-13 13:00:33,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 13:00:33,373 [INFO]: There are 4704 embeddings of dim 49152
2025-03-13 13:00:33,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 13:00:33,373 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:33
2025-03-13 13:00:33,373 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:33,373 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:00:33,373 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:00:33,373 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:33,373 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:33
2025-03-13 13:00:33,373 [INFO]: 970.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:33,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:00:33,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:33
2025-03-13 13:00:33,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:33,373 [INFO]: 	Creating the index 03/13/2025, 13:00:33
2025-03-13 13:00:33,374 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:00:33
2025-03-13 13:00:33,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:00:33,375 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:33
2025-03-13 13:00:33,375 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:00:33,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.28it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.92it/s] 58%|█████▊    | 11/19 [00:00<00:00, 34.75it/s] 84%|████████▍ | 16/19 [00:00<00:00, 37.39it/s]100%|██████████| 19/19 [00:05<00:00,  3.68it/s]
2025-03-13 13:00:38,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:38
2025-03-13 13:01:24,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4009 secs
2025-03-13 13:01:24,946 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 13:01:24,946 [INFO]: 	Compute fast metrics 03/13/2025, 13:01:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.46it/s]
2025-03-13 13:02:04,185 [INFO]: 	>>> Finished "Compute fast metrics" in 39.2386 secs
2025-03-13 13:02:04,188 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8132 secs
2025-03-13 13:02:04,188 [INFO]: {
2025-03-13 13:02:04,188 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:04,188 [INFO]: 	index_param: efSearch=203
2025-03-13 13:02:04,188 [INFO]: 	index_path: knn.index
2025-03-13 13:02:04,188 [INFO]: 	size in bytes: 925483810
2025-03-13 13:02:04,188 [INFO]: 	avg_search_speed_ms: 9.562810416596925
2025-03-13 13:02:04,188 [INFO]: 	99p_search_speed_ms: 14.579006948042657
2025-03-13 13:02:04,188 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:04,188 [INFO]: 	nb vectors: 4704
2025-03-13 13:02:04,188 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:04,188 [INFO]: 	compression ratio: 0.9993087096791029
2025-03-13 13:02:04,188 [INFO]: }
2025-03-13 13:02:04,188 [INFO]: 	>>> Finished "Creating the index" in 90.8146 secs
2025-03-13 13:02:04,188 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8469 secs
2025-03-13 13:02:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 8656 [episode count 12/20]
[retrieval_preprocessing] for episode 33632 [episode count 13/20], we have num_retrieval=np.int64(4708) num_query=np.int64(214)
2025-03-13 13:02:06,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:08,056 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:08
2025-03-13 13:02:08,056 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1568.55it/s]
2025-03-13 13:02:08,097 [INFO]: There are 4708 embeddings of dim 49152
2025-03-13 13:02:08,098 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0416 secs
2025-03-13 13:02:08,098 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,098 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:08,098 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:02:08,099 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:08,099 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 13:02:08,099 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,099 [INFO]: 971.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:08,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:02:08,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:08
2025-03-13 13:02:08,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:08,100 [INFO]: 	Creating the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:08
2025-03-13 13:02:08,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 13:02:08,104 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,104 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:02:08,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.38it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.29it/s] 47%|████▋     | 9/19 [00:00<00:00, 28.74it/s] 68%|██████▊   | 13/19 [00:00<00:00, 31.13it/s] 89%|████████▉ | 17/19 [00:00<00:00, 29.33it/s]100%|██████████| 19/19 [00:04<00:00,  3.84it/s]
2025-03-13 13:02:13,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:13
2025-03-13 13:02:57,383 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3187 secs
2025-03-13 13:02:57,383 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 13:02:57,383 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.50it/s]
2025-03-13 13:03:11,510 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1267 secs
2025-03-13 13:03:11,514 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4097 secs
2025-03-13 13:03:11,514 [INFO]: {
2025-03-13 13:03:11,514 [INFO]: 	index_key: HNSW15
2025-03-13 13:03:11,514 [INFO]: 	index_param: efSearch=241
2025-03-13 13:03:11,514 [INFO]: 	index_path: knn.index
2025-03-13 13:03:11,514 [INFO]: 	size in bytes: 926270890
2025-03-13 13:03:11,514 [INFO]: 	avg_search_speed_ms: 14.252309024763795
2025-03-13 13:03:11,514 [INFO]: 	99p_search_speed_ms: 27.214850171003494
2025-03-13 13:03:11,514 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:03:11,514 [INFO]: 	nb vectors: 4708
2025-03-13 13:03:11,514 [INFO]: 	vectors dimension: 49152
2025-03-13 13:03:11,514 [INFO]: 	compression ratio: 0.9993085975097414
2025-03-13 13:03:11,514 [INFO]: }
2025-03-13 13:03:11,514 [INFO]: 	>>> Finished "Creating the index" in 63.4144 secs
2025-03-13 13:03:11,514 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4584 secs
2025-03-13 13:03:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:03:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 33632 [episode count 13/20]
[retrieval_preprocessing] for episode 80740 [episode count 14/20], we have num_retrieval=np.int64(4684) num_query=np.int64(238)
2025-03-13 13:03:14,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:03:15,590 [INFO]: Launching the whole pipeline 03/13/2025, 13:03:15
2025-03-13 13:03:15,590 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:03:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1634.57it/s]
2025-03-13 13:03:15,636 [INFO]: There are 4684 embeddings of dim 49152
2025-03-13 13:03:15,636 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0464 secs
2025-03-13 13:03:15,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:03:15
2025-03-13 13:03:15,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:03:15,637 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:03:15,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:03:15,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:03:15,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:03:15
2025-03-13 13:03:15,637 [INFO]: 966.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:03:15,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:03:15,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:03:15
2025-03-13 13:03:15,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:03:15,637 [INFO]: 	Creating the index 03/13/2025, 13:03:15
2025-03-13 13:03:15,637 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:03:15
2025-03-13 13:03:15,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:03:15,638 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:03:15
2025-03-13 13:03:15,638 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:03:15,638 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  4.95it/s] 21%|██        | 4/19 [00:00<00:01, 14.91it/s] 37%|███▋      | 7/19 [00:00<00:00, 19.76it/s] 58%|█████▊    | 11/19 [00:00<00:00, 24.38it/s] 79%|███████▉  | 15/19 [00:00<00:00, 27.74it/s]100%|██████████| 19/19 [00:05<00:00,  1.93it/s]100%|██████████| 19/19 [00:05<00:00,  3.19it/s]
2025-03-13 13:03:21,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:21
2025-03-13 13:04:20,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5732 secs
2025-03-13 13:04:20,175 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 13:04:20,175 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.12s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.49it/s]
2025-03-13 13:04:47,087 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9117 secs
2025-03-13 13:04:47,090 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.4517 secs
2025-03-13 13:04:47,090 [INFO]: {
2025-03-13 13:04:47,090 [INFO]: 	index_key: HNSW15
2025-03-13 13:04:47,090 [INFO]: 	index_param: efSearch=251
2025-03-13 13:04:47,090 [INFO]: 	index_path: knn.index
2025-03-13 13:04:47,090 [INFO]: 	size in bytes: 921548890
2025-03-13 13:04:47,090 [INFO]: 	avg_search_speed_ms: 10.904946576218926
2025-03-13 13:04:47,090 [INFO]: 	99p_search_speed_ms: 15.639396086335184
2025-03-13 13:04:47,090 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:47,090 [INFO]: 	nb vectors: 4684
2025-03-13 13:04:47,090 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:47,090 [INFO]: 	compression ratio: 0.9993087528975266
2025-03-13 13:04:47,090 [INFO]: }
2025-03-13 13:04:47,090 [INFO]: 	>>> Finished "Creating the index" in 91.4533 secs
2025-03-13 13:04:47,090 [INFO]: >>> Finished "Launching the whole pipeline" in 91.5004 secs
2025-03-13 13:04:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:04:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 80740 [episode count 14/20]
[retrieval_preprocessing] for episode 33703 [episode count 15/20], we have num_retrieval=np.int64(4596) num_query=np.int64(326)
2025-03-13 13:04:50,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:50,691 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:50
2025-03-13 13:04:50,692 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.09it/s]
2025-03-13 13:04:50,724 [INFO]: There are 4596 embeddings of dim 49152
2025-03-13 13:04:50,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 13:04:50,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:50,725 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 13:04:50,725 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:04:50,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:04:50,725 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,725 [INFO]: 948.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:50,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:04:50,725 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:50
2025-03-13 13:04:50,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:50,725 [INFO]: 	Creating the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,725 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:04:50
2025-03-13 13:04:50,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:04:50,726 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,726 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:04:50,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.56it/s] 37%|███▋      | 7/19 [00:00<00:00, 32.35it/s] 68%|██████▊   | 13/19 [00:00<00:00, 40.26it/s] 95%|█████████▍| 18/19 [00:00<00:00, 42.63it/s]100%|██████████| 19/19 [00:04<00:00,  3.84it/s]
2025-03-13 13:04:55,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:04:55
2025-03-13 13:05:41,290 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6097 secs
2025-03-13 13:05:41,291 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 13:05:41,291 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 13:06:07,332 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0409 secs
2025-03-13 13:06:07,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.6089 secs
2025-03-13 13:06:07,335 [INFO]: {
2025-03-13 13:06:07,335 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:07,335 [INFO]: 	index_param: efSearch=228
2025-03-13 13:06:07,335 [INFO]: 	index_path: knn.index
2025-03-13 13:06:07,335 [INFO]: 	size in bytes: 904235350
2025-03-13 13:06:07,335 [INFO]: 	avg_search_speed_ms: 9.887416512758762
2025-03-13 13:06:07,335 [INFO]: 	99p_search_speed_ms: 12.59830045280978
2025-03-13 13:06:07,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:07,335 [INFO]: 	nb vectors: 4596
2025-03-13 13:06:07,335 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:07,335 [INFO]: 	compression ratio: 0.9993088281717807
2025-03-13 13:06:07,335 [INFO]: }
2025-03-13 13:06:07,335 [INFO]: 	>>> Finished "Creating the index" in 76.6102 secs
2025-03-13 13:06:07,335 [INFO]: >>> Finished "Launching the whole pipeline" in 76.6434 secs
2025-03-13 13:06:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 33703 [episode count 15/20]
[retrieval_preprocessing] for episode 66474 [episode count 16/20], we have num_retrieval=np.int64(4635) num_query=np.int64(287)
2025-03-13 13:06:11,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:12,204 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:12
2025-03-13 13:06:12,204 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1860.83it/s]
2025-03-13 13:06:12,240 [INFO]: There are 4635 embeddings of dim 49152
2025-03-13 13:06:12,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 13:06:12,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:12,240 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 13:06:12,240 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:12,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:06:12,240 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,240 [INFO]: 956.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:12,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:06:12,240 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:12
2025-03-13 13:06:12,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:12,240 [INFO]: 	Creating the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,240 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:12
2025-03-13 13:06:12,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:06:12,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:12
2025-03-13 13:06:12,241 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:06:12,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.39it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.60it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.41it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.89it/s]100%|██████████| 19/19 [00:03<00:00,  4.94it/s]
2025-03-13 13:06:16,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:16
2025-03-13 13:06:55,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9540 secs
2025-03-13 13:06:55,048 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 13:06:55,048 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.92it/s]
2025-03-13 13:07:17,291 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2423 secs
2025-03-13 13:07:17,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0531 secs
2025-03-13 13:07:17,295 [INFO]: {
2025-03-13 13:07:17,295 [INFO]: 	index_key: HNSW15
2025-03-13 13:07:17,295 [INFO]: 	index_param: efSearch=224
2025-03-13 13:07:17,295 [INFO]: 	index_path: knn.index
2025-03-13 13:07:17,295 [INFO]: 	size in bytes: 911908390
2025-03-13 13:07:17,295 [INFO]: 	avg_search_speed_ms: 12.024379086002368
2025-03-13 13:07:17,295 [INFO]: 	99p_search_speed_ms: 18.26899419073015
2025-03-13 13:07:17,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:17,295 [INFO]: 	nb vectors: 4635
2025-03-13 13:07:17,295 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:17,295 [INFO]: 	compression ratio: 0.9993088011834171
2025-03-13 13:07:17,295 [INFO]: }
2025-03-13 13:07:17,295 [INFO]: 	>>> Finished "Creating the index" in 65.0547 secs
2025-03-13 13:07:17,295 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0907 secs
2025-03-13 13:07:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 66474 [episode count 16/20]
[retrieval_preprocessing] for episode 59784 [episode count 17/20], we have num_retrieval=np.int64(4682) num_query=np.int64(240)
2025-03-13 13:07:20,913 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:21,731 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:21
2025-03-13 13:07:21,731 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1505.49it/s]
2025-03-13 13:07:21,766 [INFO]: There are 4682 embeddings of dim 49152
2025-03-13 13:07:21,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 13:07:21,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:21
2025-03-13 13:07:21,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:21,767 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:07:21,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:07:21,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:07:21,768 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:21
2025-03-13 13:07:21,768 [INFO]: 966.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:21,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:07:21,768 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:21
2025-03-13 13:07:21,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:21,768 [INFO]: 	Creating the index 03/13/2025, 13:07:21
2025-03-13 13:07:21,768 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:07:21
2025-03-13 13:07:21,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 13:07:21,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:21
2025-03-13 13:07:21,771 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:07:21,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.69it/s] 26%|██▋       | 5/19 [00:00<00:00, 25.28it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.85it/s] 89%|████████▉ | 17/19 [00:00<00:00, 43.80it/s]100%|██████████| 19/19 [00:04<00:00,  4.04it/s]
2025-03-13 13:07:26,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:26
2025-03-13 13:08:13,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2814 secs
2025-03-13 13:08:13,756 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 13:08:13,756 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 13:08:34,628 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8719 secs
2025-03-13 13:08:34,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8595 secs
2025-03-13 13:08:34,631 [INFO]: {
2025-03-13 13:08:34,631 [INFO]: 	index_key: HNSW15
2025-03-13 13:08:34,631 [INFO]: 	index_param: efSearch=232
2025-03-13 13:08:34,631 [INFO]: 	index_path: knn.index
2025-03-13 13:08:34,631 [INFO]: 	size in bytes: 921155410
2025-03-13 13:08:34,631 [INFO]: 	avg_search_speed_ms: 10.622573610110457
2025-03-13 13:08:34,631 [INFO]: 	99p_search_speed_ms: 15.158960968255998
2025-03-13 13:08:34,631 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:34,631 [INFO]: 	nb vectors: 4682
2025-03-13 13:08:34,631 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:34,631 [INFO]: 	compression ratio: 0.9993087442215641
2025-03-13 13:08:34,631 [INFO]: }
2025-03-13 13:08:34,631 [INFO]: 	>>> Finished "Creating the index" in 72.8628 secs
2025-03-13 13:08:34,631 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9002 secs
2025-03-13 13:08:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 59784 [episode count 17/20]
[retrieval_preprocessing] for episode 59818 [episode count 18/20], we have num_retrieval=np.int64(4664) num_query=np.int64(258)
2025-03-13 13:08:37,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:38,033 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:38
2025-03-13 13:08:38,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2263.52it/s]
2025-03-13 13:08:38,066 [INFO]: There are 4664 embeddings of dim 49152
2025-03-13 13:08:38,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 13:08:38,066 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:38
2025-03-13 13:08:38,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:38,066 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:08:38,066 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:08:38,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:08:38,066 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:38
2025-03-13 13:08:38,067 [INFO]: 962.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:38,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:08:38,067 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:38
2025-03-13 13:08:38,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:38,067 [INFO]: 	Creating the index 03/13/2025, 13:08:38
2025-03-13 13:08:38,067 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:08:38
2025-03-13 13:08:38,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:08:38,068 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:38
2025-03-13 13:08:38,068 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:08:38,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.60it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.57it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.05it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.61it/s]100%|██████████| 19/19 [00:03<00:00,  4.83it/s]
2025-03-13 13:08:42,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:42
2025-03-13 13:09:22,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6780 secs
2025-03-13 13:09:22,684 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 13:09:22,684 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-13 13:09:39,506 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8227 secs
2025-03-13 13:09:40,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9651 secs
2025-03-13 13:09:40,033 [INFO]: {
2025-03-13 13:09:40,033 [INFO]: 	index_key: HNSW15
2025-03-13 13:09:40,033 [INFO]: 	index_param: efSearch=249
2025-03-13 13:09:40,034 [INFO]: 	index_path: knn.index
2025-03-13 13:09:40,034 [INFO]: 	size in bytes: 917614030
2025-03-13 13:09:40,034 [INFO]: 	avg_search_speed_ms: 10.699078468556072
2025-03-13 13:09:40,034 [INFO]: 	99p_search_speed_ms: 16.387863596901283
2025-03-13 13:09:40,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:40,034 [INFO]: 	nb vectors: 4664
2025-03-13 13:09:40,034 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:40,034 [INFO]: 	compression ratio: 0.9993087311448365
2025-03-13 13:09:40,034 [INFO]: }
2025-03-13 13:09:40,034 [INFO]: 	>>> Finished "Creating the index" in 61.9673 secs
2025-03-13 13:09:40,034 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0011 secs
2025-03-13 13:09:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 59818 [episode count 18/20]
[retrieval_preprocessing] for episode 34090 [episode count 19/20], we have num_retrieval=np.int64(4714) num_query=np.int64(208)
2025-03-13 13:09:43,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:09:43,766 [INFO]: Launching the whole pipeline 03/13/2025, 13:09:43
2025-03-13 13:09:43,767 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:09:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-13 13:09:43,803 [INFO]: There are 4714 embeddings of dim 49152
2025-03-13 13:09:43,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 13:09:43,804 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:09:43,804 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 13:09:43,804 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:09:43,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:09:43,805 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,805 [INFO]: 972.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:09:43,805 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:09:43,806 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:09:43
2025-03-13 13:09:43,806 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:09:43,806 [INFO]: 	Creating the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,806 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:09:43
2025-03-13 13:09:43,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:09:43,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,809 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 13:09:43,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 25.54it/s] 47%|████▋     | 9/19 [00:00<00:00, 42.41it/s] 79%|███████▉  | 15/19 [00:00<00:00, 48.22it/s]100%|██████████| 19/19 [00:03<00:00,  5.39it/s]
2025-03-13 13:09:47,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:09:47
2025-03-13 13:10:24,940 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5985 secs
2025-03-13 13:10:24,940 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 13:10:24,940 [INFO]: 	Compute fast metrics 03/13/2025, 13:10:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.70it/s]
2025-03-13 13:10:47,604 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6637 secs
2025-03-13 13:10:47,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1066 secs
2025-03-13 13:10:47,916 [INFO]: {
2025-03-13 13:10:47,916 [INFO]: 	index_key: HNSW15
2025-03-13 13:10:47,916 [INFO]: 	index_param: efSearch=209
2025-03-13 13:10:47,916 [INFO]: 	index_path: knn.index
2025-03-13 13:10:47,917 [INFO]: 	size in bytes: 927451330
2025-03-13 13:10:47,917 [INFO]: 	avg_search_speed_ms: 12.870748616345082
2025-03-13 13:10:47,917 [INFO]: 	99p_search_speed_ms: 19.409250738099217
2025-03-13 13:10:47,917 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:47,917 [INFO]: 	nb vectors: 4714
2025-03-13 13:10:47,917 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:47,917 [INFO]: 	compression ratio: 0.9993086235587155
2025-03-13 13:10:47,917 [INFO]: }
2025-03-13 13:10:47,917 [INFO]: 	>>> Finished "Creating the index" in 64.1111 secs
2025-03-13 13:10:47,917 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1505 secs
2025-03-13 13:10:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 34090 [episode count 19/20]
2025-03-13 13:10:50: [retrieval_preprocessing] finished for 1656877278_put_towel_in_bowl [chosen_id count 5/260]
2025-03-13 13:10:52: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_remove_can_from_bowl [chosen_id count 6/260]
2025-03-13 13:10:52: [retrieval_preprocessing] we have num_total=3994 embedding_dim=49152
[retrieval_preprocessing] for episode 22614 [episode count 0/20], we have num_retrieval=np.int64(3774) num_query=np.int64(220)
2025-03-13 13:10:52,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:54,044 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:54
2025-03-13 13:10:54,044 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.96it/s]
2025-03-13 13:10:54,078 [INFO]: There are 3774 embeddings of dim 49152
2025-03-13 13:10:54,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 13:10:54,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:54
2025-03-13 13:10:54,078 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:54,078 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:10:54,078 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:54,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:10:54,078 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:54
2025-03-13 13:10:54,078 [INFO]: 778.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:54,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:10:54,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:54
2025-03-13 13:10:54,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:54,078 [INFO]: 	Creating the index 03/13/2025, 13:10:54
2025-03-13 13:10:54,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:54
2025-03-13 13:10:54,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:10:54,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:54
2025-03-13 13:10:54,080 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:10:54,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.96it/s] 40%|████      | 6/15 [00:00<00:00, 30.82it/s] 80%|████████  | 12/15 [00:00<00:00, 41.06it/s]100%|██████████| 15/15 [00:03<00:00,  4.91it/s]
2025-03-13 13:10:57,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:57
2025-03-13 13:11:37,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1606 secs
2025-03-13 13:11:37,300 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 13:11:37,300 [INFO]: 	Compute fast metrics 03/13/2025, 13:11:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-13 13:11:56,821 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5208 secs
2025-03-13 13:11:56,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7435 secs
2025-03-13 13:11:56,823 [INFO]: {
2025-03-13 13:11:56,823 [INFO]: 	index_key: HNSW15
2025-03-13 13:11:56,823 [INFO]: 	index_param: efSearch=247
2025-03-13 13:11:56,823 [INFO]: 	index_path: knn.index
2025-03-13 13:11:56,823 [INFO]: 	size in bytes: 742511530
2025-03-13 13:11:56,823 [INFO]: 	avg_search_speed_ms: 11.046446577921328
2025-03-13 13:11:56,823 [INFO]: 	99p_search_speed_ms: 14.754372520837935
2025-03-13 13:11:56,823 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:11:56,823 [INFO]: 	nb vectors: 3774
2025-03-13 13:11:56,823 [INFO]: 	vectors dimension: 49152
2025-03-13 13:11:56,824 [INFO]: 	compression ratio: 0.9993091851381756
2025-03-13 13:11:56,824 [INFO]: }
2025-03-13 13:11:56,824 [INFO]: 	>>> Finished "Creating the index" in 62.7452 secs
2025-03-13 13:11:56,824 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7799 secs
2025-03-13 13:11:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:11:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 22614 [episode count 0/20]
[retrieval_preprocessing] for episode 82014 [episode count 1/20], we have num_retrieval=np.int64(3808) num_query=np.int64(186)
2025-03-13 13:11:59,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:11:59,797 [INFO]: Launching the whole pipeline 03/13/2025, 13:11:59
2025-03-13 13:11:59,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:11:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2228.64it/s]
2025-03-13 13:11:59,825 [INFO]: There are 3808 embeddings of dim 49152
2025-03-13 13:11:59,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 13:11:59,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:11:59
2025-03-13 13:11:59,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:11:59,826 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:11:59,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:11:59,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:11:59,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:11:59
2025-03-13 13:11:59,826 [INFO]: 785.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:11:59,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:11:59,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:11:59
2025-03-13 13:11:59,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:11:59,826 [INFO]: 	Creating the index 03/13/2025, 13:11:59
2025-03-13 13:11:59,826 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:11:59
2025-03-13 13:11:59,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:11:59,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:11:59
2025-03-13 13:11:59,827 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:11:59,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.20it/s] 40%|████      | 6/15 [00:00<00:00, 30.14it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.56it/s]100%|██████████| 15/15 [00:03<00:00,  3.38it/s]100%|██████████| 15/15 [00:03<00:00,  4.67it/s]
2025-03-13 13:12:03,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:12:03
2025-03-13 13:12:38,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5582 secs
2025-03-13 13:12:38,602 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 13:12:38,602 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.82it/s]
2025-03-13 13:13:01,925 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3237 secs
2025-03-13 13:13:01,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1004 secs
2025-03-13 13:13:01,928 [INFO]: {
2025-03-13 13:13:01,928 [INFO]: 	index_key: HNSW15
2025-03-13 13:13:01,928 [INFO]: 	index_param: efSearch=242
2025-03-13 13:13:01,928 [INFO]: 	index_path: knn.index
2025-03-13 13:13:01,928 [INFO]: 	size in bytes: 749200930
2025-03-13 13:13:01,928 [INFO]: 	avg_search_speed_ms: 9.991535362410735
2025-03-13 13:13:01,928 [INFO]: 	99p_search_speed_ms: 13.130514184013009
2025-03-13 13:13:01,928 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:01,928 [INFO]: 	nb vectors: 3808
2025-03-13 13:13:01,928 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:01,928 [INFO]: 	compression ratio: 0.9993090425021229
2025-03-13 13:13:01,928 [INFO]: }
2025-03-13 13:13:01,928 [INFO]: 	>>> Finished "Creating the index" in 62.1019 secs
2025-03-13 13:13:01,928 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1313 secs
2025-03-13 13:13:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 82014 [episode count 1/20]
[retrieval_preprocessing] for episode 12411 [episode count 2/20], we have num_retrieval=np.int64(3793) num_query=np.int64(201)
2025-03-13 13:13:04,102 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:05,191 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:05
2025-03-13 13:13:05,191 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.63it/s]
2025-03-13 13:13:05,221 [INFO]: There are 3793 embeddings of dim 49152
2025-03-13 13:13:05,222 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 13:13:05,222 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:05
2025-03-13 13:13:05,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:05,223 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:13:05,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:13:05,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 13:13:05,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:05
2025-03-13 13:13:05,224 [INFO]: 782.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:05,224 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:13:05,225 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:05
2025-03-13 13:13:05,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:05,225 [INFO]: 	Creating the index 03/13/2025, 13:13:05
2025-03-13 13:13:05,225 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:13:05
2025-03-13 13:13:05,229 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 13:13:05,229 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:05
2025-03-13 13:13:05,230 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:13:05,230 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.57it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.84it/s] 93%|█████████▎| 14/15 [00:00<00:00, 44.31it/s]100%|██████████| 15/15 [00:02<00:00,  5.20it/s]
2025-03-13 13:13:08,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:08
2025-03-13 13:13:48,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3820 secs
2025-03-13 13:13:48,502 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 13:13:48,502 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 13:14:03,775 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2731 secs
2025-03-13 13:14:03,778 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5486 secs
2025-03-13 13:14:03,778 [INFO]: {
2025-03-13 13:14:03,778 [INFO]: 	index_key: HNSW15
2025-03-13 13:14:03,778 [INFO]: 	index_param: efSearch=209
2025-03-13 13:14:03,778 [INFO]: 	index_path: knn.index
2025-03-13 13:14:03,778 [INFO]: 	size in bytes: 746249650
2025-03-13 13:14:03,778 [INFO]: 	avg_search_speed_ms: 9.926728582719253
2025-03-13 13:14:03,778 [INFO]: 	99p_search_speed_ms: 14.077803683467204
2025-03-13 13:14:03,778 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:03,778 [INFO]: 	nb vectors: 3793
2025-03-13 13:14:03,778 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:03,778 [INFO]: 	compression ratio: 0.999309204366126
2025-03-13 13:14:03,778 [INFO]: }
2025-03-13 13:14:03,778 [INFO]: 	>>> Finished "Creating the index" in 58.5532 secs
2025-03-13 13:14:03,778 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5876 secs
2025-03-13 13:14:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 12411 [episode count 2/20]
[retrieval_preprocessing] for episode 26773 [episode count 3/20], we have num_retrieval=np.int64(3828) num_query=np.int64(166)
2025-03-13 13:14:06,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:14:06,746 [INFO]: Launching the whole pipeline 03/13/2025, 13:14:06
2025-03-13 13:14:06,746 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:14:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.96it/s]
2025-03-13 13:14:06,774 [INFO]: There are 3828 embeddings of dim 49152
2025-03-13 13:14:06,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 13:14:06,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:14:06
2025-03-13 13:14:06,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:14:06,774 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:14:06,774 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:14:06,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:14:06,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:14:06
2025-03-13 13:14:06,774 [INFO]: 790.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:14:06,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:14:06,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:14:06
2025-03-13 13:14:06,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:14:06,775 [INFO]: 	Creating the index 03/13/2025, 13:14:06
2025-03-13 13:14:06,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:14:06
2025-03-13 13:14:06,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:14:06,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:14:06
2025-03-13 13:14:06,776 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:14:06,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.96it/s] 44%|████▍     | 7/16 [00:00<00:00, 37.72it/s] 81%|████████▏ | 13/16 [00:00<00:00, 46.46it/s]100%|██████████| 16/16 [00:02<00:00,  5.95it/s]
2025-03-13 13:14:09,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:14:09
2025-03-13 13:14:46,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2495 secs
2025-03-13 13:14:46,716 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 13:14:46,716 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.77it/s]
2025-03-13 13:15:09,358 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6419 secs
2025-03-13 13:15:09,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5847 secs
2025-03-13 13:15:09,361 [INFO]: {
2025-03-13 13:15:09,361 [INFO]: 	index_key: HNSW15
2025-03-13 13:15:09,361 [INFO]: 	index_param: efSearch=236
2025-03-13 13:15:09,361 [INFO]: 	index_path: knn.index
2025-03-13 13:15:09,361 [INFO]: 	size in bytes: 753135850
2025-03-13 13:15:09,361 [INFO]: 	avg_search_speed_ms: 13.08398249199967
2025-03-13 13:15:09,361 [INFO]: 	99p_search_speed_ms: 19.372024917975068
2025-03-13 13:15:09,361 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:15:09,361 [INFO]: 	nb vectors: 3828
2025-03-13 13:15:09,361 [INFO]: 	vectors dimension: 49152
2025-03-13 13:15:09,361 [INFO]: 	compression ratio: 0.9993089878804734
2025-03-13 13:15:09,361 [INFO]: }
2025-03-13 13:15:09,361 [INFO]: 	>>> Finished "Creating the index" in 62.5863 secs
2025-03-13 13:15:09,361 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6145 secs
2025-03-13 13:15:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 26773 [episode count 3/20]
[retrieval_preprocessing] for episode 66012 [episode count 4/20], we have num_retrieval=np.int64(3763) num_query=np.int64(231)
2025-03-13 13:15:11,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:11,634 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:11
2025-03-13 13:15:11,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.46it/s]
2025-03-13 13:15:11,668 [INFO]: There are 3763 embeddings of dim 49152
2025-03-13 13:15:11,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 13:15:11,668 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,669 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:11,669 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:15:11,669 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:15:11,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:15:11,669 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,670 [INFO]: 776.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:11,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:15:11,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:11
2025-03-13 13:15:11,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:11,671 [INFO]: 	Creating the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:15:11
2025-03-13 13:15:11,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 13:15:11,675 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:11
2025-03-13 13:15:11,675 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:15:11,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.90it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.63it/s] 80%|████████  | 12/15 [00:00<00:00, 39.85it/s]100%|██████████| 15/15 [00:03<00:00,  3.98it/s]
2025-03-13 13:15:15,452 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:15
2025-03-13 13:15:58,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5016 secs
2025-03-13 13:15:58,955 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 13:15:58,955 [INFO]: 	Compute fast metrics 03/13/2025, 13:15:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.05it/s]
2025-03-13 13:16:20,332 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3771 secs
2025-03-13 13:16:20,334 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6591 secs
2025-03-13 13:16:20,335 [INFO]: {
2025-03-13 13:16:20,335 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:20,335 [INFO]: 	index_param: efSearch=193
2025-03-13 13:16:20,335 [INFO]: 	index_path: knn.index
2025-03-13 13:16:20,335 [INFO]: 	size in bytes: 740347390
2025-03-13 13:16:20,335 [INFO]: 	avg_search_speed_ms: 8.643183741491535
2025-03-13 13:16:20,335 [INFO]: 	99p_search_speed_ms: 14.159791758283976
2025-03-13 13:16:20,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:20,335 [INFO]: 	nb vectors: 3763
2025-03-13 13:16:20,335 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:20,335 [INFO]: 	compression ratio: 0.9993091270302176
2025-03-13 13:16:20,335 [INFO]: }
2025-03-13 13:16:20,335 [INFO]: 	>>> Finished "Creating the index" in 68.6637 secs
2025-03-13 13:16:20,335 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7011 secs
2025-03-13 13:16:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 66012 [episode count 4/20]
[retrieval_preprocessing] for episode 62231 [episode count 5/20], we have num_retrieval=np.int64(3805) num_query=np.int64(189)
2025-03-13 13:16:22,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:23,082 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:23
2025-03-13 13:16:23,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1383.80it/s]
2025-03-13 13:16:23,112 [INFO]: There are 3805 embeddings of dim 49152
2025-03-13 13:16:23,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 13:16:23,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:23
2025-03-13 13:16:23,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:23,112 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:16:23,112 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:23,112 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:16:23,112 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:23
2025-03-13 13:16:23,113 [INFO]: 785.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:23,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:16:23,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:23
2025-03-13 13:16:23,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:23,113 [INFO]: 	Creating the index 03/13/2025, 13:16:23
2025-03-13 13:16:23,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:23
2025-03-13 13:16:23,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:16:23,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:23
2025-03-13 13:16:23,114 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:16:23,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.74it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.91it/s] 80%|████████  | 12/15 [00:00<00:00, 42.06it/s]100%|██████████| 15/15 [00:02<00:00,  5.19it/s]
2025-03-13 13:16:26,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:26
2025-03-13 13:17:03,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9283 secs
2025-03-13 13:17:03,472 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 13:17:03,472 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.37it/s]
2025-03-13 13:17:23,725 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2523 secs
2025-03-13 13:17:23,727 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6130 secs
2025-03-13 13:17:23,727 [INFO]: {
2025-03-13 13:17:23,727 [INFO]: 	index_key: HNSW15
2025-03-13 13:17:23,727 [INFO]: 	index_param: efSearch=164
2025-03-13 13:17:23,727 [INFO]: 	index_path: knn.index
2025-03-13 13:17:23,727 [INFO]: 	size in bytes: 748610650
2025-03-13 13:17:23,727 [INFO]: 	avg_search_speed_ms: 7.716399599887132
2025-03-13 13:17:23,727 [INFO]: 	99p_search_speed_ms: 10.394190566148609
2025-03-13 13:17:23,727 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:17:23,727 [INFO]: 	nb vectors: 3805
2025-03-13 13:17:23,727 [INFO]: 	vectors dimension: 49152
2025-03-13 13:17:23,727 [INFO]: 	compression ratio: 0.9993091068100621
2025-03-13 13:17:23,727 [INFO]: }
2025-03-13 13:17:23,727 [INFO]: 	>>> Finished "Creating the index" in 60.6144 secs
2025-03-13 13:17:23,727 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6454 secs
2025-03-13 13:17:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:17:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 62231 [episode count 5/20]
[retrieval_preprocessing] for episode 60185 [episode count 6/20], we have num_retrieval=np.int64(3744) num_query=np.int64(250)
2025-03-13 13:17:25,137 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:17:25,632 [INFO]: Launching the whole pipeline 03/13/2025, 13:17:25
2025-03-13 13:17:25,632 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:17:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.81it/s]
2025-03-13 13:17:25,660 [INFO]: There are 3744 embeddings of dim 49152
2025-03-13 13:17:25,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 13:17:25,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:17:25,660 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:17:25,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:17:25,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:17:25,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,661 [INFO]: 772.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:17:25,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:17:25,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:17:25
2025-03-13 13:17:25,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:17:25,661 [INFO]: 	Creating the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:17:25
2025-03-13 13:17:25,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:17:25,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:17:25
2025-03-13 13:17:25,662 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:17:25,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.87it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.33it/s] 87%|████████▋ | 13/15 [00:00<00:00, 41.40it/s]100%|██████████| 15/15 [00:03<00:00,  4.55it/s]
2025-03-13 13:17:28,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:28
2025-03-13 13:18:05,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0978 secs
2025-03-13 13:18:05,063 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 13:18:05,063 [INFO]: 	Compute fast metrics 03/13/2025, 13:18:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.41it/s]
2025-03-13 13:18:31,553 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4898 secs
2025-03-13 13:18:31,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8932 secs
2025-03-13 13:18:31,555 [INFO]: {
2025-03-13 13:18:31,555 [INFO]: 	index_key: HNSW15
2025-03-13 13:18:31,555 [INFO]: 	index_param: efSearch=194
2025-03-13 13:18:31,555 [INFO]: 	index_path: knn.index
2025-03-13 13:18:31,555 [INFO]: 	size in bytes: 736609210
2025-03-13 13:18:31,555 [INFO]: 	avg_search_speed_ms: 8.356362385574165
2025-03-13 13:18:31,555 [INFO]: 	99p_search_speed_ms: 13.139634123072026
2025-03-13 13:18:31,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:31,555 [INFO]: 	nb vectors: 3744
2025-03-13 13:18:31,555 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:31,555 [INFO]: 	compression ratio: 0.9993091886537775
2025-03-13 13:18:31,555 [INFO]: }
2025-03-13 13:18:31,555 [INFO]: 	>>> Finished "Creating the index" in 65.8945 secs
2025-03-13 13:18:31,555 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9232 secs
2025-03-13 13:18:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:18:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 60185 [episode count 6/20]
[retrieval_preprocessing] for episode 70399 [episode count 7/20], we have num_retrieval=np.int64(3800) num_query=np.int64(194)
2025-03-13 13:18:33,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:18:34,053 [INFO]: Launching the whole pipeline 03/13/2025, 13:18:34
2025-03-13 13:18:34,053 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:18:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1173.89it/s]
2025-03-13 13:18:34,081 [INFO]: There are 3800 embeddings of dim 49152
2025-03-13 13:18:34,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 13:18:34,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:18:34,081 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:18:34,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:18:34,081 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:18:34,081 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,081 [INFO]: 784.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:18:34,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:18:34,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:18:34
2025-03-13 13:18:34,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:18:34,082 [INFO]: 	Creating the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,082 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:18:34
2025-03-13 13:18:34,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:18:34,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:18:34
2025-03-13 13:18:34,083 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:18:34,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.53it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.52it/s] 80%|████████  | 12/15 [00:00<00:00, 39.67it/s]100%|██████████| 15/15 [00:03<00:00,  4.43it/s]
2025-03-13 13:18:37,470 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:18:37
2025-03-13 13:19:21,955 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4843 secs
2025-03-13 13:19:21,955 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 13:19:21,955 [INFO]: 	Compute fast metrics 03/13/2025, 13:19:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-13 13:19:43,550 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5944 secs
2025-03-13 13:19:43,553 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.4701 secs
2025-03-13 13:19:43,553 [INFO]: {
2025-03-13 13:19:43,553 [INFO]: 	index_key: HNSW15
2025-03-13 13:19:43,553 [INFO]: 	index_param: efSearch=169
2025-03-13 13:19:43,553 [INFO]: 	index_path: knn.index
2025-03-13 13:19:43,553 [INFO]: 	size in bytes: 747626830
2025-03-13 13:19:43,553 [INFO]: 	avg_search_speed_ms: 9.503195682498083
2025-03-13 13:19:43,553 [INFO]: 	99p_search_speed_ms: 13.695681523531675
2025-03-13 13:19:43,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:43,553 [INFO]: 	nb vectors: 3800
2025-03-13 13:19:43,553 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:43,553 [INFO]: 	compression ratio: 0.9993092409484555
2025-03-13 13:19:43,553 [INFO]: }
2025-03-13 13:19:43,553 [INFO]: 	>>> Finished "Creating the index" in 69.4716 secs
2025-03-13 13:19:43,553 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5000 secs
2025-03-13 13:19:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 70399 [episode count 7/20]
[retrieval_preprocessing] for episode 6916 [episode count 8/20], we have num_retrieval=np.int64(3761) num_query=np.int64(233)
2025-03-13 13:19:45,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:45,913 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:45
2025-03-13 13:19:45,913 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1540.32it/s]
2025-03-13 13:19:45,943 [INFO]: There are 3761 embeddings of dim 49152
2025-03-13 13:19:45,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 13:19:45,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:45
2025-03-13 13:19:45,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:45,943 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:19:45,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:19:45,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:19:45,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:45
2025-03-13 13:19:45,943 [INFO]: 776.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:45,944 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:19:45,944 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:45
2025-03-13 13:19:45,944 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:45,944 [INFO]: 	Creating the index 03/13/2025, 13:19:45
2025-03-13 13:19:45,944 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:19:45
2025-03-13 13:19:45,945 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:19:45,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:45
2025-03-13 13:19:45,945 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:19:45,945 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.52it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.46it/s] 87%|████████▋ | 13/15 [00:00<00:00, 45.65it/s]100%|██████████| 15/15 [00:03<00:00,  4.45it/s]
2025-03-13 13:19:49,323 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:49
2025-03-13 13:20:25,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3326 secs
2025-03-13 13:20:25,656 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 13:20:25,657 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-13 13:20:43,554 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8975 secs
2025-03-13 13:20:43,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6119 secs
2025-03-13 13:20:43,557 [INFO]: {
2025-03-13 13:20:43,557 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:43,557 [INFO]: 	index_param: efSearch=250
2025-03-13 13:20:43,557 [INFO]: 	index_path: knn.index
2025-03-13 13:20:43,557 [INFO]: 	size in bytes: 739953910
2025-03-13 13:20:43,557 [INFO]: 	avg_search_speed_ms: 10.555130340166798
2025-03-13 13:20:43,557 [INFO]: 	99p_search_speed_ms: 16.481311125680804
2025-03-13 13:20:43,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:43,557 [INFO]: 	nb vectors: 3761
2025-03-13 13:20:43,557 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:43,557 [INFO]: 	compression ratio: 0.9993091164286165
2025-03-13 13:20:43,557 [INFO]: }
2025-03-13 13:20:43,557 [INFO]: 	>>> Finished "Creating the index" in 57.6135 secs
2025-03-13 13:20:43,557 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6444 secs
2025-03-13 13:20:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 6916 [episode count 8/20]
[retrieval_preprocessing] for episode 45434 [episode count 9/20], we have num_retrieval=np.int64(3834) num_query=np.int64(160)
2025-03-13 13:20:46,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:47,311 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:47
2025-03-13 13:20:47,311 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.86it/s]
2025-03-13 13:20:47,347 [INFO]: There are 3834 embeddings of dim 49152
2025-03-13 13:20:47,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 13:20:47,348 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:47
2025-03-13 13:20:47,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:47,348 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:20:47,348 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:47,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:20:47,349 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:47
2025-03-13 13:20:47,349 [INFO]: 791.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:47,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:20:47,349 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:47
2025-03-13 13:20:47,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:47,350 [INFO]: 	Creating the index 03/13/2025, 13:20:47
2025-03-13 13:20:47,350 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:47
2025-03-13 13:20:47,353 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:20:47,353 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:47
2025-03-13 13:20:47,353 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:20:47,353 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.88it/s] 50%|█████     | 8/16 [00:00<00:00, 40.25it/s] 88%|████████▊ | 14/16 [00:00<00:00, 46.22it/s]100%|██████████| 16/16 [00:02<00:00,  5.48it/s]
2025-03-13 13:20:50,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:20:50
2025-03-13 13:21:27,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4537 secs
2025-03-13 13:21:27,733 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 13:21:27,733 [INFO]: 	Compute fast metrics 03/13/2025, 13:21:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-13 13:21:48,010 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2773 secs
2025-03-13 13:21:48,013 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6603 secs
2025-03-13 13:21:48,014 [INFO]: {
2025-03-13 13:21:48,014 [INFO]: 	index_key: HNSW15
2025-03-13 13:21:48,014 [INFO]: 	index_param: efSearch=215
2025-03-13 13:21:48,014 [INFO]: 	index_path: knn.index
2025-03-13 13:21:48,014 [INFO]: 	size in bytes: 754316410
2025-03-13 13:21:48,014 [INFO]: 	avg_search_speed_ms: 11.446972032614665
2025-03-13 13:21:48,014 [INFO]: 	99p_search_speed_ms: 18.13257944770157
2025-03-13 13:21:48,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:48,014 [INFO]: 	nb vectors: 3834
2025-03-13 13:21:48,014 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:48,014 [INFO]: 	compression ratio: 0.9993088603229512
2025-03-13 13:21:48,014 [INFO]: }
2025-03-13 13:21:48,014 [INFO]: 	>>> Finished "Creating the index" in 60.6641 secs
2025-03-13 13:21:48,014 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7027 secs
2025-03-13 13:21:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 45434 [episode count 9/20]
[retrieval_preprocessing] for episode 33818 [episode count 10/20], we have num_retrieval=np.int64(3812) num_query=np.int64(182)
2025-03-13 13:21:50,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:50,722 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:50
2025-03-13 13:21:50,722 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1682.43it/s]
2025-03-13 13:21:50,758 [INFO]: There are 3812 embeddings of dim 49152
2025-03-13 13:21:50,758 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 13:21:50,759 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:50
2025-03-13 13:21:50,759 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:50,759 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:21:50,759 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:21:50,759 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:21:50,760 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:50
2025-03-13 13:21:50,760 [INFO]: 786.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:50,760 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:21:50,761 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:50
2025-03-13 13:21:50,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:50,761 [INFO]: 	Creating the index 03/13/2025, 13:21:50
2025-03-13 13:21:50,761 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:50
2025-03-13 13:21:50,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 13:21:50,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:50
2025-03-13 13:21:50,765 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:21:50,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.91it/s] 31%|███▏      | 5/16 [00:00<00:00, 27.35it/s] 62%|██████▎   | 10/16 [00:00<00:00, 33.89it/s] 94%|█████████▍| 15/16 [00:00<00:00, 36.55it/s]100%|██████████| 16/16 [00:03<00:00,  5.03it/s]
2025-03-13 13:21:53,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:53
2025-03-13 13:22:34,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1103 secs
2025-03-13 13:22:34,063 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 13:22:34,063 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-13 13:22:52,440 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3768 secs
2025-03-13 13:22:52,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8509 secs
2025-03-13 13:22:52,616 [INFO]: {
2025-03-13 13:22:52,616 [INFO]: 	index_key: HNSW15
2025-03-13 13:22:52,616 [INFO]: 	index_param: efSearch=253
2025-03-13 13:22:52,616 [INFO]: 	index_path: knn.index
2025-03-13 13:22:52,616 [INFO]: 	size in bytes: 749987890
2025-03-13 13:22:52,616 [INFO]: 	avg_search_speed_ms: 11.402016301971766
2025-03-13 13:22:52,616 [INFO]: 	99p_search_speed_ms: 23.373222034424547
2025-03-13 13:22:52,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:52,616 [INFO]: 	nb vectors: 3812
2025-03-13 13:22:52,616 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:52,616 [INFO]: 	compression ratio: 0.9993090635103454
2025-03-13 13:22:52,616 [INFO]: }
2025-03-13 13:22:52,616 [INFO]: 	>>> Finished "Creating the index" in 61.8553 secs
2025-03-13 13:22:52,616 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8940 secs
2025-03-13 13:22:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:22:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 33818 [episode count 10/20]
[retrieval_preprocessing] for episode 58517 [episode count 11/20], we have num_retrieval=np.int64(3801) num_query=np.int64(193)
2025-03-13 13:22:56,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:58,421 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:58
2025-03-13 13:22:58,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.97it/s]
2025-03-13 13:22:58,467 [INFO]: There are 3801 embeddings of dim 49152
2025-03-13 13:22:58,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0459 secs
2025-03-13 13:22:58,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:58,469 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:22:58,469 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:22:58,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:22:58,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,470 [INFO]: 784.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:58,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 13:22:58,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:58
2025-03-13 13:22:58,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:22:58,471 [INFO]: 	Creating the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,471 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:22:58
2025-03-13 13:22:58,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 13:22:58,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,474 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:22:58,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.92it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.28it/s] 20%|██        | 3/15 [00:00<00:01,  6.79it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.05it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.33it/s] 40%|████      | 6/15 [00:00<00:01,  8.03it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.39it/s] 60%|██████    | 9/15 [00:01<00:00,  9.37it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.79it/s] 80%|████████  | 12/15 [00:01<00:00,  9.62it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.26it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.14it/s]100%|██████████| 15/15 [00:05<00:00,  1.16s/it]100%|██████████| 15/15 [00:05<00:00,  2.64it/s]
2025-03-13 13:23:04,167 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:04
2025-03-13 13:23:42,703 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5353 secs
2025-03-13 13:23:42,704 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 13:23:42,704 [INFO]: 	Compute fast metrics 03/13/2025, 13:23:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 13:24:04,212 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5082 secs
2025-03-13 13:24:04,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7407 secs
2025-03-13 13:24:04,215 [INFO]: {
2025-03-13 13:24:04,215 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:04,215 [INFO]: 	index_param: efSearch=265
2025-03-13 13:24:04,215 [INFO]: 	index_path: knn.index
2025-03-13 13:24:04,215 [INFO]: 	size in bytes: 747823570
2025-03-13 13:24:04,215 [INFO]: 	avg_search_speed_ms: 10.537761315071387
2025-03-13 13:24:04,215 [INFO]: 	99p_search_speed_ms: 15.15987493097782
2025-03-13 13:24:04,215 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:04,215 [INFO]: 	nb vectors: 3801
2025-03-13 13:24:04,215 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:04,215 [INFO]: 	compression ratio: 0.9993092461635035
2025-03-13 13:24:04,215 [INFO]: }
2025-03-13 13:24:04,215 [INFO]: 	>>> Finished "Creating the index" in 65.7442 secs
2025-03-13 13:24:04,215 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7933 secs
2025-03-13 13:24:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 58517 [episode count 11/20]
[retrieval_preprocessing] for episode 76972 [episode count 12/20], we have num_retrieval=np.int64(3834) num_query=np.int64(160)
2025-03-13 13:24:07,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:07,603 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:07
2025-03-13 13:24:07,603 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2216.86it/s]
2025-03-13 13:24:07,627 [INFO]: There are 3834 embeddings of dim 49152
2025-03-13 13:24:07,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 13:24:07,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:07,628 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:24:07,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:07,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:24:07,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,628 [INFO]: 791.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:07,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:24:07,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:07
2025-03-13 13:24:07,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:07,628 [INFO]: 	Creating the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:07
2025-03-13 13:24:07,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:24:07,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,629 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:24:07,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.60it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.85it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.99it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.63it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.06it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.93it/s] 81%|████████▏ | 13/16 [00:01<00:00, 13.09it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.12it/s]100%|██████████| 16/16 [00:03<00:00,  4.19it/s]
2025-03-13 13:24:11,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:11
2025-03-13 13:24:45,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8802 secs
2025-03-13 13:24:45,329 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 13:24:45,329 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.69it/s] 50%|█████     | 2/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.96it/s]
2025-03-13 13:25:03,007 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6783 secs
2025-03-13 13:25:03,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3810 secs
2025-03-13 13:25:03,010 [INFO]: {
2025-03-13 13:25:03,010 [INFO]: 	index_key: HNSW15
2025-03-13 13:25:03,010 [INFO]: 	index_param: efSearch=272
2025-03-13 13:25:03,010 [INFO]: 	index_path: knn.index
2025-03-13 13:25:03,010 [INFO]: 	size in bytes: 754316410
2025-03-13 13:25:03,010 [INFO]: 	avg_search_speed_ms: 10.399736905724135
2025-03-13 13:25:03,010 [INFO]: 	99p_search_speed_ms: 15.904398337006567
2025-03-13 13:25:03,010 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:25:03,010 [INFO]: 	nb vectors: 3834
2025-03-13 13:25:03,010 [INFO]: 	vectors dimension: 49152
2025-03-13 13:25:03,010 [INFO]: 	compression ratio: 0.9993088603229512
2025-03-13 13:25:03,010 [INFO]: }
2025-03-13 13:25:03,010 [INFO]: 	>>> Finished "Creating the index" in 55.3824 secs
2025-03-13 13:25:03,011 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4072 secs
2025-03-13 13:25:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:25:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 76972 [episode count 12/20]
[retrieval_preprocessing] for episode 5566 [episode count 13/20], we have num_retrieval=np.int64(3783) num_query=np.int64(211)
2025-03-13 13:25:06,067 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:25:06,553 [INFO]: Launching the whole pipeline 03/13/2025, 13:25:06
2025-03-13 13:25:06,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:25:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2290.72it/s]
2025-03-13 13:25:06,579 [INFO]: There are 3783 embeddings of dim 49152
2025-03-13 13:25:06,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 13:25:06,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:25:06
2025-03-13 13:25:06,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:25:06,580 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:25:06,580 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:25:06,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:25:06,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:25:06
2025-03-13 13:25:06,580 [INFO]: 780.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:25:06,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:25:06,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:25:06
2025-03-13 13:25:06,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:25:06,580 [INFO]: 	Creating the index 03/13/2025, 13:25:06
2025-03-13 13:25:06,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:25:06
2025-03-13 13:25:06,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:25:06,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:25:06
2025-03-13 13:25:06,581 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:25:06,581 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.60it/s] 20%|██        | 3/15 [00:00<00:01, 10.18it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.50it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.01it/s] 60%|██████    | 9/15 [00:00<00:00, 12.28it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.56it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.60it/s]100%|██████████| 15/15 [00:03<00:00,  1.91it/s]100%|██████████| 15/15 [00:03<00:00,  3.75it/s]
2025-03-13 13:25:10,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:10
2025-03-13 13:25:45,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4382 secs
2025-03-13 13:25:45,029 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 13:25:45,029 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 13:26:03,719 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6901 secs
2025-03-13 13:26:03,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1614 secs
2025-03-13 13:26:03,743 [INFO]: {
2025-03-13 13:26:03,743 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:03,743 [INFO]: 	index_param: efSearch=258
2025-03-13 13:26:03,743 [INFO]: 	index_path: knn.index
2025-03-13 13:26:03,743 [INFO]: 	size in bytes: 744282190
2025-03-13 13:26:03,743 [INFO]: 	avg_search_speed_ms: 10.034931846030258
2025-03-13 13:26:03,743 [INFO]: 	99p_search_speed_ms: 14.641063176095482
2025-03-13 13:26:03,743 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:03,743 [INFO]: 	nb vectors: 3783
2025-03-13 13:26:03,743 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:03,743 [INFO]: 	compression ratio: 0.9993092324297052
2025-03-13 13:26:03,743 [INFO]: }
2025-03-13 13:26:03,743 [INFO]: 	>>> Finished "Creating the index" in 57.1635 secs
2025-03-13 13:26:03,743 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1898 secs
2025-03-13 13:26:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 5566 [episode count 13/20]
[retrieval_preprocessing] for episode 93561 [episode count 14/20], we have num_retrieval=np.int64(3783) num_query=np.int64(211)
2025-03-13 13:26:07,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:07,941 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:07
2025-03-13 13:26:07,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.91it/s]
2025-03-13 13:26:07,965 [INFO]: There are 3783 embeddings of dim 49152
2025-03-13 13:26:07,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 13:26:07,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:07
2025-03-13 13:26:07,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:07,966 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:26:07,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:26:07,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:26:07,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:07
2025-03-13 13:26:07,966 [INFO]: 780.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:07,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:26:07,966 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:07
2025-03-13 13:26:07,966 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:07,966 [INFO]: 	Creating the index 03/13/2025, 13:26:07
2025-03-13 13:26:07,966 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:07
2025-03-13 13:26:07,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:26:07,967 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:07
2025-03-13 13:26:07,967 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:26:07,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.55it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.16it/s] 20%|██        | 3/15 [00:00<00:01,  7.90it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.34it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.68it/s] 40%|████      | 6/15 [00:00<00:01,  8.97it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.04it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.68it/s] 60%|██████    | 9/15 [00:01<00:00,  8.47it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.19it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.30it/s] 80%|████████  | 12/15 [00:01<00:00,  8.22it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.18it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.34it/s]100%|██████████| 15/15 [00:04<00:00,  1.02it/s]100%|██████████| 15/15 [00:04<00:00,  3.21it/s]
2025-03-13 13:26:12,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:12
2025-03-13 13:26:53,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8039 secs
2025-03-13 13:26:53,450 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 13:26:53,450 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s]
2025-03-13 13:27:12,154 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7044 secs
2025-03-13 13:27:12,157 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1903 secs
2025-03-13 13:27:12,158 [INFO]: {
2025-03-13 13:27:12,158 [INFO]: 	index_key: HNSW15
2025-03-13 13:27:12,158 [INFO]: 	index_param: efSearch=231
2025-03-13 13:27:12,158 [INFO]: 	index_path: knn.index
2025-03-13 13:27:12,158 [INFO]: 	size in bytes: 744282190
2025-03-13 13:27:12,158 [INFO]: 	avg_search_speed_ms: 11.635930086860089
2025-03-13 13:27:12,158 [INFO]: 	99p_search_speed_ms: 23.437813348136785
2025-03-13 13:27:12,158 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:27:12,158 [INFO]: 	nb vectors: 3783
2025-03-13 13:27:12,158 [INFO]: 	vectors dimension: 49152
2025-03-13 13:27:12,158 [INFO]: 	compression ratio: 0.9993092324297052
2025-03-13 13:27:12,158 [INFO]: }
2025-03-13 13:27:12,158 [INFO]: 	>>> Finished "Creating the index" in 64.1919 secs
2025-03-13 13:27:12,158 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2165 secs
2025-03-13 13:27:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:27:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 93561 [episode count 14/20]
[retrieval_preprocessing] for episode 81393 [episode count 15/20], we have num_retrieval=np.int64(3773) num_query=np.int64(221)
2025-03-13 13:27:15,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:27:16,441 [INFO]: Launching the whole pipeline 03/13/2025, 13:27:16
2025-03-13 13:27:16,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:27:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.81it/s]
2025-03-13 13:27:16,469 [INFO]: There are 3773 embeddings of dim 49152
2025-03-13 13:27:16,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 13:27:16,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:27:16
2025-03-13 13:27:16,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:27:16,471 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:27:16,471 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:27:16,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:27:16,471 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:27:16
2025-03-13 13:27:16,471 [INFO]: 778.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:27:16,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:27:16,472 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:27:16
2025-03-13 13:27:16,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:27:16,472 [INFO]: 	Creating the index 03/13/2025, 13:27:16
2025-03-13 13:27:16,472 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:27:16
2025-03-13 13:27:16,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 13:27:16,476 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:27:16
2025-03-13 13:27:16,476 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:27:16,476 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.91it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.26it/s] 20%|██        | 3/15 [00:00<00:01,  6.84it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.09it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.52it/s] 40%|████      | 6/15 [00:00<00:01,  7.93it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.21it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.36it/s] 60%|██████    | 9/15 [00:01<00:00,  8.10it/s] 67%|██████▋   | 10/15 [00:01<00:00,  7.96it/s] 73%|███████▎  | 11/15 [00:01<00:00,  7.85it/s] 80%|████████  | 12/15 [00:01<00:00,  7.91it/s] 87%|████████▋ | 13/15 [00:01<00:00,  7.89it/s] 93%|█████████▎| 14/15 [00:01<00:00,  7.90it/s]100%|██████████| 15/15 [00:05<00:00,  1.16s/it]100%|██████████| 15/15 [00:05<00:00,  2.79it/s]
2025-03-13 13:27:21,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:21
2025-03-13 13:27:56,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3960 secs
2025-03-13 13:27:56,264 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 13:27:56,264 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 13:28:18,201 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9369 secs
2025-03-13 13:28:18,203 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7271 secs
2025-03-13 13:28:18,203 [INFO]: {
2025-03-13 13:28:18,203 [INFO]: 	index_key: HNSW15
2025-03-13 13:28:18,203 [INFO]: 	index_param: efSearch=279
2025-03-13 13:28:18,203 [INFO]: 	index_path: knn.index
2025-03-13 13:28:18,203 [INFO]: 	size in bytes: 742314790
2025-03-13 13:28:18,203 [INFO]: 	avg_search_speed_ms: 10.914609678024549
2025-03-13 13:28:18,203 [INFO]: 	99p_search_speed_ms: 15.243103750981394
2025-03-13 13:28:18,203 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:28:18,203 [INFO]: 	nb vectors: 3773
2025-03-13 13:28:18,203 [INFO]: 	vectors dimension: 49152
2025-03-13 13:28:18,203 [INFO]: 	compression ratio: 0.9993091798696345
2025-03-13 13:28:18,203 [INFO]: }
2025-03-13 13:28:18,203 [INFO]: 	>>> Finished "Creating the index" in 61.7312 secs
2025-03-13 13:28:18,203 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7625 secs
2025-03-13 13:28:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:28:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 81393 [episode count 15/20]
[retrieval_preprocessing] for episode 36402 [episode count 16/20], we have num_retrieval=np.int64(3791) num_query=np.int64(203)
2025-03-13 13:28:22,206 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:28:22,783 [INFO]: Launching the whole pipeline 03/13/2025, 13:28:22
2025-03-13 13:28:22,783 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:28:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1695.35it/s]
2025-03-13 13:28:22,806 [INFO]: There are 3791 embeddings of dim 49152
2025-03-13 13:28:22,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 13:28:22,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:28:22
2025-03-13 13:28:22,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:28:22,807 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:28:22,807 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:28:22,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:28:22,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:28:22
2025-03-13 13:28:22,807 [INFO]: 782.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:28:22,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:28:22,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:28:22
2025-03-13 13:28:22,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:28:22,807 [INFO]: 	Creating the index 03/13/2025, 13:28:22
2025-03-13 13:28:22,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:28:22
2025-03-13 13:28:22,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:28:22,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:28:22
2025-03-13 13:28:22,808 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:28:22,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.28it/s] 20%|██        | 3/15 [00:00<00:01, 11.97it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.81it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.25it/s] 60%|██████    | 9/15 [00:00<00:00, 11.90it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.61it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.59it/s]100%|██████████| 15/15 [00:04<00:00,  1.60it/s]100%|██████████| 15/15 [00:04<00:00,  3.24it/s]
2025-03-13 13:28:27,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:28:27
2025-03-13 13:29:04,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6097 secs
2025-03-13 13:29:04,059 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 13:29:04,059 [INFO]: 	Compute fast metrics 03/13/2025, 13:29:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.11it/s]
2025-03-13 13:29:23,932 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8728 secs
2025-03-13 13:29:23,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1266 secs
2025-03-13 13:29:23,935 [INFO]: {
2025-03-13 13:29:23,935 [INFO]: 	index_key: HNSW15
2025-03-13 13:29:23,935 [INFO]: 	index_param: efSearch=238
2025-03-13 13:29:23,935 [INFO]: 	index_path: knn.index
2025-03-13 13:29:23,935 [INFO]: 	size in bytes: 745856170
2025-03-13 13:29:23,935 [INFO]: 	avg_search_speed_ms: 8.879716225633427
2025-03-13 13:29:23,935 [INFO]: 	99p_search_speed_ms: 11.872646980918944
2025-03-13 13:29:23,935 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:29:23,935 [INFO]: 	nb vectors: 3791
2025-03-13 13:29:23,935 [INFO]: 	vectors dimension: 49152
2025-03-13 13:29:23,935 [INFO]: 	compression ratio: 0.9993091938892186
2025-03-13 13:29:23,935 [INFO]: }
2025-03-13 13:29:23,935 [INFO]: 	>>> Finished "Creating the index" in 61.1279 secs
2025-03-13 13:29:23,935 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1521 secs
2025-03-13 13:29:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:29:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 36402 [episode count 16/20]
[retrieval_preprocessing] for episode 32499 [episode count 17/20], we have num_retrieval=np.int64(3775) num_query=np.int64(219)
2025-03-13 13:29:26,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:29:27,340 [INFO]: Launching the whole pipeline 03/13/2025, 13:29:27
2025-03-13 13:29:27,340 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:29:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2030.16it/s]
2025-03-13 13:29:27,372 [INFO]: There are 3775 embeddings of dim 49152
2025-03-13 13:29:27,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 13:29:27,373 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:29:27
2025-03-13 13:29:27,373 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:29:27,374 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 13:29:27,374 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:29:27,374 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:29:27,374 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:29:27
2025-03-13 13:29:27,374 [INFO]: 779.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:29:27,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:29:27,375 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:29:27
2025-03-13 13:29:27,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:29:27,375 [INFO]: 	Creating the index 03/13/2025, 13:29:27
2025-03-13 13:29:27,375 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:29:27
2025-03-13 13:29:27,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 13:29:27,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:29:27
2025-03-13 13:29:27,379 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 13:29:27,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.51it/s] 20%|██        | 3/15 [00:00<00:01, 10.22it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.86it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.47it/s] 60%|██████    | 9/15 [00:00<00:00, 12.71it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.90it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.29it/s]100%|██████████| 15/15 [00:04<00:00,  1.62it/s]100%|██████████| 15/15 [00:04<00:00,  3.29it/s]
2025-03-13 13:29:31,959 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:29:31
