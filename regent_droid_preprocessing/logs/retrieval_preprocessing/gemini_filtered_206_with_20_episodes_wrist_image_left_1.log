2025-03-13 14:35:00: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1526685371_marker_on_towel_fold_in_box [chosen_id count 0/196]
2025-03-13 14:35:09: [retrieval_preprocessing] we have num_total=7750 embedding_dim=49152
[retrieval_preprocessing] for episode 8705 [episode count 0/20], we have num_retrieval=np.int64(7428) num_query=np.int64(322)
2025-03-13 14:35:13,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:15,060 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:15
2025-03-13 14:35:15,060 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2734.23it/s]
2025-03-13 14:35:15,099 [INFO]: There are 7428 embeddings of dim 49152
2025-03-13 14:35:15,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0394 secs
2025-03-13 14:35:15,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:15
2025-03-13 14:35:15,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:15,100 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:35:15,100 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:15,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:35:15,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:15
2025-03-13 14:35:15,101 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:15,102 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0014 secs
2025-03-13 14:35:15,102 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:15
2025-03-13 14:35:15,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:15,102 [INFO]: 	Creating the index 03/13/2025, 14:35:15
2025-03-13 14:35:15,102 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:15
2025-03-13 14:35:15,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 14:35:15,105 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:15
2025-03-13 14:35:15,105 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:35:15,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.16it/s] 10%|▉         | 3/31 [00:00<00:02, 10.39it/s] 16%|█▌        | 5/31 [00:00<00:02, 10.93it/s] 23%|██▎       | 7/31 [00:00<00:01, 12.96it/s] 29%|██▉       | 9/31 [00:00<00:01, 12.62it/s] 35%|███▌      | 11/31 [00:00<00:01, 14.12it/s] 42%|████▏     | 13/31 [00:00<00:01, 15.15it/s] 48%|████▊     | 15/31 [00:01<00:01, 14.57it/s] 55%|█████▍    | 17/31 [00:01<00:00, 14.68it/s] 61%|██████▏   | 19/31 [00:01<00:00, 14.84it/s] 68%|██████▊   | 21/31 [00:05<00:07,  1.34it/s] 74%|███████▍  | 23/31 [00:06<00:04,  1.81it/s] 77%|███████▋  | 24/31 [00:06<00:03,  2.11it/s] 81%|████████  | 25/31 [00:06<00:02,  2.49it/s] 84%|████████▍ | 26/31 [00:06<00:01,  2.95it/s] 87%|████████▋ | 27/31 [00:06<00:01,  3.50it/s] 90%|█████████ | 28/31 [00:06<00:00,  4.10it/s] 94%|█████████▎| 29/31 [00:06<00:00,  4.77it/s] 97%|█████████▋| 30/31 [00:07<00:00,  5.44it/s]100%|██████████| 31/31 [00:09<00:00,  1.14it/s]100%|██████████| 31/31 [00:09<00:00,  3.21it/s]
2025-03-13 14:35:24,756 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:24
2025-03-13 14:36:41,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.2899 secs
2025-03-13 14:36:41,046 [INFO]: The best hyperparameters are: efSearch=93
2025-03-13 14:36:41,047 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
2025-03-13 14:37:03,276 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2293 secs
2025-03-13 14:37:03,278 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.1735 secs
2025-03-13 14:37:03,279 [INFO]: {
2025-03-13 14:37:03,279 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:03,279 [INFO]: 	index_param: efSearch=93
2025-03-13 14:37:03,279 [INFO]: 	index_path: knn.index
2025-03-13 14:37:03,279 [INFO]: 	size in bytes: 1461415270
2025-03-13 14:37:03,279 [INFO]: 	avg_search_speed_ms: 8.073314710176694
2025-03-13 14:37:03,279 [INFO]: 	99p_search_speed_ms: 13.567579425871358
2025-03-13 14:37:03,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:03,279 [INFO]: 	nb vectors: 7428
2025-03-13 14:37:03,279 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:03,279 [INFO]: 	compression ratio: 0.9993081733708722
2025-03-13 14:37:03,279 [INFO]: }
2025-03-13 14:37:03,279 [INFO]: 	>>> Finished "Creating the index" in 108.1768 secs
2025-03-13 14:37:03,279 [INFO]: >>> Finished "Launching the whole pipeline" in 108.2188 secs
2025-03-13 14:37:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 8705 [episode count 0/20]
[retrieval_preprocessing] for episode 3337 [episode count 1/20], we have num_retrieval=np.int64(7416) num_query=np.int64(334)
2025-03-13 14:37:06,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:07,587 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:07
2025-03-13 14:37:07,588 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1319.38it/s]
2025-03-13 14:37:07,620 [INFO]: There are 7416 embeddings of dim 49152
2025-03-13 14:37:07,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 14:37:07,620 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:07
2025-03-13 14:37:07,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:07,620 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:37:07,620 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:07,621 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:37:07,621 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:07
2025-03-13 14:37:07,621 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:07,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:07,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:07
2025-03-13 14:37:07,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:07,621 [INFO]: 	Creating the index 03/13/2025, 14:37:07
2025-03-13 14:37:07,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:07
2025-03-13 14:37:07,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:37:07,622 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:07
2025-03-13 14:37:07,623 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:37:07,623 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:05,  5.03it/s] 16%|█▌        | 5/31 [00:00<00:01, 18.28it/s] 29%|██▉       | 9/31 [00:00<00:00, 24.89it/s] 42%|████▏     | 13/31 [00:00<00:00, 28.66it/s] 55%|█████▍    | 17/31 [00:00<00:00, 30.44it/s] 68%|██████▊   | 21/31 [00:06<00:05,  2.00it/s] 81%|████████  | 25/31 [00:06<00:02,  2.93it/s] 97%|█████████▋| 30/31 [00:06<00:00,  4.52it/s]100%|██████████| 31/31 [00:09<00:00,  3.37it/s]
2025-03-13 14:37:16,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:16
2025-03-13 14:38:32,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.1708 secs
2025-03-13 14:38:33,000 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 14:38:33,000 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-13 14:38:48,345 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3448 secs
2025-03-13 14:38:48,347 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.7250 secs
2025-03-13 14:38:48,348 [INFO]: {
2025-03-13 14:38:48,348 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:48,348 [INFO]: 	index_param: efSearch=111
2025-03-13 14:38:48,348 [INFO]: 	index_path: knn.index
2025-03-13 14:38:48,348 [INFO]: 	size in bytes: 1459054210
2025-03-13 14:38:48,348 [INFO]: 	avg_search_speed_ms: 9.536477515173878
2025-03-13 14:38:48,348 [INFO]: 	99p_search_speed_ms: 14.416603269055482
2025-03-13 14:38:48,348 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:48,348 [INFO]: 	nb vectors: 7416
2025-03-13 14:38:48,348 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:48,348 [INFO]: 	compression ratio: 0.9993082628506311
2025-03-13 14:38:48,348 [INFO]: }
2025-03-13 14:38:48,348 [INFO]: 	>>> Finished "Creating the index" in 100.7269 secs
2025-03-13 14:38:48,348 [INFO]: >>> Finished "Launching the whole pipeline" in 100.7603 secs
2025-03-13 14:38:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 3337 [episode count 1/20]
[retrieval_preprocessing] for episode 55819 [episode count 2/20], we have num_retrieval=np.int64(7239) num_query=np.int64(511)
2025-03-13 14:38:51,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:52,366 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:52
2025-03-13 14:38:52,367 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1006.79it/s]
2025-03-13 14:38:52,664 [INFO]: There are 7239 embeddings of dim 49152
2025-03-13 14:38:52,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2974 secs
2025-03-13 14:38:52,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:52
2025-03-13 14:38:52,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:52,664 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 14:38:52,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:52,665 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:38:52,665 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:52
2025-03-13 14:38:52,665 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:52,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:38:52,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:52
2025-03-13 14:38:52,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:52,665 [INFO]: 	Creating the index 03/13/2025, 14:38:52
2025-03-13 14:38:52,665 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:52
2025-03-13 14:38:52,667 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 14:38:52,668 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:52
2025-03-13 14:38:52,668 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 14:38:52,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.88it/s] 17%|█▋        | 5/30 [00:00<00:00, 26.08it/s] 30%|███       | 9/30 [00:00<00:00, 31.17it/s] 47%|████▋     | 14/30 [00:00<00:00, 36.22it/s] 63%|██████▎   | 19/30 [00:00<00:00, 39.18it/s] 77%|███████▋  | 23/30 [00:06<00:03,  1.87it/s] 90%|█████████ | 27/30 [00:07<00:01,  2.65it/s]100%|██████████| 30/30 [00:10<00:00,  1.78it/s]100%|██████████| 30/30 [00:10<00:00,  2.87it/s]
2025-03-13 14:39:03,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:03
2025-03-13 14:40:16,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.3740 secs
2025-03-13 14:40:16,498 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 14:40:16,499 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:16
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]
2025-03-13 14:40:35,831 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3319 secs
2025-03-13 14:40:35,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.1647 secs
2025-03-13 14:40:35,833 [INFO]: {
2025-03-13 14:40:35,833 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:35,833 [INFO]: 	index_param: efSearch=114
2025-03-13 14:40:35,833 [INFO]: 	index_path: knn.index
2025-03-13 14:40:35,833 [INFO]: 	size in bytes: 1424230570
2025-03-13 14:40:35,833 [INFO]: 	avg_search_speed_ms: 8.460982818299883
2025-03-13 14:40:35,833 [INFO]: 	99p_search_speed_ms: 12.395425690338017
2025-03-13 14:40:35,833 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:35,833 [INFO]: 	nb vectors: 7239
2025-03-13 14:40:35,833 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:35,833 [INFO]: 	compression ratio: 0.9993082173485435
2025-03-13 14:40:35,833 [INFO]: }
2025-03-13 14:40:35,833 [INFO]: 	>>> Finished "Creating the index" in 103.1675 secs
2025-03-13 14:40:35,833 [INFO]: >>> Finished "Launching the whole pipeline" in 103.4662 secs
2025-03-13 14:40:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 55819 [episode count 2/20]
[retrieval_preprocessing] for episode 48526 [episode count 3/20], we have num_retrieval=np.int64(7324) num_query=np.int64(426)
2025-03-13 14:40:39,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:40,961 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:40
2025-03-13 14:40:40,961 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 925.28it/s]
2025-03-13 14:40:40,988 [INFO]: There are 7324 embeddings of dim 49152
2025-03-13 14:40:40,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 14:40:40,988 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:40
2025-03-13 14:40:40,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:40,988 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 14:40:40,988 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:40,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:40,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:40
2025-03-13 14:40:40,988 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:40,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:40:40,988 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:40
2025-03-13 14:40:40,989 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:40,989 [INFO]: 	Creating the index 03/13/2025, 14:40:40
2025-03-13 14:40:40,989 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:40
2025-03-13 14:40:40,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:40:40,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:40
2025-03-13 14:40:40,990 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 14:40:40,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.47it/s] 17%|█▋        | 5/30 [00:00<00:01, 24.03it/s] 33%|███▎      | 10/30 [00:00<00:00, 31.69it/s] 47%|████▋     | 14/30 [00:00<00:00, 33.99it/s] 60%|██████    | 18/30 [00:00<00:00, 35.63it/s] 73%|███████▎  | 22/30 [00:05<00:03,  2.21it/s] 90%|█████████ | 27/30 [00:05<00:00,  3.46it/s]100%|██████████| 30/30 [00:08<00:00,  3.47it/s]
2025-03-13 14:40:49,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:49
2025-03-13 14:41:47,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.2366 secs
2025-03-13 14:41:47,882 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 14:41:47,882 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.98it/s]
2025-03-13 14:42:16,013 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1309 secs
2025-03-13 14:42:16,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.0251 secs
2025-03-13 14:42:16,015 [INFO]: {
2025-03-13 14:42:16,015 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:16,015 [INFO]: 	index_param: efSearch=147
2025-03-13 14:42:16,015 [INFO]: 	index_path: knn.index
2025-03-13 14:42:16,015 [INFO]: 	size in bytes: 1440953830
2025-03-13 14:42:16,015 [INFO]: 	avg_search_speed_ms: 9.234536291699468
2025-03-13 14:42:16,015 [INFO]: 	99p_search_speed_ms: 12.750755962915719
2025-03-13 14:42:16,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:16,016 [INFO]: 	nb vectors: 7324
2025-03-13 14:42:16,016 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:16,016 [INFO]: 	compression ratio: 0.999308209618347
2025-03-13 14:42:16,016 [INFO]: }
2025-03-13 14:42:16,016 [INFO]: 	>>> Finished "Creating the index" in 95.0270 secs
2025-03-13 14:42:16,016 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0546 secs
2025-03-13 14:42:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 48526 [episode count 3/20]
[retrieval_preprocessing] for episode 88602 [episode count 4/20], we have num_retrieval=np.int64(7453) num_query=np.int64(297)
2025-03-13 14:42:19,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:20,545 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:20
2025-03-13 14:42:20,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1142.86it/s]
2025-03-13 14:42:20,574 [INFO]: There are 7453 embeddings of dim 49152
2025-03-13 14:42:20,575 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 14:42:20,575 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,575 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:20,575 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:42:20,575 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:20,575 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:42:20,575 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,575 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:20,575 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:42:20,575 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:20
2025-03-13 14:42:20,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:20,575 [INFO]: 	Creating the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,576 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:20
2025-03-13 14:42:20,576 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:42:20,577 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:20
2025-03-13 14:42:20,577 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:42:20,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  7.12it/s] 19%|█▉        | 6/31 [00:00<00:00, 25.92it/s] 35%|███▌      | 11/31 [00:00<00:00, 34.04it/s] 52%|█████▏    | 16/31 [00:00<00:00, 38.18it/s] 68%|██████▊   | 21/31 [00:05<00:03,  2.67it/s] 84%|████████▍ | 26/31 [00:05<00:01,  4.01it/s]100%|██████████| 31/31 [00:08<00:00,  2.66it/s]100%|██████████| 31/31 [00:08<00:00,  3.71it/s]
2025-03-13 14:42:28,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:28
2025-03-13 14:43:41,801 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.8596 secs
2025-03-13 14:43:41,801 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 14:43:41,802 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 14:44:03,396 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5943 secs
2025-03-13 14:44:03,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.8215 secs
2025-03-13 14:44:03,398 [INFO]: {
2025-03-13 14:44:03,398 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:03,398 [INFO]: 	index_param: efSearch=157
2025-03-13 14:44:03,398 [INFO]: 	index_path: knn.index
2025-03-13 14:44:03,398 [INFO]: 	size in bytes: 1466334010
2025-03-13 14:44:03,398 [INFO]: 	avg_search_speed_ms: 9.663493692389
2025-03-13 14:44:03,398 [INFO]: 	99p_search_speed_ms: 13.488554367795585
2025-03-13 14:44:03,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:03,398 [INFO]: 	nb vectors: 7453
2025-03-13 14:44:03,398 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:03,398 [INFO]: 	compression ratio: 0.9993080798828365
2025-03-13 14:44:03,399 [INFO]: }
2025-03-13 14:44:03,399 [INFO]: 	>>> Finished "Creating the index" in 102.8230 secs
2025-03-13 14:44:03,399 [INFO]: >>> Finished "Launching the whole pipeline" in 102.8530 secs
2025-03-13 14:44:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 88602 [episode count 4/20]
[retrieval_preprocessing] for episode 42659 [episode count 5/20], we have num_retrieval=np.int64(7448) num_query=np.int64(302)
2025-03-13 14:44:07,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:08,337 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:08
2025-03-13 14:44:08,337 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.10it/s]
2025-03-13 14:44:08,368 [INFO]: There are 7448 embeddings of dim 49152
2025-03-13 14:44:08,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 14:44:08,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:08
2025-03-13 14:44:08,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:08,369 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:44:08,369 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:08,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:44:08,369 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:08
2025-03-13 14:44:08,369 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:08,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:44:08,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:08
2025-03-13 14:44:08,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:08,369 [INFO]: 	Creating the index 03/13/2025, 14:44:08
2025-03-13 14:44:08,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:08
2025-03-13 14:44:08,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:44:08,370 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:08
2025-03-13 14:44:08,371 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:44:08,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  7.12it/s] 13%|█▎        | 4/31 [00:00<00:01, 18.52it/s] 26%|██▌       | 8/31 [00:00<00:00, 26.59it/s] 42%|████▏     | 13/31 [00:00<00:00, 32.77it/s] 55%|█████▍    | 17/31 [00:00<00:00, 34.73it/s] 68%|██████▊   | 21/31 [00:05<00:04,  2.10it/s] 81%|████████  | 25/31 [00:05<00:01,  3.05it/s] 94%|█████████▎| 29/31 [00:06<00:00,  4.33it/s]100%|██████████| 31/31 [00:09<00:00,  3.30it/s]
2025-03-13 14:44:17,776 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:17
2025-03-13 14:45:27,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.9826 secs
2025-03-13 14:45:27,759 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 14:45:27,759 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.99it/s]
2025-03-13 14:45:55,424 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6646 secs
2025-03-13 14:45:55,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.0554 secs
2025-03-13 14:45:55,426 [INFO]: {
2025-03-13 14:45:55,426 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:55,426 [INFO]: 	index_param: efSearch=158
2025-03-13 14:45:55,426 [INFO]: 	index_path: knn.index
2025-03-13 14:45:55,426 [INFO]: 	size in bytes: 1465350310
2025-03-13 14:45:55,426 [INFO]: 	avg_search_speed_ms: 11.845650833863676
2025-03-13 14:45:55,426 [INFO]: 	99p_search_speed_ms: 17.099116779863806
2025-03-13 14:45:55,426 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:55,426 [INFO]: 	nb vectors: 7448
2025-03-13 14:45:55,426 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:55,426 [INFO]: 	compression ratio: 0.9993080657962259
2025-03-13 14:45:55,426 [INFO]: }
2025-03-13 14:45:55,426 [INFO]: 	>>> Finished "Creating the index" in 107.0571 secs
2025-03-13 14:45:55,426 [INFO]: >>> Finished "Launching the whole pipeline" in 107.0890 secs
2025-03-13 14:45:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 42659 [episode count 5/20]
[retrieval_preprocessing] for episode 24487 [episode count 6/20], we have num_retrieval=np.int64(7398) num_query=np.int64(352)
2025-03-13 14:45:58,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:59,781 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:59
2025-03-13 14:45:59,781 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1605.78it/s]
2025-03-13 14:45:59,807 [INFO]: There are 7398 embeddings of dim 49152
2025-03-13 14:45:59,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 14:45:59,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:59
2025-03-13 14:45:59,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:59,808 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:45:59,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:59,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:59,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:59
2025-03-13 14:45:59,808 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:59,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:45:59,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:59
2025-03-13 14:45:59,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:59,808 [INFO]: 	Creating the index 03/13/2025, 14:45:59
2025-03-13 14:45:59,808 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:59
2025-03-13 14:45:59,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:45:59,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:59
2025-03-13 14:45:59,809 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:45:59,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.25it/s] 19%|█▉        | 6/31 [00:00<00:00, 26.23it/s] 35%|███▌      | 11/31 [00:00<00:00, 35.28it/s] 52%|█████▏    | 16/31 [00:00<00:00, 40.23it/s] 68%|██████▊   | 21/31 [00:04<00:03,  3.00it/s] 84%|████████▍ | 26/31 [00:04<00:01,  4.49it/s]100%|██████████| 31/31 [00:07<00:00,  3.03it/s]100%|██████████| 31/31 [00:07<00:00,  4.19it/s]
2025-03-13 14:46:07,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:07
2025-03-13 14:47:16,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1886 secs
2025-03-13 14:47:16,402 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 14:47:16,402 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.44it/s]
2025-03-13 14:47:42,753 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3510 secs
2025-03-13 14:47:42,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.9462 secs
2025-03-13 14:47:42,756 [INFO]: {
2025-03-13 14:47:42,756 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:42,756 [INFO]: 	index_param: efSearch=135
2025-03-13 14:47:42,756 [INFO]: 	index_path: knn.index
2025-03-13 14:47:42,756 [INFO]: 	size in bytes: 1455512770
2025-03-13 14:47:42,756 [INFO]: 	avg_search_speed_ms: 11.530396063954944
2025-03-13 14:47:42,756 [INFO]: 	99p_search_speed_ms: 21.328910407610255
2025-03-13 14:47:42,756 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:42,756 [INFO]: 	nb vectors: 7398
2025-03-13 14:47:42,756 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:42,756 [INFO]: 	compression ratio: 0.9993082946293903
2025-03-13 14:47:42,756 [INFO]: }
2025-03-13 14:47:42,756 [INFO]: 	>>> Finished "Creating the index" in 102.9475 secs
2025-03-13 14:47:42,756 [INFO]: >>> Finished "Launching the whole pipeline" in 102.9747 secs
2025-03-13 14:47:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 24487 [episode count 6/20]
[retrieval_preprocessing] for episode 2988 [episode count 7/20], we have num_retrieval=np.int64(7300) num_query=np.int64(450)
2025-03-13 14:47:46,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:47,450 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:47
2025-03-13 14:47:47,451 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.61it/s]
2025-03-13 14:47:47,480 [INFO]: There are 7300 embeddings of dim 49152
2025-03-13 14:47:47,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 14:47:47,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:47,480 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 14:47:47,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:47,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:47,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,480 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:47,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:47:47,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:47
2025-03-13 14:47:47,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:47,481 [INFO]: 	Creating the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:47
2025-03-13 14:47:47,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:47:47,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,482 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 14:47:47,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.34it/s] 13%|█▎        | 4/30 [00:00<00:01, 17.51it/s] 27%|██▋       | 8/30 [00:00<00:00, 26.29it/s] 40%|████      | 12/30 [00:00<00:00, 30.93it/s] 53%|█████▎    | 16/30 [00:00<00:00, 32.96it/s] 67%|██████▋   | 20/30 [00:00<00:00, 35.14it/s] 80%|████████  | 24/30 [00:05<00:02,  2.45it/s]100%|██████████| 30/30 [00:07<00:00,  2.53it/s]100%|██████████| 30/30 [00:07<00:00,  4.00it/s]
2025-03-13 14:47:54,986 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:54
2025-03-13 14:48:56,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.3431 secs
2025-03-13 14:48:56,329 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 14:48:56,329 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-13 14:49:42,726 [INFO]: 	>>> Finished "Compute fast metrics" in 46.3967 secs
2025-03-13 14:49:43,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.9614 secs
2025-03-13 14:49:43,444 [INFO]: {
2025-03-13 14:49:43,444 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:43,444 [INFO]: 	index_param: efSearch=179
2025-03-13 14:49:43,444 [INFO]: 	index_path: knn.index
2025-03-13 14:49:43,444 [INFO]: 	size in bytes: 1436232070
2025-03-13 14:49:43,444 [INFO]: 	avg_search_speed_ms: 10.517746808211056
2025-03-13 14:49:43,444 [INFO]: 	99p_search_speed_ms: 15.062051941640675
2025-03-13 14:49:43,444 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:43,444 [INFO]: 	nb vectors: 7300
2025-03-13 14:49:43,444 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:43,444 [INFO]: 	compression ratio: 0.9993081410582901
2025-03-13 14:49:43,444 [INFO]: }
2025-03-13 14:49:43,445 [INFO]: 	>>> Finished "Creating the index" in 115.9638 secs
2025-03-13 14:49:43,445 [INFO]: >>> Finished "Launching the whole pipeline" in 115.9940 secs
2025-03-13 14:49:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 2988 [episode count 7/20]
[retrieval_preprocessing] for episode 47547 [episode count 8/20], we have num_retrieval=np.int64(7285) num_query=np.int64(465)
2025-03-13 14:49:47,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:49,743 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:49
2025-03-13 14:49:49,744 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1371.14it/s]
2025-03-13 14:49:49,774 [INFO]: There are 7285 embeddings of dim 49152
2025-03-13 14:49:49,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 14:49:49,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:49,774 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 14:49:49,774 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:49,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:49,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,775 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:49,775 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:49,775 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:49
2025-03-13 14:49:49,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:49,775 [INFO]: 	Creating the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:49
2025-03-13 14:49:49,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:49:49,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,776 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 14:49:49,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.29it/s] 20%|██        | 6/30 [00:00<00:00, 28.46it/s] 37%|███▋      | 11/30 [00:00<00:00, 37.43it/s] 57%|█████▋    | 17/30 [00:00<00:00, 43.72it/s] 73%|███████▎  | 22/30 [00:04<00:02,  3.31it/s] 93%|█████████▎| 28/30 [00:04<00:00,  5.18it/s]100%|██████████| 30/30 [00:06<00:00,  4.31it/s]
2025-03-13 14:49:56,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:56
2025-03-13 14:51:05,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.6712 secs
2025-03-13 14:51:05,421 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 14:51:05,421 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.76it/s]
2025-03-13 14:51:30,564 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1421 secs
2025-03-13 14:51:30,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.7893 secs
2025-03-13 14:51:30,566 [INFO]: {
2025-03-13 14:51:30,566 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:30,566 [INFO]: 	index_param: efSearch=164
2025-03-13 14:51:30,566 [INFO]: 	index_path: knn.index
2025-03-13 14:51:30,566 [INFO]: 	size in bytes: 1433280730
2025-03-13 14:51:30,566 [INFO]: 	avg_search_speed_ms: 11.385398450709108
2025-03-13 14:51:30,566 [INFO]: 	99p_search_speed_ms: 16.01256737019867
2025-03-13 14:51:30,566 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:30,566 [INFO]: 	nb vectors: 7285
2025-03-13 14:51:30,566 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:30,566 [INFO]: 	compression ratio: 0.9993082653110114
2025-03-13 14:51:30,566 [INFO]: }
2025-03-13 14:51:30,566 [INFO]: 	>>> Finished "Creating the index" in 100.7910 secs
2025-03-13 14:51:30,566 [INFO]: >>> Finished "Launching the whole pipeline" in 100.8224 secs
2025-03-13 14:51:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 47547 [episode count 8/20]
[retrieval_preprocessing] for episode 48316 [episode count 9/20], we have num_retrieval=np.int64(7413) num_query=np.int64(337)
2025-03-13 14:51:34,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:36,243 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:36
2025-03-13 14:51:36,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 14:51:36,272 [INFO]: There are 7413 embeddings of dim 49152
2025-03-13 14:51:36,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 14:51:36,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:36,272 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:51:36,272 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:36,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:36,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,273 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:36,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:51:36,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:36
2025-03-13 14:51:36,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:36,273 [INFO]: 	Creating the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:36
2025-03-13 14:51:36,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:51:36,274 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:36
2025-03-13 14:51:36,274 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:51:36,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  7.83it/s] 16%|█▌        | 5/31 [00:00<00:01, 24.45it/s] 29%|██▉       | 9/31 [00:00<00:00, 30.77it/s] 45%|████▌     | 14/31 [00:00<00:00, 36.07it/s] 61%|██████▏   | 19/31 [00:00<00:00, 38.67it/s] 74%|███████▍  | 23/31 [00:05<00:03,  2.51it/s] 90%|█████████ | 28/31 [00:05<00:00,  3.84it/s]100%|██████████| 31/31 [00:08<00:00,  3.86it/s]
2025-03-13 14:51:44,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:44
2025-03-13 14:52:52,064 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.7463 secs
2025-03-13 14:52:52,065 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 14:52:52,065 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 14:53:21,648 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5829 secs
2025-03-13 14:53:22,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.9435 secs
2025-03-13 14:53:22,218 [INFO]: {
2025-03-13 14:53:22,218 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:22,218 [INFO]: 	index_param: efSearch=123
2025-03-13 14:53:22,218 [INFO]: 	index_path: knn.index
2025-03-13 14:53:22,218 [INFO]: 	size in bytes: 1458463990
2025-03-13 14:53:22,218 [INFO]: 	avg_search_speed_ms: 9.18377602696966
2025-03-13 14:53:22,218 [INFO]: 	99p_search_speed_ms: 14.16637862101197
2025-03-13 14:53:22,218 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:22,218 [INFO]: 	nb vectors: 7413
2025-03-13 14:53:22,218 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:22,218 [INFO]: 	compression ratio: 0.9993082544328022
2025-03-13 14:53:22,218 [INFO]: }
2025-03-13 14:53:22,218 [INFO]: 	>>> Finished "Creating the index" in 105.9457 secs
2025-03-13 14:53:22,219 [INFO]: >>> Finished "Launching the whole pipeline" in 105.9751 secs
2025-03-13 14:53:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 48316 [episode count 9/20]
[retrieval_preprocessing] for episode 47867 [episode count 10/20], we have num_retrieval=np.int64(7389) num_query=np.int64(361)
2025-03-13 14:53:24,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:26,179 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:26
2025-03-13 14:53:26,180 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1756.41it/s]
2025-03-13 14:53:26,210 [INFO]: There are 7389 embeddings of dim 49152
2025-03-13 14:53:26,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 14:53:26,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:26
2025-03-13 14:53:26,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:26,211 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:53:26,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:26,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:53:26,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:26
2025-03-13 14:53:26,212 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:26,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:53:26,212 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:26
2025-03-13 14:53:26,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:26,212 [INFO]: 	Creating the index 03/13/2025, 14:53:26
2025-03-13 14:53:26,212 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:26
2025-03-13 14:53:26,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 14:53:26,215 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:26
2025-03-13 14:53:26,215 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:53:26,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.27it/s] 19%|█▉        | 6/31 [00:00<00:01, 24.66it/s] 35%|███▌      | 11/31 [00:00<00:00, 32.04it/s] 52%|█████▏    | 16/31 [00:00<00:00, 35.33it/s] 68%|██████▊   | 21/31 [00:05<00:03,  2.52it/s] 84%|████████▍ | 26/31 [00:05<00:01,  3.80it/s]100%|██████████| 31/31 [00:08<00:00,  2.75it/s]100%|██████████| 31/31 [00:08<00:00,  3.72it/s]
2025-03-13 14:53:34,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:34
2025-03-13 14:54:45,237 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.6870 secs
2025-03-13 14:54:45,237 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 14:54:45,237 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:13,  4.51s/it] 50%|█████     | 2/4 [00:10<00:10,  5.11s/it] 75%|███████▌  | 3/4 [00:14<00:04,  4.93s/it] 75%|███████▌  | 3/4 [00:15<00:05,  5.33s/it]
2025-03-13 14:55:36,223 [INFO]: 	>>> Finished "Compute fast metrics" in 50.9862 secs
2025-03-13 14:55:36,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.0111 secs
2025-03-13 14:55:36,226 [INFO]: {
2025-03-13 14:55:36,226 [INFO]: 	index_key: HNSW15
2025-03-13 14:55:36,226 [INFO]: 	index_param: efSearch=113
2025-03-13 14:55:36,226 [INFO]: 	index_path: knn.index
2025-03-13 14:55:36,226 [INFO]: 	size in bytes: 1453742050
2025-03-13 14:55:36,226 [INFO]: 	avg_search_speed_ms: 11.340700349952105
2025-03-13 14:55:36,226 [INFO]: 	99p_search_speed_ms: 16.911348195280862
2025-03-13 14:55:36,226 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:36,226 [INFO]: 	nb vectors: 7389
2025-03-13 14:55:36,226 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:36,226 [INFO]: 	compression ratio: 0.9993083105768317
2025-03-13 14:55:36,226 [INFO]: }
2025-03-13 14:55:36,226 [INFO]: 	>>> Finished "Creating the index" in 130.0139 secs
2025-03-13 14:55:36,226 [INFO]: >>> Finished "Launching the whole pipeline" in 130.0468 secs
2025-03-13 14:55:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 47867 [episode count 10/20]
[retrieval_preprocessing] for episode 18370 [episode count 11/20], we have num_retrieval=np.int64(7365) num_query=np.int64(385)
2025-03-13 14:55:39,522 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:41,163 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:41
2025-03-13 14:55:41,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 689.97it/s]
2025-03-13 14:55:41,200 [INFO]: There are 7365 embeddings of dim 49152
2025-03-13 14:55:41,200 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 14:55:41,200 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:41
2025-03-13 14:55:41,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:41,201 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 14:55:41,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:41,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:55:41,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:41
2025-03-13 14:55:41,202 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:41,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:55:41,202 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:41
2025-03-13 14:55:41,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:41,203 [INFO]: 	Creating the index 03/13/2025, 14:55:41
2025-03-13 14:55:41,203 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:41
2025-03-13 14:55:41,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 14:55:41,206 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:41
2025-03-13 14:55:41,206 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 14:55:41,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.51it/s] 17%|█▋        | 5/30 [00:00<00:00, 25.49it/s] 33%|███▎      | 10/30 [00:00<00:00, 32.82it/s] 47%|████▋     | 14/30 [00:00<00:00, 35.37it/s] 60%|██████    | 18/30 [00:00<00:00, 30.33it/s] 73%|███████▎  | 22/30 [00:07<00:05,  1.56it/s] 83%|████████▎ | 25/30 [00:12<00:04,  1.11it/s] 93%|█████████▎| 28/30 [00:12<00:01,  1.48it/s]100%|██████████| 30/30 [00:22<00:00,  1.58s/it]100%|██████████| 30/30 [00:22<00:00,  1.31it/s]
2025-03-13 14:56:04,116 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:04
2025-03-13 14:57:23,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.0340 secs
2025-03-13 14:57:23,151 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 14:57:23,151 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.97s/it] 50%|█████     | 2/4 [00:03<00:02,  1.30s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.21it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.19s/it]
2025-03-13 14:58:05,767 [INFO]: 	>>> Finished "Compute fast metrics" in 42.6163 secs
2025-03-13 14:58:05,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.5811 secs
2025-03-13 14:58:05,788 [INFO]: {
2025-03-13 14:58:05,788 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:05,788 [INFO]: 	index_param: efSearch=97
2025-03-13 14:58:05,788 [INFO]: 	index_path: knn.index
2025-03-13 14:58:05,788 [INFO]: 	size in bytes: 1449020290
2025-03-13 14:58:05,788 [INFO]: 	avg_search_speed_ms: 8.320231072971916
2025-03-13 14:58:05,788 [INFO]: 	99p_search_speed_ms: 12.045395283494145
2025-03-13 14:58:05,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:05,788 [INFO]: 	nb vectors: 7365
2025-03-13 14:58:05,788 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:05,788 [INFO]: 	compression ratio: 0.9993082429508285
2025-03-13 14:58:05,788 [INFO]: }
2025-03-13 14:58:05,788 [INFO]: 	>>> Finished "Creating the index" in 144.5851 secs
2025-03-13 14:58:05,788 [INFO]: >>> Finished "Launching the whole pipeline" in 144.6245 secs
2025-03-13 14:58:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 18370 [episode count 11/20]
[retrieval_preprocessing] for episode 78411 [episode count 12/20], we have num_retrieval=np.int64(7404) num_query=np.int64(346)
2025-03-13 14:58:12,554 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:14,000 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:14
2025-03-13 14:58:14,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1014.34it/s]
2025-03-13 14:58:14,036 [INFO]: There are 7404 embeddings of dim 49152
2025-03-13 14:58:14,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 14:58:14,036 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:14
2025-03-13 14:58:14,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:14,036 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 14:58:14,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:14,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:58:14,036 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:14
2025-03-13 14:58:14,037 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:14,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:58:14,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:14
2025-03-13 14:58:14,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:14,037 [INFO]: 	Creating the index 03/13/2025, 14:58:14
2025-03-13 14:58:14,037 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:14
2025-03-13 14:58:14,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:58:14,038 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:14
2025-03-13 14:58:14,038 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 14:58:14,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:07,  4.08it/s]  6%|▋         | 2/31 [00:00<00:05,  5.64it/s] 10%|▉         | 3/31 [00:00<00:04,  6.55it/s] 13%|█▎        | 4/31 [00:00<00:03,  6.97it/s] 16%|█▌        | 5/31 [00:00<00:03,  7.41it/s] 19%|█▉        | 6/31 [00:00<00:03,  7.74it/s] 23%|██▎       | 7/31 [00:00<00:03,  7.96it/s] 26%|██▌       | 8/31 [00:01<00:02,  8.17it/s] 29%|██▉       | 9/31 [00:01<00:02,  8.35it/s] 32%|███▏      | 10/31 [00:01<00:02,  8.45it/s] 35%|███▌      | 11/31 [00:01<00:02,  8.50it/s] 39%|███▊      | 12/31 [00:01<00:02,  8.65it/s] 42%|████▏     | 13/31 [00:01<00:02,  8.63it/s] 45%|████▌     | 14/31 [00:01<00:01,  8.69it/s] 48%|████▊     | 15/31 [00:01<00:01,  8.66it/s] 52%|█████▏    | 16/31 [00:02<00:01,  8.69it/s] 55%|█████▍    | 17/31 [00:02<00:01,  8.63it/s] 58%|█████▊    | 18/31 [00:02<00:01,  8.41it/s] 61%|██████▏   | 19/31 [00:02<00:01,  8.15it/s] 65%|██████▍   | 20/31 [00:02<00:01,  8.01it/s] 68%|██████▊   | 21/31 [00:10<00:25,  2.55s/it] 71%|███████   | 22/31 [00:11<00:18,  2.02s/it] 74%|███████▍  | 23/31 [00:11<00:12,  1.55s/it] 77%|███████▋  | 24/31 [00:12<00:08,  1.15s/it] 84%|████████▍ | 26/31 [00:12<00:03,  1.51it/s] 87%|████████▋ | 27/31 [00:12<00:02,  1.61it/s] 90%|█████████ | 28/31 [00:13<00:01,  1.79it/s] 94%|█████████▎| 29/31 [00:13<00:00,  2.06it/s] 97%|█████████▋| 30/31 [00:13<00:00,  2.40it/s]100%|██████████| 31/31 [00:17<00:00,  1.26s/it]100%|██████████| 31/31 [00:17<00:00,  1.81it/s]
2025-03-13 14:58:31,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:31
2025-03-13 14:59:31,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.1497 secs
2025-03-13 14:59:31,341 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 14:59:31,341 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 14:59:57,922 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5813 secs
2025-03-13 14:59:58,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.0650 secs
2025-03-13 14:59:58,104 [INFO]: {
2025-03-13 14:59:58,104 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:58,104 [INFO]: 	index_param: efSearch=172
2025-03-13 14:59:58,104 [INFO]: 	index_path: knn.index
2025-03-13 14:59:58,104 [INFO]: 	size in bytes: 1456693270
2025-03-13 14:59:58,104 [INFO]: 	avg_search_speed_ms: 12.439333308437163
2025-03-13 14:59:58,104 [INFO]: 	99p_search_speed_ms: 20.715007949620485
2025-03-13 14:59:58,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:58,104 [INFO]: 	nb vectors: 7404
2025-03-13 14:59:58,104 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:58,105 [INFO]: 	compression ratio: 0.9993082702990727
2025-03-13 14:59:58,105 [INFO]: }
2025-03-13 14:59:58,105 [INFO]: 	>>> Finished "Creating the index" in 104.0678 secs
2025-03-13 14:59:58,105 [INFO]: >>> Finished "Launching the whole pipeline" in 104.1039 secs
2025-03-13 14:59:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 78411 [episode count 12/20]
[retrieval_preprocessing] for episode 13135 [episode count 13/20], we have num_retrieval=np.int64(7212) num_query=np.int64(538)
2025-03-13 15:00:04,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:05,606 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:05
2025-03-13 15:00:05,607 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.56it/s]
2025-03-13 15:00:05,631 [INFO]: There are 7212 embeddings of dim 49152
2025-03-13 15:00:05,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 15:00:05,631 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:05
2025-03-13 15:00:05,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:05,631 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 15:00:05,631 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:05,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:00:05,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:05
2025-03-13 15:00:05,632 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:05,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:00:05,632 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:05
2025-03-13 15:00:05,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:05,632 [INFO]: 	Creating the index 03/13/2025, 15:00:05
2025-03-13 15:00:05,632 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:05
2025-03-13 15:00:05,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:00:05,633 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:05
2025-03-13 15:00:05,633 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:00:05,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.11it/s] 10%|█         | 3/30 [00:00<00:03,  8.65it/s] 17%|█▋        | 5/30 [00:00<00:02,  9.98it/s] 23%|██▎       | 7/30 [00:00<00:02, 10.57it/s] 30%|███       | 9/30 [00:00<00:01, 10.90it/s] 37%|███▋      | 11/30 [00:01<00:01, 11.16it/s] 43%|████▎     | 13/30 [00:01<00:01, 11.15it/s] 50%|█████     | 15/30 [00:01<00:01, 11.18it/s] 57%|█████▋    | 17/30 [00:01<00:01, 11.06it/s] 63%|██████▎   | 19/30 [00:01<00:00, 11.02it/s] 70%|███████   | 21/30 [00:05<00:06,  1.46it/s] 73%|███████▎  | 22/30 [00:05<00:04,  1.71it/s] 77%|███████▋  | 23/30 [00:06<00:03,  2.05it/s] 80%|████████  | 24/30 [00:09<00:07,  1.23s/it] 83%|████████▎ | 25/30 [00:09<00:04,  1.04it/s] 90%|█████████ | 27/30 [00:10<00:01,  1.66it/s] 93%|█████████▎| 28/30 [00:10<00:01,  1.99it/s]100%|██████████| 30/30 [00:13<00:00,  1.16it/s]100%|██████████| 30/30 [00:13<00:00,  2.28it/s]
2025-03-13 15:00:18,797 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:18
2025-03-13 15:01:19,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6203 secs
2025-03-13 15:01:19,418 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:01:19,418 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 15:02:19,429 [INFO]: 	>>> Finished "Compute fast metrics" in 60.0104 secs
2025-03-13 15:02:19,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.8068 secs
2025-03-13 15:02:19,440 [INFO]: {
2025-03-13 15:02:19,440 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:19,440 [INFO]: 	index_param: efSearch=156
2025-03-13 15:02:19,440 [INFO]: 	index_path: knn.index
2025-03-13 15:02:19,440 [INFO]: 	size in bytes: 1418918470
2025-03-13 15:02:19,440 [INFO]: 	avg_search_speed_ms: 10.667537731886817
2025-03-13 15:02:19,440 [INFO]: 	99p_search_speed_ms: 24.60591559298336
2025-03-13 15:02:19,440 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:19,440 [INFO]: 	nb vectors: 7212
2025-03-13 15:02:19,440 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:19,440 [INFO]: 	compression ratio: 0.9993082238192305
2025-03-13 15:02:19,440 [INFO]: }
2025-03-13 15:02:19,440 [INFO]: 	>>> Finished "Creating the index" in 133.8087 secs
2025-03-13 15:02:19,440 [INFO]: >>> Finished "Launching the whole pipeline" in 133.8339 secs
2025-03-13 15:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 13135 [episode count 13/20]
[retrieval_preprocessing] for episode 17359 [episode count 14/20], we have num_retrieval=np.int64(7335) num_query=np.int64(415)
2025-03-13 15:02:25,452 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:27,315 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:27
2025-03-13 15:02:27,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 15:02:27,341 [INFO]: There are 7335 embeddings of dim 49152
2025-03-13 15:02:27,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:02:27,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:27
2025-03-13 15:02:27,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:27,342 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 15:02:27,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:27,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:27,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:27
2025-03-13 15:02:27,342 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:27,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:02:27,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:27
2025-03-13 15:02:27,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:27,342 [INFO]: 	Creating the index 03/13/2025, 15:02:27
2025-03-13 15:02:27,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:27
2025-03-13 15:02:27,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:02:27,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:27
2025-03-13 15:02:27,343 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:02:27,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:06,  4.56it/s]  7%|▋         | 2/30 [00:00<00:04,  6.13it/s] 10%|█         | 3/30 [00:00<00:03,  7.44it/s] 17%|█▋        | 5/30 [00:00<00:02,  8.75it/s] 20%|██        | 6/30 [00:00<00:02,  8.72it/s] 23%|██▎       | 7/30 [00:00<00:02,  8.58it/s] 27%|██▋       | 8/30 [00:01<00:02,  8.43it/s] 30%|███       | 9/30 [00:01<00:02,  8.43it/s] 33%|███▎      | 10/30 [00:01<00:02,  8.34it/s] 37%|███▋      | 11/30 [00:01<00:02,  8.30it/s] 40%|████      | 12/30 [00:01<00:02,  8.15it/s] 43%|████▎     | 13/30 [00:01<00:02,  8.16it/s] 47%|████▋     | 14/30 [00:01<00:01,  8.35it/s] 53%|█████▎    | 16/30 [00:01<00:01,  9.40it/s] 60%|██████    | 18/30 [00:02<00:01, 10.00it/s] 67%|██████▋   | 20/30 [00:02<00:00, 10.47it/s] 73%|███████▎  | 22/30 [00:06<00:06,  1.27it/s] 80%|████████  | 24/30 [00:06<00:03,  1.78it/s] 87%|████████▋ | 26/30 [00:06<00:01,  2.43it/s] 93%|█████████▎| 28/30 [00:07<00:00,  3.19it/s]100%|██████████| 30/30 [00:10<00:00,  1.42it/s]100%|██████████| 30/30 [00:10<00:00,  2.92it/s]
2025-03-13 15:02:37,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:37
2025-03-13 15:03:37,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0246 secs
2025-03-13 15:03:37,636 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 15:03:37,636 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.33it/s] 50%|█████     | 2/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.69it/s]
2025-03-13 15:04:09,523 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8866 secs
2025-03-13 15:04:09,525 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.1816 secs
2025-03-13 15:04:09,525 [INFO]: {
2025-03-13 15:04:09,525 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:09,525 [INFO]: 	index_param: efSearch=115
2025-03-13 15:04:09,525 [INFO]: 	index_path: knn.index
2025-03-13 15:04:09,525 [INFO]: 	size in bytes: 1443118030
2025-03-13 15:04:09,525 [INFO]: 	avg_search_speed_ms: 8.919336546435089
2025-03-13 15:04:09,525 [INFO]: 	99p_search_speed_ms: 19.901035306975153
2025-03-13 15:04:09,525 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:09,525 [INFO]: 	nb vectors: 7335
2025-03-13 15:04:09,525 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:09,525 [INFO]: 	compression ratio: 0.9993081993438887
2025-03-13 15:04:09,525 [INFO]: }
2025-03-13 15:04:09,525 [INFO]: 	>>> Finished "Creating the index" in 102.1833 secs
2025-03-13 15:04:09,525 [INFO]: >>> Finished "Launching the whole pipeline" in 102.2103 secs
2025-03-13 15:04:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 17359 [episode count 14/20]
[retrieval_preprocessing] for episode 62292 [episode count 15/20], we have num_retrieval=np.int64(7422) num_query=np.int64(328)
2025-03-13 15:04:20,813 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:22,226 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:22
2025-03-13 15:04:22,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1008.73it/s]
2025-03-13 15:04:22,252 [INFO]: There are 7422 embeddings of dim 49152
2025-03-13 15:04:22,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:04:22,253 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:22,253 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 15:04:22,253 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:22,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:22,253 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,253 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:22,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:04:22,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:22
2025-03-13 15:04:22,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:22,253 [INFO]: 	Creating the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:22
2025-03-13 15:04:22,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:04:22,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,254 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:04:22,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.07it/s] 10%|▉         | 3/31 [00:00<00:02, 12.46it/s] 16%|█▌        | 5/31 [00:00<00:01, 14.10it/s] 26%|██▌       | 8/31 [00:00<00:01, 18.36it/s] 32%|███▏      | 10/31 [00:00<00:01, 18.27it/s] 42%|████▏     | 13/31 [00:00<00:00, 21.25it/s] 52%|█████▏    | 16/31 [00:01<00:01, 13.63it/s] 61%|██████▏   | 19/31 [00:01<00:00, 16.04it/s] 68%|██████▊   | 21/31 [00:05<00:06,  1.65it/s] 77%|███████▋  | 24/31 [00:06<00:03,  1.91it/s] 84%|████████▍ | 26/31 [00:07<00:02,  1.94it/s] 90%|█████████ | 28/31 [00:07<00:01,  2.48it/s] 94%|█████████▎| 29/31 [00:08<00:00,  2.75it/s] 97%|█████████▋| 30/31 [00:08<00:00,  3.03it/s]100%|██████████| 31/31 [00:11<00:00,  1.11it/s]100%|██████████| 31/31 [00:11<00:00,  2.73it/s]
2025-03-13 15:04:33,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:33
2025-03-13 15:05:34,767 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1381 secs
2025-03-13 15:05:34,767 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:05:34,767 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s]
2025-03-13 15:06:06,859 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0911 secs
2025-03-13 15:06:06,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.6064 secs
2025-03-13 15:06:06,861 [INFO]: {
2025-03-13 15:06:06,861 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:06,861 [INFO]: 	index_param: efSearch=179
2025-03-13 15:06:06,861 [INFO]: 	index_path: knn.index
2025-03-13 15:06:06,861 [INFO]: 	size in bytes: 1460234710
2025-03-13 15:06:06,861 [INFO]: 	avg_search_speed_ms: 11.381578995910843
2025-03-13 15:06:06,861 [INFO]: 	99p_search_speed_ms: 21.946105719544
2025-03-13 15:06:06,861 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:06,861 [INFO]: 	nb vectors: 7422
2025-03-13 15:06:06,861 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:06,861 [INFO]: 	compression ratio: 0.9993082386050116
2025-03-13 15:06:06,861 [INFO]: }
2025-03-13 15:06:06,861 [INFO]: 	>>> Finished "Creating the index" in 104.6080 secs
2025-03-13 15:06:06,861 [INFO]: >>> Finished "Launching the whole pipeline" in 104.6349 secs
2025-03-13 15:06:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 62292 [episode count 15/20]
[retrieval_preprocessing] for episode 77780 [episode count 16/20], we have num_retrieval=np.int64(7418) num_query=np.int64(332)
2025-03-13 15:06:12,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:13,701 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:13
2025-03-13 15:06:13,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.62it/s]
2025-03-13 15:06:13,729 [INFO]: There are 7418 embeddings of dim 49152
2025-03-13 15:06:13,729 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:06:13,730 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:13
2025-03-13 15:06:13,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:13,730 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 15:06:13,730 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:13,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:06:13,730 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:13
2025-03-13 15:06:13,731 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:13,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:06:13,731 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:13
2025-03-13 15:06:13,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:13,731 [INFO]: 	Creating the index 03/13/2025, 15:06:13
2025-03-13 15:06:13,731 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:13
2025-03-13 15:06:13,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:06:13,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:13
2025-03-13 15:06:13,735 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:06:13,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:06,  4.79it/s]  6%|▋         | 2/31 [00:00<00:04,  6.86it/s] 10%|▉         | 3/31 [00:00<00:03,  7.60it/s] 16%|█▌        | 5/31 [00:00<00:02,  9.65it/s] 23%|██▎       | 7/31 [00:00<00:02, 10.82it/s] 29%|██▉       | 9/31 [00:00<00:01, 11.00it/s] 35%|███▌      | 11/31 [00:01<00:02,  9.96it/s] 42%|████▏     | 13/31 [00:01<00:01,  9.25it/s] 45%|████▌     | 14/31 [00:01<00:01,  9.08it/s] 48%|████▊     | 15/31 [00:01<00:01,  9.07it/s] 52%|█████▏    | 16/31 [00:01<00:01,  9.11it/s] 55%|█████▍    | 17/31 [00:01<00:01,  9.18it/s] 58%|█████▊    | 18/31 [00:01<00:01,  9.11it/s] 61%|██████▏   | 19/31 [00:02<00:01,  9.19it/s] 65%|██████▍   | 20/31 [00:02<00:01,  9.36it/s] 68%|██████▊   | 21/31 [00:06<00:12,  1.20s/it] 71%|███████   | 22/31 [00:06<00:07,  1.13it/s] 74%|███████▍  | 23/31 [00:06<00:05,  1.52it/s] 77%|███████▋  | 24/31 [00:06<00:03,  2.01it/s] 81%|████████  | 25/31 [00:06<00:02,  2.62it/s] 84%|████████▍ | 26/31 [00:06<00:01,  3.32it/s] 87%|████████▋ | 27/31 [00:06<00:00,  4.11it/s] 90%|█████████ | 28/31 [00:06<00:00,  4.91it/s] 94%|█████████▎| 29/31 [00:06<00:00,  5.68it/s] 97%|█████████▋| 30/31 [00:07<00:00,  6.42it/s]100%|██████████| 31/31 [00:09<00:00,  1.14it/s]100%|██████████| 31/31 [00:09<00:00,  3.21it/s]
2025-03-13 15:06:23,402 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:23
2025-03-13 15:07:22,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0552 secs
2025-03-13 15:07:22,458 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 15:07:22,458 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.38it/s] 50%|█████     | 2/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 15:07:46,983 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5252 secs
2025-03-13 15:07:46,986 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.2510 secs
2025-03-13 15:07:46,986 [INFO]: {
2025-03-13 15:07:46,986 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:46,986 [INFO]: 	index_param: efSearch=184
2025-03-13 15:07:46,986 [INFO]: 	index_path: knn.index
2025-03-13 15:07:46,986 [INFO]: 	size in bytes: 1459447690
2025-03-13 15:07:46,986 [INFO]: 	avg_search_speed_ms: 14.012364036708819
2025-03-13 15:07:46,986 [INFO]: 	99p_search_speed_ms: 21.586719509214163
2025-03-13 15:07:46,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:46,986 [INFO]: 	nb vectors: 7418
2025-03-13 15:07:46,986 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:46,986 [INFO]: 	compression ratio: 0.9993082684587345
2025-03-13 15:07:46,986 [INFO]: }
2025-03-13 15:07:46,986 [INFO]: 	>>> Finished "Creating the index" in 93.2549 secs
2025-03-13 15:07:46,986 [INFO]: >>> Finished "Launching the whole pipeline" in 93.2852 secs
2025-03-13 15:07:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 77780 [episode count 16/20]
[retrieval_preprocessing] for episode 94166 [episode count 17/20], we have num_retrieval=np.int64(7395) num_query=np.int64(355)
2025-03-13 15:07:53,418 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:54,680 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:54
2025-03-13 15:07:54,680 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.03it/s]
2025-03-13 15:07:54,702 [INFO]: There are 7395 embeddings of dim 49152
2025-03-13 15:07:54,703 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 15:07:54,703 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:54
2025-03-13 15:07:54,703 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:54,703 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 15:07:54,703 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:54,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:07:54,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:54
2025-03-13 15:07:54,703 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:54,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:54,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:54
2025-03-13 15:07:54,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:54,703 [INFO]: 	Creating the index 03/13/2025, 15:07:54
2025-03-13 15:07:54,703 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:54
2025-03-13 15:07:54,704 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:07:54,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:54
2025-03-13 15:07:54,705 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 15:07:54,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:06,  4.40it/s]  6%|▋         | 2/31 [00:00<00:05,  5.75it/s] 10%|▉         | 3/31 [00:00<00:04,  6.41it/s] 16%|█▌        | 5/31 [00:00<00:03,  8.32it/s] 19%|█▉        | 6/31 [00:00<00:03,  8.14it/s] 23%|██▎       | 7/31 [00:00<00:03,  7.98it/s] 26%|██▌       | 8/31 [00:01<00:02,  7.91it/s] 29%|██▉       | 9/31 [00:01<00:02,  7.94it/s] 32%|███▏      | 10/31 [00:01<00:02,  8.13it/s] 35%|███▌      | 11/31 [00:01<00:02,  7.97it/s] 39%|███▊      | 12/31 [00:01<00:02,  7.87it/s] 42%|████▏     | 13/31 [00:01<00:02,  7.79it/s] 45%|████▌     | 14/31 [00:01<00:02,  8.01it/s] 52%|█████▏    | 16/31 [00:02<00:01,  8.94it/s] 58%|█████▊    | 18/31 [00:02<00:01,  9.42it/s] 65%|██████▍   | 20/31 [00:02<00:01,  9.76it/s] 68%|██████▊   | 21/31 [00:06<00:10,  1.02s/it] 71%|███████   | 22/31 [00:07<00:07,  1.23it/s] 77%|███████▋  | 24/31 [00:07<00:03,  1.89it/s] 84%|████████▍ | 26/31 [00:07<00:01,  2.68it/s] 90%|█████████ | 28/31 [00:07<00:00,  3.60it/s] 97%|█████████▋| 30/31 [00:07<00:00,  4.61it/s]100%|██████████| 31/31 [00:10<00:00,  1.45it/s]100%|██████████| 31/31 [00:10<00:00,  2.94it/s]
2025-03-13 15:08:05,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:05
2025-03-13 15:09:03,100 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8474 secs
2025-03-13 15:09:03,101 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:09:03,101 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.96it/s]
2025-03-13 15:09:31,137 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0364 secs
2025-03-13 15:09:31,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.4356 secs
2025-03-13 15:09:31,140 [INFO]: {
2025-03-13 15:09:31,140 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:31,140 [INFO]: 	index_param: efSearch=177
2025-03-13 15:09:31,140 [INFO]: 	index_path: knn.index
2025-03-13 15:09:31,140 [INFO]: 	size in bytes: 1454922550
2025-03-13 15:09:31,140 [INFO]: 	avg_search_speed_ms: 12.260332808307117
2025-03-13 15:09:31,140 [INFO]: 	99p_search_speed_ms: 20.08476629853249
2025-03-13 15:09:31,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:31,141 [INFO]: 	nb vectors: 7395
2025-03-13 15:09:31,141 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:31,141 [INFO]: 	compression ratio: 0.9993082862039633
2025-03-13 15:09:31,141 [INFO]: }
2025-03-13 15:09:31,141 [INFO]: 	>>> Finished "Creating the index" in 96.4372 secs
2025-03-13 15:09:31,141 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4607 secs
2025-03-13 15:09:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 94166 [episode count 17/20]
[retrieval_preprocessing] for episode 5089 [episode count 18/20], we have num_retrieval=np.int64(7274) num_query=np.int64(476)
2025-03-13 15:09:36,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:37,815 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:37
2025-03-13 15:09:37,816 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1404.66it/s]
2025-03-13 15:09:37,844 [INFO]: There are 7274 embeddings of dim 49152
2025-03-13 15:09:37,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:09:37,845 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:37
2025-03-13 15:09:37,845 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:37,845 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 15:09:37,845 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:37,845 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:09:37,845 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:37
2025-03-13 15:09:37,846 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:37,846 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:09:37,846 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:37
2025-03-13 15:09:37,846 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:37,846 [INFO]: 	Creating the index 03/13/2025, 15:09:37
2025-03-13 15:09:37,846 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:37
2025-03-13 15:09:37,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:09:37,850 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:37
2025-03-13 15:09:37,850 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:09:37,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.42it/s] 10%|█         | 3/30 [00:00<00:03,  8.94it/s] 17%|█▋        | 5/30 [00:00<00:02, 10.11it/s] 23%|██▎       | 7/30 [00:00<00:02, 10.40it/s] 30%|███       | 9/30 [00:00<00:01, 10.54it/s] 37%|███▋      | 11/30 [00:01<00:01, 10.34it/s] 43%|████▎     | 13/30 [00:01<00:01, 10.33it/s] 50%|█████     | 15/30 [00:01<00:01, 10.16it/s] 57%|█████▋    | 17/30 [00:01<00:01, 10.65it/s] 63%|██████▎   | 19/30 [00:01<00:01, 10.81it/s] 70%|███████   | 21/30 [00:06<00:06,  1.40it/s] 73%|███████▎  | 22/30 [00:06<00:04,  1.65it/s] 80%|████████  | 24/30 [00:06<00:02,  2.33it/s] 87%|████████▋ | 26/30 [00:06<00:01,  3.16it/s] 93%|█████████▎| 28/30 [00:06<00:00,  4.11it/s]100%|██████████| 30/30 [00:09<00:00,  1.73it/s]100%|██████████| 30/30 [00:09<00:00,  3.22it/s]
2025-03-13 15:09:47,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:47
2025-03-13 15:10:45,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8203 secs
2025-03-13 15:10:45,005 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 15:10:45,006 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 15:11:19,099 [INFO]: 	>>> Finished "Compute fast metrics" in 34.0933 secs
2025-03-13 15:11:19,699 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.8491 secs
2025-03-13 15:11:19,699 [INFO]: {
2025-03-13 15:11:19,699 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:19,699 [INFO]: 	index_param: efSearch=149
2025-03-13 15:11:19,699 [INFO]: 	index_path: knn.index
2025-03-13 15:11:19,699 [INFO]: 	size in bytes: 1431116530
2025-03-13 15:11:19,699 [INFO]: 	avg_search_speed_ms: 10.245732212826594
2025-03-13 15:11:19,699 [INFO]: 	99p_search_speed_ms: 17.731626343447715
2025-03-13 15:11:19,699 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:19,699 [INFO]: 	nb vectors: 7274
2025-03-13 15:11:19,699 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:19,699 [INFO]: 	compression ratio: 0.9993082757558533
2025-03-13 15:11:19,700 [INFO]: }
2025-03-13 15:11:19,700 [INFO]: 	>>> Finished "Creating the index" in 101.8532 secs
2025-03-13 15:11:19,700 [INFO]: >>> Finished "Launching the whole pipeline" in 101.8840 secs
2025-03-13 15:11:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 5089 [episode count 18/20]
[retrieval_preprocessing] for episode 56162 [episode count 19/20], we have num_retrieval=np.int64(7332) num_query=np.int64(418)
2025-03-13 15:11:26,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:28,080 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:28
2025-03-13 15:11:28,080 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-13 15:11:28,108 [INFO]: There are 7332 embeddings of dim 49152
2025-03-13 15:11:28,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:11:28,108 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:28
2025-03-13 15:11:28,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:28,108 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 15:11:28,108 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:28,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:28,108 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:28
2025-03-13 15:11:28,109 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:28,109 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:11:28,109 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:28
2025-03-13 15:11:28,109 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:28,109 [INFO]: 	Creating the index 03/13/2025, 15:11:28
2025-03-13 15:11:28,109 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:28
2025-03-13 15:11:28,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:11:28,110 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:28
2025-03-13 15:11:28,110 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 15:11:28,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:06,  4.24it/s]  7%|▋         | 2/30 [00:00<00:04,  5.80it/s] 10%|█         | 3/30 [00:00<00:04,  6.29it/s] 13%|█▎        | 4/30 [00:00<00:03,  6.61it/s] 17%|█▋        | 5/30 [00:00<00:03,  6.86it/s] 20%|██        | 6/30 [00:00<00:03,  6.95it/s] 23%|██▎       | 7/30 [00:01<00:03,  7.00it/s] 27%|██▋       | 8/30 [00:01<00:03,  7.12it/s] 30%|███       | 9/30 [00:01<00:02,  7.14it/s] 33%|███▎      | 10/30 [00:01<00:02,  7.23it/s] 37%|███▋      | 11/30 [00:01<00:02,  7.18it/s] 40%|████      | 12/30 [00:01<00:02,  7.20it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.22it/s] 47%|████▋     | 14/30 [00:02<00:02,  7.32it/s] 50%|█████     | 15/30 [00:02<00:02,  7.43it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.61it/s] 57%|█████▋    | 17/30 [00:02<00:01,  7.66it/s] 63%|██████▎   | 19/30 [00:02<00:01,  8.74it/s] 67%|██████▋   | 20/30 [00:02<00:01,  8.51it/s] 70%|███████   | 21/30 [00:07<00:11,  1.25s/it] 73%|███████▎  | 22/30 [00:07<00:07,  1.06it/s] 80%|████████  | 24/30 [00:07<00:03,  1.75it/s] 83%|████████▎ | 25/30 [00:07<00:02,  2.16it/s] 87%|████████▋ | 26/30 [00:07<00:01,  2.69it/s] 93%|█████████▎| 28/30 [00:07<00:00,  3.92it/s] 97%|█████████▋| 29/30 [00:07<00:00,  4.53it/s]100%|██████████| 30/30 [00:12<00:00,  1.31s/it]100%|██████████| 30/30 [00:12<00:00,  2.38it/s]
2025-03-13 15:11:40,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:40
2025-03-13 15:12:41,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.3523 secs
2025-03-13 15:12:41,090 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 15:12:41,091 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.00it/s]
2025-03-13 15:13:09,705 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6139 secs
2025-03-13 15:13:09,707 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.5974 secs
2025-03-13 15:13:09,707 [INFO]: {
2025-03-13 15:13:09,707 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:09,707 [INFO]: 	index_param: efSearch=103
2025-03-13 15:13:09,707 [INFO]: 	index_path: knn.index
2025-03-13 15:13:09,707 [INFO]: 	size in bytes: 1442527810
2025-03-13 15:13:09,707 [INFO]: 	avg_search_speed_ms: 8.026250662172982
2025-03-13 15:13:09,707 [INFO]: 	99p_search_speed_ms: 14.607686875388024
2025-03-13 15:13:09,708 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:09,708 [INFO]: 	nb vectors: 7332
2025-03-13 15:13:09,708 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:09,708 [INFO]: 	compression ratio: 0.9993081908070806
2025-03-13 15:13:09,708 [INFO]: }
2025-03-13 15:13:09,708 [INFO]: 	>>> Finished "Creating the index" in 101.5989 secs
2025-03-13 15:13:09,708 [INFO]: >>> Finished "Launching the whole pipeline" in 101.6273 secs
2025-03-13 15:13:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 56162 [episode count 19/20]
2025-03-13 15:13:12: [retrieval_preprocessing] finished for 1526685371_marker_on_towel_fold_in_box [chosen_id count 0/196]
2025-03-13 15:13:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 164628080_put_rubber_duck_in_pot [chosen_id count 1/196]
2025-03-13 15:13:14: [retrieval_preprocessing] we have num_total=2119 embedding_dim=49152
[retrieval_preprocessing] for episode 7174 [episode count 0/20], we have num_retrieval=np.int64(2018) num_query=np.int64(101)
2025-03-13 15:13:15,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:16,013 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:16
2025-03-13 15:13:16,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.38it/s]
2025-03-13 15:13:16,037 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 15:13:16,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:13:16,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:16,038 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:13:16,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:16,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:16,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,038 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:16,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:13:16,038 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:16
2025-03-13 15:13:16,038 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:16,038 [INFO]: 	Creating the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:16
2025-03-13 15:13:16,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:13:16,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:16
2025-03-13 15:13:16,039 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:13:16,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.27it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.56it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.11it/s] 50%|█████     | 4/8 [00:00<00:00,  7.42it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.59it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.79it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.84it/s]100%|██████████| 8/8 [00:02<00:00,  1.54it/s]100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
2025-03-13 15:13:19,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:19
2025-03-13 15:13:49,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5639 secs
2025-03-13 15:13:49,720 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 15:13:49,720 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 15:14:10,313 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5930 secs
2025-03-13 15:14:10,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2757 secs
2025-03-13 15:14:10,315 [INFO]: {
2025-03-13 15:14:10,315 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:10,315 [INFO]: 	index_param: efSearch=219
2025-03-13 15:14:10,315 [INFO]: 	index_path: knn.index
2025-03-13 15:14:10,315 [INFO]: 	size in bytes: 397029310
2025-03-13 15:14:10,315 [INFO]: 	avg_search_speed_ms: 8.705870382523438
2025-03-13 15:14:10,315 [INFO]: 	99p_search_speed_ms: 15.596496891230341
2025-03-13 15:14:10,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:10,315 [INFO]: 	nb vectors: 2018
2025-03-13 15:14:10,315 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:10,315 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 15:14:10,315 [INFO]: }
2025-03-13 15:14:10,315 [INFO]: 	>>> Finished "Creating the index" in 54.2772 secs
2025-03-13 15:14:10,316 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3026 secs
2025-03-13 15:14:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 7174 [episode count 0/20]
[retrieval_preprocessing] for episode 22046 [episode count 1/20], we have num_retrieval=np.int64(1985) num_query=np.int64(134)
2025-03-13 15:14:11,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:12,233 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:12
2025-03-13 15:14:12,233 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-13 15:14:12,258 [INFO]: There are 1985 embeddings of dim 49152
2025-03-13 15:14:12,258 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:14:12,258 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:12
2025-03-13 15:14:12,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:12,258 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:14:12,258 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:12,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:12,258 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:12
2025-03-13 15:14:12,258 [INFO]: 409.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:12,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:14:12,258 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:12
2025-03-13 15:14:12,259 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:12,259 [INFO]: 	Creating the index 03/13/2025, 15:14:12
2025-03-13 15:14:12,259 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:12
2025-03-13 15:14:12,259 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:14:12,260 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:12
2025-03-13 15:14:12,260 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:14:12,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.45it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.96it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.55it/s] 50%|█████     | 4/8 [00:00<00:00,  7.79it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.07it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.16it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.18it/s]100%|██████████| 8/8 [00:02<00:00,  1.81it/s]100%|██████████| 8/8 [00:02<00:00,  3.37it/s]
2025-03-13 15:14:15,040 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:15
2025-03-13 15:14:41,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0273 secs
2025-03-13 15:14:41,068 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 15:14:41,068 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 15:14:57,337 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2683 secs
2025-03-13 15:14:57,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0794 secs
2025-03-13 15:14:57,339 [INFO]: {
2025-03-13 15:14:57,339 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:57,339 [INFO]: 	index_param: efSearch=209
2025-03-13 15:14:57,339 [INFO]: 	index_path: knn.index
2025-03-13 15:14:57,339 [INFO]: 	size in bytes: 390536770
2025-03-13 15:14:57,339 [INFO]: 	avg_search_speed_ms: 9.329309401192717
2025-03-13 15:14:57,339 [INFO]: 	99p_search_speed_ms: 14.233921112027016
2025-03-13 15:14:57,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:57,339 [INFO]: 	nb vectors: 1985
2025-03-13 15:14:57,339 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:57,339 [INFO]: 	compression ratio: 0.9993089255078338
2025-03-13 15:14:57,339 [INFO]: }
2025-03-13 15:14:57,339 [INFO]: 	>>> Finished "Creating the index" in 45.0808 secs
2025-03-13 15:14:57,339 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1062 secs
2025-03-13 15:14:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 22046 [episode count 1/20]
[retrieval_preprocessing] for episode 36920 [episode count 2/20], we have num_retrieval=np.int64(2004) num_query=np.int64(115)
2025-03-13 15:15:00,417 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:00,808 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:00
2025-03-13 15:15:00,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.16it/s]
2025-03-13 15:15:00,836 [INFO]: There are 2004 embeddings of dim 49152
2025-03-13 15:15:00,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 15:15:00,836 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:00,837 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:15:00,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:00,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:15:00,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,837 [INFO]: 413.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:00,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:15:00,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:00
2025-03-13 15:15:00,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:00,838 [INFO]: 	Creating the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:00
2025-03-13 15:15:00,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:15:00,841 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,841 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:15:00,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.94it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.12it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.66it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.80it/s]100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
2025-03-13 15:15:03,109 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:03
2025-03-13 15:15:31,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6797 secs
2025-03-13 15:15:31,790 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:15:31,790 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.30it/s] 50%|█████     | 2/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.80it/s]
2025-03-13 15:15:52,863 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0730 secs
2025-03-13 15:15:52,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0249 secs
2025-03-13 15:15:52,866 [INFO]: {
2025-03-13 15:15:52,866 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:52,866 [INFO]: 	index_param: efSearch=199
2025-03-13 15:15:52,866 [INFO]: 	index_path: knn.index
2025-03-13 15:15:52,866 [INFO]: 	size in bytes: 394274890
2025-03-13 15:15:52,867 [INFO]: 	avg_search_speed_ms: 10.3761418638036
2025-03-13 15:15:52,867 [INFO]: 	99p_search_speed_ms: 16.190693106036633
2025-03-13 15:15:52,867 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:52,867 [INFO]: 	nb vectors: 2004
2025-03-13 15:15:52,867 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:52,867 [INFO]: 	compression ratio: 0.9993089643624021
2025-03-13 15:15:52,867 [INFO]: }
2025-03-13 15:15:52,867 [INFO]: 	>>> Finished "Creating the index" in 52.0285 secs
2025-03-13 15:15:52,867 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0582 secs
2025-03-13 15:15:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 36920 [episode count 2/20]
[retrieval_preprocessing] for episode 31802 [episode count 3/20], we have num_retrieval=np.int64(2027) num_query=np.int64(92)
2025-03-13 15:15:56,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:57,456 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:57
2025-03-13 15:15:57,456 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 906.29it/s]
2025-03-13 15:15:57,494 [INFO]: There are 2027 embeddings of dim 49152
2025-03-13 15:15:57,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 15:15:57,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:57,495 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:15:57,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:57,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:15:57,495 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,495 [INFO]: 418.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:57,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:15:57,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:57
2025-03-13 15:15:57,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:57,496 [INFO]: 	Creating the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,496 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:57
2025-03-13 15:15:57,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:15:57,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:57
2025-03-13 15:15:57,499 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:15:57,499 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.31it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.70it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.32it/s] 50%|█████     | 4/8 [00:00<00:00,  6.57it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.95it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.34it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.38it/s]100%|██████████| 8/8 [00:02<00:00,  1.57it/s]100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
2025-03-13 15:16:00,262 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:00
2025-03-13 15:16:28,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8083 secs
2025-03-13 15:16:28,071 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 15:16:28,071 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 15:16:52,246 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1742 secs
2025-03-13 15:16:52,248 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7495 secs
2025-03-13 15:16:52,248 [INFO]: {
2025-03-13 15:16:52,248 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:52,248 [INFO]: 	index_param: efSearch=269
2025-03-13 15:16:52,248 [INFO]: 	index_path: knn.index
2025-03-13 15:16:52,248 [INFO]: 	size in bytes: 398800090
2025-03-13 15:16:52,248 [INFO]: 	avg_search_speed_ms: 10.48194390132953
2025-03-13 15:16:52,248 [INFO]: 	99p_search_speed_ms: 16.350269196555022
2025-03-13 15:16:52,248 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:52,248 [INFO]: 	nb vectors: 2027
2025-03-13 15:16:52,248 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:52,248 [INFO]: 	compression ratio: 0.9993087413796722
2025-03-13 15:16:52,248 [INFO]: }
2025-03-13 15:16:52,248 [INFO]: 	>>> Finished "Creating the index" in 54.7526 secs
2025-03-13 15:16:52,248 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7927 secs
2025-03-13 15:16:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 31802 [episode count 3/20]
[retrieval_preprocessing] for episode 77377 [episode count 4/20], we have num_retrieval=np.int64(1998) num_query=np.int64(121)
2025-03-13 15:16:53,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:54,343 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:54
2025-03-13 15:16:54,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  6.99it/s]100%|██████████| 1/1 [00:00<00:00,  6.94it/s]
2025-03-13 15:16:54,514 [INFO]: There are 1998 embeddings of dim 49152
2025-03-13 15:16:54,515 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1719 secs
2025-03-13 15:16:54,515 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:54
2025-03-13 15:16:54,515 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:54,516 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:16:54,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:54,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:16:54,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:54
2025-03-13 15:16:54,516 [INFO]: 412.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:54,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:16:54,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:54
2025-03-13 15:16:54,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:54,517 [INFO]: 	Creating the index 03/13/2025, 15:16:54
2025-03-13 15:16:54,517 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:54
2025-03-13 15:16:54,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:16:54,520 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:54
2025-03-13 15:16:54,520 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:16:54,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.68it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.04it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.80it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.36it/s]100%|██████████| 8/8 [00:02<00:00,  3.78it/s]
2025-03-13 15:16:57,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:57
2025-03-13 15:17:22,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2365 secs
2025-03-13 15:17:22,029 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 15:17:22,029 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.94it/s]
2025-03-13 15:17:37,622 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5930 secs
2025-03-13 15:17:37,625 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1055 secs
2025-03-13 15:17:37,626 [INFO]: {
2025-03-13 15:17:37,626 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:37,626 [INFO]: 	index_param: efSearch=250
2025-03-13 15:17:37,626 [INFO]: 	index_path: knn.index
2025-03-13 15:17:37,626 [INFO]: 	size in bytes: 393094450
2025-03-13 15:17:37,626 [INFO]: 	avg_search_speed_ms: 10.603926108245394
2025-03-13 15:17:37,626 [INFO]: 	99p_search_speed_ms: 16.062054042704407
2025-03-13 15:17:37,626 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:37,626 [INFO]: 	nb vectors: 1998
2025-03-13 15:17:37,626 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:37,626 [INFO]: 	compression ratio: 0.9993089040051316
2025-03-13 15:17:37,626 [INFO]: }
2025-03-13 15:17:37,626 [INFO]: 	>>> Finished "Creating the index" in 43.1092 secs
2025-03-13 15:17:37,626 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2830 secs
2025-03-13 15:17:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 77377 [episode count 4/20]
[retrieval_preprocessing] for episode 92245 [episode count 5/20], we have num_retrieval=np.int64(2010) num_query=np.int64(109)
2025-03-13 15:17:40,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:40,928 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:40
2025-03-13 15:17:40,928 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.25it/s]
2025-03-13 15:17:40,956 [INFO]: There are 2010 embeddings of dim 49152
2025-03-13 15:17:40,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:17:40,957 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:40
2025-03-13 15:17:40,957 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:40,958 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:17:40,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:40,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:17:40,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:40
2025-03-13 15:17:40,958 [INFO]: 414.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:40,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:17:40,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:40
2025-03-13 15:17:40,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:40,959 [INFO]: 	Creating the index 03/13/2025, 15:17:40
2025-03-13 15:17:40,959 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:40
2025-03-13 15:17:40,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:17:40,963 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:40
2025-03-13 15:17:40,963 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:17:40,963 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.76it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.29it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.80it/s] 50%|█████     | 4/8 [00:00<00:00,  7.72it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.75it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.74it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.64it/s]100%|██████████| 8/8 [00:03<00:00,  1.08it/s]100%|██████████| 8/8 [00:03<00:00,  2.24it/s]
2025-03-13 15:17:44,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:44
2025-03-13 15:18:15,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9160 secs
2025-03-13 15:18:15,452 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 15:18:15,453 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 15:18:34,888 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4356 secs
2025-03-13 15:18:34,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9276 secs
2025-03-13 15:18:34,891 [INFO]: {
2025-03-13 15:18:34,891 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:34,891 [INFO]: 	index_param: efSearch=264
2025-03-13 15:18:34,891 [INFO]: 	index_path: knn.index
2025-03-13 15:18:34,891 [INFO]: 	size in bytes: 395455390
2025-03-13 15:18:34,891 [INFO]: 	avg_search_speed_ms: 10.327768141417264
2025-03-13 15:18:34,891 [INFO]: 	99p_search_speed_ms: 14.138995208777493
2025-03-13 15:18:34,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:34,891 [INFO]: 	nb vectors: 2010
2025-03-13 15:18:34,891 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:34,891 [INFO]: 	compression ratio: 0.9993088727403614
2025-03-13 15:18:34,891 [INFO]: }
2025-03-13 15:18:34,891 [INFO]: 	>>> Finished "Creating the index" in 53.9316 secs
2025-03-13 15:18:34,891 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9627 secs
2025-03-13 15:18:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 92245 [episode count 5/20]
[retrieval_preprocessing] for episode 58971 [episode count 6/20], we have num_retrieval=np.int64(2025) num_query=np.int64(94)
2025-03-13 15:18:36,785 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:37,483 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:37
2025-03-13 15:18:37,483 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1987.82it/s]
2025-03-13 15:18:37,510 [INFO]: There are 2025 embeddings of dim 49152
2025-03-13 15:18:37,511 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 15:18:37,511 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:37
2025-03-13 15:18:37,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:37,511 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:18:37,511 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:37,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:18:37,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:37
2025-03-13 15:18:37,512 [INFO]: 417.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:37,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:18:37,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:37
2025-03-13 15:18:37,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:37,512 [INFO]: 	Creating the index 03/13/2025, 15:18:37
2025-03-13 15:18:37,513 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:37
2025-03-13 15:18:37,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:18:37,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:37
2025-03-13 15:18:37,516 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:18:37,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.14it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.23it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.43it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.55it/s]100%|██████████| 8/8 [00:02<00:00,  3.22it/s]
2025-03-13 15:18:40,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:40
2025-03-13 15:19:02,796 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7865 secs
2025-03-13 15:19:02,797 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 15:19:02,797 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-13 15:19:24,434 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6374 secs
2025-03-13 15:19:24,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9206 secs
2025-03-13 15:19:24,437 [INFO]: {
2025-03-13 15:19:24,437 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:24,437 [INFO]: 	index_param: efSearch=217
2025-03-13 15:19:24,437 [INFO]: 	index_path: knn.index
2025-03-13 15:19:24,437 [INFO]: 	size in bytes: 398406610
2025-03-13 15:19:24,437 [INFO]: 	avg_search_speed_ms: 9.813492423310963
2025-03-13 15:19:24,437 [INFO]: 	99p_search_speed_ms: 17.8904404118657
2025-03-13 15:19:24,437 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:24,437 [INFO]: 	nb vectors: 2025
2025-03-13 15:19:24,437 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:24,437 [INFO]: 	compression ratio: 0.9993087213086148
2025-03-13 15:19:24,437 [INFO]: }
2025-03-13 15:19:24,437 [INFO]: 	>>> Finished "Creating the index" in 46.9244 secs
2025-03-13 15:19:24,437 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9542 secs
2025-03-13 15:19:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 58971 [episode count 6/20]
[retrieval_preprocessing] for episode 45150 [episode count 7/20], we have num_retrieval=np.int64(2031) num_query=np.int64(88)
2025-03-13 15:19:25,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:26,274 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:26
2025-03-13 15:19:26,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-13 15:19:26,300 [INFO]: There are 2031 embeddings of dim 49152
2025-03-13 15:19:26,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 15:19:26,300 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:26,300 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:19:26,300 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:26,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:26,300 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,300 [INFO]: 419.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:26,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:19:26,300 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:26
2025-03-13 15:19:26,300 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:26,300 [INFO]: 	Creating the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,300 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:26
2025-03-13 15:19:26,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:19:26,301 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:26
2025-03-13 15:19:26,301 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:19:26,301 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.61it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.69it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.82it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.46it/s]100%|██████████| 8/8 [00:02<00:00,  3.70it/s]
2025-03-13 15:19:28,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:28
2025-03-13 15:19:58,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9777 secs
2025-03-13 15:19:58,455 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 15:19:58,455 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.35s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.34it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.69it/s]
2025-03-13 15:20:18,662 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2071 secs
2025-03-13 15:20:18,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3631 secs
2025-03-13 15:20:18,665 [INFO]: {
2025-03-13 15:20:18,665 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:18,665 [INFO]: 	index_param: efSearch=186
2025-03-13 15:20:18,665 [INFO]: 	index_path: knn.index
2025-03-13 15:20:18,665 [INFO]: 	size in bytes: 399587050
2025-03-13 15:20:18,665 [INFO]: 	avg_search_speed_ms: 9.146354693113354
2025-03-13 15:20:18,665 [INFO]: 	99p_search_speed_ms: 14.921958763152345
2025-03-13 15:20:18,665 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:18,665 [INFO]: 	nb vectors: 2031
2025-03-13 15:20:18,665 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:18,665 [INFO]: 	compression ratio: 0.9993087814032011
2025-03-13 15:20:18,665 [INFO]: }
2025-03-13 15:20:18,665 [INFO]: 	>>> Finished "Creating the index" in 52.3646 secs
2025-03-13 15:20:18,665 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3906 secs
2025-03-13 15:20:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 45150 [episode count 7/20]
[retrieval_preprocessing] for episode 70243 [episode count 8/20], we have num_retrieval=np.int64(2005) num_query=np.int64(114)
2025-03-13 15:20:20,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:20,780 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:20
2025-03-13 15:20:20,780 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.99it/s]
2025-03-13 15:20:20,804 [INFO]: There are 2005 embeddings of dim 49152
2025-03-13 15:20:20,805 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 15:20:20,805 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,805 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:20,805 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:20:20,805 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:20,805 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:20,805 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,805 [INFO]: 413.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:20,805 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:20:20,805 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:20
2025-03-13 15:20:20,805 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:20,805 [INFO]: 	Creating the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,805 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:20
2025-03-13 15:20:20,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:20:20,806 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,806 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:20:20,806 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.35it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.19it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.41it/s] 50%|█████     | 4/8 [00:00<00:00,  7.37it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.19it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.01it/s] 88%|████████▊ | 7/8 [00:00<00:00,  6.97it/s]100%|██████████| 8/8 [00:02<00:00,  1.61it/s]100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
2025-03-13 15:20:23,458 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:23
2025-03-13 15:20:57,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8960 secs
2025-03-13 15:20:57,355 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 15:20:57,355 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 15:21:16,775 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4197 secs
2025-03-13 15:21:16,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9706 secs
2025-03-13 15:21:16,777 [INFO]: {
2025-03-13 15:21:16,777 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:16,777 [INFO]: 	index_param: efSearch=242
2025-03-13 15:21:16,777 [INFO]: 	index_path: knn.index
2025-03-13 15:21:16,777 [INFO]: 	size in bytes: 394471630
2025-03-13 15:21:16,777 [INFO]: 	avg_search_speed_ms: 10.743514786721493
2025-03-13 15:21:16,777 [INFO]: 	99p_search_speed_ms: 16.3735650246963
2025-03-13 15:21:16,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:16,777 [INFO]: 	nb vectors: 2005
2025-03-13 15:21:16,777 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:16,777 [INFO]: 	compression ratio: 0.9993089743868273
2025-03-13 15:21:16,777 [INFO]: }
2025-03-13 15:21:16,778 [INFO]: 	>>> Finished "Creating the index" in 55.9723 secs
2025-03-13 15:21:16,778 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9974 secs
2025-03-13 15:21:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 70243 [episode count 8/20]
[retrieval_preprocessing] for episode 30319 [episode count 9/20], we have num_retrieval=np.int64(2009) num_query=np.int64(110)
2025-03-13 15:21:18,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:19,476 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:19
2025-03-13 15:21:19,476 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.81it/s]
2025-03-13 15:21:20,267 [INFO]: There are 2009 embeddings of dim 49152
2025-03-13 15:21:20,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7914 secs
2025-03-13 15:21:20,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:20
2025-03-13 15:21:20,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:20,268 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:21:20,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:20,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:21:20,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:20
2025-03-13 15:21:20,269 [INFO]: 414.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:20,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:21:20,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:20
2025-03-13 15:21:20,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:20,269 [INFO]: 	Creating the index 03/13/2025, 15:21:20
2025-03-13 15:21:20,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:20
2025-03-13 15:21:20,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:21:20,272 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:20
2025-03-13 15:21:20,272 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:21:20,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.83it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.70it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.64it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.11it/s]100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
2025-03-13 15:21:22,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:22
2025-03-13 15:21:55,214 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6724 secs
2025-03-13 15:21:55,214 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:21:55,215 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 15:22:18,301 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0863 secs
2025-03-13 15:22:18,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0312 secs
2025-03-13 15:22:18,303 [INFO]: {
2025-03-13 15:22:18,303 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:18,303 [INFO]: 	index_param: efSearch=193
2025-03-13 15:22:18,303 [INFO]: 	index_path: knn.index
2025-03-13 15:22:18,303 [INFO]: 	size in bytes: 395258650
2025-03-13 15:22:18,303 [INFO]: 	avg_search_speed_ms: 9.012577497224829
2025-03-13 15:22:18,303 [INFO]: 	99p_search_speed_ms: 18.774536615237647
2025-03-13 15:22:18,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:18,303 [INFO]: 	nb vectors: 2009
2025-03-13 15:22:18,303 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:18,303 [INFO]: 	compression ratio: 0.9993088626902915
2025-03-13 15:22:18,303 [INFO]: }
2025-03-13 15:22:18,303 [INFO]: 	>>> Finished "Creating the index" in 58.0340 secs
2025-03-13 15:22:18,303 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8269 secs
2025-03-13 15:22:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 30319 [episode count 9/20]
[retrieval_preprocessing] for episode 5751 [episode count 10/20], we have num_retrieval=np.int64(2030) num_query=np.int64(89)
2025-03-13 15:22:19,785 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:20,114 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:20
2025-03-13 15:22:20,114 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.14it/s]
2025-03-13 15:22:20,140 [INFO]: There are 2030 embeddings of dim 49152
2025-03-13 15:22:20,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:22:20,141 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:20
2025-03-13 15:22:20,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:20,141 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:22:20,141 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:20,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:22:20,141 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:20
2025-03-13 15:22:20,141 [INFO]: 418.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:20,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:22:20,141 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:20
2025-03-13 15:22:20,141 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:20,141 [INFO]: 	Creating the index 03/13/2025, 15:22:20
2025-03-13 15:22:20,141 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:20
2025-03-13 15:22:20,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:22:20,142 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:20
2025-03-13 15:22:20,143 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:22:20,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.43it/s] 38%|███▊      | 3/8 [00:00<00:00, 12.11it/s] 62%|██████▎   | 5/8 [00:00<00:00, 13.64it/s] 88%|████████▊ | 7/8 [00:00<00:00, 14.29it/s]100%|██████████| 8/8 [00:01<00:00,  4.23it/s]
2025-03-13 15:22:22,040 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:22
2025-03-13 15:22:50,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3935 secs
2025-03-13 15:22:50,434 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 15:22:50,434 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-13 15:23:12,827 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3928 secs
2025-03-13 15:23:12,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6866 secs
2025-03-13 15:23:12,829 [INFO]: {
2025-03-13 15:23:12,829 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:12,829 [INFO]: 	index_param: efSearch=248
2025-03-13 15:23:12,829 [INFO]: 	index_path: knn.index
2025-03-13 15:23:12,829 [INFO]: 	size in bytes: 399390310
2025-03-13 15:23:12,829 [INFO]: 	avg_search_speed_ms: 10.018280157735488
2025-03-13 15:23:12,829 [INFO]: 	99p_search_speed_ms: 14.174603102728723
2025-03-13 15:23:12,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:12,829 [INFO]: 	nb vectors: 2030
2025-03-13 15:23:12,829 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:12,829 [INFO]: 	compression ratio: 0.9993087714121056
2025-03-13 15:23:12,829 [INFO]: }
2025-03-13 15:23:12,830 [INFO]: 	>>> Finished "Creating the index" in 52.6882 secs
2025-03-13 15:23:12,830 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7152 secs
2025-03-13 15:23:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 5751 [episode count 10/20]
[retrieval_preprocessing] for episode 62589 [episode count 11/20], we have num_retrieval=np.int64(2001) num_query=np.int64(118)
2025-03-13 15:23:16,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:17,920 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:17
2025-03-13 15:23:17,920 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1353.44it/s]
2025-03-13 15:23:17,946 [INFO]: There are 2001 embeddings of dim 49152
2025-03-13 15:23:17,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:23:17,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:17
2025-03-13 15:23:17,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:17,947 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:23:17,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:17,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:23:17,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:17
2025-03-13 15:23:17,947 [INFO]: 413.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:17,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:23:17,947 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:17
2025-03-13 15:23:17,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:17,947 [INFO]: 	Creating the index 03/13/2025, 15:23:17
2025-03-13 15:23:17,947 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:17
2025-03-13 15:23:17,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:23:17,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:17
2025-03-13 15:23:17,948 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:23:17,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.07it/s] 38%|███▊      | 3/8 [00:00<00:00, 11.26it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.67it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.11it/s]100%|██████████| 8/8 [00:02<00:00,  1.65it/s]100%|██████████| 8/8 [00:02<00:00,  2.68it/s]
2025-03-13 15:23:20,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:20
2025-03-13 15:23:49,951 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0060 secs
2025-03-13 15:23:49,951 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 15:23:49,952 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.99it/s]
2025-03-13 15:24:08,075 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1238 secs
2025-03-13 15:24:08,291 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3426 secs
2025-03-13 15:24:08,291 [INFO]: {
2025-03-13 15:24:08,291 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:08,291 [INFO]: 	index_param: efSearch=226
2025-03-13 15:24:08,292 [INFO]: 	index_path: knn.index
2025-03-13 15:24:08,292 [INFO]: 	size in bytes: 393684670
2025-03-13 15:24:08,292 [INFO]: 	avg_search_speed_ms: 11.23060150658367
2025-03-13 15:24:08,292 [INFO]: 	99p_search_speed_ms: 16.73297118395567
2025-03-13 15:24:08,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:08,292 [INFO]: 	nb vectors: 2001
2025-03-13 15:24:08,292 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:08,292 [INFO]: 	compression ratio: 0.9993089342290112
2025-03-13 15:24:08,292 [INFO]: }
2025-03-13 15:24:08,292 [INFO]: 	>>> Finished "Creating the index" in 50.3452 secs
2025-03-13 15:24:08,292 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3721 secs
2025-03-13 15:24:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 62589 [episode count 11/20]
[retrieval_preprocessing] for episode 26251 [episode count 12/20], we have num_retrieval=np.int64(1994) num_query=np.int64(125)
2025-03-13 15:24:10,103 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:10,432 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:10
2025-03-13 15:24:10,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1541.46it/s]
2025-03-13 15:24:10,455 [INFO]: There are 1994 embeddings of dim 49152
2025-03-13 15:24:10,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 15:24:10,455 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:10
2025-03-13 15:24:10,455 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:10,455 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:24:10,455 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:10,455 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:10,455 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:10
2025-03-13 15:24:10,455 [INFO]: 411.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:10,455 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:24:10,455 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:10
2025-03-13 15:24:10,455 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:10,455 [INFO]: 	Creating the index 03/13/2025, 15:24:10
2025-03-13 15:24:10,456 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:10
2025-03-13 15:24:10,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:24:10,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:10
2025-03-13 15:24:10,457 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:24:10,457 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.04it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.78it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.69it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.97it/s]100%|██████████| 8/8 [00:02<00:00,  2.07it/s]100%|██████████| 8/8 [00:02<00:00,  3.22it/s]
2025-03-13 15:24:12,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:12
2025-03-13 15:24:42,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2383 secs
2025-03-13 15:24:42,186 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 15:24:42,186 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 15:25:07,270 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0834 secs
2025-03-13 15:25:07,272 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8157 secs
2025-03-13 15:25:07,272 [INFO]: {
2025-03-13 15:25:07,273 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:07,273 [INFO]: 	index_param: efSearch=250
2025-03-13 15:25:07,273 [INFO]: 	index_path: knn.index
2025-03-13 15:25:07,273 [INFO]: 	size in bytes: 392307490
2025-03-13 15:25:07,273 [INFO]: 	avg_search_speed_ms: 12.077308619554618
2025-03-13 15:25:07,273 [INFO]: 	99p_search_speed_ms: 22.967867983970816
2025-03-13 15:25:07,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:07,273 [INFO]: 	nb vectors: 1994
2025-03-13 15:25:07,273 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:07,273 [INFO]: 	compression ratio: 0.999308863565159
2025-03-13 15:25:07,273 [INFO]: }
2025-03-13 15:25:07,273 [INFO]: 	>>> Finished "Creating the index" in 56.8172 secs
2025-03-13 15:25:07,273 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8403 secs
2025-03-13 15:25:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 26251 [episode count 12/20]
[retrieval_preprocessing] for episode 35483 [episode count 13/20], we have num_retrieval=np.int64(2004) num_query=np.int64(115)
2025-03-13 15:25:09,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:09,780 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:09
2025-03-13 15:25:09,780 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.17it/s]
2025-03-13 15:25:09,806 [INFO]: There are 2004 embeddings of dim 49152
2025-03-13 15:25:09,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:25:09,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:09
2025-03-13 15:25:09,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:09,807 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:25:09,807 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:09,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:09,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:09
2025-03-13 15:25:09,807 [INFO]: 413.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:09,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:25:09,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:09
2025-03-13 15:25:09,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:09,807 [INFO]: 	Creating the index 03/13/2025, 15:25:09
2025-03-13 15:25:09,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:09
2025-03-13 15:25:09,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:25:09,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:09
2025-03-13 15:25:09,809 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:25:09,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.25it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.35it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.05it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.22it/s]100%|██████████| 8/8 [00:02<00:00,  3.81it/s]
2025-03-13 15:25:11,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:11
2025-03-13 15:25:40,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6179 secs
2025-03-13 15:25:40,538 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 15:25:40,538 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]
2025-03-13 15:26:00,033 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4947 secs
2025-03-13 15:26:00,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2259 secs
2025-03-13 15:26:00,035 [INFO]: {
2025-03-13 15:26:00,035 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:00,035 [INFO]: 	index_param: efSearch=243
2025-03-13 15:26:00,035 [INFO]: 	index_path: knn.index
2025-03-13 15:26:00,035 [INFO]: 	size in bytes: 394274890
2025-03-13 15:26:00,035 [INFO]: 	avg_search_speed_ms: 9.947072411308167
2025-03-13 15:26:00,035 [INFO]: 	99p_search_speed_ms: 14.275793526321653
2025-03-13 15:26:00,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:00,035 [INFO]: 	nb vectors: 2004
2025-03-13 15:26:00,035 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:00,035 [INFO]: 	compression ratio: 0.9993089643624021
2025-03-13 15:26:00,035 [INFO]: }
2025-03-13 15:26:00,035 [INFO]: 	>>> Finished "Creating the index" in 50.2278 secs
2025-03-13 15:26:00,035 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2545 secs
2025-03-13 15:26:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 35483 [episode count 13/20]
[retrieval_preprocessing] for episode 18590 [episode count 14/20], we have num_retrieval=np.int64(2030) num_query=np.int64(89)
2025-03-13 15:26:01,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:02,157 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:02
2025-03-13 15:26:02,157 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-13 15:26:02,184 [INFO]: There are 2030 embeddings of dim 49152
2025-03-13 15:26:02,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:26:02,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:02
2025-03-13 15:26:02,185 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:02,185 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:26:02,185 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:02,185 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:02,185 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:02
2025-03-13 15:26:02,185 [INFO]: 418.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:02,185 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:02,185 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:02
2025-03-13 15:26:02,185 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:02,185 [INFO]: 	Creating the index 03/13/2025, 15:26:02
2025-03-13 15:26:02,185 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:02
2025-03-13 15:26:02,186 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:26:02,186 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:02
2025-03-13 15:26:02,186 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:26:02,187 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.67it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.21it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.94it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.08it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.81it/s]100%|██████████| 8/8 [00:02<00:00,  3.80it/s]
2025-03-13 15:26:04,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:04
2025-03-13 15:26:31,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1442 secs
2025-03-13 15:26:31,445 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:26:31,445 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.34it/s] 50%|█████     | 2/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 15:26:52,751 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3058 secs
2025-03-13 15:26:52,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5667 secs
2025-03-13 15:26:52,753 [INFO]: {
2025-03-13 15:26:52,753 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:52,753 [INFO]: 	index_param: efSearch=211
2025-03-13 15:26:52,753 [INFO]: 	index_path: knn.index
2025-03-13 15:26:52,753 [INFO]: 	size in bytes: 399390310
2025-03-13 15:26:52,753 [INFO]: 	avg_search_speed_ms: 9.556775342140625
2025-03-13 15:26:52,753 [INFO]: 	99p_search_speed_ms: 14.079346542712292
2025-03-13 15:26:52,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:52,753 [INFO]: 	nb vectors: 2030
2025-03-13 15:26:52,753 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:52,753 [INFO]: 	compression ratio: 0.9993087714121056
2025-03-13 15:26:52,753 [INFO]: }
2025-03-13 15:26:52,753 [INFO]: 	>>> Finished "Creating the index" in 50.5683 secs
2025-03-13 15:26:52,753 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5963 secs
2025-03-13 15:26:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 18590 [episode count 14/20]
[retrieval_preprocessing] for episode 86698 [episode count 15/20], we have num_retrieval=np.int64(2018) num_query=np.int64(101)
2025-03-13 15:26:54,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:54,792 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:54
2025-03-13 15:26:54,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.65it/s]
2025-03-13 15:26:54,816 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 15:26:54,816 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 15:26:54,816 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:54
2025-03-13 15:26:54,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:54,816 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:26:54,816 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:54,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:54,816 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:54
2025-03-13 15:26:54,816 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:54,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:26:54,816 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:54
2025-03-13 15:26:54,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:54,816 [INFO]: 	Creating the index 03/13/2025, 15:26:54
2025-03-13 15:26:54,816 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:54
2025-03-13 15:26:54,817 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:26:54,817 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:54
2025-03-13 15:26:54,817 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:26:54,817 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.18it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.02it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.86it/s] 50%|█████     | 4/8 [00:00<00:00,  8.23it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.54it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.72it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.86it/s]100%|██████████| 8/8 [00:02<00:00,  1.73it/s]100%|██████████| 8/8 [00:02<00:00,  3.30it/s]
2025-03-13 15:26:57,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:57
2025-03-13 15:27:27,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8637 secs
2025-03-13 15:27:27,113 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 15:27:27,113 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s]
2025-03-13 15:27:48,375 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2615 secs
2025-03-13 15:27:48,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5596 secs
2025-03-13 15:27:48,377 [INFO]: {
2025-03-13 15:27:48,377 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:48,377 [INFO]: 	index_param: efSearch=255
2025-03-13 15:27:48,377 [INFO]: 	index_path: knn.index
2025-03-13 15:27:48,377 [INFO]: 	size in bytes: 397029310
2025-03-13 15:27:48,377 [INFO]: 	avg_search_speed_ms: 10.327119633511154
2025-03-13 15:27:48,377 [INFO]: 	99p_search_speed_ms: 13.543540367390968
2025-03-13 15:27:48,377 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:48,377 [INFO]: 	nb vectors: 2018
2025-03-13 15:27:48,377 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:48,377 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 15:27:48,377 [INFO]: }
2025-03-13 15:27:48,377 [INFO]: 	>>> Finished "Creating the index" in 53.5609 secs
2025-03-13 15:27:48,377 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5846 secs
2025-03-13 15:27:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 86698 [episode count 15/20]
[retrieval_preprocessing] for episode 22189 [episode count 16/20], we have num_retrieval=np.int64(2018) num_query=np.int64(101)
2025-03-13 15:27:50,189 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:50,577 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:50
2025-03-13 15:27:50,577 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.83it/s]
2025-03-13 15:27:50,602 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 15:27:50,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:27:50,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:50,603 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:27:50,603 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:50,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:50,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,603 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:50,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:27:50,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:50
2025-03-13 15:27:50,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:50,603 [INFO]: 	Creating the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:50
2025-03-13 15:27:50,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:27:50,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,604 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:27:50,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.49it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.34it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.23it/s] 50%|█████     | 4/8 [00:00<00:00,  8.59it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.81it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.09it/s]100%|██████████| 8/8 [00:02<00:00,  2.61it/s]100%|██████████| 8/8 [00:02<00:00,  3.92it/s]
2025-03-13 15:27:52,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:52
2025-03-13 15:28:25,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9428 secs
2025-03-13 15:28:25,596 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:28:25,596 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 15:28:49,398 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8011 secs
2025-03-13 15:28:49,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7957 secs
2025-03-13 15:28:49,400 [INFO]: {
2025-03-13 15:28:49,400 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:49,400 [INFO]: 	index_param: efSearch=187
2025-03-13 15:28:49,400 [INFO]: 	index_path: knn.index
2025-03-13 15:28:49,400 [INFO]: 	size in bytes: 397029310
2025-03-13 15:28:49,400 [INFO]: 	avg_search_speed_ms: 9.79776439976666
2025-03-13 15:28:49,400 [INFO]: 	99p_search_speed_ms: 15.794359100982545
2025-03-13 15:28:49,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:49,400 [INFO]: 	nb vectors: 2018
2025-03-13 15:28:49,400 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:49,400 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 15:28:49,400 [INFO]: }
2025-03-13 15:28:49,401 [INFO]: 	>>> Finished "Creating the index" in 58.7975 secs
2025-03-13 15:28:49,401 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8236 secs
2025-03-13 15:28:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 22189 [episode count 16/20]
[retrieval_preprocessing] for episode 90816 [episode count 17/20], we have num_retrieval=np.int64(2012) num_query=np.int64(107)
2025-03-13 15:28:51,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:51,484 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:51
2025-03-13 15:28:51,484 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.77it/s]
2025-03-13 15:28:51,510 [INFO]: There are 2012 embeddings of dim 49152
2025-03-13 15:28:51,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:28:51,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:51
2025-03-13 15:28:51,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:51,510 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:28:51,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:51,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:51,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:51
2025-03-13 15:28:51,511 [INFO]: 415.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:51,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:28:51,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:51
2025-03-13 15:28:51,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:51,511 [INFO]: 	Creating the index 03/13/2025, 15:28:51
2025-03-13 15:28:51,511 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:51
2025-03-13 15:28:51,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:28:51,512 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:51
2025-03-13 15:28:51,512 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:28:51,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.61it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.30it/s] 50%|█████     | 4/8 [00:00<00:00,  8.47it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.24it/s]100%|██████████| 8/8 [00:02<00:00,  2.07it/s]100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
2025-03-13 15:28:54,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:54
2025-03-13 15:29:29,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1056 secs
2025-03-13 15:29:29,347 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 15:29:29,347 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.12it/s]
2025-03-13 15:29:53,081 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7340 secs
2025-03-13 15:29:53,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5715 secs
2025-03-13 15:29:53,084 [INFO]: {
2025-03-13 15:29:53,084 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:53,084 [INFO]: 	index_param: efSearch=210
2025-03-13 15:29:53,084 [INFO]: 	index_path: knn.index
2025-03-13 15:29:53,084 [INFO]: 	size in bytes: 395848870
2025-03-13 15:29:53,084 [INFO]: 	avg_search_speed_ms: 8.830506819614634
2025-03-13 15:29:53,084 [INFO]: 	99p_search_speed_ms: 15.611030710861089
2025-03-13 15:29:53,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:53,084 [INFO]: 	nb vectors: 2012
2025-03-13 15:29:53,084 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:53,084 [INFO]: 	compression ratio: 0.9993088928105315
2025-03-13 15:29:53,084 [INFO]: }
2025-03-13 15:29:53,084 [INFO]: 	>>> Finished "Creating the index" in 61.5734 secs
2025-03-13 15:29:53,084 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6000 secs
2025-03-13 15:29:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 90816 [episode count 17/20]
[retrieval_preprocessing] for episode 66247 [episode count 18/20], we have num_retrieval=np.int64(2022) num_query=np.int64(97)
2025-03-13 15:29:55,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:55,992 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:55
2025-03-13 15:29:55,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-13 15:29:56,019 [INFO]: There are 2022 embeddings of dim 49152
2025-03-13 15:29:56,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 15:29:56,020 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:56,020 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:29:56,020 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:56,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:29:56,020 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,020 [INFO]: 417.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:56,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:29:56,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:56
2025-03-13 15:29:56,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:56,021 [INFO]: 	Creating the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:56
2025-03-13 15:29:56,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:29:56,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,024 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:29:56,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  3.89it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.13it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.00it/s] 50%|█████     | 4/8 [00:00<00:00,  6.54it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.92it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.27it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.40it/s]100%|██████████| 8/8 [00:02<00:00,  1.53it/s]100%|██████████| 8/8 [00:02<00:00,  2.84it/s]
2025-03-13 15:29:58,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:58
2025-03-13 15:30:34,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2783 secs
2025-03-13 15:30:34,132 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 15:30:34,132 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-13 15:30:53,736 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6040 secs
2025-03-13 15:30:54,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0692 secs
2025-03-13 15:30:54,094 [INFO]: {
2025-03-13 15:30:54,094 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:54,094 [INFO]: 	index_param: efSearch=213
2025-03-13 15:30:54,094 [INFO]: 	index_path: knn.index
2025-03-13 15:30:54,094 [INFO]: 	size in bytes: 397816330
2025-03-13 15:30:54,094 [INFO]: 	avg_search_speed_ms: 9.872749252915971
2025-03-13 15:30:54,094 [INFO]: 	99p_search_speed_ms: 19.12018882110715
2025-03-13 15:30:54,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:54,094 [INFO]: 	nb vectors: 2022
2025-03-13 15:30:54,095 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:54,095 [INFO]: 	compression ratio: 0.9993088418466884
2025-03-13 15:30:54,095 [INFO]: }
2025-03-13 15:30:54,095 [INFO]: 	>>> Finished "Creating the index" in 58.0734 secs
2025-03-13 15:30:54,095 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1028 secs
2025-03-13 15:30:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 66247 [episode count 18/20]
[retrieval_preprocessing] for episode 55519 [episode count 19/20], we have num_retrieval=np.int64(2020) num_query=np.int64(99)
2025-03-13 15:30:55,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:56,182 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:56
2025-03-13 15:30:56,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.11it/s]
2025-03-13 15:30:56,208 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 15:30:56,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 15:30:56,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:56
2025-03-13 15:30:56,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:56,209 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:30:56,209 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:56,209 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:30:56,209 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:56
2025-03-13 15:30:56,209 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:56,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:30:56,209 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:56
2025-03-13 15:30:56,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:56,209 [INFO]: 	Creating the index 03/13/2025, 15:30:56
2025-03-13 15:30:56,209 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:56
2025-03-13 15:30:56,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:30:56,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:56
2025-03-13 15:30:56,210 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:30:56,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.82it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.26it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.35it/s] 50%|█████     | 4/8 [00:00<00:00,  7.54it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.66it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.60it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.59it/s]100%|██████████| 8/8 [00:02<00:00,  1.49it/s]100%|██████████| 8/8 [00:02<00:00,  2.87it/s]
2025-03-13 15:30:59,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:59
2025-03-13 15:31:27,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3346 secs
2025-03-13 15:31:27,343 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:31:27,343 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s]
2025-03-13 15:31:51,596 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2524 secs
2025-03-13 15:31:51,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3876 secs
2025-03-13 15:31:51,599 [INFO]: {
2025-03-13 15:31:51,599 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:51,599 [INFO]: 	index_param: efSearch=202
2025-03-13 15:31:51,599 [INFO]: 	index_path: knn.index
2025-03-13 15:31:51,599 [INFO]: 	size in bytes: 397422850
2025-03-13 15:31:51,599 [INFO]: 	avg_search_speed_ms: 7.983441798413654
2025-03-13 15:31:51,599 [INFO]: 	99p_search_speed_ms: 12.073461103718731
2025-03-13 15:31:51,599 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:51,599 [INFO]: 	nb vectors: 2020
2025-03-13 15:31:51,599 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:51,599 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 15:31:51,599 [INFO]: }
2025-03-13 15:31:51,599 [INFO]: 	>>> Finished "Creating the index" in 55.3899 secs
2025-03-13 15:31:51,599 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4165 secs
2025-03-13 15:31:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 55519 [episode count 19/20]
2025-03-13 15:31:52: [retrieval_preprocessing] finished for 164628080_put_rubber_duck_in_pot [chosen_id count 1/196]
2025-03-13 15:31:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_can_in_bowl [chosen_id count 2/196]
2025-03-13 15:31:58: [retrieval_preprocessing] we have num_total=4535 embedding_dim=49152
[retrieval_preprocessing] for episode 20490 [episode count 0/20], we have num_retrieval=np.int64(4275) num_query=np.int64(260)
2025-03-13 15:32:00,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:01,117 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:01
2025-03-13 15:32:01,117 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 973.83it/s]
2025-03-13 15:32:01,142 [INFO]: There are 4275 embeddings of dim 49152
2025-03-13 15:32:01,142 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 15:32:01,142 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:01
2025-03-13 15:32:01,142 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:01,142 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:32:01,142 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:01,142 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:01,142 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:01
2025-03-13 15:32:01,142 [INFO]: 882.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:01,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:01,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:01
2025-03-13 15:32:01,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:01,143 [INFO]: 	Creating the index 03/13/2025, 15:32:01
2025-03-13 15:32:01,143 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:01
2025-03-13 15:32:01,144 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:32:01,144 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:01
2025-03-13 15:32:01,144 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:32:01,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.47it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.98it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.85it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.51it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.77it/s] 41%|████      | 7/17 [00:00<00:01,  9.03it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.28it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.26it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.79it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.43it/s] 71%|███████   | 12/17 [00:01<00:00,  8.46it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.14it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.66it/s]100%|██████████| 17/17 [00:06<00:00,  1.03s/it]100%|██████████| 17/17 [00:06<00:00,  2.76it/s]
2025-03-13 15:32:07,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:07
2025-03-13 15:33:01,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.9950 secs
2025-03-13 15:33:01,305 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 15:33:01,305 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.45it/s] 50%|█████     | 2/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.65it/s]
2025-03-13 15:33:25,608 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3026 secs
2025-03-13 15:33:25,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.4681 secs
2025-03-13 15:33:25,612 [INFO]: {
2025-03-13 15:33:25,612 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:25,612 [INFO]: 	index_param: efSearch=230
2025-03-13 15:33:25,612 [INFO]: 	index_path: knn.index
2025-03-13 15:33:25,612 [INFO]: 	size in bytes: 841080610
2025-03-13 15:33:25,612 [INFO]: 	avg_search_speed_ms: 10.736533336475283
2025-03-13 15:33:25,612 [INFO]: 	99p_search_speed_ms: 15.423945502843704
2025-03-13 15:33:25,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:25,612 [INFO]: 	nb vectors: 4275
2025-03-13 15:33:25,612 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:25,612 [INFO]: 	compression ratio: 0.9993087345100014
2025-03-13 15:33:25,612 [INFO]: }
2025-03-13 15:33:25,612 [INFO]: 	>>> Finished "Creating the index" in 84.4697 secs
2025-03-13 15:33:25,612 [INFO]: >>> Finished "Launching the whole pipeline" in 84.4949 secs
2025-03-13 15:33:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 20490 [episode count 0/20]
[retrieval_preprocessing] for episode 81964 [episode count 1/20], we have num_retrieval=np.int64(4324) num_query=np.int64(211)
2025-03-13 15:33:29,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:30,579 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:30
2025-03-13 15:33:30,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2223.92it/s]
2025-03-13 15:33:30,602 [INFO]: There are 4324 embeddings of dim 49152
2025-03-13 15:33:30,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 15:33:30,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:30
2025-03-13 15:33:30,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:30,602 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:33:30,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:30,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:30,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:30
2025-03-13 15:33:30,602 [INFO]: 892.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:30,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:33:30,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:30
2025-03-13 15:33:30,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:30,602 [INFO]: 	Creating the index 03/13/2025, 15:33:30
2025-03-13 15:33:30,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:30
2025-03-13 15:33:30,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:33:30,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:30
2025-03-13 15:33:30,604 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:33:30,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:04,  4.18it/s] 11%|█         | 2/18 [00:00<00:02,  6.25it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.53it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.31it/s] 44%|████▍     | 8/18 [00:00<00:00, 11.01it/s] 56%|█████▌    | 10/18 [00:00<00:00, 13.11it/s] 67%|██████▋   | 12/18 [00:01<00:00, 14.03it/s] 78%|███████▊  | 14/18 [00:01<00:00, 15.07it/s] 89%|████████▉ | 16/18 [00:01<00:00, 15.11it/s]100%|██████████| 18/18 [00:04<00:00,  1.99it/s]100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
2025-03-13 15:33:34,841 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:34
2025-03-13 15:34:23,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9562 secs
2025-03-13 15:34:23,799 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 15:34:23,799 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 15:34:46,191 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3921 secs
2025-03-13 15:34:46,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5906 secs
2025-03-13 15:34:46,195 [INFO]: {
2025-03-13 15:34:46,195 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:46,195 [INFO]: 	index_param: efSearch=169
2025-03-13 15:34:46,195 [INFO]: 	index_path: knn.index
2025-03-13 15:34:46,195 [INFO]: 	size in bytes: 850721170
2025-03-13 15:34:46,195 [INFO]: 	avg_search_speed_ms: 9.240716545155715
2025-03-13 15:34:46,195 [INFO]: 	99p_search_speed_ms: 14.42247358616442
2025-03-13 15:34:46,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:46,195 [INFO]: 	nb vectors: 4324
2025-03-13 15:34:46,195 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:46,195 [INFO]: 	compression ratio: 0.9993086124799269
2025-03-13 15:34:46,195 [INFO]: }
2025-03-13 15:34:46,195 [INFO]: 	>>> Finished "Creating the index" in 75.5923 secs
2025-03-13 15:34:46,195 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6158 secs
2025-03-13 15:34:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 81964 [episode count 1/20]
[retrieval_preprocessing] for episode 34872 [episode count 2/20], we have num_retrieval=np.int64(4313) num_query=np.int64(222)
2025-03-13 15:34:49,251 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:50,113 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:50
2025-03-13 15:34:50,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.72it/s]
2025-03-13 15:34:50,139 [INFO]: There are 4313 embeddings of dim 49152
2025-03-13 15:34:50,139 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:34:50,139 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:50
2025-03-13 15:34:50,139 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:50,139 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:34:50,139 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:50,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:50,139 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:50
2025-03-13 15:34:50,140 [INFO]: 890.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:50,140 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:50,140 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:50
2025-03-13 15:34:50,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:50,140 [INFO]: 	Creating the index 03/13/2025, 15:34:50
2025-03-13 15:34:50,140 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:50
2025-03-13 15:34:50,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:34:50,141 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:50
2025-03-13 15:34:50,141 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:34:50,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.09it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.90it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.32it/s] 41%|████      | 7/17 [00:00<00:00, 12.85it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.86it/s] 65%|██████▍   | 11/17 [00:00<00:00, 14.53it/s] 76%|███████▋  | 13/17 [00:01<00:00, 14.48it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.33it/s]100%|██████████| 17/17 [00:04<00:00,  1.64it/s]100%|██████████| 17/17 [00:04<00:00,  3.58it/s]
2025-03-13 15:34:54,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:54
2025-03-13 15:35:37,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2569 secs
2025-03-13 15:35:37,157 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 15:35:37,157 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 15:36:13,732 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5745 secs
2025-03-13 15:36:13,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5939 secs
2025-03-13 15:36:13,735 [INFO]: {
2025-03-13 15:36:13,735 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:13,735 [INFO]: 	index_param: efSearch=253
2025-03-13 15:36:13,735 [INFO]: 	index_path: knn.index
2025-03-13 15:36:13,735 [INFO]: 	size in bytes: 848556970
2025-03-13 15:36:13,735 [INFO]: 	avg_search_speed_ms: 10.786303846485021
2025-03-13 15:36:13,735 [INFO]: 	99p_search_speed_ms: 16.739986082538962
2025-03-13 15:36:13,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:13,735 [INFO]: 	nb vectors: 4313
2025-03-13 15:36:13,735 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:13,735 [INFO]: 	compression ratio: 0.9993086309808993
2025-03-13 15:36:13,735 [INFO]: }
2025-03-13 15:36:13,735 [INFO]: 	>>> Finished "Creating the index" in 83.5955 secs
2025-03-13 15:36:13,735 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6221 secs
2025-03-13 15:36:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 34872 [episode count 2/20]
[retrieval_preprocessing] for episode 26723 [episode count 3/20], we have num_retrieval=np.int64(4296) num_query=np.int64(239)
2025-03-13 15:36:18,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:19,342 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:19
2025-03-13 15:36:19,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.31it/s]
2025-03-13 15:36:19,368 [INFO]: There are 4296 embeddings of dim 49152
2025-03-13 15:36:19,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:36:19,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:19
2025-03-13 15:36:19,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:19,368 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:36:19,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:19,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:19,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:19
2025-03-13 15:36:19,368 [INFO]: 886.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:19,368 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:36:19,368 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:19
2025-03-13 15:36:19,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:19,368 [INFO]: 	Creating the index 03/13/2025, 15:36:19
2025-03-13 15:36:19,368 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:19
2025-03-13 15:36:19,369 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:36:19,370 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:19
2025-03-13 15:36:19,370 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:36:19,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.62it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.85it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.13it/s] 41%|████      | 7/17 [00:00<00:00, 11.05it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.67it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.99it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.91it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.51it/s]100%|██████████| 17/17 [00:04<00:00,  1.72it/s]100%|██████████| 17/17 [00:04<00:00,  3.67it/s]
2025-03-13 15:36:24,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:24
2025-03-13 15:37:12,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7727 secs
2025-03-13 15:37:12,787 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 15:37:12,787 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 15:37:35,372 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5847 secs
2025-03-13 15:37:35,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0074 secs
2025-03-13 15:37:35,377 [INFO]: {
2025-03-13 15:37:35,377 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:35,377 [INFO]: 	index_param: efSearch=203
2025-03-13 15:37:35,377 [INFO]: 	index_path: knn.index
2025-03-13 15:37:35,377 [INFO]: 	size in bytes: 845212330
2025-03-13 15:37:35,377 [INFO]: 	avg_search_speed_ms: 11.618247718640044
2025-03-13 15:37:35,377 [INFO]: 	99p_search_speed_ms: 19.108986295759657
2025-03-13 15:37:35,377 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:35,377 [INFO]: 	nb vectors: 4296
2025-03-13 15:37:35,377 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:35,377 [INFO]: 	compression ratio: 0.9993086210656676
2025-03-13 15:37:35,377 [INFO]: }
2025-03-13 15:37:35,377 [INFO]: 	>>> Finished "Creating the index" in 76.0090 secs
2025-03-13 15:37:35,377 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0349 secs
2025-03-13 15:37:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 26723 [episode count 3/20]
[retrieval_preprocessing] for episode 92396 [episode count 4/20], we have num_retrieval=np.int64(4336) num_query=np.int64(199)
2025-03-13 15:37:40,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:41,453 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:41
2025-03-13 15:37:41,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.74it/s]
2025-03-13 15:37:41,479 [INFO]: There are 4336 embeddings of dim 49152
2025-03-13 15:37:41,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:37:41,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:41
2025-03-13 15:37:41,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:41,480 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:37:41,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:41,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:37:41,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:41
2025-03-13 15:37:41,481 [INFO]: 894.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:41,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:37:41,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:41
2025-03-13 15:37:41,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:41,481 [INFO]: 	Creating the index 03/13/2025, 15:37:41
2025-03-13 15:37:41,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:41
2025-03-13 15:37:41,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 15:37:41,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:41
2025-03-13 15:37:41,486 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:37:41,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.60it/s] 11%|█         | 2/18 [00:00<00:02,  7.54it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.93it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.64it/s] 44%|████▍     | 8/18 [00:00<00:00, 10.03it/s] 56%|█████▌    | 10/18 [00:00<00:00, 11.62it/s] 67%|██████▋   | 12/18 [00:01<00:00, 12.94it/s] 78%|███████▊  | 14/18 [00:01<00:00, 12.42it/s] 89%|████████▉ | 16/18 [00:01<00:00, 11.70it/s]100%|██████████| 18/18 [00:05<00:00,  1.46it/s]100%|██████████| 18/18 [00:05<00:00,  3.30it/s]
2025-03-13 15:37:46,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:46
2025-03-13 15:38:32,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9253 secs
2025-03-13 15:38:32,871 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 15:38:32,871 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.21it/s] 50%|█████     | 2/4 [00:00<00:00,  3.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.83it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.99it/s]
2025-03-13 15:39:23,636 [INFO]: 	>>> Finished "Compute fast metrics" in 50.7644 secs
2025-03-13 15:39:23,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.1542 secs
2025-03-13 15:39:23,640 [INFO]: {
2025-03-13 15:39:23,640 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:23,640 [INFO]: 	index_param: efSearch=215
2025-03-13 15:39:23,640 [INFO]: 	index_path: knn.index
2025-03-13 15:39:23,640 [INFO]: 	size in bytes: 853082110
2025-03-13 15:39:23,640 [INFO]: 	avg_search_speed_ms: 9.838138332986457
2025-03-13 15:39:23,640 [INFO]: 	99p_search_speed_ms: 15.59095478150994
2025-03-13 15:39:23,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:23,640 [INFO]: 	nb vectors: 4336
2025-03-13 15:39:23,640 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:23,640 [INFO]: 	compression ratio: 0.9993085987936143
2025-03-13 15:39:23,640 [INFO]: }
2025-03-13 15:39:23,640 [INFO]: 	>>> Finished "Creating the index" in 102.1586 secs
2025-03-13 15:39:23,640 [INFO]: >>> Finished "Launching the whole pipeline" in 102.1872 secs
2025-03-13 15:39:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 92396 [episode count 4/20]
[retrieval_preprocessing] for episode 4347 [episode count 5/20], we have num_retrieval=np.int64(4375) num_query=np.int64(160)
2025-03-13 15:39:27,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:28,081 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:28
2025-03-13 15:39:28,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.82it/s]
2025-03-13 15:39:28,106 [INFO]: There are 4375 embeddings of dim 49152
2025-03-13 15:39:28,107 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:39:28,107 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,107 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:28,107 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:39:28,107 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:28,107 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:39:28,107 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,107 [INFO]: 902.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:28,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:39:28,107 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:28
2025-03-13 15:39:28,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:28,107 [INFO]: 	Creating the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,107 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:28
2025-03-13 15:39:28,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:39:28,108 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,108 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:39:28,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.59it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.84it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.95it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.46it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.61it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.55it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.69it/s] 50%|█████     | 9/18 [00:01<00:01,  8.84it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.59it/s] 61%|██████    | 11/18 [00:01<00:00,  8.34it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.18it/s] 72%|███████▏  | 13/18 [00:01<00:00,  7.99it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.34it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.11it/s] 94%|█████████▍| 17/18 [00:02<00:00,  9.02it/s]100%|██████████| 18/18 [00:06<00:00,  1.25s/it]100%|██████████| 18/18 [00:06<00:00,  2.79it/s]
2025-03-13 15:39:34,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:34
2025-03-13 15:40:16,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4193 secs
2025-03-13 15:40:16,990 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 15:40:16,991 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 15:40:52,026 [INFO]: 	>>> Finished "Compute fast metrics" in 35.0348 secs
2025-03-13 15:40:52,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.9211 secs
2025-03-13 15:40:52,029 [INFO]: {
2025-03-13 15:40:52,030 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:52,030 [INFO]: 	index_param: efSearch=236
2025-03-13 15:40:52,030 [INFO]: 	index_path: knn.index
2025-03-13 15:40:52,030 [INFO]: 	size in bytes: 860755150
2025-03-13 15:40:52,030 [INFO]: 	avg_search_speed_ms: 11.283859807426758
2025-03-13 15:40:52,030 [INFO]: 	99p_search_speed_ms: 16.191858183592554
2025-03-13 15:40:52,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:52,030 [INFO]: 	nb vectors: 4375
2025-03-13 15:40:52,030 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:52,030 [INFO]: 	compression ratio: 0.999308572246126
2025-03-13 15:40:52,030 [INFO]: }
2025-03-13 15:40:52,030 [INFO]: 	>>> Finished "Creating the index" in 83.9225 secs
2025-03-13 15:40:52,030 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9483 secs
2025-03-13 15:40:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 4347 [episode count 5/20]
[retrieval_preprocessing] for episode 8448 [episode count 6/20], we have num_retrieval=np.int64(4275) num_query=np.int64(260)
2025-03-13 15:40:54,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:55,486 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:55
2025-03-13 15:40:55,487 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1100.29it/s]
2025-03-13 15:40:55,530 [INFO]: There are 4275 embeddings of dim 49152
2025-03-13 15:40:55,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0435 secs
2025-03-13 15:40:55,531 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:55
2025-03-13 15:40:55,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:55,531 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:40:55,531 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:55,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:40:55,531 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:55
2025-03-13 15:40:55,531 [INFO]: 882.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:55,532 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:40:55,532 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:55
2025-03-13 15:40:55,532 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:55,532 [INFO]: 	Creating the index 03/13/2025, 15:40:55
2025-03-13 15:40:55,532 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:55
2025-03-13 15:40:55,534 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:40:55,534 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:55
2025-03-13 15:40:55,534 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:40:55,534 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.88it/s] 35%|███▌      | 6/17 [00:00<00:00, 25.95it/s] 65%|██████▍   | 11/17 [00:00<00:00, 33.16it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.28it/s]100%|██████████| 17/17 [00:04<00:00,  3.87it/s]
2025-03-13 15:40:59,935 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:59
2025-03-13 15:41:49,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8933 secs
2025-03-13 15:41:49,829 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 15:41:49,829 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 15:42:13,515 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6857 secs
2025-03-13 15:42:13,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9871 secs
2025-03-13 15:42:13,521 [INFO]: {
2025-03-13 15:42:13,521 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:13,521 [INFO]: 	index_param: efSearch=205
2025-03-13 15:42:13,521 [INFO]: 	index_path: knn.index
2025-03-13 15:42:13,521 [INFO]: 	size in bytes: 841080610
2025-03-13 15:42:13,521 [INFO]: 	avg_search_speed_ms: 13.917282792339321
2025-03-13 15:42:13,521 [INFO]: 	99p_search_speed_ms: 20.773219913244258
2025-03-13 15:42:13,521 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:13,521 [INFO]: 	nb vectors: 4275
2025-03-13 15:42:13,521 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:13,521 [INFO]: 	compression ratio: 0.9993087345100014
2025-03-13 15:42:13,521 [INFO]: }
2025-03-13 15:42:13,521 [INFO]: 	>>> Finished "Creating the index" in 77.9896 secs
2025-03-13 15:42:13,521 [INFO]: >>> Finished "Launching the whole pipeline" in 78.0347 secs
2025-03-13 15:42:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 8448 [episode count 6/20]
[retrieval_preprocessing] for episode 82201 [episode count 7/20], we have num_retrieval=np.int64(4310) num_query=np.int64(225)
2025-03-13 15:42:16,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:17,751 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:17
2025-03-13 15:42:17,751 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 661.67it/s]
2025-03-13 15:42:17,787 [INFO]: There are 4310 embeddings of dim 49152
2025-03-13 15:42:17,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 15:42:17,787 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:17
2025-03-13 15:42:17,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:17,788 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:42:17,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:17,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:42:17,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:17
2025-03-13 15:42:17,789 [INFO]: 889.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:17,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 15:42:17,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:17
2025-03-13 15:42:17,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:17,790 [INFO]: 	Creating the index 03/13/2025, 15:42:17
2025-03-13 15:42:17,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:17
2025-03-13 15:42:17,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:42:17,793 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:17
2025-03-13 15:42:17,793 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:42:17,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.59it/s] 24%|██▎       | 4/17 [00:00<00:00, 15.05it/s] 35%|███▌      | 6/17 [00:00<00:00, 15.24it/s] 47%|████▋     | 8/17 [00:00<00:00, 13.44it/s] 59%|█████▉    | 10/17 [00:00<00:00, 12.35it/s] 71%|███████   | 12/17 [00:00<00:00, 11.74it/s] 82%|████████▏ | 14/17 [00:01<00:00, 11.32it/s] 94%|█████████▍| 16/17 [00:01<00:00, 11.08it/s]100%|██████████| 17/17 [00:06<00:00,  2.64it/s]
2025-03-13 15:42:24,232 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:24
2025-03-13 15:43:11,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1774 secs
2025-03-13 15:43:11,411 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 15:43:11,411 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 15:43:42,391 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9792 secs
2025-03-13 15:43:42,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.6008 secs
2025-03-13 15:43:42,394 [INFO]: {
2025-03-13 15:43:42,394 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:42,394 [INFO]: 	index_param: efSearch=166
2025-03-13 15:43:42,394 [INFO]: 	index_path: knn.index
2025-03-13 15:43:42,394 [INFO]: 	size in bytes: 847966750
2025-03-13 15:43:42,394 [INFO]: 	avg_search_speed_ms: 12.313882727978815
2025-03-13 15:43:42,394 [INFO]: 	99p_search_speed_ms: 29.538956335745745
2025-03-13 15:43:42,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:42,394 [INFO]: 	nb vectors: 4310
2025-03-13 15:43:42,394 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:42,394 [INFO]: 	compression ratio: 0.9993086167588529
2025-03-13 15:43:42,394 [INFO]: }
2025-03-13 15:43:42,394 [INFO]: 	>>> Finished "Creating the index" in 84.6046 secs
2025-03-13 15:43:42,394 [INFO]: >>> Finished "Launching the whole pipeline" in 84.6433 secs
2025-03-13 15:43:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 82201 [episode count 7/20]
[retrieval_preprocessing] for episode 49426 [episode count 8/20], we have num_retrieval=np.int64(4338) num_query=np.int64(197)
2025-03-13 15:43:46,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:47,482 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:47
2025-03-13 15:43:47,482 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1108.72it/s]
2025-03-13 15:43:47,515 [INFO]: There are 4338 embeddings of dim 49152
2025-03-13 15:43:47,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 15:43:47,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:47
2025-03-13 15:43:47,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:47,517 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:43:47,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:47,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:43:47,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:47
2025-03-13 15:43:47,517 [INFO]: 895.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:47,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:43:47,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:47
2025-03-13 15:43:47,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:47,518 [INFO]: 	Creating the index 03/13/2025, 15:43:47
2025-03-13 15:43:47,518 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:47
2025-03-13 15:43:47,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:43:47,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:47
2025-03-13 15:43:47,522 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:43:47,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.54it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.57it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.60it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.21it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.59it/s] 50%|█████     | 9/18 [00:01<00:01,  8.05it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.22it/s] 61%|██████    | 11/18 [00:01<00:00,  8.26it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.41it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.58it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.69it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.84it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.98it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.11it/s]100%|██████████| 18/18 [00:06<00:00,  1.34s/it]100%|██████████| 18/18 [00:06<00:00,  2.90it/s]
2025-03-13 15:43:53,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:53
2025-03-13 15:44:43,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2408 secs
2025-03-13 15:44:43,979 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 15:44:43,979 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 15:45:18,663 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6835 secs
2025-03-13 15:45:18,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1442 secs
2025-03-13 15:45:18,666 [INFO]: {
2025-03-13 15:45:18,666 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:18,666 [INFO]: 	index_param: efSearch=227
2025-03-13 15:45:18,667 [INFO]: 	index_path: knn.index
2025-03-13 15:45:18,667 [INFO]: 	size in bytes: 853475590
2025-03-13 15:45:18,667 [INFO]: 	avg_search_speed_ms: 12.836846896890785
2025-03-13 15:45:18,667 [INFO]: 	99p_search_speed_ms: 25.66685161087662
2025-03-13 15:45:18,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:18,667 [INFO]: 	nb vectors: 4338
2025-03-13 15:45:18,667 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:18,667 [INFO]: 	compression ratio: 0.9993086082286197
2025-03-13 15:45:18,667 [INFO]: }
2025-03-13 15:45:18,667 [INFO]: 	>>> Finished "Creating the index" in 91.1487 secs
2025-03-13 15:45:18,667 [INFO]: >>> Finished "Launching the whole pipeline" in 91.1843 secs
2025-03-13 15:45:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 49426 [episode count 8/20]
[retrieval_preprocessing] for episode 10534 [episode count 9/20], we have num_retrieval=np.int64(4322) num_query=np.int64(213)
2025-03-13 15:45:23,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:24,360 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:24
2025-03-13 15:45:24,360 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 975.87it/s]
2025-03-13 15:45:24,388 [INFO]: There are 4322 embeddings of dim 49152
2025-03-13 15:45:24,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:45:24,388 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:24
2025-03-13 15:45:24,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:24,388 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:45:24,388 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:24,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:24,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:24
2025-03-13 15:45:24,388 [INFO]: 892.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:24,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:45:24,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:24
2025-03-13 15:45:24,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:24,389 [INFO]: 	Creating the index 03/13/2025, 15:45:24
2025-03-13 15:45:24,389 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:24
2025-03-13 15:45:24,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:45:24,390 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:24
2025-03-13 15:45:24,390 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:45:24,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.80it/s] 11%|█         | 2/18 [00:00<00:02,  7.65it/s] 22%|██▏       | 4/18 [00:00<00:01,  9.19it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.83it/s] 44%|████▍     | 8/18 [00:00<00:00, 10.04it/s] 50%|█████     | 9/18 [00:00<00:00,  9.93it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.95it/s] 67%|██████▋   | 12/18 [00:01<00:00, 10.05it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.04it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.27it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.61it/s]100%|██████████| 18/18 [00:05<00:00,  3.28it/s]
2025-03-13 15:45:30,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:30
2025-03-13 15:46:28,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.3104 secs
2025-03-13 15:46:28,677 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 15:46:28,677 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.63it/s] 50%|█████     | 2/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 15:46:52,926 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2489 secs
2025-03-13 15:46:52,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.5396 secs
2025-03-13 15:46:52,930 [INFO]: {
2025-03-13 15:46:52,930 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:52,930 [INFO]: 	index_param: efSearch=203
2025-03-13 15:46:52,930 [INFO]: 	index_path: knn.index
2025-03-13 15:46:52,930 [INFO]: 	size in bytes: 850327690
2025-03-13 15:46:52,930 [INFO]: 	avg_search_speed_ms: 9.678099082415379
2025-03-13 15:46:52,930 [INFO]: 	99p_search_speed_ms: 15.560605146456506
2025-03-13 15:46:52,930 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:52,930 [INFO]: 	nb vectors: 4322
2025-03-13 15:46:52,930 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:52,930 [INFO]: 	compression ratio: 0.9993086030163265
2025-03-13 15:46:52,930 [INFO]: }
2025-03-13 15:46:52,930 [INFO]: 	>>> Finished "Creating the index" in 88.5412 secs
2025-03-13 15:46:52,930 [INFO]: >>> Finished "Launching the whole pipeline" in 88.5701 secs
2025-03-13 15:46:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 10534 [episode count 9/20]
[retrieval_preprocessing] for episode 71995 [episode count 10/20], we have num_retrieval=np.int64(4317) num_query=np.int64(218)
2025-03-13 15:46:57,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:57,752 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:57
2025-03-13 15:46:57,752 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2061.08it/s]
2025-03-13 15:46:57,775 [INFO]: There are 4317 embeddings of dim 49152
2025-03-13 15:46:57,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 15:46:57,776 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:57
2025-03-13 15:46:57,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:57,776 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:46:57,776 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:57,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:46:57,776 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:57
2025-03-13 15:46:57,776 [INFO]: 890.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:57,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:46:57,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:57
2025-03-13 15:46:57,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:57,776 [INFO]: 	Creating the index 03/13/2025, 15:46:57
2025-03-13 15:46:57,776 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:57
2025-03-13 15:46:57,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:46:57,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:57
2025-03-13 15:46:57,777 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:46:57,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.50it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.80it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.82it/s] 41%|████      | 7/17 [00:00<00:00, 10.53it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.85it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.00it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.96it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.95it/s]100%|██████████| 17/17 [00:04<00:00,  1.80it/s]100%|██████████| 17/17 [00:04<00:00,  3.73it/s]
2025-03-13 15:47:02,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:02
2025-03-13 15:47:54,265 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9149 secs
2025-03-13 15:47:54,265 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 15:47:54,265 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.29it/s]
2025-03-13 15:48:18,187 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9216 secs
2025-03-13 15:48:18,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.5244 secs
2025-03-13 15:48:18,302 [INFO]: {
2025-03-13 15:48:18,302 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:18,302 [INFO]: 	index_param: efSearch=106
2025-03-13 15:48:18,302 [INFO]: 	index_path: knn.index
2025-03-13 15:48:18,302 [INFO]: 	size in bytes: 849343930
2025-03-13 15:48:18,302 [INFO]: 	avg_search_speed_ms: 5.858408058021799
2025-03-13 15:48:18,302 [INFO]: 	99p_search_speed_ms: 10.071118571795527
2025-03-13 15:48:18,302 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:18,302 [INFO]: 	nb vectors: 4317
2025-03-13 15:48:18,302 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:18,302 [INFO]: 	compression ratio: 0.9993086499128804
2025-03-13 15:48:18,302 [INFO]: }
2025-03-13 15:48:18,302 [INFO]: 	>>> Finished "Creating the index" in 80.5265 secs
2025-03-13 15:48:18,303 [INFO]: >>> Finished "Launching the whole pipeline" in 80.5508 secs
2025-03-13 15:48:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 71995 [episode count 10/20]
[retrieval_preprocessing] for episode 6505 [episode count 11/20], we have num_retrieval=np.int64(4282) num_query=np.int64(253)
2025-03-13 15:48:21,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:21,829 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:21
2025-03-13 15:48:21,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.98it/s]
2025-03-13 15:48:21,858 [INFO]: There are 4282 embeddings of dim 49152
2025-03-13 15:48:21,859 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:48:21,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:21
2025-03-13 15:48:21,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:21,859 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:48:21,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:21,860 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:48:21,860 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:21
2025-03-13 15:48:21,860 [INFO]: 883.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:21,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:48:21,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:21
2025-03-13 15:48:21,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:21,861 [INFO]: 	Creating the index 03/13/2025, 15:48:21
2025-03-13 15:48:21,861 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:21
2025-03-13 15:48:21,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:48:21,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:21
2025-03-13 15:48:21,864 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:48:21,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:05,  3.09it/s] 12%|█▏        | 2/17 [00:00<00:03,  4.60it/s] 18%|█▊        | 3/17 [00:00<00:02,  5.47it/s] 24%|██▎       | 4/17 [00:00<00:01,  6.53it/s] 41%|████      | 7/17 [00:00<00:00, 11.53it/s] 59%|█████▉    | 10/17 [00:00<00:00, 14.81it/s] 76%|███████▋  | 13/17 [00:01<00:00, 17.35it/s] 88%|████████▊ | 15/17 [00:01<00:00, 17.33it/s]100%|██████████| 17/17 [00:04<00:00,  2.13it/s]100%|██████████| 17/17 [00:04<00:00,  3.99it/s]
2025-03-13 15:48:26,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:26
2025-03-13 15:49:05,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3760 secs
2025-03-13 15:49:05,514 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:49:05,515 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.26it/s] 50%|█████     | 2/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.66it/s]
2025-03-13 15:49:44,509 [INFO]: 	>>> Finished "Compute fast metrics" in 38.9940 secs
2025-03-13 15:49:44,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6480 secs
2025-03-13 15:49:44,512 [INFO]: {
2025-03-13 15:49:44,512 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:44,512 [INFO]: 	index_param: efSearch=202
2025-03-13 15:49:44,512 [INFO]: 	index_path: knn.index
2025-03-13 15:49:44,512 [INFO]: 	size in bytes: 842457850
2025-03-13 15:49:44,512 [INFO]: 	avg_search_speed_ms: 9.463289832562392
2025-03-13 15:49:44,512 [INFO]: 	99p_search_speed_ms: 16.072888877242818
2025-03-13 15:49:44,512 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:44,512 [INFO]: 	nb vectors: 4282
2025-03-13 15:49:44,512 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:44,512 [INFO]: 	compression ratio: 0.9993086965715852
2025-03-13 15:49:44,512 [INFO]: }
2025-03-13 15:49:44,512 [INFO]: 	>>> Finished "Creating the index" in 82.6517 secs
2025-03-13 15:49:44,512 [INFO]: >>> Finished "Launching the whole pipeline" in 82.6830 secs
2025-03-13 15:49:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 6505 [episode count 11/20]
[retrieval_preprocessing] for episode 43349 [episode count 12/20], we have num_retrieval=np.int64(4299) num_query=np.int64(236)
2025-03-13 15:49:48,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:49,402 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:49
2025-03-13 15:49:49,402 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.66it/s]
2025-03-13 15:49:49,432 [INFO]: There are 4299 embeddings of dim 49152
2025-03-13 15:49:49,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 15:49:49,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:49
2025-03-13 15:49:49,433 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:49,433 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:49:49,433 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:49,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:49:49,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:49
2025-03-13 15:49:49,434 [INFO]: 887.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:49,434 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:49:49,434 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:49
2025-03-13 15:49:49,434 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:49,434 [INFO]: 	Creating the index 03/13/2025, 15:49:49
2025-03-13 15:49:49,434 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:49
2025-03-13 15:49:49,438 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:49:49,438 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:49
2025-03-13 15:49:49,438 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:49:49,438 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.09it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.33it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.35it/s] 41%|████      | 7/17 [00:00<00:00, 10.79it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.09it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.22it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.39it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.58it/s]100%|██████████| 17/17 [00:04<00:00,  1.81it/s]100%|██████████| 17/17 [00:04<00:00,  3.78it/s]
2025-03-13 15:49:53,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:53
2025-03-13 15:50:35,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4425 secs
2025-03-13 15:50:35,392 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 15:50:35,392 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 15:51:04,438 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0465 secs
2025-03-13 15:51:04,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.0055 secs
2025-03-13 15:51:04,444 [INFO]: {
2025-03-13 15:51:04,444 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:04,444 [INFO]: 	index_param: efSearch=152
2025-03-13 15:51:04,444 [INFO]: 	index_path: knn.index
2025-03-13 15:51:04,444 [INFO]: 	size in bytes: 845802550
2025-03-13 15:51:04,444 [INFO]: 	avg_search_speed_ms: 8.522028795616412
2025-03-13 15:51:04,444 [INFO]: 	99p_search_speed_ms: 15.869810774456706
2025-03-13 15:51:04,444 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:04,444 [INFO]: 	nb vectors: 4299
2025-03-13 15:51:04,444 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:04,444 [INFO]: 	compression ratio: 0.9993086353310238
2025-03-13 15:51:04,444 [INFO]: }
2025-03-13 15:51:04,444 [INFO]: 	>>> Finished "Creating the index" in 75.0096 secs
2025-03-13 15:51:04,444 [INFO]: >>> Finished "Launching the whole pipeline" in 75.0417 secs
2025-03-13 15:51:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 43349 [episode count 12/20]
[retrieval_preprocessing] for episode 6491 [episode count 13/20], we have num_retrieval=np.int64(4306) num_query=np.int64(229)
2025-03-13 15:51:11,225 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:12,078 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:12
2025-03-13 15:51:12,078 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.52it/s]
2025-03-13 15:51:12,104 [INFO]: There are 4306 embeddings of dim 49152
2025-03-13 15:51:12,104 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:51:12,104 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:12
2025-03-13 15:51:12,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:12,105 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:51:12,105 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:12,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:51:12,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:12
2025-03-13 15:51:12,105 [INFO]: 888.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:12,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:51:12,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:12
2025-03-13 15:51:12,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:12,105 [INFO]: 	Creating the index 03/13/2025, 15:51:12
2025-03-13 15:51:12,105 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:12
2025-03-13 15:51:12,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:51:12,106 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:12
2025-03-13 15:51:12,106 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:51:12,106 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.78it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.52it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.26it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.68it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.90it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.06it/s] 41%|████      | 7/17 [00:00<00:01,  7.95it/s] 47%|████▋     | 8/17 [00:01<00:01,  7.74it/s] 53%|█████▎    | 9/17 [00:01<00:01,  7.60it/s] 59%|█████▉    | 10/17 [00:01<00:00,  7.74it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.27it/s] 71%|███████   | 12/17 [00:01<00:00,  8.48it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.31it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.08it/s] 88%|████████▊ | 15/17 [00:01<00:00,  7.92it/s] 94%|█████████▍| 16/17 [00:02<00:00,  7.76it/s]100%|██████████| 17/17 [00:06<00:00,  1.30s/it]100%|██████████| 17/17 [00:06<00:00,  2.79it/s]
2025-03-13 15:51:18,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:18
2025-03-13 15:52:08,135 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9231 secs
2025-03-13 15:52:08,135 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 15:52:08,136 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.86it/s] 50%|█████     | 2/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.36it/s]
2025-03-13 15:52:29,032 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8966 secs
2025-03-13 15:52:29,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.9295 secs
2025-03-13 15:52:29,036 [INFO]: {
2025-03-13 15:52:29,036 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:29,036 [INFO]: 	index_param: efSearch=227
2025-03-13 15:52:29,036 [INFO]: 	index_path: knn.index
2025-03-13 15:52:29,036 [INFO]: 	size in bytes: 847179790
2025-03-13 15:52:29,036 [INFO]: 	avg_search_speed_ms: 11.149106159704502
2025-03-13 15:52:29,036 [INFO]: 	99p_search_speed_ms: 17.618124708533287
2025-03-13 15:52:29,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:29,036 [INFO]: 	nb vectors: 4306
2025-03-13 15:52:29,036 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:29,036 [INFO]: 	compression ratio: 0.9993085977652985
2025-03-13 15:52:29,036 [INFO]: }
2025-03-13 15:52:29,036 [INFO]: 	>>> Finished "Creating the index" in 76.9308 secs
2025-03-13 15:52:29,036 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9574 secs
2025-03-13 15:52:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 6491 [episode count 13/20]
[retrieval_preprocessing] for episode 25405 [episode count 14/20], we have num_retrieval=np.int64(4287) num_query=np.int64(248)
2025-03-13 15:52:33,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:34,051 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:34
2025-03-13 15:52:34,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2116.20it/s]
2025-03-13 15:52:34,075 [INFO]: There are 4287 embeddings of dim 49152
2025-03-13 15:52:34,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 15:52:34,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:34,075 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:52:34,075 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:34,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:34,075 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,075 [INFO]: 884.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:34,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:52:34,075 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:34
2025-03-13 15:52:34,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:34,075 [INFO]: 	Creating the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,075 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:34
2025-03-13 15:52:34,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:52:34,076 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:34
2025-03-13 15:52:34,076 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:52:34,076 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.78it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.59it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.66it/s] 41%|████      | 7/17 [00:00<00:00, 12.49it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.96it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.25it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.55it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.58it/s]100%|██████████| 17/17 [00:05<00:00,  1.39it/s]100%|██████████| 17/17 [00:05<00:00,  3.10it/s]
2025-03-13 15:52:39,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:39
2025-03-13 15:53:37,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.3118 secs
2025-03-13 15:53:37,879 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 15:53:37,879 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.78s/it] 50%|█████     | 2/4 [00:02<00:02,  1.13s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.10it/s]
2025-03-13 15:54:03,004 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1243 secs
2025-03-13 15:54:03,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.9305 secs
2025-03-13 15:54:03,007 [INFO]: {
2025-03-13 15:54:03,007 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:03,007 [INFO]: 	index_param: efSearch=214
2025-03-13 15:54:03,007 [INFO]: 	index_path: knn.index
2025-03-13 15:54:03,007 [INFO]: 	size in bytes: 843441550
2025-03-13 15:54:03,007 [INFO]: 	avg_search_speed_ms: 10.06995575818583
2025-03-13 15:54:03,007 [INFO]: 	99p_search_speed_ms: 14.5932752545923
2025-03-13 15:54:03,007 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:03,007 [INFO]: 	nb vectors: 4287
2025-03-13 15:54:03,007 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:03,007 [INFO]: 	compression ratio: 0.9993087203256704
2025-03-13 15:54:03,007 [INFO]: }
2025-03-13 15:54:03,007 [INFO]: 	>>> Finished "Creating the index" in 88.9319 secs
2025-03-13 15:54:03,007 [INFO]: >>> Finished "Launching the whole pipeline" in 88.9564 secs
2025-03-13 15:54:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 25405 [episode count 14/20]
[retrieval_preprocessing] for episode 58191 [episode count 15/20], we have num_retrieval=np.int64(4357) num_query=np.int64(178)
2025-03-13 15:54:08,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:08,953 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:08
2025-03-13 15:54:08,953 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2130.17it/s]
2025-03-13 15:54:08,977 [INFO]: There are 4357 embeddings of dim 49152
2025-03-13 15:54:08,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 15:54:08,978 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:08
2025-03-13 15:54:08,978 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:08,978 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:54:08,978 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:08,978 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:08,978 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:08
2025-03-13 15:54:08,978 [INFO]: 899.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:08,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:08,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:08
2025-03-13 15:54:08,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:08,978 [INFO]: 	Creating the index 03/13/2025, 15:54:08
2025-03-13 15:54:08,978 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:08
2025-03-13 15:54:08,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:54:08,979 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:08
2025-03-13 15:54:08,979 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:54:08,979 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.62it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.19it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.46it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.67it/s] 50%|█████     | 9/18 [00:00<00:00, 10.92it/s] 61%|██████    | 11/18 [00:01<00:00, 10.66it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.47it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.38it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.09it/s]100%|██████████| 18/18 [00:05<00:00,  3.23it/s]
2025-03-13 15:54:14,557 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:14
2025-03-13 15:54:57,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9467 secs
2025-03-13 15:54:57,505 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:54:57,505 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.18it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.59it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.26it/s]
2025-03-13 15:55:36,018 [INFO]: 	>>> Finished "Compute fast metrics" in 38.5125 secs
2025-03-13 15:55:36,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.0418 secs
2025-03-13 15:55:36,021 [INFO]: {
2025-03-13 15:55:36,021 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:36,021 [INFO]: 	index_param: efSearch=207
2025-03-13 15:55:36,021 [INFO]: 	index_path: knn.index
2025-03-13 15:55:36,021 [INFO]: 	size in bytes: 857213770
2025-03-13 15:55:36,021 [INFO]: 	avg_search_speed_ms: 8.699161624130996
2025-03-13 15:55:36,021 [INFO]: 	99p_search_speed_ms: 12.192965541034937
2025-03-13 15:55:36,021 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:36,021 [INFO]: 	nb vectors: 4357
2025-03-13 15:55:36,021 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:36,021 [INFO]: 	compression ratio: 0.9993085575375207
2025-03-13 15:55:36,021 [INFO]: }
2025-03-13 15:55:36,021 [INFO]: 	>>> Finished "Creating the index" in 87.0434 secs
2025-03-13 15:55:36,022 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0684 secs
2025-03-13 15:55:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 58191 [episode count 15/20]
[retrieval_preprocessing] for episode 2909 [episode count 16/20], we have num_retrieval=np.int64(4309) num_query=np.int64(226)
2025-03-13 15:55:39,301 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:40,078 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:40
2025-03-13 15:55:40,078 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.26it/s]
2025-03-13 15:55:40,104 [INFO]: There are 4309 embeddings of dim 49152
2025-03-13 15:55:40,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:55:40,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,106 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:40,106 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:55:40,106 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:40,106 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:55:40,106 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,107 [INFO]: 889.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:40,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:55:40,107 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:40
2025-03-13 15:55:40,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:40,108 [INFO]: 	Creating the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,108 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:40
2025-03-13 15:55:40,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:55:40,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,112 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:55:40,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.59it/s] 12%|█▏        | 2/17 [00:00<00:01,  7.83it/s] 24%|██▎       | 4/17 [00:00<00:01, 10.61it/s] 35%|███▌      | 6/17 [00:00<00:00, 12.21it/s] 47%|████▋     | 8/17 [00:00<00:00, 11.32it/s] 59%|█████▉    | 10/17 [00:00<00:00, 10.87it/s] 71%|███████   | 12/17 [00:01<00:00,  9.63it/s] 82%|████████▏ | 14/17 [00:01<00:00, 10.63it/s] 94%|█████████▍| 16/17 [00:01<00:00, 10.83it/s]100%|██████████| 17/17 [00:07<00:00,  2.18it/s]
2025-03-13 15:55:47,941 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:47
2025-03-13 15:56:37,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.3442 secs
2025-03-13 15:56:37,286 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:56:37,286 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.63it/s]
2025-03-13 15:57:02,746 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4604 secs
2025-03-13 15:57:02,749 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6373 secs
2025-03-13 15:57:02,749 [INFO]: {
2025-03-13 15:57:02,750 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:02,750 [INFO]: 	index_param: efSearch=200
2025-03-13 15:57:02,750 [INFO]: 	index_path: knn.index
2025-03-13 15:57:02,750 [INFO]: 	size in bytes: 847770010
2025-03-13 15:57:02,750 [INFO]: 	avg_search_speed_ms: 9.53406695137999
2025-03-13 15:57:02,750 [INFO]: 	99p_search_speed_ms: 16.92944487556815
2025-03-13 15:57:02,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:02,750 [INFO]: 	nb vectors: 4309
2025-03-13 15:57:02,750 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:02,750 [INFO]: 	compression ratio: 0.9993086120137701
2025-03-13 15:57:02,750 [INFO]: }
2025-03-13 15:57:02,750 [INFO]: 	>>> Finished "Creating the index" in 82.6416 secs
2025-03-13 15:57:02,750 [INFO]: >>> Finished "Launching the whole pipeline" in 82.6720 secs
2025-03-13 15:57:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 2909 [episode count 16/20]
[retrieval_preprocessing] for episode 72110 [episode count 17/20], we have num_retrieval=np.int64(4316) num_query=np.int64(219)
2025-03-13 15:57:08,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:09,290 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:09
2025-03-13 15:57:09,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 969.33it/s]
2025-03-13 15:57:09,316 [INFO]: There are 4316 embeddings of dim 49152
2025-03-13 15:57:09,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:57:09,316 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:09
2025-03-13 15:57:09,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:09,317 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 15:57:09,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:09,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:09,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:09
2025-03-13 15:57:09,317 [INFO]: 890.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:09,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:57:09,317 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:09
2025-03-13 15:57:09,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:09,317 [INFO]: 	Creating the index 03/13/2025, 15:57:09
2025-03-13 15:57:09,317 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:09
2025-03-13 15:57:09,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:57:09,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:09
2025-03-13 15:57:09,318 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:57:09,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.98it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.47it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.23it/s] 41%|████      | 7/17 [00:00<00:00, 10.40it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.58it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.81it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.90it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.99it/s]100%|██████████| 17/17 [00:04<00:00,  1.71it/s]100%|██████████| 17/17 [00:04<00:00,  3.60it/s]
2025-03-13 15:57:14,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:14
2025-03-13 15:58:05,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.6654 secs
2025-03-13 15:58:05,411 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:58:05,411 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.78it/s]
2025-03-13 15:58:44,903 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4916 secs
2025-03-13 15:58:44,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.5884 secs
2025-03-13 15:58:44,907 [INFO]: {
2025-03-13 15:58:44,907 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:44,907 [INFO]: 	index_param: efSearch=182
2025-03-13 15:58:44,907 [INFO]: 	index_path: knn.index
2025-03-13 15:58:44,907 [INFO]: 	size in bytes: 849147190
2025-03-13 15:58:44,907 [INFO]: 	avg_search_speed_ms: 10.030392013721864
2025-03-13 15:58:44,907 [INFO]: 	99p_search_speed_ms: 18.48206174559891
2025-03-13 15:58:44,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:44,907 [INFO]: 	nb vectors: 4316
2025-03-13 15:58:44,907 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:44,907 [INFO]: 	compression ratio: 0.9993086451831749
2025-03-13 15:58:44,907 [INFO]: }
2025-03-13 15:58:44,907 [INFO]: 	>>> Finished "Creating the index" in 95.5902 secs
2025-03-13 15:58:44,907 [INFO]: >>> Finished "Launching the whole pipeline" in 95.6174 secs
2025-03-13 15:58:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 72110 [episode count 17/20]
[retrieval_preprocessing] for episode 37744 [episode count 18/20], we have num_retrieval=np.int64(4247) num_query=np.int64(288)
2025-03-13 15:58:49,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:50,012 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:50
2025-03-13 15:58:50,012 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.85it/s]
2025-03-13 15:58:50,042 [INFO]: There are 4247 embeddings of dim 49152
2025-03-13 15:58:50,042 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 15:58:50,042 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,042 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:50,043 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:58:50,043 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:50,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:58:50,043 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,043 [INFO]: 876.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:50,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:58:50,044 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:50
2025-03-13 15:58:50,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:50,044 [INFO]: 	Creating the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,044 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:50
2025-03-13 15:58:50,047 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:58:50,047 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,048 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:58:50,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.82it/s] 12%|█▏        | 2/17 [00:00<00:01,  7.66it/s] 24%|██▎       | 4/17 [00:00<00:01,  9.16it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.43it/s] 47%|████▋     | 8/17 [00:00<00:00, 10.42it/s] 59%|█████▉    | 10/17 [00:00<00:00, 11.11it/s] 71%|███████   | 12/17 [00:01<00:00,  9.09it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.79it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.76it/s]100%|██████████| 17/17 [00:05<00:00,  3.37it/s]
2025-03-13 15:58:55,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:55
2025-03-13 15:59:46,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.5215 secs
2025-03-13 15:59:46,632 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 15:59:46,632 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 16:00:07,714 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0824 secs
2025-03-13 16:00:07,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.6709 secs
2025-03-13 16:00:07,719 [INFO]: {
2025-03-13 16:00:07,719 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:07,719 [INFO]: 	index_param: efSearch=149
2025-03-13 16:00:07,719 [INFO]: 	index_path: knn.index
2025-03-13 16:00:07,719 [INFO]: 	size in bytes: 835571830
2025-03-13 16:00:07,719 [INFO]: 	avg_search_speed_ms: 7.781747760657033
2025-03-13 16:00:07,719 [INFO]: 	99p_search_speed_ms: 12.476107496768247
2025-03-13 16:00:07,719 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:07,719 [INFO]: 	nb vectors: 4247
2025-03-13 16:00:07,719 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:07,719 [INFO]: 	compression ratio: 0.9993086722418586
2025-03-13 16:00:07,719 [INFO]: }
2025-03-13 16:00:07,719 [INFO]: 	>>> Finished "Creating the index" in 77.6747 secs
2025-03-13 16:00:07,719 [INFO]: >>> Finished "Launching the whole pipeline" in 77.7071 secs
2025-03-13 16:00:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 37744 [episode count 18/20]
[retrieval_preprocessing] for episode 13169 [episode count 19/20], we have num_retrieval=np.int64(4281) num_query=np.int64(254)
2025-03-13 16:00:11,822 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:13,159 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:13
2025-03-13 16:00:13,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.11it/s]
2025-03-13 16:00:13,184 [INFO]: There are 4281 embeddings of dim 49152
2025-03-13 16:00:13,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 16:00:13,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:13
2025-03-13 16:00:13,185 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:13,185 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 16:00:13,185 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:13,185 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:00:13,185 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:13
2025-03-13 16:00:13,185 [INFO]: 883.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:13,185 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:00:13,185 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:13
2025-03-13 16:00:13,185 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:13,185 [INFO]: 	Creating the index 03/13/2025, 16:00:13
2025-03-13 16:00:13,185 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:13
2025-03-13 16:00:13,186 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:00:13,186 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:13
2025-03-13 16:00:13,186 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:00:13,186 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.19it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.07it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.13it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.84it/s] 41%|████      | 7/17 [00:00<00:01,  8.69it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.61it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.59it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.36it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.39it/s] 71%|███████   | 12/17 [00:01<00:00,  8.39it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.39it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.39it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.63it/s]100%|██████████| 17/17 [00:05<00:00,  1.01s/it]100%|██████████| 17/17 [00:05<00:00,  2.88it/s]
2025-03-13 16:00:19,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:19
2025-03-13 16:01:06,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0233 secs
2025-03-13 16:01:06,128 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 16:01:06,128 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 16:01:47,744 [INFO]: 	>>> Finished "Compute fast metrics" in 41.6150 secs
2025-03-13 16:01:47,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5614 secs
2025-03-13 16:01:47,748 [INFO]: {
2025-03-13 16:01:47,748 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:47,748 [INFO]: 	index_param: efSearch=196
2025-03-13 16:01:47,748 [INFO]: 	index_path: knn.index
2025-03-13 16:01:47,748 [INFO]: 	size in bytes: 842261110
2025-03-13 16:01:47,748 [INFO]: 	avg_search_speed_ms: 10.169077860731498
2025-03-13 16:01:47,748 [INFO]: 	99p_search_speed_ms: 16.445694188587368
2025-03-13 16:01:47,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:47,748 [INFO]: 	nb vectors: 4281
2025-03-13 16:01:47,748 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:47,748 [INFO]: 	compression ratio: 0.9993086918141098
2025-03-13 16:01:47,748 [INFO]: }
2025-03-13 16:01:47,748 [INFO]: 	>>> Finished "Creating the index" in 94.5628 secs
2025-03-13 16:01:47,748 [INFO]: >>> Finished "Launching the whole pipeline" in 94.5884 secs
2025-03-13 16:01:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 13169 [episode count 19/20]
2025-03-13 16:01:50: [retrieval_preprocessing] finished for 1656877278_put_can_in_bowl [chosen_id count 2/196]
2025-03-13 16:01:55: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_bowl_in_sink [chosen_id count 3/196]
2025-03-13 16:01:55: [retrieval_preprocessing] we have num_total=5269 embedding_dim=49152
[retrieval_preprocessing] for episode 69639 [episode count 0/20], we have num_retrieval=np.int64(5006) num_query=np.int64(263)
2025-03-13 16:01:57,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:58,531 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:58
2025-03-13 16:01:58,531 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1983.12it/s]
2025-03-13 16:01:58,554 [INFO]: There are 5006 embeddings of dim 49152
2025-03-13 16:01:58,555 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 16:01:58,555 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:58
2025-03-13 16:01:58,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:58,555 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:01:58,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:58,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:58,555 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:58
2025-03-13 16:01:58,555 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:58,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:01:58,555 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:58
2025-03-13 16:01:58,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:58,555 [INFO]: 	Creating the index 03/13/2025, 16:01:58
2025-03-13 16:01:58,555 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:58
2025-03-13 16:01:58,556 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:01:58,556 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:58
2025-03-13 16:01:58,556 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:01:58,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.98it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.97it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.11it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.33it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.65it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.04it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.94it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.77it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.85it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.61it/s]100%|██████████| 20/20 [00:07<00:00,  2.69it/s]
2025-03-13 16:02:05,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:05
2025-03-13 16:02:59,671 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6784 secs
2025-03-13 16:02:59,671 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 16:02:59,672 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 16:03:50,384 [INFO]: 	>>> Finished "Compute fast metrics" in 50.7116 secs
2025-03-13 16:03:50,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.8303 secs
2025-03-13 16:03:50,387 [INFO]: {
2025-03-13 16:03:50,387 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:50,387 [INFO]: 	index_param: efSearch=190
2025-03-13 16:03:50,387 [INFO]: 	index_path: knn.index
2025-03-13 16:03:50,387 [INFO]: 	size in bytes: 984900670
2025-03-13 16:03:50,387 [INFO]: 	avg_search_speed_ms: 9.035232787541272
2025-03-13 16:03:50,387 [INFO]: 	99p_search_speed_ms: 17.412445754744116
2025-03-13 16:03:50,387 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:50,387 [INFO]: 	nb vectors: 5006
2025-03-13 16:03:50,387 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:50,387 [INFO]: 	compression ratio: 0.999308537377683
2025-03-13 16:03:50,387 [INFO]: }
2025-03-13 16:03:50,387 [INFO]: 	>>> Finished "Creating the index" in 111.8317 secs
2025-03-13 16:03:50,387 [INFO]: >>> Finished "Launching the whole pipeline" in 111.8557 secs
2025-03-13 16:03:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 69639 [episode count 0/20]
[retrieval_preprocessing] for episode 57464 [episode count 1/20], we have num_retrieval=np.int64(5033) num_query=np.int64(236)
2025-03-13 16:03:53,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:54,479 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:54
2025-03-13 16:03:54,480 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1247.93it/s]
2025-03-13 16:03:54,504 [INFO]: There are 5033 embeddings of dim 49152
2025-03-13 16:03:54,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 16:03:54,504 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:54
2025-03-13 16:03:54,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:54,505 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:03:54,505 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:54,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:54,505 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:54
2025-03-13 16:03:54,505 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:54,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:03:54,505 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:54
2025-03-13 16:03:54,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:54,505 [INFO]: 	Creating the index 03/13/2025, 16:03:54
2025-03-13 16:03:54,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:54
2025-03-13 16:03:54,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:03:54,506 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:54
2025-03-13 16:03:54,506 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:03:54,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.37it/s] 10%|█         | 2/20 [00:00<00:02,  7.06it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.79it/s] 20%|██        | 4/20 [00:00<00:01,  8.13it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.35it/s] 30%|███       | 6/20 [00:00<00:01,  8.58it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.86it/s] 40%|████      | 8/20 [00:00<00:01,  8.92it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.92it/s] 50%|█████     | 10/20 [00:01<00:01,  8.95it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.95it/s] 60%|██████    | 12/20 [00:01<00:00,  9.01it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.93it/s] 70%|███████   | 14/20 [00:01<00:00,  8.87it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.76it/s] 80%|████████  | 16/20 [00:01<00:00,  8.70it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.85it/s]100%|██████████| 20/20 [00:05<00:00,  1.34it/s]100%|██████████| 20/20 [00:05<00:00,  3.64it/s]
2025-03-13 16:04:00,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:00
2025-03-13 16:04:46,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2954 secs
2025-03-13 16:04:46,842 [INFO]: The best hyperparameters are: efSearch=73
2025-03-13 16:04:46,842 [INFO]: 	Compute fast metrics 03/13/2025, 16:04:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 50%|█████     | 2/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 16:05:07,761 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9184 secs
2025-03-13 16:05:07,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2592 secs
2025-03-13 16:05:07,766 [INFO]: {
2025-03-13 16:05:07,766 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:07,766 [INFO]: 	index_param: efSearch=73
2025-03-13 16:05:07,766 [INFO]: 	index_path: knn.index
2025-03-13 16:05:07,766 [INFO]: 	size in bytes: 990212770
2025-03-13 16:05:07,766 [INFO]: 	avg_search_speed_ms: 4.331959272734821
2025-03-13 16:05:07,766 [INFO]: 	99p_search_speed_ms: 7.38671380560845
2025-03-13 16:05:07,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:07,766 [INFO]: 	nb vectors: 5033
2025-03-13 16:05:07,766 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:07,766 [INFO]: 	compression ratio: 0.9993085263887276
2025-03-13 16:05:07,766 [INFO]: }
2025-03-13 16:05:07,766 [INFO]: 	>>> Finished "Creating the index" in 73.2609 secs
2025-03-13 16:05:07,766 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2865 secs
2025-03-13 16:05:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 57464 [episode count 1/20]
[retrieval_preprocessing] for episode 51350 [episode count 2/20], we have num_retrieval=np.int64(4971) num_query=np.int64(298)
2025-03-13 16:05:11,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:12,838 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:12
2025-03-13 16:05:12,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.01it/s]
2025-03-13 16:05:12,862 [INFO]: There are 4971 embeddings of dim 49152
2025-03-13 16:05:12,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 16:05:12,862 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:12
2025-03-13 16:05:12,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:12,862 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:05:12,862 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:12,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:05:12,862 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:12
2025-03-13 16:05:12,863 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:12,863 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:05:12,863 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:12
2025-03-13 16:05:12,863 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:12,863 [INFO]: 	Creating the index 03/13/2025, 16:05:12
2025-03-13 16:05:12,863 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:12
2025-03-13 16:05:12,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:05:12,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:12
2025-03-13 16:05:12,864 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:05:12,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.13it/s] 10%|█         | 2/20 [00:00<00:02,  6.19it/s] 20%|██        | 4/20 [00:00<00:01,  8.32it/s] 30%|███       | 6/20 [00:00<00:01,  9.33it/s] 40%|████      | 8/20 [00:00<00:01,  9.86it/s] 50%|█████     | 10/20 [00:01<00:00, 10.20it/s] 60%|██████    | 12/20 [00:01<00:00, 10.39it/s] 70%|███████   | 14/20 [00:01<00:00, 10.54it/s] 80%|████████  | 16/20 [00:01<00:00, 10.73it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.81it/s]100%|██████████| 20/20 [00:06<00:00,  1.35it/s]100%|██████████| 20/20 [00:06<00:00,  3.22it/s]
2025-03-13 16:05:19,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:19
2025-03-13 16:06:05,146 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0595 secs
2025-03-13 16:06:05,146 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 16:06:05,146 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.55it/s] 50%|█████     | 2/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-13 16:06:41,733 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5865 secs
2025-03-13 16:06:41,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.8737 secs
2025-03-13 16:06:41,738 [INFO]: {
2025-03-13 16:06:41,738 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:41,738 [INFO]: 	index_param: efSearch=264
2025-03-13 16:06:41,738 [INFO]: 	index_path: knn.index
2025-03-13 16:06:41,738 [INFO]: 	size in bytes: 978014470
2025-03-13 16:06:41,738 [INFO]: 	avg_search_speed_ms: 9.425519016491466
2025-03-13 16:06:41,738 [INFO]: 	99p_search_speed_ms: 14.260860998183515
2025-03-13 16:06:41,738 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:41,738 [INFO]: 	nb vectors: 4971
2025-03-13 16:06:41,738 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:41,738 [INFO]: 	compression ratio: 0.9993086993896931
2025-03-13 16:06:41,738 [INFO]: }
2025-03-13 16:06:41,738 [INFO]: 	>>> Finished "Creating the index" in 88.8753 secs
2025-03-13 16:06:41,738 [INFO]: >>> Finished "Launching the whole pipeline" in 88.8998 secs
2025-03-13 16:06:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 51350 [episode count 2/20]
[retrieval_preprocessing] for episode 6356 [episode count 3/20], we have num_retrieval=np.int64(4921) num_query=np.int64(348)
2025-03-13 16:06:46,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:47,411 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:47
2025-03-13 16:06:47,411 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 976.33it/s]
2025-03-13 16:06:47,437 [INFO]: There are 4921 embeddings of dim 49152
2025-03-13 16:06:47,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 16:06:47,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:47
2025-03-13 16:06:47,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:47,438 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:06:47,438 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:47,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:06:47,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:47
2025-03-13 16:06:47,438 [INFO]: 1015.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:47,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:06:47,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:47
2025-03-13 16:06:47,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:47,438 [INFO]: 	Creating the index 03/13/2025, 16:06:47
2025-03-13 16:06:47,438 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:47
2025-03-13 16:06:47,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:06:47,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:47
2025-03-13 16:06:47,440 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:06:47,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.38it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.31it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.22it/s] 30%|███       | 6/20 [00:00<00:01,  9.36it/s] 40%|████      | 8/20 [00:00<00:01,  9.78it/s] 50%|█████     | 10/20 [00:01<00:01,  9.98it/s] 60%|██████    | 12/20 [00:01<00:00, 10.09it/s] 70%|███████   | 14/20 [00:01<00:00, 10.20it/s] 80%|████████  | 16/20 [00:01<00:00, 10.30it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.11it/s]100%|██████████| 20/20 [00:05<00:00,  1.56it/s]100%|██████████| 20/20 [00:05<00:00,  3.63it/s]
2025-03-13 16:06:52,959 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:52
2025-03-13 16:07:44,247 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2868 secs
2025-03-13 16:07:44,247 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:07:44,247 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 16:08:06,008 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7606 secs
2025-03-13 16:08:06,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5721 secs
2025-03-13 16:08:06,013 [INFO]: {
2025-03-13 16:08:06,013 [INFO]: 	index_key: HNSW15
2025-03-13 16:08:06,013 [INFO]: 	index_param: efSearch=242
2025-03-13 16:08:06,013 [INFO]: 	index_path: knn.index
2025-03-13 16:08:06,013 [INFO]: 	size in bytes: 968177230
2025-03-13 16:08:06,013 [INFO]: 	avg_search_speed_ms: 10.366808715483916
2025-03-13 16:08:06,013 [INFO]: 	99p_search_speed_ms: 15.398662807419896
2025-03-13 16:08:06,013 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:06,013 [INFO]: 	nb vectors: 4921
2025-03-13 16:08:06,013 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:06,013 [INFO]: 	compression ratio: 0.9993087401983209
2025-03-13 16:08:06,013 [INFO]: }
2025-03-13 16:08:06,013 [INFO]: 	>>> Finished "Creating the index" in 78.5747 secs
2025-03-13 16:08:06,013 [INFO]: >>> Finished "Launching the whole pipeline" in 78.6018 secs
2025-03-13 16:08:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 6356 [episode count 3/20]
[retrieval_preprocessing] for episode 47338 [episode count 4/20], we have num_retrieval=np.int64(5027) num_query=np.int64(242)
2025-03-13 16:08:11,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:12,535 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:12
2025-03-13 16:08:12,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.83it/s]
2025-03-13 16:08:12,561 [INFO]: There are 5027 embeddings of dim 49152
2025-03-13 16:08:12,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 16:08:12,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:12
2025-03-13 16:08:12,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:12,561 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:08:12,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:12,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:08:12,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:12
2025-03-13 16:08:12,561 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:12,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:08:12,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:12
2025-03-13 16:08:12,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:12,561 [INFO]: 	Creating the index 03/13/2025, 16:08:12
2025-03-13 16:08:12,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:12
2025-03-13 16:08:12,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:08:12,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:12
2025-03-13 16:08:12,562 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:08:12,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.84it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.98it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.31it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.83it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.18it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.43it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.20it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.91it/s] 80%|████████  | 16/20 [00:01<00:00,  9.77it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.66it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.57it/s]100%|██████████| 20/20 [00:05<00:00,  1.13it/s]100%|██████████| 20/20 [00:05<00:00,  3.34it/s]
2025-03-13 16:08:18,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:18
2025-03-13 16:09:04,201 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6358 secs
2025-03-13 16:09:04,201 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 16:09:04,201 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-13 16:10:04,424 [INFO]: 	>>> Finished "Compute fast metrics" in 60.2227 secs
2025-03-13 16:10:04,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.8657 secs
2025-03-13 16:10:04,428 [INFO]: {
2025-03-13 16:10:04,428 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:04,428 [INFO]: 	index_param: efSearch=299
2025-03-13 16:10:04,428 [INFO]: 	index_path: knn.index
2025-03-13 16:10:04,428 [INFO]: 	size in bytes: 989032330
2025-03-13 16:10:04,428 [INFO]: 	avg_search_speed_ms: 10.441069042315952
2025-03-13 16:10:04,428 [INFO]: 	99p_search_speed_ms: 16.68511300813403
2025-03-13 16:10:04,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:04,428 [INFO]: 	nb vectors: 5027
2025-03-13 16:10:04,428 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:04,428 [INFO]: 	compression ratio: 0.9993085018767789
2025-03-13 16:10:04,428 [INFO]: }
2025-03-13 16:10:04,428 [INFO]: 	>>> Finished "Creating the index" in 111.8671 secs
2025-03-13 16:10:04,428 [INFO]: >>> Finished "Launching the whole pipeline" in 111.8936 secs
2025-03-13 16:10:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 47338 [episode count 4/20]
[retrieval_preprocessing] for episode 21447 [episode count 5/20], we have num_retrieval=np.int64(5015) num_query=np.int64(254)
2025-03-13 16:10:12,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:13,396 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:13
2025-03-13 16:10:13,396 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.96it/s]
2025-03-13 16:10:13,420 [INFO]: There are 5015 embeddings of dim 49152
2025-03-13 16:10:13,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 16:10:13,421 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:13
2025-03-13 16:10:13,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:13,421 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:10:13,421 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:13,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:13,421 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:13
2025-03-13 16:10:13,421 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:13,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:10:13,421 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:13
2025-03-13 16:10:13,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:13,421 [INFO]: 	Creating the index 03/13/2025, 16:10:13
2025-03-13 16:10:13,421 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:13
2025-03-13 16:10:13,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:10:13,422 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:13
2025-03-13 16:10:13,422 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:10:13,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:05,  3.53it/s] 10%|█         | 2/20 [00:00<00:03,  5.22it/s] 15%|█▌        | 3/20 [00:00<00:02,  6.45it/s] 20%|██        | 4/20 [00:00<00:02,  7.22it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.93it/s] 30%|███       | 6/20 [00:00<00:01,  8.48it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.83it/s] 40%|████      | 8/20 [00:01<00:01,  8.92it/s] 50%|█████     | 10/20 [00:01<00:01,  9.41it/s] 60%|██████    | 12/20 [00:01<00:00,  9.54it/s] 70%|███████   | 14/20 [00:01<00:00,  9.86it/s] 80%|████████  | 16/20 [00:01<00:00, 10.12it/s] 90%|█████████ | 18/20 [00:02<00:00, 10.24it/s]100%|██████████| 20/20 [00:07<00:00,  1.10it/s]100%|██████████| 20/20 [00:07<00:00,  2.74it/s]
2025-03-13 16:10:21,054 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:21
2025-03-13 16:11:12,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3559 secs
2025-03-13 16:11:12,410 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 16:11:12,410 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 16:11:36,157 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7465 secs
2025-03-13 16:11:36,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.7384 secs
2025-03-13 16:11:36,161 [INFO]: {
2025-03-13 16:11:36,161 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:36,161 [INFO]: 	index_param: efSearch=270
2025-03-13 16:11:36,161 [INFO]: 	index_path: knn.index
2025-03-13 16:11:36,161 [INFO]: 	size in bytes: 986671330
2025-03-13 16:11:36,161 [INFO]: 	avg_search_speed_ms: 11.215107678853377
2025-03-13 16:11:36,161 [INFO]: 	99p_search_speed_ms: 16.64197334786877
2025-03-13 16:11:36,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:36,161 [INFO]: 	nb vectors: 5015
2025-03-13 16:11:36,161 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:36,161 [INFO]: 	compression ratio: 0.9993085742138671
2025-03-13 16:11:36,161 [INFO]: }
2025-03-13 16:11:36,161 [INFO]: 	>>> Finished "Creating the index" in 82.7398 secs
2025-03-13 16:11:36,161 [INFO]: >>> Finished "Launching the whole pipeline" in 82.7652 secs
2025-03-13 16:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 21447 [episode count 5/20]
[retrieval_preprocessing] for episode 58317 [episode count 6/20], we have num_retrieval=np.int64(5016) num_query=np.int64(253)
2025-03-13 16:11:41,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:42,137 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:42
2025-03-13 16:11:42,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.45it/s]
2025-03-13 16:11:42,164 [INFO]: There are 5016 embeddings of dim 49152
2025-03-13 16:11:42,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 16:11:42,164 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:42,164 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:11:42,164 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:42,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:11:42,164 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,164 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:42,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:11:42,164 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:42
2025-03-13 16:11:42,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:42,164 [INFO]: 	Creating the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:42
2025-03-13 16:11:42,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:11:42,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:42
2025-03-13 16:11:42,166 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:11:42,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.33it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.33it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.40it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.88it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.58it/s] 50%|█████     | 10/20 [00:01<00:01,  9.35it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.08it/s] 60%|██████    | 12/20 [00:01<00:00,  8.87it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.67it/s] 70%|███████   | 14/20 [00:01<00:00,  8.55it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.59it/s] 80%|████████  | 16/20 [00:01<00:00,  8.52it/s] 85%|████████▌ | 17/20 [00:01<00:00,  8.66it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.33it/s]100%|██████████| 20/20 [00:06<00:00,  1.15s/it]100%|██████████| 20/20 [00:06<00:00,  3.09it/s]
2025-03-13 16:11:48,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:48
2025-03-13 16:12:35,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4154 secs
2025-03-13 16:12:35,061 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 16:12:35,061 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 16:13:16,423 [INFO]: 	>>> Finished "Compute fast metrics" in 41.3618 secs
2025-03-13 16:13:16,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.2631 secs
2025-03-13 16:13:16,429 [INFO]: {
2025-03-13 16:13:16,429 [INFO]: 	index_key: HNSW15
2025-03-13 16:13:16,429 [INFO]: 	index_param: efSearch=232
2025-03-13 16:13:16,429 [INFO]: 	index_path: knn.index
2025-03-13 16:13:16,429 [INFO]: 	size in bytes: 986868070
2025-03-13 16:13:16,429 [INFO]: 	avg_search_speed_ms: 8.806219799156887
2025-03-13 16:13:16,429 [INFO]: 	99p_search_speed_ms: 15.844046026468277
2025-03-13 16:13:16,429 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:13:16,429 [INFO]: 	nb vectors: 5016
2025-03-13 16:13:16,429 [INFO]: 	vectors dimension: 49152
2025-03-13 16:13:16,429 [INFO]: 	compression ratio: 0.999308578298617
2025-03-13 16:13:16,429 [INFO]: }
2025-03-13 16:13:16,429 [INFO]: 	>>> Finished "Creating the index" in 94.2649 secs
2025-03-13 16:13:16,429 [INFO]: >>> Finished "Launching the whole pipeline" in 94.2920 secs
2025-03-13 16:13:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 58317 [episode count 6/20]
[retrieval_preprocessing] for episode 91111 [episode count 7/20], we have num_retrieval=np.int64(5031) num_query=np.int64(238)
2025-03-13 16:13:21,707 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:13:22,617 [INFO]: Launching the whole pipeline 03/13/2025, 16:13:22
2025-03-13 16:13:22,617 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:13:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1611.33it/s]
2025-03-13 16:13:22,642 [INFO]: There are 5031 embeddings of dim 49152
2025-03-13 16:13:22,643 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 16:13:22,643 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:13:22
2025-03-13 16:13:22,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:13:22,643 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:13:22,643 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:13:22,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:13:22,643 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:13:22
2025-03-13 16:13:22,643 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:13:22,643 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:13:22,643 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:13:22
2025-03-13 16:13:22,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:13:22,644 [INFO]: 	Creating the index 03/13/2025, 16:13:22
2025-03-13 16:13:22,644 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:13:22
2025-03-13 16:13:22,645 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:13:22,645 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:13:22
2025-03-13 16:13:22,645 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:13:22,645 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.68it/s] 10%|█         | 2/20 [00:00<00:02,  6.33it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.13it/s] 20%|██        | 4/20 [00:00<00:02,  7.46it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.76it/s] 30%|███       | 6/20 [00:00<00:01,  7.92it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.85it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.94it/s] 50%|█████     | 10/20 [00:01<00:01,  9.19it/s] 60%|██████    | 12/20 [00:01<00:00,  9.57it/s] 70%|███████   | 14/20 [00:01<00:00,  9.96it/s] 80%|████████  | 16/20 [00:01<00:00, 10.28it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.76it/s]100%|██████████| 20/20 [00:05<00:00,  1.53it/s]100%|██████████| 20/20 [00:05<00:00,  3.55it/s]
2025-03-13 16:13:28,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:13:28
2025-03-13 16:14:10,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6409 secs
2025-03-13 16:14:10,924 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:14:10,924 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 16:14:54,055 [INFO]: 	>>> Finished "Compute fast metrics" in 43.1307 secs
2025-03-13 16:14:54,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.4146 secs
2025-03-13 16:14:54,060 [INFO]: {
2025-03-13 16:14:54,060 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:54,060 [INFO]: 	index_param: efSearch=187
2025-03-13 16:14:54,060 [INFO]: 	index_path: knn.index
2025-03-13 16:14:54,060 [INFO]: 	size in bytes: 989819290
2025-03-13 16:14:54,060 [INFO]: 	avg_search_speed_ms: 8.601453589682633
2025-03-13 16:14:54,060 [INFO]: 	99p_search_speed_ms: 13.319307893980296
2025-03-13 16:14:54,060 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:54,060 [INFO]: 	nb vectors: 5031
2025-03-13 16:14:54,060 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:54,060 [INFO]: 	compression ratio: 0.9993085182245741
2025-03-13 16:14:54,060 [INFO]: }
2025-03-13 16:14:54,060 [INFO]: 	>>> Finished "Creating the index" in 91.4165 secs
2025-03-13 16:14:54,060 [INFO]: >>> Finished "Launching the whole pipeline" in 91.4427 secs
2025-03-13 16:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 91111 [episode count 7/20]
[retrieval_preprocessing] for episode 91145 [episode count 8/20], we have num_retrieval=np.int64(5009) num_query=np.int64(260)
2025-03-13 16:15:00,427 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:01,329 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:01
2025-03-13 16:15:01,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.65it/s]
2025-03-13 16:15:01,353 [INFO]: There are 5009 embeddings of dim 49152
2025-03-13 16:15:01,353 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 16:15:01,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:01,354 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:15:01,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:01,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:15:01,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,354 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:01,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:15:01,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:01
2025-03-13 16:15:01,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:01,354 [INFO]: 	Creating the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:01
2025-03-13 16:15:01,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 16:15:01,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:01
2025-03-13 16:15:01,357 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:15:01,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.68it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.49it/s] 20%|██        | 4/20 [00:00<00:01,  8.48it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.93it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.84it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.22it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.17it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.60it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.76it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.75it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.74it/s]100%|██████████| 20/20 [00:06<00:00,  3.09it/s]
2025-03-13 16:15:07,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:07
2025-03-13 16:15:59,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3475 secs
2025-03-13 16:15:59,188 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:15:59,188 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 16:16:38,618 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4301 secs
2025-03-13 16:16:38,947 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.5903 secs
2025-03-13 16:16:38,947 [INFO]: {
2025-03-13 16:16:38,947 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:38,947 [INFO]: 	index_param: efSearch=237
2025-03-13 16:16:38,947 [INFO]: 	index_path: knn.index
2025-03-13 16:16:38,948 [INFO]: 	size in bytes: 985490890
2025-03-13 16:16:38,948 [INFO]: 	avg_search_speed_ms: 8.186146057913547
2025-03-13 16:16:38,948 [INFO]: 	99p_search_speed_ms: 13.106162433978168
2025-03-13 16:16:38,948 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:38,948 [INFO]: 	nb vectors: 5009
2025-03-13 16:16:38,948 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:38,948 [INFO]: 	compression ratio: 0.9993085496711187
2025-03-13 16:16:38,948 [INFO]: }
2025-03-13 16:16:38,948 [INFO]: 	>>> Finished "Creating the index" in 97.5936 secs
2025-03-13 16:16:38,948 [INFO]: >>> Finished "Launching the whole pipeline" in 97.6187 secs
2025-03-13 16:16:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:16:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 91145 [episode count 8/20]
[retrieval_preprocessing] for episode 44555 [episode count 9/20], we have num_retrieval=np.int64(4980) num_query=np.int64(289)
2025-03-13 16:16:44,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:16:44,987 [INFO]: Launching the whole pipeline 03/13/2025, 16:16:44
2025-03-13 16:16:44,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:16:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-13 16:16:45,013 [INFO]: There are 4980 embeddings of dim 49152
2025-03-13 16:16:45,013 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 16:16:45,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:16:45
2025-03-13 16:16:45,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:16:45,014 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:16:45,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:16:45,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:16:45,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:16:45
2025-03-13 16:16:45,014 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:16:45,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:16:45,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:16:45
2025-03-13 16:16:45,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:16:45,014 [INFO]: 	Creating the index 03/13/2025, 16:16:45
2025-03-13 16:16:45,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:16:45
2025-03-13 16:16:45,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:16:45,015 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:16:45
2025-03-13 16:16:45,015 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:16:45,015 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.76it/s] 10%|█         | 2/20 [00:00<00:02,  6.19it/s] 15%|█▌        | 3/20 [00:00<00:02,  6.60it/s] 20%|██        | 4/20 [00:00<00:02,  6.82it/s] 25%|██▌       | 5/20 [00:00<00:02,  7.34it/s] 30%|███       | 6/20 [00:00<00:01,  7.45it/s] 35%|███▌      | 7/20 [00:01<00:02,  4.81it/s] 40%|████      | 8/20 [00:02<00:08,  1.46it/s] 50%|█████     | 10/20 [00:03<00:03,  2.58it/s] 60%|██████    | 12/20 [00:03<00:02,  3.95it/s] 75%|███████▌  | 15/20 [00:03<00:00,  6.43it/s] 90%|█████████ | 18/20 [00:03<00:00,  5.58it/s]100%|██████████| 20/20 [00:07<00:00,  1.67it/s]100%|██████████| 20/20 [00:07<00:00,  2.72it/s]
2025-03-13 16:16:52,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:16:52
2025-03-13 16:17:48,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4072 secs
2025-03-13 16:17:48,782 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 16:17:48,782 [INFO]: 	Compute fast metrics 03/13/2025, 16:17:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.40it/s] 50%|█████     | 2/4 [00:00<00:00,  5.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.58it/s]
2025-03-13 16:18:14,916 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1342 secs
2025-03-13 16:18:14,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.9075 secs
2025-03-13 16:18:14,923 [INFO]: {
2025-03-13 16:18:14,923 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:14,923 [INFO]: 	index_param: efSearch=231
2025-03-13 16:18:14,923 [INFO]: 	index_path: knn.index
2025-03-13 16:18:14,923 [INFO]: 	size in bytes: 979785190
2025-03-13 16:18:14,923 [INFO]: 	avg_search_speed_ms: 9.364940623939386
2025-03-13 16:18:14,923 [INFO]: 	99p_search_speed_ms: 14.75790516473351
2025-03-13 16:18:14,923 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:14,923 [INFO]: 	nb vectors: 4980
2025-03-13 16:18:14,923 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:14,923 [INFO]: 	compression ratio: 0.9993086749964041
2025-03-13 16:18:14,923 [INFO]: }
2025-03-13 16:18:14,923 [INFO]: 	>>> Finished "Creating the index" in 89.9092 secs
2025-03-13 16:18:14,923 [INFO]: >>> Finished "Launching the whole pipeline" in 89.9360 secs
2025-03-13 16:18:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 44555 [episode count 9/20]
[retrieval_preprocessing] for episode 24130 [episode count 10/20], we have num_retrieval=np.int64(5029) num_query=np.int64(240)
2025-03-13 16:18:20,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:18:21,172 [INFO]: Launching the whole pipeline 03/13/2025, 16:18:21
2025-03-13 16:18:21,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:18:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1124.48it/s]
2025-03-13 16:18:21,197 [INFO]: There are 5029 embeddings of dim 49152
2025-03-13 16:18:21,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 16:18:21,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:18:21
2025-03-13 16:18:21,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:18:21,198 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:18:21,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:18:21,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:18:21,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:18:21
2025-03-13 16:18:21,198 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:18:21,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:18:21,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:18:21
2025-03-13 16:18:21,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:18:21,198 [INFO]: 	Creating the index 03/13/2025, 16:18:21
2025-03-13 16:18:21,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:18:21
2025-03-13 16:18:21,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:18:21,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:18:21
2025-03-13 16:18:21,200 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:18:21,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.56it/s] 20%|██        | 4/20 [00:00<00:00, 17.34it/s] 35%|███▌      | 7/20 [00:00<00:00, 20.46it/s] 50%|█████     | 10/20 [00:00<00:00, 22.60it/s] 65%|██████▌   | 13/20 [00:00<00:00, 24.05it/s] 80%|████████  | 16/20 [00:00<00:00, 24.99it/s] 95%|█████████▌| 19/20 [00:00<00:00, 25.82it/s]100%|██████████| 20/20 [00:04<00:00,  4.83it/s]
2025-03-13 16:18:25,347 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:25
2025-03-13 16:19:16,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9142 secs
2025-03-13 16:19:16,262 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 16:19:16,262 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 16:19:49,713 [INFO]: 	>>> Finished "Compute fast metrics" in 33.4516 secs
2025-03-13 16:19:49,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.5182 secs
2025-03-13 16:19:49,719 [INFO]: {
2025-03-13 16:19:49,719 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:49,719 [INFO]: 	index_param: efSearch=251
2025-03-13 16:19:49,719 [INFO]: 	index_path: knn.index
2025-03-13 16:19:49,719 [INFO]: 	size in bytes: 989425810
2025-03-13 16:19:49,719 [INFO]: 	avg_search_speed_ms: 10.953449106827248
2025-03-13 16:19:49,719 [INFO]: 	99p_search_speed_ms: 20.369789125397798
2025-03-13 16:19:49,719 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:49,719 [INFO]: 	nb vectors: 5029
2025-03-13 16:19:49,719 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:49,719 [INFO]: 	compression ratio: 0.9993085100539272
2025-03-13 16:19:49,719 [INFO]: }
2025-03-13 16:19:49,719 [INFO]: 	>>> Finished "Creating the index" in 88.5207 secs
2025-03-13 16:19:49,719 [INFO]: >>> Finished "Launching the whole pipeline" in 88.5464 secs
2025-03-13 16:19:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 24130 [episode count 10/20]
[retrieval_preprocessing] for episode 58818 [episode count 11/20], we have num_retrieval=np.int64(5041) num_query=np.int64(228)
2025-03-13 16:19:53,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:54,779 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:54
2025-03-13 16:19:54,779 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.18it/s]
2025-03-13 16:19:54,805 [INFO]: There are 5041 embeddings of dim 49152
2025-03-13 16:19:54,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:19:54,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:54
2025-03-13 16:19:54,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:54,806 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:19:54,806 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:54,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:54,806 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:54
2025-03-13 16:19:54,806 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:54,806 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:19:54,806 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:54
2025-03-13 16:19:54,806 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:54,806 [INFO]: 	Creating the index 03/13/2025, 16:19:54
2025-03-13 16:19:54,806 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:54
2025-03-13 16:19:54,807 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:19:54,807 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:54
2025-03-13 16:19:54,808 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:19:54,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.22it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.27it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.32it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.79it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.14it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.28it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.40it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.40it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.36it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.40it/s]100%|██████████| 20/20 [00:05<00:00,  3.63it/s]
2025-03-13 16:20:00,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:00
2025-03-13 16:20:47,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0623 secs
2025-03-13 16:20:47,392 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 16:20:47,392 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 16:21:27,894 [INFO]: 	>>> Finished "Compute fast metrics" in 40.5015 secs
2025-03-13 16:21:27,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.0901 secs
2025-03-13 16:21:27,898 [INFO]: {
2025-03-13 16:21:27,898 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:27,898 [INFO]: 	index_param: efSearch=229
2025-03-13 16:21:27,898 [INFO]: 	index_path: knn.index
2025-03-13 16:21:27,898 [INFO]: 	size in bytes: 991786810
2025-03-13 16:21:27,898 [INFO]: 	avg_search_speed_ms: 9.672095813352536
2025-03-13 16:21:27,898 [INFO]: 	99p_search_speed_ms: 17.78126947581768
2025-03-13 16:21:27,898 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:27,898 [INFO]: 	nb vectors: 5041
2025-03-13 16:21:27,898 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:27,898 [INFO]: 	compression ratio: 0.9993084380704761
2025-03-13 16:21:27,898 [INFO]: }
2025-03-13 16:21:27,898 [INFO]: 	>>> Finished "Creating the index" in 93.0917 secs
2025-03-13 16:21:27,898 [INFO]: >>> Finished "Launching the whole pipeline" in 93.1190 secs
2025-03-13 16:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 58818 [episode count 11/20]
[retrieval_preprocessing] for episode 18067 [episode count 12/20], we have num_retrieval=np.int64(4970) num_query=np.int64(299)
2025-03-13 16:21:33,131 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:34,118 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:34
2025-03-13 16:21:34,118 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 970.23it/s]
2025-03-13 16:21:34,144 [INFO]: There are 4970 embeddings of dim 49152
2025-03-13 16:21:34,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:21:34,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:34
2025-03-13 16:21:34,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:34,144 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:21:34,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:34,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:34,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:34
2025-03-13 16:21:34,145 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:34,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:21:34,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:34
2025-03-13 16:21:34,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:34,145 [INFO]: 	Creating the index 03/13/2025, 16:21:34
2025-03-13 16:21:34,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:34
2025-03-13 16:21:34,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:21:34,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:34
2025-03-13 16:21:34,146 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:21:34,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.43it/s] 10%|█         | 2/20 [00:00<00:03,  5.83it/s] 15%|█▌        | 3/20 [00:00<00:02,  6.54it/s] 20%|██        | 4/20 [00:00<00:02,  6.90it/s] 25%|██▌       | 5/20 [00:00<00:02,  7.11it/s] 30%|███       | 6/20 [00:00<00:01,  7.47it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.69it/s] 40%|████      | 8/20 [00:01<00:01,  7.96it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.16it/s] 50%|█████     | 10/20 [00:01<00:01,  8.40it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.55it/s] 60%|██████    | 12/20 [00:01<00:00,  8.48it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.36it/s] 70%|███████   | 14/20 [00:01<00:00,  8.61it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.84it/s] 80%|████████  | 16/20 [00:02<00:00,  9.11it/s] 85%|████████▌ | 17/20 [00:02<00:00,  9.07it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.91it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.14it/s]100%|██████████| 20/20 [00:06<00:00,  1.25s/it]100%|██████████| 20/20 [00:06<00:00,  3.19it/s]
2025-03-13 16:21:40,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:40
2025-03-13 16:22:28,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6465 secs
2025-03-13 16:22:28,072 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 16:22:28,072 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.03it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 16:23:29,300 [INFO]: 	>>> Finished "Compute fast metrics" in 61.2274 secs
2025-03-13 16:23:29,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.1589 secs
2025-03-13 16:23:29,305 [INFO]: {
2025-03-13 16:23:29,305 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:29,305 [INFO]: 	index_param: efSearch=201
2025-03-13 16:23:29,305 [INFO]: 	index_path: knn.index
2025-03-13 16:23:29,305 [INFO]: 	size in bytes: 977817730
2025-03-13 16:23:29,305 [INFO]: 	avg_search_speed_ms: 7.9831582259389755
2025-03-13 16:23:29,305 [INFO]: 	99p_search_speed_ms: 11.676988860126585
2025-03-13 16:23:29,305 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:29,305 [INFO]: 	nb vectors: 4970
2025-03-13 16:23:29,305 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:29,305 [INFO]: 	compression ratio: 0.999308695292322
2025-03-13 16:23:29,305 [INFO]: }
2025-03-13 16:23:29,305 [INFO]: 	>>> Finished "Creating the index" in 115.1603 secs
2025-03-13 16:23:29,305 [INFO]: >>> Finished "Launching the whole pipeline" in 115.1867 secs
2025-03-13 16:23:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 18067 [episode count 12/20]
[retrieval_preprocessing] for episode 19697 [episode count 13/20], we have num_retrieval=np.int64(5040) num_query=np.int64(229)
2025-03-13 16:23:33,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:34,527 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:34
2025-03-13 16:23:34,527 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1115.21it/s]
2025-03-13 16:23:34,554 [INFO]: There are 5040 embeddings of dim 49152
2025-03-13 16:23:34,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:23:34,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:34
2025-03-13 16:23:34,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:34,554 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:23:34,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:34,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:34,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:34
2025-03-13 16:23:34,554 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:34,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:23:34,554 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:34
2025-03-13 16:23:34,554 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:34,554 [INFO]: 	Creating the index 03/13/2025, 16:23:34
2025-03-13 16:23:34,555 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:34
2025-03-13 16:23:34,556 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:23:34,556 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:34
2025-03-13 16:23:34,556 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:23:34,556 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.49it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.71it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.62it/s] 30%|███       | 6/20 [00:00<00:01,  9.69it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.71it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.95it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.88it/s] 60%|██████    | 12/20 [00:01<00:00,  9.75it/s] 70%|███████   | 14/20 [00:01<00:00,  9.81it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.53it/s] 80%|████████  | 16/20 [00:01<00:00,  9.31it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.17it/s] 90%|█████████ | 18/20 [00:01<00:00,  8.87it/s] 95%|█████████▌| 19/20 [00:02<00:00,  8.86it/s]100%|██████████| 20/20 [00:06<00:00,  1.32s/it]100%|██████████| 20/20 [00:06<00:00,  3.10it/s]
2025-03-13 16:23:41,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:41
2025-03-13 16:24:26,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0989 secs
2025-03-13 16:24:26,116 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:24:26,116 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.90it/s] 50%|█████     | 2/4 [00:00<00:00,  4.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.00it/s]
2025-03-13 16:24:47,846 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7295 secs
2025-03-13 16:24:47,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2958 secs
2025-03-13 16:24:47,852 [INFO]: {
2025-03-13 16:24:47,852 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:47,852 [INFO]: 	index_param: efSearch=197
2025-03-13 16:24:47,852 [INFO]: 	index_path: knn.index
2025-03-13 16:24:47,852 [INFO]: 	size in bytes: 991590070
2025-03-13 16:24:47,852 [INFO]: 	avg_search_speed_ms: 9.960741295379055
2025-03-13 16:24:47,852 [INFO]: 	99p_search_speed_ms: 20.685175072867423
2025-03-13 16:24:47,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:47,852 [INFO]: 	nb vectors: 5040
2025-03-13 16:24:47,852 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:47,852 [INFO]: 	compression ratio: 0.999308433978166
2025-03-13 16:24:47,852 [INFO]: }
2025-03-13 16:24:47,852 [INFO]: 	>>> Finished "Creating the index" in 73.2975 secs
2025-03-13 16:24:47,852 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3248 secs
2025-03-13 16:24:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 19697 [episode count 13/20]
[retrieval_preprocessing] for episode 23795 [episode count 14/20], we have num_retrieval=np.int64(4953) num_query=np.int64(316)
2025-03-13 16:24:52,220 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:53,240 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:53
2025-03-13 16:24:53,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1764.54it/s]
2025-03-13 16:24:53,265 [INFO]: There are 4953 embeddings of dim 49152
2025-03-13 16:24:53,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 16:24:53,266 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:53
2025-03-13 16:24:53,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:53,266 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:24:53,266 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:53,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:53,266 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:53
2025-03-13 16:24:53,266 [INFO]: 1022.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:53,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:24:53,266 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:53
2025-03-13 16:24:53,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:53,266 [INFO]: 	Creating the index 03/13/2025, 16:24:53
2025-03-13 16:24:53,266 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:53
2025-03-13 16:24:53,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:24:53,267 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:53
2025-03-13 16:24:53,267 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:24:53,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.44it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.40it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.83it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.69it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.42it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.72it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.11it/s] 75%|███████▌  | 15/20 [00:01<00:00, 13.58it/s] 85%|████████▌ | 17/20 [00:01<00:00, 13.89it/s] 95%|█████████▌| 19/20 [00:01<00:00, 14.30it/s]100%|██████████| 20/20 [00:05<00:00,  3.86it/s]
2025-03-13 16:24:58,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:58
2025-03-13 16:25:44,174 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7191 secs
2025-03-13 16:25:44,174 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:25:44,175 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.83it/s] 50%|█████     | 2/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.99it/s]
2025-03-13 16:26:20,241 [INFO]: 	>>> Finished "Compute fast metrics" in 36.0668 secs
2025-03-13 16:26:20,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.9779 secs
2025-03-13 16:26:20,245 [INFO]: {
2025-03-13 16:26:20,245 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:20,245 [INFO]: 	index_param: efSearch=237
2025-03-13 16:26:20,245 [INFO]: 	index_path: knn.index
2025-03-13 16:26:20,245 [INFO]: 	size in bytes: 974473150
2025-03-13 16:26:20,245 [INFO]: 	avg_search_speed_ms: 8.131449474816824
2025-03-13 16:26:20,245 [INFO]: 	99p_search_speed_ms: 11.251507683191448
2025-03-13 16:26:20,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:20,245 [INFO]: 	nb vectors: 4953
2025-03-13 16:26:20,246 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:20,246 [INFO]: 	compression ratio: 0.9993086253838805
2025-03-13 16:26:20,246 [INFO]: }
2025-03-13 16:26:20,246 [INFO]: 	>>> Finished "Creating the index" in 86.9794 secs
2025-03-13 16:26:20,246 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0052 secs
2025-03-13 16:26:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 23795 [episode count 14/20]
[retrieval_preprocessing] for episode 63235 [episode count 15/20], we have num_retrieval=np.int64(5045) num_query=np.int64(224)
2025-03-13 16:26:24,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:26,395 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:26
2025-03-13 16:26:26,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 986.20it/s]
2025-03-13 16:26:26,418 [INFO]: There are 5045 embeddings of dim 49152
2025-03-13 16:26:26,418 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 16:26:26,418 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,418 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:26,418 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:26:26,418 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:26,418 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:26,418 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,419 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:26,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:26,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:26
2025-03-13 16:26:26,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:26,419 [INFO]: 	Creating the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:26
2025-03-13 16:26:26,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:26:26,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:26
2025-03-13 16:26:26,420 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:26:26,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.85it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.23it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.46it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.20it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.53it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.76it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.83it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.98it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.19it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.51it/s]100%|██████████| 20/20 [00:05<00:00,  3.85it/s]
2025-03-13 16:26:31,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:31
2025-03-13 16:27:18,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4391 secs
2025-03-13 16:27:18,066 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 16:27:18,066 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 16:27:43,956 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8903 secs
2025-03-13 16:27:43,960 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5403 secs
2025-03-13 16:27:43,960 [INFO]: {
2025-03-13 16:27:43,960 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:43,960 [INFO]: 	index_param: efSearch=167
2025-03-13 16:27:43,960 [INFO]: 	index_path: knn.index
2025-03-13 16:27:43,960 [INFO]: 	size in bytes: 992573770
2025-03-13 16:27:43,960 [INFO]: 	avg_search_speed_ms: 8.125951585011572
2025-03-13 16:27:43,960 [INFO]: 	99p_search_speed_ms: 14.988798152189709
2025-03-13 16:27:43,960 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:43,960 [INFO]: 	nb vectors: 5045
2025-03-13 16:27:43,960 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:43,960 [INFO]: 	compression ratio: 0.9993084544234934
2025-03-13 16:27:43,960 [INFO]: }
2025-03-13 16:27:43,960 [INFO]: 	>>> Finished "Creating the index" in 77.5416 secs
2025-03-13 16:27:43,960 [INFO]: >>> Finished "Launching the whole pipeline" in 77.5655 secs
2025-03-13 16:27:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 63235 [episode count 15/20]
[retrieval_preprocessing] for episode 91910 [episode count 16/20], we have num_retrieval=np.int64(4994) num_query=np.int64(275)
2025-03-13 16:27:47,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:48,351 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:48
2025-03-13 16:27:48,351 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.00it/s]
2025-03-13 16:27:48,376 [INFO]: There are 4994 embeddings of dim 49152
2025-03-13 16:27:48,377 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 16:27:48,377 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:48
2025-03-13 16:27:48,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:48,377 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:27:48,377 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:48,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:27:48,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:48
2025-03-13 16:27:48,377 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:48,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:27:48,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:48
2025-03-13 16:27:48,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:48,377 [INFO]: 	Creating the index 03/13/2025, 16:27:48
2025-03-13 16:27:48,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:48
2025-03-13 16:27:48,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:27:48,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:48
2025-03-13 16:27:48,378 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:27:48,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.73it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.06it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.59it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.23it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.33it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.50it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.63it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.83it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.93it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.88it/s]100%|██████████| 20/20 [00:05<00:00,  3.92it/s]
2025-03-13 16:27:53,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:53
2025-03-13 16:28:37,297 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8156 secs
2025-03-13 16:28:37,297 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 16:28:37,297 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 16:29:22,963 [INFO]: 	>>> Finished "Compute fast metrics" in 45.6662 secs
2025-03-13 16:29:22,967 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5886 secs
2025-03-13 16:29:22,967 [INFO]: {
2025-03-13 16:29:22,967 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:22,967 [INFO]: 	index_param: efSearch=252
2025-03-13 16:29:22,967 [INFO]: 	index_path: knn.index
2025-03-13 16:29:22,967 [INFO]: 	size in bytes: 982539790
2025-03-13 16:29:22,967 [INFO]: 	avg_search_speed_ms: 10.559201953783159
2025-03-13 16:29:22,967 [INFO]: 	99p_search_speed_ms: 14.673732235096393
2025-03-13 16:29:22,967 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:22,967 [INFO]: 	nb vectors: 4994
2025-03-13 16:29:22,967 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:22,967 [INFO]: 	compression ratio: 0.9993084880562445
2025-03-13 16:29:22,967 [INFO]: }
2025-03-13 16:29:22,967 [INFO]: 	>>> Finished "Creating the index" in 94.5902 secs
2025-03-13 16:29:22,967 [INFO]: >>> Finished "Launching the whole pipeline" in 94.6165 secs
2025-03-13 16:29:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 91910 [episode count 16/20]
[retrieval_preprocessing] for episode 89869 [episode count 17/20], we have num_retrieval=np.int64(5008) num_query=np.int64(261)
2025-03-13 16:29:29,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:30,736 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:30
2025-03-13 16:29:30,736 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.77it/s]
2025-03-13 16:29:30,764 [INFO]: There are 5008 embeddings of dim 49152
2025-03-13 16:29:30,765 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 16:29:30,765 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:30
2025-03-13 16:29:30,765 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:30,765 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:29:30,765 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:30,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:30,765 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:30
2025-03-13 16:29:30,765 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:30,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:30,765 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:30
2025-03-13 16:29:30,765 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:30,765 [INFO]: 	Creating the index 03/13/2025, 16:29:30
2025-03-13 16:29:30,765 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:30
2025-03-13 16:29:30,767 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:29:30,767 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:30
2025-03-13 16:29:30,767 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:29:30,767 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.86it/s] 10%|█         | 2/20 [00:00<00:02,  6.22it/s] 20%|██        | 4/20 [00:00<00:01,  8.41it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.82it/s] 30%|███       | 6/20 [00:00<00:01,  8.48it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.22it/s] 40%|████      | 8/20 [00:01<00:01,  7.98it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.71it/s] 50%|█████     | 10/20 [00:01<00:01,  7.50it/s] 55%|█████▌    | 11/20 [00:01<00:01,  7.36it/s] 60%|██████    | 12/20 [00:01<00:01,  7.27it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.23it/s] 70%|███████   | 14/20 [00:01<00:00,  7.34it/s] 75%|███████▌  | 15/20 [00:01<00:00,  7.58it/s] 80%|████████  | 16/20 [00:02<00:00,  7.77it/s] 85%|████████▌ | 17/20 [00:02<00:00,  7.82it/s] 90%|█████████ | 18/20 [00:02<00:00,  7.92it/s] 95%|█████████▌| 19/20 [00:02<00:00,  8.17it/s]100%|██████████| 20/20 [00:06<00:00,  1.39s/it]100%|██████████| 20/20 [00:06<00:00,  2.94it/s]
2025-03-13 16:29:37,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:37
2025-03-13 16:30:25,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1412 secs
2025-03-13 16:30:25,717 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 16:30:25,717 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 16:30:56,930 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2133 secs
2025-03-13 16:30:56,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.1678 secs
2025-03-13 16:30:56,935 [INFO]: {
2025-03-13 16:30:56,935 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:56,935 [INFO]: 	index_param: efSearch=217
2025-03-13 16:30:56,935 [INFO]: 	index_path: knn.index
2025-03-13 16:30:56,935 [INFO]: 	size in bytes: 985294150
2025-03-13 16:30:56,935 [INFO]: 	avg_search_speed_ms: 9.017158265673196
2025-03-13 16:30:56,935 [INFO]: 	99p_search_speed_ms: 12.745698280632503
2025-03-13 16:30:56,935 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:56,935 [INFO]: 	nb vectors: 5008
2025-03-13 16:30:56,935 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:56,935 [INFO]: 	compression ratio: 0.9993085455749433
2025-03-13 16:30:56,935 [INFO]: }
2025-03-13 16:30:56,935 [INFO]: 	>>> Finished "Creating the index" in 86.1695 secs
2025-03-13 16:30:56,935 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1983 secs
2025-03-13 16:30:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 89869 [episode count 17/20]
[retrieval_preprocessing] for episode 46206 [episode count 18/20], we have num_retrieval=np.int64(5037) num_query=np.int64(232)
2025-03-13 16:31:01,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:02,253 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:02
2025-03-13 16:31:02,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1057.83it/s]
2025-03-13 16:31:02,294 [INFO]: There are 5037 embeddings of dim 49152
2025-03-13 16:31:02,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 16:31:02,294 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:02
2025-03-13 16:31:02,294 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:02,294 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:31:02,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:02,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:31:02,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:02
2025-03-13 16:31:02,295 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:02,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:31:02,295 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:02
2025-03-13 16:31:02,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:02,295 [INFO]: 	Creating the index 03/13/2025, 16:31:02
2025-03-13 16:31:02,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:02
2025-03-13 16:31:02,298 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:31:02,298 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:02
2025-03-13 16:31:02,298 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:31:02,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.52it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.71it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.66it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.23it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.49it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.56it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.71it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.67it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.60it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.52it/s]100%|██████████| 20/20 [00:05<00:00,  3.40it/s]
2025-03-13 16:31:08,182 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:08
2025-03-13 16:31:54,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4899 secs
2025-03-13 16:31:54,673 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 16:31:54,673 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s]
2025-03-13 16:32:25,864 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1912 secs
2025-03-13 16:32:26,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.9138 secs
2025-03-13 16:32:26,212 [INFO]: {
2025-03-13 16:32:26,212 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:26,212 [INFO]: 	index_param: efSearch=198
2025-03-13 16:32:26,212 [INFO]: 	index_path: knn.index
2025-03-13 16:32:26,212 [INFO]: 	size in bytes: 990999850
2025-03-13 16:32:26,212 [INFO]: 	avg_search_speed_ms: 8.277700037467262
2025-03-13 16:32:26,213 [INFO]: 	99p_search_speed_ms: 12.097875482868407
2025-03-13 16:32:26,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:26,213 [INFO]: 	nb vectors: 5037
2025-03-13 16:32:26,213 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:26,213 [INFO]: 	compression ratio: 0.9993084216914866
2025-03-13 16:32:26,213 [INFO]: }
2025-03-13 16:32:26,213 [INFO]: 	>>> Finished "Creating the index" in 83.9174 secs
2025-03-13 16:32:26,213 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9599 secs
2025-03-13 16:32:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 46206 [episode count 18/20]
[retrieval_preprocessing] for episode 43690 [episode count 19/20], we have num_retrieval=np.int64(4985) num_query=np.int64(284)
2025-03-13 16:32:29,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:30,673 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:30
2025-03-13 16:32:30,673 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1682.43it/s]
2025-03-13 16:32:30,908 [INFO]: There are 4985 embeddings of dim 49152
2025-03-13 16:32:30,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2348 secs
2025-03-13 16:32:30,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:30
2025-03-13 16:32:30,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:30,908 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:32:30,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:30,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:32:30,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:30
2025-03-13 16:32:30,908 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:30,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:32:30,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:30
2025-03-13 16:32:30,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:30,909 [INFO]: 	Creating the index 03/13/2025, 16:32:30
2025-03-13 16:32:30,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:30
2025-03-13 16:32:30,910 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:32:30,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:30
2025-03-13 16:32:30,910 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:32:30,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.57it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.93it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.71it/s] 30%|███       | 6/20 [00:00<00:01,  7.72it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.85it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.06it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.61it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.78it/s] 70%|███████   | 14/20 [00:01<00:00,  9.79it/s] 80%|████████  | 16/20 [00:01<00:00, 10.45it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.89it/s]100%|██████████| 20/20 [00:05<00:00,  1.54it/s]100%|██████████| 20/20 [00:05<00:00,  3.68it/s]
2025-03-13 16:32:36,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:36
2025-03-13 16:33:17,148 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4516 secs
2025-03-13 16:33:17,149 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 16:33:17,149 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-13 16:33:52,934 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7852 secs
2025-03-13 16:33:53,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.9161 secs
2025-03-13 16:33:53,826 [INFO]: {
2025-03-13 16:33:53,826 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:53,826 [INFO]: 	index_param: efSearch=274
2025-03-13 16:33:53,826 [INFO]: 	index_path: knn.index
2025-03-13 16:33:53,826 [INFO]: 	size in bytes: 980768950
2025-03-13 16:33:53,827 [INFO]: 	avg_search_speed_ms: 11.034832646620544
2025-03-13 16:33:53,827 [INFO]: 	99p_search_speed_ms: 17.870102939195924
2025-03-13 16:33:53,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:53,827 [INFO]: 	nb vectors: 4985
2025-03-13 16:33:53,827 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:53,827 [INFO]: 	compression ratio: 0.9993086343118835
2025-03-13 16:33:53,827 [INFO]: }
2025-03-13 16:33:53,827 [INFO]: 	>>> Finished "Creating the index" in 82.9183 secs
2025-03-13 16:33:53,827 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1538 secs
2025-03-13 16:33:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 43690 [episode count 19/20]
2025-03-13 16:33:57: [retrieval_preprocessing] finished for 1656877278_put_bowl_in_sink [chosen_id count 3/196]
2025-03-13 16:34:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_cans_on_tray [chosen_id count 4/196]
2025-03-13 16:34:05: [retrieval_preprocessing] we have num_total=7253 embedding_dim=49152
[retrieval_preprocessing] for episode 16394 [episode count 0/20], we have num_retrieval=np.int64(6885) num_query=np.int64(368)
2025-03-13 16:34:08,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:10,255 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:10
2025-03-13 16:34:10,255 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.71it/s]
2025-03-13 16:34:10,283 [INFO]: There are 6885 embeddings of dim 49152
2025-03-13 16:34:10,283 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 16:34:10,283 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,283 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:10,283 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:34:10,283 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:10,283 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:34:10,283 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,283 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:10,283 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:34:10,283 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:10
2025-03-13 16:34:10,283 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:10,283 [INFO]: 	Creating the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,284 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:10
2025-03-13 16:34:10,285 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:34:10,285 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:10
2025-03-13 16:34:10,285 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:34:10,285 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:07,  4.00it/s]  7%|▋         | 2/29 [00:00<00:04,  5.64it/s] 10%|█         | 3/29 [00:00<00:03,  6.62it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.01it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.54it/s] 21%|██        | 6/29 [00:00<00:02,  7.81it/s] 24%|██▍       | 7/29 [00:00<00:02,  7.99it/s] 28%|██▊       | 8/29 [00:01<00:02,  8.20it/s] 31%|███       | 9/29 [00:01<00:02,  8.35it/s] 34%|███▍      | 10/29 [00:01<00:02,  8.40it/s] 38%|███▊      | 11/29 [00:01<00:02,  8.52it/s] 41%|████▏     | 12/29 [00:01<00:01,  8.86it/s] 45%|████▍     | 13/29 [00:01<00:01,  9.14it/s] 52%|█████▏    | 15/29 [00:01<00:01,  9.45it/s] 55%|█████▌    | 16/29 [00:01<00:01,  8.83it/s] 59%|█████▊    | 17/29 [00:02<00:01,  7.67it/s] 62%|██████▏   | 18/29 [00:02<00:01,  8.02it/s] 66%|██████▌   | 19/29 [00:02<00:01,  8.21it/s] 69%|██████▉   | 20/29 [00:02<00:01,  8.32it/s] 72%|███████▏  | 21/29 [00:06<00:10,  1.33s/it] 76%|███████▌  | 22/29 [00:06<00:06,  1.03it/s] 83%|████████▎ | 24/29 [00:07<00:02,  1.75it/s] 86%|████████▌ | 25/29 [00:07<00:01,  2.19it/s] 93%|█████████▎| 27/29 [00:07<00:00,  3.26it/s]100%|██████████| 29/29 [00:10<00:00,  1.42it/s]100%|██████████| 29/29 [00:10<00:00,  2.86it/s]
2025-03-13 16:34:20,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:20
2025-03-13 16:35:24,153 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7281 secs
2025-03-13 16:35:24,153 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 16:35:24,153 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-13 16:36:22,838 [INFO]: 	>>> Finished "Compute fast metrics" in 58.6842 secs
2025-03-13 16:36:22,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.5546 secs
2025-03-13 16:36:22,839 [INFO]: {
2025-03-13 16:36:22,839 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:22,839 [INFO]: 	index_param: efSearch=230
2025-03-13 16:36:22,839 [INFO]: 	index_path: knn.index
2025-03-13 16:36:22,839 [INFO]: 	size in bytes: 1354582810
2025-03-13 16:36:22,839 [INFO]: 	avg_search_speed_ms: 12.022656292034439
2025-03-13 16:36:22,840 [INFO]: 	99p_search_speed_ms: 21.48738568881526
2025-03-13 16:36:22,840 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:22,840 [INFO]: 	nb vectors: 6885
2025-03-13 16:36:22,840 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:22,840 [INFO]: 	compression ratio: 0.9993084734332337
2025-03-13 16:36:22,840 [INFO]: }
2025-03-13 16:36:22,840 [INFO]: 	>>> Finished "Creating the index" in 132.5561 secs
2025-03-13 16:36:22,840 [INFO]: >>> Finished "Launching the whole pipeline" in 132.5846 secs
2025-03-13 16:36:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 16394 [episode count 0/20]
[retrieval_preprocessing] for episode 59405 [episode count 1/20], we have num_retrieval=np.int64(6708) num_query=np.int64(545)
2025-03-13 16:36:29,288 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:30,370 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:30
2025-03-13 16:36:30,370 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1188.19it/s]
2025-03-13 16:36:30,396 [INFO]: There are 6708 embeddings of dim 49152
2025-03-13 16:36:30,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:36:30,396 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:30
2025-03-13 16:36:30,396 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:30,397 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:36:30,397 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:30,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:30,397 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:30
2025-03-13 16:36:30,397 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:30,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:36:30,397 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:30
2025-03-13 16:36:30,397 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:30,397 [INFO]: 	Creating the index 03/13/2025, 16:36:30
2025-03-13 16:36:30,397 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:30
2025-03-13 16:36:30,398 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:36:30,398 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:30
2025-03-13 16:36:30,398 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:36:30,398 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.16it/s] 11%|█         | 3/28 [00:00<00:02,  8.69it/s] 18%|█▊        | 5/28 [00:00<00:02,  9.78it/s] 25%|██▌       | 7/28 [00:00<00:01, 10.53it/s] 32%|███▏      | 9/28 [00:00<00:01, 10.76it/s] 39%|███▉      | 11/28 [00:01<00:01, 10.76it/s] 46%|████▋     | 13/28 [00:01<00:01, 10.80it/s] 54%|█████▎    | 15/28 [00:01<00:01, 10.84it/s] 61%|██████    | 17/28 [00:01<00:01, 10.84it/s] 68%|██████▊   | 19/28 [00:01<00:00, 10.79it/s] 75%|███████▌  | 21/28 [00:05<00:04,  1.54it/s] 79%|███████▊  | 22/28 [00:05<00:03,  1.82it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.53it/s] 89%|████████▉ | 25/28 [00:06<00:01,  2.93it/s] 93%|█████████▎| 26/28 [00:06<00:00,  3.43it/s] 96%|█████████▋| 27/28 [00:06<00:00,  4.01it/s]100%|██████████| 28/28 [00:08<00:00,  1.34it/s]100%|██████████| 28/28 [00:08<00:00,  3.30it/s]
2025-03-13 16:36:38,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:38
2025-03-13 16:37:36,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.6214 secs
2025-03-13 16:37:36,498 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 16:37:36,498 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 16:38:37,802 [INFO]: 	>>> Finished "Compute fast metrics" in 61.3036 secs
2025-03-13 16:38:37,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.4059 secs
2025-03-13 16:38:37,804 [INFO]: {
2025-03-13 16:38:37,804 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:37,804 [INFO]: 	index_param: efSearch=200
2025-03-13 16:38:37,804 [INFO]: 	index_path: knn.index
2025-03-13 16:38:37,804 [INFO]: 	size in bytes: 1319759230
2025-03-13 16:38:37,804 [INFO]: 	avg_search_speed_ms: 11.92179485612701
2025-03-13 16:38:37,804 [INFO]: 	99p_search_speed_ms: 20.6445814948529
2025-03-13 16:38:37,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:37,804 [INFO]: 	nb vectors: 6708
2025-03-13 16:38:37,804 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:37,804 [INFO]: 	compression ratio: 0.9993083844543372
2025-03-13 16:38:37,804 [INFO]: }
2025-03-13 16:38:37,804 [INFO]: 	>>> Finished "Creating the index" in 127.4074 secs
2025-03-13 16:38:37,804 [INFO]: >>> Finished "Launching the whole pipeline" in 127.4346 secs
2025-03-13 16:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 59405 [episode count 1/20]
[retrieval_preprocessing] for episode 86031 [episode count 2/20], we have num_retrieval=np.int64(6726) num_query=np.int64(527)
2025-03-13 16:38:47,004 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:48,234 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:48
2025-03-13 16:38:48,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.55it/s]
2025-03-13 16:38:48,260 [INFO]: There are 6726 embeddings of dim 49152
2025-03-13 16:38:48,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:38:48,260 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:48
2025-03-13 16:38:48,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:48,260 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:38:48,260 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:48,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:48,260 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:48
2025-03-13 16:38:48,260 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:48,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:38:48,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:48
2025-03-13 16:38:48,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:48,260 [INFO]: 	Creating the index 03/13/2025, 16:38:48
2025-03-13 16:38:48,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:48
2025-03-13 16:38:48,261 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:38:48,261 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:48
2025-03-13 16:38:48,261 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:38:48,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.70it/s]  7%|▋         | 2/28 [00:00<00:03,  6.83it/s] 14%|█▍        | 4/28 [00:00<00:02,  8.62it/s] 21%|██▏       | 6/28 [00:00<00:02,  9.38it/s] 29%|██▊       | 8/28 [00:00<00:02,  9.63it/s] 36%|███▌      | 10/28 [00:01<00:01,  9.66it/s] 39%|███▉      | 11/28 [00:01<00:01,  9.65it/s] 43%|████▎     | 12/28 [00:01<00:01,  9.63it/s] 46%|████▋     | 13/28 [00:01<00:01,  9.63it/s] 50%|█████     | 14/28 [00:01<00:01,  9.59it/s] 54%|█████▎    | 15/28 [00:01<00:01,  9.61it/s] 61%|██████    | 17/28 [00:01<00:01,  9.93it/s] 68%|██████▊   | 19/28 [00:02<00:00, 10.15it/s] 75%|███████▌  | 21/28 [00:06<00:06,  1.12it/s] 79%|███████▊  | 22/28 [00:06<00:04,  1.35it/s] 82%|████████▏ | 23/28 [00:06<00:02,  1.68it/s] 89%|████████▉ | 25/28 [00:07<00:01,  2.48it/s] 96%|█████████▋| 27/28 [00:07<00:00,  3.42it/s]100%|██████████| 28/28 [00:09<00:00,  1.61it/s]100%|██████████| 28/28 [00:09<00:00,  3.03it/s]
2025-03-13 16:38:57,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:57
2025-03-13 16:39:56,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2764 secs
2025-03-13 16:39:56,774 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:39:56,775 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 16:41:03,044 [INFO]: 	>>> Finished "Compute fast metrics" in 66.2697 secs
2025-03-13 16:41:03,047 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.7852 secs
2025-03-13 16:41:03,047 [INFO]: {
2025-03-13 16:41:03,047 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:03,047 [INFO]: 	index_param: efSearch=207
2025-03-13 16:41:03,047 [INFO]: 	index_path: knn.index
2025-03-13 16:41:03,047 [INFO]: 	size in bytes: 1323300610
2025-03-13 16:41:03,047 [INFO]: 	avg_search_speed_ms: 9.583145505802213
2025-03-13 16:41:03,047 [INFO]: 	99p_search_speed_ms: 15.851019199471903
2025-03-13 16:41:03,047 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:03,047 [INFO]: 	nb vectors: 6726
2025-03-13 16:41:03,047 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:03,047 [INFO]: 	compression ratio: 0.9993083944849085
2025-03-13 16:41:03,047 [INFO]: }
2025-03-13 16:41:03,047 [INFO]: 	>>> Finished "Creating the index" in 134.7865 secs
2025-03-13 16:41:03,047 [INFO]: >>> Finished "Launching the whole pipeline" in 134.8132 secs
2025-03-13 16:41:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 86031 [episode count 2/20]
[retrieval_preprocessing] for episode 49192 [episode count 3/20], we have num_retrieval=np.int64(7080) num_query=np.int64(173)
2025-03-13 16:41:10,036 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:11,061 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:11
2025-03-13 16:41:11,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.38it/s]
2025-03-13 16:41:11,090 [INFO]: There are 7080 embeddings of dim 49152
2025-03-13 16:41:11,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:41:11,091 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:11
2025-03-13 16:41:11,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:11,091 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:41:11,092 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:11,092 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:41:11,092 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:11
2025-03-13 16:41:11,092 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:11,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:11,093 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:11
2025-03-13 16:41:11,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:11,093 [INFO]: 	Creating the index 03/13/2025, 16:41:11
2025-03-13 16:41:11,093 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:11
2025-03-13 16:41:11,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:41:11,097 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:11
2025-03-13 16:41:11,097 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:41:11,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  5.58it/s] 10%|█         | 3/29 [00:00<00:02,  9.68it/s] 17%|█▋        | 5/29 [00:00<00:02, 11.27it/s] 24%|██▍       | 7/29 [00:00<00:01, 13.10it/s] 31%|███       | 9/29 [00:00<00:01, 12.67it/s] 38%|███▊      | 11/29 [00:00<00:01, 11.88it/s] 45%|████▍     | 13/29 [00:01<00:01, 11.88it/s] 52%|█████▏    | 15/29 [00:01<00:01, 11.84it/s] 59%|█████▊    | 17/29 [00:01<00:01, 11.85it/s] 66%|██████▌   | 19/29 [00:01<00:00, 11.80it/s] 72%|███████▏  | 21/29 [00:05<00:05,  1.42it/s] 76%|███████▌  | 22/29 [00:05<00:04,  1.67it/s] 79%|███████▉  | 23/29 [00:06<00:02,  2.01it/s] 83%|████████▎ | 24/29 [00:06<00:02,  2.44it/s] 86%|████████▌ | 25/29 [00:06<00:01,  2.97it/s] 90%|████████▉ | 26/29 [00:06<00:00,  3.62it/s] 93%|█████████▎| 27/29 [00:06<00:00,  4.36it/s] 97%|█████████▋| 28/29 [00:06<00:00,  5.14it/s]100%|██████████| 29/29 [00:08<00:00,  1.29it/s]100%|██████████| 29/29 [00:08<00:00,  3.29it/s]
2025-03-13 16:41:19,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:19
2025-03-13 16:42:30,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.8078 secs
2025-03-13 16:42:30,722 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 16:42:30,722 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.90it/s]
2025-03-13 16:43:26,091 [INFO]: 	>>> Finished "Compute fast metrics" in 55.3696 secs
2025-03-13 16:43:26,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.9970 secs
2025-03-13 16:43:26,094 [INFO]: {
2025-03-13 16:43:26,094 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:26,094 [INFO]: 	index_param: efSearch=153
2025-03-13 16:43:26,094 [INFO]: 	index_path: knn.index
2025-03-13 16:43:26,094 [INFO]: 	size in bytes: 1392948070
2025-03-13 16:43:26,094 [INFO]: 	avg_search_speed_ms: 8.4574872272502
2025-03-13 16:43:26,094 [INFO]: 	99p_search_speed_ms: 14.515977394767146
2025-03-13 16:43:26,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:26,094 [INFO]: 	nb vectors: 7080
2025-03-13 16:43:26,094 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:26,094 [INFO]: 	compression ratio: 0.9993083518181693
2025-03-13 16:43:26,094 [INFO]: }
2025-03-13 16:43:26,094 [INFO]: 	>>> Finished "Creating the index" in 135.0010 secs
2025-03-13 16:43:26,094 [INFO]: >>> Finished "Launching the whole pipeline" in 135.0330 secs
2025-03-13 16:43:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 49192 [episode count 3/20]
[retrieval_preprocessing] for episode 53294 [episode count 4/20], we have num_retrieval=np.int64(7008) num_query=np.int64(245)
2025-03-13 16:43:30,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:32,107 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:32
2025-03-13 16:43:32,107 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.06it/s]
2025-03-13 16:43:32,132 [INFO]: There are 7008 embeddings of dim 49152
2025-03-13 16:43:32,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 16:43:32,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:32,133 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:43:32,133 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:32,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:32,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,133 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:32,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:43:32,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:32
2025-03-13 16:43:32,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:32,133 [INFO]: 	Creating the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:32
2025-03-13 16:43:32,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:43:32,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,134 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:43:32,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  4.90it/s] 10%|█         | 3/29 [00:00<00:02,  9.74it/s] 17%|█▋        | 5/29 [00:00<00:02, 11.81it/s] 24%|██▍       | 7/29 [00:00<00:01, 12.94it/s] 31%|███       | 9/29 [00:00<00:01, 11.53it/s] 38%|███▊      | 11/29 [00:00<00:01, 12.61it/s] 45%|████▍     | 13/29 [00:01<00:01, 12.96it/s] 52%|█████▏    | 15/29 [00:01<00:01, 12.96it/s] 59%|█████▊    | 17/29 [00:01<00:00, 12.78it/s] 66%|██████▌   | 19/29 [00:01<00:00, 13.19it/s] 72%|███████▏  | 21/29 [00:05<00:05,  1.37it/s] 76%|███████▌  | 22/29 [00:06<00:04,  1.57it/s] 79%|███████▉  | 23/29 [00:06<00:03,  1.86it/s] 83%|████████▎ | 24/29 [00:06<00:02,  2.23it/s] 86%|████████▌ | 25/29 [00:06<00:01,  2.69it/s] 90%|████████▉ | 26/29 [00:06<00:00,  3.22it/s] 93%|█████████▎| 27/29 [00:06<00:00,  3.60it/s] 97%|█████████▋| 28/29 [00:07<00:00,  4.15it/s]100%|██████████| 29/29 [00:09<00:00,  1.13it/s]100%|██████████| 29/29 [00:09<00:00,  3.03it/s]
2025-03-13 16:43:41,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:41
2025-03-13 16:44:47,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9204 secs
2025-03-13 16:44:47,820 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 16:44:47,820 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.38it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 16:45:51,370 [INFO]: 	>>> Finished "Compute fast metrics" in 63.5499 secs
2025-03-13 16:45:51,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.2381 secs
2025-03-13 16:45:51,372 [INFO]: {
2025-03-13 16:45:51,372 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:51,372 [INFO]: 	index_param: efSearch=160
2025-03-13 16:45:51,372 [INFO]: 	index_path: knn.index
2025-03-13 16:45:51,372 [INFO]: 	size in bytes: 1378782610
2025-03-13 16:45:51,372 [INFO]: 	avg_search_speed_ms: 9.029491993833364
2025-03-13 16:45:51,372 [INFO]: 	99p_search_speed_ms: 17.483660164289184
2025-03-13 16:45:51,372 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:51,372 [INFO]: 	nb vectors: 7008
2025-03-13 16:45:51,372 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:51,372 [INFO]: 	compression ratio: 0.9993082694885455
2025-03-13 16:45:51,372 [INFO]: }
2025-03-13 16:45:51,372 [INFO]: 	>>> Finished "Creating the index" in 139.2396 secs
2025-03-13 16:45:51,372 [INFO]: >>> Finished "Launching the whole pipeline" in 139.2658 secs
2025-03-13 16:45:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 53294 [episode count 4/20]
[retrieval_preprocessing] for episode 94285 [episode count 5/20], we have num_retrieval=np.int64(6858) num_query=np.int64(395)
2025-03-13 16:45:57,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:58,672 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:58
2025-03-13 16:45:58,672 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.83it/s]
2025-03-13 16:45:58,698 [INFO]: There are 6858 embeddings of dim 49152
2025-03-13 16:45:58,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 16:45:58,698 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:58
2025-03-13 16:45:58,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:58,698 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:45:58,698 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:58,698 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:58,698 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:58
2025-03-13 16:45:58,698 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:58,698 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:58,698 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:58
2025-03-13 16:45:58,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:58,698 [INFO]: 	Creating the index 03/13/2025, 16:45:58
2025-03-13 16:45:58,698 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:58
2025-03-13 16:45:58,699 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:45:58,700 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:58
2025-03-13 16:45:58,700 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:45:58,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.91it/s] 11%|█         | 3/28 [00:00<00:03,  8.13it/s] 18%|█▊        | 5/28 [00:00<00:02,  9.23it/s] 25%|██▌       | 7/28 [00:00<00:02,  9.84it/s] 32%|███▏      | 9/28 [00:00<00:01, 10.09it/s] 39%|███▉      | 11/28 [00:01<00:01, 10.19it/s] 46%|████▋     | 13/28 [00:01<00:01, 10.29it/s] 54%|█████▎    | 15/28 [00:01<00:01, 10.31it/s] 61%|██████    | 17/28 [00:01<00:01, 10.55it/s] 68%|██████▊   | 19/28 [00:01<00:00, 10.72it/s] 75%|███████▌  | 21/28 [00:05<00:04,  1.49it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.37it/s] 96%|█████████▋| 27/28 [00:06<00:00,  3.52it/s]100%|██████████| 28/28 [00:08<00:00,  3.31it/s]
2025-03-13 16:46:07,162 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:07
2025-03-13 16:47:16,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.2936 secs
2025-03-13 16:47:16,457 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 16:47:16,457 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 16:48:10,999 [INFO]: 	>>> Finished "Compute fast metrics" in 54.5419 secs
2025-03-13 16:48:11,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.3020 secs
2025-03-13 16:48:11,002 [INFO]: {
2025-03-13 16:48:11,002 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:11,002 [INFO]: 	index_param: efSearch=159
2025-03-13 16:48:11,002 [INFO]: 	index_path: knn.index
2025-03-13 16:48:11,002 [INFO]: 	size in bytes: 1349270770
2025-03-13 16:48:11,002 [INFO]: 	avg_search_speed_ms: 9.3719294557004
2025-03-13 16:48:11,002 [INFO]: 	99p_search_speed_ms: 14.651339803822337
2025-03-13 16:48:11,002 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:11,002 [INFO]: 	nb vectors: 6858
2025-03-13 16:48:11,002 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:11,002 [INFO]: 	compression ratio: 0.9993084368084251
2025-03-13 16:48:11,002 [INFO]: }
2025-03-13 16:48:11,002 [INFO]: 	>>> Finished "Creating the index" in 132.3037 secs
2025-03-13 16:48:11,002 [INFO]: >>> Finished "Launching the whole pipeline" in 132.3304 secs
2025-03-13 16:48:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 94285 [episode count 5/20]
[retrieval_preprocessing] for episode 34940 [episode count 6/20], we have num_retrieval=np.int64(6849) num_query=np.int64(404)
2025-03-13 16:48:18,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:20,037 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:20
2025-03-13 16:48:20,037 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.23it/s]
2025-03-13 16:48:20,064 [INFO]: There are 6849 embeddings of dim 49152
2025-03-13 16:48:20,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 16:48:20,064 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:20
2025-03-13 16:48:20,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:20,065 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:48:20,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:20,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:48:20,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:20
2025-03-13 16:48:20,065 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:20,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:20,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:20
2025-03-13 16:48:20,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:20,065 [INFO]: 	Creating the index 03/13/2025, 16:48:20
2025-03-13 16:48:20,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:20
2025-03-13 16:48:20,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:48:20,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:20
2025-03-13 16:48:20,066 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:48:20,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.78it/s]  7%|▋         | 2/28 [00:00<00:03,  6.61it/s] 11%|█         | 3/28 [00:00<00:03,  7.58it/s] 14%|█▍        | 4/28 [00:00<00:03,  7.96it/s] 18%|█▊        | 5/28 [00:00<00:02,  8.53it/s] 21%|██▏       | 6/28 [00:00<00:02,  8.74it/s] 25%|██▌       | 7/28 [00:00<00:02,  8.96it/s] 29%|██▊       | 8/28 [00:00<00:02,  9.06it/s] 32%|███▏      | 9/28 [00:01<00:02,  9.09it/s] 36%|███▌      | 10/28 [00:01<00:02,  8.92it/s] 39%|███▉      | 11/28 [00:01<00:01,  9.03it/s] 43%|████▎     | 12/28 [00:01<00:01,  8.91it/s] 46%|████▋     | 13/28 [00:01<00:01,  8.77it/s] 50%|█████     | 14/28 [00:01<00:01,  8.50it/s] 54%|█████▎    | 15/28 [00:01<00:01,  8.42it/s] 57%|█████▋    | 16/28 [00:01<00:01,  8.40it/s] 61%|██████    | 17/28 [00:02<00:01,  8.12it/s] 64%|██████▍   | 18/28 [00:02<00:01,  8.12it/s] 68%|██████▊   | 19/28 [00:02<00:01,  8.06it/s] 71%|███████▏  | 20/28 [00:02<00:00,  8.06it/s] 75%|███████▌  | 21/28 [00:07<00:10,  1.54s/it] 86%|████████▌ | 24/28 [00:07<00:02,  1.43it/s] 96%|█████████▋| 27/28 [00:07<00:00,  2.46it/s]100%|██████████| 28/28 [00:10<00:00,  2.77it/s]
2025-03-13 16:48:30,196 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:30
2025-03-13 16:49:39,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1934 secs
2025-03-13 16:49:39,391 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 16:49:39,391 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.23it/s]
2025-03-13 16:50:55,330 [INFO]: 	>>> Finished "Compute fast metrics" in 75.9380 secs
2025-03-13 16:50:55,332 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.2656 secs
2025-03-13 16:50:55,332 [INFO]: {
2025-03-13 16:50:55,332 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:55,332 [INFO]: 	index_param: efSearch=166
2025-03-13 16:50:55,332 [INFO]: 	index_path: knn.index
2025-03-13 16:50:55,332 [INFO]: 	size in bytes: 1347500050
2025-03-13 16:50:55,332 [INFO]: 	avg_search_speed_ms: 12.484065376770928
2025-03-13 16:50:55,332 [INFO]: 	99p_search_speed_ms: 17.565693939104676
2025-03-13 16:50:55,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:55,332 [INFO]: 	nb vectors: 6849
2025-03-13 16:50:55,332 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:55,332 [INFO]: 	compression ratio: 0.9993084542000573
2025-03-13 16:50:55,332 [INFO]: }
2025-03-13 16:50:55,332 [INFO]: 	>>> Finished "Creating the index" in 155.2672 secs
2025-03-13 16:50:55,332 [INFO]: >>> Finished "Launching the whole pipeline" in 155.2953 secs
2025-03-13 16:50:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 34940 [episode count 6/20]
[retrieval_preprocessing] for episode 41052 [episode count 7/20], we have num_retrieval=np.int64(6788) num_query=np.int64(465)
2025-03-13 16:50:59,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:00,745 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:00
2025-03-13 16:51:00,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.16it/s]
2025-03-13 16:51:00,779 [INFO]: There are 6788 embeddings of dim 49152
2025-03-13 16:51:00,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 16:51:00,780 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:00,780 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:51:00,780 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:00,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:51:00,780 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,781 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:00,781 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:51:00,781 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:00
2025-03-13 16:51:00,781 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:00,781 [INFO]: 	Creating the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,781 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:00
2025-03-13 16:51:00,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:51:00,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,784 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:51:00,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.59it/s] 18%|█▊        | 5/28 [00:00<00:01, 21.03it/s] 32%|███▏      | 9/28 [00:00<00:00, 27.02it/s] 46%|████▋     | 13/28 [00:00<00:00, 29.10it/s] 61%|██████    | 17/28 [00:00<00:00, 30.20it/s] 75%|███████▌  | 21/28 [00:05<00:03,  2.15it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.87it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.82it/s]100%|██████████| 28/28 [00:07<00:00,  3.57it/s]
2025-03-13 16:51:08,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:08
2025-03-13 16:52:21,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.2387 secs
2025-03-13 16:52:21,879 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 16:52:21,879 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.71it/s]
2025-03-13 16:53:15,554 [INFO]: 	>>> Finished "Compute fast metrics" in 53.6747 secs
2025-03-13 16:53:15,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.7725 secs
2025-03-13 16:53:15,557 [INFO]: {
2025-03-13 16:53:15,557 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:15,557 [INFO]: 	index_param: efSearch=114
2025-03-13 16:53:15,557 [INFO]: 	index_path: knn.index
2025-03-13 16:53:15,557 [INFO]: 	size in bytes: 1335498670
2025-03-13 16:53:15,557 [INFO]: 	avg_search_speed_ms: 6.985243236591387
2025-03-13 16:53:15,557 [INFO]: 	99p_search_speed_ms: 10.870313108898701
2025-03-13 16:53:15,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:15,557 [INFO]: 	nb vectors: 6788
2025-03-13 16:53:15,557 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:15,557 [INFO]: 	compression ratio: 0.9993084485812329
2025-03-13 16:53:15,557 [INFO]: }
2025-03-13 16:53:15,557 [INFO]: 	>>> Finished "Creating the index" in 134.7757 secs
2025-03-13 16:53:15,557 [INFO]: >>> Finished "Launching the whole pipeline" in 134.8114 secs
2025-03-13 16:53:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 41052 [episode count 7/20]
[retrieval_preprocessing] for episode 2160 [episode count 8/20], we have num_retrieval=np.int64(6921) num_query=np.int64(332)
2025-03-13 16:53:19,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:20,392 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:20
2025-03-13 16:53:20,392 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.43it/s]
2025-03-13 16:53:20,426 [INFO]: There are 6921 embeddings of dim 49152
2025-03-13 16:53:20,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 16:53:20,427 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:20
2025-03-13 16:53:20,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:20,428 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:53:20,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:20,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:53:20,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:20
2025-03-13 16:53:20,428 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:20,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:53:20,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:20
2025-03-13 16:53:20,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:20,429 [INFO]: 	Creating the index 03/13/2025, 16:53:20
2025-03-13 16:53:20,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:20
2025-03-13 16:53:20,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:53:20,433 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:20
2025-03-13 16:53:20,433 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:53:20,433 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  9.29it/s] 21%|██        | 6/29 [00:00<00:00, 28.78it/s] 38%|███▊      | 11/29 [00:00<00:00, 36.27it/s] 55%|█████▌    | 16/29 [00:00<00:00, 40.73it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.33it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.97it/s]100%|██████████| 29/29 [00:06<00:00,  4.42it/s]
2025-03-13 16:53:27,002 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:27
2025-03-13 16:54:32,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.0781 secs
2025-03-13 16:54:32,081 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 16:54:32,081 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 16:55:01,421 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3406 secs
2025-03-13 16:55:01,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.9901 secs
2025-03-13 16:55:01,423 [INFO]: {
2025-03-13 16:55:01,423 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:01,423 [INFO]: 	index_param: efSearch=168
2025-03-13 16:55:01,423 [INFO]: 	index_path: knn.index
2025-03-13 16:55:01,423 [INFO]: 	size in bytes: 1361665810
2025-03-13 16:55:01,423 [INFO]: 	avg_search_speed_ms: 9.839681784510539
2025-03-13 16:55:01,423 [INFO]: 	99p_search_speed_ms: 15.611446148250254
2025-03-13 16:55:01,423 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:01,423 [INFO]: 	nb vectors: 6921
2025-03-13 16:55:01,423 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:01,423 [INFO]: 	compression ratio: 0.9993083163335063
2025-03-13 16:55:01,423 [INFO]: }
2025-03-13 16:55:01,423 [INFO]: 	>>> Finished "Creating the index" in 100.9942 secs
2025-03-13 16:55:01,423 [INFO]: >>> Finished "Launching the whole pipeline" in 101.0312 secs
2025-03-13 16:55:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 2160 [episode count 8/20]
[retrieval_preprocessing] for episode 77993 [episode count 9/20], we have num_retrieval=np.int64(6920) num_query=np.int64(333)
2025-03-13 16:55:04,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:06,257 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:06
2025-03-13 16:55:06,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1870.79it/s]
2025-03-13 16:55:06,288 [INFO]: There are 6920 embeddings of dim 49152
2025-03-13 16:55:06,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 16:55:06,289 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:06,290 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:55:06,290 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:06,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:55:06,290 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,290 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:06,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:55:06,291 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:06
2025-03-13 16:55:06,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:06,291 [INFO]: 	Creating the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:06
2025-03-13 16:55:06,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:55:06,294 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,294 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:55:06,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.58it/s] 17%|█▋        | 5/29 [00:00<00:00, 25.95it/s] 31%|███       | 9/29 [00:00<00:00, 31.41it/s] 45%|████▍     | 13/29 [00:00<00:00, 33.84it/s] 59%|█████▊    | 17/29 [00:00<00:00, 35.18it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.23it/s] 90%|████████▉ | 26/29 [00:05<00:00,  3.53it/s]100%|██████████| 29/29 [00:07<00:00,  3.93it/s]
2025-03-13 16:55:13,687 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:13
2025-03-13 16:56:12,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1308 secs
2025-03-13 16:56:12,819 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 16:56:12,819 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.95it/s]
2025-03-13 16:57:13,817 [INFO]: 	>>> Finished "Compute fast metrics" in 60.9978 secs
2025-03-13 16:57:13,819 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.5247 secs
2025-03-13 16:57:13,819 [INFO]: {
2025-03-13 16:57:13,819 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:13,819 [INFO]: 	index_param: efSearch=182
2025-03-13 16:57:13,819 [INFO]: 	index_path: knn.index
2025-03-13 16:57:13,819 [INFO]: 	size in bytes: 1361469010
2025-03-13 16:57:13,819 [INFO]: 	avg_search_speed_ms: 11.460535935012096
2025-03-13 16:57:13,819 [INFO]: 	99p_search_speed_ms: 18.589113624766465
2025-03-13 16:57:13,819 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:13,819 [INFO]: 	nb vectors: 6920
2025-03-13 16:57:13,819 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:13,819 [INFO]: 	compression ratio: 0.9993083573749505
2025-03-13 16:57:13,819 [INFO]: }
2025-03-13 16:57:13,819 [INFO]: 	>>> Finished "Creating the index" in 127.5283 secs
2025-03-13 16:57:13,819 [INFO]: >>> Finished "Launching the whole pipeline" in 127.5619 secs
2025-03-13 16:57:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 77993 [episode count 9/20]
[retrieval_preprocessing] for episode 28874 [episode count 10/20], we have num_retrieval=np.int64(6900) num_query=np.int64(353)
2025-03-13 16:57:18,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:20,243 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:20
2025-03-13 16:57:20,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 790.78it/s]
2025-03-13 16:57:20,279 [INFO]: There are 6900 embeddings of dim 49152
2025-03-13 16:57:20,279 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 16:57:20,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:20
2025-03-13 16:57:20,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:20,280 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:57:20,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:20,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:57:20,281 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:20
2025-03-13 16:57:20,281 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:20,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:57:20,281 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:20
2025-03-13 16:57:20,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:20,282 [INFO]: 	Creating the index 03/13/2025, 16:57:20
2025-03-13 16:57:20,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:20
2025-03-13 16:57:20,285 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:57:20,285 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:20
2025-03-13 16:57:20,285 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:57:20,286 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  9.16it/s] 17%|█▋        | 5/29 [00:00<00:00, 25.33it/s] 31%|███       | 9/29 [00:00<00:00, 30.65it/s] 45%|████▍     | 13/29 [00:00<00:00, 33.21it/s] 59%|█████▊    | 17/29 [00:00<00:00, 34.65it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.23it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.25it/s]100%|██████████| 29/29 [00:08<00:00,  2.42it/s]100%|██████████| 29/29 [00:08<00:00,  3.61it/s]
2025-03-13 16:57:28,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:28
2025-03-13 16:58:45,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.4162 secs
2025-03-13 16:58:45,738 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 16:58:45,738 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.55it/s]
2025-03-13 16:59:30,496 [INFO]: 	>>> Finished "Compute fast metrics" in 44.7577 secs
2025-03-13 16:59:30,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.2125 secs
2025-03-13 16:59:30,498 [INFO]: {
2025-03-13 16:59:30,498 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:30,498 [INFO]: 	index_param: efSearch=155
2025-03-13 16:59:30,498 [INFO]: 	index_path: knn.index
2025-03-13 16:59:30,498 [INFO]: 	size in bytes: 1357534030
2025-03-13 16:59:30,498 [INFO]: 	avg_search_speed_ms: 8.296081670115536
2025-03-13 16:59:30,498 [INFO]: 	99p_search_speed_ms: 12.198647037148481
2025-03-13 16:59:30,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:30,498 [INFO]: 	nb vectors: 6900
2025-03-13 16:59:30,498 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:30,498 [INFO]: 	compression ratio: 0.9993084298593974
2025-03-13 16:59:30,498 [INFO]: }
2025-03-13 16:59:30,498 [INFO]: 	>>> Finished "Creating the index" in 130.2164 secs
2025-03-13 16:59:30,498 [INFO]: >>> Finished "Launching the whole pipeline" in 130.2550 secs
2025-03-13 16:59:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 28874 [episode count 10/20]
[retrieval_preprocessing] for episode 82300 [episode count 11/20], we have num_retrieval=np.int64(6727) num_query=np.int64(526)
2025-03-13 16:59:33,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:34,591 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:34
2025-03-13 16:59:34,591 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.35it/s]
2025-03-13 16:59:34,621 [INFO]: There are 6727 embeddings of dim 49152
2025-03-13 16:59:34,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 16:59:34,622 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:34
2025-03-13 16:59:34,622 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:34,622 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:59:34,622 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:34,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:34,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:34
2025-03-13 16:59:34,622 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:34,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:34,622 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:34
2025-03-13 16:59:34,622 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:34,622 [INFO]: 	Creating the index 03/13/2025, 16:59:34
2025-03-13 16:59:34,622 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:34
2025-03-13 16:59:34,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:59:34,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:34
2025-03-13 16:59:34,624 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:59:34,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.50it/s] 21%|██▏       | 6/28 [00:00<00:00, 25.49it/s] 39%|███▉      | 11/28 [00:00<00:00, 33.22it/s] 57%|█████▋    | 16/28 [00:00<00:00, 37.16it/s] 75%|███████▌  | 21/28 [00:05<00:02,  2.66it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.72it/s]100%|██████████| 28/28 [00:07<00:00,  2.77it/s]100%|██████████| 28/28 [00:07<00:00,  3.91it/s]
2025-03-13 16:59:41,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:41
2025-03-13 17:00:49,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.6186 secs
2025-03-13 17:00:49,411 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:00:49,411 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.55it/s]
2025-03-13 17:01:30,790 [INFO]: 	>>> Finished "Compute fast metrics" in 41.3789 secs
2025-03-13 17:01:30,791 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.1677 secs
2025-03-13 17:01:30,792 [INFO]: {
2025-03-13 17:01:30,792 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:30,792 [INFO]: 	index_param: efSearch=207
2025-03-13 17:01:30,792 [INFO]: 	index_path: knn.index
2025-03-13 17:01:30,792 [INFO]: 	size in bytes: 1323497350
2025-03-13 17:01:30,792 [INFO]: 	avg_search_speed_ms: 12.34813134536653
2025-03-13 17:01:30,792 [INFO]: 	99p_search_speed_ms: 18.137833040673286
2025-03-13 17:01:30,792 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:30,792 [INFO]: 	nb vectors: 6727
2025-03-13 17:01:30,792 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:30,792 [INFO]: 	compression ratio: 0.9993083975574262
2025-03-13 17:01:30,792 [INFO]: }
2025-03-13 17:01:30,792 [INFO]: 	>>> Finished "Creating the index" in 116.1696 secs
2025-03-13 17:01:30,792 [INFO]: >>> Finished "Launching the whole pipeline" in 116.2007 secs
2025-03-13 17:01:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 82300 [episode count 11/20]
[retrieval_preprocessing] for episode 67965 [episode count 12/20], we have num_retrieval=np.int64(7045) num_query=np.int64(208)
2025-03-13 17:01:35,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:36,375 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:36
2025-03-13 17:01:36,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.10it/s]
2025-03-13 17:01:36,403 [INFO]: There are 7045 embeddings of dim 49152
2025-03-13 17:01:36,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:01:36,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:36
2025-03-13 17:01:36,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:36,403 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:01:36,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:36,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:01:36,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:36
2025-03-13 17:01:36,403 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:36,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:01:36,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:36
2025-03-13 17:01:36,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:36,404 [INFO]: 	Creating the index 03/13/2025, 17:01:36
2025-03-13 17:01:36,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:36
2025-03-13 17:01:36,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:01:36,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:36
2025-03-13 17:01:36,405 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:01:36,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.78it/s] 24%|██▍       | 7/29 [00:00<00:00, 31.41it/s] 45%|████▍     | 13/29 [00:00<00:00, 41.53it/s] 66%|██████▌   | 19/29 [00:00<00:00, 46.39it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.85it/s]100%|██████████| 29/29 [00:06<00:00,  3.22it/s]100%|██████████| 29/29 [00:06<00:00,  4.76it/s]
2025-03-13 17:01:42,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:42
2025-03-13 17:03:05,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.8852 secs
2025-03-13 17:03:05,386 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 17:03:05,386 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.07it/s]
2025-03-13 17:03:43,603 [INFO]: 	>>> Finished "Compute fast metrics" in 38.2173 secs
2025-03-13 17:03:43,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.2001 secs
2025-03-13 17:03:43,605 [INFO]: {
2025-03-13 17:03:43,605 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:43,605 [INFO]: 	index_param: efSearch=133
2025-03-13 17:03:43,605 [INFO]: 	index_path: knn.index
2025-03-13 17:03:43,605 [INFO]: 	size in bytes: 1386062050
2025-03-13 17:03:43,605 [INFO]: 	avg_search_speed_ms: 7.448930036722115
2025-03-13 17:03:43,605 [INFO]: 	99p_search_speed_ms: 10.857006330043072
2025-03-13 17:03:43,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:43,605 [INFO]: 	nb vectors: 7045
2025-03-13 17:03:43,605 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:43,605 [INFO]: 	compression ratio: 0.999308335438518
2025-03-13 17:03:43,605 [INFO]: }
2025-03-13 17:03:43,605 [INFO]: 	>>> Finished "Creating the index" in 127.2016 secs
2025-03-13 17:03:43,605 [INFO]: >>> Finished "Launching the whole pipeline" in 127.2298 secs
2025-03-13 17:03:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 67965 [episode count 12/20]
[retrieval_preprocessing] for episode 80263 [episode count 13/20], we have num_retrieval=np.int64(6846) num_query=np.int64(407)
2025-03-13 17:03:45,520 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:46,477 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:46
2025-03-13 17:03:46,477 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.53it/s]
2025-03-13 17:03:46,505 [INFO]: There are 6846 embeddings of dim 49152
2025-03-13 17:03:46,506 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:03:46,506 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:46
2025-03-13 17:03:46,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:46,506 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:03:46,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:46,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:03:46,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:46
2025-03-13 17:03:46,506 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:46,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:03:46,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:46
2025-03-13 17:03:46,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:46,506 [INFO]: 	Creating the index 03/13/2025, 17:03:46
2025-03-13 17:03:46,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:46
2025-03-13 17:03:46,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:03:46,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:46
2025-03-13 17:03:46,508 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:03:46,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.56it/s] 21%|██▏       | 6/28 [00:00<00:00, 31.33it/s] 43%|████▎     | 12/28 [00:00<00:00, 40.64it/s] 64%|██████▍   | 18/28 [00:00<00:00, 44.67it/s] 82%|████████▏ | 23/28 [00:04<00:01,  3.44it/s] 93%|█████████▎| 26/28 [00:04<00:00,  3.96it/s]100%|██████████| 28/28 [00:07<00:00,  3.90it/s]
2025-03-13 17:03:53,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:53
2025-03-13 17:04:57,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.0969 secs
2025-03-13 17:04:57,793 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 17:04:57,793 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.97it/s]
2025-03-13 17:05:52,436 [INFO]: 	>>> Finished "Compute fast metrics" in 54.6428 secs
2025-03-13 17:05:52,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.9298 secs
2025-03-13 17:05:52,438 [INFO]: {
2025-03-13 17:05:52,438 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:52,438 [INFO]: 	index_param: efSearch=244
2025-03-13 17:05:52,438 [INFO]: 	index_path: knn.index
2025-03-13 17:05:52,438 [INFO]: 	size in bytes: 1346909830
2025-03-13 17:05:52,438 [INFO]: 	avg_search_speed_ms: 13.933692159245314
2025-03-13 17:05:52,438 [INFO]: 	99p_search_speed_ms: 19.391967032570395
2025-03-13 17:05:52,438 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:52,438 [INFO]: 	nb vectors: 6846
2025-03-13 17:05:52,438 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:52,438 [INFO]: 	compression ratio: 0.9993084451688945
2025-03-13 17:05:52,438 [INFO]: }
2025-03-13 17:05:52,438 [INFO]: 	>>> Finished "Creating the index" in 125.9319 secs
2025-03-13 17:05:52,438 [INFO]: >>> Finished "Launching the whole pipeline" in 125.9612 secs
2025-03-13 17:05:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 80263 [episode count 13/20]
[retrieval_preprocessing] for episode 65958 [episode count 14/20], we have num_retrieval=np.int64(6890) num_query=np.int64(363)
2025-03-13 17:05:57,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:59,156 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:59
2025-03-13 17:05:59,156 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.68it/s]
2025-03-13 17:05:59,185 [INFO]: There are 6890 embeddings of dim 49152
2025-03-13 17:05:59,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:05:59,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:59
2025-03-13 17:05:59,185 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:59,186 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:05:59,186 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:59,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:59,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:59
2025-03-13 17:05:59,186 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:59,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:59,186 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:59
2025-03-13 17:05:59,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:59,186 [INFO]: 	Creating the index 03/13/2025, 17:05:59
2025-03-13 17:05:59,186 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:59
2025-03-13 17:05:59,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:05:59,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:59
2025-03-13 17:05:59,188 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:05:59,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.37it/s] 21%|██        | 6/29 [00:00<00:00, 27.69it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.81it/s] 55%|█████▌    | 16/29 [00:00<00:00, 40.11it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.05it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.54it/s]100%|██████████| 29/29 [00:06<00:00,  4.42it/s]
2025-03-13 17:06:05,755 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:05
2025-03-13 17:07:19,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.5493 secs
2025-03-13 17:07:19,305 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:07:19,305 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-13 17:08:14,924 [INFO]: 	>>> Finished "Compute fast metrics" in 55.6187 secs
2025-03-13 17:08:14,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.7379 secs
2025-03-13 17:08:14,926 [INFO]: {
2025-03-13 17:08:14,926 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:14,926 [INFO]: 	index_param: efSearch=168
2025-03-13 17:08:14,926 [INFO]: 	index_path: knn.index
2025-03-13 17:08:14,926 [INFO]: 	size in bytes: 1355566570
2025-03-13 17:08:14,926 [INFO]: 	avg_search_speed_ms: 9.49685737722379
2025-03-13 17:08:14,926 [INFO]: 	99p_search_speed_ms: 13.697472279891372
2025-03-13 17:08:14,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:14,926 [INFO]: 	nb vectors: 6890
2025-03-13 17:08:14,926 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:14,926 [INFO]: 	compression ratio: 0.999308444143765
2025-03-13 17:08:14,926 [INFO]: }
2025-03-13 17:08:14,926 [INFO]: 	>>> Finished "Creating the index" in 135.7403 secs
2025-03-13 17:08:14,926 [INFO]: >>> Finished "Launching the whole pipeline" in 135.7700 secs
2025-03-13 17:08:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 65958 [episode count 14/20]
[retrieval_preprocessing] for episode 8613 [episode count 15/20], we have num_retrieval=np.int64(6817) num_query=np.int64(436)
2025-03-13 17:08:18,318 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:19,718 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:19
2025-03-13 17:08:19,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.71it/s]
2025-03-13 17:08:19,747 [INFO]: There are 6817 embeddings of dim 49152
2025-03-13 17:08:19,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:08:19,747 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:19
2025-03-13 17:08:19,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:19,747 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:08:19,747 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:19,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:19,747 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:19
2025-03-13 17:08:19,747 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:19,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:08:19,747 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:19
2025-03-13 17:08:19,747 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:19,748 [INFO]: 	Creating the index 03/13/2025, 17:08:19
2025-03-13 17:08:19,748 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:19
2025-03-13 17:08:19,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:08:19,749 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:19
2025-03-13 17:08:19,749 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:08:19,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.34it/s] 21%|██▏       | 6/28 [00:00<00:00, 22.76it/s] 39%|███▉      | 11/28 [00:00<00:00, 30.54it/s] 57%|█████▋    | 16/28 [00:00<00:00, 34.70it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.14it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.69it/s]100%|██████████| 28/28 [00:06<00:00,  4.19it/s]
2025-03-13 17:08:26,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:26
2025-03-13 17:09:34,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.2564 secs
2025-03-13 17:09:34,694 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 17:09:34,694 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 17:10:13,545 [INFO]: 	>>> Finished "Compute fast metrics" in 38.8518 secs
2025-03-13 17:10:13,547 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.7981 secs
2025-03-13 17:10:13,547 [INFO]: {
2025-03-13 17:10:13,547 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:13,547 [INFO]: 	index_param: efSearch=205
2025-03-13 17:10:13,547 [INFO]: 	index_path: knn.index
2025-03-13 17:10:13,547 [INFO]: 	size in bytes: 1341204250
2025-03-13 17:10:13,547 [INFO]: 	avg_search_speed_ms: 11.032584269121372
2025-03-13 17:10:13,547 [INFO]: 	99p_search_speed_ms: 16.188370990566906
2025-03-13 17:10:13,547 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:13,547 [INFO]: 	nb vectors: 6817
2025-03-13 17:10:13,547 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:13,547 [INFO]: 	compression ratio: 0.9993084468678055
2025-03-13 17:10:13,547 [INFO]: }
2025-03-13 17:10:13,547 [INFO]: 	>>> Finished "Creating the index" in 113.7998 secs
2025-03-13 17:10:13,547 [INFO]: >>> Finished "Launching the whole pipeline" in 113.8296 secs
2025-03-13 17:10:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 8613 [episode count 15/20]
[retrieval_preprocessing] for episode 35749 [episode count 16/20], we have num_retrieval=np.int64(7101) num_query=np.int64(152)
2025-03-13 17:10:17,334 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:19,015 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:19
2025-03-13 17:10:19,015 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1233.98it/s]
2025-03-13 17:10:19,045 [INFO]: There are 7101 embeddings of dim 49152
2025-03-13 17:10:19,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 17:10:19,046 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:19
2025-03-13 17:10:19,046 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:19,046 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:10:19,046 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:19,046 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:10:19,047 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:19
2025-03-13 17:10:19,047 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:19,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:10:19,047 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:19
2025-03-13 17:10:19,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:19,048 [INFO]: 	Creating the index 03/13/2025, 17:10:19
2025-03-13 17:10:19,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:19
2025-03-13 17:10:19,051 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:10:19,051 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:19
2025-03-13 17:10:19,051 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:10:19,052 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 17.94it/s] 28%|██▊       | 8/29 [00:00<00:00, 39.69it/s] 48%|████▊     | 14/29 [00:00<00:00, 46.77it/s] 69%|██████▉   | 20/29 [00:00<00:00, 50.13it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.17it/s]100%|██████████| 29/29 [00:05<00:00,  4.89it/s]
2025-03-13 17:10:24,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:24
2025-03-13 17:11:23,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0261 secs
2025-03-13 17:11:23,019 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:11:23,019 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.15it/s]
2025-03-13 17:11:46,821 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8016 secs
2025-03-13 17:11:46,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.7716 secs
2025-03-13 17:11:46,823 [INFO]: {
2025-03-13 17:11:46,823 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:46,823 [INFO]: 	index_param: efSearch=169
2025-03-13 17:11:46,823 [INFO]: 	index_path: knn.index
2025-03-13 17:11:46,823 [INFO]: 	size in bytes: 1397079670
2025-03-13 17:11:46,823 [INFO]: 	avg_search_speed_ms: 10.945457239131926
2025-03-13 17:11:46,823 [INFO]: 	99p_search_speed_ms: 17.936483200173825
2025-03-13 17:11:46,823 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:46,823 [INFO]: 	nb vectors: 7101
2025-03-13 17:11:46,823 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:46,823 [INFO]: 	compression ratio: 0.9993083701518611
2025-03-13 17:11:46,823 [INFO]: }
2025-03-13 17:11:46,823 [INFO]: 	>>> Finished "Creating the index" in 87.7757 secs
2025-03-13 17:11:46,823 [INFO]: >>> Finished "Launching the whole pipeline" in 87.8083 secs
2025-03-13 17:11:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 35749 [episode count 16/20]
[retrieval_preprocessing] for episode 75770 [episode count 17/20], we have num_retrieval=np.int64(6922) num_query=np.int64(331)
2025-03-13 17:11:48,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:50,158 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:50
2025-03-13 17:11:50,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.40it/s]
2025-03-13 17:11:50,187 [INFO]: There are 6922 embeddings of dim 49152
2025-03-13 17:11:50,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 17:11:50,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:50
2025-03-13 17:11:50,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:50,188 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:11:50,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:50,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:50,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:50
2025-03-13 17:11:50,188 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:50,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:50,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:50
2025-03-13 17:11:50,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:50,188 [INFO]: 	Creating the index 03/13/2025, 17:11:50
2025-03-13 17:11:50,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:50
2025-03-13 17:11:50,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:11:50,190 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:50
2025-03-13 17:11:50,190 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:11:50,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  4.98it/s] 17%|█▋        | 5/29 [00:00<00:01, 19.10it/s] 34%|███▍      | 10/29 [00:00<00:00, 27.87it/s] 52%|█████▏    | 15/29 [00:00<00:00, 32.43it/s] 66%|██████▌   | 19/29 [00:00<00:00, 34.68it/s] 79%|███████▉  | 23/29 [00:06<00:03,  1.90it/s] 90%|████████▉ | 26/29 [00:06<00:01,  2.51it/s]100%|██████████| 29/29 [00:09<00:00,  1.78it/s]100%|██████████| 29/29 [00:09<00:00,  2.93it/s]
2025-03-13 17:12:00,081 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:00
2025-03-13 17:13:07,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.6945 secs
2025-03-13 17:13:07,776 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 17:13:07,776 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 17:13:52,534 [INFO]: 	>>> Finished "Compute fast metrics" in 44.7580 secs
2025-03-13 17:13:52,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.3463 secs
2025-03-13 17:13:52,536 [INFO]: {
2025-03-13 17:13:52,536 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:52,537 [INFO]: 	index_param: efSearch=190
2025-03-13 17:13:52,537 [INFO]: 	index_path: knn.index
2025-03-13 17:13:52,537 [INFO]: 	size in bytes: 1361862550
2025-03-13 17:13:52,537 [INFO]: 	avg_search_speed_ms: 10.551022449930745
2025-03-13 17:13:52,537 [INFO]: 	99p_search_speed_ms: 15.09769356343895
2025-03-13 17:13:52,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:52,537 [INFO]: 	nb vectors: 6922
2025-03-13 17:13:52,537 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:52,537 [INFO]: 	compression ratio: 0.9993083193307577
2025-03-13 17:13:52,537 [INFO]: }
2025-03-13 17:13:52,537 [INFO]: 	>>> Finished "Creating the index" in 122.3483 secs
2025-03-13 17:13:52,537 [INFO]: >>> Finished "Launching the whole pipeline" in 122.3786 secs
2025-03-13 17:13:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 75770 [episode count 17/20]
[retrieval_preprocessing] for episode 82913 [episode count 18/20], we have num_retrieval=np.int64(7035) num_query=np.int64(218)
2025-03-13 17:13:55,338 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:56,316 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:56
2025-03-13 17:13:56,316 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 983.42it/s]
2025-03-13 17:13:56,342 [INFO]: There are 7035 embeddings of dim 49152
2025-03-13 17:13:56,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:13:56,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:56
2025-03-13 17:13:56,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:56,343 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:13:56,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:56,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:56,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:56
2025-03-13 17:13:56,343 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:56,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:13:56,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:56
2025-03-13 17:13:56,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:56,343 [INFO]: 	Creating the index 03/13/2025, 17:13:56
2025-03-13 17:13:56,343 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:56
2025-03-13 17:13:56,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:13:56,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:56
2025-03-13 17:13:56,344 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:13:56,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.23it/s] 24%|██▍       | 7/29 [00:00<00:00, 32.55it/s] 45%|████▍     | 13/29 [00:00<00:00, 42.49it/s] 66%|██████▌   | 19/29 [00:00<00:00, 46.92it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.36it/s]100%|██████████| 29/29 [00:06<00:00,  3.18it/s]100%|██████████| 29/29 [00:06<00:00,  4.59it/s]
2025-03-13 17:14:02,660 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:02
2025-03-13 17:15:06,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.1101 secs
2025-03-13 17:15:06,770 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:15:06,771 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-13 17:16:02,678 [INFO]: 	>>> Finished "Compute fast metrics" in 55.9074 secs
2025-03-13 17:16:02,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.3357 secs
2025-03-13 17:16:02,680 [INFO]: {
2025-03-13 17:16:02,680 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:02,680 [INFO]: 	index_param: efSearch=155
2025-03-13 17:16:02,680 [INFO]: 	index_path: knn.index
2025-03-13 17:16:02,680 [INFO]: 	size in bytes: 1384094590
2025-03-13 17:16:02,680 [INFO]: 	avg_search_speed_ms: 9.72738728046794
2025-03-13 17:16:02,680 [INFO]: 	99p_search_speed_ms: 14.525910397060223
2025-03-13 17:16:02,680 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:02,680 [INFO]: 	nb vectors: 7035
2025-03-13 17:16:02,680 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:02,680 [INFO]: 	compression ratio: 0.9993083492942487
2025-03-13 17:16:02,680 [INFO]: }
2025-03-13 17:16:02,681 [INFO]: 	>>> Finished "Creating the index" in 126.3373 secs
2025-03-13 17:16:02,681 [INFO]: >>> Finished "Launching the whole pipeline" in 126.3643 secs
2025-03-13 17:16:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 82913 [episode count 18/20]
[retrieval_preprocessing] for episode 50230 [episode count 19/20], we have num_retrieval=np.int64(6781) num_query=np.int64(472)
2025-03-13 17:16:05,880 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:07,218 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:07
2025-03-13 17:16:07,218 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1072.44it/s]
2025-03-13 17:16:07,251 [INFO]: There are 6781 embeddings of dim 49152
2025-03-13 17:16:07,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 17:16:07,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:07,251 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:16:07,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:07,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:07,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,251 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:07,252 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:16:07,252 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:07
2025-03-13 17:16:07,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:07,252 [INFO]: 	Creating the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,252 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:07
2025-03-13 17:16:07,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:16:07,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,253 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:16:07,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.44it/s] 18%|█▊        | 5/28 [00:00<00:00, 23.83it/s] 36%|███▌      | 10/28 [00:00<00:00, 32.05it/s] 54%|█████▎    | 15/28 [00:00<00:00, 35.75it/s] 71%|███████▏  | 20/28 [00:00<00:00, 37.84it/s] 86%|████████▌ | 24/28 [00:04<00:01,  2.78it/s]100%|██████████| 28/28 [00:06<00:00,  2.55it/s]100%|██████████| 28/28 [00:06<00:00,  4.10it/s]
2025-03-13 17:16:14,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:14
2025-03-13 17:17:27,195 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.1079 secs
2025-03-13 17:17:27,196 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 17:17:27,196 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.30it/s]
2025-03-13 17:17:59,306 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1097 secs
2025-03-13 17:17:59,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.0542 secs
2025-03-13 17:17:59,308 [INFO]: {
2025-03-13 17:17:59,308 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:59,308 [INFO]: 	index_param: efSearch=124
2025-03-13 17:17:59,308 [INFO]: 	index_path: knn.index
2025-03-13 17:17:59,308 [INFO]: 	size in bytes: 1334121490
2025-03-13 17:17:59,308 [INFO]: 	avg_search_speed_ms: 7.732325140963044
2025-03-13 17:17:59,308 [INFO]: 	99p_search_speed_ms: 12.467792332172394
2025-03-13 17:17:59,308 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:59,308 [INFO]: 	nb vectors: 6781
2025-03-13 17:17:59,308 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:59,308 [INFO]: 	compression ratio: 0.9993084273007251
2025-03-13 17:17:59,308 [INFO]: }
2025-03-13 17:17:59,308 [INFO]: 	>>> Finished "Creating the index" in 112.0562 secs
2025-03-13 17:17:59,308 [INFO]: >>> Finished "Launching the whole pipeline" in 112.0895 secs
2025-03-13 17:18:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 50230 [episode count 19/20]
2025-03-13 17:18:02: [retrieval_preprocessing] finished for 1656877278_put_cans_on_tray [chosen_id count 4/196]
2025-03-13 17:18:04: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_packet_in_bowl [chosen_id count 5/196]
2025-03-13 17:18:04: [retrieval_preprocessing] we have num_total=3831 embedding_dim=49152
[retrieval_preprocessing] for episode 55333 [episode count 0/20], we have num_retrieval=np.int64(3653) num_query=np.int64(178)
2025-03-13 17:18:04,464 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:05,030 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:05
2025-03-13 17:18:05,031 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.59it/s]
2025-03-13 17:18:05,062 [INFO]: There are 3653 embeddings of dim 49152
2025-03-13 17:18:05,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 17:18:05,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:05
2025-03-13 17:18:05,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:05,063 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:18:05,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:05,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:18:05,063 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:05
2025-03-13 17:18:05,064 [INFO]: 753.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:05,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:18:05,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:05
2025-03-13 17:18:05,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:05,065 [INFO]: 	Creating the index 03/13/2025, 17:18:05
2025-03-13 17:18:05,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:05
2025-03-13 17:18:05,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:18:05,068 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:05
2025-03-13 17:18:05,068 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:18:05,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.27it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.80it/s] 80%|████████  | 12/15 [00:00<00:00, 38.50it/s]100%|██████████| 15/15 [00:03<00:00,  4.95it/s]
2025-03-13 17:18:08,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:08
2025-03-13 17:18:58,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0791 secs
2025-03-13 17:18:58,186 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:18:58,186 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 17:19:23,740 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5532 secs
2025-03-13 17:19:23,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7847 secs
2025-03-13 17:19:23,853 [INFO]: {
2025-03-13 17:19:23,853 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:23,853 [INFO]: 	index_param: efSearch=164
2025-03-13 17:19:23,853 [INFO]: 	index_path: knn.index
2025-03-13 17:19:23,853 [INFO]: 	size in bytes: 718705510
2025-03-13 17:19:23,854 [INFO]: 	avg_search_speed_ms: 8.694788362304477
2025-03-13 17:19:23,854 [INFO]: 	99p_search_speed_ms: 12.313289956655353
2025-03-13 17:19:23,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:23,854 [INFO]: 	nb vectors: 3653
2025-03-13 17:19:23,854 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:23,854 [INFO]: 	compression ratio: 0.9993091941092813
2025-03-13 17:19:23,854 [INFO]: }
2025-03-13 17:19:23,854 [INFO]: 	>>> Finished "Creating the index" in 78.7892 secs
2025-03-13 17:19:23,854 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8233 secs
2025-03-13 17:19:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 55333 [episode count 0/20]
[retrieval_preprocessing] for episode 32810 [episode count 1/20], we have num_retrieval=np.int64(3668) num_query=np.int64(163)
2025-03-13 17:19:25,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:25,937 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:25
2025-03-13 17:19:25,937 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.69it/s]
2025-03-13 17:19:25,966 [INFO]: There are 3668 embeddings of dim 49152
2025-03-13 17:19:25,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:19:25,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:25
2025-03-13 17:19:25,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:25,966 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:19:25,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:25,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:25,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:25
2025-03-13 17:19:25,967 [INFO]: 757.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:25,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:19:25,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:25
2025-03-13 17:19:25,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:25,967 [INFO]: 	Creating the index 03/13/2025, 17:19:25
2025-03-13 17:19:25,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:25
2025-03-13 17:19:25,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:19:25,968 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:25
2025-03-13 17:19:25,968 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:19:25,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.08it/s] 40%|████      | 6/15 [00:00<00:00, 29.99it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.16it/s]100%|██████████| 15/15 [00:03<00:00,  3.50it/s]100%|██████████| 15/15 [00:03<00:00,  4.83it/s]
2025-03-13 17:19:29,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:29
2025-03-13 17:20:15,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0723 secs
2025-03-13 17:20:15,151 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 17:20:15,151 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-13 17:20:43,247 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0957 secs
2025-03-13 17:20:43,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.7041 secs
2025-03-13 17:20:43,673 [INFO]: {
2025-03-13 17:20:43,673 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:43,673 [INFO]: 	index_param: efSearch=177
2025-03-13 17:20:43,673 [INFO]: 	index_path: knn.index
2025-03-13 17:20:43,673 [INFO]: 	size in bytes: 721656610
2025-03-13 17:20:43,673 [INFO]: 	avg_search_speed_ms: 9.318098026757896
2025-03-13 17:20:43,673 [INFO]: 	99p_search_speed_ms: 14.058142104186114
2025-03-13 17:20:43,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:43,673 [INFO]: 	nb vectors: 3668
2025-03-13 17:20:43,674 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:43,674 [INFO]: 	compression ratio: 0.9993092753629735
2025-03-13 17:20:43,674 [INFO]: }
2025-03-13 17:20:43,674 [INFO]: 	>>> Finished "Creating the index" in 77.7066 secs
2025-03-13 17:20:43,674 [INFO]: >>> Finished "Launching the whole pipeline" in 77.7369 secs
2025-03-13 17:20:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 32810 [episode count 1/20]
[retrieval_preprocessing] for episode 38956 [episode count 2/20], we have num_retrieval=np.int64(3614) num_query=np.int64(217)
2025-03-13 17:20:45,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:45,950 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:45
2025-03-13 17:20:45,951 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1148.18it/s]
2025-03-13 17:20:45,978 [INFO]: There are 3614 embeddings of dim 49152
2025-03-13 17:20:45,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:20:45,979 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:45
2025-03-13 17:20:45,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:45,979 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:20:45,979 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:45,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:45,979 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:45
2025-03-13 17:20:45,979 [INFO]: 745.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:45,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:20:45,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:45
2025-03-13 17:20:45,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:45,979 [INFO]: 	Creating the index 03/13/2025, 17:20:45
2025-03-13 17:20:45,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:45
2025-03-13 17:20:45,980 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:20:45,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:45
2025-03-13 17:20:45,981 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:20:45,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.75it/s] 40%|████      | 6/15 [00:00<00:00, 30.10it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.04it/s]100%|██████████| 15/15 [00:03<00:00,  3.28it/s]100%|██████████| 15/15 [00:03<00:00,  4.54it/s]
2025-03-13 17:20:49,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:49
2025-03-13 17:21:36,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2639 secs
2025-03-13 17:21:36,553 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:21:36,553 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 17:22:00,638 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0852 secs
2025-03-13 17:22:00,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6609 secs
2025-03-13 17:22:00,642 [INFO]: {
2025-03-13 17:22:00,642 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:00,642 [INFO]: 	index_param: efSearch=176
2025-03-13 17:22:00,642 [INFO]: 	index_path: knn.index
2025-03-13 17:22:00,642 [INFO]: 	size in bytes: 711032290
2025-03-13 17:22:00,642 [INFO]: 	avg_search_speed_ms: 10.127295167062824
2025-03-13 17:22:00,642 [INFO]: 	99p_search_speed_ms: 15.768396991770715
2025-03-13 17:22:00,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:00,642 [INFO]: 	nb vectors: 3614
2025-03-13 17:22:00,642 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:00,642 [INFO]: 	compression ratio: 0.9993094856493788
2025-03-13 17:22:00,642 [INFO]: }
2025-03-13 17:22:00,642 [INFO]: 	>>> Finished "Creating the index" in 74.6626 secs
2025-03-13 17:22:00,642 [INFO]: >>> Finished "Launching the whole pipeline" in 74.6914 secs
2025-03-13 17:22:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 38956 [episode count 2/20]
[retrieval_preprocessing] for episode 6191 [episode count 3/20], we have num_retrieval=np.int64(3661) num_query=np.int64(170)
2025-03-13 17:22:04,288 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:04,904 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:04
2025-03-13 17:22:04,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1498.50it/s]
2025-03-13 17:22:05,448 [INFO]: There are 3661 embeddings of dim 49152
2025-03-13 17:22:05,448 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5441 secs
2025-03-13 17:22:05,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:05
2025-03-13 17:22:05,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:05,449 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:22:05,449 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:05,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:22:05,449 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:05
2025-03-13 17:22:05,449 [INFO]: 755.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:05,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:22:05,449 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:05
2025-03-13 17:22:05,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:05,450 [INFO]: 	Creating the index 03/13/2025, 17:22:05
2025-03-13 17:22:05,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:05
2025-03-13 17:22:05,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:22:05,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:05
2025-03-13 17:22:05,452 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:22:05,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.83it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.62it/s] 80%|████████  | 12/15 [00:00<00:00, 38.33it/s]100%|██████████| 15/15 [00:03<00:00,  4.98it/s]
2025-03-13 17:22:08,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:08
2025-03-13 17:22:50,119 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6531 secs
2025-03-13 17:22:50,120 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 17:22:50,120 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.27it/s]
2025-03-13 17:23:12,267 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1472 secs
2025-03-13 17:23:12,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8173 secs
2025-03-13 17:23:12,270 [INFO]: {
2025-03-13 17:23:12,270 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:12,270 [INFO]: 	index_param: efSearch=186
2025-03-13 17:23:12,270 [INFO]: 	index_path: knn.index
2025-03-13 17:23:12,270 [INFO]: 	size in bytes: 720279430
2025-03-13 17:23:12,270 [INFO]: 	avg_search_speed_ms: 9.2529578422602
2025-03-13 17:23:12,270 [INFO]: 	99p_search_speed_ms: 14.794109854847203
2025-03-13 17:23:12,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:12,270 [INFO]: 	nb vectors: 3661
2025-03-13 17:23:12,270 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:12,270 [INFO]: 	compression ratio: 0.9993092375274413
2025-03-13 17:23:12,270 [INFO]: }
2025-03-13 17:23:12,270 [INFO]: 	>>> Finished "Creating the index" in 66.8201 secs
2025-03-13 17:23:12,270 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3656 secs
2025-03-13 17:23:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 6191 [episode count 3/20]
[retrieval_preprocessing] for episode 20597 [episode count 4/20], we have num_retrieval=np.int64(3616) num_query=np.int64(215)
2025-03-13 17:23:13,984 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:14,531 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:14
2025-03-13 17:23:14,531 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1173.56it/s]
2025-03-13 17:23:14,557 [INFO]: There are 3616 embeddings of dim 49152
2025-03-13 17:23:14,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:23:14,558 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:14
2025-03-13 17:23:14,558 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:14,558 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:23:14,558 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:14,558 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:23:14,558 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:14
2025-03-13 17:23:14,558 [INFO]: 746.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:14,558 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:23:14,558 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:14
2025-03-13 17:23:14,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:14,558 [INFO]: 	Creating the index 03/13/2025, 17:23:14
2025-03-13 17:23:14,558 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:14
2025-03-13 17:23:14,559 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:23:14,560 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:14
2025-03-13 17:23:14,560 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:23:14,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.94it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.21it/s] 80%|████████  | 12/15 [00:00<00:00, 37.75it/s]100%|██████████| 15/15 [00:03<00:00,  4.02it/s]
2025-03-13 17:23:18,296 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:18
2025-03-13 17:24:08,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.7725 secs
2025-03-13 17:24:08,069 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 17:24:08,069 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.96it/s]
2025-03-13 17:24:30,238 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1689 secs
2025-03-13 17:24:30,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.6810 secs
2025-03-13 17:24:30,241 [INFO]: {
2025-03-13 17:24:30,241 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:30,241 [INFO]: 	index_param: efSearch=151
2025-03-13 17:24:30,241 [INFO]: 	index_path: knn.index
2025-03-13 17:24:30,241 [INFO]: 	size in bytes: 711425770
2025-03-13 17:24:30,241 [INFO]: 	avg_search_speed_ms: 8.72468036952157
2025-03-13 17:24:30,241 [INFO]: 	99p_search_speed_ms: 13.072490878403187
2025-03-13 17:24:30,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:30,241 [INFO]: 	nb vectors: 3616
2025-03-13 17:24:30,241 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:30,241 [INFO]: 	compression ratio: 0.9993094964777562
2025-03-13 17:24:30,241 [INFO]: }
2025-03-13 17:24:30,241 [INFO]: 	>>> Finished "Creating the index" in 75.6826 secs
2025-03-13 17:24:30,241 [INFO]: >>> Finished "Launching the whole pipeline" in 75.7097 secs
2025-03-13 17:24:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 20597 [episode count 4/20]
[retrieval_preprocessing] for episode 55417 [episode count 5/20], we have num_retrieval=np.int64(3624) num_query=np.int64(207)
2025-03-13 17:24:32,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:33,725 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:33
2025-03-13 17:24:33,725 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 902.19it/s]
2025-03-13 17:24:33,753 [INFO]: There are 3624 embeddings of dim 49152
2025-03-13 17:24:33,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:24:33,754 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:33
2025-03-13 17:24:33,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:33,754 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:24:33,754 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:33,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:33,754 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:33
2025-03-13 17:24:33,754 [INFO]: 747.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:33,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:24:33,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:33
2025-03-13 17:24:33,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:33,754 [INFO]: 	Creating the index 03/13/2025, 17:24:33
2025-03-13 17:24:33,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:33
2025-03-13 17:24:33,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:24:33,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:33
2025-03-13 17:24:33,755 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:24:33,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.59it/s] 40%|████      | 6/15 [00:00<00:00, 30.38it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.14it/s]100%|██████████| 15/15 [00:03<00:00,  3.54it/s]100%|██████████| 15/15 [00:03<00:00,  4.88it/s]
2025-03-13 17:24:36,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:36
2025-03-13 17:25:24,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4491 secs
2025-03-13 17:25:24,282 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 17:25:24,282 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.91it/s]
2025-03-13 17:25:48,258 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9757 secs
2025-03-13 17:25:48,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7743 secs
2025-03-13 17:25:48,530 [INFO]: {
2025-03-13 17:25:48,530 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:48,530 [INFO]: 	index_param: efSearch=145
2025-03-13 17:25:48,530 [INFO]: 	index_path: knn.index
2025-03-13 17:25:48,530 [INFO]: 	size in bytes: 712999750
2025-03-13 17:25:48,530 [INFO]: 	avg_search_speed_ms: 9.453308094946037
2025-03-13 17:25:48,530 [INFO]: 	99p_search_speed_ms: 16.733581391163177
2025-03-13 17:25:48,530 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:48,530 [INFO]: 	nb vectors: 3624
2025-03-13 17:25:48,530 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:48,530 [INFO]: 	compression ratio: 0.9993094555783505
2025-03-13 17:25:48,531 [INFO]: }
2025-03-13 17:25:48,531 [INFO]: 	>>> Finished "Creating the index" in 74.7765 secs
2025-03-13 17:25:48,531 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8058 secs
2025-03-13 17:25:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 55417 [episode count 5/20]
[retrieval_preprocessing] for episode 65727 [episode count 6/20], we have num_retrieval=np.int64(3649) num_query=np.int64(182)
2025-03-13 17:25:52,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:53,881 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:53
2025-03-13 17:25:53,882 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.13it/s]
2025-03-13 17:25:53,913 [INFO]: There are 3649 embeddings of dim 49152
2025-03-13 17:25:53,914 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 17:25:53,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:53
2025-03-13 17:25:53,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:53,914 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:25:53,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:53,914 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:53,914 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:53
2025-03-13 17:25:53,914 [INFO]: 753.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:53,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:53,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:53
2025-03-13 17:25:53,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:53,914 [INFO]: 	Creating the index 03/13/2025, 17:25:53
2025-03-13 17:25:53,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:53
2025-03-13 17:25:53,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:25:53,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:53
2025-03-13 17:25:53,916 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:25:53,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.14it/s] 40%|████      | 6/15 [00:00<00:00, 28.45it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.28it/s]100%|██████████| 15/15 [00:03<00:00,  3.44it/s]100%|██████████| 15/15 [00:03<00:00,  4.74it/s]
2025-03-13 17:25:57,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:57
2025-03-13 17:26:56,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.4607 secs
2025-03-13 17:26:56,546 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:26:56,546 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-13 17:27:30,939 [INFO]: 	>>> Finished "Compute fast metrics" in 34.3925 secs
2025-03-13 17:27:30,942 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.0264 secs
2025-03-13 17:27:30,942 [INFO]: {
2025-03-13 17:27:30,942 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:30,942 [INFO]: 	index_param: efSearch=178
2025-03-13 17:27:30,942 [INFO]: 	index_path: knn.index
2025-03-13 17:27:30,942 [INFO]: 	size in bytes: 717918490
2025-03-13 17:27:30,942 [INFO]: 	avg_search_speed_ms: 10.351834160480147
2025-03-13 17:27:30,942 [INFO]: 	99p_search_speed_ms: 20.360695384442813
2025-03-13 17:27:30,942 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:30,942 [INFO]: 	nb vectors: 3649
2025-03-13 17:27:30,942 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:30,942 [INFO]: 	compression ratio: 0.9993092558460223
2025-03-13 17:27:30,942 [INFO]: }
2025-03-13 17:27:30,942 [INFO]: 	>>> Finished "Creating the index" in 97.0283 secs
2025-03-13 17:27:30,942 [INFO]: >>> Finished "Launching the whole pipeline" in 97.0609 secs
2025-03-13 17:27:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 65727 [episode count 6/20]
[retrieval_preprocessing] for episode 37124 [episode count 7/20], we have num_retrieval=np.int64(3632) num_query=np.int64(199)
2025-03-13 17:27:32,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:33,305 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:33
2025-03-13 17:27:33,305 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.51it/s]
2025-03-13 17:27:33,333 [INFO]: There are 3632 embeddings of dim 49152
2025-03-13 17:27:33,334 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:27:33,334 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:33
2025-03-13 17:27:33,334 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:33,334 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:27:33,334 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:33,334 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:33,334 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:33
2025-03-13 17:27:33,334 [INFO]: 749.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:33,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:27:33,334 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:33
2025-03-13 17:27:33,334 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:33,334 [INFO]: 	Creating the index 03/13/2025, 17:27:33
2025-03-13 17:27:33,334 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:33
2025-03-13 17:27:33,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:27:33,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:33
2025-03-13 17:27:33,336 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:27:33,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.63it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.90it/s] 80%|████████  | 12/15 [00:00<00:00, 37.97it/s]100%|██████████| 15/15 [00:03<00:00,  4.87it/s]
2025-03-13 17:27:36,420 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:36
2025-03-13 17:28:18,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5218 secs
2025-03-13 17:28:18,942 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 17:28:18,942 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 17:28:58,134 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1916 secs
2025-03-13 17:28:58,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.8007 secs
2025-03-13 17:28:58,136 [INFO]: {
2025-03-13 17:28:58,137 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:58,137 [INFO]: 	index_param: efSearch=205
2025-03-13 17:28:58,137 [INFO]: 	index_path: knn.index
2025-03-13 17:28:58,137 [INFO]: 	size in bytes: 714573730
2025-03-13 17:28:58,137 [INFO]: 	avg_search_speed_ms: 9.462249502513203
2025-03-13 17:28:58,137 [INFO]: 	99p_search_speed_ms: 12.74325326085091
2025-03-13 17:28:58,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:58,137 [INFO]: 	nb vectors: 3632
2025-03-13 17:28:58,137 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:58,137 [INFO]: 	compression ratio: 0.9993094148591217
2025-03-13 17:28:58,137 [INFO]: }
2025-03-13 17:28:58,137 [INFO]: 	>>> Finished "Creating the index" in 84.8024 secs
2025-03-13 17:28:58,137 [INFO]: >>> Finished "Launching the whole pipeline" in 84.8316 secs
2025-03-13 17:28:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 37124 [episode count 7/20]
[retrieval_preprocessing] for episode 18723 [episode count 8/20], we have num_retrieval=np.int64(3627) num_query=np.int64(204)
2025-03-13 17:29:00,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:00,870 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:00
2025-03-13 17:29:00,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.00it/s]
2025-03-13 17:29:00,895 [INFO]: There are 3627 embeddings of dim 49152
2025-03-13 17:29:00,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 17:29:00,896 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:00
2025-03-13 17:29:00,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:00,896 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:29:00,896 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:00,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:00,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:00
2025-03-13 17:29:00,896 [INFO]: 748.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:00,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:29:00,896 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:00
2025-03-13 17:29:00,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:00,896 [INFO]: 	Creating the index 03/13/2025, 17:29:00
2025-03-13 17:29:00,896 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:00
2025-03-13 17:29:00,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:29:00,897 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:00
2025-03-13 17:29:00,897 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:29:00,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.02it/s] 33%|███▎      | 5/15 [00:00<00:00, 23.52it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.46it/s]100%|██████████| 15/15 [00:02<00:00,  3.77it/s]100%|██████████| 15/15 [00:02<00:00,  5.06it/s]
2025-03-13 17:29:03,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:03
2025-03-13 17:29:46,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5520 secs
2025-03-13 17:29:46,418 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 17:29:46,418 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 17:30:05,475 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0568 secs
2025-03-13 17:30:05,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5802 secs
2025-03-13 17:30:05,478 [INFO]: {
2025-03-13 17:30:05,478 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:05,478 [INFO]: 	index_param: efSearch=190
2025-03-13 17:30:05,478 [INFO]: 	index_path: knn.index
2025-03-13 17:30:05,478 [INFO]: 	size in bytes: 713589970
2025-03-13 17:30:05,478 [INFO]: 	avg_search_speed_ms: 11.32869710729142
2025-03-13 17:30:05,478 [INFO]: 	99p_search_speed_ms: 20.983733101747923
2025-03-13 17:30:05,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:05,478 [INFO]: 	nb vectors: 3627
2025-03-13 17:30:05,478 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:05,478 [INFO]: 	compression ratio: 0.9993094717965276
2025-03-13 17:30:05,478 [INFO]: }
2025-03-13 17:30:05,478 [INFO]: 	>>> Finished "Creating the index" in 64.5817 secs
2025-03-13 17:30:05,478 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6078 secs
2025-03-13 17:30:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 18723 [episode count 8/20]
[retrieval_preprocessing] for episode 12833 [episode count 9/20], we have num_retrieval=np.int64(3659) num_query=np.int64(172)
2025-03-13 17:30:07,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:09,122 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:09
2025-03-13 17:30:09,122 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 741.17it/s]
2025-03-13 17:30:09,150 [INFO]: There are 3659 embeddings of dim 49152
2025-03-13 17:30:09,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:30:09,151 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:09
2025-03-13 17:30:09,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:09,152 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:30:09,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:09,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:30:09,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:09
2025-03-13 17:30:09,152 [INFO]: 755.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:09,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:30:09,153 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:09
2025-03-13 17:30:09,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:09,153 [INFO]: 	Creating the index 03/13/2025, 17:30:09
2025-03-13 17:30:09,153 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:09
2025-03-13 17:30:09,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:30:09,157 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:09
2025-03-13 17:30:09,157 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:30:09,157 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.85it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.76it/s] 80%|████████  | 12/15 [00:00<00:00, 37.48it/s]100%|██████████| 15/15 [00:04<00:00,  3.70it/s]
2025-03-13 17:30:13,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:13
2025-03-13 17:31:01,303 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0808 secs
2025-03-13 17:31:01,303 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:31:01,303 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 17:31:23,895 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5916 secs
2025-03-13 17:31:24,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5670 secs
2025-03-13 17:31:24,724 [INFO]: {
2025-03-13 17:31:24,724 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:24,724 [INFO]: 	index_param: efSearch=194
2025-03-13 17:31:24,724 [INFO]: 	index_path: knn.index
2025-03-13 17:31:24,724 [INFO]: 	size in bytes: 719885950
2025-03-13 17:31:24,724 [INFO]: 	avg_search_speed_ms: 10.529173204528266
2025-03-13 17:31:24,724 [INFO]: 	99p_search_speed_ms: 16.205410456750542
2025-03-13 17:31:24,724 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:24,724 [INFO]: 	nb vectors: 3659
2025-03-13 17:31:24,724 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:24,724 [INFO]: 	compression ratio: 0.9993092266907001
2025-03-13 17:31:24,724 [INFO]: }
2025-03-13 17:31:24,724 [INFO]: 	>>> Finished "Creating the index" in 75.5714 secs
2025-03-13 17:31:24,724 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6022 secs
2025-03-13 17:31:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 12833 [episode count 9/20]
[retrieval_preprocessing] for episode 25053 [episode count 10/20], we have num_retrieval=np.int64(3661) num_query=np.int64(170)
2025-03-13 17:31:26,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:27,131 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:27
2025-03-13 17:31:27,131 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.44it/s]
2025-03-13 17:31:27,159 [INFO]: There are 3661 embeddings of dim 49152
2025-03-13 17:31:27,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:31:27,160 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:27
2025-03-13 17:31:27,160 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:27,161 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:31:27,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:27,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:31:27,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:27
2025-03-13 17:31:27,161 [INFO]: 755.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:27,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:31:27,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:27
2025-03-13 17:31:27,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:27,162 [INFO]: 	Creating the index 03/13/2025, 17:31:27
2025-03-13 17:31:27,162 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:27
2025-03-13 17:31:27,165 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:31:27,165 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:27
2025-03-13 17:31:27,166 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:31:27,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.34it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.65it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.29it/s]100%|██████████| 15/15 [00:03<00:00,  3.19it/s]100%|██████████| 15/15 [00:03<00:00,  4.58it/s]
2025-03-13 17:31:30,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:30
2025-03-13 17:32:17,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8129 secs
2025-03-13 17:32:17,261 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:32:17,261 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-13 17:32:40,574 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3129 secs
2025-03-13 17:32:40,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4113 secs
2025-03-13 17:32:40,577 [INFO]: {
2025-03-13 17:32:40,577 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:40,577 [INFO]: 	index_param: efSearch=199
2025-03-13 17:32:40,577 [INFO]: 	index_path: knn.index
2025-03-13 17:32:40,577 [INFO]: 	size in bytes: 720279430
2025-03-13 17:32:40,577 [INFO]: 	avg_search_speed_ms: 11.770964737105018
2025-03-13 17:32:40,577 [INFO]: 	99p_search_speed_ms: 17.642383000347763
2025-03-13 17:32:40,577 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:40,577 [INFO]: 	nb vectors: 3661
2025-03-13 17:32:40,577 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:40,577 [INFO]: 	compression ratio: 0.9993092375274413
2025-03-13 17:32:40,577 [INFO]: }
2025-03-13 17:32:40,577 [INFO]: 	>>> Finished "Creating the index" in 73.4150 secs
2025-03-13 17:32:40,577 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4464 secs
2025-03-13 17:32:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 25053 [episode count 10/20]
[retrieval_preprocessing] for episode 61924 [episode count 11/20], we have num_retrieval=np.int64(3649) num_query=np.int64(182)
2025-03-13 17:32:42,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:42,687 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:42
2025-03-13 17:32:42,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.36it/s]
2025-03-13 17:32:42,713 [INFO]: There are 3649 embeddings of dim 49152
2025-03-13 17:32:42,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:32:42,713 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,713 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:42,713 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:32:42,713 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:42,713 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:42,713 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,713 [INFO]: 753.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:42,713 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:32:42,713 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:42
2025-03-13 17:32:42,713 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:42,713 [INFO]: 	Creating the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,714 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:42
2025-03-13 17:32:42,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:32:42,715 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,715 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:32:42,715 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.64it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.31it/s] 80%|████████  | 12/15 [00:00<00:00, 41.72it/s]100%|██████████| 15/15 [00:03<00:00,  4.43it/s]
2025-03-13 17:32:46,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:46
2025-03-13 17:33:26,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4891 secs
2025-03-13 17:33:26,595 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:33:26,595 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.00it/s]
2025-03-13 17:33:54,147 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5514 secs
2025-03-13 17:33:54,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4351 secs
2025-03-13 17:33:54,150 [INFO]: {
2025-03-13 17:33:54,150 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:54,150 [INFO]: 	index_param: efSearch=199
2025-03-13 17:33:54,150 [INFO]: 	index_path: knn.index
2025-03-13 17:33:54,150 [INFO]: 	size in bytes: 717918490
2025-03-13 17:33:54,150 [INFO]: 	avg_search_speed_ms: 11.18818895658999
2025-03-13 17:33:54,150 [INFO]: 	99p_search_speed_ms: 16.599850016646077
2025-03-13 17:33:54,150 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:54,150 [INFO]: 	nb vectors: 3649
2025-03-13 17:33:54,150 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:54,150 [INFO]: 	compression ratio: 0.9993092558460223
2025-03-13 17:33:54,150 [INFO]: }
2025-03-13 17:33:54,150 [INFO]: 	>>> Finished "Creating the index" in 71.4366 secs
2025-03-13 17:33:54,150 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4627 secs
2025-03-13 17:33:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 61924 [episode count 11/20]
[retrieval_preprocessing] for episode 16909 [episode count 12/20], we have num_retrieval=np.int64(3644) num_query=np.int64(187)
2025-03-13 17:33:55,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:56,385 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:56
2025-03-13 17:33:56,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.78it/s]
2025-03-13 17:33:56,413 [INFO]: There are 3644 embeddings of dim 49152
2025-03-13 17:33:56,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:33:56,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:56
2025-03-13 17:33:56,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:56,415 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:33:56,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:56,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:33:56,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:56
2025-03-13 17:33:56,415 [INFO]: 752.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:56,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:33:56,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:56
2025-03-13 17:33:56,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:56,416 [INFO]: 	Creating the index 03/13/2025, 17:33:56
2025-03-13 17:33:56,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:56
2025-03-13 17:33:56,419 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:33:56,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:56
2025-03-13 17:33:56,420 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:33:56,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.13it/s] 53%|█████▎    | 8/15 [00:00<00:00, 39.77it/s] 93%|█████████▎| 14/15 [00:00<00:00, 46.47it/s]100%|██████████| 15/15 [00:03<00:00,  4.98it/s]
2025-03-13 17:33:59,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:59
2025-03-13 17:34:39,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9962 secs
2025-03-13 17:34:39,436 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 17:34:39,436 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 17:35:01,238 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8018 secs
2025-03-13 17:35:01,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8209 secs
2025-03-13 17:35:01,241 [INFO]: {
2025-03-13 17:35:01,241 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:01,241 [INFO]: 	index_param: efSearch=179
2025-03-13 17:35:01,241 [INFO]: 	index_path: knn.index
2025-03-13 17:35:01,241 [INFO]: 	size in bytes: 716934790
2025-03-13 17:35:01,241 [INFO]: 	avg_search_speed_ms: 10.070720995135778
2025-03-13 17:35:01,241 [INFO]: 	99p_search_speed_ms: 15.616456987336278
2025-03-13 17:35:01,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:01,241 [INFO]: 	nb vectors: 3644
2025-03-13 17:35:01,241 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:01,241 [INFO]: 	compression ratio: 0.9993092286677844
2025-03-13 17:35:01,241 [INFO]: }
2025-03-13 17:35:01,241 [INFO]: 	>>> Finished "Creating the index" in 64.8251 secs
2025-03-13 17:35:01,241 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8563 secs
2025-03-13 17:35:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 16909 [episode count 12/20]
[retrieval_preprocessing] for episode 78188 [episode count 13/20], we have num_retrieval=np.int64(3663) num_query=np.int64(168)
2025-03-13 17:35:05,061 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:05,880 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:05
2025-03-13 17:35:05,880 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 877.10it/s]
2025-03-13 17:35:05,914 [INFO]: There are 3663 embeddings of dim 49152
2025-03-13 17:35:05,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 17:35:05,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:05
2025-03-13 17:35:05,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:05,915 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:35:05,915 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:05,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:35:05,916 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:05
2025-03-13 17:35:05,916 [INFO]: 756.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:05,916 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:35:05,916 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:05
2025-03-13 17:35:05,916 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:05,916 [INFO]: 	Creating the index 03/13/2025, 17:35:05
2025-03-13 17:35:05,916 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:05
2025-03-13 17:35:05,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:35:05,920 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:05
2025-03-13 17:35:05,920 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:35:05,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.44it/s] 33%|███▎      | 5/15 [00:00<00:00, 22.88it/s] 60%|██████    | 9/15 [00:00<00:00, 28.07it/s] 87%|████████▋ | 13/15 [00:00<00:00, 30.59it/s]100%|██████████| 15/15 [00:04<00:00,  3.64it/s]
2025-03-13 17:35:10,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:10
2025-03-13 17:35:54,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3727 secs
2025-03-13 17:35:54,426 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:35:54,426 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 17:36:22,087 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6612 secs
2025-03-13 17:36:22,090 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1695 secs
2025-03-13 17:36:22,090 [INFO]: {
2025-03-13 17:36:22,090 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:22,090 [INFO]: 	index_param: efSearch=196
2025-03-13 17:36:22,090 [INFO]: 	index_path: knn.index
2025-03-13 17:36:22,090 [INFO]: 	size in bytes: 720672910
2025-03-13 17:36:22,090 [INFO]: 	avg_search_speed_ms: 9.460026081105168
2025-03-13 17:36:22,090 [INFO]: 	99p_search_speed_ms: 13.670874796807768
2025-03-13 17:36:22,090 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:22,090 [INFO]: 	nb vectors: 3663
2025-03-13 17:36:22,090 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:22,090 [INFO]: 	compression ratio: 0.9993092483523489
2025-03-13 17:36:22,090 [INFO]: }
2025-03-13 17:36:22,090 [INFO]: 	>>> Finished "Creating the index" in 76.1734 secs
2025-03-13 17:36:22,090 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2094 secs
2025-03-13 17:36:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 78188 [episode count 13/20]
[retrieval_preprocessing] for episode 82296 [episode count 14/20], we have num_retrieval=np.int64(3572) num_query=np.int64(259)
2025-03-13 17:36:23,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:24,262 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:24
2025-03-13 17:36:24,262 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.35it/s]
2025-03-13 17:36:24,290 [INFO]: There are 3572 embeddings of dim 49152
2025-03-13 17:36:24,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:36:24,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:24
2025-03-13 17:36:24,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:24,290 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:36:24,290 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:24,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:24,290 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:24
2025-03-13 17:36:24,290 [INFO]: 737.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:24,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:24,290 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:24
2025-03-13 17:36:24,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:24,290 [INFO]: 	Creating the index 03/13/2025, 17:36:24
2025-03-13 17:36:24,290 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:24
2025-03-13 17:36:24,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:36:24,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:24
2025-03-13 17:36:24,292 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:36:24,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 25.51it/s] 60%|██████    | 9/15 [00:00<00:00, 40.58it/s]100%|██████████| 15/15 [00:03<00:00,  3.98it/s]100%|██████████| 15/15 [00:03<00:00,  4.95it/s]
2025-03-13 17:36:27,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:27
2025-03-13 17:37:09,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5784 secs
2025-03-13 17:37:09,462 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 17:37:09,462 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 17:37:27,555 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0929 secs
2025-03-13 17:37:27,558 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2660 secs
2025-03-13 17:37:27,558 [INFO]: {
2025-03-13 17:37:27,558 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:27,558 [INFO]: 	index_param: efSearch=188
2025-03-13 17:37:27,558 [INFO]: 	index_path: knn.index
2025-03-13 17:37:27,558 [INFO]: 	size in bytes: 702768970
2025-03-13 17:37:27,558 [INFO]: 	avg_search_speed_ms: 12.737047994972034
2025-03-13 17:37:27,558 [INFO]: 	99p_search_speed_ms: 19.78870046325028
2025-03-13 17:37:27,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:27,558 [INFO]: 	nb vectors: 3572
2025-03-13 17:37:27,558 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:27,558 [INFO]: 	compression ratio: 0.9993095967228035
2025-03-13 17:37:27,558 [INFO]: }
2025-03-13 17:37:27,558 [INFO]: 	>>> Finished "Creating the index" in 63.2678 secs
2025-03-13 17:37:27,558 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2960 secs
2025-03-13 17:37:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 82296 [episode count 14/20]
[retrieval_preprocessing] for episode 384 [episode count 15/20], we have num_retrieval=np.int64(3611) num_query=np.int64(220)
2025-03-13 17:37:30,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:31,010 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:31
2025-03-13 17:37:31,010 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1806.33it/s]
2025-03-13 17:37:31,035 [INFO]: There are 3611 embeddings of dim 49152
2025-03-13 17:37:31,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 17:37:31,035 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:31
2025-03-13 17:37:31,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:31,035 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:37:31,035 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:31,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:37:31,035 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:31
2025-03-13 17:37:31,036 [INFO]: 745.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:31,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:37:31,036 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:31
2025-03-13 17:37:31,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:31,036 [INFO]: 	Creating the index 03/13/2025, 17:37:31
2025-03-13 17:37:31,036 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:31
2025-03-13 17:37:31,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:37:31,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:31
2025-03-13 17:37:31,037 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:37:31,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.51it/s] 33%|███▎      | 5/15 [00:00<00:00, 21.50it/s] 60%|██████    | 9/15 [00:00<00:00, 27.59it/s] 87%|████████▋ | 13/15 [00:00<00:00, 30.46it/s]100%|██████████| 15/15 [00:04<00:00,  3.71it/s]
2025-03-13 17:37:35,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:35
2025-03-13 17:38:18,435 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3485 secs
2025-03-13 17:38:18,436 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 17:38:18,436 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 17:38:51,827 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3913 secs
2025-03-13 17:38:51,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.7932 secs
2025-03-13 17:38:51,830 [INFO]: {
2025-03-13 17:38:51,830 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:51,830 [INFO]: 	index_param: efSearch=166
2025-03-13 17:38:51,830 [INFO]: 	index_path: knn.index
2025-03-13 17:38:51,830 [INFO]: 	size in bytes: 710442070
2025-03-13 17:38:51,830 [INFO]: 	avg_search_speed_ms: 9.324916325893545
2025-03-13 17:38:51,830 [INFO]: 	99p_search_speed_ms: 14.320674254558966
2025-03-13 17:38:51,830 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:51,830 [INFO]: 	nb vectors: 3611
2025-03-13 17:38:51,830 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:51,830 [INFO]: 	compression ratio: 0.999309469384323
2025-03-13 17:38:51,830 [INFO]: }
2025-03-13 17:38:51,830 [INFO]: 	>>> Finished "Creating the index" in 80.7947 secs
2025-03-13 17:38:51,830 [INFO]: >>> Finished "Launching the whole pipeline" in 80.8204 secs
2025-03-13 17:38:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 384 [episode count 15/20]
[retrieval_preprocessing] for episode 70039 [episode count 16/20], we have num_retrieval=np.int64(3653) num_query=np.int64(178)
2025-03-13 17:38:53,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:54,236 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:54
2025-03-13 17:38:54,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.40it/s]
2025-03-13 17:38:54,269 [INFO]: There are 3653 embeddings of dim 49152
2025-03-13 17:38:54,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 17:38:54,270 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:54
2025-03-13 17:38:54,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:54,270 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:38:54,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:54,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:38:54,270 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:54
2025-03-13 17:38:54,271 [INFO]: 753.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:54,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:38:54,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:54
2025-03-13 17:38:54,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:54,271 [INFO]: 	Creating the index 03/13/2025, 17:38:54
2025-03-13 17:38:54,271 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:54
2025-03-13 17:38:54,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:38:54,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:54
2025-03-13 17:38:54,275 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:38:54,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.80it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.04it/s] 93%|█████████▎| 14/15 [00:00<00:00, 44.53it/s]100%|██████████| 15/15 [00:02<00:00,  5.38it/s]
2025-03-13 17:38:57,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:57
2025-03-13 17:39:46,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0894 secs
2025-03-13 17:39:46,157 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 17:39:46,157 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.03it/s]
2025-03-13 17:40:27,789 [INFO]: 	>>> Finished "Compute fast metrics" in 41.6323 secs
2025-03-13 17:40:27,793 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.5181 secs
2025-03-13 17:40:27,793 [INFO]: {
2025-03-13 17:40:27,793 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:27,793 [INFO]: 	index_param: efSearch=177
2025-03-13 17:40:27,793 [INFO]: 	index_path: knn.index
2025-03-13 17:40:27,793 [INFO]: 	size in bytes: 718705510
2025-03-13 17:40:27,793 [INFO]: 	avg_search_speed_ms: 9.458629847090473
2025-03-13 17:40:27,793 [INFO]: 	99p_search_speed_ms: 13.605763684026899
2025-03-13 17:40:27,793 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:27,793 [INFO]: 	nb vectors: 3653
2025-03-13 17:40:27,793 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:27,793 [INFO]: 	compression ratio: 0.9993091941092813
2025-03-13 17:40:27,793 [INFO]: }
2025-03-13 17:40:27,793 [INFO]: 	>>> Finished "Creating the index" in 93.5218 secs
2025-03-13 17:40:27,793 [INFO]: >>> Finished "Launching the whole pipeline" in 93.5567 secs
2025-03-13 17:40:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 70039 [episode count 16/20]
[retrieval_preprocessing] for episode 82391 [episode count 17/20], we have num_retrieval=np.int64(3617) num_query=np.int64(214)
2025-03-13 17:40:30,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:30,772 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:30
2025-03-13 17:40:30,772 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.42it/s]
2025-03-13 17:40:30,803 [INFO]: There are 3617 embeddings of dim 49152
2025-03-13 17:40:30,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 17:40:30,804 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:30
2025-03-13 17:40:30,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:30,804 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:40:30,804 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:30,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:40:30,804 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:30
2025-03-13 17:40:30,805 [INFO]: 746.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:30,805 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:40:30,805 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:30
2025-03-13 17:40:30,805 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:30,806 [INFO]: 	Creating the index 03/13/2025, 17:40:30
2025-03-13 17:40:30,806 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:30
2025-03-13 17:40:30,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:40:30,809 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:30
2025-03-13 17:40:30,809 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:40:30,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.32it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.79it/s] 80%|████████  | 12/15 [00:00<00:00, 37.14it/s]100%|██████████| 15/15 [00:03<00:00,  4.63it/s]
2025-03-13 17:40:34,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:34
2025-03-13 17:41:21,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2880 secs
2025-03-13 17:41:21,343 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:41:21,343 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.46it/s]
2025-03-13 17:41:40,914 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5709 secs
2025-03-13 17:41:40,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1082 secs
2025-03-13 17:41:40,918 [INFO]: {
2025-03-13 17:41:40,918 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:40,918 [INFO]: 	index_param: efSearch=176
2025-03-13 17:41:40,918 [INFO]: 	index_path: knn.index
2025-03-13 17:41:40,918 [INFO]: 	size in bytes: 711622510
2025-03-13 17:41:40,918 [INFO]: 	avg_search_speed_ms: 10.969560001588738
2025-03-13 17:41:40,918 [INFO]: 	99p_search_speed_ms: 20.86254838388413
2025-03-13 17:41:40,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:40,918 [INFO]: 	nb vectors: 3617
2025-03-13 17:41:40,918 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:40,918 [INFO]: 	compression ratio: 0.9993095018874544
2025-03-13 17:41:40,918 [INFO]: }
2025-03-13 17:41:40,918 [INFO]: 	>>> Finished "Creating the index" in 70.1119 secs
2025-03-13 17:41:40,918 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1461 secs
2025-03-13 17:41:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 82391 [episode count 17/20]
[retrieval_preprocessing] for episode 90474 [episode count 18/20], we have num_retrieval=np.int64(3659) num_query=np.int64(172)
2025-03-13 17:41:43,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:43,717 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:43
2025-03-13 17:41:43,717 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.98it/s]
2025-03-13 17:41:43,745 [INFO]: There are 3659 embeddings of dim 49152
2025-03-13 17:41:43,746 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:41:43,746 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:43,747 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:41:43,747 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:43,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:41:43,747 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,748 [INFO]: 755.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:43,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:41:43,748 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:43
2025-03-13 17:41:43,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:43,748 [INFO]: 	Creating the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,749 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:43
2025-03-13 17:41:43,752 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:41:43,752 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:43
2025-03-13 17:41:43,752 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:41:43,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.15it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.53it/s] 80%|████████  | 12/15 [00:00<00:00, 39.05it/s]100%|██████████| 15/15 [00:03<00:00,  4.28it/s]
2025-03-13 17:41:47,266 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:47
2025-03-13 17:42:28,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2936 secs
2025-03-13 17:42:28,560 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 17:42:28,560 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.30it/s]
2025-03-13 17:43:00,350 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7897 secs
2025-03-13 17:43:00,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.6010 secs
2025-03-13 17:43:00,353 [INFO]: {
2025-03-13 17:43:00,353 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:00,353 [INFO]: 	index_param: efSearch=209
2025-03-13 17:43:00,353 [INFO]: 	index_path: knn.index
2025-03-13 17:43:00,353 [INFO]: 	size in bytes: 719885950
2025-03-13 17:43:00,353 [INFO]: 	avg_search_speed_ms: 9.98946177339615
2025-03-13 17:43:00,353 [INFO]: 	99p_search_speed_ms: 14.010431012138724
2025-03-13 17:43:00,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:00,353 [INFO]: 	nb vectors: 3659
2025-03-13 17:43:00,353 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:00,353 [INFO]: 	compression ratio: 0.9993092266907001
2025-03-13 17:43:00,353 [INFO]: }
2025-03-13 17:43:00,353 [INFO]: 	>>> Finished "Creating the index" in 76.6049 secs
2025-03-13 17:43:00,353 [INFO]: >>> Finished "Launching the whole pipeline" in 76.6365 secs
2025-03-13 17:43:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 90474 [episode count 18/20]
[retrieval_preprocessing] for episode 33144 [episode count 19/20], we have num_retrieval=np.int64(3657) num_query=np.int64(174)
2025-03-13 17:43:02,154 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:02,909 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:02
2025-03-13 17:43:02,909 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.55it/s]
2025-03-13 17:43:02,936 [INFO]: There are 3657 embeddings of dim 49152
2025-03-13 17:43:02,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:43:02,937 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:02
2025-03-13 17:43:02,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:02,937 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:43:02,937 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:02,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:02,937 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:02
2025-03-13 17:43:02,937 [INFO]: 754.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:02,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:02,937 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:02
2025-03-13 17:43:02,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:02,937 [INFO]: 	Creating the index 03/13/2025, 17:43:02
2025-03-13 17:43:02,937 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:02
2025-03-13 17:43:02,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:43:02,938 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:02
2025-03-13 17:43:02,939 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:43:02,939 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01, 10.00it/s] 40%|████      | 6/15 [00:00<00:00, 30.27it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.31it/s]100%|██████████| 15/15 [00:03<00:00,  3.34it/s]100%|██████████| 15/15 [00:03<00:00,  4.62it/s]
2025-03-13 17:43:06,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:06
2025-03-13 17:43:48,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6816 secs
2025-03-13 17:43:48,959 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:43:48,959 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-13 17:44:30,940 [INFO]: 	>>> Finished "Compute fast metrics" in 41.9804 secs
2025-03-13 17:44:30,942 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.0038 secs
2025-03-13 17:44:30,942 [INFO]: {
2025-03-13 17:44:30,942 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:30,943 [INFO]: 	index_param: efSearch=223
2025-03-13 17:44:30,943 [INFO]: 	index_path: knn.index
2025-03-13 17:44:30,943 [INFO]: 	size in bytes: 719492470
2025-03-13 17:44:30,943 [INFO]: 	avg_search_speed_ms: 10.488146889429594
2025-03-13 17:44:30,943 [INFO]: 	99p_search_speed_ms: 13.995280484668912
2025-03-13 17:44:30,943 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:30,943 [INFO]: 	nb vectors: 3657
2025-03-13 17:44:30,943 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:30,943 [INFO]: 	compression ratio: 0.9993092158421061
2025-03-13 17:44:30,943 [INFO]: }
2025-03-13 17:44:30,943 [INFO]: 	>>> Finished "Creating the index" in 88.0053 secs
2025-03-13 17:44:30,943 [INFO]: >>> Finished "Launching the whole pipeline" in 88.0336 secs
2025-03-13 17:44:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 33144 [episode count 19/20]
2025-03-13 17:44:32: [retrieval_preprocessing] finished for 1656877278_put_packet_in_bowl [chosen_id count 5/196]
2025-03-13 17:44:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_towel_in_bowl [chosen_id count 6/196]
2025-03-13 17:44:34: [retrieval_preprocessing] we have num_total=4922 embedding_dim=49152
[retrieval_preprocessing] for episode 14 [episode count 0/20], we have num_retrieval=np.int64(4705) num_query=np.int64(217)
2025-03-13 17:44:35,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:36,330 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:36
2025-03-13 17:44:36,330 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1044.14it/s]
2025-03-13 17:44:36,362 [INFO]: There are 4705 embeddings of dim 49152
2025-03-13 17:44:36,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 17:44:36,363 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:36
2025-03-13 17:44:36,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:36,363 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:44:36,363 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:36,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:44:36,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:36
2025-03-13 17:44:36,363 [INFO]: 971.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:36,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:36,363 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:36
2025-03-13 17:44:36,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:36,363 [INFO]: 	Creating the index 03/13/2025, 17:44:36
2025-03-13 17:44:36,363 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:36
2025-03-13 17:44:36,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:44:36,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:36
2025-03-13 17:44:36,365 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:44:36,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.25it/s] 32%|███▏      | 6/19 [00:00<00:00, 25.74it/s] 58%|█████▊    | 11/19 [00:00<00:00, 32.77it/s] 84%|████████▍ | 16/19 [00:00<00:00, 35.91it/s]100%|██████████| 19/19 [00:04<00:00,  4.31it/s]
2025-03-13 17:44:40,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:40
2025-03-13 17:45:35,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.6684 secs
2025-03-13 17:45:35,449 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:45:35,449 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 17:46:05,992 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5431 secs
2025-03-13 17:46:05,995 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.6302 secs
2025-03-13 17:46:05,995 [INFO]: {
2025-03-13 17:46:05,995 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:05,995 [INFO]: 	index_param: efSearch=207
2025-03-13 17:46:05,995 [INFO]: 	index_path: knn.index
2025-03-13 17:46:05,995 [INFO]: 	size in bytes: 925680610
2025-03-13 17:46:05,995 [INFO]: 	avg_search_speed_ms: 11.19566777713747
2025-03-13 17:46:05,995 [INFO]: 	99p_search_speed_ms: 23.245677240192897
2025-03-13 17:46:05,995 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:05,995 [INFO]: 	nb vectors: 4705
2025-03-13 17:46:05,995 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:05,995 [INFO]: 	compression ratio: 0.9993086492326981
2025-03-13 17:46:05,995 [INFO]: }
2025-03-13 17:46:05,995 [INFO]: 	>>> Finished "Creating the index" in 89.6319 secs
2025-03-13 17:46:05,995 [INFO]: >>> Finished "Launching the whole pipeline" in 89.6652 secs
2025-03-13 17:46:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 14 [episode count 0/20]
[retrieval_preprocessing] for episode 55310 [episode count 1/20], we have num_retrieval=np.int64(4682) num_query=np.int64(240)
2025-03-13 17:46:08,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:09,308 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:09
2025-03-13 17:46:09,308 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1862.48it/s]
2025-03-13 17:46:09,337 [INFO]: There are 4682 embeddings of dim 49152
2025-03-13 17:46:09,337 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:46:09,338 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:09
2025-03-13 17:46:09,338 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:09,338 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:46:09,338 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:09,338 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:46:09,338 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:09
2025-03-13 17:46:09,339 [INFO]: 966.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:09,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:46:09,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:09
2025-03-13 17:46:09,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:09,340 [INFO]: 	Creating the index 03/13/2025, 17:46:09
2025-03-13 17:46:09,340 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:09
2025-03-13 17:46:09,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:46:09,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:09
2025-03-13 17:46:09,344 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:46:09,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.13it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.71it/s] 53%|█████▎    | 10/19 [00:00<00:00, 31.61it/s] 74%|███████▎  | 14/19 [00:00<00:00, 33.68it/s] 95%|█████████▍| 18/19 [00:00<00:00, 35.72it/s]100%|██████████| 19/19 [00:04<00:00,  4.56it/s]
2025-03-13 17:46:13,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:13
2025-03-13 17:47:01,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1335 secs
2025-03-13 17:47:01,649 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 17:47:01,649 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 17:47:25,620 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9712 secs
2025-03-13 17:47:25,625 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2811 secs
2025-03-13 17:47:25,625 [INFO]: {
2025-03-13 17:47:25,625 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:25,625 [INFO]: 	index_param: efSearch=210
2025-03-13 17:47:25,625 [INFO]: 	index_path: knn.index
2025-03-13 17:47:25,625 [INFO]: 	size in bytes: 921155410
2025-03-13 17:47:25,625 [INFO]: 	avg_search_speed_ms: 10.377174808983826
2025-03-13 17:47:25,625 [INFO]: 	99p_search_speed_ms: 18.884609846863896
2025-03-13 17:47:25,625 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:25,625 [INFO]: 	nb vectors: 4682
2025-03-13 17:47:25,625 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:25,625 [INFO]: 	compression ratio: 0.9993087442215641
2025-03-13 17:47:25,625 [INFO]: }
2025-03-13 17:47:25,625 [INFO]: 	>>> Finished "Creating the index" in 76.2855 secs
2025-03-13 17:47:25,626 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3178 secs
2025-03-13 17:47:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 55310 [episode count 1/20]
[retrieval_preprocessing] for episode 75862 [episode count 2/20], we have num_retrieval=np.int64(4622) num_query=np.int64(300)
2025-03-13 17:47:28,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:28,700 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:28
2025-03-13 17:47:28,700 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1529.09it/s]
2025-03-13 17:47:28,727 [INFO]: There are 4622 embeddings of dim 49152
2025-03-13 17:47:28,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 17:47:28,727 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:28
2025-03-13 17:47:28,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:28,727 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:47:28,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:28,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:28,728 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:28
2025-03-13 17:47:28,728 [INFO]: 953.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:28,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:47:28,728 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:28
2025-03-13 17:47:28,728 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:28,728 [INFO]: 	Creating the index 03/13/2025, 17:47:28
2025-03-13 17:47:28,728 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:28
2025-03-13 17:47:28,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:47:28,729 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:28
2025-03-13 17:47:28,729 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:47:28,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.57it/s] 26%|██▋       | 5/19 [00:00<00:00, 22.42it/s] 53%|█████▎    | 10/19 [00:00<00:00, 30.96it/s] 79%|███████▉  | 15/19 [00:00<00:00, 34.68it/s]100%|██████████| 19/19 [00:04<00:00,  2.74it/s]100%|██████████| 19/19 [00:04<00:00,  4.22it/s]
2025-03-13 17:47:33,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:33
2025-03-13 17:48:17,389 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1497 secs
2025-03-13 17:48:17,389 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:48:17,389 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-13 17:48:44,070 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6801 secs
2025-03-13 17:48:44,073 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3441 secs
2025-03-13 17:48:44,073 [INFO]: {
2025-03-13 17:48:44,073 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:44,073 [INFO]: 	index_param: efSearch=220
2025-03-13 17:48:44,073 [INFO]: 	index_path: knn.index
2025-03-13 17:48:44,073 [INFO]: 	size in bytes: 909350650
2025-03-13 17:48:44,073 [INFO]: 	avg_search_speed_ms: 12.995952078104986
2025-03-13 17:48:44,074 [INFO]: 	99p_search_speed_ms: 22.769875004887567
2025-03-13 17:48:44,074 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:44,074 [INFO]: 	nb vectors: 4622
2025-03-13 17:48:44,074 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:44,074 [INFO]: 	compression ratio: 0.9993088760644753
2025-03-13 17:48:44,074 [INFO]: }
2025-03-13 17:48:44,074 [INFO]: 	>>> Finished "Creating the index" in 75.3458 secs
2025-03-13 17:48:44,074 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3736 secs
2025-03-13 17:48:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 75862 [episode count 2/20]
[retrieval_preprocessing] for episode 2140 [episode count 3/20], we have num_retrieval=np.int64(4711) num_query=np.int64(211)
2025-03-13 17:48:47,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:48,712 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:48
2025-03-13 17:48:48,712 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.48it/s]
2025-03-13 17:48:48,748 [INFO]: There are 4711 embeddings of dim 49152
2025-03-13 17:48:48,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 17:48:48,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:48
2025-03-13 17:48:48,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:48,749 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:48:48,749 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:48,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:48,749 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:48
2025-03-13 17:48:48,749 [INFO]: 972.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:48,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:48:48,749 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:48
2025-03-13 17:48:48,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:48,749 [INFO]: 	Creating the index 03/13/2025, 17:48:48
2025-03-13 17:48:48,749 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:48
2025-03-13 17:48:48,750 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:48:48,750 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:48
2025-03-13 17:48:48,751 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:48:48,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.75it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.42it/s] 47%|████▋     | 9/19 [00:00<00:00, 29.47it/s] 68%|██████▊   | 13/19 [00:00<00:00, 32.93it/s] 89%|████████▉ | 17/19 [00:00<00:00, 34.95it/s]100%|██████████| 19/19 [00:05<00:00,  3.67it/s]
2025-03-13 17:48:53,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:53
2025-03-13 17:49:40,303 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3721 secs
2025-03-13 17:49:40,303 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 17:49:40,304 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.55it/s]
2025-03-13 17:50:14,021 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7173 secs
2025-03-13 17:50:14,024 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.2739 secs
2025-03-13 17:50:14,025 [INFO]: {
2025-03-13 17:50:14,025 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:14,025 [INFO]: 	index_param: efSearch=239
2025-03-13 17:50:14,025 [INFO]: 	index_path: knn.index
2025-03-13 17:50:14,025 [INFO]: 	size in bytes: 926861110
2025-03-13 17:50:14,025 [INFO]: 	avg_search_speed_ms: 9.701939514466895
2025-03-13 17:50:14,025 [INFO]: 	99p_search_speed_ms: 13.090496417135
2025-03-13 17:50:14,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:14,025 [INFO]: 	nb vectors: 4711
2025-03-13 17:50:14,025 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:14,025 [INFO]: 	compression ratio: 0.9993086105425224
2025-03-13 17:50:14,025 [INFO]: }
2025-03-13 17:50:14,025 [INFO]: 	>>> Finished "Creating the index" in 85.2756 secs
2025-03-13 17:50:14,025 [INFO]: >>> Finished "Launching the whole pipeline" in 85.3126 secs
2025-03-13 17:50:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 2140 [episode count 3/20]
[retrieval_preprocessing] for episode 77958 [episode count 4/20], we have num_retrieval=np.int64(4685) num_query=np.int64(237)
2025-03-13 17:50:16,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:16,893 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:16
2025-03-13 17:50:16,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.16it/s]
2025-03-13 17:50:16,921 [INFO]: There are 4685 embeddings of dim 49152
2025-03-13 17:50:16,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:50:16,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:16
2025-03-13 17:50:16,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:16,922 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:50:16,922 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:16,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:16,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:16
2025-03-13 17:50:16,922 [INFO]: 966.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:16,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:50:16,922 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:16
2025-03-13 17:50:16,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:16,922 [INFO]: 	Creating the index 03/13/2025, 17:50:16
2025-03-13 17:50:16,922 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:16
2025-03-13 17:50:16,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:50:16,923 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:16
2025-03-13 17:50:16,923 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:50:16,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.27it/s] 37%|███▋      | 7/19 [00:00<00:00, 34.21it/s] 68%|██████▊   | 13/19 [00:00<00:00, 41.94it/s] 95%|█████████▍| 18/19 [00:00<00:00, 44.06it/s]100%|██████████| 19/19 [00:03<00:00,  4.84it/s]
2025-03-13 17:50:20,856 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:20
2025-03-13 17:51:07,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8780 secs
2025-03-13 17:51:07,734 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 17:51:07,734 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 17:51:40,492 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7573 secs
2025-03-13 17:51:40,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5729 secs
2025-03-13 17:51:40,496 [INFO]: {
2025-03-13 17:51:40,496 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:40,496 [INFO]: 	index_param: efSearch=226
2025-03-13 17:51:40,496 [INFO]: 	index_path: knn.index
2025-03-13 17:51:40,496 [INFO]: 	size in bytes: 921745630
2025-03-13 17:51:40,496 [INFO]: 	avg_search_speed_ms: 12.650044158680362
2025-03-13 17:51:40,496 [INFO]: 	99p_search_speed_ms: 19.59739597514272
2025-03-13 17:51:40,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:40,497 [INFO]: 	nb vectors: 4685
2025-03-13 17:51:40,497 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:40,497 [INFO]: 	compression ratio: 0.9993087572327303
2025-03-13 17:51:40,497 [INFO]: }
2025-03-13 17:51:40,497 [INFO]: 	>>> Finished "Creating the index" in 83.5746 secs
2025-03-13 17:51:40,497 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6035 secs
2025-03-13 17:51:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 77958 [episode count 4/20]
[retrieval_preprocessing] for episode 88380 [episode count 5/20], we have num_retrieval=np.int64(4680) num_query=np.int64(242)
2025-03-13 17:51:42,921 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:43,558 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:43
2025-03-13 17:51:43,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 908.25it/s]
2025-03-13 17:51:43,585 [INFO]: There are 4680 embeddings of dim 49152
2025-03-13 17:51:43,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:51:43,586 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:43
2025-03-13 17:51:43,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:43,586 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:51:43,586 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:43,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:43,586 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:43
2025-03-13 17:51:43,586 [INFO]: 965.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:43,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:51:43,586 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:43
2025-03-13 17:51:43,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:43,586 [INFO]: 	Creating the index 03/13/2025, 17:51:43
2025-03-13 17:51:43,586 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:43
2025-03-13 17:51:43,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:51:43,587 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:43
2025-03-13 17:51:43,587 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:51:43,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.41it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.19it/s] 58%|█████▊    | 11/19 [00:00<00:00, 35.42it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.28it/s]100%|██████████| 19/19 [00:04<00:00,  4.62it/s]
2025-03-13 17:51:47,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:47
2025-03-13 17:52:35,744 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0382 secs
2025-03-13 17:52:35,744 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:52:35,744 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 17:53:00,303 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5592 secs
2025-03-13 17:53:00,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7199 secs
2025-03-13 17:53:00,308 [INFO]: {
2025-03-13 17:53:00,308 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:00,308 [INFO]: 	index_param: efSearch=202
2025-03-13 17:53:00,308 [INFO]: 	index_path: knn.index
2025-03-13 17:53:00,308 [INFO]: 	size in bytes: 920761870
2025-03-13 17:53:00,308 [INFO]: 	avg_search_speed_ms: 11.427102666082126
2025-03-13 17:53:00,308 [INFO]: 	99p_search_speed_ms: 20.774025935679674
2025-03-13 17:53:00,308 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:00,308 [INFO]: 	nb vectors: 4680
2025-03-13 17:53:00,308 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:00,308 [INFO]: 	compression ratio: 0.9993088006565694
2025-03-13 17:53:00,308 [INFO]: }
2025-03-13 17:53:00,308 [INFO]: 	>>> Finished "Creating the index" in 76.7215 secs
2025-03-13 17:53:00,308 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7498 secs
2025-03-13 17:53:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 88380 [episode count 5/20]
[retrieval_preprocessing] for episode 65830 [episode count 6/20], we have num_retrieval=np.int64(4659) num_query=np.int64(263)
2025-03-13 17:53:03,274 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:03,923 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:03
2025-03-13 17:53:03,923 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1184.50it/s]
2025-03-13 17:53:03,950 [INFO]: There are 4659 embeddings of dim 49152
2025-03-13 17:53:03,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:53:03,950 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:03
2025-03-13 17:53:03,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:03,950 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:53:03,950 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:03,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:03,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:03
2025-03-13 17:53:03,950 [INFO]: 961.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:03,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:03,950 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:03
2025-03-13 17:53:03,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:03,950 [INFO]: 	Creating the index 03/13/2025, 17:53:03
2025-03-13 17:53:03,950 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:03
2025-03-13 17:53:03,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:53:03,952 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:03
2025-03-13 17:53:03,952 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:53:03,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.36it/s] 32%|███▏      | 6/19 [00:00<00:00, 26.00it/s] 58%|█████▊    | 11/19 [00:00<00:00, 34.26it/s] 84%|████████▍ | 16/19 [00:00<00:00, 38.40it/s]100%|██████████| 19/19 [00:03<00:00,  4.85it/s]
2025-03-13 17:53:07,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:07
2025-03-13 17:53:52,998 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1232 secs
2025-03-13 17:53:52,999 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 17:53:52,999 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-13 17:54:18,058 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0583 secs
2025-03-13 17:54:18,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.1103 secs
2025-03-13 17:54:18,062 [INFO]: {
2025-03-13 17:54:18,062 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:18,062 [INFO]: 	index_param: efSearch=244
2025-03-13 17:54:18,062 [INFO]: 	index_path: knn.index
2025-03-13 17:54:18,062 [INFO]: 	size in bytes: 916630210
2025-03-13 17:54:18,062 [INFO]: 	avg_search_speed_ms: 14.06627946530643
2025-03-13 17:54:18,062 [INFO]: 	99p_search_speed_ms: 24.786306452006098
2025-03-13 17:54:18,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:18,063 [INFO]: 	nb vectors: 4659
2025-03-13 17:54:18,063 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:18,063 [INFO]: 	compression ratio: 0.999308840148308
2025-03-13 17:54:18,063 [INFO]: }
2025-03-13 17:54:18,063 [INFO]: 	>>> Finished "Creating the index" in 74.1122 secs
2025-03-13 17:54:18,063 [INFO]: >>> Finished "Launching the whole pipeline" in 74.1396 secs
2025-03-13 17:54:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 65830 [episode count 6/20]
[retrieval_preprocessing] for episode 33073 [episode count 7/20], we have num_retrieval=np.int64(4630) num_query=np.int64(292)
2025-03-13 17:54:21,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:22,343 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:22
2025-03-13 17:54:22,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.47it/s]
2025-03-13 17:54:22,488 [INFO]: There are 4630 embeddings of dim 49152
2025-03-13 17:54:22,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1454 secs
2025-03-13 17:54:22,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:22,489 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:54:22,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:22,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:54:22,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,489 [INFO]: 955.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:22,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:54:22,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:22
2025-03-13 17:54:22,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:22,490 [INFO]: 	Creating the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:22
2025-03-13 17:54:22,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:54:22,492 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:22
2025-03-13 17:54:22,492 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:54:22,492 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.42it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.38it/s] 58%|█████▊    | 11/19 [00:00<00:00, 35.31it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.01it/s]100%|██████████| 19/19 [00:03<00:00,  5.15it/s]
2025-03-13 17:54:26,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:26
2025-03-13 17:55:11,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9822 secs
2025-03-13 17:55:11,167 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:55:11,167 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.26it/s]
2025-03-13 17:55:39,381 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2138 secs
2025-03-13 17:55:39,384 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8920 secs
2025-03-13 17:55:39,385 [INFO]: {
2025-03-13 17:55:39,385 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:39,385 [INFO]: 	index_param: efSearch=206
2025-03-13 17:55:39,385 [INFO]: 	index_path: knn.index
2025-03-13 17:55:39,385 [INFO]: 	size in bytes: 910924570
2025-03-13 17:55:39,385 [INFO]: 	avg_search_speed_ms: 11.403981109862317
2025-03-13 17:55:39,385 [INFO]: 	99p_search_speed_ms: 18.24858189560473
2025-03-13 17:55:39,385 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:39,385 [INFO]: 	nb vectors: 4630
2025-03-13 17:55:39,385 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:39,385 [INFO]: 	compression ratio: 0.9993089109452827
2025-03-13 17:55:39,385 [INFO]: }
2025-03-13 17:55:39,385 [INFO]: 	>>> Finished "Creating the index" in 76.8951 secs
2025-03-13 17:55:39,385 [INFO]: >>> Finished "Launching the whole pipeline" in 77.0417 secs
2025-03-13 17:55:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 33073 [episode count 7/20]
[retrieval_preprocessing] for episode 29011 [episode count 8/20], we have num_retrieval=np.int64(4651) num_query=np.int64(271)
2025-03-13 17:55:43,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:44,871 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:44
2025-03-13 17:55:44,871 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1128.41it/s]
2025-03-13 17:55:44,896 [INFO]: There are 4651 embeddings of dim 49152
2025-03-13 17:55:44,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 17:55:44,897 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:44
2025-03-13 17:55:44,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:44,897 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:55:44,897 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:44,897 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:55:44,897 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:44
2025-03-13 17:55:44,898 [INFO]: 959.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:44,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:55:44,898 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:44
2025-03-13 17:55:44,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:44,899 [INFO]: 	Creating the index 03/13/2025, 17:55:44
2025-03-13 17:55:44,899 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:44
2025-03-13 17:55:44,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:55:44,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:44
2025-03-13 17:55:44,902 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:55:44,903 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.30it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.71it/s] 63%|██████▎   | 12/19 [00:00<00:00, 38.78it/s] 89%|████████▉ | 17/19 [00:00<00:00, 40.30it/s]100%|██████████| 19/19 [00:04<00:00,  4.60it/s]
2025-03-13 17:55:49,037 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:49
2025-03-13 17:56:38,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5019 secs
2025-03-13 17:56:38,539 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 17:56:38,540 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.15it/s]
2025-03-13 17:57:07,631 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0911 secs
2025-03-13 17:57:07,633 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.7311 secs
2025-03-13 17:57:07,633 [INFO]: {
2025-03-13 17:57:07,633 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:07,634 [INFO]: 	index_param: efSearch=187
2025-03-13 17:57:07,634 [INFO]: 	index_path: knn.index
2025-03-13 17:57:07,634 [INFO]: 	size in bytes: 915056290
2025-03-13 17:57:07,634 [INFO]: 	avg_search_speed_ms: 7.792834896632033
2025-03-13 17:57:07,634 [INFO]: 	99p_search_speed_ms: 10.549684180878106
2025-03-13 17:57:07,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:07,634 [INFO]: 	nb vectors: 4651
2025-03-13 17:57:07,634 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:07,634 [INFO]: 	compression ratio: 0.9993088053632198
2025-03-13 17:57:07,634 [INFO]: }
2025-03-13 17:57:07,634 [INFO]: 	>>> Finished "Creating the index" in 82.7348 secs
2025-03-13 17:57:07,634 [INFO]: >>> Finished "Launching the whole pipeline" in 82.7627 secs
2025-03-13 17:57:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 29011 [episode count 8/20]
[retrieval_preprocessing] for episode 59657 [episode count 9/20], we have num_retrieval=np.int64(4685) num_query=np.int64(237)
2025-03-13 17:57:09,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:10,355 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:10
2025-03-13 17:57:10,356 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1228.56it/s]
2025-03-13 17:57:10,381 [INFO]: There are 4685 embeddings of dim 49152
2025-03-13 17:57:10,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:57:10,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:10
2025-03-13 17:57:10,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:10,382 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:57:10,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:10,382 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:10,382 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:10
2025-03-13 17:57:10,382 [INFO]: 966.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:10,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:10,382 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:10
2025-03-13 17:57:10,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:10,382 [INFO]: 	Creating the index 03/13/2025, 17:57:10
2025-03-13 17:57:10,382 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:10
2025-03-13 17:57:10,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:57:10,384 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:10
2025-03-13 17:57:10,384 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:57:10,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.42it/s] 37%|███▋      | 7/19 [00:00<00:00, 32.85it/s] 68%|██████▊   | 13/19 [00:00<00:00, 41.07it/s]100%|██████████| 19/19 [00:03<00:00,  4.19it/s]100%|██████████| 19/19 [00:03<00:00,  5.59it/s]
2025-03-13 17:57:13,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:13
2025-03-13 17:58:00,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5556 secs
2025-03-13 17:58:00,344 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:58:00,344 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.63it/s]
2025-03-13 17:58:28,575 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2312 secs
2025-03-13 17:58:29,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.0155 secs
2025-03-13 17:58:29,399 [INFO]: {
2025-03-13 17:58:29,400 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:29,400 [INFO]: 	index_param: efSearch=212
2025-03-13 17:58:29,400 [INFO]: 	index_path: knn.index
2025-03-13 17:58:29,400 [INFO]: 	size in bytes: 921745630
2025-03-13 17:58:29,400 [INFO]: 	avg_search_speed_ms: 9.778685657715357
2025-03-13 17:58:29,400 [INFO]: 	99p_search_speed_ms: 12.702623903751373
2025-03-13 17:58:29,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:29,400 [INFO]: 	nb vectors: 4685
2025-03-13 17:58:29,400 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:29,400 [INFO]: 	compression ratio: 0.9993087572327303
2025-03-13 17:58:29,400 [INFO]: }
2025-03-13 17:58:29,400 [INFO]: 	>>> Finished "Creating the index" in 79.0180 secs
2025-03-13 17:58:29,400 [INFO]: >>> Finished "Launching the whole pipeline" in 79.0447 secs
2025-03-13 17:58:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 59657 [episode count 9/20]
[retrieval_preprocessing] for episode 57642 [episode count 10/20], we have num_retrieval=np.int64(4714) num_query=np.int64(208)
2025-03-13 17:58:31,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:32,410 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:32
2025-03-13 17:58:32,411 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.87it/s]
2025-03-13 17:58:32,443 [INFO]: There are 4714 embeddings of dim 49152
2025-03-13 17:58:32,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 17:58:32,443 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:32
2025-03-13 17:58:32,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:32,443 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:58:32,443 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:32,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:32,443 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:32
2025-03-13 17:58:32,443 [INFO]: 972.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:32,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:58:32,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:32
2025-03-13 17:58:32,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:32,444 [INFO]: 	Creating the index 03/13/2025, 17:58:32
2025-03-13 17:58:32,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:32
2025-03-13 17:58:32,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:58:32,445 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:32
2025-03-13 17:58:32,445 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:58:32,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.14it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.69it/s] 58%|█████▊    | 11/19 [00:00<00:00, 35.60it/s] 84%|████████▍ | 16/19 [00:00<00:00, 38.78it/s]100%|██████████| 19/19 [00:04<00:00,  4.37it/s]
2025-03-13 17:58:36,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:36
2025-03-13 17:59:20,849 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0492 secs
2025-03-13 17:59:20,850 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:59:20,850 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-13 17:59:53,034 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1836 secs
2025-03-13 17:59:53,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.5919 secs
2025-03-13 17:59:53,037 [INFO]: {
2025-03-13 17:59:53,037 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:53,037 [INFO]: 	index_param: efSearch=200
2025-03-13 17:59:53,037 [INFO]: 	index_path: knn.index
2025-03-13 17:59:53,037 [INFO]: 	size in bytes: 927451330
2025-03-13 17:59:53,037 [INFO]: 	avg_search_speed_ms: 9.67194917057848
2025-03-13 17:59:53,037 [INFO]: 	99p_search_speed_ms: 14.957088606897733
2025-03-13 17:59:53,037 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:53,037 [INFO]: 	nb vectors: 4714
2025-03-13 17:59:53,037 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:53,037 [INFO]: 	compression ratio: 0.9993086235587155
2025-03-13 17:59:53,037 [INFO]: }
2025-03-13 17:59:53,037 [INFO]: 	>>> Finished "Creating the index" in 80.5935 secs
2025-03-13 17:59:53,037 [INFO]: >>> Finished "Launching the whole pipeline" in 80.6266 secs
2025-03-13 17:59:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 57642 [episode count 10/20]
[retrieval_preprocessing] for episode 59991 [episode count 11/20], we have num_retrieval=np.int64(4707) num_query=np.int64(215)
2025-03-13 17:59:55,311 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:56,835 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:56
2025-03-13 17:59:56,835 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 17:59:56,861 [INFO]: There are 4707 embeddings of dim 49152
2025-03-13 17:59:56,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:59:56,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:56
2025-03-13 17:59:56,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:56,861 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 17:59:56,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:56,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:56,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:56
2025-03-13 17:59:56,861 [INFO]: 971.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:56,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:56,861 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:56
2025-03-13 17:59:56,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:56,862 [INFO]: 	Creating the index 03/13/2025, 17:59:56
2025-03-13 17:59:56,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:56
2025-03-13 17:59:56,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:59:56,863 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:56
2025-03-13 17:59:56,863 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 17:59:56,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.31it/s] 42%|████▏     | 8/19 [00:00<00:00, 38.62it/s] 74%|███████▎  | 14/19 [00:00<00:00, 44.15it/s]100%|██████████| 19/19 [00:04<00:00,  2.77it/s]100%|██████████| 19/19 [00:04<00:00,  3.96it/s]
2025-03-13 18:00:01,662 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:01
2025-03-13 18:00:51,045 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.3817 secs
2025-03-13 18:00:51,045 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 18:00:51,045 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 18:01:15,134 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0892 secs
2025-03-13 18:01:15,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2742 secs
2025-03-13 18:01:15,137 [INFO]: {
2025-03-13 18:01:15,137 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:15,137 [INFO]: 	index_param: efSearch=194
2025-03-13 18:01:15,137 [INFO]: 	index_path: knn.index
2025-03-13 18:01:15,137 [INFO]: 	size in bytes: 926074090
2025-03-13 18:01:15,137 [INFO]: 	avg_search_speed_ms: 9.50003804502777
2025-03-13 18:01:15,137 [INFO]: 	99p_search_speed_ms: 14.521494898945095
2025-03-13 18:01:15,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:15,137 [INFO]: 	nb vectors: 4707
2025-03-13 18:01:15,137 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:15,137 [INFO]: 	compression ratio: 0.999308657906626
2025-03-13 18:01:15,137 [INFO]: }
2025-03-13 18:01:15,138 [INFO]: 	>>> Finished "Creating the index" in 78.2759 secs
2025-03-13 18:01:15,138 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3026 secs
2025-03-13 18:01:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 59991 [episode count 11/20]
[retrieval_preprocessing] for episode 8656 [episode count 12/20], we have num_retrieval=np.int64(4704) num_query=np.int64(218)
2025-03-13 18:01:17,235 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:18,343 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:18
2025-03-13 18:01:18,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.38it/s]
2025-03-13 18:01:18,368 [INFO]: There are 4704 embeddings of dim 49152
2025-03-13 18:01:18,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:01:18,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:18
2025-03-13 18:01:18,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:18,368 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:01:18,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:18,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:18,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:18
2025-03-13 18:01:18,369 [INFO]: 970.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:18,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:01:18,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:18
2025-03-13 18:01:18,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:18,369 [INFO]: 	Creating the index 03/13/2025, 18:01:18
2025-03-13 18:01:18,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:18
2025-03-13 18:01:18,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:01:18,370 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:18
2025-03-13 18:01:18,370 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:01:18,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.69it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.73it/s] 58%|█████▊    | 11/19 [00:00<00:00, 39.77it/s] 89%|████████▉ | 17/19 [00:00<00:00, 44.80it/s]100%|██████████| 19/19 [00:04<00:00,  4.58it/s]
2025-03-13 18:01:22,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:22
2025-03-13 18:02:09,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4431 secs
2025-03-13 18:02:09,967 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:02:09,967 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.55it/s]
2025-03-13 18:02:38,209 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2425 secs
2025-03-13 18:02:38,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8423 secs
2025-03-13 18:02:38,212 [INFO]: {
2025-03-13 18:02:38,212 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:38,212 [INFO]: 	index_param: efSearch=209
2025-03-13 18:02:38,212 [INFO]: 	index_path: knn.index
2025-03-13 18:02:38,212 [INFO]: 	size in bytes: 925483810
2025-03-13 18:02:38,212 [INFO]: 	avg_search_speed_ms: 10.010164945635262
2025-03-13 18:02:38,212 [INFO]: 	99p_search_speed_ms: 14.257683735340834
2025-03-13 18:02:38,212 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:38,212 [INFO]: 	nb vectors: 4704
2025-03-13 18:02:38,212 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:38,212 [INFO]: 	compression ratio: 0.9993087096791029
2025-03-13 18:02:38,213 [INFO]: }
2025-03-13 18:02:38,213 [INFO]: 	>>> Finished "Creating the index" in 79.8437 secs
2025-03-13 18:02:38,213 [INFO]: >>> Finished "Launching the whole pipeline" in 79.8693 secs
2025-03-13 18:02:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 8656 [episode count 12/20]
[retrieval_preprocessing] for episode 33632 [episode count 13/20], we have num_retrieval=np.int64(4708) num_query=np.int64(214)
2025-03-13 18:02:40,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:40,960 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:40
2025-03-13 18:02:40,960 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.17it/s]
2025-03-13 18:02:40,986 [INFO]: There are 4708 embeddings of dim 49152
2025-03-13 18:02:40,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:02:40,987 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:40
2025-03-13 18:02:40,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:40,987 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:02:40,987 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:40,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:40,987 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:40
2025-03-13 18:02:40,987 [INFO]: 971.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:40,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:40,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:40
2025-03-13 18:02:40,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:40,987 [INFO]: 	Creating the index 03/13/2025, 18:02:40
2025-03-13 18:02:40,987 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:40
2025-03-13 18:02:40,988 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:02:40,988 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:40
2025-03-13 18:02:40,988 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:02:40,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.26it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.88it/s] 53%|█████▎    | 10/19 [00:00<00:00, 32.21it/s] 79%|███████▉  | 15/19 [00:00<00:00, 36.03it/s]100%|██████████| 19/19 [00:04<00:00,  2.65it/s]100%|██████████| 19/19 [00:04<00:00,  4.10it/s]
2025-03-13 18:02:45,624 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:45
2025-03-13 18:03:37,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2277 secs
2025-03-13 18:03:37,852 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 18:03:37,852 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.41it/s]
2025-03-13 18:04:02,664 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8123 secs
2025-03-13 18:04:02,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6787 secs
2025-03-13 18:04:02,667 [INFO]: {
2025-03-13 18:04:02,667 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:02,667 [INFO]: 	index_param: efSearch=192
2025-03-13 18:04:02,667 [INFO]: 	index_path: knn.index
2025-03-13 18:04:02,667 [INFO]: 	size in bytes: 926270890
2025-03-13 18:04:02,667 [INFO]: 	avg_search_speed_ms: 8.244420649170545
2025-03-13 18:04:02,667 [INFO]: 	99p_search_speed_ms: 11.568128336220978
2025-03-13 18:04:02,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:02,667 [INFO]: 	nb vectors: 4708
2025-03-13 18:04:02,667 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:02,667 [INFO]: 	compression ratio: 0.9993085975097414
2025-03-13 18:04:02,667 [INFO]: }
2025-03-13 18:04:02,668 [INFO]: 	>>> Finished "Creating the index" in 81.6801 secs
2025-03-13 18:04:02,668 [INFO]: >>> Finished "Launching the whole pipeline" in 81.7073 secs
2025-03-13 18:04:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 33632 [episode count 13/20]
[retrieval_preprocessing] for episode 80740 [episode count 14/20], we have num_retrieval=np.int64(4684) num_query=np.int64(238)
2025-03-13 18:04:04,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:05,653 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:05
2025-03-13 18:04:05,653 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1725.34it/s]
2025-03-13 18:04:06,467 [INFO]: There are 4684 embeddings of dim 49152
2025-03-13 18:04:06,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.8142 secs
2025-03-13 18:04:06,467 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:06
2025-03-13 18:04:06,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:06,468 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:04:06,468 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:06,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:04:06,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:06
2025-03-13 18:04:06,469 [INFO]: 966.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:06,469 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:04:06,469 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:06
2025-03-13 18:04:06,469 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:06,469 [INFO]: 	Creating the index 03/13/2025, 18:04:06
2025-03-13 18:04:06,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:06
2025-03-13 18:04:06,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:04:06,473 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:06
2025-03-13 18:04:06,473 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:04:06,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.61it/s] 42%|████▏     | 8/19 [00:00<00:00, 38.73it/s] 74%|███████▎  | 14/19 [00:00<00:00, 45.03it/s]100%|██████████| 19/19 [00:04<00:00,  2.96it/s]100%|██████████| 19/19 [00:04<00:00,  4.22it/s]
2025-03-13 18:04:10,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:10
2025-03-13 18:04:55,950 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9654 secs
2025-03-13 18:04:55,950 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:04:55,950 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 18:05:29,639 [INFO]: 	>>> Finished "Compute fast metrics" in 33.6882 secs
2025-03-13 18:05:29,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1692 secs
2025-03-13 18:05:29,642 [INFO]: {
2025-03-13 18:05:29,642 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:29,642 [INFO]: 	index_param: efSearch=231
2025-03-13 18:05:29,642 [INFO]: 	index_path: knn.index
2025-03-13 18:05:29,642 [INFO]: 	size in bytes: 921548890
2025-03-13 18:05:29,642 [INFO]: 	avg_search_speed_ms: 11.22615246601846
2025-03-13 18:05:29,642 [INFO]: 	99p_search_speed_ms: 15.902195102535194
2025-03-13 18:05:29,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:29,642 [INFO]: 	nb vectors: 4684
2025-03-13 18:05:29,642 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:29,642 [INFO]: 	compression ratio: 0.9993087528975266
2025-03-13 18:05:29,642 [INFO]: }
2025-03-13 18:05:29,642 [INFO]: 	>>> Finished "Creating the index" in 83.1730 secs
2025-03-13 18:05:29,642 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9895 secs
2025-03-13 18:05:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 80740 [episode count 14/20]
[retrieval_preprocessing] for episode 33703 [episode count 15/20], we have num_retrieval=np.int64(4596) num_query=np.int64(326)
2025-03-13 18:05:32,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:33,960 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:33
2025-03-13 18:05:33,960 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 912.80it/s]
2025-03-13 18:05:33,986 [INFO]: There are 4596 embeddings of dim 49152
2025-03-13 18:05:33,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:05:33,986 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:33
2025-03-13 18:05:33,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:33,986 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 18:05:33,986 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:33,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:33,987 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:33
2025-03-13 18:05:33,987 [INFO]: 948.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:33,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:05:33,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:33
2025-03-13 18:05:33,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:33,987 [INFO]: 	Creating the index 03/13/2025, 18:05:33
2025-03-13 18:05:33,987 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:33
2025-03-13 18:05:33,988 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:05:33,988 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:33
2025-03-13 18:05:33,988 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:05:33,988 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.72it/s] 32%|███▏      | 6/19 [00:00<00:00, 25.30it/s] 58%|█████▊    | 11/19 [00:00<00:00, 32.30it/s] 79%|███████▉  | 15/19 [00:00<00:00, 34.75it/s]100%|██████████| 19/19 [00:03<00:00,  3.05it/s]100%|██████████| 19/19 [00:03<00:00,  4.80it/s]
2025-03-13 18:05:37,948 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:37
2025-03-13 18:06:23,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6701 secs
2025-03-13 18:06:23,619 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 18:06:23,619 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.30it/s]
2025-03-13 18:06:56,493 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8741 secs
2025-03-13 18:06:56,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.5085 secs
2025-03-13 18:06:56,497 [INFO]: {
2025-03-13 18:06:56,497 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:56,497 [INFO]: 	index_param: efSearch=179
2025-03-13 18:06:56,497 [INFO]: 	index_path: knn.index
2025-03-13 18:06:56,497 [INFO]: 	size in bytes: 904235350
2025-03-13 18:06:56,497 [INFO]: 	avg_search_speed_ms: 10.027842545029946
2025-03-13 18:06:56,497 [INFO]: 	99p_search_speed_ms: 15.410628663375972
2025-03-13 18:06:56,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:56,497 [INFO]: 	nb vectors: 4596
2025-03-13 18:06:56,497 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:56,497 [INFO]: 	compression ratio: 0.9993088281717807
2025-03-13 18:06:56,497 [INFO]: }
2025-03-13 18:06:56,497 [INFO]: 	>>> Finished "Creating the index" in 82.5100 secs
2025-03-13 18:06:56,497 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5372 secs
2025-03-13 18:06:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 33703 [episode count 15/20]
[retrieval_preprocessing] for episode 66474 [episode count 16/20], we have num_retrieval=np.int64(4635) num_query=np.int64(287)
2025-03-13 18:07:00,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:01,282 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:01
2025-03-13 18:07:01,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.24it/s]
2025-03-13 18:07:01,314 [INFO]: There are 4635 embeddings of dim 49152
2025-03-13 18:07:01,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 18:07:01,316 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:01
2025-03-13 18:07:01,316 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:01,316 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 18:07:01,316 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:01,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:07:01,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:01
2025-03-13 18:07:01,317 [INFO]: 956.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:01,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:07:01,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:01
2025-03-13 18:07:01,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:01,318 [INFO]: 	Creating the index 03/13/2025, 18:07:01
2025-03-13 18:07:01,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:01
2025-03-13 18:07:01,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 18:07:01,322 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:01
2025-03-13 18:07:01,322 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 18:07:01,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.24it/s] 21%|██        | 4/19 [00:00<00:00, 15.14it/s] 37%|███▋      | 7/19 [00:00<00:00, 20.55it/s] 58%|█████▊    | 11/19 [00:00<00:00, 24.47it/s] 79%|███████▉  | 15/19 [00:00<00:00, 26.63it/s] 95%|█████████▍| 18/19 [00:00<00:00, 27.21it/s]100%|██████████| 19/19 [00:05<00:00,  3.73it/s]
2025-03-13 18:07:06,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:06
2025-03-13 18:07:55,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4912 secs
2025-03-13 18:07:55,917 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 18:07:55,917 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-13 18:08:23,015 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0976 secs
2025-03-13 18:08:23,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6952 secs
2025-03-13 18:08:23,018 [INFO]: {
2025-03-13 18:08:23,018 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:23,018 [INFO]: 	index_param: efSearch=208
2025-03-13 18:08:23,018 [INFO]: 	index_path: knn.index
2025-03-13 18:08:23,018 [INFO]: 	size in bytes: 911908390
2025-03-13 18:08:23,018 [INFO]: 	avg_search_speed_ms: 10.92944984105441
2025-03-13 18:08:23,018 [INFO]: 	99p_search_speed_ms: 19.68072097748518
2025-03-13 18:08:23,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:23,018 [INFO]: 	nb vectors: 4635
2025-03-13 18:08:23,018 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:23,018 [INFO]: 	compression ratio: 0.9993088011834171
2025-03-13 18:08:23,018 [INFO]: }
2025-03-13 18:08:23,018 [INFO]: 	>>> Finished "Creating the index" in 81.6996 secs
2025-03-13 18:08:23,018 [INFO]: >>> Finished "Launching the whole pipeline" in 81.7359 secs
2025-03-13 18:08:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 66474 [episode count 16/20]
[retrieval_preprocessing] for episode 59784 [episode count 17/20], we have num_retrieval=np.int64(4682) num_query=np.int64(240)
2025-03-13 18:08:25,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:26,998 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:26
2025-03-13 18:08:26,998 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.12it/s]
2025-03-13 18:08:27,024 [INFO]: There are 4682 embeddings of dim 49152
2025-03-13 18:08:27,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 18:08:27,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:27
2025-03-13 18:08:27,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:27,024 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:08:27,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:27,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:27,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:27
2025-03-13 18:08:27,024 [INFO]: 966.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:27,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:08:27,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:27
2025-03-13 18:08:27,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:27,024 [INFO]: 	Creating the index 03/13/2025, 18:08:27
2025-03-13 18:08:27,025 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:27
2025-03-13 18:08:27,026 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:08:27,026 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:27
2025-03-13 18:08:27,026 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:08:27,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.84it/s] 42%|████▏     | 8/19 [00:00<00:00, 38.92it/s] 74%|███████▎  | 14/19 [00:00<00:00, 45.41it/s]100%|██████████| 19/19 [00:03<00:00,  3.43it/s]100%|██████████| 19/19 [00:03<00:00,  4.87it/s]
2025-03-13 18:08:30,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:30
2025-03-13 18:09:14,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8642 secs
2025-03-13 18:09:14,825 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:09:14,825 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 18:09:48,159 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3341 secs
2025-03-13 18:09:48,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.1371 secs
2025-03-13 18:09:48,163 [INFO]: {
2025-03-13 18:09:48,163 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:48,163 [INFO]: 	index_param: efSearch=203
2025-03-13 18:09:48,163 [INFO]: 	index_path: knn.index
2025-03-13 18:09:48,163 [INFO]: 	size in bytes: 921155410
2025-03-13 18:09:48,163 [INFO]: 	avg_search_speed_ms: 10.512813840298419
2025-03-13 18:09:48,163 [INFO]: 	99p_search_speed_ms: 16.18442707695067
2025-03-13 18:09:48,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:48,163 [INFO]: 	nb vectors: 4682
2025-03-13 18:09:48,163 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:48,163 [INFO]: 	compression ratio: 0.9993087442215641
2025-03-13 18:09:48,163 [INFO]: }
2025-03-13 18:09:48,163 [INFO]: 	>>> Finished "Creating the index" in 81.1388 secs
2025-03-13 18:09:48,163 [INFO]: >>> Finished "Launching the whole pipeline" in 81.1653 secs
2025-03-13 18:09:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 59784 [episode count 17/20]
[retrieval_preprocessing] for episode 59818 [episode count 18/20], we have num_retrieval=np.int64(4664) num_query=np.int64(258)
2025-03-13 18:09:51,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:51,780 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:51
2025-03-13 18:09:51,780 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.90it/s]
2025-03-13 18:09:51,812 [INFO]: There are 4664 embeddings of dim 49152
2025-03-13 18:09:51,813 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 18:09:51,813 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:51
2025-03-13 18:09:51,813 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:51,813 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:09:51,813 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:51,813 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:09:51,814 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:51
2025-03-13 18:09:51,814 [INFO]: 962.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:51,814 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:09:51,814 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:51
2025-03-13 18:09:51,815 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:51,815 [INFO]: 	Creating the index 03/13/2025, 18:09:51
2025-03-13 18:09:51,815 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:51
2025-03-13 18:09:51,818 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 18:09:51,819 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:51
2025-03-13 18:09:51,819 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:09:51,819 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.81it/s] 37%|███▋      | 7/19 [00:00<00:00, 31.64it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.11it/s] 89%|████████▉ | 17/19 [00:00<00:00, 40.11it/s]100%|██████████| 19/19 [00:04<00:00,  4.19it/s]
2025-03-13 18:09:56,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:56
2025-03-13 18:10:44,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8982 secs
2025-03-13 18:10:44,258 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 18:10:44,258 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.47it/s]
2025-03-13 18:11:09,918 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6599 secs
2025-03-13 18:11:09,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1018 secs
2025-03-13 18:11:09,921 [INFO]: {
2025-03-13 18:11:09,921 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:09,921 [INFO]: 	index_param: efSearch=198
2025-03-13 18:11:09,921 [INFO]: 	index_path: knn.index
2025-03-13 18:11:09,921 [INFO]: 	size in bytes: 917614030
2025-03-13 18:11:09,921 [INFO]: 	avg_search_speed_ms: 10.324771182036837
2025-03-13 18:11:09,921 [INFO]: 	99p_search_speed_ms: 15.480392938479776
2025-03-13 18:11:09,921 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:09,921 [INFO]: 	nb vectors: 4664
2025-03-13 18:11:09,921 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:09,921 [INFO]: 	compression ratio: 0.9993087311448365
2025-03-13 18:11:09,921 [INFO]: }
2025-03-13 18:11:09,921 [INFO]: 	>>> Finished "Creating the index" in 78.1062 secs
2025-03-13 18:11:09,921 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1411 secs
2025-03-13 18:11:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 59818 [episode count 18/20]
[retrieval_preprocessing] for episode 34090 [episode count 19/20], we have num_retrieval=np.int64(4714) num_query=np.int64(208)
2025-03-13 18:11:12,210 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:12,899 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:12
2025-03-13 18:11:12,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 968.66it/s]
2025-03-13 18:11:12,927 [INFO]: There are 4714 embeddings of dim 49152
2025-03-13 18:11:12,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 18:11:12,928 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:12
2025-03-13 18:11:12,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:12,928 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:11:12,928 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:12,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:12,928 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:12
2025-03-13 18:11:12,928 [INFO]: 972.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:12,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:12,928 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:12
2025-03-13 18:11:12,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:12,928 [INFO]: 	Creating the index 03/13/2025, 18:11:12
2025-03-13 18:11:12,928 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:12
2025-03-13 18:11:12,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:11:12,929 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:12
2025-03-13 18:11:12,929 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:11:12,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.69it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.95it/s] 53%|█████▎    | 10/19 [00:00<00:00, 31.85it/s] 74%|███████▎  | 14/19 [00:00<00:00, 34.72it/s]100%|██████████| 19/19 [00:03<00:00,  3.19it/s]100%|██████████| 19/19 [00:03<00:00,  4.78it/s]
2025-03-13 18:11:16,911 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:16
2025-03-13 18:12:05,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0340 secs
2025-03-13 18:12:05,946 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 18:12:05,946 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.14it/s]
2025-03-13 18:12:30,548 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6015 secs
2025-03-13 18:12:31,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7945 secs
2025-03-13 18:12:31,724 [INFO]: {
2025-03-13 18:12:31,724 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:31,724 [INFO]: 	index_param: efSearch=159
2025-03-13 18:12:31,724 [INFO]: 	index_path: knn.index
2025-03-13 18:12:31,724 [INFO]: 	size in bytes: 927451330
2025-03-13 18:12:31,724 [INFO]: 	avg_search_speed_ms: 9.67835565255405
2025-03-13 18:12:31,724 [INFO]: 	99p_search_speed_ms: 14.280656995251775
2025-03-13 18:12:31,725 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:31,725 [INFO]: 	nb vectors: 4714
2025-03-13 18:12:31,725 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:31,725 [INFO]: 	compression ratio: 0.9993086235587155
2025-03-13 18:12:31,725 [INFO]: }
2025-03-13 18:12:31,725 [INFO]: 	>>> Finished "Creating the index" in 78.7967 secs
2025-03-13 18:12:31,725 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8256 secs
2025-03-13 18:12:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 34090 [episode count 19/20]
2025-03-13 18:12:33: [retrieval_preprocessing] finished for 1656877278_put_towel_in_bowl [chosen_id count 6/196]
2025-03-13 18:12:35: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_remove_can_from_bowl [chosen_id count 7/196]
2025-03-13 18:12:35: [retrieval_preprocessing] we have num_total=3994 embedding_dim=49152
[retrieval_preprocessing] for episode 22614 [episode count 0/20], we have num_retrieval=np.int64(3774) num_query=np.int64(220)
2025-03-13 18:12:35,387 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:36,082 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:36
2025-03-13 18:12:36,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1743.27it/s]
2025-03-13 18:12:36,111 [INFO]: There are 3774 embeddings of dim 49152
2025-03-13 18:12:36,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 18:12:36,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:36
2025-03-13 18:12:36,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:36,113 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:12:36,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:36,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:12:36,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:36
2025-03-13 18:12:36,113 [INFO]: 778.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:36,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:12:36,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:36
2025-03-13 18:12:36,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:36,114 [INFO]: 	Creating the index 03/13/2025, 18:12:36
2025-03-13 18:12:36,114 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:36
2025-03-13 18:12:36,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:12:36,118 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:36
2025-03-13 18:12:36,118 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:12:36,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.71it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.74it/s] 80%|████████  | 12/15 [00:00<00:00, 38.72it/s]100%|██████████| 15/15 [00:03<00:00,  4.94it/s]
2025-03-13 18:12:39,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:39
2025-03-13 18:13:28,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7481 secs
2025-03-13 18:13:28,192 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 18:13:28,192 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 18:13:58,497 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3047 secs
2025-03-13 18:13:58,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3819 secs
2025-03-13 18:13:58,500 [INFO]: {
2025-03-13 18:13:58,500 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:58,500 [INFO]: 	index_param: efSearch=186
2025-03-13 18:13:58,500 [INFO]: 	index_path: knn.index
2025-03-13 18:13:58,500 [INFO]: 	size in bytes: 742511530
2025-03-13 18:13:58,500 [INFO]: 	avg_search_speed_ms: 8.898957493695102
2025-03-13 18:13:58,500 [INFO]: 	99p_search_speed_ms: 12.687735862564296
2025-03-13 18:13:58,500 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:58,500 [INFO]: 	nb vectors: 3774
2025-03-13 18:13:58,500 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:58,500 [INFO]: 	compression ratio: 0.9993091851381756
2025-03-13 18:13:58,500 [INFO]: }
2025-03-13 18:13:58,500 [INFO]: 	>>> Finished "Creating the index" in 82.3860 secs
2025-03-13 18:13:58,500 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4178 secs
2025-03-13 18:13:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 22614 [episode count 0/20]
[retrieval_preprocessing] for episode 82014 [episode count 1/20], we have num_retrieval=np.int64(3808) num_query=np.int64(186)
2025-03-13 18:14:00,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:01,152 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:01
2025-03-13 18:14:01,152 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.35it/s]
2025-03-13 18:14:01,179 [INFO]: There are 3808 embeddings of dim 49152
2025-03-13 18:14:01,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:14:01,180 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:01
2025-03-13 18:14:01,180 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:01,180 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:14:01,180 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:01,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:01,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:01
2025-03-13 18:14:01,180 [INFO]: 785.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:01,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:14:01,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:01
2025-03-13 18:14:01,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:01,180 [INFO]: 	Creating the index 03/13/2025, 18:14:01
2025-03-13 18:14:01,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:01
2025-03-13 18:14:01,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:14:01,181 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:01
2025-03-13 18:14:01,181 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:14:01,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.86it/s] 33%|███▎      | 5/15 [00:00<00:00, 24.35it/s] 67%|██████▋   | 10/15 [00:00<00:00, 33.76it/s]100%|██████████| 15/15 [00:03<00:00,  3.63it/s]100%|██████████| 15/15 [00:03<00:00,  4.78it/s]
2025-03-13 18:14:04,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:04
2025-03-13 18:14:49,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1685 secs
2025-03-13 18:14:49,496 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 18:14:49,496 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.06it/s]
2025-03-13 18:15:24,850 [INFO]: 	>>> Finished "Compute fast metrics" in 35.3539 secs
2025-03-13 18:15:24,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6708 secs
2025-03-13 18:15:24,852 [INFO]: {
2025-03-13 18:15:24,852 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:24,852 [INFO]: 	index_param: efSearch=129
2025-03-13 18:15:24,853 [INFO]: 	index_path: knn.index
2025-03-13 18:15:24,853 [INFO]: 	size in bytes: 749200930
2025-03-13 18:15:24,853 [INFO]: 	avg_search_speed_ms: 6.643703003008649
2025-03-13 18:15:24,853 [INFO]: 	99p_search_speed_ms: 8.92955250106752
2025-03-13 18:15:24,853 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:24,853 [INFO]: 	nb vectors: 3808
2025-03-13 18:15:24,853 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:24,853 [INFO]: 	compression ratio: 0.9993090425021229
2025-03-13 18:15:24,853 [INFO]: }
2025-03-13 18:15:24,853 [INFO]: 	>>> Finished "Creating the index" in 83.6723 secs
2025-03-13 18:15:24,853 [INFO]: >>> Finished "Launching the whole pipeline" in 83.7004 secs
2025-03-13 18:15:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 82014 [episode count 1/20]
[retrieval_preprocessing] for episode 12411 [episode count 2/20], we have num_retrieval=np.int64(3793) num_query=np.int64(201)
2025-03-13 18:15:29,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:29,992 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:29
2025-03-13 18:15:29,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-13 18:15:30,017 [INFO]: There are 3793 embeddings of dim 49152
2025-03-13 18:15:30,018 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:15:30,018 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,018 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:30,018 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:15:30,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:30,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:30,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,018 [INFO]: 782.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:30,018 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:30,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:30
2025-03-13 18:15:30,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:30,018 [INFO]: 	Creating the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:30
2025-03-13 18:15:30,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:15:30,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,019 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:15:30,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.65it/s] 40%|████      | 6/15 [00:00<00:00, 27.48it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.57it/s]100%|██████████| 15/15 [00:04<00:00,  2.40it/s]100%|██████████| 15/15 [00:04<00:00,  3.36it/s]
2025-03-13 18:15:34,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:34
2025-03-13 18:16:22,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9315 secs
2025-03-13 18:16:22,422 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:16:22,422 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.82it/s]
2025-03-13 18:16:53,612 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1902 secs
2025-03-13 18:16:53,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5950 secs
2025-03-13 18:16:53,614 [INFO]: {
2025-03-13 18:16:53,615 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:53,615 [INFO]: 	index_param: efSearch=161
2025-03-13 18:16:53,615 [INFO]: 	index_path: knn.index
2025-03-13 18:16:53,615 [INFO]: 	size in bytes: 746249650
2025-03-13 18:16:53,615 [INFO]: 	avg_search_speed_ms: 6.965813257479859
2025-03-13 18:16:53,615 [INFO]: 	99p_search_speed_ms: 9.547272964846345
2025-03-13 18:16:53,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:53,615 [INFO]: 	nb vectors: 3793
2025-03-13 18:16:53,615 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:53,615 [INFO]: 	compression ratio: 0.999309204366126
2025-03-13 18:16:53,615 [INFO]: }
2025-03-13 18:16:53,615 [INFO]: 	>>> Finished "Creating the index" in 83.5966 secs
2025-03-13 18:16:53,615 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6224 secs
2025-03-13 18:16:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 12411 [episode count 2/20]
[retrieval_preprocessing] for episode 26773 [episode count 3/20], we have num_retrieval=np.int64(3828) num_query=np.int64(166)
2025-03-13 18:17:00,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:00,880 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:00
2025-03-13 18:17:00,880 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.84it/s]
2025-03-13 18:17:01,581 [INFO]: There are 3828 embeddings of dim 49152
2025-03-13 18:17:01,581 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7008 secs
2025-03-13 18:17:01,581 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:01
2025-03-13 18:17:01,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:01,582 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:17:01,582 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:01,582 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:17:01,582 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:01
2025-03-13 18:17:01,582 [INFO]: 790.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:01,582 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:17:01,583 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:01
2025-03-13 18:17:01,583 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:01,583 [INFO]: 	Creating the index 03/13/2025, 18:17:01
2025-03-13 18:17:01,583 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:01
2025-03-13 18:17:01,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:17:01,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:01
2025-03-13 18:17:01,586 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:17:01,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.99it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.15it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.35it/s]100%|██████████| 16/16 [00:03<00:00,  3.96it/s]100%|██████████| 16/16 [00:03<00:00,  5.30it/s]
2025-03-13 18:17:04,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:04
2025-03-13 18:17:50,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9706 secs
2025-03-13 18:17:50,583 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 18:17:50,583 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-13 18:18:09,901 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3183 secs
2025-03-13 18:18:09,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3181 secs
2025-03-13 18:18:09,904 [INFO]: {
2025-03-13 18:18:09,904 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:09,904 [INFO]: 	index_param: efSearch=157
2025-03-13 18:18:09,904 [INFO]: 	index_path: knn.index
2025-03-13 18:18:09,904 [INFO]: 	size in bytes: 753135850
2025-03-13 18:18:09,904 [INFO]: 	avg_search_speed_ms: 8.449702782240205
2025-03-13 18:18:09,904 [INFO]: 	99p_search_speed_ms: 14.395405857358188
2025-03-13 18:18:09,904 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:09,904 [INFO]: 	nb vectors: 3828
2025-03-13 18:18:09,904 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:09,904 [INFO]: 	compression ratio: 0.9993089878804734
2025-03-13 18:18:09,904 [INFO]: }
2025-03-13 18:18:09,904 [INFO]: 	>>> Finished "Creating the index" in 68.3212 secs
2025-03-13 18:18:09,904 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0238 secs
2025-03-13 18:18:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 26773 [episode count 3/20]
[retrieval_preprocessing] for episode 66012 [episode count 4/20], we have num_retrieval=np.int64(3763) num_query=np.int64(231)
2025-03-13 18:18:11,186 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:12,787 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:12
2025-03-13 18:18:12,787 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2105.57it/s]
2025-03-13 18:18:12,811 [INFO]: There are 3763 embeddings of dim 49152
2025-03-13 18:18:12,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 18:18:12,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:12,812 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:18:12,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:12,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:12,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,812 [INFO]: 776.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:12,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:18:12,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:12
2025-03-13 18:18:12,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:12,812 [INFO]: 	Creating the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:12
2025-03-13 18:18:12,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:18:12,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,813 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:18:12,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.87it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.35it/s] 80%|████████  | 12/15 [00:00<00:00, 40.47it/s]100%|██████████| 15/15 [00:03<00:00,  4.98it/s]
2025-03-13 18:18:15,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:15
2025-03-13 18:18:50,160 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3322 secs
2025-03-13 18:18:50,161 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 18:18:50,161 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-13 18:19:17,631 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4703 secs
2025-03-13 18:19:17,633 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8199 secs
2025-03-13 18:19:17,633 [INFO]: {
2025-03-13 18:19:17,633 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:17,633 [INFO]: 	index_param: efSearch=165
2025-03-13 18:19:17,633 [INFO]: 	index_path: knn.index
2025-03-13 18:19:17,633 [INFO]: 	size in bytes: 740347390
2025-03-13 18:19:17,634 [INFO]: 	avg_search_speed_ms: 9.744296855924988
2025-03-13 18:19:17,634 [INFO]: 	99p_search_speed_ms: 14.561260002665222
2025-03-13 18:19:17,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:17,634 [INFO]: 	nb vectors: 3763
2025-03-13 18:19:17,634 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:17,634 [INFO]: 	compression ratio: 0.9993091270302176
2025-03-13 18:19:17,634 [INFO]: }
2025-03-13 18:19:17,634 [INFO]: 	>>> Finished "Creating the index" in 64.8217 secs
2025-03-13 18:19:17,634 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8469 secs
2025-03-13 18:19:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 66012 [episode count 4/20]
[retrieval_preprocessing] for episode 62231 [episode count 5/20], we have num_retrieval=np.int64(3805) num_query=np.int64(189)
2025-03-13 18:19:19,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:20,118 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:20
2025-03-13 18:19:20,118 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.92it/s]
2025-03-13 18:19:20,142 [INFO]: There are 3805 embeddings of dim 49152
2025-03-13 18:19:20,142 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:19:20,142 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:20
2025-03-13 18:19:20,142 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:20,142 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:19:20,142 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:20,142 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:19:20,142 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:20
2025-03-13 18:19:20,142 [INFO]: 785.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:20,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:19:20,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:20
2025-03-13 18:19:20,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:20,143 [INFO]: 	Creating the index 03/13/2025, 18:19:20
2025-03-13 18:19:20,143 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:20
2025-03-13 18:19:20,144 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:19:20,144 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:20
2025-03-13 18:19:20,144 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:19:20,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.40it/s] 40%|████      | 6/15 [00:00<00:00, 26.44it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.43it/s]100%|██████████| 15/15 [00:03<00:00,  3.37it/s]100%|██████████| 15/15 [00:03<00:00,  4.62it/s]
2025-03-13 18:19:23,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:23
2025-03-13 18:20:03,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1727 secs
2025-03-13 18:20:03,566 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 18:20:03,567 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 18:20:28,870 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3034 secs
2025-03-13 18:20:28,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7291 secs
2025-03-13 18:20:28,873 [INFO]: {
2025-03-13 18:20:28,873 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:28,873 [INFO]: 	index_param: efSearch=171
2025-03-13 18:20:28,873 [INFO]: 	index_path: knn.index
2025-03-13 18:20:28,873 [INFO]: 	size in bytes: 748610650
2025-03-13 18:20:28,873 [INFO]: 	avg_search_speed_ms: 11.195370397913246
2025-03-13 18:20:28,873 [INFO]: 	99p_search_speed_ms: 15.135680669918658
2025-03-13 18:20:28,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:28,873 [INFO]: 	nb vectors: 3805
2025-03-13 18:20:28,873 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:28,873 [INFO]: 	compression ratio: 0.9993091068100621
2025-03-13 18:20:28,873 [INFO]: }
2025-03-13 18:20:28,873 [INFO]: 	>>> Finished "Creating the index" in 68.7306 secs
2025-03-13 18:20:28,873 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7553 secs
2025-03-13 18:20:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 62231 [episode count 5/20]
[retrieval_preprocessing] for episode 60185 [episode count 6/20], we have num_retrieval=np.int64(3744) num_query=np.int64(250)
2025-03-13 18:20:30,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:31,298 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:31
2025-03-13 18:20:31,298 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.74it/s]
2025-03-13 18:20:31,329 [INFO]: There are 3744 embeddings of dim 49152
2025-03-13 18:20:31,329 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 18:20:31,329 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:31
2025-03-13 18:20:31,329 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:31,329 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:20:31,329 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:31,329 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:31,329 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:31
2025-03-13 18:20:31,330 [INFO]: 772.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:31,330 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:31,330 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:31
2025-03-13 18:20:31,330 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:31,330 [INFO]: 	Creating the index 03/13/2025, 18:20:31
2025-03-13 18:20:31,330 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:31
2025-03-13 18:20:31,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:20:31,331 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:31
2025-03-13 18:20:31,331 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:20:31,331 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.97it/s] 27%|██▋       | 4/15 [00:00<00:00, 13.39it/s] 47%|████▋     | 7/15 [00:00<00:00, 17.00it/s] 67%|██████▋   | 10/15 [00:00<00:00, 18.90it/s] 87%|████████▋ | 13/15 [00:00<00:00, 20.02it/s]100%|██████████| 15/15 [00:04<00:00,  3.75it/s]
2025-03-13 18:20:35,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:35
2025-03-13 18:21:14,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7502 secs
2025-03-13 18:21:14,088 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:21:14,088 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.63it/s]
2025-03-13 18:21:43,726 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6381 secs
2025-03-13 18:21:43,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3974 secs
2025-03-13 18:21:43,729 [INFO]: {
2025-03-13 18:21:43,729 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:43,729 [INFO]: 	index_param: efSearch=212
2025-03-13 18:21:43,729 [INFO]: 	index_path: knn.index
2025-03-13 18:21:43,729 [INFO]: 	size in bytes: 736609210
2025-03-13 18:21:43,729 [INFO]: 	avg_search_speed_ms: 10.179716624728842
2025-03-13 18:21:43,729 [INFO]: 	99p_search_speed_ms: 17.4913988728076
2025-03-13 18:21:43,729 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:43,729 [INFO]: 	nb vectors: 3744
2025-03-13 18:21:43,729 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:43,729 [INFO]: 	compression ratio: 0.9993091886537775
2025-03-13 18:21:43,729 [INFO]: }
2025-03-13 18:21:43,729 [INFO]: 	>>> Finished "Creating the index" in 72.3993 secs
2025-03-13 18:21:43,729 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4314 secs
2025-03-13 18:21:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 60185 [episode count 6/20]
[retrieval_preprocessing] for episode 70399 [episode count 7/20], we have num_retrieval=np.int64(3800) num_query=np.int64(194)
2025-03-13 18:21:47,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:47,994 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:47
2025-03-13 18:21:47,994 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.44it/s]
2025-03-13 18:21:48,025 [INFO]: There are 3800 embeddings of dim 49152
2025-03-13 18:21:48,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 18:21:48,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:48
2025-03-13 18:21:48,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:48,025 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:21:48,025 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:48,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:48,025 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:48
2025-03-13 18:21:48,026 [INFO]: 784.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:48,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:21:48,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:48
2025-03-13 18:21:48,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:48,026 [INFO]: 	Creating the index 03/13/2025, 18:21:48
2025-03-13 18:21:48,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:48
2025-03-13 18:21:48,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:21:48,027 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:48
2025-03-13 18:21:48,027 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:21:48,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.97it/s] 40%|████      | 6/15 [00:00<00:00, 28.10it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.66it/s]100%|██████████| 15/15 [00:03<00:00,  3.39it/s]100%|██████████| 15/15 [00:03<00:00,  4.68it/s]
2025-03-13 18:21:51,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:51
2025-03-13 18:22:26,317 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0785 secs
2025-03-13 18:22:26,317 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 18:22:26,318 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 18:22:52,133 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8154 secs
2025-03-13 18:22:52,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1092 secs
2025-03-13 18:22:52,137 [INFO]: {
2025-03-13 18:22:52,137 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:52,137 [INFO]: 	index_param: efSearch=165
2025-03-13 18:22:52,137 [INFO]: 	index_path: knn.index
2025-03-13 18:22:52,137 [INFO]: 	size in bytes: 747626830
2025-03-13 18:22:52,137 [INFO]: 	avg_search_speed_ms: 8.467156577036794
2025-03-13 18:22:52,137 [INFO]: 	99p_search_speed_ms: 11.733130831271415
2025-03-13 18:22:52,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:52,137 [INFO]: 	nb vectors: 3800
2025-03-13 18:22:52,137 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:52,137 [INFO]: 	compression ratio: 0.9993092409484555
2025-03-13 18:22:52,137 [INFO]: }
2025-03-13 18:22:52,137 [INFO]: 	>>> Finished "Creating the index" in 64.1112 secs
2025-03-13 18:22:52,137 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1427 secs
2025-03-13 18:22:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 70399 [episode count 7/20]
[retrieval_preprocessing] for episode 6916 [episode count 8/20], we have num_retrieval=np.int64(3761) num_query=np.int64(233)
2025-03-13 18:22:54,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:55,076 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:55
2025-03-13 18:22:55,076 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1074.09it/s]
2025-03-13 18:22:55,103 [INFO]: There are 3761 embeddings of dim 49152
2025-03-13 18:22:55,103 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:22:55,104 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:55
2025-03-13 18:22:55,104 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:55,104 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:22:55,104 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:55,104 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:55,104 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:55
2025-03-13 18:22:55,104 [INFO]: 776.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:55,104 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:22:55,104 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:55
2025-03-13 18:22:55,104 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:55,104 [INFO]: 	Creating the index 03/13/2025, 18:22:55
2025-03-13 18:22:55,104 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:55
2025-03-13 18:22:55,105 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:22:55,105 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:55
2025-03-13 18:22:55,105 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:22:55,106 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.76it/s] 27%|██▋       | 4/15 [00:00<00:00, 14.97it/s] 53%|█████▎    | 8/15 [00:00<00:00, 22.90it/s] 80%|████████  | 12/15 [00:00<00:00, 27.33it/s]100%|██████████| 15/15 [00:04<00:00,  2.44it/s]100%|██████████| 15/15 [00:04<00:00,  3.75it/s]
2025-03-13 18:22:59,114 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:59
2025-03-13 18:23:41,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6058 secs
2025-03-13 18:23:41,720 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:23:41,720 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.08it/s]
2025-03-13 18:24:07,021 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3011 secs
2025-03-13 18:24:07,594 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4883 secs
2025-03-13 18:24:07,594 [INFO]: {
2025-03-13 18:24:07,594 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:07,594 [INFO]: 	index_param: efSearch=161
2025-03-13 18:24:07,594 [INFO]: 	index_path: knn.index
2025-03-13 18:24:07,594 [INFO]: 	size in bytes: 739953910
2025-03-13 18:24:07,594 [INFO]: 	avg_search_speed_ms: 8.540667450718779
2025-03-13 18:24:07,595 [INFO]: 	99p_search_speed_ms: 12.298350851051508
2025-03-13 18:24:07,595 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:07,595 [INFO]: 	nb vectors: 3761
2025-03-13 18:24:07,595 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:07,595 [INFO]: 	compression ratio: 0.9993091164286165
2025-03-13 18:24:07,595 [INFO]: }
2025-03-13 18:24:07,595 [INFO]: 	>>> Finished "Creating the index" in 72.4907 secs
2025-03-13 18:24:07,595 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5192 secs
2025-03-13 18:24:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 6916 [episode count 8/20]
[retrieval_preprocessing] for episode 45434 [episode count 9/20], we have num_retrieval=np.int64(3834) num_query=np.int64(160)
2025-03-13 18:24:09,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:09,812 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:09
2025-03-13 18:24:09,812 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.04it/s]
2025-03-13 18:24:09,838 [INFO]: There are 3834 embeddings of dim 49152
2025-03-13 18:24:09,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:24:09,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:09
2025-03-13 18:24:09,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:09,839 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:24:09,839 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:09,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:24:09,839 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:09
2025-03-13 18:24:09,839 [INFO]: 791.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:09,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:24:09,840 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:09
2025-03-13 18:24:09,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:09,840 [INFO]: 	Creating the index 03/13/2025, 18:24:09
2025-03-13 18:24:09,840 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:09
2025-03-13 18:24:09,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:24:09,843 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:09
2025-03-13 18:24:09,843 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:24:09,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.69it/s] 50%|█████     | 8/16 [00:00<00:00, 39.76it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.85it/s]100%|██████████| 16/16 [00:03<00:00,  4.91it/s]
2025-03-13 18:24:13,111 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:13
2025-03-13 18:24:53,760 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6481 secs
2025-03-13 18:24:53,760 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 18:24:53,760 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-13 18:25:16,523 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7628 secs
2025-03-13 18:25:16,525 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6818 secs
2025-03-13 18:25:16,525 [INFO]: {
2025-03-13 18:25:16,525 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:16,525 [INFO]: 	index_param: efSearch=182
2025-03-13 18:25:16,525 [INFO]: 	index_path: knn.index
2025-03-13 18:25:16,525 [INFO]: 	size in bytes: 754316410
2025-03-13 18:25:16,525 [INFO]: 	avg_search_speed_ms: 8.675847126410083
2025-03-13 18:25:16,526 [INFO]: 	99p_search_speed_ms: 12.002955647185447
2025-03-13 18:25:16,526 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:16,526 [INFO]: 	nb vectors: 3834
2025-03-13 18:25:16,526 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:16,526 [INFO]: 	compression ratio: 0.9993088603229512
2025-03-13 18:25:16,526 [INFO]: }
2025-03-13 18:25:16,526 [INFO]: 	>>> Finished "Creating the index" in 66.6855 secs
2025-03-13 18:25:16,526 [INFO]: >>> Finished "Launching the whole pipeline" in 66.7140 secs
2025-03-13 18:25:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 45434 [episode count 9/20]
[retrieval_preprocessing] for episode 33818 [episode count 10/20], we have num_retrieval=np.int64(3812) num_query=np.int64(182)
2025-03-13 18:25:18,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:19,154 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:19
2025-03-13 18:25:19,154 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 882.45it/s]
2025-03-13 18:25:19,180 [INFO]: There are 3812 embeddings of dim 49152
2025-03-13 18:25:19,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:25:19,180 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:19
2025-03-13 18:25:19,180 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:19,180 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:25:19,180 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:19,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:25:19,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:19
2025-03-13 18:25:19,180 [INFO]: 786.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:19,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:25:19,181 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:19
2025-03-13 18:25:19,181 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:19,181 [INFO]: 	Creating the index 03/13/2025, 18:25:19
2025-03-13 18:25:19,181 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:19
2025-03-13 18:25:19,182 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:25:19,182 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:19
2025-03-13 18:25:19,182 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:25:19,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.32it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.40it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.64it/s]100%|██████████| 16/16 [00:03<00:00,  3.85it/s]100%|██████████| 16/16 [00:03<00:00,  5.13it/s]
2025-03-13 18:25:22,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:22
2025-03-13 18:25:55,695 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3903 secs
2025-03-13 18:25:55,695 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 18:25:55,695 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.07it/s]
2025-03-13 18:26:27,162 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4672 secs
2025-03-13 18:26:27,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9831 secs
2025-03-13 18:26:27,165 [INFO]: {
2025-03-13 18:26:27,165 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:27,165 [INFO]: 	index_param: efSearch=227
2025-03-13 18:26:27,165 [INFO]: 	index_path: knn.index
2025-03-13 18:26:27,165 [INFO]: 	size in bytes: 749987890
2025-03-13 18:26:27,165 [INFO]: 	avg_search_speed_ms: 10.32065343033903
2025-03-13 18:26:27,165 [INFO]: 	99p_search_speed_ms: 13.938853740692126
2025-03-13 18:26:27,165 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:27,165 [INFO]: 	nb vectors: 3812
2025-03-13 18:26:27,165 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:27,165 [INFO]: 	compression ratio: 0.9993090635103454
2025-03-13 18:26:27,165 [INFO]: }
2025-03-13 18:26:27,165 [INFO]: 	>>> Finished "Creating the index" in 67.9849 secs
2025-03-13 18:26:27,165 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0118 secs
2025-03-13 18:26:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 33818 [episode count 10/20]
[retrieval_preprocessing] for episode 58517 [episode count 11/20], we have num_retrieval=np.int64(3801) num_query=np.int64(193)
2025-03-13 18:26:29,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:30,741 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:30
2025-03-13 18:26:30,741 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.27it/s]
2025-03-13 18:26:30,769 [INFO]: There are 3801 embeddings of dim 49152
2025-03-13 18:26:30,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 18:26:30,770 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:30
2025-03-13 18:26:30,770 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:30,770 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:26:30,770 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:30,770 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:30,770 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:30
2025-03-13 18:26:30,770 [INFO]: 784.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:30,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:26:30,770 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:30
2025-03-13 18:26:30,770 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:30,770 [INFO]: 	Creating the index 03/13/2025, 18:26:30
2025-03-13 18:26:30,770 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:30
2025-03-13 18:26:30,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:26:30,772 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:30
2025-03-13 18:26:30,772 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:26:30,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.82it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.13it/s] 80%|████████  | 12/15 [00:00<00:00, 40.57it/s]100%|██████████| 15/15 [00:03<00:00,  4.35it/s]
2025-03-13 18:26:34,225 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:34
2025-03-13 18:27:19,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2157 secs
2025-03-13 18:27:19,441 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 18:27:19,441 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.06it/s]
2025-03-13 18:27:39,422 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9806 secs
2025-03-13 18:27:39,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6525 secs
2025-03-13 18:27:39,424 [INFO]: {
2025-03-13 18:27:39,424 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:39,424 [INFO]: 	index_param: efSearch=218
2025-03-13 18:27:39,424 [INFO]: 	index_path: knn.index
2025-03-13 18:27:39,424 [INFO]: 	size in bytes: 747823570
2025-03-13 18:27:39,424 [INFO]: 	avg_search_speed_ms: 9.842435765862978
2025-03-13 18:27:39,424 [INFO]: 	99p_search_speed_ms: 15.505246014799926
2025-03-13 18:27:39,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:39,424 [INFO]: 	nb vectors: 3801
2025-03-13 18:27:39,424 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:39,424 [INFO]: 	compression ratio: 0.9993092461635035
2025-03-13 18:27:39,424 [INFO]: }
2025-03-13 18:27:39,424 [INFO]: 	>>> Finished "Creating the index" in 68.6544 secs
2025-03-13 18:27:39,425 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6838 secs
2025-03-13 18:27:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 58517 [episode count 11/20]
[retrieval_preprocessing] for episode 76972 [episode count 12/20], we have num_retrieval=np.int64(3834) num_query=np.int64(160)
2025-03-13 18:27:41,333 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:41,995 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:41
2025-03-13 18:27:41,996 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1875.81it/s]
2025-03-13 18:27:42,020 [INFO]: There are 3834 embeddings of dim 49152
2025-03-13 18:27:42,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:27:42,020 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:42
2025-03-13 18:27:42,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:42,020 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:27:42,020 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:42,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:42,020 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:42
2025-03-13 18:27:42,020 [INFO]: 791.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:42,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:27:42,020 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:42
2025-03-13 18:27:42,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:42,020 [INFO]: 	Creating the index 03/13/2025, 18:27:42
2025-03-13 18:27:42,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:42
2025-03-13 18:27:42,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:27:42,022 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:42
2025-03-13 18:27:42,022 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:27:42,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.29it/s] 50%|█████     | 8/16 [00:00<00:00, 39.19it/s] 88%|████████▊ | 14/16 [00:00<00:00, 46.18it/s]100%|██████████| 16/16 [00:02<00:00,  5.60it/s]
2025-03-13 18:27:44,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:44
2025-03-13 18:28:23,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3362 secs
2025-03-13 18:28:23,220 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:28:23,220 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.06it/s]
2025-03-13 18:28:53,964 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7437 secs
2025-03-13 18:28:53,967 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9455 secs
2025-03-13 18:28:53,967 [INFO]: {
2025-03-13 18:28:53,967 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:53,967 [INFO]: 	index_param: efSearch=221
2025-03-13 18:28:53,967 [INFO]: 	index_path: knn.index
2025-03-13 18:28:53,967 [INFO]: 	size in bytes: 754316410
2025-03-13 18:28:53,967 [INFO]: 	avg_search_speed_ms: 8.450389582079632
2025-03-13 18:28:53,967 [INFO]: 	99p_search_speed_ms: 13.771532312966903
2025-03-13 18:28:53,968 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:53,968 [INFO]: 	nb vectors: 3834
2025-03-13 18:28:53,968 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:53,968 [INFO]: 	compression ratio: 0.9993088603229512
2025-03-13 18:28:53,968 [INFO]: }
2025-03-13 18:28:53,968 [INFO]: 	>>> Finished "Creating the index" in 71.9471 secs
2025-03-13 18:28:53,968 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9721 secs
2025-03-13 18:28:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 76972 [episode count 12/20]
[retrieval_preprocessing] for episode 5566 [episode count 13/20], we have num_retrieval=np.int64(3783) num_query=np.int64(211)
2025-03-13 18:28:55,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:56,768 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:56
2025-03-13 18:28:56,768 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 783.54it/s]
2025-03-13 18:28:56,795 [INFO]: There are 3783 embeddings of dim 49152
2025-03-13 18:28:56,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 18:28:56,796 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:56
2025-03-13 18:28:56,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:56,796 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:28:56,796 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:56,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:28:56,796 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:56
2025-03-13 18:28:56,796 [INFO]: 780.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:56,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:28:56,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:56
2025-03-13 18:28:56,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:56,796 [INFO]: 	Creating the index 03/13/2025, 18:28:56
2025-03-13 18:28:56,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:56
2025-03-13 18:28:56,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 18:28:56,799 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:56
2025-03-13 18:28:56,799 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:28:56,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 26.43it/s] 60%|██████    | 9/15 [00:00<00:00, 44.59it/s]100%|██████████| 15/15 [00:02<00:00,  4.48it/s]100%|██████████| 15/15 [00:02<00:00,  5.56it/s]
2025-03-13 18:28:59,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:59
2025-03-13 18:29:36,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1388 secs
2025-03-13 18:29:36,668 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 18:29:36,668 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 18:29:54,879 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2106 secs
2025-03-13 18:29:54,882 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0834 secs
2025-03-13 18:29:54,883 [INFO]: {
2025-03-13 18:29:54,883 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:54,883 [INFO]: 	index_param: efSearch=235
2025-03-13 18:29:54,883 [INFO]: 	index_path: knn.index
2025-03-13 18:29:54,883 [INFO]: 	size in bytes: 744282190
2025-03-13 18:29:54,883 [INFO]: 	avg_search_speed_ms: 11.943240589984562
2025-03-13 18:29:54,883 [INFO]: 	99p_search_speed_ms: 20.60287551023066
2025-03-13 18:29:54,883 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:54,883 [INFO]: 	nb vectors: 3783
2025-03-13 18:29:54,883 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:54,883 [INFO]: 	compression ratio: 0.9993092324297052
2025-03-13 18:29:54,883 [INFO]: }
2025-03-13 18:29:54,883 [INFO]: 	>>> Finished "Creating the index" in 58.0863 secs
2025-03-13 18:29:54,883 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1151 secs
2025-03-13 18:29:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 5566 [episode count 13/20]
[retrieval_preprocessing] for episode 93561 [episode count 14/20], we have num_retrieval=np.int64(3783) num_query=np.int64(211)
2025-03-13 18:29:57,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:57,739 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:57
2025-03-13 18:29:57,739 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.90it/s]
2025-03-13 18:29:57,767 [INFO]: There are 3783 embeddings of dim 49152
2025-03-13 18:29:57,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 18:29:57,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:57
2025-03-13 18:29:57,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:57,767 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:29:57,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:57,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:57,767 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:57
2025-03-13 18:29:57,767 [INFO]: 780.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:57,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:29:57,768 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:57
2025-03-13 18:29:57,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:57,768 [INFO]: 	Creating the index 03/13/2025, 18:29:57
2025-03-13 18:29:57,768 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:57
2025-03-13 18:29:57,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:29:57,769 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:57
2025-03-13 18:29:57,769 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:29:57,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.88it/s] 40%|████      | 6/15 [00:00<00:00, 28.02it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.04it/s]100%|██████████| 15/15 [00:03<00:00,  3.41it/s]100%|██████████| 15/15 [00:03<00:00,  4.69it/s]
2025-03-13 18:30:00,971 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:00
2025-03-13 18:30:43,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4653 secs
2025-03-13 18:30:43,437 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:30:43,438 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.72it/s]
2025-03-13 18:31:11,198 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7602 secs
2025-03-13 18:31:11,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4315 secs
2025-03-13 18:31:11,201 [INFO]: {
2025-03-13 18:31:11,201 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:11,201 [INFO]: 	index_param: efSearch=222
2025-03-13 18:31:11,201 [INFO]: 	index_path: knn.index
2025-03-13 18:31:11,201 [INFO]: 	size in bytes: 744282190
2025-03-13 18:31:11,201 [INFO]: 	avg_search_speed_ms: 10.164745030612345
2025-03-13 18:31:11,201 [INFO]: 	99p_search_speed_ms: 16.582779034506512
2025-03-13 18:31:11,201 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:11,201 [INFO]: 	nb vectors: 3783
2025-03-13 18:31:11,201 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:11,201 [INFO]: 	compression ratio: 0.9993092324297052
2025-03-13 18:31:11,201 [INFO]: }
2025-03-13 18:31:11,201 [INFO]: 	>>> Finished "Creating the index" in 73.4332 secs
2025-03-13 18:31:11,201 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4615 secs
2025-03-13 18:31:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 93561 [episode count 14/20]
[retrieval_preprocessing] for episode 81393 [episode count 15/20], we have num_retrieval=np.int64(3773) num_query=np.int64(221)
2025-03-13 18:31:13,242 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:14,858 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:14
2025-03-13 18:31:14,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.83it/s]
2025-03-13 18:31:14,881 [INFO]: There are 3773 embeddings of dim 49152
2025-03-13 18:31:14,881 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 18:31:14,881 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,881 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:14,881 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:31:14,881 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:14,881 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:31:14,881 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,882 [INFO]: 778.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:14,882 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:31:14,882 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:14
2025-03-13 18:31:14,882 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:14,882 [INFO]: 	Creating the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,882 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:14
2025-03-13 18:31:14,883 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:31:14,883 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,883 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:31:14,883 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.04it/s] 40%|████      | 6/15 [00:00<00:00, 28.71it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.43it/s]100%|██████████| 15/15 [00:03<00:00,  3.28it/s]100%|██████████| 15/15 [00:03<00:00,  4.53it/s]
2025-03-13 18:31:18,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:18
2025-03-13 18:31:55,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5937 secs
2025-03-13 18:31:55,793 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 18:31:55,793 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.88it/s]
2025-03-13 18:32:19,102 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3089 secs
2025-03-13 18:32:19,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2233 secs
2025-03-13 18:32:19,107 [INFO]: {
2025-03-13 18:32:19,107 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:19,107 [INFO]: 	index_param: efSearch=282
2025-03-13 18:32:19,107 [INFO]: 	index_path: knn.index
2025-03-13 18:32:19,107 [INFO]: 	size in bytes: 742314790
2025-03-13 18:32:19,107 [INFO]: 	avg_search_speed_ms: 12.349047868535566
2025-03-13 18:32:19,107 [INFO]: 	99p_search_speed_ms: 19.424600999336683
2025-03-13 18:32:19,107 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:19,107 [INFO]: 	nb vectors: 3773
2025-03-13 18:32:19,107 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:19,107 [INFO]: 	compression ratio: 0.9993091798696345
2025-03-13 18:32:19,107 [INFO]: }
2025-03-13 18:32:19,107 [INFO]: 	>>> Finished "Creating the index" in 64.2250 secs
2025-03-13 18:32:19,107 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2486 secs
2025-03-13 18:32:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 81393 [episode count 15/20]
[retrieval_preprocessing] for episode 36402 [episode count 16/20], we have num_retrieval=np.int64(3791) num_query=np.int64(203)
2025-03-13 18:32:22,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:23,635 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:23
2025-03-13 18:32:23,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.76it/s]
2025-03-13 18:32:23,665 [INFO]: There are 3791 embeddings of dim 49152
2025-03-13 18:32:23,665 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 18:32:23,665 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:23
2025-03-13 18:32:23,666 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:23,666 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:32:23,666 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:23,666 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:32:23,666 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:23
2025-03-13 18:32:23,666 [INFO]: 782.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:23,666 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:32:23,667 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:23
2025-03-13 18:32:23,667 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:23,667 [INFO]: 	Creating the index 03/13/2025, 18:32:23
2025-03-13 18:32:23,667 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:23
2025-03-13 18:32:23,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 18:32:23,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:23
2025-03-13 18:32:23,669 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:32:23,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.07it/s] 40%|████      | 6/15 [00:00<00:00, 30.60it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.07it/s]100%|██████████| 15/15 [00:02<00:00,  3.69it/s]100%|██████████| 15/15 [00:02<00:00,  5.08it/s]
2025-03-13 18:32:26,630 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:26
2025-03-13 18:33:01,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1801 secs
2025-03-13 18:33:01,811 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 18:33:01,811 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 18:33:21,950 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1389 secs
2025-03-13 18:33:21,952 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2832 secs
2025-03-13 18:33:21,953 [INFO]: {
2025-03-13 18:33:21,953 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:21,953 [INFO]: 	index_param: efSearch=132
2025-03-13 18:33:21,953 [INFO]: 	index_path: knn.index
2025-03-13 18:33:21,953 [INFO]: 	size in bytes: 745856170
2025-03-13 18:33:21,953 [INFO]: 	avg_search_speed_ms: 7.460151506768567
2025-03-13 18:33:21,953 [INFO]: 	99p_search_speed_ms: 12.828455022536215
2025-03-13 18:33:21,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:21,953 [INFO]: 	nb vectors: 3791
2025-03-13 18:33:21,953 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:21,953 [INFO]: 	compression ratio: 0.9993091938892186
2025-03-13 18:33:21,953 [INFO]: }
2025-03-13 18:33:21,953 [INFO]: 	>>> Finished "Creating the index" in 58.2862 secs
2025-03-13 18:33:21,953 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3180 secs
2025-03-13 18:33:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 36402 [episode count 16/20]
[retrieval_preprocessing] for episode 32499 [episode count 17/20], we have num_retrieval=np.int64(3775) num_query=np.int64(219)
2025-03-13 18:33:23,336 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:23,836 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:23
2025-03-13 18:33:23,836 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1550.57it/s]
2025-03-13 18:33:23,858 [INFO]: There are 3775 embeddings of dim 49152
2025-03-13 18:33:23,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 18:33:23,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:23
2025-03-13 18:33:23,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:23,859 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:33:23,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:23,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:33:23,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:23
2025-03-13 18:33:23,859 [INFO]: 779.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:23,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:33:23,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:23
2025-03-13 18:33:23,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:23,859 [INFO]: 	Creating the index 03/13/2025, 18:33:23
2025-03-13 18:33:23,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:23
2025-03-13 18:33:23,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:33:23,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:23
2025-03-13 18:33:23,860 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:33:23,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.54it/s] 33%|███▎      | 5/15 [00:00<00:00, 24.95it/s] 67%|██████▋   | 10/15 [00:00<00:00, 33.75it/s]100%|██████████| 15/15 [00:03<00:00,  3.73it/s]100%|██████████| 15/15 [00:03<00:00,  4.91it/s]
2025-03-13 18:33:26,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:26
2025-03-13 18:34:01,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0132 secs
2025-03-13 18:34:01,935 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 18:34:01,935 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.98it/s]
2025-03-13 18:34:23,130 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1947 secs
2025-03-13 18:34:23,133 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2728 secs
2025-03-13 18:34:23,133 [INFO]: {
2025-03-13 18:34:23,133 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:23,133 [INFO]: 	index_param: efSearch=250
2025-03-13 18:34:23,133 [INFO]: 	index_path: knn.index
2025-03-13 18:34:23,133 [INFO]: 	size in bytes: 742708270
2025-03-13 18:34:23,133 [INFO]: 	avg_search_speed_ms: 11.93082879860225
2025-03-13 18:34:23,133 [INFO]: 	99p_search_speed_ms: 17.331249271519482
2025-03-13 18:34:23,133 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:23,133 [INFO]: 	nb vectors: 3775
2025-03-13 18:34:23,133 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:23,133 [INFO]: 	compression ratio: 0.9993091904039254
2025-03-13 18:34:23,133 [INFO]: }
2025-03-13 18:34:23,133 [INFO]: 	>>> Finished "Creating the index" in 59.2743 secs
2025-03-13 18:34:23,133 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2975 secs
2025-03-13 18:34:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 32499 [episode count 17/20]
[retrieval_preprocessing] for episode 43579 [episode count 18/20], we have num_retrieval=np.int64(3785) num_query=np.int64(209)
2025-03-13 18:34:25,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:26,328 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:26
2025-03-13 18:34:26,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.22it/s]
2025-03-13 18:34:26,354 [INFO]: There are 3785 embeddings of dim 49152
2025-03-13 18:34:26,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:34:26,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:26
2025-03-13 18:34:26,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:26,354 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:34:26,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:26,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:26,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:26
2025-03-13 18:34:26,354 [INFO]: 781.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:26,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:34:26,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:26
2025-03-13 18:34:26,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:26,355 [INFO]: 	Creating the index 03/13/2025, 18:34:26
2025-03-13 18:34:26,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:26
2025-03-13 18:34:26,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:34:26,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:26
2025-03-13 18:34:26,356 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:34:26,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.97it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.75it/s] 93%|█████████▎| 14/15 [00:00<00:00, 45.74it/s]100%|██████████| 15/15 [00:02<00:00,  5.37it/s]
2025-03-13 18:34:29,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:29
2025-03-13 18:35:07,024 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8729 secs
2025-03-13 18:35:07,025 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 18:35:07,025 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.80it/s]
2025-03-13 18:35:28,806 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7807 secs
2025-03-13 18:35:28,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6099 secs
2025-03-13 18:35:28,966 [INFO]: {
2025-03-13 18:35:28,966 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:28,966 [INFO]: 	index_param: efSearch=247
2025-03-13 18:35:28,966 [INFO]: 	index_path: knn.index
2025-03-13 18:35:28,966 [INFO]: 	size in bytes: 744675670
2025-03-13 18:35:28,967 [INFO]: 	avg_search_speed_ms: 11.677227607333778
2025-03-13 18:35:28,967 [INFO]: 	99p_search_speed_ms: 16.331650959327817
2025-03-13 18:35:28,967 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:28,967 [INFO]: 	nb vectors: 3785
2025-03-13 18:35:28,967 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:28,967 [INFO]: 	compression ratio: 0.9993092429083926
2025-03-13 18:35:28,967 [INFO]: }
2025-03-13 18:35:28,967 [INFO]: 	>>> Finished "Creating the index" in 62.6123 secs
2025-03-13 18:35:28,967 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6388 secs
2025-03-13 18:35:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 43579 [episode count 18/20]
[retrieval_preprocessing] for episode 40364 [episode count 19/20], we have num_retrieval=np.int64(3839) num_query=np.int64(155)
2025-03-13 18:35:31,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:32,183 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:32
2025-03-13 18:35:32,183 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.51it/s]
2025-03-13 18:35:32,213 [INFO]: There are 3839 embeddings of dim 49152
2025-03-13 18:35:32,213 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:35:32,214 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:32
2025-03-13 18:35:32,214 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:32,214 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:35:32,214 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:32,214 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:35:32,214 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:32
2025-03-13 18:35:32,215 [INFO]: 792.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:32,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:35:32,215 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:32
2025-03-13 18:35:32,215 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:32,215 [INFO]: 	Creating the index 03/13/2025, 18:35:32
2025-03-13 18:35:32,215 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:32
2025-03-13 18:35:32,218 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:35:32,218 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:32
2025-03-13 18:35:32,218 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:35:32,219 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.99it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.04it/s] 75%|███████▌  | 12/16 [00:00<00:00, 40.00it/s]100%|██████████| 16/16 [00:03<00:00,  3.38it/s]100%|██████████| 16/16 [00:03<00:00,  4.85it/s]
2025-03-13 18:35:35,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:35
2025-03-13 18:36:12,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8946 secs
2025-03-13 18:36:12,422 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 18:36:12,422 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-13 18:36:31,074 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6519 secs
2025-03-13 18:36:31,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8582 secs
2025-03-13 18:36:31,077 [INFO]: {
2025-03-13 18:36:31,077 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:31,077 [INFO]: 	index_param: efSearch=163
2025-03-13 18:36:31,077 [INFO]: 	index_path: knn.index
2025-03-13 18:36:31,077 [INFO]: 	size in bytes: 755300110
2025-03-13 18:36:31,077 [INFO]: 	avg_search_speed_ms: 8.287984023276522
2025-03-13 18:36:31,077 [INFO]: 	99p_search_speed_ms: 11.91038222052158
2025-03-13 18:36:31,077 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:31,077 [INFO]: 	nb vectors: 3839
2025-03-13 18:36:31,077 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:31,077 [INFO]: 	compression ratio: 0.9993088866358036
2025-03-13 18:36:31,077 [INFO]: }
2025-03-13 18:36:31,077 [INFO]: 	>>> Finished "Creating the index" in 58.8616 secs
2025-03-13 18:36:31,077 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8937 secs
2025-03-13 18:36:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 40364 [episode count 19/20]
2025-03-13 18:36:32: [retrieval_preprocessing] finished for 1656877278_remove_can_from_bowl [chosen_id count 7/196]
2025-03-13 18:36:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_remove_towel_from_bowl [chosen_id count 8/196]
2025-03-13 18:36:33: [retrieval_preprocessing] we have num_total=3943 embedding_dim=49152
[retrieval_preprocessing] for episode 67661 [episode count 0/20], we have num_retrieval=np.int64(3729) num_query=np.int64(214)
2025-03-13 18:36:34,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:34,907 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:34
2025-03-13 18:36:34,907 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.62it/s]
2025-03-13 18:36:34,933 [INFO]: There are 3729 embeddings of dim 49152
2025-03-13 18:36:34,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:36:34,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:34
2025-03-13 18:36:34,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:34,933 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:36:34,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:34,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:34,933 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:34
2025-03-13 18:36:34,934 [INFO]: 769.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:34,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:36:34,934 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:34
2025-03-13 18:36:34,934 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:34,934 [INFO]: 	Creating the index 03/13/2025, 18:36:34
2025-03-13 18:36:34,934 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:34
2025-03-13 18:36:34,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:36:34,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:34
2025-03-13 18:36:34,935 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:36:34,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.10it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.59it/s] 80%|████████  | 12/15 [00:00<00:00, 40.71it/s]100%|██████████| 15/15 [00:03<00:00,  3.83it/s]
2025-03-13 18:36:39,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:39
2025-03-13 18:37:22,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4595 secs
2025-03-13 18:37:22,554 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 18:37:22,554 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.27it/s]
2025-03-13 18:37:39,530 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9758 secs
2025-03-13 18:37:39,532 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5970 secs
2025-03-13 18:37:39,532 [INFO]: {
2025-03-13 18:37:39,532 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:39,532 [INFO]: 	index_param: efSearch=152
2025-03-13 18:37:39,532 [INFO]: 	index_path: knn.index
2025-03-13 18:37:39,532 [INFO]: 	size in bytes: 733657990
2025-03-13 18:37:39,532 [INFO]: 	avg_search_speed_ms: 10.456069393782919
2025-03-13 18:37:39,532 [INFO]: 	99p_search_speed_ms: 15.662956854794176
2025-03-13 18:37:39,532 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:39,532 [INFO]: 	nb vectors: 3729
2025-03-13 18:37:39,532 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:39,532 [INFO]: 	compression ratio: 0.9993092721582709
2025-03-13 18:37:39,532 [INFO]: }
2025-03-13 18:37:39,532 [INFO]: 	>>> Finished "Creating the index" in 64.5985 secs
2025-03-13 18:37:39,532 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6255 secs
2025-03-13 18:37:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 67661 [episode count 0/20]
[retrieval_preprocessing] for episode 80066 [episode count 1/20], we have num_retrieval=np.int64(3768) num_query=np.int64(175)
2025-03-13 18:37:41,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:41,724 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:41
2025-03-13 18:37:41,724 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]
2025-03-13 18:37:41,752 [INFO]: There are 3768 embeddings of dim 49152
2025-03-13 18:37:41,752 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:37:41,752 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:41
2025-03-13 18:37:41,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:41,753 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:37:41,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:41,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:37:41,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:41
2025-03-13 18:37:41,753 [INFO]: 777.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:41,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:37:41,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:41
2025-03-13 18:37:41,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:41,754 [INFO]: 	Creating the index 03/13/2025, 18:37:41
2025-03-13 18:37:41,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:41
2025-03-13 18:37:41,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:37:41,758 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:41
2025-03-13 18:37:41,758 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:37:41,758 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.32it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.92it/s] 80%|████████  | 12/15 [00:00<00:00, 40.89it/s]100%|██████████| 15/15 [00:03<00:00,  4.19it/s]
2025-03-13 18:37:45,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:45
2025-03-13 18:38:22,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9643 secs
2025-03-13 18:38:22,311 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 18:38:22,311 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.35it/s]
2025-03-13 18:38:56,961 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6492 secs
2025-03-13 18:38:56,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2052 secs
2025-03-13 18:38:56,963 [INFO]: {
2025-03-13 18:38:56,963 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:56,963 [INFO]: 	index_param: efSearch=257
2025-03-13 18:38:56,963 [INFO]: 	index_path: knn.index
2025-03-13 18:38:56,963 [INFO]: 	size in bytes: 741331090
2025-03-13 18:38:56,963 [INFO]: 	avg_search_speed_ms: 14.416172975333414
2025-03-13 18:38:56,963 [INFO]: 	99p_search_speed_ms: 21.336203841492562
2025-03-13 18:38:56,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:56,963 [INFO]: 	nb vectors: 3768
2025-03-13 18:38:56,963 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:56,963 [INFO]: 	compression ratio: 0.9993091534849834
2025-03-13 18:38:56,963 [INFO]: }
2025-03-13 18:38:56,963 [INFO]: 	>>> Finished "Creating the index" in 75.2092 secs
2025-03-13 18:38:56,963 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2389 secs
2025-03-13 18:38:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 80066 [episode count 1/20]
[retrieval_preprocessing] for episode 67899 [episode count 2/20], we have num_retrieval=np.int64(3790) num_query=np.int64(153)
2025-03-13 18:38:59,452 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:00,028 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:00
2025-03-13 18:39:00,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2069.22it/s]
2025-03-13 18:39:00,056 [INFO]: There are 3790 embeddings of dim 49152
2025-03-13 18:39:00,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:39:00,057 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:00
2025-03-13 18:39:00,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:00,057 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:39:00,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:00,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:39:00,057 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:00
2025-03-13 18:39:00,058 [INFO]: 782.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:00,058 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:39:00,058 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:00
2025-03-13 18:39:00,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:00,059 [INFO]: 	Creating the index 03/13/2025, 18:39:00
2025-03-13 18:39:00,059 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:00
2025-03-13 18:39:00,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:39:00,062 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:00
2025-03-13 18:39:00,063 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:39:00,063 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.31it/s] 47%|████▋     | 7/15 [00:00<00:00, 30.57it/s] 80%|████████  | 12/15 [00:00<00:00, 35.48it/s]100%|██████████| 15/15 [00:04<00:00,  3.73it/s]
2025-03-13 18:39:04,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:04
2025-03-13 18:39:50,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9891 secs
2025-03-13 18:39:50,081 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 18:39:50,081 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-13 18:40:09,543 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4623 secs
2025-03-13 18:40:09,545 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.4830 secs
2025-03-13 18:40:09,546 [INFO]: {
2025-03-13 18:40:09,546 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:09,546 [INFO]: 	index_param: efSearch=126
2025-03-13 18:40:09,546 [INFO]: 	index_path: knn.index
2025-03-13 18:40:09,546 [INFO]: 	size in bytes: 745659430
2025-03-13 18:40:09,546 [INFO]: 	avg_search_speed_ms: 7.294998791056565
2025-03-13 18:40:09,546 [INFO]: 	99p_search_speed_ms: 9.956016624346375
2025-03-13 18:40:09,546 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:09,546 [INFO]: 	nb vectors: 3790
2025-03-13 18:40:09,546 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:09,546 [INFO]: 	compression ratio: 0.9993091886466184
2025-03-13 18:40:09,546 [INFO]: }
2025-03-13 18:40:09,546 [INFO]: 	>>> Finished "Creating the index" in 69.4872 secs
2025-03-13 18:40:09,546 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5174 secs
2025-03-13 18:40:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 67899 [episode count 2/20]
[retrieval_preprocessing] for episode 84334 [episode count 3/20], we have num_retrieval=np.int64(3764) num_query=np.int64(179)
2025-03-13 18:40:10,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:11,282 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:11
2025-03-13 18:40:11,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1762.31it/s]
2025-03-13 18:40:11,307 [INFO]: There are 3764 embeddings of dim 49152
2025-03-13 18:40:11,307 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:40:11,307 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:11
2025-03-13 18:40:11,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:11,307 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:40:11,307 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:11,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:40:11,307 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:11
2025-03-13 18:40:11,307 [INFO]: 776.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:11,307 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:40:11,308 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:11
2025-03-13 18:40:11,308 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:11,308 [INFO]: 	Creating the index 03/13/2025, 18:40:11
2025-03-13 18:40:11,308 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:11
2025-03-13 18:40:11,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:40:11,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:11
2025-03-13 18:40:11,309 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:40:11,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.03it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.11it/s] 80%|████████  | 12/15 [00:00<00:00, 40.05it/s]100%|██████████| 15/15 [00:03<00:00,  4.64it/s]
2025-03-13 18:40:14,542 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:14
2025-03-13 18:40:56,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5309 secs
2025-03-13 18:40:56,073 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:40:56,073 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 18:41:21,519 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4451 secs
2025-03-13 18:41:21,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2123 secs
2025-03-13 18:41:21,521 [INFO]: {
2025-03-13 18:41:21,521 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:21,521 [INFO]: 	index_param: efSearch=205
2025-03-13 18:41:21,521 [INFO]: 	index_path: knn.index
2025-03-13 18:41:21,521 [INFO]: 	size in bytes: 740544130
2025-03-13 18:41:21,521 [INFO]: 	avg_search_speed_ms: 10.1303465503033
2025-03-13 18:41:21,521 [INFO]: 	99p_search_speed_ms: 13.46641009207815
2025-03-13 18:41:21,521 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:21,521 [INFO]: 	nb vectors: 3764
2025-03-13 18:41:21,521 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:21,521 [INFO]: 	compression ratio: 0.9993091323267933
2025-03-13 18:41:21,521 [INFO]: }
2025-03-13 18:41:21,521 [INFO]: 	>>> Finished "Creating the index" in 70.2138 secs
2025-03-13 18:41:21,521 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2392 secs
2025-03-13 18:41:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 84334 [episode count 3/20]
[retrieval_preprocessing] for episode 72047 [episode count 4/20], we have num_retrieval=np.int64(3760) num_query=np.int64(183)
2025-03-13 18:41:26,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:27,475 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:27
2025-03-13 18:41:27,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 914.79it/s]
2025-03-13 18:41:27,505 [INFO]: There are 3760 embeddings of dim 49152
2025-03-13 18:41:27,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 18:41:27,506 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:27
2025-03-13 18:41:27,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:27,506 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:41:27,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:27,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:27,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:27
2025-03-13 18:41:27,506 [INFO]: 776.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:27,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:27,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:27
2025-03-13 18:41:27,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:27,506 [INFO]: 	Creating the index 03/13/2025, 18:41:27
2025-03-13 18:41:27,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:27
2025-03-13 18:41:27,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:41:27,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:27
2025-03-13 18:41:27,508 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:41:27,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.50it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.75it/s] 80%|████████  | 12/15 [00:00<00:00, 35.99it/s]100%|██████████| 15/15 [00:03<00:00,  4.46it/s]
2025-03-13 18:41:31,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:31
2025-03-13 18:42:11,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5286 secs
2025-03-13 18:42:11,967 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 18:42:11,968 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-13 18:42:29,467 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4996 secs
2025-03-13 18:42:29,470 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9619 secs
2025-03-13 18:42:29,470 [INFO]: {
2025-03-13 18:42:29,470 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:29,470 [INFO]: 	index_param: efSearch=151
2025-03-13 18:42:29,470 [INFO]: 	index_path: knn.index
2025-03-13 18:42:29,470 [INFO]: 	size in bytes: 739757170
2025-03-13 18:42:29,470 [INFO]: 	avg_search_speed_ms: 9.646348805878969
2025-03-13 18:42:29,470 [INFO]: 	99p_search_speed_ms: 13.991827294230466
2025-03-13 18:42:29,470 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:29,470 [INFO]: 	nb vectors: 3760
2025-03-13 18:42:29,470 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:29,470 [INFO]: 	compression ratio: 0.9993091111235867
2025-03-13 18:42:29,470 [INFO]: }
2025-03-13 18:42:29,470 [INFO]: 	>>> Finished "Creating the index" in 61.9639 secs
2025-03-13 18:42:29,470 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9951 secs
2025-03-13 18:42:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 72047 [episode count 4/20]
[retrieval_preprocessing] for episode 8902 [episode count 5/20], we have num_retrieval=np.int64(3757) num_query=np.int64(186)
2025-03-13 18:42:31,348 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:32,090 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:32
2025-03-13 18:42:32,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.71it/s]
2025-03-13 18:42:32,117 [INFO]: There are 3757 embeddings of dim 49152
2025-03-13 18:42:32,117 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 18:42:32,117 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:32
2025-03-13 18:42:32,117 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:32,117 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:42:32,117 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:32,117 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:42:32,117 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:32
2025-03-13 18:42:32,118 [INFO]: 775.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:32,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:42:32,118 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:32
2025-03-13 18:42:32,118 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:32,118 [INFO]: 	Creating the index 03/13/2025, 18:42:32
2025-03-13 18:42:32,118 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:32
2025-03-13 18:42:32,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:42:32,119 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:32
2025-03-13 18:42:32,119 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:42:32,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.48it/s] 33%|███▎      | 5/15 [00:00<00:00, 21.97it/s] 60%|██████    | 9/15 [00:00<00:00, 27.50it/s] 87%|████████▋ | 13/15 [00:00<00:00, 28.80it/s]100%|██████████| 15/15 [00:04<00:00,  3.41it/s]
2025-03-13 18:42:36,519 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:36
2025-03-13 18:43:21,097 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5773 secs
2025-03-13 18:43:21,097 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 18:43:21,097 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-13 18:43:48,298 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2000 secs
2025-03-13 18:43:48,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1821 secs
2025-03-13 18:43:48,301 [INFO]: {
2025-03-13 18:43:48,301 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:48,302 [INFO]: 	index_param: efSearch=178
2025-03-13 18:43:48,302 [INFO]: 	index_path: knn.index
2025-03-13 18:43:48,302 [INFO]: 	size in bytes: 739166950
2025-03-13 18:43:48,302 [INFO]: 	avg_search_speed_ms: 11.572707531101614
2025-03-13 18:43:48,302 [INFO]: 	99p_search_speed_ms: 20.332367299124602
2025-03-13 18:43:48,302 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:48,302 [INFO]: 	nb vectors: 3757
2025-03-13 18:43:48,302 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:48,302 [INFO]: 	compression ratio: 0.9993090951915531
2025-03-13 18:43:48,302 [INFO]: }
2025-03-13 18:43:48,302 [INFO]: 	>>> Finished "Creating the index" in 76.1839 secs
2025-03-13 18:43:48,302 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2119 secs
2025-03-13 18:43:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 8902 [episode count 5/20]
[retrieval_preprocessing] for episode 39447 [episode count 6/20], we have num_retrieval=np.int64(3761) num_query=np.int64(182)
2025-03-13 18:43:50,317 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:50,872 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:50
2025-03-13 18:43:50,872 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 977.92it/s]
2025-03-13 18:43:50,900 [INFO]: There are 3761 embeddings of dim 49152
2025-03-13 18:43:50,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:43:50,901 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:50
2025-03-13 18:43:50,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:50,901 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:43:50,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:50,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:50,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:50
2025-03-13 18:43:50,901 [INFO]: 776.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:50,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:50,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:50
2025-03-13 18:43:50,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:50,901 [INFO]: 	Creating the index 03/13/2025, 18:43:50
2025-03-13 18:43:50,901 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:50
2025-03-13 18:43:50,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:43:50,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:50
2025-03-13 18:43:50,902 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:43:50,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.04it/s] 40%|████      | 6/15 [00:00<00:00, 31.64it/s] 80%|████████  | 12/15 [00:00<00:00, 40.76it/s]100%|██████████| 15/15 [00:03<00:00,  4.44it/s]
2025-03-13 18:43:54,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:54
2025-03-13 18:44:34,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1377 secs
2025-03-13 18:44:34,420 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 18:44:34,420 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.98it/s]
2025-03-13 18:45:02,349 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9283 secs
2025-03-13 18:45:02,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4490 secs
2025-03-13 18:45:02,351 [INFO]: {
2025-03-13 18:45:02,351 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:02,351 [INFO]: 	index_param: efSearch=223
2025-03-13 18:45:02,351 [INFO]: 	index_path: knn.index
2025-03-13 18:45:02,351 [INFO]: 	size in bytes: 739953910
2025-03-13 18:45:02,351 [INFO]: 	avg_search_speed_ms: 10.847645524864989
2025-03-13 18:45:02,351 [INFO]: 	99p_search_speed_ms: 16.941215305123475
2025-03-13 18:45:02,351 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:02,351 [INFO]: 	nb vectors: 3761
2025-03-13 18:45:02,351 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:02,351 [INFO]: 	compression ratio: 0.9993091164286165
2025-03-13 18:45:02,351 [INFO]: }
2025-03-13 18:45:02,351 [INFO]: 	>>> Finished "Creating the index" in 71.4504 secs
2025-03-13 18:45:02,351 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4791 secs
2025-03-13 18:45:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 39447 [episode count 6/20]
[retrieval_preprocessing] for episode 76784 [episode count 7/20], we have num_retrieval=np.int64(3704) num_query=np.int64(239)
2025-03-13 18:45:03,956 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:04,454 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:04
2025-03-13 18:45:04,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.40it/s]
2025-03-13 18:45:04,482 [INFO]: There are 3704 embeddings of dim 49152
2025-03-13 18:45:04,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:45:04,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:04
2025-03-13 18:45:04,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:04,483 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:45:04,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:04,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:45:04,484 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:04
2025-03-13 18:45:04,484 [INFO]: 764.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:04,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:45:04,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:04
2025-03-13 18:45:04,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:04,485 [INFO]: 	Creating the index 03/13/2025, 18:45:04
2025-03-13 18:45:04,485 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:04
2025-03-13 18:45:04,488 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:45:04,488 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:04
2025-03-13 18:45:04,488 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:45:04,488 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 27.65it/s] 60%|██████    | 9/15 [00:00<00:00, 45.02it/s]100%|██████████| 15/15 [00:02<00:00,  4.31it/s]100%|██████████| 15/15 [00:02<00:00,  5.37it/s]
2025-03-13 18:45:07,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:07
2025-03-13 18:45:46,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1259 secs
2025-03-13 18:45:46,415 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 18:45:46,415 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.99it/s]
2025-03-13 18:46:06,180 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7651 secs
2025-03-13 18:46:06,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6941 secs
2025-03-13 18:46:06,182 [INFO]: {
2025-03-13 18:46:06,182 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:06,182 [INFO]: 	index_param: efSearch=154
2025-03-13 18:46:06,182 [INFO]: 	index_path: knn.index
2025-03-13 18:46:06,182 [INFO]: 	size in bytes: 728739250
2025-03-13 18:46:06,182 [INFO]: 	avg_search_speed_ms: 9.559812533302344
2025-03-13 18:46:06,182 [INFO]: 	99p_search_speed_ms: 14.692520257085556
2025-03-13 18:46:06,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:06,182 [INFO]: 	nb vectors: 3704
2025-03-13 18:46:06,182 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:06,182 [INFO]: 	compression ratio: 0.9993094676868304
2025-03-13 18:46:06,182 [INFO]: }
2025-03-13 18:46:06,182 [INFO]: 	>>> Finished "Creating the index" in 61.6979 secs
2025-03-13 18:46:06,183 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7283 secs
2025-03-13 18:46:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 76784 [episode count 7/20]
[retrieval_preprocessing] for episode 54284 [episode count 8/20], we have num_retrieval=np.int64(3794) num_query=np.int64(149)
2025-03-13 18:46:08,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:09,122 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:09
2025-03-13 18:46:09,122 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.12it/s]
2025-03-13 18:46:09,764 [INFO]: There are 3794 embeddings of dim 49152
2025-03-13 18:46:09,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6416 secs
2025-03-13 18:46:09,764 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:09
2025-03-13 18:46:09,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:09,764 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:46:09,764 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:09,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:46:09,765 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:09
2025-03-13 18:46:09,765 [INFO]: 783.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:09,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:46:09,765 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:09
2025-03-13 18:46:09,765 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:09,765 [INFO]: 	Creating the index 03/13/2025, 18:46:09
2025-03-13 18:46:09,765 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:09
2025-03-13 18:46:09,767 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:46:09,768 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:09
2025-03-13 18:46:09,768 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:46:09,768 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.95it/s] 40%|████      | 6/15 [00:00<00:00, 32.42it/s] 73%|███████▎  | 11/15 [00:00<00:00, 39.57it/s]100%|██████████| 15/15 [00:03<00:00,  3.24it/s]100%|██████████| 15/15 [00:03<00:00,  4.50it/s]
2025-03-13 18:46:13,108 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:13
2025-03-13 18:46:54,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8112 secs
2025-03-13 18:46:54,920 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:46:54,920 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.86it/s]
2025-03-13 18:47:21,222 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3023 secs
2025-03-13 18:47:21,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5019 secs
2025-03-13 18:47:21,270 [INFO]: {
2025-03-13 18:47:21,270 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:21,270 [INFO]: 	index_param: efSearch=196
2025-03-13 18:47:21,270 [INFO]: 	index_path: knn.index
2025-03-13 18:47:21,270 [INFO]: 	size in bytes: 746446390
2025-03-13 18:47:21,270 [INFO]: 	avg_search_speed_ms: 10.520714607636211
2025-03-13 18:47:21,270 [INFO]: 	99p_search_speed_ms: 14.870349084958434
2025-03-13 18:47:21,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:21,270 [INFO]: 	nb vectors: 3794
2025-03-13 18:47:21,271 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:21,271 [INFO]: 	compression ratio: 0.9993092096004376
2025-03-13 18:47:21,271 [INFO]: }
2025-03-13 18:47:21,271 [INFO]: 	>>> Finished "Creating the index" in 71.5054 secs
2025-03-13 18:47:21,271 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1483 secs
2025-03-13 18:47:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 54284 [episode count 8/20]
[retrieval_preprocessing] for episode 72723 [episode count 9/20], we have num_retrieval=np.int64(3707) num_query=np.int64(236)
2025-03-13 18:47:22,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:23,363 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:23
2025-03-13 18:47:23,363 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.90it/s]
2025-03-13 18:47:23,393 [INFO]: There are 3707 embeddings of dim 49152
2025-03-13 18:47:23,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 18:47:23,393 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,394 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:23,394 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:47:23,394 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:23,394 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:47:23,394 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,394 [INFO]: 765.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:23,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:47:23,395 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:23
2025-03-13 18:47:23,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:23,395 [INFO]: 	Creating the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,396 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:23
2025-03-13 18:47:23,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:47:23,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,399 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:47:23,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.50it/s] 40%|████      | 6/15 [00:00<00:00, 26.75it/s] 73%|███████▎  | 11/15 [00:00<00:00, 33.33it/s]100%|██████████| 15/15 [00:03<00:00,  2.81it/s]100%|██████████| 15/15 [00:03<00:00,  3.89it/s]
2025-03-13 18:47:27,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:27
2025-03-13 18:48:08,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9236 secs
2025-03-13 18:48:08,183 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:48:08,183 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-13 18:48:27,718 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5350 secs
2025-03-13 18:48:27,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3215 secs
2025-03-13 18:48:27,721 [INFO]: {
2025-03-13 18:48:27,721 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:27,721 [INFO]: 	index_param: efSearch=196
2025-03-13 18:48:27,721 [INFO]: 	index_path: knn.index
2025-03-13 18:48:27,721 [INFO]: 	size in bytes: 729329470
2025-03-13 18:48:27,721 [INFO]: 	avg_search_speed_ms: 11.599366124470885
2025-03-13 18:48:27,721 [INFO]: 	99p_search_speed_ms: 18.529902177397155
2025-03-13 18:48:27,721 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:27,721 [INFO]: 	nb vectors: 3707
2025-03-13 18:48:27,721 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:27,721 [INFO]: 	compression ratio: 0.9993094835452077
2025-03-13 18:48:27,721 [INFO]: }
2025-03-13 18:48:27,721 [INFO]: 	>>> Finished "Creating the index" in 64.3256 secs
2025-03-13 18:48:27,721 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3576 secs
2025-03-13 18:48:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 72723 [episode count 9/20]
[retrieval_preprocessing] for episode 95069 [episode count 10/20], we have num_retrieval=np.int64(3657) num_query=np.int64(286)
2025-03-13 18:48:30,044 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:30,589 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:30
2025-03-13 18:48:30,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.20it/s]
2025-03-13 18:48:30,618 [INFO]: There are 3657 embeddings of dim 49152
2025-03-13 18:48:30,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:48:30,618 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:30
2025-03-13 18:48:30,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:30,619 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:48:30,619 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:30,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:48:30,619 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:30
2025-03-13 18:48:30,620 [INFO]: 754.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:30,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:48:30,620 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:30
2025-03-13 18:48:30,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:30,620 [INFO]: 	Creating the index 03/13/2025, 18:48:30
2025-03-13 18:48:30,620 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:30
2025-03-13 18:48:30,623 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:48:30,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:30
2025-03-13 18:48:30,624 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:48:30,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.48it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.49it/s] 80%|████████  | 12/15 [00:00<00:00, 40.63it/s]100%|██████████| 15/15 [00:04<00:00,  3.70it/s]
2025-03-13 18:48:34,687 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:34
2025-03-13 18:49:11,513 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8264 secs
2025-03-13 18:49:11,514 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:49:11,514 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 18:49:38,164 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6499 secs
2025-03-13 18:49:39,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5700 secs
2025-03-13 18:49:39,194 [INFO]: {
2025-03-13 18:49:39,194 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:39,194 [INFO]: 	index_param: efSearch=216
2025-03-13 18:49:39,194 [INFO]: 	index_path: knn.index
2025-03-13 18:49:39,194 [INFO]: 	size in bytes: 719492470
2025-03-13 18:49:39,194 [INFO]: 	avg_search_speed_ms: 10.385112658042464
2025-03-13 18:49:39,195 [INFO]: 	99p_search_speed_ms: 15.146200559101999
2025-03-13 18:49:39,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:39,195 [INFO]: 	nb vectors: 3657
2025-03-13 18:49:39,195 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:39,195 [INFO]: 	compression ratio: 0.9993092158421061
2025-03-13 18:49:39,195 [INFO]: }
2025-03-13 18:49:39,195 [INFO]: 	>>> Finished "Creating the index" in 68.5745 secs
2025-03-13 18:49:39,195 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6057 secs
2025-03-13 18:49:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 95069 [episode count 10/20]
[retrieval_preprocessing] for episode 93716 [episode count 11/20], we have num_retrieval=np.int64(3769) num_query=np.int64(174)
2025-03-13 18:49:41,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:42,303 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:42
2025-03-13 18:49:42,303 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.81it/s]
2025-03-13 18:49:42,331 [INFO]: There are 3769 embeddings of dim 49152
2025-03-13 18:49:42,331 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:49:42,331 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:42
2025-03-13 18:49:42,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:42,332 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:49:42,332 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:42,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:49:42,332 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:42
2025-03-13 18:49:42,332 [INFO]: 777.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:42,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:49:42,333 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:42
2025-03-13 18:49:42,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:42,333 [INFO]: 	Creating the index 03/13/2025, 18:49:42
2025-03-13 18:49:42,333 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:42
2025-03-13 18:49:42,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:49:42,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:42
2025-03-13 18:49:42,336 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:49:42,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 25.89it/s] 60%|██████    | 9/15 [00:00<00:00, 43.54it/s]100%|██████████| 15/15 [00:02<00:00,  4.12it/s]100%|██████████| 15/15 [00:02<00:00,  5.13it/s]
2025-03-13 18:49:45,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:45
2025-03-13 18:50:30,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4368 secs
2025-03-13 18:50:30,703 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 18:50:30,703 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 18:50:51,445 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7421 secs
2025-03-13 18:50:51,447 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1111 secs
2025-03-13 18:50:51,447 [INFO]: {
2025-03-13 18:50:51,447 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:51,447 [INFO]: 	index_param: efSearch=190
2025-03-13 18:50:51,447 [INFO]: 	index_path: knn.index
2025-03-13 18:50:51,447 [INFO]: 	size in bytes: 741527830
2025-03-13 18:50:51,447 [INFO]: 	avg_search_speed_ms: 10.162929072502878
2025-03-13 18:50:51,447 [INFO]: 	99p_search_speed_ms: 18.07993246475234
2025-03-13 18:50:51,447 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:51,447 [INFO]: 	nb vectors: 3769
2025-03-13 18:50:51,447 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:51,447 [INFO]: 	compression ratio: 0.9993091587675138
2025-03-13 18:50:51,448 [INFO]: }
2025-03-13 18:50:51,448 [INFO]: 	>>> Finished "Creating the index" in 69.1147 secs
2025-03-13 18:50:51,448 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1449 secs
2025-03-13 18:50:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 93716 [episode count 11/20]
[retrieval_preprocessing] for episode 31965 [episode count 12/20], we have num_retrieval=np.int64(3705) num_query=np.int64(238)
2025-03-13 18:50:53,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:53,981 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:53
2025-03-13 18:50:53,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1691.25it/s]
2025-03-13 18:50:54,009 [INFO]: There are 3705 embeddings of dim 49152
2025-03-13 18:50:54,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:50:54,009 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:54
2025-03-13 18:50:54,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:54,009 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:50:54,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:54,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:54,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:54
2025-03-13 18:50:54,009 [INFO]: 764.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:54,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:54,010 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:54
2025-03-13 18:50:54,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:54,010 [INFO]: 	Creating the index 03/13/2025, 18:50:54
2025-03-13 18:50:54,010 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:54
2025-03-13 18:50:54,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:50:54,011 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:54
2025-03-13 18:50:54,011 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:50:54,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.10it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.49it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.38it/s]100%|██████████| 15/15 [00:03<00:00,  4.62it/s]
2025-03-13 18:50:57,264 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:57
2025-03-13 18:51:38,491 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2262 secs
2025-03-13 18:51:38,491 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 18:51:38,491 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.62it/s]
2025-03-13 18:52:01,888 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3972 secs
2025-03-13 18:52:01,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8796 secs
2025-03-13 18:52:01,891 [INFO]: {
2025-03-13 18:52:01,891 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:01,891 [INFO]: 	index_param: efSearch=190
2025-03-13 18:52:01,891 [INFO]: 	index_path: knn.index
2025-03-13 18:52:01,891 [INFO]: 	size in bytes: 728935990
2025-03-13 18:52:01,891 [INFO]: 	avg_search_speed_ms: 9.325343523763003
2025-03-13 18:52:01,891 [INFO]: 	99p_search_speed_ms: 13.089173501357434
2025-03-13 18:52:01,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:01,891 [INFO]: 	nb vectors: 3705
2025-03-13 18:52:01,891 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:01,891 [INFO]: 	compression ratio: 0.9993094729758096
2025-03-13 18:52:01,891 [INFO]: }
2025-03-13 18:52:01,891 [INFO]: 	>>> Finished "Creating the index" in 67.8814 secs
2025-03-13 18:52:01,891 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9095 secs
2025-03-13 18:52:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 31965 [episode count 12/20]
[retrieval_preprocessing] for episode 38607 [episode count 13/20], we have num_retrieval=np.int64(3766) num_query=np.int64(177)
2025-03-13 18:52:04,061 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:04,565 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:04
2025-03-13 18:52:04,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2220.38it/s]
2025-03-13 18:52:04,588 [INFO]: There are 3766 embeddings of dim 49152
2025-03-13 18:52:04,588 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 18:52:04,589 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:04
2025-03-13 18:52:04,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:04,589 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:52:04,589 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:04,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:04,589 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:04
2025-03-13 18:52:04,589 [INFO]: 777.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:04,589 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:52:04,589 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:04
2025-03-13 18:52:04,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:04,589 [INFO]: 	Creating the index 03/13/2025, 18:52:04
2025-03-13 18:52:04,589 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:04
2025-03-13 18:52:04,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:52:04,590 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:04
2025-03-13 18:52:04,590 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:52:04,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.09it/s] 53%|█████▎    | 8/15 [00:00<00:00, 36.67it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.17it/s]100%|██████████| 15/15 [00:03<00:00,  4.71it/s]
2025-03-13 18:52:07,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:07
2025-03-13 18:52:45,416 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6409 secs
2025-03-13 18:52:45,417 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:52:45,417 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.42it/s]
2025-03-13 18:53:06,229 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8119 secs
2025-03-13 18:53:06,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1428 secs
2025-03-13 18:53:06,733 [INFO]: {
2025-03-13 18:53:06,733 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:06,733 [INFO]: 	index_param: efSearch=211
2025-03-13 18:53:06,733 [INFO]: 	index_path: knn.index
2025-03-13 18:53:06,733 [INFO]: 	size in bytes: 740937610
2025-03-13 18:53:06,733 [INFO]: 	avg_search_speed_ms: 11.729253498304544
2025-03-13 18:53:06,734 [INFO]: 	99p_search_speed_ms: 18.580652447417382
2025-03-13 18:53:06,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:06,734 [INFO]: 	nb vectors: 3766
2025-03-13 18:53:06,734 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:06,734 [INFO]: 	compression ratio: 0.9993091429115064
2025-03-13 18:53:06,734 [INFO]: }
2025-03-13 18:53:06,734 [INFO]: 	>>> Finished "Creating the index" in 62.1448 secs
2025-03-13 18:53:06,734 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1685 secs
2025-03-13 18:53:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 38607 [episode count 13/20]
[retrieval_preprocessing] for episode 94897 [episode count 14/20], we have num_retrieval=np.int64(3802) num_query=np.int64(141)
2025-03-13 18:53:08,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:09,257 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:09
2025-03-13 18:53:09,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1299.35it/s]
2025-03-13 18:53:09,286 [INFO]: There are 3802 embeddings of dim 49152
2025-03-13 18:53:09,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 18:53:09,286 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:09
2025-03-13 18:53:09,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:09,286 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:53:09,286 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:09,286 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:53:09,286 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:09
2025-03-13 18:53:09,286 [INFO]: 784.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:09,286 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:53:09,286 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:09
2025-03-13 18:53:09,286 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:09,286 [INFO]: 	Creating the index 03/13/2025, 18:53:09
2025-03-13 18:53:09,287 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:09
2025-03-13 18:53:09,287 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:53:09,288 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:09
2025-03-13 18:53:09,288 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:53:09,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.27it/s] 40%|████      | 6/15 [00:00<00:00, 29.88it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.23it/s]100%|██████████| 15/15 [00:03<00:00,  3.45it/s]100%|██████████| 15/15 [00:03<00:00,  4.76it/s]
2025-03-13 18:53:12,441 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:12
2025-03-13 18:53:51,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6213 secs
2025-03-13 18:53:51,063 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 18:53:51,063 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.68it/s]
2025-03-13 18:54:15,037 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9743 secs
2025-03-13 18:54:15,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7518 secs
2025-03-13 18:54:15,039 [INFO]: {
2025-03-13 18:54:15,039 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:15,040 [INFO]: 	index_param: efSearch=230
2025-03-13 18:54:15,040 [INFO]: 	index_path: knn.index
2025-03-13 18:54:15,040 [INFO]: 	size in bytes: 748020310
2025-03-13 18:54:15,040 [INFO]: 	avg_search_speed_ms: 11.485190733563664
2025-03-13 18:54:15,040 [INFO]: 	99p_search_speed_ms: 17.386161233298456
2025-03-13 18:54:15,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:15,040 [INFO]: 	nb vectors: 3802
2025-03-13 18:54:15,040 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:15,040 [INFO]: 	compression ratio: 0.9993092513758083
2025-03-13 18:54:15,040 [INFO]: }
2025-03-13 18:54:15,040 [INFO]: 	>>> Finished "Creating the index" in 65.7532 secs
2025-03-13 18:54:15,040 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7821 secs
2025-03-13 18:54:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 94897 [episode count 14/20]
[retrieval_preprocessing] for episode 38213 [episode count 15/20], we have num_retrieval=np.int64(3759) num_query=np.int64(184)
2025-03-13 18:54:17,046 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:17,661 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:17
2025-03-13 18:54:17,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1787.85it/s]
2025-03-13 18:54:18,059 [INFO]: There are 3759 embeddings of dim 49152
2025-03-13 18:54:18,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3974 secs
2025-03-13 18:54:18,059 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:18
2025-03-13 18:54:18,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:18,059 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:54:18,059 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:18,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:54:18,060 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:18
2025-03-13 18:54:18,060 [INFO]: 775.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:18,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:54:18,060 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:18
2025-03-13 18:54:18,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:18,060 [INFO]: 	Creating the index 03/13/2025, 18:54:18
2025-03-13 18:54:18,060 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:18
2025-03-13 18:54:18,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 18:54:18,063 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:18
2025-03-13 18:54:18,063 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:54:18,063 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.98it/s] 33%|███▎      | 5/15 [00:00<00:00, 22.45it/s] 67%|██████▋   | 10/15 [00:00<00:00, 31.35it/s]100%|██████████| 15/15 [00:03<00:00,  3.52it/s]100%|██████████| 15/15 [00:03<00:00,  4.62it/s]
2025-03-13 18:54:21,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:21
2025-03-13 18:54:55,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3594 secs
2025-03-13 18:54:55,678 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 18:54:55,678 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.79it/s]
2025-03-13 18:55:15,013 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3354 secs
2025-03-13 18:55:15,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9525 secs
2025-03-13 18:55:15,015 [INFO]: {
2025-03-13 18:55:15,015 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:15,015 [INFO]: 	index_param: efSearch=181
2025-03-13 18:55:15,015 [INFO]: 	index_path: knn.index
2025-03-13 18:55:15,015 [INFO]: 	size in bytes: 739560430
2025-03-13 18:55:15,015 [INFO]: 	avg_search_speed_ms: 9.73911367369473
2025-03-13 18:55:15,016 [INFO]: 	99p_search_speed_ms: 15.309952870011333
2025-03-13 18:55:15,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:15,016 [INFO]: 	nb vectors: 3759
2025-03-13 18:55:15,016 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:15,016 [INFO]: 	compression ratio: 0.9993091058157344
2025-03-13 18:55:15,016 [INFO]: }
2025-03-13 18:55:15,016 [INFO]: 	>>> Finished "Creating the index" in 56.9553 secs
2025-03-13 18:55:15,016 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3540 secs
2025-03-13 18:55:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 38213 [episode count 15/20]
[retrieval_preprocessing] for episode 58541 [episode count 16/20], we have num_retrieval=np.int64(3740) num_query=np.int64(203)
2025-03-13 18:55:16,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:18,071 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:18
2025-03-13 18:55:18,071 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1992.54it/s]
2025-03-13 18:55:18,096 [INFO]: There are 3740 embeddings of dim 49152
2025-03-13 18:55:18,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 18:55:18,096 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:18
2025-03-13 18:55:18,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:18,096 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:55:18,096 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:18,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:55:18,096 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:18
2025-03-13 18:55:18,096 [INFO]: 771.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:18,096 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:55:18,096 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:18
2025-03-13 18:55:18,096 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:18,097 [INFO]: 	Creating the index 03/13/2025, 18:55:18
2025-03-13 18:55:18,097 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:18
2025-03-13 18:55:18,097 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:55:18,098 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:18
2025-03-13 18:55:18,098 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:55:18,098 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.69it/s] 40%|████      | 6/15 [00:00<00:00, 28.34it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.79it/s]100%|██████████| 15/15 [00:03<00:00,  3.37it/s]100%|██████████| 15/15 [00:03<00:00,  4.64it/s]
2025-03-13 18:55:21,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:21
2025-03-13 18:56:01,845 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5115 secs
2025-03-13 18:56:01,845 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 18:56:01,845 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.19it/s]
2025-03-13 18:56:28,294 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4493 secs
2025-03-13 18:56:28,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1988 secs
2025-03-13 18:56:28,297 [INFO]: {
2025-03-13 18:56:28,297 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:28,297 [INFO]: 	index_param: efSearch=183
2025-03-13 18:56:28,297 [INFO]: 	index_path: knn.index
2025-03-13 18:56:28,297 [INFO]: 	size in bytes: 735822250
2025-03-13 18:56:28,297 [INFO]: 	avg_search_speed_ms: 10.886170588974903
2025-03-13 18:56:28,297 [INFO]: 	99p_search_speed_ms: 16.42507904674858
2025-03-13 18:56:28,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:28,297 [INFO]: 	nb vectors: 3740
2025-03-13 18:56:28,297 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:28,297 [INFO]: 	compression ratio: 0.9993091673974251
2025-03-13 18:56:28,297 [INFO]: }
2025-03-13 18:56:28,297 [INFO]: 	>>> Finished "Creating the index" in 70.2004 secs
2025-03-13 18:56:28,297 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2261 secs
2025-03-13 18:56:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 58541 [episode count 16/20]
[retrieval_preprocessing] for episode 11732 [episode count 17/20], we have num_retrieval=np.int64(3777) num_query=np.int64(166)
2025-03-13 18:56:32,112 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:32,675 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:32
2025-03-13 18:56:32,675 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 976.78it/s]
2025-03-13 18:56:32,701 [INFO]: There are 3777 embeddings of dim 49152
2025-03-13 18:56:32,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:56:32,701 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:32,701 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:56:32,701 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:32,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:32,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,701 [INFO]: 779.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:32,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:56:32,701 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:32
2025-03-13 18:56:32,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:32,701 [INFO]: 	Creating the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:32
2025-03-13 18:56:32,702 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:56:32,703 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:32
2025-03-13 18:56:32,703 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:56:32,703 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.08it/s] 53%|█████▎    | 8/15 [00:00<00:00, 36.95it/s] 93%|█████████▎| 14/15 [00:00<00:00, 43.07it/s]100%|██████████| 15/15 [00:03<00:00,  4.95it/s]
2025-03-13 18:56:35,736 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:35
2025-03-13 18:57:16,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0560 secs
2025-03-13 18:57:16,793 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 18:57:16,793 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.24it/s]
2025-03-13 18:57:40,284 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4912 secs
2025-03-13 18:57:40,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5835 secs
2025-03-13 18:57:40,286 [INFO]: {
2025-03-13 18:57:40,286 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:40,286 [INFO]: 	index_param: efSearch=198
2025-03-13 18:57:40,286 [INFO]: 	index_path: knn.index
2025-03-13 18:57:40,286 [INFO]: 	size in bytes: 743101750
2025-03-13 18:57:40,286 [INFO]: 	avg_search_speed_ms: 10.09551868618933
2025-03-13 18:57:40,286 [INFO]: 	99p_search_speed_ms: 14.125866908580065
2025-03-13 18:57:40,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:40,286 [INFO]: 	nb vectors: 3777
2025-03-13 18:57:40,286 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:40,286 [INFO]: 	compression ratio: 0.9993092009270601
2025-03-13 18:57:40,286 [INFO]: }
2025-03-13 18:57:40,286 [INFO]: 	>>> Finished "Creating the index" in 67.5850 secs
2025-03-13 18:57:40,286 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6113 secs
2025-03-13 18:57:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 11732 [episode count 17/20]
[retrieval_preprocessing] for episode 15162 [episode count 18/20], we have num_retrieval=np.int64(3724) num_query=np.int64(219)
2025-03-13 18:57:41,727 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:42,220 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:42
2025-03-13 18:57:42,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1814.15it/s]
2025-03-13 18:57:42,513 [INFO]: There are 3724 embeddings of dim 49152
2025-03-13 18:57:42,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2929 secs
2025-03-13 18:57:42,513 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:42
2025-03-13 18:57:42,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:42,513 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:57:42,513 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:42,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:57:42,513 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:42
2025-03-13 18:57:42,513 [INFO]: 768.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:42,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:57:42,513 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:42
2025-03-13 18:57:42,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:42,513 [INFO]: 	Creating the index 03/13/2025, 18:57:42
2025-03-13 18:57:42,513 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:42
2025-03-13 18:57:42,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:57:42,514 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:42
2025-03-13 18:57:42,514 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:57:42,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.82it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.06it/s] 80%|████████  | 12/15 [00:00<00:00, 37.14it/s]100%|██████████| 15/15 [00:04<00:00,  3.55it/s]
2025-03-13 18:57:46,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:46
2025-03-13 18:58:28,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4509 secs
2025-03-13 18:58:28,201 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:58:28,201 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.03it/s]
2025-03-13 18:58:55,145 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9440 secs
2025-03-13 18:58:55,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6328 secs
2025-03-13 18:58:55,147 [INFO]: {
2025-03-13 18:58:55,147 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:55,147 [INFO]: 	index_param: efSearch=197
2025-03-13 18:58:55,147 [INFO]: 	index_path: knn.index
2025-03-13 18:58:55,147 [INFO]: 	size in bytes: 732674170
2025-03-13 18:58:55,147 [INFO]: 	avg_search_speed_ms: 9.48170705089319
2025-03-13 18:58:55,147 [INFO]: 	99p_search_speed_ms: 13.071383046917623
2025-03-13 18:58:55,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:55,147 [INFO]: 	nb vectors: 3724
2025-03-13 18:58:55,147 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:55,147 [INFO]: 	compression ratio: 0.9993094092562319
2025-03-13 18:58:55,148 [INFO]: }
2025-03-13 18:58:55,148 [INFO]: 	>>> Finished "Creating the index" in 72.6341 secs
2025-03-13 18:58:55,148 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9276 secs
2025-03-13 18:58:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 15162 [episode count 18/20]
[retrieval_preprocessing] for episode 62112 [episode count 19/20], we have num_retrieval=np.int64(3684) num_query=np.int64(259)
2025-03-13 18:58:57,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:58,024 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:58
2025-03-13 18:58:58,024 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 961.78it/s]
2025-03-13 18:58:58,054 [INFO]: There are 3684 embeddings of dim 49152
2025-03-13 18:58:58,055 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:58:58,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:58
2025-03-13 18:58:58,056 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:58,056 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:58:58,056 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:58,056 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:58:58,056 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:58
2025-03-13 18:58:58,057 [INFO]: 760.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:58,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:58:58,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:58
2025-03-13 18:58:58,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:58,057 [INFO]: 	Creating the index 03/13/2025, 18:58:58
2025-03-13 18:58:58,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:58
2025-03-13 18:58:58,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:58:58,061 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:58
2025-03-13 18:58:58,061 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:58:58,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.66it/s] 47%|████▋     | 7/15 [00:00<00:00, 37.19it/s] 80%|████████  | 12/15 [00:00<00:00, 42.86it/s]100%|██████████| 15/15 [00:03<00:00,  4.89it/s]
2025-03-13 18:59:01,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:01
2025-03-13 18:59:37,899 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7670 secs
2025-03-13 18:59:37,899 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 18:59:37,899 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.43it/s]
2025-03-13 19:00:06,576 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6769 secs
2025-03-13 19:00:06,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5175 secs
2025-03-13 19:00:06,579 [INFO]: {
2025-03-13 19:00:06,579 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:06,579 [INFO]: 	index_param: efSearch=210
2025-03-13 19:00:06,579 [INFO]: 	index_path: knn.index
2025-03-13 19:00:06,579 [INFO]: 	size in bytes: 724804450
2025-03-13 19:00:06,579 [INFO]: 	avg_search_speed_ms: 9.724130837945493
2025-03-13 19:00:06,579 [INFO]: 	99p_search_speed_ms: 14.023378333076847
2025-03-13 19:00:06,579 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:06,579 [INFO]: 	nb vectors: 3684
2025-03-13 19:00:06,579 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:06,579 [INFO]: 	compression ratio: 0.99930936130428
2025-03-13 19:00:06,579 [INFO]: }
2025-03-13 19:00:06,579 [INFO]: 	>>> Finished "Creating the index" in 68.5215 secs
2025-03-13 19:00:06,579 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5545 secs
2025-03-13 19:00:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 62112 [episode count 19/20]
2025-03-13 19:00:10: [retrieval_preprocessing] finished for 1656877278_remove_towel_from_bowl [chosen_id count 8/196]
2025-03-13 19:00:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_remove_cups_from_tray [chosen_id count 9/196]
2025-03-13 19:00:13: [retrieval_preprocessing] we have num_total=8673 embedding_dim=49152
[retrieval_preprocessing] for episode 92229 [episode count 0/20], we have num_retrieval=np.int64(8310) num_query=np.int64(363)
2025-03-13 19:00:14,579 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:15,847 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:15
2025-03-13 19:00:15,847 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.92it/s]
2025-03-13 19:00:15,876 [INFO]: There are 8310 embeddings of dim 49152
2025-03-13 19:00:15,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 19:00:15,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:15
2025-03-13 19:00:15,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:15,876 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:00:15,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:15,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:00:15,876 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:15
2025-03-13 19:00:15,877 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:15,877 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:00:15,877 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:15
2025-03-13 19:00:15,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:15,877 [INFO]: 	Creating the index 03/13/2025, 19:00:15
2025-03-13 19:00:15,877 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:15
2025-03-13 19:00:15,878 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:00:15,878 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:15
2025-03-13 19:00:15,878 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:00:15,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  8.50it/s] 18%|█▊        | 6/34 [00:00<00:00, 28.68it/s] 32%|███▏      | 11/34 [00:00<00:00, 35.95it/s] 47%|████▋     | 16/34 [00:00<00:00, 39.24it/s] 62%|██████▏   | 21/34 [00:04<00:04,  3.00it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.51it/s] 94%|█████████▍| 32/34 [00:04<00:00,  6.93it/s]100%|██████████| 34/34 [00:07<00:00,  4.45it/s]
2025-03-13 19:00:23,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:23
2025-03-13 19:01:30,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.0100 secs
2025-03-13 19:01:30,540 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 19:01:30,540 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.49it/s]
2025-03-13 19:02:15,124 [INFO]: 	>>> Finished "Compute fast metrics" in 44.5841 secs
2025-03-13 19:02:15,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.2483 secs
2025-03-13 19:02:15,127 [INFO]: {
2025-03-13 19:02:15,127 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:15,127 [INFO]: 	index_param: efSearch=234
2025-03-13 19:02:15,127 [INFO]: 	index_path: knn.index
2025-03-13 19:02:15,127 [INFO]: 	size in bytes: 1634943370
2025-03-13 19:02:15,127 [INFO]: 	avg_search_speed_ms: 11.473871745092264
2025-03-13 19:02:15,127 [INFO]: 	99p_search_speed_ms: 16.808923243079334
2025-03-13 19:02:15,127 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:15,127 [INFO]: 	nb vectors: 8310
2025-03-13 19:02:15,127 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:15,127 [INFO]: 	compression ratio: 0.999308300201248
2025-03-13 19:02:15,127 [INFO]: }
2025-03-13 19:02:15,127 [INFO]: 	>>> Finished "Creating the index" in 119.2506 secs
2025-03-13 19:02:15,127 [INFO]: >>> Finished "Launching the whole pipeline" in 119.2808 secs
2025-03-13 19:02:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 92229 [episode count 0/20]
[retrieval_preprocessing] for episode 33020 [episode count 1/20], we have num_retrieval=np.int64(8224) num_query=np.int64(449)
2025-03-13 19:02:19,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:20,469 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:20
2025-03-13 19:02:20,469 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1303.79it/s]
2025-03-13 19:02:21,272 [INFO]: There are 8224 embeddings of dim 49152
2025-03-13 19:02:21,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.8032 secs
2025-03-13 19:02:21,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:21
2025-03-13 19:02:21,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:21,273 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:02:21,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:21,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:02:21,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:21
2025-03-13 19:02:21,273 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:21,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:02:21,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:21
2025-03-13 19:02:21,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:21,274 [INFO]: 	Creating the index 03/13/2025, 19:02:21
2025-03-13 19:02:21,274 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:21
2025-03-13 19:02:21,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:02:21,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:21
2025-03-13 19:02:21,276 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:02:21,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  6%|▌         | 2/34 [00:00<00:01, 16.74it/s] 21%|██        | 7/34 [00:00<00:00, 34.05it/s] 35%|███▌      | 12/34 [00:00<00:00, 40.06it/s] 50%|█████     | 17/34 [00:00<00:00, 42.84it/s] 65%|██████▍   | 22/34 [00:04<00:03,  3.03it/s] 79%|███████▉  | 27/34 [00:04<00:01,  4.51it/s] 94%|█████████▍| 32/34 [00:04<00:00,  6.47it/s]100%|██████████| 34/34 [00:08<00:00,  4.12it/s]
2025-03-13 19:02:29,526 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:29
2025-03-13 19:03:38,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.5694 secs
2025-03-13 19:03:38,096 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 19:03:38,096 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.70it/s]
2025-03-13 19:04:10,951 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8550 secs
2025-03-13 19:04:10,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.6772 secs
2025-03-13 19:04:10,954 [INFO]: {
2025-03-13 19:04:10,954 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:10,954 [INFO]: 	index_param: efSearch=200
2025-03-13 19:04:10,954 [INFO]: 	index_path: knn.index
2025-03-13 19:04:10,954 [INFO]: 	size in bytes: 1618023550
2025-03-13 19:04:10,954 [INFO]: 	avg_search_speed_ms: 9.900293948986373
2025-03-13 19:04:10,954 [INFO]: 	99p_search_speed_ms: 14.521935288794335
2025-03-13 19:04:10,954 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:10,954 [INFO]: 	nb vectors: 8224
2025-03-13 19:04:10,954 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:10,954 [INFO]: 	compression ratio: 0.9993081942472345
2025-03-13 19:04:10,954 [INFO]: }
2025-03-13 19:04:10,954 [INFO]: 	>>> Finished "Creating the index" in 109.6801 secs
2025-03-13 19:04:10,954 [INFO]: >>> Finished "Launching the whole pipeline" in 110.4845 secs
2025-03-13 19:04:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 33020 [episode count 1/20]
[retrieval_preprocessing] for episode 12543 [episode count 2/20], we have num_retrieval=np.int64(8345) num_query=np.int64(328)
2025-03-13 19:04:14,911 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:16,125 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:16
2025-03-13 19:04:16,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.37it/s]
2025-03-13 19:04:16,154 [INFO]: There are 8345 embeddings of dim 49152
2025-03-13 19:04:16,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 19:04:16,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:16,154 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:04:16,154 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:04:16,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:04:16,154 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,154 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:16,154 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:04:16,154 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:16
2025-03-13 19:04:16,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:16,154 [INFO]: 	Creating the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:16
2025-03-13 19:04:16,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:04:16,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,156 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:04:16,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.20it/s] 12%|█▏        | 4/34 [00:00<00:01, 16.19it/s] 29%|██▉       | 10/34 [00:00<00:00, 30.83it/s] 47%|████▋     | 16/34 [00:00<00:00, 38.94it/s] 62%|██████▏   | 21/34 [00:05<00:04,  2.78it/s] 74%|███████▎  | 25/34 [00:05<00:02,  3.85it/s] 88%|████████▊ | 30/34 [00:05<00:00,  5.64it/s]100%|██████████| 34/34 [00:09<00:00,  2.56it/s]100%|██████████| 34/34 [00:09<00:00,  3.76it/s]
2025-03-13 19:04:25,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:25
2025-03-13 19:05:28,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7343 secs
2025-03-13 19:05:28,930 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 19:05:28,930 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.21it/s]
2025-03-13 19:06:25,582 [INFO]: 	>>> Finished "Compute fast metrics" in 56.6520 secs
2025-03-13 19:06:25,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.4287 secs
2025-03-13 19:06:25,585 [INFO]: {
2025-03-13 19:06:25,585 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:25,585 [INFO]: 	index_param: efSearch=166
2025-03-13 19:06:25,585 [INFO]: 	index_path: knn.index
2025-03-13 19:06:25,585 [INFO]: 	size in bytes: 1641829330
2025-03-13 19:06:25,585 [INFO]: 	avg_search_speed_ms: 8.313737544505946
2025-03-13 19:06:25,585 [INFO]: 	99p_search_speed_ms: 11.004526568576694
2025-03-13 19:06:25,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:25,585 [INFO]: 	nb vectors: 8345
2025-03-13 19:06:25,585 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:25,585 [INFO]: 	compression ratio: 0.9993083507650579
2025-03-13 19:06:25,585 [INFO]: }
2025-03-13 19:06:25,585 [INFO]: 	>>> Finished "Creating the index" in 129.4305 secs
2025-03-13 19:06:25,585 [INFO]: >>> Finished "Launching the whole pipeline" in 129.4600 secs
2025-03-13 19:06:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 12543 [episode count 2/20]
[retrieval_preprocessing] for episode 49414 [episode count 3/20], we have num_retrieval=np.int64(8142) num_query=np.int64(531)
2025-03-13 19:06:29,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:30,933 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:30
2025-03-13 19:06:30,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.20it/s]
2025-03-13 19:06:30,963 [INFO]: There are 8142 embeddings of dim 49152
2025-03-13 19:06:30,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 19:06:30,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:30
2025-03-13 19:06:30,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:30,963 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:06:30,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:30,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:30,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:30
2025-03-13 19:06:30,964 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:30,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:06:30,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:30
2025-03-13 19:06:30,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:30,964 [INFO]: 	Creating the index 03/13/2025, 19:06:30
2025-03-13 19:06:30,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:30
2025-03-13 19:06:30,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:06:30,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:30
2025-03-13 19:06:30,965 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:06:30,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.47it/s] 18%|█▊        | 6/34 [00:00<00:01, 25.01it/s] 32%|███▏      | 11/34 [00:00<00:00, 32.47it/s] 47%|████▋     | 16/34 [00:00<00:00, 36.21it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.99it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.48it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.42it/s]100%|██████████| 34/34 [00:08<00:00,  4.11it/s]
2025-03-13 19:06:39,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:39
2025-03-13 19:07:36,023 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7779 secs
2025-03-13 19:07:36,024 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 19:07:36,024 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.05it/s]
2025-03-13 19:08:27,669 [INFO]: 	>>> Finished "Compute fast metrics" in 51.6450 secs
2025-03-13 19:08:27,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.7059 secs
2025-03-13 19:08:27,671 [INFO]: {
2025-03-13 19:08:27,671 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:27,671 [INFO]: 	index_param: efSearch=179
2025-03-13 19:08:27,671 [INFO]: 	index_path: knn.index
2025-03-13 19:08:27,671 [INFO]: 	size in bytes: 1601890390
2025-03-13 19:08:27,671 [INFO]: 	avg_search_speed_ms: 9.995557634126428
2025-03-13 19:08:27,671 [INFO]: 	99p_search_speed_ms: 13.96678714081645
2025-03-13 19:08:27,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:27,671 [INFO]: 	nb vectors: 8142
2025-03-13 19:08:27,671 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:27,671 [INFO]: 	compression ratio: 0.9993082835087113
2025-03-13 19:08:27,671 [INFO]: }
2025-03-13 19:08:27,671 [INFO]: 	>>> Finished "Creating the index" in 116.7077 secs
2025-03-13 19:08:27,671 [INFO]: >>> Finished "Launching the whole pipeline" in 116.7383 secs
2025-03-13 19:08:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 49414 [episode count 3/20]
[retrieval_preprocessing] for episode 92443 [episode count 4/20], we have num_retrieval=np.int64(8310) num_query=np.int64(363)
2025-03-13 19:08:34,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:36,261 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:36
2025-03-13 19:08:36,262 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.82it/s]
2025-03-13 19:08:36,294 [INFO]: There are 8310 embeddings of dim 49152
2025-03-13 19:08:36,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 19:08:36,295 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:36
2025-03-13 19:08:36,296 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:36,296 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:08:36,296 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:36,296 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:08:36,296 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:36
2025-03-13 19:08:36,297 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:36,297 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:08:36,297 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:36
2025-03-13 19:08:36,297 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:36,297 [INFO]: 	Creating the index 03/13/2025, 19:08:36
2025-03-13 19:08:36,298 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:36
2025-03-13 19:08:36,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:08:36,301 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:36
2025-03-13 19:08:36,301 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:08:36,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  8.04it/s] 18%|█▊        | 6/34 [00:00<00:01, 27.66it/s] 32%|███▏      | 11/34 [00:00<00:00, 34.60it/s] 47%|████▋     | 16/34 [00:00<00:00, 38.94it/s] 62%|██████▏   | 21/34 [00:04<00:03,  3.25it/s] 74%|███████▎  | 25/34 [00:04<00:01,  4.52it/s] 88%|████████▊ | 30/34 [00:04<00:00,  6.59it/s]100%|██████████| 34/34 [00:08<00:00,  2.62it/s]100%|██████████| 34/34 [00:08<00:00,  4.11it/s]
2025-03-13 19:08:44,580 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:44
2025-03-13 19:09:43,513 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9322 secs
2025-03-13 19:09:43,513 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 19:09:43,513 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 19:10:16,127 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6140 secs
2025-03-13 19:10:16,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.8279 secs
2025-03-13 19:10:16,129 [INFO]: {
2025-03-13 19:10:16,129 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:16,129 [INFO]: 	index_param: efSearch=202
2025-03-13 19:10:16,129 [INFO]: 	index_path: knn.index
2025-03-13 19:10:16,129 [INFO]: 	size in bytes: 1634943370
2025-03-13 19:10:16,129 [INFO]: 	avg_search_speed_ms: 10.916655784062065
2025-03-13 19:10:16,129 [INFO]: 	99p_search_speed_ms: 16.882317001000047
2025-03-13 19:10:16,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:16,129 [INFO]: 	nb vectors: 8310
2025-03-13 19:10:16,129 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:16,129 [INFO]: 	compression ratio: 0.999308300201248
2025-03-13 19:10:16,129 [INFO]: }
2025-03-13 19:10:16,129 [INFO]: 	>>> Finished "Creating the index" in 99.8319 secs
2025-03-13 19:10:16,129 [INFO]: >>> Finished "Launching the whole pipeline" in 99.8679 secs
2025-03-13 19:10:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 92443 [episode count 4/20]
[retrieval_preprocessing] for episode 39277 [episode count 5/20], we have num_retrieval=np.int64(8285) num_query=np.int64(388)
2025-03-13 19:10:19,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:20,385 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:20
2025-03-13 19:10:20,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 983.19it/s]
2025-03-13 19:10:20,412 [INFO]: There are 8285 embeddings of dim 49152
2025-03-13 19:10:20,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 19:10:20,413 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:20
2025-03-13 19:10:20,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:20,413 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:10:20,413 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:20,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:20,413 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:20
2025-03-13 19:10:20,413 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:20,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:10:20,413 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:20
2025-03-13 19:10:20,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:20,413 [INFO]: 	Creating the index 03/13/2025, 19:10:20
2025-03-13 19:10:20,413 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:20
2025-03-13 19:10:20,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:10:20,415 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:20
2025-03-13 19:10:20,415 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:10:20,415 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  8.80it/s] 18%|█▊        | 6/34 [00:00<00:00, 31.53it/s] 32%|███▏      | 11/34 [00:00<00:00, 39.62it/s] 50%|█████     | 17/34 [00:00<00:00, 44.33it/s] 65%|██████▍   | 22/34 [00:04<00:03,  3.61it/s] 82%|████████▏ | 28/34 [00:04<00:01,  5.64it/s]100%|██████████| 34/34 [00:07<00:00,  3.30it/s]100%|██████████| 34/34 [00:07<00:00,  4.65it/s]
2025-03-13 19:10:27,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:27
2025-03-13 19:11:35,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.5203 secs
2025-03-13 19:11:35,252 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 19:11:35,252 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 19:12:02,170 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9180 secs
2025-03-13 19:12:02,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.7582 secs
2025-03-13 19:12:02,173 [INFO]: {
2025-03-13 19:12:02,173 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:02,173 [INFO]: 	index_param: efSearch=194
2025-03-13 19:12:02,173 [INFO]: 	index_path: knn.index
2025-03-13 19:12:02,173 [INFO]: 	size in bytes: 1630024810
2025-03-13 19:12:02,173 [INFO]: 	avg_search_speed_ms: 10.91220604094312
2025-03-13 19:12:02,173 [INFO]: 	99p_search_speed_ms: 19.195696758106354
2025-03-13 19:12:02,173 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:02,173 [INFO]: 	nb vectors: 8285
2025-03-13 19:12:02,173 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:02,173 [INFO]: 	compression ratio: 0.9993082743323398
2025-03-13 19:12:02,173 [INFO]: }
2025-03-13 19:12:02,173 [INFO]: 	>>> Finished "Creating the index" in 101.7599 secs
2025-03-13 19:12:02,173 [INFO]: >>> Finished "Launching the whole pipeline" in 101.7881 secs
2025-03-13 19:12:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 39277 [episode count 5/20]
[retrieval_preprocessing] for episode 35247 [episode count 6/20], we have num_retrieval=np.int64(8201) num_query=np.int64(472)
2025-03-13 19:12:05,825 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:07,339 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:07
2025-03-13 19:12:07,340 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.63it/s]
2025-03-13 19:12:07,369 [INFO]: There are 8201 embeddings of dim 49152
2025-03-13 19:12:07,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 19:12:07,370 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:07
2025-03-13 19:12:07,370 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:07,370 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:12:07,370 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:07,370 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:12:07,370 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:07
2025-03-13 19:12:07,370 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:07,370 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:12:07,370 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:07
2025-03-13 19:12:07,370 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:07,370 [INFO]: 	Creating the index 03/13/2025, 19:12:07
2025-03-13 19:12:07,370 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:07
2025-03-13 19:12:07,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:12:07,372 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:07
2025-03-13 19:12:07,372 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:12:07,372 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  8.65it/s] 18%|█▊        | 6/34 [00:00<00:00, 30.07it/s] 32%|███▏      | 11/34 [00:00<00:00, 38.12it/s] 47%|████▋     | 16/34 [00:00<00:00, 42.09it/s] 62%|██████▏   | 21/34 [00:04<00:03,  3.27it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.88it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.99it/s]100%|██████████| 34/34 [00:07<00:00,  4.75it/s]
2025-03-13 19:12:14,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:14
2025-03-13 19:13:17,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.4011 secs
2025-03-13 19:13:17,934 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 19:13:17,934 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.69it/s]
2025-03-13 19:13:47,926 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9920 secs
2025-03-13 19:13:47,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.5567 secs
2025-03-13 19:13:47,928 [INFO]: {
2025-03-13 19:13:47,928 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:47,929 [INFO]: 	index_param: efSearch=187
2025-03-13 19:13:47,929 [INFO]: 	index_path: knn.index
2025-03-13 19:13:47,929 [INFO]: 	size in bytes: 1613498530
2025-03-13 19:13:47,929 [INFO]: 	avg_search_speed_ms: 10.181320316676057
2025-03-13 19:13:47,929 [INFO]: 	99p_search_speed_ms: 15.05925749894231
2025-03-13 19:13:47,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:47,929 [INFO]: 	nb vectors: 8201
2025-03-13 19:13:47,929 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:47,929 [INFO]: 	compression ratio: 0.9993081357192188
2025-03-13 19:13:47,929 [INFO]: }
2025-03-13 19:13:47,929 [INFO]: 	>>> Finished "Creating the index" in 100.5583 secs
2025-03-13 19:13:47,929 [INFO]: >>> Finished "Launching the whole pipeline" in 100.5891 secs
2025-03-13 19:13:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 35247 [episode count 6/20]
[retrieval_preprocessing] for episode 84680 [episode count 7/20], we have num_retrieval=np.int64(8289) num_query=np.int64(384)
2025-03-13 19:13:51,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:52,889 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:52
2025-03-13 19:13:52,889 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.49it/s]
2025-03-13 19:13:52,917 [INFO]: There are 8289 embeddings of dim 49152
2025-03-13 19:13:52,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:13:52,918 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,918 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:52,918 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:13:52,918 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:52,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:52,918 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,918 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:52,918 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:13:52,918 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:52
2025-03-13 19:13:52,918 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:52,918 [INFO]: 	Creating the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,918 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:52
2025-03-13 19:13:52,919 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:13:52,920 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:52
2025-03-13 19:13:52,920 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:13:52,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.74it/s] 21%|██        | 7/34 [00:00<00:00, 32.39it/s] 38%|███▊      | 13/34 [00:00<00:00, 41.41it/s] 56%|█████▌    | 19/34 [00:00<00:00, 46.00it/s] 71%|███████   | 24/34 [00:03<00:02,  3.89it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.30it/s]100%|██████████| 34/34 [00:06<00:00,  5.06it/s]
2025-03-13 19:13:59,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:59
2025-03-13 19:14:58,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.6227 secs
2025-03-13 19:14:58,264 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 19:14:58,264 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.44it/s]
2025-03-13 19:15:31,045 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7814 secs
2025-03-13 19:15:31,048 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.1285 secs
2025-03-13 19:15:31,048 [INFO]: {
2025-03-13 19:15:31,048 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:31,049 [INFO]: 	index_param: efSearch=187
2025-03-13 19:15:31,049 [INFO]: 	index_path: knn.index
2025-03-13 19:15:31,049 [INFO]: 	size in bytes: 1630811770
2025-03-13 19:15:31,049 [INFO]: 	avg_search_speed_ms: 11.100636907964697
2025-03-13 19:15:31,049 [INFO]: 	99p_search_speed_ms: 17.587287379428744
2025-03-13 19:15:31,049 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:31,049 [INFO]: 	nb vectors: 8289
2025-03-13 19:15:31,049 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:31,049 [INFO]: 	compression ratio: 0.9993082843644181
2025-03-13 19:15:31,049 [INFO]: }
2025-03-13 19:15:31,049 [INFO]: 	>>> Finished "Creating the index" in 98.1304 secs
2025-03-13 19:15:31,049 [INFO]: >>> Finished "Launching the whole pipeline" in 98.1593 secs
2025-03-13 19:15:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 84680 [episode count 7/20]
[retrieval_preprocessing] for episode 17496 [episode count 8/20], we have num_retrieval=np.int64(8090) num_query=np.int64(583)
2025-03-13 19:15:36,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:38,264 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:38
2025-03-13 19:15:38,264 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1794.74it/s]
2025-03-13 19:15:38,572 [INFO]: There are 8090 embeddings of dim 49152
2025-03-13 19:15:38,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3080 secs
2025-03-13 19:15:38,573 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:38
2025-03-13 19:15:38,573 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:38,573 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:15:38,573 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:38,573 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:15:38,573 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:38
2025-03-13 19:15:38,574 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:38,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:15:38,574 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:38
2025-03-13 19:15:38,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:38,574 [INFO]: 	Creating the index 03/13/2025, 19:15:38
2025-03-13 19:15:38,574 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:38
2025-03-13 19:15:38,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 19:15:38,577 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:38
2025-03-13 19:15:38,577 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:15:38,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  6.80it/s] 15%|█▌        | 5/33 [00:00<00:01, 22.88it/s] 30%|███       | 10/33 [00:00<00:00, 31.26it/s] 45%|████▌     | 15/33 [00:00<00:00, 35.07it/s] 58%|█████▊    | 19/33 [00:00<00:00, 36.51it/s] 70%|██████▉   | 23/33 [00:05<00:04,  2.22it/s] 85%|████████▍ | 28/33 [00:05<00:01,  3.43it/s]100%|██████████| 33/33 [00:08<00:00,  2.54it/s]100%|██████████| 33/33 [00:08<00:00,  3.72it/s]
2025-03-13 19:15:47,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:47
2025-03-13 19:16:48,077 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6271 secs
2025-03-13 19:16:48,077 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 19:16:48,077 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 19:17:11,858 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7800 secs
2025-03-13 19:17:11,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.2826 secs
2025-03-13 19:17:11,860 [INFO]: {
2025-03-13 19:17:11,860 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:11,860 [INFO]: 	index_param: efSearch=209
2025-03-13 19:17:11,860 [INFO]: 	index_path: knn.index
2025-03-13 19:17:11,860 [INFO]: 	size in bytes: 1591659850
2025-03-13 19:17:11,860 [INFO]: 	avg_search_speed_ms: 11.7904254732838
2025-03-13 19:17:11,860 [INFO]: 	99p_search_speed_ms: 18.527609752491117
2025-03-13 19:17:11,860 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:11,860 [INFO]: 	nb vectors: 8090
2025-03-13 19:17:11,860 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:11,860 [INFO]: 	compression ratio: 0.9993081876130757
2025-03-13 19:17:11,860 [INFO]: }
2025-03-13 19:17:11,860 [INFO]: 	>>> Finished "Creating the index" in 93.2857 secs
2025-03-13 19:17:11,860 [INFO]: >>> Finished "Launching the whole pipeline" in 93.5957 secs
2025-03-13 19:17:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 17496 [episode count 8/20]
[retrieval_preprocessing] for episode 78940 [episode count 9/20], we have num_retrieval=np.int64(8191) num_query=np.int64(482)
2025-03-13 19:17:16,886 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:18,136 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:18
2025-03-13 19:17:18,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 904.72it/s]
2025-03-13 19:17:18,165 [INFO]: There are 8191 embeddings of dim 49152
2025-03-13 19:17:18,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 19:17:18,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:18
2025-03-13 19:17:18,166 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:18,166 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:17:18,166 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:18,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:17:18,166 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:18
2025-03-13 19:17:18,166 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:18,166 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:17:18,166 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:18
2025-03-13 19:17:18,166 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:18,166 [INFO]: 	Creating the index 03/13/2025, 19:17:18
2025-03-13 19:17:18,166 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:18
2025-03-13 19:17:18,167 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:17:18,167 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:18
2025-03-13 19:17:18,167 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:17:18,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.00it/s] 21%|██        | 7/34 [00:00<00:00, 32.95it/s] 38%|███▊      | 13/34 [00:00<00:00, 43.15it/s] 56%|█████▌    | 19/34 [00:00<00:00, 48.06it/s] 74%|███████▎  | 25/34 [00:04<00:02,  3.97it/s] 91%|█████████ | 31/34 [00:04<00:00,  5.93it/s]100%|██████████| 34/34 [00:06<00:00,  4.90it/s]
2025-03-13 19:17:25,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:25
2025-03-13 19:18:26,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6769 secs
2025-03-13 19:18:26,787 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 19:18:26,787 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-13 19:18:59,572 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7849 secs
2025-03-13 19:18:59,574 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.4068 secs
2025-03-13 19:18:59,575 [INFO]: {
2025-03-13 19:18:59,575 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:59,575 [INFO]: 	index_param: efSearch=195
2025-03-13 19:18:59,575 [INFO]: 	index_path: knn.index
2025-03-13 19:18:59,575 [INFO]: 	size in bytes: 1611531070
2025-03-13 19:18:59,575 [INFO]: 	avg_search_speed_ms: 9.813840848542712
2025-03-13 19:18:59,575 [INFO]: 	99p_search_speed_ms: 15.372880678623908
2025-03-13 19:18:59,575 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:59,575 [INFO]: 	nb vectors: 8191
2025-03-13 19:18:59,575 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:59,575 [INFO]: 	compression ratio: 0.9993081473756507
2025-03-13 19:18:59,575 [INFO]: }
2025-03-13 19:18:59,575 [INFO]: 	>>> Finished "Creating the index" in 101.4087 secs
2025-03-13 19:18:59,575 [INFO]: >>> Finished "Launching the whole pipeline" in 101.4387 secs
2025-03-13 19:19:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 78940 [episode count 9/20]
[retrieval_preprocessing] for episode 89957 [episode count 10/20], we have num_retrieval=np.int64(8129) num_query=np.int64(544)
2025-03-13 19:19:03,834 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:04,919 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:04
2025-03-13 19:19:04,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.36it/s]
2025-03-13 19:19:04,959 [INFO]: There are 8129 embeddings of dim 49152
2025-03-13 19:19:04,959 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 19:19:04,960 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:04
2025-03-13 19:19:04,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:04,960 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:19:04,960 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:04,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:19:04,960 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:04
2025-03-13 19:19:04,960 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:04,960 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:19:04,960 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:04
2025-03-13 19:19:04,961 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:04,961 [INFO]: 	Creating the index 03/13/2025, 19:19:04
2025-03-13 19:19:04,961 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:04
2025-03-13 19:19:04,963 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 19:19:04,963 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:04
2025-03-13 19:19:04,964 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:19:04,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.59it/s] 18%|█▊        | 6/33 [00:00<00:00, 31.18it/s] 33%|███▎      | 11/33 [00:00<00:00, 38.28it/s] 48%|████▊     | 16/33 [00:00<00:00, 41.62it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.20it/s] 79%|███████▉  | 26/33 [00:04<00:01,  4.77it/s] 94%|█████████▍| 31/33 [00:04<00:00,  6.85it/s]100%|██████████| 33/33 [00:07<00:00,  4.49it/s]
2025-03-13 19:19:12,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:12
2025-03-13 19:20:13,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.7786 secs
2025-03-13 19:20:13,093 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 19:20:13,093 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.30it/s]
2025-03-13 19:20:32,126 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0332 secs
2025-03-13 19:20:32,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.1649 secs
2025-03-13 19:20:32,129 [INFO]: {
2025-03-13 19:20:32,129 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:32,129 [INFO]: 	index_param: efSearch=195
2025-03-13 19:20:32,129 [INFO]: 	index_path: knn.index
2025-03-13 19:20:32,129 [INFO]: 	size in bytes: 1599332770
2025-03-13 19:20:32,129 [INFO]: 	avg_search_speed_ms: 9.906424474118666
2025-03-13 19:20:32,129 [INFO]: 	99p_search_speed_ms: 14.241689764894545
2025-03-13 19:20:32,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:32,129 [INFO]: 	nb vectors: 8129
2025-03-13 19:20:32,129 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:32,129 [INFO]: 	compression ratio: 0.9993082502773953
2025-03-13 19:20:32,129 [INFO]: }
2025-03-13 19:20:32,129 [INFO]: 	>>> Finished "Creating the index" in 87.1681 secs
2025-03-13 19:20:32,129 [INFO]: >>> Finished "Launching the whole pipeline" in 87.2102 secs
2025-03-13 19:20:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 89957 [episode count 10/20]
[retrieval_preprocessing] for episode 9426 [episode count 11/20], we have num_retrieval=np.int64(8181) num_query=np.int64(492)
2025-03-13 19:20:36,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:37,486 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:37
2025-03-13 19:20:37,486 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1188.86it/s]
2025-03-13 19:20:37,517 [INFO]: There are 8181 embeddings of dim 49152
2025-03-13 19:20:37,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 19:20:37,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:37
2025-03-13 19:20:37,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:37,518 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:20:37,518 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:37,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:20:37,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:37
2025-03-13 19:20:37,519 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:37,519 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:20:37,519 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:37
2025-03-13 19:20:37,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:37,520 [INFO]: 	Creating the index 03/13/2025, 19:20:37
2025-03-13 19:20:37,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:37
2025-03-13 19:20:37,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:20:37,523 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:37
2025-03-13 19:20:37,523 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:20:37,524 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  9.47it/s] 18%|█▊        | 6/34 [00:00<00:00, 32.45it/s] 32%|███▏      | 11/34 [00:00<00:00, 39.72it/s] 47%|████▋     | 16/34 [00:00<00:00, 43.36it/s] 62%|██████▏   | 21/34 [00:03<00:03,  3.61it/s] 76%|███████▋  | 26/34 [00:03<00:01,  5.38it/s] 94%|█████████▍| 32/34 [00:04<00:00,  8.16it/s]100%|██████████| 34/34 [00:06<00:00,  5.21it/s]
2025-03-13 19:20:44,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:44
2025-03-13 19:21:44,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.2878 secs
2025-03-13 19:21:44,342 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 19:21:44,342 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 19:22:12,786 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4441 secs
2025-03-13 19:22:12,789 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.2654 secs
2025-03-13 19:22:12,789 [INFO]: {
2025-03-13 19:22:12,789 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:12,789 [INFO]: 	index_param: efSearch=213
2025-03-13 19:22:12,789 [INFO]: 	index_path: knn.index
2025-03-13 19:22:12,789 [INFO]: 	size in bytes: 1609563610
2025-03-13 19:22:12,789 [INFO]: 	avg_search_speed_ms: 14.612496704080678
2025-03-13 19:22:12,789 [INFO]: 	99p_search_speed_ms: 21.44067379646003
2025-03-13 19:22:12,789 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:12,789 [INFO]: 	nb vectors: 8181
2025-03-13 19:22:12,789 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:12,789 [INFO]: 	compression ratio: 0.9993081590605791
2025-03-13 19:22:12,789 [INFO]: }
2025-03-13 19:22:12,789 [INFO]: 	>>> Finished "Creating the index" in 95.2695 secs
2025-03-13 19:22:12,789 [INFO]: >>> Finished "Launching the whole pipeline" in 95.3030 secs
2025-03-13 19:22:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 9426 [episode count 11/20]
[retrieval_preprocessing] for episode 79016 [episode count 12/20], we have num_retrieval=np.int64(8096) num_query=np.int64(577)
2025-03-13 19:22:17,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:19,468 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:19
2025-03-13 19:22:19,468 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 864.63it/s]
2025-03-13 19:22:19,503 [INFO]: There are 8096 embeddings of dim 49152
2025-03-13 19:22:19,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 19:22:19,504 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:19
2025-03-13 19:22:19,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:19,504 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:22:19,504 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:19,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:22:19,504 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:19
2025-03-13 19:22:19,505 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:19,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 19:22:19,505 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:19
2025-03-13 19:22:19,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:19,506 [INFO]: 	Creating the index 03/13/2025, 19:22:19
2025-03-13 19:22:19,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:19
2025-03-13 19:22:19,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:22:19,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:19
2025-03-13 19:22:19,510 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:22:19,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.91it/s] 18%|█▊        | 6/33 [00:00<00:00, 29.62it/s] 33%|███▎      | 11/33 [00:00<00:00, 35.84it/s] 48%|████▊     | 16/33 [00:00<00:00, 38.69it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.24it/s] 82%|████████▏ | 27/33 [00:04<00:01,  5.17it/s]100%|██████████| 33/33 [00:06<00:00,  3.57it/s]100%|██████████| 33/33 [00:06<00:00,  4.75it/s]
2025-03-13 19:22:26,465 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:26
2025-03-13 19:23:27,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.2365 secs
2025-03-13 19:23:27,702 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 19:23:27,703 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-13 19:23:57,322 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6195 secs
2025-03-13 19:23:57,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.2243 secs
2025-03-13 19:23:57,734 [INFO]: {
2025-03-13 19:23:57,735 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:57,735 [INFO]: 	index_param: efSearch=185
2025-03-13 19:23:57,735 [INFO]: 	index_path: knn.index
2025-03-13 19:23:57,735 [INFO]: 	size in bytes: 1592840290
2025-03-13 19:23:57,735 [INFO]: 	avg_search_speed_ms: 8.611769031999597
2025-03-13 19:23:57,735 [INFO]: 	99p_search_speed_ms: 12.521594483405357
2025-03-13 19:23:57,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:57,735 [INFO]: 	nb vectors: 8096
2025-03-13 19:23:57,735 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:57,735 [INFO]: 	compression ratio: 0.99930820308419
2025-03-13 19:23:57,735 [INFO]: }
2025-03-13 19:23:57,735 [INFO]: 	>>> Finished "Creating the index" in 98.2293 secs
2025-03-13 19:23:57,735 [INFO]: >>> Finished "Launching the whole pipeline" in 98.2671 secs
2025-03-13 19:23:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 79016 [episode count 12/20]
[retrieval_preprocessing] for episode 75246 [episode count 13/20], we have num_retrieval=np.int64(8130) num_query=np.int64(543)
2025-03-13 19:24:01,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:03,616 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:03
2025-03-13 19:24:03,616 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.63it/s]
2025-03-13 19:24:03,644 [INFO]: There are 8130 embeddings of dim 49152
2025-03-13 19:24:03,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 19:24:03,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:03
2025-03-13 19:24:03,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:03,644 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:24:03,644 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:03,644 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:24:03,644 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:03
2025-03-13 19:24:03,644 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:03,644 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:24:03,644 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:03
2025-03-13 19:24:03,644 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:03,644 [INFO]: 	Creating the index 03/13/2025, 19:24:03
2025-03-13 19:24:03,644 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:03
2025-03-13 19:24:03,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:24:03,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:03
2025-03-13 19:24:03,646 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:24:03,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.34it/s] 18%|█▊        | 6/33 [00:00<00:00, 28.70it/s] 36%|███▋      | 12/33 [00:00<00:00, 38.89it/s] 55%|█████▍    | 18/33 [00:00<00:00, 43.65it/s] 70%|██████▉   | 23/33 [00:04<00:02,  3.64it/s] 88%|████████▊ | 29/33 [00:04<00:00,  5.63it/s]100%|██████████| 33/33 [00:07<00:00,  2.82it/s]100%|██████████| 33/33 [00:07<00:00,  4.33it/s]
2025-03-13 19:24:11,280 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:11
2025-03-13 19:25:09,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4055 secs
2025-03-13 19:25:09,686 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 19:25:09,686 [INFO]: 	Compute fast metrics 03/13/2025, 19:25:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 19:25:36,494 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8071 secs
2025-03-13 19:25:36,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.8512 secs
2025-03-13 19:25:36,498 [INFO]: {
2025-03-13 19:25:36,498 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:36,498 [INFO]: 	index_param: efSearch=198
2025-03-13 19:25:36,498 [INFO]: 	index_path: knn.index
2025-03-13 19:25:36,498 [INFO]: 	size in bytes: 1599529510
2025-03-13 19:25:36,498 [INFO]: 	avg_search_speed_ms: 12.752033921246113
2025-03-13 19:25:36,498 [INFO]: 	99p_search_speed_ms: 19.84225891064851
2025-03-13 19:25:36,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:36,498 [INFO]: 	nb vectors: 8130
2025-03-13 19:25:36,498 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:36,498 [INFO]: 	compression ratio: 0.9993082528374234
2025-03-13 19:25:36,498 [INFO]: }
2025-03-13 19:25:36,498 [INFO]: 	>>> Finished "Creating the index" in 92.8538 secs
2025-03-13 19:25:36,498 [INFO]: >>> Finished "Launching the whole pipeline" in 92.8825 secs
2025-03-13 19:25:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 75246 [episode count 13/20]
[retrieval_preprocessing] for episode 26426 [episode count 14/20], we have num_retrieval=np.int64(8384) num_query=np.int64(289)
2025-03-13 19:25:41,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:42,096 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:42
2025-03-13 19:25:42,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.39it/s]
2025-03-13 19:25:42,123 [INFO]: There are 8384 embeddings of dim 49152
2025-03-13 19:25:42,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 19:25:42,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:42
2025-03-13 19:25:42,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:42,123 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:25:42,123 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:42,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:42,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:42
2025-03-13 19:25:42,124 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:42,124 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:25:42,124 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:42
2025-03-13 19:25:42,124 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:42,124 [INFO]: 	Creating the index 03/13/2025, 19:25:42
2025-03-13 19:25:42,124 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:42
2025-03-13 19:25:42,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:25:42,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:42
2025-03-13 19:25:42,125 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:25:42,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  8.17it/s] 21%|██        | 7/34 [00:00<00:00, 33.10it/s] 38%|███▊      | 13/34 [00:00<00:00, 41.91it/s] 56%|█████▌    | 19/34 [00:00<00:00, 45.63it/s] 71%|███████   | 24/34 [00:04<00:02,  3.56it/s] 88%|████████▊ | 30/34 [00:04<00:00,  5.47it/s]100%|██████████| 34/34 [00:07<00:00,  3.00it/s]100%|██████████| 34/34 [00:07<00:00,  4.56it/s]
2025-03-13 19:25:49,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:49
2025-03-13 19:26:48,682 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0955 secs
2025-03-13 19:26:48,683 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 19:26:48,683 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.70it/s]
2025-03-13 19:27:12,424 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7408 secs
2025-03-13 19:27:12,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.3004 secs
2025-03-13 19:27:12,426 [INFO]: {
2025-03-13 19:27:12,426 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:12,426 [INFO]: 	index_param: efSearch=170
2025-03-13 19:27:12,426 [INFO]: 	index_path: knn.index
2025-03-13 19:27:12,426 [INFO]: 	size in bytes: 1649502310
2025-03-13 19:27:12,426 [INFO]: 	avg_search_speed_ms: 8.554602652099828
2025-03-13 19:27:12,426 [INFO]: 	99p_search_speed_ms: 15.316045191138961
2025-03-13 19:27:12,426 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:12,426 [INFO]: 	nb vectors: 8384
2025-03-13 19:27:12,426 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:12,426 [INFO]: 	compression ratio: 0.9993083744150683
2025-03-13 19:27:12,426 [INFO]: }
2025-03-13 19:27:12,426 [INFO]: 	>>> Finished "Creating the index" in 90.3020 secs
2025-03-13 19:27:12,426 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3300 secs
2025-03-13 19:27:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 26426 [episode count 14/20]
[retrieval_preprocessing] for episode 4583 [episode count 15/20], we have num_retrieval=np.int64(8239) num_query=np.int64(434)
2025-03-13 19:27:15,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:16,730 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:16
2025-03-13 19:27:16,730 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.81it/s]
2025-03-13 19:27:16,762 [INFO]: There are 8239 embeddings of dim 49152
2025-03-13 19:27:16,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 19:27:16,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:16
2025-03-13 19:27:16,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:16,763 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:27:16,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:16,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:27:16,764 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:16
2025-03-13 19:27:16,764 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:16,764 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:27:16,764 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:16
2025-03-13 19:27:16,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:16,764 [INFO]: 	Creating the index 03/13/2025, 19:27:16
2025-03-13 19:27:16,765 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:16
2025-03-13 19:27:16,768 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:27:16,768 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:16
2025-03-13 19:27:16,768 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:27:16,768 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  8.15it/s] 18%|█▊        | 6/34 [00:00<00:00, 28.23it/s] 32%|███▏      | 11/34 [00:00<00:00, 34.82it/s] 47%|████▋     | 16/34 [00:00<00:00, 37.91it/s] 62%|██████▏   | 21/34 [00:04<00:04,  3.11it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.67it/s] 94%|█████████▍| 32/34 [00:04<00:00,  7.16it/s]100%|██████████| 34/34 [00:07<00:00,  4.63it/s]
2025-03-13 19:27:24,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:24
2025-03-13 19:28:20,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.9004 secs
2025-03-13 19:28:20,013 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 19:28:20,013 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-13 19:28:44,514 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5006 secs
2025-03-13 19:28:44,516 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.7476 secs
2025-03-13 19:28:44,516 [INFO]: {
2025-03-13 19:28:44,516 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:44,516 [INFO]: 	index_param: efSearch=192
2025-03-13 19:28:44,516 [INFO]: 	index_path: knn.index
2025-03-13 19:28:44,516 [INFO]: 	size in bytes: 1620974650
2025-03-13 19:28:44,516 [INFO]: 	avg_search_speed_ms: 9.385458506708423
2025-03-13 19:28:44,516 [INFO]: 	99p_search_speed_ms: 21.078168996609726
2025-03-13 19:28:44,516 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:44,516 [INFO]: 	nb vectors: 8239
2025-03-13 19:28:44,516 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:44,516 [INFO]: 	compression ratio: 0.9993082322416331
2025-03-13 19:28:44,516 [INFO]: }
2025-03-13 19:28:44,516 [INFO]: 	>>> Finished "Creating the index" in 87.7515 secs
2025-03-13 19:28:44,516 [INFO]: >>> Finished "Launching the whole pipeline" in 87.7862 secs
2025-03-13 19:28:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 4583 [episode count 15/20]
[retrieval_preprocessing] for episode 15302 [episode count 16/20], we have num_retrieval=np.int64(8208) num_query=np.int64(465)
2025-03-13 19:28:49,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:50,451 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:50
2025-03-13 19:28:50,451 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.12it/s]
2025-03-13 19:28:50,484 [INFO]: There are 8208 embeddings of dim 49152
2025-03-13 19:28:50,484 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 19:28:50,484 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:50
2025-03-13 19:28:50,484 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:50,484 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:28:50,484 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:28:50,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:28:50,484 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:50
2025-03-13 19:28:50,484 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:50,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:28:50,485 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:50
2025-03-13 19:28:50,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:50,485 [INFO]: 	Creating the index 03/13/2025, 19:28:50
2025-03-13 19:28:50,485 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:50
2025-03-13 19:28:50,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:28:50,486 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:50
2025-03-13 19:28:50,486 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:28:50,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  5.87it/s] 18%|█▊        | 6/34 [00:00<00:01, 23.58it/s] 32%|███▏      | 11/34 [00:00<00:00, 31.71it/s] 47%|████▋     | 16/34 [00:00<00:00, 35.47it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.84it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.26it/s] 91%|█████████ | 31/34 [00:05<00:00,  6.13it/s]100%|██████████| 34/34 [00:08<00:00,  4.19it/s]
2025-03-13 19:28:58,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:58
2025-03-13 19:30:01,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.6174 secs
2025-03-13 19:30:01,219 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 19:30:01,219 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.25it/s]
2025-03-13 19:30:37,756 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5365 secs
2025-03-13 19:30:37,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.4423 secs
2025-03-13 19:30:37,930 [INFO]: {
2025-03-13 19:30:37,930 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:37,930 [INFO]: 	index_param: efSearch=180
2025-03-13 19:30:37,930 [INFO]: 	index_path: knn.index
2025-03-13 19:30:37,930 [INFO]: 	size in bytes: 1614875710
2025-03-13 19:30:37,930 [INFO]: 	avg_search_speed_ms: 9.17332228721726
2025-03-13 19:30:37,930 [INFO]: 	99p_search_speed_ms: 18.207262188661726
2025-03-13 19:30:37,930 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:37,930 [INFO]: 	nb vectors: 8208
2025-03-13 19:30:37,930 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:37,930 [INFO]: 	compression ratio: 0.9993081535668153
2025-03-13 19:30:37,930 [INFO]: }
2025-03-13 19:30:37,931 [INFO]: 	>>> Finished "Creating the index" in 107.4457 secs
2025-03-13 19:30:37,931 [INFO]: >>> Finished "Launching the whole pipeline" in 107.4795 secs
2025-03-13 19:30:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 15302 [episode count 16/20]
[retrieval_preprocessing] for episode 91810 [episode count 17/20], we have num_retrieval=np.int64(8267) num_query=np.int64(406)
2025-03-13 19:30:41,586 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:42,822 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:42
2025-03-13 19:30:42,823 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.82it/s]
2025-03-13 19:30:42,850 [INFO]: There are 8267 embeddings of dim 49152
2025-03-13 19:30:42,850 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 19:30:42,850 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:42
2025-03-13 19:30:42,850 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:42,850 [INFO]: 		-> Add: 4.5 seconds
2025-03-13 19:30:42,850 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:42,850 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:42,850 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:42
2025-03-13 19:30:42,850 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:42,850 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:30:42,850 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:42
2025-03-13 19:30:42,850 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:42,850 [INFO]: 	Creating the index 03/13/2025, 19:30:42
2025-03-13 19:30:42,850 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:42
2025-03-13 19:30:42,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:30:42,851 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:42
2025-03-13 19:30:42,852 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:30:42,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  9.89it/s] 21%|██        | 7/34 [00:00<00:00, 37.35it/s] 38%|███▊      | 13/34 [00:00<00:00, 45.46it/s] 53%|█████▎    | 18/34 [00:00<00:00, 46.42it/s] 68%|██████▊   | 23/34 [00:04<00:03,  3.37it/s] 85%|████████▌ | 29/34 [00:04<00:00,  5.29it/s]100%|██████████| 34/34 [00:07<00:00,  3.30it/s]100%|██████████| 34/34 [00:07<00:00,  4.74it/s]
2025-03-13 19:30:50,413 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:50
2025-03-13 19:31:48,124 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7105 secs
2025-03-13 19:31:48,124 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 19:31:48,124 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.87it/s]
2025-03-13 19:32:21,534 [INFO]: 	>>> Finished "Compute fast metrics" in 33.4097 secs
2025-03-13 19:32:21,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.7560 secs
2025-03-13 19:32:21,608 [INFO]: {
2025-03-13 19:32:21,608 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:21,608 [INFO]: 	index_param: efSearch=196
2025-03-13 19:32:21,608 [INFO]: 	index_path: knn.index
2025-03-13 19:32:21,608 [INFO]: 	size in bytes: 1626483370
2025-03-13 19:32:21,608 [INFO]: 	avg_search_speed_ms: 9.257785439775843
2025-03-13 19:32:21,608 [INFO]: 	99p_search_speed_ms: 16.25067666871474
2025-03-13 19:32:21,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:21,609 [INFO]: 	nb vectors: 8267
2025-03-13 19:32:21,609 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:21,609 [INFO]: 	compression ratio: 0.9993083027956198
2025-03-13 19:32:21,609 [INFO]: }
2025-03-13 19:32:21,609 [INFO]: 	>>> Finished "Creating the index" in 98.7586 secs
2025-03-13 19:32:21,609 [INFO]: >>> Finished "Launching the whole pipeline" in 98.7865 secs
2025-03-13 19:32:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 91810 [episode count 17/20]
[retrieval_preprocessing] for episode 28411 [episode count 18/20], we have num_retrieval=np.int64(8305) num_query=np.int64(368)
2025-03-13 19:32:24,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:25,921 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:25
2025-03-13 19:32:25,921 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2239.35it/s]
2025-03-13 19:32:25,946 [INFO]: There are 8305 embeddings of dim 49152
2025-03-13 19:32:25,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 19:32:25,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:25
2025-03-13 19:32:25,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:25,947 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:32:25,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:32:25,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:32:25,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:25
2025-03-13 19:32:25,947 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:25,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:32:25,947 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:25
2025-03-13 19:32:25,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:25,947 [INFO]: 	Creating the index 03/13/2025, 19:32:25
2025-03-13 19:32:25,947 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:25
2025-03-13 19:32:25,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:32:25,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:25
2025-03-13 19:32:25,948 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:32:25,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  6.70it/s] 24%|██▎       | 8/34 [00:00<00:00, 35.69it/s] 44%|████▍     | 15/34 [00:00<00:00, 47.79it/s] 62%|██████▏   | 21/34 [00:03<00:03,  4.21it/s] 79%|███████▉  | 27/34 [00:03<00:01,  6.39it/s]100%|██████████| 34/34 [00:06<00:00,  4.06it/s]100%|██████████| 34/34 [00:06<00:00,  5.21it/s]
2025-03-13 19:32:32,483 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:32
2025-03-13 19:33:30,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7924 secs
2025-03-13 19:33:30,276 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 19:33:30,276 [INFO]: 	Compute fast metrics 03/13/2025, 19:33:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.77it/s]
2025-03-13 19:34:02,263 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9864 secs
2025-03-13 19:34:02,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.3171 secs
2025-03-13 19:34:02,265 [INFO]: {
2025-03-13 19:34:02,265 [INFO]: 	index_key: HNSW15
2025-03-13 19:34:02,265 [INFO]: 	index_param: efSearch=223
2025-03-13 19:34:02,265 [INFO]: 	index_path: knn.index
2025-03-13 19:34:02,265 [INFO]: 	size in bytes: 1633959610
2025-03-13 19:34:02,266 [INFO]: 	avg_search_speed_ms: 11.060867300700084
2025-03-13 19:34:02,266 [INFO]: 	99p_search_speed_ms: 16.05986377457157
2025-03-13 19:34:02,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:34:02,266 [INFO]: 	nb vectors: 8305
2025-03-13 19:34:02,266 [INFO]: 	vectors dimension: 49152
2025-03-13 19:34:02,266 [INFO]: 	compression ratio: 0.999308324396097
2025-03-13 19:34:02,266 [INFO]: }
2025-03-13 19:34:02,266 [INFO]: 	>>> Finished "Creating the index" in 96.3186 secs
2025-03-13 19:34:02,266 [INFO]: >>> Finished "Launching the whole pipeline" in 96.3447 secs
2025-03-13 19:34:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 28411 [episode count 18/20]
[retrieval_preprocessing] for episode 52872 [episode count 19/20], we have num_retrieval=np.int64(8461) num_query=np.int64(212)
2025-03-13 19:34:06,425 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:08,028 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:08
2025-03-13 19:34:08,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.03it/s]
2025-03-13 19:34:08,057 [INFO]: There are 8461 embeddings of dim 49152
2025-03-13 19:34:08,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 19:34:08,057 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:08
2025-03-13 19:34:08,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:08,057 [INFO]: 		-> Add: 4.6 seconds
2025-03-13 19:34:08,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:34:08,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:34:08,057 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:08
2025-03-13 19:34:08,057 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:08,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:34:08,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:08
2025-03-13 19:34:08,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:34:08,057 [INFO]: 	Creating the index 03/13/2025, 19:34:08
2025-03-13 19:34:08,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:34:08
2025-03-13 19:34:08,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:34:08,059 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:08
2025-03-13 19:34:08,059 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 19:34:08,059 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.87it/s] 20%|██        | 7/35 [00:00<00:00, 32.86it/s] 37%|███▋      | 13/35 [00:00<00:00, 42.19it/s] 54%|█████▍    | 19/35 [00:00<00:00, 46.06it/s] 69%|██████▊   | 24/35 [00:03<00:02,  3.98it/s] 86%|████████▌ | 30/35 [00:04<00:00,  6.07it/s]100%|██████████| 35/35 [00:06<00:00,  3.69it/s]100%|██████████| 35/35 [00:06<00:00,  5.34it/s]
2025-03-13 19:34:14,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:14
2025-03-13 19:35:10,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.3739 secs
2025-03-13 19:35:10,996 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 19:35:10,996 [INFO]: 	Compute fast metrics 03/13/2025, 19:35:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.47it/s]
2025-03-13 19:35:39,015 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0183 secs
2025-03-13 19:35:39,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9580 secs
2025-03-13 19:35:39,017 [INFO]: {
2025-03-13 19:35:39,017 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:39,017 [INFO]: 	index_param: efSearch=231
2025-03-13 19:35:39,017 [INFO]: 	index_path: knn.index
2025-03-13 19:35:39,017 [INFO]: 	size in bytes: 1664651590
2025-03-13 19:35:39,017 [INFO]: 	avg_search_speed_ms: 10.823897853870655
2025-03-13 19:35:39,017 [INFO]: 	99p_search_speed_ms: 18.806762460153514
2025-03-13 19:35:39,017 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:39,017 [INFO]: 	nb vectors: 8461
2025-03-13 19:35:39,017 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:39,017 [INFO]: 	compression ratio: 0.9993083826027523
2025-03-13 19:35:39,017 [INFO]: }
2025-03-13 19:35:39,017 [INFO]: 	>>> Finished "Creating the index" in 90.9599 secs
2025-03-13 19:35:39,017 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9890 secs
2025-03-13 19:35:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 52872 [episode count 19/20]
2025-03-13 19:35:41: [retrieval_preprocessing] finished for 1656877278_remove_cups_from_tray [chosen_id count 9/196]
2025-03-13 19:35:41: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
