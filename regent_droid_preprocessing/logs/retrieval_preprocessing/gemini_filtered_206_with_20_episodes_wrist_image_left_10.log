nohup: ignoring input
2025-03-13 10:51:47: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:51:53: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7489911085_turn_off_switch [chosen_id count 0/260]
2025-03-13 10:51:53: [retrieval_preprocessing] we have num_total=2733 embedding_dim=49152
[retrieval_preprocessing] for episode 58390 [episode count 0/20], we have num_retrieval=np.int64(2631) num_query=np.int64(102)
2025-03-13 10:51:56,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:56,824 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:56
2025-03-13 10:51:56,824 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 753.02it/s]
2025-03-13 10:51:56,858 [INFO]: There are 2631 embeddings of dim 49152
2025-03-13 10:51:56,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 10:51:56,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:56
2025-03-13 10:51:56,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:56,858 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:51:56,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:56,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:51:56,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:56
2025-03-13 10:51:56,859 [INFO]: 543.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:56,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 10:51:56,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:56
2025-03-13 10:51:56,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:56,859 [INFO]: 	Creating the index 03/13/2025, 10:51:56
2025-03-13 10:51:56,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:56
2025-03-13 10:51:56,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 10:51:56,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:56
2025-03-13 10:51:56,861 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:51:56,861 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.43it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.32it/s] 27%|██▋       | 3/11 [00:00<00:01,  5.42it/s] 36%|███▋      | 4/11 [00:00<00:01,  5.62it/s] 45%|████▌     | 5/11 [00:00<00:01,  5.82it/s] 55%|█████▍    | 6/11 [00:01<00:00,  6.22it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.06it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.73it/s]100%|██████████| 11/11 [00:02<00:00,  2.55it/s]100%|██████████| 11/11 [00:02<00:00,  3.80it/s]
2025-03-13 10:51:59,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:59
2025-03-13 10:52:26,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3141 secs
2025-03-13 10:52:26,077 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 10:52:26,077 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 10:52:38,766 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6890 secs
2025-03-13 10:52:38,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9072 secs
2025-03-13 10:52:38,768 [INFO]: {
2025-03-13 10:52:38,768 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:38,768 [INFO]: 	index_param: efSearch=240
2025-03-13 10:52:38,768 [INFO]: 	index_path: knn.index
2025-03-13 10:52:38,768 [INFO]: 	size in bytes: 517633150
2025-03-13 10:52:38,768 [INFO]: 	avg_search_speed_ms: 8.285145888524786
2025-03-13 10:52:38,768 [INFO]: 	99p_search_speed_ms: 13.628620668314449
2025-03-13 10:52:38,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:38,768 [INFO]: 	nb vectors: 2631
2025-03-13 10:52:38,768 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:38,768 [INFO]: 	compression ratio: 0.9993093525791383
2025-03-13 10:52:38,768 [INFO]: }
2025-03-13 10:52:38,768 [INFO]: 	>>> Finished "Creating the index" in 41.9090 secs
2025-03-13 10:52:38,768 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9439 secs
2025-03-13 10:52:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 58390 [episode count 0/20]
[retrieval_preprocessing] for episode 43674 [episode count 1/20], we have num_retrieval=np.int64(2583) num_query=np.int64(150)
2025-03-13 10:52:40,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:41,085 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:41
2025-03-13 10:52:41,085 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.78it/s]
2025-03-13 10:52:41,112 [INFO]: There are 2583 embeddings of dim 49152
2025-03-13 10:52:41,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 10:52:41,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:41
2025-03-13 10:52:41,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:41,114 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:52:41,114 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:41,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 10:52:41,114 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:41
2025-03-13 10:52:41,114 [INFO]: 533.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:41,115 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:52:41,115 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:41
2025-03-13 10:52:41,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:41,115 [INFO]: 	Creating the index 03/13/2025, 10:52:41
2025-03-13 10:52:41,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:41
2025-03-13 10:52:41,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 10:52:41,119 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:41
2025-03-13 10:52:41,119 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:52:41,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.07it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.07it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.89it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.12it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.68it/s]100%|██████████| 11/11 [00:02<00:00,  2.80it/s]100%|██████████| 11/11 [00:02<00:00,  4.25it/s]
2025-03-13 10:52:43,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:43
2025-03-13 10:53:11,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7302 secs
2025-03-13 10:53:11,447 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 10:53:11,447 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 10:53:24,096 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6493 secs
2025-03-13 10:53:24,098 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9795 secs
2025-03-13 10:53:24,099 [INFO]: {
2025-03-13 10:53:24,099 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:24,099 [INFO]: 	index_param: efSearch=295
2025-03-13 10:53:24,099 [INFO]: 	index_path: knn.index
2025-03-13 10:53:24,099 [INFO]: 	size in bytes: 508189390
2025-03-13 10:53:24,099 [INFO]: 	avg_search_speed_ms: 10.060057255544399
2025-03-13 10:53:24,099 [INFO]: 	99p_search_speed_ms: 14.20050359796732
2025-03-13 10:53:24,099 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:24,099 [INFO]: 	nb vectors: 2583
2025-03-13 10:53:24,099 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:24,099 [INFO]: 	compression ratio: 0.9993094582317037
2025-03-13 10:53:24,099 [INFO]: }
2025-03-13 10:53:24,099 [INFO]: 	>>> Finished "Creating the index" in 42.9835 secs
2025-03-13 10:53:24,099 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0139 secs
2025-03-13 10:53:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 43674 [episode count 1/20]
[retrieval_preprocessing] for episode 94381 [episode count 2/20], we have num_retrieval=np.int64(2623) num_query=np.int64(110)
2025-03-13 10:53:27,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:27,664 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:27
2025-03-13 10:53:27,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.38it/s]
2025-03-13 10:53:27,692 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 10:53:27,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 10:53:27,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:27
2025-03-13 10:53:27,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:27,693 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:53:27,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:27,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:27,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:27
2025-03-13 10:53:27,693 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:27,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:53:27,693 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:27
2025-03-13 10:53:27,693 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:27,693 [INFO]: 	Creating the index 03/13/2025, 10:53:27
2025-03-13 10:53:27,693 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:27
2025-03-13 10:53:27,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 10:53:27,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:27
2025-03-13 10:53:27,695 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:53:27,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.31it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.80it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.13it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.27it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.52it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.65it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.70it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.72it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.68it/s]100%|██████████| 11/11 [00:03<00:00,  1.48it/s]100%|██████████| 11/11 [00:03<00:00,  3.49it/s]
2025-03-13 10:53:30,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:30
2025-03-13 10:54:02,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4746 secs
2025-03-13 10:54:02,325 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 10:54:02,325 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s]
2025-03-13 10:54:15,348 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0225 secs
2025-03-13 10:54:15,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6554 secs
2025-03-13 10:54:15,350 [INFO]: {
2025-03-13 10:54:15,350 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:15,350 [INFO]: 	index_param: efSearch=304
2025-03-13 10:54:15,350 [INFO]: 	index_path: knn.index
2025-03-13 10:54:15,350 [INFO]: 	size in bytes: 516059170
2025-03-13 10:54:15,350 [INFO]: 	avg_search_speed_ms: 9.869147418250733
2025-03-13 10:54:15,350 [INFO]: 	99p_search_speed_ms: 13.586142603307962
2025-03-13 10:54:15,350 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:15,350 [INFO]: 	nb vectors: 2623
2025-03-13 10:54:15,350 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:15,350 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 10:54:15,350 [INFO]: }
2025-03-13 10:54:15,350 [INFO]: 	>>> Finished "Creating the index" in 47.6571 secs
2025-03-13 10:54:15,350 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6865 secs
2025-03-13 10:54:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 94381 [episode count 2/20]
[retrieval_preprocessing] for episode 50860 [episode count 3/20], we have num_retrieval=np.int64(2618) num_query=np.int64(115)
2025-03-13 10:54:17,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:17,912 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:17
2025-03-13 10:54:17,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1671.04it/s]
2025-03-13 10:54:17,935 [INFO]: There are 2618 embeddings of dim 49152
2025-03-13 10:54:17,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 10:54:17,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:17
2025-03-13 10:54:17,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:17,936 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:54:17,936 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:17,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:17,936 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:17
2025-03-13 10:54:17,936 [INFO]: 540.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:17,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:17,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:17
2025-03-13 10:54:17,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:17,936 [INFO]: 	Creating the index 03/13/2025, 10:54:17
2025-03-13 10:54:17,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:17
2025-03-13 10:54:17,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:54:17,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:17
2025-03-13 10:54:17,937 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:54:17,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.03it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.20it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.60it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.87it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.23it/s]100%|██████████| 11/11 [00:02<00:00,  3.12it/s]100%|██████████| 11/11 [00:02<00:00,  4.72it/s]
2025-03-13 10:54:20,270 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:20
2025-03-13 10:54:49,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2985 secs
2025-03-13 10:54:49,569 [INFO]: The best hyperparameters are: efSearch=347
2025-03-13 10:54:49,569 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.68it/s]
2025-03-13 10:55:01,927 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3580 secs
2025-03-13 10:55:01,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9917 secs
2025-03-13 10:55:01,929 [INFO]: {
2025-03-13 10:55:01,929 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:01,929 [INFO]: 	index_param: efSearch=347
2025-03-13 10:55:01,929 [INFO]: 	index_path: knn.index
2025-03-13 10:55:01,929 [INFO]: 	size in bytes: 515075470
2025-03-13 10:55:01,929 [INFO]: 	avg_search_speed_ms: 10.074757441666357
2025-03-13 10:55:01,929 [INFO]: 	99p_search_speed_ms: 13.268873989582072
2025-03-13 10:55:01,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:01,929 [INFO]: 	nb vectors: 2618
2025-03-13 10:55:01,929 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:01,929 [INFO]: 	compression ratio: 0.9993093711102181
2025-03-13 10:55:01,929 [INFO]: }
2025-03-13 10:55:01,929 [INFO]: 	>>> Finished "Creating the index" in 43.9932 secs
2025-03-13 10:55:01,929 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0169 secs
2025-03-13 10:55:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 50860 [episode count 3/20]
[retrieval_preprocessing] for episode 27822 [episode count 4/20], we have num_retrieval=np.int64(2498) num_query=np.int64(235)
2025-03-13 10:55:04,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:04,702 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:04
2025-03-13 10:55:04,702 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2043.01it/s]
2025-03-13 10:55:04,721 [INFO]: There are 2498 embeddings of dim 49152
2025-03-13 10:55:04,721 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0196 secs
2025-03-13 10:55:04,721 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:04
2025-03-13 10:55:04,721 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:04,721 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:55:04,721 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:04,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:04,722 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:04
2025-03-13 10:55:04,722 [INFO]: 515.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:04,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:55:04,722 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:04
2025-03-13 10:55:04,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:04,722 [INFO]: 	Creating the index 03/13/2025, 10:55:04
2025-03-13 10:55:04,722 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:04
2025-03-13 10:55:04,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 10:55:04,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:04
2025-03-13 10:55:04,723 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:55:04,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.57it/s] 30%|███       | 3/10 [00:00<00:00, 10.20it/s] 50%|█████     | 5/10 [00:00<00:00, 11.18it/s] 70%|███████   | 7/10 [00:00<00:00, 11.69it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.98it/s]100%|██████████| 10/10 [00:02<00:00,  4.40it/s]
2025-03-13 10:55:07,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:07
2025-03-13 10:55:36,286 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2814 secs
2025-03-13 10:55:36,286 [INFO]: The best hyperparameters are: efSearch=335
2025-03-13 10:55:36,286 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 10:55:48,669 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3821 secs
2025-03-13 10:55:48,670 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9476 secs
2025-03-13 10:55:48,670 [INFO]: {
2025-03-13 10:55:48,670 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:48,670 [INFO]: 	index_param: efSearch=335
2025-03-13 10:55:48,670 [INFO]: 	index_path: knn.index
2025-03-13 10:55:48,671 [INFO]: 	size in bytes: 491465830
2025-03-13 10:55:48,671 [INFO]: 	avg_search_speed_ms: 10.72208869215081
2025-03-13 10:55:48,671 [INFO]: 	99p_search_speed_ms: 15.555213270708911
2025-03-13 10:55:48,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:48,671 [INFO]: 	nb vectors: 2498
2025-03-13 10:55:48,671 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:48,671 [INFO]: 	compression ratio: 0.9993101331174946
2025-03-13 10:55:48,671 [INFO]: }
2025-03-13 10:55:48,671 [INFO]: 	>>> Finished "Creating the index" in 43.9487 secs
2025-03-13 10:55:48,671 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9689 secs
2025-03-13 10:55:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 27822 [episode count 4/20]
[retrieval_preprocessing] for episode 74940 [episode count 5/20], we have num_retrieval=np.int64(2578) num_query=np.int64(155)
2025-03-13 10:55:51,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:51,988 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:51
2025-03-13 10:55:51,988 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2268.42it/s]
2025-03-13 10:55:52,009 [INFO]: There are 2578 embeddings of dim 49152
2025-03-13 10:55:52,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 10:55:52,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:52,010 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:55:52,010 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:52,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:52,010 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,010 [INFO]: 532.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:52,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:55:52,010 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:52
2025-03-13 10:55:52,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:52,010 [INFO]: 	Creating the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,010 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:52
2025-03-13 10:55:52,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 10:55:52,011 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:52
2025-03-13 10:55:52,011 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:55:52,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.58it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.17it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.05it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.36it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.52it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.65it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.74it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.90it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.83it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.71it/s]100%|██████████| 11/11 [00:02<00:00,  1.79it/s]100%|██████████| 11/11 [00:02<00:00,  3.99it/s]
2025-03-13 10:55:54,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:54
2025-03-13 10:56:21,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4722 secs
2025-03-13 10:56:21,241 [INFO]: The best hyperparameters are: efSearch=316
2025-03-13 10:56:21,241 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-13 10:56:33,648 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4063 secs
2025-03-13 10:56:33,650 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6386 secs
2025-03-13 10:56:33,650 [INFO]: {
2025-03-13 10:56:33,650 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:33,650 [INFO]: 	index_param: efSearch=316
2025-03-13 10:56:33,650 [INFO]: 	index_path: knn.index
2025-03-13 10:56:33,650 [INFO]: 	size in bytes: 507205690
2025-03-13 10:56:33,650 [INFO]: 	avg_search_speed_ms: 9.542854924025086
2025-03-13 10:56:33,650 [INFO]: 	99p_search_speed_ms: 13.03748520091176
2025-03-13 10:56:33,650 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:33,650 [INFO]: 	nb vectors: 2578
2025-03-13 10:56:33,650 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:33,650 [INFO]: 	compression ratio: 0.9993094202078057
2025-03-13 10:56:33,650 [INFO]: }
2025-03-13 10:56:33,650 [INFO]: 	>>> Finished "Creating the index" in 41.6398 secs
2025-03-13 10:56:33,650 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6621 secs
2025-03-13 10:56:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 74940 [episode count 5/20]
[retrieval_preprocessing] for episode 38592 [episode count 6/20], we have num_retrieval=np.int64(2603) num_query=np.int64(130)
2025-03-13 10:56:36,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:36,354 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:36
2025-03-13 10:56:36,354 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.45it/s]
2025-03-13 10:56:36,376 [INFO]: There are 2603 embeddings of dim 49152
2025-03-13 10:56:36,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 10:56:36,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:36,376 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:56:36,376 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:36,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:36,376 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,376 [INFO]: 537.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:36,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:56:36,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:36
2025-03-13 10:56:36,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:36,376 [INFO]: 	Creating the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,376 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:36
2025-03-13 10:56:36,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:56:36,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:36
2025-03-13 10:56:36,377 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:56:36,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.56it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.99it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.99it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.37it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.73it/s]100%|██████████| 11/11 [00:03<00:00,  2.18it/s]100%|██████████| 11/11 [00:03<00:00,  3.52it/s]
2025-03-13 10:56:39,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:39
2025-03-13 10:57:04,234 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7329 secs
2025-03-13 10:57:04,234 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 10:57:04,234 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 10:57:16,849 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6150 secs
2025-03-13 10:57:16,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4737 secs
2025-03-13 10:57:16,851 [INFO]: {
2025-03-13 10:57:16,851 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:16,851 [INFO]: 	index_param: efSearch=287
2025-03-13 10:57:16,851 [INFO]: 	index_path: knn.index
2025-03-13 10:57:16,851 [INFO]: 	size in bytes: 512124250
2025-03-13 10:57:16,851 [INFO]: 	avg_search_speed_ms: 9.340437854588881
2025-03-13 10:57:16,851 [INFO]: 	99p_search_speed_ms: 12.777388840913769
2025-03-13 10:57:16,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:16,851 [INFO]: 	nb vectors: 2603
2025-03-13 10:57:16,851 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:16,851 [INFO]: 	compression ratio: 0.9993094917883697
2025-03-13 10:57:16,851 [INFO]: }
2025-03-13 10:57:16,851 [INFO]: 	>>> Finished "Creating the index" in 40.4751 secs
2025-03-13 10:57:16,851 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4975 secs
2025-03-13 10:57:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 38592 [episode count 6/20]
[retrieval_preprocessing] for episode 23946 [episode count 7/20], we have num_retrieval=np.int64(2622) num_query=np.int64(111)
2025-03-13 10:57:18,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:19,202 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:19
2025-03-13 10:57:19,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2263.52it/s]
2025-03-13 10:57:19,223 [INFO]: There are 2622 embeddings of dim 49152
2025-03-13 10:57:19,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0214 secs
2025-03-13 10:57:19,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:19
2025-03-13 10:57:19,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:19,223 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:57:19,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:19,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:19,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:19
2025-03-13 10:57:19,223 [INFO]: 541.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:19,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:19,224 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:19
2025-03-13 10:57:19,224 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:19,224 [INFO]: 	Creating the index 03/13/2025, 10:57:19
2025-03-13 10:57:19,224 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:19
2025-03-13 10:57:19,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:57:19,224 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:19
2025-03-13 10:57:19,225 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:57:19,225 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.15it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.81it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.61it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.03it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.31it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.51it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.76it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.80it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.80it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.88it/s]100%|██████████| 11/11 [00:02<00:00,  1.76it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]
2025-03-13 10:57:22,033 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:22
2025-03-13 10:57:50,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9465 secs
2025-03-13 10:57:50,980 [INFO]: The best hyperparameters are: efSearch=342
2025-03-13 10:57:50,980 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 10:58:04,639 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6589 secs
2025-03-13 10:58:04,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4164 secs
2025-03-13 10:58:04,641 [INFO]: {
2025-03-13 10:58:04,641 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:04,641 [INFO]: 	index_param: efSearch=342
2025-03-13 10:58:04,641 [INFO]: 	index_path: knn.index
2025-03-13 10:58:04,641 [INFO]: 	size in bytes: 515862430
2025-03-13 10:58:04,641 [INFO]: 	avg_search_speed_ms: 10.742267280132795
2025-03-13 10:58:04,641 [INFO]: 	99p_search_speed_ms: 14.330062270164492
2025-03-13 10:58:04,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:04,641 [INFO]: 	nb vectors: 2622
2025-03-13 10:58:04,641 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:04,641 [INFO]: 	compression ratio: 0.999309401151776
2025-03-13 10:58:04,641 [INFO]: }
2025-03-13 10:58:04,641 [INFO]: 	>>> Finished "Creating the index" in 45.4177 secs
2025-03-13 10:58:04,641 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4395 secs
2025-03-13 10:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 23946 [episode count 7/20]
[retrieval_preprocessing] for episode 27058 [episode count 8/20], we have num_retrieval=np.int64(2627) num_query=np.int64(106)
2025-03-13 10:58:07,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:07,658 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:07
2025-03-13 10:58:07,659 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1710.56it/s]
2025-03-13 10:58:07,679 [INFO]: There are 2627 embeddings of dim 49152
2025-03-13 10:58:07,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0205 secs
2025-03-13 10:58:07,679 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:07
2025-03-13 10:58:07,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:07,679 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:58:07,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:07,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:07,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:07
2025-03-13 10:58:07,679 [INFO]: 542.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:07,679 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:58:07,679 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:07
2025-03-13 10:58:07,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:07,680 [INFO]: 	Creating the index 03/13/2025, 10:58:07
2025-03-13 10:58:07,680 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:07
2025-03-13 10:58:07,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:58:07,680 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:07
2025-03-13 10:58:07,681 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:58:07,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.58it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.97it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.04it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.93it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.20it/s]100%|██████████| 11/11 [00:02<00:00,  2.78it/s]100%|██████████| 11/11 [00:02<00:00,  4.26it/s]
2025-03-13 10:58:10,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:10
2025-03-13 10:58:47,144 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8807 secs
2025-03-13 10:58:47,145 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 10:58:47,145 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s]
2025-03-13 10:58:59,583 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4388 secs
2025-03-13 10:58:59,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9049 secs
2025-03-13 10:58:59,585 [INFO]: {
2025-03-13 10:58:59,586 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:59,586 [INFO]: 	index_param: efSearch=241
2025-03-13 10:58:59,586 [INFO]: 	index_path: knn.index
2025-03-13 10:58:59,586 [INFO]: 	size in bytes: 516846130
2025-03-13 10:58:59,586 [INFO]: 	avg_search_speed_ms: 7.9074342830159665
2025-03-13 10:58:59,586 [INFO]: 	99p_search_speed_ms: 14.76953393081203
2025-03-13 10:58:59,586 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:59,586 [INFO]: 	nb vectors: 2627
2025-03-13 10:58:59,586 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:59,586 [INFO]: 	compression ratio: 0.9993094385750746
2025-03-13 10:58:59,586 [INFO]: }
2025-03-13 10:58:59,586 [INFO]: 	>>> Finished "Creating the index" in 51.9061 secs
2025-03-13 10:58:59,586 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9272 secs
2025-03-13 10:59:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 27058 [episode count 8/20]
[retrieval_preprocessing] for episode 53689 [episode count 9/20], we have num_retrieval=np.int64(2567) num_query=np.int64(166)
2025-03-13 10:59:01,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:01,763 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:01
2025-03-13 10:59:01,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.38it/s]
2025-03-13 10:59:01,788 [INFO]: There are 2567 embeddings of dim 49152
2025-03-13 10:59:01,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 10:59:01,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:01
2025-03-13 10:59:01,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:01,788 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:59:01,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:01,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:01,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:01
2025-03-13 10:59:01,788 [INFO]: 529.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:01,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:59:01,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:01
2025-03-13 10:59:01,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:01,789 [INFO]: 	Creating the index 03/13/2025, 10:59:01
2025-03-13 10:59:01,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:01
2025-03-13 10:59:01,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:59:01,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:01
2025-03-13 10:59:01,790 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:59:01,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.98it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.67it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.78it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.17it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.44it/s]100%|██████████| 11/11 [00:02<00:00,  2.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.31it/s]
2025-03-13 10:59:04,347 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:04
2025-03-13 10:59:30,214 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8672 secs
2025-03-13 10:59:30,214 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 10:59:30,214 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 10:59:43,361 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1468 secs
2025-03-13 10:59:43,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5739 secs
2025-03-13 10:59:43,364 [INFO]: {
2025-03-13 10:59:43,364 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:43,364 [INFO]: 	index_param: efSearch=292
2025-03-13 10:59:43,364 [INFO]: 	index_path: knn.index
2025-03-13 10:59:43,364 [INFO]: 	size in bytes: 505041370
2025-03-13 10:59:43,364 [INFO]: 	avg_search_speed_ms: 9.336303054102036
2025-03-13 10:59:43,364 [INFO]: 	99p_search_speed_ms: 12.70176493562758
2025-03-13 10:59:43,364 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:43,364 [INFO]: 	nb vectors: 2567
2025-03-13 10:59:43,364 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:43,364 [INFO]: 	compression ratio: 0.9993096921941266
2025-03-13 10:59:43,364 [INFO]: }
2025-03-13 10:59:43,364 [INFO]: 	>>> Finished "Creating the index" in 41.5755 secs
2025-03-13 10:59:43,364 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6008 secs
2025-03-13 10:59:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 53689 [episode count 9/20]
[retrieval_preprocessing] for episode 72635 [episode count 10/20], we have num_retrieval=np.int64(2597) num_query=np.int64(136)
2025-03-13 10:59:45,847 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:46,249 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:46
2025-03-13 10:59:46,249 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.87it/s]
2025-03-13 10:59:46,271 [INFO]: There are 2597 embeddings of dim 49152
2025-03-13 10:59:46,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 10:59:46,271 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:46
2025-03-13 10:59:46,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:46,271 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:59:46,271 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:46,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:46,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:46
2025-03-13 10:59:46,272 [INFO]: 536.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:46,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:59:46,272 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:46
2025-03-13 10:59:46,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:46,272 [INFO]: 	Creating the index 03/13/2025, 10:59:46
2025-03-13 10:59:46,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:46
2025-03-13 10:59:46,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:59:46,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:46
2025-03-13 10:59:46,273 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:59:46,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.05it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.30it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.09it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.15it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.70it/s]100%|██████████| 11/11 [00:02<00:00,  2.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.25it/s]
2025-03-13 10:59:48,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:48
2025-03-13 11:00:20,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5331 secs
2025-03-13 11:00:20,399 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:00:20,399 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 11:00:33,313 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9139 secs
2025-03-13 11:00:33,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0428 secs
2025-03-13 11:00:33,316 [INFO]: {
2025-03-13 11:00:33,316 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:33,316 [INFO]: 	index_param: efSearch=294
2025-03-13 11:00:33,316 [INFO]: 	index_path: knn.index
2025-03-13 11:00:33,316 [INFO]: 	size in bytes: 510943810
2025-03-13 11:00:33,316 [INFO]: 	avg_search_speed_ms: 9.647205625341895
2025-03-13 11:00:33,316 [INFO]: 	99p_search_speed_ms: 18.135546827688827
2025-03-13 11:00:33,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:33,316 [INFO]: 	nb vectors: 2597
2025-03-13 11:00:33,316 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:33,316 [INFO]: 	compression ratio: 0.9993094465710427
2025-03-13 11:00:33,316 [INFO]: }
2025-03-13 11:00:33,316 [INFO]: 	>>> Finished "Creating the index" in 47.0443 secs
2025-03-13 11:00:33,316 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0672 secs
2025-03-13 11:00:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 72635 [episode count 10/20]
[retrieval_preprocessing] for episode 43971 [episode count 11/20], we have num_retrieval=np.int64(2620) num_query=np.int64(113)
2025-03-13 11:00:35,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:35,979 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:35
2025-03-13 11:00:35,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.82it/s]
2025-03-13 11:00:36,003 [INFO]: There are 2620 embeddings of dim 49152
2025-03-13 11:00:36,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 11:00:36,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:36
2025-03-13 11:00:36,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:36,003 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:00:36,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:36,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:00:36,003 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:36
2025-03-13 11:00:36,004 [INFO]: 540.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:36,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:00:36,004 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:36
2025-03-13 11:00:36,004 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:36,004 [INFO]: 	Creating the index 03/13/2025, 11:00:36
2025-03-13 11:00:36,004 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:36
2025-03-13 11:00:36,005 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:00:36,005 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:36
2025-03-13 11:00:36,005 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:00:36,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.88it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.10it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.95it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.42it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.69it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.74it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.80it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.99it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.51it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.52it/s]100%|██████████| 11/11 [00:02<00:00,  1.73it/s]100%|██████████| 11/11 [00:02<00:00,  3.81it/s]
2025-03-13 11:00:38,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:38
2025-03-13 11:01:13,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5134 secs
2025-03-13 11:01:13,406 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 11:01:13,406 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-13 11:01:26,101 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6956 secs
2025-03-13 11:01:26,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0987 secs
2025-03-13 11:01:26,104 [INFO]: {
2025-03-13 11:01:26,104 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:26,104 [INFO]: 	index_param: efSearch=299
2025-03-13 11:01:26,104 [INFO]: 	index_path: knn.index
2025-03-13 11:01:26,104 [INFO]: 	size in bytes: 515468950
2025-03-13 11:01:26,104 [INFO]: 	avg_search_speed_ms: 9.625409534147245
2025-03-13 11:01:26,104 [INFO]: 	99p_search_speed_ms: 13.099681027233592
2025-03-13 11:01:26,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:26,104 [INFO]: 	nb vectors: 2620
2025-03-13 11:01:26,104 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:26,104 [INFO]: 	compression ratio: 0.9993093861424631
2025-03-13 11:01:26,104 [INFO]: }
2025-03-13 11:01:26,104 [INFO]: 	>>> Finished "Creating the index" in 50.1003 secs
2025-03-13 11:01:26,104 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1245 secs
2025-03-13 11:01:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 43971 [episode count 11/20]
[retrieval_preprocessing] for episode 56682 [episode count 12/20], we have num_retrieval=np.int64(2616) num_query=np.int64(117)
2025-03-13 11:01:28,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:29,281 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:29
2025-03-13 11:01:29,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1751.28it/s]
2025-03-13 11:01:29,308 [INFO]: There are 2616 embeddings of dim 49152
2025-03-13 11:01:29,309 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:01:29,309 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:29
2025-03-13 11:01:29,309 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:29,310 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:01:29,310 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:29,310 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:01:29,310 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:29
2025-03-13 11:01:29,310 [INFO]: 539.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:29,311 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:01:29,311 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:29
2025-03-13 11:01:29,311 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:29,311 [INFO]: 	Creating the index 03/13/2025, 11:01:29
2025-03-13 11:01:29,311 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:29
2025-03-13 11:01:29,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:01:29,315 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:29
2025-03-13 11:01:29,315 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:01:29,315 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.01it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.62it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.84it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.36it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.61it/s]100%|██████████| 11/11 [00:02<00:00,  2.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.50it/s]
2025-03-13 11:01:31,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:31
2025-03-13 11:02:02,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9171 secs
2025-03-13 11:02:02,685 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 11:02:02,685 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.28it/s]
2025-03-13 11:02:15,621 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9361 secs
2025-03-13 11:02:15,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3079 secs
2025-03-13 11:02:15,623 [INFO]: {
2025-03-13 11:02:15,623 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:15,623 [INFO]: 	index_param: efSearch=269
2025-03-13 11:02:15,623 [INFO]: 	index_path: knn.index
2025-03-13 11:02:15,623 [INFO]: 	size in bytes: 514681990
2025-03-13 11:02:15,623 [INFO]: 	avg_search_speed_ms: 9.19901876257974
2025-03-13 11:02:15,623 [INFO]: 	99p_search_speed_ms: 12.714464603923263
2025-03-13 11:02:15,623 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:15,623 [INFO]: 	nb vectors: 2616
2025-03-13 11:02:15,623 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:15,623 [INFO]: 	compression ratio: 0.9993093560549885
2025-03-13 11:02:15,623 [INFO]: }
2025-03-13 11:02:15,623 [INFO]: 	>>> Finished "Creating the index" in 46.3117 secs
2025-03-13 11:02:15,623 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3422 secs
2025-03-13 11:02:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 56682 [episode count 12/20]
[retrieval_preprocessing] for episode 34107 [episode count 13/20], we have num_retrieval=np.int64(2589) num_query=np.int64(144)
2025-03-13 11:02:17,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:18,219 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:18
2025-03-13 11:02:18,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.31it/s]
2025-03-13 11:02:18,244 [INFO]: There are 2589 embeddings of dim 49152
2025-03-13 11:02:18,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:02:18,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:18
2025-03-13 11:02:18,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:18,244 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:02:18,244 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:18,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:18,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:18
2025-03-13 11:02:18,245 [INFO]: 534.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:18,245 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:02:18,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:18
2025-03-13 11:02:18,245 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:18,245 [INFO]: 	Creating the index 03/13/2025, 11:02:18
2025-03-13 11:02:18,245 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:18
2025-03-13 11:02:18,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:02:18,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:18
2025-03-13 11:02:18,246 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:02:18,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.64it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.26it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.88it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.28it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.52it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.64it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.83it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.92it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.79it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.82it/s]100%|██████████| 11/11 [00:02<00:00,  1.73it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]
2025-03-13 11:02:21,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:21
2025-03-13 11:02:47,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6750 secs
2025-03-13 11:02:47,866 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 11:02:47,867 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s]
2025-03-13 11:03:00,927 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0604 secs
2025-03-13 11:03:00,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6834 secs
2025-03-13 11:03:00,929 [INFO]: {
2025-03-13 11:03:00,929 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:00,929 [INFO]: 	index_param: efSearch=237
2025-03-13 11:03:00,929 [INFO]: 	index_path: knn.index
2025-03-13 11:03:00,929 [INFO]: 	size in bytes: 509369890
2025-03-13 11:03:00,929 [INFO]: 	avg_search_speed_ms: 8.294796506986332
2025-03-13 11:03:00,929 [INFO]: 	99p_search_speed_ms: 13.523691846057774
2025-03-13 11:03:00,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:00,930 [INFO]: 	nb vectors: 2589
2025-03-13 11:03:00,930 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:00,930 [INFO]: 	compression ratio: 0.9993093859552633
2025-03-13 11:03:00,930 [INFO]: }
2025-03-13 11:03:00,930 [INFO]: 	>>> Finished "Creating the index" in 42.6848 secs
2025-03-13 11:03:00,930 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7102 secs
2025-03-13 11:03:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 34107 [episode count 13/20]
[retrieval_preprocessing] for episode 50494 [episode count 14/20], we have num_retrieval=np.int64(2620) num_query=np.int64(113)
2025-03-13 11:03:03,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:03,576 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:03
2025-03-13 11:03:03,576 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1545.43it/s]
2025-03-13 11:03:03,600 [INFO]: There are 2620 embeddings of dim 49152
2025-03-13 11:03:03,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:03:03,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:03
2025-03-13 11:03:03,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:03,600 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:03:03,600 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:03,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:03,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:03
2025-03-13 11:03:03,600 [INFO]: 540.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:03,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:03,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:03
2025-03-13 11:03:03,601 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:03,601 [INFO]: 	Creating the index 03/13/2025, 11:03:03
2025-03-13 11:03:03,601 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:03
2025-03-13 11:03:03,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:03:03,602 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:03
2025-03-13 11:03:03,602 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:03:03,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.80it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.63it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.13it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.79it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.40it/s]100%|██████████| 11/11 [00:02<00:00,  3.02it/s]100%|██████████| 11/11 [00:02<00:00,  4.62it/s]
2025-03-13 11:03:05,986 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:05
2025-03-13 11:03:34,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2667 secs
2025-03-13 11:03:34,253 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 11:03:34,254 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 11:03:47,102 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8482 secs
2025-03-13 11:03:47,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5026 secs
2025-03-13 11:03:47,104 [INFO]: {
2025-03-13 11:03:47,104 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:47,104 [INFO]: 	index_param: efSearch=289
2025-03-13 11:03:47,104 [INFO]: 	index_path: knn.index
2025-03-13 11:03:47,104 [INFO]: 	size in bytes: 515468950
2025-03-13 11:03:47,104 [INFO]: 	avg_search_speed_ms: 9.437156273359609
2025-03-13 11:03:47,104 [INFO]: 	99p_search_speed_ms: 12.795398905873302
2025-03-13 11:03:47,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:47,104 [INFO]: 	nb vectors: 2620
2025-03-13 11:03:47,104 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:47,105 [INFO]: 	compression ratio: 0.9993093861424631
2025-03-13 11:03:47,105 [INFO]: }
2025-03-13 11:03:47,105 [INFO]: 	>>> Finished "Creating the index" in 43.5040 secs
2025-03-13 11:03:47,105 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5284 secs
2025-03-13 11:03:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 50494 [episode count 14/20]
[retrieval_preprocessing] for episode 33575 [episode count 15/20], we have num_retrieval=np.int64(2570) num_query=np.int64(163)
2025-03-13 11:03:49,210 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:49,673 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:49
2025-03-13 11:03:49,674 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2037.06it/s]
2025-03-13 11:03:49,696 [INFO]: There are 2570 embeddings of dim 49152
2025-03-13 11:03:49,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:03:49,697 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:49
2025-03-13 11:03:49,697 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:49,697 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:03:49,697 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:49,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:49,697 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:49
2025-03-13 11:03:49,697 [INFO]: 530.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:49,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:49,697 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:49
2025-03-13 11:03:49,697 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:49,697 [INFO]: 	Creating the index 03/13/2025, 11:03:49
2025-03-13 11:03:49,697 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:49
2025-03-13 11:03:49,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:03:49,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:49
2025-03-13 11:03:49,698 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:03:49,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.03it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.75it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.59it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.10it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.47it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.99it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.24it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.54it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.90it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.07it/s]100%|██████████| 11/11 [00:03<00:00,  1.36it/s]100%|██████████| 11/11 [00:03<00:00,  3.20it/s]
2025-03-13 11:03:53,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:53
2025-03-13 11:04:22,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8492 secs
2025-03-13 11:04:22,990 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 11:04:22,990 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s]
2025-03-13 11:04:37,709 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7187 secs
2025-03-13 11:04:37,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0133 secs
2025-03-13 11:04:37,711 [INFO]: {
2025-03-13 11:04:37,711 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:37,711 [INFO]: 	index_param: efSearch=262
2025-03-13 11:04:37,711 [INFO]: 	index_path: knn.index
2025-03-13 11:04:37,711 [INFO]: 	size in bytes: 505631590
2025-03-13 11:04:37,711 [INFO]: 	avg_search_speed_ms: 9.159986439737535
2025-03-13 11:04:37,711 [INFO]: 	99p_search_speed_ms: 12.552520944736898
2025-03-13 11:04:37,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:37,711 [INFO]: 	nb vectors: 2570
2025-03-13 11:04:37,711 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:37,711 [INFO]: 	compression ratio: 0.999309714806387
2025-03-13 11:04:37,711 [INFO]: }
2025-03-13 11:04:37,712 [INFO]: 	>>> Finished "Creating the index" in 48.0146 secs
2025-03-13 11:04:37,712 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0379 secs
2025-03-13 11:04:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 33575 [episode count 15/20]
[retrieval_preprocessing] for episode 22276 [episode count 16/20], we have num_retrieval=np.int64(2614) num_query=np.int64(119)
2025-03-13 11:04:40,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:40,535 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:40
2025-03-13 11:04:40,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.61it/s]
2025-03-13 11:04:40,560 [INFO]: There are 2614 embeddings of dim 49152
2025-03-13 11:04:40,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 11:04:40,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:40,561 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:04:40,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:40,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:40,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,561 [INFO]: 539.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:40,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:04:40,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:40
2025-03-13 11:04:40,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:40,561 [INFO]: 	Creating the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:40
2025-03-13 11:04:40,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:04:40,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,562 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:04:40,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.76it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.30it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.50it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.93it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.94it/s]100%|██████████| 11/11 [00:02<00:00,  2.34it/s]100%|██████████| 11/11 [00:02<00:00,  3.71it/s]
2025-03-13 11:04:43,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:43
2025-03-13 11:05:14,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2859 secs
2025-03-13 11:05:14,820 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 11:05:14,820 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.30it/s]
2025-03-13 11:05:27,162 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3422 secs
2025-03-13 11:05:27,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6020 secs
2025-03-13 11:05:27,164 [INFO]: {
2025-03-13 11:05:27,164 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:27,164 [INFO]: 	index_param: efSearch=266
2025-03-13 11:05:27,164 [INFO]: 	index_path: knn.index
2025-03-13 11:05:27,164 [INFO]: 	size in bytes: 514288510
2025-03-13 11:05:27,164 [INFO]: 	avg_search_speed_ms: 10.391725593182624
2025-03-13 11:05:27,164 [INFO]: 	99p_search_speed_ms: 20.411052796989672
2025-03-13 11:05:27,164 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:27,164 [INFO]: 	nb vectors: 2614
2025-03-13 11:05:27,164 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:27,165 [INFO]: 	compression ratio: 0.9993093409767214
2025-03-13 11:05:27,165 [INFO]: }
2025-03-13 11:05:27,165 [INFO]: 	>>> Finished "Creating the index" in 46.6034 secs
2025-03-13 11:05:27,165 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6291 secs
2025-03-13 11:05:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 22276 [episode count 16/20]
[retrieval_preprocessing] for episode 36596 [episode count 17/20], we have num_retrieval=np.int64(2613) num_query=np.int64(120)
2025-03-13 11:05:29,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:29,834 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:29
2025-03-13 11:05:29,834 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.78it/s]
2025-03-13 11:05:29,862 [INFO]: There are 2613 embeddings of dim 49152
2025-03-13 11:05:29,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 11:05:29,863 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:29
2025-03-13 11:05:29,863 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:29,863 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:05:29,863 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:29,863 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:05:29,863 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:29
2025-03-13 11:05:29,863 [INFO]: 539.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:29,864 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:05:29,864 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:29
2025-03-13 11:05:29,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:29,864 [INFO]: 	Creating the index 03/13/2025, 11:05:29
2025-03-13 11:05:29,864 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:29
2025-03-13 11:05:29,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:05:29,867 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:29
2025-03-13 11:05:29,868 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:05:29,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.76it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.94it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.84it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.30it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.43it/s]100%|██████████| 11/11 [00:02<00:00,  2.37it/s]100%|██████████| 11/11 [00:02<00:00,  3.77it/s]
2025-03-13 11:05:32,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:32
2025-03-13 11:06:03,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1513 secs
2025-03-13 11:06:03,940 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:06:03,940 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 11:06:19,407 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4677 secs
2025-03-13 11:06:19,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5418 secs
2025-03-13 11:06:19,409 [INFO]: {
2025-03-13 11:06:19,410 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:19,410 [INFO]: 	index_param: efSearch=295
2025-03-13 11:06:19,410 [INFO]: 	index_path: knn.index
2025-03-13 11:06:19,410 [INFO]: 	size in bytes: 514091710
2025-03-13 11:06:19,410 [INFO]: 	avg_search_speed_ms: 9.84983502088913
2025-03-13 11:06:19,410 [INFO]: 	99p_search_speed_ms: 14.71698315814138
2025-03-13 11:06:19,410 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:19,410 [INFO]: 	nb vectors: 2613
2025-03-13 11:06:19,410 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:19,410 [INFO]: 	compression ratio: 0.9993094500590177
2025-03-13 11:06:19,410 [INFO]: }
2025-03-13 11:06:19,410 [INFO]: 	>>> Finished "Creating the index" in 49.5456 secs
2025-03-13 11:06:19,410 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5759 secs
2025-03-13 11:06:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 36596 [episode count 17/20]
[retrieval_preprocessing] for episode 7910 [episode count 18/20], we have num_retrieval=np.int64(2556) num_query=np.int64(177)
2025-03-13 11:06:21,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:21,937 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:21
2025-03-13 11:06:21,937 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.88it/s]
2025-03-13 11:06:21,962 [INFO]: There are 2556 embeddings of dim 49152
2025-03-13 11:06:21,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:06:21,962 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:21,963 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:06:21,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:21,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:06:21,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,963 [INFO]: 527.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:21,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:06:21,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:21
2025-03-13 11:06:21,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:21,964 [INFO]: 	Creating the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:21
2025-03-13 11:06:21,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:06:21,967 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,967 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:06:21,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.07it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.54it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.13it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.43it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.70it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.89it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.36it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.14it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.90it/s]100%|██████████| 11/11 [00:02<00:00,  1.94it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-13 11:06:24,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:24
2025-03-13 11:06:53,977 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1551 secs
2025-03-13 11:06:53,977 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 11:06:53,977 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s]
2025-03-13 11:07:06,528 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5501 secs
2025-03-13 11:07:06,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.5623 secs
2025-03-13 11:07:06,530 [INFO]: {
2025-03-13 11:07:06,530 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:06,530 [INFO]: 	index_param: efSearch=277
2025-03-13 11:07:06,530 [INFO]: 	index_path: knn.index
2025-03-13 11:07:06,530 [INFO]: 	size in bytes: 502877230
2025-03-13 11:07:06,530 [INFO]: 	avg_search_speed_ms: 9.244044790777778
2025-03-13 11:07:06,530 [INFO]: 	99p_search_speed_ms: 13.146726395934826
2025-03-13 11:07:06,530 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:06,530 [INFO]: 	nb vectors: 2556
2025-03-13 11:07:06,530 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:06,530 [INFO]: 	compression ratio: 0.9993096088283814
2025-03-13 11:07:06,530 [INFO]: }
2025-03-13 11:07:06,530 [INFO]: 	>>> Finished "Creating the index" in 44.5663 secs
2025-03-13 11:07:06,530 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5929 secs
2025-03-13 11:07:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 7910 [episode count 18/20]
[retrieval_preprocessing] for episode 64883 [episode count 19/20], we have num_retrieval=np.int64(2582) num_query=np.int64(151)
2025-03-13 11:07:08,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:09,374 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:09
2025-03-13 11:07:09,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1480.52it/s]
2025-03-13 11:07:09,399 [INFO]: There are 2582 embeddings of dim 49152
2025-03-13 11:07:09,399 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 11:07:09,400 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:09
2025-03-13 11:07:09,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:09,400 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:07:09,400 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:09,400 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:07:09,400 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:09
2025-03-13 11:07:09,400 [INFO]: 532.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:09,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:07:09,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:09
2025-03-13 11:07:09,402 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:09,402 [INFO]: 	Creating the index 03/13/2025, 11:07:09
2025-03-13 11:07:09,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:09
2025-03-13 11:07:09,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:07:09,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:09
2025-03-13 11:07:09,405 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:07:09,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.33it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.92it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.65it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.05it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.40it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.53it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.56it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.55it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.57it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.66it/s]100%|██████████| 11/11 [00:02<00:00,  1.80it/s]100%|██████████| 11/11 [00:02<00:00,  3.97it/s]
2025-03-13 11:07:12,200 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:12
2025-03-13 11:07:44,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8366 secs
2025-03-13 11:07:44,037 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:07:44,037 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-13 11:07:57,646 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6085 secs
2025-03-13 11:07:57,648 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2429 secs
2025-03-13 11:07:57,648 [INFO]: {
2025-03-13 11:07:57,648 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:57,648 [INFO]: 	index_param: efSearch=294
2025-03-13 11:07:57,648 [INFO]: 	index_path: knn.index
2025-03-13 11:07:57,648 [INFO]: 	size in bytes: 507992650
2025-03-13 11:07:57,648 [INFO]: 	avg_search_speed_ms: 10.538872804402425
2025-03-13 11:07:57,648 [INFO]: 	99p_search_speed_ms: 14.036210533231495
2025-03-13 11:07:57,648 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:57,648 [INFO]: 	nb vectors: 2582
2025-03-13 11:07:57,648 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:57,648 [INFO]: 	compression ratio: 0.9993094506387051
2025-03-13 11:07:57,648 [INFO]: }
2025-03-13 11:07:57,648 [INFO]: 	>>> Finished "Creating the index" in 48.2465 secs
2025-03-13 11:07:57,648 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2746 secs
2025-03-13 11:07:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 64883 [episode count 19/20]
2025-03-13 11:07:59: [retrieval_preprocessing] finished for 7489911085_turn_off_switch [chosen_id count 0/260]
2025-03-13 11:08:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7495112204_put_marker_in_mug [chosen_id count 1/260]
2025-03-13 11:08:02: [retrieval_preprocessing] we have num_total=2943 embedding_dim=49152
[retrieval_preprocessing] for episode 92176 [episode count 0/20], we have num_retrieval=np.int64(2790) num_query=np.int64(153)
2025-03-13 11:08:03,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:03,578 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:03
2025-03-13 11:08:03,578 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1148.18it/s]
2025-03-13 11:08:03,606 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 11:08:03,607 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:08:03,607 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:03
2025-03-13 11:08:03,607 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:03,607 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:08:03,607 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:03,607 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:08:03,607 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:03
2025-03-13 11:08:03,608 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:03,608 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:08:03,608 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:03
2025-03-13 11:08:03,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:03,609 [INFO]: 	Creating the index 03/13/2025, 11:08:03
2025-03-13 11:08:03,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:03
2025-03-13 11:08:03,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:08:03,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:03
2025-03-13 11:08:03,612 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:08:03,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.98it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.66it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.49it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.07it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.33it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.25it/s] 64%|██████▎   | 7/11 [00:00<00:00,  6.70it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.75it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.05it/s]100%|██████████| 11/11 [00:03<00:00,  1.54it/s]100%|██████████| 11/11 [00:03<00:00,  3.24it/s]
2025-03-13 11:08:07,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:07
2025-03-13 11:08:33,893 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8732 secs
2025-03-13 11:08:33,894 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 11:08:33,894 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s]
2025-03-13 11:08:46,701 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8072 secs
2025-03-13 11:08:46,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0909 secs
2025-03-13 11:08:46,703 [INFO]: {
2025-03-13 11:08:46,703 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:46,703 [INFO]: 	index_param: efSearch=226
2025-03-13 11:08:46,703 [INFO]: 	index_path: knn.index
2025-03-13 11:08:46,703 [INFO]: 	size in bytes: 548915110
2025-03-13 11:08:46,703 [INFO]: 	avg_search_speed_ms: 8.378294912890562
2025-03-13 11:08:46,703 [INFO]: 	99p_search_speed_ms: 11.289617298170917
2025-03-13 11:08:46,703 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:46,703 [INFO]: 	nb vectors: 2790
2025-03-13 11:08:46,703 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:46,703 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 11:08:46,703 [INFO]: }
2025-03-13 11:08:46,703 [INFO]: 	>>> Finished "Creating the index" in 43.0947 secs
2025-03-13 11:08:46,704 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1255 secs
2025-03-13 11:08:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 92176 [episode count 0/20]
[retrieval_preprocessing] for episode 9761 [episode count 1/20], we have num_retrieval=np.int64(2783) num_query=np.int64(160)
2025-03-13 11:08:48,933 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:49,336 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:49
2025-03-13 11:08:49,336 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.57it/s]
2025-03-13 11:08:49,361 [INFO]: There are 2783 embeddings of dim 49152
2025-03-13 11:08:49,361 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:08:49,361 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:49
2025-03-13 11:08:49,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:49,362 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:08:49,362 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:49,362 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:08:49,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:49
2025-03-13 11:08:49,363 [INFO]: 574.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:49,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:08:49,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:49
2025-03-13 11:08:49,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:49,364 [INFO]: 	Creating the index 03/13/2025, 11:08:49
2025-03-13 11:08:49,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:49
2025-03-13 11:08:49,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:08:49,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:49
2025-03-13 11:08:49,368 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:08:49,369 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.91it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.19it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.67it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.81it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.98it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.28it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.43it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.57it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.68it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.74it/s]100%|██████████| 11/11 [00:03<00:00,  1.38it/s]100%|██████████| 11/11 [00:03<00:00,  3.30it/s]
2025-03-13 11:08:52,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:52
2025-03-13 11:09:24,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4550 secs
2025-03-13 11:09:24,167 [INFO]: The best hyperparameters are: efSearch=306
2025-03-13 11:09:24,167 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 11:09:38,559 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3921 secs
2025-03-13 11:09:38,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1931 secs
2025-03-13 11:09:38,561 [INFO]: {
2025-03-13 11:09:38,561 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:38,561 [INFO]: 	index_param: efSearch=306
2025-03-13 11:09:38,561 [INFO]: 	index_path: knn.index
2025-03-13 11:09:38,561 [INFO]: 	size in bytes: 547537930
2025-03-13 11:09:38,561 [INFO]: 	avg_search_speed_ms: 10.248504300910948
2025-03-13 11:09:38,561 [INFO]: 	99p_search_speed_ms: 13.473063125275075
2025-03-13 11:09:38,561 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:38,562 [INFO]: 	nb vectors: 2783
2025-03-13 11:09:38,562 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:38,562 [INFO]: 	compression ratio: 0.9993098816003487
2025-03-13 11:09:38,562 [INFO]: }
2025-03-13 11:09:38,562 [INFO]: 	>>> Finished "Creating the index" in 49.1973 secs
2025-03-13 11:09:38,562 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2257 secs
2025-03-13 11:09:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 9761 [episode count 1/20]
[retrieval_preprocessing] for episode 5181 [episode count 2/20], we have num_retrieval=np.int64(2735) num_query=np.int64(208)
2025-03-13 11:09:41,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:41,686 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:41
2025-03-13 11:09:41,686 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.81it/s]
2025-03-13 11:09:41,711 [INFO]: There are 2735 embeddings of dim 49152
2025-03-13 11:09:41,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:09:41,711 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:41
2025-03-13 11:09:41,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:41,712 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:09:41,712 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:41,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:09:41,712 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:41
2025-03-13 11:09:41,712 [INFO]: 564.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:41,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:09:41,713 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:41
2025-03-13 11:09:41,713 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:41,713 [INFO]: 	Creating the index 03/13/2025, 11:09:41
2025-03-13 11:09:41,713 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:41
2025-03-13 11:09:41,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:09:41,716 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:41
2025-03-13 11:09:41,716 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:09:41,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.92it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.54it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.74it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.25it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.46it/s]100%|██████████| 11/11 [00:02<00:00,  2.56it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]
2025-03-13 11:09:44,574 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:44
2025-03-13 11:10:15,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9843 secs
2025-03-13 11:10:15,559 [INFO]: The best hyperparameters are: efSearch=355
2025-03-13 11:10:15,559 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.29it/s] 50%|█████     | 2/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 11:10:33,839 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2803 secs
2025-03-13 11:10:33,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1250 secs
2025-03-13 11:10:33,841 [INFO]: {
2025-03-13 11:10:33,841 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:33,841 [INFO]: 	index_param: efSearch=355
2025-03-13 11:10:33,841 [INFO]: 	index_path: knn.index
2025-03-13 11:10:33,841 [INFO]: 	size in bytes: 538094230
2025-03-13 11:10:33,841 [INFO]: 	avg_search_speed_ms: 11.54007715701567
2025-03-13 11:10:33,841 [INFO]: 	99p_search_speed_ms: 20.455250013619693
2025-03-13 11:10:33,841 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:33,841 [INFO]: 	nb vectors: 2735
2025-03-13 11:10:33,841 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:33,842 [INFO]: 	compression ratio: 0.9993098792380658
2025-03-13 11:10:33,842 [INFO]: }
2025-03-13 11:10:33,842 [INFO]: 	>>> Finished "Creating the index" in 52.1287 secs
2025-03-13 11:10:33,842 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1558 secs
2025-03-13 11:10:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 5181 [episode count 2/20]
[retrieval_preprocessing] for episode 58501 [episode count 3/20], we have num_retrieval=np.int64(2787) num_query=np.int64(156)
2025-03-13 11:10:37,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:38,074 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:38
2025-03-13 11:10:38,074 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-13 11:10:38,101 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 11:10:38,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:10:38,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:38,102 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:10:38,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:38,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:10:38,103 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,103 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:38,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:10:38,103 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:38
2025-03-13 11:10:38,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:38,104 [INFO]: 	Creating the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,104 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:38
2025-03-13 11:10:38,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:10:38,107 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:38
2025-03-13 11:10:38,107 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:10:38,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.00it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.96it/s] 64%|██████▎   | 7/11 [00:00<00:00, 19.61it/s] 82%|████████▏ | 9/11 [00:00<00:00, 19.60it/s]100%|██████████| 11/11 [00:02<00:00,  2.94it/s]100%|██████████| 11/11 [00:02<00:00,  4.66it/s]
2025-03-13 11:10:40,478 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:40
2025-03-13 11:11:08,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9662 secs
2025-03-13 11:11:08,445 [INFO]: The best hyperparameters are: efSearch=366
2025-03-13 11:11:08,445 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-13 11:11:22,044 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5990 secs
2025-03-13 11:11:22,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9391 secs
2025-03-13 11:11:22,046 [INFO]: {
2025-03-13 11:11:22,046 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:22,046 [INFO]: 	index_param: efSearch=366
2025-03-13 11:11:22,046 [INFO]: 	index_path: knn.index
2025-03-13 11:11:22,046 [INFO]: 	size in bytes: 548324890
2025-03-13 11:11:22,046 [INFO]: 	avg_search_speed_ms: 11.597808533826214
2025-03-13 11:11:22,046 [INFO]: 	99p_search_speed_ms: 15.88239043019712
2025-03-13 11:11:22,046 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:22,046 [INFO]: 	nb vectors: 2787
2025-03-13 11:11:22,046 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:22,046 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 11:11:22,046 [INFO]: }
2025-03-13 11:11:22,046 [INFO]: 	>>> Finished "Creating the index" in 43.9427 secs
2025-03-13 11:11:22,046 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9723 secs
2025-03-13 11:11:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 58501 [episode count 3/20]
[retrieval_preprocessing] for episode 89737 [episode count 4/20], we have num_retrieval=np.int64(2815) num_query=np.int64(128)
2025-03-13 11:11:25,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:25,887 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:25
2025-03-13 11:11:25,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1862.48it/s]
2025-03-13 11:11:25,911 [INFO]: There are 2815 embeddings of dim 49152
2025-03-13 11:11:25,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:11:25,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,911 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:25,911 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:11:25,911 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:25,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:11:25,911 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,911 [INFO]: 580.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:25,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:11:25,911 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:25
2025-03-13 11:11:25,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:25,911 [INFO]: 	Creating the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,911 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:25
2025-03-13 11:11:25,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:11:25,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,912 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:11:25,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.72it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.11it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.09it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.59it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.71it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.76it/s]100%|██████████| 12/12 [00:02<00:00,  4.05it/s]
2025-03-13 11:11:28,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:28
2025-03-13 11:11:56,958 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0773 secs
2025-03-13 11:11:56,959 [INFO]: The best hyperparameters are: efSearch=383
2025-03-13 11:11:56,959 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 11:12:11,956 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9969 secs
2025-03-13 11:12:11,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0453 secs
2025-03-13 11:12:11,958 [INFO]: {
2025-03-13 11:12:11,958 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:11,958 [INFO]: 	index_param: efSearch=383
2025-03-13 11:12:11,958 [INFO]: 	index_path: knn.index
2025-03-13 11:12:11,958 [INFO]: 	size in bytes: 553833790
2025-03-13 11:12:11,958 [INFO]: 	avg_search_speed_ms: 11.808323276689917
2025-03-13 11:12:11,958 [INFO]: 	99p_search_speed_ms: 14.957962110638617
2025-03-13 11:12:11,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:11,958 [INFO]: 	nb vectors: 2815
2025-03-13 11:12:11,958 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:11,958 [INFO]: 	compression ratio: 0.9993097748694604
2025-03-13 11:12:11,958 [INFO]: }
2025-03-13 11:12:11,958 [INFO]: 	>>> Finished "Creating the index" in 46.0468 secs
2025-03-13 11:12:11,958 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0714 secs
2025-03-13 11:12:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 89737 [episode count 4/20]
[retrieval_preprocessing] for episode 20132 [episode count 5/20], we have num_retrieval=np.int64(2802) num_query=np.int64(141)
2025-03-13 11:12:15,324 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:15,719 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:15
2025-03-13 11:12:15,719 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.87it/s]
2025-03-13 11:12:15,743 [INFO]: There are 2802 embeddings of dim 49152
2025-03-13 11:12:15,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:12:15,743 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:15,744 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:12:15,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:15,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:12:15,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,744 [INFO]: 578.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:15,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:12:15,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:15
2025-03-13 11:12:15,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:15,745 [INFO]: 	Creating the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:15
2025-03-13 11:12:15,748 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:12:15,748 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,748 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:12:15,748 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.15it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.41it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.21it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.49it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.71it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.69it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]
2025-03-13 11:12:18,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:18
2025-03-13 11:12:45,975 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4095 secs
2025-03-13 11:12:45,975 [INFO]: The best hyperparameters are: efSearch=383
2025-03-13 11:12:45,976 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 11:13:00,113 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1374 secs
2025-03-13 11:13:00,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3670 secs
2025-03-13 11:13:00,115 [INFO]: {
2025-03-13 11:13:00,115 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:00,115 [INFO]: 	index_param: efSearch=383
2025-03-13 11:13:00,115 [INFO]: 	index_path: knn.index
2025-03-13 11:13:00,115 [INFO]: 	size in bytes: 551276170
2025-03-13 11:13:00,115 [INFO]: 	avg_search_speed_ms: 12.062862041924234
2025-03-13 11:13:00,115 [INFO]: 	99p_search_speed_ms: 19.938016664236795
2025-03-13 11:13:00,115 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:00,115 [INFO]: 	nb vectors: 2802
2025-03-13 11:13:00,115 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:00,115 [INFO]: 	compression ratio: 0.9993096853796528
2025-03-13 11:13:00,115 [INFO]: }
2025-03-13 11:13:00,115 [INFO]: 	>>> Finished "Creating the index" in 44.3705 secs
2025-03-13 11:13:00,115 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3966 secs
2025-03-13 11:13:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 20132 [episode count 5/20]
[retrieval_preprocessing] for episode 28351 [episode count 6/20], we have num_retrieval=np.int64(2815) num_query=np.int64(128)
2025-03-13 11:13:03,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:03,891 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:03
2025-03-13 11:13:03,891 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.33it/s]
2025-03-13 11:13:03,914 [INFO]: There are 2815 embeddings of dim 49152
2025-03-13 11:13:03,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:13:03,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:03
2025-03-13 11:13:03,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:03,915 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:13:03,915 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:03,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:13:03,915 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:03
2025-03-13 11:13:03,915 [INFO]: 580.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:03,915 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:03,915 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:03
2025-03-13 11:13:03,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:03,915 [INFO]: 	Creating the index 03/13/2025, 11:13:03
2025-03-13 11:13:03,915 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:03
2025-03-13 11:13:03,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:13:03,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:03
2025-03-13 11:13:03,917 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:13:03,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.88it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.18it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.88it/s] 50%|█████     | 6/12 [00:00<00:00, 10.00it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.68it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.90it/s]100%|██████████| 12/12 [00:02<00:00,  2.70it/s]100%|██████████| 12/12 [00:02<00:00,  4.24it/s]
2025-03-13 11:13:06,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:06
2025-03-13 11:13:34,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9155 secs
2025-03-13 11:13:34,668 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:13:34,668 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-13 11:13:49,521 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8529 secs
2025-03-13 11:13:49,524 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6071 secs
2025-03-13 11:13:49,524 [INFO]: {
2025-03-13 11:13:49,524 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:49,524 [INFO]: 	index_param: efSearch=295
2025-03-13 11:13:49,524 [INFO]: 	index_path: knn.index
2025-03-13 11:13:49,524 [INFO]: 	size in bytes: 553833790
2025-03-13 11:13:49,524 [INFO]: 	avg_search_speed_ms: 9.71710718480329
2025-03-13 11:13:49,524 [INFO]: 	99p_search_speed_ms: 14.775429740548134
2025-03-13 11:13:49,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:49,524 [INFO]: 	nb vectors: 2815
2025-03-13 11:13:49,524 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:49,524 [INFO]: 	compression ratio: 0.9993097748694604
2025-03-13 11:13:49,524 [INFO]: }
2025-03-13 11:13:49,524 [INFO]: 	>>> Finished "Creating the index" in 45.6087 secs
2025-03-13 11:13:49,524 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6333 secs
2025-03-13 11:13:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 28351 [episode count 6/20]
[retrieval_preprocessing] for episode 91356 [episode count 7/20], we have num_retrieval=np.int64(2794) num_query=np.int64(149)
2025-03-13 11:13:51,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:52,188 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:52
2025-03-13 11:13:52,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.45it/s]
2025-03-13 11:13:52,215 [INFO]: There are 2794 embeddings of dim 49152
2025-03-13 11:13:52,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 11:13:52,216 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:52
2025-03-13 11:13:52,216 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:52,216 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:13:52,216 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:52,216 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:13:52,216 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:52
2025-03-13 11:13:52,217 [INFO]: 576.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:52,217 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:13:52,217 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:52
2025-03-13 11:13:52,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:52,217 [INFO]: 	Creating the index 03/13/2025, 11:13:52
2025-03-13 11:13:52,217 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:52
2025-03-13 11:13:52,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:13:52,221 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:52
2025-03-13 11:13:52,221 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:13:52,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.22it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.31it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.14it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.52it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.56it/s]100%|██████████| 11/11 [00:02<00:00,  2.68it/s]100%|██████████| 11/11 [00:02<00:00,  4.19it/s]
2025-03-13 11:13:54,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:54
2025-03-13 11:14:22,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2467 secs
2025-03-13 11:14:22,103 [INFO]: The best hyperparameters are: efSearch=402
2025-03-13 11:14:22,103 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
2025-03-13 11:14:34,631 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5279 secs
2025-03-13 11:14:34,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4128 secs
2025-03-13 11:14:34,634 [INFO]: {
2025-03-13 11:14:34,634 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:34,634 [INFO]: 	index_param: efSearch=402
2025-03-13 11:14:34,634 [INFO]: 	index_path: knn.index
2025-03-13 11:14:34,634 [INFO]: 	size in bytes: 549702130
2025-03-13 11:14:34,634 [INFO]: 	avg_search_speed_ms: 11.98665965716991
2025-03-13 11:14:34,634 [INFO]: 	99p_search_speed_ms: 19.179051667451837
2025-03-13 11:14:34,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:34,634 [INFO]: 	nb vectors: 2794
2025-03-13 11:14:34,634 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:34,634 [INFO]: 	compression ratio: 0.9993098480444309
2025-03-13 11:14:34,634 [INFO]: }
2025-03-13 11:14:34,634 [INFO]: 	>>> Finished "Creating the index" in 42.4170 secs
2025-03-13 11:14:34,634 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4459 secs
2025-03-13 11:14:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 91356 [episode count 7/20]
[retrieval_preprocessing] for episode 69360 [episode count 8/20], we have num_retrieval=np.int64(2821) num_query=np.int64(122)
2025-03-13 11:14:38,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:38,614 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:38
2025-03-13 11:14:38,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.72it/s]
2025-03-13 11:14:38,642 [INFO]: There are 2821 embeddings of dim 49152
2025-03-13 11:14:38,642 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:14:38,642 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:38
2025-03-13 11:14:38,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:38,643 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:14:38,643 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:38,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:14:38,643 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:38
2025-03-13 11:14:38,643 [INFO]: 582.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:38,644 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:14:38,644 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:38
2025-03-13 11:14:38,644 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:38,644 [INFO]: 	Creating the index 03/13/2025, 11:14:38
2025-03-13 11:14:38,644 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:38
2025-03-13 11:14:38,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:14:38,648 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:38
2025-03-13 11:14:38,648 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:14:38,648 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.32it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.84it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.59it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.07it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.27it/s] 50%|█████     | 6/12 [00:00<00:00,  8.38it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.47it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.57it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.70it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.71it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.65it/s]100%|██████████| 12/12 [00:03<00:00,  1.65it/s]100%|██████████| 12/12 [00:03<00:00,  3.91it/s]
2025-03-13 11:14:41,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:41
2025-03-13 11:15:08,530 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8113 secs
2025-03-13 11:15:08,530 [INFO]: The best hyperparameters are: efSearch=398
2025-03-13 11:15:08,530 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 11:15:22,159 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6286 secs
2025-03-13 11:15:22,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5136 secs
2025-03-13 11:15:22,162 [INFO]: {
2025-03-13 11:15:22,162 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:22,162 [INFO]: 	index_param: efSearch=398
2025-03-13 11:15:22,162 [INFO]: 	index_path: knn.index
2025-03-13 11:15:22,162 [INFO]: 	size in bytes: 555014230
2025-03-13 11:15:22,162 [INFO]: 	avg_search_speed_ms: 13.079235351833155
2025-03-13 11:15:22,162 [INFO]: 	99p_search_speed_ms: 23.083311812952168
2025-03-13 11:15:22,162 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:22,162 [INFO]: 	nb vectors: 2821
2025-03-13 11:15:22,162 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:22,162 [INFO]: 	compression ratio: 0.9993098158942699
2025-03-13 11:15:22,162 [INFO]: }
2025-03-13 11:15:22,162 [INFO]: 	>>> Finished "Creating the index" in 43.5174 secs
2025-03-13 11:15:22,162 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5476 secs
2025-03-13 11:15:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 69360 [episode count 8/20]
[retrieval_preprocessing] for episode 86340 [episode count 9/20], we have num_retrieval=np.int64(2784) num_query=np.int64(159)
2025-03-13 11:15:25,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:25,658 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:25
2025-03-13 11:15:25,658 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.37it/s]
2025-03-13 11:15:25,686 [INFO]: There are 2784 embeddings of dim 49152
2025-03-13 11:15:25,686 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:15:25,687 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:25
2025-03-13 11:15:25,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:25,687 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:15:25,687 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:25,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:15:25,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:25
2025-03-13 11:15:25,688 [INFO]: 574.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:25,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:15:25,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:25
2025-03-13 11:15:25,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:25,689 [INFO]: 	Creating the index 03/13/2025, 11:15:25
2025-03-13 11:15:25,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:25
2025-03-13 11:15:25,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:15:25,692 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:25
2025-03-13 11:15:25,692 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:15:25,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.33it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.88it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.03it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.09it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.05it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.64it/s]100%|██████████| 11/11 [00:03<00:00,  2.32it/s]100%|██████████| 11/11 [00:03<00:00,  3.55it/s]
2025-03-13 11:15:28,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:28
2025-03-13 11:15:56,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2806 secs
2025-03-13 11:15:56,084 [INFO]: The best hyperparameters are: efSearch=325
2025-03-13 11:15:56,084 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s]
2025-03-13 11:16:08,541 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4576 secs
2025-03-13 11:16:08,544 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8519 secs
2025-03-13 11:16:08,544 [INFO]: {
2025-03-13 11:16:08,544 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:08,544 [INFO]: 	index_param: efSearch=325
2025-03-13 11:16:08,544 [INFO]: 	index_path: knn.index
2025-03-13 11:16:08,544 [INFO]: 	size in bytes: 547734670
2025-03-13 11:16:08,544 [INFO]: 	avg_search_speed_ms: 11.047122165694503
2025-03-13 11:16:08,544 [INFO]: 	99p_search_speed_ms: 15.084585053846247
2025-03-13 11:16:08,544 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:08,544 [INFO]: 	nb vectors: 2784
2025-03-13 11:16:08,544 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:08,544 [INFO]: 	compression ratio: 0.9993098884903524
2025-03-13 11:16:08,544 [INFO]: }
2025-03-13 11:16:08,544 [INFO]: 	>>> Finished "Creating the index" in 42.8555 secs
2025-03-13 11:16:08,544 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8858 secs
2025-03-13 11:16:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 86340 [episode count 9/20]
[retrieval_preprocessing] for episode 91975 [episode count 10/20], we have num_retrieval=np.int64(2790) num_query=np.int64(153)
2025-03-13 11:16:11,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:11,732 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:11
2025-03-13 11:16:11,732 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.84it/s]
2025-03-13 11:16:11,758 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 11:16:11,759 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:16:11,759 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,759 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:11,759 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:16:11,759 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:11,759 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:16:11,759 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,759 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:11,759 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:16:11,759 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:11
2025-03-13 11:16:11,759 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:11,759 [INFO]: 	Creating the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:11
2025-03-13 11:16:11,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:16:11,760 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:11
2025-03-13 11:16:11,761 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:16:11,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.75it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.44it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.97it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.18it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.18it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.05it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.01it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.89it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.77it/s]100%|██████████| 11/11 [00:03<00:00,  1.36it/s]100%|██████████| 11/11 [00:03<00:00,  3.31it/s]
2025-03-13 11:16:15,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:15
2025-03-13 11:16:47,536 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4377 secs
2025-03-13 11:16:47,536 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 11:16:47,536 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s]
2025-03-13 11:17:02,365 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8292 secs
2025-03-13 11:17:02,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6073 secs
2025-03-13 11:17:02,368 [INFO]: {
2025-03-13 11:17:02,368 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:02,368 [INFO]: 	index_param: efSearch=307
2025-03-13 11:17:02,368 [INFO]: 	index_path: knn.index
2025-03-13 11:17:02,368 [INFO]: 	size in bytes: 548915110
2025-03-13 11:17:02,368 [INFO]: 	avg_search_speed_ms: 9.875465319367807
2025-03-13 11:17:02,368 [INFO]: 	99p_search_speed_ms: 13.778359573334455
2025-03-13 11:17:02,368 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:02,368 [INFO]: 	nb vectors: 2790
2025-03-13 11:17:02,368 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:02,368 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 11:17:02,368 [INFO]: }
2025-03-13 11:17:02,368 [INFO]: 	>>> Finished "Creating the index" in 50.6089 secs
2025-03-13 11:17:02,368 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6363 secs
2025-03-13 11:17:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 91975 [episode count 10/20]
[retrieval_preprocessing] for episode 87896 [episode count 11/20], we have num_retrieval=np.int64(2805) num_query=np.int64(138)
2025-03-13 11:17:04,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:05,269 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:05
2025-03-13 11:17:05,269 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1229.28it/s]
2025-03-13 11:17:05,291 [INFO]: There are 2805 embeddings of dim 49152
2025-03-13 11:17:05,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 11:17:05,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:05
2025-03-13 11:17:05,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:05,292 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:17:05,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:05,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:05,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:05
2025-03-13 11:17:05,292 [INFO]: 578.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:05,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:05,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:05
2025-03-13 11:17:05,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:05,292 [INFO]: 	Creating the index 03/13/2025, 11:17:05
2025-03-13 11:17:05,292 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:05
2025-03-13 11:17:05,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:17:05,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:05
2025-03-13 11:17:05,293 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:17:05,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.25it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.10it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.80it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.27it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.55it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.91it/s]100%|██████████| 12/12 [00:02<00:00,  4.45it/s]
2025-03-13 11:17:07,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:07
2025-03-13 11:17:39,900 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9078 secs
2025-03-13 11:17:39,901 [INFO]: The best hyperparameters are: efSearch=343
2025-03-13 11:17:39,901 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 11:17:54,232 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3316 secs
2025-03-13 11:17:54,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9419 secs
2025-03-13 11:17:54,235 [INFO]: {
2025-03-13 11:17:54,235 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:54,235 [INFO]: 	index_param: efSearch=343
2025-03-13 11:17:54,235 [INFO]: 	index_path: knn.index
2025-03-13 11:17:54,235 [INFO]: 	size in bytes: 551866390
2025-03-13 11:17:54,235 [INFO]: 	avg_search_speed_ms: 10.809815704721856
2025-03-13 11:17:54,235 [INFO]: 	99p_search_speed_ms: 17.691826745867722
2025-03-13 11:17:54,235 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:54,235 [INFO]: 	nb vectors: 2805
2025-03-13 11:17:54,235 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:54,235 [INFO]: 	compression ratio: 0.9993097061047693
2025-03-13 11:17:54,235 [INFO]: }
2025-03-13 11:17:54,235 [INFO]: 	>>> Finished "Creating the index" in 48.9433 secs
2025-03-13 11:17:54,235 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9663 secs
2025-03-13 11:17:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 87896 [episode count 11/20]
[retrieval_preprocessing] for episode 31580 [episode count 12/20], we have num_retrieval=np.int64(2811) num_query=np.int64(132)
2025-03-13 11:17:57,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:57,625 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:57
2025-03-13 11:17:57,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.57it/s]
2025-03-13 11:17:57,650 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 11:17:57,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 11:17:57,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:57
2025-03-13 11:17:57,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:57,650 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:17:57,650 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:57,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:57,650 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:57
2025-03-13 11:17:57,650 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:57,650 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:57,650 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:57
2025-03-13 11:17:57,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:57,651 [INFO]: 	Creating the index 03/13/2025, 11:17:57
2025-03-13 11:17:57,651 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:57
2025-03-13 11:17:57,652 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:17:57,652 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:57
2025-03-13 11:17:57,652 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:17:57,652 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.43it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.71it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.54it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.07it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.50it/s] 92%|█████████▏| 11/12 [00:00<00:00, 13.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.54it/s]
2025-03-13 11:18:00,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:00
2025-03-13 11:18:28,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4860 secs
2025-03-13 11:18:28,787 [INFO]: The best hyperparameters are: efSearch=322
2025-03-13 11:18:28,787 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
2025-03-13 11:18:41,516 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7291 secs
2025-03-13 11:18:41,518 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8664 secs
2025-03-13 11:18:41,518 [INFO]: {
2025-03-13 11:18:41,518 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:41,518 [INFO]: 	index_param: efSearch=322
2025-03-13 11:18:41,518 [INFO]: 	index_path: knn.index
2025-03-13 11:18:41,518 [INFO]: 	size in bytes: 553046830
2025-03-13 11:18:41,518 [INFO]: 	avg_search_speed_ms: 9.842806483351252
2025-03-13 11:18:41,518 [INFO]: 	99p_search_speed_ms: 13.699020235799255
2025-03-13 11:18:41,518 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:41,518 [INFO]: 	nb vectors: 2811
2025-03-13 11:18:41,518 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:41,518 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 11:18:41,518 [INFO]: }
2025-03-13 11:18:41,518 [INFO]: 	>>> Finished "Creating the index" in 43.8678 secs
2025-03-13 11:18:41,518 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8929 secs
2025-03-13 11:18:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 31580 [episode count 12/20]
[retrieval_preprocessing] for episode 26992 [episode count 13/20], we have num_retrieval=np.int64(2784) num_query=np.int64(159)
2025-03-13 11:18:43,742 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:44,166 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:44
2025-03-13 11:18:44,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2167.60it/s]
2025-03-13 11:18:44,190 [INFO]: There are 2784 embeddings of dim 49152
2025-03-13 11:18:44,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 11:18:44,190 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,190 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:44,191 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:18:44,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:44,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:18:44,191 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,191 [INFO]: 574.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:44,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:18:44,191 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:44
2025-03-13 11:18:44,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:44,192 [INFO]: 	Creating the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:44
2025-03-13 11:18:44,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 11:18:44,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,194 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:18:44,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.36it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.21it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.84it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.08it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.17it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.38it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.33it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.04it/s]100%|██████████| 11/11 [00:03<00:00,  1.28it/s]100%|██████████| 11/11 [00:03<00:00,  3.12it/s]
2025-03-13 11:18:47,732 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:47
2025-03-13 11:19:17,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6576 secs
2025-03-13 11:19:17,391 [INFO]: The best hyperparameters are: efSearch=356
2025-03-13 11:19:17,391 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-13 11:19:32,486 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0950 secs
2025-03-13 11:19:32,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2942 secs
2025-03-13 11:19:32,488 [INFO]: {
2025-03-13 11:19:32,488 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:32,488 [INFO]: 	index_param: efSearch=356
2025-03-13 11:19:32,488 [INFO]: 	index_path: knn.index
2025-03-13 11:19:32,489 [INFO]: 	size in bytes: 547734670
2025-03-13 11:19:32,489 [INFO]: 	avg_search_speed_ms: 11.082512557562318
2025-03-13 11:19:32,489 [INFO]: 	99p_search_speed_ms: 17.134452040772892
2025-03-13 11:19:32,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:32,489 [INFO]: 	nb vectors: 2784
2025-03-13 11:19:32,489 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:32,489 [INFO]: 	compression ratio: 0.9993098884903524
2025-03-13 11:19:32,489 [INFO]: }
2025-03-13 11:19:32,489 [INFO]: 	>>> Finished "Creating the index" in 48.2969 secs
2025-03-13 11:19:32,489 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3223 secs
2025-03-13 11:19:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 26992 [episode count 13/20]
[retrieval_preprocessing] for episode 59833 [episode count 14/20], we have num_retrieval=np.int64(2811) num_query=np.int64(132)
2025-03-13 11:19:35,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:36,104 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:36
2025-03-13 11:19:36,104 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.22it/s]
2025-03-13 11:19:36,129 [INFO]: There are 2811 embeddings of dim 49152
2025-03-13 11:19:36,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:19:36,130 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:36
2025-03-13 11:19:36,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:36,130 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:19:36,130 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:36,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:36,130 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:36
2025-03-13 11:19:36,130 [INFO]: 580.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:36,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:36,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:36
2025-03-13 11:19:36,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:36,130 [INFO]: 	Creating the index 03/13/2025, 11:19:36
2025-03-13 11:19:36,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:36
2025-03-13 11:19:36,131 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:36,131 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:36
2025-03-13 11:19:36,131 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:19:36,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.78it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.82it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.81it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.53it/s] 50%|█████     | 6/12 [00:00<00:00,  9.23it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.16it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.09it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.01it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.73it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.52it/s]100%|██████████| 12/12 [00:03<00:00,  1.26it/s]100%|██████████| 12/12 [00:03<00:00,  3.23it/s]
2025-03-13 11:19:39,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:39
2025-03-13 11:20:09,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7117 secs
2025-03-13 11:20:09,567 [INFO]: The best hyperparameters are: efSearch=362
2025-03-13 11:20:09,567 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-13 11:20:25,040 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4732 secs
2025-03-13 11:20:25,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9116 secs
2025-03-13 11:20:25,043 [INFO]: {
2025-03-13 11:20:25,043 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:25,043 [INFO]: 	index_param: efSearch=362
2025-03-13 11:20:25,043 [INFO]: 	index_path: knn.index
2025-03-13 11:20:25,043 [INFO]: 	size in bytes: 553046830
2025-03-13 11:20:25,043 [INFO]: 	avg_search_speed_ms: 11.199314756556712
2025-03-13 11:20:25,043 [INFO]: 	99p_search_speed_ms: 15.85430598817766
2025-03-13 11:20:25,043 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:25,043 [INFO]: 	nb vectors: 2811
2025-03-13 11:20:25,043 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:25,043 [INFO]: 	compression ratio: 0.9993097474222933
2025-03-13 11:20:25,043 [INFO]: }
2025-03-13 11:20:25,043 [INFO]: 	>>> Finished "Creating the index" in 48.9131 secs
2025-03-13 11:20:25,043 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9392 secs
2025-03-13 11:20:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 59833 [episode count 14/20]
[retrieval_preprocessing] for episode 46536 [episode count 15/20], we have num_retrieval=np.int64(2805) num_query=np.int64(138)
2025-03-13 11:20:27,600 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:28,015 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:28
2025-03-13 11:20:28,015 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-13 11:20:28,039 [INFO]: There are 2805 embeddings of dim 49152
2025-03-13 11:20:28,039 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:20:28,039 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:28
2025-03-13 11:20:28,039 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:28,039 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:20:28,039 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:28,039 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:28,039 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:28
2025-03-13 11:20:28,039 [INFO]: 578.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:28,040 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:28,040 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:28
2025-03-13 11:20:28,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:28,040 [INFO]: 	Creating the index 03/13/2025, 11:20:28
2025-03-13 11:20:28,040 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:28
2025-03-13 11:20:28,041 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:20:28,041 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:28
2025-03-13 11:20:28,041 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:20:28,041 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.29it/s] 33%|███▎      | 4/12 [00:00<00:00, 15.28it/s] 50%|█████     | 6/12 [00:00<00:00, 12.95it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.34it/s] 83%|████████▎ | 10/12 [00:00<00:00,  9.28it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.98it/s]100%|██████████| 12/12 [00:02<00:00,  1.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.05it/s]
2025-03-13 11:20:31,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:31
2025-03-13 11:21:02,888 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8797 secs
2025-03-13 11:21:02,888 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 11:21:02,888 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s]
2025-03-13 11:21:15,638 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7498 secs
2025-03-13 11:21:15,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5992 secs
2025-03-13 11:21:15,640 [INFO]: {
2025-03-13 11:21:15,640 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:15,640 [INFO]: 	index_param: efSearch=299
2025-03-13 11:21:15,640 [INFO]: 	index_path: knn.index
2025-03-13 11:21:15,640 [INFO]: 	size in bytes: 551866390
2025-03-13 11:21:15,640 [INFO]: 	avg_search_speed_ms: 9.51470144524582
2025-03-13 11:21:15,640 [INFO]: 	99p_search_speed_ms: 17.16486201621592
2025-03-13 11:21:15,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:15,640 [INFO]: 	nb vectors: 2805
2025-03-13 11:21:15,640 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:15,640 [INFO]: 	compression ratio: 0.9993097061047693
2025-03-13 11:21:15,640 [INFO]: }
2025-03-13 11:21:15,640 [INFO]: 	>>> Finished "Creating the index" in 47.6005 secs
2025-03-13 11:21:15,640 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6256 secs
2025-03-13 11:21:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 46536 [episode count 15/20]
[retrieval_preprocessing] for episode 16347 [episode count 16/20], we have num_retrieval=np.int64(2821) num_query=np.int64(122)
2025-03-13 11:21:17,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:18,352 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:18
2025-03-13 11:21:18,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1780.26it/s]
2025-03-13 11:21:18,375 [INFO]: There are 2821 embeddings of dim 49152
2025-03-13 11:21:18,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:21:18,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:18,375 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:21:18,375 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:18,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:18,375 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,376 [INFO]: 582.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:18,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:21:18,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:18
2025-03-13 11:21:18,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:18,376 [INFO]: 	Creating the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,376 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:18
2025-03-13 11:21:18,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:21:18,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:18
2025-03-13 11:21:18,377 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:21:18,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.90it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.71it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.77it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.18it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.46it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.63it/s]100%|██████████| 12/12 [00:02<00:00,  4.53it/s]
2025-03-13 11:21:21,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:21
2025-03-13 11:21:48,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8288 secs
2025-03-13 11:21:48,862 [INFO]: The best hyperparameters are: efSearch=397
2025-03-13 11:21:48,862 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
2025-03-13 11:22:02,096 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2347 secs
2025-03-13 11:22:02,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7225 secs
2025-03-13 11:22:02,099 [INFO]: {
2025-03-13 11:22:02,099 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:02,099 [INFO]: 	index_param: efSearch=397
2025-03-13 11:22:02,099 [INFO]: 	index_path: knn.index
2025-03-13 11:22:02,100 [INFO]: 	size in bytes: 555014230
2025-03-13 11:22:02,100 [INFO]: 	avg_search_speed_ms: 12.82075163311301
2025-03-13 11:22:02,100 [INFO]: 	99p_search_speed_ms: 22.93200596934185
2025-03-13 11:22:02,100 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:02,100 [INFO]: 	nb vectors: 2821
2025-03-13 11:22:02,100 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:02,100 [INFO]: 	compression ratio: 0.9993098158942699
2025-03-13 11:22:02,100 [INFO]: }
2025-03-13 11:22:02,100 [INFO]: 	>>> Finished "Creating the index" in 43.7240 secs
2025-03-13 11:22:02,100 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7472 secs
2025-03-13 11:22:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 16347 [episode count 16/20]
[retrieval_preprocessing] for episode 93161 [episode count 17/20], we have num_retrieval=np.int64(2787) num_query=np.int64(156)
2025-03-13 11:22:04,971 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:05,333 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:05
2025-03-13 11:22:05,333 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.60it/s]
2025-03-13 11:22:05,357 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 11:22:05,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:22:05,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:05
2025-03-13 11:22:05,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:05,357 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:22:05,357 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:05,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:05,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:05
2025-03-13 11:22:05,358 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:05,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:22:05,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:05
2025-03-13 11:22:05,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:05,358 [INFO]: 	Creating the index 03/13/2025, 11:22:05
2025-03-13 11:22:05,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:05
2025-03-13 11:22:05,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:22:05,359 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:05
2025-03-13 11:22:05,359 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:22:05,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.54it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.46it/s] 55%|█████▍    | 6/11 [00:00<00:00, 13.09it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.52it/s] 91%|█████████ | 10/11 [00:00<00:00, 11.16it/s]100%|██████████| 11/11 [00:02<00:00,  4.17it/s]
2025-03-13 11:22:08,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:08
2025-03-13 11:22:36,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1710 secs
2025-03-13 11:22:36,180 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 11:22:36,180 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 11:22:50,229 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0491 secs
2025-03-13 11:22:50,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8726 secs
2025-03-13 11:22:50,232 [INFO]: {
2025-03-13 11:22:50,232 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:50,232 [INFO]: 	index_param: efSearch=328
2025-03-13 11:22:50,232 [INFO]: 	index_path: knn.index
2025-03-13 11:22:50,232 [INFO]: 	size in bytes: 548324890
2025-03-13 11:22:50,232 [INFO]: 	avg_search_speed_ms: 10.748214154474196
2025-03-13 11:22:50,232 [INFO]: 	99p_search_speed_ms: 20.82332644611599
2025-03-13 11:22:50,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:50,232 [INFO]: 	nb vectors: 2787
2025-03-13 11:22:50,232 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:50,232 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 11:22:50,232 [INFO]: }
2025-03-13 11:22:50,232 [INFO]: 	>>> Finished "Creating the index" in 44.8741 secs
2025-03-13 11:22:50,232 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8985 secs
2025-03-13 11:22:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 93161 [episode count 17/20]
[retrieval_preprocessing] for episode 40743 [episode count 18/20], we have num_retrieval=np.int64(2794) num_query=np.int64(149)
2025-03-13 11:22:52,702 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:53,079 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:53
2025-03-13 11:22:53,079 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.19it/s]
2025-03-13 11:22:53,103 [INFO]: There are 2794 embeddings of dim 49152
2025-03-13 11:22:53,104 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:22:53,104 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:53
2025-03-13 11:22:53,104 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:53,104 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:22:53,104 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:53,104 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:53,104 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:53
2025-03-13 11:22:53,104 [INFO]: 576.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:53,104 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:22:53,104 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:53
2025-03-13 11:22:53,104 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:53,104 [INFO]: 	Creating the index 03/13/2025, 11:22:53
2025-03-13 11:22:53,104 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:53
2025-03-13 11:22:53,105 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:22:53,105 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:53
2025-03-13 11:22:53,105 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:22:53,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.15it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.01it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.59it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.42it/s] 91%|█████████ | 10/11 [00:00<00:00, 14.59it/s]100%|██████████| 11/11 [00:02<00:00,  4.46it/s]
2025-03-13 11:22:55,580 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:55
2025-03-13 11:23:23,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8448 secs
2025-03-13 11:23:23,426 [INFO]: The best hyperparameters are: efSearch=348
2025-03-13 11:23:23,426 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s]
2025-03-13 11:23:36,829 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4032 secs
2025-03-13 11:23:36,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7265 secs
2025-03-13 11:23:36,832 [INFO]: {
2025-03-13 11:23:36,832 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:36,832 [INFO]: 	index_param: efSearch=348
2025-03-13 11:23:36,832 [INFO]: 	index_path: knn.index
2025-03-13 11:23:36,832 [INFO]: 	size in bytes: 549702130
2025-03-13 11:23:36,832 [INFO]: 	avg_search_speed_ms: 10.938413315850028
2025-03-13 11:23:36,832 [INFO]: 	99p_search_speed_ms: 16.920209124218673
2025-03-13 11:23:36,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:36,832 [INFO]: 	nb vectors: 2794
2025-03-13 11:23:36,832 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:36,832 [INFO]: 	compression ratio: 0.9993098480444309
2025-03-13 11:23:36,832 [INFO]: }
2025-03-13 11:23:36,832 [INFO]: 	>>> Finished "Creating the index" in 43.7279 secs
2025-03-13 11:23:36,832 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7526 secs
2025-03-13 11:23:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 40743 [episode count 18/20]
[retrieval_preprocessing] for episode 57251 [episode count 19/20], we have num_retrieval=np.int64(2783) num_query=np.int64(160)
2025-03-13 11:23:39,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:40,171 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:40
2025-03-13 11:23:40,171 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1815.72it/s]
2025-03-13 11:23:40,200 [INFO]: There are 2783 embeddings of dim 49152
2025-03-13 11:23:40,200 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:23:40,200 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:40
2025-03-13 11:23:40,200 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:40,200 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 11:23:40,200 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:40,200 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:40,200 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:40
2025-03-13 11:23:40,200 [INFO]: 574.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:40,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:23:40,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:40
2025-03-13 11:23:40,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:40,201 [INFO]: 	Creating the index 03/13/2025, 11:23:40
2025-03-13 11:23:40,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:40
2025-03-13 11:23:40,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:23:40,202 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:40
2025-03-13 11:23:40,202 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:23:40,202 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.44it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.57it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.88it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.43it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.45it/s] 91%|█████████ | 10/11 [00:01<00:00, 12.18it/s]100%|██████████| 11/11 [00:02<00:00,  3.72it/s]
2025-03-13 11:23:43,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:43
2025-03-13 11:24:14,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3789 secs
2025-03-13 11:24:14,549 [INFO]: The best hyperparameters are: efSearch=298
2025-03-13 11:24:14,549 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 11:24:27,771 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2221 secs
2025-03-13 11:24:27,773 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5717 secs
2025-03-13 11:24:27,774 [INFO]: {
2025-03-13 11:24:27,774 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:27,774 [INFO]: 	index_param: efSearch=298
2025-03-13 11:24:27,774 [INFO]: 	index_path: knn.index
2025-03-13 11:24:27,774 [INFO]: 	size in bytes: 547537930
2025-03-13 11:24:27,774 [INFO]: 	avg_search_speed_ms: 11.168503925703757
2025-03-13 11:24:27,774 [INFO]: 	99p_search_speed_ms: 19.67611936852327
2025-03-13 11:24:27,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:27,774 [INFO]: 	nb vectors: 2783
2025-03-13 11:24:27,774 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:27,774 [INFO]: 	compression ratio: 0.9993098816003487
2025-03-13 11:24:27,774 [INFO]: }
2025-03-13 11:24:27,774 [INFO]: 	>>> Finished "Creating the index" in 47.5731 secs
2025-03-13 11:24:27,774 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6030 secs
2025-03-13 11:24:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 57251 [episode count 19/20]
2025-03-13 11:24:29: [retrieval_preprocessing] finished for 7495112204_put_marker_in_mug [chosen_id count 1/260]
2025-03-13 11:24:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7724213024_pens_to_container [chosen_id count 2/260]
2025-03-13 11:24:32: [retrieval_preprocessing] we have num_total=3564 embedding_dim=49152
[retrieval_preprocessing] for episode 62541 [episode count 0/20], we have num_retrieval=np.int64(3426) num_query=np.int64(138)
2025-03-13 11:24:34,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:34,681 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:34
2025-03-13 11:24:34,681 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.57it/s]
2025-03-13 11:24:34,709 [INFO]: There are 3426 embeddings of dim 49152
2025-03-13 11:24:34,709 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 11:24:34,710 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:34
2025-03-13 11:24:34,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:34,710 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:24:34,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:34,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:24:34,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:34
2025-03-13 11:24:34,711 [INFO]: 707.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:34,711 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:24:34,711 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:34
2025-03-13 11:24:34,711 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:34,712 [INFO]: 	Creating the index 03/13/2025, 11:24:34
2025-03-13 11:24:34,712 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:34
2025-03-13 11:24:34,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:24:34,715 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:34
2025-03-13 11:24:34,715 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:24:34,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.04it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.92it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.64it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.77it/s] 50%|█████     | 7/14 [00:00<00:00,  9.35it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.04it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.91it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.63it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.20it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.15it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.05it/s]100%|██████████| 14/14 [00:03<00:00,  1.24it/s]100%|██████████| 14/14 [00:03<00:00,  3.52it/s]
2025-03-13 11:24:38,700 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:38
2025-03-13 11:25:10,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0702 secs
2025-03-13 11:25:10,771 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 11:25:10,771 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-13 11:25:26,590 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8188 secs
2025-03-13 11:25:26,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8775 secs
2025-03-13 11:25:26,593 [INFO]: {
2025-03-13 11:25:26,593 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:26,593 [INFO]: 	index_param: efSearch=264
2025-03-13 11:25:26,593 [INFO]: 	index_path: knn.index
2025-03-13 11:25:26,593 [INFO]: 	size in bytes: 674044510
2025-03-13 11:25:26,593 [INFO]: 	avg_search_speed_ms: 10.435116370616866
2025-03-13 11:25:26,593 [INFO]: 	99p_search_speed_ms: 15.521586698014245
2025-03-13 11:25:26,593 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:26,593 [INFO]: 	nb vectors: 3426
2025-03-13 11:25:26,593 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:26,593 [INFO]: 	compression ratio: 0.9993093898205624
2025-03-13 11:25:26,593 [INFO]: }
2025-03-13 11:25:26,593 [INFO]: 	>>> Finished "Creating the index" in 51.8816 secs
2025-03-13 11:25:26,593 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9126 secs
2025-03-13 11:25:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 62541 [episode count 0/20]
[retrieval_preprocessing] for episode 94819 [episode count 1/20], we have num_retrieval=np.int64(3333) num_query=np.int64(231)
2025-03-13 11:25:29,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:30,161 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:30
2025-03-13 11:25:30,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-13 11:25:30,188 [INFO]: There are 3333 embeddings of dim 49152
2025-03-13 11:25:30,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 11:25:30,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:30
2025-03-13 11:25:30,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:30,188 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:25:30,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:30,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:30,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:30
2025-03-13 11:25:30,189 [INFO]: 687.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:30,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:25:30,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:30
2025-03-13 11:25:30,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:30,189 [INFO]: 	Creating the index 03/13/2025, 11:25:30
2025-03-13 11:25:30,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:30
2025-03-13 11:25:30,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:25:30,190 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:30
2025-03-13 11:25:30,190 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:25:30,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.61it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.12it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.75it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.48it/s] 57%|█████▋    | 8/14 [00:00<00:00, 13.87it/s] 71%|███████▏  | 10/14 [00:00<00:00, 13.06it/s] 86%|████████▌ | 12/14 [00:01<00:00, 13.11it/s]100%|██████████| 14/14 [00:03<00:00,  2.34it/s]100%|██████████| 14/14 [00:03<00:00,  4.15it/s]
2025-03-13 11:25:33,569 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:33
2025-03-13 11:26:07,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2411 secs
2025-03-13 11:26:07,810 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:26:07,810 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 11:26:20,782 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9714 secs
2025-03-13 11:26:20,784 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5943 secs
2025-03-13 11:26:20,784 [INFO]: {
2025-03-13 11:26:20,784 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:20,784 [INFO]: 	index_param: efSearch=251
2025-03-13 11:26:20,784 [INFO]: 	index_path: knn.index
2025-03-13 11:26:20,784 [INFO]: 	size in bytes: 655747510
2025-03-13 11:26:20,784 [INFO]: 	avg_search_speed_ms: 10.971244120778385
2025-03-13 11:26:20,785 [INFO]: 	99p_search_speed_ms: 19.39881003927439
2025-03-13 11:26:20,785 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:20,785 [INFO]: 	nb vectors: 3333
2025-03-13 11:26:20,785 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:20,785 [INFO]: 	compression ratio: 0.999309115180628
2025-03-13 11:26:20,785 [INFO]: }
2025-03-13 11:26:20,785 [INFO]: 	>>> Finished "Creating the index" in 50.5958 secs
2025-03-13 11:26:20,785 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6237 secs
2025-03-13 11:26:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 94819 [episode count 1/20]
[retrieval_preprocessing] for episode 40548 [episode count 2/20], we have num_retrieval=np.int64(3409) num_query=np.int64(155)
2025-03-13 11:26:23,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:24,408 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:24
2025-03-13 11:26:24,408 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1505.49it/s]
2025-03-13 11:26:24,432 [INFO]: There are 3409 embeddings of dim 49152
2025-03-13 11:26:24,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:26:24,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:24
2025-03-13 11:26:24,432 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:24,432 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:26:24,432 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:24,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:26:24,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:24
2025-03-13 11:26:24,433 [INFO]: 703.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:24,433 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:26:24,433 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:24
2025-03-13 11:26:24,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:24,433 [INFO]: 	Creating the index 03/13/2025, 11:26:24
2025-03-13 11:26:24,433 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:24
2025-03-13 11:26:24,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:26:24,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:24
2025-03-13 11:26:24,434 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:26:24,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.12it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.28it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.76it/s] 50%|█████     | 7/14 [00:00<00:00, 11.16it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.34it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.49it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.37it/s]100%|██████████| 14/14 [00:03<00:00,  4.06it/s]
2025-03-13 11:26:27,889 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:27
2025-03-13 11:27:06,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2508 secs
2025-03-13 11:27:06,140 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 11:27:06,140 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s]
2025-03-13 11:27:20,581 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4405 secs
2025-03-13 11:27:20,583 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1496 secs
2025-03-13 11:27:20,584 [INFO]: {
2025-03-13 11:27:20,584 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:20,584 [INFO]: 	index_param: efSearch=253
2025-03-13 11:27:20,584 [INFO]: 	index_path: knn.index
2025-03-13 11:27:20,584 [INFO]: 	size in bytes: 670699930
2025-03-13 11:27:20,584 [INFO]: 	avg_search_speed_ms: 10.298138799435478
2025-03-13 11:27:20,584 [INFO]: 	99p_search_speed_ms: 15.567733673378823
2025-03-13 11:27:20,584 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:20,584 [INFO]: 	nb vectors: 3409
2025-03-13 11:27:20,584 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:20,584 [INFO]: 	compression ratio: 0.9993092917126143
2025-03-13 11:27:20,584 [INFO]: }
2025-03-13 11:27:20,584 [INFO]: 	>>> Finished "Creating the index" in 56.1514 secs
2025-03-13 11:27:20,584 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1761 secs
2025-03-13 11:27:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 40548 [episode count 2/20]
[retrieval_preprocessing] for episode 67735 [episode count 3/20], we have num_retrieval=np.int64(3362) num_query=np.int64(202)
2025-03-13 11:27:23,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:24,148 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:24
2025-03-13 11:27:24,148 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2187.95it/s]
2025-03-13 11:27:24,170 [INFO]: There are 3362 embeddings of dim 49152
2025-03-13 11:27:24,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 11:27:24,170 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:24
2025-03-13 11:27:24,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:24,170 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:27:24,170 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:24,170 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:24,170 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:24
2025-03-13 11:27:24,170 [INFO]: 693.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:24,170 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:24,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:24
2025-03-13 11:27:24,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:24,171 [INFO]: 	Creating the index 03/13/2025, 11:27:24
2025-03-13 11:27:24,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:24
2025-03-13 11:27:24,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:27:24,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:24
2025-03-13 11:27:24,172 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:27:24,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.86it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.51it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.13it/s] 43%|████▎     | 6/14 [00:00<00:00, 10.32it/s] 57%|█████▋    | 8/14 [00:00<00:00, 10.88it/s] 71%|███████▏  | 10/14 [00:00<00:00, 11.76it/s] 86%|████████▌ | 12/14 [00:01<00:00, 11.76it/s]100%|██████████| 14/14 [00:03<00:00,  2.03it/s]100%|██████████| 14/14 [00:03<00:00,  3.69it/s]
2025-03-13 11:27:27,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:27
2025-03-13 11:28:09,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2502 secs
2025-03-13 11:28:09,221 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 11:28:09,221 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 11:28:25,520 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2983 secs
2025-03-13 11:28:25,523 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3516 secs
2025-03-13 11:28:25,524 [INFO]: {
2025-03-13 11:28:25,524 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:25,524 [INFO]: 	index_param: efSearch=240
2025-03-13 11:28:25,524 [INFO]: 	index_path: knn.index
2025-03-13 11:28:25,524 [INFO]: 	size in bytes: 661452970
2025-03-13 11:28:25,524 [INFO]: 	avg_search_speed_ms: 10.708258392556512
2025-03-13 11:28:25,524 [INFO]: 	99p_search_speed_ms: 14.89176985342055
2025-03-13 11:28:25,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:25,524 [INFO]: 	nb vectors: 3362
2025-03-13 11:28:25,524 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:25,524 [INFO]: 	compression ratio: 0.9993092872498555
2025-03-13 11:28:25,524 [INFO]: }
2025-03-13 11:28:25,524 [INFO]: 	>>> Finished "Creating the index" in 61.3533 secs
2025-03-13 11:28:25,524 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3758 secs
2025-03-13 11:28:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 67735 [episode count 3/20]
[retrieval_preprocessing] for episode 16580 [episode count 4/20], we have num_retrieval=np.int64(3391) num_query=np.int64(173)
2025-03-13 11:28:29,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:30,123 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:30
2025-03-13 11:28:30,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.16it/s]
2025-03-13 11:28:30,154 [INFO]: There are 3391 embeddings of dim 49152
2025-03-13 11:28:30,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 11:28:30,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:30,155 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:28:30,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:30,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:28:30,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,155 [INFO]: 699.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:30,156 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:28:30,156 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:30
2025-03-13 11:28:30,156 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:30,156 [INFO]: 	Creating the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,156 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:30
2025-03-13 11:28:30,159 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:28:30,159 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:30
2025-03-13 11:28:30,159 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:28:30,160 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.47it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.92it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.69it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.08it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.35it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.49it/s] 50%|█████     | 7/14 [00:00<00:00,  8.38it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.56it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.45it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.49it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.51it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.51it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.51it/s]100%|██████████| 14/14 [00:04<00:00,  1.08s/it]100%|██████████| 14/14 [00:04<00:00,  2.86it/s]
2025-03-13 11:28:35,061 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:35
2025-03-13 11:29:13,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1657 secs
2025-03-13 11:29:13,228 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 11:29:13,228 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s]
2025-03-13 11:29:26,274 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0459 secs
2025-03-13 11:29:26,278 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1181 secs
2025-03-13 11:29:26,278 [INFO]: {
2025-03-13 11:29:26,278 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:26,278 [INFO]: 	index_param: efSearch=258
2025-03-13 11:29:26,278 [INFO]: 	index_path: knn.index
2025-03-13 11:29:26,278 [INFO]: 	size in bytes: 667158550
2025-03-13 11:29:26,278 [INFO]: 	avg_search_speed_ms: 11.48781022238711
2025-03-13 11:29:26,278 [INFO]: 	99p_search_speed_ms: 18.666391191072762
2025-03-13 11:29:26,278 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:26,278 [INFO]: 	nb vectors: 3391
2025-03-13 11:29:26,278 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:26,278 [INFO]: 	compression ratio: 0.9993092766329683
2025-03-13 11:29:26,278 [INFO]: }
2025-03-13 11:29:26,278 [INFO]: 	>>> Finished "Creating the index" in 56.1219 secs
2025-03-13 11:29:26,278 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1546 secs
2025-03-13 11:29:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 16580 [episode count 4/20]
[retrieval_preprocessing] for episode 33565 [episode count 5/20], we have num_retrieval=np.int64(3390) num_query=np.int64(174)
2025-03-13 11:29:29,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:29,834 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:29
2025-03-13 11:29:29,834 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.60it/s]
2025-03-13 11:29:29,859 [INFO]: There are 3390 embeddings of dim 49152
2025-03-13 11:29:29,859 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:29:29,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:29
2025-03-13 11:29:29,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:29,860 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:29:29,860 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:29,860 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:29,860 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:29
2025-03-13 11:29:29,860 [INFO]: 699.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:29,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:29,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:29
2025-03-13 11:29:29,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:29,860 [INFO]: 	Creating the index 03/13/2025, 11:29:29
2025-03-13 11:29:29,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:29
2025-03-13 11:29:29,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:29:29,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:29
2025-03-13 11:29:29,861 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:29:29,861 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.54it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.84it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.77it/s] 50%|█████     | 7/14 [00:00<00:00, 10.22it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.17it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.13it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.38it/s]100%|██████████| 14/14 [00:03<00:00,  3.93it/s]
2025-03-13 11:29:33,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:33
2025-03-13 11:30:11,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2218 secs
2025-03-13 11:30:11,650 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:30:11,650 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
2025-03-13 11:30:26,985 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3344 secs
2025-03-13 11:30:26,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1274 secs
2025-03-13 11:30:26,989 [INFO]: {
2025-03-13 11:30:26,989 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:26,989 [INFO]: 	index_param: efSearch=251
2025-03-13 11:30:26,989 [INFO]: 	index_path: knn.index
2025-03-13 11:30:26,989 [INFO]: 	size in bytes: 666961810
2025-03-13 11:30:26,989 [INFO]: 	avg_search_speed_ms: 9.981312024306707
2025-03-13 11:30:26,989 [INFO]: 	99p_search_speed_ms: 14.772598361596465
2025-03-13 11:30:26,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:26,989 [INFO]: 	nb vectors: 3390
2025-03-13 11:30:26,989 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:26,989 [INFO]: 	compression ratio: 0.9993092707961795
2025-03-13 11:30:26,989 [INFO]: }
2025-03-13 11:30:26,989 [INFO]: 	>>> Finished "Creating the index" in 57.1290 secs
2025-03-13 11:30:26,989 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1551 secs
2025-03-13 11:30:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 33565 [episode count 5/20]
[retrieval_preprocessing] for episode 54572 [episode count 6/20], we have num_retrieval=np.int64(3398) num_query=np.int64(166)
2025-03-13 11:30:29,897 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:30,495 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:30
2025-03-13 11:30:30,495 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.40it/s]
2025-03-13 11:30:30,519 [INFO]: There are 3398 embeddings of dim 49152
2025-03-13 11:30:30,520 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 11:30:30,520 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:30
2025-03-13 11:30:30,520 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:30,520 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:30:30,520 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:30,520 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:30,520 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:30
2025-03-13 11:30:30,520 [INFO]: 701.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:30,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:30,520 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:30
2025-03-13 11:30:30,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:30,520 [INFO]: 	Creating the index 03/13/2025, 11:30:30
2025-03-13 11:30:30,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:30
2025-03-13 11:30:30,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:30,521 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:30
2025-03-13 11:30:30,521 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:30:30,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.03it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.05it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.77it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.95it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.06it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.16it/s] 50%|█████     | 7/14 [00:00<00:00,  8.49it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.60it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.68it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.72it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.75it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.92it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.92it/s]100%|██████████| 14/14 [00:03<00:00,  1.30it/s]100%|██████████| 14/14 [00:03<00:00,  3.65it/s]
2025-03-13 11:30:34,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:34
2025-03-13 11:31:04,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4395 secs
2025-03-13 11:31:04,802 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 11:31:04,802 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
2025-03-13 11:31:18,523 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7206 secs
2025-03-13 11:31:18,526 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0045 secs
2025-03-13 11:31:18,526 [INFO]: {
2025-03-13 11:31:18,526 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:18,526 [INFO]: 	index_param: efSearch=283
2025-03-13 11:31:18,526 [INFO]: 	index_path: knn.index
2025-03-13 11:31:18,526 [INFO]: 	size in bytes: 668535730
2025-03-13 11:31:18,526 [INFO]: 	avg_search_speed_ms: 10.371138514236696
2025-03-13 11:31:18,526 [INFO]: 	99p_search_speed_ms: 14.481735825538635
2025-03-13 11:31:18,526 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:18,526 [INFO]: 	nb vectors: 3398
2025-03-13 11:31:18,526 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:18,526 [INFO]: 	compression ratio: 0.9993093173943
2025-03-13 11:31:18,526 [INFO]: }
2025-03-13 11:31:18,526 [INFO]: 	>>> Finished "Creating the index" in 48.0060 secs
2025-03-13 11:31:18,526 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0312 secs
2025-03-13 11:31:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 54572 [episode count 6/20]
[retrieval_preprocessing] for episode 2384 [episode count 7/20], we have num_retrieval=np.int64(3327) num_query=np.int64(237)
2025-03-13 11:31:21,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:21,876 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:21
2025-03-13 11:31:21,876 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-13 11:31:21,899 [INFO]: There are 3327 embeddings of dim 49152
2025-03-13 11:31:21,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 11:31:21,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:21
2025-03-13 11:31:21,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:21,900 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:31:21,900 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:21,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:21,900 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:21
2025-03-13 11:31:21,900 [INFO]: 686.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:21,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:21,900 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:21
2025-03-13 11:31:21,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:21,900 [INFO]: 	Creating the index 03/13/2025, 11:31:21
2025-03-13 11:31:21,900 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:21
2025-03-13 11:31:21,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:21,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:21
2025-03-13 11:31:21,901 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:31:21,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.55it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.07it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.05it/s] 50%|█████     | 7/14 [00:00<00:00, 11.63it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.80it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.04it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.21it/s]100%|██████████| 14/14 [00:03<00:00,  3.99it/s]
2025-03-13 11:31:25,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:25
2025-03-13 11:32:03,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4794 secs
2025-03-13 11:32:03,897 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 11:32:03,897 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s]
2025-03-13 11:32:18,615 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7179 secs
2025-03-13 11:32:18,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7161 secs
2025-03-13 11:32:18,617 [INFO]: {
2025-03-13 11:32:18,617 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:18,618 [INFO]: 	index_param: efSearch=229
2025-03-13 11:32:18,618 [INFO]: 	index_path: knn.index
2025-03-13 11:32:18,618 [INFO]: 	size in bytes: 654567070
2025-03-13 11:32:18,618 [INFO]: 	avg_search_speed_ms: 9.160105580371896
2025-03-13 11:32:18,618 [INFO]: 	99p_search_speed_ms: 13.117813782300797
2025-03-13 11:32:18,618 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:18,618 [INFO]: 	nb vectors: 3327
2025-03-13 11:32:18,618 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:18,618 [INFO]: 	compression ratio: 0.9993090792055885
2025-03-13 11:32:18,618 [INFO]: }
2025-03-13 11:32:18,618 [INFO]: 	>>> Finished "Creating the index" in 56.7176 secs
2025-03-13 11:32:18,618 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7413 secs
2025-03-13 11:32:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 2384 [episode count 7/20]
[retrieval_preprocessing] for episode 75112 [episode count 8/20], we have num_retrieval=np.int64(3368) num_query=np.int64(196)
2025-03-13 11:32:21,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:22,377 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:22
2025-03-13 11:32:22,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2328.88it/s]
2025-03-13 11:32:22,400 [INFO]: There are 3368 embeddings of dim 49152
2025-03-13 11:32:22,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:32:22,400 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:22
2025-03-13 11:32:22,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:22,400 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:32:22,400 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:22,400 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:22,400 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:22
2025-03-13 11:32:22,400 [INFO]: 695.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:22,400 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:22,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:22
2025-03-13 11:32:22,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:22,401 [INFO]: 	Creating the index 03/13/2025, 11:32:22
2025-03-13 11:32:22,401 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:22
2025-03-13 11:32:22,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:32:22,402 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:22
2025-03-13 11:32:22,402 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:32:22,402 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.02it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.81it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.43it/s] 43%|████▎     | 6/14 [00:00<00:00, 10.02it/s] 57%|█████▋    | 8/14 [00:00<00:00, 10.25it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.49it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.50it/s]100%|██████████| 14/14 [00:03<00:00,  1.98it/s]100%|██████████| 14/14 [00:03<00:00,  3.60it/s]
2025-03-13 11:32:26,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:26
2025-03-13 11:33:08,129 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8347 secs
2025-03-13 11:33:08,129 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 11:33:08,129 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 11:33:22,600 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4704 secs
2025-03-13 11:33:22,603 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2013 secs
2025-03-13 11:33:22,603 [INFO]: {
2025-03-13 11:33:22,603 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:22,603 [INFO]: 	index_param: efSearch=208
2025-03-13 11:33:22,603 [INFO]: 	index_path: knn.index
2025-03-13 11:33:22,603 [INFO]: 	size in bytes: 662633410
2025-03-13 11:33:22,603 [INFO]: 	avg_search_speed_ms: 9.784487356548425
2025-03-13 11:33:22,603 [INFO]: 	99p_search_speed_ms: 15.254444011952723
2025-03-13 11:33:22,603 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:22,603 [INFO]: 	nb vectors: 3368
2025-03-13 11:33:22,603 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:22,603 [INFO]: 	compression ratio: 0.9993093224804346
2025-03-13 11:33:22,603 [INFO]: }
2025-03-13 11:33:22,603 [INFO]: 	>>> Finished "Creating the index" in 60.2028 secs
2025-03-13 11:33:22,603 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2261 secs
2025-03-13 11:33:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 75112 [episode count 8/20]
[retrieval_preprocessing] for episode 7028 [episode count 9/20], we have num_retrieval=np.int64(3403) num_query=np.int64(161)
2025-03-13 11:33:25,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:25,905 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:25
2025-03-13 11:33:25,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.85it/s]
2025-03-13 11:33:25,938 [INFO]: There are 3403 embeddings of dim 49152
2025-03-13 11:33:25,938 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 11:33:25,938 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,939 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:25,939 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:33:25,939 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:25,939 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:33:25,939 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,940 [INFO]: 702.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:25,940 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:33:25,940 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:25
2025-03-13 11:33:25,940 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:25,940 [INFO]: 	Creating the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,940 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:25
2025-03-13 11:33:25,943 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:33:25,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,944 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:33:25,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.06it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.86it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.22it/s] 50%|█████     | 7/14 [00:00<00:00, 10.41it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.48it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.58it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.61it/s]100%|██████████| 14/14 [00:04<00:00,  3.49it/s]
2025-03-13 11:33:29,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:29
2025-03-13 11:34:15,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2534 secs
2025-03-13 11:34:15,219 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:34:15,219 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s]
2025-03-13 11:34:30,601 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3824 secs
2025-03-13 11:34:30,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6603 secs
2025-03-13 11:34:30,604 [INFO]: {
2025-03-13 11:34:30,604 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:30,604 [INFO]: 	index_param: efSearch=251
2025-03-13 11:34:30,604 [INFO]: 	index_path: knn.index
2025-03-13 11:34:30,604 [INFO]: 	size in bytes: 669519490
2025-03-13 11:34:30,604 [INFO]: 	avg_search_speed_ms: 9.961345007381517
2025-03-13 11:34:30,604 [INFO]: 	99p_search_speed_ms: 13.416601188946517
2025-03-13 11:34:30,604 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:30,604 [INFO]: 	nb vectors: 3403
2025-03-13 11:34:30,604 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:30,604 [INFO]: 	compression ratio: 0.9993092568522538
2025-03-13 11:34:30,604 [INFO]: }
2025-03-13 11:34:30,604 [INFO]: 	>>> Finished "Creating the index" in 64.6641 secs
2025-03-13 11:34:30,604 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6991 secs
2025-03-13 11:34:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 7028 [episode count 9/20]
[retrieval_preprocessing] for episode 31107 [episode count 10/20], we have num_retrieval=np.int64(3386) num_query=np.int64(178)
2025-03-13 11:34:33,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:34,006 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:34
2025-03-13 11:34:34,006 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.89it/s]
2025-03-13 11:34:34,032 [INFO]: There are 3386 embeddings of dim 49152
2025-03-13 11:34:34,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 11:34:34,032 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:34,032 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:34:34,032 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:34,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:34:34,032 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,032 [INFO]: 698.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:34,032 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:34:34,032 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:34
2025-03-13 11:34:34,032 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:34,032 [INFO]: 	Creating the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,032 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:34
2025-03-13 11:34:34,033 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:34:34,033 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:34
2025-03-13 11:34:34,034 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:34:34,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.45it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.43it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.17it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.33it/s] 50%|█████     | 7/14 [00:00<00:00,  9.43it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.11it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.81it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.19it/s]100%|██████████| 14/14 [00:03<00:00,  3.90it/s]
2025-03-13 11:34:37,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:37
2025-03-13 11:35:12,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8913 secs
2025-03-13 11:35:12,518 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 11:35:12,518 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 11:35:27,638 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1194 secs
2025-03-13 11:35:27,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6066 secs
2025-03-13 11:35:27,640 [INFO]: {
2025-03-13 11:35:27,640 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:27,640 [INFO]: 	index_param: efSearch=278
2025-03-13 11:35:27,640 [INFO]: 	index_path: knn.index
2025-03-13 11:35:27,640 [INFO]: 	size in bytes: 666174790
2025-03-13 11:35:27,640 [INFO]: 	avg_search_speed_ms: 10.188021464036234
2025-03-13 11:35:27,640 [INFO]: 	99p_search_speed_ms: 18.44738638959819
2025-03-13 11:35:27,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:27,640 [INFO]: 	nb vectors: 3386
2025-03-13 11:35:27,640 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:27,640 [INFO]: 	compression ratio: 0.9993093374187877
2025-03-13 11:35:27,640 [INFO]: }
2025-03-13 11:35:27,640 [INFO]: 	>>> Finished "Creating the index" in 53.6080 secs
2025-03-13 11:35:27,640 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6341 secs
2025-03-13 11:35:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 31107 [episode count 10/20]
[retrieval_preprocessing] for episode 56228 [episode count 11/20], we have num_retrieval=np.int64(3403) num_query=np.int64(161)
2025-03-13 11:35:30,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:31,229 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:31
2025-03-13 11:35:31,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1825.99it/s]
2025-03-13 11:35:31,254 [INFO]: There are 3403 embeddings of dim 49152
2025-03-13 11:35:31,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:35:31,255 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:31
2025-03-13 11:35:31,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:31,255 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:35:31,255 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:31,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:35:31,255 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:31
2025-03-13 11:35:31,256 [INFO]: 702.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:31,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:35:31,256 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:31
2025-03-13 11:35:31,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:31,256 [INFO]: 	Creating the index 03/13/2025, 11:35:31
2025-03-13 11:35:31,257 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:31
2025-03-13 11:35:31,259 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:35:31,260 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:31
2025-03-13 11:35:31,260 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:35:31,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.47it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.05it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.91it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.32it/s] 50%|█████     | 7/14 [00:00<00:00,  9.13it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.97it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.88it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.76it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.86it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.95it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.21it/s]100%|██████████| 14/14 [00:04<00:00,  1.15it/s]100%|██████████| 14/14 [00:04<00:00,  3.36it/s]
2025-03-13 11:35:35,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:35
2025-03-13 11:36:24,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2476 secs
2025-03-13 11:36:24,685 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 11:36:24,685 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 11:36:42,228 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5433 secs
2025-03-13 11:36:42,231 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9716 secs
2025-03-13 11:36:42,231 [INFO]: {
2025-03-13 11:36:42,231 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:42,231 [INFO]: 	index_param: efSearch=193
2025-03-13 11:36:42,231 [INFO]: 	index_path: knn.index
2025-03-13 11:36:42,232 [INFO]: 	size in bytes: 669519490
2025-03-13 11:36:42,232 [INFO]: 	avg_search_speed_ms: 8.827545521871269
2025-03-13 11:36:42,232 [INFO]: 	99p_search_speed_ms: 12.02880542725325
2025-03-13 11:36:42,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:42,232 [INFO]: 	nb vectors: 3403
2025-03-13 11:36:42,232 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:42,232 [INFO]: 	compression ratio: 0.9993092568522538
2025-03-13 11:36:42,232 [INFO]: }
2025-03-13 11:36:42,232 [INFO]: 	>>> Finished "Creating the index" in 70.9751 secs
2025-03-13 11:36:42,232 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0024 secs
2025-03-13 11:36:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 56228 [episode count 11/20]
[retrieval_preprocessing] for episode 65473 [episode count 12/20], we have num_retrieval=np.int64(3404) num_query=np.int64(160)
2025-03-13 11:36:44,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:45,205 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:45
2025-03-13 11:36:45,205 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-13 11:36:45,233 [INFO]: There are 3404 embeddings of dim 49152
2025-03-13 11:36:45,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 11:36:45,234 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:45
2025-03-13 11:36:45,234 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:45,234 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:36:45,234 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:45,234 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:36:45,234 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:45
2025-03-13 11:36:45,235 [INFO]: 702.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:45,235 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:36:45,235 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:45
2025-03-13 11:36:45,235 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:45,235 [INFO]: 	Creating the index 03/13/2025, 11:36:45
2025-03-13 11:36:45,236 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:45
2025-03-13 11:36:45,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:36:45,239 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:45
2025-03-13 11:36:45,240 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:36:45,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.86it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.13it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.22it/s] 50%|█████     | 7/14 [00:00<00:00, 11.60it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.90it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.04it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.10it/s]100%|██████████| 14/14 [00:03<00:00,  4.05it/s]
2025-03-13 11:36:48,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:48
2025-03-13 11:37:27,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2662 secs
2025-03-13 11:37:27,972 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 11:37:27,972 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 11:37:43,254 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2819 secs
2025-03-13 11:37:43,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0174 secs
2025-03-13 11:37:43,257 [INFO]: {
2025-03-13 11:37:43,257 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:43,257 [INFO]: 	index_param: efSearch=273
2025-03-13 11:37:43,257 [INFO]: 	index_path: knn.index
2025-03-13 11:37:43,257 [INFO]: 	size in bytes: 669716230
2025-03-13 11:37:43,257 [INFO]: 	avg_search_speed_ms: 12.012485901647363
2025-03-13 11:37:43,257 [INFO]: 	99p_search_speed_ms: 21.4337361510843
2025-03-13 11:37:43,257 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:43,257 [INFO]: 	nb vectors: 3404
2025-03-13 11:37:43,257 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:43,257 [INFO]: 	compression ratio: 0.999309262670848
2025-03-13 11:37:43,257 [INFO]: }
2025-03-13 11:37:43,257 [INFO]: 	>>> Finished "Creating the index" in 58.0215 secs
2025-03-13 11:37:43,257 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0518 secs
2025-03-13 11:37:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 65473 [episode count 12/20]
[retrieval_preprocessing] for episode 8699 [episode count 13/20], we have num_retrieval=np.int64(3392) num_query=np.int64(172)
2025-03-13 11:37:46,109 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:46,640 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:46
2025-03-13 11:37:46,640 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-13 11:37:46,664 [INFO]: There are 3392 embeddings of dim 49152
2025-03-13 11:37:46,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 11:37:46,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:46
2025-03-13 11:37:46,665 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:46,665 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:37:46,665 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:46,665 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:37:46,665 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:46
2025-03-13 11:37:46,665 [INFO]: 700.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:46,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:37:46,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:46
2025-03-13 11:37:46,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:46,665 [INFO]: 	Creating the index 03/13/2025, 11:37:46
2025-03-13 11:37:46,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:46
2025-03-13 11:37:46,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 11:37:46,668 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:46
2025-03-13 11:37:46,668 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:37:46,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.80it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.70it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.51it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.97it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.61it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.79it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.82it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.86it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.00it/s]100%|██████████| 14/14 [00:03<00:00,  1.87it/s]100%|██████████| 14/14 [00:03<00:00,  3.69it/s]
2025-03-13 11:37:50,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:50
2025-03-13 11:38:37,480 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0131 secs
2025-03-13 11:38:37,480 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 11:38:37,480 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
2025-03-13 11:38:52,543 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0626 secs
2025-03-13 11:38:52,545 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8769 secs
2025-03-13 11:38:52,545 [INFO]: {
2025-03-13 11:38:52,545 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:52,545 [INFO]: 	index_param: efSearch=270
2025-03-13 11:38:52,545 [INFO]: 	index_path: knn.index
2025-03-13 11:38:52,545 [INFO]: 	size in bytes: 667355290
2025-03-13 11:38:52,545 [INFO]: 	avg_search_speed_ms: 10.813059235948163
2025-03-13 11:38:52,545 [INFO]: 	99p_search_speed_ms: 15.556253958493471
2025-03-13 11:38:52,545 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:52,545 [INFO]: 	nb vectors: 3392
2025-03-13 11:38:52,545 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:52,545 [INFO]: 	compression ratio: 0.9993092824663157
2025-03-13 11:38:52,545 [INFO]: }
2025-03-13 11:38:52,545 [INFO]: 	>>> Finished "Creating the index" in 65.8799 secs
2025-03-13 11:38:52,545 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9057 secs
2025-03-13 11:38:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 8699 [episode count 13/20]
[retrieval_preprocessing] for episode 77502 [episode count 14/20], we have num_retrieval=np.int64(3356) num_query=np.int64(208)
2025-03-13 11:38:55,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:56,062 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:56
2025-03-13 11:38:56,063 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-13 11:38:56,087 [INFO]: There are 3356 embeddings of dim 49152
2025-03-13 11:38:56,087 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 11:38:56,087 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:56
2025-03-13 11:38:56,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:56,087 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:38:56,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:56,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:56,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:56
2025-03-13 11:38:56,087 [INFO]: 692.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:56,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:38:56,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:56
2025-03-13 11:38:56,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:56,088 [INFO]: 	Creating the index 03/13/2025, 11:38:56
2025-03-13 11:38:56,088 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:56
2025-03-13 11:38:56,089 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:38:56,089 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:56
2025-03-13 11:38:56,089 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:38:56,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:03,  4.20it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.67it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.92it/s] 50%|█████     | 7/14 [00:00<00:00,  9.53it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.00it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.32it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.82it/s]100%|██████████| 14/14 [00:03<00:00,  3.97it/s]
2025-03-13 11:38:59,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:59
2025-03-13 11:39:41,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7606 secs
2025-03-13 11:39:41,380 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:39:41,380 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s]
2025-03-13 11:39:57,883 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5023 secs
2025-03-13 11:39:57,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7967 secs
2025-03-13 11:39:57,886 [INFO]: {
2025-03-13 11:39:57,886 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:57,886 [INFO]: 	index_param: efSearch=249
2025-03-13 11:39:57,886 [INFO]: 	index_path: knn.index
2025-03-13 11:39:57,886 [INFO]: 	size in bytes: 660272530
2025-03-13 11:39:57,886 [INFO]: 	avg_search_speed_ms: 10.460253040429018
2025-03-13 11:39:57,886 [INFO]: 	99p_search_speed_ms: 19.138484797440494
2025-03-13 11:39:57,886 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:57,886 [INFO]: 	nb vectors: 3356
2025-03-13 11:39:57,886 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:57,886 [INFO]: 	compression ratio: 0.9993092518933053
2025-03-13 11:39:57,886 [INFO]: }
2025-03-13 11:39:57,886 [INFO]: 	>>> Finished "Creating the index" in 61.7981 secs
2025-03-13 11:39:57,886 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8233 secs
2025-03-13 11:39:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 77502 [episode count 14/20]
[retrieval_preprocessing] for episode 30522 [episode count 15/20], we have num_retrieval=np.int64(3389) num_query=np.int64(175)
2025-03-13 11:40:00,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:01,319 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:01
2025-03-13 11:40:01,320 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.12it/s]
2025-03-13 11:40:01,345 [INFO]: There are 3389 embeddings of dim 49152
2025-03-13 11:40:01,345 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:40:01,345 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:01
2025-03-13 11:40:01,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:01,345 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:40:01,346 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:01,346 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:40:01,346 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:01
2025-03-13 11:40:01,346 [INFO]: 699.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:01,346 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:40:01,346 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:01
2025-03-13 11:40:01,346 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:01,346 [INFO]: 	Creating the index 03/13/2025, 11:40:01
2025-03-13 11:40:01,346 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:01
2025-03-13 11:40:01,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:40:01,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:01
2025-03-13 11:40:01,347 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:40:01,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.81it/s] 29%|██▊       | 4/14 [00:00<00:00, 13.71it/s] 43%|████▎     | 6/14 [00:00<00:00, 15.11it/s] 57%|█████▋    | 8/14 [00:00<00:00, 11.54it/s] 71%|███████▏  | 10/14 [00:00<00:00, 10.21it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.59it/s]100%|██████████| 14/14 [00:03<00:00,  1.90it/s]100%|██████████| 14/14 [00:03<00:00,  3.52it/s]
2025-03-13 11:40:05,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:05
2025-03-13 11:40:42,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1372 secs
2025-03-13 11:40:42,462 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 11:40:42,462 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-13 11:41:00,293 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8311 secs
2025-03-13 11:41:00,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9485 secs
2025-03-13 11:41:00,296 [INFO]: {
2025-03-13 11:41:00,296 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:00,296 [INFO]: 	index_param: efSearch=295
2025-03-13 11:41:00,296 [INFO]: 	index_path: knn.index
2025-03-13 11:41:00,296 [INFO]: 	size in bytes: 666765070
2025-03-13 11:41:00,296 [INFO]: 	avg_search_speed_ms: 11.709256545069085
2025-03-13 11:41:00,296 [INFO]: 	99p_search_speed_ms: 21.70862765982749
2025-03-13 11:41:00,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:00,296 [INFO]: 	nb vectors: 3389
2025-03-13 11:41:00,296 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:00,296 [INFO]: 	compression ratio: 0.9993092649559462
2025-03-13 11:41:00,296 [INFO]: }
2025-03-13 11:41:00,296 [INFO]: 	>>> Finished "Creating the index" in 58.9500 secs
2025-03-13 11:41:00,296 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9763 secs
2025-03-13 11:41:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 30522 [episode count 15/20]
[retrieval_preprocessing] for episode 2962 [episode count 16/20], we have num_retrieval=np.int64(3425) num_query=np.int64(139)
2025-03-13 11:41:03,124 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:03,775 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:03
2025-03-13 11:41:03,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.50it/s]
2025-03-13 11:41:03,801 [INFO]: There are 3425 embeddings of dim 49152
2025-03-13 11:41:03,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:41:03,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:03,801 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:41:03,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:03,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:41:03,802 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,802 [INFO]: 706.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:03,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:41:03,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:03
2025-03-13 11:41:03,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:03,802 [INFO]: 	Creating the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,802 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:03
2025-03-13 11:41:03,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 11:41:03,804 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:03
2025-03-13 11:41:03,804 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:41:03,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.85it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.70it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.35it/s] 43%|████▎     | 6/14 [00:00<00:00, 11.52it/s] 57%|█████▋    | 8/14 [00:00<00:00, 13.08it/s] 71%|███████▏  | 10/14 [00:00<00:00, 13.39it/s] 86%|████████▌ | 12/14 [00:01<00:00, 12.76it/s]100%|██████████| 14/14 [00:03<00:00,  2.24it/s]100%|██████████| 14/14 [00:03<00:00,  4.07it/s]
2025-03-13 11:41:07,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:07
2025-03-13 11:41:49,304 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0582 secs
2025-03-13 11:41:49,304 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:41:49,304 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s] 50%|█████     | 2/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-13 11:42:06,154 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8495 secs
2025-03-13 11:42:06,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3525 secs
2025-03-13 11:42:06,157 [INFO]: {
2025-03-13 11:42:06,157 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:06,157 [INFO]: 	index_param: efSearch=249
2025-03-13 11:42:06,157 [INFO]: 	index_path: knn.index
2025-03-13 11:42:06,157 [INFO]: 	size in bytes: 673847770
2025-03-13 11:42:06,157 [INFO]: 	avg_search_speed_ms: 12.685349131125783
2025-03-13 11:42:06,157 [INFO]: 	99p_search_speed_ms: 30.086887441575534
2025-03-13 11:42:06,157 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:06,157 [INFO]: 	nb vectors: 3425
2025-03-13 11:42:06,157 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:06,157 [INFO]: 	compression ratio: 0.9993093840764659
2025-03-13 11:42:06,157 [INFO]: }
2025-03-13 11:42:06,157 [INFO]: 	>>> Finished "Creating the index" in 62.3547 secs
2025-03-13 11:42:06,157 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3822 secs
2025-03-13 11:42:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 2962 [episode count 16/20]
[retrieval_preprocessing] for episode 31715 [episode count 17/20], we have num_retrieval=np.int64(3413) num_query=np.int64(151)
2025-03-13 11:42:08,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:09,281 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:09
2025-03-13 11:42:09,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.27it/s]
2025-03-13 11:42:09,306 [INFO]: There are 3413 embeddings of dim 49152
2025-03-13 11:42:09,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 11:42:09,306 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:09
2025-03-13 11:42:09,306 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:09,306 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:42:09,306 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:09,306 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:42:09,306 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:09
2025-03-13 11:42:09,306 [INFO]: 704.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:09,307 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:42:09,307 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:09
2025-03-13 11:42:09,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:09,307 [INFO]: 	Creating the index 03/13/2025, 11:42:09
2025-03-13 11:42:09,307 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:09
2025-03-13 11:42:09,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:42:09,308 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:09
2025-03-13 11:42:09,308 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:42:09,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.74it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.35it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.56it/s] 50%|█████     | 7/14 [00:00<00:00, 11.20it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.41it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.65it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.73it/s]100%|██████████| 14/14 [00:03<00:00,  4.09it/s]
2025-03-13 11:42:12,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:12
2025-03-13 11:42:48,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0232 secs
2025-03-13 11:42:48,754 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 11:42:48,754 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-13 11:43:06,883 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1288 secs
2025-03-13 11:43:06,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5778 secs
2025-03-13 11:43:06,886 [INFO]: {
2025-03-13 11:43:06,886 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:06,886 [INFO]: 	index_param: efSearch=262
2025-03-13 11:43:06,886 [INFO]: 	index_path: knn.index
2025-03-13 11:43:06,886 [INFO]: 	size in bytes: 671486890
2025-03-13 11:43:06,886 [INFO]: 	avg_search_speed_ms: 10.155973351811092
2025-03-13 11:43:06,886 [INFO]: 	99p_search_speed_ms: 13.817877704277633
2025-03-13 11:43:06,886 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:06,886 [INFO]: 	nb vectors: 3413
2025-03-13 11:43:06,886 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:06,886 [INFO]: 	compression ratio: 0.9993093148847627
2025-03-13 11:43:06,886 [INFO]: }
2025-03-13 11:43:06,886 [INFO]: 	>>> Finished "Creating the index" in 57.5791 secs
2025-03-13 11:43:06,886 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6046 secs
2025-03-13 11:43:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 31715 [episode count 17/20]
[retrieval_preprocessing] for episode 9 [episode count 18/20], we have num_retrieval=np.int64(3340) num_query=np.int64(224)
2025-03-13 11:43:09,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:10,038 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:10
2025-03-13 11:43:10,039 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2175.47it/s]
2025-03-13 11:43:10,062 [INFO]: There are 3340 embeddings of dim 49152
2025-03-13 11:43:10,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 11:43:10,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:10
2025-03-13 11:43:10,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:10,064 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:43:10,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:10,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:43:10,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:10
2025-03-13 11:43:10,064 [INFO]: 689.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:10,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:43:10,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:10
2025-03-13 11:43:10,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:10,065 [INFO]: 	Creating the index 03/13/2025, 11:43:10
2025-03-13 11:43:10,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:10
2025-03-13 11:43:10,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:43:10,069 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:10
2025-03-13 11:43:10,069 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:43:10,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.88it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.24it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.80it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.19it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.51it/s] 50%|█████     | 7/14 [00:00<00:00,  9.70it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.95it/s] 79%|███████▊  | 11/14 [00:01<00:00, 13.84it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.94it/s]100%|██████████| 14/14 [00:04<00:00,  3.41it/s]
2025-03-13 11:43:14,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:14
2025-03-13 11:43:48,242 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0617 secs
2025-03-13 11:43:48,243 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 11:43:48,243 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 11:44:04,660 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4169 secs
2025-03-13 11:44:04,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5935 secs
2025-03-13 11:44:04,662 [INFO]: {
2025-03-13 11:44:04,662 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:04,662 [INFO]: 	index_param: efSearch=233
2025-03-13 11:44:04,662 [INFO]: 	index_path: knn.index
2025-03-13 11:44:04,662 [INFO]: 	size in bytes: 657124690
2025-03-13 11:44:04,662 [INFO]: 	avg_search_speed_ms: 10.422424524100885
2025-03-13 11:44:04,663 [INFO]: 	99p_search_speed_ms: 17.898767523001872
2025-03-13 11:44:04,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:04,663 [INFO]: 	nb vectors: 3340
2025-03-13 11:44:04,663 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:04,663 [INFO]: 	compression ratio: 0.9993091569881509
2025-03-13 11:44:04,663 [INFO]: }
2025-03-13 11:44:04,663 [INFO]: 	>>> Finished "Creating the index" in 54.5978 secs
2025-03-13 11:44:04,663 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6241 secs
2025-03-13 11:44:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 9 [episode count 18/20]
[retrieval_preprocessing] for episode 39471 [episode count 19/20], we have num_retrieval=np.int64(3401) num_query=np.int64(163)
2025-03-13 11:44:08,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:08,849 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:08
2025-03-13 11:44:08,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1538.07it/s]
2025-03-13 11:44:08,874 [INFO]: There are 3401 embeddings of dim 49152
2025-03-13 11:44:08,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 11:44:08,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:08,874 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:44:08,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:08,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:08,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,874 [INFO]: 701.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:08,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:44:08,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:08
2025-03-13 11:44:08,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:08,875 [INFO]: 	Creating the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:08
2025-03-13 11:44:08,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:44:08,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:08
2025-03-13 11:44:08,877 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:44:08,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.55it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.85it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.08it/s] 50%|█████     | 7/14 [00:00<00:00, 11.57it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.77it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.89it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.96it/s]100%|██████████| 14/14 [00:03<00:00,  4.18it/s]
2025-03-13 11:44:12,233 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:12
2025-03-13 11:44:49,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4018 secs
2025-03-13 11:44:49,635 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 11:44:49,635 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 11:45:06,244 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6088 secs
2025-03-13 11:45:06,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3703 secs
2025-03-13 11:45:06,247 [INFO]: {
2025-03-13 11:45:06,247 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:06,247 [INFO]: 	index_param: efSearch=281
2025-03-13 11:45:06,247 [INFO]: 	index_path: knn.index
2025-03-13 11:45:06,247 [INFO]: 	size in bytes: 669126010
2025-03-13 11:45:06,247 [INFO]: 	avg_search_speed_ms: 11.137405475228196
2025-03-13 11:45:06,247 [INFO]: 	99p_search_speed_ms: 16.858263430185616
2025-03-13 11:45:06,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:06,247 [INFO]: 	nb vectors: 3401
2025-03-13 11:45:06,247 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:06,247 [INFO]: 	compression ratio: 0.9993092452048008
2025-03-13 11:45:06,247 [INFO]: }
2025-03-13 11:45:06,247 [INFO]: 	>>> Finished "Creating the index" in 57.3726 secs
2025-03-13 11:45:06,247 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3985 secs
2025-03-13 11:45:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 39471 [episode count 19/20]
2025-03-13 11:45:07: [retrieval_preprocessing] finished for 7724213024_pens_to_container [chosen_id count 2/260]
2025-03-13 11:45:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7779812931_Put_Item_in_Bag [chosen_id count 3/260]
2025-03-13 11:45:12: [retrieval_preprocessing] we have num_total=5859 embedding_dim=49152
[retrieval_preprocessing] for episode 40451 [episode count 0/20], we have num_retrieval=np.int64(5633) num_query=np.int64(226)
2025-03-13 11:45:13,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:14,252 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:14
2025-03-13 11:45:14,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.78it/s]
2025-03-13 11:45:14,276 [INFO]: There are 5633 embeddings of dim 49152
2025-03-13 11:45:14,276 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 11:45:14,276 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:14
2025-03-13 11:45:14,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:14,276 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:45:14,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:14,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:14,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:14
2025-03-13 11:45:14,276 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:14,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:45:14,276 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:14
2025-03-13 11:45:14,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:14,276 [INFO]: 	Creating the index 03/13/2025, 11:45:14
2025-03-13 11:45:14,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:14
2025-03-13 11:45:14,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:45:14,277 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:14
2025-03-13 11:45:14,277 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:45:14,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.41it/s] 12%|█▎        | 3/24 [00:00<00:01, 10.86it/s] 21%|██        | 5/24 [00:00<00:01, 12.21it/s] 29%|██▉       | 7/24 [00:00<00:01, 14.15it/s] 38%|███▊      | 9/24 [00:00<00:00, 15.43it/s] 46%|████▌     | 11/24 [00:00<00:00, 16.36it/s] 54%|█████▍    | 13/24 [00:00<00:00, 16.82it/s] 62%|██████▎   | 15/24 [00:00<00:00, 17.22it/s] 71%|███████   | 17/24 [00:01<00:00, 17.46it/s] 79%|███████▉  | 19/24 [00:01<00:00, 17.61it/s] 88%|████████▊ | 21/24 [00:04<00:01,  1.75it/s] 96%|█████████▌| 23/24 [00:04<00:00,  2.33it/s]100%|██████████| 24/24 [00:06<00:00,  3.81it/s]
2025-03-13 11:45:20,574 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:20
2025-03-13 11:46:10,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5987 secs
2025-03-13 11:46:10,174 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 11:46:10,174 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 11:46:29,599 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4253 secs
2025-03-13 11:46:29,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.6353 secs
2025-03-13 11:46:29,913 [INFO]: {
2025-03-13 11:46:29,913 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:29,913 [INFO]: 	index_param: efSearch=204
2025-03-13 11:46:29,913 [INFO]: 	index_path: knn.index
2025-03-13 11:46:29,913 [INFO]: 	size in bytes: 1108259770
2025-03-13 11:46:29,913 [INFO]: 	avg_search_speed_ms: 11.220288094745658
2025-03-13 11:46:29,913 [INFO]: 	99p_search_speed_ms: 16.37572862673551
2025-03-13 11:46:29,913 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:29,913 [INFO]: 	nb vectors: 5633
2025-03-13 11:46:29,913 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:29,913 [INFO]: 	compression ratio: 0.9993080088073575
2025-03-13 11:46:29,913 [INFO]: }
2025-03-13 11:46:29,914 [INFO]: 	>>> Finished "Creating the index" in 75.6374 secs
2025-03-13 11:46:29,914 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6610 secs
2025-03-13 11:46:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 40451 [episode count 0/20]
[retrieval_preprocessing] for episode 86150 [episode count 1/20], we have num_retrieval=np.int64(5658) num_query=np.int64(201)
2025-03-13 11:46:34,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:34,899 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:34
2025-03-13 11:46:34,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2257.43it/s]
2025-03-13 11:46:34,922 [INFO]: There are 5658 embeddings of dim 49152
2025-03-13 11:46:34,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:46:34,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:34
2025-03-13 11:46:34,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:34,922 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:46:34,922 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:34,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:46:34,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:34
2025-03-13 11:46:34,923 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:34,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:46:34,923 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:34
2025-03-13 11:46:34,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:34,923 [INFO]: 	Creating the index 03/13/2025, 11:46:34
2025-03-13 11:46:34,923 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:34
2025-03-13 11:46:34,924 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:46:34,924 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:34
2025-03-13 11:46:34,924 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:46:34,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:05,  3.92it/s]  8%|▊         | 2/24 [00:00<00:03,  5.56it/s] 12%|█▎        | 3/24 [00:00<00:03,  6.65it/s] 17%|█▋        | 4/24 [00:00<00:02,  7.28it/s] 21%|██        | 5/24 [00:00<00:02,  7.67it/s] 25%|██▌       | 6/24 [00:00<00:02,  7.90it/s] 29%|██▉       | 7/24 [00:00<00:02,  8.06it/s] 33%|███▎      | 8/24 [00:01<00:01,  8.24it/s] 38%|███▊      | 9/24 [00:01<00:01,  8.28it/s] 42%|████▏     | 10/24 [00:01<00:01,  8.31it/s] 46%|████▌     | 11/24 [00:01<00:01,  8.35it/s] 50%|█████     | 12/24 [00:01<00:01,  8.39it/s] 54%|█████▍    | 13/24 [00:01<00:01,  8.43it/s] 58%|█████▊    | 14/24 [00:01<00:01,  8.58it/s] 62%|██████▎   | 15/24 [00:01<00:01,  8.52it/s] 67%|██████▋   | 16/24 [00:02<00:00,  8.43it/s] 71%|███████   | 17/24 [00:02<00:00,  8.36it/s] 75%|███████▌  | 18/24 [00:02<00:00,  8.37it/s] 83%|████████▎ | 20/24 [00:02<00:00,  9.19it/s] 88%|████████▊ | 21/24 [00:06<00:03,  1.09s/it] 92%|█████████▏| 22/24 [00:06<00:01,  1.21it/s]100%|██████████| 24/24 [00:07<00:00,  1.30it/s]100%|██████████| 24/24 [00:07<00:00,  3.00it/s]
2025-03-13 11:46:42,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:42
2025-03-13 11:47:26,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0962 secs
2025-03-13 11:47:26,017 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 11:47:26,017 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 11:47:46,880 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8625 secs
2025-03-13 11:47:46,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9569 secs
2025-03-13 11:47:46,881 [INFO]: {
2025-03-13 11:47:46,881 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:46,881 [INFO]: 	index_param: efSearch=244
2025-03-13 11:47:46,881 [INFO]: 	index_path: knn.index
2025-03-13 11:47:46,881 [INFO]: 	size in bytes: 1113178330
2025-03-13 11:47:46,882 [INFO]: 	avg_search_speed_ms: 12.12603010491214
2025-03-13 11:47:46,882 [INFO]: 	99p_search_speed_ms: 18.954888144508004
2025-03-13 11:47:46,882 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:46,882 [INFO]: 	nb vectors: 5658
2025-03-13 11:47:46,882 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:46,882 [INFO]: 	compression ratio: 0.9993080479746673
2025-03-13 11:47:46,882 [INFO]: }
2025-03-13 11:47:46,882 [INFO]: 	>>> Finished "Creating the index" in 71.9589 secs
2025-03-13 11:47:46,882 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9822 secs
2025-03-13 11:47:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 86150 [episode count 1/20]
[retrieval_preprocessing] for episode 29069 [episode count 2/20], we have num_retrieval=np.int64(5649) num_query=np.int64(210)
2025-03-13 11:47:51,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:52,277 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:52
2025-03-13 11:47:52,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 890.70it/s]
2025-03-13 11:47:52,302 [INFO]: There are 5649 embeddings of dim 49152
2025-03-13 11:47:52,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:47:52,303 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:52
2025-03-13 11:47:52,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:52,303 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:47:52,303 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:52,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:52,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:52
2025-03-13 11:47:52,303 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:52,303 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:47:52,303 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:52
2025-03-13 11:47:52,303 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:52,303 [INFO]: 	Creating the index 03/13/2025, 11:47:52
2025-03-13 11:47:52,303 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:52
2025-03-13 11:47:52,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:47:52,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:52
2025-03-13 11:47:52,304 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:47:52,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  4.91it/s] 12%|█▎        | 3/24 [00:00<00:02,  7.98it/s] 17%|█▋        | 4/24 [00:00<00:02,  8.58it/s] 25%|██▌       | 6/24 [00:00<00:01,  9.46it/s] 33%|███▎      | 8/24 [00:00<00:01,  9.91it/s] 42%|████▏     | 10/24 [00:01<00:01, 10.23it/s] 50%|█████     | 12/24 [00:01<00:01, 10.70it/s] 58%|█████▊    | 14/24 [00:01<00:00, 11.33it/s] 67%|██████▋   | 16/24 [00:01<00:00, 12.02it/s] 75%|███████▌  | 18/24 [00:01<00:00, 13.05it/s] 83%|████████▎ | 20/24 [00:01<00:00, 12.87it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.70it/s]100%|██████████| 24/24 [00:06<00:00,  1.60it/s]100%|██████████| 24/24 [00:06<00:00,  3.57it/s]
2025-03-13 11:47:59,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:59
2025-03-13 11:48:46,022 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9970 secs
2025-03-13 11:48:46,022 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:48:46,022 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 11:49:10,784 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7616 secs
2025-03-13 11:49:10,785 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4805 secs
2025-03-13 11:49:10,785 [INFO]: {
2025-03-13 11:49:10,785 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:10,785 [INFO]: 	index_param: efSearch=223
2025-03-13 11:49:10,785 [INFO]: 	index_path: knn.index
2025-03-13 11:49:10,785 [INFO]: 	size in bytes: 1111407670
2025-03-13 11:49:10,785 [INFO]: 	avg_search_speed_ms: 12.192910473237223
2025-03-13 11:49:10,785 [INFO]: 	99p_search_speed_ms: 20.846782342996427
2025-03-13 11:49:10,785 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:10,785 [INFO]: 	nb vectors: 5649
2025-03-13 11:49:10,785 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:10,785 [INFO]: 	compression ratio: 0.9993080144930078
2025-03-13 11:49:10,785 [INFO]: }
2025-03-13 11:49:10,785 [INFO]: 	>>> Finished "Creating the index" in 78.4818 secs
2025-03-13 11:49:10,785 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5080 secs
2025-03-13 11:49:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 29069 [episode count 2/20]
[retrieval_preprocessing] for episode 47374 [episode count 3/20], we have num_retrieval=np.int64(5449) num_query=np.int64(410)
2025-03-13 11:49:14,471 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:15,466 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:15
2025-03-13 11:49:15,466 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.72it/s]
2025-03-13 11:49:15,491 [INFO]: There are 5449 embeddings of dim 49152
2025-03-13 11:49:15,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 11:49:15,492 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:15,492 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:49:15,492 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:15,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:15,492 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,492 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:15,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:49:15,492 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:15
2025-03-13 11:49:15,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:15,492 [INFO]: 	Creating the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,492 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:15
2025-03-13 11:49:15,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:49:15,493 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,493 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:49:15,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.77it/s]  9%|▊         | 2/23 [00:00<00:03,  6.33it/s] 13%|█▎        | 3/23 [00:00<00:02,  6.96it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.31it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.48it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.67it/s] 30%|███       | 7/23 [00:00<00:02,  7.64it/s] 35%|███▍      | 8/23 [00:01<00:01,  7.64it/s] 39%|███▉      | 9/23 [00:01<00:01,  7.54it/s] 43%|████▎     | 10/23 [00:01<00:01,  7.51it/s] 48%|████▊     | 11/23 [00:01<00:01,  7.51it/s] 52%|█████▏    | 12/23 [00:01<00:01,  7.36it/s] 57%|█████▋    | 13/23 [00:01<00:01,  7.26it/s] 61%|██████    | 14/23 [00:01<00:01,  7.18it/s] 65%|██████▌   | 15/23 [00:02<00:01,  7.02it/s] 70%|██████▉   | 16/23 [00:02<00:00,  7.06it/s] 74%|███████▍  | 17/23 [00:02<00:00,  7.45it/s] 78%|███████▊  | 18/23 [00:02<00:00,  7.66it/s] 83%|████████▎ | 19/23 [00:02<00:00,  7.80it/s] 87%|████████▋ | 20/23 [00:02<00:00,  7.97it/s] 91%|█████████▏| 21/23 [00:07<00:02,  1.39s/it] 96%|█████████▌| 22/23 [00:07<00:01,  1.00s/it]100%|██████████| 23/23 [00:08<00:00,  1.06s/it]100%|██████████| 23/23 [00:08<00:00,  2.76it/s]
2025-03-13 11:49:23,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:23
2025-03-13 11:50:07,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1503 secs
2025-03-13 11:50:07,985 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 11:50:07,985 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 11:50:37,548 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5625 secs
2025-03-13 11:50:37,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0553 secs
2025-03-13 11:50:37,548 [INFO]: {
2025-03-13 11:50:37,549 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:37,549 [INFO]: 	index_param: efSearch=168
2025-03-13 11:50:37,549 [INFO]: 	index_path: knn.index
2025-03-13 11:50:37,549 [INFO]: 	size in bytes: 1072058770
2025-03-13 11:50:37,549 [INFO]: 	avg_search_speed_ms: 8.285747519628682
2025-03-13 11:50:37,549 [INFO]: 	99p_search_speed_ms: 12.05592639278621
2025-03-13 11:50:37,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:37,549 [INFO]: 	nb vectors: 5449
2025-03-13 11:50:37,549 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:37,549 [INFO]: 	compression ratio: 0.9993080808433664
2025-03-13 11:50:37,549 [INFO]: }
2025-03-13 11:50:37,549 [INFO]: 	>>> Finished "Creating the index" in 82.0567 secs
2025-03-13 11:50:37,549 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0830 secs
2025-03-13 11:50:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 47374 [episode count 3/20]
[retrieval_preprocessing] for episode 72592 [episode count 4/20], we have num_retrieval=np.int64(5613) num_query=np.int64(246)
2025-03-13 11:50:42,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:44,582 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:44
2025-03-13 11:50:44,582 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.51it/s]
2025-03-13 11:50:44,609 [INFO]: There are 5613 embeddings of dim 49152
2025-03-13 11:50:44,610 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:50:44,610 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:44
2025-03-13 11:50:44,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:44,610 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:50:44,610 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:44,611 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:50:44,611 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:44
2025-03-13 11:50:44,611 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:44,611 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:50:44,611 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:44
2025-03-13 11:50:44,612 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:44,612 [INFO]: 	Creating the index 03/13/2025, 11:50:44
2025-03-13 11:50:44,612 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:44
2025-03-13 11:50:44,614 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:50:44,615 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:44
2025-03-13 11:50:44,615 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:50:44,615 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:06,  3.66it/s]  8%|▊         | 2/24 [00:00<00:03,  5.63it/s] 12%|█▎        | 3/24 [00:00<00:03,  6.83it/s] 17%|█▋        | 4/24 [00:00<00:02,  7.46it/s] 21%|██        | 5/24 [00:00<00:02,  8.05it/s] 29%|██▉       | 7/24 [00:00<00:01,  9.19it/s] 33%|███▎      | 8/24 [00:01<00:01,  8.99it/s] 38%|███▊      | 9/24 [00:01<00:01,  9.03it/s] 42%|████▏     | 10/24 [00:01<00:01,  8.98it/s] 46%|████▌     | 11/24 [00:01<00:01,  9.06it/s] 50%|█████     | 12/24 [00:01<00:01,  9.10it/s] 54%|█████▍    | 13/24 [00:01<00:01,  9.18it/s] 58%|█████▊    | 14/24 [00:01<00:01,  9.16it/s] 62%|██████▎   | 15/24 [00:01<00:00,  9.07it/s] 67%|██████▋   | 16/24 [00:01<00:00,  9.11it/s] 71%|███████   | 17/24 [00:02<00:00,  8.91it/s] 75%|███████▌  | 18/24 [00:02<00:00,  8.86it/s] 79%|███████▉  | 19/24 [00:02<00:00,  8.80it/s] 83%|████████▎ | 20/24 [00:02<00:00,  8.86it/s] 88%|████████▊ | 21/24 [00:06<00:04,  1.39s/it] 96%|█████████▌| 23/24 [00:06<00:00,  1.26it/s]100%|██████████| 24/24 [00:08<00:00,  1.03it/s]100%|██████████| 24/24 [00:08<00:00,  2.85it/s]
2025-03-13 11:50:53,041 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:53
2025-03-13 11:51:37,614 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5727 secs
2025-03-13 11:51:37,615 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 11:51:37,615 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 11:51:57,879 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2641 secs
2025-03-13 11:51:57,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2651 secs
2025-03-13 11:51:57,880 [INFO]: {
2025-03-13 11:51:57,881 [INFO]: 	index_key: HNSW15
2025-03-13 11:51:57,881 [INFO]: 	index_param: efSearch=234
2025-03-13 11:51:57,881 [INFO]: 	index_path: knn.index
2025-03-13 11:51:57,881 [INFO]: 	size in bytes: 1104324910
2025-03-13 11:51:57,881 [INFO]: 	avg_search_speed_ms: 11.843714047878786
2025-03-13 11:51:57,881 [INFO]: 	99p_search_speed_ms: 16.63432309636845
2025-03-13 11:51:57,881 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:57,881 [INFO]: 	nb vectors: 5613
2025-03-13 11:51:57,881 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:57,881 [INFO]: 	compression ratio: 0.9993079880811526
2025-03-13 11:51:57,881 [INFO]: }
2025-03-13 11:51:57,881 [INFO]: 	>>> Finished "Creating the index" in 73.2688 secs
2025-03-13 11:51:57,881 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2990 secs
2025-03-13 11:52:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 72592 [episode count 4/20]
[retrieval_preprocessing] for episode 79760 [episode count 5/20], we have num_retrieval=np.int64(5581) num_query=np.int64(278)
2025-03-13 11:52:02,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:03,427 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:03
2025-03-13 11:52:03,427 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2152.03it/s]
2025-03-13 11:52:03,452 [INFO]: There are 5581 embeddings of dim 49152
2025-03-13 11:52:03,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:52:03,452 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:03
2025-03-13 11:52:03,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:03,453 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:52:03,453 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:03,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:52:03,453 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:03
2025-03-13 11:52:03,453 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:03,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:52:03,453 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:03
2025-03-13 11:52:03,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:03,453 [INFO]: 	Creating the index 03/13/2025, 11:52:03
2025-03-13 11:52:03,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:03
2025-03-13 11:52:03,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:52:03,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:03
2025-03-13 11:52:03,456 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:52:03,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.70it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.25it/s] 22%|██▏       | 5/23 [00:00<00:01, 12.33it/s] 30%|███       | 7/23 [00:00<00:01, 12.01it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.29it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.02it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.41it/s] 65%|██████▌   | 15/23 [00:01<00:00, 13.92it/s] 74%|███████▍  | 17/23 [00:01<00:00, 13.58it/s] 83%|████████▎ | 19/23 [00:01<00:00, 13.27it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.43it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.68it/s]100%|██████████| 23/23 [00:07<00:00,  1.25it/s]100%|██████████| 23/23 [00:07<00:00,  3.09it/s]
2025-03-13 11:52:10,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:10
2025-03-13 11:52:54,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1628 secs
2025-03-13 11:52:54,069 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 11:52:54,069 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 11:53:12,324 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2549 secs
2025-03-13 11:53:12,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8691 secs
2025-03-13 11:53:12,325 [INFO]: {
2025-03-13 11:53:12,325 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:12,325 [INFO]: 	index_param: efSearch=227
2025-03-13 11:53:12,325 [INFO]: 	index_path: knn.index
2025-03-13 11:53:12,325 [INFO]: 	size in bytes: 1098029170
2025-03-13 11:53:12,325 [INFO]: 	avg_search_speed_ms: 11.300325704906873
2025-03-13 11:53:12,325 [INFO]: 	99p_search_speed_ms: 20.514177121222012
2025-03-13 11:53:12,325 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:12,326 [INFO]: 	nb vectors: 5581
2025-03-13 11:53:12,326 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:12,326 [INFO]: 	compression ratio: 0.9993079218469214
2025-03-13 11:53:12,326 [INFO]: }
2025-03-13 11:53:12,326 [INFO]: 	>>> Finished "Creating the index" in 68.8721 secs
2025-03-13 11:53:12,326 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8985 secs
2025-03-13 11:53:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 79760 [episode count 5/20]
[retrieval_preprocessing] for episode 4371 [episode count 6/20], we have num_retrieval=np.int64(5368) num_query=np.int64(491)
2025-03-13 11:53:17,882 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:18,689 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:18
2025-03-13 11:53:18,689 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.49it/s]
2025-03-13 11:53:18,716 [INFO]: There are 5368 embeddings of dim 49152
2025-03-13 11:53:18,716 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:53:18,716 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:18
2025-03-13 11:53:18,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:18,716 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 11:53:18,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:18,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:53:18,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:18
2025-03-13 11:53:18,716 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:18,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:53:18,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:18
2025-03-13 11:53:18,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:18,716 [INFO]: 	Creating the index 03/13/2025, 11:53:18
2025-03-13 11:53:18,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:18
2025-03-13 11:53:18,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:53:18,718 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:18
2025-03-13 11:53:18,718 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:53:18,718 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.95it/s]  9%|▊         | 2/23 [00:00<00:03,  6.74it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.66it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.35it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.67it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.97it/s] 30%|███       | 7/23 [00:00<00:02,  6.97it/s] 35%|███▍      | 8/23 [00:01<00:02,  7.08it/s] 39%|███▉      | 9/23 [00:01<00:01,  7.73it/s] 43%|████▎     | 10/23 [00:01<00:01,  7.95it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.16it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.20it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.27it/s] 61%|██████    | 14/23 [00:01<00:01,  8.39it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.73it/s] 74%|███████▍  | 17/23 [00:02<00:00,  9.08it/s] 78%|███████▊  | 18/23 [00:02<00:00,  9.06it/s] 83%|████████▎ | 19/23 [00:02<00:00,  9.18it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.23it/s]100%|██████████| 23/23 [00:07<00:00,  1.34it/s]100%|██████████| 23/23 [00:07<00:00,  3.24it/s]
2025-03-13 11:53:25,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:25
2025-03-13 11:54:06,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2518 secs
2025-03-13 11:54:06,062 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:54:06,062 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 11:54:26,349 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2874 secs
2025-03-13 11:54:26,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6324 secs
2025-03-13 11:54:26,350 [INFO]: {
2025-03-13 11:54:26,350 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:26,350 [INFO]: 	index_param: efSearch=223
2025-03-13 11:54:26,350 [INFO]: 	index_path: knn.index
2025-03-13 11:54:26,350 [INFO]: 	size in bytes: 1056122470
2025-03-13 11:54:26,350 [INFO]: 	avg_search_speed_ms: 11.273964411099236
2025-03-13 11:54:26,350 [INFO]: 	99p_search_speed_ms: 16.060898927971717
2025-03-13 11:54:26,350 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:26,350 [INFO]: 	nb vectors: 5368
2025-03-13 11:54:26,350 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:26,350 [INFO]: 	compression ratio: 0.9993081048640126
2025-03-13 11:54:26,350 [INFO]: }
2025-03-13 11:54:26,350 [INFO]: 	>>> Finished "Creating the index" in 67.6339 secs
2025-03-13 11:54:26,350 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6609 secs
2025-03-13 11:54:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 4371 [episode count 6/20]
[retrieval_preprocessing] for episode 27796 [episode count 7/20], we have num_retrieval=np.int64(5577) num_query=np.int64(282)
2025-03-13 11:54:32,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:33,227 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:33
2025-03-13 11:54:33,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1339.61it/s]
2025-03-13 11:54:33,254 [INFO]: There are 5577 embeddings of dim 49152
2025-03-13 11:54:33,254 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:54:33,254 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:33
2025-03-13 11:54:33,254 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:33,254 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:54:33,255 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:33,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:33,255 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:33
2025-03-13 11:54:33,255 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:33,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:54:33,255 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:33
2025-03-13 11:54:33,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:33,255 [INFO]: 	Creating the index 03/13/2025, 11:54:33
2025-03-13 11:54:33,255 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:33
2025-03-13 11:54:33,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:54:33,256 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:33
2025-03-13 11:54:33,256 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:54:33,256 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.02it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.95it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.10it/s] 30%|███       | 7/23 [00:00<00:01,  9.64it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.69it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.70it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.19it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.49it/s] 74%|███████▍  | 17/23 [00:01<00:00, 13.11it/s] 83%|████████▎ | 19/23 [00:01<00:00, 13.42it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.48it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.75it/s]100%|██████████| 23/23 [00:07<00:00,  1.33it/s]100%|██████████| 23/23 [00:07<00:00,  3.16it/s]
2025-03-13 11:54:40,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:40
2025-03-13 11:55:23,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1143 secs
2025-03-13 11:55:23,652 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 11:55:23,652 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 11:55:51,421 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7689 secs
2025-03-13 11:55:51,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1657 secs
2025-03-13 11:55:51,422 [INFO]: {
2025-03-13 11:55:51,422 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:51,422 [INFO]: 	index_param: efSearch=206
2025-03-13 11:55:51,422 [INFO]: 	index_path: knn.index
2025-03-13 11:55:51,422 [INFO]: 	size in bytes: 1097242210
2025-03-13 11:55:51,422 [INFO]: 	avg_search_speed_ms: 10.969473876971996
2025-03-13 11:55:51,422 [INFO]: 	99p_search_speed_ms: 16.673041910398748
2025-03-13 11:55:51,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:51,422 [INFO]: 	nb vectors: 5577
2025-03-13 11:55:51,422 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:51,422 [INFO]: 	compression ratio: 0.9993079066836118
2025-03-13 11:55:51,422 [INFO]: }
2025-03-13 11:55:51,422 [INFO]: 	>>> Finished "Creating the index" in 78.1673 secs
2025-03-13 11:55:51,422 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1950 secs
2025-03-13 11:55:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 27796 [episode count 7/20]
[retrieval_preprocessing] for episode 42644 [episode count 8/20], we have num_retrieval=np.int64(5460) num_query=np.int64(399)
2025-03-13 11:55:56,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:57,558 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:57
2025-03-13 11:55:57,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1142.55it/s]
2025-03-13 11:55:57,586 [INFO]: There are 5460 embeddings of dim 49152
2025-03-13 11:55:57,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:55:57,586 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:57,587 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:55:57,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:57,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:55:57,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,587 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:57,588 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:55:57,588 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:57
2025-03-13 11:55:57,588 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:57,588 [INFO]: 	Creating the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,588 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:57
2025-03-13 11:55:57,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:55:57,592 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:57
2025-03-13 11:55:57,592 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:55:57,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.60it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.21it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.43it/s] 30%|███       | 7/23 [00:00<00:01, 11.24it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.43it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.44it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.77it/s] 65%|██████▌   | 15/23 [00:01<00:00, 14.46it/s] 74%|███████▍  | 17/23 [00:01<00:00, 14.44it/s] 83%|████████▎ | 19/23 [00:01<00:00, 14.08it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.37it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.61it/s]100%|██████████| 23/23 [00:07<00:00,  1.33it/s]100%|██████████| 23/23 [00:07<00:00,  3.15it/s]
2025-03-13 11:56:04,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:04
2025-03-13 11:56:50,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5083 secs
2025-03-13 11:56:50,413 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 11:56:50,414 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.67it/s]
2025-03-13 11:57:08,652 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2387 secs
2025-03-13 11:57:08,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0616 secs
2025-03-13 11:57:08,654 [INFO]: {
2025-03-13 11:57:08,654 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:08,654 [INFO]: 	index_param: efSearch=209
2025-03-13 11:57:08,654 [INFO]: 	index_path: knn.index
2025-03-13 11:57:08,654 [INFO]: 	size in bytes: 1074223030
2025-03-13 11:57:08,654 [INFO]: 	avg_search_speed_ms: 11.032920457200696
2025-03-13 11:57:08,654 [INFO]: 	99p_search_speed_ms: 16.174739599227916
2025-03-13 11:57:08,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:08,654 [INFO]: 	nb vectors: 5460
2025-03-13 11:57:08,654 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:08,654 [INFO]: 	compression ratio: 0.9993080114843563
2025-03-13 11:57:08,654 [INFO]: }
2025-03-13 11:57:08,654 [INFO]: 	>>> Finished "Creating the index" in 71.0655 secs
2025-03-13 11:57:08,654 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0954 secs
2025-03-13 11:57:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 42644 [episode count 8/20]
[retrieval_preprocessing] for episode 95129 [episode count 9/20], we have num_retrieval=np.int64(5353) num_query=np.int64(506)
2025-03-13 11:57:13,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:14,715 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:14
2025-03-13 11:57:14,716 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.31it/s]
2025-03-13 11:57:14,740 [INFO]: There are 5353 embeddings of dim 49152
2025-03-13 11:57:14,740 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 11:57:14,740 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:14
2025-03-13 11:57:14,740 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:14,740 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 11:57:14,740 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:14,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:14,740 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:14
2025-03-13 11:57:14,741 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:14,741 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:57:14,741 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:14
2025-03-13 11:57:14,741 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:14,741 [INFO]: 	Creating the index 03/13/2025, 11:57:14
2025-03-13 11:57:14,741 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:14
2025-03-13 11:57:14,742 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:57:14,742 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:14
2025-03-13 11:57:14,742 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:57:14,742 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.98it/s]  9%|▊         | 2/23 [00:00<00:03,  6.67it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.42it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.84it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.10it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.39it/s] 30%|███       | 7/23 [00:00<00:01,  8.45it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.45it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.48it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.45it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.59it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.58it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.59it/s] 61%|██████    | 14/23 [00:01<00:01,  8.63it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.66it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.68it/s] 74%|███████▍  | 17/23 [00:02<00:00,  8.80it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.80it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.80it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.88it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.30s/it]100%|██████████| 23/23 [00:07<00:00,  1.06it/s]100%|██████████| 23/23 [00:07<00:00,  3.06it/s]
2025-03-13 11:57:22,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:22
2025-03-13 11:58:07,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3531 secs
2025-03-13 11:58:07,613 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:58:07,613 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s]
2025-03-13 11:58:29,831 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2177 secs
2025-03-13 11:58:29,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.0894 secs
2025-03-13 11:58:29,831 [INFO]: {
2025-03-13 11:58:29,831 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:29,831 [INFO]: 	index_param: efSearch=202
2025-03-13 11:58:29,831 [INFO]: 	index_path: knn.index
2025-03-13 11:58:29,831 [INFO]: 	size in bytes: 1053171310
2025-03-13 11:58:29,831 [INFO]: 	avg_search_speed_ms: 10.403219385617234
2025-03-13 11:58:29,831 [INFO]: 	99p_search_speed_ms: 14.872755575925108
2025-03-13 11:58:29,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:29,831 [INFO]: 	nb vectors: 5353
2025-03-13 11:58:29,831 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:29,831 [INFO]: 	compression ratio: 0.9993081030663473
2025-03-13 11:58:29,831 [INFO]: }
2025-03-13 11:58:29,831 [INFO]: 	>>> Finished "Creating the index" in 75.0907 secs
2025-03-13 11:58:29,831 [INFO]: >>> Finished "Launching the whole pipeline" in 75.1159 secs
2025-03-13 11:58:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 95129 [episode count 9/20]
[retrieval_preprocessing] for episode 63134 [episode count 10/20], we have num_retrieval=np.int64(5428) num_query=np.int64(431)
2025-03-13 11:58:37,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:38,465 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:38
2025-03-13 11:58:38,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.96it/s]
2025-03-13 11:58:38,495 [INFO]: There are 5428 embeddings of dim 49152
2025-03-13 11:58:38,496 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 11:58:38,496 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:38
2025-03-13 11:58:38,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:38,496 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:58:38,496 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:38,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:38,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:38
2025-03-13 11:58:38,496 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:38,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:58:38,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:38
2025-03-13 11:58:38,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:38,496 [INFO]: 	Creating the index 03/13/2025, 11:58:38
2025-03-13 11:58:38,496 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:38
2025-03-13 11:58:38,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:58:38,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:38
2025-03-13 11:58:38,498 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:58:38,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.89it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.00it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.20it/s] 30%|███       | 7/23 [00:00<00:01, 10.09it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.64it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.27it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.90it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.42it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.38it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.48it/s] 91%|█████████▏| 21/23 [00:06<00:01,  1.27it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.50it/s]100%|██████████| 23/23 [00:07<00:00,  1.26it/s]100%|██████████| 23/23 [00:07<00:00,  2.92it/s]
2025-03-13 11:58:46,369 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:46
2025-03-13 11:59:30,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9781 secs
2025-03-13 11:59:30,347 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:59:30,347 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 11:59:50,619 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2720 secs
2025-03-13 11:59:50,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1224 secs
2025-03-13 11:59:50,620 [INFO]: {
2025-03-13 11:59:50,620 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:50,620 [INFO]: 	index_param: efSearch=202
2025-03-13 11:59:50,621 [INFO]: 	index_path: knn.index
2025-03-13 11:59:50,621 [INFO]: 	size in bytes: 1067927170
2025-03-13 11:59:50,621 [INFO]: 	avg_search_speed_ms: 11.475586490449283
2025-03-13 11:59:50,621 [INFO]: 	99p_search_speed_ms: 19.09861060557884
2025-03-13 11:59:50,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:50,621 [INFO]: 	nb vectors: 5428
2025-03-13 11:59:50,621 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:50,621 [INFO]: 	compression ratio: 0.9993080558105849
2025-03-13 11:59:50,621 [INFO]: }
2025-03-13 11:59:50,621 [INFO]: 	>>> Finished "Creating the index" in 72.1245 secs
2025-03-13 11:59:50,621 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1559 secs
2025-03-13 11:59:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 63134 [episode count 10/20]
[retrieval_preprocessing] for episode 93726 [episode count 11/20], we have num_retrieval=np.int64(5673) num_query=np.int64(186)
2025-03-13 11:59:56,947 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:57,678 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:57
2025-03-13 11:59:57,678 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1759.36it/s]
2025-03-13 11:59:57,700 [INFO]: There are 5673 embeddings of dim 49152
2025-03-13 11:59:57,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 11:59:57,701 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:57
2025-03-13 11:59:57,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:57,701 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:59:57,701 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:57,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:59:57,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:57
2025-03-13 11:59:57,701 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:57,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:59:57,701 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:57
2025-03-13 11:59:57,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:57,701 [INFO]: 	Creating the index 03/13/2025, 11:59:57
2025-03-13 11:59:57,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:57
2025-03-13 11:59:57,702 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:59:57,702 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:57
2025-03-13 11:59:57,702 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:59:57,702 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.47it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.96it/s] 21%|██        | 5/24 [00:00<00:01, 11.00it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.45it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.68it/s] 46%|████▌     | 11/24 [00:00<00:01, 12.01it/s] 54%|█████▍    | 13/24 [00:01<00:00, 12.10it/s] 62%|██████▎   | 15/24 [00:01<00:00, 12.12it/s] 71%|███████   | 17/24 [00:01<00:00, 12.30it/s] 79%|███████▉  | 19/24 [00:01<00:00, 12.34it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.59it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.85it/s] 96%|█████████▌| 23/24 [00:05<00:00,  2.21it/s]100%|██████████| 24/24 [00:07<00:00,  1.37it/s]100%|██████████| 24/24 [00:07<00:00,  3.30it/s]
2025-03-13 12:00:04,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:04
2025-03-13 12:00:50,599 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6211 secs
2025-03-13 12:00:50,599 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 12:00:50,599 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 12:01:10,638 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0386 secs
2025-03-13 12:01:10,886 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1838 secs
2025-03-13 12:01:10,886 [INFO]: {
2025-03-13 12:01:10,886 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:10,886 [INFO]: 	index_param: efSearch=153
2025-03-13 12:01:10,887 [INFO]: 	index_path: knn.index
2025-03-13 12:01:10,887 [INFO]: 	size in bytes: 1116129430
2025-03-13 12:01:10,887 [INFO]: 	avg_search_speed_ms: 7.442864513632163
2025-03-13 12:01:10,887 [INFO]: 	99p_search_speed_ms: 11.70946881175039
2025-03-13 12:01:10,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:10,887 [INFO]: 	nb vectors: 5673
2025-03-13 12:01:10,887 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:10,887 [INFO]: 	compression ratio: 0.9993081035413608
2025-03-13 12:01:10,887 [INFO]: }
2025-03-13 12:01:10,887 [INFO]: 	>>> Finished "Creating the index" in 73.1859 secs
2025-03-13 12:01:10,887 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2091 secs
2025-03-13 12:01:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 93726 [episode count 11/20]
[retrieval_preprocessing] for episode 64418 [episode count 12/20], we have num_retrieval=np.int64(5685) num_query=np.int64(174)
2025-03-13 12:01:14,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:14,933 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:14
2025-03-13 12:01:14,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.52it/s]
2025-03-13 12:01:14,958 [INFO]: There are 5685 embeddings of dim 49152
2025-03-13 12:01:14,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 12:01:14,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:14
2025-03-13 12:01:14,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:14,958 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:01:14,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:14,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:01:14,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:14
2025-03-13 12:01:14,958 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:14,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:01:14,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:14
2025-03-13 12:01:14,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:14,958 [INFO]: 	Creating the index 03/13/2025, 12:01:14
2025-03-13 12:01:14,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:14
2025-03-13 12:01:14,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:01:14,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:14
2025-03-13 12:01:14,960 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:01:14,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.41it/s] 12%|█▎        | 3/24 [00:00<00:01, 10.56it/s] 21%|██        | 5/24 [00:00<00:01, 12.47it/s] 29%|██▉       | 7/24 [00:00<00:01, 12.71it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.85it/s] 46%|████▌     | 11/24 [00:00<00:00, 13.11it/s] 54%|█████▍    | 13/24 [00:01<00:00, 12.85it/s] 62%|██████▎   | 15/24 [00:01<00:00, 13.08it/s] 71%|███████   | 17/24 [00:01<00:00, 12.48it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.94it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.62it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.89it/s] 96%|█████████▌| 23/24 [00:05<00:00,  2.26it/s]100%|██████████| 24/24 [00:06<00:00,  1.45it/s]100%|██████████| 24/24 [00:06<00:00,  3.45it/s]
2025-03-13 12:01:21,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:21
2025-03-13 12:02:03,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6655 secs
2025-03-13 12:02:03,589 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 12:02:03,590 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s]
2025-03-13 12:02:26,811 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2216 secs
2025-03-13 12:02:26,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8526 secs
2025-03-13 12:02:26,812 [INFO]: {
2025-03-13 12:02:26,812 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:26,812 [INFO]: 	index_param: efSearch=230
2025-03-13 12:02:26,812 [INFO]: 	index_path: knn.index
2025-03-13 12:02:26,812 [INFO]: 	size in bytes: 1118490370
2025-03-13 12:02:26,812 [INFO]: 	avg_search_speed_ms: 12.211009029637891
2025-03-13 12:02:26,812 [INFO]: 	99p_search_speed_ms: 17.470391900278607
2025-03-13 12:02:26,812 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:26,812 [INFO]: 	nb vectors: 5685
2025-03-13 12:02:26,812 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:26,812 [INFO]: 	compression ratio: 0.9993080941769753
2025-03-13 12:02:26,812 [INFO]: }
2025-03-13 12:02:26,812 [INFO]: 	>>> Finished "Creating the index" in 71.8540 secs
2025-03-13 12:02:26,812 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8790 secs
2025-03-13 12:02:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 64418 [episode count 12/20]
[retrieval_preprocessing] for episode 23209 [episode count 13/20], we have num_retrieval=np.int64(5659) num_query=np.int64(200)
2025-03-13 12:02:31,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:32,028 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:32
2025-03-13 12:02:32,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.78it/s]
2025-03-13 12:02:32,052 [INFO]: There are 5659 embeddings of dim 49152
2025-03-13 12:02:32,052 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:02:32,052 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:32
2025-03-13 12:02:32,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:32,052 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:02:32,052 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:32,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:02:32,052 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:32
2025-03-13 12:02:32,052 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:32,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:02:32,052 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:32
2025-03-13 12:02:32,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:32,052 [INFO]: 	Creating the index 03/13/2025, 12:02:32
2025-03-13 12:02:32,052 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:32
2025-03-13 12:02:32,053 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:02:32,053 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:32
2025-03-13 12:02:32,053 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:02:32,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.13it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.55it/s] 21%|██        | 5/24 [00:00<00:02,  9.33it/s] 29%|██▉       | 7/24 [00:00<00:01,  9.72it/s] 38%|███▊      | 9/24 [00:00<00:01, 10.14it/s] 46%|████▌     | 11/24 [00:01<00:01, 10.73it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.18it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.27it/s] 71%|███████   | 17/24 [00:01<00:00, 11.61it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.73it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.65it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.94it/s]100%|██████████| 24/24 [00:06<00:00,  1.74it/s]100%|██████████| 24/24 [00:06<00:00,  3.51it/s]
2025-03-13 12:02:38,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:38
2025-03-13 12:03:21,146 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2602 secs
2025-03-13 12:03:21,147 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 12:03:21,147 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 12:03:45,217 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0706 secs
2025-03-13 12:03:45,218 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1649 secs
2025-03-13 12:03:45,218 [INFO]: {
2025-03-13 12:03:45,218 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:45,218 [INFO]: 	index_param: efSearch=226
2025-03-13 12:03:45,218 [INFO]: 	index_path: knn.index
2025-03-13 12:03:45,218 [INFO]: 	size in bytes: 1113375070
2025-03-13 12:03:45,218 [INFO]: 	avg_search_speed_ms: 10.838294549333588
2025-03-13 12:03:45,218 [INFO]: 	99p_search_speed_ms: 14.734139172360297
2025-03-13 12:03:45,218 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:45,218 [INFO]: 	nb vectors: 5659
2025-03-13 12:03:45,218 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:45,218 [INFO]: 	compression ratio: 0.9993080516882779
2025-03-13 12:03:45,218 [INFO]: }
2025-03-13 12:03:45,219 [INFO]: 	>>> Finished "Creating the index" in 73.1662 secs
2025-03-13 12:03:45,219 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1909 secs
2025-03-13 12:03:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 23209 [episode count 13/20]
[retrieval_preprocessing] for episode 38059 [episode count 14/20], we have num_retrieval=np.int64(5612) num_query=np.int64(247)
2025-03-13 12:03:48,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:49,236 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:49
2025-03-13 12:03:49,236 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2345.81it/s]
2025-03-13 12:03:49,259 [INFO]: There are 5612 embeddings of dim 49152
2025-03-13 12:03:49,259 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 12:03:49,259 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:49
2025-03-13 12:03:49,259 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:49,259 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:03:49,259 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:49,259 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:49,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:49
2025-03-13 12:03:49,259 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:49,259 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:03:49,259 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:49
2025-03-13 12:03:49,259 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:49,259 [INFO]: 	Creating the index 03/13/2025, 12:03:49
2025-03-13 12:03:49,259 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:49
2025-03-13 12:03:49,260 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:03:49,260 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:49
2025-03-13 12:03:49,260 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:03:49,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.40it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.18it/s] 21%|██        | 5/24 [00:00<00:01, 11.17it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.91it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.91it/s] 46%|████▌     | 11/24 [00:00<00:01, 11.99it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.93it/s] 62%|██████▎   | 15/24 [00:01<00:00, 12.03it/s] 71%|███████   | 17/24 [00:01<00:00, 12.05it/s] 79%|███████▉  | 19/24 [00:01<00:00, 12.14it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.58it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.85it/s]100%|██████████| 24/24 [00:06<00:00,  1.70it/s]100%|██████████| 24/24 [00:06<00:00,  3.49it/s]
2025-03-13 12:03:56,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:56
2025-03-13 12:04:41,159 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0203 secs
2025-03-13 12:04:41,159 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 12:04:41,159 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 12:05:04,845 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6859 secs
2025-03-13 12:05:04,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5859 secs
2025-03-13 12:05:04,846 [INFO]: {
2025-03-13 12:05:04,846 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:04,846 [INFO]: 	index_param: efSearch=213
2025-03-13 12:05:04,846 [INFO]: 	index_path: knn.index
2025-03-13 12:05:04,846 [INFO]: 	size in bytes: 1104128170
2025-03-13 12:05:04,846 [INFO]: 	avg_search_speed_ms: 10.622853784862507
2025-03-13 12:05:04,847 [INFO]: 	99p_search_speed_ms: 14.221347542479636
2025-03-13 12:05:04,847 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:04,847 [INFO]: 	nb vectors: 5612
2025-03-13 12:05:04,847 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:04,847 [INFO]: 	compression ratio: 0.999307984325769
2025-03-13 12:05:04,847 [INFO]: }
2025-03-13 12:05:04,847 [INFO]: 	>>> Finished "Creating the index" in 75.5872 secs
2025-03-13 12:05:04,847 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6102 secs
2025-03-13 12:05:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 38059 [episode count 14/20]
[retrieval_preprocessing] for episode 76343 [episode count 15/20], we have num_retrieval=np.int64(5599) num_query=np.int64(260)
2025-03-13 12:05:21,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:22,528 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:22
2025-03-13 12:05:22,528 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.37it/s]
2025-03-13 12:05:22,556 [INFO]: There are 5599 embeddings of dim 49152
2025-03-13 12:05:22,556 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 12:05:22,556 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:22
2025-03-13 12:05:22,556 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:22,557 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:05:22,557 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:22,557 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:05:22,557 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:22
2025-03-13 12:05:22,557 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:22,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:05:22,558 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:22
2025-03-13 12:05:22,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:22,558 [INFO]: 	Creating the index 03/13/2025, 12:05:22
2025-03-13 12:05:22,558 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:22
2025-03-13 12:05:22,561 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:05:22,561 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:22
2025-03-13 12:05:22,561 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:05:22,561 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.21it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.89it/s] 21%|██        | 5/24 [00:00<00:01, 11.34it/s] 29%|██▉       | 7/24 [00:00<00:01, 13.00it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.28it/s] 46%|████▌     | 11/24 [00:00<00:01, 12.00it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.48it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.16it/s] 71%|███████   | 17/24 [00:01<00:00, 10.76it/s] 79%|███████▉  | 19/24 [00:01<00:00, 10.26it/s] 88%|████████▊ | 21/24 [00:05<00:02,  1.50it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.76it/s] 96%|█████████▌| 23/24 [00:05<00:00,  2.11it/s]100%|██████████| 24/24 [00:07<00:00,  1.53it/s]100%|██████████| 24/24 [00:07<00:00,  3.35it/s]
2025-03-13 12:05:29,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:29
2025-03-13 12:06:11,153 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4300 secs
2025-03-13 12:06:11,153 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 12:06:11,153 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 12:06:33,058 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9050 secs
2025-03-13 12:06:33,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.4980 secs
2025-03-13 12:06:33,059 [INFO]: {
2025-03-13 12:06:33,059 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:33,059 [INFO]: 	index_param: efSearch=193
2025-03-13 12:06:33,059 [INFO]: 	index_path: knn.index
2025-03-13 12:06:33,059 [INFO]: 	size in bytes: 1101570490
2025-03-13 12:06:33,059 [INFO]: 	avg_search_speed_ms: 9.817906112937482
2025-03-13 12:06:33,059 [INFO]: 	99p_search_speed_ms: 15.179445520043368
2025-03-13 12:06:33,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:33,059 [INFO]: 	nb vectors: 5599
2025-03-13 12:06:33,059 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:33,059 [INFO]: 	compression ratio: 0.9993079898137068
2025-03-13 12:06:33,059 [INFO]: }
2025-03-13 12:06:33,059 [INFO]: 	>>> Finished "Creating the index" in 70.5016 secs
2025-03-13 12:06:33,059 [INFO]: >>> Finished "Launching the whole pipeline" in 70.5311 secs
2025-03-13 12:06:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 76343 [episode count 15/20]
[retrieval_preprocessing] for episode 84668 [episode count 16/20], we have num_retrieval=np.int64(5626) num_query=np.int64(233)
2025-03-13 12:06:37,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:38,244 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:38
2025-03-13 12:06:38,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.76it/s]
2025-03-13 12:06:38,268 [INFO]: There are 5626 embeddings of dim 49152
2025-03-13 12:06:38,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 12:06:38,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:38
2025-03-13 12:06:38,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:38,268 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:06:38,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:38,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:06:38,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:38
2025-03-13 12:06:38,268 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:38,268 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:06:38,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:38
2025-03-13 12:06:38,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:38,269 [INFO]: 	Creating the index 03/13/2025, 12:06:38
2025-03-13 12:06:38,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:38
2025-03-13 12:06:38,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:06:38,270 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:38
2025-03-13 12:06:38,270 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:06:38,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:05,  4.51it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.64it/s] 21%|██        | 5/24 [00:00<00:01, 10.19it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.80it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.03it/s] 46%|████▌     | 11/24 [00:01<00:01, 11.45it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.89it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.99it/s] 71%|███████   | 17/24 [00:01<00:00, 11.81it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.71it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.57it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.85it/s]100%|██████████| 24/24 [00:06<00:00,  1.69it/s]100%|██████████| 24/24 [00:06<00:00,  3.44it/s]
2025-03-13 12:06:45,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:45
2025-03-13 12:07:29,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2648 secs
2025-03-13 12:07:29,504 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 12:07:29,505 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s]
2025-03-13 12:07:48,727 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2225 secs
2025-03-13 12:07:48,728 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.4585 secs
2025-03-13 12:07:48,728 [INFO]: {
2025-03-13 12:07:48,728 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:48,728 [INFO]: 	index_param: efSearch=238
2025-03-13 12:07:48,728 [INFO]: 	index_path: knn.index
2025-03-13 12:07:48,728 [INFO]: 	size in bytes: 1106882590
2025-03-13 12:07:48,728 [INFO]: 	avg_search_speed_ms: 12.107447619306388
2025-03-13 12:07:48,728 [INFO]: 	99p_search_speed_ms: 20.28349123429507
2025-03-13 12:07:48,728 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:48,728 [INFO]: 	nb vectors: 5626
2025-03-13 12:07:48,728 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:48,728 [INFO]: 	compression ratio: 0.9993079826108747
2025-03-13 12:07:48,728 [INFO]: }
2025-03-13 12:07:48,728 [INFO]: 	>>> Finished "Creating the index" in 70.4598 secs
2025-03-13 12:07:48,728 [INFO]: >>> Finished "Launching the whole pipeline" in 70.4847 secs
2025-03-13 12:07:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 84668 [episode count 16/20]
[retrieval_preprocessing] for episode 84922 [episode count 17/20], we have num_retrieval=np.int64(5573) num_query=np.int64(286)
2025-03-13 12:07:53,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:54,112 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:54
2025-03-13 12:07:54,112 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1188.52it/s]
2025-03-13 12:07:54,140 [INFO]: There are 5573 embeddings of dim 49152
2025-03-13 12:07:54,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 12:07:54,141 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:54
2025-03-13 12:07:54,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:54,141 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:07:54,141 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:54,142 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:07:54,142 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:54
2025-03-13 12:07:54,142 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:54,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:07:54,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:54
2025-03-13 12:07:54,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:54,143 [INFO]: 	Creating the index 03/13/2025, 12:07:54
2025-03-13 12:07:54,143 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:54
2025-03-13 12:07:54,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:07:54,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:54
2025-03-13 12:07:54,146 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:07:54,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.28it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.70it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.36it/s] 30%|███       | 7/23 [00:00<00:01, 10.70it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.89it/s] 48%|████▊     | 11/23 [00:01<00:01, 10.89it/s] 57%|█████▋    | 13/23 [00:01<00:00, 10.95it/s] 65%|██████▌   | 15/23 [00:01<00:00, 10.94it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.13it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.44it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.60it/s]100%|██████████| 23/23 [00:06<00:00,  1.56it/s]100%|██████████| 23/23 [00:06<00:00,  3.40it/s]
2025-03-13 12:08:00,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:00
2025-03-13 12:08:41,907 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9768 secs
2025-03-13 12:08:41,907 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 12:08:41,907 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-13 12:09:04,866 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9588 secs
2025-03-13 12:09:04,867 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7210 secs
2025-03-13 12:09:04,867 [INFO]: {
2025-03-13 12:09:04,867 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:04,867 [INFO]: 	index_param: efSearch=247
2025-03-13 12:09:04,867 [INFO]: 	index_path: knn.index
2025-03-13 12:09:04,867 [INFO]: 	size in bytes: 1096455190
2025-03-13 12:09:04,867 [INFO]: 	avg_search_speed_ms: 10.971572991254282
2025-03-13 12:09:04,867 [INFO]: 	99p_search_speed_ms: 15.787340290844439
2025-03-13 12:09:04,867 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:04,867 [INFO]: 	nb vectors: 5573
2025-03-13 12:09:04,867 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:04,867 [INFO]: 	compression ratio: 0.999307946182461
2025-03-13 12:09:04,867 [INFO]: }
2025-03-13 12:09:04,867 [INFO]: 	>>> Finished "Creating the index" in 70.7248 secs
2025-03-13 12:09:04,867 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7556 secs
2025-03-13 12:09:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 84922 [episode count 17/20]
[retrieval_preprocessing] for episode 89273 [episode count 18/20], we have num_retrieval=np.int64(5472) num_query=np.int64(387)
2025-03-13 12:09:10,946 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:11,868 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:11
2025-03-13 12:09:11,868 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.38it/s]
2025-03-13 12:09:11,892 [INFO]: There are 5472 embeddings of dim 49152
2025-03-13 12:09:11,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 12:09:11,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:11,893 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 12:09:11,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:11,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:09:11,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,893 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:11,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:09:11,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:11
2025-03-13 12:09:11,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:11,893 [INFO]: 	Creating the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:11
2025-03-13 12:09:11,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:09:11,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,894 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:09:11,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.21it/s]  9%|▊         | 2/23 [00:00<00:02,  7.17it/s] 17%|█▋        | 4/23 [00:00<00:01,  9.82it/s] 26%|██▌       | 6/23 [00:00<00:01, 10.84it/s] 35%|███▍      | 8/23 [00:00<00:01, 11.81it/s] 43%|████▎     | 10/23 [00:00<00:01, 12.33it/s] 52%|█████▏    | 12/23 [00:01<00:00, 12.56it/s] 61%|██████    | 14/23 [00:01<00:00, 12.74it/s] 70%|██████▉   | 16/23 [00:01<00:00, 12.55it/s] 78%|███████▊  | 18/23 [00:01<00:00, 12.44it/s] 87%|████████▋ | 20/23 [00:01<00:00, 12.36it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.51it/s]100%|██████████| 23/23 [00:07<00:00,  1.27it/s]100%|██████████| 23/23 [00:07<00:00,  3.28it/s]
2025-03-13 12:09:18,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:18
2025-03-13 12:10:01,397 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4770 secs
2025-03-13 12:10:01,397 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:10:01,397 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 12:10:20,644 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2463 secs
2025-03-13 12:10:21,193 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2986 secs
2025-03-13 12:10:21,193 [INFO]: {
2025-03-13 12:10:21,193 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:21,193 [INFO]: 	index_param: efSearch=258
2025-03-13 12:10:21,193 [INFO]: 	index_path: knn.index
2025-03-13 12:10:21,193 [INFO]: 	size in bytes: 1076583970
2025-03-13 12:10:21,193 [INFO]: 	avg_search_speed_ms: 13.003034067857328
2025-03-13 12:10:21,193 [INFO]: 	99p_search_speed_ms: 18.27000624500215
2025-03-13 12:10:21,193 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:21,193 [INFO]: 	nb vectors: 5472
2025-03-13 12:10:21,193 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:21,194 [INFO]: 	compression ratio: 0.9993080019573392
2025-03-13 12:10:21,194 [INFO]: }
2025-03-13 12:10:21,194 [INFO]: 	>>> Finished "Creating the index" in 69.3007 secs
2025-03-13 12:10:21,194 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3261 secs
2025-03-13 12:10:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 89273 [episode count 18/20]
[retrieval_preprocessing] for episode 40386 [episode count 19/20], we have num_retrieval=np.int64(5653) num_query=np.int64(206)
2025-03-13 12:10:27,029 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:28,000 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:28
2025-03-13 12:10:28,000 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-13 12:10:28,030 [INFO]: There are 5653 embeddings of dim 49152
2025-03-13 12:10:28,030 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 12:10:28,030 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:28
2025-03-13 12:10:28,031 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:28,031 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 12:10:28,031 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:28,031 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:10:28,031 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:28
2025-03-13 12:10:28,031 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:28,031 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:10:28,031 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:28
2025-03-13 12:10:28,031 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:28,031 [INFO]: 	Creating the index 03/13/2025, 12:10:28
2025-03-13 12:10:28,031 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:28
2025-03-13 12:10:28,033 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 12:10:28,033 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:28
2025-03-13 12:10:28,033 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 12:10:28,033 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.13it/s] 12%|█▎        | 3/24 [00:00<00:01, 10.85it/s] 21%|██        | 5/24 [00:00<00:01, 11.74it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.71it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.88it/s] 46%|████▌     | 11/24 [00:00<00:01, 11.52it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.33it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.21it/s] 71%|███████   | 17/24 [00:01<00:00, 11.18it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.14it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.61it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.89it/s]100%|██████████| 24/24 [00:06<00:00,  1.72it/s]100%|██████████| 24/24 [00:06<00:00,  3.52it/s]
2025-03-13 12:10:34,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:34
2025-03-13 12:11:19,075 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2267 secs
2025-03-13 12:11:19,076 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 12:11:19,076 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-13 12:11:44,249 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1728 secs
2025-03-13 12:11:44,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2165 secs
2025-03-13 12:11:44,249 [INFO]: {
2025-03-13 12:11:44,249 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:44,250 [INFO]: 	index_param: efSearch=156
2025-03-13 12:11:44,250 [INFO]: 	index_path: knn.index
2025-03-13 12:11:44,250 [INFO]: 	size in bytes: 1112194630
2025-03-13 12:11:44,250 [INFO]: 	avg_search_speed_ms: 8.102685001390462
2025-03-13 12:11:44,250 [INFO]: 	99p_search_speed_ms: 11.493617875967185
2025-03-13 12:11:44,250 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:44,250 [INFO]: 	nb vectors: 5653
2025-03-13 12:11:44,250 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:44,250 [INFO]: 	compression ratio: 0.9993080293869069
2025-03-13 12:11:44,250 [INFO]: }
2025-03-13 12:11:44,250 [INFO]: 	>>> Finished "Creating the index" in 76.2184 secs
2025-03-13 12:11:44,250 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2496 secs
2025-03-13 12:11:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 40386 [episode count 19/20]
2025-03-13 12:11:45: [retrieval_preprocessing] finished for 7779812931_Put_Item_in_Bag [chosen_id count 3/260]
2025-03-13 12:11:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7802759726_top_right_button [chosen_id count 4/260]
2025-03-13 12:11:49: [retrieval_preprocessing] we have num_total=3810 embedding_dim=49152
[retrieval_preprocessing] for episode 26756 [episode count 0/20], we have num_retrieval=np.int64(3623) num_query=np.int64(187)
2025-03-13 12:11:50,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:50,769 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:50
2025-03-13 12:11:50,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.03it/s]
2025-03-13 12:11:50,793 [INFO]: There are 3623 embeddings of dim 49152
2025-03-13 12:11:50,793 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 12:11:50,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:50
2025-03-13 12:11:50,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:50,793 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:11:50,793 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:50,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:50,793 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:50
2025-03-13 12:11:50,793 [INFO]: 747.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:50,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:50,794 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:50
2025-03-13 12:11:50,794 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:50,794 [INFO]: 	Creating the index 03/13/2025, 12:11:50
2025-03-13 12:11:50,794 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:50
2025-03-13 12:11:50,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:11:50,795 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:50
2025-03-13 12:11:50,795 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:11:50,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.19it/s] 20%|██        | 3/15 [00:00<00:01,  9.28it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.14it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.83it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.74it/s] 60%|██████    | 9/15 [00:00<00:00,  9.61it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.04it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.31it/s]100%|██████████| 15/15 [00:04<00:00,  1.85it/s]100%|██████████| 15/15 [00:04<00:00,  3.68it/s]
2025-03-13 12:11:54,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:54
2025-03-13 12:12:30,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8189 secs
2025-03-13 12:12:30,692 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 12:12:30,692 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 12:12:50,734 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0416 secs
2025-03-13 12:12:50,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9420 secs
2025-03-13 12:12:50,737 [INFO]: {
2025-03-13 12:12:50,737 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:50,737 [INFO]: 	index_param: efSearch=263
2025-03-13 12:12:50,737 [INFO]: 	index_path: knn.index
2025-03-13 12:12:50,737 [INFO]: 	size in bytes: 712803010
2025-03-13 12:12:50,737 [INFO]: 	avg_search_speed_ms: 9.49132769298784
2025-03-13 12:12:50,737 [INFO]: 	99p_search_speed_ms: 12.33849017182365
2025-03-13 12:12:50,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:50,737 [INFO]: 	nb vectors: 3623
2025-03-13 12:12:50,737 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:50,737 [INFO]: 	compression ratio: 0.999309450166323
2025-03-13 12:12:50,737 [INFO]: }
2025-03-13 12:12:50,737 [INFO]: 	>>> Finished "Creating the index" in 59.9434 secs
2025-03-13 12:12:50,737 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9683 secs
2025-03-13 12:12:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 26756 [episode count 0/20]
[retrieval_preprocessing] for episode 65416 [episode count 1/20], we have num_retrieval=np.int64(3667) num_query=np.int64(143)
2025-03-13 12:12:54,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:54,941 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:54
2025-03-13 12:12:54,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1907.37it/s]
2025-03-13 12:12:54,964 [INFO]: There are 3667 embeddings of dim 49152
2025-03-13 12:12:54,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 12:12:54,964 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:54
2025-03-13 12:12:54,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:54,964 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:12:54,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:54,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:12:54,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:54
2025-03-13 12:12:54,965 [INFO]: 756.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:54,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:12:54,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:54
2025-03-13 12:12:54,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:54,965 [INFO]: 	Creating the index 03/13/2025, 12:12:54
2025-03-13 12:12:54,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:54
2025-03-13 12:12:54,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:12:54,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:54
2025-03-13 12:12:54,966 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:12:54,966 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.77it/s] 20%|██        | 3/15 [00:00<00:01,  9.71it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.56it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.28it/s] 60%|██████    | 9/15 [00:00<00:00, 11.68it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.05it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.25it/s]100%|██████████| 15/15 [00:03<00:00,  2.35it/s]100%|██████████| 15/15 [00:03<00:00,  4.38it/s]
2025-03-13 12:12:58,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:58
2025-03-13 12:13:38,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9718 secs
2025-03-13 12:13:38,368 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 12:13:38,368 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
2025-03-13 12:13:58,037 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6693 secs
2025-03-13 12:13:58,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3983 secs
2025-03-13 12:13:58,364 [INFO]: {
2025-03-13 12:13:58,364 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:58,364 [INFO]: 	index_param: efSearch=296
2025-03-13 12:13:58,365 [INFO]: 	index_path: knn.index
2025-03-13 12:13:58,365 [INFO]: 	size in bytes: 721459870
2025-03-13 12:13:58,365 [INFO]: 	avg_search_speed_ms: 10.883943863837322
2025-03-13 12:13:58,365 [INFO]: 	99p_search_speed_ms: 21.86680969316512
2025-03-13 12:13:58,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:58,365 [INFO]: 	nb vectors: 3667
2025-03-13 12:13:58,365 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:58,365 [INFO]: 	compression ratio: 0.9993092699667412
2025-03-13 12:13:58,365 [INFO]: }
2025-03-13 12:13:58,365 [INFO]: 	>>> Finished "Creating the index" in 63.4003 secs
2025-03-13 12:13:58,365 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4238 secs
2025-03-13 12:13:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 65416 [episode count 1/20]
[retrieval_preprocessing] for episode 20618 [episode count 2/20], we have num_retrieval=np.int64(3672) num_query=np.int64(138)
2025-03-13 12:14:00,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:01,211 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:01
2025-03-13 12:14:01,212 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1833.98it/s]
2025-03-13 12:14:01,238 [INFO]: There are 3672 embeddings of dim 49152
2025-03-13 12:14:01,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 12:14:01,239 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:01
2025-03-13 12:14:01,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:01,239 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:14:01,240 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:01,240 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:14:01,240 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:01
2025-03-13 12:14:01,240 [INFO]: 757.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:01,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:14:01,241 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:01
2025-03-13 12:14:01,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:01,241 [INFO]: 	Creating the index 03/13/2025, 12:14:01
2025-03-13 12:14:01,241 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:01
2025-03-13 12:14:01,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:14:01,244 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:01
2025-03-13 12:14:01,245 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:14:01,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.07it/s] 20%|██        | 3/15 [00:00<00:01,  8.84it/s] 27%|██▋       | 4/15 [00:00<00:01,  9.13it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.79it/s] 40%|████      | 6/15 [00:00<00:01,  8.71it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.83it/s] 60%|██████    | 9/15 [00:01<00:00,  9.07it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.88it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.73it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.04it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.90it/s]100%|██████████| 15/15 [00:04<00:00,  1.42it/s]100%|██████████| 15/15 [00:04<00:00,  3.71it/s]
2025-03-13 12:14:05,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:05
2025-03-13 12:14:44,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0261 secs
2025-03-13 12:14:44,325 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 12:14:44,325 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s]
2025-03-13 12:15:07,450 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1241 secs
2025-03-13 12:15:07,795 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5501 secs
2025-03-13 12:15:07,795 [INFO]: {
2025-03-13 12:15:07,795 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:07,795 [INFO]: 	index_param: efSearch=307
2025-03-13 12:15:07,795 [INFO]: 	index_path: knn.index
2025-03-13 12:15:07,795 [INFO]: 	size in bytes: 722443570
2025-03-13 12:15:07,795 [INFO]: 	avg_search_speed_ms: 9.873532342125992
2025-03-13 12:15:07,795 [INFO]: 	99p_search_speed_ms: 15.003762375563381
2025-03-13 12:15:07,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:07,795 [INFO]: 	nb vectors: 3672
2025-03-13 12:15:07,796 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:07,796 [INFO]: 	compression ratio: 0.9993092969185122
2025-03-13 12:15:07,796 [INFO]: }
2025-03-13 12:15:07,796 [INFO]: 	>>> Finished "Creating the index" in 66.5548 secs
2025-03-13 12:15:07,796 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5842 secs
2025-03-13 12:15:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 20618 [episode count 2/20]
[retrieval_preprocessing] for episode 65291 [episode count 3/20], we have num_retrieval=np.int64(3583) num_query=np.int64(227)
2025-03-13 12:15:10,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:10,870 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:10
2025-03-13 12:15:10,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2268.42it/s]
2025-03-13 12:15:10,892 [INFO]: There are 3583 embeddings of dim 49152
2025-03-13 12:15:10,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-13 12:15:10,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:10
2025-03-13 12:15:10,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:10,892 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:15:10,892 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:10,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:10,892 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:10
2025-03-13 12:15:10,892 [INFO]: 739.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:10,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:15:10,892 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:10
2025-03-13 12:15:10,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:10,892 [INFO]: 	Creating the index 03/13/2025, 12:15:10
2025-03-13 12:15:10,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:10
2025-03-13 12:15:10,893 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:15:10,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:10
2025-03-13 12:15:10,894 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:15:10,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.11it/s] 20%|██        | 3/15 [00:00<00:00, 13.54it/s] 33%|███▎      | 5/15 [00:00<00:00, 15.81it/s] 47%|████▋     | 7/15 [00:00<00:00, 15.08it/s] 60%|██████    | 9/15 [00:00<00:00, 14.01it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.29it/s] 87%|████████▋ | 13/15 [00:00<00:00, 12.87it/s]100%|██████████| 15/15 [00:03<00:00,  2.19it/s]100%|██████████| 15/15 [00:03<00:00,  4.31it/s]
2025-03-13 12:15:14,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:14
2025-03-13 12:15:56,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0545 secs
2025-03-13 12:15:56,429 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 12:15:56,429 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 12:16:16,534 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1049 secs
2025-03-13 12:16:16,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6430 secs
2025-03-13 12:16:16,537 [INFO]: {
2025-03-13 12:16:16,537 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:16,537 [INFO]: 	index_param: efSearch=269
2025-03-13 12:16:16,537 [INFO]: 	index_path: knn.index
2025-03-13 12:16:16,537 [INFO]: 	size in bytes: 704933110
2025-03-13 12:16:16,537 [INFO]: 	avg_search_speed_ms: 9.412513038655655
2025-03-13 12:16:16,537 [INFO]: 	99p_search_speed_ms: 13.84081675438211
2025-03-13 12:16:16,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:16,537 [INFO]: 	nb vectors: 3583
2025-03-13 12:16:16,537 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:16,537 [INFO]: 	compression ratio: 0.9993096564864147
2025-03-13 12:16:16,537 [INFO]: }
2025-03-13 12:16:16,537 [INFO]: 	>>> Finished "Creating the index" in 65.6445 secs
2025-03-13 12:16:16,537 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6667 secs
2025-03-13 12:16:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 65291 [episode count 3/20]
[retrieval_preprocessing] for episode 65674 [episode count 4/20], we have num_retrieval=np.int64(3649) num_query=np.int64(161)
2025-03-13 12:16:19,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:20,358 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:20
2025-03-13 12:16:20,358 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1865.79it/s]
2025-03-13 12:16:20,380 [INFO]: There are 3649 embeddings of dim 49152
2025-03-13 12:16:20,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 12:16:20,380 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:20
2025-03-13 12:16:20,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:20,380 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:16:20,380 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:20,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:16:20,380 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:20
2025-03-13 12:16:20,380 [INFO]: 753.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:20,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:16:20,380 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:20
2025-03-13 12:16:20,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:20,381 [INFO]: 	Creating the index 03/13/2025, 12:16:20
2025-03-13 12:16:20,381 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:20
2025-03-13 12:16:20,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:16:20,381 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:20
2025-03-13 12:16:20,382 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:16:20,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.60it/s] 20%|██        | 3/15 [00:00<00:01, 10.00it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.95it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.44it/s] 60%|██████    | 9/15 [00:00<00:00, 11.71it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.08it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.19it/s]100%|██████████| 15/15 [00:03<00:00,  2.34it/s]100%|██████████| 15/15 [00:03<00:00,  4.36it/s]
2025-03-13 12:16:23,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:23
2025-03-13 12:16:58,047 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2260 secs
2025-03-13 12:16:58,047 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 12:16:58,047 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 12:17:18,175 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1273 secs
2025-03-13 12:17:18,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7969 secs
2025-03-13 12:17:18,179 [INFO]: {
2025-03-13 12:17:18,179 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:18,179 [INFO]: 	index_param: efSearch=248
2025-03-13 12:17:18,179 [INFO]: 	index_path: knn.index
2025-03-13 12:17:18,179 [INFO]: 	size in bytes: 717918490
2025-03-13 12:17:18,179 [INFO]: 	avg_search_speed_ms: 9.646452293599253
2025-03-13 12:17:18,179 [INFO]: 	99p_search_speed_ms: 18.417997416108847
2025-03-13 12:17:18,179 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:18,179 [INFO]: 	nb vectors: 3649
2025-03-13 12:17:18,179 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:18,179 [INFO]: 	compression ratio: 0.9993092558460223
2025-03-13 12:17:18,179 [INFO]: }
2025-03-13 12:17:18,179 [INFO]: 	>>> Finished "Creating the index" in 57.7983 secs
2025-03-13 12:17:18,179 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8212 secs
2025-03-13 12:17:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 65674 [episode count 4/20]
[retrieval_preprocessing] for episode 83090 [episode count 5/20], we have num_retrieval=np.int64(3612) num_query=np.int64(198)
2025-03-13 12:17:21,094 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:22,600 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:22
2025-03-13 12:17:22,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.86it/s]
2025-03-13 12:17:22,625 [INFO]: There are 3612 embeddings of dim 49152
2025-03-13 12:17:22,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 12:17:22,625 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:22
2025-03-13 12:17:22,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:22,625 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:17:22,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:22,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:22,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:22
2025-03-13 12:17:22,626 [INFO]: 745.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:22,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:22,626 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:22
2025-03-13 12:17:22,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:22,626 [INFO]: 	Creating the index 03/13/2025, 12:17:22
2025-03-13 12:17:22,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:22
2025-03-13 12:17:22,627 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:17:22,627 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:22
2025-03-13 12:17:22,627 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:17:22,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.37it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.96it/s] 20%|██        | 3/15 [00:00<00:01,  7.77it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.16it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.36it/s] 40%|████      | 6/15 [00:00<00:01,  8.51it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.61it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.68it/s] 60%|██████    | 9/15 [00:01<00:00,  8.98it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.93it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.89it/s] 80%|████████  | 12/15 [00:01<00:00,  8.96it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.85it/s]100%|██████████| 15/15 [00:03<00:00,  1.61it/s]100%|██████████| 15/15 [00:03<00:00,  3.79it/s]
2025-03-13 12:17:26,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:26
2025-03-13 12:18:06,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8120 secs
2025-03-13 12:18:06,404 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 12:18:06,404 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 12:18:20,031 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6269 secs
2025-03-13 12:18:20,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4070 secs
2025-03-13 12:18:20,034 [INFO]: {
2025-03-13 12:18:20,034 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:20,034 [INFO]: 	index_param: efSearch=251
2025-03-13 12:18:20,034 [INFO]: 	index_path: knn.index
2025-03-13 12:18:20,034 [INFO]: 	size in bytes: 710638810
2025-03-13 12:18:20,034 [INFO]: 	avg_search_speed_ms: 10.539052043271077
2025-03-13 12:18:20,034 [INFO]: 	99p_search_speed_ms: 19.15715398266911
2025-03-13 12:18:20,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:20,035 [INFO]: 	nb vectors: 3612
2025-03-13 12:18:20,035 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:20,035 [INFO]: 	compression ratio: 0.9993094748090102
2025-03-13 12:18:20,035 [INFO]: }
2025-03-13 12:18:20,035 [INFO]: 	>>> Finished "Creating the index" in 57.4087 secs
2025-03-13 12:18:20,035 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4342 secs
2025-03-13 12:18:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 83090 [episode count 5/20]
[retrieval_preprocessing] for episode 63251 [episode count 6/20], we have num_retrieval=np.int64(3587) num_query=np.int64(223)
2025-03-13 12:18:23,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:24,441 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:24
2025-03-13 12:18:24,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2111.94it/s]
2025-03-13 12:18:24,466 [INFO]: There are 3587 embeddings of dim 49152
2025-03-13 12:18:24,466 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:18:24,467 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:24
2025-03-13 12:18:24,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:24,467 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:18:24,467 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:24,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:24,467 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:24
2025-03-13 12:18:24,467 [INFO]: 740.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:24,467 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:18:24,467 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:24
2025-03-13 12:18:24,467 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:24,467 [INFO]: 	Creating the index 03/13/2025, 12:18:24
2025-03-13 12:18:24,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:24
2025-03-13 12:18:24,468 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:18:24,468 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:24
2025-03-13 12:18:24,468 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:18:24,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.03it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.85it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.09it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.46it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.29it/s] 60%|██████    | 9/15 [00:01<00:00,  9.90it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.34it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.87it/s]100%|██████████| 15/15 [00:03<00:00,  2.09it/s]100%|██████████| 15/15 [00:03<00:00,  3.83it/s]
2025-03-13 12:18:28,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:28
2025-03-13 12:19:12,086 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6971 secs
2025-03-13 12:19:12,086 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 12:19:12,086 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 12:19:28,714 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6278 secs
2025-03-13 12:19:28,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2489 secs
2025-03-13 12:19:28,717 [INFO]: {
2025-03-13 12:19:28,717 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:28,717 [INFO]: 	index_param: efSearch=263
2025-03-13 12:19:28,717 [INFO]: 	index_path: knn.index
2025-03-13 12:19:28,717 [INFO]: 	size in bytes: 705720130
2025-03-13 12:19:28,717 [INFO]: 	avg_search_speed_ms: 10.061480650459032
2025-03-13 12:19:28,717 [INFO]: 	99p_search_speed_ms: 14.309112827759234
2025-03-13 12:19:28,717 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:28,717 [INFO]: 	nb vectors: 3587
2025-03-13 12:19:28,717 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:28,717 [INFO]: 	compression ratio: 0.9993095931669117
2025-03-13 12:19:28,717 [INFO]: }
2025-03-13 12:19:28,717 [INFO]: 	>>> Finished "Creating the index" in 64.2502 secs
2025-03-13 12:19:28,717 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2759 secs
2025-03-13 12:19:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 63251 [episode count 6/20]
[retrieval_preprocessing] for episode 48916 [episode count 7/20], we have num_retrieval=np.int64(3508) num_query=np.int64(302)
2025-03-13 12:19:32,061 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:32,559 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:32
2025-03-13 12:19:32,559 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1339.61it/s]
2025-03-13 12:19:32,583 [INFO]: There are 3508 embeddings of dim 49152
2025-03-13 12:19:32,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 12:19:32,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:32
2025-03-13 12:19:32,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:32,583 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 12:19:32,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:32,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:32,583 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:32
2025-03-13 12:19:32,583 [INFO]: 724.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:32,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:32,583 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:32
2025-03-13 12:19:32,583 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:32,583 [INFO]: 	Creating the index 03/13/2025, 12:19:32
2025-03-13 12:19:32,583 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:32
2025-03-13 12:19:32,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:19:32,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:32
2025-03-13 12:19:32,585 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 12:19:32,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.44it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.61it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.71it/s] 50%|█████     | 7/14 [00:00<00:00, 12.23it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.49it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.74it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.64it/s]100%|██████████| 14/14 [00:03<00:00,  4.25it/s]
2025-03-13 12:19:35,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:35
2025-03-13 12:20:18,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8311 secs
2025-03-13 12:20:18,722 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:20:18,722 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 12:20:39,199 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4773 secs
2025-03-13 12:20:39,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6172 secs
2025-03-13 12:20:39,203 [INFO]: {
2025-03-13 12:20:39,203 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:39,203 [INFO]: 	index_param: efSearch=235
2025-03-13 12:20:39,203 [INFO]: 	index_path: knn.index
2025-03-13 12:20:39,203 [INFO]: 	size in bytes: 690177430
2025-03-13 12:20:39,203 [INFO]: 	avg_search_speed_ms: 8.554308091061648
2025-03-13 12:20:39,203 [INFO]: 	99p_search_speed_ms: 11.49625364691019
2025-03-13 12:20:39,203 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:39,203 [INFO]: 	nb vectors: 3508
2025-03-13 12:20:39,203 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:39,203 [INFO]: 	compression ratio: 0.999309502195689
2025-03-13 12:20:39,203 [INFO]: }
2025-03-13 12:20:39,203 [INFO]: 	>>> Finished "Creating the index" in 66.6194 secs
2025-03-13 12:20:39,203 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6441 secs
2025-03-13 12:20:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 48916 [episode count 7/20]
[retrieval_preprocessing] for episode 77207 [episode count 8/20], we have num_retrieval=np.int64(3614) num_query=np.int64(196)
2025-03-13 12:20:43,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:43,924 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:43
2025-03-13 12:20:43,924 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-13 12:20:43,949 [INFO]: There are 3614 embeddings of dim 49152
2025-03-13 12:20:43,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 12:20:43,950 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:43
2025-03-13 12:20:43,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:43,950 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:20:43,950 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:43,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:20:43,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:43
2025-03-13 12:20:43,950 [INFO]: 745.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:43,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:20:43,950 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:43
2025-03-13 12:20:43,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:43,950 [INFO]: 	Creating the index 03/13/2025, 12:20:43
2025-03-13 12:20:43,950 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:43
2025-03-13 12:20:43,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:20:43,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:43
2025-03-13 12:20:43,951 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:20:43,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.65it/s] 20%|██        | 3/15 [00:00<00:01,  9.56it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.77it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.13it/s] 60%|██████    | 9/15 [00:00<00:00, 11.46it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.33it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.01it/s]100%|██████████| 15/15 [00:04<00:00,  1.78it/s]100%|██████████| 15/15 [00:04<00:00,  3.48it/s]
2025-03-13 12:20:48,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:48
2025-03-13 12:21:28,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9040 secs
2025-03-13 12:21:28,174 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 12:21:28,174 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s]
2025-03-13 12:21:47,698 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5245 secs
2025-03-13 12:21:47,701 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7495 secs
2025-03-13 12:21:47,701 [INFO]: {
2025-03-13 12:21:47,701 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:47,701 [INFO]: 	index_param: efSearch=257
2025-03-13 12:21:47,701 [INFO]: 	index_path: knn.index
2025-03-13 12:21:47,701 [INFO]: 	size in bytes: 711032290
2025-03-13 12:21:47,701 [INFO]: 	avg_search_speed_ms: 10.522957378263143
2025-03-13 12:21:47,701 [INFO]: 	99p_search_speed_ms: 15.440837573260069
2025-03-13 12:21:47,701 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:47,701 [INFO]: 	nb vectors: 3614
2025-03-13 12:21:47,701 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:47,701 [INFO]: 	compression ratio: 0.9993094856493788
2025-03-13 12:21:47,701 [INFO]: }
2025-03-13 12:21:47,701 [INFO]: 	>>> Finished "Creating the index" in 63.7511 secs
2025-03-13 12:21:47,701 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7770 secs
2025-03-13 12:21:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 77207 [episode count 8/20]
[retrieval_preprocessing] for episode 82968 [episode count 9/20], we have num_retrieval=np.int64(3626) num_query=np.int64(184)
2025-03-13 12:21:51,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:52,306 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:52
2025-03-13 12:21:52,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1614.44it/s]
2025-03-13 12:21:52,332 [INFO]: There are 3626 embeddings of dim 49152
2025-03-13 12:21:52,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:21:52,333 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:52
2025-03-13 12:21:52,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:52,333 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:21:52,333 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:52,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:21:52,333 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:52
2025-03-13 12:21:52,333 [INFO]: 748.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:52,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:21:52,333 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:52
2025-03-13 12:21:52,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:52,333 [INFO]: 	Creating the index 03/13/2025, 12:21:52
2025-03-13 12:21:52,333 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:52
2025-03-13 12:21:52,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:21:52,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:52
2025-03-13 12:21:52,334 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:21:52,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.43it/s] 20%|██        | 3/15 [00:00<00:01,  8.18it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.30it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.58it/s] 40%|████      | 6/15 [00:00<00:01,  8.78it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.82it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.58it/s] 60%|██████    | 9/15 [00:01<00:00,  8.41it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.28it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.22it/s] 80%|████████  | 12/15 [00:01<00:00,  8.16it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.30it/s]100%|██████████| 15/15 [00:04<00:00,  1.52it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-13 12:21:56,473 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:56
2025-03-13 12:22:37,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3389 secs
2025-03-13 12:22:37,812 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 12:22:37,812 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 12:23:03,269 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4571 secs
2025-03-13 12:23:03,272 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9379 secs
2025-03-13 12:23:03,272 [INFO]: {
2025-03-13 12:23:03,272 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:03,272 [INFO]: 	index_param: efSearch=321
2025-03-13 12:23:03,272 [INFO]: 	index_path: knn.index
2025-03-13 12:23:03,272 [INFO]: 	size in bytes: 713393230
2025-03-13 12:23:03,272 [INFO]: 	avg_search_speed_ms: 10.233329836385918
2025-03-13 12:23:03,272 [INFO]: 	99p_search_speed_ms: 14.023963324725628
2025-03-13 12:23:03,272 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:03,272 [INFO]: 	nb vectors: 3626
2025-03-13 12:23:03,272 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:03,272 [INFO]: 	compression ratio: 0.9993094663934503
2025-03-13 12:23:03,272 [INFO]: }
2025-03-13 12:23:03,272 [INFO]: 	>>> Finished "Creating the index" in 70.9394 secs
2025-03-13 12:23:03,272 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9662 secs
2025-03-13 12:23:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 82968 [episode count 9/20]
[retrieval_preprocessing] for episode 25373 [episode count 10/20], we have num_retrieval=np.int64(3615) num_query=np.int64(195)
2025-03-13 12:23:06,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:06,969 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:06
2025-03-13 12:23:06,969 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.47it/s]
2025-03-13 12:23:06,992 [INFO]: There are 3615 embeddings of dim 49152
2025-03-13 12:23:06,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 12:23:06,992 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:06,992 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:23:06,992 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:06,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:06,992 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,992 [INFO]: 746.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:06,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:23:06,992 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:06
2025-03-13 12:23:06,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:06,992 [INFO]: 	Creating the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,992 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:06
2025-03-13 12:23:06,993 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:23:06,993 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,993 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:23:06,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.20it/s] 20%|██        | 3/15 [00:00<00:01,  9.62it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.33it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.20it/s] 60%|██████    | 9/15 [00:00<00:00, 10.92it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.67it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.96it/s]100%|██████████| 15/15 [00:03<00:00,  2.08it/s]100%|██████████| 15/15 [00:03<00:00,  3.94it/s]
2025-03-13 12:23:10,801 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:10
2025-03-13 12:23:49,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0688 secs
2025-03-13 12:23:49,871 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 12:23:49,871 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 12:24:10,822 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9508 secs
2025-03-13 12:24:10,824 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8311 secs
2025-03-13 12:24:10,824 [INFO]: {
2025-03-13 12:24:10,825 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:10,825 [INFO]: 	index_param: efSearch=282
2025-03-13 12:24:10,825 [INFO]: 	index_path: knn.index
2025-03-13 12:24:10,825 [INFO]: 	size in bytes: 711229030
2025-03-13 12:24:10,825 [INFO]: 	avg_search_speed_ms: 9.776667035152936
2025-03-13 12:24:10,825 [INFO]: 	99p_search_speed_ms: 14.037094111554325
2025-03-13 12:24:10,825 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:10,825 [INFO]: 	nb vectors: 3615
2025-03-13 12:24:10,825 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:10,825 [INFO]: 	compression ratio: 0.9993094910650652
2025-03-13 12:24:10,825 [INFO]: }
2025-03-13 12:24:10,825 [INFO]: 	>>> Finished "Creating the index" in 63.8325 secs
2025-03-13 12:24:10,825 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8557 secs
2025-03-13 12:24:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 25373 [episode count 10/20]
[retrieval_preprocessing] for episode 61726 [episode count 11/20], we have num_retrieval=np.int64(3566) num_query=np.int64(244)
2025-03-13 12:24:14,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:14,701 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:14
2025-03-13 12:24:14,702 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2361.66it/s]
2025-03-13 12:24:14,724 [INFO]: There are 3566 embeddings of dim 49152
2025-03-13 12:24:14,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 12:24:14,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:14
2025-03-13 12:24:14,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:14,724 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:24:14,724 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:14,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:24:14,724 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:14
2025-03-13 12:24:14,724 [INFO]: 735.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:14,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:14,724 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:14
2025-03-13 12:24:14,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:14,725 [INFO]: 	Creating the index 03/13/2025, 12:24:14
2025-03-13 12:24:14,725 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:14
2025-03-13 12:24:14,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:24:14,726 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:14
2025-03-13 12:24:14,726 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:24:14,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.68it/s] 20%|██        | 3/15 [00:00<00:01, 10.84it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.37it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.73it/s] 60%|██████    | 9/15 [00:00<00:00, 13.03it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.98it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.55it/s]100%|██████████| 15/15 [00:03<00:00,  2.22it/s]100%|██████████| 15/15 [00:03<00:00,  4.26it/s]
2025-03-13 12:24:18,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:18
2025-03-13 12:25:00,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4476 secs
2025-03-13 12:25:00,696 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 12:25:00,697 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 12:25:17,857 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1600 secs
2025-03-13 12:25:17,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1340 secs
2025-03-13 12:25:17,860 [INFO]: {
2025-03-13 12:25:17,860 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:17,860 [INFO]: 	index_param: efSearch=291
2025-03-13 12:25:17,860 [INFO]: 	index_path: knn.index
2025-03-13 12:25:17,860 [INFO]: 	size in bytes: 701588530
2025-03-13 12:25:17,860 [INFO]: 	avg_search_speed_ms: 10.447857893911914
2025-03-13 12:25:17,860 [INFO]: 	99p_search_speed_ms: 18.568194201216095
2025-03-13 12:25:17,860 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:17,860 [INFO]: 	nb vectors: 3566
2025-03-13 12:25:17,860 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:17,860 [INFO]: 	compression ratio: 0.9993095639690689
2025-03-13 12:25:17,860 [INFO]: }
2025-03-13 12:25:17,860 [INFO]: 	>>> Finished "Creating the index" in 63.1353 secs
2025-03-13 12:25:17,860 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1585 secs
2025-03-13 12:25:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 61726 [episode count 11/20]
[retrieval_preprocessing] for episode 5663 [episode count 12/20], we have num_retrieval=np.int64(3650) num_query=np.int64(160)
2025-03-13 12:25:21,575 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:23,057 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:23
2025-03-13 12:25:23,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1608.86it/s]
2025-03-13 12:25:23,079 [INFO]: There are 3650 embeddings of dim 49152
2025-03-13 12:25:23,080 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 12:25:23,080 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:23
2025-03-13 12:25:23,080 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:23,080 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:25:23,080 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:23,080 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:23,080 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:23
2025-03-13 12:25:23,080 [INFO]: 753.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:23,080 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:25:23,080 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:23
2025-03-13 12:25:23,080 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:23,080 [INFO]: 	Creating the index 03/13/2025, 12:25:23
2025-03-13 12:25:23,080 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:23
2025-03-13 12:25:23,081 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:25:23,081 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:23
2025-03-13 12:25:23,081 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:25:23,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.54it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.92it/s] 20%|██        | 3/15 [00:00<00:01,  6.51it/s] 27%|██▋       | 4/15 [00:00<00:01,  6.92it/s] 33%|███▎      | 5/15 [00:00<00:01,  6.97it/s] 40%|████      | 6/15 [00:00<00:01,  7.04it/s] 47%|████▋     | 7/15 [00:01<00:01,  7.06it/s] 53%|█████▎    | 8/15 [00:01<00:00,  7.14it/s] 60%|██████    | 9/15 [00:01<00:00,  7.23it/s] 67%|██████▋   | 10/15 [00:01<00:00,  7.25it/s] 73%|███████▎  | 11/15 [00:01<00:00,  7.26it/s] 80%|████████  | 12/15 [00:01<00:00,  7.25it/s] 87%|████████▋ | 13/15 [00:01<00:00,  7.25it/s] 93%|█████████▎| 14/15 [00:01<00:00,  7.39it/s]100%|██████████| 15/15 [00:04<00:00,  1.16it/s]100%|██████████| 15/15 [00:04<00:00,  3.30it/s]
2025-03-13 12:25:27,623 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:27
2025-03-13 12:26:16,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3838 secs
2025-03-13 12:26:16,007 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 12:26:16,008 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-13 12:26:34,209 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2017 secs
2025-03-13 12:26:34,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1310 secs
2025-03-13 12:26:34,212 [INFO]: {
2025-03-13 12:26:34,212 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:34,212 [INFO]: 	index_param: efSearch=219
2025-03-13 12:26:34,212 [INFO]: 	index_path: knn.index
2025-03-13 12:26:34,212 [INFO]: 	size in bytes: 718115230
2025-03-13 12:26:34,212 [INFO]: 	avg_search_speed_ms: 7.919518488311073
2025-03-13 12:26:34,212 [INFO]: 	99p_search_speed_ms: 11.026431773789225
2025-03-13 12:26:34,212 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:34,212 [INFO]: 	nb vectors: 3650
2025-03-13 12:26:34,212 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:34,212 [INFO]: 	compression ratio: 0.9993092612727348
2025-03-13 12:26:34,212 [INFO]: }
2025-03-13 12:26:34,212 [INFO]: 	>>> Finished "Creating the index" in 71.1322 secs
2025-03-13 12:26:34,212 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1549 secs
2025-03-13 12:26:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 5663 [episode count 12/20]
[retrieval_preprocessing] for episode 40607 [episode count 13/20], we have num_retrieval=np.int64(3645) num_query=np.int64(165)
2025-03-13 12:26:37,324 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:38,002 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:38
2025-03-13 12:26:38,002 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-13 12:26:38,028 [INFO]: There are 3645 embeddings of dim 49152
2025-03-13 12:26:38,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 12:26:38,028 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:38
2025-03-13 12:26:38,028 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:38,028 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:26:38,028 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:38,028 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:38,028 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:38
2025-03-13 12:26:38,028 [INFO]: 752.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:38,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:26:38,029 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:38
2025-03-13 12:26:38,029 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:38,029 [INFO]: 	Creating the index 03/13/2025, 12:26:38
2025-03-13 12:26:38,029 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:38
2025-03-13 12:26:38,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:26:38,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:38
2025-03-13 12:26:38,030 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:26:38,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.83it/s] 20%|██        | 3/15 [00:00<00:01,  8.87it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.82it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.14it/s] 60%|██████    | 9/15 [00:00<00:00, 10.36it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.43it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.24it/s]100%|██████████| 15/15 [00:03<00:00,  2.14it/s]100%|██████████| 15/15 [00:03<00:00,  3.96it/s]
2025-03-13 12:26:41,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:41
2025-03-13 12:27:20,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2446 secs
2025-03-13 12:27:20,066 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 12:27:20,066 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 12:27:45,349 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2834 secs
2025-03-13 12:27:45,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3225 secs
2025-03-13 12:27:45,353 [INFO]: {
2025-03-13 12:27:45,353 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:45,353 [INFO]: 	index_param: efSearch=297
2025-03-13 12:27:45,353 [INFO]: 	index_path: knn.index
2025-03-13 12:27:45,353 [INFO]: 	size in bytes: 717131530
2025-03-13 12:27:45,353 [INFO]: 	avg_search_speed_ms: 9.761258302392756
2025-03-13 12:27:45,353 [INFO]: 	99p_search_speed_ms: 13.26724580489099
2025-03-13 12:27:45,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:45,353 [INFO]: 	nb vectors: 3645
2025-03-13 12:27:45,353 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:45,353 [INFO]: 	compression ratio: 0.9993092341093969
2025-03-13 12:27:45,353 [INFO]: }
2025-03-13 12:27:45,353 [INFO]: 	>>> Finished "Creating the index" in 67.3241 secs
2025-03-13 12:27:45,353 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3505 secs
2025-03-13 12:27:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 40607 [episode count 13/20]
[retrieval_preprocessing] for episode 75432 [episode count 14/20], we have num_retrieval=np.int64(3590) num_query=np.int64(220)
2025-03-13 12:27:48,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:48,990 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:48
2025-03-13 12:27:48,990 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2234.58it/s]
2025-03-13 12:27:49,013 [INFO]: There are 3590 embeddings of dim 49152
2025-03-13 12:27:49,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 12:27:49,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:49
2025-03-13 12:27:49,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:49,015 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:27:49,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:49,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:27:49,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:49
2025-03-13 12:27:49,015 [INFO]: 740.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:49,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:27:49,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:49
2025-03-13 12:27:49,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:49,016 [INFO]: 	Creating the index 03/13/2025, 12:27:49
2025-03-13 12:27:49,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:49
2025-03-13 12:27:49,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:27:49,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:49
2025-03-13 12:27:49,020 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:27:49,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:04,  2.82it/s] 20%|██        | 3/15 [00:00<00:01,  6.62it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.64it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.92it/s] 60%|██████    | 9/15 [00:01<00:00, 10.67it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.09it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.17it/s]100%|██████████| 15/15 [00:03<00:00,  2.34it/s]100%|██████████| 15/15 [00:03<00:00,  4.14it/s]
2025-03-13 12:27:52,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:52
2025-03-13 12:28:28,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7153 secs
2025-03-13 12:28:28,568 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 12:28:28,568 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 12:28:51,715 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1471 secs
2025-03-13 12:28:51,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6977 secs
2025-03-13 12:28:51,717 [INFO]: {
2025-03-13 12:28:51,718 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:51,718 [INFO]: 	index_param: efSearch=291
2025-03-13 12:28:51,718 [INFO]: 	index_path: knn.index
2025-03-13 12:28:51,718 [INFO]: 	size in bytes: 706310350
2025-03-13 12:28:51,718 [INFO]: 	avg_search_speed_ms: 10.000940463272855
2025-03-13 12:28:51,718 [INFO]: 	99p_search_speed_ms: 16.140551276039332
2025-03-13 12:28:51,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:51,718 [INFO]: 	nb vectors: 3590
2025-03-13 12:28:51,718 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:51,718 [INFO]: 	compression ratio: 0.9993096094372679
2025-03-13 12:28:51,718 [INFO]: }
2025-03-13 12:28:51,718 [INFO]: 	>>> Finished "Creating the index" in 62.7016 secs
2025-03-13 12:28:51,718 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7281 secs
2025-03-13 12:28:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 75432 [episode count 14/20]
[retrieval_preprocessing] for episode 63999 [episode count 15/20], we have num_retrieval=np.int64(3654) num_query=np.int64(156)
2025-03-13 12:28:54,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:55,398 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:55
2025-03-13 12:28:55,398 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1773.49it/s]
2025-03-13 12:28:55,419 [INFO]: There are 3654 embeddings of dim 49152
2025-03-13 12:28:55,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0215 secs
2025-03-13 12:28:55,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:55
2025-03-13 12:28:55,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:55,419 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:28:55,419 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:55,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:55,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:55
2025-03-13 12:28:55,420 [INFO]: 754.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:55,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:28:55,420 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:55
2025-03-13 12:28:55,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:55,420 [INFO]: 	Creating the index 03/13/2025, 12:28:55
2025-03-13 12:28:55,420 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:55
2025-03-13 12:28:55,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:28:55,421 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:55
2025-03-13 12:28:55,421 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:28:55,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.02it/s] 20%|██        | 3/15 [00:00<00:01,  9.12it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.96it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.61it/s] 60%|██████    | 9/15 [00:00<00:00, 11.95it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.79it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.30it/s]100%|██████████| 15/15 [00:03<00:00,  2.29it/s]100%|██████████| 15/15 [00:03<00:00,  4.28it/s]
2025-03-13 12:28:58,925 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:58
2025-03-13 12:29:32,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0024 secs
2025-03-13 12:29:32,928 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 12:29:32,928 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 12:29:48,976 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0482 secs
2025-03-13 12:29:48,979 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5581 secs
2025-03-13 12:29:48,979 [INFO]: {
2025-03-13 12:29:48,979 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:48,979 [INFO]: 	index_param: efSearch=289
2025-03-13 12:29:48,979 [INFO]: 	index_path: knn.index
2025-03-13 12:29:48,979 [INFO]: 	size in bytes: 718902250
2025-03-13 12:29:48,979 [INFO]: 	avg_search_speed_ms: 10.407437337562442
2025-03-13 12:29:48,979 [INFO]: 	99p_search_speed_ms: 13.84937185794115
2025-03-13 12:29:48,979 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:48,979 [INFO]: 	nb vectors: 3654
2025-03-13 12:29:48,979 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:48,979 [INFO]: 	compression ratio: 0.9993091995469482
2025-03-13 12:29:48,979 [INFO]: }
2025-03-13 12:29:48,979 [INFO]: 	>>> Finished "Creating the index" in 53.5595 secs
2025-03-13 12:29:48,979 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5815 secs
2025-03-13 12:29:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 63999 [episode count 15/20]
[retrieval_preprocessing] for episode 82613 [episode count 16/20], we have num_retrieval=np.int64(3653) num_query=np.int64(157)
2025-03-13 12:29:52,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:52,940 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:52
2025-03-13 12:29:52,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1098.56it/s]
2025-03-13 12:29:52,966 [INFO]: There are 3653 embeddings of dim 49152
2025-03-13 12:29:52,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:29:52,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:52
2025-03-13 12:29:52,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:52,966 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:29:52,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:52,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:29:52,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:52
2025-03-13 12:29:52,967 [INFO]: 753.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:52,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:29:52,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:52
2025-03-13 12:29:52,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:52,967 [INFO]: 	Creating the index 03/13/2025, 12:29:52
2025-03-13 12:29:52,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:52
2025-03-13 12:29:52,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:29:52,968 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:52
2025-03-13 12:29:52,968 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:29:52,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.78it/s] 20%|██        | 3/15 [00:00<00:01,  8.75it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.65it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.87it/s] 60%|██████    | 9/15 [00:00<00:00, 10.14it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.34it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.46it/s]100%|██████████| 15/15 [00:03<00:00,  2.01it/s]100%|██████████| 15/15 [00:03<00:00,  3.75it/s]
2025-03-13 12:29:56,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:56
2025-03-13 12:30:39,645 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6773 secs
2025-03-13 12:30:39,645 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 12:30:39,645 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 12:30:57,285 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6396 secs
2025-03-13 12:30:57,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3195 secs
2025-03-13 12:30:57,288 [INFO]: {
2025-03-13 12:30:57,288 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:57,288 [INFO]: 	index_param: efSearch=259
2025-03-13 12:30:57,288 [INFO]: 	index_path: knn.index
2025-03-13 12:30:57,288 [INFO]: 	size in bytes: 718705510
2025-03-13 12:30:57,288 [INFO]: 	avg_search_speed_ms: 9.517814927724688
2025-03-13 12:30:57,288 [INFO]: 	99p_search_speed_ms: 15.426859492436051
2025-03-13 12:30:57,288 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:57,288 [INFO]: 	nb vectors: 3653
2025-03-13 12:30:57,288 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:57,288 [INFO]: 	compression ratio: 0.9993091941092813
2025-03-13 12:30:57,288 [INFO]: }
2025-03-13 12:30:57,288 [INFO]: 	>>> Finished "Creating the index" in 64.3212 secs
2025-03-13 12:30:57,288 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3486 secs
2025-03-13 12:30:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 82613 [episode count 16/20]
[retrieval_preprocessing] for episode 36980 [episode count 17/20], we have num_retrieval=np.int64(3616) num_query=np.int64(194)
2025-03-13 12:31:00,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:00,838 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:00
2025-03-13 12:31:00,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.00it/s]
2025-03-13 12:31:00,864 [INFO]: There are 3616 embeddings of dim 49152
2025-03-13 12:31:00,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:31:00,865 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:00
2025-03-13 12:31:00,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:00,865 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:31:00,865 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:00,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:31:00,865 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:00
2025-03-13 12:31:00,865 [INFO]: 746.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:00,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:31:00,865 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:00
2025-03-13 12:31:00,865 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:00,865 [INFO]: 	Creating the index 03/13/2025, 12:31:00
2025-03-13 12:31:00,865 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:00
2025-03-13 12:31:00,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:31:00,867 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:00
2025-03-13 12:31:00,867 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:31:00,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.32it/s] 20%|██        | 3/15 [00:00<00:01,  8.35it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.47it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.95it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.70it/s] 60%|██████    | 9/15 [00:00<00:00,  9.47it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.40it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.29it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.67it/s]100%|██████████| 15/15 [00:04<00:00,  1.65it/s]100%|██████████| 15/15 [00:04<00:00,  3.56it/s]
2025-03-13 12:31:05,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:05
2025-03-13 12:31:43,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2055 secs
2025-03-13 12:31:43,291 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 12:31:43,291 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  5.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.00it/s]
2025-03-13 12:32:01,083 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7920 secs
2025-03-13 12:32:01,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2192 secs
2025-03-13 12:32:01,086 [INFO]: {
2025-03-13 12:32:01,086 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:01,086 [INFO]: 	index_param: efSearch=273
2025-03-13 12:32:01,086 [INFO]: 	index_path: knn.index
2025-03-13 12:32:01,086 [INFO]: 	size in bytes: 711425770
2025-03-13 12:32:01,086 [INFO]: 	avg_search_speed_ms: 9.978104916962604
2025-03-13 12:32:01,086 [INFO]: 	99p_search_speed_ms: 15.809280038811272
2025-03-13 12:32:01,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:01,086 [INFO]: 	nb vectors: 3616
2025-03-13 12:32:01,086 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:01,086 [INFO]: 	compression ratio: 0.9993094964777562
2025-03-13 12:32:01,086 [INFO]: }
2025-03-13 12:32:01,086 [INFO]: 	>>> Finished "Creating the index" in 60.2208 secs
2025-03-13 12:32:01,086 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2481 secs
2025-03-13 12:32:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 36980 [episode count 17/20]
[retrieval_preprocessing] for episode 968 [episode count 18/20], we have num_retrieval=np.int64(3640) num_query=np.int64(170)
2025-03-13 12:32:04,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:04,632 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:04
2025-03-13 12:32:04,632 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.23it/s]
2025-03-13 12:32:04,658 [INFO]: There are 3640 embeddings of dim 49152
2025-03-13 12:32:04,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 12:32:04,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:04
2025-03-13 12:32:04,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:04,659 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:32:04,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:04,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:32:04,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:04
2025-03-13 12:32:04,659 [INFO]: 751.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:04,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:04,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:04
2025-03-13 12:32:04,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:04,659 [INFO]: 	Creating the index 03/13/2025, 12:32:04
2025-03-13 12:32:04,659 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:04
2025-03-13 12:32:04,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:32:04,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:04
2025-03-13 12:32:04,660 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:32:04,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.25it/s] 20%|██        | 3/15 [00:00<00:01, 10.28it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.43it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.88it/s] 60%|██████    | 9/15 [00:00<00:00, 11.89it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.68it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.24it/s]100%|██████████| 15/15 [00:03<00:00,  2.16it/s]100%|██████████| 15/15 [00:03<00:00,  4.10it/s]
2025-03-13 12:32:08,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:08
2025-03-13 12:32:44,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0849 secs
2025-03-13 12:32:44,405 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 12:32:44,406 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.41it/s] 50%|█████     | 2/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.80it/s]
2025-03-13 12:33:05,359 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9531 secs
2025-03-13 12:33:05,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7022 secs
2025-03-13 12:33:05,363 [INFO]: {
2025-03-13 12:33:05,363 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:05,363 [INFO]: 	index_param: efSearch=315
2025-03-13 12:33:05,363 [INFO]: 	index_path: knn.index
2025-03-13 12:33:05,363 [INFO]: 	size in bytes: 716147830
2025-03-13 12:33:05,363 [INFO]: 	avg_search_speed_ms: 10.815323948155385
2025-03-13 12:33:05,363 [INFO]: 	99p_search_speed_ms: 15.161073626950383
2025-03-13 12:33:05,363 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:05,363 [INFO]: 	nb vectors: 3640
2025-03-13 12:33:05,363 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:05,363 [INFO]: 	compression ratio: 0.999309206871436
2025-03-13 12:33:05,363 [INFO]: }
2025-03-13 12:33:05,363 [INFO]: 	>>> Finished "Creating the index" in 60.7036 secs
2025-03-13 12:33:05,363 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7307 secs
2025-03-13 12:33:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 968 [episode count 18/20]
[retrieval_preprocessing] for episode 4940 [episode count 19/20], we have num_retrieval=np.int64(3620) num_query=np.int64(190)
2025-03-13 12:33:08,338 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:09,601 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:09
2025-03-13 12:33:09,601 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2245.34it/s]
2025-03-13 12:33:09,623 [INFO]: There are 3620 embeddings of dim 49152
2025-03-13 12:33:09,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-13 12:33:09,623 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:09,623 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 12:33:09,623 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:09,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:33:09,623 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,623 [INFO]: 747.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:09,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:33:09,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:09
2025-03-13 12:33:09,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:09,623 [INFO]: 	Creating the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:09
2025-03-13 12:33:09,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:33:09,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,624 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:33:09,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:04,  3.18it/s] 13%|█▎        | 2/15 [00:00<00:02,  4.80it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.57it/s] 40%|████      | 6/15 [00:00<00:00,  9.61it/s] 53%|█████▎    | 8/15 [00:00<00:00, 10.93it/s] 67%|██████▋   | 10/15 [00:01<00:00, 11.68it/s] 80%|████████  | 12/15 [00:01<00:00, 12.08it/s] 93%|█████████▎| 14/15 [00:01<00:00, 10.08it/s]100%|██████████| 15/15 [00:03<00:00,  3.85it/s]
2025-03-13 12:33:13,524 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:13
2025-03-13 12:34:00,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9802 secs
2025-03-13 12:34:00,505 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 12:34:00,505 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 12:34:17,062 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5569 secs
2025-03-13 12:34:17,065 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4407 secs
2025-03-13 12:34:17,065 [INFO]: {
2025-03-13 12:34:17,065 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:17,065 [INFO]: 	index_param: efSearch=199
2025-03-13 12:34:17,065 [INFO]: 	index_path: knn.index
2025-03-13 12:34:17,065 [INFO]: 	size in bytes: 712212790
2025-03-13 12:34:17,065 [INFO]: 	avg_search_speed_ms: 9.662944403733464
2025-03-13 12:34:17,065 [INFO]: 	99p_search_speed_ms: 17.085961950942863
2025-03-13 12:34:17,065 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:17,065 [INFO]: 	nb vectors: 3620
2025-03-13 12:34:17,066 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:17,066 [INFO]: 	compression ratio: 0.9993094339123003
2025-03-13 12:34:17,066 [INFO]: }
2025-03-13 12:34:17,066 [INFO]: 	>>> Finished "Creating the index" in 67.4421 secs
2025-03-13 12:34:17,066 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4642 secs
2025-03-13 12:34:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 4940 [episode count 19/20]
2025-03-13 12:34:18: [retrieval_preprocessing] finished for 7802759726_top_right_button [chosen_id count 4/260]
2025-03-13 12:34:27: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7844349127_box_to_backrest [chosen_id count 5/260]
2025-03-13 12:34:27: [retrieval_preprocessing] we have num_total=10673 embedding_dim=49152
[retrieval_preprocessing] for episode 63360 [episode count 0/20], we have num_retrieval=np.int64(10385) num_query=np.int64(288)
2025-03-13 12:34:30,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:32,639 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:32
2025-03-13 12:34:32,639 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.53it/s]
2025-03-13 12:34:32,667 [INFO]: There are 10385 embeddings of dim 49152
2025-03-13 12:34:32,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:34:32,667 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:32
2025-03-13 12:34:32,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:32,667 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 12:34:32,667 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:34:32,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:32,667 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:32
2025-03-13 12:34:32,667 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:32,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:34:32,668 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:32
2025-03-13 12:34:32,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:32,668 [INFO]: 	Creating the index 03/13/2025, 12:34:32
2025-03-13 12:34:32,668 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:34:32
2025-03-13 12:34:32,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 12:34:32,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:32
2025-03-13 12:34:32,669 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:34:32,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.75it/s]  9%|▉         | 4/43 [00:00<00:02, 14.75it/s] 16%|█▋        | 7/43 [00:00<00:01, 18.57it/s] 23%|██▎       | 10/43 [00:00<00:01, 20.94it/s] 30%|███       | 13/43 [00:00<00:01, 20.83it/s] 37%|███▋      | 16/43 [00:00<00:01, 22.21it/s] 44%|████▍     | 19/43 [00:00<00:01, 21.96it/s] 51%|█████     | 22/43 [00:08<00:16,  1.25it/s] 56%|█████▌    | 24/43 [00:08<00:12,  1.57it/s] 60%|██████    | 26/43 [00:08<00:08,  1.96it/s] 65%|██████▌   | 28/43 [00:08<00:05,  2.55it/s] 70%|██████▉   | 30/43 [00:08<00:03,  3.32it/s] 74%|███████▍  | 32/43 [00:08<00:02,  4.28it/s] 79%|███████▉  | 34/43 [00:09<00:01,  5.33it/s] 84%|████████▎ | 36/43 [00:09<00:01,  6.76it/s] 91%|█████████ | 39/43 [00:09<00:00,  9.17it/s] 95%|█████████▌| 41/43 [00:09<00:00, 10.61it/s]100%|██████████| 43/43 [00:20<00:00,  1.59s/it]100%|██████████| 43/43 [00:20<00:00,  2.10it/s]
2025-03-13 12:34:53,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:53
2025-03-13 12:36:09,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.0639 secs
2025-03-13 12:36:09,222 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 12:36:09,222 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-13 12:36:34,273 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0505 secs
2025-03-13 12:36:34,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.6041 secs
2025-03-13 12:36:34,273 [INFO]: {
2025-03-13 12:36:34,273 [INFO]: 	index_key: HNSW32
2025-03-13 12:36:34,273 [INFO]: 	index_param: efSearch=91
2025-03-13 12:36:34,273 [INFO]: 	index_path: knn.index
2025-03-13 12:36:34,273 [INFO]: 	size in bytes: 2044596782
2025-03-13 12:36:34,273 [INFO]: 	avg_search_speed_ms: 9.448627170416508
2025-03-13 12:36:34,273 [INFO]: 	99p_search_speed_ms: 18.778315570671133
2025-03-13 12:36:34,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:34,273 [INFO]: 	nb vectors: 10385
2025-03-13 12:36:34,273 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:34,273 [INFO]: 	compression ratio: 0.9986194334135463
2025-03-13 12:36:34,273 [INFO]: }
2025-03-13 12:36:34,273 [INFO]: 	>>> Finished "Creating the index" in 121.6057 secs
2025-03-13 12:36:34,274 [INFO]: >>> Finished "Launching the whole pipeline" in 121.6348 secs
2025-03-13 12:36:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 63360 [episode count 0/20]
[retrieval_preprocessing] for episode 46209 [episode count 1/20], we have num_retrieval=np.int64(10248) num_query=np.int64(425)
2025-03-13 12:36:41,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:42,782 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:42
2025-03-13 12:36:42,783 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.04it/s]
2025-03-13 12:36:42,810 [INFO]: There are 10248 embeddings of dim 49152
2025-03-13 12:36:42,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 12:36:42,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:42
2025-03-13 12:36:42,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:42,811 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:36:42,811 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:36:42,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:36:42,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:42
2025-03-13 12:36:42,812 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:42,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:36:42,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:42
2025-03-13 12:36:42,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:36:42,813 [INFO]: 	Creating the index 03/13/2025, 12:36:42
2025-03-13 12:36:42,813 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:36:42
2025-03-13 12:36:42,816 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 12:36:42,816 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:42
2025-03-13 12:36:42,816 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:36:42,816 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.94it/s]  7%|▋         | 3/43 [00:00<00:03, 10.02it/s] 12%|█▏        | 5/43 [00:00<00:03, 11.66it/s] 16%|█▋        | 7/43 [00:00<00:05,  6.88it/s] 19%|█▊        | 8/43 [00:01<00:05,  6.28it/s] 21%|██        | 9/43 [00:01<00:05,  5.81it/s] 23%|██▎       | 10/43 [00:01<00:05,  5.96it/s] 26%|██▌       | 11/43 [00:01<00:05,  5.69it/s] 28%|██▊       | 12/43 [00:01<00:05,  5.73it/s] 30%|███       | 13/43 [00:02<00:05,  5.83it/s] 33%|███▎      | 14/43 [00:02<00:04,  6.22it/s] 35%|███▍      | 15/43 [00:02<00:04,  6.57it/s] 37%|███▋      | 16/43 [00:02<00:05,  5.38it/s] 40%|███▉      | 17/43 [00:02<00:05,  4.98it/s] 44%|████▍     | 19/43 [00:02<00:03,  7.00it/s] 47%|████▋     | 20/43 [00:03<00:03,  7.29it/s] 49%|████▉     | 21/43 [00:09<00:36,  1.65s/it] 51%|█████     | 22/43 [00:09<00:25,  1.23s/it] 56%|█████▌    | 24/43 [00:09<00:13,  1.37it/s] 60%|██████    | 26/43 [00:09<00:08,  2.06it/s] 65%|██████▌   | 28/43 [00:09<00:05,  2.89it/s] 70%|██████▉   | 30/43 [00:09<00:03,  3.93it/s] 74%|███████▍  | 32/43 [00:09<00:02,  5.18it/s] 79%|███████▉  | 34/43 [00:10<00:01,  6.19it/s] 84%|████████▎ | 36/43 [00:10<00:01,  6.54it/s] 88%|████████▊ | 38/43 [00:10<00:00,  7.74it/s] 93%|█████████▎| 40/43 [00:10<00:00,  8.42it/s] 98%|█████████▊| 42/43 [00:18<00:01,  1.21s/it]100%|██████████| 43/43 [00:20<00:00,  1.34s/it]100%|██████████| 43/43 [00:20<00:00,  2.14it/s]
2025-03-13 12:37:02,929 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:02
2025-03-13 12:38:26,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.7392 secs
2025-03-13 12:38:26,669 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 12:38:26,669 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 12:39:03,352 [INFO]: 	>>> Finished "Compute fast metrics" in 36.6833 secs
2025-03-13 12:39:03,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.5363 secs
2025-03-13 12:39:03,352 [INFO]: {
2025-03-13 12:39:03,352 [INFO]: 	index_key: HNSW32
2025-03-13 12:39:03,352 [INFO]: 	index_param: efSearch=139
2025-03-13 12:39:03,352 [INFO]: 	index_path: knn.index
2025-03-13 12:39:03,353 [INFO]: 	size in bytes: 2017624130
2025-03-13 12:39:03,353 [INFO]: 	avg_search_speed_ms: 11.349000896154887
2025-03-13 12:39:03,353 [INFO]: 	99p_search_speed_ms: 24.726154422387484
2025-03-13 12:39:03,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:03,353 [INFO]: 	nb vectors: 10248
2025-03-13 12:39:03,353 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:03,353 [INFO]: 	compression ratio: 0.9986194921251264
2025-03-13 12:39:03,353 [INFO]: }
2025-03-13 12:39:03,353 [INFO]: 	>>> Finished "Creating the index" in 140.5399 secs
2025-03-13 12:39:03,353 [INFO]: >>> Finished "Launching the whole pipeline" in 140.5701 secs
2025-03-13 12:39:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 46209 [episode count 1/20]
[retrieval_preprocessing] for episode 58370 [episode count 2/20], we have num_retrieval=np.int64(10215) num_query=np.int64(458)
2025-03-13 12:39:10,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:12,327 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:12
2025-03-13 12:39:12,327 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.64it/s]
2025-03-13 12:39:12,357 [INFO]: There are 10215 embeddings of dim 49152
2025-03-13 12:39:12,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 12:39:12,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:12
2025-03-13 12:39:12,358 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:12,359 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:39:12,359 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:39:12,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:39:12,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:12
2025-03-13 12:39:12,360 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:12,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:39:12,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:12
2025-03-13 12:39:12,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:39:12,361 [INFO]: 	Creating the index 03/13/2025, 12:39:12
2025-03-13 12:39:12,361 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:39:12
2025-03-13 12:39:12,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0033 secs
2025-03-13 12:39:12,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:12
2025-03-13 12:39:12,365 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:39:12,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:08,  4.86it/s]  7%|▋         | 3/43 [00:00<00:04,  9.23it/s] 12%|█▏        | 5/43 [00:00<00:03, 11.34it/s] 16%|█▋        | 7/43 [00:00<00:02, 12.27it/s] 21%|██        | 9/43 [00:00<00:02, 12.76it/s] 26%|██▌       | 11/43 [00:00<00:02, 13.28it/s] 30%|███       | 13/43 [00:01<00:02, 13.55it/s] 35%|███▍      | 15/43 [00:01<00:01, 14.35it/s] 40%|███▉      | 17/43 [00:01<00:01, 15.10it/s] 44%|████▍     | 19/43 [00:01<00:01, 15.88it/s] 49%|████▉     | 21/43 [00:08<00:23,  1.08s/it] 53%|█████▎    | 23/43 [00:08<00:15,  1.29it/s] 58%|█████▊    | 25/43 [00:08<00:10,  1.77it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.40it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.17it/s] 72%|███████▏  | 31/43 [00:08<00:02,  4.04it/s] 77%|███████▋  | 33/43 [00:09<00:02,  4.99it/s] 81%|████████▏ | 35/43 [00:09<00:01,  5.98it/s] 86%|████████▌ | 37/43 [00:09<00:00,  6.91it/s] 91%|█████████ | 39/43 [00:09<00:00,  7.73it/s] 95%|█████████▌| 41/43 [00:09<00:00,  8.51it/s]100%|██████████| 43/43 [00:19<00:00,  1.49s/it]100%|██████████| 43/43 [00:19<00:00,  2.23it/s]
2025-03-13 12:39:31,665 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:31
2025-03-13 12:40:43,206 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.5402 secs
2025-03-13 12:40:43,206 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 12:40:43,206 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.78it/s]
2025-03-13 12:41:13,725 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5188 secs
2025-03-13 12:41:13,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.3611 secs
2025-03-13 12:41:13,726 [INFO]: {
2025-03-13 12:41:13,726 [INFO]: 	index_key: HNSW32
2025-03-13 12:41:13,726 [INFO]: 	index_param: efSearch=126
2025-03-13 12:41:13,726 [INFO]: 	index_path: knn.index
2025-03-13 12:41:13,726 [INFO]: 	size in bytes: 2011127094
2025-03-13 12:41:13,726 [INFO]: 	avg_search_speed_ms: 14.010099772395206
2025-03-13 12:41:13,726 [INFO]: 	99p_search_speed_ms: 29.416899960488088
2025-03-13 12:41:13,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:13,726 [INFO]: 	nb vectors: 10215
2025-03-13 12:41:13,726 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:13,726 [INFO]: 	compression ratio: 0.9986194935127257
2025-03-13 12:41:13,726 [INFO]: }
2025-03-13 12:41:13,726 [INFO]: 	>>> Finished "Creating the index" in 121.3654 secs
2025-03-13 12:41:13,726 [INFO]: >>> Finished "Launching the whole pipeline" in 121.3987 secs
2025-03-13 12:41:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 58370 [episode count 2/20]
[retrieval_preprocessing] for episode 20995 [episode count 3/20], we have num_retrieval=np.int64(10161) num_query=np.int64(512)
2025-03-13 12:41:35,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:41:37,179 [INFO]: Launching the whole pipeline 03/13/2025, 12:41:37
2025-03-13 12:41:37,179 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:41:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.76it/s]
2025-03-13 12:41:37,205 [INFO]: There are 10161 embeddings of dim 49152
2025-03-13 12:41:37,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:41:37,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:41:37
2025-03-13 12:41:37,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:41:37,206 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:41:37,206 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:41:37,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:41:37,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:41:37
2025-03-13 12:41:37,206 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:41:37,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:41:37,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:41:37
2025-03-13 12:41:37,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:41:37,206 [INFO]: 	Creating the index 03/13/2025, 12:41:37
2025-03-13 12:41:37,206 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:41:37
2025-03-13 12:41:37,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 12:41:37,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:41:37
2025-03-13 12:41:37,208 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:41:37,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:09,  4.07it/s]  5%|▍         | 2/41 [00:00<00:07,  5.54it/s]  7%|▋         | 3/41 [00:00<00:06,  6.29it/s] 10%|▉         | 4/41 [00:00<00:05,  6.62it/s] 12%|█▏        | 5/41 [00:00<00:05,  6.63it/s] 15%|█▍        | 6/41 [00:01<00:05,  5.86it/s] 20%|█▉        | 8/41 [00:01<00:04,  7.70it/s] 22%|██▏       | 9/41 [00:01<00:03,  8.14it/s] 24%|██▍       | 10/41 [00:01<00:03,  7.97it/s] 27%|██▋       | 11/41 [00:01<00:03,  7.86it/s] 29%|██▉       | 12/41 [00:01<00:03,  7.77it/s] 32%|███▏      | 13/41 [00:01<00:03,  7.68it/s] 34%|███▍      | 14/41 [00:01<00:03,  7.64it/s] 37%|███▋      | 15/41 [00:02<00:03,  7.63it/s] 39%|███▉      | 16/41 [00:02<00:03,  7.60it/s] 41%|████▏     | 17/41 [00:02<00:03,  7.75it/s] 44%|████▍     | 18/41 [00:02<00:02,  7.83it/s] 46%|████▋     | 19/41 [00:02<00:02,  8.02it/s] 51%|█████     | 21/41 [00:08<00:30,  1.54s/it] 54%|█████▎    | 22/41 [00:09<00:25,  1.32s/it] 59%|█████▊    | 24/41 [00:09<00:13,  1.22it/s] 61%|██████    | 25/41 [00:09<00:10,  1.53it/s] 63%|██████▎   | 26/41 [00:10<00:07,  1.92it/s] 66%|██████▌   | 27/41 [00:10<00:05,  2.42it/s] 68%|██████▊   | 28/41 [00:10<00:04,  3.04it/s] 73%|███████▎  | 30/41 [00:10<00:02,  4.34it/s] 76%|███████▌  | 31/41 [00:10<00:02,  4.96it/s] 78%|███████▊  | 32/41 [00:10<00:01,  5.63it/s] 83%|████████▎ | 34/41 [00:10<00:00,  7.54it/s] 88%|████████▊ | 36/41 [00:11<00:00,  8.48it/s] 93%|█████████▎| 38/41 [00:11<00:00,  8.77it/s] 98%|█████████▊| 40/41 [00:11<00:00,  9.56it/s]100%|██████████| 41/41 [00:19<00:00,  2.13it/s]
2025-03-13 12:41:56,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:41:56
2025-03-13 12:43:11,054 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.6153 secs
2025-03-13 12:43:11,055 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 12:43:11,055 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.57it/s]
2025-03-13 12:43:38,642 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5872 secs
2025-03-13 12:43:38,646 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.4378 secs
2025-03-13 12:43:38,646 [INFO]: {
2025-03-13 12:43:38,646 [INFO]: 	index_key: HNSW32
2025-03-13 12:43:38,646 [INFO]: 	index_param: efSearch=139
2025-03-13 12:43:38,646 [INFO]: 	index_path: knn.index
2025-03-13 12:43:38,646 [INFO]: 	size in bytes: 2000495534
2025-03-13 12:43:38,646 [INFO]: 	avg_search_speed_ms: 14.980427138674669
2025-03-13 12:43:38,646 [INFO]: 	99p_search_speed_ms: 26.85813899850475
2025-03-13 12:43:38,646 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:38,646 [INFO]: 	nb vectors: 10161
2025-03-13 12:43:38,646 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:38,646 [INFO]: 	compression ratio: 0.9986195190376266
2025-03-13 12:43:38,646 [INFO]: }
2025-03-13 12:43:38,646 [INFO]: 	>>> Finished "Creating the index" in 121.4395 secs
2025-03-13 12:43:38,646 [INFO]: >>> Finished "Launching the whole pipeline" in 121.4666 secs
2025-03-13 12:43:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 20995 [episode count 3/20]
[retrieval_preprocessing] for episode 74767 [episode count 4/20], we have num_retrieval=np.int64(10299) num_query=np.int64(374)
2025-03-13 12:43:45,629 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:47,373 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:47
2025-03-13 12:43:47,373 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 12:43:47,402 [INFO]: There are 10299 embeddings of dim 49152
2025-03-13 12:43:47,402 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:43:47,402 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:47
2025-03-13 12:43:47,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:47,403 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 12:43:47,403 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:43:47,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:43:47,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:47
2025-03-13 12:43:47,404 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:47,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:43:47,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:47
2025-03-13 12:43:47,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:43:47,404 [INFO]: 	Creating the index 03/13/2025, 12:43:47
2025-03-13 12:43:47,405 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:43:47
2025-03-13 12:43:47,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 12:43:47,408 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:47
2025-03-13 12:43:47,408 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:43:47,408 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:08,  4.75it/s]  7%|▋         | 3/43 [00:00<00:04,  8.86it/s] 12%|█▏        | 5/43 [00:00<00:03, 10.69it/s] 16%|█▋        | 7/43 [00:00<00:02, 12.01it/s] 21%|██        | 9/43 [00:00<00:02, 12.91it/s] 26%|██▌       | 11/43 [00:00<00:02, 13.05it/s] 30%|███       | 13/43 [00:01<00:02, 12.55it/s] 35%|███▍      | 15/43 [00:01<00:02, 13.38it/s] 40%|███▉      | 17/43 [00:01<00:01, 14.00it/s] 44%|████▍     | 19/43 [00:01<00:01, 14.44it/s] 49%|████▉     | 21/43 [00:07<00:21,  1.01it/s] 53%|█████▎    | 23/43 [00:07<00:14,  1.40it/s] 58%|█████▊    | 25/43 [00:07<00:09,  1.92it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.58it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.39it/s] 72%|███████▏  | 31/43 [00:08<00:02,  4.35it/s] 77%|███████▋  | 33/43 [00:08<00:01,  5.43it/s] 81%|████████▏ | 35/43 [00:08<00:01,  6.58it/s] 86%|████████▌ | 37/43 [00:08<00:00,  7.77it/s] 91%|█████████ | 39/43 [00:09<00:00,  8.77it/s] 95%|█████████▌| 41/43 [00:09<00:00, 10.42it/s]100%|██████████| 43/43 [00:18<00:00,  1.41s/it]100%|██████████| 43/43 [00:18<00:00,  2.38it/s]
2025-03-13 12:44:05,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:05
2025-03-13 12:45:22,318 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.8168 secs
2025-03-13 12:45:22,318 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 12:45:22,318 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 12:45:53,254 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9364 secs
2025-03-13 12:45:53,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.8466 secs
2025-03-13 12:45:53,255 [INFO]: {
2025-03-13 12:45:53,255 [INFO]: 	index_key: HNSW32
2025-03-13 12:45:53,255 [INFO]: 	index_param: efSearch=148
2025-03-13 12:45:53,255 [INFO]: 	index_path: knn.index
2025-03-13 12:45:53,255 [INFO]: 	size in bytes: 2027664934
2025-03-13 12:45:53,255 [INFO]: 	avg_search_speed_ms: 14.492404636036119
2025-03-13 12:45:53,255 [INFO]: 	99p_search_speed_ms: 24.39480782020837
2025-03-13 12:45:53,255 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:53,255 [INFO]: 	nb vectors: 10299
2025-03-13 12:45:53,255 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:53,255 [INFO]: 	compression ratio: 0.9986195243834107
2025-03-13 12:45:53,255 [INFO]: }
2025-03-13 12:45:53,255 [INFO]: 	>>> Finished "Creating the index" in 125.8505 secs
2025-03-13 12:45:53,255 [INFO]: >>> Finished "Launching the whole pipeline" in 125.8817 secs
2025-03-13 12:45:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 74767 [episode count 4/20]
[retrieval_preprocessing] for episode 1049 [episode count 5/20], we have num_retrieval=np.int64(10013) num_query=np.int64(660)
2025-03-13 12:45:59,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:00,857 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:00
2025-03-13 12:46:00,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.03it/s]
2025-03-13 12:46:00,882 [INFO]: There are 10013 embeddings of dim 49152
2025-03-13 12:46:00,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 12:46:00,882 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:00
2025-03-13 12:46:00,882 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:00,883 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 12:46:00,883 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:46:00,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:46:00,883 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:00
2025-03-13 12:46:00,883 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:00,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:46:00,884 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:00
2025-03-13 12:46:00,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:46:00,884 [INFO]: 	Creating the index 03/13/2025, 12:46:00
2025-03-13 12:46:00,884 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:46:00
2025-03-13 12:46:00,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 12:46:00,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:00
2025-03-13 12:46:00,888 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 12:46:00,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.82it/s]  7%|▋         | 3/41 [00:00<00:04,  8.57it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.94it/s] 17%|█▋        | 7/41 [00:00<00:03, 10.63it/s] 22%|██▏       | 9/41 [00:00<00:02, 11.01it/s] 27%|██▋       | 11/41 [00:01<00:02, 11.18it/s] 32%|███▏      | 13/41 [00:01<00:02, 11.11it/s] 37%|███▋      | 15/41 [00:01<00:02, 11.24it/s] 41%|████▏     | 17/41 [00:01<00:02, 11.30it/s] 46%|████▋     | 19/41 [00:01<00:01, 12.51it/s] 51%|█████     | 21/41 [00:07<00:18,  1.09it/s] 54%|█████▎    | 22/41 [00:07<00:14,  1.29it/s] 59%|█████▊    | 24/41 [00:07<00:09,  1.85it/s] 63%|██████▎   | 26/41 [00:07<00:05,  2.53it/s] 68%|██████▊   | 28/41 [00:07<00:03,  3.37it/s] 73%|███████▎  | 30/41 [00:08<00:02,  4.31it/s] 78%|███████▊  | 32/41 [00:08<00:01,  5.31it/s] 83%|████████▎ | 34/41 [00:08<00:01,  6.32it/s] 88%|████████▊ | 36/41 [00:08<00:00,  7.20it/s] 93%|█████████▎| 38/41 [00:08<00:00,  7.99it/s] 98%|█████████▊| 40/41 [00:09<00:00,  8.67it/s]100%|██████████| 41/41 [00:16<00:00,  2.52it/s]
2025-03-13 12:46:17,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:17
2025-03-13 12:47:35,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.1239 secs
2025-03-13 12:47:35,316 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 12:47:35,316 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.83it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.39it/s]
2025-03-13 12:48:24,692 [INFO]: 	>>> Finished "Compute fast metrics" in 49.3754 secs
2025-03-13 12:48:24,696 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.8088 secs
2025-03-13 12:48:24,697 [INFO]: {
2025-03-13 12:48:24,697 [INFO]: 	index_key: HNSW32
2025-03-13 12:48:24,697 [INFO]: 	index_param: efSearch=134
2025-03-13 12:48:24,697 [INFO]: 	index_path: knn.index
2025-03-13 12:48:24,697 [INFO]: 	size in bytes: 1971357246
2025-03-13 12:48:24,697 [INFO]: 	avg_search_speed_ms: 13.093836615300928
2025-03-13 12:48:24,697 [INFO]: 	99p_search_speed_ms: 21.338008856400847
2025-03-13 12:48:24,697 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:24,697 [INFO]: 	nb vectors: 10013
2025-03-13 12:48:24,697 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:24,697 [INFO]: 	compression ratio: 0.9986195591866863
2025-03-13 12:48:24,697 [INFO]: }
2025-03-13 12:48:24,697 [INFO]: 	>>> Finished "Creating the index" in 143.8125 secs
2025-03-13 12:48:24,697 [INFO]: >>> Finished "Launching the whole pipeline" in 143.8394 secs
2025-03-13 12:48:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 1049 [episode count 5/20]
[retrieval_preprocessing] for episode 2983 [episode count 6/20], we have num_retrieval=np.int64(10201) num_query=np.int64(472)
2025-03-13 12:48:34,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:36,566 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:36
2025-03-13 12:48:36,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.01it/s]
2025-03-13 12:48:36,589 [INFO]: There are 10201 embeddings of dim 49152
2025-03-13 12:48:36,589 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 12:48:36,589 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:36,590 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 12:48:36,590 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:48:36,590 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:48:36,590 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,590 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:36,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:48:36,590 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:36
2025-03-13 12:48:36,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:36,590 [INFO]: 	Creating the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,590 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:48:36
2025-03-13 12:48:36,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:48:36,591 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:36
2025-03-13 12:48:36,591 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:48:36,591 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:16,  2.56it/s]  5%|▍         | 2/43 [00:00<00:09,  4.16it/s]  7%|▋         | 3/43 [00:00<00:07,  5.59it/s]  9%|▉         | 4/43 [00:00<00:05,  6.67it/s] 14%|█▍        | 6/43 [00:00<00:03,  9.42it/s] 19%|█▊        | 8/43 [00:01<00:05,  6.84it/s] 21%|██        | 9/43 [00:02<00:17,  1.93it/s] 23%|██▎       | 10/43 [00:03<00:16,  2.03it/s] 26%|██▌       | 11/43 [00:03<00:13,  2.46it/s] 28%|██▊       | 12/43 [00:03<00:10,  2.89it/s] 33%|███▎      | 14/43 [00:03<00:06,  4.49it/s] 35%|███▍      | 15/43 [00:03<00:05,  5.17it/s] 37%|███▋      | 16/43 [00:04<00:04,  5.72it/s] 40%|███▉      | 17/43 [00:04<00:04,  5.53it/s] 42%|████▏     | 18/43 [00:04<00:04,  5.04it/s] 44%|████▍     | 19/43 [00:04<00:04,  5.80it/s] 47%|████▋     | 20/43 [00:04<00:03,  6.24it/s] 49%|████▉     | 21/43 [00:10<00:41,  1.89s/it] 51%|█████     | 22/43 [00:11<00:29,  1.39s/it] 53%|█████▎    | 23/43 [00:11<00:20,  1.02s/it] 56%|█████▌    | 24/43 [00:11<00:14,  1.33it/s] 60%|██████    | 26/43 [00:11<00:07,  2.22it/s] 63%|██████▎   | 27/43 [00:11<00:05,  2.74it/s] 67%|██████▋   | 29/43 [00:11<00:03,  3.94it/s] 70%|██████▉   | 30/43 [00:11<00:02,  4.54it/s] 72%|███████▏  | 31/43 [00:12<00:02,  5.19it/s] 74%|███████▍  | 32/43 [00:12<00:01,  5.81it/s] 77%|███████▋  | 33/43 [00:12<00:01,  6.34it/s] 79%|███████▉  | 34/43 [00:12<00:01,  6.86it/s] 81%|████████▏ | 35/43 [00:12<00:01,  7.26it/s] 84%|████████▎ | 36/43 [00:12<00:00,  7.66it/s] 86%|████████▌ | 37/43 [00:12<00:00,  7.87it/s] 88%|████████▊ | 38/43 [00:12<00:00,  8.04it/s] 91%|█████████ | 39/43 [00:12<00:00,  8.16it/s] 93%|█████████▎| 40/43 [00:13<00:00,  8.23it/s] 95%|█████████▌| 41/43 [00:13<00:00,  8.37it/s] 98%|█████████▊| 42/43 [00:21<00:02,  2.66s/it]100%|██████████| 43/43 [00:23<00:00,  2.29s/it]100%|██████████| 43/43 [00:23<00:00,  1.85it/s]
2025-03-13 12:48:59,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:59
2025-03-13 12:50:13,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.1467 secs
2025-03-13 12:50:13,027 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 12:50:13,027 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 12:50:41,443 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4150 secs
2025-03-13 12:50:41,864 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.2726 secs
2025-03-13 12:50:41,864 [INFO]: {
2025-03-13 12:50:41,864 [INFO]: 	index_key: HNSW32
2025-03-13 12:50:41,864 [INFO]: 	index_param: efSearch=170
2025-03-13 12:50:41,864 [INFO]: 	index_path: knn.index
2025-03-13 12:50:41,864 [INFO]: 	size in bytes: 2008370830
2025-03-13 12:50:41,864 [INFO]: 	avg_search_speed_ms: 16.951080329589924
2025-03-13 12:50:41,864 [INFO]: 	99p_search_speed_ms: 28.552272780798397
2025-03-13 12:50:41,865 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:41,865 [INFO]: 	nb vectors: 10201
2025-03-13 12:50:41,865 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:41,865 [INFO]: 	compression ratio: 0.9986194671030947
2025-03-13 12:50:41,865 [INFO]: }
2025-03-13 12:50:41,865 [INFO]: 	>>> Finished "Creating the index" in 125.2749 secs
2025-03-13 12:50:41,865 [INFO]: >>> Finished "Launching the whole pipeline" in 125.2988 secs
2025-03-13 12:50:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 2983 [episode count 6/20]
[retrieval_preprocessing] for episode 59574 [episode count 7/20], we have num_retrieval=np.int64(10010) num_query=np.int64(663)
2025-03-13 12:50:51,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:53,520 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:53
2025-03-13 12:50:53,520 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.21it/s]
2025-03-13 12:50:53,546 [INFO]: There are 10010 embeddings of dim 49152
2025-03-13 12:50:53,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 12:50:53,547 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:53
2025-03-13 12:50:53,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:53,547 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 12:50:53,547 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:50:53,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:50:53,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:53
2025-03-13 12:50:53,547 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:53,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:50:53,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:53
2025-03-13 12:50:53,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:53,548 [INFO]: 	Creating the index 03/13/2025, 12:50:53
2025-03-13 12:50:53,548 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:50:53
2025-03-13 12:50:53,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0022 secs
2025-03-13 12:50:53,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:53
2025-03-13 12:50:53,550 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 12:50:53,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:11,  3.33it/s]  5%|▍         | 2/41 [00:00<00:08,  4.54it/s] 10%|▉         | 4/41 [00:00<00:05,  6.95it/s] 15%|█▍        | 6/41 [00:00<00:04,  8.17it/s] 20%|█▉        | 8/41 [00:01<00:03,  8.87it/s] 22%|██▏       | 9/41 [00:01<00:03,  9.08it/s] 24%|██▍       | 10/41 [00:01<00:03,  9.28it/s] 29%|██▉       | 12/41 [00:01<00:02,  9.77it/s] 32%|███▏      | 13/41 [00:01<00:02,  9.68it/s] 37%|███▋      | 15/41 [00:01<00:02,  9.92it/s] 41%|████▏     | 17/41 [00:01<00:02, 10.28it/s] 46%|████▋     | 19/41 [00:02<00:01, 11.60it/s] 51%|█████     | 21/41 [00:07<00:19,  1.04it/s] 54%|█████▎    | 22/41 [00:07<00:15,  1.25it/s] 59%|█████▊    | 24/41 [00:07<00:09,  1.81it/s] 63%|██████▎   | 26/41 [00:08<00:06,  2.49it/s] 68%|██████▊   | 28/41 [00:08<00:03,  3.30it/s] 71%|███████   | 29/41 [00:08<00:03,  3.76it/s] 76%|███████▌  | 31/41 [00:08<00:02,  4.83it/s] 80%|████████  | 33/41 [00:08<00:01,  5.84it/s] 85%|████████▌ | 35/41 [00:08<00:00,  6.76it/s] 90%|█████████ | 37/41 [00:09<00:00,  7.50it/s] 95%|█████████▌| 39/41 [00:09<00:00,  8.16it/s]100%|██████████| 41/41 [00:17<00:00,  1.34s/it]100%|██████████| 41/41 [00:17<00:00,  2.34it/s]
2025-03-13 12:51:11,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:11
2025-03-13 12:52:32,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.5135 secs
2025-03-13 12:52:32,626 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 12:52:32,626 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 12:53:22,226 [INFO]: 	>>> Finished "Compute fast metrics" in 49.5998 secs
2025-03-13 12:53:22,230 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.6794 secs
2025-03-13 12:53:22,230 [INFO]: {
2025-03-13 12:53:22,230 [INFO]: 	index_key: HNSW32
2025-03-13 12:53:22,230 [INFO]: 	index_param: efSearch=130
2025-03-13 12:53:22,230 [INFO]: 	index_path: knn.index
2025-03-13 12:53:22,230 [INFO]: 	size in bytes: 1970766618
2025-03-13 12:53:22,230 [INFO]: 	avg_search_speed_ms: 11.162411538732288
2025-03-13 12:53:22,230 [INFO]: 	99p_search_speed_ms: 18.613018689211454
2025-03-13 12:53:22,230 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:22,230 [INFO]: 	nb vectors: 10010
2025-03-13 12:53:22,230 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:22,230 [INFO]: 	compression ratio: 0.9986195534391784
2025-03-13 12:53:22,230 [INFO]: }
2025-03-13 12:53:22,230 [INFO]: 	>>> Finished "Creating the index" in 148.6822 secs
2025-03-13 12:53:22,230 [INFO]: >>> Finished "Launching the whole pipeline" in 148.7100 secs
2025-03-13 12:53:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 59574 [episode count 7/20]
[retrieval_preprocessing] for episode 42172 [episode count 8/20], we have num_retrieval=np.int64(9767) num_query=np.int64(906)
2025-03-13 12:53:29,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:31,099 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:31
2025-03-13 12:53:31,100 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1231.45it/s]
2025-03-13 12:53:31,125 [INFO]: There are 9767 embeddings of dim 49152
2025-03-13 12:53:31,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 12:53:31,125 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:31
2025-03-13 12:53:31,125 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:31,125 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 12:53:31,125 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:53:31,125 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:53:31,125 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:31
2025-03-13 12:53:31,125 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:31,125 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:53:31,125 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:31
2025-03-13 12:53:31,125 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:31,125 [INFO]: 	Creating the index 03/13/2025, 12:53:31
2025-03-13 12:53:31,125 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:53:31
2025-03-13 12:53:31,127 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:53:31,127 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:31
2025-03-13 12:53:31,127 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 12:53:31,127 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:09,  4.30it/s]  8%|▊         | 3/40 [00:00<00:03,  9.69it/s] 12%|█▎        | 5/40 [00:00<00:02, 12.37it/s] 18%|█▊        | 7/40 [00:00<00:02, 13.40it/s] 22%|██▎       | 9/40 [00:00<00:02, 14.04it/s] 28%|██▊       | 11/40 [00:00<00:01, 14.83it/s] 32%|███▎      | 13/40 [00:01<00:01, 13.57it/s] 38%|███▊      | 15/40 [00:01<00:01, 12.59it/s] 42%|████▎     | 17/40 [00:01<00:01, 12.09it/s] 48%|████▊     | 19/40 [00:01<00:01, 11.84it/s] 52%|█████▎    | 21/40 [00:05<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:05<00:08,  1.98it/s] 62%|██████▎   | 25/40 [00:06<00:05,  2.63it/s] 68%|██████▊   | 27/40 [00:06<00:03,  3.37it/s] 70%|███████   | 28/40 [00:06<00:03,  3.79it/s] 72%|███████▎  | 29/40 [00:06<00:02,  4.19it/s] 75%|███████▌  | 30/40 [00:06<00:02,  4.73it/s] 78%|███████▊  | 31/40 [00:06<00:01,  5.33it/s] 80%|████████  | 32/40 [00:07<00:03,  2.64it/s] 85%|████████▌ | 34/40 [00:07<00:01,  3.88it/s] 90%|█████████ | 36/40 [00:08<00:00,  5.08it/s] 92%|█████████▎| 37/40 [00:09<00:01,  2.03it/s] 95%|█████████▌| 38/40 [00:19<00:05,  2.64s/it] 98%|█████████▊| 39/40 [00:21<00:02,  2.45s/it]100%|██████████| 40/40 [00:28<00:00,  3.80s/it]100%|██████████| 40/40 [00:28<00:00,  1.39it/s]
2025-03-13 12:53:59,917 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:53:59
2025-03-13 12:55:11,435 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.5174 secs
2025-03-13 12:55:11,435 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 12:55:11,436 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 12:55:44,031 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5949 secs
2025-03-13 12:55:44,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.9123 secs
2025-03-13 12:55:44,039 [INFO]: {
2025-03-13 12:55:44,039 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:44,040 [INFO]: 	index_param: efSearch=153
2025-03-13 12:55:44,040 [INFO]: 	index_path: knn.index
2025-03-13 12:55:44,040 [INFO]: 	size in bytes: 1921599310
2025-03-13 12:55:44,040 [INFO]: 	avg_search_speed_ms: 9.542097997823232
2025-03-13 12:55:44,040 [INFO]: 	99p_search_speed_ms: 16.739303977228698
2025-03-13 12:55:44,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:44,040 [INFO]: 	nb vectors: 9767
2025-03-13 12:55:44,040 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:44,040 [INFO]: 	compression ratio: 0.9993084021246864
2025-03-13 12:55:44,040 [INFO]: }
2025-03-13 12:55:44,040 [INFO]: 	>>> Finished "Creating the index" in 132.9142 secs
2025-03-13 12:55:44,040 [INFO]: >>> Finished "Launching the whole pipeline" in 132.9401 secs
2025-03-13 12:55:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 42172 [episode count 8/20]
[retrieval_preprocessing] for episode 19524 [episode count 9/20], we have num_retrieval=np.int64(10480) num_query=np.int64(193)
2025-03-13 12:55:53,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:55,299 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:55
2025-03-13 12:55:55,299 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 995.80it/s]
2025-03-13 12:55:55,323 [INFO]: There are 10480 embeddings of dim 49152
2025-03-13 12:55:55,323 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 12:55:55,323 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:55,323 [INFO]: 		-> Add: 5.8 seconds
2025-03-13 12:55:55,323 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:55:55,323 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:55:55,323 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,324 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:55,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:55:55,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:55
2025-03-13 12:55:55,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:55,324 [INFO]: 	Creating the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,324 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:55:55
2025-03-13 12:55:55,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 12:55:55,325 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:55
2025-03-13 12:55:55,325 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 12:55:55,325 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:09,  4.52it/s]  7%|▋         | 3/44 [00:00<00:04,  8.41it/s] 11%|█▏        | 5/44 [00:00<00:03,  9.84it/s] 16%|█▌        | 7/44 [00:00<00:03, 10.59it/s] 20%|██        | 9/44 [00:00<00:03, 11.09it/s] 25%|██▌       | 11/44 [00:01<00:02, 11.64it/s] 30%|██▉       | 13/44 [00:01<00:02, 11.76it/s] 34%|███▍      | 15/44 [00:01<00:02, 11.37it/s] 39%|███▊      | 17/44 [00:01<00:02, 10.88it/s] 43%|████▎     | 19/44 [00:01<00:02, 10.70it/s] 48%|████▊     | 21/44 [00:07<00:21,  1.05it/s] 52%|█████▏    | 23/44 [00:07<00:14,  1.45it/s] 57%|█████▋    | 25/44 [00:07<00:09,  2.01it/s] 61%|██████▏   | 27/44 [00:08<00:06,  2.72it/s] 66%|██████▌   | 29/44 [00:08<00:04,  3.61it/s] 70%|███████   | 31/44 [00:08<00:02,  4.64it/s] 75%|███████▌  | 33/44 [00:08<00:01,  5.93it/s] 80%|███████▉  | 35/44 [00:08<00:01,  7.33it/s] 84%|████████▍ | 37/44 [00:08<00:00,  8.83it/s] 89%|████████▊ | 39/44 [00:08<00:00, 10.29it/s] 93%|█████████▎| 41/44 [00:08<00:00, 11.64it/s] 98%|█████████▊| 43/44 [00:16<00:01,  1.16s/it]100%|██████████| 44/44 [00:17<00:00,  2.46it/s]
2025-03-13 12:56:13,205 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:13
2025-03-13 12:57:38,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.9983 secs
2025-03-13 12:57:38,204 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 12:57:38,204 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 12:58:21,154 [INFO]: 	>>> Finished "Compute fast metrics" in 42.9491 secs
2025-03-13 12:58:21,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.8294 secs
2025-03-13 12:58:21,154 [INFO]: {
2025-03-13 12:58:21,154 [INFO]: 	index_key: HNSW32
2025-03-13 12:58:21,154 [INFO]: 	index_param: efSearch=148
2025-03-13 12:58:21,154 [INFO]: 	index_path: knn.index
2025-03-13 12:58:21,154 [INFO]: 	size in bytes: 2063300898
2025-03-13 12:58:21,154 [INFO]: 	avg_search_speed_ms: 14.410993515752708
2025-03-13 12:58:21,154 [INFO]: 	99p_search_speed_ms: 26.232765929307803
2025-03-13 12:58:21,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:21,154 [INFO]: 	nb vectors: 10480
2025-03-13 12:58:21,154 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:21,155 [INFO]: 	compression ratio: 0.9986191747394858
2025-03-13 12:58:21,155 [INFO]: }
2025-03-13 12:58:21,155 [INFO]: 	>>> Finished "Creating the index" in 145.8308 secs
2025-03-13 12:58:21,155 [INFO]: >>> Finished "Launching the whole pipeline" in 145.8551 secs
2025-03-13 12:58:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 19524 [episode count 9/20]
[retrieval_preprocessing] for episode 11598 [episode count 10/20], we have num_retrieval=np.int64(9945) num_query=np.int64(728)
2025-03-13 12:58:27,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:29,534 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:29
2025-03-13 12:58:29,534 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.70it/s]
2025-03-13 12:58:29,562 [INFO]: There are 9945 embeddings of dim 49152
2025-03-13 12:58:29,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:58:29,562 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:29
2025-03-13 12:58:29,562 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:29,562 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 12:58:29,562 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:58:29,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:29,562 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:29
2025-03-13 12:58:29,562 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:29,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:29,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:29
2025-03-13 12:58:29,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:29,562 [INFO]: 	Creating the index 03/13/2025, 12:58:29
2025-03-13 12:58:29,562 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:29
2025-03-13 12:58:29,564 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:58:29,564 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:29
2025-03-13 12:58:29,564 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 12:58:29,564 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:09,  4.07it/s]  5%|▍         | 2/41 [00:00<00:06,  5.86it/s]  7%|▋         | 3/41 [00:00<00:05,  6.87it/s] 10%|▉         | 4/41 [00:00<00:04,  7.44it/s] 12%|█▏        | 5/41 [00:00<00:04,  7.79it/s] 15%|█▍        | 6/41 [00:00<00:04,  8.05it/s] 17%|█▋        | 7/41 [00:00<00:04,  8.29it/s] 20%|█▉        | 8/41 [00:01<00:03,  8.35it/s] 22%|██▏       | 9/41 [00:01<00:03,  8.32it/s] 24%|██▍       | 10/41 [00:01<00:03,  8.42it/s] 27%|██▋       | 11/41 [00:01<00:03,  8.72it/s] 32%|███▏      | 13/41 [00:01<00:02, 10.12it/s] 37%|███▋      | 15/41 [00:01<00:02, 10.53it/s] 41%|████▏     | 17/41 [00:01<00:02, 11.04it/s] 46%|████▋     | 19/41 [00:02<00:01, 11.09it/s] 51%|█████     | 21/41 [00:06<00:16,  1.21it/s] 54%|█████▎    | 22/41 [00:06<00:13,  1.46it/s] 59%|█████▊    | 24/41 [00:07<00:08,  2.11it/s] 63%|██████▎   | 26/41 [00:07<00:05,  2.93it/s] 68%|██████▊   | 28/41 [00:07<00:03,  3.92it/s] 73%|███████▎  | 30/41 [00:07<00:02,  5.04it/s] 78%|███████▊  | 32/41 [00:07<00:01,  6.31it/s] 83%|████████▎ | 34/41 [00:07<00:00,  7.58it/s] 88%|████████▊ | 36/41 [00:07<00:00,  8.87it/s] 93%|█████████▎| 38/41 [00:08<00:00, 10.09it/s] 98%|█████████▊| 40/41 [00:08<00:00, 11.25it/s]100%|██████████| 41/41 [00:12<00:00,  3.16it/s]
2025-03-13 12:58:42,558 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:42
2025-03-13 13:00:00,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.0916 secs
2025-03-13 13:00:00,650 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 13:00:00,650 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s]
2025-03-13 13:00:36,502 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8517 secs
2025-03-13 13:00:36,507 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.9434 secs
2025-03-13 13:00:36,508 [INFO]: {
2025-03-13 13:00:36,508 [INFO]: 	index_key: HNSW15
2025-03-13 13:00:36,508 [INFO]: 	index_param: efSearch=195
2025-03-13 13:00:36,508 [INFO]: 	index_path: knn.index
2025-03-13 13:00:36,508 [INFO]: 	size in bytes: 1956620110
2025-03-13 13:00:36,508 [INFO]: 	avg_search_speed_ms: 11.186945042989615
2025-03-13 13:00:36,508 [INFO]: 	99p_search_speed_ms: 19.226761786267154
2025-03-13 13:00:36,508 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:36,508 [INFO]: 	nb vectors: 9945
2025-03-13 13:00:36,508 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:36,508 [INFO]: 	compression ratio: 0.9993082203371609
2025-03-13 13:00:36,508 [INFO]: }
2025-03-13 13:00:36,508 [INFO]: 	>>> Finished "Creating the index" in 126.9460 secs
2025-03-13 13:00:36,508 [INFO]: >>> Finished "Launching the whole pipeline" in 126.9747 secs
2025-03-13 13:00:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 11598 [episode count 10/20]
[retrieval_preprocessing] for episode 40269 [episode count 11/20], we have num_retrieval=np.int64(9852) num_query=np.int64(821)
2025-03-13 13:00:48,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:50,002 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:50
2025-03-13 13:00:50,002 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.28it/s]
2025-03-13 13:00:50,026 [INFO]: There are 9852 embeddings of dim 49152
2025-03-13 13:00:50,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 13:00:50,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:50
2025-03-13 13:00:50,027 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:50,027 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 13:00:50,027 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:00:50,027 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:50,027 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:50
2025-03-13 13:00:50,027 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:50,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:00:50,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:50
2025-03-13 13:00:50,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:50,027 [INFO]: 	Creating the index 03/13/2025, 13:00:50
2025-03-13 13:00:50,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:00:50
2025-03-13 13:00:50,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:00:50,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:50
2025-03-13 13:00:50,028 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 13:00:50,028 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:08,  4.80it/s]  8%|▊         | 3/40 [00:00<00:04,  8.31it/s] 12%|█▎        | 5/40 [00:00<00:03,  9.68it/s] 18%|█▊        | 7/40 [00:00<00:03, 10.37it/s] 22%|██▎       | 9/40 [00:00<00:02, 10.58it/s] 28%|██▊       | 11/40 [00:01<00:02, 10.83it/s] 32%|███▎      | 13/40 [00:01<00:02, 11.18it/s] 38%|███▊      | 15/40 [00:01<00:02, 11.57it/s] 42%|████▎     | 17/40 [00:01<00:02, 10.49it/s] 48%|████▊     | 19/40 [00:01<00:02,  9.10it/s] 52%|█████▎    | 21/40 [00:05<00:12,  1.52it/s] 55%|█████▌    | 22/40 [00:05<00:10,  1.79it/s] 60%|██████    | 24/40 [00:05<00:06,  2.52it/s] 65%|██████▌   | 26/40 [00:06<00:04,  3.43it/s] 70%|███████   | 28/40 [00:06<00:02,  4.49it/s] 75%|███████▌  | 30/40 [00:06<00:01,  5.68it/s] 80%|████████  | 32/40 [00:06<00:01,  6.81it/s] 85%|████████▌ | 34/40 [00:06<00:00,  7.94it/s] 90%|█████████ | 36/40 [00:06<00:00,  9.01it/s] 95%|█████████▌| 38/40 [00:07<00:00,  9.89it/s]100%|██████████| 40/40 [00:11<00:00,  1.35it/s]100%|██████████| 40/40 [00:11<00:00,  3.48it/s]
2025-03-13 13:01:01,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:01:01
2025-03-13 13:02:12,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.8139 secs
2025-03-13 13:02:12,360 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 13:02:12,360 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 13:02:41,080 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7196 secs
2025-03-13 13:02:41,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.0551 secs
2025-03-13 13:02:41,084 [INFO]: {
2025-03-13 13:02:41,084 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:41,084 [INFO]: 	index_param: efSearch=204
2025-03-13 13:02:41,084 [INFO]: 	index_path: knn.index
2025-03-13 13:02:41,084 [INFO]: 	size in bytes: 1938322810
2025-03-13 13:02:41,084 [INFO]: 	avg_search_speed_ms: 10.875148092568649
2025-03-13 13:02:41,084 [INFO]: 	99p_search_speed_ms: 16.924755421932783
2025-03-13 13:02:41,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:41,084 [INFO]: 	nb vectors: 9852
2025-03-13 13:02:41,084 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:41,084 [INFO]: 	compression ratio: 0.999308271051095
2025-03-13 13:02:41,084 [INFO]: }
2025-03-13 13:02:41,084 [INFO]: 	>>> Finished "Creating the index" in 111.0567 secs
2025-03-13 13:02:41,084 [INFO]: >>> Finished "Launching the whole pipeline" in 111.0818 secs
2025-03-13 13:02:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 40269 [episode count 11/20]
[retrieval_preprocessing] for episode 33746 [episode count 12/20], we have num_retrieval=np.int64(10130) num_query=np.int64(543)
2025-03-13 13:02:51,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:53,525 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:53
2025-03-13 13:02:53,525 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1562.12it/s]
2025-03-13 13:02:53,549 [INFO]: There are 10130 embeddings of dim 49152
2025-03-13 13:02:53,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 13:02:53,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:53
2025-03-13 13:02:53,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:53,550 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 13:02:53,550 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:02:53,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:53,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:53
2025-03-13 13:02:53,550 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:53,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:02:53,550 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:53
2025-03-13 13:02:53,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:53,550 [INFO]: 	Creating the index 03/13/2025, 13:02:53
2025-03-13 13:02:53,550 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:02:53
2025-03-13 13:02:53,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:02:53,551 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:53
2025-03-13 13:02:53,551 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:02:53,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.49it/s]  7%|▋         | 3/41 [00:00<00:04,  8.21it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.52it/s] 17%|█▋        | 7/41 [00:00<00:03, 10.09it/s] 22%|██▏       | 9/41 [00:00<00:03, 10.18it/s] 27%|██▋       | 11/41 [00:01<00:02, 10.28it/s] 32%|███▏      | 13/41 [00:01<00:02, 10.42it/s] 37%|███▋      | 15/41 [00:01<00:02, 10.48it/s] 41%|████▏     | 17/41 [00:01<00:02, 10.61it/s] 46%|████▋     | 19/41 [00:01<00:02, 10.65it/s] 51%|█████     | 21/41 [00:08<00:22,  1.15s/it] 56%|█████▌    | 23/41 [00:09<00:14,  1.21it/s] 61%|██████    | 25/41 [00:09<00:09,  1.66it/s] 66%|██████▌   | 27/41 [00:09<00:06,  2.24it/s] 71%|███████   | 29/41 [00:09<00:04,  2.96it/s] 76%|███████▌  | 31/41 [00:09<00:02,  3.81it/s] 80%|████████  | 33/41 [00:09<00:01,  4.74it/s] 85%|████████▌ | 35/41 [00:10<00:01,  5.61it/s] 90%|█████████ | 37/41 [00:10<00:00,  6.27it/s] 93%|█████████▎| 38/41 [00:10<00:00,  6.60it/s] 95%|█████████▌| 39/41 [00:10<00:00,  6.96it/s] 98%|█████████▊| 40/41 [00:10<00:00,  7.11it/s]100%|██████████| 41/41 [00:22<00:00,  2.85s/it]100%|██████████| 41/41 [00:22<00:00,  1.85it/s]
2025-03-13 13:03:15,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:15
2025-03-13 13:04:33,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.5193 secs
2025-03-13 13:04:33,218 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 13:04:33,218 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.26it/s] 50%|█████     | 2/4 [00:01<00:00,  2.02it/s] 75%|███████▌  | 3/4 [00:01<00:00,  3.08it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.41it/s]
2025-03-13 13:04:58,964 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7459 secs
2025-03-13 13:04:58,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.4189 secs
2025-03-13 13:04:58,970 [INFO]: {
2025-03-13 13:04:58,970 [INFO]: 	index_key: HNSW32
2025-03-13 13:04:58,970 [INFO]: 	index_param: efSearch=147
2025-03-13 13:04:58,970 [INFO]: 	index_path: knn.index
2025-03-13 13:04:58,970 [INFO]: 	size in bytes: 1994392378
2025-03-13 13:04:58,970 [INFO]: 	avg_search_speed_ms: 14.974629669589643
2025-03-13 13:04:58,970 [INFO]: 	99p_search_speed_ms: 26.231308621354408
2025-03-13 13:04:58,970 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:58,970 [INFO]: 	nb vectors: 10130
2025-03-13 13:04:58,970 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:58,970 [INFO]: 	compression ratio: 0.9986194602273997
2025-03-13 13:04:58,970 [INFO]: }
2025-03-13 13:04:58,970 [INFO]: 	>>> Finished "Creating the index" in 125.4205 secs
2025-03-13 13:04:58,970 [INFO]: >>> Finished "Launching the whole pipeline" in 125.4453 secs
2025-03-13 13:05:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:05:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 33746 [episode count 12/20]
[retrieval_preprocessing] for episode 84434 [episode count 13/20], we have num_retrieval=np.int64(10068) num_query=np.int64(605)
2025-03-13 13:05:07,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:05:08,848 [INFO]: Launching the whole pipeline 03/13/2025, 13:05:08
2025-03-13 13:05:08,848 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:05:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1751.28it/s]
2025-03-13 13:05:08,873 [INFO]: There are 10068 embeddings of dim 49152
2025-03-13 13:05:08,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 13:05:08,873 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:05:08
2025-03-13 13:05:08,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:05:08,874 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 13:05:08,874 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:05:08,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:05:08,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:05:08
2025-03-13 13:05:08,874 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:05:08,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:05:08,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:05:08
2025-03-13 13:05:08,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:05:08,874 [INFO]: 	Creating the index 03/13/2025, 13:05:08
2025-03-13 13:05:08,874 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:05:08
2025-03-13 13:05:08,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:05:08,875 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:05:08
2025-03-13 13:05:08,875 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 13:05:08,875 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.47it/s]  7%|▋         | 3/41 [00:00<00:04,  8.11it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.54it/s] 17%|█▋        | 7/41 [00:00<00:03, 10.63it/s] 22%|██▏       | 9/41 [00:00<00:02, 11.49it/s] 27%|██▋       | 11/41 [00:01<00:02, 12.04it/s] 32%|███▏      | 13/41 [00:01<00:02, 12.27it/s] 37%|███▋      | 15/41 [00:01<00:02, 12.25it/s] 41%|████▏     | 17/41 [00:01<00:01, 12.70it/s] 46%|████▋     | 19/41 [00:01<00:01, 13.12it/s] 51%|█████     | 21/41 [00:08<00:20,  1.03s/it] 54%|█████▎    | 22/41 [00:08<00:16,  1.15it/s] 59%|█████▊    | 24/41 [00:08<00:10,  1.65it/s] 61%|██████    | 25/41 [00:08<00:08,  1.97it/s] 63%|██████▎   | 26/41 [00:08<00:06,  2.38it/s] 66%|██████▌   | 27/41 [00:08<00:04,  2.89it/s] 68%|██████▊   | 28/41 [00:08<00:03,  3.53it/s] 71%|███████   | 29/41 [00:08<00:02,  4.24it/s] 73%|███████▎  | 30/41 [00:08<00:02,  5.03it/s] 76%|███████▌  | 31/41 [00:09<00:01,  5.82it/s] 78%|███████▊  | 32/41 [00:09<00:01,  6.60it/s] 80%|████████  | 33/41 [00:09<00:01,  7.30it/s] 83%|████████▎ | 34/41 [00:09<00:00,  7.90it/s] 85%|████████▌ | 35/41 [00:09<00:00,  8.29it/s] 88%|████████▊ | 36/41 [00:09<00:00,  8.59it/s] 90%|█████████ | 37/41 [00:09<00:00,  8.87it/s] 93%|█████████▎| 38/41 [00:09<00:00,  9.08it/s] 95%|█████████▌| 39/41 [00:09<00:00,  9.32it/s] 98%|█████████▊| 40/41 [00:09<00:00,  9.39it/s]100%|██████████| 41/41 [00:17<00:00,  2.22s/it]100%|██████████| 41/41 [00:17<00:00,  2.39it/s]
2025-03-13 13:05:26,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:05:26
2025-03-13 13:06:47,670 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.6392 secs
2025-03-13 13:06:47,670 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 13:06:47,670 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-13 13:07:24,810 [INFO]: 	>>> Finished "Compute fast metrics" in 37.1392 secs
2025-03-13 13:07:24,815 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.9397 secs
2025-03-13 13:07:24,815 [INFO]: {
2025-03-13 13:07:24,815 [INFO]: 	index_key: HNSW32
2025-03-13 13:07:24,815 [INFO]: 	index_param: efSearch=137
2025-03-13 13:07:24,815 [INFO]: 	index_path: knn.index
2025-03-13 13:07:24,815 [INFO]: 	size in bytes: 1982185682
2025-03-13 13:07:24,815 [INFO]: 	avg_search_speed_ms: 14.155882404777294
2025-03-13 13:07:24,815 [INFO]: 	99p_search_speed_ms: 23.312192568555467
2025-03-13 13:07:24,815 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:24,815 [INFO]: 	nb vectors: 10068
2025-03-13 13:07:24,815 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:24,815 [INFO]: 	compression ratio: 0.99861953497856
2025-03-13 13:07:24,815 [INFO]: }
2025-03-13 13:07:24,815 [INFO]: 	>>> Finished "Creating the index" in 135.9413 secs
2025-03-13 13:07:24,815 [INFO]: >>> Finished "Launching the whole pipeline" in 135.9673 secs
2025-03-13 13:07:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 84434 [episode count 13/20]
[retrieval_preprocessing] for episode 5845 [episode count 14/20], we have num_retrieval=np.int64(10288) num_query=np.int64(385)
2025-03-13 13:07:32,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:33,954 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:33
2025-03-13 13:07:33,954 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1111.96it/s]
2025-03-13 13:07:33,979 [INFO]: There are 10288 embeddings of dim 49152
2025-03-13 13:07:33,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 13:07:33,980 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:33
2025-03-13 13:07:33,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:33,980 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 13:07:33,980 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:07:33,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:07:33,980 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:33
2025-03-13 13:07:33,980 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:33,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:07:33,980 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:33
2025-03-13 13:07:33,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:33,980 [INFO]: 	Creating the index 03/13/2025, 13:07:33
2025-03-13 13:07:33,980 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:07:33
2025-03-13 13:07:33,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 13:07:33,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:33
2025-03-13 13:07:33,981 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:07:33,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.28it/s]  7%|▋         | 3/43 [00:00<00:03, 10.03it/s] 12%|█▏        | 5/43 [00:00<00:03, 11.09it/s] 16%|█▋        | 7/43 [00:00<00:03, 11.95it/s] 21%|██        | 9/43 [00:00<00:02, 12.01it/s] 26%|██▌       | 11/43 [00:00<00:02, 12.18it/s] 30%|███       | 13/43 [00:01<00:02, 12.20it/s] 35%|███▍      | 15/43 [00:01<00:02, 12.05it/s] 40%|███▉      | 17/43 [00:01<00:02, 11.91it/s] 44%|████▍     | 19/43 [00:01<00:01, 12.06it/s] 49%|████▉     | 21/43 [00:07<00:21,  1.01it/s] 51%|█████     | 22/43 [00:07<00:17,  1.20it/s] 56%|█████▌    | 24/43 [00:07<00:11,  1.73it/s] 60%|██████    | 26/43 [00:08<00:07,  2.39it/s] 65%|██████▌   | 28/43 [00:08<00:04,  3.20it/s] 70%|██████▉   | 30/43 [00:08<00:03,  4.13it/s] 74%|███████▍  | 32/43 [00:08<00:02,  5.19it/s] 79%|███████▉  | 34/43 [00:08<00:01,  6.25it/s] 84%|████████▎ | 36/43 [00:09<00:00,  7.26it/s] 88%|████████▊ | 38/43 [00:09<00:00,  8.18it/s] 93%|█████████▎| 40/43 [00:09<00:00,  8.82it/s] 98%|█████████▊| 42/43 [00:17<00:01,  1.24s/it]100%|██████████| 43/43 [00:18<00:00,  1.27s/it]100%|██████████| 43/43 [00:18<00:00,  2.33it/s]
2025-03-13 13:07:52,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:52
2025-03-13 13:09:10,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.3995 secs
2025-03-13 13:09:10,848 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 13:09:10,848 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-13 13:09:35,746 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8983 secs
2025-03-13 13:09:35,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.7659 secs
2025-03-13 13:09:35,747 [INFO]: {
2025-03-13 13:09:35,747 [INFO]: 	index_key: HNSW32
2025-03-13 13:09:35,747 [INFO]: 	index_param: efSearch=161
2025-03-13 13:09:35,747 [INFO]: 	index_path: knn.index
2025-03-13 13:09:35,747 [INFO]: 	size in bytes: 2025499298
2025-03-13 13:09:35,747 [INFO]: 	avg_search_speed_ms: 15.424515519259593
2025-03-13 13:09:35,747 [INFO]: 	99p_search_speed_ms: 27.771684704348424
2025-03-13 13:09:35,747 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:35,747 [INFO]: 	nb vectors: 10288
2025-03-13 13:09:35,747 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:35,747 [INFO]: 	compression ratio: 0.9986195038414671
2025-03-13 13:09:35,747 [INFO]: }
2025-03-13 13:09:35,747 [INFO]: 	>>> Finished "Creating the index" in 121.7671 secs
2025-03-13 13:09:35,747 [INFO]: >>> Finished "Launching the whole pipeline" in 121.7929 secs
2025-03-13 13:09:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 5845 [episode count 14/20]
[retrieval_preprocessing] for episode 82775 [episode count 15/20], we have num_retrieval=np.int64(10285) num_query=np.int64(388)
2025-03-13 13:09:41,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:09:43,439 [INFO]: Launching the whole pipeline 03/13/2025, 13:09:43
2025-03-13 13:09:43,440 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:09:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1581.56it/s]
2025-03-13 13:09:43,464 [INFO]: There are 10285 embeddings of dim 49152
2025-03-13 13:09:43,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 13:09:43,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:09:43,464 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 13:09:43,464 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:09:43,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:09:43,464 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,465 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:09:43,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:09:43,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:09:43
2025-03-13 13:09:43,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:09:43,465 [INFO]: 	Creating the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,465 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:09:43
2025-03-13 13:09:43,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:09:43,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:09:43
2025-03-13 13:09:43,466 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:09:43,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.66it/s]  5%|▍         | 2/43 [00:00<00:06,  6.72it/s]  7%|▋         | 3/43 [00:00<00:05,  7.71it/s]  9%|▉         | 4/43 [00:00<00:04,  8.30it/s] 14%|█▍        | 6/43 [00:00<00:03,  9.45it/s] 19%|█▊        | 8/43 [00:00<00:03,  9.92it/s] 23%|██▎       | 10/43 [00:01<00:03, 10.02it/s] 28%|██▊       | 12/43 [00:01<00:03, 10.26it/s] 33%|███▎      | 14/43 [00:01<00:02, 10.35it/s] 37%|███▋      | 16/43 [00:01<00:02, 10.18it/s] 42%|████▏     | 18/43 [00:08<00:29,  1.17s/it] 44%|████▍     | 19/43 [00:09<00:25,  1.07s/it] 47%|████▋     | 20/43 [00:09<00:20,  1.13it/s] 49%|████▉     | 21/43 [00:14<00:41,  1.88s/it] 51%|█████     | 22/43 [00:16<00:40,  1.92s/it] 58%|█████▊    | 25/43 [00:17<00:17,  1.00it/s] 60%|██████    | 26/43 [00:18<00:18,  1.08s/it] 67%|██████▋   | 29/43 [00:18<00:08,  1.62it/s] 72%|███████▏  | 31/43 [00:18<00:05,  2.24it/s] 74%|███████▍  | 32/43 [00:18<00:04,  2.59it/s] 77%|███████▋  | 33/43 [00:19<00:03,  3.04it/s] 81%|████████▏ | 35/43 [00:20<00:03,  2.48it/s] 84%|████████▎ | 36/43 [00:22<00:05,  1.29it/s] 86%|████████▌ | 37/43 [00:22<00:03,  1.60it/s] 91%|█████████ | 39/43 [00:22<00:01,  2.51it/s] 98%|█████████▊| 42/43 [00:29<00:01,  1.33s/it]100%|██████████| 43/43 [00:31<00:00,  1.35s/it]100%|██████████| 43/43 [00:31<00:00,  1.38it/s]
2025-03-13 13:10:14,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:14
2025-03-13 13:11:32,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.3142 secs
2025-03-13 13:11:32,042 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 13:11:32,042 [INFO]: 	Compute fast metrics 03/13/2025, 13:11:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 13:12:05,912 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8696 secs
2025-03-13 13:12:05,912 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.4462 secs
2025-03-13 13:12:05,912 [INFO]: {
2025-03-13 13:12:05,912 [INFO]: 	index_key: HNSW32
2025-03-13 13:12:05,912 [INFO]: 	index_param: efSearch=142
2025-03-13 13:12:05,912 [INFO]: 	index_path: knn.index
2025-03-13 13:12:05,912 [INFO]: 	size in bytes: 2024908542
2025-03-13 13:12:05,912 [INFO]: 	avg_search_speed_ms: 12.951970526555293
2025-03-13 13:12:05,912 [INFO]: 	99p_search_speed_ms: 20.85648036561906
2025-03-13 13:12:05,912 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:12:05,912 [INFO]: 	nb vectors: 10285
2025-03-13 13:12:05,912 [INFO]: 	vectors dimension: 49152
2025-03-13 13:12:05,912 [INFO]: 	compression ratio: 0.9986195613569593
2025-03-13 13:12:05,912 [INFO]: }
2025-03-13 13:12:05,912 [INFO]: 	>>> Finished "Creating the index" in 142.4475 secs
2025-03-13 13:12:05,912 [INFO]: >>> Finished "Launching the whole pipeline" in 142.4728 secs
2025-03-13 13:12:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:12:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 82775 [episode count 15/20]
[retrieval_preprocessing] for episode 76634 [episode count 16/20], we have num_retrieval=np.int64(10237) num_query=np.int64(436)
2025-03-13 13:12:22,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:12:24,423 [INFO]: Launching the whole pipeline 03/13/2025, 13:12:24
2025-03-13 13:12:24,423 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:12:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2323.71it/s]
2025-03-13 13:12:24,446 [INFO]: There are 10237 embeddings of dim 49152
2025-03-13 13:12:24,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 13:12:24,446 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:12:24
2025-03-13 13:12:24,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:12:24,447 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 13:12:24,447 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:12:24,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:12:24,447 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:12:24
2025-03-13 13:12:24,447 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:12:24,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:12:24,447 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:12:24
2025-03-13 13:12:24,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:12:24,447 [INFO]: 	Creating the index 03/13/2025, 13:12:24
2025-03-13 13:12:24,447 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:12:24
2025-03-13 13:12:24,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 13:12:24,448 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:12:24
2025-03-13 13:12:24,448 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:12:24,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:03<02:32,  3.62s/it]  5%|▍         | 2/43 [00:03<01:10,  1.71s/it]  9%|▉         | 4/43 [00:04<00:26,  1.49it/s] 16%|█▋        | 7/43 [00:04<00:11,  3.21it/s] 21%|██        | 9/43 [00:04<00:07,  4.45it/s] 28%|██▊       | 12/43 [00:04<00:04,  6.82it/s] 35%|███▍      | 15/43 [00:04<00:02,  9.65it/s] 42%|████▏     | 18/43 [00:04<00:02, 12.35it/s] 49%|████▉     | 21/43 [00:09<00:14,  1.57it/s] 56%|█████▌    | 24/43 [00:10<00:08,  2.26it/s] 63%|██████▎   | 27/43 [00:10<00:05,  3.18it/s] 70%|██████▉   | 30/43 [00:10<00:02,  4.39it/s] 77%|███████▋  | 33/43 [00:10<00:01,  5.76it/s] 84%|████████▎ | 36/43 [00:10<00:01,  6.76it/s] 88%|████████▊ | 38/43 [00:10<00:00,  7.72it/s] 93%|█████████▎| 40/43 [00:11<00:00,  8.21it/s] 98%|█████████▊| 42/43 [00:18<00:00,  1.00it/s]100%|██████████| 43/43 [00:19<00:00,  2.19it/s]
2025-03-13 13:12:44,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:12:44
2025-03-13 13:13:59,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.6241 secs
2025-03-13 13:13:59,692 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 13:13:59,692 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 13:14:32,073 [INFO]: 	>>> Finished "Compute fast metrics" in 32.3812 secs
2025-03-13 13:14:32,074 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.6255 secs
2025-03-13 13:14:32,074 [INFO]: {
2025-03-13 13:14:32,074 [INFO]: 	index_key: HNSW32
2025-03-13 13:14:32,074 [INFO]: 	index_param: efSearch=137
2025-03-13 13:14:32,074 [INFO]: 	index_path: knn.index
2025-03-13 13:14:32,074 [INFO]: 	size in bytes: 2015458494
2025-03-13 13:14:32,074 [INFO]: 	avg_search_speed_ms: 11.891427161958285
2025-03-13 13:14:32,074 [INFO]: 	99p_search_speed_ms: 20.144917815923698
2025-03-13 13:14:32,074 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:32,074 [INFO]: 	nb vectors: 10237
2025-03-13 13:14:32,074 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:32,074 [INFO]: 	compression ratio: 0.998619471446183
2025-03-13 13:14:32,074 [INFO]: }
2025-03-13 13:14:32,074 [INFO]: 	>>> Finished "Creating the index" in 127.6268 secs
2025-03-13 13:14:32,074 [INFO]: >>> Finished "Launching the whole pipeline" in 127.6507 secs
2025-03-13 13:14:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 76634 [episode count 16/20]
[retrieval_preprocessing] for episode 33759 [episode count 17/20], we have num_retrieval=np.int64(9941) num_query=np.int64(732)
2025-03-13 13:14:38,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:14:39,230 [INFO]: Launching the whole pipeline 03/13/2025, 13:14:39
2025-03-13 13:14:39,230 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:14:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1609.48it/s]
2025-03-13 13:14:39,255 [INFO]: There are 9941 embeddings of dim 49152
2025-03-13 13:14:39,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 13:14:39,255 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:14:39
2025-03-13 13:14:39,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:14:39,255 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 13:14:39,255 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:14:39,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:14:39,255 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:14:39
2025-03-13 13:14:39,255 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:14:39,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:14:39,255 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:14:39
2025-03-13 13:14:39,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:14:39,255 [INFO]: 	Creating the index 03/13/2025, 13:14:39
2025-03-13 13:14:39,255 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:14:39
2025-03-13 13:14:39,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:14:39,256 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:14:39
2025-03-13 13:14:39,256 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 13:14:39,256 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:09,  4.21it/s]  5%|▍         | 2/41 [00:00<00:06,  6.09it/s]  7%|▋         | 3/41 [00:00<00:05,  7.34it/s] 10%|▉         | 4/41 [00:00<00:04,  7.83it/s] 12%|█▏        | 5/41 [00:00<00:04,  8.41it/s] 15%|█▍        | 6/41 [00:00<00:04,  8.66it/s] 17%|█▋        | 7/41 [00:00<00:03,  8.89it/s] 20%|█▉        | 8/41 [00:00<00:03,  8.91it/s] 22%|██▏       | 9/41 [00:01<00:03,  8.94it/s] 24%|██▍       | 10/41 [00:01<00:03,  9.04it/s] 27%|██▋       | 11/41 [00:01<00:03,  8.97it/s] 29%|██▉       | 12/41 [00:01<00:03,  9.18it/s] 32%|███▏      | 13/41 [00:01<00:03,  9.12it/s] 34%|███▍      | 14/41 [00:01<00:02,  9.06it/s] 37%|███▋      | 15/41 [00:01<00:02,  9.06it/s] 41%|████▏     | 17/41 [00:01<00:02, 10.30it/s] 46%|████▋     | 19/41 [00:02<00:01, 11.18it/s] 51%|█████     | 21/41 [00:05<00:13,  1.43it/s] 56%|█████▌    | 23/41 [00:05<00:08,  2.05it/s] 61%|██████    | 25/41 [00:05<00:05,  2.82it/s] 66%|██████▌   | 27/41 [00:06<00:03,  3.73it/s] 71%|███████   | 29/41 [00:06<00:02,  4.78it/s] 76%|███████▌  | 31/41 [00:06<00:01,  5.96it/s] 80%|████████  | 33/41 [00:06<00:01,  7.12it/s] 85%|████████▌ | 35/41 [00:06<00:00,  8.39it/s] 90%|█████████ | 37/41 [00:06<00:00,  9.39it/s] 95%|█████████▌| 39/41 [00:07<00:00, 10.27it/s]100%|██████████| 41/41 [00:11<00:00,  1.39it/s]100%|██████████| 41/41 [00:11<00:00,  3.61it/s]
2025-03-13 13:14:50,630 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:14:50
2025-03-13 13:16:00,148 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.5180 secs
2025-03-13 13:16:00,149 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 13:16:00,149 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.84it/s]
2025-03-13 13:16:35,097 [INFO]: 	>>> Finished "Compute fast metrics" in 34.9486 secs
2025-03-13 13:16:35,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.8447 secs
2025-03-13 13:16:35,101 [INFO]: {
2025-03-13 13:16:35,101 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:35,101 [INFO]: 	index_param: efSearch=233
2025-03-13 13:16:35,101 [INFO]: 	index_path: knn.index
2025-03-13 13:16:35,101 [INFO]: 	size in bytes: 1955833150
2025-03-13 13:16:35,101 [INFO]: 	avg_search_speed_ms: 11.77909176876753
2025-03-13 13:16:35,101 [INFO]: 	99p_search_speed_ms: 16.68535047210753
2025-03-13 13:16:35,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:35,101 [INFO]: 	nb vectors: 9941
2025-03-13 13:16:35,101 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:35,101 [INFO]: 	compression ratio: 0.9993082119504928
2025-03-13 13:16:35,101 [INFO]: }
2025-03-13 13:16:35,101 [INFO]: 	>>> Finished "Creating the index" in 115.8460 secs
2025-03-13 13:16:35,101 [INFO]: >>> Finished "Launching the whole pipeline" in 115.8710 secs
2025-03-13 13:16:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 33759 [episode count 17/20]
[retrieval_preprocessing] for episode 71521 [episode count 18/20], we have num_retrieval=np.int64(9952) num_query=np.int64(721)
2025-03-13 13:16:48,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:50,058 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:50
2025-03-13 13:16:50,058 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-13 13:16:50,698 [INFO]: There are 9952 embeddings of dim 49152
2025-03-13 13:16:50,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6407 secs
2025-03-13 13:16:50,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:50
2025-03-13 13:16:50,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:50,699 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 13:16:50,700 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:16:50,700 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:16:50,700 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:50
2025-03-13 13:16:50,700 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:50,700 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:16:50,700 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:50
2025-03-13 13:16:50,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:50,701 [INFO]: 	Creating the index 03/13/2025, 13:16:50
2025-03-13 13:16:50,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:50
2025-03-13 13:16:50,704 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:16:50,704 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:50
2025-03-13 13:16:50,704 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 13:16:50,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:10,  3.91it/s]  5%|▍         | 2/41 [00:00<00:07,  5.53it/s]  7%|▋         | 3/41 [00:00<00:05,  6.37it/s] 10%|▉         | 4/41 [00:00<00:05,  6.87it/s] 12%|█▏        | 5/41 [00:00<00:04,  7.28it/s] 15%|█▍        | 6/41 [00:00<00:04,  7.45it/s] 17%|█▋        | 7/41 [00:01<00:04,  7.55it/s] 20%|█▉        | 8/41 [00:01<00:04,  7.63it/s] 22%|██▏       | 9/41 [00:01<00:04,  7.64it/s] 24%|██▍       | 10/41 [00:01<00:03,  7.77it/s] 27%|██▋       | 11/41 [00:01<00:03,  7.77it/s] 29%|██▉       | 12/41 [00:01<00:03,  7.78it/s] 32%|███▏      | 13/41 [00:01<00:03,  7.91it/s] 37%|███▋      | 15/41 [00:01<00:02,  8.78it/s] 41%|████▏     | 17/41 [00:02<00:02,  9.84it/s] 46%|████▋     | 19/41 [00:02<00:02, 10.81it/s] 51%|█████     | 21/41 [00:06<00:15,  1.31it/s] 56%|█████▌    | 23/41 [00:06<00:09,  1.86it/s] 61%|██████    | 25/41 [00:06<00:06,  2.55it/s] 66%|██████▌   | 27/41 [00:06<00:04,  3.41it/s] 71%|███████   | 29/41 [00:07<00:02,  4.44it/s] 76%|███████▌  | 31/41 [00:07<00:01,  5.66it/s] 80%|████████  | 33/41 [00:07<00:01,  6.85it/s] 85%|████████▌ | 35/41 [00:07<00:00,  8.48it/s] 90%|█████████ | 37/41 [00:07<00:00,  9.85it/s] 95%|█████████▌| 39/41 [00:07<00:00, 11.09it/s]100%|██████████| 41/41 [00:12<00:00,  1.33it/s]100%|██████████| 41/41 [00:12<00:00,  3.35it/s]
2025-03-13 13:17:02,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:02
2025-03-13 13:18:09,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.8459 secs
2025-03-13 13:18:09,812 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 13:18:09,812 [INFO]: 	Compute fast metrics 03/13/2025, 13:18:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 13:18:53,689 [INFO]: 	>>> Finished "Compute fast metrics" in 43.8764 secs
2025-03-13 13:18:53,693 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.9883 secs
2025-03-13 13:18:53,693 [INFO]: {
2025-03-13 13:18:53,693 [INFO]: 	index_key: HNSW15
2025-03-13 13:18:53,693 [INFO]: 	index_param: efSearch=241
2025-03-13 13:18:53,693 [INFO]: 	index_path: knn.index
2025-03-13 13:18:53,693 [INFO]: 	size in bytes: 1957997290
2025-03-13 13:18:53,693 [INFO]: 	avg_search_speed_ms: 13.190586627633028
2025-03-13 13:18:53,693 [INFO]: 	99p_search_speed_ms: 18.487849060911678
2025-03-13 13:18:53,693 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:53,693 [INFO]: 	nb vectors: 9952
2025-03-13 13:18:53,693 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:53,693 [INFO]: 	compression ratio: 0.9993082349976082
2025-03-13 13:18:53,693 [INFO]: }
2025-03-13 13:18:53,693 [INFO]: 	>>> Finished "Creating the index" in 122.9921 secs
2025-03-13 13:18:53,693 [INFO]: >>> Finished "Launching the whole pipeline" in 123.6351 secs
2025-03-13 13:18:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 71521 [episode count 18/20]
[retrieval_preprocessing] for episode 77285 [episode count 19/20], we have num_retrieval=np.int64(10310) num_query=np.int64(363)
2025-03-13 13:19:07,231 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:08,713 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:08
2025-03-13 13:19:08,713 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.53it/s]
2025-03-13 13:19:08,741 [INFO]: There are 10310 embeddings of dim 49152
2025-03-13 13:19:08,742 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 13:19:08,742 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:08
2025-03-13 13:19:08,742 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:08,742 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 13:19:08,742 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:19:08,742 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:19:08,743 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:08
2025-03-13 13:19:08,743 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:08,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:19:08,743 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:08
2025-03-13 13:19:08,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 13:19:08,744 [INFO]: 	Creating the index 03/13/2025, 13:19:08
2025-03-13 13:19:08,744 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:19:08
2025-03-13 13:19:08,747 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 13:19:08,747 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:08
2025-03-13 13:19:08,748 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 13:19:08,748 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.65it/s]  7%|▋         | 3/43 [00:00<00:04,  8.53it/s] 12%|█▏        | 5/43 [00:00<00:03,  9.81it/s] 16%|█▋        | 7/43 [00:00<00:03, 10.50it/s] 21%|██        | 9/43 [00:00<00:03, 10.81it/s] 26%|██▌       | 11/43 [00:01<00:02, 10.93it/s] 30%|███       | 13/43 [00:01<00:02, 11.14it/s] 35%|███▍      | 15/43 [00:01<00:02, 11.22it/s] 40%|███▉      | 17/43 [00:01<00:02, 11.33it/s] 44%|████▍     | 19/43 [00:01<00:02, 11.51it/s] 49%|████▉     | 21/43 [00:07<00:20,  1.06it/s] 53%|█████▎    | 23/43 [00:07<00:13,  1.46it/s] 58%|█████▊    | 25/43 [00:07<00:08,  2.01it/s] 63%|██████▎   | 27/43 [00:07<00:05,  2.71it/s] 67%|██████▋   | 29/43 [00:08<00:03,  3.57it/s] 72%|███████▏  | 31/43 [00:08<00:02,  4.55it/s] 77%|███████▋  | 33/43 [00:08<00:01,  5.54it/s] 81%|████████▏ | 35/43 [00:08<00:01,  6.51it/s] 86%|████████▌ | 37/43 [00:08<00:00,  7.42it/s] 91%|█████████ | 39/43 [00:09<00:00,  8.18it/s] 95%|█████████▌| 41/43 [00:09<00:00,  8.83it/s]100%|██████████| 43/43 [00:19<00:00,  1.63s/it]100%|██████████| 43/43 [00:19<00:00,  2.20it/s]
2025-03-13 13:19:28,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:28
2025-03-13 13:20:42,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.9024 secs
2025-03-13 13:20:42,225 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 13:20:42,225 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 13:21:02,046 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8205 secs
2025-03-13 13:21:02,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.2989 secs
2025-03-13 13:21:02,046 [INFO]: {
2025-03-13 13:21:02,046 [INFO]: 	index_key: HNSW32
2025-03-13 13:21:02,046 [INFO]: 	index_param: efSearch=141
2025-03-13 13:21:02,046 [INFO]: 	index_path: knn.index
2025-03-13 13:21:02,046 [INFO]: 	size in bytes: 2029830698
2025-03-13 13:21:02,046 [INFO]: 	avg_search_speed_ms: 13.120246895288272
2025-03-13 13:21:02,046 [INFO]: 	99p_search_speed_ms: 20.90540674049407
2025-03-13 13:21:02,047 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:02,047 [INFO]: 	nb vectors: 10310
2025-03-13 13:21:02,047 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:02,047 [INFO]: 	compression ratio: 0.9986194819091262
2025-03-13 13:21:02,047 [INFO]: }
2025-03-13 13:21:02,047 [INFO]: 	>>> Finished "Creating the index" in 113.3025 secs
2025-03-13 13:21:02,047 [INFO]: >>> Finished "Launching the whole pipeline" in 113.3337 secs
2025-03-13 13:21:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 77285 [episode count 19/20]
2025-03-13 13:21:04: [retrieval_preprocessing] finished for 7844349127_box_to_backrest [chosen_id count 5/260]
2025-03-13 13:21:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7870099758_Pouring [chosen_id count 6/260]
2025-03-13 13:21:09: [retrieval_preprocessing] we have num_total=9649 embedding_dim=49152
[retrieval_preprocessing] for episode 46978 [episode count 0/20], we have num_retrieval=np.int64(9302) num_query=np.int64(347)
2025-03-13 13:21:11,168 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:12,488 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:12
2025-03-13 13:21:12,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1602.71it/s]
2025-03-13 13:21:12,517 [INFO]: There are 9302 embeddings of dim 49152
2025-03-13 13:21:12,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 13:21:12,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:12
2025-03-13 13:21:12,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:12,517 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 13:21:12,518 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:21:12,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:21:12,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:12
2025-03-13 13:21:12,518 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:12,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:21:12,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:12
2025-03-13 13:21:12,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:12,519 [INFO]: 	Creating the index 03/13/2025, 13:21:12
2025-03-13 13:21:12,519 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:12
2025-03-13 13:21:12,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:21:12,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:12
2025-03-13 13:21:12,522 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 13:21:12,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:07,  5.27it/s]  8%|▊         | 3/38 [00:00<00:03,  9.57it/s] 13%|█▎        | 5/38 [00:00<00:02, 11.31it/s] 18%|█▊        | 7/38 [00:00<00:02, 12.31it/s] 24%|██▎       | 9/38 [00:00<00:02, 12.18it/s] 29%|██▉       | 11/38 [00:00<00:02, 12.28it/s] 34%|███▍      | 13/38 [00:01<00:02, 11.04it/s] 39%|███▉      | 15/38 [00:01<00:02, 10.10it/s] 45%|████▍     | 17/38 [00:01<00:01, 10.68it/s] 50%|█████     | 19/38 [00:01<00:01, 11.02it/s] 55%|█████▌    | 21/38 [00:04<00:09,  1.84it/s] 58%|█████▊    | 22/38 [00:04<00:07,  2.15it/s] 63%|██████▎   | 24/38 [00:05<00:04,  2.99it/s] 68%|██████▊   | 26/38 [00:05<00:03,  3.97it/s] 74%|███████▎  | 28/38 [00:05<00:01,  5.06it/s] 79%|███████▉  | 30/38 [00:05<00:01,  6.40it/s] 84%|████████▍ | 32/38 [00:05<00:00,  7.95it/s] 89%|████████▉ | 34/38 [00:05<00:00,  8.95it/s] 95%|█████████▍| 36/38 [00:06<00:00,  9.81it/s]100%|██████████| 38/38 [00:09<00:00,  1.72it/s]100%|██████████| 38/38 [00:09<00:00,  4.04it/s]
2025-03-13 13:21:21,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:21
2025-03-13 13:22:17,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.4727 secs
2025-03-13 13:22:17,400 [INFO]: The best hyperparameters are: efSearch=325
2025-03-13 13:22:17,401 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 13:22:46,193 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7920 secs
2025-03-13 13:22:46,196 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.6736 secs
2025-03-13 13:22:46,196 [INFO]: {
2025-03-13 13:22:46,196 [INFO]: 	index_key: HNSW15
2025-03-13 13:22:46,196 [INFO]: 	index_param: efSearch=325
2025-03-13 13:22:46,196 [INFO]: 	index_path: knn.index
2025-03-13 13:22:46,196 [INFO]: 	size in bytes: 1830113710
2025-03-13 13:22:46,196 [INFO]: 	avg_search_speed_ms: 10.932038850888935
2025-03-13 13:22:46,196 [INFO]: 	99p_search_speed_ms: 19.510414665564895
2025-03-13 13:22:46,196 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:46,196 [INFO]: 	nb vectors: 9302
2025-03-13 13:22:46,196 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:46,196 [INFO]: 	compression ratio: 0.9993081883420238
2025-03-13 13:22:46,196 [INFO]: }
2025-03-13 13:22:46,196 [INFO]: 	>>> Finished "Creating the index" in 93.6774 secs
2025-03-13 13:22:46,196 [INFO]: >>> Finished "Launching the whole pipeline" in 93.7081 secs
2025-03-13 13:22:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:22:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 46978 [episode count 0/20]
[retrieval_preprocessing] for episode 9609 [episode count 1/20], we have num_retrieval=np.int64(9228) num_query=np.int64(421)
2025-03-13 13:22:52,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:54,234 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:54
2025-03-13 13:22:54,235 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.10it/s]
2025-03-13 13:22:54,261 [INFO]: There are 9228 embeddings of dim 49152
2025-03-13 13:22:54,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 13:22:54,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:54,262 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 13:22:54,262 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:22:54,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:22:54,262 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,262 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:54,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:22:54,262 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:54
2025-03-13 13:22:54,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:22:54,262 [INFO]: 	Creating the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,262 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:22:54
2025-03-13 13:22:54,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:22:54,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:54
2025-03-13 13:22:54,264 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 13:22:54,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:08,  4.23it/s]  5%|▌         | 2/38 [00:00<00:06,  5.86it/s]  8%|▊         | 3/38 [00:00<00:04,  7.14it/s] 11%|█         | 4/38 [00:00<00:04,  7.67it/s] 13%|█▎        | 5/38 [00:00<00:04,  7.99it/s] 16%|█▌        | 6/38 [00:00<00:03,  8.27it/s] 18%|█▊        | 7/38 [00:00<00:03,  8.47it/s] 24%|██▎       | 9/38 [00:01<00:02, 10.37it/s] 29%|██▉       | 11/38 [00:01<00:02, 10.58it/s] 34%|███▍      | 13/38 [00:01<00:02, 12.08it/s] 39%|███▉      | 15/38 [00:01<00:01, 13.54it/s] 45%|████▍     | 17/38 [00:01<00:01, 14.66it/s] 50%|█████     | 19/38 [00:01<00:01, 15.24it/s] 55%|█████▌    | 21/38 [00:04<00:09,  1.80it/s] 61%|██████    | 23/38 [00:05<00:06,  2.38it/s] 66%|██████▌   | 25/38 [00:05<00:04,  3.21it/s] 71%|███████   | 27/38 [00:05<00:02,  4.17it/s] 76%|███████▋  | 29/38 [00:05<00:01,  5.26it/s] 82%|████████▏ | 31/38 [00:05<00:01,  6.33it/s] 87%|████████▋ | 33/38 [00:05<00:00,  7.24it/s] 92%|█████████▏| 35/38 [00:06<00:00,  8.00it/s] 97%|█████████▋| 37/38 [00:06<00:00,  8.76it/s]100%|██████████| 38/38 [00:10<00:00,  3.71it/s]
2025-03-13 13:23:04,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:04
2025-03-13 13:24:01,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5280 secs
2025-03-13 13:24:01,041 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 13:24:01,041 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 13:24:33,106 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0649 secs
2025-03-13 13:24:33,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.8453 secs
2025-03-13 13:24:33,109 [INFO]: {
2025-03-13 13:24:33,109 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:33,109 [INFO]: 	index_param: efSearch=301
2025-03-13 13:24:33,109 [INFO]: 	index_path: knn.index
2025-03-13 13:24:33,109 [INFO]: 	size in bytes: 1815554590
2025-03-13 13:24:33,109 [INFO]: 	avg_search_speed_ms: 10.300716135629772
2025-03-13 13:24:33,109 [INFO]: 	99p_search_speed_ms: 14.129395247437056
2025-03-13 13:24:33,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:33,109 [INFO]: 	nb vectors: 9228
2025-03-13 13:24:33,109 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:33,109 [INFO]: 	compression ratio: 0.9993082190935388
2025-03-13 13:24:33,109 [INFO]: }
2025-03-13 13:24:33,109 [INFO]: 	>>> Finished "Creating the index" in 98.8469 secs
2025-03-13 13:24:33,109 [INFO]: >>> Finished "Launching the whole pipeline" in 98.8746 secs
2025-03-13 13:24:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 9609 [episode count 1/20]
[retrieval_preprocessing] for episode 33810 [episode count 2/20], we have num_retrieval=np.int64(9277) num_query=np.int64(372)
2025-03-13 13:24:41,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:43,213 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:43
2025-03-13 13:24:43,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1327.73it/s]
2025-03-13 13:24:43,240 [INFO]: There are 9277 embeddings of dim 49152
2025-03-13 13:24:43,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 13:24:43,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:43
2025-03-13 13:24:43,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:43,241 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 13:24:43,241 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:24:43,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 13:24:43,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:43
2025-03-13 13:24:43,241 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:43,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:24:43,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:43
2025-03-13 13:24:43,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:43,242 [INFO]: 	Creating the index 03/13/2025, 13:24:43
2025-03-13 13:24:43,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:43
2025-03-13 13:24:43,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 13:24:43,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:43
2025-03-13 13:24:43,246 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 13:24:43,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:07,  4.67it/s]  5%|▌         | 2/38 [00:00<00:05,  6.42it/s]  8%|▊         | 3/38 [00:00<00:04,  7.28it/s] 11%|█         | 4/38 [00:00<00:04,  7.88it/s] 13%|█▎        | 5/38 [00:00<00:03,  8.31it/s] 16%|█▌        | 6/38 [00:00<00:03,  8.66it/s] 18%|█▊        | 7/38 [00:00<00:03,  8.65it/s] 21%|██        | 8/38 [00:00<00:03,  8.85it/s] 26%|██▋       | 10/38 [00:01<00:03,  9.25it/s] 29%|██▉       | 11/38 [00:01<00:02,  9.32it/s] 32%|███▏      | 12/38 [00:01<00:02,  9.42it/s] 34%|███▍      | 13/38 [00:01<00:02,  9.56it/s] 39%|███▉      | 15/38 [00:01<00:02, 10.24it/s] 45%|████▍     | 17/38 [00:01<00:01, 11.58it/s] 50%|█████     | 19/38 [00:01<00:01, 12.49it/s] 55%|█████▌    | 21/38 [00:05<00:10,  1.68it/s] 58%|█████▊    | 22/38 [00:05<00:08,  1.99it/s] 61%|██████    | 23/38 [00:05<00:06,  2.40it/s] 63%|██████▎   | 24/38 [00:05<00:04,  2.91it/s] 66%|██████▌   | 25/38 [00:05<00:03,  3.52it/s] 68%|██████▊   | 26/38 [00:05<00:02,  4.20it/s] 71%|███████   | 27/38 [00:05<00:02,  4.93it/s] 74%|███████▎  | 28/38 [00:05<00:01,  5.70it/s] 76%|███████▋  | 29/38 [00:06<00:01,  6.37it/s] 79%|███████▉  | 30/38 [00:06<00:01,  6.96it/s] 82%|████████▏ | 31/38 [00:06<00:00,  7.47it/s] 84%|████████▍ | 32/38 [00:06<00:00,  7.86it/s] 87%|████████▋ | 33/38 [00:06<00:00,  8.16it/s] 89%|████████▉ | 34/38 [00:06<00:00,  8.42it/s] 92%|█████████▏| 35/38 [00:06<00:00,  8.38it/s] 95%|█████████▍| 36/38 [00:06<00:00,  8.50it/s] 97%|█████████▋| 37/38 [00:06<00:00,  8.57it/s]100%|██████████| 38/38 [00:10<00:00,  1.20s/it]100%|██████████| 38/38 [00:10<00:00,  3.56it/s]
2025-03-13 13:24:53,937 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:53
2025-03-13 13:25:51,298 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.3601 secs
2025-03-13 13:25:51,298 [INFO]: The best hyperparameters are: efSearch=319
2025-03-13 13:25:51,298 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
2025-03-13 13:26:18,713 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4144 secs
2025-03-13 13:26:19,392 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.1462 secs
2025-03-13 13:26:19,392 [INFO]: {
2025-03-13 13:26:19,392 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:19,392 [INFO]: 	index_param: efSearch=319
2025-03-13 13:26:19,392 [INFO]: 	index_path: knn.index
2025-03-13 13:26:19,392 [INFO]: 	size in bytes: 1825195150
2025-03-13 13:26:19,392 [INFO]: 	avg_search_speed_ms: 10.780194477962956
2025-03-13 13:26:19,392 [INFO]: 	99p_search_speed_ms: 19.202984259463847
2025-03-13 13:26:19,392 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:19,393 [INFO]: 	nb vectors: 9277
2025-03-13 13:26:19,393 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:19,393 [INFO]: 	compression ratio: 0.9993081649378698
2025-03-13 13:26:19,393 [INFO]: }
2025-03-13 13:26:19,393 [INFO]: 	>>> Finished "Creating the index" in 96.1506 secs
2025-03-13 13:26:19,393 [INFO]: >>> Finished "Launching the whole pipeline" in 96.1801 secs
2025-03-13 13:26:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 33810 [episode count 2/20]
[retrieval_preprocessing] for episode 83986 [episode count 3/20], we have num_retrieval=np.int64(9273) num_query=np.int64(376)
2025-03-13 13:26:26,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:28,607 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:28
2025-03-13 13:26:28,607 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.77it/s]
2025-03-13 13:26:29,357 [INFO]: There are 9273 embeddings of dim 49152
2025-03-13 13:26:29,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7496 secs
2025-03-13 13:26:29,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:29
2025-03-13 13:26:29,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:29,357 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 13:26:29,357 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:26:29,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:26:29,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:29
2025-03-13 13:26:29,358 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:29,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:26:29,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:29
2025-03-13 13:26:29,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:29,358 [INFO]: 	Creating the index 03/13/2025, 13:26:29
2025-03-13 13:26:29,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:29
2025-03-13 13:26:29,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 13:26:29,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:29
2025-03-13 13:26:29,361 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 13:26:29,361 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:07,  4.99it/s]  8%|▊         | 3/38 [00:00<00:03,  9.83it/s] 21%|██        | 8/38 [00:00<00:01, 22.25it/s] 34%|███▍      | 13/38 [00:00<00:00, 29.37it/s] 47%|████▋     | 18/38 [00:00<00:00, 34.01it/s] 58%|█████▊    | 22/38 [00:04<00:04,  3.43it/s] 68%|██████▊   | 26/38 [00:04<00:02,  4.82it/s] 79%|███████▉  | 30/38 [00:04<00:01,  6.61it/s] 89%|████████▉ | 34/38 [00:04<00:00,  8.13it/s] 97%|█████████▋| 37/38 [00:04<00:00,  8.33it/s]100%|██████████| 38/38 [00:08<00:00,  4.37it/s]
2025-03-13 13:26:38,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:38
2025-03-13 13:27:41,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.1308 secs
2025-03-13 13:27:41,202 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 13:27:41,203 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s]
2025-03-13 13:28:07,966 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7635 secs
2025-03-13 13:28:07,969 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.6088 secs
2025-03-13 13:28:07,970 [INFO]: {
2025-03-13 13:28:07,970 [INFO]: 	index_key: HNSW15
2025-03-13 13:28:07,970 [INFO]: 	index_param: efSearch=300
2025-03-13 13:28:07,970 [INFO]: 	index_path: knn.index
2025-03-13 13:28:07,970 [INFO]: 	size in bytes: 1824408190
2025-03-13 13:28:07,970 [INFO]: 	avg_search_speed_ms: 10.41620026287331
2025-03-13 13:28:07,970 [INFO]: 	99p_search_speed_ms: 23.18718265742063
2025-03-13 13:28:07,970 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:28:07,970 [INFO]: 	nb vectors: 9273
2025-03-13 13:28:07,970 [INFO]: 	vectors dimension: 49152
2025-03-13 13:28:07,970 [INFO]: 	compression ratio: 0.9993081559231545
2025-03-13 13:28:07,970 [INFO]: }
2025-03-13 13:28:07,970 [INFO]: 	>>> Finished "Creating the index" in 98.6115 secs
2025-03-13 13:28:07,970 [INFO]: >>> Finished "Launching the whole pipeline" in 99.3625 secs
2025-03-13 13:28:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:28:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 83986 [episode count 3/20]
[retrieval_preprocessing] for episode 53270 [episode count 4/20], we have num_retrieval=np.int64(8994) num_query=np.int64(655)
2025-03-13 13:28:15,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:28:17,318 [INFO]: Launching the whole pipeline 03/13/2025, 13:28:17
2025-03-13 13:28:17,319 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:28:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1224.26it/s]
2025-03-13 13:28:17,345 [INFO]: There are 8994 embeddings of dim 49152
2025-03-13 13:28:17,345 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 13:28:17,345 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:28:17
2025-03-13 13:28:17,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:28:17,345 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 13:28:17,345 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:28:17,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:28:17,345 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:28:17
2025-03-13 13:28:17,345 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:28:17,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:28:17,345 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:28:17
2025-03-13 13:28:17,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:28:17,345 [INFO]: 	Creating the index 03/13/2025, 13:28:17
2025-03-13 13:28:17,346 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:28:17
2025-03-13 13:28:17,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:28:17,346 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:28:17
2025-03-13 13:28:17,347 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 13:28:17,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:07,  4.92it/s]  8%|▊         | 3/37 [00:00<00:03,  8.94it/s] 14%|█▎        | 5/37 [00:00<00:03, 10.59it/s] 19%|█▉        | 7/37 [00:00<00:02, 11.68it/s] 24%|██▍       | 9/37 [00:00<00:02, 12.04it/s] 30%|██▉       | 11/37 [00:00<00:02, 12.46it/s] 35%|███▌      | 13/37 [00:01<00:01, 12.29it/s] 41%|████      | 15/37 [00:01<00:01, 13.30it/s] 54%|█████▍    | 20/37 [00:01<00:00, 20.72it/s] 62%|██████▏   | 23/37 [00:04<00:05,  2.59it/s] 68%|██████▊   | 25/37 [00:04<00:03,  3.22it/s] 73%|███████▎  | 27/37 [00:05<00:02,  3.95it/s] 78%|███████▊  | 29/37 [00:05<00:01,  4.74it/s] 84%|████████▍ | 31/37 [00:05<00:01,  5.67it/s] 89%|████████▉ | 33/37 [00:05<00:00,  6.53it/s] 95%|█████████▍| 35/37 [00:05<00:00,  7.77it/s]100%|██████████| 37/37 [00:09<00:00,  1.61it/s]100%|██████████| 37/37 [00:09<00:00,  3.95it/s]
2025-03-13 13:28:26,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:28:26
2025-03-13 13:29:23,865 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1531 secs
2025-03-13 13:29:23,865 [INFO]: The best hyperparameters are: efSearch=310
2025-03-13 13:29:23,865 [INFO]: 	Compute fast metrics 03/13/2025, 13:29:23
