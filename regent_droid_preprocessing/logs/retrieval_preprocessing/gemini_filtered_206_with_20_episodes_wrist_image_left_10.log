Using cache found in /home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
2025-03-13 14:54:43: [embed_episodes] skipping episode 90112 [episode count 0/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 49156 [episode count 1/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 83988 [episode count 2/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 32791 [episode count 3/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 59439 [episode count 4/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 8242 [episode count 5/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 26858 [episode count 6/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 24854 [episode count 7/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 33061 [episode count 8/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 21096 [episode count 9/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 94764 [episode count 10/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 88627 [episode count 11/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 53833 [episode count 12/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 74370 [episode count 13/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 17037 [episode count 14/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 76433 [episode count 15/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 68269 [episode count 16/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 23252 [episode count 17/20]
2025-03-13 14:54:43: [embed_episodes] skipping episode 80598 [episode count 18/20]
2025-03-13 14:54:48: [embed_episodes] embedded episode 45785 with 161 steps [episode count 19/20]
2025-03-13 14:54:48: [embed_episodes] finished embedding all episodes for 4823049285_place_block_in_bowl [chosen_id count 0/196]
2025-03-13 14:54:48: [embed_episodes] skipping episode 81936 [episode count 0/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 84082 [episode count 1/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 67636 [episode count 2/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 14588 [episode count 3/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 2316 [episode count 4/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 49700 [episode count 5/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 46173 [episode count 6/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 87874 [episode count 7/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 21354 [episode count 8/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 35701 [episode count 9/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 78972 [episode count 10/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 46240 [episode count 11/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 42236 [episode count 12/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 15769 [episode count 13/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 91554 [episode count 14/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 28395 [episode count 15/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 50602 [episode count 16/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 22200 [episode count 17/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 54988 [episode count 18/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 94906 [episode count 19/20]
2025-03-13 14:54:48: [embed_episodes] finished embedding all episodes for 4823049285_remove_bottle_from_tray_and_place_on_table [chosen_id count 1/196]
2025-03-13 14:54:48: [embed_episodes] skipping episode 88072 [episode count 0/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 6203 [episode count 1/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 12571 [episode count 2/20]
2025-03-13 14:54:48: [embed_episodes] skipping episode 89110 [episode count 3/20]
2025-03-13 14:54:49: [embed_episodes] embedded episode 1065 with 107 steps [episode count 4/20]
2025-03-13 14:54:51: [embed_episodes] embedded episode 38049 with 109 steps [episode count 5/20]
2025-03-13 14:54:53: [embed_episodes] embedded episode 79321 with 114 steps [episode count 6/20]
2025-03-13 14:54:55: [embed_episodes] embedded episode 93192 with 86 steps [episode count 7/20]
2025-03-13 14:54:57: [embed_episodes] embedded episode 43319 with 154 steps [episode count 8/20]
2025-03-13 14:54:59: [embed_episodes] embedded episode 33639 with 112 steps [episode count 9/20]
2025-03-13 14:55:00: [embed_episodes] embedded episode 10683 with 74 steps [episode count 10/20]
2025-03-13 14:55:03: [embed_episodes] embedded episode 40892 with 155 steps [episode count 11/20]
2025-03-13 14:55:05: [embed_episodes] embedded episode 85274 with 142 steps [episode count 12/20]
2025-03-13 14:55:29: [embed_episodes] embedded episode 50376 with 235 steps [episode count 13/20]
2025-03-13 14:55:31: [embed_episodes] embedded episode 66789 with 122 steps [episode count 14/20]
2025-03-13 14:55:34: [embed_episodes] embedded episode 30318 with 194 steps [episode count 15/20]
2025-03-13 14:55:36: [embed_episodes] embedded episode 40938 with 131 steps [episode count 16/20]
2025-03-13 14:55:38: [embed_episodes] embedded episode 50416 with 130 steps [episode count 17/20]
2025-03-13 14:55:40: [embed_episodes] embedded episode 18301 with 112 steps [episode count 18/20]
2025-03-13 14:55:42: [embed_episodes] embedded episode 76992 with 142 steps [episode count 19/20]
2025-03-13 14:55:42: [embed_episodes] finished embedding all episodes for 4823049285_turn_on_switch [chosen_id count 2/196]
2025-03-13 14:55:42: [embed_episodes] skipping episode 30235 [episode count 0/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 77342 [episode count 1/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 3637 [episode count 2/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 85564 [episode count 3/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 3649 [episode count 4/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 20548 [episode count 5/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 54355 [episode count 6/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 20714 [episode count 7/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 47341 [episode count 8/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 49401 [episode count 9/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 48384 [episode count 10/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 91410 [episode count 11/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 56599 [episode count 12/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 77084 [episode count 13/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 21864 [episode count 14/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 41323 [episode count 15/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 8050 [episode count 16/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 31609 [episode count 17/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 28539 [episode count 18/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 8588 [episode count 19/20]
2025-03-13 14:55:42: [embed_episodes] finished embedding all episodes for 484659531_put_marker_in_cup [chosen_id count 3/196]
2025-03-13 14:55:42: [embed_episodes] skipping episode 75791 [episode count 0/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 73760 [episode count 1/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 19495 [episode count 2/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 6193 [episode count 3/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 14936 [episode count 4/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 13950 [episode count 5/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 11887 [episode count 6/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 43121 [episode count 7/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 16064 [episode count 8/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 59084 [episode count 9/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 20198 [episode count 10/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 21232 [episode count 11/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 8437 [episode count 12/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 43303 [episode count 13/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 33089 [episode count 14/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 8004 [episode count 15/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 47001 [episode count 16/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 92060 [episode count 17/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 74143 [episode count 18/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 14757 [episode count 19/20]
2025-03-13 14:55:42: [embed_episodes] finished embedding all episodes for 4846810092_hang_cloth_on_stand [chosen_id count 4/196]
2025-03-13 14:55:42: [embed_episodes] skipping episode 28163 [episode count 0/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 77316 [episode count 1/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 19527 [episode count 2/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 32350 [episode count 3/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 50811 [episode count 4/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 68264 [episode count 5/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 80055 [episode count 6/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 77002 [episode count 7/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 72925 [episode count 8/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 30434 [episode count 9/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 61734 [episode count 10/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 86327 [episode count 11/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 95549 [episode count 12/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 50013 [episode count 13/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 87914 [episode count 14/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 22895 [episode count 15/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 42370 [episode count 16/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 80300 [episode count 17/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 2483 [episode count 18/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 43157 [episode count 19/20]
2025-03-13 14:55:42: [embed_episodes] finished embedding all episodes for 4846810092_put_cloth_on_table [chosen_id count 5/196]
2025-03-13 14:55:42: [embed_episodes] skipping episode 65051 [episode count 0/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 67100 [episode count 1/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 23087 [episode count 2/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 64564 [episode count 3/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 87630 [episode count 4/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 66652 [episode count 5/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 84573 [episode count 6/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 20068 [episode count 7/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 28274 [episode count 8/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 1167 [episode count 9/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 84131 [episode count 10/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 2740 [episode count 11/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 20154 [episode count 12/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 73930 [episode count 13/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 213 [episode count 14/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 68841 [episode count 15/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 89326 [episode count 16/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 39173 [episode count 17/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 57611 [episode count 18/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 83230 [episode count 19/20]
2025-03-13 14:55:42: [embed_episodes] finished embedding all episodes for 488975025_put_one_slice_of_bread_in_toaster [chosen_id count 6/196]
2025-03-13 14:55:42: [embed_episodes] skipping episode 6666 [episode count 0/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 68625 [episode count 1/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 29213 [episode count 2/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 1572 [episode count 3/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 8790 [episode count 4/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 76900 [episode count 5/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 91762 [episode count 6/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 7388 [episode count 7/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 84191 [episode count 8/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 7927 [episode count 9/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 72962 [episode count 10/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 60703 [episode count 11/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 84267 [episode count 12/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 48996 [episode count 13/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 87423 [episode count 14/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 75688 [episode count 15/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 4587 [episode count 16/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 12049 [episode count 17/20]
2025-03-13 14:55:42: [embed_episodes] skipping episode 73681 [episode count 18/20]
2025-03-13 14:56:20: [embed_episodes] embedded episode 62930 with 497 steps [episode count 19/20]
2025-03-13 14:56:20: [embed_episodes] finished embedding all episodes for 488975025_put_two_slices_of_bread_in_toaster [chosen_id count 7/196]
2025-03-13 14:56:20: [embed_episodes] skipping episode 56833 [episode count 0/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 49686 [episode count 1/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 37931 [episode count 2/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 15409 [episode count 3/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 51764 [episode count 4/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 94810 [episode count 5/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 90221 [episode count 6/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 32923 [episode count 7/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 62121 [episode count 8/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 78517 [episode count 9/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 45238 [episode count 10/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 89803 [episode count 11/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 42732 [episode count 12/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 80117 [episode count 13/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 27414 [episode count 14/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 68470 [episode count 15/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 13189 [episode count 16/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 39409 [episode count 17/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 49654 [episode count 18/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 28486 [episode count 19/20]
2025-03-13 14:56:20: [embed_episodes] finished embedding all episodes for 488975025_push_down_toaster_lever [chosen_id count 8/196]
2025-03-13 14:56:20: [embed_episodes] skipping episode 67077 [episode count 0/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 67213 [episode count 1/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 6161 [episode count 2/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 18832 [episode count 3/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 42515 [episode count 4/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 6300 [episode count 5/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 28449 [episode count 6/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 49954 [episode count 7/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 5795 [episode count 8/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 88110 [episode count 9/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 36018 [episode count 10/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 52920 [episode count 11/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 78904 [episode count 12/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 89911 [episode count 13/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 54977 [episode count 14/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 10950 [episode count 15/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 51028 [episode count 16/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 45018 [episode count 17/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 5343 [episode count 18/20]
2025-03-13 14:56:20: [embed_episodes] skipping episode 75629 [episode count 19/20]
2025-03-13 14:56:20: [embed_episodes] finished embedding all episodes for 4938854758_put_pen_in_cup [chosen_id count 9/196]
2025-03-13 14:56:20: [embed_episodes] done!
2025-03-13 14:56:20: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:56:45: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4823049285_place_block_in_bowl [chosen_id count 0/196]
2025-03-13 14:56:45: [retrieval_preprocessing] we have num_total=3402 embedding_dim=49152
[retrieval_preprocessing] for episode 90112 [episode count 0/20], we have num_retrieval=np.int64(3249) num_query=np.int64(153)
2025-03-13 14:56:45,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:46,295 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:46
2025-03-13 14:56:46,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 720.42it/s]
2025-03-13 14:56:46,337 [INFO]: There are 3249 embeddings of dim 49152
2025-03-13 14:56:46,337 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0424 secs
2025-03-13 14:56:46,338 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,338 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:46,338 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:56:46,338 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:46,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:56:46,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,340 [INFO]: 670.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:46,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0017 secs
2025-03-13 14:56:46,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:46
2025-03-13 14:56:46,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:46,341 [INFO]: 	Creating the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:46
2025-03-13 14:56:46,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 14:56:46,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,344 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:56:46,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:20,  1.70s/it] 15%|█▌        | 2/13 [00:03<00:16,  1.47s/it] 23%|██▎       | 3/13 [00:03<00:08,  1.16it/s] 31%|███       | 4/13 [00:09<00:28,  3.18s/it] 38%|███▊      | 5/13 [00:09<00:16,  2.07s/it] 46%|████▌     | 6/13 [00:10<00:09,  1.40s/it] 62%|██████▏   | 8/13 [00:10<00:03,  1.34it/s] 77%|███████▋  | 10/13 [00:10<00:01,  2.11it/s] 92%|█████████▏| 12/13 [00:10<00:00,  3.06it/s]100%|██████████| 13/13 [00:13<00:00,  1.06s/it]
2025-03-13 14:57:00,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:00
2025-03-13 14:57:48,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3892 secs
2025-03-13 14:57:48,507 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 14:57:48,507 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 14:58:12,869 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3626 secs
2025-03-13 14:58:12,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.5332 secs
2025-03-13 14:58:12,878 [INFO]: {
2025-03-13 14:58:12,878 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:12,878 [INFO]: 	index_param: efSearch=252
2025-03-13 14:58:12,878 [INFO]: 	index_path: knn.index
2025-03-13 14:58:12,878 [INFO]: 	size in bytes: 639220990
2025-03-13 14:58:12,878 [INFO]: 	avg_search_speed_ms: 11.682286537328526
2025-03-13 14:58:12,878 [INFO]: 	99p_search_speed_ms: 20.171822910197093
2025-03-13 14:58:12,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:12,878 [INFO]: 	nb vectors: 3249
2025-03-13 14:58:12,878 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:12,878 [INFO]: 	compression ratio: 0.9993091622351137
2025-03-13 14:58:12,878 [INFO]: }
2025-03-13 14:58:12,878 [INFO]: 	>>> Finished "Creating the index" in 86.5367 secs
2025-03-13 14:58:12,878 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5832 secs
2025-03-13 14:58:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 90112 [episode count 0/20]
[retrieval_preprocessing] for episode 49156 [episode count 1/20], we have num_retrieval=np.int64(3253) num_query=np.int64(149)
2025-03-13 14:58:16,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:17,160 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:17
2025-03-13 14:58:17,160 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.79it/s]
2025-03-13 14:58:17,188 [INFO]: There are 3253 embeddings of dim 49152
2025-03-13 14:58:17,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 14:58:17,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:17,189 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:58:17,189 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:17,189 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:58:17,189 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,189 [INFO]: 671.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:17,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:58:17,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:17
2025-03-13 14:58:17,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:17,189 [INFO]: 	Creating the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:17
2025-03-13 14:58:17,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:58:17,191 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:17
2025-03-13 14:58:17,191 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:58:17,191 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.13it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.24it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.71it/s] 31%|███       | 4/13 [00:00<00:01,  6.97it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.17it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.52it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.15it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.24it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.14it/s]100%|██████████| 13/13 [00:05<00:00,  1.16it/s]100%|██████████| 13/13 [00:05<00:00,  2.30it/s]
2025-03-13 14:58:22,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:22
2025-03-13 14:59:06,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5602 secs
2025-03-13 14:59:06,411 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 14:59:06,411 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 14:59:32,201 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7900 secs
2025-03-13 14:59:32,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3419 secs
2025-03-13 14:59:32,533 [INFO]: {
2025-03-13 14:59:32,533 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:32,533 [INFO]: 	index_param: efSearch=241
2025-03-13 14:59:32,533 [INFO]: 	index_path: knn.index
2025-03-13 14:59:32,533 [INFO]: 	size in bytes: 640007950
2025-03-13 14:59:32,533 [INFO]: 	avg_search_speed_ms: 10.716238072080117
2025-03-13 14:59:32,533 [INFO]: 	99p_search_speed_ms: 16.992831723764514
2025-03-13 14:59:32,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:32,533 [INFO]: 	nb vectors: 3253
2025-03-13 14:59:32,533 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:32,533 [INFO]: 	compression ratio: 0.9993091867061964
2025-03-13 14:59:32,533 [INFO]: }
2025-03-13 14:59:32,534 [INFO]: 	>>> Finished "Creating the index" in 75.3444 secs
2025-03-13 14:59:32,534 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3738 secs
2025-03-13 14:59:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 49156 [episode count 1/20]
[retrieval_preprocessing] for episode 83988 [episode count 2/20], we have num_retrieval=np.int64(3226) num_query=np.int64(176)
2025-03-13 14:59:35,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:35,862 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:35
2025-03-13 14:59:35,862 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1627.59it/s]
2025-03-13 14:59:35,885 [INFO]: There are 3226 embeddings of dim 49152
2025-03-13 14:59:35,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 14:59:35,885 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:35
2025-03-13 14:59:35,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:35,885 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 14:59:35,885 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:35,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:59:35,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:35
2025-03-13 14:59:35,886 [INFO]: 665.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:35,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:35,886 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:35
2025-03-13 14:59:35,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:35,886 [INFO]: 	Creating the index 03/13/2025, 14:59:35
2025-03-13 14:59:35,886 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:35
2025-03-13 14:59:35,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 14:59:35,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:35
2025-03-13 14:59:35,888 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:59:35,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.12it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.70it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.42it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.53it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.98it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.87it/s]100%|██████████| 13/13 [00:03<00:00,  1.97it/s]100%|██████████| 13/13 [00:03<00:00,  3.72it/s]
2025-03-13 14:59:39,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:39
2025-03-13 15:00:20,194 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8063 secs
2025-03-13 15:00:20,194 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:00:20,194 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.36it/s] 50%|█████     | 2/4 [00:00<00:00,  5.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.40it/s]
2025-03-13 15:00:46,214 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0199 secs
2025-03-13 15:00:46,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3290 secs
2025-03-13 15:00:46,217 [INFO]: {
2025-03-13 15:00:46,217 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:46,217 [INFO]: 	index_param: efSearch=221
2025-03-13 15:00:46,217 [INFO]: 	index_path: knn.index
2025-03-13 15:00:46,217 [INFO]: 	size in bytes: 634695670
2025-03-13 15:00:46,217 [INFO]: 	avg_search_speed_ms: 10.12847627930177
2025-03-13 15:00:46,217 [INFO]: 	99p_search_speed_ms: 17.330428771674633
2025-03-13 15:00:46,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:46,217 [INFO]: 	nb vectors: 3226
2025-03-13 15:00:46,217 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:46,217 [INFO]: 	compression ratio: 0.9993094926896224
2025-03-13 15:00:46,217 [INFO]: }
2025-03-13 15:00:46,218 [INFO]: 	>>> Finished "Creating the index" in 70.3316 secs
2025-03-13 15:00:46,218 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3551 secs
2025-03-13 15:00:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 83988 [episode count 2/20]
[retrieval_preprocessing] for episode 32791 [episode count 3/20], we have num_retrieval=np.int64(3222) num_query=np.int64(180)
2025-03-13 15:00:49,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:50,244 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:50
2025-03-13 15:00:50,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.13it/s]
2025-03-13 15:00:50,268 [INFO]: There are 3222 embeddings of dim 49152
2025-03-13 15:00:50,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 15:00:50,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:50
2025-03-13 15:00:50,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:50,268 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:00:50,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:50,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:00:50,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:50
2025-03-13 15:00:50,268 [INFO]: 664.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:50,268 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:00:50,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:50
2025-03-13 15:00:50,268 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:50,269 [INFO]: 	Creating the index 03/13/2025, 15:00:50
2025-03-13 15:00:50,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:50
2025-03-13 15:00:50,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:00:50,270 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:50
2025-03-13 15:00:50,270 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:00:50,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.77it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.22it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.90it/s] 31%|███       | 4/13 [00:00<00:01,  7.29it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.54it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.74it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.10it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.10it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.99it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.59it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.37it/s]100%|██████████| 13/13 [00:04<00:00,  1.12it/s]100%|██████████| 13/13 [00:04<00:00,  3.05it/s]
2025-03-13 15:00:54,538 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:54
2025-03-13 15:01:36,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2956 secs
2025-03-13 15:01:36,835 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 15:01:36,835 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 15:02:12,712 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8774 secs
2025-03-13 15:02:12,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4456 secs
2025-03-13 15:02:12,715 [INFO]: {
2025-03-13 15:02:12,716 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:12,716 [INFO]: 	index_param: efSearch=275
2025-03-13 15:02:12,716 [INFO]: 	index_path: knn.index
2025-03-13 15:02:12,716 [INFO]: 	size in bytes: 633908590
2025-03-13 15:02:12,716 [INFO]: 	avg_search_speed_ms: 10.675749749446183
2025-03-13 15:02:12,716 [INFO]: 	99p_search_speed_ms: 21.665994795039293
2025-03-13 15:02:12,716 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:12,716 [INFO]: 	nb vectors: 3222
2025-03-13 15:02:12,716 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:12,716 [INFO]: 	compression ratio: 0.9993096575643501
2025-03-13 15:02:12,716 [INFO]: }
2025-03-13 15:02:12,716 [INFO]: 	>>> Finished "Creating the index" in 82.4471 secs
2025-03-13 15:02:12,716 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4712 secs
2025-03-13 15:02:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 32791 [episode count 3/20]
[retrieval_preprocessing] for episode 59439 [episode count 4/20], we have num_retrieval=np.int64(3248) num_query=np.int64(154)
2025-03-13 15:02:15,950 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:16,448 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:16
2025-03-13 15:02:16,448 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.34it/s]
2025-03-13 15:02:16,472 [INFO]: There are 3248 embeddings of dim 49152
2025-03-13 15:02:16,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 15:02:16,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:16,472 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:02:16,472 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:16,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:16,472 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,472 [INFO]: 670.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:16,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:02:16,472 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:16
2025-03-13 15:02:16,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:16,472 [INFO]: 	Creating the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,472 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:16
2025-03-13 15:02:16,473 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:02:16,473 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:16
2025-03-13 15:02:16,473 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:02:16,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.76it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.68it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.61it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.20it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.34it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.34it/s]100%|██████████| 13/13 [00:03<00:00,  2.20it/s]100%|██████████| 13/13 [00:03<00:00,  3.88it/s]
2025-03-13 15:02:19,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:19
2025-03-13 15:03:05,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2962 secs
2025-03-13 15:03:05,128 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 15:03:05,128 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 15:03:32,657 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5279 secs
2025-03-13 15:03:32,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.4923 secs
2025-03-13 15:03:32,966 [INFO]: {
2025-03-13 15:03:32,966 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:32,966 [INFO]: 	index_param: efSearch=222
2025-03-13 15:03:32,966 [INFO]: 	index_path: knn.index
2025-03-13 15:03:32,966 [INFO]: 	size in bytes: 639024250
2025-03-13 15:03:32,966 [INFO]: 	avg_search_speed_ms: 9.551081066122128
2025-03-13 15:03:32,966 [INFO]: 	99p_search_speed_ms: 13.203847003169358
2025-03-13 15:03:32,966 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:32,966 [INFO]: 	nb vectors: 3248
2025-03-13 15:03:32,966 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:32,967 [INFO]: 	compression ratio: 0.9993091561079255
2025-03-13 15:03:32,967 [INFO]: }
2025-03-13 15:03:32,967 [INFO]: 	>>> Finished "Creating the index" in 76.4943 secs
2025-03-13 15:03:32,967 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5183 secs
2025-03-13 15:03:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 59439 [episode count 4/20]
[retrieval_preprocessing] for episode 8242 [episode count 5/20], we have num_retrieval=np.int64(3250) num_query=np.int64(152)
2025-03-13 15:03:35,431 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:36,346 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:36
2025-03-13 15:03:36,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1592.98it/s]
2025-03-13 15:03:36,378 [INFO]: There are 3250 embeddings of dim 49152
2025-03-13 15:03:36,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 15:03:36,379 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:36
2025-03-13 15:03:36,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:36,379 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:03:36,379 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:36,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:03:36,379 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:36
2025-03-13 15:03:36,379 [INFO]: 670.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:36,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:03:36,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:36
2025-03-13 15:03:36,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:36,379 [INFO]: 	Creating the index 03/13/2025, 15:03:36
2025-03-13 15:03:36,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:36
2025-03-13 15:03:36,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:03:36,381 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:36
2025-03-13 15:03:36,381 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:03:36,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.51it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.40it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.33it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.38it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.40it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.08it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.65it/s]100%|██████████| 13/13 [00:03<00:00,  1.98it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]
2025-03-13 15:03:40,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:40
2025-03-13 15:04:18,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3384 secs
2025-03-13 15:04:18,352 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 15:04:18,352 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.25it/s]
2025-03-13 15:04:42,380 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0277 secs
2025-03-13 15:04:42,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3367 secs
2025-03-13 15:04:42,718 [INFO]: {
2025-03-13 15:04:42,718 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:42,718 [INFO]: 	index_param: efSearch=241
2025-03-13 15:04:42,718 [INFO]: 	index_path: knn.index
2025-03-13 15:04:42,718 [INFO]: 	size in bytes: 639417730
2025-03-13 15:04:42,718 [INFO]: 	avg_search_speed_ms: 10.282985006295382
2025-03-13 15:04:42,718 [INFO]: 	99p_search_speed_ms: 13.969764839857817
2025-03-13 15:04:42,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:42,718 [INFO]: 	nb vectors: 3250
2025-03-13 15:04:42,718 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:42,718 [INFO]: 	compression ratio: 0.9993091683585315
2025-03-13 15:04:42,719 [INFO]: }
2025-03-13 15:04:42,719 [INFO]: 	>>> Finished "Creating the index" in 66.3392 secs
2025-03-13 15:04:42,719 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3724 secs
2025-03-13 15:04:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 8242 [episode count 5/20]
[retrieval_preprocessing] for episode 26858 [episode count 6/20], we have num_retrieval=np.int64(3203) num_query=np.int64(199)
2025-03-13 15:04:46,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:46,944 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:46
2025-03-13 15:04:46,944 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1023.75it/s]
2025-03-13 15:04:46,967 [INFO]: There are 3203 embeddings of dim 49152
2025-03-13 15:04:46,968 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 15:04:46,968 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:46
2025-03-13 15:04:46,968 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:46,968 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:04:46,969 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:46,969 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:04:46,969 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:46
2025-03-13 15:04:46,969 [INFO]: 661.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:46,969 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:04:46,969 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:46
2025-03-13 15:04:46,970 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:46,970 [INFO]: 	Creating the index 03/13/2025, 15:04:46
2025-03-13 15:04:46,970 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:46
2025-03-13 15:04:46,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:04:46,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:46
2025-03-13 15:04:46,973 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:04:46,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.96it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.52it/s] 31%|███       | 4/13 [00:00<00:00,  9.67it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.70it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.97it/s] 92%|█████████▏| 12/13 [00:01<00:00, 12.04it/s]100%|██████████| 13/13 [00:03<00:00,  3.43it/s]
2025-03-13 15:04:50,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:50
2025-03-13 15:05:30,940 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1693 secs
2025-03-13 15:05:30,941 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 15:05:30,941 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.93it/s] 50%|█████     | 2/4 [00:00<00:00,  3.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.81it/s]
2025-03-13 15:05:48,506 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5652 secs
2025-03-13 15:05:48,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8684 secs
2025-03-13 15:05:48,842 [INFO]: {
2025-03-13 15:05:48,842 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:48,842 [INFO]: 	index_param: efSearch=260
2025-03-13 15:05:48,842 [INFO]: 	index_path: knn.index
2025-03-13 15:05:48,842 [INFO]: 	size in bytes: 630170350
2025-03-13 15:05:48,842 [INFO]: 	avg_search_speed_ms: 10.610512273103662
2025-03-13 15:05:48,842 [INFO]: 	99p_search_speed_ms: 14.825507486239077
2025-03-13 15:05:48,842 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:48,842 [INFO]: 	nb vectors: 3203
2025-03-13 15:05:48,842 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:48,842 [INFO]: 	compression ratio: 0.9993098278901887
2025-03-13 15:05:48,843 [INFO]: }
2025-03-13 15:05:48,843 [INFO]: 	>>> Finished "Creating the index" in 61.8727 secs
2025-03-13 15:05:48,843 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8988 secs
2025-03-13 15:05:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 26858 [episode count 6/20]
[retrieval_preprocessing] for episode 24854 [episode count 7/20], we have num_retrieval=np.int64(3206) num_query=np.int64(196)
2025-03-13 15:05:52,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:52,806 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:52
2025-03-13 15:05:52,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.78it/s]
2025-03-13 15:05:52,828 [INFO]: There are 3206 embeddings of dim 49152
2025-03-13 15:05:52,828 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0215 secs
2025-03-13 15:05:52,828 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:52
2025-03-13 15:05:52,828 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:52,828 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:05:52,828 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:52,828 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:05:52,828 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:52
2025-03-13 15:05:52,829 [INFO]: 661.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:52,829 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:05:52,829 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:52
2025-03-13 15:05:52,829 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:52,829 [INFO]: 	Creating the index 03/13/2025, 15:05:52
2025-03-13 15:05:52,829 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:52
2025-03-13 15:05:52,830 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:05:52,830 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:52
2025-03-13 15:05:52,830 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:05:52,830 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 14.26it/s] 31%|███       | 4/13 [00:00<00:01,  5.87it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.30it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.91it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.73it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.91it/s]100%|██████████| 13/13 [00:03<00:00,  3.65it/s]
2025-03-13 15:05:56,394 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:56
2025-03-13 15:06:37,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9461 secs
2025-03-13 15:06:37,341 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 15:06:37,341 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.15it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 15:07:08,262 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9214 secs
2025-03-13 15:07:08,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4352 secs
2025-03-13 15:07:08,266 [INFO]: {
2025-03-13 15:07:08,266 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:08,266 [INFO]: 	index_param: efSearch=270
2025-03-13 15:07:08,266 [INFO]: 	index_path: knn.index
2025-03-13 15:07:08,266 [INFO]: 	size in bytes: 630760630
2025-03-13 15:07:08,266 [INFO]: 	avg_search_speed_ms: 10.87692055329883
2025-03-13 15:07:08,266 [INFO]: 	99p_search_speed_ms: 14.921386349014933
2025-03-13 15:07:08,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:08,266 [INFO]: 	nb vectors: 3206
2025-03-13 15:07:08,266 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:08,266 [INFO]: 	compression ratio: 0.9993097508321025
2025-03-13 15:07:08,266 [INFO]: }
2025-03-13 15:07:08,266 [INFO]: 	>>> Finished "Creating the index" in 75.4372 secs
2025-03-13 15:07:08,266 [INFO]: >>> Finished "Launching the whole pipeline" in 75.4594 secs
2025-03-13 15:07:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 24854 [episode count 7/20]
[retrieval_preprocessing] for episode 33061 [episode count 8/20], we have num_retrieval=np.int64(3230) num_query=np.int64(172)
2025-03-13 15:07:13,602 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:14,301 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:14
2025-03-13 15:07:14,301 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-13 15:07:14,324 [INFO]: There are 3230 embeddings of dim 49152
2025-03-13 15:07:14,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 15:07:14,325 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:14
2025-03-13 15:07:14,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:14,325 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:07:14,325 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:14,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:14,325 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:14
2025-03-13 15:07:14,325 [INFO]: 666.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:14,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:14,325 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:14
2025-03-13 15:07:14,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:14,325 [INFO]: 	Creating the index 03/13/2025, 15:07:14
2025-03-13 15:07:14,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:14
2025-03-13 15:07:14,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:07:14,326 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:14
2025-03-13 15:07:14,326 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:07:14,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.47it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.09it/s] 31%|███       | 4/13 [00:00<00:00, 10.58it/s] 46%|████▌     | 6/13 [00:01<00:01,  3.88it/s] 54%|█████▍    | 7/13 [00:02<00:02,  2.52it/s] 62%|██████▏   | 8/13 [00:02<00:01,  2.80it/s] 69%|██████▉   | 9/13 [00:02<00:01,  2.43it/s] 77%|███████▋  | 10/13 [00:03<00:01,  2.21it/s] 85%|████████▍ | 11/13 [00:03<00:00,  2.73it/s] 92%|█████████▏| 12/13 [00:04<00:00,  2.24it/s]100%|██████████| 13/13 [00:07<00:00,  1.15s/it]100%|██████████| 13/13 [00:07<00:00,  1.83it/s]
2025-03-13 15:07:21,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:21
2025-03-13 15:08:05,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4658 secs
2025-03-13 15:08:05,923 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 15:08:05,923 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 15:08:32,184 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2607 secs
2025-03-13 15:08:32,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.8742 secs
2025-03-13 15:08:32,201 [INFO]: {
2025-03-13 15:08:32,201 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:32,201 [INFO]: 	index_param: efSearch=265
2025-03-13 15:08:32,201 [INFO]: 	index_path: knn.index
2025-03-13 15:08:32,201 [INFO]: 	size in bytes: 635482750
2025-03-13 15:08:32,201 [INFO]: 	avg_search_speed_ms: 11.63058105293055
2025-03-13 15:08:32,201 [INFO]: 	99p_search_speed_ms: 20.72825409704818
2025-03-13 15:08:32,201 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:32,201 [INFO]: 	nb vectors: 3230
2025-03-13 15:08:32,201 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:32,201 [INFO]: 	compression ratio: 0.9993093282233074
2025-03-13 15:08:32,201 [INFO]: }
2025-03-13 15:08:32,201 [INFO]: 	>>> Finished "Creating the index" in 77.8759 secs
2025-03-13 15:08:32,201 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9000 secs
2025-03-13 15:08:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 33061 [episode count 8/20]
[retrieval_preprocessing] for episode 21096 [episode count 9/20], we have num_retrieval=np.int64(3248) num_query=np.int64(154)
2025-03-13 15:08:35,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:36,186 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:36
2025-03-13 15:08:36,186 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.17it/s]
2025-03-13 15:08:36,214 [INFO]: There are 3248 embeddings of dim 49152
2025-03-13 15:08:36,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 15:08:36,215 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,215 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:36,216 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:08:36,216 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:36,216 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:08:36,216 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,216 [INFO]: 670.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:36,216 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:08:36,217 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:36
2025-03-13 15:08:36,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:36,217 [INFO]: 	Creating the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,217 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:36
2025-03-13 15:08:36,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:08:36,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,221 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:08:36,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.16it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.91it/s] 23%|██▎       | 3/13 [00:00<00:01,  5.98it/s] 31%|███       | 4/13 [00:00<00:01,  7.07it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.88it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.45it/s] 62%|██████▏   | 8/13 [00:01<00:00,  9.16it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.94it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.76it/s]100%|██████████| 13/13 [00:03<00:00,  3.63it/s]
2025-03-13 15:08:39,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:39
2025-03-13 15:09:22,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9449 secs
2025-03-13 15:09:22,756 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:09:22,756 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 15:09:42,033 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2773 secs
2025-03-13 15:09:42,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8159 secs
2025-03-13 15:09:42,037 [INFO]: {
2025-03-13 15:09:42,038 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:42,038 [INFO]: 	index_param: efSearch=206
2025-03-13 15:09:42,038 [INFO]: 	index_path: knn.index
2025-03-13 15:09:42,038 [INFO]: 	size in bytes: 639024250
2025-03-13 15:09:42,038 [INFO]: 	avg_search_speed_ms: 8.629398352552505
2025-03-13 15:09:42,038 [INFO]: 	99p_search_speed_ms: 14.28124753292651
2025-03-13 15:09:42,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:42,038 [INFO]: 	nb vectors: 3248
2025-03-13 15:09:42,038 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:42,038 [INFO]: 	compression ratio: 0.9993091561079255
2025-03-13 15:09:42,038 [INFO]: }
2025-03-13 15:09:42,038 [INFO]: 	>>> Finished "Creating the index" in 65.8209 secs
2025-03-13 15:09:42,038 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8516 secs
2025-03-13 15:09:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 21096 [episode count 9/20]
[retrieval_preprocessing] for episode 94764 [episode count 10/20], we have num_retrieval=np.int64(3192) num_query=np.int64(210)
2025-03-13 15:09:45,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:45,794 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:45
2025-03-13 15:09:45,794 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1002.22it/s]
2025-03-13 15:09:45,819 [INFO]: There are 3192 embeddings of dim 49152
2025-03-13 15:09:45,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 15:09:45,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:45
2025-03-13 15:09:45,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:45,820 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:09:45,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:45,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:45,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:45
2025-03-13 15:09:45,820 [INFO]: 658.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:45,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:45,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:45
2025-03-13 15:09:45,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:45,820 [INFO]: 	Creating the index 03/13/2025, 15:09:45
2025-03-13 15:09:45,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:45
2025-03-13 15:09:45,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:09:45,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:45
2025-03-13 15:09:45,821 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:09:45,821 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.43it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.26it/s] 31%|███       | 4/13 [00:00<00:01,  7.52it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.65it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.83it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.34it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.43it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.04it/s]100%|██████████| 13/13 [00:03<00:00,  2.09it/s]100%|██████████| 13/13 [00:03<00:00,  3.68it/s]
2025-03-13 15:09:49,361 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:49
2025-03-13 15:10:27,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6483 secs
2025-03-13 15:10:27,009 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 15:10:27,010 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.83it/s] 50%|█████     | 2/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 15:10:51,176 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1666 secs
2025-03-13 15:10:51,179 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3577 secs
2025-03-13 15:10:51,179 [INFO]: {
2025-03-13 15:10:51,179 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:51,179 [INFO]: 	index_param: efSearch=284
2025-03-13 15:10:51,179 [INFO]: 	index_path: knn.index
2025-03-13 15:10:51,179 [INFO]: 	size in bytes: 628006210
2025-03-13 15:10:51,179 [INFO]: 	avg_search_speed_ms: 11.53701404029033
2025-03-13 15:10:51,179 [INFO]: 	99p_search_speed_ms: 18.232321585528563
2025-03-13 15:10:51,179 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:51,179 [INFO]: 	nb vectors: 3192
2025-03-13 15:10:51,179 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:51,179 [INFO]: 	compression ratio: 0.9993097616025166
2025-03-13 15:10:51,179 [INFO]: }
2025-03-13 15:10:51,179 [INFO]: 	>>> Finished "Creating the index" in 65.3591 secs
2025-03-13 15:10:51,179 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3849 secs
2025-03-13 15:10:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 94764 [episode count 10/20]
[retrieval_preprocessing] for episode 88627 [episode count 11/20], we have num_retrieval=np.int64(3242) num_query=np.int64(160)
2025-03-13 15:10:55,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:55,671 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:55
2025-03-13 15:10:55,671 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.77it/s]
2025-03-13 15:10:55,700 [INFO]: There are 3242 embeddings of dim 49152
2025-03-13 15:10:55,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 15:10:55,701 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:55
2025-03-13 15:10:55,702 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:55,702 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:10:55,702 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:55,702 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:10:55,702 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:55
2025-03-13 15:10:55,702 [INFO]: 669.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:55,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:10:55,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:55
2025-03-13 15:10:55,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:55,703 [INFO]: 	Creating the index 03/13/2025, 15:10:55
2025-03-13 15:10:55,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:55
2025-03-13 15:10:55,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:10:55,707 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:55
2025-03-13 15:10:55,707 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:10:55,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.55it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.76it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.19it/s] 31%|███       | 4/13 [00:00<00:01,  7.32it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.41it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.45it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.26it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.22it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.11it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.00it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.06it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.09it/s]100%|██████████| 13/13 [00:04<00:00,  1.11it/s]100%|██████████| 13/13 [00:04<00:00,  3.00it/s]
2025-03-13 15:11:00,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:00
2025-03-13 15:11:48,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3200 secs
2025-03-13 15:11:48,368 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 15:11:48,368 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 15:12:09,091 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7226 secs
2025-03-13 15:12:09,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3869 secs
2025-03-13 15:12:09,094 [INFO]: {
2025-03-13 15:12:09,094 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:09,094 [INFO]: 	index_param: efSearch=136
2025-03-13 15:12:09,094 [INFO]: 	index_path: knn.index
2025-03-13 15:12:09,094 [INFO]: 	size in bytes: 637843750
2025-03-13 15:12:09,094 [INFO]: 	avg_search_speed_ms: 7.222526007253849
2025-03-13 15:12:09,094 [INFO]: 	99p_search_speed_ms: 12.192777083255354
2025-03-13 15:12:09,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:09,094 [INFO]: 	nb vectors: 3242
2025-03-13 15:12:09,094 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:09,094 [INFO]: 	compression ratio: 0.9993092132673559
2025-03-13 15:12:09,094 [INFO]: }
2025-03-13 15:12:09,094 [INFO]: 	>>> Finished "Creating the index" in 73.3905 secs
2025-03-13 15:12:09,094 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4233 secs
2025-03-13 15:12:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 88627 [episode count 11/20]
[retrieval_preprocessing] for episode 53833 [episode count 12/20], we have num_retrieval=np.int64(3229) num_query=np.int64(173)
2025-03-13 15:12:12,061 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:12,782 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:12
2025-03-13 15:12:12,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1419.87it/s]
2025-03-13 15:12:12,811 [INFO]: There are 3229 embeddings of dim 49152
2025-03-13 15:12:12,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:12:12,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:12
2025-03-13 15:12:12,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:12,812 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:12:12,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:12,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:12:12,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:12
2025-03-13 15:12:12,813 [INFO]: 666.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:12,813 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:12:12,813 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:12
2025-03-13 15:12:12,813 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:12,813 [INFO]: 	Creating the index 03/13/2025, 15:12:12
2025-03-13 15:12:12,814 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:12
2025-03-13 15:12:12,817 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:12:12,817 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:12
2025-03-13 15:12:12,817 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:12:12,818 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.03it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.58it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.36it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.15it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.34it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.90it/s]100%|██████████| 13/13 [00:03<00:00,  2.27it/s]100%|██████████| 13/13 [00:03<00:00,  3.87it/s]
2025-03-13 15:12:16,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:16
2025-03-13 15:13:01,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6685 secs
2025-03-13 15:13:01,858 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 15:13:01,858 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.83it/s] 50%|█████     | 2/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 15:13:24,664 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8052 secs
2025-03-13 15:13:24,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8496 secs
2025-03-13 15:13:24,667 [INFO]: {
2025-03-13 15:13:24,667 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:24,667 [INFO]: 	index_param: efSearch=231
2025-03-13 15:13:24,667 [INFO]: 	index_path: knn.index
2025-03-13 15:13:24,667 [INFO]: 	size in bytes: 635285950
2025-03-13 15:13:24,667 [INFO]: 	avg_search_speed_ms: 10.416027293589044
2025-03-13 15:13:24,667 [INFO]: 	99p_search_speed_ms: 16.600708721671253
2025-03-13 15:13:24,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:24,667 [INFO]: 	nb vectors: 3229
2025-03-13 15:13:24,667 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:24,667 [INFO]: 	compression ratio: 0.9993094164918963
2025-03-13 15:13:24,667 [INFO]: }
2025-03-13 15:13:24,667 [INFO]: 	>>> Finished "Creating the index" in 71.8537 secs
2025-03-13 15:13:24,667 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8850 secs
2025-03-13 15:13:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 53833 [episode count 12/20]
[retrieval_preprocessing] for episode 74370 [episode count 13/20], we have num_retrieval=np.int64(3225) num_query=np.int64(177)
2025-03-13 15:13:28,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:28,941 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:28
2025-03-13 15:13:28,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1772.74it/s]
2025-03-13 15:13:28,970 [INFO]: There are 3225 embeddings of dim 49152
2025-03-13 15:13:28,970 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 15:13:28,971 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:28,971 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:13:28,971 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:28,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:13:28,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,972 [INFO]: 665.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:28,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:13:28,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:28
2025-03-13 15:13:28,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:28,972 [INFO]: 	Creating the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,973 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:28
2025-03-13 15:13:28,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:13:28,976 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,976 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:13:28,976 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.06it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.40it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.95it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.43it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.87it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.04it/s]100%|██████████| 13/13 [00:04<00:00,  1.67it/s]100%|██████████| 13/13 [00:04<00:00,  3.03it/s]
2025-03-13 15:13:33,272 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:33
2025-03-13 15:14:12,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1619 secs
2025-03-13 15:14:12,435 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 15:14:12,435 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.77it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 15:14:42,458 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0236 secs
2025-03-13 15:14:42,462 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4863 secs
2025-03-13 15:14:42,462 [INFO]: {
2025-03-13 15:14:42,462 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:42,462 [INFO]: 	index_param: efSearch=302
2025-03-13 15:14:42,462 [INFO]: 	index_path: knn.index
2025-03-13 15:14:42,462 [INFO]: 	size in bytes: 634498930
2025-03-13 15:14:42,462 [INFO]: 	avg_search_speed_ms: 14.190871790976178
2025-03-13 15:14:42,462 [INFO]: 	99p_search_speed_ms: 23.741480279713873
2025-03-13 15:14:42,462 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:42,462 [INFO]: 	nb vectors: 3225
2025-03-13 15:14:42,462 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:42,462 [INFO]: 	compression ratio: 0.9993094866211989
2025-03-13 15:14:42,462 [INFO]: }
2025-03-13 15:14:42,462 [INFO]: 	>>> Finished "Creating the index" in 73.4899 secs
2025-03-13 15:14:42,462 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5215 secs
2025-03-13 15:14:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 74370 [episode count 13/20]
[retrieval_preprocessing] for episode 17037 [episode count 14/20], we have num_retrieval=np.int64(3219) num_query=np.int64(183)
2025-03-13 15:14:45,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:46,486 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:46
2025-03-13 15:14:46,486 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.50it/s]
2025-03-13 15:14:46,514 [INFO]: There are 3219 embeddings of dim 49152
2025-03-13 15:14:46,514 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:14:46,514 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:46
2025-03-13 15:14:46,515 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:46,515 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:14:46,515 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:46,515 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:14:46,515 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:46
2025-03-13 15:14:46,515 [INFO]: 664.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:46,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:14:46,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:46
2025-03-13 15:14:46,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:46,516 [INFO]: 	Creating the index 03/13/2025, 15:14:46
2025-03-13 15:14:46,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:46
2025-03-13 15:14:46,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:14:46,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:46
2025-03-13 15:14:46,519 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:14:46,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.31it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.28it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.23it/s] 31%|███       | 4/13 [00:00<00:01,  8.50it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.11it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.00it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.23it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.67it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.99it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.59it/s]100%|██████████| 13/13 [00:03<00:00,  1.71it/s]100%|██████████| 13/13 [00:03<00:00,  3.37it/s]
2025-03-13 15:14:50,386 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:50
2025-03-13 15:15:31,556 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1701 secs
2025-03-13 15:15:31,557 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 15:15:31,557 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 15:15:54,557 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0006 secs
2025-03-13 15:15:54,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0421 secs
2025-03-13 15:15:54,562 [INFO]: {
2025-03-13 15:15:54,562 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:54,562 [INFO]: 	index_param: efSearch=181
2025-03-13 15:15:54,562 [INFO]: 	index_path: knn.index
2025-03-13 15:15:54,562 [INFO]: 	size in bytes: 633318310
2025-03-13 15:15:54,562 [INFO]: 	avg_search_speed_ms: 10.35361772829254
2025-03-13 15:15:54,562 [INFO]: 	99p_search_speed_ms: 15.156588528770955
2025-03-13 15:15:54,562 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:54,562 [INFO]: 	nb vectors: 3219
2025-03-13 15:15:54,562 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:54,562 [INFO]: 	compression ratio: 0.9993097341524833
2025-03-13 15:15:54,562 [INFO]: }
2025-03-13 15:15:54,562 [INFO]: 	>>> Finished "Creating the index" in 68.0458 secs
2025-03-13 15:15:54,562 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0756 secs
2025-03-13 15:15:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 17037 [episode count 14/20]
[retrieval_preprocessing] for episode 76433 [episode count 15/20], we have num_retrieval=np.int64(3246) num_query=np.int64(156)
2025-03-13 15:15:58,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:59,055 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:59
2025-03-13 15:15:59,055 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.25it/s]
2025-03-13 15:15:59,078 [INFO]: There are 3246 embeddings of dim 49152
2025-03-13 15:15:59,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 15:15:59,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,078 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:59,078 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:15:59,078 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:59,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:59,078 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,078 [INFO]: 669.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:59,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:15:59,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:59
2025-03-13 15:15:59,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:59,078 [INFO]: 	Creating the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:59
2025-03-13 15:15:59,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:15:59,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,080 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:15:59,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.85it/s] 31%|███       | 4/13 [00:00<00:00, 10.42it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.18it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.77it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.56it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.54it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.74it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.35it/s]100%|██████████| 13/13 [00:04<00:00,  1.25it/s]100%|██████████| 13/13 [00:04<00:00,  2.99it/s]
2025-03-13 15:16:03,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:03
2025-03-13 15:16:44,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1800 secs
2025-03-13 15:16:44,620 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 15:16:44,620 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s]
2025-03-13 15:17:14,064 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4448 secs
2025-03-13 15:17:14,067 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.9876 secs
2025-03-13 15:17:14,067 [INFO]: {
2025-03-13 15:17:14,067 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:14,067 [INFO]: 	index_param: efSearch=272
2025-03-13 15:17:14,067 [INFO]: 	index_path: knn.index
2025-03-13 15:17:14,067 [INFO]: 	size in bytes: 638630770
2025-03-13 15:17:14,067 [INFO]: 	avg_search_speed_ms: 10.855576944417127
2025-03-13 15:17:14,068 [INFO]: 	99p_search_speed_ms: 19.45969332009553
2025-03-13 15:17:14,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:14,068 [INFO]: 	nb vectors: 3246
2025-03-13 15:17:14,068 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:14,068 [INFO]: 	compression ratio: 0.9993091438422236
2025-03-13 15:17:14,068 [INFO]: }
2025-03-13 15:17:14,068 [INFO]: 	>>> Finished "Creating the index" in 74.9891 secs
2025-03-13 15:17:14,068 [INFO]: >>> Finished "Launching the whole pipeline" in 75.0125 secs
2025-03-13 15:17:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 76433 [episode count 15/20]
[retrieval_preprocessing] for episode 68269 [episode count 16/20], we have num_retrieval=np.int64(3246) num_query=np.int64(156)
2025-03-13 15:17:16,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:17,478 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:17
2025-03-13 15:17:17,478 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.33it/s]
2025-03-13 15:17:17,503 [INFO]: There are 3246 embeddings of dim 49152
2025-03-13 15:17:17,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:17:17,504 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:17
2025-03-13 15:17:17,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:17,504 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:17:17,504 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:17,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:17:17,505 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:17
2025-03-13 15:17:17,505 [INFO]: 669.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:17,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:17:17,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:17
2025-03-13 15:17:17,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:17,506 [INFO]: 	Creating the index 03/13/2025, 15:17:17
2025-03-13 15:17:17,507 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:17
2025-03-13 15:17:17,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:17:17,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:17
2025-03-13 15:17:17,510 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:17:17,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.52it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.22it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.00it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.66it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.58it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.09it/s]100%|██████████| 13/13 [00:03<00:00,  2.08it/s]100%|██████████| 13/13 [00:03<00:00,  3.64it/s]
2025-03-13 15:17:21,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:21
2025-03-13 15:18:00,703 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6129 secs
2025-03-13 15:18:00,703 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 15:18:00,703 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s]
2025-03-13 15:18:31,311 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6074 secs
2025-03-13 15:18:31,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8577 secs
2025-03-13 15:18:31,368 [INFO]: {
2025-03-13 15:18:31,369 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:31,369 [INFO]: 	index_param: efSearch=265
2025-03-13 15:18:31,369 [INFO]: 	index_path: knn.index
2025-03-13 15:18:31,369 [INFO]: 	size in bytes: 638630770
2025-03-13 15:18:31,369 [INFO]: 	avg_search_speed_ms: 10.821054431557398
2025-03-13 15:18:31,369 [INFO]: 	99p_search_speed_ms: 20.47593114199116
2025-03-13 15:18:31,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:31,369 [INFO]: 	nb vectors: 3246
2025-03-13 15:18:31,369 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:31,369 [INFO]: 	compression ratio: 0.9993091438422236
2025-03-13 15:18:31,369 [INFO]: }
2025-03-13 15:18:31,369 [INFO]: 	>>> Finished "Creating the index" in 73.8626 secs
2025-03-13 15:18:31,369 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8907 secs
2025-03-13 15:18:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 68269 [episode count 16/20]
[retrieval_preprocessing] for episode 23252 [episode count 17/20], we have num_retrieval=np.int64(3248) num_query=np.int64(154)
2025-03-13 15:18:35,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:35,957 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:35
2025-03-13 15:18:35,957 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-13 15:18:35,985 [INFO]: There are 3248 embeddings of dim 49152
2025-03-13 15:18:35,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:18:35,986 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:35
2025-03-13 15:18:35,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:35,986 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:18:35,986 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:35,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:18:35,986 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:35
2025-03-13 15:18:35,986 [INFO]: 670.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:35,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:18:35,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:35
2025-03-13 15:18:35,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:35,988 [INFO]: 	Creating the index 03/13/2025, 15:18:35
2025-03-13 15:18:35,988 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:35
2025-03-13 15:18:35,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:18:35,991 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:35
2025-03-13 15:18:35,991 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:18:35,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.59it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.46it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.41it/s] 31%|███       | 4/13 [00:00<00:01,  8.88it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.14it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.31it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.50it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.01it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.01it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.98it/s]100%|██████████| 13/13 [00:04<00:00,  1.35it/s]100%|██████████| 13/13 [00:04<00:00,  3.24it/s]
2025-03-13 15:18:40,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:40
2025-03-13 15:19:12,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8180 secs
2025-03-13 15:19:12,830 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 15:19:12,830 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s]
2025-03-13 15:19:38,104 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2745 secs
2025-03-13 15:19:38,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2159 secs
2025-03-13 15:19:38,207 [INFO]: {
2025-03-13 15:19:38,207 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:38,207 [INFO]: 	index_param: efSearch=309
2025-03-13 15:19:38,207 [INFO]: 	index_path: knn.index
2025-03-13 15:19:38,208 [INFO]: 	size in bytes: 639024250
2025-03-13 15:19:38,208 [INFO]: 	avg_search_speed_ms: 13.175667705608236
2025-03-13 15:19:38,208 [INFO]: 	99p_search_speed_ms: 23.322143820114427
2025-03-13 15:19:38,208 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:38,208 [INFO]: 	nb vectors: 3248
2025-03-13 15:19:38,208 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:38,208 [INFO]: 	compression ratio: 0.9993091561079255
2025-03-13 15:19:38,208 [INFO]: }
2025-03-13 15:19:38,208 [INFO]: 	>>> Finished "Creating the index" in 62.2201 secs
2025-03-13 15:19:38,208 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2508 secs
2025-03-13 15:19:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 23252 [episode count 17/20]
[retrieval_preprocessing] for episode 80598 [episode count 18/20], we have num_retrieval=np.int64(3215) num_query=np.int64(187)
2025-03-13 15:19:41,164 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:41,631 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:41
2025-03-13 15:19:41,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.93it/s]
2025-03-13 15:19:41,656 [INFO]: There are 3215 embeddings of dim 49152
2025-03-13 15:19:41,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:19:41,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:41
2025-03-13 15:19:41,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:41,657 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:19:41,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:41,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:41,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:41
2025-03-13 15:19:41,657 [INFO]: 663.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:41,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:19:41,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:41
2025-03-13 15:19:41,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:41,657 [INFO]: 	Creating the index 03/13/2025, 15:19:41
2025-03-13 15:19:41,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:41
2025-03-13 15:19:41,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:19:41,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:41
2025-03-13 15:19:41,658 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:19:41,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.46it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.69it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.63it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.04it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.30it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.39it/s]100%|██████████| 13/13 [00:03<00:00,  2.25it/s]100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
2025-03-13 15:19:44,994 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:44
2025-03-13 15:20:20,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2581 secs
2025-03-13 15:20:20,253 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 15:20:20,253 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.83it/s]
2025-03-13 15:20:39,101 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8483 secs
2025-03-13 15:20:39,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4462 secs
2025-03-13 15:20:39,105 [INFO]: {
2025-03-13 15:20:39,105 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:39,105 [INFO]: 	index_param: efSearch=188
2025-03-13 15:20:39,105 [INFO]: 	index_path: knn.index
2025-03-13 15:20:39,105 [INFO]: 	size in bytes: 632531290
2025-03-13 15:20:39,105 [INFO]: 	avg_search_speed_ms: 9.313419251182435
2025-03-13 15:20:39,105 [INFO]: 	99p_search_speed_ms: 17.45387938572094
2025-03-13 15:20:39,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:39,105 [INFO]: 	nb vectors: 3215
2025-03-13 15:20:39,105 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:39,105 [INFO]: 	compression ratio: 0.9993098048951855
2025-03-13 15:20:39,105 [INFO]: }
2025-03-13 15:20:39,105 [INFO]: 	>>> Finished "Creating the index" in 57.4479 secs
2025-03-13 15:20:39,105 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4737 secs
2025-03-13 15:20:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 80598 [episode count 18/20]
[retrieval_preprocessing] for episode 45785 [episode count 19/20], we have num_retrieval=np.int64(3241) num_query=np.int64(161)
2025-03-13 15:20:42,483 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:43,134 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:43
2025-03-13 15:20:43,134 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 991.33it/s]
2025-03-13 15:20:43,162 [INFO]: There are 3241 embeddings of dim 49152
2025-03-13 15:20:43,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:20:43,163 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:43
2025-03-13 15:20:43,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:43,163 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:20:43,164 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:43,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:20:43,164 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:43
2025-03-13 15:20:43,164 [INFO]: 668.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:43,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:20:43,164 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:43
2025-03-13 15:20:43,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:43,165 [INFO]: 	Creating the index 03/13/2025, 15:20:43
2025-03-13 15:20:43,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:43
2025-03-13 15:20:43,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:20:43,168 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:43
2025-03-13 15:20:43,168 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:20:43,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.82it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.60it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.47it/s] 31%|███       | 4/13 [00:00<00:01,  8.97it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.55it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.77it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.70it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.07it/s]100%|██████████| 13/13 [00:03<00:00,  1.93it/s]100%|██████████| 13/13 [00:03<00:00,  3.54it/s]
2025-03-13 15:20:46,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:46
2025-03-13 15:21:26,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3569 secs
2025-03-13 15:21:26,206 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 15:21:26,206 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.62it/s]
2025-03-13 15:21:46,928 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7219 secs
2025-03-13 15:21:46,931 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7625 secs
2025-03-13 15:21:46,931 [INFO]: {
2025-03-13 15:21:46,931 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:46,931 [INFO]: 	index_param: efSearch=243
2025-03-13 15:21:46,931 [INFO]: 	index_path: knn.index
2025-03-13 15:21:46,931 [INFO]: 	size in bytes: 637647010
2025-03-13 15:21:46,931 [INFO]: 	avg_search_speed_ms: 11.50836964176434
2025-03-13 15:21:46,931 [INFO]: 	99p_search_speed_ms: 17.27016867138445
2025-03-13 15:21:46,931 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:46,931 [INFO]: 	nb vectors: 3241
2025-03-13 15:21:46,931 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:46,931 [INFO]: 	compression ratio: 0.9993092071426791
2025-03-13 15:21:46,931 [INFO]: }
2025-03-13 15:21:46,931 [INFO]: 	>>> Finished "Creating the index" in 63.7663 secs
2025-03-13 15:21:46,931 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7972 secs
2025-03-13 15:21:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 45785 [episode count 19/20]
2025-03-13 15:21:48: [retrieval_preprocessing] finished for 4823049285_place_block_in_bowl [chosen_id count 0/196]
2025-03-13 15:21:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4823049285_remove_bottle_from_tray_and_place_on_table [chosen_id count 1/196]
2025-03-13 15:21:51: [retrieval_preprocessing] we have num_total=3311 embedding_dim=49152
[retrieval_preprocessing] for episode 81936 [episode count 0/20], we have num_retrieval=np.int64(3142) num_query=np.int64(169)
2025-03-13 15:21:52,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:53,512 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:53
2025-03-13 15:21:53,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.73it/s]
2025-03-13 15:21:53,541 [INFO]: There are 3142 embeddings of dim 49152
2025-03-13 15:21:53,541 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:21:53,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:53
2025-03-13 15:21:53,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:53,542 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:21:53,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:53,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:21:53,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:53
2025-03-13 15:21:53,542 [INFO]: 648.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:53,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:21:53,543 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:53
2025-03-13 15:21:53,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:53,543 [INFO]: 	Creating the index 03/13/2025, 15:21:53
2025-03-13 15:21:53,543 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:53
2025-03-13 15:21:53,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:21:53,546 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:53
2025-03-13 15:21:53,547 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:21:53,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.90it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.87it/s] 31%|███       | 4/13 [00:00<00:00,  9.10it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.75it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.64it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.30it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.99it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.73it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.69it/s]100%|██████████| 13/13 [00:03<00:00,  1.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.46it/s]
2025-03-13 15:21:57,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:57
2025-03-13 15:22:45,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3102 secs
2025-03-13 15:22:45,624 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 15:22:45,625 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.27it/s] 50%|█████     | 2/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 15:23:11,089 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4639 secs
2025-03-13 15:23:11,093 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5465 secs
2025-03-13 15:23:11,094 [INFO]: {
2025-03-13 15:23:11,094 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:11,094 [INFO]: 	index_param: efSearch=184
2025-03-13 15:23:11,094 [INFO]: 	index_path: knn.index
2025-03-13 15:23:11,094 [INFO]: 	size in bytes: 618169090
2025-03-13 15:23:11,094 [INFO]: 	avg_search_speed_ms: 9.63789603209952
2025-03-13 15:23:11,094 [INFO]: 	99p_search_speed_ms: 14.467491114046407
2025-03-13 15:23:11,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:11,094 [INFO]: 	nb vectors: 3142
2025-03-13 15:23:11,094 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:11,094 [INFO]: 	compression ratio: 0.9993096484329231
2025-03-13 15:23:11,094 [INFO]: }
2025-03-13 15:23:11,094 [INFO]: 	>>> Finished "Creating the index" in 77.5511 secs
2025-03-13 15:23:11,094 [INFO]: >>> Finished "Launching the whole pipeline" in 77.5825 secs
2025-03-13 15:23:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 81936 [episode count 0/20]
[retrieval_preprocessing] for episode 84082 [episode count 1/20], we have num_retrieval=np.int64(3160) num_query=np.int64(151)
2025-03-13 15:23:14,567 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:15,835 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:15
2025-03-13 15:23:15,835 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-13 15:23:15,858 [INFO]: There are 3160 embeddings of dim 49152
2025-03-13 15:23:15,859 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 15:23:15,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:15
2025-03-13 15:23:15,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:15,859 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:23:15,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:15,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:23:15,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:15
2025-03-13 15:23:15,860 [INFO]: 652.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:15,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:23:15,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:15
2025-03-13 15:23:15,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:15,860 [INFO]: 	Creating the index 03/13/2025, 15:23:15
2025-03-13 15:23:15,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:15
2025-03-13 15:23:15,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:23:15,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:15
2025-03-13 15:23:15,862 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:23:15,862 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.05it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.22it/s] 31%|███       | 4/13 [00:00<00:01,  7.25it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.21it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.17it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.24it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.69it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.29it/s]100%|██████████| 13/13 [00:04<00:00,  1.33it/s]100%|██████████| 13/13 [00:04<00:00,  2.80it/s]
2025-03-13 15:23:20,509 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:20
2025-03-13 15:24:08,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1487 secs
2025-03-13 15:24:08,658 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 15:24:08,658 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 15:24:34,188 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5298 secs
2025-03-13 15:24:34,191 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3294 secs
2025-03-13 15:24:34,191 [INFO]: {
2025-03-13 15:24:34,191 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:34,191 [INFO]: 	index_param: efSearch=129
2025-03-13 15:24:34,191 [INFO]: 	index_path: knn.index
2025-03-13 15:24:34,191 [INFO]: 	size in bytes: 621710470
2025-03-13 15:24:34,191 [INFO]: 	avg_search_speed_ms: 6.673946967646877
2025-03-13 15:24:34,191 [INFO]: 	99p_search_speed_ms: 10.20223033148795
2025-03-13 15:24:34,191 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:34,191 [INFO]: 	nb vectors: 3160
2025-03-13 15:24:34,191 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:34,191 [INFO]: 	compression ratio: 0.9993096625829705
2025-03-13 15:24:34,191 [INFO]: }
2025-03-13 15:24:34,191 [INFO]: 	>>> Finished "Creating the index" in 78.3313 secs
2025-03-13 15:24:34,191 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3564 secs
2025-03-13 15:24:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 84082 [episode count 1/20]
[retrieval_preprocessing] for episode 67636 [episode count 2/20], we have num_retrieval=np.int64(3022) num_query=np.int64(289)
2025-03-13 15:24:36,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:36,918 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:36
2025-03-13 15:24:36,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.37it/s]
2025-03-13 15:24:36,942 [INFO]: There are 3022 embeddings of dim 49152
2025-03-13 15:24:36,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 15:24:36,942 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:36
2025-03-13 15:24:36,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:36,943 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:24:36,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:36,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:36,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:36
2025-03-13 15:24:36,943 [INFO]: 623.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:36,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:24:36,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:36
2025-03-13 15:24:36,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:36,943 [INFO]: 	Creating the index 03/13/2025, 15:24:36
2025-03-13 15:24:36,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:36
2025-03-13 15:24:36,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:24:36,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:36
2025-03-13 15:24:36,944 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:24:36,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.98it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.74it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.05it/s] 50%|█████     | 6/12 [00:00<00:00, 10.04it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.40it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.15it/s]100%|██████████| 12/12 [00:03<00:00,  1.97it/s]100%|██████████| 12/12 [00:03<00:00,  3.35it/s]
2025-03-13 15:24:40,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:40
2025-03-13 15:25:24,022 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4845 secs
2025-03-13 15:25:24,023 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:25:24,023 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 15:25:42,725 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7026 secs
2025-03-13 15:25:42,728 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7839 secs
2025-03-13 15:25:42,728 [INFO]: {
2025-03-13 15:25:42,728 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:42,728 [INFO]: 	index_param: efSearch=179
2025-03-13 15:25:42,728 [INFO]: 	index_path: knn.index
2025-03-13 15:25:42,728 [INFO]: 	size in bytes: 594559690
2025-03-13 15:25:42,728 [INFO]: 	avg_search_speed_ms: 9.939526620174705
2025-03-13 15:25:42,728 [INFO]: 	99p_search_speed_ms: 15.177565801423055
2025-03-13 15:25:42,728 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:42,728 [INFO]: 	nb vectors: 3022
2025-03-13 15:25:42,728 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:42,728 [INFO]: 	compression ratio: 0.9993098859426545
2025-03-13 15:25:42,728 [INFO]: }
2025-03-13 15:25:42,728 [INFO]: 	>>> Finished "Creating the index" in 65.7855 secs
2025-03-13 15:25:42,729 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8099 secs
2025-03-13 15:25:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 67636 [episode count 2/20]
[retrieval_preprocessing] for episode 14588 [episode count 3/20], we have num_retrieval=np.int64(3113) num_query=np.int64(198)
2025-03-13 15:25:46,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:46,922 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:46
2025-03-13 15:25:46,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1638.40it/s]
2025-03-13 15:25:46,943 [INFO]: There are 3113 embeddings of dim 49152
2025-03-13 15:25:46,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0210 secs
2025-03-13 15:25:46,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:46
2025-03-13 15:25:46,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:46,943 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:25:46,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:46,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:46,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:46
2025-03-13 15:25:46,943 [INFO]: 642.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:46,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:25:46,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:46
2025-03-13 15:25:46,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:46,943 [INFO]: 	Creating the index 03/13/2025, 15:25:46
2025-03-13 15:25:46,944 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:46
2025-03-13 15:25:46,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:25:46,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:46
2025-03-13 15:25:46,944 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:25:46,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.95it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.68it/s] 31%|███       | 4/13 [00:00<00:01,  8.65it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.77it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.04it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.13it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.29it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.42it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.34it/s]100%|██████████| 13/13 [00:03<00:00,  1.76it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-13 15:25:50,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:50
2025-03-13 15:26:32,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6908 secs
2025-03-13 15:26:32,366 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:26:32,366 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.23it/s] 50%|█████     | 2/4 [00:00<00:00,  5.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 15:26:56,485 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1193 secs
2025-03-13 15:26:56,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5433 secs
2025-03-13 15:26:56,488 [INFO]: {
2025-03-13 15:26:56,488 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:56,488 [INFO]: 	index_param: efSearch=201
2025-03-13 15:26:56,488 [INFO]: 	index_path: knn.index
2025-03-13 15:26:56,488 [INFO]: 	size in bytes: 612463450
2025-03-13 15:26:56,488 [INFO]: 	avg_search_speed_ms: 10.963122213102077
2025-03-13 15:26:56,488 [INFO]: 	99p_search_speed_ms: 14.335397512186319
2025-03-13 15:26:56,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:56,488 [INFO]: 	nb vectors: 3113
2025-03-13 15:26:56,488 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:56,488 [INFO]: 	compression ratio: 0.9993097612600392
2025-03-13 15:26:56,488 [INFO]: }
2025-03-13 15:26:56,488 [INFO]: 	>>> Finished "Creating the index" in 69.5447 secs
2025-03-13 15:26:56,488 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5662 secs
2025-03-13 15:26:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 14588 [episode count 3/20]
[retrieval_preprocessing] for episode 2316 [episode count 4/20], we have num_retrieval=np.int64(3134) num_query=np.int64(177)
2025-03-13 15:26:59,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:59,856 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:59
2025-03-13 15:26:59,856 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2145.42it/s]
2025-03-13 15:26:59,879 [INFO]: There are 3134 embeddings of dim 49152
2025-03-13 15:26:59,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 15:26:59,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:59
2025-03-13 15:26:59,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:59,879 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:26:59,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:59,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:59,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:59
2025-03-13 15:26:59,879 [INFO]: 646.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:59,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:26:59,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:59
2025-03-13 15:26:59,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:59,879 [INFO]: 	Creating the index 03/13/2025, 15:26:59
2025-03-13 15:26:59,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:59
2025-03-13 15:26:59,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:26:59,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:59
2025-03-13 15:26:59,880 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:26:59,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.04it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.39it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.99it/s] 31%|███       | 4/13 [00:00<00:01,  7.38it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.59it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.79it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.21it/s] 62%|██████▏   | 8/13 [00:01<00:00,  6.87it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.20it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.39it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.43it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.44it/s]100%|██████████| 13/13 [00:04<00:00,  1.22it/s]100%|██████████| 13/13 [00:04<00:00,  3.20it/s]
2025-03-13 15:27:03,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:03
2025-03-13 15:27:47,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0214 secs
2025-03-13 15:27:47,965 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 15:27:47,966 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-13 15:28:13,743 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7769 secs
2025-03-13 15:28:13,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8670 secs
2025-03-13 15:28:13,748 [INFO]: {
2025-03-13 15:28:13,748 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:13,748 [INFO]: 	index_param: efSearch=186
2025-03-13 15:28:13,748 [INFO]: 	index_path: knn.index
2025-03-13 15:28:13,748 [INFO]: 	size in bytes: 616595170
2025-03-13 15:28:13,748 [INFO]: 	avg_search_speed_ms: 11.532131315293832
2025-03-13 15:28:13,748 [INFO]: 	99p_search_speed_ms: 18.90962877310813
2025-03-13 15:28:13,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:13,748 [INFO]: 	nb vectors: 3134
2025-03-13 15:28:13,748 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:13,748 [INFO]: 	compression ratio: 0.9993095988734391
2025-03-13 15:28:13,748 [INFO]: }
2025-03-13 15:28:13,748 [INFO]: 	>>> Finished "Creating the index" in 73.8685 secs
2025-03-13 15:28:13,748 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8920 secs
2025-03-13 15:28:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 2316 [episode count 4/20]
[retrieval_preprocessing] for episode 49700 [episode count 5/20], we have num_retrieval=np.int64(3168) num_query=np.int64(143)
2025-03-13 15:28:17,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:17,991 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:17
2025-03-13 15:28:17,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.44it/s]
2025-03-13 15:28:18,016 [INFO]: There are 3168 embeddings of dim 49152
2025-03-13 15:28:18,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:28:18,016 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:18
2025-03-13 15:28:18,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:18,017 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:28:18,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:18,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:28:18,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:18
2025-03-13 15:28:18,017 [INFO]: 653.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:18,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:28:18,017 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:18
2025-03-13 15:28:18,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:18,017 [INFO]: 	Creating the index 03/13/2025, 15:28:18
2025-03-13 15:28:18,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:18
2025-03-13 15:28:18,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:28:18,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:18
2025-03-13 15:28:18,019 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:28:18,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.92it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.34it/s] 31%|███       | 4/13 [00:00<00:00,  9.47it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.26it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.02it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.80it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.70it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.86it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.35it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.81it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.89it/s]100%|██████████| 13/13 [00:05<00:00,  1.20s/it]100%|██████████| 13/13 [00:05<00:00,  2.53it/s]
2025-03-13 15:28:23,163 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:23
2025-03-13 15:29:13,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2680 secs
2025-03-13 15:29:13,431 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:29:13,431 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.42it/s] 50%|█████     | 2/4 [00:00<00:00,  5.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.68it/s]
2025-03-13 15:29:36,761 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3293 secs
2025-03-13 15:29:36,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7445 secs
2025-03-13 15:29:36,763 [INFO]: {
2025-03-13 15:29:36,763 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:36,763 [INFO]: 	index_param: efSearch=182
2025-03-13 15:29:36,763 [INFO]: 	index_path: knn.index
2025-03-13 15:29:36,763 [INFO]: 	size in bytes: 623284390
2025-03-13 15:29:36,763 [INFO]: 	avg_search_speed_ms: 9.489369905373502
2025-03-13 15:29:36,763 [INFO]: 	99p_search_speed_ms: 15.408234370406719
2025-03-13 15:29:36,763 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:36,763 [INFO]: 	nb vectors: 3168
2025-03-13 15:29:36,763 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:36,763 [INFO]: 	compression ratio: 0.9993097115748398
2025-03-13 15:29:36,763 [INFO]: }
2025-03-13 15:29:36,763 [INFO]: 	>>> Finished "Creating the index" in 78.7463 secs
2025-03-13 15:29:36,763 [INFO]: >>> Finished "Launching the whole pipeline" in 78.7725 secs
2025-03-13 15:29:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 49700 [episode count 5/20]
[retrieval_preprocessing] for episode 46173 [episode count 6/20], we have num_retrieval=np.int64(3117) num_query=np.int64(194)
2025-03-13 15:29:38,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:39,225 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:39
2025-03-13 15:29:39,225 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.01it/s]
2025-03-13 15:29:39,250 [INFO]: There are 3117 embeddings of dim 49152
2025-03-13 15:29:39,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:29:39,250 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:39
2025-03-13 15:29:39,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:39,250 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:29:39,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:39,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:29:39,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:39
2025-03-13 15:29:39,251 [INFO]: 643.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:39,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:29:39,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:39
2025-03-13 15:29:39,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:39,251 [INFO]: 	Creating the index 03/13/2025, 15:29:39
2025-03-13 15:29:39,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:39
2025-03-13 15:29:39,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:29:39,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:39
2025-03-13 15:29:39,252 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:29:39,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.68it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.95it/s] 38%|███▊      | 5/13 [00:00<00:00, 14.80it/s] 54%|█████▍    | 7/13 [00:00<00:00, 15.66it/s] 69%|██████▉   | 9/13 [00:00<00:00, 15.39it/s] 85%|████████▍ | 11/13 [00:00<00:00, 15.94it/s]100%|██████████| 13/13 [00:03<00:00,  2.21it/s]100%|██████████| 13/13 [00:03<00:00,  4.06it/s]
2025-03-13 15:29:42,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:42
2025-03-13 15:30:21,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6450 secs
2025-03-13 15:30:21,105 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:30:21,105 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s]
2025-03-13 15:30:45,036 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9311 secs
2025-03-13 15:30:45,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7871 secs
2025-03-13 15:30:45,039 [INFO]: {
2025-03-13 15:30:45,039 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:45,039 [INFO]: 	index_param: efSearch=207
2025-03-13 15:30:45,039 [INFO]: 	index_path: knn.index
2025-03-13 15:30:45,039 [INFO]: 	size in bytes: 613250410
2025-03-13 15:30:45,039 [INFO]: 	avg_search_speed_ms: 10.788053768448846
2025-03-13 15:30:45,039 [INFO]: 	99p_search_speed_ms: 17.119238264858733
2025-03-13 15:30:45,039 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:45,039 [INFO]: 	nb vectors: 3117
2025-03-13 15:30:45,039 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:45,040 [INFO]: 	compression ratio: 0.9993097860301471
2025-03-13 15:30:45,040 [INFO]: }
2025-03-13 15:30:45,040 [INFO]: 	>>> Finished "Creating the index" in 65.7889 secs
2025-03-13 15:30:45,040 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8148 secs
2025-03-13 15:30:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 46173 [episode count 6/20]
[retrieval_preprocessing] for episode 87874 [episode count 7/20], we have num_retrieval=np.int64(3182) num_query=np.int64(129)
2025-03-13 15:30:47,984 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:48,672 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:48
2025-03-13 15:30:48,672 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 940.43it/s]
2025-03-13 15:30:49,042 [INFO]: There are 3182 embeddings of dim 49152
2025-03-13 15:30:49,042 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3704 secs
2025-03-13 15:30:49,042 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,042 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:49,043 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:30:49,043 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:49,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:30:49,043 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,043 [INFO]: 656.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:49,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:30:49,044 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:49
2025-03-13 15:30:49,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:49,044 [INFO]: 	Creating the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,044 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:49
2025-03-13 15:30:49,048 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:30:49,048 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,048 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:30:49,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.65it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.97it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.06it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.65it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.27it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.75it/s]100%|██████████| 13/13 [00:03<00:00,  2.01it/s]100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
2025-03-13 15:30:52,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:52
2025-03-13 15:31:29,450 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7005 secs
2025-03-13 15:31:29,450 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 15:31:29,450 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 15:32:00,295 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8445 secs
2025-03-13 15:32:00,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2491 secs
2025-03-13 15:32:00,297 [INFO]: {
2025-03-13 15:32:00,297 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:00,297 [INFO]: 	index_param: efSearch=235
2025-03-13 15:32:00,297 [INFO]: 	index_path: knn.index
2025-03-13 15:32:00,297 [INFO]: 	size in bytes: 626038810
2025-03-13 15:32:00,297 [INFO]: 	avg_search_speed_ms: 11.892068022629523
2025-03-13 15:32:00,297 [INFO]: 	99p_search_speed_ms: 14.992194389924409
2025-03-13 15:32:00,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:00,297 [INFO]: 	nb vectors: 3182
2025-03-13 15:32:00,297 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:00,297 [INFO]: 	compression ratio: 0.999309700943301
2025-03-13 15:32:00,297 [INFO]: }
2025-03-13 15:32:00,298 [INFO]: 	>>> Finished "Creating the index" in 71.2534 secs
2025-03-13 15:32:00,298 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6259 secs
2025-03-13 15:32:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 87874 [episode count 7/20]
[retrieval_preprocessing] for episode 21354 [episode count 8/20], we have num_retrieval=np.int64(3167) num_query=np.int64(144)
2025-03-13 15:32:02,887 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:03,462 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:03
2025-03-13 15:32:03,462 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.86it/s]
2025-03-13 15:32:03,488 [INFO]: There are 3167 embeddings of dim 49152
2025-03-13 15:32:03,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:32:03,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:03
2025-03-13 15:32:03,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:03,489 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:32:03,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:03,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:32:03,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:03
2025-03-13 15:32:03,490 [INFO]: 653.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:03,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:32:03,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:03
2025-03-13 15:32:03,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:03,490 [INFO]: 	Creating the index 03/13/2025, 15:32:03
2025-03-13 15:32:03,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:03
2025-03-13 15:32:03,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:32:03,493 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:03
2025-03-13 15:32:03,494 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:32:03,494 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.16it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.04it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.35it/s] 31%|███       | 4/13 [00:00<00:01,  7.99it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.64it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.77it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.93it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.96it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.11it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.13it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.22it/s]100%|██████████| 13/13 [00:04<00:00,  1.02s/it]100%|██████████| 13/13 [00:04<00:00,  2.87it/s]
2025-03-13 15:32:08,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:08
2025-03-13 15:32:56,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1311 secs
2025-03-13 15:32:56,168 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 15:32:56,168 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-13 15:33:17,805 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6365 secs
2025-03-13 15:33:17,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.3140 secs
2025-03-13 15:33:17,808 [INFO]: {
2025-03-13 15:33:17,808 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:17,808 [INFO]: 	index_param: efSearch=146
2025-03-13 15:33:17,808 [INFO]: 	index_path: knn.index
2025-03-13 15:33:17,808 [INFO]: 	size in bytes: 623087650
2025-03-13 15:33:17,808 [INFO]: 	avg_search_speed_ms: 9.315865313528386
2025-03-13 15:33:17,808 [INFO]: 	99p_search_speed_ms: 19.517243951559053
2025-03-13 15:33:17,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:17,808 [INFO]: 	nb vectors: 3167
2025-03-13 15:33:17,808 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:17,808 [INFO]: 	compression ratio: 0.9993097054643917
2025-03-13 15:33:17,808 [INFO]: }
2025-03-13 15:33:17,808 [INFO]: 	>>> Finished "Creating the index" in 74.3177 secs
2025-03-13 15:33:17,808 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3459 secs
2025-03-13 15:33:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 21354 [episode count 8/20]
[retrieval_preprocessing] for episode 35701 [episode count 9/20], we have num_retrieval=np.int64(3210) num_query=np.int64(101)
2025-03-13 15:33:20,050 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:20,566 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:20
2025-03-13 15:33:20,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1327.73it/s]
2025-03-13 15:33:20,595 [INFO]: There are 3210 embeddings of dim 49152
2025-03-13 15:33:20,595 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 15:33:20,596 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:20
2025-03-13 15:33:20,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:20,596 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:33:20,596 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:20,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:20,596 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:20
2025-03-13 15:33:20,596 [INFO]: 662.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:20,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:33:20,596 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:20
2025-03-13 15:33:20,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:20,596 [INFO]: 	Creating the index 03/13/2025, 15:33:20
2025-03-13 15:33:20,596 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:20
2025-03-13 15:33:20,597 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:33:20,597 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:20
2025-03-13 15:33:20,598 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:33:20,598 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.10it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.75it/s] 38%|███▊      | 5/13 [00:00<00:01,  5.05it/s] 54%|█████▍    | 7/13 [00:01<00:01,  5.95it/s] 62%|██████▏   | 8/13 [00:01<00:01,  4.60it/s] 69%|██████▉   | 9/13 [00:01<00:01,  3.92it/s] 77%|███████▋  | 10/13 [00:02<00:00,  4.61it/s] 85%|████████▍ | 11/13 [00:02<00:00,  5.01it/s] 92%|█████████▏| 12/13 [00:02<00:00,  5.61it/s]100%|██████████| 13/13 [00:05<00:00,  1.03s/it]100%|██████████| 13/13 [00:05<00:00,  2.39it/s]
2025-03-13 15:33:26,044 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:26
2025-03-13 15:34:15,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9672 secs
2025-03-13 15:34:15,013 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 15:34:15,013 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s]
2025-03-13 15:34:37,594 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5812 secs
2025-03-13 15:34:37,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.0004 secs
2025-03-13 15:34:37,598 [INFO]: {
2025-03-13 15:34:37,598 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:37,598 [INFO]: 	index_param: efSearch=158
2025-03-13 15:34:37,598 [INFO]: 	index_path: knn.index
2025-03-13 15:34:37,598 [INFO]: 	size in bytes: 631547590
2025-03-13 15:34:37,598 [INFO]: 	avg_search_speed_ms: 9.705165652467787
2025-03-13 15:34:37,598 [INFO]: 	99p_search_speed_ms: 16.951418949756796
2025-03-13 15:34:37,598 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:37,598 [INFO]: 	nb vectors: 3210
2025-03-13 15:34:37,598 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:37,598 [INFO]: 	compression ratio: 0.9993097748975656
2025-03-13 15:34:37,598 [INFO]: }
2025-03-13 15:34:37,598 [INFO]: 	>>> Finished "Creating the index" in 77.0022 secs
2025-03-13 15:34:37,598 [INFO]: >>> Finished "Launching the whole pipeline" in 77.0323 secs
2025-03-13 15:34:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 35701 [episode count 9/20]
[retrieval_preprocessing] for episode 78972 [episode count 10/20], we have num_retrieval=np.int64(3131) num_query=np.int64(180)
2025-03-13 15:34:40,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:40,818 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:40
2025-03-13 15:34:40,819 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1346.49it/s]
2025-03-13 15:34:40,846 [INFO]: There are 3131 embeddings of dim 49152
2025-03-13 15:34:40,846 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:34:40,846 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:40
2025-03-13 15:34:40,846 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:40,846 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:34:40,846 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:40,846 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:40,846 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:40
2025-03-13 15:34:40,846 [INFO]: 646.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:40,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:34:40,847 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:40
2025-03-13 15:34:40,847 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:40,847 [INFO]: 	Creating the index 03/13/2025, 15:34:40
2025-03-13 15:34:40,847 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:40
2025-03-13 15:34:40,848 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:34:40,848 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:40
2025-03-13 15:34:40,848 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:34:40,848 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.57it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.43it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.34it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.85it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.02it/s]100%|██████████| 13/13 [00:03<00:00,  2.04it/s]100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
2025-03-13 15:34:44,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:44
2025-03-13 15:35:31,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9579 secs
2025-03-13 15:35:31,504 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:35:31,504 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.50it/s] 50%|█████     | 2/4 [00:00<00:00,  5.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.41it/s]
2025-03-13 15:35:58,762 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2575 secs
2025-03-13 15:35:58,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9177 secs
2025-03-13 15:35:58,766 [INFO]: {
2025-03-13 15:35:58,766 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:58,766 [INFO]: 	index_param: efSearch=177
2025-03-13 15:35:58,766 [INFO]: 	index_path: knn.index
2025-03-13 15:35:58,766 [INFO]: 	size in bytes: 616004950
2025-03-13 15:35:58,766 [INFO]: 	avg_search_speed_ms: 9.239676058256272
2025-03-13 15:35:58,766 [INFO]: 	99p_search_speed_ms: 14.602096453309064
2025-03-13 15:35:58,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:58,766 [INFO]: 	nb vectors: 3131
2025-03-13 15:35:58,766 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:58,766 [INFO]: 	compression ratio: 0.9993095802233407
2025-03-13 15:35:58,766 [INFO]: }
2025-03-13 15:35:58,767 [INFO]: 	>>> Finished "Creating the index" in 77.9196 secs
2025-03-13 15:35:58,767 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9480 secs
2025-03-13 15:35:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 78972 [episode count 10/20]
[retrieval_preprocessing] for episode 46240 [episode count 11/20], we have num_retrieval=np.int64(3146) num_query=np.int64(165)
2025-03-13 15:36:01,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:02,089 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:02
2025-03-13 15:36:02,089 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2379.07it/s]
2025-03-13 15:36:02,111 [INFO]: There are 3146 embeddings of dim 49152
2025-03-13 15:36:02,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 15:36:02,111 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:02
2025-03-13 15:36:02,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:02,111 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:36:02,111 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:02,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:02,111 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:02
2025-03-13 15:36:02,112 [INFO]: 649.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:02,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:36:02,112 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:02
2025-03-13 15:36:02,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:02,112 [INFO]: 	Creating the index 03/13/2025, 15:36:02
2025-03-13 15:36:02,112 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:02
2025-03-13 15:36:02,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:36:02,113 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:02
2025-03-13 15:36:02,113 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:36:02,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.85it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.48it/s] 31%|███       | 4/13 [00:00<00:01,  8.27it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.96it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.93it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.97it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.91it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.98it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.94it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.89it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.82it/s]100%|██████████| 13/13 [00:04<00:00,  1.05it/s]100%|██████████| 13/13 [00:04<00:00,  2.96it/s]
2025-03-13 15:36:06,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:06
2025-03-13 15:36:49,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6655 secs
2025-03-13 15:36:49,179 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:36:49,179 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 15:37:17,050 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8708 secs
2025-03-13 15:37:17,054 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.9409 secs
2025-03-13 15:37:17,054 [INFO]: {
2025-03-13 15:37:17,054 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:17,054 [INFO]: 	index_param: efSearch=200
2025-03-13 15:37:17,054 [INFO]: 	index_path: knn.index
2025-03-13 15:37:17,054 [INFO]: 	size in bytes: 618956050
2025-03-13 15:37:17,054 [INFO]: 	avg_search_speed_ms: 11.548941651430178
2025-03-13 15:37:17,054 [INFO]: 	99p_search_speed_ms: 16.39015693217516
2025-03-13 15:37:17,054 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:17,054 [INFO]: 	nb vectors: 3146
2025-03-13 15:37:17,054 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:17,054 [INFO]: 	compression ratio: 0.9993096731181479
2025-03-13 15:37:17,054 [INFO]: }
2025-03-13 15:37:17,054 [INFO]: 	>>> Finished "Creating the index" in 74.9424 secs
2025-03-13 15:37:17,054 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9650 secs
2025-03-13 15:37:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 46240 [episode count 11/20]
[retrieval_preprocessing] for episode 42236 [episode count 12/20], we have num_retrieval=np.int64(3178) num_query=np.int64(133)
2025-03-13 15:37:22,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:22,996 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:22
2025-03-13 15:37:22,996 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 963.32it/s]
2025-03-13 15:37:23,024 [INFO]: There are 3178 embeddings of dim 49152
2025-03-13 15:37:23,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 15:37:23,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:23
2025-03-13 15:37:23,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:23,024 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:37:23,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:23,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:37:23,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:23
2025-03-13 15:37:23,025 [INFO]: 655.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:23,025 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:37:23,025 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:23
2025-03-13 15:37:23,025 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:23,025 [INFO]: 	Creating the index 03/13/2025, 15:37:23
2025-03-13 15:37:23,026 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:23
2025-03-13 15:37:23,029 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:37:23,029 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:23
2025-03-13 15:37:23,030 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:37:23,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.45it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.78it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.08it/s] 31%|███       | 4/13 [00:00<00:01,  7.45it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.25it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.20it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.52it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.47it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.31it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.15it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.04it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.87it/s]100%|██████████| 13/13 [00:04<00:00,  1.07it/s]100%|██████████| 13/13 [00:04<00:00,  2.92it/s]
2025-03-13 15:37:27,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:27
2025-03-13 15:38:10,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8551 secs
2025-03-13 15:38:10,792 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:38:10,792 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s]
2025-03-13 15:38:35,175 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3832 secs
2025-03-13 15:38:35,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1487 secs
2025-03-13 15:38:35,178 [INFO]: {
2025-03-13 15:38:35,178 [INFO]: 	index_key: HNSW15
2025-03-13 15:38:35,178 [INFO]: 	index_param: efSearch=212
2025-03-13 15:38:35,178 [INFO]: 	index_path: knn.index
2025-03-13 15:38:35,178 [INFO]: 	size in bytes: 625251850
2025-03-13 15:38:35,179 [INFO]: 	avg_search_speed_ms: 11.68210826086307
2025-03-13 15:38:35,179 [INFO]: 	99p_search_speed_ms: 22.3268958507106
2025-03-13 15:38:35,179 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:38:35,179 [INFO]: 	nb vectors: 3178
2025-03-13 15:38:35,179 [INFO]: 	vectors dimension: 49152
2025-03-13 15:38:35,179 [INFO]: 	compression ratio: 0.9993096765727283
2025-03-13 15:38:35,179 [INFO]: }
2025-03-13 15:38:35,179 [INFO]: 	>>> Finished "Creating the index" in 72.1531 secs
2025-03-13 15:38:35,179 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1822 secs
2025-03-13 15:38:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:38:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 42236 [episode count 12/20]
[retrieval_preprocessing] for episode 15769 [episode count 13/20], we have num_retrieval=np.int64(3138) num_query=np.int64(173)
2025-03-13 15:38:37,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:38,177 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:38
2025-03-13 15:38:38,177 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.24it/s]
2025-03-13 15:38:38,201 [INFO]: There are 3138 embeddings of dim 49152
2025-03-13 15:38:38,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 15:38:38,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:38
2025-03-13 15:38:38,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:38,201 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:38:38,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:38,202 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:38:38,202 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:38
2025-03-13 15:38:38,202 [INFO]: 647.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:38,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:38:38,202 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:38
2025-03-13 15:38:38,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:38,202 [INFO]: 	Creating the index 03/13/2025, 15:38:38
2025-03-13 15:38:38,202 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:38
2025-03-13 15:38:38,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:38:38,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:38
2025-03-13 15:38:38,203 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:38:38,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.45it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.51it/s] 23%|██▎       | 3/13 [00:00<00:01,  5.99it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.63it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.57it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.18it/s] 85%|████████▍ | 11/13 [00:01<00:00, 13.36it/s]100%|██████████| 13/13 [00:03<00:00,  2.22it/s]100%|██████████| 13/13 [00:03<00:00,  3.78it/s]
2025-03-13 15:38:41,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:41
2025-03-13 15:39:37,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.4157 secs
2025-03-13 15:39:37,058 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:39:37,058 [INFO]: 	Compute fast metrics 03/13/2025, 15:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 15:40:07,217 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1590 secs
2025-03-13 15:40:07,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.4596 secs
2025-03-13 15:40:07,663 [INFO]: {
2025-03-13 15:40:07,663 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:07,663 [INFO]: 	index_param: efSearch=185
2025-03-13 15:40:07,663 [INFO]: 	index_path: knn.index
2025-03-13 15:40:07,663 [INFO]: 	size in bytes: 617382130
2025-03-13 15:40:07,663 [INFO]: 	avg_search_speed_ms: 10.318601756021227
2025-03-13 15:40:07,663 [INFO]: 	99p_search_speed_ms: 15.806577922776324
2025-03-13 15:40:07,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:07,663 [INFO]: 	nb vectors: 3138
2025-03-13 15:40:07,664 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:07,664 [INFO]: 	compression ratio: 0.9993096236847672
2025-03-13 15:40:07,664 [INFO]: }
2025-03-13 15:40:07,664 [INFO]: 	>>> Finished "Creating the index" in 89.4618 secs
2025-03-13 15:40:07,664 [INFO]: >>> Finished "Launching the whole pipeline" in 89.4867 secs
2025-03-13 15:40:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 15769 [episode count 13/20]
[retrieval_preprocessing] for episode 91554 [episode count 14/20], we have num_retrieval=np.int64(3171) num_query=np.int64(140)
2025-03-13 15:40:10,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:11,026 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:11
2025-03-13 15:40:11,026 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.46it/s]
2025-03-13 15:40:11,055 [INFO]: There are 3171 embeddings of dim 49152
2025-03-13 15:40:11,055 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 15:40:11,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:11
2025-03-13 15:40:11,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:11,055 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:40:11,055 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:11,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:11,055 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:11
2025-03-13 15:40:11,055 [INFO]: 654.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:11,055 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:40:11,055 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:11
2025-03-13 15:40:11,055 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:11,055 [INFO]: 	Creating the index 03/13/2025, 15:40:11
2025-03-13 15:40:11,055 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:11
2025-03-13 15:40:11,056 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:40:11,056 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:11
2025-03-13 15:40:11,056 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:40:11,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.64it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.70it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.72it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.15it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.36it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.50it/s]100%|██████████| 13/13 [00:03<00:00,  2.12it/s]100%|██████████| 13/13 [00:03<00:00,  3.68it/s]
2025-03-13 15:40:14,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:14
2025-03-13 15:40:55,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4890 secs
2025-03-13 15:40:55,081 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:40:55,081 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 15:41:17,457 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3763 secs
2025-03-13 15:41:17,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4042 secs
2025-03-13 15:41:17,461 [INFO]: {
2025-03-13 15:41:17,461 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:17,461 [INFO]: 	index_param: efSearch=201
2025-03-13 15:41:17,461 [INFO]: 	index_path: knn.index
2025-03-13 15:41:17,461 [INFO]: 	size in bytes: 623874610
2025-03-13 15:41:17,461 [INFO]: 	avg_search_speed_ms: 13.718155666544462
2025-03-13 15:41:17,461 [INFO]: 	99p_search_speed_ms: 24.69922743737698
2025-03-13 15:41:17,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:17,461 [INFO]: 	nb vectors: 3171
2025-03-13 15:41:17,461 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:17,461 [INFO]: 	compression ratio: 0.999309729883061
2025-03-13 15:41:17,461 [INFO]: }
2025-03-13 15:41:17,461 [INFO]: 	>>> Finished "Creating the index" in 66.4055 secs
2025-03-13 15:41:17,461 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4347 secs
2025-03-13 15:41:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 91554 [episode count 14/20]
[retrieval_preprocessing] for episode 28395 [episode count 15/20], we have num_retrieval=np.int64(3067) num_query=np.int64(244)
2025-03-13 15:41:20,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:21,092 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:21
2025-03-13 15:41:21,092 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.28it/s]
2025-03-13 15:41:21,118 [INFO]: There are 3067 embeddings of dim 49152
2025-03-13 15:41:21,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:41:21,118 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:21
2025-03-13 15:41:21,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:21,119 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:41:21,119 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:21,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:41:21,119 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:21
2025-03-13 15:41:21,119 [INFO]: 633.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:21,119 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:41:21,119 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:21
2025-03-13 15:41:21,119 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:21,119 [INFO]: 	Creating the index 03/13/2025, 15:41:21
2025-03-13 15:41:21,119 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:21
2025-03-13 15:41:21,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:41:21,120 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:21
2025-03-13 15:41:21,120 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:41:21,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.62it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.24it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.19it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.53it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.59it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.58it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.46it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.49it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.42it/s]100%|██████████| 13/13 [00:04<00:00,  1.11it/s]100%|██████████| 13/13 [00:04<00:00,  3.10it/s]
2025-03-13 15:41:25,323 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:25
2025-03-13 15:42:10,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5487 secs
2025-03-13 15:42:10,873 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:42:10,873 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 15:42:31,736 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8636 secs
2025-03-13 15:42:31,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6192 secs
2025-03-13 15:42:31,739 [INFO]: {
2025-03-13 15:42:31,739 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:31,739 [INFO]: 	index_param: efSearch=200
2025-03-13 15:42:31,739 [INFO]: 	index_path: knn.index
2025-03-13 15:42:31,739 [INFO]: 	size in bytes: 603413230
2025-03-13 15:42:31,739 [INFO]: 	avg_search_speed_ms: 12.322701366097562
2025-03-13 15:42:31,739 [INFO]: 	99p_search_speed_ms: 19.633770890068263
2025-03-13 15:42:31,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:31,739 [INFO]: 	nb vectors: 3067
2025-03-13 15:42:31,739 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:31,739 [INFO]: 	compression ratio: 0.9993097698570513
2025-03-13 15:42:31,739 [INFO]: }
2025-03-13 15:42:31,739 [INFO]: 	>>> Finished "Creating the index" in 70.6205 secs
2025-03-13 15:42:31,740 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6473 secs
2025-03-13 15:42:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 28395 [episode count 15/20]
[retrieval_preprocessing] for episode 50602 [episode count 16/20], we have num_retrieval=np.int64(3126) num_query=np.int64(185)
2025-03-13 15:42:35,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:35,690 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:35
2025-03-13 15:42:35,690 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 15:42:35,716 [INFO]: There are 3126 embeddings of dim 49152
2025-03-13 15:42:35,717 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:42:35,717 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:35
2025-03-13 15:42:35,717 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:35,717 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:42:35,717 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:35,717 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:42:35,717 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:35
2025-03-13 15:42:35,717 [INFO]: 645.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:35,718 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:42:35,718 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:35
2025-03-13 15:42:35,718 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:35,718 [INFO]: 	Creating the index 03/13/2025, 15:42:35
2025-03-13 15:42:35,718 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:35
2025-03-13 15:42:35,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:42:35,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:35
2025-03-13 15:42:35,721 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:42:35,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.78it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.23it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.23it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.71it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.00it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.30it/s]100%|██████████| 13/13 [00:03<00:00,  2.14it/s]100%|██████████| 13/13 [00:03<00:00,  3.73it/s]
2025-03-13 15:42:39,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:39
2025-03-13 15:43:29,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4174 secs
2025-03-13 15:43:29,626 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 15:43:29,626 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s]
2025-03-13 15:43:49,184 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5579 secs
2025-03-13 15:43:49,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4664 secs
2025-03-13 15:43:49,187 [INFO]: {
2025-03-13 15:43:49,187 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:49,187 [INFO]: 	index_param: efSearch=147
2025-03-13 15:43:49,187 [INFO]: 	index_path: knn.index
2025-03-13 15:43:49,187 [INFO]: 	size in bytes: 615021250
2025-03-13 15:43:49,187 [INFO]: 	avg_search_speed_ms: 8.99707487407941
2025-03-13 15:43:49,187 [INFO]: 	99p_search_speed_ms: 18.88259027618916
2025-03-13 15:43:49,187 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:49,187 [INFO]: 	nb vectors: 3126
2025-03-13 15:43:49,187 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:49,187 [INFO]: 	compression ratio: 0.9993095490602967
2025-03-13 15:43:49,187 [INFO]: }
2025-03-13 15:43:49,187 [INFO]: 	>>> Finished "Creating the index" in 73.4692 secs
2025-03-13 15:43:49,187 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4976 secs
2025-03-13 15:43:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 50602 [episode count 16/20]
[retrieval_preprocessing] for episode 22200 [episode count 17/20], we have num_retrieval=np.int64(3175) num_query=np.int64(136)
2025-03-13 15:43:53,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:54,582 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:54
2025-03-13 15:43:54,583 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.90it/s]
2025-03-13 15:43:54,610 [INFO]: There are 3175 embeddings of dim 49152
2025-03-13 15:43:54,610 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:43:54,610 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:54
2025-03-13 15:43:54,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:54,610 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:43:54,610 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:54,610 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:43:54,610 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:54
2025-03-13 15:43:54,611 [INFO]: 655.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:54,611 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:43:54,611 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:54
2025-03-13 15:43:54,611 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:54,611 [INFO]: 	Creating the index 03/13/2025, 15:43:54
2025-03-13 15:43:54,611 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:54
2025-03-13 15:43:54,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:43:54,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:54
2025-03-13 15:43:54,612 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:43:54,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.90it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.41it/s] 31%|███       | 4/13 [00:00<00:00, 10.59it/s] 46%|████▌     | 6/13 [00:00<00:00, 10.09it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.78it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.38it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.09it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.84it/s]100%|██████████| 13/13 [00:04<00:00,  1.33it/s]100%|██████████| 13/13 [00:04<00:00,  3.20it/s]
2025-03-13 15:43:58,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:58
2025-03-13 15:44:36,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8296 secs
2025-03-13 15:44:36,506 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:44:36,506 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 15:45:08,381 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8744 secs
2025-03-13 15:45:08,384 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7720 secs
2025-03-13 15:45:08,385 [INFO]: {
2025-03-13 15:45:08,385 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:08,385 [INFO]: 	index_param: efSearch=212
2025-03-13 15:45:08,385 [INFO]: 	index_path: knn.index
2025-03-13 15:45:08,385 [INFO]: 	size in bytes: 624661570
2025-03-13 15:45:08,385 [INFO]: 	avg_search_speed_ms: 11.772864280980738
2025-03-13 15:45:08,385 [INFO]: 	99p_search_speed_ms: 19.447811832651496
2025-03-13 15:45:08,385 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:08,385 [INFO]: 	nb vectors: 3175
2025-03-13 15:45:08,385 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:08,385 [INFO]: 	compression ratio: 0.9993097542402041
2025-03-13 15:45:08,385 [INFO]: }
2025-03-13 15:45:08,385 [INFO]: 	>>> Finished "Creating the index" in 73.7744 secs
2025-03-13 15:45:08,385 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8027 secs
2025-03-13 15:45:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 22200 [episode count 17/20]
[retrieval_preprocessing] for episode 54988 [episode count 18/20], we have num_retrieval=np.int64(3173) num_query=np.int64(138)
2025-03-13 15:45:11,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:12,159 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:12
2025-03-13 15:45:12,160 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1236.16it/s]
2025-03-13 15:45:12,202 [INFO]: There are 3173 embeddings of dim 49152
2025-03-13 15:45:12,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0433 secs
2025-03-13 15:45:12,203 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:12
2025-03-13 15:45:12,203 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:12,204 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:45:12,204 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:12,204 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:45:12,204 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:12
2025-03-13 15:45:12,204 [INFO]: 654.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:12,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:45:12,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:12
2025-03-13 15:45:12,205 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:12,205 [INFO]: 	Creating the index 03/13/2025, 15:45:12
2025-03-13 15:45:12,205 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:12
2025-03-13 15:45:12,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:45:12,209 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:12
2025-03-13 15:45:12,209 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:45:12,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.82it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.33it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.59it/s] 31%|███       | 4/13 [00:00<00:01,  7.61it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.51it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.29it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.15it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.99it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.95it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.03it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.38it/s]100%|██████████| 13/13 [00:04<00:00,  1.18it/s]100%|██████████| 13/13 [00:04<00:00,  3.19it/s]
2025-03-13 15:45:16,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:16
2025-03-13 15:46:07,544 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2562 secs
2025-03-13 15:46:07,545 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 15:46:07,545 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 15:46:35,236 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6912 secs
2025-03-13 15:46:35,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.0304 secs
2025-03-13 15:46:35,239 [INFO]: {
2025-03-13 15:46:35,239 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:35,239 [INFO]: 	index_param: efSearch=160
2025-03-13 15:46:35,239 [INFO]: 	index_path: knn.index
2025-03-13 15:46:35,239 [INFO]: 	size in bytes: 624268090
2025-03-13 15:46:35,239 [INFO]: 	avg_search_speed_ms: 10.651390335033623
2025-03-13 15:46:35,239 [INFO]: 	99p_search_speed_ms: 19.722542413510386
2025-03-13 15:46:35,239 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:35,239 [INFO]: 	nb vectors: 3173
2025-03-13 15:46:35,239 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:35,239 [INFO]: 	compression ratio: 0.9993097420693087
2025-03-13 15:46:35,239 [INFO]: }
2025-03-13 15:46:35,239 [INFO]: 	>>> Finished "Creating the index" in 83.0345 secs
2025-03-13 15:46:35,239 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0799 secs
2025-03-13 15:46:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 54988 [episode count 18/20]
[retrieval_preprocessing] for episode 94906 [episode count 19/20], we have num_retrieval=np.int64(3189) num_query=np.int64(122)
2025-03-13 15:46:37,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:38,495 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:38
2025-03-13 15:46:38,495 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.34it/s]
2025-03-13 15:46:38,534 [INFO]: There are 3189 embeddings of dim 49152
2025-03-13 15:46:38,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0390 secs
2025-03-13 15:46:38,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:38
2025-03-13 15:46:38,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:38,535 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:46:38,535 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:38,535 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:46:38,535 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:38
2025-03-13 15:46:38,535 [INFO]: 658.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:38,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:46:38,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:38
2025-03-13 15:46:38,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:38,536 [INFO]: 	Creating the index 03/13/2025, 15:46:38
2025-03-13 15:46:38,536 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:38
2025-03-13 15:46:38,539 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:46:38,540 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:38
2025-03-13 15:46:38,540 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:46:38,540 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.66it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.77it/s] 31%|███       | 4/13 [00:00<00:01,  8.61it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.64it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.44it/s] 92%|█████████▏| 12/13 [00:01<00:00, 10.52it/s]100%|██████████| 13/13 [00:03<00:00,  3.32it/s]
2025-03-13 15:46:42,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:42
2025-03-13 15:47:28,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0867 secs
2025-03-13 15:47:28,551 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:47:28,551 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.27it/s] 50%|█████     | 2/4 [00:00<00:00,  5.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.20it/s]
2025-03-13 15:47:55,689 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1377 secs
2025-03-13 15:47:55,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.1524 secs
2025-03-13 15:47:55,692 [INFO]: {
2025-03-13 15:47:55,692 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:55,692 [INFO]: 	index_param: efSearch=173
2025-03-13 15:47:55,692 [INFO]: 	index_path: knn.index
2025-03-13 15:47:55,692 [INFO]: 	size in bytes: 627415990
2025-03-13 15:47:55,692 [INFO]: 	avg_search_speed_ms: 15.676784346633383
2025-03-13 15:47:55,693 [INFO]: 	99p_search_speed_ms: 45.282234025653445
2025-03-13 15:47:55,693 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:55,693 [INFO]: 	nb vectors: 3189
2025-03-13 15:47:55,693 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:55,693 [INFO]: 	compression ratio: 0.999309743444696
2025-03-13 15:47:55,693 [INFO]: }
2025-03-13 15:47:55,693 [INFO]: 	>>> Finished "Creating the index" in 77.1565 secs
2025-03-13 15:47:55,693 [INFO]: >>> Finished "Launching the whole pipeline" in 77.1976 secs
2025-03-13 15:47:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 94906 [episode count 19/20]
2025-03-13 15:47:57: [retrieval_preprocessing] finished for 4823049285_remove_bottle_from_tray_and_place_on_table [chosen_id count 1/196]
2025-03-13 15:47:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4823049285_turn_on_switch [chosen_id count 2/196]
2025-03-13 15:47:58: [retrieval_preprocessing] we have num_total=2637 embedding_dim=49152
[retrieval_preprocessing] for episode 88072 [episode count 0/20], we have num_retrieval=np.int64(2439) num_query=np.int64(198)
2025-03-13 15:47:59,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:00,234 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:00
2025-03-13 15:48:00,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.81it/s]
2025-03-13 15:48:00,269 [INFO]: There are 2439 embeddings of dim 49152
2025-03-13 15:48:00,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 15:48:00,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:00
2025-03-13 15:48:00,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:00,270 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:48:00,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:00,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:48:00,270 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:00
2025-03-13 15:48:00,270 [INFO]: 503.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:00,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:48:00,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:00
2025-03-13 15:48:00,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:00,270 [INFO]: 	Creating the index 03/13/2025, 15:48:00
2025-03-13 15:48:00,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:00
2025-03-13 15:48:00,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:48:00,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:00
2025-03-13 15:48:00,271 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:48:00,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.91it/s] 30%|███       | 3/10 [00:00<00:00,  9.19it/s] 50%|█████     | 5/10 [00:00<00:00,  9.98it/s] 70%|███████   | 7/10 [00:00<00:00, 10.11it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.13it/s]100%|██████████| 10/10 [00:02<00:00,  3.72it/s]
2025-03-13 15:48:02,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:02
2025-03-13 15:48:37,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2964 secs
2025-03-13 15:48:37,260 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 15:48:37,260 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.28s/it] 50%|█████     | 2/4 [00:04<00:04,  2.16s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.43s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.85s/it]
2025-03-13 15:49:09,417 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1568 secs
2025-03-13 15:49:09,419 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1483 secs
2025-03-13 15:49:09,420 [INFO]: {
2025-03-13 15:49:09,420 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:09,420 [INFO]: 	index_param: efSearch=245
2025-03-13 15:49:09,420 [INFO]: 	index_path: knn.index
2025-03-13 15:49:09,420 [INFO]: 	size in bytes: 479858050
2025-03-13 15:49:09,420 [INFO]: 	avg_search_speed_ms: 9.861258933636593
2025-03-13 15:49:09,420 [INFO]: 	99p_search_speed_ms: 15.899962172843516
2025-03-13 15:49:09,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:09,420 [INFO]: 	nb vectors: 2439
2025-03-13 15:49:09,420 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:09,420 [INFO]: 	compression ratio: 0.999309925091389
2025-03-13 15:49:09,420 [INFO]: }
2025-03-13 15:49:09,420 [INFO]: 	>>> Finished "Creating the index" in 69.1499 secs
2025-03-13 15:49:09,420 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1860 secs
2025-03-13 15:49:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 88072 [episode count 0/20]
[retrieval_preprocessing] for episode 6203 [episode count 1/20], we have num_retrieval=np.int64(2537) num_query=np.int64(100)
2025-03-13 15:49:12,048 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:12,481 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:12
2025-03-13 15:49:12,481 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.52it/s]
2025-03-13 15:49:12,506 [INFO]: There are 2537 embeddings of dim 49152
2025-03-13 15:49:12,506 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:49:12,506 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:12
2025-03-13 15:49:12,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:12,506 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:49:12,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:12,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:12,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:12
2025-03-13 15:49:12,506 [INFO]: 523.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:12,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:49:12,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:12
2025-03-13 15:49:12,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:12,506 [INFO]: 	Creating the index 03/13/2025, 15:49:12
2025-03-13 15:49:12,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:12
2025-03-13 15:49:12,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:49:12,507 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:12
2025-03-13 15:49:12,507 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:49:12,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.61it/s] 40%|████      | 4/10 [00:00<00:00, 17.21it/s] 70%|███████   | 7/10 [00:00<00:00, 20.15it/s]100%|██████████| 10/10 [00:02<00:00,  3.31it/s]100%|██████████| 10/10 [00:02<00:00,  4.40it/s]
2025-03-13 15:49:14,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:14
2025-03-13 15:49:46,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8797 secs
2025-03-13 15:49:46,673 [INFO]: The best hyperparameters are: efSearch=320
2025-03-13 15:49:46,673 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 15:50:14,353 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6798 secs
2025-03-13 15:50:14,513 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0058 secs
2025-03-13 15:50:14,514 [INFO]: {
2025-03-13 15:50:14,514 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:14,514 [INFO]: 	index_param: efSearch=320
2025-03-13 15:50:14,514 [INFO]: 	index_path: knn.index
2025-03-13 15:50:14,514 [INFO]: 	size in bytes: 499139050
2025-03-13 15:50:14,514 [INFO]: 	avg_search_speed_ms: 11.810167223366841
2025-03-13 15:50:14,514 [INFO]: 	99p_search_speed_ms: 21.109537575393915
2025-03-13 15:50:14,514 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:14,514 [INFO]: 	nb vectors: 2537
2025-03-13 15:50:14,514 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:14,514 [INFO]: 	compression ratio: 0.999309703378247
2025-03-13 15:50:14,514 [INFO]: }
2025-03-13 15:50:14,514 [INFO]: 	>>> Finished "Creating the index" in 62.0080 secs
2025-03-13 15:50:14,514 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0334 secs
2025-03-13 15:50:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 6203 [episode count 1/20]
[retrieval_preprocessing] for episode 12571 [episode count 2/20], we have num_retrieval=np.int64(2509) num_query=np.int64(128)
2025-03-13 15:50:16,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:16,915 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:16
2025-03-13 15:50:16,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 15:50:16,940 [INFO]: There are 2509 embeddings of dim 49152
2025-03-13 15:50:16,941 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 15:50:16,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:16
2025-03-13 15:50:16,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:16,941 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:50:16,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:16,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:50:16,941 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:16
2025-03-13 15:50:16,941 [INFO]: 517.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:16,941 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:50:16,941 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:16
2025-03-13 15:50:16,941 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:16,941 [INFO]: 	Creating the index 03/13/2025, 15:50:16
2025-03-13 15:50:16,941 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:16
2025-03-13 15:50:16,942 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:50:16,942 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:16
2025-03-13 15:50:16,942 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:50:16,942 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.34it/s] 30%|███       | 3/10 [00:00<00:00, 10.85it/s] 50%|█████     | 5/10 [00:00<00:00, 12.50it/s] 70%|███████   | 7/10 [00:00<00:00, 13.08it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.07it/s]100%|██████████| 10/10 [00:03<00:00,  2.84it/s]
2025-03-13 15:50:20,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:20
2025-03-13 15:50:58,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2128 secs
2025-03-13 15:50:58,688 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 15:50:58,688 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 15:51:20,540 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8513 secs
2025-03-13 15:51:20,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7690 secs
2025-03-13 15:51:20,712 [INFO]: {
2025-03-13 15:51:20,712 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:20,713 [INFO]: 	index_param: efSearch=229
2025-03-13 15:51:20,713 [INFO]: 	index_path: knn.index
2025-03-13 15:51:20,713 [INFO]: 	size in bytes: 493630150
2025-03-13 15:51:20,713 [INFO]: 	avg_search_speed_ms: 10.016923299981263
2025-03-13 15:51:20,713 [INFO]: 	99p_search_speed_ms: 18.913707369938486
2025-03-13 15:51:20,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:20,713 [INFO]: 	nb vectors: 2509
2025-03-13 15:51:20,713 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:20,713 [INFO]: 	compression ratio: 0.999309851717931
2025-03-13 15:51:20,713 [INFO]: }
2025-03-13 15:51:20,713 [INFO]: 	>>> Finished "Creating the index" in 63.7719 secs
2025-03-13 15:51:20,713 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7976 secs
2025-03-13 15:51:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 12571 [episode count 2/20]
[retrieval_preprocessing] for episode 89110 [episode count 3/20], we have num_retrieval=np.int64(2545) num_query=np.int64(92)
2025-03-13 15:51:22,696 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:23,050 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:23
2025-03-13 15:51:23,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1389.76it/s]
2025-03-13 15:51:23,075 [INFO]: There are 2545 embeddings of dim 49152
2025-03-13 15:51:23,076 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 15:51:23,076 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:23
2025-03-13 15:51:23,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:23,076 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:51:23,076 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:23,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:51:23,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:23
2025-03-13 15:51:23,077 [INFO]: 525.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:23,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:51:23,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:23
2025-03-13 15:51:23,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:23,078 [INFO]: 	Creating the index 03/13/2025, 15:51:23
2025-03-13 15:51:23,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:23
2025-03-13 15:51:23,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:51:23,081 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:23
2025-03-13 15:51:23,081 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:51:23,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.88it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.38it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.62it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.56it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.03it/s]100%|██████████| 11/11 [00:02<00:00,  3.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.65it/s]
2025-03-13 15:51:25,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:25
2025-03-13 15:51:55,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1101 secs
2025-03-13 15:51:55,562 [INFO]: The best hyperparameters are: efSearch=319
2025-03-13 15:51:55,562 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 15:52:23,527 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9654 secs
2025-03-13 15:52:23,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4492 secs
2025-03-13 15:52:23,530 [INFO]: {
2025-03-13 15:52:23,530 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:23,530 [INFO]: 	index_param: efSearch=319
2025-03-13 15:52:23,530 [INFO]: 	index_path: knn.index
2025-03-13 15:52:23,530 [INFO]: 	size in bytes: 500713090
2025-03-13 15:52:23,530 [INFO]: 	avg_search_speed_ms: 12.420941081464939
2025-03-13 15:52:23,530 [INFO]: 	99p_search_speed_ms: 19.01162925176324
2025-03-13 15:52:23,530 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:23,530 [INFO]: 	nb vectors: 2545
2025-03-13 15:52:23,530 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:23,530 [INFO]: 	compression ratio: 0.9993095247420034
2025-03-13 15:52:23,530 [INFO]: }
2025-03-13 15:52:23,531 [INFO]: 	>>> Finished "Creating the index" in 60.4529 secs
2025-03-13 15:52:23,531 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4808 secs
2025-03-13 15:52:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 89110 [episode count 3/20]
[retrieval_preprocessing] for episode 1065 [episode count 4/20], we have num_retrieval=np.int64(2530) num_query=np.int64(107)
2025-03-13 15:52:27,185 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:27,724 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:27
2025-03-13 15:52:27,724 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-13 15:52:27,752 [INFO]: There are 2530 embeddings of dim 49152
2025-03-13 15:52:27,752 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:52:27,752 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:27
2025-03-13 15:52:27,752 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:27,753 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:52:27,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:27,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:52:27,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:27
2025-03-13 15:52:27,753 [INFO]: 522.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:27,753 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:52:27,753 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:27
2025-03-13 15:52:27,753 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:27,753 [INFO]: 	Creating the index 03/13/2025, 15:52:27
2025-03-13 15:52:27,753 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:27
2025-03-13 15:52:27,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:52:27,754 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:27
2025-03-13 15:52:27,754 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:52:27,754 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.05it/s] 20%|██        | 2/10 [00:00<00:01,  6.36it/s] 30%|███       | 3/10 [00:00<00:01,  6.75it/s] 40%|████      | 4/10 [00:00<00:00,  7.00it/s] 50%|█████     | 5/10 [00:00<00:00,  7.17it/s] 60%|██████    | 6/10 [00:00<00:00,  7.35it/s] 70%|███████   | 7/10 [00:01<00:00,  7.29it/s] 80%|████████  | 8/10 [00:01<00:00,  7.45it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.51it/s]100%|██████████| 10/10 [00:03<00:00,  1.47it/s]100%|██████████| 10/10 [00:03<00:00,  3.16it/s]
2025-03-13 15:52:30,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:30
2025-03-13 15:53:04,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5396 secs
2025-03-13 15:53:04,471 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 15:53:04,471 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.06s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.29it/s] 75%|███████▌  | 3/4 [00:04<00:01,  1.49s/it]
2025-03-13 15:53:40,996 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5246 secs
2025-03-13 15:53:40,998 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2440 secs
2025-03-13 15:53:40,998 [INFO]: {
2025-03-13 15:53:40,998 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:40,998 [INFO]: 	index_param: efSearch=266
2025-03-13 15:53:40,998 [INFO]: 	index_path: knn.index
2025-03-13 15:53:40,998 [INFO]: 	size in bytes: 497761870
2025-03-13 15:53:40,999 [INFO]: 	avg_search_speed_ms: 9.4007361880276
2025-03-13 15:53:40,999 [INFO]: 	99p_search_speed_ms: 16.235654491465493
2025-03-13 15:53:40,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:40,999 [INFO]: 	nb vectors: 2530
2025-03-13 15:53:40,999 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:40,999 [INFO]: 	compression ratio: 0.9993096498130722
2025-03-13 15:53:40,999 [INFO]: }
2025-03-13 15:53:40,999 [INFO]: 	>>> Finished "Creating the index" in 73.2456 secs
2025-03-13 15:53:40,999 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2745 secs
2025-03-13 15:53:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 1065 [episode count 4/20]
[retrieval_preprocessing] for episode 38049 [episode count 5/20], we have num_retrieval=np.int64(2528) num_query=np.int64(109)
2025-03-13 15:53:43,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:43,853 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:43
2025-03-13 15:53:43,853 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 768.19it/s]
2025-03-13 15:53:43,882 [INFO]: There are 2528 embeddings of dim 49152
2025-03-13 15:53:43,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 15:53:43,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:43
2025-03-13 15:53:43,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:43,883 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:53:43,884 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:43,884 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:53:43,884 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:43
2025-03-13 15:53:43,884 [INFO]: 521.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:43,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:53:43,884 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:43
2025-03-13 15:53:43,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:43,884 [INFO]: 	Creating the index 03/13/2025, 15:53:43
2025-03-13 15:53:43,885 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:43
2025-03-13 15:53:43,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:53:43,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:43
2025-03-13 15:53:43,888 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:53:43,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.05it/s] 20%|██        | 2/10 [00:00<00:01,  6.71it/s] 30%|███       | 3/10 [00:00<00:00,  7.49it/s] 40%|████      | 4/10 [00:00<00:00,  7.96it/s] 50%|█████     | 5/10 [00:00<00:00,  8.29it/s] 60%|██████    | 6/10 [00:00<00:00,  8.63it/s] 70%|███████   | 7/10 [00:00<00:00,  8.62it/s] 80%|████████  | 8/10 [00:00<00:00,  8.71it/s] 90%|█████████ | 9/10 [00:01<00:00,  4.51it/s]100%|██████████| 10/10 [00:04<00:00,  1.12s/it]100%|██████████| 10/10 [00:04<00:00,  2.19it/s]
2025-03-13 15:53:48,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:48
2025-03-13 15:54:18,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5246 secs
2025-03-13 15:54:18,994 [INFO]: The best hyperparameters are: efSearch=298
2025-03-13 15:54:18,994 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-13 15:54:43,195 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2008 secs
2025-03-13 15:54:43,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3116 secs
2025-03-13 15:54:43,200 [INFO]: {
2025-03-13 15:54:43,200 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:43,200 [INFO]: 	index_param: efSearch=298
2025-03-13 15:54:43,200 [INFO]: 	index_path: knn.index
2025-03-13 15:54:43,200 [INFO]: 	size in bytes: 497368330
2025-03-13 15:54:43,200 [INFO]: 	avg_search_speed_ms: 10.456983670767661
2025-03-13 15:54:43,200 [INFO]: 	99p_search_speed_ms: 18.13303735107184
2025-03-13 15:54:43,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:43,200 [INFO]: 	nb vectors: 2528
2025-03-13 15:54:43,200 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:43,200 [INFO]: 	compression ratio: 0.9993097550059128
2025-03-13 15:54:43,200 [INFO]: }
2025-03-13 15:54:43,200 [INFO]: 	>>> Finished "Creating the index" in 59.3154 secs
2025-03-13 15:54:43,200 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3470 secs
2025-03-13 15:54:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 38049 [episode count 5/20]
[retrieval_preprocessing] for episode 79321 [episode count 6/20], we have num_retrieval=np.int64(2523) num_query=np.int64(114)
2025-03-13 15:54:45,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:45,985 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:45
2025-03-13 15:54:45,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-13 15:54:46,012 [INFO]: There are 2523 embeddings of dim 49152
2025-03-13 15:54:46,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:54:46,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:46
2025-03-13 15:54:46,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:46,012 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:54:46,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:46,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:46,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:46
2025-03-13 15:54:46,012 [INFO]: 520.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:46,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:46,012 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:46
2025-03-13 15:54:46,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:46,012 [INFO]: 	Creating the index 03/13/2025, 15:54:46
2025-03-13 15:54:46,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:46
2025-03-13 15:54:46,014 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:54:46,014 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:46
2025-03-13 15:54:46,014 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:54:46,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.22it/s] 30%|███       | 3/10 [00:00<00:00, 11.06it/s] 50%|█████     | 5/10 [00:00<00:00, 12.10it/s] 70%|███████   | 7/10 [00:00<00:00, 11.91it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.81it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-13 15:54:48,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:48
2025-03-13 15:55:18,591 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1268 secs
2025-03-13 15:55:18,591 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 15:55:18,591 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:13,  4.41s/it] 50%|█████     | 2/4 [00:04<00:04,  2.11s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.72s/it]
2025-03-13 15:55:40,196 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6046 secs
2025-03-13 15:55:40,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1851 secs
2025-03-13 15:55:40,199 [INFO]: {
2025-03-13 15:55:40,199 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:40,199 [INFO]: 	index_param: efSearch=218
2025-03-13 15:55:40,199 [INFO]: 	index_path: knn.index
2025-03-13 15:55:40,199 [INFO]: 	size in bytes: 496384570
2025-03-13 15:55:40,199 [INFO]: 	avg_search_speed_ms: 8.31603825680397
2025-03-13 15:55:40,199 [INFO]: 	99p_search_speed_ms: 11.324837694410235
2025-03-13 15:55:40,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:40,199 [INFO]: 	nb vectors: 2523
2025-03-13 15:55:40,199 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:40,199 [INFO]: 	compression ratio: 0.9993098375318153
2025-03-13 15:55:40,199 [INFO]: }
2025-03-13 15:55:40,199 [INFO]: 	>>> Finished "Creating the index" in 54.1869 secs
2025-03-13 15:55:40,199 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2137 secs
2025-03-13 15:55:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 79321 [episode count 6/20]
[retrieval_preprocessing] for episode 93192 [episode count 7/20], we have num_retrieval=np.int64(2551) num_query=np.int64(86)
2025-03-13 15:55:42,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:43,010 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:43
2025-03-13 15:55:43,010 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1024.00it/s]
2025-03-13 15:55:43,056 [INFO]: There are 2551 embeddings of dim 49152
2025-03-13 15:55:43,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0459 secs
2025-03-13 15:55:43,057 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:43
2025-03-13 15:55:43,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:43,057 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:55:43,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:43,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:55:43,058 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:43
2025-03-13 15:55:43,058 [INFO]: 526.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:43,059 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 15:55:43,059 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:43
2025-03-13 15:55:43,059 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:43,060 [INFO]: 	Creating the index 03/13/2025, 15:55:43
2025-03-13 15:55:43,060 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:43
2025-03-13 15:55:43,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:55:43,061 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:43
2025-03-13 15:55:43,061 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:55:43,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.04it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.51it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.87it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.68it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.78it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.25it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.73it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.50it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.29it/s]100%|██████████| 11/11 [00:05<00:00,  1.19s/it]100%|██████████| 11/11 [00:05<00:00,  2.16it/s]
2025-03-13 15:55:48,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:48
2025-03-13 15:56:20,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2188 secs
2025-03-13 15:56:20,380 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:56:20,381 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.37it/s] 50%|█████     | 2/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.46it/s]
2025-03-13 15:56:39,719 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3380 secs
2025-03-13 15:56:39,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6596 secs
2025-03-13 15:56:39,721 [INFO]: {
2025-03-13 15:56:39,721 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:39,721 [INFO]: 	index_param: efSearch=173
2025-03-13 15:56:39,721 [INFO]: 	index_path: knn.index
2025-03-13 15:56:39,721 [INFO]: 	size in bytes: 501893530
2025-03-13 15:56:39,721 [INFO]: 	avg_search_speed_ms: 8.081591678685422
2025-03-13 15:56:39,721 [INFO]: 	99p_search_speed_ms: 12.292993823066356
2025-03-13 15:56:39,721 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:39,721 [INFO]: 	nb vectors: 2551
2025-03-13 15:56:39,721 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:39,721 [INFO]: 	compression ratio: 0.9993095706971955
2025-03-13 15:56:39,721 [INFO]: }
2025-03-13 15:56:39,721 [INFO]: 	>>> Finished "Creating the index" in 56.6615 secs
2025-03-13 15:56:39,721 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7110 secs
2025-03-13 15:56:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 93192 [episode count 7/20]
[retrieval_preprocessing] for episode 43319 [episode count 8/20], we have num_retrieval=np.int64(2483) num_query=np.int64(154)
2025-03-13 15:56:41,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:41,840 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:41
2025-03-13 15:56:41,841 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.92it/s]
2025-03-13 15:56:41,865 [INFO]: There are 2483 embeddings of dim 49152
2025-03-13 15:56:41,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:56:41,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:41
2025-03-13 15:56:41,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:41,866 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:56:41,866 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:41,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:41,866 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:41
2025-03-13 15:56:41,866 [INFO]: 512.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:41,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:56:41,866 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:41
2025-03-13 15:56:41,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:41,866 [INFO]: 	Creating the index 03/13/2025, 15:56:41
2025-03-13 15:56:41,866 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:41
2025-03-13 15:56:41,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:56:41,867 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:41
2025-03-13 15:56:41,867 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:56:41,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  4.45it/s] 20%|██        | 2/10 [00:00<00:01,  5.78it/s] 30%|███       | 3/10 [00:00<00:01,  6.29it/s] 40%|████      | 4/10 [00:00<00:00,  6.59it/s] 50%|█████     | 5/10 [00:00<00:00,  6.73it/s] 60%|██████    | 6/10 [00:00<00:00,  6.86it/s] 70%|███████   | 7/10 [00:01<00:00,  6.91it/s] 80%|████████  | 8/10 [00:01<00:00,  7.00it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.02it/s]100%|██████████| 10/10 [00:03<00:00,  1.65it/s]100%|██████████| 10/10 [00:03<00:00,  3.33it/s]
2025-03-13 15:56:44,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:44
2025-03-13 15:57:15,555 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6787 secs
2025-03-13 15:57:15,556 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 15:57:15,556 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 15:57:31,664 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1086 secs
2025-03-13 15:57:31,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8001 secs
2025-03-13 15:57:31,667 [INFO]: {
2025-03-13 15:57:31,667 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:31,668 [INFO]: 	index_param: efSearch=248
2025-03-13 15:57:31,668 [INFO]: 	index_path: knn.index
2025-03-13 15:57:31,668 [INFO]: 	size in bytes: 488514670
2025-03-13 15:57:31,668 [INFO]: 	avg_search_speed_ms: 10.435693744192822
2025-03-13 15:57:31,668 [INFO]: 	99p_search_speed_ms: 15.130831224378198
2025-03-13 15:57:31,668 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:31,668 [INFO]: 	nb vectors: 2483
2025-03-13 15:57:31,668 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:31,668 [INFO]: 	compression ratio: 0.9993101414948297
2025-03-13 15:57:31,668 [INFO]: }
2025-03-13 15:57:31,668 [INFO]: 	>>> Finished "Creating the index" in 49.8017 secs
2025-03-13 15:57:31,668 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8271 secs
2025-03-13 15:57:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 43319 [episode count 8/20]
[retrieval_preprocessing] for episode 33639 [episode count 9/20], we have num_retrieval=np.int64(2525) num_query=np.int64(112)
2025-03-13 15:57:34,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:34,942 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:34
2025-03-13 15:57:34,943 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.78it/s]
2025-03-13 15:57:34,967 [INFO]: There are 2525 embeddings of dim 49152
2025-03-13 15:57:34,967 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 15:57:34,967 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:34
2025-03-13 15:57:34,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:34,967 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:57:34,967 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:34,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:34,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:34
2025-03-13 15:57:34,967 [INFO]: 521.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:34,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:57:34,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:34
2025-03-13 15:57:34,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:34,968 [INFO]: 	Creating the index 03/13/2025, 15:57:34
2025-03-13 15:57:34,968 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:34
2025-03-13 15:57:34,969 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:57:34,969 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:34
2025-03-13 15:57:34,969 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:57:34,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.37it/s] 30%|███       | 3/10 [00:00<00:00,  9.09it/s] 50%|█████     | 5/10 [00:00<00:00,  9.45it/s] 60%|██████    | 6/10 [00:00<00:00,  9.42it/s] 70%|███████   | 7/10 [00:00<00:00,  9.36it/s] 80%|████████  | 8/10 [00:00<00:00,  9.13it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.13it/s]100%|██████████| 10/10 [00:03<00:00,  1.49it/s]100%|██████████| 10/10 [00:03<00:00,  3.29it/s]
2025-03-13 15:57:38,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:38
2025-03-13 15:58:10,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2014 secs
2025-03-13 15:58:10,324 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 15:58:10,324 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 15:58:43,136 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8116 secs
2025-03-13 15:58:43,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1696 secs
2025-03-13 15:58:43,138 [INFO]: {
2025-03-13 15:58:43,139 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:43,139 [INFO]: 	index_param: efSearch=280
2025-03-13 15:58:43,139 [INFO]: 	index_path: knn.index
2025-03-13 15:58:43,139 [INFO]: 	size in bytes: 496778050
2025-03-13 15:58:43,139 [INFO]: 	avg_search_speed_ms: 11.041013656541804
2025-03-13 15:58:43,139 [INFO]: 	99p_search_speed_ms: 18.275200179778043
2025-03-13 15:58:43,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:43,139 [INFO]: 	nb vectors: 2525
2025-03-13 15:58:43,139 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:43,139 [INFO]: 	compression ratio: 0.9993098527602015
2025-03-13 15:58:43,139 [INFO]: }
2025-03-13 15:58:43,139 [INFO]: 	>>> Finished "Creating the index" in 68.1712 secs
2025-03-13 15:58:43,139 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1961 secs
2025-03-13 15:58:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 33639 [episode count 9/20]
[retrieval_preprocessing] for episode 10683 [episode count 10/20], we have num_retrieval=np.int64(2563) num_query=np.int64(74)
2025-03-13 15:58:45,990 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:46,643 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:46
2025-03-13 15:58:46,643 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.73it/s]
2025-03-13 15:58:46,676 [INFO]: There are 2563 embeddings of dim 49152
2025-03-13 15:58:46,677 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 15:58:46,677 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:46
2025-03-13 15:58:46,677 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:46,677 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:58:46,677 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:46,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:58:46,677 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:46
2025-03-13 15:58:46,678 [INFO]: 528.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:46,678 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:58:46,678 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:46
2025-03-13 15:58:46,679 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:46,679 [INFO]: 	Creating the index 03/13/2025, 15:58:46
2025-03-13 15:58:46,679 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:46
2025-03-13 15:58:46,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:58:46,682 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:46
2025-03-13 15:58:46,682 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:58:46,683 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.93it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.63it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.57it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.96it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.20it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.33it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.44it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.61it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.65it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.70it/s]100%|██████████| 11/11 [00:02<00:00,  1.64it/s]100%|██████████| 11/11 [00:02<00:00,  3.72it/s]
2025-03-13 15:58:49,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:49
2025-03-13 15:59:24,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1529 secs
2025-03-13 15:59:24,099 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 15:59:24,100 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 15:59:49,612 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5119 secs
2025-03-13 15:59:49,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9334 secs
2025-03-13 15:59:49,616 [INFO]: {
2025-03-13 15:59:49,616 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:49,616 [INFO]: 	index_param: efSearch=245
2025-03-13 15:59:49,616 [INFO]: 	index_path: knn.index
2025-03-13 15:59:49,616 [INFO]: 	size in bytes: 504254410
2025-03-13 15:59:49,616 [INFO]: 	avg_search_speed_ms: 11.754454417782371
2025-03-13 15:59:49,616 [INFO]: 	99p_search_speed_ms: 24.877842515707016
2025-03-13 15:59:49,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:49,616 [INFO]: 	nb vectors: 2563
2025-03-13 15:59:49,616 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:49,616 [INFO]: 	compression ratio: 0.9993096619621036
2025-03-13 15:59:49,616 [INFO]: }
2025-03-13 15:59:49,616 [INFO]: 	>>> Finished "Creating the index" in 62.9372 secs
2025-03-13 15:59:49,616 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9729 secs
2025-03-13 15:59:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 10683 [episode count 10/20]
[retrieval_preprocessing] for episode 40892 [episode count 11/20], we have num_retrieval=np.int64(2482) num_query=np.int64(155)
2025-03-13 15:59:51,677 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:52,199 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:52
2025-03-13 15:59:52,199 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.01it/s]
2025-03-13 15:59:52,590 [INFO]: There are 2482 embeddings of dim 49152
2025-03-13 15:59:52,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3911 secs
2025-03-13 15:59:52,591 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:52
2025-03-13 15:59:52,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:52,591 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:59:52,591 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:52,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:59:52,591 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:52
2025-03-13 15:59:52,591 [INFO]: 512.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:52,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:59:52,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:52
2025-03-13 15:59:52,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:52,592 [INFO]: 	Creating the index 03/13/2025, 15:59:52
2025-03-13 15:59:52,592 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:52
2025-03-13 15:59:52,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:59:52,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:52
2025-03-13 15:59:52,594 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:59:52,594 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.96it/s] 30%|███       | 3/10 [00:00<00:00,  9.46it/s] 50%|█████     | 5/10 [00:00<00:00,  9.90it/s] 70%|███████   | 7/10 [00:00<00:00, 10.71it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.78it/s]100%|██████████| 10/10 [00:02<00:00,  3.90it/s]
2025-03-13 15:59:55,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:55
2025-03-13 16:00:22,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9928 secs
2025-03-13 16:00:22,162 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 16:00:22,162 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 16:00:52,141 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9785 secs
2025-03-13 16:00:52,143 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5492 secs
2025-03-13 16:00:52,144 [INFO]: {
2025-03-13 16:00:52,144 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:52,144 [INFO]: 	index_param: efSearch=229
2025-03-13 16:00:52,144 [INFO]: 	index_path: knn.index
2025-03-13 16:00:52,144 [INFO]: 	size in bytes: 488317930
2025-03-13 16:00:52,144 [INFO]: 	avg_search_speed_ms: 8.369890378523134
2025-03-13 16:00:52,144 [INFO]: 	99p_search_speed_ms: 12.728303526528176
2025-03-13 16:00:52,144 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:52,144 [INFO]: 	nb vectors: 2482
2025-03-13 16:00:52,144 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:52,144 [INFO]: 	compression ratio: 0.9993101338711851
2025-03-13 16:00:52,144 [INFO]: }
2025-03-13 16:00:52,144 [INFO]: 	>>> Finished "Creating the index" in 59.5519 secs
2025-03-13 16:00:52,144 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9443 secs
2025-03-13 16:00:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 40892 [episode count 11/20]
[retrieval_preprocessing] for episode 85274 [episode count 12/20], we have num_retrieval=np.int64(2495) num_query=np.int64(142)
2025-03-13 16:00:54,434 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:54,858 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:54
2025-03-13 16:00:54,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.68it/s]
2025-03-13 16:00:54,883 [INFO]: There are 2495 embeddings of dim 49152
2025-03-13 16:00:54,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 16:00:54,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:54
2025-03-13 16:00:54,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:54,883 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:00:54,884 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:54,884 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:00:54,884 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:54
2025-03-13 16:00:54,884 [INFO]: 514.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:54,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:00:54,884 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:54
2025-03-13 16:00:54,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:54,884 [INFO]: 	Creating the index 03/13/2025, 16:00:54
2025-03-13 16:00:54,884 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:54
2025-03-13 16:00:54,885 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:00:54,885 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:54
2025-03-13 16:00:54,885 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:00:54,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.64it/s] 30%|███       | 3/10 [00:00<00:00,  9.44it/s] 50%|█████     | 5/10 [00:00<00:00, 10.06it/s] 70%|███████   | 7/10 [00:00<00:00, 10.35it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.48it/s]100%|██████████| 10/10 [00:02<00:00,  4.09it/s]
2025-03-13 16:00:57,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:57
2025-03-13 16:01:31,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2632 secs
2025-03-13 16:01:31,602 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 16:01:31,602 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 16:01:56,858 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2561 secs
2025-03-13 16:01:56,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9759 secs
2025-03-13 16:01:56,861 [INFO]: {
2025-03-13 16:01:56,861 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:56,861 [INFO]: 	index_param: efSearch=267
2025-03-13 16:01:56,861 [INFO]: 	index_path: knn.index
2025-03-13 16:01:56,861 [INFO]: 	size in bytes: 490875610
2025-03-13 16:01:56,861 [INFO]: 	avg_search_speed_ms: 10.826142713955695
2025-03-13 16:01:56,861 [INFO]: 	99p_search_speed_ms: 16.903565293177962
2025-03-13 16:01:56,861 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:56,861 [INFO]: 	nb vectors: 2495
2025-03-13 16:01:56,861 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:56,861 [INFO]: 	compression ratio: 0.9993101103556561
2025-03-13 16:01:56,861 [INFO]: }
2025-03-13 16:01:56,861 [INFO]: 	>>> Finished "Creating the index" in 61.9774 secs
2025-03-13 16:01:56,861 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0029 secs
2025-03-13 16:01:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 85274 [episode count 12/20]
[retrieval_preprocessing] for episode 50376 [episode count 13/20], we have num_retrieval=np.int64(2402) num_query=np.int64(235)
2025-03-13 16:01:59,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:59,882 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:59
2025-03-13 16:01:59,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.13it/s]
2025-03-13 16:01:59,907 [INFO]: There are 2402 embeddings of dim 49152
2025-03-13 16:01:59,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 16:01:59,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:59
2025-03-13 16:01:59,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:59,908 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:01:59,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:59,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:59,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:59
2025-03-13 16:01:59,908 [INFO]: 495.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:59,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:01:59,908 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:59
2025-03-13 16:01:59,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:59,908 [INFO]: 	Creating the index 03/13/2025, 16:01:59
2025-03-13 16:01:59,908 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:59
2025-03-13 16:01:59,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:01:59,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:59
2025-03-13 16:01:59,909 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:01:59,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.25it/s] 30%|███       | 3/10 [00:00<00:00,  8.63it/s] 50%|█████     | 5/10 [00:00<00:00, 10.15it/s] 70%|███████   | 7/10 [00:00<00:00, 10.24it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.56it/s]100%|██████████| 10/10 [00:03<00:00,  3.16it/s]
2025-03-13 16:02:03,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:03
2025-03-13 16:02:40,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5236 secs
2025-03-13 16:02:40,864 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 16:02:40,865 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 50%|█████     | 2/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 16:03:05,208 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3433 secs
2025-03-13 16:03:05,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3011 secs
2025-03-13 16:03:05,210 [INFO]: {
2025-03-13 16:03:05,210 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:05,210 [INFO]: 	index_param: efSearch=227
2025-03-13 16:03:05,210 [INFO]: 	index_path: knn.index
2025-03-13 16:03:05,210 [INFO]: 	size in bytes: 472578610
2025-03-13 16:03:05,210 [INFO]: 	avg_search_speed_ms: 8.95421606410985
2025-03-13 16:03:05,210 [INFO]: 	99p_search_speed_ms: 13.346253093332049
2025-03-13 16:03:05,210 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:05,210 [INFO]: 	nb vectors: 2402
2025-03-13 16:03:05,210 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:05,210 [INFO]: 	compression ratio: 0.9993097571639986
2025-03-13 16:03:05,210 [INFO]: }
2025-03-13 16:03:05,210 [INFO]: 	>>> Finished "Creating the index" in 65.3024 secs
2025-03-13 16:03:05,210 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3279 secs
2025-03-13 16:03:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 50376 [episode count 13/20]
[retrieval_preprocessing] for episode 66789 [episode count 14/20], we have num_retrieval=np.int64(2515) num_query=np.int64(122)
2025-03-13 16:03:07,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:07,997 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:07
2025-03-13 16:03:07,997 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-13 16:03:08,023 [INFO]: There are 2515 embeddings of dim 49152
2025-03-13 16:03:08,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:03:08,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:08,023 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:03:08,023 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:08,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:08,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,023 [INFO]: 519.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:08,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:03:08,023 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:08
2025-03-13 16:03:08,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:08,023 [INFO]: 	Creating the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:08
2025-03-13 16:03:08,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 16:03:08,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:08
2025-03-13 16:03:08,024 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:03:08,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.17it/s] 30%|███       | 3/10 [00:00<00:00, 10.53it/s] 50%|█████     | 5/10 [00:00<00:00, 11.51it/s] 70%|███████   | 7/10 [00:00<00:00, 12.02it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.52it/s]100%|██████████| 10/10 [00:02<00:00,  4.20it/s]
2025-03-13 16:03:10,411 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:10
2025-03-13 16:03:37,174 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7628 secs
2025-03-13 16:03:37,174 [INFO]: The best hyperparameters are: efSearch=332
2025-03-13 16:03:37,174 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 16:04:18,762 [INFO]: 	>>> Finished "Compute fast metrics" in 41.5878 secs
2025-03-13 16:04:18,765 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7410 secs
2025-03-13 16:04:18,766 [INFO]: {
2025-03-13 16:04:18,766 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:18,766 [INFO]: 	index_param: efSearch=332
2025-03-13 16:04:18,766 [INFO]: 	index_path: knn.index
2025-03-13 16:04:18,766 [INFO]: 	size in bytes: 494810590
2025-03-13 16:04:18,766 [INFO]: 	avg_search_speed_ms: 11.811172121799295
2025-03-13 16:04:18,766 [INFO]: 	99p_search_speed_ms: 23.19429966155439
2025-03-13 16:04:18,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:18,766 [INFO]: 	nb vectors: 2515
2025-03-13 16:04:18,766 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:18,766 [INFO]: 	compression ratio: 0.9993098975508993
2025-03-13 16:04:18,766 [INFO]: }
2025-03-13 16:04:18,766 [INFO]: 	>>> Finished "Creating the index" in 70.7422 secs
2025-03-13 16:04:18,766 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7683 secs
2025-03-13 16:04:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 66789 [episode count 14/20]
[retrieval_preprocessing] for episode 30318 [episode count 15/20], we have num_retrieval=np.int64(2443) num_query=np.int64(194)
2025-03-13 16:04:21,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:22,038 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:22
2025-03-13 16:04:22,038 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1110.19it/s]
2025-03-13 16:04:22,064 [INFO]: There are 2443 embeddings of dim 49152
2025-03-13 16:04:22,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:04:22,065 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:22,065 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:04:22,065 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:22,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:04:22,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,066 [INFO]: 504.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:22,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:04:22,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:22
2025-03-13 16:04:22,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:22,066 [INFO]: 	Creating the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,066 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:22
2025-03-13 16:04:22,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:04:22,069 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,069 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:04:22,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.15it/s] 20%|██        | 2/10 [00:00<00:01,  6.30it/s] 30%|███       | 3/10 [00:00<00:01,  6.68it/s] 40%|████      | 4/10 [00:00<00:00,  6.88it/s] 50%|█████     | 5/10 [00:00<00:00,  7.08it/s] 60%|██████    | 6/10 [00:00<00:00,  7.29it/s] 70%|███████   | 7/10 [00:00<00:00,  7.47it/s] 80%|████████  | 8/10 [00:01<00:00,  7.49it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.63it/s]100%|██████████| 10/10 [00:03<00:00,  1.47it/s]100%|██████████| 10/10 [00:03<00:00,  3.16it/s]
2025-03-13 16:04:25,241 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:25
2025-03-13 16:05:04,727 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4863 secs
2025-03-13 16:05:04,728 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 16:05:04,728 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.89it/s] 50%|█████     | 2/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-13 16:05:24,585 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8572 secs
2025-03-13 16:05:24,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5186 secs
2025-03-13 16:05:24,588 [INFO]: {
2025-03-13 16:05:24,588 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:24,588 [INFO]: 	index_param: efSearch=234
2025-03-13 16:05:24,588 [INFO]: 	index_path: knn.index
2025-03-13 16:05:24,588 [INFO]: 	size in bytes: 480645010
2025-03-13 16:05:24,588 [INFO]: 	avg_search_speed_ms: 9.838369754042228
2025-03-13 16:05:24,588 [INFO]: 	99p_search_speed_ms: 15.435828792396933
2025-03-13 16:05:24,588 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:24,588 [INFO]: 	nb vectors: 2443
2025-03-13 16:05:24,588 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:24,588 [INFO]: 	compression ratio: 0.9993099564270936
2025-03-13 16:05:24,588 [INFO]: }
2025-03-13 16:05:24,588 [INFO]: 	>>> Finished "Creating the index" in 62.5216 secs
2025-03-13 16:05:24,588 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5497 secs
2025-03-13 16:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 30318 [episode count 15/20]
[retrieval_preprocessing] for episode 40938 [episode count 16/20], we have num_retrieval=np.int64(2506) num_query=np.int64(131)
2025-03-13 16:05:27,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:28,034 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:28
2025-03-13 16:05:28,034 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1544.29it/s]
2025-03-13 16:05:28,061 [INFO]: There are 2506 embeddings of dim 49152
2025-03-13 16:05:28,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:05:28,062 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:28
2025-03-13 16:05:28,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:28,063 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:05:28,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:28,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:05:28,063 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:28
2025-03-13 16:05:28,063 [INFO]: 517.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:28,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:05:28,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:28
2025-03-13 16:05:28,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:28,064 [INFO]: 	Creating the index 03/13/2025, 16:05:28
2025-03-13 16:05:28,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:28
2025-03-13 16:05:28,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:05:28,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:28
2025-03-13 16:05:28,067 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:05:28,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.16it/s] 30%|███       | 3/10 [00:00<00:00,  9.70it/s] 50%|█████     | 5/10 [00:00<00:00, 10.86it/s] 70%|███████   | 7/10 [00:00<00:00, 11.23it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.69it/s]100%|██████████| 10/10 [00:02<00:00,  3.82it/s]
2025-03-13 16:05:30,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:30
2025-03-13 16:05:57,969 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2701 secs
2025-03-13 16:05:57,969 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 16:05:57,969 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 16:06:23,160 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1912 secs
2025-03-13 16:06:23,327 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2598 secs
2025-03-13 16:06:23,327 [INFO]: {
2025-03-13 16:06:23,327 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:23,327 [INFO]: 	index_param: efSearch=289
2025-03-13 16:06:23,328 [INFO]: 	index_path: knn.index
2025-03-13 16:06:23,328 [INFO]: 	size in bytes: 493039870
2025-03-13 16:06:23,328 [INFO]: 	avg_search_speed_ms: 10.07703315812133
2025-03-13 16:06:23,328 [INFO]: 	99p_search_speed_ms: 18.691600819583986
2025-03-13 16:06:23,328 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:23,328 [INFO]: 	nb vectors: 2506
2025-03-13 16:06:23,328 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:23,328 [INFO]: 	compression ratio: 0.9993099503291691
2025-03-13 16:06:23,328 [INFO]: }
2025-03-13 16:06:23,328 [INFO]: 	>>> Finished "Creating the index" in 55.2640 secs
2025-03-13 16:06:23,328 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2937 secs
2025-03-13 16:06:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 40938 [episode count 16/20]
[retrieval_preprocessing] for episode 50416 [episode count 17/20], we have num_retrieval=np.int64(2507) num_query=np.int64(130)
2025-03-13 16:06:25,609 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:25,965 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:25
2025-03-13 16:06:25,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2258.65it/s]
2025-03-13 16:06:25,988 [INFO]: There are 2507 embeddings of dim 49152
2025-03-13 16:06:25,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 16:06:25,988 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:25
2025-03-13 16:06:25,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:25,988 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:06:25,988 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:25,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:25,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:25
2025-03-13 16:06:25,988 [INFO]: 517.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:25,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:06:25,988 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:25
2025-03-13 16:06:25,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:25,988 [INFO]: 	Creating the index 03/13/2025, 16:06:25
2025-03-13 16:06:25,989 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:25
2025-03-13 16:06:25,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:06:25,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:25
2025-03-13 16:06:25,990 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:06:25,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.73it/s] 30%|███       | 3/10 [00:00<00:00, 10.01it/s] 50%|█████     | 5/10 [00:00<00:00, 11.00it/s] 70%|███████   | 7/10 [00:00<00:00, 11.48it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.32it/s]100%|██████████| 10/10 [00:02<00:00,  3.35it/s]
2025-03-13 16:06:28,979 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:28
2025-03-13 16:07:04,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9851 secs
2025-03-13 16:07:04,965 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:07:04,965 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 16:07:26,188 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2226 secs
2025-03-13 16:07:26,190 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2005 secs
2025-03-13 16:07:26,190 [INFO]: {
2025-03-13 16:07:26,190 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:26,190 [INFO]: 	index_param: efSearch=237
2025-03-13 16:07:26,190 [INFO]: 	index_path: knn.index
2025-03-13 16:07:26,190 [INFO]: 	size in bytes: 493236610
2025-03-13 16:07:26,190 [INFO]: 	avg_search_speed_ms: 11.1081794080221
2025-03-13 16:07:26,190 [INFO]: 	99p_search_speed_ms: 22.56998587865382
2025-03-13 16:07:26,191 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:26,191 [INFO]: 	nb vectors: 2507
2025-03-13 16:07:26,191 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:26,191 [INFO]: 	compression ratio: 0.99930995795304
2025-03-13 16:07:26,191 [INFO]: }
2025-03-13 16:07:26,191 [INFO]: 	>>> Finished "Creating the index" in 60.2020 secs
2025-03-13 16:07:26,191 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2251 secs
2025-03-13 16:07:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 50416 [episode count 17/20]
[retrieval_preprocessing] for episode 18301 [episode count 18/20], we have num_retrieval=np.int64(2525) num_query=np.int64(112)
2025-03-13 16:07:28,753 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:29,422 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:29
2025-03-13 16:07:29,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1019.27it/s]
2025-03-13 16:07:29,461 [INFO]: There are 2525 embeddings of dim 49152
2025-03-13 16:07:29,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0392 secs
2025-03-13 16:07:29,462 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:29
2025-03-13 16:07:29,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:29,462 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:07:29,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:29,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:07:29,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:29
2025-03-13 16:07:29,463 [INFO]: 521.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:29,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:07:29,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:29
2025-03-13 16:07:29,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:29,463 [INFO]: 	Creating the index 03/13/2025, 16:07:29
2025-03-13 16:07:29,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:29
2025-03-13 16:07:29,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:07:29,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:29
2025-03-13 16:07:29,466 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:07:29,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.92it/s] 20%|██        | 2/10 [00:00<00:01,  7.76it/s] 40%|████      | 4/10 [00:00<00:00,  9.51it/s] 60%|██████    | 6/10 [00:00<00:00, 10.57it/s] 80%|████████  | 8/10 [00:00<00:00, 11.04it/s]100%|██████████| 10/10 [00:02<00:00,  2.85it/s]100%|██████████| 10/10 [00:02<00:00,  4.17it/s]
2025-03-13 16:07:31,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:31
2025-03-13 16:08:02,290 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4147 secs
2025-03-13 16:08:02,290 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 16:08:02,290 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s]
2025-03-13 16:08:20,376 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0859 secs
2025-03-13 16:08:20,378 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9125 secs
2025-03-13 16:08:20,378 [INFO]: {
2025-03-13 16:08:20,378 [INFO]: 	index_key: HNSW15
2025-03-13 16:08:20,378 [INFO]: 	index_param: efSearch=259
2025-03-13 16:08:20,378 [INFO]: 	index_path: knn.index
2025-03-13 16:08:20,379 [INFO]: 	size in bytes: 496778050
2025-03-13 16:08:20,379 [INFO]: 	avg_search_speed_ms: 11.557856122990048
2025-03-13 16:08:20,379 [INFO]: 	99p_search_speed_ms: 17.575237462297086
2025-03-13 16:08:20,379 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:20,379 [INFO]: 	nb vectors: 2525
2025-03-13 16:08:20,379 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:20,379 [INFO]: 	compression ratio: 0.9993098527602015
2025-03-13 16:08:20,379 [INFO]: }
2025-03-13 16:08:20,379 [INFO]: 	>>> Finished "Creating the index" in 50.9154 secs
2025-03-13 16:08:20,379 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9563 secs
2025-03-13 16:08:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 18301 [episode count 18/20]
[retrieval_preprocessing] for episode 76992 [episode count 19/20], we have num_retrieval=np.int64(2495) num_query=np.int64(142)
2025-03-13 16:08:22,602 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:23,031 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:23
2025-03-13 16:08:23,031 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 866.23it/s]
2025-03-13 16:08:23,060 [INFO]: There are 2495 embeddings of dim 49152
2025-03-13 16:08:23,061 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 16:08:23,061 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:23
2025-03-13 16:08:23,061 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:23,061 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:08:23,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:23,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:08:23,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:23
2025-03-13 16:08:23,062 [INFO]: 514.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:23,062 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:08:23,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:23
2025-03-13 16:08:23,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:23,063 [INFO]: 	Creating the index 03/13/2025, 16:08:23
2025-03-13 16:08:23,063 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:23
2025-03-13 16:08:23,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:08:23,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:23
2025-03-13 16:08:23,067 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:08:23,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.12it/s] 20%|██        | 2/10 [00:00<00:01,  7.81it/s] 30%|███       | 3/10 [00:00<00:00,  8.67it/s] 50%|█████     | 5/10 [00:00<00:00, 10.02it/s] 70%|███████   | 7/10 [00:00<00:00, 10.68it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.83it/s]100%|██████████| 10/10 [00:02<00:00,  4.00it/s]
2025-03-13 16:08:25,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:25
2025-03-13 16:08:58,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9099 secs
2025-03-13 16:08:58,490 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 16:08:58,490 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 16:09:34,654 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1647 secs
2025-03-13 16:09:34,656 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5892 secs
2025-03-13 16:09:34,656 [INFO]: {
2025-03-13 16:09:34,656 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:34,656 [INFO]: 	index_param: efSearch=271
2025-03-13 16:09:34,656 [INFO]: 	index_path: knn.index
2025-03-13 16:09:34,656 [INFO]: 	size in bytes: 490875610
2025-03-13 16:09:34,657 [INFO]: 	avg_search_speed_ms: 8.300251397207626
2025-03-13 16:09:34,657 [INFO]: 	99p_search_speed_ms: 15.456249415874504
2025-03-13 16:09:34,657 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:34,657 [INFO]: 	nb vectors: 2495
2025-03-13 16:09:34,657 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:34,657 [INFO]: 	compression ratio: 0.9993101103556561
2025-03-13 16:09:34,657 [INFO]: }
2025-03-13 16:09:34,657 [INFO]: 	>>> Finished "Creating the index" in 71.5934 secs
2025-03-13 16:09:34,657 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6257 secs
2025-03-13 16:09:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 76992 [episode count 19/20]
2025-03-13 16:09:35: [retrieval_preprocessing] finished for 4823049285_turn_on_switch [chosen_id count 2/196]
2025-03-13 16:09:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 484659531_put_marker_in_cup [chosen_id count 3/196]
2025-03-13 16:09:39: [retrieval_preprocessing] we have num_total=5183 embedding_dim=49152
[retrieval_preprocessing] for episode 30235 [episode count 0/20], we have num_retrieval=np.int64(4881) num_query=np.int64(302)
2025-03-13 16:09:40,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:41,308 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:41
2025-03-13 16:09:41,308 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1517.48it/s]
2025-03-13 16:09:41,334 [INFO]: There are 4881 embeddings of dim 49152
2025-03-13 16:09:41,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 16:09:41,335 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:41
2025-03-13 16:09:41,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:41,335 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:09:41,335 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:41,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:09:41,335 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:41
2025-03-13 16:09:41,335 [INFO]: 1007.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:41,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:09:41,335 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:41
2025-03-13 16:09:41,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:41,335 [INFO]: 	Creating the index 03/13/2025, 16:09:41
2025-03-13 16:09:41,335 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:41
2025-03-13 16:09:41,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:09:41,337 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:41
2025-03-13 16:09:41,337 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:09:41,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.78it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.89it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.93it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.39it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.94it/s] 50%|█████     | 10/20 [00:01<00:01,  9.72it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.72it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.25it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.53it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.24it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.77it/s]100%|██████████| 20/20 [00:05<00:00,  1.20it/s]100%|██████████| 20/20 [00:05<00:00,  3.39it/s]
2025-03-13 16:09:47,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:47
2025-03-13 16:10:34,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7884 secs
2025-03-13 16:10:34,034 [INFO]: The best hyperparameters are: efSearch=75
2025-03-13 16:10:34,034 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 16:11:00,734 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7003 secs
2025-03-13 16:11:00,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4017 secs
2025-03-13 16:11:00,739 [INFO]: {
2025-03-13 16:11:00,739 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:00,739 [INFO]: 	index_param: efSearch=75
2025-03-13 16:11:00,739 [INFO]: 	index_path: knn.index
2025-03-13 16:11:00,739 [INFO]: 	size in bytes: 960307510
2025-03-13 16:11:00,739 [INFO]: 	avg_search_speed_ms: 5.322332811840394
2025-03-13 16:11:00,739 [INFO]: 	99p_search_speed_ms: 9.927347979974005
2025-03-13 16:11:00,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:00,739 [INFO]: 	nb vectors: 4881
2025-03-13 16:11:00,739 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:00,739 [INFO]: 	compression ratio: 0.9993086985230387
2025-03-13 16:11:00,739 [INFO]: }
2025-03-13 16:11:00,739 [INFO]: 	>>> Finished "Creating the index" in 79.4036 secs
2025-03-13 16:11:00,739 [INFO]: >>> Finished "Launching the whole pipeline" in 79.4305 secs
2025-03-13 16:11:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 30235 [episode count 0/20]
[retrieval_preprocessing] for episode 77342 [episode count 1/20], we have num_retrieval=np.int64(4997) num_query=np.int64(186)
2025-03-13 16:11:04,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:05,027 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:05
2025-03-13 16:11:05,027 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.80it/s]
2025-03-13 16:11:05,052 [INFO]: There are 4997 embeddings of dim 49152
2025-03-13 16:11:05,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 16:11:05,053 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:05
2025-03-13 16:11:05,053 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:05,053 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:11:05,053 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:05,053 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:11:05,053 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:05
2025-03-13 16:11:05,053 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:05,053 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:11:05,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:05
2025-03-13 16:11:05,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:05,053 [INFO]: 	Creating the index 03/13/2025, 16:11:05
2025-03-13 16:11:05,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:05
2025-03-13 16:11:05,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:11:05,054 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:05
2025-03-13 16:11:05,054 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:11:05,054 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.97it/s] 10%|█         | 2/20 [00:00<00:02,  6.62it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.43it/s] 20%|██        | 4/20 [00:00<00:01,  8.00it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.23it/s] 30%|███       | 6/20 [00:00<00:01,  8.37it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.47it/s] 40%|████      | 8/20 [00:01<00:01,  8.50it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.46it/s] 50%|█████     | 10/20 [00:01<00:01,  8.58it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.54it/s] 60%|██████    | 12/20 [00:01<00:00,  8.51it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.50it/s] 70%|███████   | 14/20 [00:01<00:00,  8.65it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.83it/s] 80%|████████  | 16/20 [00:01<00:00,  9.05it/s] 85%|████████▌ | 17/20 [00:02<00:00,  8.77it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.51it/s]100%|██████████| 20/20 [00:05<00:00,  1.03it/s]100%|██████████| 20/20 [00:05<00:00,  3.43it/s]
2025-03-13 16:11:10,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:10
2025-03-13 16:12:05,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.5190 secs
2025-03-13 16:12:05,408 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 16:12:05,408 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 16:12:47,873 [INFO]: 	>>> Finished "Compute fast metrics" in 42.4650 secs
2025-03-13 16:12:47,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.8241 secs
2025-03-13 16:12:47,878 [INFO]: {
2025-03-13 16:12:47,879 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:47,879 [INFO]: 	index_param: efSearch=213
2025-03-13 16:12:47,879 [INFO]: 	index_path: knn.index
2025-03-13 16:12:47,879 [INFO]: 	size in bytes: 983130010
2025-03-13 16:12:47,879 [INFO]: 	avg_search_speed_ms: 10.112902221596668
2025-03-13 16:12:47,879 [INFO]: 	99p_search_speed_ms: 15.424010548740625
2025-03-13 16:12:47,879 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:47,879 [INFO]: 	nb vectors: 4997
2025-03-13 16:12:47,879 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:47,879 [INFO]: 	compression ratio: 0.9993085004088117
2025-03-13 16:12:47,879 [INFO]: }
2025-03-13 16:12:47,879 [INFO]: 	>>> Finished "Creating the index" in 102.8254 secs
2025-03-13 16:12:47,879 [INFO]: >>> Finished "Launching the whole pipeline" in 102.8514 secs
2025-03-13 16:12:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 77342 [episode count 1/20]
[retrieval_preprocessing] for episode 3637 [episode count 2/20], we have num_retrieval=np.int64(4841) num_query=np.int64(342)
2025-03-13 16:12:51,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:52,465 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:52
2025-03-13 16:12:52,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.14it/s]
2025-03-13 16:12:52,489 [INFO]: There are 4841 embeddings of dim 49152
2025-03-13 16:12:52,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 16:12:52,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:52
2025-03-13 16:12:52,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:52,489 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:12:52,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:52,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:52,490 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:52
2025-03-13 16:12:52,490 [INFO]: 999.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:52,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:52,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:52
2025-03-13 16:12:52,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:52,490 [INFO]: 	Creating the index 03/13/2025, 16:12:52
2025-03-13 16:12:52,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:52
2025-03-13 16:12:52,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:12:52,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:52
2025-03-13 16:12:52,491 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:12:52,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.24it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.47it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.01it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.48it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.38it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.80it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.60it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.50it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.49it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.55it/s]100%|██████████| 20/20 [00:05<00:00,  3.71it/s]
2025-03-13 16:12:57,891 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:57
2025-03-13 16:14:10,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.3495 secs
2025-03-13 16:14:10,241 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:14:10,241 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 16:14:55,630 [INFO]: 	>>> Finished "Compute fast metrics" in 45.3889 secs
2025-03-13 16:14:55,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.1428 secs
2025-03-13 16:14:55,634 [INFO]: {
2025-03-13 16:14:55,634 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:55,634 [INFO]: 	index_param: efSearch=193
2025-03-13 16:14:55,634 [INFO]: 	index_path: knn.index
2025-03-13 16:14:55,634 [INFO]: 	size in bytes: 952437850
2025-03-13 16:14:55,634 [INFO]: 	avg_search_speed_ms: 10.881837060668945
2025-03-13 16:14:55,634 [INFO]: 	99p_search_speed_ms: 18.622498321346935
2025-03-13 16:14:55,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:55,634 [INFO]: 	nb vectors: 4841
2025-03-13 16:14:55,634 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:55,634 [INFO]: 	compression ratio: 0.9993085932063703
2025-03-13 16:14:55,634 [INFO]: }
2025-03-13 16:14:55,634 [INFO]: 	>>> Finished "Creating the index" in 123.1445 secs
2025-03-13 16:14:55,634 [INFO]: >>> Finished "Launching the whole pipeline" in 123.1695 secs
2025-03-13 16:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 3637 [episode count 2/20]
[retrieval_preprocessing] for episode 85564 [episode count 3/20], we have num_retrieval=np.int64(4971) num_query=np.int64(212)
2025-03-13 16:15:01,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:02,250 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:02
2025-03-13 16:15:02,251 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2143.23it/s]
2025-03-13 16:15:02,275 [INFO]: There are 4971 embeddings of dim 49152
2025-03-13 16:15:02,276 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 16:15:02,276 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:02
2025-03-13 16:15:02,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:02,276 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:15:02,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:02,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:15:02,277 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:02
2025-03-13 16:15:02,277 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:02,277 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:15:02,277 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:02
2025-03-13 16:15:02,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:02,278 [INFO]: 	Creating the index 03/13/2025, 16:15:02
2025-03-13 16:15:02,278 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:02
2025-03-13 16:15:02,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:15:02,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:02
2025-03-13 16:15:02,281 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:15:02,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.82it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.84it/s] 20%|██        | 4/20 [00:00<00:02,  7.98it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.16it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.22it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.68it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.82it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.99it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.94it/s] 80%|████████  | 16/20 [00:01<00:00,  9.92it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.83it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.72it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.51it/s]100%|██████████| 20/20 [00:07<00:00,  1.51s/it]100%|██████████| 20/20 [00:07<00:00,  2.68it/s]
2025-03-13 16:15:09,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:09
2025-03-13 16:16:06,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4636 secs
2025-03-13 16:16:06,199 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 16:16:06,200 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.53it/s]
2025-03-13 16:16:50,495 [INFO]: 	>>> Finished "Compute fast metrics" in 44.2954 secs
2025-03-13 16:16:50,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.2179 secs
2025-03-13 16:16:50,499 [INFO]: {
2025-03-13 16:16:50,499 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:50,499 [INFO]: 	index_param: efSearch=225
2025-03-13 16:16:50,499 [INFO]: 	index_path: knn.index
2025-03-13 16:16:50,499 [INFO]: 	size in bytes: 978014470
2025-03-13 16:16:50,499 [INFO]: 	avg_search_speed_ms: 10.754449291515254
2025-03-13 16:16:50,499 [INFO]: 	99p_search_speed_ms: 20.24260736769066
2025-03-13 16:16:50,499 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:50,499 [INFO]: 	nb vectors: 4971
2025-03-13 16:16:50,499 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:50,499 [INFO]: 	compression ratio: 0.9993086993896931
2025-03-13 16:16:50,499 [INFO]: }
2025-03-13 16:16:50,499 [INFO]: 	>>> Finished "Creating the index" in 108.2218 secs
2025-03-13 16:16:50,499 [INFO]: >>> Finished "Launching the whole pipeline" in 108.2488 secs
2025-03-13 16:16:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:16:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 85564 [episode count 3/20]
[retrieval_preprocessing] for episode 3649 [episode count 4/20], we have num_retrieval=np.int64(4951) num_query=np.int64(232)
2025-03-13 16:16:55,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:16:56,524 [INFO]: Launching the whole pipeline 03/13/2025, 16:16:56
2025-03-13 16:16:56,524 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:16:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 947.44it/s]
2025-03-13 16:16:56,552 [INFO]: There are 4951 embeddings of dim 49152
2025-03-13 16:16:56,552 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 16:16:56,552 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:16:56
2025-03-13 16:16:56,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:16:56,552 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:16:56,552 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:16:56,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:16:56,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:16:56
2025-03-13 16:16:56,552 [INFO]: 1021.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:16:56,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:16:56,552 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:16:56
2025-03-13 16:16:56,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:16:56,552 [INFO]: 	Creating the index 03/13/2025, 16:16:56
2025-03-13 16:16:56,552 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:16:56
2025-03-13 16:16:56,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:16:56,554 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:16:56
2025-03-13 16:16:56,554 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:16:56,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.39it/s] 10%|█         | 2/20 [00:00<00:03,  5.73it/s] 15%|█▌        | 3/20 [00:00<00:02,  6.19it/s] 20%|██        | 4/20 [00:00<00:02,  6.41it/s] 25%|██▌       | 5/20 [00:00<00:02,  6.51it/s] 30%|███       | 6/20 [00:00<00:02,  6.64it/s] 35%|███▌      | 7/20 [00:01<00:01,  6.85it/s] 40%|████      | 8/20 [00:01<00:01,  7.07it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.17it/s] 50%|█████     | 10/20 [00:01<00:01,  7.26it/s] 55%|█████▌    | 11/20 [00:01<00:01,  7.33it/s] 60%|██████    | 12/20 [00:01<00:01,  7.40it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.54it/s] 75%|███████▌  | 15/20 [00:02<00:00,  8.56it/s] 85%|████████▌ | 17/20 [00:02<00:00,  9.14it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.82it/s]100%|██████████| 20/20 [00:05<00:00,  1.34it/s]100%|██████████| 20/20 [00:05<00:00,  3.52it/s]
2025-03-13 16:17:02,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:02
2025-03-13 16:17:55,888 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6517 secs
2025-03-13 16:17:55,889 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 16:17:55,889 [INFO]: 	Compute fast metrics 03/13/2025, 16:17:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 16:18:20,556 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6677 secs
2025-03-13 16:18:20,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.0067 secs
2025-03-13 16:18:20,561 [INFO]: {
2025-03-13 16:18:20,561 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:20,561 [INFO]: 	index_param: efSearch=203
2025-03-13 16:18:20,561 [INFO]: 	index_path: knn.index
2025-03-13 16:18:20,561 [INFO]: 	size in bytes: 974079670
2025-03-13 16:18:20,561 [INFO]: 	avg_search_speed_ms: 10.501345718610139
2025-03-13 16:18:20,561 [INFO]: 	99p_search_speed_ms: 16.915787279140204
2025-03-13 16:18:20,561 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:20,561 [INFO]: 	nb vectors: 4951
2025-03-13 16:18:20,561 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:20,561 [INFO]: 	compression ratio: 0.9993086171277962
2025-03-13 16:18:20,561 [INFO]: }
2025-03-13 16:18:20,561 [INFO]: 	>>> Finished "Creating the index" in 84.0085 secs
2025-03-13 16:18:20,561 [INFO]: >>> Finished "Launching the whole pipeline" in 84.0365 secs
2025-03-13 16:18:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 3649 [episode count 4/20]
[retrieval_preprocessing] for episode 20548 [episode count 5/20], we have num_retrieval=np.int64(4925) num_query=np.int64(258)
2025-03-13 16:18:23,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:18:24,163 [INFO]: Launching the whole pipeline 03/13/2025, 16:18:24
2025-03-13 16:18:24,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:18:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.22it/s]
2025-03-13 16:18:24,189 [INFO]: There are 4925 embeddings of dim 49152
2025-03-13 16:18:24,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 16:18:24,190 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:18:24
2025-03-13 16:18:24,190 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:18:24,191 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:18:24,191 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:18:24,191 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:18:24,191 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:18:24
2025-03-13 16:18:24,192 [INFO]: 1016.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:18:24,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:18:24,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:18:24
2025-03-13 16:18:24,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:18:24,192 [INFO]: 	Creating the index 03/13/2025, 16:18:24
2025-03-13 16:18:24,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:18:24
2025-03-13 16:18:24,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:18:24,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:18:24
2025-03-13 16:18:24,196 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:18:24,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.03it/s] 20%|██        | 4/20 [00:00<00:01, 15.92it/s] 35%|███▌      | 7/20 [00:00<00:00, 18.29it/s] 45%|████▌     | 9/20 [00:00<00:00, 17.97it/s] 55%|█████▌    | 11/20 [00:00<00:00, 14.65it/s] 65%|██████▌   | 13/20 [00:00<00:00, 14.02it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.58it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.82it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.39it/s]100%|██████████| 20/20 [00:05<00:00,  3.94it/s]
2025-03-13 16:18:29,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:29
2025-03-13 16:19:26,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.6898 secs
2025-03-13 16:19:26,222 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:19:26,222 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 16:20:04,704 [INFO]: 	>>> Finished "Compute fast metrics" in 38.4817 secs
2025-03-13 16:20:04,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.5119 secs
2025-03-13 16:20:04,708 [INFO]: {
2025-03-13 16:20:04,708 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:04,708 [INFO]: 	index_param: efSearch=216
2025-03-13 16:20:04,708 [INFO]: 	index_path: knn.index
2025-03-13 16:20:04,708 [INFO]: 	size in bytes: 968964250
2025-03-13 16:20:04,708 [INFO]: 	avg_search_speed_ms: 11.12917153759756
2025-03-13 16:20:04,708 [INFO]: 	99p_search_speed_ms: 17.68751322990283
2025-03-13 16:20:04,708 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:04,708 [INFO]: 	nb vectors: 4925
2025-03-13 16:20:04,708 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:04,708 [INFO]: 	compression ratio: 0.9993086948254283
2025-03-13 16:20:04,708 [INFO]: }
2025-03-13 16:20:04,708 [INFO]: 	>>> Finished "Creating the index" in 100.5162 secs
2025-03-13 16:20:04,708 [INFO]: >>> Finished "Launching the whole pipeline" in 100.5454 secs
2025-03-13 16:20:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 20548 [episode count 5/20]
[retrieval_preprocessing] for episode 54355 [episode count 6/20], we have num_retrieval=np.int64(4939) num_query=np.int64(244)
2025-03-13 16:20:08,895 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:09,639 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:09
2025-03-13 16:20:09,639 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.03it/s]
2025-03-13 16:20:09,664 [INFO]: There are 4939 embeddings of dim 49152
2025-03-13 16:20:09,665 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:20:09,665 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:09
2025-03-13 16:20:09,665 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:09,665 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:20:09,665 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:09,665 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:20:09,665 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:09
2025-03-13 16:20:09,665 [INFO]: 1019.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:09,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:20:09,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:09
2025-03-13 16:20:09,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:09,665 [INFO]: 	Creating the index 03/13/2025, 16:20:09
2025-03-13 16:20:09,665 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:09
2025-03-13 16:20:09,666 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:20:09,666 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:09
2025-03-13 16:20:09,667 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:20:09,667 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.01it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.70it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.60it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.30it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.60it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.55it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.07it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.51it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.13it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.72it/s]100%|██████████| 20/20 [00:05<00:00,  3.50it/s]
2025-03-13 16:20:15,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:15
2025-03-13 16:21:11,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2256 secs
2025-03-13 16:21:11,609 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:21:11,609 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 16:21:42,423 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8133 secs
2025-03-13 16:21:42,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.7604 secs
2025-03-13 16:21:42,427 [INFO]: {
2025-03-13 16:21:42,427 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:42,427 [INFO]: 	index_param: efSearch=220
2025-03-13 16:21:42,427 [INFO]: 	index_path: knn.index
2025-03-13 16:21:42,427 [INFO]: 	size in bytes: 971718670
2025-03-13 16:21:42,427 [INFO]: 	avg_search_speed_ms: 11.612479024135121
2025-03-13 16:21:42,427 [INFO]: 	99p_search_speed_ms: 17.44425087235868
2025-03-13 16:21:42,427 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:42,427 [INFO]: 	nb vectors: 4939
2025-03-13 16:21:42,427 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:42,427 [INFO]: 	compression ratio: 0.9993086908580238
2025-03-13 16:21:42,427 [INFO]: }
2025-03-13 16:21:42,427 [INFO]: 	>>> Finished "Creating the index" in 92.7620 secs
2025-03-13 16:21:42,427 [INFO]: >>> Finished "Launching the whole pipeline" in 92.7883 secs
2025-03-13 16:21:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 54355 [episode count 6/20]
[retrieval_preprocessing] for episode 20714 [episode count 7/20], we have num_retrieval=np.int64(4884) num_query=np.int64(299)
2025-03-13 16:21:47,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:48,273 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:48
2025-03-13 16:21:48,273 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1721.09it/s]
2025-03-13 16:21:48,295 [INFO]: There are 4884 embeddings of dim 49152
2025-03-13 16:21:48,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 16:21:48,296 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:48
2025-03-13 16:21:48,296 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:48,296 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:21:48,296 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:48,296 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:48,296 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:48
2025-03-13 16:21:48,296 [INFO]: 1007.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:48,296 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:21:48,296 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:48
2025-03-13 16:21:48,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:48,296 [INFO]: 	Creating the index 03/13/2025, 16:21:48
2025-03-13 16:21:48,296 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:48
2025-03-13 16:21:48,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:21:48,297 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:48
2025-03-13 16:21:48,297 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:21:48,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.38it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.25it/s] 20%|██        | 4/20 [00:00<00:01,  8.63it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.90it/s] 30%|███       | 6/20 [00:00<00:01,  9.02it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.98it/s] 40%|████      | 8/20 [00:00<00:01,  9.01it/s] 50%|█████     | 10/20 [00:01<00:01,  9.55it/s] 60%|██████    | 12/20 [00:01<00:00,  9.74it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.74it/s] 70%|███████   | 14/20 [00:01<00:00,  9.76it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.75it/s] 80%|████████  | 16/20 [00:01<00:00,  9.67it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.83it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.69it/s]100%|██████████| 20/20 [00:06<00:00,  1.16s/it]100%|██████████| 20/20 [00:06<00:00,  3.15it/s]
2025-03-13 16:21:54,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:54
2025-03-13 16:22:43,703 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0566 secs
2025-03-13 16:22:43,704 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 16:22:43,704 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 16:23:35,821 [INFO]: 	>>> Finished "Compute fast metrics" in 52.1169 secs
2025-03-13 16:23:35,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.5291 secs
2025-03-13 16:23:35,826 [INFO]: {
2025-03-13 16:23:35,826 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:35,826 [INFO]: 	index_param: efSearch=277
2025-03-13 16:23:35,826 [INFO]: 	index_path: knn.index
2025-03-13 16:23:35,826 [INFO]: 	size in bytes: 960897730
2025-03-13 16:23:35,826 [INFO]: 	avg_search_speed_ms: 13.436911093767092
2025-03-13 16:23:35,826 [INFO]: 	99p_search_speed_ms: 23.587221165653318
2025-03-13 16:23:35,826 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:35,826 [INFO]: 	nb vectors: 4884
2025-03-13 16:23:35,826 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:35,826 [INFO]: 	compression ratio: 0.9993087110321304
2025-03-13 16:23:35,826 [INFO]: }
2025-03-13 16:23:35,827 [INFO]: 	>>> Finished "Creating the index" in 107.5306 secs
2025-03-13 16:23:35,827 [INFO]: >>> Finished "Launching the whole pipeline" in 107.5538 secs
2025-03-13 16:23:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 20714 [episode count 7/20]
[retrieval_preprocessing] for episode 47341 [episode count 8/20], we have num_retrieval=np.int64(4929) num_query=np.int64(254)
2025-03-13 16:23:42,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:44,274 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:44
2025-03-13 16:23:44,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.96it/s]
2025-03-13 16:23:44,302 [INFO]: There are 4929 embeddings of dim 49152
2025-03-13 16:23:44,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 16:23:44,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:44
2025-03-13 16:23:44,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:44,303 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:23:44,303 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:44,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 16:23:44,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:44
2025-03-13 16:23:44,304 [INFO]: 1017.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:44,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:23:44,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:44
2025-03-13 16:23:44,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:44,304 [INFO]: 	Creating the index 03/13/2025, 16:23:44
2025-03-13 16:23:44,305 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:44
2025-03-13 16:23:44,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:23:44,306 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:44
2025-03-13 16:23:44,306 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:23:44,306 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.89it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.96it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.17it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.55it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.72it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.82it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.96it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.98it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.96it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.78it/s]100%|██████████| 20/20 [00:05<00:00,  3.72it/s]
2025-03-13 16:23:49,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:49
2025-03-13 16:24:38,459 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7667 secs
2025-03-13 16:24:38,459 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 16:24:38,459 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 16:25:03,404 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9446 secs
2025-03-13 16:25:03,408 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.1019 secs
2025-03-13 16:25:03,408 [INFO]: {
2025-03-13 16:25:03,408 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:03,408 [INFO]: 	index_param: efSearch=101
2025-03-13 16:25:03,408 [INFO]: 	index_path: knn.index
2025-03-13 16:25:03,408 [INFO]: 	size in bytes: 969751210
2025-03-13 16:25:03,408 [INFO]: 	avg_search_speed_ms: 6.832581318364881
2025-03-13 16:25:03,409 [INFO]: 	99p_search_speed_ms: 10.719786016270515
2025-03-13 16:25:03,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:03,409 [INFO]: 	nb vectors: 4929
2025-03-13 16:25:03,409 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:03,409 [INFO]: 	compression ratio: 0.9993087113549464
2025-03-13 16:25:03,409 [INFO]: }
2025-03-13 16:25:03,409 [INFO]: 	>>> Finished "Creating the index" in 79.1039 secs
2025-03-13 16:25:03,409 [INFO]: >>> Finished "Launching the whole pipeline" in 79.1348 secs
2025-03-13 16:25:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 47341 [episode count 8/20]
[retrieval_preprocessing] for episode 49401 [episode count 9/20], we have num_retrieval=np.int64(4985) num_query=np.int64(198)
2025-03-13 16:25:06,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:08,245 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:08
2025-03-13 16:25:08,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.12it/s]
2025-03-13 16:25:08,269 [INFO]: There are 4985 embeddings of dim 49152
2025-03-13 16:25:08,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 16:25:08,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:08
2025-03-13 16:25:08,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:08,270 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:25:08,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:08,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:25:08,270 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:08
2025-03-13 16:25:08,270 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:08,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:25:08,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:08
2025-03-13 16:25:08,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:08,270 [INFO]: 	Creating the index 03/13/2025, 16:25:08
2025-03-13 16:25:08,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:08
2025-03-13 16:25:08,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:25:08,272 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:08
2025-03-13 16:25:08,272 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:25:08,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.12it/s] 10%|█         | 2/20 [00:00<00:02,  6.96it/s] 20%|██        | 4/20 [00:00<00:01,  8.87it/s] 30%|███       | 6/20 [00:00<00:01,  9.62it/s] 40%|████      | 8/20 [00:00<00:01, 10.23it/s] 50%|█████     | 10/20 [00:01<00:00, 10.68it/s] 60%|██████    | 12/20 [00:01<00:00, 11.08it/s] 70%|███████   | 14/20 [00:01<00:00, 11.26it/s] 80%|████████  | 16/20 [00:01<00:00, 11.17it/s] 90%|█████████ | 18/20 [00:01<00:00, 11.10it/s]100%|██████████| 20/20 [00:05<00:00,  1.39it/s]100%|██████████| 20/20 [00:05<00:00,  3.34it/s]
2025-03-13 16:25:14,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:14
2025-03-13 16:26:02,893 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6332 secs
2025-03-13 16:26:02,893 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 16:26:02,893 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s]
2025-03-13 16:26:47,779 [INFO]: 	>>> Finished "Compute fast metrics" in 44.8862 secs
2025-03-13 16:26:47,784 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.5121 secs
2025-03-13 16:26:47,784 [INFO]: {
2025-03-13 16:26:47,784 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:47,784 [INFO]: 	index_param: efSearch=226
2025-03-13 16:26:47,785 [INFO]: 	index_path: knn.index
2025-03-13 16:26:47,785 [INFO]: 	size in bytes: 980768950
2025-03-13 16:26:47,785 [INFO]: 	avg_search_speed_ms: 12.152183352248745
2025-03-13 16:26:47,785 [INFO]: 	99p_search_speed_ms: 23.424759744666517
2025-03-13 16:26:47,785 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:47,785 [INFO]: 	nb vectors: 4985
2025-03-13 16:26:47,785 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:47,785 [INFO]: 	compression ratio: 0.9993086343118835
2025-03-13 16:26:47,785 [INFO]: }
2025-03-13 16:26:47,785 [INFO]: 	>>> Finished "Creating the index" in 99.5145 secs
2025-03-13 16:26:47,785 [INFO]: >>> Finished "Launching the whole pipeline" in 99.5398 secs
2025-03-13 16:26:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 49401 [episode count 9/20]
[retrieval_preprocessing] for episode 48384 [episode count 10/20], we have num_retrieval=np.int64(4809) num_query=np.int64(374)
2025-03-13 16:26:51,901 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:52,695 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:52
2025-03-13 16:26:52,695 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1347.35it/s]
2025-03-13 16:26:52,731 [INFO]: There are 4809 embeddings of dim 49152
2025-03-13 16:26:52,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 16:26:52,732 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:52,732 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 16:26:52,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:52,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:26:52,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,732 [INFO]: 992.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:52,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:26:52,733 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:52
2025-03-13 16:26:52,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:52,733 [INFO]: 	Creating the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,733 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:52
2025-03-13 16:26:52,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:26:52,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:52
2025-03-13 16:26:52,736 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:26:52,736 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.92it/s] 16%|█▌        | 3/19 [00:00<00:01,  9.69it/s] 26%|██▋       | 5/19 [00:00<00:01, 10.44it/s] 37%|███▋      | 7/19 [00:00<00:01, 10.70it/s] 47%|████▋     | 9/19 [00:00<00:00, 10.80it/s] 58%|█████▊    | 11/19 [00:01<00:00, 10.82it/s] 68%|██████▊   | 13/19 [00:01<00:00,  9.60it/s] 74%|███████▎  | 14/19 [00:01<00:00,  8.02it/s] 84%|████████▍ | 16/19 [00:01<00:00,  8.62it/s] 89%|████████▉ | 17/19 [00:01<00:00,  8.82it/s] 95%|█████████▍| 18/19 [00:01<00:00,  9.00it/s]100%|██████████| 19/19 [00:06<00:00,  1.17s/it]100%|██████████| 19/19 [00:06<00:00,  2.96it/s]
2025-03-13 16:26:59,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:59
2025-03-13 16:27:49,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.3891 secs
2025-03-13 16:27:49,558 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:27:49,558 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 16:28:31,225 [INFO]: 	>>> Finished "Compute fast metrics" in 41.6667 secs
2025-03-13 16:28:31,228 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.4930 secs
2025-03-13 16:28:31,229 [INFO]: {
2025-03-13 16:28:31,229 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:31,229 [INFO]: 	index_param: efSearch=237
2025-03-13 16:28:31,229 [INFO]: 	index_path: knn.index
2025-03-13 16:28:31,229 [INFO]: 	size in bytes: 946141990
2025-03-13 16:28:31,229 [INFO]: 	avg_search_speed_ms: 10.674020126382468
2025-03-13 16:28:31,229 [INFO]: 	99p_search_speed_ms: 19.19725979678331
2025-03-13 16:28:31,229 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:31,229 [INFO]: 	nb vectors: 4809
2025-03-13 16:28:31,229 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:31,229 [INFO]: 	compression ratio: 0.9993086471090877
2025-03-13 16:28:31,229 [INFO]: }
2025-03-13 16:28:31,229 [INFO]: 	>>> Finished "Creating the index" in 98.4956 secs
2025-03-13 16:28:31,229 [INFO]: >>> Finished "Launching the whole pipeline" in 98.5339 secs
2025-03-13 16:28:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 48384 [episode count 10/20]
[retrieval_preprocessing] for episode 91410 [episode count 11/20], we have num_retrieval=np.int64(4915) num_query=np.int64(268)
2025-03-13 16:28:36,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:37,862 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:37
2025-03-13 16:28:37,862 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.41it/s]
2025-03-13 16:28:38,607 [INFO]: There are 4915 embeddings of dim 49152
2025-03-13 16:28:38,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7455 secs
2025-03-13 16:28:38,608 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:38
2025-03-13 16:28:38,608 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:38,608 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:28:38,608 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:38,608 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:28:38,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:38
2025-03-13 16:28:38,609 [INFO]: 1014.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:38,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:28:38,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:38
2025-03-13 16:28:38,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:38,609 [INFO]: 	Creating the index 03/13/2025, 16:28:38
2025-03-13 16:28:38,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:38
2025-03-13 16:28:38,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 16:28:38,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:38
2025-03-13 16:28:38,612 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:28:38,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.65it/s] 20%|██        | 4/20 [00:00<00:01, 14.43it/s] 35%|███▌      | 7/20 [00:00<00:00, 17.89it/s] 45%|████▌     | 9/20 [00:00<00:00, 18.53it/s] 60%|██████    | 12/20 [00:00<00:00, 18.73it/s] 70%|███████   | 14/20 [00:00<00:00, 17.52it/s] 80%|████████  | 16/20 [00:00<00:00, 16.92it/s] 90%|█████████ | 18/20 [00:01<00:00, 16.37it/s]100%|██████████| 20/20 [00:04<00:00,  1.66it/s]100%|██████████| 20/20 [00:04<00:00,  4.09it/s]
2025-03-13 16:28:43,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:28:43
2025-03-13 16:29:33,174 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6671 secs
2025-03-13 16:29:33,174 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 16:29:33,175 [INFO]: 	Compute fast metrics 03/13/2025, 16:29:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.56it/s] 50%|█████     | 2/4 [00:00<00:00,  8.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 16:29:53,988 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8137 secs
2025-03-13 16:29:53,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3811 secs
2025-03-13 16:29:53,993 [INFO]: {
2025-03-13 16:29:53,993 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:53,993 [INFO]: 	index_param: efSearch=164
2025-03-13 16:29:53,993 [INFO]: 	index_path: knn.index
2025-03-13 16:29:53,993 [INFO]: 	size in bytes: 966996730
2025-03-13 16:29:53,993 [INFO]: 	avg_search_speed_ms: 8.602388491277004
2025-03-13 16:29:53,993 [INFO]: 	99p_search_speed_ms: 17.518680929206315
2025-03-13 16:29:53,993 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:53,993 [INFO]: 	nb vectors: 4915
2025-03-13 16:29:53,993 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:53,993 [INFO]: 	compression ratio: 0.999308777393694
2025-03-13 16:29:53,993 [INFO]: }
2025-03-13 16:29:53,993 [INFO]: 	>>> Finished "Creating the index" in 75.3842 secs
2025-03-13 16:29:53,993 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1313 secs
2025-03-13 16:29:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 91410 [episode count 11/20]
[retrieval_preprocessing] for episode 56599 [episode count 12/20], we have num_retrieval=np.int64(4839) num_query=np.int64(344)
2025-03-13 16:29:59,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:01,290 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:01
2025-03-13 16:30:01,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2078.45it/s]
2025-03-13 16:30:01,316 [INFO]: There are 4839 embeddings of dim 49152
2025-03-13 16:30:01,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 16:30:01,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:01
2025-03-13 16:30:01,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:01,318 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:30:01,318 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:01,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:30:01,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:01
2025-03-13 16:30:01,318 [INFO]: 998.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:01,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:30:01,319 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:01
2025-03-13 16:30:01,319 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:01,319 [INFO]: 	Creating the index 03/13/2025, 16:30:01
2025-03-13 16:30:01,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:01
2025-03-13 16:30:01,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 16:30:01,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:01
2025-03-13 16:30:01,323 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:30:01,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.88it/s] 10%|█         | 2/20 [00:00<00:02,  6.92it/s] 20%|██        | 4/20 [00:00<00:01,  9.22it/s] 30%|███       | 6/20 [00:00<00:01,  9.93it/s] 40%|████      | 8/20 [00:00<00:01, 10.05it/s] 50%|█████     | 10/20 [00:01<00:00, 10.36it/s] 60%|██████    | 12/20 [00:01<00:00, 10.40it/s] 70%|███████   | 14/20 [00:01<00:00, 10.45it/s] 80%|████████  | 16/20 [00:01<00:00, 10.19it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.34it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.38it/s]100%|██████████| 20/20 [00:06<00:00,  1.04it/s]100%|██████████| 20/20 [00:06<00:00,  3.22it/s]
2025-03-13 16:30:07,531 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:07
2025-03-13 16:31:02,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8941 secs
2025-03-13 16:31:02,426 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 16:31:02,426 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.79it/s]
2025-03-13 16:31:40,255 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8290 secs
2025-03-13 16:31:40,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.9368 secs
2025-03-13 16:31:40,260 [INFO]: {
2025-03-13 16:31:40,260 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:40,260 [INFO]: 	index_param: efSearch=213
2025-03-13 16:31:40,260 [INFO]: 	index_path: knn.index
2025-03-13 16:31:40,260 [INFO]: 	size in bytes: 952044370
2025-03-13 16:31:40,260 [INFO]: 	avg_search_speed_ms: 11.659582767479279
2025-03-13 16:31:40,260 [INFO]: 	99p_search_speed_ms: 21.23561135027555
2025-03-13 16:31:40,260 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:40,260 [INFO]: 	nb vectors: 4839
2025-03-13 16:31:40,260 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:40,260 [INFO]: 	compression ratio: 0.9993085847458979
2025-03-13 16:31:40,260 [INFO]: }
2025-03-13 16:31:40,260 [INFO]: 	>>> Finished "Creating the index" in 98.9404 secs
2025-03-13 16:31:40,260 [INFO]: >>> Finished "Launching the whole pipeline" in 98.9694 secs
2025-03-13 16:31:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 56599 [episode count 12/20]
[retrieval_preprocessing] for episode 77084 [episode count 13/20], we have num_retrieval=np.int64(4844) num_query=np.int64(339)
2025-03-13 16:31:46,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:46,813 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:46
2025-03-13 16:31:46,813 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.83it/s]
2025-03-13 16:31:46,841 [INFO]: There are 4844 embeddings of dim 49152
2025-03-13 16:31:46,842 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:31:46,842 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:46
2025-03-13 16:31:46,842 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:46,842 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:31:46,842 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:46,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:31:46,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:46
2025-03-13 16:31:46,843 [INFO]: 999.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:46,843 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:31:46,843 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:46
2025-03-13 16:31:46,843 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:46,843 [INFO]: 	Creating the index 03/13/2025, 16:31:46
2025-03-13 16:31:46,843 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:46
2025-03-13 16:31:46,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:31:46,847 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:46
2025-03-13 16:31:46,847 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:31:46,847 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.54it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.81it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.54it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.80it/s] 40%|████      | 8/20 [00:00<00:01,  9.74it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.69it/s] 50%|█████     | 10/20 [00:01<00:01,  9.65it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.64it/s] 60%|██████    | 12/20 [00:01<00:00,  9.52it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.44it/s] 70%|███████   | 14/20 [00:01<00:00,  9.51it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.48it/s] 80%|████████  | 16/20 [00:01<00:00,  9.44it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.43it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.44it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.58it/s]100%|██████████| 20/20 [00:06<00:00,  1.28s/it]100%|██████████| 20/20 [00:06<00:00,  3.31it/s]
2025-03-13 16:31:52,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:52
2025-03-13 16:32:41,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0935 secs
2025-03-13 16:32:41,997 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 16:32:41,997 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.55it/s] 50%|█████     | 2/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 16:33:17,480 [INFO]: 	>>> Finished "Compute fast metrics" in 35.4834 secs
2025-03-13 16:33:18,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.3160 secs
2025-03-13 16:33:18,163 [INFO]: {
2025-03-13 16:33:18,163 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:18,163 [INFO]: 	index_param: efSearch=234
2025-03-13 16:33:18,163 [INFO]: 	index_path: knn.index
2025-03-13 16:33:18,163 [INFO]: 	size in bytes: 953028070
2025-03-13 16:33:18,163 [INFO]: 	avg_search_speed_ms: 10.779254178863805
2025-03-13 16:33:18,163 [INFO]: 	99p_search_speed_ms: 17.514655811246488
2025-03-13 16:33:18,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:18,164 [INFO]: 	nb vectors: 4844
2025-03-13 16:33:18,164 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:18,164 [INFO]: 	compression ratio: 0.9993086058839799
2025-03-13 16:33:18,164 [INFO]: }
2025-03-13 16:33:18,164 [INFO]: 	>>> Finished "Creating the index" in 91.3203 secs
2025-03-13 16:33:18,164 [INFO]: >>> Finished "Launching the whole pipeline" in 91.3505 secs
2025-03-13 16:33:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 77084 [episode count 13/20]
[retrieval_preprocessing] for episode 21864 [episode count 14/20], we have num_retrieval=np.int64(4954) num_query=np.int64(229)
2025-03-13 16:33:23,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:24,492 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:24
2025-03-13 16:33:24,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 797.09it/s]
2025-03-13 16:33:24,525 [INFO]: There are 4954 embeddings of dim 49152
2025-03-13 16:33:24,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 16:33:24,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:24
2025-03-13 16:33:24,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:24,526 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:33:24,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:24,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:33:24,527 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:24
2025-03-13 16:33:24,527 [INFO]: 1022.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:24,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 16:33:24,528 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:24
2025-03-13 16:33:24,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:24,528 [INFO]: 	Creating the index 03/13/2025, 16:33:24
2025-03-13 16:33:24,529 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:24
2025-03-13 16:33:24,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0038 secs
2025-03-13 16:33:24,533 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:24
2025-03-13 16:33:24,533 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:33:24,534 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.71it/s] 15%|█▌        | 3/20 [00:00<00:01, 11.48it/s] 25%|██▌       | 5/20 [00:00<00:01, 13.24it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.47it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.43it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.11it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.06it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.08it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.12it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.06it/s]100%|██████████| 20/20 [00:05<00:00,  3.53it/s]
2025-03-13 16:33:30,200 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:30
2025-03-13 16:34:21,443 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2425 secs
2025-03-13 16:34:21,444 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:34:21,444 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.95it/s]
2025-03-13 16:34:54,414 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9700 secs
2025-03-13 16:34:54,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.4047 secs
2025-03-13 16:34:54,939 [INFO]: {
2025-03-13 16:34:54,939 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:54,939 [INFO]: 	index_param: efSearch=169
2025-03-13 16:34:54,939 [INFO]: 	index_path: knn.index
2025-03-13 16:34:54,940 [INFO]: 	size in bytes: 974669890
2025-03-13 16:34:54,940 [INFO]: 	avg_search_speed_ms: 8.799693178267441
2025-03-13 16:34:54,940 [INFO]: 	99p_search_speed_ms: 17.77411962393676
2025-03-13 16:34:54,940 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:54,940 [INFO]: 	nb vectors: 4954
2025-03-13 16:34:54,940 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:54,940 [INFO]: 	compression ratio: 0.9993086295094229
2025-03-13 16:34:54,940 [INFO]: }
2025-03-13 16:34:54,940 [INFO]: 	>>> Finished "Creating the index" in 90.4115 secs
2025-03-13 16:34:54,940 [INFO]: >>> Finished "Launching the whole pipeline" in 90.4478 secs
2025-03-13 16:34:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 21864 [episode count 14/20]
[retrieval_preprocessing] for episode 41323 [episode count 15/20], we have num_retrieval=np.int64(4982) num_query=np.int64(201)
2025-03-13 16:34:58,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:59,724 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:59
2025-03-13 16:34:59,725 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.46it/s]
2025-03-13 16:34:59,892 [INFO]: There are 4982 embeddings of dim 49152
2025-03-13 16:34:59,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1682 secs
2025-03-13 16:34:59,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:59
2025-03-13 16:34:59,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:59,893 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:34:59,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:59,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:34:59,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:59
2025-03-13 16:34:59,894 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:59,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:34:59,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:59
2025-03-13 16:34:59,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:59,894 [INFO]: 	Creating the index 03/13/2025, 16:34:59
2025-03-13 16:34:59,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:59
2025-03-13 16:34:59,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:34:59,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:59
2025-03-13 16:34:59,898 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:34:59,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.25it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.31it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.30it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.84it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.98it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.90it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.98it/s] 70%|███████   | 14/20 [00:01<00:00,  9.98it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.95it/s] 80%|████████  | 16/20 [00:01<00:00,  9.95it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.95it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.88it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.80it/s]100%|██████████| 20/20 [00:05<00:00,  1.14s/it]100%|██████████| 20/20 [00:05<00:00,  3.48it/s]
2025-03-13 16:35:05,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:05
2025-03-13 16:35:50,238 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5812 secs
2025-03-13 16:35:50,238 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 16:35:50,238 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 16:36:35,655 [INFO]: 	>>> Finished "Compute fast metrics" in 45.4168 secs
2025-03-13 16:36:35,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.7618 secs
2025-03-13 16:36:35,660 [INFO]: {
2025-03-13 16:36:35,660 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:35,660 [INFO]: 	index_param: efSearch=226
2025-03-13 16:36:35,660 [INFO]: 	index_path: knn.index
2025-03-13 16:36:35,660 [INFO]: 	size in bytes: 980178670
2025-03-13 16:36:35,660 [INFO]: 	avg_search_speed_ms: 10.450431184167803
2025-03-13 16:36:35,660 [INFO]: 	99p_search_speed_ms: 17.315062768757336
2025-03-13 16:36:35,660 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:35,660 [INFO]: 	nb vectors: 4982
2025-03-13 16:36:35,660 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:35,660 [INFO]: 	compression ratio: 0.9993086831812
2025-03-13 16:36:35,660 [INFO]: }
2025-03-13 16:36:35,660 [INFO]: 	>>> Finished "Creating the index" in 95.7655 secs
2025-03-13 16:36:35,660 [INFO]: >>> Finished "Launching the whole pipeline" in 95.9355 secs
2025-03-13 16:36:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 41323 [episode count 15/20]
[retrieval_preprocessing] for episode 8050 [episode count 16/20], we have num_retrieval=np.int64(4946) num_query=np.int64(237)
2025-03-13 16:36:40,216 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:41,326 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:41
2025-03-13 16:36:41,326 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1297.34it/s]
2025-03-13 16:36:41,354 [INFO]: There are 4946 embeddings of dim 49152
2025-03-13 16:36:41,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 16:36:41,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:41
2025-03-13 16:36:41,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:41,355 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:36:41,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:41,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:36:41,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:41
2025-03-13 16:36:41,356 [INFO]: 1020.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:41,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:36:41,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:41
2025-03-13 16:36:41,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:41,356 [INFO]: 	Creating the index 03/13/2025, 16:36:41
2025-03-13 16:36:41,357 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:41
2025-03-13 16:36:41,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:36:41,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:41
2025-03-13 16:36:41,360 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:36:41,360 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.83it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.55it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.36it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.80it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.82it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.08it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.14it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.14it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.13it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.16it/s]100%|██████████| 20/20 [00:05<00:00,  3.76it/s]
2025-03-13 16:36:46,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:46
2025-03-13 16:37:33,707 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0167 secs
2025-03-13 16:37:33,708 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 16:37:33,708 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s]
2025-03-13 16:38:25,700 [INFO]: 	>>> Finished "Compute fast metrics" in 51.9924 secs
2025-03-13 16:38:25,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.3465 secs
2025-03-13 16:38:25,706 [INFO]: {
2025-03-13 16:38:25,706 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:25,706 [INFO]: 	index_param: efSearch=228
2025-03-13 16:38:25,707 [INFO]: 	index_path: knn.index
2025-03-13 16:38:25,707 [INFO]: 	size in bytes: 973095910
2025-03-13 16:38:25,707 [INFO]: 	avg_search_speed_ms: 11.37994114252335
2025-03-13 16:38:25,707 [INFO]: 	99p_search_speed_ms: 19.547349112108357
2025-03-13 16:38:25,707 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:25,707 [INFO]: 	nb vectors: 4946
2025-03-13 16:38:25,707 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:25,707 [INFO]: 	compression ratio: 0.9993086580746188
2025-03-13 16:38:25,707 [INFO]: }
2025-03-13 16:38:25,707 [INFO]: 	>>> Finished "Creating the index" in 104.3502 secs
2025-03-13 16:38:25,707 [INFO]: >>> Finished "Launching the whole pipeline" in 104.3806 secs
2025-03-13 16:38:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 8050 [episode count 16/20]
[retrieval_preprocessing] for episode 31609 [episode count 17/20], we have num_retrieval=np.int64(4958) num_query=np.int64(225)
2025-03-13 16:38:31,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:32,843 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:32
2025-03-13 16:38:32,843 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.17it/s]
2025-03-13 16:38:32,868 [INFO]: There are 4958 embeddings of dim 49152
2025-03-13 16:38:32,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 16:38:32,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:32
2025-03-13 16:38:32,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:32,868 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:38:32,868 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:32,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:32,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:32
2025-03-13 16:38:32,868 [INFO]: 1023.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:32,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:38:32,868 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:32
2025-03-13 16:38:32,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:32,868 [INFO]: 	Creating the index 03/13/2025, 16:38:32
2025-03-13 16:38:32,869 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:32
2025-03-13 16:38:32,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:38:32,870 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:32
2025-03-13 16:38:32,870 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:38:32,870 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.94it/s] 10%|█         | 2/20 [00:00<00:02,  6.47it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.41it/s] 20%|██        | 4/20 [00:00<00:01,  8.05it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.36it/s] 30%|███       | 6/20 [00:00<00:01,  8.58it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.76it/s] 40%|████      | 8/20 [00:00<00:01,  9.01it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.11it/s] 50%|█████     | 10/20 [00:01<00:01,  9.07it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.07it/s] 60%|██████    | 12/20 [00:01<00:00,  9.17it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.25it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.47it/s] 80%|████████  | 16/20 [00:01<00:00,  9.50it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.51it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.54it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.51it/s]100%|██████████| 20/20 [00:05<00:00,  1.15s/it]100%|██████████| 20/20 [00:05<00:00,  3.39it/s]
2025-03-13 16:38:38,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:38
2025-03-13 16:39:35,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7289 secs
2025-03-13 16:39:35,499 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 16:39:35,499 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.20it/s] 50%|█████     | 2/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 16:40:00,081 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5812 secs
2025-03-13 16:40:00,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.2143 secs
2025-03-13 16:40:00,084 [INFO]: {
2025-03-13 16:40:00,084 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:00,084 [INFO]: 	index_param: efSearch=218
2025-03-13 16:40:00,084 [INFO]: 	index_path: knn.index
2025-03-13 16:40:00,084 [INFO]: 	size in bytes: 975456850
2025-03-13 16:40:00,084 [INFO]: 	avg_search_speed_ms: 9.89300027304503
2025-03-13 16:40:00,084 [INFO]: 	99p_search_speed_ms: 16.638144128955897
2025-03-13 16:40:00,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:00,084 [INFO]: 	nb vectors: 4958
2025-03-13 16:40:00,084 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:00,084 [INFO]: 	compression ratio: 0.999308645994951
2025-03-13 16:40:00,084 [INFO]: }
2025-03-13 16:40:00,084 [INFO]: 	>>> Finished "Creating the index" in 87.2158 secs
2025-03-13 16:40:00,084 [INFO]: >>> Finished "Launching the whole pipeline" in 87.2412 secs
2025-03-13 16:40:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 31609 [episode count 17/20]
[retrieval_preprocessing] for episode 28539 [episode count 18/20], we have num_retrieval=np.int64(4916) num_query=np.int64(267)
2025-03-13 16:40:10,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:11,166 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:11
2025-03-13 16:40:11,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1750.54it/s]
2025-03-13 16:40:11,188 [INFO]: There are 4916 embeddings of dim 49152
2025-03-13 16:40:11,189 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 16:40:11,189 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:11
2025-03-13 16:40:11,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:11,189 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:40:11,189 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:11,189 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:40:11,189 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:11
2025-03-13 16:40:11,189 [INFO]: 1014.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:11,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:40:11,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:11
2025-03-13 16:40:11,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:11,189 [INFO]: 	Creating the index 03/13/2025, 16:40:11
2025-03-13 16:40:11,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:11
2025-03-13 16:40:11,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:40:11,190 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:11
2025-03-13 16:40:11,190 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:40:11,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.22it/s] 10%|█         | 2/20 [00:00<00:02,  6.91it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.84it/s] 20%|██        | 4/20 [00:00<00:01,  8.27it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.52it/s] 30%|███       | 6/20 [00:00<00:01,  8.68it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.80it/s] 40%|████      | 8/20 [00:00<00:01,  8.86it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.99it/s] 50%|█████     | 10/20 [00:01<00:01,  9.03it/s] 60%|██████    | 12/20 [00:01<00:00,  9.91it/s] 70%|███████   | 14/20 [00:01<00:00, 10.41it/s] 80%|████████  | 16/20 [00:01<00:00, 10.46it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.53it/s]100%|██████████| 20/20 [00:05<00:00,  1.54it/s]100%|██████████| 20/20 [00:05<00:00,  3.64it/s]
2025-03-13 16:40:16,681 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:16
2025-03-13 16:41:06,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.7110 secs
2025-03-13 16:41:06,393 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 16:41:06,393 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-13 16:41:39,747 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3541 secs
2025-03-13 16:41:39,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.5613 secs
2025-03-13 16:41:39,751 [INFO]: {
2025-03-13 16:41:39,752 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:39,752 [INFO]: 	index_param: efSearch=225
2025-03-13 16:41:39,752 [INFO]: 	index_path: knn.index
2025-03-13 16:41:39,752 [INFO]: 	size in bytes: 967193470
2025-03-13 16:41:39,752 [INFO]: 	avg_search_speed_ms: 11.990680030437646
2025-03-13 16:41:39,752 [INFO]: 	99p_search_speed_ms: 20.55854693055152
2025-03-13 16:41:39,752 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:39,752 [INFO]: 	nb vectors: 4916
2025-03-13 16:41:39,752 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:39,752 [INFO]: 	compression ratio: 0.9993087815202061
2025-03-13 16:41:39,752 [INFO]: }
2025-03-13 16:41:39,752 [INFO]: 	>>> Finished "Creating the index" in 88.5626 secs
2025-03-13 16:41:39,752 [INFO]: >>> Finished "Launching the whole pipeline" in 88.5855 secs
2025-03-13 16:41:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 28539 [episode count 18/20]
[retrieval_preprocessing] for episode 8588 [episode count 19/20], we have num_retrieval=np.int64(5011) num_query=np.int64(172)
2025-03-13 16:41:43,839 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:44,817 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:44
2025-03-13 16:41:44,817 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 994.38it/s]
2025-03-13 16:41:44,844 [INFO]: There are 5011 embeddings of dim 49152
2025-03-13 16:41:44,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:41:44,844 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:44
2025-03-13 16:41:44,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:44,844 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 16:41:44,844 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:44,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:41:44,844 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:44
2025-03-13 16:41:44,844 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:44,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:41:44,844 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:44
2025-03-13 16:41:44,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:44,844 [INFO]: 	Creating the index 03/13/2025, 16:41:44
2025-03-13 16:41:44,845 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:44
2025-03-13 16:41:44,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:41:44,846 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:44
2025-03-13 16:41:44,846 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:41:44,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.41it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.50it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.61it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.48it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.92it/s] 55%|█████▌    | 11/20 [00:00<00:00, 13.13it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.42it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.93it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.89it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.39it/s]100%|██████████| 20/20 [00:06<00:00,  3.33it/s]
2025-03-13 16:41:50,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:50
2025-03-13 16:42:44,912 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.0562 secs
2025-03-13 16:42:44,912 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:42:44,913 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 16:43:44,158 [INFO]: 	>>> Finished "Compute fast metrics" in 59.2455 secs
2025-03-13 16:43:44,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.3162 secs
2025-03-13 16:43:44,162 [INFO]: {
2025-03-13 16:43:44,162 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:44,162 [INFO]: 	index_param: efSearch=216
2025-03-13 16:43:44,162 [INFO]: 	index_path: knn.index
2025-03-13 16:43:44,162 [INFO]: 	size in bytes: 985884370
2025-03-13 16:43:44,162 [INFO]: 	avg_search_speed_ms: 11.152217484940023
2025-03-13 16:43:44,162 [INFO]: 	99p_search_speed_ms: 22.419818229973313
2025-03-13 16:43:44,162 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:44,162 [INFO]: 	nb vectors: 5011
2025-03-13 16:43:44,162 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:44,162 [INFO]: 	compression ratio: 0.9993085578585651
2025-03-13 16:43:44,162 [INFO]: }
2025-03-13 16:43:44,162 [INFO]: 	>>> Finished "Creating the index" in 119.3178 secs
2025-03-13 16:43:44,162 [INFO]: >>> Finished "Launching the whole pipeline" in 119.3451 secs
2025-03-13 16:43:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 8588 [episode count 19/20]
2025-03-13 16:43:45: [retrieval_preprocessing] finished for 484659531_put_marker_in_cup [chosen_id count 3/196]
2025-03-13 16:43:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4846810092_hang_cloth_on_stand [chosen_id count 4/196]
2025-03-13 16:43:49: [retrieval_preprocessing] we have num_total=4667 embedding_dim=49152
[retrieval_preprocessing] for episode 75791 [episode count 0/20], we have num_retrieval=np.int64(4468) num_query=np.int64(199)
2025-03-13 16:43:51,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:52,238 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:52
2025-03-13 16:43:52,238 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1207.69it/s]
2025-03-13 16:43:52,264 [INFO]: There are 4468 embeddings of dim 49152
2025-03-13 16:43:52,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:43:52,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:52
2025-03-13 16:43:52,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:52,264 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:43:52,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:52,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:52,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:52
2025-03-13 16:43:52,265 [INFO]: 922.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:52,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:43:52,265 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:52
2025-03-13 16:43:52,265 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:52,265 [INFO]: 	Creating the index 03/13/2025, 16:43:52
2025-03-13 16:43:52,265 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:52
2025-03-13 16:43:52,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:43:52,266 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:52
2025-03-13 16:43:52,266 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:43:52,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.65it/s] 17%|█▋        | 3/18 [00:00<00:01, 11.28it/s] 28%|██▊       | 5/18 [00:00<00:00, 13.04it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.73it/s] 50%|█████     | 9/18 [00:00<00:00, 14.55it/s] 61%|██████    | 11/18 [00:00<00:00, 14.96it/s] 72%|███████▏  | 13/18 [00:00<00:00, 15.07it/s] 83%|████████▎ | 15/18 [00:01<00:00, 14.84it/s] 94%|█████████▍| 17/18 [00:01<00:00, 14.95it/s]100%|██████████| 18/18 [00:05<00:00,  3.08it/s]
2025-03-13 16:43:58,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:58
2025-03-13 16:44:55,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5759 secs
2025-03-13 16:44:55,084 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 16:44:55,084 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-13 16:45:34,886 [INFO]: 	>>> Finished "Compute fast metrics" in 39.8024 secs
2025-03-13 16:45:34,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.6237 secs
2025-03-13 16:45:34,890 [INFO]: {
2025-03-13 16:45:34,890 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:34,890 [INFO]: 	index_param: efSearch=210
2025-03-13 16:45:34,890 [INFO]: 	index_path: knn.index
2025-03-13 16:45:34,890 [INFO]: 	size in bytes: 879052270
2025-03-13 16:45:34,890 [INFO]: 	avg_search_speed_ms: 11.377808855914333
2025-03-13 16:45:34,890 [INFO]: 	99p_search_speed_ms: 16.534894215874388
2025-03-13 16:45:34,890 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:34,890 [INFO]: 	nb vectors: 4468
2025-03-13 16:45:34,890 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:34,890 [INFO]: 	compression ratio: 0.9993086577206609
2025-03-13 16:45:34,890 [INFO]: }
2025-03-13 16:45:34,890 [INFO]: 	>>> Finished "Creating the index" in 102.6251 secs
2025-03-13 16:45:34,890 [INFO]: >>> Finished "Launching the whole pipeline" in 102.6521 secs
2025-03-13 16:45:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 75791 [episode count 0/20]
[retrieval_preprocessing] for episode 73760 [episode count 1/20], we have num_retrieval=np.int64(4376) num_query=np.int64(291)
2025-03-13 16:45:37,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:38,781 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:38
2025-03-13 16:45:38,781 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1326.89it/s]
2025-03-13 16:45:38,806 [INFO]: There are 4376 embeddings of dim 49152
2025-03-13 16:45:38,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 16:45:38,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:38
2025-03-13 16:45:38,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:38,806 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 16:45:38,806 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:38,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:38,806 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:38
2025-03-13 16:45:38,806 [INFO]: 903.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:38,806 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:45:38,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:38
2025-03-13 16:45:38,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:38,807 [INFO]: 	Creating the index 03/13/2025, 16:45:38
2025-03-13 16:45:38,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:38
2025-03-13 16:45:38,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:45:38,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:38
2025-03-13 16:45:38,808 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:45:38,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.73it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.07it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.01it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.19it/s] 50%|█████     | 9/18 [00:00<00:00, 10.54it/s] 61%|██████    | 11/18 [00:01<00:00, 10.68it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.73it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.92it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.01it/s]100%|██████████| 18/18 [00:05<00:00,  3.52it/s]
2025-03-13 16:45:44,825 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:44
2025-03-13 16:46:31,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0052 secs
2025-03-13 16:46:31,831 [INFO]: The best hyperparameters are: efSearch=110
2025-03-13 16:46:31,831 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 16:47:04,752 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9216 secs
2025-03-13 16:47:04,756 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.9477 secs
2025-03-13 16:47:04,756 [INFO]: {
2025-03-13 16:47:04,756 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:04,756 [INFO]: 	index_param: efSearch=110
2025-03-13 16:47:04,756 [INFO]: 	index_path: knn.index
2025-03-13 16:47:04,756 [INFO]: 	size in bytes: 860951890
2025-03-13 16:47:04,756 [INFO]: 	avg_search_speed_ms: 8.287982615738008
2025-03-13 16:47:04,756 [INFO]: 	99p_search_speed_ms: 15.883852133993077
2025-03-13 16:47:04,756 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:04,756 [INFO]: 	nb vectors: 4376
2025-03-13 16:47:04,756 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:04,756 [INFO]: 	compression ratio: 0.9993085769287294
2025-03-13 16:47:04,756 [INFO]: }
2025-03-13 16:47:04,756 [INFO]: 	>>> Finished "Creating the index" in 85.9494 secs
2025-03-13 16:47:04,756 [INFO]: >>> Finished "Launching the whole pipeline" in 85.9753 secs
2025-03-13 16:47:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 73760 [episode count 1/20]
[retrieval_preprocessing] for episode 19495 [episode count 2/20], we have num_retrieval=np.int64(4538) num_query=np.int64(129)
2025-03-13 16:47:08,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:08,857 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:08
2025-03-13 16:47:08,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.48it/s]
2025-03-13 16:47:08,885 [INFO]: There are 4538 embeddings of dim 49152
2025-03-13 16:47:08,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:47:08,885 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:08
2025-03-13 16:47:08,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:08,885 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:47:08,885 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:08,885 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:08,885 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:08
2025-03-13 16:47:08,885 [INFO]: 936.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:08,885 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:47:08,886 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:08
2025-03-13 16:47:08,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:08,886 [INFO]: 	Creating the index 03/13/2025, 16:47:08
2025-03-13 16:47:08,886 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:08
2025-03-13 16:47:08,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:47:08,887 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:08
2025-03-13 16:47:08,887 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:47:08,887 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.11it/s] 11%|█         | 2/18 [00:00<00:02,  7.04it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.09it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.71it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.99it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.31it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.50it/s] 50%|█████     | 9/18 [00:00<00:00, 10.09it/s] 61%|██████    | 11/18 [00:01<00:00, 10.36it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.28it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.94it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.94it/s]100%|██████████| 18/18 [00:06<00:00,  1.02it/s]100%|██████████| 18/18 [00:06<00:00,  2.76it/s]
2025-03-13 16:47:15,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:15
2025-03-13 16:48:00,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0717 secs
2025-03-13 16:48:00,500 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 16:48:00,500 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.89it/s]
2025-03-13 16:48:33,850 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3497 secs
2025-03-13 16:48:33,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9677 secs
2025-03-13 16:48:33,855 [INFO]: {
2025-03-13 16:48:33,855 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:33,855 [INFO]: 	index_param: efSearch=122
2025-03-13 16:48:33,855 [INFO]: 	index_path: knn.index
2025-03-13 16:48:33,855 [INFO]: 	size in bytes: 892824310
2025-03-13 16:48:33,855 [INFO]: 	avg_search_speed_ms: 10.478784485409657
2025-03-13 16:48:33,855 [INFO]: 	99p_search_speed_ms: 19.309766846708982
2025-03-13 16:48:33,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:33,855 [INFO]: 	nb vectors: 4538
2025-03-13 16:48:33,855 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:33,855 [INFO]: 	compression ratio: 0.9993087038591053
2025-03-13 16:48:33,855 [INFO]: }
2025-03-13 16:48:33,855 [INFO]: 	>>> Finished "Creating the index" in 84.9693 secs
2025-03-13 16:48:33,855 [INFO]: >>> Finished "Launching the whole pipeline" in 84.9977 secs
2025-03-13 16:48:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 19495 [episode count 2/20]
[retrieval_preprocessing] for episode 6193 [episode count 3/20], we have num_retrieval=np.int64(4534) num_query=np.int64(133)
2025-03-13 16:48:36,631 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:37,397 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:37
2025-03-13 16:48:37,397 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1973.79it/s]
2025-03-13 16:48:37,428 [INFO]: There are 4534 embeddings of dim 49152
2025-03-13 16:48:37,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:48:37,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:37
2025-03-13 16:48:37,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:37,430 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:48:37,430 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:37,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:48:37,430 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:37
2025-03-13 16:48:37,431 [INFO]: 935.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:37,431 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:48:37,431 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:37
2025-03-13 16:48:37,431 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:37,431 [INFO]: 	Creating the index 03/13/2025, 16:48:37
2025-03-13 16:48:37,432 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:37
2025-03-13 16:48:37,435 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 16:48:37,436 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:37
2025-03-13 16:48:37,436 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:48:37,436 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.67it/s] 11%|█         | 2/18 [00:00<00:02,  6.15it/s] 17%|█▋        | 3/18 [00:00<00:02,  6.95it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.48it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.84it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.25it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.52it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.61it/s] 50%|█████     | 9/18 [00:01<00:01,  8.68it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.83it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.22it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.96it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.72it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.60it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.60it/s] 94%|█████████▍| 17/18 [00:02<00:00,  8.48it/s]100%|██████████| 18/18 [00:07<00:00,  1.60s/it]100%|██████████| 18/18 [00:07<00:00,  2.47it/s]
2025-03-13 16:48:44,723 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:44
2025-03-13 16:49:33,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1730 secs
2025-03-13 16:49:33,898 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 16:49:33,898 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 16:50:28,676 [INFO]: 	>>> Finished "Compute fast metrics" in 54.7785 secs
2025-03-13 16:50:29,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.6656 secs
2025-03-13 16:50:29,102 [INFO]: {
2025-03-13 16:50:29,102 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:29,102 [INFO]: 	index_param: efSearch=111
2025-03-13 16:50:29,102 [INFO]: 	index_path: knn.index
2025-03-13 16:50:29,102 [INFO]: 	size in bytes: 892037230
2025-03-13 16:50:29,102 [INFO]: 	avg_search_speed_ms: 7.518248009159321
2025-03-13 16:50:29,102 [INFO]: 	99p_search_speed_ms: 11.208177879452705
2025-03-13 16:50:29,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:29,102 [INFO]: 	nb vectors: 4534
2025-03-13 16:50:29,102 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:29,102 [INFO]: 	compression ratio: 0.9993088203280485
2025-03-13 16:50:29,102 [INFO]: }
2025-03-13 16:50:29,102 [INFO]: 	>>> Finished "Creating the index" in 111.6706 secs
2025-03-13 16:50:29,102 [INFO]: >>> Finished "Launching the whole pipeline" in 111.7054 secs
2025-03-13 16:50:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 6193 [episode count 3/20]
[retrieval_preprocessing] for episode 14936 [episode count 4/20], we have num_retrieval=np.int64(4477) num_query=np.int64(190)
2025-03-13 16:50:31,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:31,933 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:31
2025-03-13 16:50:31,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.99it/s]
2025-03-13 16:50:31,957 [INFO]: There are 4477 embeddings of dim 49152
2025-03-13 16:50:31,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 16:50:31,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:31
2025-03-13 16:50:31,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:31,958 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:50:31,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:31,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:31,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:31
2025-03-13 16:50:31,958 [INFO]: 923.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:31,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:50:31,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:31
2025-03-13 16:50:31,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:31,958 [INFO]: 	Creating the index 03/13/2025, 16:50:31
2025-03-13 16:50:31,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:31
2025-03-13 16:50:31,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:50:31,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:31
2025-03-13 16:50:31,960 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:50:31,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.93it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.72it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.72it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.16it/s] 50%|█████     | 9/18 [00:00<00:00, 11.25it/s] 61%|██████    | 11/18 [00:01<00:00, 11.33it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.47it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.52it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.78it/s]100%|██████████| 18/18 [00:04<00:00,  3.83it/s]
2025-03-13 16:50:36,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:36
2025-03-13 16:51:21,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8406 secs
2025-03-13 16:51:21,500 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 16:51:21,500 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  4.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.40it/s]
2025-03-13 16:51:44,064 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5644 secs
2025-03-13 16:51:44,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1088 secs
2025-03-13 16:51:44,068 [INFO]: {
2025-03-13 16:51:44,068 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:44,068 [INFO]: 	index_param: efSearch=138
2025-03-13 16:51:44,069 [INFO]: 	index_path: knn.index
2025-03-13 16:51:44,069 [INFO]: 	size in bytes: 880822990
2025-03-13 16:51:44,069 [INFO]: 	avg_search_speed_ms: 9.954083511207383
2025-03-13 16:51:44,069 [INFO]: 	99p_search_speed_ms: 17.819625977426792
2025-03-13 16:51:44,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:44,069 [INFO]: 	nb vectors: 4477
2025-03-13 16:51:44,069 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:44,069 [INFO]: 	compression ratio: 0.9993086306705051
2025-03-13 16:51:44,069 [INFO]: }
2025-03-13 16:51:44,069 [INFO]: 	>>> Finished "Creating the index" in 72.1106 secs
2025-03-13 16:51:44,069 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1361 secs
2025-03-13 16:51:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 14936 [episode count 4/20]
[retrieval_preprocessing] for episode 13950 [episode count 5/20], we have num_retrieval=np.int64(4343) num_query=np.int64(324)
2025-03-13 16:51:47,168 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:47,910 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:47
2025-03-13 16:51:47,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1565.62it/s]
2025-03-13 16:51:47,935 [INFO]: There are 4343 embeddings of dim 49152
2025-03-13 16:51:47,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:51:47,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:47
2025-03-13 16:51:47,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:47,935 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 16:51:47,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:47,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:47,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:47
2025-03-13 16:51:47,935 [INFO]: 896.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:47,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:51:47,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:47
2025-03-13 16:51:47,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:47,935 [INFO]: 	Creating the index 03/13/2025, 16:51:47
2025-03-13 16:51:47,935 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:47
2025-03-13 16:51:47,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:51:47,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:47
2025-03-13 16:51:47,937 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:51:47,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.70it/s] 11%|█         | 2/18 [00:00<00:02,  6.21it/s] 17%|█▋        | 3/18 [00:00<00:02,  6.93it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.27it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.57it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.68it/s] 39%|███▉      | 7/18 [00:00<00:01,  7.77it/s] 44%|████▍     | 8/18 [00:01<00:01,  7.84it/s] 50%|█████     | 9/18 [00:01<00:01,  7.88it/s] 56%|█████▌    | 10/18 [00:01<00:01,  7.87it/s] 61%|██████    | 11/18 [00:01<00:00,  7.94it/s] 67%|██████▋   | 12/18 [00:01<00:00,  7.84it/s] 72%|███████▏  | 13/18 [00:01<00:00,  7.84it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.76it/s] 94%|█████████▍| 17/18 [00:02<00:00,  9.38it/s]100%|██████████| 18/18 [00:05<00:00,  1.15it/s]100%|██████████| 18/18 [00:05<00:00,  3.17it/s]
2025-03-13 16:51:53,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:53
2025-03-13 16:52:37,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4538 secs
2025-03-13 16:52:37,069 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 16:52:37,069 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 16:53:27,150 [INFO]: 	>>> Finished "Compute fast metrics" in 50.0804 secs
2025-03-13 16:53:27,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.2171 secs
2025-03-13 16:53:27,155 [INFO]: {
2025-03-13 16:53:27,155 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:27,155 [INFO]: 	index_param: efSearch=143
2025-03-13 16:53:27,155 [INFO]: 	index_path: knn.index
2025-03-13 16:53:27,155 [INFO]: 	size in bytes: 854459350
2025-03-13 16:53:27,155 [INFO]: 	avg_search_speed_ms: 9.693111411914908
2025-03-13 16:53:27,155 [INFO]: 	99p_search_speed_ms: 16.264437080826593
2025-03-13 16:53:27,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:27,155 [INFO]: 	nb vectors: 4343
2025-03-13 16:53:27,155 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:27,155 [INFO]: 	compression ratio: 0.9993085616068219
2025-03-13 16:53:27,155 [INFO]: }
2025-03-13 16:53:27,155 [INFO]: 	>>> Finished "Creating the index" in 99.2195 secs
2025-03-13 16:53:27,155 [INFO]: >>> Finished "Launching the whole pipeline" in 99.2447 secs
2025-03-13 16:53:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 13950 [episode count 5/20]
[retrieval_preprocessing] for episode 11887 [episode count 6/20], we have num_retrieval=np.int64(4486) num_query=np.int64(181)
2025-03-13 16:53:31,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:32,314 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:32
2025-03-13 16:53:32,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.59it/s]
2025-03-13 16:53:32,342 [INFO]: There are 4486 embeddings of dim 49152
2025-03-13 16:53:32,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 16:53:32,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:32
2025-03-13 16:53:32,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:32,343 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:53:32,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:32,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:53:32,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:32
2025-03-13 16:53:32,343 [INFO]: 925.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:32,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:53:32,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:32
2025-03-13 16:53:32,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:32,343 [INFO]: 	Creating the index 03/13/2025, 16:53:32
2025-03-13 16:53:32,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:32
2025-03-13 16:53:32,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:53:32,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:32
2025-03-13 16:53:32,345 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:53:32,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.37it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.33it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.21it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.78it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.74it/s] 50%|█████     | 9/18 [00:00<00:00,  9.54it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.28it/s] 61%|██████    | 11/18 [00:01<00:00,  9.11it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.09it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.90it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.78it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.54it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.28it/s] 94%|█████████▍| 17/18 [00:01<00:00,  8.65it/s]100%|██████████| 18/18 [00:05<00:00,  1.24s/it]100%|██████████| 18/18 [00:05<00:00,  3.09it/s]
2025-03-13 16:53:38,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:38
2025-03-13 16:54:25,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3587 secs
2025-03-13 16:54:25,532 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 16:54:25,532 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 16:54:49,875 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3428 secs
2025-03-13 16:54:49,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5344 secs
2025-03-13 16:54:49,879 [INFO]: {
2025-03-13 16:54:49,879 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:49,879 [INFO]: 	index_param: efSearch=99
2025-03-13 16:54:49,879 [INFO]: 	index_path: knn.index
2025-03-13 16:54:49,879 [INFO]: 	size in bytes: 882593650
2025-03-13 16:54:49,879 [INFO]: 	avg_search_speed_ms: 8.201928229214069
2025-03-13 16:54:49,880 [INFO]: 	99p_search_speed_ms: 18.030195045284923
2025-03-13 16:54:49,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:49,880 [INFO]: 	nb vectors: 4486
2025-03-13 16:54:49,880 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:49,880 [INFO]: 	compression ratio: 0.9993086716633414
2025-03-13 16:54:49,880 [INFO]: }
2025-03-13 16:54:49,880 [INFO]: 	>>> Finished "Creating the index" in 77.5361 secs
2025-03-13 16:54:49,880 [INFO]: >>> Finished "Launching the whole pipeline" in 77.5651 secs
2025-03-13 16:54:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 11887 [episode count 6/20]
[retrieval_preprocessing] for episode 43121 [episode count 7/20], we have num_retrieval=np.int64(4518) num_query=np.int64(149)
2025-03-13 16:54:52,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:53,278 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:53
2025-03-13 16:54:53,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.21it/s]
2025-03-13 16:54:53,303 [INFO]: There are 4518 embeddings of dim 49152
2025-03-13 16:54:53,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 16:54:53,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:53,304 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:54:53,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:53,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:53,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,304 [INFO]: 932.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:53,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:54:53,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:53
2025-03-13 16:54:53,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:53,304 [INFO]: 	Creating the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,304 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:53
2025-03-13 16:54:53,305 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:54:53,305 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,305 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:54:53,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.58it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.92it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.81it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.20it/s] 50%|█████     | 9/18 [00:00<00:00, 10.46it/s] 61%|██████    | 11/18 [00:01<00:00, 10.55it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.68it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.56it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.58it/s]100%|██████████| 18/18 [00:05<00:00,  3.28it/s]
2025-03-13 16:54:58,805 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:58
2025-03-13 16:55:42,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9692 secs
2025-03-13 16:55:42,775 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:55:42,775 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 16:56:32,391 [INFO]: 	>>> Finished "Compute fast metrics" in 49.6160 secs
2025-03-13 16:56:32,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.0887 secs
2025-03-13 16:56:32,394 [INFO]: {
2025-03-13 16:56:32,394 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:32,394 [INFO]: 	index_param: efSearch=169
2025-03-13 16:56:32,394 [INFO]: 	index_path: knn.index
2025-03-13 16:56:32,394 [INFO]: 	size in bytes: 888889390
2025-03-13 16:56:32,394 [INFO]: 	avg_search_speed_ms: 9.564235794000028
2025-03-13 16:56:32,394 [INFO]: 	99p_search_speed_ms: 13.651530048809937
2025-03-13 16:56:32,394 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:32,394 [INFO]: 	nb vectors: 4518
2025-03-13 16:56:32,394 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:32,394 [INFO]: 	compression ratio: 0.999308748639693
2025-03-13 16:56:32,394 [INFO]: }
2025-03-13 16:56:32,394 [INFO]: 	>>> Finished "Creating the index" in 99.0902 secs
2025-03-13 16:56:32,394 [INFO]: >>> Finished "Launching the whole pipeline" in 99.1160 secs
2025-03-13 16:56:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 43121 [episode count 7/20]
[retrieval_preprocessing] for episode 16064 [episode count 8/20], we have num_retrieval=np.int64(4516) num_query=np.int64(151)
2025-03-13 16:56:33,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:34,389 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:34
2025-03-13 16:56:34,389 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2055.02it/s]
2025-03-13 16:56:34,430 [INFO]: There are 4516 embeddings of dim 49152
2025-03-13 16:56:34,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 16:56:34,431 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:34
2025-03-13 16:56:34,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:34,431 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:56:34,431 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:34,432 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:56:34,432 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:34
2025-03-13 16:56:34,432 [INFO]: 932.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:34,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:56:34,433 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:34
2025-03-13 16:56:34,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:34,433 [INFO]: 	Creating the index 03/13/2025, 16:56:34
2025-03-13 16:56:34,433 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:34
2025-03-13 16:56:34,436 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:56:34,436 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:34
2025-03-13 16:56:34,436 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:56:34,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.42it/s] 50%|█████     | 9/18 [00:00<00:00, 44.54it/s] 83%|████████▎ | 15/18 [00:00<00:00, 50.54it/s]100%|██████████| 18/18 [00:04<00:00,  3.73it/s]
2025-03-13 16:56:39,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:39
2025-03-13 16:57:49,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.7262 secs
2025-03-13 16:57:49,996 [INFO]: The best hyperparameters are: efSearch=60
2025-03-13 16:57:49,996 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 16:58:11,455 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4586 secs
2025-03-13 16:58:11,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.0220 secs
2025-03-13 16:58:11,458 [INFO]: {
2025-03-13 16:58:11,458 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:11,458 [INFO]: 	index_param: efSearch=60
2025-03-13 16:58:11,459 [INFO]: 	index_path: knn.index
2025-03-13 16:58:11,459 [INFO]: 	size in bytes: 888495910
2025-03-13 16:58:11,459 [INFO]: 	avg_search_speed_ms: 6.067571915444258
2025-03-13 16:58:11,459 [INFO]: 	99p_search_speed_ms: 10.9569391189143
2025-03-13 16:58:11,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:11,459 [INFO]: 	nb vectors: 4516
2025-03-13 16:58:11,459 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:11,459 [INFO]: 	compression ratio: 0.9993087396429321
2025-03-13 16:58:11,459 [INFO]: }
2025-03-13 16:58:11,459 [INFO]: 	>>> Finished "Creating the index" in 97.0257 secs
2025-03-13 16:58:11,459 [INFO]: >>> Finished "Launching the whole pipeline" in 97.0694 secs
2025-03-13 16:58:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 16064 [episode count 8/20]
[retrieval_preprocessing] for episode 59084 [episode count 9/20], we have num_retrieval=np.int64(4518) num_query=np.int64(149)
2025-03-13 16:58:13,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:14,112 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:14
2025-03-13 16:58:14,112 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.66it/s]
2025-03-13 16:58:14,157 [INFO]: There are 4518 embeddings of dim 49152
2025-03-13 16:58:14,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0455 secs
2025-03-13 16:58:14,157 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:14
2025-03-13 16:58:14,157 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:14,157 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:58:14,157 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:14,157 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:14,157 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:14
2025-03-13 16:58:14,158 [INFO]: 932.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:14,158 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:58:14,158 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:14
2025-03-13 16:58:14,158 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:14,158 [INFO]: 	Creating the index 03/13/2025, 16:58:14
2025-03-13 16:58:14,158 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:14
2025-03-13 16:58:14,159 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:58:14,159 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:14
2025-03-13 16:58:14,159 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:58:14,159 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.91it/s] 33%|███▎      | 6/18 [00:00<00:00, 28.95it/s] 61%|██████    | 11/18 [00:00<00:00, 36.70it/s] 89%|████████▉ | 16/18 [00:00<00:00, 40.84it/s]100%|██████████| 18/18 [00:04<00:00,  3.74it/s]
2025-03-13 16:58:18,983 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:18
2025-03-13 16:59:14,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1776 secs
2025-03-13 16:59:14,162 [INFO]: The best hyperparameters are: efSearch=100
2025-03-13 16:59:14,162 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 16:59:44,198 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0362 secs
2025-03-13 16:59:44,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.0416 secs
2025-03-13 16:59:44,201 [INFO]: {
2025-03-13 16:59:44,201 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:44,201 [INFO]: 	index_param: efSearch=100
2025-03-13 16:59:44,201 [INFO]: 	index_path: knn.index
2025-03-13 16:59:44,201 [INFO]: 	size in bytes: 888889390
2025-03-13 16:59:44,201 [INFO]: 	avg_search_speed_ms: 9.244526471545
2025-03-13 16:59:44,201 [INFO]: 	99p_search_speed_ms: 22.773969459813102
2025-03-13 16:59:44,201 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:44,201 [INFO]: 	nb vectors: 4518
2025-03-13 16:59:44,201 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:44,201 [INFO]: 	compression ratio: 0.999308748639693
2025-03-13 16:59:44,201 [INFO]: }
2025-03-13 16:59:44,201 [INFO]: 	>>> Finished "Creating the index" in 90.0436 secs
2025-03-13 16:59:44,201 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0897 secs
2025-03-13 16:59:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 59084 [episode count 9/20]
[retrieval_preprocessing] for episode 20198 [episode count 10/20], we have num_retrieval=np.int64(4514) num_query=np.int64(153)
2025-03-13 16:59:46,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:46,978 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:46
2025-03-13 16:59:46,978 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 797.40it/s]
2025-03-13 16:59:47,024 [INFO]: There are 4514 embeddings of dim 49152
2025-03-13 16:59:47,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0458 secs
2025-03-13 16:59:47,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:47
2025-03-13 16:59:47,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:47,025 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:59:47,025 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:47,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:59:47,025 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:47
2025-03-13 16:59:47,026 [INFO]: 931.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:47,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 16:59:47,026 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:47
2025-03-13 16:59:47,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:47,027 [INFO]: 	Creating the index 03/13/2025, 16:59:47
2025-03-13 16:59:47,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:47
2025-03-13 16:59:47,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:59:47,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:47
2025-03-13 16:59:47,030 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:59:47,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.62it/s] 44%|████▍     | 8/18 [00:00<00:00, 39.13it/s] 78%|███████▊  | 14/18 [00:00<00:00, 44.67it/s]100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
2025-03-13 16:59:51,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:51
2025-03-13 17:00:42,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2018 secs
2025-03-13 17:00:42,425 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 17:00:42,425 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 17:01:18,205 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7801 secs
2025-03-13 17:01:18,208 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1782 secs
2025-03-13 17:01:18,209 [INFO]: {
2025-03-13 17:01:18,209 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:18,209 [INFO]: 	index_param: efSearch=135
2025-03-13 17:01:18,209 [INFO]: 	index_path: knn.index
2025-03-13 17:01:18,209 [INFO]: 	size in bytes: 888102430
2025-03-13 17:01:18,209 [INFO]: 	avg_search_speed_ms: 9.81078735233757
2025-03-13 17:01:18,209 [INFO]: 	99p_search_speed_ms: 13.830551402643312
2025-03-13 17:01:18,209 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:18,209 [INFO]: 	nb vectors: 4514
2025-03-13 17:01:18,209 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:18,209 [INFO]: 	compression ratio: 0.999308730638199
2025-03-13 17:01:18,209 [INFO]: }
2025-03-13 17:01:18,209 [INFO]: 	>>> Finished "Creating the index" in 91.1821 secs
2025-03-13 17:01:18,209 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2305 secs
2025-03-13 17:01:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 20198 [episode count 10/20]
[retrieval_preprocessing] for episode 21232 [episode count 11/20], we have num_retrieval=np.int64(4343) num_query=np.int64(324)
2025-03-13 17:01:22,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:22,996 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:22
2025-03-13 17:01:22,996 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 635.31it/s]
2025-03-13 17:01:23,049 [INFO]: There are 4343 embeddings of dim 49152
2025-03-13 17:01:23,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0531 secs
2025-03-13 17:01:23,049 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:23,050 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 17:01:23,050 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:23,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:01:23,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,051 [INFO]: 896.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:23,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:01:23,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:23
2025-03-13 17:01:23,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:23,051 [INFO]: 	Creating the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,051 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:23
2025-03-13 17:01:23,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:01:23,054 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:23
2025-03-13 17:01:23,055 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:01:23,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.12it/s] 39%|███▉      | 7/18 [00:00<00:00, 30.67it/s] 67%|██████▋   | 12/18 [00:00<00:00, 35.19it/s] 94%|█████████▍| 17/18 [00:00<00:00, 37.70it/s]100%|██████████| 18/18 [00:04<00:00,  3.85it/s]
2025-03-13 17:01:27,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:27
2025-03-13 17:02:09,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7584 secs
2025-03-13 17:02:09,501 [INFO]: The best hyperparameters are: efSearch=110
2025-03-13 17:02:09,501 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.45it/s]
2025-03-13 17:02:35,075 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5746 secs
2025-03-13 17:02:35,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0248 secs
2025-03-13 17:02:35,080 [INFO]: {
2025-03-13 17:02:35,080 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:35,080 [INFO]: 	index_param: efSearch=110
2025-03-13 17:02:35,080 [INFO]: 	index_path: knn.index
2025-03-13 17:02:35,080 [INFO]: 	size in bytes: 854459350
2025-03-13 17:02:35,080 [INFO]: 	avg_search_speed_ms: 13.591170050937723
2025-03-13 17:02:35,080 [INFO]: 	99p_search_speed_ms: 27.55469109397381
2025-03-13 17:02:35,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:35,080 [INFO]: 	nb vectors: 4343
2025-03-13 17:02:35,080 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:35,080 [INFO]: 	compression ratio: 0.9993085616068219
2025-03-13 17:02:35,080 [INFO]: }
2025-03-13 17:02:35,080 [INFO]: 	>>> Finished "Creating the index" in 72.0285 secs
2025-03-13 17:02:35,080 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0839 secs
2025-03-13 17:02:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 21232 [episode count 11/20]
[retrieval_preprocessing] for episode 8437 [episode count 12/20], we have num_retrieval=np.int64(4476) num_query=np.int64(191)
2025-03-13 17:02:38,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:39,572 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:39
2025-03-13 17:02:39,572 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1231.45it/s]
2025-03-13 17:02:39,624 [INFO]: There are 4476 embeddings of dim 49152
2025-03-13 17:02:39,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0522 secs
2025-03-13 17:02:39,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:39
2025-03-13 17:02:39,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:39,624 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:02:39,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:39,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:39,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:39
2025-03-13 17:02:39,625 [INFO]: 923.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:39,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:39,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:39
2025-03-13 17:02:39,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:39,625 [INFO]: 	Creating the index 03/13/2025, 17:02:39
2025-03-13 17:02:39,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:39
2025-03-13 17:02:39,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:02:39,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:39
2025-03-13 17:02:39,626 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:02:39,626 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.93it/s] 28%|██▊       | 5/18 [00:00<00:00, 17.41it/s] 50%|█████     | 9/18 [00:00<00:00, 23.64it/s] 72%|███████▏  | 13/18 [00:00<00:00, 27.55it/s] 94%|█████████▍| 17/18 [00:00<00:00, 30.53it/s]100%|██████████| 18/18 [00:05<00:00,  3.37it/s]
2025-03-13 17:02:44,975 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:44
2025-03-13 17:03:31,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8036 secs
2025-03-13 17:03:31,780 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 17:03:31,780 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.41it/s]
2025-03-13 17:04:02,942 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1621 secs
2025-03-13 17:04:02,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3186 secs
2025-03-13 17:04:02,945 [INFO]: {
2025-03-13 17:04:02,945 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:02,945 [INFO]: 	index_param: efSearch=144
2025-03-13 17:04:02,945 [INFO]: 	index_path: knn.index
2025-03-13 17:04:02,945 [INFO]: 	size in bytes: 880626250
2025-03-13 17:04:02,945 [INFO]: 	avg_search_speed_ms: 9.532996315954767
2025-03-13 17:04:02,945 [INFO]: 	99p_search_speed_ms: 13.660920886322856
2025-03-13 17:04:02,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:02,945 [INFO]: 	nb vectors: 4476
2025-03-13 17:04:02,945 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:02,945 [INFO]: 	compression ratio: 0.9993086261055698
2025-03-13 17:04:02,945 [INFO]: }
2025-03-13 17:04:02,945 [INFO]: 	>>> Finished "Creating the index" in 83.3202 secs
2025-03-13 17:04:02,945 [INFO]: >>> Finished "Launching the whole pipeline" in 83.3731 secs
2025-03-13 17:04:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 8437 [episode count 12/20]
[retrieval_preprocessing] for episode 43303 [episode count 13/20], we have num_retrieval=np.int64(4317) num_query=np.int64(350)
2025-03-13 17:04:04,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:05,295 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:05
2025-03-13 17:04:05,295 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1072.44it/s]
2025-03-13 17:04:05,341 [INFO]: There are 4317 embeddings of dim 49152
2025-03-13 17:04:05,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0468 secs
2025-03-13 17:04:05,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:05,342 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 17:04:05,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:05,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:04:05,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,343 [INFO]: 890.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:05,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:04:05,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:05
2025-03-13 17:04:05,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:05,344 [INFO]: 	Creating the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:05
2025-03-13 17:04:05,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:04:05,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:05
2025-03-13 17:04:05,347 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:04:05,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.63it/s] 41%|████      | 7/17 [00:00<00:00, 34.06it/s] 71%|███████   | 12/17 [00:00<00:00, 39.59it/s]100%|██████████| 17/17 [00:04<00:00,  3.00it/s]100%|██████████| 17/17 [00:04<00:00,  4.21it/s]
2025-03-13 17:04:09,394 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:09
2025-03-13 17:04:53,357 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9629 secs
2025-03-13 17:04:53,358 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:04:53,358 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-13 17:05:30,900 [INFO]: 	>>> Finished "Compute fast metrics" in 37.5417 secs
2025-03-13 17:05:30,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5545 secs
2025-03-13 17:05:30,902 [INFO]: {
2025-03-13 17:05:30,902 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:30,902 [INFO]: 	index_param: efSearch=156
2025-03-13 17:05:30,902 [INFO]: 	index_path: knn.index
2025-03-13 17:05:30,902 [INFO]: 	size in bytes: 849343930
2025-03-13 17:05:30,902 [INFO]: 	avg_search_speed_ms: 8.45577934676575
2025-03-13 17:05:30,902 [INFO]: 	99p_search_speed_ms: 11.618714877404285
2025-03-13 17:05:30,902 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:30,902 [INFO]: 	nb vectors: 4317
2025-03-13 17:05:30,902 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:30,902 [INFO]: 	compression ratio: 0.9993086499128804
2025-03-13 17:05:30,902 [INFO]: }
2025-03-13 17:05:30,902 [INFO]: 	>>> Finished "Creating the index" in 85.5584 secs
2025-03-13 17:05:30,902 [INFO]: >>> Finished "Launching the whole pipeline" in 85.6075 secs
2025-03-13 17:05:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 43303 [episode count 13/20]
[retrieval_preprocessing] for episode 33089 [episode count 14/20], we have num_retrieval=np.int64(4108) num_query=np.int64(559)
2025-03-13 17:05:33,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:34,502 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:34
2025-03-13 17:05:34,502 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1023.25it/s]
2025-03-13 17:05:34,546 [INFO]: There are 4108 embeddings of dim 49152
2025-03-13 17:05:34,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0446 secs
2025-03-13 17:05:34,547 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:34,547 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:05:34,547 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:34,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:34,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,547 [INFO]: 847.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:34,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:05:34,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:34
2025-03-13 17:05:34,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:34,547 [INFO]: 	Creating the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,547 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:34
2025-03-13 17:05:34,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:05:34,548 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,548 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:05:34,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.31it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.67it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.79it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.40it/s]100%|██████████| 17/17 [00:04<00:00,  3.70it/s]
2025-03-13 17:05:39,736 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:39
2025-03-13 17:06:25,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9329 secs
2025-03-13 17:06:25,669 [INFO]: The best hyperparameters are: efSearch=98
2025-03-13 17:06:25,670 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.12it/s]
2025-03-13 17:06:55,324 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6546 secs
2025-03-13 17:06:55,327 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.7789 secs
2025-03-13 17:06:55,327 [INFO]: {
2025-03-13 17:06:55,327 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:55,327 [INFO]: 	index_param: efSearch=98
2025-03-13 17:06:55,327 [INFO]: 	index_path: knn.index
2025-03-13 17:06:55,327 [INFO]: 	size in bytes: 808224430
2025-03-13 17:06:55,327 [INFO]: 	avg_search_speed_ms: 10.68506529654225
2025-03-13 17:06:55,327 [INFO]: 	99p_search_speed_ms: 15.17551733413711
2025-03-13 17:06:55,327 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:55,327 [INFO]: 	nb vectors: 4108
2025-03-13 17:06:55,327 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:55,327 [INFO]: 	compression ratio: 0.9993086499501135
2025-03-13 17:06:55,327 [INFO]: }
2025-03-13 17:06:55,327 [INFO]: 	>>> Finished "Creating the index" in 80.7802 secs
2025-03-13 17:06:55,327 [INFO]: >>> Finished "Launching the whole pipeline" in 80.8257 secs
2025-03-13 17:06:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 33089 [episode count 14/20]
[retrieval_preprocessing] for episode 8004 [episode count 15/20], we have num_retrieval=np.int64(4500) num_query=np.int64(167)
2025-03-13 17:06:59,068 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:59,955 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:59
2025-03-13 17:06:59,955 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 722.28it/s]
2025-03-13 17:07:00,007 [INFO]: There are 4500 embeddings of dim 49152
2025-03-13 17:07:00,007 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0523 secs
2025-03-13 17:07:00,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:00
2025-03-13 17:07:00,008 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:00,008 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:07:00,008 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:00,008 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:07:00,008 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:00
2025-03-13 17:07:00,008 [INFO]: 928.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:00,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:07:00,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:00
2025-03-13 17:07:00,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:00,009 [INFO]: 	Creating the index 03/13/2025, 17:07:00
2025-03-13 17:07:00,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:00
2025-03-13 17:07:00,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:07:00,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:00
2025-03-13 17:07:00,013 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:07:00,013 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.61it/s] 28%|██▊       | 5/18 [00:00<00:00, 24.50it/s] 50%|█████     | 9/18 [00:00<00:00, 29.56it/s] 72%|███████▏  | 13/18 [00:00<00:00, 32.17it/s] 94%|█████████▍| 17/18 [00:00<00:00, 32.67it/s]100%|██████████| 18/18 [00:06<00:00,  2.68it/s]
2025-03-13 17:07:06,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:06
2025-03-13 17:07:49,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9315 secs
2025-03-13 17:07:49,677 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 17:07:49,677 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.34it/s]
2025-03-13 17:08:27,860 [INFO]: 	>>> Finished "Compute fast metrics" in 38.1828 secs
2025-03-13 17:08:27,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.8508 secs
2025-03-13 17:08:27,864 [INFO]: {
2025-03-13 17:08:27,864 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:27,864 [INFO]: 	index_param: efSearch=140
2025-03-13 17:08:27,864 [INFO]: 	index_path: knn.index
2025-03-13 17:08:27,864 [INFO]: 	size in bytes: 885348070
2025-03-13 17:08:27,864 [INFO]: 	avg_search_speed_ms: 11.689645493627204
2025-03-13 17:08:27,864 [INFO]: 	99p_search_speed_ms: 16.865419340319935
2025-03-13 17:08:27,864 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:27,864 [INFO]: 	nb vectors: 4500
2025-03-13 17:08:27,864 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:27,864 [INFO]: 	compression ratio: 0.9993086673809545
2025-03-13 17:08:27,864 [INFO]: }
2025-03-13 17:08:27,864 [INFO]: 	>>> Finished "Creating the index" in 87.8545 secs
2025-03-13 17:08:27,864 [INFO]: >>> Finished "Launching the whole pipeline" in 87.9090 secs
2025-03-13 17:08:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 8004 [episode count 15/20]
[retrieval_preprocessing] for episode 47001 [episode count 16/20], we have num_retrieval=np.int64(4503) num_query=np.int64(164)
2025-03-13 17:08:30,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:31,402 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:31
2025-03-13 17:08:31,403 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 838.86it/s]
2025-03-13 17:08:31,464 [INFO]: There are 4503 embeddings of dim 49152
2025-03-13 17:08:31,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0617 secs
2025-03-13 17:08:31,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:31
2025-03-13 17:08:31,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:31,465 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:08:31,465 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:31,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:08:31,465 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:31
2025-03-13 17:08:31,465 [INFO]: 929.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:31,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:08:31,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:31
2025-03-13 17:08:31,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:31,465 [INFO]: 	Creating the index 03/13/2025, 17:08:31
2025-03-13 17:08:31,465 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:31
2025-03-13 17:08:31,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:08:31,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:31
2025-03-13 17:08:31,467 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:08:31,467 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.90it/s] 28%|██▊       | 5/18 [00:00<00:00, 17.23it/s] 44%|████▍     | 8/18 [00:00<00:00, 21.46it/s] 67%|██████▋   | 12/18 [00:00<00:00, 25.13it/s] 89%|████████▉ | 16/18 [00:00<00:00, 27.28it/s]100%|██████████| 18/18 [00:05<00:00,  3.30it/s]
2025-03-13 17:08:36,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:36
2025-03-13 17:09:26,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8726 secs
2025-03-13 17:09:26,794 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:09:26,794 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.76it/s]
2025-03-13 17:10:00,931 [INFO]: 	>>> Finished "Compute fast metrics" in 34.1371 secs
2025-03-13 17:10:01,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.1959 secs
2025-03-13 17:10:01,663 [INFO]: {
2025-03-13 17:10:01,663 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:01,663 [INFO]: 	index_param: efSearch=138
2025-03-13 17:10:01,663 [INFO]: 	index_path: knn.index
2025-03-13 17:10:01,663 [INFO]: 	size in bytes: 885938290
2025-03-13 17:10:01,664 [INFO]: 	avg_search_speed_ms: 10.20259125234217
2025-03-13 17:10:01,664 [INFO]: 	99p_search_speed_ms: 16.980343421455473
2025-03-13 17:10:01,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:01,664 [INFO]: 	nb vectors: 4503
2025-03-13 17:10:01,664 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:01,664 [INFO]: 	compression ratio: 0.9993086809691903
2025-03-13 17:10:01,664 [INFO]: }
2025-03-13 17:10:01,664 [INFO]: 	>>> Finished "Creating the index" in 90.1988 secs
2025-03-13 17:10:01,664 [INFO]: >>> Finished "Launching the whole pipeline" in 90.2614 secs
2025-03-13 17:10:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 47001 [episode count 16/20]
[retrieval_preprocessing] for episode 92060 [episode count 17/20], we have num_retrieval=np.int64(4327) num_query=np.int64(340)
2025-03-13 17:10:03,724 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:04,458 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:04
2025-03-13 17:10:04,459 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.53it/s]
2025-03-13 17:10:04,496 [INFO]: There are 4327 embeddings of dim 49152
2025-03-13 17:10:04,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0381 secs
2025-03-13 17:10:04,497 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:04
2025-03-13 17:10:04,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:04,497 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 17:10:04,497 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:04,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:10:04,497 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:04
2025-03-13 17:10:04,497 [INFO]: 893.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:04,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:10:04,497 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:04
2025-03-13 17:10:04,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:04,497 [INFO]: 	Creating the index 03/13/2025, 17:10:04
2025-03-13 17:10:04,497 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:04
2025-03-13 17:10:04,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:10:04,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:04
2025-03-13 17:10:04,499 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:10:04,499 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.14it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.31it/s] 61%|██████    | 11/18 [00:00<00:00, 33.73it/s] 89%|████████▉ | 16/18 [00:00<00:00, 37.26it/s]100%|██████████| 18/18 [00:03<00:00,  4.65it/s]
2025-03-13 17:10:08,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:08
2025-03-13 17:10:50,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7842 secs
2025-03-13 17:10:50,156 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:10:50,156 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.69it/s]
2025-03-13 17:11:30,474 [INFO]: 	>>> Finished "Compute fast metrics" in 40.3177 secs
2025-03-13 17:11:30,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.2360 secs
2025-03-13 17:11:30,735 [INFO]: {
2025-03-13 17:11:30,735 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:30,735 [INFO]: 	index_param: efSearch=169
2025-03-13 17:11:30,735 [INFO]: 	index_path: knn.index
2025-03-13 17:11:30,735 [INFO]: 	size in bytes: 851311390
2025-03-13 17:11:30,735 [INFO]: 	avg_search_speed_ms: 12.275605801881456
2025-03-13 17:11:30,735 [INFO]: 	99p_search_speed_ms: 17.512760595418513
2025-03-13 17:11:30,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:30,735 [INFO]: 	nb vectors: 4327
2025-03-13 17:11:30,735 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:30,735 [INFO]: 	compression ratio: 0.9993086266589244
2025-03-13 17:11:30,736 [INFO]: }
2025-03-13 17:11:30,736 [INFO]: 	>>> Finished "Creating the index" in 86.2383 secs
2025-03-13 17:11:30,736 [INFO]: >>> Finished "Launching the whole pipeline" in 86.2771 secs
2025-03-13 17:11:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 92060 [episode count 17/20]
[retrieval_preprocessing] for episode 74143 [episode count 18/20], we have num_retrieval=np.int64(4351) num_query=np.int64(316)
2025-03-13 17:11:35,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:36,841 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:36
2025-03-13 17:11:36,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.80it/s]
2025-03-13 17:11:36,893 [INFO]: There are 4351 embeddings of dim 49152
2025-03-13 17:11:36,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0521 secs
2025-03-13 17:11:36,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:36
2025-03-13 17:11:36,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:36,894 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 17:11:36,894 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:36,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:36,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:36
2025-03-13 17:11:36,894 [INFO]: 897.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:36,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:11:36,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:36
2025-03-13 17:11:36,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:36,894 [INFO]: 	Creating the index 03/13/2025, 17:11:36
2025-03-13 17:11:36,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:36
2025-03-13 17:11:36,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:11:36,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:36
2025-03-13 17:11:36,896 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:11:36,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.84it/s] 28%|██▊       | 5/18 [00:00<00:00, 19.90it/s] 50%|█████     | 9/18 [00:00<00:00, 25.88it/s] 72%|███████▏  | 13/18 [00:00<00:00, 29.38it/s] 94%|█████████▍| 17/18 [00:00<00:00, 32.36it/s]100%|██████████| 18/18 [00:04<00:00,  3.84it/s]
2025-03-13 17:11:41,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:41
2025-03-13 17:12:39,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.5609 secs
2025-03-13 17:12:39,155 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 17:12:39,155 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 17:13:03,749 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5941 secs
2025-03-13 17:13:03,752 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.8563 secs
2025-03-13 17:13:03,752 [INFO]: {
2025-03-13 17:13:03,752 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:03,752 [INFO]: 	index_param: efSearch=146
2025-03-13 17:13:03,752 [INFO]: 	index_path: knn.index
2025-03-13 17:13:03,752 [INFO]: 	size in bytes: 856033330
2025-03-13 17:13:03,752 [INFO]: 	avg_search_speed_ms: 11.454349183418786
2025-03-13 17:13:03,752 [INFO]: 	99p_search_speed_ms: 18.375055119395245
2025-03-13 17:13:03,752 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:03,752 [INFO]: 	nb vectors: 4351
2025-03-13 17:13:03,752 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:03,752 [INFO]: 	compression ratio: 0.9993085292601867
2025-03-13 17:13:03,752 [INFO]: }
2025-03-13 17:13:03,752 [INFO]: 	>>> Finished "Creating the index" in 86.8580 secs
2025-03-13 17:13:03,753 [INFO]: >>> Finished "Launching the whole pipeline" in 86.9109 secs
2025-03-13 17:13:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 74143 [episode count 18/20]
[retrieval_preprocessing] for episode 14757 [episode count 19/20], we have num_retrieval=np.int64(4460) num_query=np.int64(207)
2025-03-13 17:13:07,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:08,205 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:08
2025-03-13 17:13:08,205 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.12it/s]
2025-03-13 17:13:08,256 [INFO]: There are 4460 embeddings of dim 49152
2025-03-13 17:13:08,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0514 secs
2025-03-13 17:13:08,256 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:08,257 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 17:13:08,257 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:08,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:13:08,257 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,258 [INFO]: 920.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:08,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 17:13:08,258 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:08
2025-03-13 17:13:08,259 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:08,259 [INFO]: 	Creating the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,259 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:08
2025-03-13 17:13:08,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:13:08,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,263 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:13:08,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.08it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.85it/s] 67%|██████▋   | 12/18 [00:00<00:00, 39.41it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.28it/s]100%|██████████| 18/18 [00:04<00:00,  4.46it/s]
2025-03-13 17:13:12,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:12
2025-03-13 17:13:54,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4379 secs
2025-03-13 17:13:54,746 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:13:54,746 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.99it/s]
2025-03-13 17:14:23,164 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4173 secs
2025-03-13 17:14:23,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.9045 secs
2025-03-13 17:14:23,168 [INFO]: {
2025-03-13 17:14:23,168 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:23,168 [INFO]: 	index_param: efSearch=156
2025-03-13 17:14:23,168 [INFO]: 	index_path: knn.index
2025-03-13 17:14:23,168 [INFO]: 	size in bytes: 877478350
2025-03-13 17:14:23,168 [INFO]: 	avg_search_speed_ms: 11.581008867425327
2025-03-13 17:14:23,168 [INFO]: 	99p_search_speed_ms: 16.845002144109458
2025-03-13 17:14:23,168 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:23,168 [INFO]: 	nb vectors: 4460
2025-03-13 17:14:23,168 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:23,168 [INFO]: 	compression ratio: 0.9993086211186862
2025-03-13 17:14:23,168 [INFO]: }
2025-03-13 17:14:23,168 [INFO]: 	>>> Finished "Creating the index" in 74.9086 secs
2025-03-13 17:14:23,168 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9631 secs
2025-03-13 17:14:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 14757 [episode count 19/20]
2025-03-13 17:14:25: [retrieval_preprocessing] finished for 4846810092_hang_cloth_on_stand [chosen_id count 4/196]
2025-03-13 17:14:26: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4846810092_put_cloth_on_table [chosen_id count 5/196]
2025-03-13 17:14:26: [retrieval_preprocessing] we have num_total=2505 embedding_dim=49152
[retrieval_preprocessing] for episode 28163 [episode count 0/20], we have num_retrieval=np.int64(2389) num_query=np.int64(116)
2025-03-13 17:14:26,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:27,346 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:27
2025-03-13 17:14:27,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 914.79it/s]
2025-03-13 17:14:27,387 [INFO]: There are 2389 embeddings of dim 49152
2025-03-13 17:14:27,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 17:14:27,388 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:27,388 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:14:27,388 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:27,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:14:27,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,389 [INFO]: 493.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:27,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:14:27,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:27
2025-03-13 17:14:27,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:27,390 [INFO]: 	Creating the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:27
2025-03-13 17:14:27,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:14:27,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,393 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:14:27,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.38it/s] 30%|███       | 3/10 [00:00<00:00, 13.83it/s] 60%|██████    | 6/10 [00:00<00:00, 20.05it/s]100%|██████████| 10/10 [00:03<00:00,  2.53it/s]100%|██████████| 10/10 [00:03<00:00,  3.22it/s]
2025-03-13 17:14:30,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:30
2025-03-13 17:15:06,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3025 secs
2025-03-13 17:15:06,811 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:15:06,811 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.65it/s]
2025-03-13 17:15:35,034 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2236 secs
2025-03-13 17:15:35,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6427 secs
2025-03-13 17:15:35,036 [INFO]: {
2025-03-13 17:15:35,036 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:35,036 [INFO]: 	index_param: efSearch=138
2025-03-13 17:15:35,036 [INFO]: 	index_path: knn.index
2025-03-13 17:15:35,036 [INFO]: 	size in bytes: 470020930
2025-03-13 17:15:35,036 [INFO]: 	avg_search_speed_ms: 6.433136694259055
2025-03-13 17:15:35,036 [INFO]: 	99p_search_speed_ms: 9.061978999525309
2025-03-13 17:15:35,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:35,036 [INFO]: 	nb vectors: 2389
2025-03-13 17:15:35,036 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:35,036 [INFO]: 	compression ratio: 0.999309779673003
2025-03-13 17:15:35,036 [INFO]: }
2025-03-13 17:15:35,036 [INFO]: 	>>> Finished "Creating the index" in 67.6464 secs
2025-03-13 17:15:35,036 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6901 secs
2025-03-13 17:15:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 28163 [episode count 0/20]
[retrieval_preprocessing] for episode 77316 [episode count 1/20], we have num_retrieval=np.int64(2380) num_query=np.int64(125)
2025-03-13 17:15:35,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:36,187 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:36
2025-03-13 17:15:36,187 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2263.52it/s]
2025-03-13 17:15:36,219 [INFO]: There are 2380 embeddings of dim 49152
2025-03-13 17:15:36,219 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:15:36,219 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:36
2025-03-13 17:15:36,220 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:36,220 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:15:36,220 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:36,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:15:36,220 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:36
2025-03-13 17:15:36,220 [INFO]: 491.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:36,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:15:36,221 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:36
2025-03-13 17:15:36,221 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:36,221 [INFO]: 	Creating the index 03/13/2025, 17:15:36
2025-03-13 17:15:36,221 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:36
2025-03-13 17:15:36,223 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:15:36,223 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:36
2025-03-13 17:15:36,223 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:15:36,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.94it/s] 60%|██████    | 6/10 [00:00<00:00, 28.54it/s]100%|██████████| 10/10 [00:01<00:00,  4.29it/s]100%|██████████| 10/10 [00:01<00:00,  5.25it/s]
2025-03-13 17:15:38,134 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:38
2025-03-13 17:16:21,054 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9199 secs
2025-03-13 17:16:21,054 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 17:16:21,054 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.80it/s]
2025-03-13 17:16:42,997 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9427 secs
2025-03-13 17:16:42,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7758 secs
2025-03-13 17:16:42,999 [INFO]: {
2025-03-13 17:16:42,999 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:42,999 [INFO]: 	index_param: efSearch=136
2025-03-13 17:16:42,999 [INFO]: 	index_path: knn.index
2025-03-13 17:16:42,999 [INFO]: 	size in bytes: 468250270
2025-03-13 17:16:42,999 [INFO]: 	avg_search_speed_ms: 10.11179561945219
2025-03-13 17:16:42,999 [INFO]: 	99p_search_speed_ms: 14.418234555050732
2025-03-13 17:16:42,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:42,999 [INFO]: 	nb vectors: 2380
2025-03-13 17:16:42,999 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:42,999 [INFO]: 	compression ratio: 0.9993097067514771
2025-03-13 17:16:42,999 [INFO]: }
2025-03-13 17:16:42,999 [INFO]: 	>>> Finished "Creating the index" in 66.7785 secs
2025-03-13 17:16:42,999 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8120 secs
2025-03-13 17:16:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 77316 [episode count 1/20]
[retrieval_preprocessing] for episode 19527 [episode count 2/20], we have num_retrieval=np.int64(2414) num_query=np.int64(91)
2025-03-13 17:16:45,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:46,149 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:46
2025-03-13 17:16:46,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.84it/s]
2025-03-13 17:16:46,187 [INFO]: There are 2414 embeddings of dim 49152
2025-03-13 17:16:46,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 17:16:46,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:46
2025-03-13 17:16:46,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:46,187 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:16:46,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:46,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:46,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:46
2025-03-13 17:16:46,187 [INFO]: 498.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:46,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:16:46,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:46
2025-03-13 17:16:46,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:46,188 [INFO]: 	Creating the index 03/13/2025, 17:16:46
2025-03-13 17:16:46,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:46
2025-03-13 17:16:46,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:16:46,189 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:46
2025-03-13 17:16:46,189 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:16:46,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.88it/s] 50%|█████     | 5/10 [00:00<00:00, 25.99it/s] 90%|█████████ | 9/10 [00:00<00:00, 32.05it/s]100%|██████████| 10/10 [00:02<00:00,  3.44it/s]
2025-03-13 17:16:49,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:49
2025-03-13 17:17:27,799 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6992 secs
2025-03-13 17:17:27,799 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:17:27,800 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 17:17:52,543 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7429 secs
2025-03-13 17:17:52,545 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3559 secs
2025-03-13 17:17:52,545 [INFO]: {
2025-03-13 17:17:52,545 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:52,545 [INFO]: 	index_param: efSearch=169
2025-03-13 17:17:52,545 [INFO]: 	index_path: knn.index
2025-03-13 17:17:52,545 [INFO]: 	size in bytes: 474939550
2025-03-13 17:17:52,545 [INFO]: 	avg_search_speed_ms: 9.090776304206388
2025-03-13 17:17:52,545 [INFO]: 	99p_search_speed_ms: 13.772839037701486
2025-03-13 17:17:52,545 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:52,545 [INFO]: 	nb vectors: 2414
2025-03-13 17:17:52,545 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:52,545 [INFO]: 	compression ratio: 0.9993097268905063
2025-03-13 17:17:52,545 [INFO]: }
2025-03-13 17:17:52,545 [INFO]: 	>>> Finished "Creating the index" in 66.3574 secs
2025-03-13 17:17:52,545 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3955 secs
2025-03-13 17:17:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 19527 [episode count 2/20]
[retrieval_preprocessing] for episode 32350 [episode count 3/20], we have num_retrieval=np.int64(2376) num_query=np.int64(129)
2025-03-13 17:17:54,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:54,993 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:54
2025-03-13 17:17:54,994 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1218.21it/s]
2025-03-13 17:17:55,027 [INFO]: There are 2376 embeddings of dim 49152
2025-03-13 17:17:55,027 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 17:17:55,027 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:55
2025-03-13 17:17:55,027 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:55,027 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:17:55,027 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:55,027 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:55,027 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:55
2025-03-13 17:17:55,027 [INFO]: 490.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:55,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:17:55,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:55
2025-03-13 17:17:55,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:55,027 [INFO]: 	Creating the index 03/13/2025, 17:17:55
2025-03-13 17:17:55,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:55
2025-03-13 17:17:55,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:17:55,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:55
2025-03-13 17:17:55,029 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:17:55,029 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.68it/s] 70%|███████   | 7/10 [00:00<00:00, 33.21it/s]100%|██████████| 10/10 [00:02<00:00,  4.78it/s]
2025-03-13 17:17:57,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:57
2025-03-13 17:18:28,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6410 secs
2025-03-13 17:18:28,767 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 17:18:28,767 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.40it/s]
2025-03-13 17:18:50,241 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4738 secs
2025-03-13 17:18:50,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2140 secs
2025-03-13 17:18:50,243 [INFO]: {
2025-03-13 17:18:50,243 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:50,243 [INFO]: 	index_param: efSearch=191
2025-03-13 17:18:50,243 [INFO]: 	index_path: knn.index
2025-03-13 17:18:50,243 [INFO]: 	size in bytes: 467463310
2025-03-13 17:18:50,243 [INFO]: 	avg_search_speed_ms: 10.132267089841818
2025-03-13 17:18:50,243 [INFO]: 	99p_search_speed_ms: 14.052538159303364
2025-03-13 17:18:50,243 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:50,243 [INFO]: 	nb vectors: 2376
2025-03-13 17:18:50,243 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:50,243 [INFO]: 	compression ratio: 0.9993096741645885
2025-03-13 17:18:50,243 [INFO]: }
2025-03-13 17:18:50,243 [INFO]: 	>>> Finished "Creating the index" in 55.2155 secs
2025-03-13 17:18:50,243 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2493 secs
2025-03-13 17:18:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 32350 [episode count 3/20]
[retrieval_preprocessing] for episode 50811 [episode count 4/20], we have num_retrieval=np.int64(2400) num_query=np.int64(105)
2025-03-13 17:18:52,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:52,929 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:52
2025-03-13 17:18:52,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.50it/s]100%|██████████| 1/1 [00:00<00:00,  1.50it/s]
2025-03-13 17:18:53,635 [INFO]: There are 2400 embeddings of dim 49152
2025-03-13 17:18:53,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7062 secs
2025-03-13 17:18:53,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:53
2025-03-13 17:18:53,636 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:53,636 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:18:53,636 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:53,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 17:18:53,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:53
2025-03-13 17:18:53,637 [INFO]: 495.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:53,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:18:53,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:53
2025-03-13 17:18:53,638 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:53,638 [INFO]: 	Creating the index 03/13/2025, 17:18:53
2025-03-13 17:18:53,638 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:53
2025-03-13 17:18:53,641 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:18:53,641 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:53
2025-03-13 17:18:53,641 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:18:53,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.18it/s] 70%|███████   | 7/10 [00:00<00:00, 33.96it/s]100%|██████████| 10/10 [00:02<00:00,  4.61it/s]
2025-03-13 17:18:55,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:55
2025-03-13 17:19:33,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7837 secs
2025-03-13 17:19:33,603 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:19:33,603 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 17:19:57,773 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1701 secs
2025-03-13 17:19:57,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1336 secs
2025-03-13 17:19:57,775 [INFO]: {
2025-03-13 17:19:57,775 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:57,775 [INFO]: 	index_param: efSearch=200
2025-03-13 17:19:57,775 [INFO]: 	index_path: knn.index
2025-03-13 17:19:57,775 [INFO]: 	size in bytes: 472185130
2025-03-13 17:19:57,775 [INFO]: 	avg_search_speed_ms: 10.806337950879922
2025-03-13 17:19:57,775 [INFO]: 	99p_search_speed_ms: 15.355742012616247
2025-03-13 17:19:57,775 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:57,775 [INFO]: 	nb vectors: 2400
2025-03-13 17:19:57,775 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:57,775 [INFO]: 	compression ratio: 0.9993097410754972
2025-03-13 17:19:57,775 [INFO]: }
2025-03-13 17:19:57,775 [INFO]: 	>>> Finished "Creating the index" in 64.1376 secs
2025-03-13 17:19:57,775 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8467 secs
2025-03-13 17:19:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 50811 [episode count 4/20]
[retrieval_preprocessing] for episode 68264 [episode count 5/20], we have num_retrieval=np.int64(2386) num_query=np.int64(119)
2025-03-13 17:19:59,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:59,973 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:59
2025-03-13 17:19:59,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.90it/s]
2025-03-13 17:20:00,009 [INFO]: There are 2386 embeddings of dim 49152
2025-03-13 17:20:00,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 17:20:00,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:00
2025-03-13 17:20:00,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:00,011 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:20:00,011 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:00,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:20:00,011 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:00
2025-03-13 17:20:00,011 [INFO]: 492.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:00,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:20:00,012 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:00
2025-03-13 17:20:00,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:00,012 [INFO]: 	Creating the index 03/13/2025, 17:20:00
2025-03-13 17:20:00,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:00
2025-03-13 17:20:00,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:20:00,016 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:00
2025-03-13 17:20:00,016 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:20:00,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.75it/s] 70%|███████   | 7/10 [00:00<00:00, 31.48it/s]100%|██████████| 10/10 [00:02<00:00,  3.88it/s]
2025-03-13 17:20:02,600 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:02
2025-03-13 17:20:31,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3453 secs
2025-03-13 17:20:31,946 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:20:31,946 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 17:20:52,712 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7665 secs
2025-03-13 17:20:52,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6989 secs
2025-03-13 17:20:52,715 [INFO]: {
2025-03-13 17:20:52,715 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:52,715 [INFO]: 	index_param: efSearch=168
2025-03-13 17:20:52,715 [INFO]: 	index_path: knn.index
2025-03-13 17:20:52,715 [INFO]: 	size in bytes: 469430710
2025-03-13 17:20:52,715 [INFO]: 	avg_search_speed_ms: 10.930646543124666
2025-03-13 17:20:52,715 [INFO]: 	99p_search_speed_ms: 15.876698901411146
2025-03-13 17:20:52,715 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:52,715 [INFO]: 	nb vectors: 2386
2025-03-13 17:20:52,715 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:52,715 [INFO]: 	compression ratio: 0.9993097554269511
2025-03-13 17:20:52,715 [INFO]: }
2025-03-13 17:20:52,715 [INFO]: 	>>> Finished "Creating the index" in 52.7032 secs
2025-03-13 17:20:52,715 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7424 secs
2025-03-13 17:20:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 68264 [episode count 5/20]
[retrieval_preprocessing] for episode 80055 [episode count 6/20], we have num_retrieval=np.int64(2378) num_query=np.int64(127)
2025-03-13 17:20:54,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:54,583 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:54
2025-03-13 17:20:54,583 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.90it/s]
2025-03-13 17:20:54,623 [INFO]: There are 2378 embeddings of dim 49152
2025-03-13 17:20:54,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0406 secs
2025-03-13 17:20:54,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:54,625 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:20:54,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:54,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:20:54,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,626 [INFO]: 490.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:54,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:20:54,626 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:54
2025-03-13 17:20:54,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:54,626 [INFO]: 	Creating the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:54
2025-03-13 17:20:54,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:20:54,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,630 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:20:54,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.61it/s] 50%|█████     | 5/10 [00:00<00:00, 23.66it/s] 90%|█████████ | 9/10 [00:00<00:00, 30.18it/s]100%|██████████| 10/10 [00:02<00:00,  3.76it/s]
2025-03-13 17:20:57,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:57
2025-03-13 17:21:35,533 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2355 secs
2025-03-13 17:21:35,533 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:21:35,533 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.83it/s]
2025-03-13 17:21:57,899 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3660 secs
2025-03-13 17:21:57,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2705 secs
2025-03-13 17:21:57,901 [INFO]: {
2025-03-13 17:21:57,901 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:57,901 [INFO]: 	index_param: efSearch=138
2025-03-13 17:21:57,901 [INFO]: 	index_path: knn.index
2025-03-13 17:21:57,901 [INFO]: 	size in bytes: 467856790
2025-03-13 17:21:57,901 [INFO]: 	avg_search_speed_ms: 8.898613365239454
2025-03-13 17:21:57,901 [INFO]: 	99p_search_speed_ms: 14.739561097230762
2025-03-13 17:21:57,901 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:57,901 [INFO]: 	nb vectors: 2378
2025-03-13 17:21:57,901 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:57,901 [INFO]: 	compression ratio: 0.999309690471736
2025-03-13 17:21:57,901 [INFO]: }
2025-03-13 17:21:57,901 [INFO]: 	>>> Finished "Creating the index" in 63.2749 secs
2025-03-13 17:21:57,901 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3179 secs
2025-03-13 17:21:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 80055 [episode count 6/20]
[retrieval_preprocessing] for episode 77002 [episode count 7/20], we have num_retrieval=np.int64(2365) num_query=np.int64(140)
2025-03-13 17:21:59,152 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:59,626 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:59
2025-03-13 17:21:59,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1345.62it/s]
2025-03-13 17:22:00,420 [INFO]: There are 2365 embeddings of dim 49152
2025-03-13 17:22:00,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7943 secs
2025-03-13 17:22:00,421 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:00,421 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:22:00,421 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:00,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:22:00,421 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,421 [INFO]: 488.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:00,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:22:00,421 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:00
2025-03-13 17:22:00,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:00,422 [INFO]: 	Creating the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,422 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:00
2025-03-13 17:22:00,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:22:00,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:00
2025-03-13 17:22:00,424 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:22:00,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.87it/s] 50%|█████     | 5/10 [00:00<00:00, 24.15it/s] 90%|█████████ | 9/10 [00:00<00:00, 29.21it/s]100%|██████████| 10/10 [00:02<00:00,  3.80it/s]
2025-03-13 17:22:03,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:03
2025-03-13 17:22:41,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5651 secs
2025-03-13 17:22:41,627 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 17:22:41,627 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.46it/s]
2025-03-13 17:22:57,424 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7969 secs
2025-03-13 17:22:57,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0025 secs
2025-03-13 17:22:57,426 [INFO]: {
2025-03-13 17:22:57,426 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:57,426 [INFO]: 	index_param: efSearch=181
2025-03-13 17:22:57,426 [INFO]: 	index_path: knn.index
2025-03-13 17:22:57,426 [INFO]: 	size in bytes: 465299170
2025-03-13 17:22:57,426 [INFO]: 	avg_search_speed_ms: 11.077113202303764
2025-03-13 17:22:57,426 [INFO]: 	99p_search_speed_ms: 14.657132104039192
2025-03-13 17:22:57,426 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:57,426 [INFO]: 	nb vectors: 2365
2025-03-13 17:22:57,426 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:57,426 [INFO]: 	compression ratio: 0.9993095839822796
2025-03-13 17:22:57,426 [INFO]: }
2025-03-13 17:22:57,426 [INFO]: 	>>> Finished "Creating the index" in 57.0049 secs
2025-03-13 17:22:57,426 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8001 secs
2025-03-13 17:22:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 77002 [episode count 7/20]
[retrieval_preprocessing] for episode 72925 [episode count 8/20], we have num_retrieval=np.int64(2409) num_query=np.int64(96)
2025-03-13 17:22:59,073 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:59,516 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:59
2025-03-13 17:22:59,516 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2125.85it/s]
2025-03-13 17:22:59,548 [INFO]: There are 2409 embeddings of dim 49152
2025-03-13 17:22:59,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 17:22:59,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:59,550 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:22:59,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:59,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:22:59,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,550 [INFO]: 497.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:59,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:22:59,551 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:59
2025-03-13 17:22:59,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:59,551 [INFO]: 	Creating the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,551 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:59
2025-03-13 17:22:59,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:22:59,554 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,554 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:22:59,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.14it/s] 70%|███████   | 7/10 [00:00<00:00, 35.07it/s]100%|██████████| 10/10 [00:02<00:00,  4.25it/s]
2025-03-13 17:23:01,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:01
2025-03-13 17:23:34,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6693 secs
2025-03-13 17:23:34,583 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 17:23:34,584 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.82it/s]
2025-03-13 17:24:00,363 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7791 secs
2025-03-13 17:24:00,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8105 secs
2025-03-13 17:24:00,365 [INFO]: {
2025-03-13 17:24:00,365 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:00,365 [INFO]: 	index_param: efSearch=113
2025-03-13 17:24:00,365 [INFO]: 	index_path: knn.index
2025-03-13 17:24:00,365 [INFO]: 	size in bytes: 473955850
2025-03-13 17:24:00,365 [INFO]: 	avg_search_speed_ms: 7.68681054113062
2025-03-13 17:24:00,365 [INFO]: 	99p_search_speed_ms: 10.496881091967225
2025-03-13 17:24:00,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:00,365 [INFO]: 	nb vectors: 2409
2025-03-13 17:24:00,365 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:00,365 [INFO]: 	compression ratio: 0.9993096867566884
2025-03-13 17:24:00,365 [INFO]: }
2025-03-13 17:24:00,365 [INFO]: 	>>> Finished "Creating the index" in 60.8139 secs
2025-03-13 17:24:00,365 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8490 secs
2025-03-13 17:24:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 72925 [episode count 8/20]
[retrieval_preprocessing] for episode 30434 [episode count 9/20], we have num_retrieval=np.int64(2392) num_query=np.int64(113)
2025-03-13 17:24:02,156 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:03,133 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:03
2025-03-13 17:24:03,133 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.07it/s]
2025-03-13 17:24:03,173 [INFO]: There are 2392 embeddings of dim 49152
2025-03-13 17:24:03,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 17:24:03,175 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:03
2025-03-13 17:24:03,175 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:03,175 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:24:03,175 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:03,176 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:24:03,176 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:03
2025-03-13 17:24:03,176 [INFO]: 493.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:03,177 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 17:24:03,177 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:03
2025-03-13 17:24:03,177 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:03,177 [INFO]: 	Creating the index 03/13/2025, 17:24:03
2025-03-13 17:24:03,178 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:03
2025-03-13 17:24:03,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 17:24:03,182 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:03
2025-03-13 17:24:03,182 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:24:03,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.89it/s] 70%|███████   | 7/10 [00:00<00:00, 32.67it/s]100%|██████████| 10/10 [00:02<00:00,  4.13it/s]
2025-03-13 17:24:05,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:05
2025-03-13 17:24:43,467 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8561 secs
2025-03-13 17:24:43,467 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 17:24:43,467 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 17:25:11,559 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0919 secs
2025-03-13 17:25:11,562 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3797 secs
2025-03-13 17:25:11,562 [INFO]: {
2025-03-13 17:25:11,562 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:11,562 [INFO]: 	index_param: efSearch=188
2025-03-13 17:25:11,562 [INFO]: 	index_path: knn.index
2025-03-13 17:25:11,562 [INFO]: 	size in bytes: 470611150
2025-03-13 17:25:11,562 [INFO]: 	avg_search_speed_ms: 11.682187459185702
2025-03-13 17:25:11,562 [INFO]: 	99p_search_speed_ms: 15.956750104669485
2025-03-13 17:25:11,562 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:11,562 [INFO]: 	nb vectors: 2392
2025-03-13 17:25:11,562 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:11,562 [INFO]: 	compression ratio: 0.9993098038582384
2025-03-13 17:25:11,562 [INFO]: }
2025-03-13 17:25:11,562 [INFO]: 	>>> Finished "Creating the index" in 68.3845 secs
2025-03-13 17:25:11,562 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4289 secs
2025-03-13 17:25:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 30434 [episode count 9/20]
[retrieval_preprocessing] for episode 61734 [episode count 10/20], we have num_retrieval=np.int64(2385) num_query=np.int64(120)
2025-03-13 17:25:12,898 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:13,708 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:13
2025-03-13 17:25:13,708 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2066.16it/s]
2025-03-13 17:25:13,749 [INFO]: There are 2385 embeddings of dim 49152
2025-03-13 17:25:13,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0418 secs
2025-03-13 17:25:13,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:13
2025-03-13 17:25:13,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:13,750 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:25:13,751 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:13,751 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:25:13,751 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:13
2025-03-13 17:25:13,751 [INFO]: 492.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:13,752 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:25:13,752 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:13
2025-03-13 17:25:13,752 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:13,752 [INFO]: 	Creating the index 03/13/2025, 17:25:13
2025-03-13 17:25:13,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:13
2025-03-13 17:25:13,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:25:13,756 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:13
2025-03-13 17:25:13,756 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:25:13,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.13it/s] 70%|███████   | 7/10 [00:00<00:00, 33.62it/s]100%|██████████| 10/10 [00:02<00:00,  4.46it/s]
2025-03-13 17:25:16,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:16
2025-03-13 17:26:07,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9973 secs
2025-03-13 17:26:07,003 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 17:26:07,003 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.15it/s]
2025-03-13 17:26:22,639 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6358 secs
2025-03-13 17:26:22,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8851 secs
2025-03-13 17:26:22,641 [INFO]: {
2025-03-13 17:26:22,641 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:22,641 [INFO]: 	index_param: efSearch=122
2025-03-13 17:26:22,641 [INFO]: 	index_path: knn.index
2025-03-13 17:26:22,641 [INFO]: 	size in bytes: 469233970
2025-03-13 17:26:22,641 [INFO]: 	avg_search_speed_ms: 10.727564566428953
2025-03-13 17:26:22,641 [INFO]: 	99p_search_speed_ms: 17.348069944418963
2025-03-13 17:26:22,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:22,641 [INFO]: 	nb vectors: 2385
2025-03-13 17:26:22,641 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:22,641 [INFO]: 	compression ratio: 0.9993097473313792
2025-03-13 17:26:22,641 [INFO]: }
2025-03-13 17:26:22,641 [INFO]: 	>>> Finished "Creating the index" in 68.8889 secs
2025-03-13 17:26:22,641 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9335 secs
2025-03-13 17:26:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 61734 [episode count 10/20]
[retrieval_preprocessing] for episode 86327 [episode count 11/20], we have num_retrieval=np.int64(2397) num_query=np.int64(108)
2025-03-13 17:26:23,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:24,306 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:24
2025-03-13 17:26:24,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.84it/s]
2025-03-13 17:26:24,344 [INFO]: There are 2397 embeddings of dim 49152
2025-03-13 17:26:24,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 17:26:24,344 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:24
2025-03-13 17:26:24,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:24,344 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:26:24,344 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:24,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:24,345 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:24
2025-03-13 17:26:24,345 [INFO]: 494.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:24,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:26:24,345 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:24
2025-03-13 17:26:24,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:24,345 [INFO]: 	Creating the index 03/13/2025, 17:26:24
2025-03-13 17:26:24,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:24
2025-03-13 17:26:24,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:26:24,346 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:24
2025-03-13 17:26:24,346 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:26:24,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.68it/s] 50%|█████     | 5/10 [00:00<00:00, 23.29it/s] 90%|█████████ | 9/10 [00:00<00:00, 28.70it/s]100%|██████████| 10/10 [00:03<00:00,  2.77it/s]
2025-03-13 17:26:27,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:27
2025-03-13 17:27:13,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6329 secs
2025-03-13 17:27:13,589 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 17:27:13,589 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 17:27:33,742 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1528 secs
2025-03-13 17:27:33,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3983 secs
2025-03-13 17:27:33,744 [INFO]: {
2025-03-13 17:27:33,744 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:33,744 [INFO]: 	index_param: efSearch=189
2025-03-13 17:27:33,745 [INFO]: 	index_path: knn.index
2025-03-13 17:27:33,745 [INFO]: 	size in bytes: 471594910
2025-03-13 17:27:33,745 [INFO]: 	avg_search_speed_ms: 11.611618418257324
2025-03-13 17:27:33,745 [INFO]: 	99p_search_speed_ms: 20.344450324773785
2025-03-13 17:27:33,745 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:33,745 [INFO]: 	nb vectors: 2397
2025-03-13 17:27:33,745 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:33,745 [INFO]: 	compression ratio: 0.9993097168924067
2025-03-13 17:27:33,745 [INFO]: }
2025-03-13 17:27:33,745 [INFO]: 	>>> Finished "Creating the index" in 69.3998 secs
2025-03-13 17:27:33,745 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4387 secs
2025-03-13 17:27:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 86327 [episode count 11/20]
[retrieval_preprocessing] for episode 95549 [episode count 12/20], we have num_retrieval=np.int64(2371) num_query=np.int64(134)
2025-03-13 17:27:36,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:37,197 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:37
2025-03-13 17:27:37,197 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1980.31it/s]
2025-03-13 17:27:37,247 [INFO]: There are 2371 embeddings of dim 49152
2025-03-13 17:27:37,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0501 secs
2025-03-13 17:27:37,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:37,248 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:27:37,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:37,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:27:37,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,248 [INFO]: 489.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:37,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:27:37,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:37
2025-03-13 17:27:37,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:37,248 [INFO]: 	Creating the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:37
2025-03-13 17:27:37,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:27:37,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:37
2025-03-13 17:27:37,250 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:27:37,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.38it/s] 60%|██████    | 6/10 [00:00<00:00, 27.58it/s]100%|██████████| 10/10 [00:02<00:00,  2.69it/s]100%|██████████| 10/10 [00:02<00:00,  3.34it/s]
2025-03-13 17:27:40,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:40
2025-03-13 17:28:16,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9584 secs
2025-03-13 17:28:16,208 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:28:16,208 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-13 17:28:43,775 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5669 secs
2025-03-13 17:28:43,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5263 secs
2025-03-13 17:28:43,777 [INFO]: {
2025-03-13 17:28:43,777 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:43,777 [INFO]: 	index_param: efSearch=212
2025-03-13 17:28:43,777 [INFO]: 	index_path: knn.index
2025-03-13 17:28:43,777 [INFO]: 	size in bytes: 466479610
2025-03-13 17:28:43,777 [INFO]: 	avg_search_speed_ms: 9.686510449605349
2025-03-13 17:28:43,777 [INFO]: 	99p_search_speed_ms: 13.726724451407787
2025-03-13 17:28:43,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:43,777 [INFO]: 	nb vectors: 2371
2025-03-13 17:28:43,777 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:43,777 [INFO]: 	compression ratio: 0.9993096332763612
2025-03-13 17:28:43,777 [INFO]: }
2025-03-13 17:28:43,777 [INFO]: 	>>> Finished "Creating the index" in 66.5287 secs
2025-03-13 17:28:43,777 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5797 secs
2025-03-13 17:28:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 95549 [episode count 12/20]
[retrieval_preprocessing] for episode 50013 [episode count 13/20], we have num_retrieval=np.int64(2301) num_query=np.int64(204)
2025-03-13 17:28:44,981 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:45,270 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:45
2025-03-13 17:28:45,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 959.79it/s]
2025-03-13 17:28:45,306 [INFO]: There are 2301 embeddings of dim 49152
2025-03-13 17:28:45,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 17:28:45,306 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:45
2025-03-13 17:28:45,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:45,307 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:28:45,307 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:45,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:28:45,307 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:45
2025-03-13 17:28:45,308 [INFO]: 474.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:45,308 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:28:45,308 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:45
2025-03-13 17:28:45,308 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:45,308 [INFO]: 	Creating the index 03/13/2025, 17:28:45
2025-03-13 17:28:45,308 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:45
2025-03-13 17:28:45,311 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:28:45,311 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:45
2025-03-13 17:28:45,312 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:28:45,312 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.90it/s] 70%|███████   | 7/10 [00:00<00:00, 36.13it/s]100%|██████████| 10/10 [00:01<00:00,  5.38it/s]
2025-03-13 17:28:47,175 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:47
2025-03-13 17:29:27,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1724 secs
2025-03-13 17:29:27,348 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 17:29:27,348 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 17:29:44,927 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5793 secs
2025-03-13 17:29:44,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6175 secs
2025-03-13 17:29:44,929 [INFO]: {
2025-03-13 17:29:44,929 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:44,929 [INFO]: 	index_param: efSearch=193
2025-03-13 17:29:44,929 [INFO]: 	index_path: knn.index
2025-03-13 17:29:44,929 [INFO]: 	size in bytes: 452707630
2025-03-13 17:29:44,929 [INFO]: 	avg_search_speed_ms: 11.34117440686956
2025-03-13 17:29:44,929 [INFO]: 	99p_search_speed_ms: 15.809225919656452
2025-03-13 17:29:44,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:44,929 [INFO]: 	nb vectors: 2301
2025-03-13 17:29:44,929 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:44,929 [INFO]: 	compression ratio: 0.999309439516184
2025-03-13 17:29:44,929 [INFO]: }
2025-03-13 17:29:44,929 [INFO]: 	>>> Finished "Creating the index" in 59.6211 secs
2025-03-13 17:29:44,929 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6594 secs
2025-03-13 17:29:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 50013 [episode count 13/20]
[retrieval_preprocessing] for episode 87914 [episode count 14/20], we have num_retrieval=np.int64(2400) num_query=np.int64(105)
2025-03-13 17:29:46,725 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:47,714 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:47
2025-03-13 17:29:47,714 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 913.00it/s]
2025-03-13 17:29:47,750 [INFO]: There are 2400 embeddings of dim 49152
2025-03-13 17:29:47,751 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 17:29:47,751 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:47
2025-03-13 17:29:47,751 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:47,751 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:29:47,751 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:47,751 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:47,751 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:47
2025-03-13 17:29:47,751 [INFO]: 495.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:47,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:47,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:47
2025-03-13 17:29:47,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:47,751 [INFO]: 	Creating the index 03/13/2025, 17:29:47
2025-03-13 17:29:47,751 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:47
2025-03-13 17:29:47,752 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:29:47,752 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:47
2025-03-13 17:29:47,753 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:29:47,753 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.42it/s] 70%|███████   | 7/10 [00:00<00:00, 31.16it/s]100%|██████████| 10/10 [00:02<00:00,  4.57it/s]
2025-03-13 17:29:49,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:49
2025-03-13 17:30:32,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0872 secs
2025-03-13 17:30:32,034 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 17:30:32,035 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-13 17:30:54,570 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5359 secs
2025-03-13 17:30:54,574 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8211 secs
2025-03-13 17:30:54,574 [INFO]: {
2025-03-13 17:30:54,574 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:54,574 [INFO]: 	index_param: efSearch=208
2025-03-13 17:30:54,574 [INFO]: 	index_path: knn.index
2025-03-13 17:30:54,574 [INFO]: 	size in bytes: 472185130
2025-03-13 17:30:54,574 [INFO]: 	avg_search_speed_ms: 13.515285780099598
2025-03-13 17:30:54,574 [INFO]: 	99p_search_speed_ms: 23.41686401981862
2025-03-13 17:30:54,574 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:54,574 [INFO]: 	nb vectors: 2400
2025-03-13 17:30:54,574 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:54,574 [INFO]: 	compression ratio: 0.9993097410754972
2025-03-13 17:30:54,575 [INFO]: }
2025-03-13 17:30:54,575 [INFO]: 	>>> Finished "Creating the index" in 66.8232 secs
2025-03-13 17:30:54,575 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8605 secs
2025-03-13 17:30:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 87914 [episode count 14/20]
[retrieval_preprocessing] for episode 22895 [episode count 15/20], we have num_retrieval=np.int64(2398) num_query=np.int64(107)
2025-03-13 17:30:55,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:56,219 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:56
2025-03-13 17:30:56,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1730.32it/s]
2025-03-13 17:30:56,251 [INFO]: There are 2398 embeddings of dim 49152
2025-03-13 17:30:56,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 17:30:56,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:56
2025-03-13 17:30:56,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:56,252 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:30:56,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:56,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:56,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:56
2025-03-13 17:30:56,252 [INFO]: 494.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:56,252 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:30:56,252 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:56
2025-03-13 17:30:56,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:56,252 [INFO]: 	Creating the index 03/13/2025, 17:30:56
2025-03-13 17:30:56,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:56
2025-03-13 17:30:56,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:30:56,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:56
2025-03-13 17:30:56,254 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:30:56,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.97it/s] 50%|█████     | 5/10 [00:00<00:00, 23.76it/s] 80%|████████  | 8/10 [00:00<00:00, 25.88it/s]100%|██████████| 10/10 [00:02<00:00,  3.48it/s]
2025-03-13 17:30:59,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:59
2025-03-13 17:31:36,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5056 secs
2025-03-13 17:31:36,634 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:31:36,635 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 17:31:56,849 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2138 secs
2025-03-13 17:31:56,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5972 secs
2025-03-13 17:31:56,851 [INFO]: {
2025-03-13 17:31:56,851 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:56,851 [INFO]: 	index_param: efSearch=196
2025-03-13 17:31:56,851 [INFO]: 	index_path: knn.index
2025-03-13 17:31:56,851 [INFO]: 	size in bytes: 471791650
2025-03-13 17:31:56,851 [INFO]: 	avg_search_speed_ms: 11.535421079013943
2025-03-13 17:31:56,851 [INFO]: 	99p_search_speed_ms: 18.971802548039705
2025-03-13 17:31:56,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:56,851 [INFO]: 	nb vectors: 2398
2025-03-13 17:31:56,851 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:56,851 [INFO]: 	compression ratio: 0.9993097249601598
2025-03-13 17:31:56,851 [INFO]: }
2025-03-13 17:31:56,851 [INFO]: 	>>> Finished "Creating the index" in 60.5986 secs
2025-03-13 17:31:56,851 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6317 secs
2025-03-13 17:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 22895 [episode count 15/20]
[retrieval_preprocessing] for episode 42370 [episode count 16/20], we have num_retrieval=np.int64(2371) num_query=np.int64(134)
2025-03-13 17:31:58,019 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:58,432 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:58
2025-03-13 17:31:58,432 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2209.85it/s]
2025-03-13 17:31:58,831 [INFO]: There are 2371 embeddings of dim 49152
2025-03-13 17:31:58,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3990 secs
2025-03-13 17:31:58,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:58,831 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:31:58,832 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:58,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:31:58,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,832 [INFO]: 489.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:58,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:31:58,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:58
2025-03-13 17:31:58,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:58,832 [INFO]: 	Creating the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,833 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:58
2025-03-13 17:31:58,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:31:58,835 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,835 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:31:58,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.82it/s] 60%|██████    | 6/10 [00:00<00:00, 29.46it/s]100%|██████████| 10/10 [00:02<00:00,  2.75it/s]100%|██████████| 10/10 [00:03<00:00,  3.33it/s]
2025-03-13 17:32:01,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:01
2025-03-13 17:32:41,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7702 secs
2025-03-13 17:32:41,610 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 17:32:41,611 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.71it/s]
2025-03-13 17:32:59,595 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9848 secs
2025-03-13 17:32:59,597 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7626 secs
2025-03-13 17:32:59,598 [INFO]: {
2025-03-13 17:32:59,598 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:59,598 [INFO]: 	index_param: efSearch=142
2025-03-13 17:32:59,598 [INFO]: 	index_path: knn.index
2025-03-13 17:32:59,598 [INFO]: 	size in bytes: 466479610
2025-03-13 17:32:59,598 [INFO]: 	avg_search_speed_ms: 8.530127693527083
2025-03-13 17:32:59,598 [INFO]: 	99p_search_speed_ms: 14.80133333243429
2025-03-13 17:32:59,598 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:59,598 [INFO]: 	nb vectors: 2371
2025-03-13 17:32:59,598 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:59,598 [INFO]: 	compression ratio: 0.9993096332763612
2025-03-13 17:32:59,598 [INFO]: }
2025-03-13 17:32:59,598 [INFO]: 	>>> Finished "Creating the index" in 60.7652 secs
2025-03-13 17:32:59,598 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1659 secs
2025-03-13 17:33:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 42370 [episode count 16/20]
[retrieval_preprocessing] for episode 80300 [episode count 17/20], we have num_retrieval=np.int64(2387) num_query=np.int64(118)
2025-03-13 17:33:00,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:01,269 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:01
2025-03-13 17:33:01,269 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.21it/s]
2025-03-13 17:33:01,657 [INFO]: There are 2387 embeddings of dim 49152
2025-03-13 17:33:01,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3878 secs
2025-03-13 17:33:01,657 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:01
2025-03-13 17:33:01,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:01,657 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:33:01,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:01,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:33:01,658 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:01
2025-03-13 17:33:01,658 [INFO]: 492.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:01,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:33:01,658 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:01
2025-03-13 17:33:01,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:01,658 [INFO]: 	Creating the index 03/13/2025, 17:33:01
2025-03-13 17:33:01,658 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:01
2025-03-13 17:33:01,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 17:33:01,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:01
2025-03-13 17:33:01,660 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:33:01,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.35it/s] 60%|██████    | 6/10 [00:00<00:00, 28.71it/s]100%|██████████| 10/10 [00:02<00:00,  3.68it/s]100%|██████████| 10/10 [00:02<00:00,  4.40it/s]
2025-03-13 17:33:03,934 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:03
2025-03-13 17:33:48,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3361 secs
2025-03-13 17:33:48,271 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:33:48,271 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.44it/s]
2025-03-13 17:34:19,989 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7176 secs
2025-03-13 17:34:19,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3309 secs
2025-03-13 17:34:19,991 [INFO]: {
2025-03-13 17:34:19,991 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:19,991 [INFO]: 	index_param: efSearch=170
2025-03-13 17:34:19,991 [INFO]: 	index_path: knn.index
2025-03-13 17:34:19,991 [INFO]: 	size in bytes: 469627450
2025-03-13 17:34:19,991 [INFO]: 	avg_search_speed_ms: 8.727171786826748
2025-03-13 17:34:19,991 [INFO]: 	99p_search_speed_ms: 11.274850822519511
2025-03-13 17:34:19,991 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:19,991 [INFO]: 	nb vectors: 2387
2025-03-13 17:34:19,991 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:19,991 [INFO]: 	compression ratio: 0.99930976351574
2025-03-13 17:34:19,991 [INFO]: }
2025-03-13 17:34:19,992 [INFO]: 	>>> Finished "Creating the index" in 78.3332 secs
2025-03-13 17:34:19,992 [INFO]: >>> Finished "Launching the whole pipeline" in 78.7222 secs
2025-03-13 17:34:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 80300 [episode count 17/20]
[retrieval_preprocessing] for episode 2483 [episode count 18/20], we have num_retrieval=np.int64(2378) num_query=np.int64(127)
2025-03-13 17:34:22,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:22,662 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:22
2025-03-13 17:34:22,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 741.83it/s]
2025-03-13 17:34:22,699 [INFO]: There are 2378 embeddings of dim 49152
2025-03-13 17:34:22,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 17:34:22,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:22
2025-03-13 17:34:22,700 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:22,700 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:34:22,700 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:22,700 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:34:22,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:22
2025-03-13 17:34:22,701 [INFO]: 490.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:22,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:34:22,701 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:22
2025-03-13 17:34:22,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:22,702 [INFO]: 	Creating the index 03/13/2025, 17:34:22
2025-03-13 17:34:22,702 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:22
2025-03-13 17:34:22,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:34:22,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:22
2025-03-13 17:34:22,706 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:34:22,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.03it/s] 70%|███████   | 7/10 [00:00<00:00, 32.74it/s]100%|██████████| 10/10 [00:02<00:00,  4.77it/s]
2025-03-13 17:34:24,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:24
2025-03-13 17:35:11,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5643 secs
2025-03-13 17:35:11,372 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 17:35:11,373 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.31it/s]
2025-03-13 17:35:33,782 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4089 secs
2025-03-13 17:35:33,784 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0782 secs
2025-03-13 17:35:33,784 [INFO]: {
2025-03-13 17:35:33,784 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:33,784 [INFO]: 	index_param: efSearch=121
2025-03-13 17:35:33,784 [INFO]: 	index_path: knn.index
2025-03-13 17:35:33,784 [INFO]: 	size in bytes: 467856790
2025-03-13 17:35:33,784 [INFO]: 	avg_search_speed_ms: 7.719534182647768
2025-03-13 17:35:33,784 [INFO]: 	99p_search_speed_ms: 12.7461788803339
2025-03-13 17:35:33,784 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:33,784 [INFO]: 	nb vectors: 2378
2025-03-13 17:35:33,784 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:33,784 [INFO]: 	compression ratio: 0.999309690471736
2025-03-13 17:35:33,784 [INFO]: }
2025-03-13 17:35:33,784 [INFO]: 	>>> Finished "Creating the index" in 71.0823 secs
2025-03-13 17:35:33,784 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1221 secs
2025-03-13 17:35:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 2483 [episode count 18/20]
[retrieval_preprocessing] for episode 43157 [episode count 19/20], we have num_retrieval=np.int64(2318) num_query=np.int64(187)
2025-03-13 17:35:34,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:35,277 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:35
2025-03-13 17:35:35,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 901.61it/s]
2025-03-13 17:35:35,314 [INFO]: There are 2318 embeddings of dim 49152
2025-03-13 17:35:35,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 17:35:35,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:35,315 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:35:35,316 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:35,316 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:35:35,316 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,316 [INFO]: 478.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:35,316 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:35:35,316 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:35
2025-03-13 17:35:35,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:35,317 [INFO]: 	Creating the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,317 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:35
2025-03-13 17:35:35,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:35:35,320 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,321 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:35:35,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.79it/s] 70%|███████   | 7/10 [00:00<00:00, 33.47it/s]100%|██████████| 10/10 [00:02<00:00,  4.40it/s]
2025-03-13 17:35:37,597 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:37
2025-03-13 17:36:18,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9949 secs
2025-03-13 17:36:18,592 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:36:18,592 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.52it/s]
2025-03-13 17:36:41,712 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1199 secs
2025-03-13 17:36:41,714 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3934 secs
2025-03-13 17:36:41,714 [INFO]: {
2025-03-13 17:36:41,714 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:41,714 [INFO]: 	index_param: efSearch=196
2025-03-13 17:36:41,714 [INFO]: 	index_path: knn.index
2025-03-13 17:36:41,714 [INFO]: 	size in bytes: 456052270
2025-03-13 17:36:41,714 [INFO]: 	avg_search_speed_ms: 10.061492572371778
2025-03-13 17:36:41,714 [INFO]: 	99p_search_speed_ms: 14.127577869221565
2025-03-13 17:36:41,714 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:41,714 [INFO]: 	nb vectors: 2318
2025-03-13 17:36:41,714 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:41,714 [INFO]: 	compression ratio: 0.9993094519626007
2025-03-13 17:36:41,714 [INFO]: }
2025-03-13 17:36:41,714 [INFO]: 	>>> Finished "Creating the index" in 66.3974 secs
2025-03-13 17:36:41,714 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4367 secs
2025-03-13 17:36:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 43157 [episode count 19/20]
2025-03-13 17:36:44: [retrieval_preprocessing] finished for 4846810092_put_cloth_on_table [chosen_id count 5/196]
2025-03-13 17:36:47: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 488975025_put_one_slice_of_bread_in_toaster [chosen_id count 6/196]
2025-03-13 17:36:47: [retrieval_preprocessing] we have num_total=7334 embedding_dim=49152
[retrieval_preprocessing] for episode 65051 [episode count 0/20], we have num_retrieval=np.int64(7002) num_query=np.int64(332)
2025-03-13 17:36:48,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:49,705 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:49
2025-03-13 17:36:49,706 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.86it/s]
2025-03-13 17:36:49,752 [INFO]: There are 7002 embeddings of dim 49152
2025-03-13 17:36:49,752 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0468 secs
2025-03-13 17:36:49,753 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:49
2025-03-13 17:36:49,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:49,753 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:36:49,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:49,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:49,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:49
2025-03-13 17:36:49,753 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:49,753 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:49,753 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:49
2025-03-13 17:36:49,753 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:49,753 [INFO]: 	Creating the index 03/13/2025, 17:36:49
2025-03-13 17:36:49,753 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:49
2025-03-13 17:36:49,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:36:49,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:49
2025-03-13 17:36:49,755 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:36:49,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.62it/s] 21%|██        | 6/29 [00:00<00:00, 29.48it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.85it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.66it/s] 72%|███████▏  | 21/29 [00:04<00:02,  2.86it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.28it/s]100%|██████████| 29/29 [00:06<00:00,  4.36it/s]
2025-03-13 17:36:56,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:56
2025-03-13 17:37:55,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0058 secs
2025-03-13 17:37:55,721 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 17:37:55,721 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 17:38:41,487 [INFO]: 	>>> Finished "Compute fast metrics" in 45.7663 secs
2025-03-13 17:38:42,064 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.3096 secs
2025-03-13 17:38:42,065 [INFO]: {
2025-03-13 17:38:42,065 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:42,065 [INFO]: 	index_param: efSearch=232
2025-03-13 17:38:42,065 [INFO]: 	index_path: knn.index
2025-03-13 17:38:42,065 [INFO]: 	size in bytes: 1377602170
2025-03-13 17:38:42,065 [INFO]: 	avg_search_speed_ms: 9.895174254678949
2025-03-13 17:38:42,065 [INFO]: 	99p_search_speed_ms: 15.842052618972955
2025-03-13 17:38:42,065 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:42,065 [INFO]: 	nb vectors: 7002
2025-03-13 17:38:42,065 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:42,065 [INFO]: 	compression ratio: 0.9993082516703643
2025-03-13 17:38:42,065 [INFO]: }
2025-03-13 17:38:42,065 [INFO]: 	>>> Finished "Creating the index" in 112.3120 secs
2025-03-13 17:38:42,065 [INFO]: >>> Finished "Launching the whole pipeline" in 112.3596 secs
2025-03-13 17:38:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 65051 [episode count 0/20]
[retrieval_preprocessing] for episode 67100 [episode count 1/20], we have num_retrieval=np.int64(7043) num_query=np.int64(291)
2025-03-13 17:38:46,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:47,222 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:47
2025-03-13 17:38:47,222 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 839.03it/s]
2025-03-13 17:38:47,273 [INFO]: There are 7043 embeddings of dim 49152
2025-03-13 17:38:47,273 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0504 secs
2025-03-13 17:38:47,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:47
2025-03-13 17:38:47,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:47,274 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:38:47,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:47,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:38:47,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:47
2025-03-13 17:38:47,274 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:47,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:38:47,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:47
2025-03-13 17:38:47,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:47,275 [INFO]: 	Creating the index 03/13/2025, 17:38:47
2025-03-13 17:38:47,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:47
2025-03-13 17:38:47,279 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:38:47,279 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:47
2025-03-13 17:38:47,279 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:38:47,279 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.74it/s] 17%|█▋        | 5/29 [00:00<00:00, 24.10it/s] 31%|███       | 9/29 [00:00<00:00, 30.51it/s] 45%|████▍     | 13/29 [00:00<00:00, 33.53it/s] 59%|█████▊    | 17/29 [00:00<00:00, 35.06it/s] 72%|███████▏  | 21/29 [00:04<00:02,  2.87it/s] 86%|████████▌ | 25/29 [00:04<00:00,  4.17it/s]100%|██████████| 29/29 [00:06<00:00,  3.29it/s]100%|██████████| 29/29 [00:06<00:00,  4.74it/s]
2025-03-13 17:38:54,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:54
2025-03-13 17:39:51,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8443 secs
2025-03-13 17:39:51,853 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:39:51,853 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-13 17:40:41,650 [INFO]: 	>>> Finished "Compute fast metrics" in 49.7966 secs
2025-03-13 17:40:41,652 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.3725 secs
2025-03-13 17:40:41,652 [INFO]: {
2025-03-13 17:40:41,652 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:41,652 [INFO]: 	index_param: efSearch=227
2025-03-13 17:40:41,652 [INFO]: 	index_path: knn.index
2025-03-13 17:40:41,652 [INFO]: 	size in bytes: 1385668510
2025-03-13 17:40:41,652 [INFO]: 	avg_search_speed_ms: 10.398356296245993
2025-03-13 17:40:41,652 [INFO]: 	99p_search_speed_ms: 14.391999775543809
2025-03-13 17:40:41,652 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:41,652 [INFO]: 	nb vectors: 7043
2025-03-13 17:40:41,652 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:41,652 [INFO]: 	compression ratio: 0.9993083728228767
2025-03-13 17:40:41,652 [INFO]: }
2025-03-13 17:40:41,652 [INFO]: 	>>> Finished "Creating the index" in 114.3765 secs
2025-03-13 17:40:41,652 [INFO]: >>> Finished "Launching the whole pipeline" in 114.4295 secs
2025-03-13 17:40:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 67100 [episode count 1/20]
[retrieval_preprocessing] for episode 23087 [episode count 2/20], we have num_retrieval=np.int64(7000) num_query=np.int64(334)
2025-03-13 17:40:45,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:46,456 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:46
2025-03-13 17:40:46,456 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.01it/s]
2025-03-13 17:40:46,502 [INFO]: There are 7000 embeddings of dim 49152
2025-03-13 17:40:46,502 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0459 secs
2025-03-13 17:40:46,502 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,502 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:46,502 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:40:46,502 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:46,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:46,502 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,503 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:46,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:46,503 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:46
2025-03-13 17:40:46,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:46,503 [INFO]: 	Creating the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,503 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:46
2025-03-13 17:40:46,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:40:46,504 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:46
2025-03-13 17:40:46,504 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:40:46,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.83it/s] 21%|██        | 6/29 [00:00<00:00, 25.24it/s] 38%|███▊      | 11/29 [00:00<00:00, 32.80it/s] 55%|█████▌    | 16/29 [00:00<00:00, 36.78it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.17it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.73it/s]100%|██████████| 29/29 [00:06<00:00,  4.68it/s]
2025-03-13 17:40:52,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:52
2025-03-13 17:41:58,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9873 secs
2025-03-13 17:41:58,688 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:41:58,689 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-13 17:42:29,508 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8196 secs
2025-03-13 17:42:29,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.0054 secs
2025-03-13 17:42:29,510 [INFO]: {
2025-03-13 17:42:29,510 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:29,510 [INFO]: 	index_param: efSearch=198
2025-03-13 17:42:29,510 [INFO]: 	index_path: knn.index
2025-03-13 17:42:29,510 [INFO]: 	size in bytes: 1377208630
2025-03-13 17:42:29,510 [INFO]: 	avg_search_speed_ms: 9.092577711086381
2025-03-13 17:42:29,510 [INFO]: 	99p_search_speed_ms: 12.883700556121765
2025-03-13 17:42:29,510 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:29,510 [INFO]: 	nb vectors: 7000
2025-03-13 17:42:29,510 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:29,510 [INFO]: 	compression ratio: 0.9993082892604296
2025-03-13 17:42:29,510 [INFO]: }
2025-03-13 17:42:29,510 [INFO]: 	>>> Finished "Creating the index" in 103.0070 secs
2025-03-13 17:42:29,510 [INFO]: >>> Finished "Launching the whole pipeline" in 103.0536 secs
2025-03-13 17:42:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 23087 [episode count 2/20]
[retrieval_preprocessing] for episode 64564 [episode count 3/20], we have num_retrieval=np.int64(7085) num_query=np.int64(249)
2025-03-13 17:42:32,701 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:33,650 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:33
2025-03-13 17:42:33,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1911.72it/s]
2025-03-13 17:42:33,691 [INFO]: There are 7085 embeddings of dim 49152
2025-03-13 17:42:33,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 17:42:33,692 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:33
2025-03-13 17:42:33,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:33,692 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:42:33,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:33,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:42:33,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:33
2025-03-13 17:42:33,693 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:33,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:42:33,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:33
2025-03-13 17:42:33,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:33,694 [INFO]: 	Creating the index 03/13/2025, 17:42:33
2025-03-13 17:42:33,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:33
2025-03-13 17:42:33,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:42:33,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:33
2025-03-13 17:42:33,697 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:42:33,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.98it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.33it/s] 41%|████▏     | 12/29 [00:00<00:00, 39.49it/s] 59%|█████▊    | 17/29 [00:00<00:00, 41.82it/s] 76%|███████▌  | 22/29 [00:04<00:02,  3.22it/s] 97%|█████████▋| 28/29 [00:04<00:00,  5.12it/s]100%|██████████| 29/29 [00:06<00:00,  4.59it/s]
2025-03-13 17:42:40,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:40
2025-03-13 17:43:40,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.7651 secs
2025-03-13 17:43:40,782 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:43:40,782 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.93it/s]
2025-03-13 17:44:36,297 [INFO]: 	>>> Finished "Compute fast metrics" in 55.5146 secs
2025-03-13 17:44:36,299 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.6018 secs
2025-03-13 17:44:36,299 [INFO]: {
2025-03-13 17:44:36,299 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:36,299 [INFO]: 	index_param: efSearch=184
2025-03-13 17:44:36,299 [INFO]: 	index_path: knn.index
2025-03-13 17:44:36,299 [INFO]: 	size in bytes: 1393931770
2025-03-13 17:44:36,299 [INFO]: 	avg_search_speed_ms: 9.207128719075087
2025-03-13 17:44:36,299 [INFO]: 	99p_search_speed_ms: 11.696409014984969
2025-03-13 17:44:36,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:36,299 [INFO]: 	nb vectors: 7085
2025-03-13 17:44:36,299 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:36,299 [INFO]: 	compression ratio: 0.9993083664346067
2025-03-13 17:44:36,299 [INFO]: }
2025-03-13 17:44:36,299 [INFO]: 	>>> Finished "Creating the index" in 122.6054 secs
2025-03-13 17:44:36,299 [INFO]: >>> Finished "Launching the whole pipeline" in 122.6490 secs
2025-03-13 17:44:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 64564 [episode count 3/20]
[retrieval_preprocessing] for episode 87630 [episode count 4/20], we have num_retrieval=np.int64(6847) num_query=np.int64(487)
2025-03-13 17:44:39,195 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:40,782 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:40
2025-03-13 17:44:40,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.84it/s]
2025-03-13 17:44:40,827 [INFO]: There are 6847 embeddings of dim 49152
2025-03-13 17:44:40,827 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0454 secs
2025-03-13 17:44:40,827 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:40
2025-03-13 17:44:40,828 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:40,828 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:44:40,828 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:40,828 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:40,828 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:40
2025-03-13 17:44:40,828 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:40,828 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:44:40,828 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:40
2025-03-13 17:44:40,828 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:40,828 [INFO]: 	Creating the index 03/13/2025, 17:44:40
2025-03-13 17:44:40,828 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:40
2025-03-13 17:44:40,829 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:44:40,829 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:40
2025-03-13 17:44:40,829 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:44:40,829 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  6.85it/s] 21%|██▏       | 6/28 [00:00<00:00, 26.18it/s] 39%|███▉      | 11/28 [00:00<00:00, 33.81it/s] 57%|█████▋    | 16/28 [00:00<00:00, 37.73it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.01it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.49it/s]100%|██████████| 28/28 [00:06<00:00,  4.33it/s]
2025-03-13 17:44:47,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:47
2025-03-13 17:45:46,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7323 secs
2025-03-13 17:45:46,031 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 17:45:46,031 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.54it/s]
2025-03-13 17:46:15,874 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8425 secs
2025-03-13 17:46:15,875 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.0462 secs
2025-03-13 17:46:15,875 [INFO]: {
2025-03-13 17:46:15,875 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:15,875 [INFO]: 	index_param: efSearch=204
2025-03-13 17:46:15,875 [INFO]: 	index_path: knn.index
2025-03-13 17:46:15,875 [INFO]: 	size in bytes: 1347106570
2025-03-13 17:46:15,875 [INFO]: 	avg_search_speed_ms: 9.796733530347732
2025-03-13 17:46:15,875 [INFO]: 	99p_search_speed_ms: 12.849870696663857
2025-03-13 17:46:15,875 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:15,875 [INFO]: 	nb vectors: 6847
2025-03-13 17:46:15,875 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:15,875 [INFO]: 	compression ratio: 0.9993084481801614
2025-03-13 17:46:15,875 [INFO]: }
2025-03-13 17:46:15,876 [INFO]: 	>>> Finished "Creating the index" in 95.0476 secs
2025-03-13 17:46:15,876 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0936 secs
2025-03-13 17:46:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 87630 [episode count 4/20]
[retrieval_preprocessing] for episode 66652 [episode count 5/20], we have num_retrieval=np.int64(7040) num_query=np.int64(294)
2025-03-13 17:46:20,999 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:22,105 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:22
2025-03-13 17:46:22,105 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.76it/s]
2025-03-13 17:46:22,164 [INFO]: There are 7040 embeddings of dim 49152
2025-03-13 17:46:22,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0595 secs
2025-03-13 17:46:22,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:22
2025-03-13 17:46:22,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:22,165 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:46:22,166 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:22,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:46:22,166 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:22
2025-03-13 17:46:22,166 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:22,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:46:22,167 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:22
2025-03-13 17:46:22,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:22,167 [INFO]: 	Creating the index 03/13/2025, 17:46:22
2025-03-13 17:46:22,167 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:22
2025-03-13 17:46:22,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:46:22,171 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:22
2025-03-13 17:46:22,171 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:46:22,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.80it/s] 17%|█▋        | 5/29 [00:00<00:01, 20.86it/s] 31%|███       | 9/29 [00:00<00:00, 25.88it/s] 45%|████▍     | 13/29 [00:00<00:00, 28.64it/s] 59%|█████▊    | 17/29 [00:00<00:00, 32.15it/s] 72%|███████▏  | 21/29 [00:04<00:03,  2.53it/s] 90%|████████▉ | 26/29 [00:04<00:00,  3.98it/s]100%|██████████| 29/29 [00:06<00:00,  2.84it/s]100%|██████████| 29/29 [00:06<00:00,  4.19it/s]
2025-03-13 17:46:29,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:29
2025-03-13 17:47:33,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.7019 secs
2025-03-13 17:47:33,798 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 17:47:33,798 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.24it/s]
2025-03-13 17:48:29,694 [INFO]: 	>>> Finished "Compute fast metrics" in 55.8955 secs
2025-03-13 17:48:29,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.5246 secs
2025-03-13 17:48:29,696 [INFO]: {
2025-03-13 17:48:29,696 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:29,696 [INFO]: 	index_param: efSearch=179
2025-03-13 17:48:29,696 [INFO]: 	index_path: knn.index
2025-03-13 17:48:29,696 [INFO]: 	size in bytes: 1385078290
2025-03-13 17:48:29,696 [INFO]: 	avg_search_speed_ms: 8.377638064563536
2025-03-13 17:48:29,696 [INFO]: 	99p_search_speed_ms: 11.327230834867805
2025-03-13 17:48:29,696 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:29,696 [INFO]: 	nb vectors: 7040
2025-03-13 17:48:29,696 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:29,696 [INFO]: 	compression ratio: 0.9993083640059076
2025-03-13 17:48:29,696 [INFO]: }
2025-03-13 17:48:29,696 [INFO]: 	>>> Finished "Creating the index" in 127.5286 secs
2025-03-13 17:48:29,696 [INFO]: >>> Finished "Launching the whole pipeline" in 127.5908 secs
2025-03-13 17:48:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 66652 [episode count 5/20]
[retrieval_preprocessing] for episode 84573 [episode count 6/20], we have num_retrieval=np.int64(7153) num_query=np.int64(181)
2025-03-13 17:48:32,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:34,068 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:34
2025-03-13 17:48:34,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 752.88it/s]
2025-03-13 17:48:34,110 [INFO]: There are 7153 embeddings of dim 49152
2025-03-13 17:48:34,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 17:48:34,111 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:34,111 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:48:34,111 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:34,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:48:34,111 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,112 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:34,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:48:34,112 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:34
2025-03-13 17:48:34,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:34,113 [INFO]: 	Creating the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:34
2025-03-13 17:48:34,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:48:34,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,116 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:48:34,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.75it/s] 20%|██        | 6/30 [00:00<00:00, 30.13it/s] 37%|███▋      | 11/30 [00:00<00:00, 37.56it/s] 53%|█████▎    | 16/30 [00:00<00:00, 39.05it/s] 70%|███████   | 21/30 [00:04<00:03,  2.79it/s] 83%|████████▎ | 25/30 [00:04<00:01,  3.88it/s] 97%|█████████▋| 29/30 [00:05<00:00,  5.33it/s]100%|██████████| 30/30 [00:07<00:00,  4.19it/s]
2025-03-13 17:48:41,284 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:41
2025-03-13 17:49:43,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.0400 secs
2025-03-13 17:49:43,325 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 17:49:43,325 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.24it/s]
2025-03-13 17:50:29,333 [INFO]: 	>>> Finished "Compute fast metrics" in 46.0077 secs
2025-03-13 17:50:29,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.2187 secs
2025-03-13 17:50:29,335 [INFO]: {
2025-03-13 17:50:29,335 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:29,335 [INFO]: 	index_param: efSearch=248
2025-03-13 17:50:29,335 [INFO]: 	index_path: knn.index
2025-03-13 17:50:29,335 [INFO]: 	size in bytes: 1407310510
2025-03-13 17:50:29,335 [INFO]: 	avg_search_speed_ms: 10.753226601168192
2025-03-13 17:50:29,335 [INFO]: 	99p_search_speed_ms: 18.073416498955346
2025-03-13 17:50:29,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:29,335 [INFO]: 	nb vectors: 7153
2025-03-13 17:50:29,335 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:29,335 [INFO]: 	compression ratio: 0.9993082649542637
2025-03-13 17:50:29,335 [INFO]: }
2025-03-13 17:50:29,335 [INFO]: 	>>> Finished "Creating the index" in 115.2226 secs
2025-03-13 17:50:29,335 [INFO]: >>> Finished "Launching the whole pipeline" in 115.2674 secs
2025-03-13 17:50:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 84573 [episode count 6/20]
[retrieval_preprocessing] for episode 20068 [episode count 7/20], we have num_retrieval=np.int64(7040) num_query=np.int64(294)
2025-03-13 17:50:35,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:36,433 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:36
2025-03-13 17:50:36,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.85it/s]
2025-03-13 17:50:36,485 [INFO]: There are 7040 embeddings of dim 49152
2025-03-13 17:50:36,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0520 secs
2025-03-13 17:50:36,485 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:36
2025-03-13 17:50:36,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:36,485 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:50:36,485 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:36,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:50:36,486 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:36
2025-03-13 17:50:36,486 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:36,486 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:50:36,486 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:36
2025-03-13 17:50:36,486 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:36,486 [INFO]: 	Creating the index 03/13/2025, 17:50:36
2025-03-13 17:50:36,486 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:36
2025-03-13 17:50:36,488 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 17:50:36,488 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:36
2025-03-13 17:50:36,488 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:50:36,488 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.38it/s] 17%|█▋        | 5/29 [00:00<00:00, 25.19it/s] 31%|███       | 9/29 [00:00<00:00, 28.64it/s] 45%|████▍     | 13/29 [00:00<00:00, 31.98it/s] 59%|█████▊    | 17/29 [00:00<00:00, 34.25it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.38it/s] 90%|████████▉ | 26/29 [00:05<00:00,  3.75it/s]100%|██████████| 29/29 [00:07<00:00,  2.61it/s]100%|██████████| 29/29 [00:07<00:00,  3.92it/s]
2025-03-13 17:50:43,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:43
2025-03-13 17:51:41,314 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4151 secs
2025-03-13 17:51:41,314 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 17:51:41,314 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.01it/s]
2025-03-13 17:52:13,406 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0915 secs
2025-03-13 17:52:13,408 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.9202 secs
2025-03-13 17:52:13,408 [INFO]: {
2025-03-13 17:52:13,408 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:13,408 [INFO]: 	index_param: efSearch=190
2025-03-13 17:52:13,408 [INFO]: 	index_path: knn.index
2025-03-13 17:52:13,408 [INFO]: 	size in bytes: 1385078290
2025-03-13 17:52:13,409 [INFO]: 	avg_search_speed_ms: 9.188952372342635
2025-03-13 17:52:13,409 [INFO]: 	99p_search_speed_ms: 13.009809243958442
2025-03-13 17:52:13,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:13,409 [INFO]: 	nb vectors: 7040
2025-03-13 17:52:13,409 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:13,409 [INFO]: 	compression ratio: 0.9993083640059076
2025-03-13 17:52:13,409 [INFO]: }
2025-03-13 17:52:13,409 [INFO]: 	>>> Finished "Creating the index" in 96.9225 secs
2025-03-13 17:52:13,409 [INFO]: >>> Finished "Launching the whole pipeline" in 96.9758 secs
2025-03-13 17:52:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 20068 [episode count 7/20]
[retrieval_preprocessing] for episode 28274 [episode count 8/20], we have num_retrieval=np.int64(6853) num_query=np.int64(481)
2025-03-13 17:52:16,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:17,982 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:17
2025-03-13 17:52:17,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.08it/s]
2025-03-13 17:52:18,023 [INFO]: There are 6853 embeddings of dim 49152
2025-03-13 17:52:18,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0416 secs
2025-03-13 17:52:18,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:18
2025-03-13 17:52:18,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:18,024 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:52:18,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:18,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:18,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:18
2025-03-13 17:52:18,024 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:18,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:52:18,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:18
2025-03-13 17:52:18,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:18,024 [INFO]: 	Creating the index 03/13/2025, 17:52:18
2025-03-13 17:52:18,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:18
2025-03-13 17:52:18,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:52:18,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:18
2025-03-13 17:52:18,025 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:52:18,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.53it/s] 21%|██▏       | 6/28 [00:00<00:00, 27.90it/s] 39%|███▉      | 11/28 [00:00<00:00, 36.16it/s] 57%|█████▋    | 16/28 [00:00<00:00, 38.83it/s] 71%|███████▏  | 20/28 [00:00<00:00, 38.35it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.45it/s]100%|██████████| 28/28 [00:08<00:00,  1.77it/s]100%|██████████| 28/28 [00:08<00:00,  3.12it/s]
2025-03-13 17:52:27,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:27
2025-03-13 17:53:26,247 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2288 secs
2025-03-13 17:53:26,247 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 17:53:26,247 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.73it/s]
2025-03-13 17:54:05,400 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1531 secs
2025-03-13 17:54:05,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.3766 secs
2025-03-13 17:54:05,402 [INFO]: {
2025-03-13 17:54:05,402 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:05,402 [INFO]: 	index_param: efSearch=203
2025-03-13 17:54:05,402 [INFO]: 	index_path: knn.index
2025-03-13 17:54:05,402 [INFO]: 	size in bytes: 1348287010
2025-03-13 17:54:05,402 [INFO]: 	avg_search_speed_ms: 9.155038838025742
2025-03-13 17:54:05,402 [INFO]: 	99p_search_speed_ms: 12.108054535929114
2025-03-13 17:54:05,402 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:05,402 [INFO]: 	nb vectors: 6853
2025-03-13 17:54:05,402 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:05,402 [INFO]: 	compression ratio: 0.9993084662293082
2025-03-13 17:54:05,402 [INFO]: }
2025-03-13 17:54:05,402 [INFO]: 	>>> Finished "Creating the index" in 107.3781 secs
2025-03-13 17:54:05,402 [INFO]: >>> Finished "Launching the whole pipeline" in 107.4203 secs
2025-03-13 17:54:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 28274 [episode count 8/20]
[retrieval_preprocessing] for episode 1167 [episode count 9/20], we have num_retrieval=np.int64(7048) num_query=np.int64(286)
2025-03-13 17:54:09,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:10,758 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:10
2025-03-13 17:54:10,758 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.22it/s]
2025-03-13 17:54:10,810 [INFO]: There are 7048 embeddings of dim 49152
2025-03-13 17:54:10,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0519 secs
2025-03-13 17:54:10,810 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:10
2025-03-13 17:54:10,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:10,811 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:54:10,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:10,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:54:10,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:10
2025-03-13 17:54:10,811 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:10,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:54:10,811 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:10
2025-03-13 17:54:10,811 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:10,811 [INFO]: 	Creating the index 03/13/2025, 17:54:10
2025-03-13 17:54:10,811 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:10
2025-03-13 17:54:10,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:54:10,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:10
2025-03-13 17:54:10,813 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:54:10,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.04it/s] 17%|█▋        | 5/29 [00:00<00:01, 20.70it/s] 31%|███       | 9/29 [00:00<00:00, 27.28it/s] 45%|████▍     | 13/29 [00:00<00:00, 30.78it/s] 59%|█████▊    | 17/29 [00:00<00:00, 32.77it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.42it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.54it/s]100%|██████████| 29/29 [00:07<00:00,  2.63it/s]100%|██████████| 29/29 [00:07<00:00,  3.88it/s]
2025-03-13 17:54:18,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:18
2025-03-13 17:55:16,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5558 secs
2025-03-13 17:55:16,844 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:55:16,844 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.74it/s]
2025-03-13 17:55:50,200 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3552 secs
2025-03-13 17:55:50,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.3891 secs
2025-03-13 17:55:50,202 [INFO]: {
2025-03-13 17:55:50,202 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:50,202 [INFO]: 	index_param: efSearch=169
2025-03-13 17:55:50,202 [INFO]: 	index_path: knn.index
2025-03-13 17:55:50,202 [INFO]: 	size in bytes: 1386652270
2025-03-13 17:55:50,202 [INFO]: 	avg_search_speed_ms: 8.585946990153053
2025-03-13 17:55:50,202 [INFO]: 	99p_search_speed_ms: 13.357406547293065
2025-03-13 17:55:50,202 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:50,202 [INFO]: 	nb vectors: 7048
2025-03-13 17:55:50,202 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:50,202 [INFO]: 	compression ratio: 0.9993083442613915
2025-03-13 17:55:50,202 [INFO]: }
2025-03-13 17:55:50,202 [INFO]: 	>>> Finished "Creating the index" in 99.3911 secs
2025-03-13 17:55:50,202 [INFO]: >>> Finished "Launching the whole pipeline" in 99.4441 secs
2025-03-13 17:55:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 1167 [episode count 9/20]
[retrieval_preprocessing] for episode 84131 [episode count 10/20], we have num_retrieval=np.int64(6960) num_query=np.int64(374)
2025-03-13 17:55:52,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:53,672 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:53
2025-03-13 17:55:53,672 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]
2025-03-13 17:55:53,999 [INFO]: There are 6960 embeddings of dim 49152
2025-03-13 17:55:54,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3276 secs
2025-03-13 17:55:54,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:54
2025-03-13 17:55:54,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:54,000 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 17:55:54,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:54,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:54,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:54
2025-03-13 17:55:54,000 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:54,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:54,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:54
2025-03-13 17:55:54,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:54,000 [INFO]: 	Creating the index 03/13/2025, 17:55:54
2025-03-13 17:55:54,001 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:54
2025-03-13 17:55:54,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:55:54,002 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:54
2025-03-13 17:55:54,002 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:55:54,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.81it/s] 17%|█▋        | 5/29 [00:00<00:01, 22.54it/s] 38%|███▊      | 11/29 [00:00<00:00, 34.98it/s] 59%|█████▊    | 17/29 [00:00<00:00, 41.11it/s] 76%|███████▌  | 22/29 [00:04<00:02,  3.46it/s] 93%|█████████▎| 27/29 [00:04<00:00,  5.07it/s]100%|██████████| 29/29 [00:05<00:00,  4.84it/s]
2025-03-13 17:55:59,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:59
2025-03-13 17:56:59,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6935 secs
2025-03-13 17:56:59,693 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 17:56:59,693 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.94it/s]
2025-03-13 17:57:47,434 [INFO]: 	>>> Finished "Compute fast metrics" in 47.7417 secs
2025-03-13 17:57:47,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.4345 secs
2025-03-13 17:57:47,437 [INFO]: {
2025-03-13 17:57:47,437 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:47,437 [INFO]: 	index_param: efSearch=284
2025-03-13 17:57:47,437 [INFO]: 	index_path: knn.index
2025-03-13 17:57:47,437 [INFO]: 	size in bytes: 1369338850
2025-03-13 17:57:47,437 [INFO]: 	avg_search_speed_ms: 13.353274818708764
2025-03-13 17:57:47,437 [INFO]: 	99p_search_speed_ms: 16.856928775087
2025-03-13 17:57:47,437 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:47,437 [INFO]: 	nb vectors: 6960
2025-03-13 17:57:47,437 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:47,437 [INFO]: 	compression ratio: 0.999308301228728
2025-03-13 17:57:47,437 [INFO]: }
2025-03-13 17:57:47,437 [INFO]: 	>>> Finished "Creating the index" in 113.4363 secs
2025-03-13 17:57:47,437 [INFO]: >>> Finished "Launching the whole pipeline" in 113.7646 secs
2025-03-13 17:57:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 84131 [episode count 10/20]
[retrieval_preprocessing] for episode 2740 [episode count 11/20], we have num_retrieval=np.int64(6706) num_query=np.int64(628)
2025-03-13 17:57:52,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:54,994 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:54
2025-03-13 17:57:54,995 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 759.70it/s]
2025-03-13 17:57:55,057 [INFO]: There are 6706 embeddings of dim 49152
2025-03-13 17:57:55,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0627 secs
2025-03-13 17:57:55,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:55
2025-03-13 17:57:55,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:55,058 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:57:55,058 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:55,058 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:57:55,058 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:55
2025-03-13 17:57:55,059 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:55,059 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:57:55,059 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:55
2025-03-13 17:57:55,059 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:55,060 [INFO]: 	Creating the index 03/13/2025, 17:57:55
2025-03-13 17:57:55,060 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:55
2025-03-13 17:57:55,063 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:57:55,064 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:55
2025-03-13 17:57:55,064 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:57:55,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.02it/s] 18%|█▊        | 5/28 [00:00<00:01, 21.23it/s] 32%|███▏      | 9/28 [00:00<00:00, 27.25it/s] 50%|█████     | 14/28 [00:00<00:00, 32.94it/s] 64%|██████▍   | 18/28 [00:00<00:00, 30.69it/s] 79%|███████▊  | 22/28 [00:05<00:02,  2.53it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.94it/s]100%|██████████| 28/28 [00:06<00:00,  4.01it/s]
2025-03-13 17:58:02,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:02
2025-03-13 17:59:04,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2427 secs
2025-03-13 17:59:04,291 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:59:04,291 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 17:59:34,659 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3684 secs
2025-03-13 17:59:35,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.5173 secs
2025-03-13 17:59:35,582 [INFO]: {
2025-03-13 17:59:35,582 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:35,582 [INFO]: 	index_param: efSearch=185
2025-03-13 17:59:35,582 [INFO]: 	index_path: knn.index
2025-03-13 17:59:35,582 [INFO]: 	size in bytes: 1319365750
2025-03-13 17:59:35,582 [INFO]: 	avg_search_speed_ms: 8.780575049730366
2025-03-13 17:59:35,582 [INFO]: 	99p_search_speed_ms: 16.91233962308614
2025-03-13 17:59:35,582 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:35,582 [INFO]: 	nb vectors: 6706
2025-03-13 17:59:35,582 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:35,582 [INFO]: 	compression ratio: 0.9993083782870671
2025-03-13 17:59:35,582 [INFO]: }
2025-03-13 17:59:35,582 [INFO]: 	>>> Finished "Creating the index" in 100.5225 secs
2025-03-13 17:59:35,582 [INFO]: >>> Finished "Launching the whole pipeline" in 100.5878 secs
2025-03-13 17:59:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 2740 [episode count 11/20]
[retrieval_preprocessing] for episode 20154 [episode count 12/20], we have num_retrieval=np.int64(7080) num_query=np.int64(254)
2025-03-13 17:59:39,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:41,413 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:41
2025-03-13 17:59:41,413 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-13 17:59:41,448 [INFO]: There are 7080 embeddings of dim 49152
2025-03-13 17:59:41,448 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 17:59:41,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:41
2025-03-13 17:59:41,448 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:41,448 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 17:59:41,448 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:41,448 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:41,448 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:41
2025-03-13 17:59:41,448 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:41,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:59:41,449 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:41
2025-03-13 17:59:41,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:41,449 [INFO]: 	Creating the index 03/13/2025, 17:59:41
2025-03-13 17:59:41,449 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:41
2025-03-13 17:59:41,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:59:41,450 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:41
2025-03-13 17:59:41,450 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 17:59:41,450 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.61it/s] 24%|██▍       | 7/29 [00:00<00:00, 33.72it/s] 45%|████▍     | 13/29 [00:00<00:00, 41.88it/s] 66%|██████▌   | 19/29 [00:00<00:00, 45.89it/s] 83%|████████▎ | 24/29 [00:03<00:01,  4.06it/s]100%|██████████| 29/29 [00:05<00:00,  3.54it/s]100%|██████████| 29/29 [00:05<00:00,  5.18it/s]
2025-03-13 17:59:47,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:47
2025-03-13 18:00:50,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.4321 secs
2025-03-13 18:00:50,484 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 18:00:50,484 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.81it/s]
2025-03-13 18:01:24,900 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4154 secs
2025-03-13 18:01:24,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.4521 secs
2025-03-13 18:01:24,902 [INFO]: {
2025-03-13 18:01:24,902 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:24,902 [INFO]: 	index_param: efSearch=182
2025-03-13 18:01:24,902 [INFO]: 	index_path: knn.index
2025-03-13 18:01:24,902 [INFO]: 	size in bytes: 1392948070
2025-03-13 18:01:24,902 [INFO]: 	avg_search_speed_ms: 8.418788764781008
2025-03-13 18:01:24,902 [INFO]: 	99p_search_speed_ms: 11.079225065186618
2025-03-13 18:01:24,902 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:24,902 [INFO]: 	nb vectors: 7080
2025-03-13 18:01:24,902 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:24,902 [INFO]: 	compression ratio: 0.9993083518181693
2025-03-13 18:01:24,902 [INFO]: }
2025-03-13 18:01:24,902 [INFO]: 	>>> Finished "Creating the index" in 103.4538 secs
2025-03-13 18:01:24,902 [INFO]: >>> Finished "Launching the whole pipeline" in 103.4895 secs
2025-03-13 18:01:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 20154 [episode count 12/20]
[retrieval_preprocessing] for episode 73930 [episode count 13/20], we have num_retrieval=np.int64(7036) num_query=np.int64(298)
2025-03-13 18:01:27,133 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:28,765 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:28
2025-03-13 18:01:28,765 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 929.38it/s]
2025-03-13 18:01:28,814 [INFO]: There are 7036 embeddings of dim 49152
2025-03-13 18:01:28,815 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0498 secs
2025-03-13 18:01:28,815 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,815 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:28,815 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 18:01:28,815 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:28,815 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:28,815 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,815 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:28,815 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:01:28,815 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:28
2025-03-13 18:01:28,815 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:28,815 [INFO]: 	Creating the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,815 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:28
2025-03-13 18:01:28,816 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:01:28,816 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,816 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 18:01:28,816 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.84it/s] 21%|██        | 6/29 [00:00<00:00, 25.58it/s] 38%|███▊      | 11/29 [00:00<00:00, 34.19it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.75it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.25it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.85it/s]100%|██████████| 29/29 [00:06<00:00,  4.67it/s]
2025-03-13 18:01:35,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:35
2025-03-13 18:02:34,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0962 secs
2025-03-13 18:02:34,122 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:02:34,122 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 18:03:10,267 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1448 secs
2025-03-13 18:03:10,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.4529 secs
2025-03-13 18:03:10,269 [INFO]: {
2025-03-13 18:03:10,269 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:10,269 [INFO]: 	index_param: efSearch=196
2025-03-13 18:03:10,269 [INFO]: 	index_path: knn.index
2025-03-13 18:03:10,269 [INFO]: 	size in bytes: 1384291330
2025-03-13 18:03:10,269 [INFO]: 	avg_search_speed_ms: 10.453280242006201
2025-03-13 18:03:10,269 [INFO]: 	99p_search_speed_ms: 14.35753141529858
2025-03-13 18:03:10,269 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:10,269 [INFO]: 	nb vectors: 7036
2025-03-13 18:03:10,269 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:10,269 [INFO]: 	compression ratio: 0.9993083522382532
2025-03-13 18:03:10,270 [INFO]: }
2025-03-13 18:03:10,270 [INFO]: 	>>> Finished "Creating the index" in 101.4543 secs
2025-03-13 18:03:10,270 [INFO]: >>> Finished "Launching the whole pipeline" in 101.5049 secs
2025-03-13 18:03:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 73930 [episode count 13/20]
[retrieval_preprocessing] for episode 213 [episode count 14/20], we have num_retrieval=np.int64(7020) num_query=np.int64(314)
2025-03-13 18:03:13,924 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:15,587 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:15
2025-03-13 18:03:15,587 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 809.71it/s]
2025-03-13 18:03:15,658 [INFO]: There are 7020 embeddings of dim 49152
2025-03-13 18:03:15,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0707 secs
2025-03-13 18:03:15,658 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:15
2025-03-13 18:03:15,658 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:15,658 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 18:03:15,658 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:15,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:15,658 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:15
2025-03-13 18:03:15,658 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:15,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:03:15,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:15
2025-03-13 18:03:15,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:15,659 [INFO]: 	Creating the index 03/13/2025, 18:03:15
2025-03-13 18:03:15,659 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:15
2025-03-13 18:03:15,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:03:15,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:15
2025-03-13 18:03:15,660 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 18:03:15,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:06,  4.34it/s]  7%|▋         | 2/29 [00:00<00:04,  6.31it/s] 17%|█▋        | 5/29 [00:00<00:01, 13.50it/s] 28%|██▊       | 8/29 [00:00<00:01, 17.46it/s] 38%|███▊      | 11/29 [00:00<00:00, 20.14it/s] 48%|████▊     | 14/29 [00:00<00:00, 22.42it/s] 62%|██████▏   | 18/29 [00:00<00:00, 26.43it/s] 72%|███████▏  | 21/29 [00:05<00:04,  1.95it/s] 90%|████████▉ | 26/29 [00:05<00:00,  3.28it/s]100%|██████████| 29/29 [00:07<00:00,  2.53it/s]100%|██████████| 29/29 [00:07<00:00,  3.77it/s]
2025-03-13 18:03:23,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:23
2025-03-13 18:04:19,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.1358 secs
2025-03-13 18:04:19,498 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 18:04:19,498 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.20it/s]
2025-03-13 18:04:51,428 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9299 secs
2025-03-13 18:04:51,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.9835 secs
2025-03-13 18:04:51,644 [INFO]: {
2025-03-13 18:04:51,644 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:51,644 [INFO]: 	index_param: efSearch=166
2025-03-13 18:04:51,644 [INFO]: 	index_path: knn.index
2025-03-13 18:04:51,644 [INFO]: 	size in bytes: 1381143490
2025-03-13 18:04:51,645 [INFO]: 	avg_search_speed_ms: 9.340264164450483
2025-03-13 18:04:51,645 [INFO]: 	99p_search_speed_ms: 14.237672835588446
2025-03-13 18:04:51,645 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:51,645 [INFO]: 	nb vectors: 7020
2025-03-13 18:04:51,645 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:51,645 [INFO]: 	compression ratio: 0.9993083050335342
2025-03-13 18:04:51,645 [INFO]: }
2025-03-13 18:04:51,645 [INFO]: 	>>> Finished "Creating the index" in 95.9862 secs
2025-03-13 18:04:51,645 [INFO]: >>> Finished "Launching the whole pipeline" in 96.0577 secs
2025-03-13 18:04:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 213 [episode count 14/20]
[retrieval_preprocessing] for episode 68841 [episode count 15/20], we have num_retrieval=np.int64(6999) num_query=np.int64(335)
2025-03-13 18:04:54,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:55,856 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:55
2025-03-13 18:04:55,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 871.09it/s]
2025-03-13 18:04:55,901 [INFO]: There are 6999 embeddings of dim 49152
2025-03-13 18:04:55,901 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0448 secs
2025-03-13 18:04:55,902 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,902 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:55,902 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 18:04:55,902 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:55,902 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:55,902 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,902 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:55,902 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:04:55,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:55
2025-03-13 18:04:55,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:55,902 [INFO]: 	Creating the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:55
2025-03-13 18:04:55,903 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:04:55,903 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,904 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 18:04:55,904 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  9.05it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.19it/s] 45%|████▍     | 13/29 [00:00<00:00, 42.51it/s] 66%|██████▌   | 19/29 [00:00<00:00, 46.39it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.50it/s]100%|██████████| 29/29 [00:05<00:00,  3.41it/s]100%|██████████| 29/29 [00:05<00:00,  4.90it/s]
2025-03-13 18:05:01,830 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:01
2025-03-13 18:05:56,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.6350 secs
2025-03-13 18:05:56,466 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:05:56,466 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.19it/s]
2025-03-13 18:06:46,267 [INFO]: 	>>> Finished "Compute fast metrics" in 49.8017 secs
2025-03-13 18:06:46,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.3660 secs
2025-03-13 18:06:46,270 [INFO]: {
2025-03-13 18:06:46,270 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:46,270 [INFO]: 	index_param: efSearch=206
2025-03-13 18:06:46,270 [INFO]: 	index_path: knn.index
2025-03-13 18:06:46,270 [INFO]: 	size in bytes: 1377011890
2025-03-13 18:06:46,270 [INFO]: 	avg_search_speed_ms: 10.66296491950655
2025-03-13 18:06:46,270 [INFO]: 	99p_search_speed_ms: 13.477899632416666
2025-03-13 18:06:46,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:46,270 [INFO]: 	nb vectors: 6999
2025-03-13 18:06:46,270 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:46,270 [INFO]: 	compression ratio: 0.9993082862922846
2025-03-13 18:06:46,270 [INFO]: }
2025-03-13 18:06:46,270 [INFO]: 	>>> Finished "Creating the index" in 110.3678 secs
2025-03-13 18:06:46,270 [INFO]: >>> Finished "Launching the whole pipeline" in 110.4133 secs
2025-03-13 18:06:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 68841 [episode count 15/20]
[retrieval_preprocessing] for episode 89326 [episode count 16/20], we have num_retrieval=np.int64(7155) num_query=np.int64(179)
2025-03-13 18:06:49,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:51,526 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:51
2025-03-13 18:06:51,526 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.16it/s]
2025-03-13 18:06:51,571 [INFO]: There are 7155 embeddings of dim 49152
2025-03-13 18:06:51,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0451 secs
2025-03-13 18:06:51,572 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:51
2025-03-13 18:06:51,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:51,572 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 18:06:51,572 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:51,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:51,572 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:51
2025-03-13 18:06:51,572 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:51,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:06:51,572 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:51
2025-03-13 18:06:51,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:51,572 [INFO]: 	Creating the index 03/13/2025, 18:06:51
2025-03-13 18:06:51,573 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:51
2025-03-13 18:06:51,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:06:51,574 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:51
2025-03-13 18:06:51,574 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 18:06:51,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.59it/s] 17%|█▋        | 5/30 [00:00<00:01, 22.09it/s] 33%|███▎      | 10/30 [00:00<00:00, 31.33it/s] 50%|█████     | 15/30 [00:00<00:00, 36.02it/s] 67%|██████▋   | 20/30 [00:00<00:00, 38.82it/s] 80%|████████  | 24/30 [00:04<00:01,  3.00it/s] 97%|█████████▋| 29/30 [00:04<00:00,  4.50it/s]100%|██████████| 30/30 [00:06<00:00,  4.36it/s]
2025-03-13 18:06:58,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:58
2025-03-13 18:08:03,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.1667 secs
2025-03-13 18:08:03,634 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:08:03,634 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.88it/s]
2025-03-13 18:08:27,855 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2208 secs
2025-03-13 18:08:27,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.2827 secs
2025-03-13 18:08:27,857 [INFO]: {
2025-03-13 18:08:27,857 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:27,857 [INFO]: 	index_param: efSearch=209
2025-03-13 18:08:27,857 [INFO]: 	index_path: knn.index
2025-03-13 18:08:27,857 [INFO]: 	size in bytes: 1407703990
2025-03-13 18:08:27,857 [INFO]: 	avg_search_speed_ms: 10.095674001614588
2025-03-13 18:08:27,857 [INFO]: 	99p_search_speed_ms: 16.741465684026483
2025-03-13 18:08:27,857 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:27,857 [INFO]: 	nb vectors: 7155
2025-03-13 18:08:27,857 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:27,857 [INFO]: 	compression ratio: 0.9993082707679191
2025-03-13 18:08:27,857 [INFO]: }
2025-03-13 18:08:27,857 [INFO]: 	>>> Finished "Creating the index" in 96.2846 secs
2025-03-13 18:08:27,857 [INFO]: >>> Finished "Launching the whole pipeline" in 96.3307 secs
2025-03-13 18:08:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 89326 [episode count 16/20]
[retrieval_preprocessing] for episode 39173 [episode count 17/20], we have num_retrieval=np.int64(6938) num_query=np.int64(396)
2025-03-13 18:08:30,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:31,034 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:31
2025-03-13 18:08:31,034 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 18:08:31,073 [INFO]: There are 6938 embeddings of dim 49152
2025-03-13 18:08:31,074 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 18:08:31,074 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:31
2025-03-13 18:08:31,074 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:31,074 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 18:08:31,074 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:31,074 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:08:31,074 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:31
2025-03-13 18:08:31,075 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:31,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:08:31,075 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:31
2025-03-13 18:08:31,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:31,076 [INFO]: 	Creating the index 03/13/2025, 18:08:31
2025-03-13 18:08:31,076 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:31
2025-03-13 18:08:31,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:08:31,079 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:31
2025-03-13 18:08:31,079 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 18:08:31,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 17.76it/s] 28%|██▊       | 8/29 [00:00<00:00, 38.50it/s] 48%|████▊     | 14/29 [00:00<00:00, 45.21it/s] 69%|██████▉   | 20/29 [00:00<00:00, 48.02it/s] 86%|████████▌ | 25/29 [00:03<00:01,  3.94it/s]100%|██████████| 29/29 [00:05<00:00,  3.39it/s]100%|██████████| 29/29 [00:05<00:00,  5.20it/s]
2025-03-13 18:08:36,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:36
2025-03-13 18:09:29,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4833 secs
2025-03-13 18:09:29,150 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:09:29,150 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.23it/s] 50%|█████     | 2/4 [00:00<00:00,  5.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.34it/s]
2025-03-13 18:10:06,567 [INFO]: 	>>> Finished "Compute fast metrics" in 37.4162 secs
2025-03-13 18:10:06,569 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.4901 secs
2025-03-13 18:10:06,569 [INFO]: {
2025-03-13 18:10:06,569 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:06,569 [INFO]: 	index_param: efSearch=205
2025-03-13 18:10:06,569 [INFO]: 	index_path: knn.index
2025-03-13 18:10:06,569 [INFO]: 	size in bytes: 1365010450
2025-03-13 18:10:06,570 [INFO]: 	avg_search_speed_ms: 11.998700779500894
2025-03-13 18:10:06,570 [INFO]: 	99p_search_speed_ms: 20.203299326822158
2025-03-13 18:10:06,570 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:06,570 [INFO]: 	nb vectors: 6938
2025-03-13 18:10:06,570 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:06,570 [INFO]: 	compression ratio: 0.9993083232439722
2025-03-13 18:10:06,570 [INFO]: }
2025-03-13 18:10:06,570 [INFO]: 	>>> Finished "Creating the index" in 95.4941 secs
2025-03-13 18:10:06,570 [INFO]: >>> Finished "Launching the whole pipeline" in 95.5358 secs
2025-03-13 18:10:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 39173 [episode count 17/20]
[retrieval_preprocessing] for episode 57611 [episode count 18/20], we have num_retrieval=np.int64(6338) num_query=np.int64(996)
2025-03-13 18:10:10,586 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:11,696 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:11
2025-03-13 18:10:11,696 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 834.85it/s]
2025-03-13 18:10:11,748 [INFO]: There are 6338 embeddings of dim 49152
2025-03-13 18:10:11,748 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0524 secs
2025-03-13 18:10:11,748 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:11
2025-03-13 18:10:11,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:11,749 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 18:10:11,749 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:11,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 18:10:11,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:11
2025-03-13 18:10:11,750 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:11,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:10:11,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:11
2025-03-13 18:10:11,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:11,751 [INFO]: 	Creating the index 03/13/2025, 18:10:11
2025-03-13 18:10:11,751 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:11
2025-03-13 18:10:11,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:10:11,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:11
2025-03-13 18:10:11,755 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 18:10:11,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  9.26it/s] 19%|█▉        | 5/26 [00:00<00:00, 26.39it/s] 38%|███▊      | 10/26 [00:00<00:00, 33.58it/s] 58%|█████▊    | 15/26 [00:00<00:00, 37.38it/s] 77%|███████▋  | 20/26 [00:00<00:00, 40.22it/s] 96%|█████████▌| 25/26 [00:04<00:00,  3.18it/s]100%|██████████| 26/26 [00:06<00:00,  3.90it/s]
2025-03-13 18:10:18,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:18
2025-03-13 18:11:17,621 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1933 secs
2025-03-13 18:11:17,621 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 18:11:17,621 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.38it/s]
2025-03-13 18:12:02,614 [INFO]: 	>>> Finished "Compute fast metrics" in 44.9926 secs
2025-03-13 18:12:02,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.8612 secs
2025-03-13 18:12:02,616 [INFO]: {
2025-03-13 18:12:02,616 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:02,616 [INFO]: 	index_param: efSearch=191
2025-03-13 18:12:02,616 [INFO]: 	index_path: knn.index
2025-03-13 18:12:02,616 [INFO]: 	size in bytes: 1246963930
2025-03-13 18:12:02,616 [INFO]: 	avg_search_speed_ms: 9.104458584888306
2025-03-13 18:12:02,616 [INFO]: 	99p_search_speed_ms: 13.668918008916076
2025-03-13 18:12:02,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:02,616 [INFO]: 	nb vectors: 6338
2025-03-13 18:12:02,616 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:02,616 [INFO]: 	compression ratio: 0.999308379353042
2025-03-13 18:12:02,616 [INFO]: }
2025-03-13 18:12:02,616 [INFO]: 	>>> Finished "Creating the index" in 110.8652 secs
2025-03-13 18:12:02,616 [INFO]: >>> Finished "Launching the whole pipeline" in 110.9206 secs
2025-03-13 18:12:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 57611 [episode count 18/20]
[retrieval_preprocessing] for episode 83230 [episode count 19/20], we have num_retrieval=np.int64(7003) num_query=np.int64(331)
2025-03-13 18:12:11,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:12,584 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:12
2025-03-13 18:12:12,585 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-13 18:12:12,641 [INFO]: There are 7003 embeddings of dim 49152
2025-03-13 18:12:12,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0569 secs
2025-03-13 18:12:12,642 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,642 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:12,642 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 18:12:12,642 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:12,642 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:12,642 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,642 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:12,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:12:12,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:12
2025-03-13 18:12:12,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:12,642 [INFO]: 	Creating the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:12
2025-03-13 18:12:12,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:12:12,644 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,644 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 18:12:12,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.83it/s] 17%|█▋        | 5/29 [00:00<00:01, 19.79it/s] 31%|███       | 9/29 [00:00<00:00, 27.06it/s] 45%|████▍     | 13/29 [00:00<00:00, 31.14it/s] 59%|█████▊    | 17/29 [00:00<00:00, 33.69it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.32it/s] 83%|████████▎ | 24/29 [00:05<00:01,  3.11it/s]100%|██████████| 29/29 [00:07<00:00,  2.72it/s]100%|██████████| 29/29 [00:07<00:00,  3.85it/s]
2025-03-13 18:12:20,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:20
2025-03-13 18:13:25,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.8149 secs
2025-03-13 18:13:25,988 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 18:13:25,988 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.85it/s]
2025-03-13 18:14:17,844 [INFO]: 	>>> Finished "Compute fast metrics" in 51.8556 secs
2025-03-13 18:14:18,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.5455 secs
2025-03-13 18:14:18,189 [INFO]: {
2025-03-13 18:14:18,190 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:18,190 [INFO]: 	index_param: efSearch=200
2025-03-13 18:14:18,190 [INFO]: 	index_path: knn.index
2025-03-13 18:14:18,190 [INFO]: 	size in bytes: 1377798910
2025-03-13 18:14:18,190 [INFO]: 	avg_search_speed_ms: 10.579318959492618
2025-03-13 18:14:18,190 [INFO]: 	99p_search_speed_ms: 17.405840735882517
2025-03-13 18:14:18,190 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:18,190 [INFO]: 	nb vectors: 7003
2025-03-13 18:14:18,190 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:18,190 [INFO]: 	compression ratio: 0.9993082546421814
2025-03-13 18:14:18,190 [INFO]: }
2025-03-13 18:14:18,190 [INFO]: 	>>> Finished "Creating the index" in 125.5480 secs
2025-03-13 18:14:18,190 [INFO]: >>> Finished "Launching the whole pipeline" in 125.6057 secs
2025-03-13 18:14:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 83230 [episode count 19/20]
2025-03-13 18:14:21: [retrieval_preprocessing] finished for 488975025_put_one_slice_of_bread_in_toaster [chosen_id count 6/196]
2025-03-13 18:14:25: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 488975025_put_two_slices_of_bread_in_toaster [chosen_id count 7/196]
2025-03-13 18:14:25: [retrieval_preprocessing] we have num_total=11583 embedding_dim=49152
[retrieval_preprocessing] for episode 6666 [episode count 0/20], we have num_retrieval=np.int64(11067) num_query=np.int64(516)
2025-03-13 18:14:26,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:28,710 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:28
2025-03-13 18:14:28,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1055.17it/s]
2025-03-13 18:14:28,754 [INFO]: There are 11067 embeddings of dim 49152
2025-03-13 18:14:28,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0439 secs
2025-03-13 18:14:28,754 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:28
2025-03-13 18:14:28,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:28,754 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:14:28,754 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:14:28,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:14:28,754 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:28
2025-03-13 18:14:28,755 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:28,755 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:14:28,755 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:28
2025-03-13 18:14:28,755 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:28,755 [INFO]: 	Creating the index 03/13/2025, 18:14:28
2025-03-13 18:14:28,755 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:14:28
2025-03-13 18:14:28,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 18:14:28,757 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:28
2025-03-13 18:14:28,757 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:14:28,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  7.02it/s] 11%|█         | 5/46 [00:00<00:01, 23.18it/s] 22%|██▏       | 10/46 [00:00<00:01, 31.89it/s] 33%|███▎      | 15/46 [00:00<00:00, 36.00it/s] 43%|████▎     | 20/46 [00:00<00:00, 38.58it/s] 52%|█████▏    | 24/46 [00:07<00:12,  1.78it/s] 61%|██████    | 28/46 [00:07<00:07,  2.52it/s] 67%|██████▋   | 31/46 [00:07<00:04,  3.26it/s] 74%|███████▍  | 34/46 [00:07<00:02,  4.25it/s] 83%|████████▎ | 38/46 [00:07<00:01,  5.97it/s] 91%|█████████▏| 42/46 [00:16<00:03,  1.21it/s] 98%|█████████▊| 45/46 [00:16<00:00,  1.60it/s]100%|██████████| 46/46 [00:20<00:00,  2.27it/s]
2025-03-13 18:14:49,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:49
2025-03-13 18:16:14,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.7310 secs
2025-03-13 18:16:14,779 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 18:16:14,780 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 18:17:28,261 [INFO]: 	>>> Finished "Compute fast metrics" in 73.4808 secs
2025-03-13 18:17:28,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 179.5050 secs
2025-03-13 18:17:28,262 [INFO]: {
2025-03-13 18:17:28,262 [INFO]: 	index_key: HNSW32
2025-03-13 18:17:28,262 [INFO]: 	index_param: efSearch=111
2025-03-13 18:17:28,262 [INFO]: 	index_path: knn.index
2025-03-13 18:17:28,262 [INFO]: 	size in bytes: 2178869798
2025-03-13 18:17:28,262 [INFO]: 	avg_search_speed_ms: 11.56125840289529
2025-03-13 18:17:28,262 [INFO]: 	99p_search_speed_ms: 25.359168769791726
2025-03-13 18:17:28,262 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:28,262 [INFO]: 	nb vectors: 11067
2025-03-13 18:17:28,262 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:28,262 [INFO]: 	compression ratio: 0.9986189803526755
2025-03-13 18:17:28,262 [INFO]: }
2025-03-13 18:17:28,262 [INFO]: 	>>> Finished "Creating the index" in 179.5070 secs
2025-03-13 18:17:28,262 [INFO]: >>> Finished "Launching the whole pipeline" in 179.5521 secs
2025-03-13 18:17:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 6666 [episode count 0/20]
[retrieval_preprocessing] for episode 68625 [episode count 1/20], we have num_retrieval=np.int64(10945) num_query=np.int64(638)
2025-03-13 18:17:33,138 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:34,833 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:34
2025-03-13 18:17:34,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-13 18:17:34,873 [INFO]: There are 10945 embeddings of dim 49152
2025-03-13 18:17:34,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0401 secs
2025-03-13 18:17:34,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:34
2025-03-13 18:17:34,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:34,874 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 18:17:34,874 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:17:34,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:34,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:34
2025-03-13 18:17:34,874 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:34,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:34,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:34
2025-03-13 18:17:34,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:34,874 [INFO]: 	Creating the index 03/13/2025, 18:17:34
2025-03-13 18:17:34,874 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:17:34
2025-03-13 18:17:34,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 18:17:34,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:34
2025-03-13 18:17:34,876 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:17:34,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  5.93it/s] 11%|█         | 5/46 [00:00<00:01, 20.52it/s] 22%|██▏       | 10/46 [00:00<00:01, 30.17it/s] 33%|███▎      | 15/46 [00:00<00:00, 35.22it/s] 43%|████▎     | 20/46 [00:00<00:00, 38.14it/s] 52%|█████▏    | 24/46 [00:06<00:10,  2.03it/s] 59%|█████▊    | 27/46 [00:06<00:07,  2.57it/s] 65%|██████▌   | 30/46 [00:07<00:04,  3.26it/s] 70%|██████▉   | 32/46 [00:07<00:03,  3.85it/s] 74%|███████▍  | 34/46 [00:07<00:02,  4.60it/s] 78%|███████▊  | 36/46 [00:07<00:01,  5.55it/s] 83%|████████▎ | 38/46 [00:07<00:01,  6.64it/s] 87%|████████▋ | 40/46 [00:07<00:00,  7.89it/s] 91%|█████████▏| 42/46 [00:15<00:04,  1.17s/it]100%|██████████| 46/46 [00:17<00:00,  1.09it/s]100%|██████████| 46/46 [00:17<00:00,  2.56it/s]
2025-03-13 18:17:52,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:52
2025-03-13 18:19:15,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.6155 secs
2025-03-13 18:19:15,472 [INFO]: The best hyperparameters are: efSearch=71
2025-03-13 18:19:15,472 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-13 18:20:00,789 [INFO]: 	>>> Finished "Compute fast metrics" in 45.3167 secs
2025-03-13 18:20:00,791 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.9155 secs
2025-03-13 18:20:00,791 [INFO]: {
2025-03-13 18:20:00,791 [INFO]: 	index_key: HNSW32
2025-03-13 18:20:00,791 [INFO]: 	index_param: efSearch=71
2025-03-13 18:20:00,791 [INFO]: 	index_path: knn.index
2025-03-13 18:20:00,791 [INFO]: 	size in bytes: 2154850158
2025-03-13 18:20:00,791 [INFO]: 	avg_search_speed_ms: 7.465166590565732
2025-03-13 18:20:00,791 [INFO]: 	99p_search_speed_ms: 12.50227099750189
2025-03-13 18:20:00,791 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:00,791 [INFO]: 	nb vectors: 10945
2025-03-13 18:20:00,791 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:00,791 [INFO]: 	compression ratio: 0.9986191160489963
2025-03-13 18:20:00,791 [INFO]: }
2025-03-13 18:20:00,791 [INFO]: 	>>> Finished "Creating the index" in 145.9172 secs
2025-03-13 18:20:00,791 [INFO]: >>> Finished "Launching the whole pipeline" in 145.9580 secs
2025-03-13 18:20:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 68625 [episode count 1/20]
[retrieval_preprocessing] for episode 29213 [episode count 2/20], we have num_retrieval=np.int64(11132) num_query=np.int64(451)
2025-03-13 18:20:08,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:10,156 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:10
2025-03-13 18:20:10,156 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.27it/s]
2025-03-13 18:20:10,186 [INFO]: There are 11132 embeddings of dim 49152
2025-03-13 18:20:10,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 18:20:10,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:10
2025-03-13 18:20:10,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:10,187 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:20:10,187 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:20:10,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:10,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:10
2025-03-13 18:20:10,187 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:10,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:10,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:10
2025-03-13 18:20:10,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:10,187 [INFO]: 	Creating the index 03/13/2025, 18:20:10
2025-03-13 18:20:10,187 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:20:10
2025-03-13 18:20:10,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 18:20:10,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:10
2025-03-13 18:20:10,188 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:20:10,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:10,  4.42it/s]  7%|▋         | 3/46 [00:00<00:05,  8.44it/s] 11%|█         | 5/46 [00:00<00:03, 10.63it/s] 15%|█▌        | 7/46 [00:00<00:03, 12.03it/s] 20%|█▉        | 9/46 [00:00<00:02, 12.97it/s] 24%|██▍       | 11/46 [00:00<00:02, 13.11it/s] 28%|██▊       | 13/46 [00:01<00:02, 12.69it/s] 33%|███▎      | 15/46 [00:01<00:02, 13.02it/s] 37%|███▋      | 17/46 [00:01<00:02, 13.24it/s] 41%|████▏     | 19/46 [00:01<00:02, 13.44it/s] 46%|████▌     | 21/46 [00:08<00:26,  1.07s/it] 48%|████▊     | 22/46 [00:08<00:21,  1.11it/s] 50%|█████     | 23/46 [00:08<00:17,  1.35it/s] 52%|█████▏    | 24/46 [00:08<00:13,  1.67it/s] 54%|█████▍    | 25/46 [00:08<00:10,  2.07it/s] 57%|█████▋    | 26/46 [00:08<00:07,  2.59it/s] 59%|█████▊    | 27/46 [00:08<00:05,  3.20it/s] 61%|██████    | 28/46 [00:08<00:04,  3.88it/s] 63%|██████▎   | 29/46 [00:09<00:03,  4.60it/s] 65%|██████▌   | 30/46 [00:09<00:03,  5.25it/s] 67%|██████▋   | 31/46 [00:09<00:02,  5.87it/s] 70%|██████▉   | 32/46 [00:09<00:02,  6.50it/s] 72%|███████▏  | 33/46 [00:09<00:01,  7.01it/s] 74%|███████▍  | 34/46 [00:09<00:01,  7.30it/s] 76%|███████▌  | 35/46 [00:09<00:01,  7.52it/s] 78%|███████▊  | 36/46 [00:09<00:01,  7.75it/s] 80%|████████  | 37/46 [00:10<00:01,  8.10it/s] 83%|████████▎ | 38/46 [00:10<00:00,  8.40it/s] 85%|████████▍ | 39/46 [00:10<00:00,  8.66it/s] 87%|████████▋ | 40/46 [00:10<00:00,  8.74it/s] 89%|████████▉ | 41/46 [00:10<00:00,  8.81it/s] 91%|█████████▏| 42/46 [00:18<00:09,  2.49s/it] 93%|█████████▎| 43/46 [00:18<00:05,  1.78s/it] 98%|█████████▊| 45/46 [00:18<00:00,  1.00it/s]100%|██████████| 46/46 [00:22<00:00,  1.74s/it]100%|██████████| 46/46 [00:22<00:00,  2.01it/s]
2025-03-13 18:20:33,051 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:33
2025-03-13 18:22:02,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.8596 secs
2025-03-13 18:22:02,911 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 18:22:02,911 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.94it/s]
2025-03-13 18:23:01,012 [INFO]: 	>>> Finished "Compute fast metrics" in 58.1010 secs
2025-03-13 18:23:01,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 171.1974 secs
2025-03-13 18:23:01,386 [INFO]: {
2025-03-13 18:23:01,386 [INFO]: 	index_key: HNSW32
2025-03-13 18:23:01,387 [INFO]: 	index_param: efSearch=112
2025-03-13 18:23:01,387 [INFO]: 	index_path: knn.index
2025-03-13 18:23:01,387 [INFO]: 	size in bytes: 2191667122
2025-03-13 18:23:01,387 [INFO]: 	avg_search_speed_ms: 11.438938848476099
2025-03-13 18:23:01,387 [INFO]: 	99p_search_speed_ms: 19.806542759761214
2025-03-13 18:23:01,387 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:01,387 [INFO]: 	nb vectors: 11132
2025-03-13 18:23:01,387 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:01,387 [INFO]: 	compression ratio: 0.9986189207432021
2025-03-13 18:23:01,387 [INFO]: }
2025-03-13 18:23:01,387 [INFO]: 	>>> Finished "Creating the index" in 171.1997 secs
2025-03-13 18:23:01,387 [INFO]: >>> Finished "Launching the whole pipeline" in 171.2312 secs
2025-03-13 18:23:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 29213 [episode count 2/20]
[retrieval_preprocessing] for episode 1572 [episode count 3/20], we have num_retrieval=np.int64(11051) num_query=np.int64(532)
2025-03-13 18:23:08,129 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:09,818 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:09
2025-03-13 18:23:09,818 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1332.37it/s]
2025-03-13 18:23:09,846 [INFO]: There are 11051 embeddings of dim 49152
2025-03-13 18:23:09,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:23:09,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:09
2025-03-13 18:23:09,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:09,847 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:23:09,847 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:23:09,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:23:09,847 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:09
2025-03-13 18:23:09,847 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:09,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:23:09,847 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:09
2025-03-13 18:23:09,847 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:09,847 [INFO]: 	Creating the index 03/13/2025, 18:23:09
2025-03-13 18:23:09,847 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:23:09
2025-03-13 18:23:09,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 18:23:09,849 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:09
2025-03-13 18:23:09,849 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:23:09,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:10,  4.14it/s]  4%|▍         | 2/46 [00:00<00:08,  5.32it/s]  7%|▋         | 3/46 [00:00<00:07,  5.86it/s]  9%|▊         | 4/46 [00:00<00:06,  6.29it/s] 11%|█         | 5/46 [00:00<00:06,  6.77it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.31it/s] 20%|█▉        | 9/46 [00:01<00:04,  9.13it/s] 22%|██▏       | 10/46 [00:01<00:03,  9.16it/s] 26%|██▌       | 12/46 [00:01<00:03,  9.70it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.72it/s] 30%|███       | 14/46 [00:01<00:03,  9.62it/s] 35%|███▍      | 16/46 [00:01<00:03,  9.09it/s] 37%|███▋      | 17/46 [00:02<00:03,  9.14it/s] 39%|███▉      | 18/46 [00:02<00:03,  9.18it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.18it/s] 43%|████▎     | 20/46 [00:02<00:02,  9.16it/s] 46%|████▌     | 21/46 [00:08<00:44,  1.77s/it] 48%|████▊     | 22/46 [00:08<00:31,  1.30s/it] 50%|█████     | 23/46 [00:08<00:22,  1.05it/s] 52%|█████▏    | 24/46 [00:08<00:16,  1.36it/s] 54%|█████▍    | 25/46 [00:08<00:11,  1.80it/s] 57%|█████▋    | 26/46 [00:09<00:08,  2.33it/s] 59%|█████▊    | 27/46 [00:09<00:06,  2.93it/s] 61%|██████    | 28/46 [00:09<00:04,  3.70it/s] 63%|██████▎   | 29/46 [00:09<00:03,  4.44it/s] 67%|██████▋   | 31/46 [00:09<00:02,  6.75it/s] 72%|███████▏  | 33/46 [00:09<00:01,  9.05it/s] 76%|███████▌  | 35/46 [00:09<00:01, 10.97it/s] 80%|████████  | 37/46 [00:10<00:00, 10.33it/s] 85%|████████▍ | 39/46 [00:10<00:00,  9.21it/s] 89%|████████▉ | 41/46 [00:10<00:00,  8.70it/s] 93%|█████████▎| 43/46 [00:18<00:03,  1.25s/it]100%|██████████| 46/46 [00:20<00:00,  1.14s/it]100%|██████████| 46/46 [00:20<00:00,  2.19it/s]
2025-03-13 18:23:30,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:30
2025-03-13 18:25:12,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.7975 secs
2025-03-13 18:25:12,612 [INFO]: The best hyperparameters are: efSearch=81
2025-03-13 18:25:12,613 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-13 18:26:26,437 [INFO]: 	>>> Finished "Compute fast metrics" in 73.8242 secs
2025-03-13 18:26:26,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 196.5895 secs
2025-03-13 18:26:26,439 [INFO]: {
2025-03-13 18:26:26,439 [INFO]: 	index_key: HNSW32
2025-03-13 18:26:26,439 [INFO]: 	index_param: efSearch=81
2025-03-13 18:26:26,439 [INFO]: 	index_path: knn.index
2025-03-13 18:26:26,439 [INFO]: 	size in bytes: 2175719526
2025-03-13 18:26:26,439 [INFO]: 	avg_search_speed_ms: 8.939629995120129
2025-03-13 18:26:26,439 [INFO]: 	99p_search_speed_ms: 14.431979856453834
2025-03-13 18:26:26,439 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:26,439 [INFO]: 	nb vectors: 11051
2025-03-13 18:26:26,439 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:26,439 [INFO]: 	compression ratio: 0.9986190692485425
2025-03-13 18:26:26,439 [INFO]: }
2025-03-13 18:26:26,439 [INFO]: 	>>> Finished "Creating the index" in 196.5913 secs
2025-03-13 18:26:26,439 [INFO]: >>> Finished "Launching the whole pipeline" in 196.6204 secs
2025-03-13 18:26:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 1572 [episode count 3/20]
[retrieval_preprocessing] for episode 8790 [episode count 4/20], we have num_retrieval=np.int64(11165) num_query=np.int64(418)
2025-03-13 18:26:33,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:36,274 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:36
2025-03-13 18:26:36,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1307.04it/s]
2025-03-13 18:26:36,306 [INFO]: There are 11165 embeddings of dim 49152
2025-03-13 18:26:36,307 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 18:26:36,307 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:36
2025-03-13 18:26:36,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:36,307 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:26:36,308 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:26:36,308 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:26:36,308 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:36
2025-03-13 18:26:36,308 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:36,309 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 18:26:36,309 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:36
2025-03-13 18:26:36,309 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:26:36,310 [INFO]: 	Creating the index 03/13/2025, 18:26:36
2025-03-13 18:26:36,310 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:26:36
2025-03-13 18:26:36,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 18:26:36,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:36
2025-03-13 18:26:36,313 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:26:36,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:12,  3.69it/s]  4%|▍         | 2/46 [00:00<00:08,  5.21it/s]  7%|▋         | 3/46 [00:00<00:07,  6.00it/s]  9%|▊         | 4/46 [00:00<00:06,  6.43it/s] 11%|█         | 5/46 [00:00<00:06,  6.74it/s] 13%|█▎        | 6/46 [00:00<00:05,  6.84it/s] 15%|█▌        | 7/46 [00:01<00:05,  6.90it/s] 17%|█▋        | 8/46 [00:01<00:05,  6.96it/s] 20%|█▉        | 9/46 [00:01<00:05,  7.05it/s] 22%|██▏       | 10/46 [00:01<00:04,  7.38it/s] 24%|██▍       | 11/46 [00:01<00:04,  7.91it/s] 26%|██▌       | 12/46 [00:01<00:04,  8.23it/s] 28%|██▊       | 13/46 [00:01<00:03,  8.61it/s] 33%|███▎      | 15/46 [00:02<00:03,  9.14it/s] 37%|███▋      | 17/46 [00:02<00:03,  9.50it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.86it/s] 46%|████▌     | 21/46 [00:09<00:33,  1.33s/it] 48%|████▊     | 22/46 [00:09<00:26,  1.09s/it] 52%|█████▏    | 24/46 [00:10<00:16,  1.36it/s] 57%|█████▋    | 26/46 [00:10<00:10,  1.94it/s] 61%|██████    | 28/46 [00:10<00:06,  2.65it/s] 65%|██████▌   | 30/46 [00:10<00:04,  3.48it/s] 70%|██████▉   | 32/46 [00:10<00:03,  4.41it/s] 74%|███████▍  | 34/46 [00:11<00:02,  5.39it/s] 78%|███████▊  | 36/46 [00:11<00:01,  6.36it/s] 83%|████████▎ | 38/46 [00:11<00:01,  7.23it/s] 87%|████████▋ | 40/46 [00:11<00:00,  8.08it/s] 91%|█████████▏| 42/46 [00:21<00:06,  1.52s/it] 93%|█████████▎| 43/46 [00:21<00:03,  1.28s/it] 96%|█████████▌| 44/46 [00:21<00:02,  1.04s/it] 98%|█████████▊| 45/46 [00:21<00:00,  1.20it/s]100%|██████████| 46/46 [00:25<00:00,  1.54s/it]100%|██████████| 46/46 [00:25<00:00,  1.82it/s]
2025-03-13 18:27:01,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:01
2025-03-13 18:28:33,880 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.3076 secs
2025-03-13 18:28:33,881 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 18:28:33,881 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s]
2025-03-13 18:29:45,165 [INFO]: 	>>> Finished "Compute fast metrics" in 71.2841 secs
2025-03-13 18:29:45,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 188.8533 secs
2025-03-13 18:29:45,167 [INFO]: {
2025-03-13 18:29:45,167 [INFO]: 	index_key: HNSW32
2025-03-13 18:29:45,167 [INFO]: 	index_param: efSearch=99
2025-03-13 18:29:45,167 [INFO]: 	index_path: knn.index
2025-03-13 18:29:45,167 [INFO]: 	size in bytes: 2198164286
2025-03-13 18:29:45,167 [INFO]: 	avg_search_speed_ms: 11.362427349244667
2025-03-13 18:29:45,167 [INFO]: 	99p_search_speed_ms: 21.431162329390652
2025-03-13 18:29:45,167 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:45,167 [INFO]: 	nb vectors: 11165
2025-03-13 18:29:45,167 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:45,167 [INFO]: 	compression ratio: 0.9986188630124982
2025-03-13 18:29:45,167 [INFO]: }
2025-03-13 18:29:45,167 [INFO]: 	>>> Finished "Creating the index" in 188.8572 secs
2025-03-13 18:29:45,167 [INFO]: >>> Finished "Launching the whole pipeline" in 188.8932 secs
2025-03-13 18:29:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 8790 [episode count 4/20]
[retrieval_preprocessing] for episode 76900 [episode count 5/20], we have num_retrieval=np.int64(10921) num_query=np.int64(662)
2025-03-13 18:29:51,905 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:53,706 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:53
2025-03-13 18:29:53,706 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 995.09it/s]
2025-03-13 18:29:53,735 [INFO]: There are 10921 embeddings of dim 49152
2025-03-13 18:29:53,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:29:53,736 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:53
2025-03-13 18:29:53,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:53,736 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 18:29:53,736 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:29:53,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:29:53,737 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:53
2025-03-13 18:29:53,737 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:53,737 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:29:53,737 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:53
2025-03-13 18:29:53,738 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:29:53,738 [INFO]: 	Creating the index 03/13/2025, 18:29:53
2025-03-13 18:29:53,738 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:29:53
2025-03-13 18:29:53,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 18:29:53,741 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:53
2025-03-13 18:29:53,741 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:29:53,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.47it/s]  7%|▋         | 3/45 [00:00<00:04,  8.51it/s] 11%|█         | 5/45 [00:00<00:04,  9.96it/s] 16%|█▌        | 7/45 [00:00<00:03, 10.53it/s] 20%|██        | 9/45 [00:00<00:03, 10.79it/s] 24%|██▍       | 11/45 [00:01<00:03, 10.81it/s] 29%|██▉       | 13/45 [00:01<00:02, 11.88it/s] 33%|███▎      | 15/45 [00:01<00:02, 12.19it/s] 38%|███▊      | 17/45 [00:01<00:02, 11.63it/s] 42%|████▏     | 19/45 [00:01<00:02, 11.39it/s] 47%|████▋     | 21/45 [00:07<00:23,  1.04it/s] 49%|████▉     | 22/45 [00:07<00:18,  1.22it/s] 51%|█████     | 23/45 [00:07<00:15,  1.46it/s] 53%|█████▎    | 24/45 [00:08<00:11,  1.78it/s] 56%|█████▌    | 25/45 [00:08<00:09,  2.19it/s] 58%|█████▊    | 26/45 [00:08<00:06,  2.73it/s] 62%|██████▏   | 28/45 [00:08<00:04,  3.92it/s] 64%|██████▍   | 29/45 [00:08<00:03,  4.45it/s] 67%|██████▋   | 30/45 [00:08<00:03,  4.95it/s] 69%|██████▉   | 31/45 [00:08<00:02,  5.49it/s] 71%|███████   | 32/45 [00:09<00:02,  5.97it/s] 73%|███████▎  | 33/45 [00:09<00:01,  6.32it/s] 76%|███████▌  | 34/45 [00:09<00:01,  6.58it/s] 78%|███████▊  | 35/45 [00:09<00:01,  6.73it/s] 80%|████████  | 36/45 [00:09<00:01,  6.97it/s] 82%|████████▏ | 37/45 [00:09<00:01,  7.06it/s] 84%|████████▍ | 38/45 [00:09<00:00,  7.07it/s] 87%|████████▋ | 39/45 [00:10<00:00,  7.16it/s] 89%|████████▉ | 40/45 [00:10<00:00,  7.25it/s] 91%|█████████ | 41/45 [00:10<00:00,  7.40it/s] 93%|█████████▎| 42/45 [00:17<00:06,  2.18s/it] 96%|█████████▌| 43/45 [00:17<00:03,  1.56s/it]100%|██████████| 45/45 [00:19<00:00,  1.44s/it]100%|██████████| 45/45 [00:19<00:00,  2.25it/s]
2025-03-13 18:30:13,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:13
2025-03-13 18:31:33,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.2810 secs
2025-03-13 18:31:33,988 [INFO]: The best hyperparameters are: efSearch=95
2025-03-13 18:31:33,988 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 18:32:02,156 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1678 secs
2025-03-13 18:32:02,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.4165 secs
2025-03-13 18:32:02,158 [INFO]: {
2025-03-13 18:32:02,158 [INFO]: 	index_key: HNSW32
2025-03-13 18:32:02,158 [INFO]: 	index_param: efSearch=95
2025-03-13 18:32:02,158 [INFO]: 	index_path: knn.index
2025-03-13 18:32:02,158 [INFO]: 	size in bytes: 2150124878
2025-03-13 18:32:02,158 [INFO]: 	avg_search_speed_ms: 10.437999607760137
2025-03-13 18:32:02,158 [INFO]: 	99p_search_speed_ms: 19.89027945324778
2025-03-13 18:32:02,158 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:02,159 [INFO]: 	nb vectors: 10921
2025-03-13 18:32:02,159 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:02,159 [INFO]: 	compression ratio: 0.998619191829099
2025-03-13 18:32:02,159 [INFO]: }
2025-03-13 18:32:02,159 [INFO]: 	>>> Finished "Creating the index" in 128.4206 secs
2025-03-13 18:32:02,159 [INFO]: >>> Finished "Launching the whole pipeline" in 128.4523 secs
2025-03-13 18:32:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 76900 [episode count 5/20]
[retrieval_preprocessing] for episode 91762 [episode count 6/20], we have num_retrieval=np.int64(11000) num_query=np.int64(583)
2025-03-13 18:32:10,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:12,017 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:12
2025-03-13 18:32:12,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.21it/s]
2025-03-13 18:32:12,046 [INFO]: There are 11000 embeddings of dim 49152
2025-03-13 18:32:12,046 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:32:12,046 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:12
2025-03-13 18:32:12,046 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:12,046 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 18:32:12,046 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:32:12,046 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:32:12,046 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:12
2025-03-13 18:32:12,046 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:12,046 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:32:12,046 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:12
2025-03-13 18:32:12,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:12,047 [INFO]: 	Creating the index 03/13/2025, 18:32:12
2025-03-13 18:32:12,047 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:32:12
2025-03-13 18:32:12,048 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 18:32:12,048 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:12
2025-03-13 18:32:12,048 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:32:12,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:11,  4.05it/s]  4%|▍         | 2/46 [00:00<00:07,  5.70it/s]  7%|▋         | 3/46 [00:00<00:06,  6.67it/s]  9%|▊         | 4/46 [00:00<00:05,  7.36it/s] 11%|█         | 5/46 [00:00<00:05,  7.66it/s] 13%|█▎        | 6/46 [00:00<00:05,  7.87it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.00it/s] 17%|█▋        | 8/46 [00:01<00:04,  8.12it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.25it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.27it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.27it/s] 26%|██▌       | 12/46 [00:01<00:03,  8.63it/s] 30%|███       | 14/46 [00:01<00:03,  9.68it/s] 33%|███▎      | 15/46 [00:01<00:03,  9.64it/s] 37%|███▋      | 17/46 [00:01<00:02, 10.64it/s] 41%|████▏     | 19/46 [00:02<00:03,  8.79it/s] 43%|████▎     | 20/46 [00:02<00:02,  8.68it/s] 46%|████▌     | 21/46 [00:08<00:35,  1.42s/it] 48%|████▊     | 22/46 [00:08<00:26,  1.10s/it] 52%|█████▏    | 24/46 [00:08<00:14,  1.47it/s] 57%|█████▋    | 26/46 [00:08<00:09,  2.16it/s] 61%|██████    | 28/46 [00:08<00:05,  3.01it/s] 65%|██████▌   | 30/46 [00:09<00:04,  3.97it/s] 70%|██████▉   | 32/46 [00:09<00:02,  5.03it/s] 74%|███████▍  | 34/46 [00:09<00:01,  6.12it/s] 78%|███████▊  | 36/46 [00:09<00:01,  7.19it/s] 83%|████████▎ | 38/46 [00:09<00:00,  8.19it/s] 87%|████████▋ | 40/46 [00:09<00:00,  9.05it/s] 91%|█████████▏| 42/46 [00:15<00:03,  1.08it/s] 93%|█████████▎| 43/46 [00:15<00:02,  1.29it/s] 98%|█████████▊| 45/46 [00:15<00:00,  1.84it/s]100%|██████████| 46/46 [00:18<00:00,  1.09it/s]100%|██████████| 46/46 [00:18<00:00,  2.53it/s]
2025-03-13 18:32:30,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:30
2025-03-13 18:33:49,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.1717 secs
2025-03-13 18:33:49,412 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 18:33:49,412 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 18:34:24,659 [INFO]: 	>>> Finished "Compute fast metrics" in 35.2470 secs
2025-03-13 18:34:24,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.6118 secs
2025-03-13 18:34:24,660 [INFO]: {
2025-03-13 18:34:24,660 [INFO]: 	index_key: HNSW32
2025-03-13 18:34:24,660 [INFO]: 	index_param: efSearch=122
2025-03-13 18:34:24,660 [INFO]: 	index_path: knn.index
2025-03-13 18:34:24,660 [INFO]: 	size in bytes: 2165678466
2025-03-13 18:34:24,660 [INFO]: 	avg_search_speed_ms: 13.483132426488913
2025-03-13 18:34:24,660 [INFO]: 	99p_search_speed_ms: 30.760882727336167
2025-03-13 18:34:24,660 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:24,660 [INFO]: 	nb vectors: 11000
2025-03-13 18:34:24,660 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:24,660 [INFO]: 	compression ratio: 0.9986191551299287
2025-03-13 18:34:24,660 [INFO]: }
2025-03-13 18:34:24,660 [INFO]: 	>>> Finished "Creating the index" in 132.6135 secs
2025-03-13 18:34:24,660 [INFO]: >>> Finished "Launching the whole pipeline" in 132.6436 secs
2025-03-13 18:34:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 91762 [episode count 6/20]
[retrieval_preprocessing] for episode 7388 [episode count 7/20], we have num_retrieval=np.int64(11045) num_query=np.int64(538)
2025-03-13 18:34:32,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:34,415 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:34
2025-03-13 18:34:34,415 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-13 18:34:34,440 [INFO]: There are 11045 embeddings of dim 49152
2025-03-13 18:34:34,440 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 18:34:34,440 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:34
2025-03-13 18:34:34,440 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:34,440 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:34:34,440 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:34:34,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:34,440 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:34
2025-03-13 18:34:34,441 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:34,441 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:34,441 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:34
2025-03-13 18:34:34,441 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:34,441 [INFO]: 	Creating the index 03/13/2025, 18:34:34
2025-03-13 18:34:34,441 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:34:34
2025-03-13 18:34:34,442 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 18:34:34,442 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:34
2025-03-13 18:34:34,442 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:34:34,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:10,  4.45it/s]  7%|▋         | 3/46 [00:00<00:05,  8.03it/s] 11%|█         | 5/46 [00:00<00:04,  9.48it/s] 15%|█▌        | 7/46 [00:00<00:03, 10.22it/s] 20%|█▉        | 9/46 [00:00<00:03, 11.11it/s] 24%|██▍       | 11/46 [00:01<00:03, 11.51it/s] 28%|██▊       | 13/46 [00:01<00:02, 11.67it/s] 33%|███▎      | 15/46 [00:01<00:02, 11.89it/s] 37%|███▋      | 17/46 [00:01<00:02, 12.02it/s] 41%|████▏     | 19/46 [00:01<00:02, 11.90it/s] 46%|████▌     | 21/46 [00:07<00:23,  1.07it/s] 54%|█████▍    | 25/46 [00:07<00:10,  1.96it/s] 63%|██████▎   | 29/46 [00:07<00:05,  3.16it/s] 72%|███████▏  | 33/46 [00:07<00:02,  4.75it/s] 80%|████████  | 37/46 [00:07<00:01,  6.80it/s] 89%|████████▉ | 41/46 [00:07<00:00,  9.32it/s] 98%|█████████▊| 45/46 [00:15<00:00,  1.41it/s]100%|██████████| 46/46 [00:19<00:00,  2.40it/s]
2025-03-13 18:34:53,573 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:53
2025-03-13 18:36:22,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.2854 secs
2025-03-13 18:36:22,859 [INFO]: The best hyperparameters are: efSearch=93
2025-03-13 18:36:22,860 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.84it/s]
2025-03-13 18:37:05,514 [INFO]: 	>>> Finished "Compute fast metrics" in 42.6539 secs
2025-03-13 18:37:05,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.0917 secs
2025-03-13 18:37:05,534 [INFO]: {
2025-03-13 18:37:05,534 [INFO]: 	index_key: HNSW32
2025-03-13 18:37:05,534 [INFO]: 	index_param: efSearch=93
2025-03-13 18:37:05,534 [INFO]: 	index_path: knn.index
2025-03-13 18:37:05,534 [INFO]: 	size in bytes: 2174538270
2025-03-13 18:37:05,534 [INFO]: 	avg_search_speed_ms: 10.73042653469057
2025-03-13 18:37:05,534 [INFO]: 	99p_search_speed_ms: 17.68418617313727
2025-03-13 18:37:05,534 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:05,534 [INFO]: 	nb vectors: 11045
2025-03-13 18:37:05,534 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:05,534 [INFO]: 	compression ratio: 0.9986190585645568
2025-03-13 18:37:05,534 [INFO]: }
2025-03-13 18:37:05,534 [INFO]: 	>>> Finished "Creating the index" in 151.0932 secs
2025-03-13 18:37:05,534 [INFO]: >>> Finished "Launching the whole pipeline" in 151.1190 secs
2025-03-13 18:37:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 7388 [episode count 7/20]
[retrieval_preprocessing] for episode 84191 [episode count 8/20], we have num_retrieval=np.int64(11009) num_query=np.int64(574)
2025-03-13 18:37:12,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:14,386 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:14
2025-03-13 18:37:14,387 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2009.73it/s]
2025-03-13 18:37:14,414 [INFO]: There are 11009 embeddings of dim 49152
2025-03-13 18:37:14,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 18:37:14,415 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:14
2025-03-13 18:37:14,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:14,415 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 18:37:14,415 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:37:14,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:37:14,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:14
2025-03-13 18:37:14,415 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:14,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:37:14,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:14
2025-03-13 18:37:14,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:14,415 [INFO]: 	Creating the index 03/13/2025, 18:37:14
2025-03-13 18:37:14,415 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:37:14
2025-03-13 18:37:14,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 18:37:14,417 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:14
2025-03-13 18:37:14,417 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:37:14,417 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:09,  4.65it/s]  7%|▋         | 3/46 [00:00<00:05,  8.45it/s] 11%|█         | 5/46 [00:00<00:04,  9.17it/s] 15%|█▌        | 7/46 [00:00<00:03,  9.88it/s] 20%|█▉        | 9/46 [00:00<00:03, 10.09it/s] 24%|██▍       | 11/46 [00:01<00:03, 10.05it/s] 28%|██▊       | 13/46 [00:01<00:03, 10.07it/s] 33%|███▎      | 15/46 [00:01<00:03, 10.10it/s] 37%|███▋      | 17/46 [00:01<00:02,  9.86it/s] 41%|████▏     | 19/46 [00:01<00:02, 10.18it/s] 46%|████▌     | 21/46 [00:08<00:25,  1.01s/it] 48%|████▊     | 22/46 [00:08<00:20,  1.18it/s] 52%|█████▏    | 24/46 [00:08<00:12,  1.69it/s] 57%|█████▋    | 26/46 [00:08<00:08,  2.34it/s] 61%|██████    | 28/46 [00:08<00:05,  3.14it/s] 65%|██████▌   | 30/46 [00:08<00:03,  4.10it/s] 70%|██████▉   | 32/46 [00:09<00:02,  5.10it/s] 74%|███████▍  | 34/46 [00:09<00:01,  6.15it/s] 78%|███████▊  | 36/46 [00:09<00:01,  7.19it/s] 83%|████████▎ | 38/46 [00:09<00:00,  8.13it/s] 87%|████████▋ | 40/46 [00:09<00:00,  8.94it/s] 91%|█████████▏| 42/46 [00:17<00:04,  1.21s/it] 93%|█████████▎| 43/46 [00:17<00:03,  1.03s/it] 96%|█████████▌| 44/46 [00:17<00:01,  1.17it/s]100%|██████████| 46/46 [00:20<00:00,  1.08s/it]100%|██████████| 46/46 [00:20<00:00,  2.23it/s]
2025-03-13 18:37:35,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:35
2025-03-13 18:38:53,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.8885 secs
2025-03-13 18:38:53,904 [INFO]: The best hyperparameters are: efSearch=107
2025-03-13 18:38:53,904 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s]
2025-03-13 18:39:24,305 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4009 secs
2025-03-13 18:39:24,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.8903 secs
2025-03-13 18:39:24,307 [INFO]: {
2025-03-13 18:39:24,307 [INFO]: 	index_key: HNSW32
2025-03-13 18:39:24,307 [INFO]: 	index_param: efSearch=107
2025-03-13 18:39:24,307 [INFO]: 	index_path: knn.index
2025-03-13 18:39:24,307 [INFO]: 	size in bytes: 2167450478
2025-03-13 18:39:24,307 [INFO]: 	avg_search_speed_ms: 11.875867718087417
2025-03-13 18:39:24,307 [INFO]: 	99p_search_speed_ms: 22.364285152871172
2025-03-13 18:39:24,307 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:24,307 [INFO]: 	nb vectors: 11009
2025-03-13 18:39:24,307 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:24,307 [INFO]: 	compression ratio: 0.9986191121640935
2025-03-13 18:39:24,307 [INFO]: }
2025-03-13 18:39:24,307 [INFO]: 	>>> Finished "Creating the index" in 129.8920 secs
2025-03-13 18:39:24,307 [INFO]: >>> Finished "Launching the whole pipeline" in 129.9207 secs
2025-03-13 18:39:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 84191 [episode count 8/20]
[retrieval_preprocessing] for episode 7927 [episode count 9/20], we have num_retrieval=np.int64(11130) num_query=np.int64(453)
2025-03-13 18:39:33,609 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:35,488 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:35
2025-03-13 18:39:35,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1176.85it/s]
2025-03-13 18:39:35,513 [INFO]: There are 11130 embeddings of dim 49152
2025-03-13 18:39:35,514 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:39:35,514 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:35
2025-03-13 18:39:35,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:35,515 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:39:35,515 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:39:35,515 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:39:35,515 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:35
2025-03-13 18:39:35,516 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:35,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:39:35,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:35
2025-03-13 18:39:35,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:39:35,517 [INFO]: 	Creating the index 03/13/2025, 18:39:35
2025-03-13 18:39:35,517 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:39:35
2025-03-13 18:39:35,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0018 secs
2025-03-13 18:39:35,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:35
2025-03-13 18:39:35,519 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:39:35,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:10,  4.11it/s]  4%|▍         | 2/46 [00:00<00:07,  6.23it/s]  7%|▋         | 3/46 [00:00<00:05,  7.52it/s]  9%|▊         | 4/46 [00:00<00:05,  8.13it/s] 13%|█▎        | 6/46 [00:00<00:04,  9.07it/s] 17%|█▋        | 8/46 [00:01<00:04,  8.57it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.24it/s] 24%|██▍       | 11/46 [00:01<00:03,  9.03it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.50it/s] 33%|███▎      | 15/46 [00:01<00:03,  9.74it/s] 37%|███▋      | 17/46 [00:01<00:02,  9.87it/s] 39%|███▉      | 18/46 [00:02<00:02,  9.88it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.84it/s] 43%|████▎     | 20/46 [00:02<00:02,  9.73it/s] 46%|████▌     | 21/46 [00:07<00:36,  1.47s/it] 48%|████▊     | 22/46 [00:07<00:26,  1.11s/it] 52%|█████▏    | 24/46 [00:08<00:14,  1.49it/s] 57%|█████▋    | 26/46 [00:08<00:08,  2.24it/s] 61%|██████    | 28/46 [00:08<00:05,  3.13it/s] 65%|██████▌   | 30/46 [00:08<00:03,  4.14it/s] 70%|██████▉   | 32/46 [00:08<00:02,  5.25it/s] 74%|███████▍  | 34/46 [00:08<00:01,  6.37it/s] 78%|███████▊  | 36/46 [00:09<00:01,  7.46it/s] 83%|████████▎ | 38/46 [00:09<00:00,  8.47it/s] 87%|████████▋ | 40/46 [00:09<00:00,  9.27it/s] 91%|█████████▏| 42/46 [00:15<00:04,  1.05s/it] 96%|█████████▌| 44/46 [00:15<00:01,  1.32it/s]100%|██████████| 46/46 [00:19<00:00,  1.00it/s]100%|██████████| 46/46 [00:19<00:00,  2.41it/s]
2025-03-13 18:39:54,614 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:54
2025-03-13 18:41:12,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.0873 secs
2025-03-13 18:41:12,703 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 18:41:12,703 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s]
2025-03-13 18:42:10,978 [INFO]: 	>>> Finished "Compute fast metrics" in 58.2755 secs
2025-03-13 18:42:10,980 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.4605 secs
2025-03-13 18:42:10,980 [INFO]: {
2025-03-13 18:42:10,980 [INFO]: 	index_key: HNSW32
2025-03-13 18:42:10,980 [INFO]: 	index_param: efSearch=105
2025-03-13 18:42:10,980 [INFO]: 	index_path: knn.index
2025-03-13 18:42:10,980 [INFO]: 	size in bytes: 2191273370
2025-03-13 18:42:10,980 [INFO]: 	avg_search_speed_ms: 9.888476016195012
2025-03-13 18:42:10,980 [INFO]: 	99p_search_speed_ms: 18.31831622170284
2025-03-13 18:42:10,980 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:10,980 [INFO]: 	nb vectors: 11130
2025-03-13 18:42:10,980 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:10,980 [INFO]: 	compression ratio: 0.9986189171823869
2025-03-13 18:42:10,980 [INFO]: }
2025-03-13 18:42:10,980 [INFO]: 	>>> Finished "Creating the index" in 155.4634 secs
2025-03-13 18:42:10,980 [INFO]: >>> Finished "Launching the whole pipeline" in 155.4921 secs
2025-03-13 18:42:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 7927 [episode count 9/20]
[retrieval_preprocessing] for episode 72962 [episode count 10/20], we have num_retrieval=np.int64(10403) num_query=np.int64(1180)
2025-03-13 18:42:18,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:21,193 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:21
2025-03-13 18:42:21,193 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1000.07it/s]
2025-03-13 18:42:21,226 [INFO]: There are 10403 embeddings of dim 49152
2025-03-13 18:42:21,226 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 18:42:21,226 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,227 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:21,227 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 18:42:21,227 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:42:21,227 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:42:21,227 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,228 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:21,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:42:21,228 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:21
2025-03-13 18:42:21,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:42:21,228 [INFO]: 	Creating the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,228 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:42:21
2025-03-13 18:42:21,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 18:42:21,232 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,232 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 18:42:21,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:10,  4.08it/s]  5%|▍         | 2/43 [00:00<00:06,  5.87it/s]  7%|▋         | 3/43 [00:00<00:05,  6.92it/s]  9%|▉         | 4/43 [00:00<00:05,  7.57it/s] 12%|█▏        | 5/43 [00:00<00:04,  8.12it/s] 14%|█▍        | 6/43 [00:00<00:04,  8.08it/s] 16%|█▋        | 7/43 [00:00<00:04,  8.15it/s] 19%|█▊        | 8/43 [00:01<00:04,  8.29it/s] 21%|██        | 9/43 [00:01<00:04,  8.44it/s] 23%|██▎       | 10/43 [00:01<00:03,  8.51it/s] 26%|██▌       | 11/43 [00:01<00:03,  8.59it/s] 28%|██▊       | 12/43 [00:01<00:03,  8.76it/s] 30%|███       | 13/43 [00:01<00:03,  8.75it/s] 33%|███▎      | 14/43 [00:01<00:03,  8.78it/s] 35%|███▍      | 15/43 [00:01<00:03,  8.78it/s] 37%|███▋      | 16/43 [00:01<00:03,  8.81it/s] 40%|███▉      | 17/43 [00:02<00:02,  8.89it/s] 42%|████▏     | 18/43 [00:02<00:02,  8.79it/s] 44%|████▍     | 19/43 [00:02<00:02,  8.69it/s] 47%|████▋     | 20/43 [00:02<00:02,  8.70it/s] 49%|████▉     | 21/43 [00:07<00:37,  1.71s/it] 53%|█████▎    | 23/43 [00:08<00:19,  1.04it/s] 58%|█████▊    | 25/43 [00:08<00:10,  1.65it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.43it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.39it/s] 72%|███████▏  | 31/43 [00:08<00:02,  4.56it/s] 77%|███████▋  | 33/43 [00:08<00:01,  5.87it/s] 81%|████████▏ | 35/43 [00:08<00:01,  7.30it/s] 86%|████████▌ | 37/43 [00:08<00:00,  8.67it/s] 91%|█████████ | 39/43 [00:09<00:00, 10.13it/s] 95%|█████████▌| 41/43 [00:09<00:00, 11.49it/s]100%|██████████| 43/43 [00:17<00:00,  1.38s/it]100%|██████████| 43/43 [00:17<00:00,  2.40it/s]
2025-03-13 18:42:39,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:39
2025-03-13 18:43:58,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.4570 secs
2025-03-13 18:43:58,650 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 18:43:58,650 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 18:44:33,598 [INFO]: 	>>> Finished "Compute fast metrics" in 34.9476 secs
2025-03-13 18:44:33,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.7506 secs
2025-03-13 18:44:33,983 [INFO]: {
2025-03-13 18:44:33,983 [INFO]: 	index_key: HNSW32
2025-03-13 18:44:33,983 [INFO]: 	index_param: efSearch=101
2025-03-13 18:44:33,983 [INFO]: 	index_path: knn.index
2025-03-13 18:44:33,983 [INFO]: 	size in bytes: 2048140934
2025-03-13 18:44:33,983 [INFO]: 	avg_search_speed_ms: 8.63757648904179
2025-03-13 18:44:33,984 [INFO]: 	99p_search_speed_ms: 13.411261385772377
2025-03-13 18:44:33,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:33,984 [INFO]: 	nb vectors: 10403
2025-03-13 18:44:33,984 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:33,984 [INFO]: 	compression ratio: 0.9986192795851812
2025-03-13 18:44:33,984 [INFO]: }
2025-03-13 18:44:33,984 [INFO]: 	>>> Finished "Creating the index" in 132.7554 secs
2025-03-13 18:44:33,984 [INFO]: >>> Finished "Launching the whole pipeline" in 132.7912 secs
2025-03-13 18:44:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 72962 [episode count 10/20]
[retrieval_preprocessing] for episode 60703 [episode count 11/20], we have num_retrieval=np.int64(10696) num_query=np.int64(887)
2025-03-13 18:44:44,405 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:46,097 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:46
2025-03-13 18:44:46,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1045.44it/s]
2025-03-13 18:44:46,124 [INFO]: There are 10696 embeddings of dim 49152
2025-03-13 18:44:46,124 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:44:46,124 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:46
2025-03-13 18:44:46,124 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:46,124 [INFO]: 		-> Add: 5.9 seconds
2025-03-13 18:44:46,124 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:44:46,124 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:44:46,124 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:46
2025-03-13 18:44:46,125 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:46,125 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:44:46,125 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:46
2025-03-13 18:44:46,125 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:46,125 [INFO]: 	Creating the index 03/13/2025, 18:44:46
2025-03-13 18:44:46,125 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:44:46
2025-03-13 18:44:46,126 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 18:44:46,126 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:46
2025-03-13 18:44:46,126 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:44:46,126 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:09,  4.40it/s]  4%|▍         | 2/45 [00:00<00:06,  6.52it/s]  7%|▋         | 3/45 [00:00<00:05,  7.48it/s]  9%|▉         | 4/45 [00:00<00:05,  7.99it/s] 11%|█         | 5/45 [00:00<00:04,  8.20it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.32it/s] 16%|█▌        | 7/45 [00:00<00:04,  8.51it/s] 18%|█▊        | 8/45 [00:01<00:04,  8.52it/s] 20%|██        | 9/45 [00:01<00:04,  8.55it/s] 22%|██▏       | 10/45 [00:01<00:04,  8.59it/s] 24%|██▍       | 11/45 [00:01<00:03,  8.64it/s] 27%|██▋       | 12/45 [00:01<00:03,  8.80it/s] 29%|██▉       | 13/45 [00:01<00:03,  8.83it/s] 31%|███       | 14/45 [00:01<00:03,  8.79it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.85it/s] 38%|███▊      | 17/45 [00:01<00:02, 10.13it/s] 42%|████▏     | 19/45 [00:02<00:02, 11.00it/s] 47%|████▋     | 21/45 [00:07<00:23,  1.04it/s] 51%|█████     | 23/45 [00:07<00:14,  1.52it/s] 56%|█████▌    | 25/45 [00:07<00:09,  2.14it/s] 60%|██████    | 27/45 [00:07<00:06,  2.92it/s] 64%|██████▍   | 29/45 [00:07<00:04,  3.85it/s] 69%|██████▉   | 31/45 [00:07<00:02,  4.97it/s] 73%|███████▎  | 33/45 [00:08<00:01,  6.14it/s] 78%|███████▊  | 35/45 [00:08<00:01,  7.34it/s] 82%|████████▏ | 37/45 [00:08<00:00,  8.46it/s] 87%|████████▋ | 39/45 [00:08<00:00,  9.54it/s] 91%|█████████ | 41/45 [00:08<00:00, 10.59it/s] 96%|█████████▌| 43/45 [00:15<00:02,  1.03s/it]100%|██████████| 45/45 [00:16<00:00,  1.00s/it]100%|██████████| 45/45 [00:16<00:00,  2.66it/s]
2025-03-13 18:45:03,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:03
2025-03-13 18:46:19,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.5940 secs
2025-03-13 18:46:19,616 [INFO]: The best hyperparameters are: efSearch=118
2025-03-13 18:46:19,616 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 50%|█████     | 2/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 18:47:12,795 [INFO]: 	>>> Finished "Compute fast metrics" in 53.1787 secs
2025-03-13 18:47:12,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.6695 secs
2025-03-13 18:47:12,796 [INFO]: {
2025-03-13 18:47:12,796 [INFO]: 	index_key: HNSW32
2025-03-13 18:47:12,796 [INFO]: 	index_param: efSearch=118
2025-03-13 18:47:12,796 [INFO]: 	index_path: knn.index
2025-03-13 18:47:12,796 [INFO]: 	size in bytes: 2105826498
2025-03-13 18:47:12,796 [INFO]: 	avg_search_speed_ms: 10.354082707959703
2025-03-13 18:47:12,796 [INFO]: 	99p_search_speed_ms: 20.41330538922921
2025-03-13 18:47:12,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:12,796 [INFO]: 	nb vectors: 10696
2025-03-13 18:47:12,796 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:12,796 [INFO]: 	compression ratio: 0.9986193876832867
2025-03-13 18:47:12,796 [INFO]: }
2025-03-13 18:47:12,796 [INFO]: 	>>> Finished "Creating the index" in 146.6710 secs
2025-03-13 18:47:12,796 [INFO]: >>> Finished "Launching the whole pipeline" in 146.6984 secs
2025-03-13 18:47:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 60703 [episode count 11/20]
[retrieval_preprocessing] for episode 84267 [episode count 12/20], we have num_retrieval=np.int64(11016) num_query=np.int64(567)
2025-03-13 18:47:21,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:23,411 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:23
2025-03-13 18:47:23,411 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.85it/s]
2025-03-13 18:47:23,437 [INFO]: There are 11016 embeddings of dim 49152
2025-03-13 18:47:23,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:47:23,437 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,437 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:23,437 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:47:23,437 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:47:23,437 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:47:23,437 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,438 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:23,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:47:23,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:23
2025-03-13 18:47:23,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:23,438 [INFO]: 	Creating the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,438 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:47:23
2025-03-13 18:47:23,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 18:47:23,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,439 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:47:23,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:11,  3.99it/s]  4%|▍         | 2/46 [00:00<00:07,  6.17it/s]  9%|▊         | 4/46 [00:00<00:05,  7.02it/s] 11%|█         | 5/46 [00:00<00:05,  7.14it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.50it/s] 20%|█▉        | 9/46 [00:01<00:03,  9.70it/s] 24%|██▍       | 11/46 [00:01<00:03, 10.40it/s] 28%|██▊       | 13/46 [00:01<00:02, 11.57it/s] 33%|███▎      | 15/46 [00:01<00:02, 11.86it/s] 37%|███▋      | 17/46 [00:01<00:02, 10.26it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.44it/s] 43%|████▎     | 20/46 [00:02<00:02,  9.12it/s] 46%|████▌     | 21/46 [00:07<00:31,  1.26s/it] 48%|████▊     | 22/46 [00:07<00:23,  1.00it/s] 52%|█████▏    | 24/46 [00:08<00:14,  1.57it/s] 57%|█████▋    | 26/46 [00:08<00:08,  2.28it/s] 61%|██████    | 28/46 [00:08<00:05,  3.12it/s] 65%|██████▌   | 30/46 [00:08<00:03,  4.11it/s] 70%|██████▉   | 32/46 [00:08<00:02,  5.19it/s] 74%|███████▍  | 34/46 [00:08<00:01,  6.29it/s] 78%|███████▊  | 36/46 [00:09<00:01,  7.37it/s] 83%|████████▎ | 38/46 [00:09<00:00,  8.55it/s] 87%|████████▋ | 40/46 [00:09<00:00,  9.35it/s] 91%|█████████▏| 42/46 [00:15<00:03,  1.02it/s] 96%|█████████▌| 44/46 [00:15<00:01,  1.41it/s]100%|██████████| 46/46 [00:18<00:00,  1.13it/s]100%|██████████| 46/46 [00:18<00:00,  2.53it/s]
2025-03-13 18:47:41,651 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:41
2025-03-13 18:48:59,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.0256 secs
2025-03-13 18:48:59,677 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 18:48:59,677 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 18:49:40,507 [INFO]: 	>>> Finished "Compute fast metrics" in 40.8294 secs
2025-03-13 18:49:40,508 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.0689 secs
2025-03-13 18:49:40,508 [INFO]: {
2025-03-13 18:49:40,508 [INFO]: 	index_key: HNSW32
2025-03-13 18:49:40,508 [INFO]: 	index_param: efSearch=106
2025-03-13 18:49:40,508 [INFO]: 	index_path: knn.index
2025-03-13 18:49:40,508 [INFO]: 	size in bytes: 2168828738
2025-03-13 18:49:40,508 [INFO]: 	avg_search_speed_ms: 8.248577462071276
2025-03-13 18:49:40,508 [INFO]: 	99p_search_speed_ms: 13.996813024859904
2025-03-13 18:49:40,508 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:40,508 [INFO]: 	nb vectors: 11016
2025-03-13 18:49:40,508 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:40,508 [INFO]: 	compression ratio: 0.9986190656977545
2025-03-13 18:49:40,508 [INFO]: }
2025-03-13 18:49:40,508 [INFO]: 	>>> Finished "Creating the index" in 137.0702 secs
2025-03-13 18:49:40,508 [INFO]: >>> Finished "Launching the whole pipeline" in 137.0974 secs
2025-03-13 18:49:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 84267 [episode count 12/20]
[retrieval_preprocessing] for episode 48996 [episode count 13/20], we have num_retrieval=np.int64(11203) num_query=np.int64(380)
2025-03-13 18:49:48,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:49,717 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:49
2025-03-13 18:49:49,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 821.77it/s]
2025-03-13 18:49:49,781 [INFO]: There are 11203 embeddings of dim 49152
2025-03-13 18:49:49,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0640 secs
2025-03-13 18:49:49,782 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:49
2025-03-13 18:49:49,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:49,782 [INFO]: 		-> Add: 6.2 seconds
2025-03-13 18:49:49,782 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:49:49,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:49:49,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:49
2025-03-13 18:49:49,783 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:49,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:49:49,783 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:49
2025-03-13 18:49:49,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:49,783 [INFO]: 	Creating the index 03/13/2025, 18:49:49
2025-03-13 18:49:49,783 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:49:49
2025-03-13 18:49:49,785 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0017 secs
2025-03-13 18:49:49,785 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:49
2025-03-13 18:49:49,785 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-13 18:49:49,785 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/47 [00:00<?, ?it/s]  2%|▏         | 1/47 [00:00<00:06,  7.22it/s] 13%|█▎        | 6/47 [00:00<00:01, 28.83it/s] 26%|██▌       | 12/47 [00:00<00:00, 40.43it/s] 38%|███▊      | 18/47 [00:00<00:00, 46.28it/s] 49%|████▉     | 23/47 [00:06<00:10,  2.39it/s] 57%|█████▋    | 27/47 [00:06<00:06,  3.09it/s] 64%|██████▍   | 30/47 [00:06<00:04,  3.67it/s] 68%|██████▊   | 32/47 [00:07<00:03,  4.10it/s] 72%|███████▏  | 34/47 [00:07<00:02,  4.67it/s] 77%|███████▋  | 36/47 [00:07<00:02,  5.29it/s] 81%|████████  | 38/47 [00:07<00:01,  6.02it/s] 85%|████████▌ | 40/47 [00:07<00:01,  6.78it/s] 89%|████████▉ | 42/47 [00:15<00:05,  1.15s/it] 98%|█████████▊| 46/47 [00:15<00:00,  1.52it/s]100%|██████████| 47/47 [00:19<00:00,  2.46it/s]
2025-03-13 18:50:08,926 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:08
2025-03-13 18:51:43,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 94.5906 secs
2025-03-13 18:51:43,517 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 18:51:43,518 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s]
2025-03-13 18:52:27,032 [INFO]: 	>>> Finished "Compute fast metrics" in 43.5145 secs
2025-03-13 18:52:27,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 157.2484 secs
2025-03-13 18:52:27,034 [INFO]: {
2025-03-13 18:52:27,034 [INFO]: 	index_key: HNSW32
2025-03-13 18:52:27,034 [INFO]: 	index_param: efSearch=91
2025-03-13 18:52:27,034 [INFO]: 	index_path: knn.index
2025-03-13 18:52:27,034 [INFO]: 	size in bytes: 2205645702
2025-03-13 18:52:27,034 [INFO]: 	avg_search_speed_ms: 9.66819121801372
2025-03-13 18:52:27,034 [INFO]: 	99p_search_speed_ms: 16.19476144202053
2025-03-13 18:52:27,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:27,034 [INFO]: 	nb vectors: 11203
2025-03-13 18:52:27,034 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:27,034 [INFO]: 	compression ratio: 0.9986188724702079
2025-03-13 18:52:27,034 [INFO]: }
2025-03-13 18:52:27,034 [INFO]: 	>>> Finished "Creating the index" in 157.2507 secs
2025-03-13 18:52:27,034 [INFO]: >>> Finished "Launching the whole pipeline" in 157.3163 secs
2025-03-13 18:52:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 48996 [episode count 13/20]
[retrieval_preprocessing] for episode 87423 [episode count 14/20], we have num_retrieval=np.int64(11019) num_query=np.int64(564)
2025-03-13 18:52:33,551 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:35,048 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:35
2025-03-13 18:52:35,048 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.61it/s]
2025-03-13 18:52:35,075 [INFO]: There are 11019 embeddings of dim 49152
2025-03-13 18:52:35,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:52:35,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:35
2025-03-13 18:52:35,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:35,075 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:52:35,075 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:52:35,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:52:35,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:35
2025-03-13 18:52:35,076 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:35,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:52:35,076 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:35
2025-03-13 18:52:35,076 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:35,076 [INFO]: 	Creating the index 03/13/2025, 18:52:35
2025-03-13 18:52:35,076 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:52:35
2025-03-13 18:52:35,077 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 18:52:35,078 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:35
2025-03-13 18:52:35,078 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:52:35,078 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:11,  3.94it/s]  4%|▍         | 2/46 [00:00<00:07,  5.81it/s]  7%|▋         | 3/46 [00:00<00:06,  6.90it/s]  9%|▊         | 4/46 [00:00<00:05,  7.54it/s] 11%|█         | 5/46 [00:00<00:05,  7.96it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.35it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.49it/s] 17%|█▋        | 8/46 [00:01<00:04,  8.53it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.65it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.70it/s] 26%|██▌       | 12/46 [00:01<00:03,  9.19it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.07it/s] 30%|███       | 14/46 [00:01<00:03,  9.09it/s] 35%|███▍      | 16/46 [00:01<00:03,  9.38it/s] 37%|███▋      | 17/46 [00:02<00:03,  9.48it/s] 41%|████▏     | 19/46 [00:02<00:02, 10.23it/s] 46%|████▌     | 21/46 [00:08<00:29,  1.19s/it] 48%|████▊     | 22/46 [00:08<00:23,  1.03it/s] 50%|█████     | 23/46 [00:08<00:17,  1.29it/s] 52%|█████▏    | 24/46 [00:08<00:13,  1.64it/s] 54%|█████▍    | 25/46 [00:08<00:10,  2.08it/s] 57%|█████▋    | 26/46 [00:08<00:07,  2.62it/s] 61%|██████    | 28/46 [00:09<00:04,  3.92it/s] 63%|██████▎   | 29/46 [00:09<00:03,  4.53it/s] 65%|██████▌   | 30/46 [00:09<00:03,  5.14it/s] 67%|██████▋   | 31/46 [00:09<00:02,  5.72it/s] 72%|███████▏  | 33/46 [00:09<00:01,  7.02it/s] 76%|███████▌  | 35/46 [00:09<00:01,  7.89it/s] 80%|████████  | 37/46 [00:10<00:01,  8.65it/s] 85%|████████▍ | 39/46 [00:10<00:00,  9.08it/s] 87%|████████▋ | 40/46 [00:10<00:00,  9.05it/s] 89%|████████▉ | 41/46 [00:10<00:00,  8.95it/s] 91%|█████████▏| 42/46 [00:19<00:08,  2.17s/it] 93%|█████████▎| 43/46 [00:19<00:04,  1.65s/it] 98%|█████████▊| 45/46 [00:19<00:01,  1.00s/it]100%|██████████| 46/46 [00:23<00:00,  1.59s/it]100%|██████████| 46/46 [00:23<00:00,  1.98it/s]
2025-03-13 18:52:58,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:58
2025-03-13 18:54:27,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.5345 secs
2025-03-13 18:54:27,818 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 18:54:27,818 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 18:55:05,691 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8721 secs
2025-03-13 18:55:05,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.6144 secs
2025-03-13 18:55:05,692 [INFO]: {
2025-03-13 18:55:05,692 [INFO]: 	index_key: HNSW32
2025-03-13 18:55:05,692 [INFO]: 	index_param: efSearch=92
2025-03-13 18:55:05,692 [INFO]: 	index_path: knn.index
2025-03-13 18:55:05,692 [INFO]: 	size in bytes: 2169419494
2025-03-13 18:55:05,692 [INFO]: 	avg_search_speed_ms: 9.256028379442998
2025-03-13 18:55:05,692 [INFO]: 	99p_search_speed_ms: 19.29041234543548
2025-03-13 18:55:05,692 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:05,692 [INFO]: 	nb vectors: 11019
2025-03-13 18:55:05,692 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:05,692 [INFO]: 	compression ratio: 0.9986190121328374
2025-03-13 18:55:05,692 [INFO]: }
2025-03-13 18:55:05,692 [INFO]: 	>>> Finished "Creating the index" in 150.6159 secs
2025-03-13 18:55:05,692 [INFO]: >>> Finished "Launching the whole pipeline" in 150.6443 secs
2025-03-13 18:55:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 87423 [episode count 14/20]
[retrieval_preprocessing] for episode 75688 [episode count 15/20], we have num_retrieval=np.int64(11071) num_query=np.int64(512)
2025-03-13 18:55:12,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:14,493 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:14
2025-03-13 18:55:14,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.20it/s]
2025-03-13 18:55:14,521 [INFO]: There are 11071 embeddings of dim 49152
2025-03-13 18:55:14,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 18:55:14,522 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:14
2025-03-13 18:55:14,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:14,522 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:55:14,522 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:55:14,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:55:14,522 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:14
2025-03-13 18:55:14,523 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:14,523 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:55:14,523 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:14
2025-03-13 18:55:14,523 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:55:14,524 [INFO]: 	Creating the index 03/13/2025, 18:55:14
2025-03-13 18:55:14,524 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:55:14
2025-03-13 18:55:14,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 18:55:14,527 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:14
2025-03-13 18:55:14,527 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:55:14,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:10,  4.49it/s]  7%|▋         | 3/46 [00:00<00:05,  8.51it/s] 11%|█         | 5/46 [00:00<00:03, 10.34it/s] 15%|█▌        | 7/46 [00:00<00:03, 11.20it/s] 20%|█▉        | 9/46 [00:00<00:03, 11.68it/s] 24%|██▍       | 11/46 [00:01<00:02, 11.93it/s] 28%|██▊       | 13/46 [00:01<00:02, 12.09it/s] 33%|███▎      | 15/46 [00:01<00:02, 12.05it/s] 37%|███▋      | 17/46 [00:01<00:02, 12.08it/s] 41%|████▏     | 19/46 [00:01<00:02, 12.43it/s] 46%|████▌     | 21/46 [00:07<00:24,  1.02it/s] 50%|█████     | 23/46 [00:07<00:16,  1.42it/s] 54%|█████▍    | 25/46 [00:07<00:10,  1.97it/s] 59%|█████▊    | 27/46 [00:08<00:07,  2.63it/s] 63%|██████▎   | 29/46 [00:08<00:04,  3.44it/s] 67%|██████▋   | 31/46 [00:08<00:03,  4.38it/s] 72%|███████▏  | 33/46 [00:08<00:02,  5.41it/s] 76%|███████▌  | 35/46 [00:08<00:01,  6.47it/s] 80%|████████  | 37/46 [00:08<00:01,  7.53it/s] 85%|████████▍ | 39/46 [00:09<00:00,  8.54it/s] 89%|████████▉ | 41/46 [00:09<00:00,  9.43it/s] 93%|█████████▎| 43/46 [00:16<00:03,  1.10s/it] 98%|█████████▊| 45/46 [00:16<00:00,  1.26it/s]100%|██████████| 46/46 [00:19<00:00,  1.17s/it]100%|██████████| 46/46 [00:19<00:00,  2.40it/s]
2025-03-13 18:55:33,713 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:33
2025-03-13 18:56:56,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.9545 secs
2025-03-13 18:56:56,669 [INFO]: The best hyperparameters are: efSearch=85
2025-03-13 18:56:56,669 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 18:57:35,764 [INFO]: 	>>> Finished "Compute fast metrics" in 39.0946 secs
2025-03-13 18:57:35,765 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.2379 secs
2025-03-13 18:57:35,765 [INFO]: {
2025-03-13 18:57:35,765 [INFO]: 	index_key: HNSW32
2025-03-13 18:57:35,765 [INFO]: 	index_param: efSearch=85
2025-03-13 18:57:35,765 [INFO]: 	index_path: knn.index
2025-03-13 18:57:35,765 [INFO]: 	size in bytes: 2179657302
2025-03-13 18:57:35,765 [INFO]: 	avg_search_speed_ms: 9.397786530347442
2025-03-13 18:57:35,765 [INFO]: 	99p_search_speed_ms: 15.716954064555457
2025-03-13 18:57:35,765 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:35,765 [INFO]: 	nb vectors: 11071
2025-03-13 18:57:35,766 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:35,766 [INFO]: 	compression ratio: 0.9986189874907225
2025-03-13 18:57:35,766 [INFO]: }
2025-03-13 18:57:35,766 [INFO]: 	>>> Finished "Creating the index" in 141.2418 secs
2025-03-13 18:57:35,766 [INFO]: >>> Finished "Launching the whole pipeline" in 141.2729 secs
2025-03-13 18:57:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 75688 [episode count 15/20]
[retrieval_preprocessing] for episode 4587 [episode count 16/20], we have num_retrieval=np.int64(11098) num_query=np.int64(485)
2025-03-13 18:57:39,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:41,556 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:41
2025-03-13 18:57:41,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.54it/s]
2025-03-13 18:57:41,599 [INFO]: There are 11098 embeddings of dim 49152
2025-03-13 18:57:41,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0441 secs
2025-03-13 18:57:41,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:41
2025-03-13 18:57:41,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:41,600 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 18:57:41,600 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:57:41,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:57:41,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:41
2025-03-13 18:57:41,600 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:41,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:57:41,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:41
2025-03-13 18:57:41,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:41,600 [INFO]: 	Creating the index 03/13/2025, 18:57:41
2025-03-13 18:57:41,601 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:57:41
2025-03-13 18:57:41,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 18:57:41,602 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:41
2025-03-13 18:57:41,602 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 18:57:41,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  5.89it/s] 13%|█▎        | 6/46 [00:00<00:01, 25.14it/s] 26%|██▌       | 12/46 [00:00<00:00, 36.03it/s] 39%|███▉      | 18/46 [00:00<00:00, 41.60it/s] 50%|█████     | 23/46 [00:06<00:10,  2.20it/s] 63%|██████▎   | 29/46 [00:06<00:04,  3.45it/s] 76%|███████▌  | 35/46 [00:06<00:02,  5.13it/s] 89%|████████▉ | 41/46 [00:07<00:00,  7.33it/s]100%|██████████| 46/46 [00:16<00:00,  1.55it/s]100%|██████████| 46/46 [00:16<00:00,  2.76it/s]
2025-03-13 18:57:58,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:58
2025-03-13 18:59:33,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.3198 secs
2025-03-13 18:59:33,570 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 18:59:33,570 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 19:00:40,196 [INFO]: 	>>> Finished "Compute fast metrics" in 66.6251 secs
2025-03-13 19:00:40,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 178.5954 secs
2025-03-13 19:00:40,197 [INFO]: {
2025-03-13 19:00:40,197 [INFO]: 	index_key: HNSW32
2025-03-13 19:00:40,197 [INFO]: 	index_param: efSearch=103
2025-03-13 19:00:40,197 [INFO]: 	index_path: knn.index
2025-03-13 19:00:40,198 [INFO]: 	size in bytes: 2184973210
2025-03-13 19:00:40,198 [INFO]: 	avg_search_speed_ms: 11.168613005689652
2025-03-13 19:00:40,198 [INFO]: 	99p_search_speed_ms: 20.687776929698877
2025-03-13 19:00:40,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:40,198 [INFO]: 	nb vectors: 11098
2025-03-13 19:00:40,198 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:40,198 [INFO]: 	compression ratio: 0.9986189185358478
2025-03-13 19:00:40,198 [INFO]: }
2025-03-13 19:00:40,198 [INFO]: 	>>> Finished "Creating the index" in 178.5971 secs
2025-03-13 19:00:40,198 [INFO]: >>> Finished "Launching the whole pipeline" in 178.6420 secs
2025-03-13 19:00:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 4587 [episode count 16/20]
[retrieval_preprocessing] for episode 12049 [episode count 17/20], we have num_retrieval=np.int64(11042) num_query=np.int64(541)
2025-03-13 19:00:46,097 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:47,636 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:47
2025-03-13 19:00:47,636 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 969.11it/s]
2025-03-13 19:00:47,687 [INFO]: There are 11042 embeddings of dim 49152
2025-03-13 19:00:47,687 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0512 secs
2025-03-13 19:00:47,687 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:47
2025-03-13 19:00:47,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:47,688 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 19:00:47,688 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:00:47,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:47,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:47
2025-03-13 19:00:47,688 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:47,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:00:47,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:47
2025-03-13 19:00:47,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:47,688 [INFO]: 	Creating the index 03/13/2025, 19:00:47
2025-03-13 19:00:47,688 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:00:47
2025-03-13 19:00:47,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 19:00:47,689 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:47
2025-03-13 19:00:47,689 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 19:00:47,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  7.04it/s]  9%|▊         | 4/46 [00:00<00:02, 17.07it/s] 13%|█▎        | 6/46 [00:00<00:02, 16.23it/s] 17%|█▋        | 8/46 [00:00<00:02, 14.16it/s] 22%|██▏       | 10/46 [00:00<00:02, 13.31it/s] 26%|██▌       | 12/46 [00:00<00:02, 12.72it/s] 30%|███       | 14/46 [00:01<00:02, 12.36it/s] 35%|███▍      | 16/46 [00:01<00:02, 12.08it/s] 39%|███▉      | 18/46 [00:01<00:02, 11.77it/s] 43%|████▎     | 20/46 [00:01<00:02, 11.71it/s] 48%|████▊     | 22/46 [00:08<00:25,  1.06s/it] 52%|█████▏    | 24/46 [00:08<00:16,  1.31it/s] 57%|█████▋    | 26/46 [00:08<00:11,  1.78it/s] 61%|██████    | 28/46 [00:08<00:07,  2.38it/s] 65%|██████▌   | 30/46 [00:08<00:05,  3.12it/s] 70%|██████▉   | 32/46 [00:09<00:03,  3.99it/s] 74%|███████▍  | 34/46 [00:09<00:02,  4.99it/s] 78%|███████▊  | 36/46 [00:09<00:01,  6.08it/s] 83%|████████▎ | 38/46 [00:09<00:01,  7.25it/s] 87%|████████▋ | 40/46 [00:09<00:00,  8.47it/s] 91%|█████████▏| 42/46 [00:17<00:05,  1.26s/it]100%|██████████| 46/46 [00:20<00:00,  1.03it/s]100%|██████████| 46/46 [00:20<00:00,  2.30it/s]
2025-03-13 19:01:07,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:01:07
2025-03-13 19:02:32,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.1204 secs
2025-03-13 19:02:32,844 [INFO]: The best hyperparameters are: efSearch=95
2025-03-13 19:02:32,844 [INFO]: 	Compute fast metrics 03/13/2025, 19:02:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s]
2025-03-13 19:03:03,817 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9727 secs
2025-03-13 19:03:03,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.1289 secs
2025-03-13 19:03:03,818 [INFO]: {
2025-03-13 19:03:03,818 [INFO]: 	index_key: HNSW32
2025-03-13 19:03:03,818 [INFO]: 	index_param: efSearch=95
2025-03-13 19:03:03,818 [INFO]: 	index_path: knn.index
2025-03-13 19:03:03,818 [INFO]: 	size in bytes: 2173947642
2025-03-13 19:03:03,818 [INFO]: 	avg_search_speed_ms: 8.836804210601619
2025-03-13 19:03:03,818 [INFO]: 	99p_search_speed_ms: 16.070010690018545
2025-03-13 19:03:03,818 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:03,818 [INFO]: 	nb vectors: 11042
2025-03-13 19:03:03,818 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:03,818 [INFO]: 	compression ratio: 0.99861905321821
2025-03-13 19:03:03,818 [INFO]: }
2025-03-13 19:03:03,818 [INFO]: 	>>> Finished "Creating the index" in 136.1302 secs
2025-03-13 19:03:03,818 [INFO]: >>> Finished "Launching the whole pipeline" in 136.1822 secs
2025-03-13 19:03:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 12049 [episode count 17/20]
[retrieval_preprocessing] for episode 73681 [episode count 18/20], we have num_retrieval=np.int64(10978) num_query=np.int64(605)
2025-03-13 19:03:07,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:03:09,791 [INFO]: Launching the whole pipeline 03/13/2025, 19:03:09
2025-03-13 19:03:09,791 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:03:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1060.51it/s]
2025-03-13 19:03:09,834 [INFO]: There are 10978 embeddings of dim 49152
2025-03-13 19:03:09,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0431 secs
2025-03-13 19:03:09,835 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:03:09
2025-03-13 19:03:09,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:03:09,835 [INFO]: 		-> Add: 6.0 seconds
2025-03-13 19:03:09,835 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:03:09,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:03:09,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:03:09
2025-03-13 19:03:09,835 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:03:09,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:03:09,835 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:03:09
2025-03-13 19:03:09,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:03:09,835 [INFO]: 	Creating the index 03/13/2025, 19:03:09
2025-03-13 19:03:09,835 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:03:09
2025-03-13 19:03:09,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 19:03:09,836 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:03:09
2025-03-13 19:03:09,836 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 19:03:09,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  6.43it/s] 13%|█▎        | 6/46 [00:00<00:01, 26.30it/s] 24%|██▍       | 11/46 [00:00<00:00, 35.01it/s] 35%|███▍      | 16/46 [00:00<00:00, 39.65it/s] 46%|████▌     | 21/46 [00:06<00:11,  2.09it/s] 57%|█████▋    | 26/46 [00:06<00:06,  3.17it/s] 70%|██████▉   | 32/46 [00:06<00:02,  4.92it/s] 83%|████████▎ | 38/46 [00:06<00:01,  7.20it/s] 93%|█████████▎| 43/46 [00:13<00:01,  2.12it/s]100%|██████████| 46/46 [00:15<00:00,  1.94it/s]100%|██████████| 46/46 [00:15<00:00,  3.03it/s]
2025-03-13 19:03:25,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:03:25
2025-03-13 19:04:48,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.0132 secs
2025-03-13 19:04:48,030 [INFO]: The best hyperparameters are: efSearch=96
2025-03-13 19:04:48,030 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 19:05:23,153 [INFO]: 	>>> Finished "Compute fast metrics" in 35.1224 secs
2025-03-13 19:05:23,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.3182 secs
2025-03-13 19:05:23,155 [INFO]: {
2025-03-13 19:05:23,155 [INFO]: 	index_key: HNSW32
2025-03-13 19:05:23,155 [INFO]: 	index_param: efSearch=96
2025-03-13 19:05:23,155 [INFO]: 	index_path: knn.index
2025-03-13 19:05:23,155 [INFO]: 	size in bytes: 2161347066
2025-03-13 19:05:23,155 [INFO]: 	avg_search_speed_ms: 10.20786424157951
2025-03-13 19:05:23,155 [INFO]: 	99p_search_speed_ms: 16.486322018317882
2025-03-13 19:05:23,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:05:23,155 [INFO]: 	nb vectors: 10978
2025-03-13 19:05:23,155 [INFO]: 	vectors dimension: 49152
2025-03-13 19:05:23,155 [INFO]: 	compression ratio: 0.9986191750288752
2025-03-13 19:05:23,155 [INFO]: }
2025-03-13 19:05:23,155 [INFO]: 	>>> Finished "Creating the index" in 133.3196 secs
2025-03-13 19:05:23,155 [INFO]: >>> Finished "Launching the whole pipeline" in 133.3635 secs
2025-03-13 19:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:05:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 73681 [episode count 18/20]
[retrieval_preprocessing] for episode 62930 [episode count 19/20], we have num_retrieval=np.int64(11086) num_query=np.int64(497)
2025-03-13 19:05:31,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:05:33,457 [INFO]: Launching the whole pipeline 03/13/2025, 19:05:33
2025-03-13 19:05:33,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:05:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.16it/s]
2025-03-13 19:05:33,487 [INFO]: There are 11086 embeddings of dim 49152
2025-03-13 19:05:33,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 19:05:33,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:05:33
2025-03-13 19:05:33,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:05:33,488 [INFO]: 		-> Add: 6.1 seconds
2025-03-13 19:05:33,488 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:05:33,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:05:33,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:05:33
2025-03-13 19:05:33,489 [INFO]: 2.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:05:33,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 19:05:33,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:05:33
2025-03-13 19:05:33,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 19:05:33,489 [INFO]: 	Creating the index 03/13/2025, 19:05:33
2025-03-13 19:05:33,490 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 19:05:33
2025-03-13 19:05:33,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 19:05:33,493 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:05:33
2025-03-13 19:05:33,493 [INFO]: The memory available for adding the vectors is 48.0GB(total available - used by the index)
2025-03-13 19:05:33,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:09,  4.92it/s]  7%|▋         | 3/46 [00:00<00:04,  9.05it/s] 11%|█         | 5/46 [00:00<00:03, 10.79it/s] 15%|█▌        | 7/46 [00:00<00:03, 11.56it/s] 20%|█▉        | 9/46 [00:00<00:03, 12.04it/s] 24%|██▍       | 11/46 [00:00<00:02, 12.39it/s] 28%|██▊       | 13/46 [00:01<00:02, 12.50it/s] 33%|███▎      | 15/46 [00:01<00:02, 12.62it/s] 37%|███▋      | 17/46 [00:01<00:02, 12.79it/s] 41%|████▏     | 19/46 [00:01<00:02, 12.83it/s] 46%|████▌     | 21/46 [00:07<00:22,  1.12it/s] 48%|████▊     | 22/46 [00:07<00:18,  1.33it/s] 52%|█████▏    | 24/46 [00:07<00:11,  1.89it/s] 57%|█████▋    | 26/46 [00:07<00:07,  2.60it/s] 61%|██████    | 28/46 [00:07<00:05,  3.44it/s] 65%|██████▌   | 30/46 [00:07<00:03,  4.39it/s] 70%|██████▉   | 32/46 [00:08<00:02,  5.38it/s] 74%|███████▍  | 34/46 [00:08<00:01,  6.41it/s] 78%|███████▊  | 36/46 [00:08<00:01,  7.37it/s] 83%|████████▎ | 38/46 [00:08<00:00,  8.26it/s] 87%|████████▋ | 40/46 [00:08<00:00,  8.89it/s] 91%|█████████▏| 42/46 [00:16<00:04,  1.22s/it]100%|██████████| 46/46 [00:18<00:00,  1.08it/s]100%|██████████| 46/46 [00:18<00:00,  2.46it/s]
2025-03-13 19:05:52,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:52
2025-03-13 19:07:14,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.5564 secs
2025-03-13 19:07:14,776 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 19:07:14,777 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.41it/s]
2025-03-13 19:08:24,416 [INFO]: 	>>> Finished "Compute fast metrics" in 69.6389 secs
2025-03-13 19:08:24,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 170.9240 secs
2025-03-13 19:08:24,417 [INFO]: {
2025-03-13 19:08:24,417 [INFO]: 	index_key: HNSW32
2025-03-13 19:08:24,417 [INFO]: 	index_param: efSearch=112
2025-03-13 19:08:24,417 [INFO]: 	index_path: knn.index
2025-03-13 19:08:24,417 [INFO]: 	size in bytes: 2182610570
2025-03-13 19:08:24,417 [INFO]: 	avg_search_speed_ms: 9.687388239314693
2025-03-13 19:08:24,417 [INFO]: 	99p_search_speed_ms: 19.515696468297392
2025-03-13 19:08:24,417 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:24,417 [INFO]: 	nb vectors: 11086
2025-03-13 19:08:24,417 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:24,417 [INFO]: 	compression ratio: 0.9986189556481438
2025-03-13 19:08:24,417 [INFO]: }
2025-03-13 19:08:24,417 [INFO]: 	>>> Finished "Creating the index" in 170.9277 secs
2025-03-13 19:08:24,417 [INFO]: >>> Finished "Launching the whole pipeline" in 170.9603 secs
2025-03-13 19:08:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 62930 [episode count 19/20]
2025-03-13 19:08:27: [retrieval_preprocessing] finished for 488975025_put_two_slices_of_bread_in_toaster [chosen_id count 7/196]
2025-03-13 19:08:28: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 488975025_push_down_toaster_lever [chosen_id count 8/196]
2025-03-13 19:08:28: [retrieval_preprocessing] we have num_total=2361 embedding_dim=49152
[retrieval_preprocessing] for episode 56833 [episode count 0/20], we have num_retrieval=np.int64(2244) num_query=np.int64(117)
2025-03-13 19:08:29,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:29,760 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:29
2025-03-13 19:08:29,760 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1006.07it/s]
2025-03-13 19:08:29,808 [INFO]: There are 2244 embeddings of dim 49152
2025-03-13 19:08:29,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0483 secs
2025-03-13 19:08:29,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:29
2025-03-13 19:08:29,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:29,808 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:08:29,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:29,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:08:29,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:29
2025-03-13 19:08:29,809 [INFO]: 463.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:29,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:08:29,809 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:29
2025-03-13 19:08:29,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:29,809 [INFO]: 	Creating the index 03/13/2025, 19:08:29
2025-03-13 19:08:29,809 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:29
2025-03-13 19:08:29,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:08:29,810 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:29
2025-03-13 19:08:29,810 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:08:29,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 15.73it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.37it/s]100%|██████████| 9/9 [00:02<00:00,  2.56it/s]100%|██████████| 9/9 [00:02<00:00,  3.28it/s]
2025-03-13 19:08:32,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:32
2025-03-13 19:08:59,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7847 secs
2025-03-13 19:08:59,347 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 19:08:59,347 [INFO]: 	Compute fast metrics 03/13/2025, 19:08:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.84it/s]
2025-03-13 19:09:14,320 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9729 secs
2025-03-13 19:09:14,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.5120 secs
2025-03-13 19:09:14,322 [INFO]: {
2025-03-13 19:09:14,322 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:14,322 [INFO]: 	index_param: efSearch=287
2025-03-13 19:09:14,322 [INFO]: 	index_path: knn.index
2025-03-13 19:09:14,322 [INFO]: 	size in bytes: 441493270
2025-03-13 19:09:14,322 [INFO]: 	avg_search_speed_ms: 9.941775897271546
2025-03-13 19:09:14,322 [INFO]: 	99p_search_speed_ms: 12.865853216499092
2025-03-13 19:09:14,322 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:14,322 [INFO]: 	nb vectors: 2244
2025-03-13 19:09:14,322 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:14,322 [INFO]: 	compression ratio: 0.9993093484754592
2025-03-13 19:09:14,322 [INFO]: }
2025-03-13 19:09:14,322 [INFO]: 	>>> Finished "Creating the index" in 44.5135 secs
2025-03-13 19:09:14,322 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5626 secs
2025-03-13 19:09:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 56833 [episode count 0/20]
[retrieval_preprocessing] for episode 49686 [episode count 1/20], we have num_retrieval=np.int64(2190) num_query=np.int64(171)
2025-03-13 19:09:16,233 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:16,556 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:16
2025-03-13 19:09:16,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.34it/s]
2025-03-13 19:09:16,598 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 19:09:16,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0416 secs
2025-03-13 19:09:16,598 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:16
2025-03-13 19:09:16,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:16,598 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:09:16,598 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:16,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:09:16,598 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:16
2025-03-13 19:09:16,598 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:16,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:09:16,598 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:16
2025-03-13 19:09:16,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:16,598 [INFO]: 	Creating the index 03/13/2025, 19:09:16
2025-03-13 19:09:16,598 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:16
2025-03-13 19:09:16,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:09:16,599 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:16
2025-03-13 19:09:16,600 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:09:16,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.39it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.18it/s]100%|██████████| 9/9 [00:01<00:00,  5.06it/s]
2025-03-13 19:09:18,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:18
2025-03-13 19:09:42,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1375 secs
2025-03-13 19:09:42,518 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 19:09:42,518 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 19:09:59,785 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2672 secs
2025-03-13 19:09:59,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1876 secs
2025-03-13 19:09:59,787 [INFO]: {
2025-03-13 19:09:59,787 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:59,787 [INFO]: 	index_param: efSearch=239
2025-03-13 19:09:59,787 [INFO]: 	index_path: knn.index
2025-03-13 19:09:59,787 [INFO]: 	size in bytes: 430869310
2025-03-13 19:09:59,787 [INFO]: 	avg_search_speed_ms: 9.518223221623805
2025-03-13 19:09:59,787 [INFO]: 	99p_search_speed_ms: 16.384063055738807
2025-03-13 19:09:59,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:59,787 [INFO]: 	nb vectors: 2190
2025-03-13 19:09:59,787 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:59,788 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 19:09:59,788 [INFO]: }
2025-03-13 19:09:59,788 [INFO]: 	>>> Finished "Creating the index" in 43.1891 secs
2025-03-13 19:09:59,788 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2313 secs
2025-03-13 19:10:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 49686 [episode count 1/20]
[retrieval_preprocessing] for episode 37931 [episode count 2/20], we have num_retrieval=np.int64(2227) num_query=np.int64(134)
2025-03-13 19:10:02,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:03,757 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:03
2025-03-13 19:10:03,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.16it/s]
2025-03-13 19:10:03,801 [INFO]: There are 2227 embeddings of dim 49152
2025-03-13 19:10:03,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0442 secs
2025-03-13 19:10:03,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:03
2025-03-13 19:10:03,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:03,801 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:10:03,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:03,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:03,802 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:03
2025-03-13 19:10:03,802 [INFO]: 459.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:03,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:10:03,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:03
2025-03-13 19:10:03,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:03,802 [INFO]: 	Creating the index 03/13/2025, 19:10:03
2025-03-13 19:10:03,802 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:03
2025-03-13 19:10:03,803 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:10:03,803 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:03
2025-03-13 19:10:03,803 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:10:03,803 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 25.52it/s]100%|██████████| 9/9 [00:01<00:00,  4.84it/s]100%|██████████| 9/9 [00:01<00:00,  5.26it/s]
2025-03-13 19:10:05,518 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:05
2025-03-13 19:10:32,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4862 secs
2025-03-13 19:10:32,005 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 19:10:32,005 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.09it/s]
2025-03-13 19:10:49,530 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5251 secs
2025-03-13 19:10:49,532 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7285 secs
2025-03-13 19:10:49,532 [INFO]: {
2025-03-13 19:10:49,532 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:49,532 [INFO]: 	index_param: efSearch=270
2025-03-13 19:10:49,532 [INFO]: 	index_path: knn.index
2025-03-13 19:10:49,532 [INFO]: 	size in bytes: 438148690
2025-03-13 19:10:49,532 [INFO]: 	avg_search_speed_ms: 10.305031948462974
2025-03-13 19:10:49,532 [INFO]: 	99p_search_speed_ms: 14.588604518212371
2025-03-13 19:10:49,532 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:49,532 [INFO]: 	nb vectors: 2227
2025-03-13 19:10:49,532 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:49,532 [INFO]: 	compression ratio: 0.9993091979802564
2025-03-13 19:10:49,532 [INFO]: }
2025-03-13 19:10:49,532 [INFO]: 	>>> Finished "Creating the index" in 45.7303 secs
2025-03-13 19:10:49,532 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7752 secs
2025-03-13 19:10:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 37931 [episode count 2/20]
[retrieval_preprocessing] for episode 15409 [episode count 3/20], we have num_retrieval=np.int64(2218) num_query=np.int64(143)
2025-03-13 19:10:51,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:52,373 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:52
2025-03-13 19:10:52,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.50it/s]
2025-03-13 19:10:52,418 [INFO]: There are 2218 embeddings of dim 49152
2025-03-13 19:10:52,418 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0447 secs
2025-03-13 19:10:52,418 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:52
2025-03-13 19:10:52,418 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:52,418 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:10:52,418 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:52,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:52,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:52
2025-03-13 19:10:52,419 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:52,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:10:52,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:52
2025-03-13 19:10:52,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:52,419 [INFO]: 	Creating the index 03/13/2025, 19:10:52
2025-03-13 19:10:52,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:52
2025-03-13 19:10:52,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:10:52,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:52
2025-03-13 19:10:52,420 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:10:52,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.43it/s] 56%|█████▌    | 5/9 [00:00<00:00, 26.51it/s]100%|██████████| 9/9 [00:02<00:00,  3.79it/s]100%|██████████| 9/9 [00:02<00:00,  4.48it/s]
2025-03-13 19:10:54,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:54
2025-03-13 19:11:20,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2286 secs
2025-03-13 19:11:20,668 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:11:20,668 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.40it/s]
2025-03-13 19:11:38,657 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9896 secs
2025-03-13 19:11:38,659 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2390 secs
2025-03-13 19:11:38,659 [INFO]: {
2025-03-13 19:11:38,659 [INFO]: 	index_key: HNSW15
2025-03-13 19:11:38,659 [INFO]: 	index_param: efSearch=280
2025-03-13 19:11:38,659 [INFO]: 	index_path: knn.index
2025-03-13 19:11:38,659 [INFO]: 	size in bytes: 436378030
2025-03-13 19:11:38,659 [INFO]: 	avg_search_speed_ms: 9.77004965056949
2025-03-13 19:11:38,659 [INFO]: 	99p_search_speed_ms: 12.908227203879505
2025-03-13 19:11:38,659 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:11:38,659 [INFO]: 	nb vectors: 2218
2025-03-13 19:11:38,659 [INFO]: 	vectors dimension: 49152
2025-03-13 19:11:38,659 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-13 19:11:38,659 [INFO]: }
2025-03-13 19:11:38,659 [INFO]: 	>>> Finished "Creating the index" in 46.2403 secs
2025-03-13 19:11:38,659 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2857 secs
2025-03-13 19:11:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 15409 [episode count 3/20]
[retrieval_preprocessing] for episode 51764 [episode count 4/20], we have num_retrieval=np.int64(2274) num_query=np.int64(87)
2025-03-13 19:11:40,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:40,918 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:40
2025-03-13 19:11:40,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1710.56it/s]
2025-03-13 19:11:40,957 [INFO]: There are 2274 embeddings of dim 49152
2025-03-13 19:11:40,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0392 secs
2025-03-13 19:11:40,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:40
2025-03-13 19:11:40,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:40,958 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:11:40,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:40,959 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:11:40,959 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:40
2025-03-13 19:11:40,959 [INFO]: 469.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:40,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:11:40,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:40
2025-03-13 19:11:40,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:40,959 [INFO]: 	Creating the index 03/13/2025, 19:11:40
2025-03-13 19:11:40,960 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:40
2025-03-13 19:11:40,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:11:40,963 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:40
2025-03-13 19:11:40,963 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:11:40,963 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.97it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.24it/s]100%|██████████| 9/9 [00:01<00:00,  4.82it/s]
2025-03-13 19:11:42,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:42
2025-03-13 19:12:12,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5296 secs
2025-03-13 19:12:12,368 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 19:12:12,368 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.13it/s]
2025-03-13 19:12:29,422 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0532 secs
2025-03-13 19:12:29,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4606 secs
2025-03-13 19:12:29,423 [INFO]: {
2025-03-13 19:12:29,424 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:29,424 [INFO]: 	index_param: efSearch=207
2025-03-13 19:12:29,424 [INFO]: 	index_path: knn.index
2025-03-13 19:12:29,424 [INFO]: 	size in bytes: 447395530
2025-03-13 19:12:29,424 [INFO]: 	avg_search_speed_ms: 8.462452509538183
2025-03-13 19:12:29,424 [INFO]: 	99p_search_speed_ms: 11.766377487219872
2025-03-13 19:12:29,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:29,424 [INFO]: 	nb vectors: 2274
2025-03-13 19:12:29,424 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:29,424 [INFO]: 	compression ratio: 0.9993094745492875
2025-03-13 19:12:29,424 [INFO]: }
2025-03-13 19:12:29,424 [INFO]: 	>>> Finished "Creating the index" in 48.4641 secs
2025-03-13 19:12:29,424 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5051 secs
2025-03-13 19:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 51764 [episode count 4/20]
[retrieval_preprocessing] for episode 94810 [episode count 5/20], we have num_retrieval=np.int64(2275) num_query=np.int64(86)
2025-03-13 19:12:30,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:31,383 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:31
2025-03-13 19:12:31,383 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.94it/s]
2025-03-13 19:12:31,427 [INFO]: There are 2275 embeddings of dim 49152
2025-03-13 19:12:31,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0445 secs
2025-03-13 19:12:31,428 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:31
2025-03-13 19:12:31,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:31,428 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:12:31,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:31,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:12:31,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:31
2025-03-13 19:12:31,429 [INFO]: 469.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:31,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:12:31,430 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:31
2025-03-13 19:12:31,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:31,430 [INFO]: 	Creating the index 03/13/2025, 19:12:31
2025-03-13 19:12:31,430 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:31
2025-03-13 19:12:31,433 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:12:31,433 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:31
2025-03-13 19:12:31,434 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:12:31,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.60it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.56it/s]100%|██████████| 9/9 [00:01<00:00,  5.03it/s]
2025-03-13 19:12:33,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:33
2025-03-13 19:12:57,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3244 secs
2025-03-13 19:12:57,555 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 19:12:57,555 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 19:13:18,631 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0761 secs
2025-03-13 19:13:18,633 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1995 secs
2025-03-13 19:13:18,633 [INFO]: {
2025-03-13 19:13:18,633 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:18,633 [INFO]: 	index_param: efSearch=258
2025-03-13 19:13:18,633 [INFO]: 	index_path: knn.index
2025-03-13 19:13:18,633 [INFO]: 	size in bytes: 447592270
2025-03-13 19:13:18,633 [INFO]: 	avg_search_speed_ms: 9.881116035937335
2025-03-13 19:13:18,633 [INFO]: 	99p_search_speed_ms: 13.641251351218669
2025-03-13 19:13:18,633 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:18,633 [INFO]: 	nb vectors: 2275
2025-03-13 19:13:18,633 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:18,633 [INFO]: 	compression ratio: 0.9993094831597517
2025-03-13 19:13:18,633 [INFO]: }
2025-03-13 19:13:18,633 [INFO]: 	>>> Finished "Creating the index" in 47.2032 secs
2025-03-13 19:13:18,633 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2504 secs
2025-03-13 19:13:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 94810 [episode count 5/20]
[retrieval_preprocessing] for episode 90221 [episode count 6/20], we have num_retrieval=np.int64(2282) num_query=np.int64(79)
2025-03-13 19:13:19,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:20,249 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:20
2025-03-13 19:13:20,250 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 843.08it/s]
2025-03-13 19:13:20,298 [INFO]: There are 2282 embeddings of dim 49152
2025-03-13 19:13:20,299 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0490 secs
2025-03-13 19:13:20,299 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:20
2025-03-13 19:13:20,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:20,299 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 19:13:20,299 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:20,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:13:20,299 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:20
2025-03-13 19:13:20,299 [INFO]: 470.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:20,299 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:13:20,299 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:20
2025-03-13 19:13:20,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:20,299 [INFO]: 	Creating the index 03/13/2025, 19:13:20
2025-03-13 19:13:20,299 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:20
2025-03-13 19:13:20,300 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:13:20,300 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:20
2025-03-13 19:13:20,300 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:13:20,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.87it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.99it/s]100%|██████████| 9/9 [00:02<00:00,  3.54it/s]100%|██████████| 9/9 [00:02<00:00,  4.35it/s]
2025-03-13 19:13:22,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:22
2025-03-13 19:13:48,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8269 secs
2025-03-13 19:13:48,200 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 19:13:48,200 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 19:14:08,552 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3526 secs
2025-03-13 19:14:08,554 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2539 secs
2025-03-13 19:14:08,554 [INFO]: {
2025-03-13 19:14:08,554 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:08,554 [INFO]: 	index_param: efSearch=291
2025-03-13 19:14:08,554 [INFO]: 	index_path: knn.index
2025-03-13 19:14:08,554 [INFO]: 	size in bytes: 448969450
2025-03-13 19:14:08,554 [INFO]: 	avg_search_speed_ms: 9.885717403068181
2025-03-13 19:14:08,555 [INFO]: 	99p_search_speed_ms: 13.730360916815696
2025-03-13 19:14:08,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:08,555 [INFO]: 	nb vectors: 2282
2025-03-13 19:14:08,555 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:08,555 [INFO]: 	compression ratio: 0.9993095432217047
2025-03-13 19:14:08,555 [INFO]: }
2025-03-13 19:14:08,555 [INFO]: 	>>> Finished "Creating the index" in 48.2553 secs
2025-03-13 19:14:08,555 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3050 secs
2025-03-13 19:14:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 90221 [episode count 6/20]
[retrieval_preprocessing] for episode 32923 [episode count 7/20], we have num_retrieval=np.int64(2258) num_query=np.int64(103)
2025-03-13 19:14:09,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:10,043 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:10
2025-03-13 19:14:10,043 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 19:14:10,084 [INFO]: There are 2258 embeddings of dim 49152
2025-03-13 19:14:10,084 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0406 secs
2025-03-13 19:14:10,084 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:10
2025-03-13 19:14:10,084 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:10,084 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:14:10,084 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:10,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:14:10,084 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:10
2025-03-13 19:14:10,084 [INFO]: 466.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:10,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:14:10,084 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:10
2025-03-13 19:14:10,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:10,084 [INFO]: 	Creating the index 03/13/2025, 19:14:10
2025-03-13 19:14:10,084 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:10
2025-03-13 19:14:10,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:14:10,085 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:10
2025-03-13 19:14:10,085 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:14:10,085 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.14it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.61it/s]100%|██████████| 9/9 [00:01<00:00,  5.31it/s]
2025-03-13 19:14:11,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:11
2025-03-13 19:14:37,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4188 secs
2025-03-13 19:14:37,204 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 19:14:37,204 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.02it/s]
2025-03-13 19:14:53,671 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4671 secs
2025-03-13 19:14:53,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5874 secs
2025-03-13 19:14:53,673 [INFO]: {
2025-03-13 19:14:53,673 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:53,673 [INFO]: 	index_param: efSearch=256
2025-03-13 19:14:53,673 [INFO]: 	index_path: knn.index
2025-03-13 19:14:53,673 [INFO]: 	size in bytes: 444247630
2025-03-13 19:14:53,673 [INFO]: 	avg_search_speed_ms: 8.72754335669999
2025-03-13 19:14:53,673 [INFO]: 	99p_search_speed_ms: 11.47104381816461
2025-03-13 19:14:53,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:53,673 [INFO]: 	nb vectors: 2258
2025-03-13 19:14:53,673 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:53,673 [INFO]: 	compression ratio: 0.9993094707111887
2025-03-13 19:14:53,673 [INFO]: }
2025-03-13 19:14:53,673 [INFO]: 	>>> Finished "Creating the index" in 43.5887 secs
2025-03-13 19:14:53,673 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6299 secs
2025-03-13 19:14:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 32923 [episode count 7/20]
[retrieval_preprocessing] for episode 62121 [episode count 8/20], we have num_retrieval=np.int64(2241) num_query=np.int64(120)
2025-03-13 19:14:54,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:55,315 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:55
2025-03-13 19:14:55,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.99it/s]
2025-03-13 19:14:55,357 [INFO]: There are 2241 embeddings of dim 49152
2025-03-13 19:14:55,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 19:14:55,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:55
2025-03-13 19:14:55,358 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:55,358 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:14:55,358 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:55,358 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:14:55,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:55
2025-03-13 19:14:55,358 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:55,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:14:55,358 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:55
2025-03-13 19:14:55,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:55,358 [INFO]: 	Creating the index 03/13/2025, 19:14:55
2025-03-13 19:14:55,358 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:55
2025-03-13 19:14:55,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:14:55,359 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:55
2025-03-13 19:14:55,359 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:14:55,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.85it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.68it/s]100%|██████████| 9/9 [00:01<00:00,  5.29it/s]
2025-03-13 19:14:57,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:57
2025-03-13 19:15:19,854 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7875 secs
2025-03-13 19:15:19,854 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 19:15:19,854 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.65it/s]
2025-03-13 19:15:36,665 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8104 secs
2025-03-13 19:15:36,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3081 secs
2025-03-13 19:15:36,668 [INFO]: {
2025-03-13 19:15:36,668 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:36,668 [INFO]: 	index_param: efSearch=274
2025-03-13 19:15:36,668 [INFO]: 	index_path: knn.index
2025-03-13 19:15:36,668 [INFO]: 	size in bytes: 440903050
2025-03-13 19:15:36,668 [INFO]: 	avg_search_speed_ms: 14.826687775138351
2025-03-13 19:15:36,668 [INFO]: 	99p_search_speed_ms: 26.6336758993566
2025-03-13 19:15:36,668 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:36,668 [INFO]: 	nb vectors: 2241
2025-03-13 19:15:36,668 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:36,668 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-13 19:15:36,668 [INFO]: }
2025-03-13 19:15:36,668 [INFO]: 	>>> Finished "Creating the index" in 41.3099 secs
2025-03-13 19:15:36,668 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3532 secs
2025-03-13 19:15:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 62121 [episode count 8/20]
[retrieval_preprocessing] for episode 78517 [episode count 9/20], we have num_retrieval=np.int64(2213) num_query=np.int64(148)
2025-03-13 19:15:38,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:39,004 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:39
2025-03-13 19:15:39,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.36it/s]
2025-03-13 19:15:39,056 [INFO]: There are 2213 embeddings of dim 49152
2025-03-13 19:15:39,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0527 secs
2025-03-13 19:15:39,057 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:39
2025-03-13 19:15:39,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:39,057 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:15:39,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:39,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:39,057 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:39
2025-03-13 19:15:39,057 [INFO]: 456.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:39,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:15:39,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:39
2025-03-13 19:15:39,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:39,057 [INFO]: 	Creating the index 03/13/2025, 19:15:39
2025-03-13 19:15:39,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:39
2025-03-13 19:15:39,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:15:39,059 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:39
2025-03-13 19:15:39,059 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:15:39,059 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.36it/s] 56%|█████▌    | 5/9 [00:00<00:00, 26.59it/s]100%|██████████| 9/9 [00:02<00:00,  3.17it/s]100%|██████████| 9/9 [00:02<00:00,  3.77it/s]
2025-03-13 19:15:41,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:41
2025-03-13 19:16:10,530 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0813 secs
2025-03-13 19:16:10,531 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 19:16:10,531 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-13 19:16:32,217 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6858 secs
2025-03-13 19:16:32,218 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1594 secs
2025-03-13 19:16:32,218 [INFO]: {
2025-03-13 19:16:32,218 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:32,218 [INFO]: 	index_param: efSearch=292
2025-03-13 19:16:32,218 [INFO]: 	index_path: knn.index
2025-03-13 19:16:32,218 [INFO]: 	size in bytes: 435394330
2025-03-13 19:16:32,218 [INFO]: 	avg_search_speed_ms: 10.067144803041348
2025-03-13 19:16:32,218 [INFO]: 	99p_search_speed_ms: 13.943244155962018
2025-03-13 19:16:32,218 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:32,218 [INFO]: 	nb vectors: 2213
2025-03-13 19:16:32,218 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:32,218 [INFO]: 	compression ratio: 0.9993090723069361
2025-03-13 19:16:32,218 [INFO]: }
2025-03-13 19:16:32,218 [INFO]: 	>>> Finished "Creating the index" in 53.1612 secs
2025-03-13 19:16:32,218 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2146 secs
2025-03-13 19:16:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 78517 [episode count 9/20]
[retrieval_preprocessing] for episode 45238 [episode count 10/20], we have num_retrieval=np.int64(2243) num_query=np.int64(118)
2025-03-13 19:16:33,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:34,699 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:34
2025-03-13 19:16:34,699 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.98it/s]
2025-03-13 19:16:34,748 [INFO]: There are 2243 embeddings of dim 49152
2025-03-13 19:16:34,748 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0492 secs
2025-03-13 19:16:34,748 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:34
2025-03-13 19:16:34,748 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:34,748 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:16:34,748 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:34,748 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:16:34,748 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:34
2025-03-13 19:16:34,748 [INFO]: 462.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:34,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:16:34,749 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:34
2025-03-13 19:16:34,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:34,749 [INFO]: 	Creating the index 03/13/2025, 19:16:34
2025-03-13 19:16:34,749 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:34
2025-03-13 19:16:34,750 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:16:34,750 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:34
2025-03-13 19:16:34,750 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:16:34,750 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.75it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.58it/s]100%|██████████| 9/9 [00:02<00:00,  4.40it/s]
2025-03-13 19:16:36,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:16:36
2025-03-13 19:17:01,450 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6519 secs
2025-03-13 19:17:01,451 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 19:17:01,451 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.79it/s]
2025-03-13 19:17:15,613 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1620 secs
2025-03-13 19:17:15,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8643 secs
2025-03-13 19:17:15,614 [INFO]: {
2025-03-13 19:17:15,614 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:15,614 [INFO]: 	index_param: efSearch=175
2025-03-13 19:17:15,614 [INFO]: 	index_path: knn.index
2025-03-13 19:17:15,614 [INFO]: 	size in bytes: 441296530
2025-03-13 19:17:15,614 [INFO]: 	avg_search_speed_ms: 7.546512151383004
2025-03-13 19:17:15,614 [INFO]: 	99p_search_speed_ms: 10.973800225183368
2025-03-13 19:17:15,614 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:15,614 [INFO]: 	nb vectors: 2243
2025-03-13 19:17:15,614 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:15,614 [INFO]: 	compression ratio: 0.9993093396859477
2025-03-13 19:17:15,614 [INFO]: }
2025-03-13 19:17:15,614 [INFO]: 	>>> Finished "Creating the index" in 40.8656 secs
2025-03-13 19:17:15,614 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9154 secs
2025-03-13 19:17:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 45238 [episode count 10/20]
[retrieval_preprocessing] for episode 89803 [episode count 11/20], we have num_retrieval=np.int64(2242) num_query=np.int64(119)
2025-03-13 19:17:16,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:16,654 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:16
2025-03-13 19:17:16,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2208.69it/s]
2025-03-13 19:17:16,687 [INFO]: There are 2242 embeddings of dim 49152
2025-03-13 19:17:16,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 19:17:16,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:16
2025-03-13 19:17:16,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:16,688 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:17:16,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:16,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:17:16,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:16
2025-03-13 19:17:16,688 [INFO]: 462.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:16,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:17:16,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:16
2025-03-13 19:17:16,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:16,688 [INFO]: 	Creating the index 03/13/2025, 19:17:16
2025-03-13 19:17:16,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:16
2025-03-13 19:17:16,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:17:16,689 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:16
2025-03-13 19:17:16,689 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:17:16,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.39it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.51it/s]100%|██████████| 9/9 [00:01<00:00,  5.16it/s]
2025-03-13 19:17:18,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:18
2025-03-13 19:17:42,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9009 secs
2025-03-13 19:17:42,337 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:17:42,337 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 19:17:59,392 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0548 secs
2025-03-13 19:17:59,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7057 secs
2025-03-13 19:17:59,395 [INFO]: {
2025-03-13 19:17:59,395 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:59,395 [INFO]: 	index_param: efSearch=280
2025-03-13 19:17:59,395 [INFO]: 	index_path: knn.index
2025-03-13 19:17:59,395 [INFO]: 	size in bytes: 441099790
2025-03-13 19:17:59,395 [INFO]: 	avg_search_speed_ms: 11.196064687420563
2025-03-13 19:17:59,395 [INFO]: 	99p_search_speed_ms: 16.683413730934266
2025-03-13 19:17:59,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:59,395 [INFO]: 	nb vectors: 2242
2025-03-13 19:17:59,395 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:59,395 [INFO]: 	compression ratio: 0.9993093308885955
2025-03-13 19:17:59,395 [INFO]: }
2025-03-13 19:17:59,395 [INFO]: 	>>> Finished "Creating the index" in 42.7072 secs
2025-03-13 19:17:59,395 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7416 secs
2025-03-13 19:18:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 89803 [episode count 11/20]
[retrieval_preprocessing] for episode 42732 [episode count 12/20], we have num_retrieval=np.int64(2260) num_query=np.int64(101)
2025-03-13 19:18:00,872 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:01,854 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:01
2025-03-13 19:18:01,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 891.65it/s]
2025-03-13 19:18:01,906 [INFO]: There are 2260 embeddings of dim 49152
2025-03-13 19:18:01,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0522 secs
2025-03-13 19:18:01,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:01
2025-03-13 19:18:01,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:01,907 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:18:01,907 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:01,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:18:01,907 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:01
2025-03-13 19:18:01,907 [INFO]: 466.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:01,907 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:18:01,907 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:01
2025-03-13 19:18:01,907 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:01,907 [INFO]: 	Creating the index 03/13/2025, 19:18:01
2025-03-13 19:18:01,907 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:01
2025-03-13 19:18:01,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:18:01,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:01
2025-03-13 19:18:01,909 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:18:01,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.57it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.58it/s]100%|██████████| 9/9 [00:01<00:00,  3.77it/s]100%|██████████| 9/9 [00:01<00:00,  4.63it/s]
2025-03-13 19:18:03,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:03
2025-03-13 19:18:28,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3923 secs
2025-03-13 19:18:28,250 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 19:18:28,250 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 19:18:47,236 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9862 secs
2025-03-13 19:18:47,238 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3293 secs
2025-03-13 19:18:47,238 [INFO]: {
2025-03-13 19:18:47,238 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:47,238 [INFO]: 	index_param: efSearch=302
2025-03-13 19:18:47,238 [INFO]: 	index_path: knn.index
2025-03-13 19:18:47,238 [INFO]: 	size in bytes: 444641110
2025-03-13 19:18:47,238 [INFO]: 	avg_search_speed_ms: 10.18158540005422
2025-03-13 19:18:47,238 [INFO]: 	99p_search_speed_ms: 14.739693801384412
2025-03-13 19:18:47,238 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:47,238 [INFO]: 	nb vectors: 2260
2025-03-13 19:18:47,238 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:47,238 [INFO]: 	compression ratio: 0.9993094880498117
2025-03-13 19:18:47,238 [INFO]: }
2025-03-13 19:18:47,238 [INFO]: 	>>> Finished "Creating the index" in 45.3310 secs
2025-03-13 19:18:47,238 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3841 secs
2025-03-13 19:18:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 42732 [episode count 12/20]
[retrieval_preprocessing] for episode 80117 [episode count 13/20], we have num_retrieval=np.int64(2251) num_query=np.int64(110)
2025-03-13 19:18:50,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:50,569 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:50
2025-03-13 19:18:50,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.93it/s]
2025-03-13 19:18:50,609 [INFO]: There are 2251 embeddings of dim 49152
2025-03-13 19:18:50,610 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 19:18:50,610 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:50
2025-03-13 19:18:50,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:50,610 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:18:50,610 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:50,610 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:18:50,610 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:50
2025-03-13 19:18:50,610 [INFO]: 464.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:50,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:18:50,610 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:50
2025-03-13 19:18:50,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:50,610 [INFO]: 	Creating the index 03/13/2025, 19:18:50
2025-03-13 19:18:50,610 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:50
2025-03-13 19:18:50,611 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:18:50,611 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:50
2025-03-13 19:18:50,611 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:18:50,611 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.94it/s] 89%|████████▉ | 8/9 [00:00<00:00, 37.48it/s]100%|██████████| 9/9 [00:01<00:00,  5.70it/s]
2025-03-13 19:18:52,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:52
2025-03-13 19:19:16,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0261 secs
2025-03-13 19:19:16,222 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 19:19:16,222 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 19:19:31,521 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2990 secs
2025-03-13 19:19:31,523 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9112 secs
2025-03-13 19:19:31,523 [INFO]: {
2025-03-13 19:19:31,523 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:31,523 [INFO]: 	index_param: efSearch=257
2025-03-13 19:19:31,523 [INFO]: 	index_path: knn.index
2025-03-13 19:19:31,523 [INFO]: 	size in bytes: 442870450
2025-03-13 19:19:31,523 [INFO]: 	avg_search_speed_ms: 8.891003140144878
2025-03-13 19:19:31,523 [INFO]: 	99p_search_speed_ms: 14.394713789224625
2025-03-13 19:19:31,523 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:31,523 [INFO]: 	nb vectors: 2251
2025-03-13 19:19:31,523 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:31,523 [INFO]: 	compression ratio: 0.9993094097833802
2025-03-13 19:19:31,523 [INFO]: }
2025-03-13 19:19:31,523 [INFO]: 	>>> Finished "Creating the index" in 40.9127 secs
2025-03-13 19:19:31,523 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9542 secs
2025-03-13 19:19:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 80117 [episode count 13/20]
[retrieval_preprocessing] for episode 27414 [episode count 14/20], we have num_retrieval=np.int64(2208) num_query=np.int64(153)
2025-03-13 19:19:32,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:32,729 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:32
2025-03-13 19:19:32,730 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.73it/s]
2025-03-13 19:19:32,775 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 19:19:32,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0462 secs
2025-03-13 19:19:32,776 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:32
2025-03-13 19:19:32,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:32,776 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:19:32,776 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:32,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:19:32,776 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:32
2025-03-13 19:19:32,777 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:32,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 19:19:32,777 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:32
2025-03-13 19:19:32,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:32,777 [INFO]: 	Creating the index 03/13/2025, 19:19:32
2025-03-13 19:19:32,778 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:32
2025-03-13 19:19:32,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 19:19:32,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:32
2025-03-13 19:19:32,780 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:19:32,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.24it/s]100%|██████████| 9/9 [00:01<00:00,  6.13it/s]100%|██████████| 9/9 [00:01<00:00,  6.63it/s]
2025-03-13 19:19:34,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:34
2025-03-13 19:19:58,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9060 secs
2025-03-13 19:19:58,049 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 19:19:58,049 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]
2025-03-13 19:20:14,031 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9813 secs
2025-03-13 19:20:14,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2528 secs
2025-03-13 19:20:14,033 [INFO]: {
2025-03-13 19:20:14,034 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:14,034 [INFO]: 	index_param: efSearch=156
2025-03-13 19:20:14,034 [INFO]: 	index_path: knn.index
2025-03-13 19:20:14,034 [INFO]: 	size in bytes: 434410630
2025-03-13 19:20:14,034 [INFO]: 	avg_search_speed_ms: 6.804413803288215
2025-03-13 19:20:14,034 [INFO]: 	99p_search_speed_ms: 9.520025495439764
2025-03-13 19:20:14,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:14,034 [INFO]: 	nb vectors: 2208
2025-03-13 19:20:14,034 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:14,034 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 19:20:14,034 [INFO]: }
2025-03-13 19:20:14,034 [INFO]: 	>>> Finished "Creating the index" in 41.2563 secs
2025-03-13 19:20:14,034 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3043 secs
2025-03-13 19:20:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 27414 [episode count 14/20]
[retrieval_preprocessing] for episode 68470 [episode count 15/20], we have num_retrieval=np.int64(2227) num_query=np.int64(134)
2025-03-13 19:20:15,621 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:15,940 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:15
2025-03-13 19:20:15,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1034.35it/s]
2025-03-13 19:20:15,989 [INFO]: There are 2227 embeddings of dim 49152
2025-03-13 19:20:15,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0487 secs
2025-03-13 19:20:15,989 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:15
2025-03-13 19:20:15,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:15,990 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:20:15,990 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:15,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:20:15,990 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:15
2025-03-13 19:20:15,990 [INFO]: 459.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:15,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 19:20:15,991 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:15
2025-03-13 19:20:15,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:15,991 [INFO]: 	Creating the index 03/13/2025, 19:20:15
2025-03-13 19:20:15,992 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:15
2025-03-13 19:20:15,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 19:20:15,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:15
2025-03-13 19:20:15,995 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:20:15,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.70it/s] 89%|████████▉ | 8/9 [00:00<00:00, 40.88it/s]100%|██████████| 9/9 [00:01<00:00,  6.30it/s]
2025-03-13 19:20:17,430 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:17
2025-03-13 19:20:42,129 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6984 secs
2025-03-13 19:20:42,129 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 19:20:42,130 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 19:20:58,942 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8122 secs
2025-03-13 19:20:58,944 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9483 secs
2025-03-13 19:20:58,944 [INFO]: {
2025-03-13 19:20:58,944 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:58,944 [INFO]: 	index_param: efSearch=227
2025-03-13 19:20:58,944 [INFO]: 	index_path: knn.index
2025-03-13 19:20:58,944 [INFO]: 	size in bytes: 438148690
2025-03-13 19:20:58,944 [INFO]: 	avg_search_speed_ms: 8.816209981855287
2025-03-13 19:20:58,944 [INFO]: 	99p_search_speed_ms: 12.45475160190836
2025-03-13 19:20:58,944 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:58,944 [INFO]: 	nb vectors: 2227
2025-03-13 19:20:58,944 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:58,944 [INFO]: 	compression ratio: 0.9993091979802564
2025-03-13 19:20:58,944 [INFO]: }
2025-03-13 19:20:58,944 [INFO]: 	>>> Finished "Creating the index" in 42.9522 secs
2025-03-13 19:20:58,944 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0034 secs
2025-03-13 19:20:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 68470 [episode count 15/20]
[retrieval_preprocessing] for episode 13189 [episode count 16/20], we have num_retrieval=np.int64(2267) num_query=np.int64(94)
2025-03-13 19:21:00,252 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:00,566 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:00
2025-03-13 19:21:00,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.53it/s]
2025-03-13 19:21:00,608 [INFO]: There are 2267 embeddings of dim 49152
2025-03-13 19:21:00,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0421 secs
2025-03-13 19:21:00,609 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:00
2025-03-13 19:21:00,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:00,609 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:21:00,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:00,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:00,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:00
2025-03-13 19:21:00,609 [INFO]: 467.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:00,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:00,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:00
2025-03-13 19:21:00,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:00,609 [INFO]: 	Creating the index 03/13/2025, 19:21:00
2025-03-13 19:21:00,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:00
2025-03-13 19:21:00,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:21:00,610 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:00
2025-03-13 19:21:00,610 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:21:00,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.10it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.48it/s]100%|██████████| 9/9 [00:01<00:00,  5.58it/s]
2025-03-13 19:21:02,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:02
2025-03-13 19:21:27,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7942 secs
2025-03-13 19:21:27,021 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 19:21:27,021 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 19:21:46,652 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6309 secs
2025-03-13 19:21:46,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0430 secs
2025-03-13 19:21:46,653 [INFO]: {
2025-03-13 19:21:46,653 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:46,653 [INFO]: 	index_param: efSearch=321
2025-03-13 19:21:46,654 [INFO]: 	index_path: knn.index
2025-03-13 19:21:46,654 [INFO]: 	size in bytes: 446018350
2025-03-13 19:21:46,654 [INFO]: 	avg_search_speed_ms: 10.436010448168867
2025-03-13 19:21:46,654 [INFO]: 	99p_search_speed_ms: 15.853217840194644
2025-03-13 19:21:46,654 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:46,654 [INFO]: 	nb vectors: 2267
2025-03-13 19:21:46,654 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:46,654 [INFO]: 	compression ratio: 0.9993094140633452
2025-03-13 19:21:46,654 [INFO]: }
2025-03-13 19:21:46,654 [INFO]: 	>>> Finished "Creating the index" in 46.0446 secs
2025-03-13 19:21:46,654 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0874 secs
2025-03-13 19:21:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 13189 [episode count 16/20]
[retrieval_preprocessing] for episode 39409 [episode count 17/20], we have num_retrieval=np.int64(2277) num_query=np.int64(84)
2025-03-13 19:21:47,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:48,206 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:48
2025-03-13 19:21:48,206 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1925.76it/s]
2025-03-13 19:21:48,242 [INFO]: There are 2277 embeddings of dim 49152
2025-03-13 19:21:48,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 19:21:48,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:48
2025-03-13 19:21:48,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:48,242 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 19:21:48,242 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:48,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:48,242 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:48
2025-03-13 19:21:48,242 [INFO]: 469.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:48,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:48,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:48
2025-03-13 19:21:48,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:48,242 [INFO]: 	Creating the index 03/13/2025, 19:21:48
2025-03-13 19:21:48,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:48
2025-03-13 19:21:48,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:21:48,244 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:48
2025-03-13 19:21:48,244 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:21:48,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.24it/s] 89%|████████▉ | 8/9 [00:00<00:00, 42.34it/s]100%|██████████| 9/9 [00:01<00:00,  6.08it/s]
2025-03-13 19:21:49,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:49
2025-03-13 19:22:22,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8403 secs
2025-03-13 19:22:22,570 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 19:22:22,570 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 19:22:37,890 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3198 secs
2025-03-13 19:22:37,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6473 secs
2025-03-13 19:22:37,891 [INFO]: {
2025-03-13 19:22:37,891 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:37,891 [INFO]: 	index_param: efSearch=175
2025-03-13 19:22:37,891 [INFO]: 	index_path: knn.index
2025-03-13 19:22:37,891 [INFO]: 	size in bytes: 447985750
2025-03-13 19:22:37,891 [INFO]: 	avg_search_speed_ms: 6.790584715927944
2025-03-13 19:22:37,891 [INFO]: 	99p_search_speed_ms: 9.256305918097496
2025-03-13 19:22:37,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:37,891 [INFO]: 	nb vectors: 2277
2025-03-13 19:22:37,891 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:37,891 [INFO]: 	compression ratio: 0.9993095003579913
2025-03-13 19:22:37,891 [INFO]: }
2025-03-13 19:22:37,891 [INFO]: 	>>> Finished "Creating the index" in 49.6489 secs
2025-03-13 19:22:37,891 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6850 secs
2025-03-13 19:22:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 39409 [episode count 17/20]
[retrieval_preprocessing] for episode 49654 [episode count 18/20], we have num_retrieval=np.int64(2222) num_query=np.int64(139)
2025-03-13 19:22:38,639 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:38,920 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:38
2025-03-13 19:22:38,921 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.71it/s]
2025-03-13 19:22:38,957 [INFO]: There are 2222 embeddings of dim 49152
2025-03-13 19:22:38,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 19:22:38,957 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:38
2025-03-13 19:22:38,957 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:38,957 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:22:38,957 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:38,957 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:22:38,957 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:38
2025-03-13 19:22:38,957 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:38,957 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:22:38,957 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:38
2025-03-13 19:22:38,957 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:38,957 [INFO]: 	Creating the index 03/13/2025, 19:22:38
2025-03-13 19:22:38,957 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:38
2025-03-13 19:22:38,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:22:38,958 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:38
2025-03-13 19:22:38,958 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:22:38,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.54it/s] 89%|████████▉ | 8/9 [00:00<00:00, 41.17it/s]100%|██████████| 9/9 [00:01<00:00,  6.14it/s]
2025-03-13 19:22:40,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:40
2025-03-13 19:23:05,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1434 secs
2025-03-13 19:23:05,571 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 19:23:05,571 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.54it/s]
2025-03-13 19:23:23,449 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8776 secs
2025-03-13 19:23:23,451 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4921 secs
2025-03-13 19:23:23,451 [INFO]: {
2025-03-13 19:23:23,451 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:23,451 [INFO]: 	index_param: efSearch=276
2025-03-13 19:23:23,451 [INFO]: 	index_path: knn.index
2025-03-13 19:23:23,451 [INFO]: 	size in bytes: 437164990
2025-03-13 19:23:23,451 [INFO]: 	avg_search_speed_ms: 9.390709992550628
2025-03-13 19:23:23,451 [INFO]: 	99p_search_speed_ms: 12.522055637091395
2025-03-13 19:23:23,451 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:23,451 [INFO]: 	nb vectors: 2222
2025-03-13 19:23:23,451 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:23,451 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-13 19:23:23,451 [INFO]: }
2025-03-13 19:23:23,451 [INFO]: 	>>> Finished "Creating the index" in 44.4935 secs
2025-03-13 19:23:23,451 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5304 secs
2025-03-13 19:23:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:23:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 49654 [episode count 18/20]
[retrieval_preprocessing] for episode 28486 [episode count 19/20], we have num_retrieval=np.int64(2240) num_query=np.int64(121)
2025-03-13 19:23:24,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:23:25,198 [INFO]: Launching the whole pipeline 03/13/2025, 19:23:25
2025-03-13 19:23:25,198 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:23:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.98it/s]
2025-03-13 19:23:25,238 [INFO]: There are 2240 embeddings of dim 49152
2025-03-13 19:23:25,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 19:23:25,239 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:23:25
2025-03-13 19:23:25,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:23:25,239 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:23:25,239 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:23:25,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:23:25,239 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:23:25
2025-03-13 19:23:25,239 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:23:25,239 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:23:25,239 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:23:25
2025-03-13 19:23:25,239 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:23:25,239 [INFO]: 	Creating the index 03/13/2025, 19:23:25
2025-03-13 19:23:25,239 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:23:25
2025-03-13 19:23:25,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:23:25,241 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:23:25
2025-03-13 19:23:25,241 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:23:25,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.28it/s] 89%|████████▉ | 8/9 [00:00<00:00, 36.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.47it/s]
2025-03-13 19:23:26,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:23:26
2025-03-13 19:23:51,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5226 secs
2025-03-13 19:23:51,413 [INFO]: The best hyperparameters are: efSearch=326
2025-03-13 19:23:51,413 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 19:24:08,551 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1382 secs
2025-03-13 19:24:08,553 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3121 secs
2025-03-13 19:24:08,553 [INFO]: {
2025-03-13 19:24:08,553 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:08,553 [INFO]: 	index_param: efSearch=326
2025-03-13 19:24:08,553 [INFO]: 	index_path: knn.index
2025-03-13 19:24:08,553 [INFO]: 	size in bytes: 440706310
2025-03-13 19:24:08,553 [INFO]: 	avg_search_speed_ms: 10.509257079366234
2025-03-13 19:24:08,553 [INFO]: 	99p_search_speed_ms: 14.485561554320157
2025-03-13 19:24:08,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:08,553 [INFO]: 	nb vectors: 2240
2025-03-13 19:24:08,553 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:08,553 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-13 19:24:08,553 [INFO]: }
2025-03-13 19:24:08,553 [INFO]: 	>>> Finished "Creating the index" in 43.3140 secs
2025-03-13 19:24:08,553 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3551 secs
2025-03-13 19:24:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 28486 [episode count 19/20]
2025-03-13 19:24:10: [retrieval_preprocessing] finished for 488975025_push_down_toaster_lever [chosen_id count 8/196]
2025-03-13 19:24:11: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 4938854758_put_pen_in_cup [chosen_id count 9/196]
2025-03-13 19:24:11: [retrieval_preprocessing] we have num_total=4492 embedding_dim=49152
[retrieval_preprocessing] for episode 67077 [episode count 0/20], we have num_retrieval=np.int64(4306) num_query=np.int64(186)
2025-03-13 19:24:12,206 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:12,942 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:12
2025-03-13 19:24:12,942 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2002.05it/s]
2025-03-13 19:24:13,195 [INFO]: There are 4306 embeddings of dim 49152
2025-03-13 19:24:13,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2531 secs
2025-03-13 19:24:13,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:13,195 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:24:13,195 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:13,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:24:13,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,196 [INFO]: 888.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:13,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:24:13,196 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:13
2025-03-13 19:24:13,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:13,196 [INFO]: 	Creating the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:13
2025-03-13 19:24:13,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:24:13,197 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,197 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:24:13,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.22it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.49it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.41it/s] 94%|█████████▍| 16/17 [00:00<00:00, 40.72it/s]100%|██████████| 17/17 [00:03<00:00,  4.84it/s]
2025-03-13 19:24:16,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:16
2025-03-13 19:24:54,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3652 secs
2025-03-13 19:24:54,080 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 19:24:54,080 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s]
2025-03-13 19:25:21,285 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2043 secs
2025-03-13 19:25:21,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0900 secs
2025-03-13 19:25:21,287 [INFO]: {
2025-03-13 19:25:21,288 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:21,288 [INFO]: 	index_param: efSearch=213
2025-03-13 19:25:21,288 [INFO]: 	index_path: knn.index
2025-03-13 19:25:21,288 [INFO]: 	size in bytes: 847179790
2025-03-13 19:25:21,288 [INFO]: 	avg_search_speed_ms: 8.831362591730596
2025-03-13 19:25:21,288 [INFO]: 	99p_search_speed_ms: 15.298763087484986
2025-03-13 19:25:21,288 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:21,288 [INFO]: 	nb vectors: 4306
2025-03-13 19:25:21,288 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:21,288 [INFO]: 	compression ratio: 0.9993085977652985
2025-03-13 19:25:21,288 [INFO]: }
2025-03-13 19:25:21,288 [INFO]: 	>>> Finished "Creating the index" in 68.0917 secs
2025-03-13 19:25:21,288 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3460 secs
2025-03-13 19:25:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 67077 [episode count 0/20]
[retrieval_preprocessing] for episode 67213 [episode count 1/20], we have num_retrieval=np.int64(4264) num_query=np.int64(228)
2025-03-13 19:25:23,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:24,594 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:24
2025-03-13 19:25:24,594 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1004.38it/s]
2025-03-13 19:25:24,636 [INFO]: There are 4264 embeddings of dim 49152
2025-03-13 19:25:24,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 19:25:24,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:24,637 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:25:24,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:24,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:24,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,637 [INFO]: 880.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:24,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:25:24,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:24
2025-03-13 19:25:24,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:24,637 [INFO]: 	Creating the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,637 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:24
2025-03-13 19:25:24,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:25:24,638 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,638 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:25:24,638 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.69it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.45it/s] 71%|███████   | 12/17 [00:00<00:00, 38.49it/s]100%|██████████| 17/17 [00:03<00:00,  3.20it/s]100%|██████████| 17/17 [00:03<00:00,  4.33it/s]
2025-03-13 19:25:28,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:28
2025-03-13 19:26:06,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9033 secs
2025-03-13 19:26:06,472 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 19:26:06,472 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.33it/s]
2025-03-13 19:26:38,519 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0472 secs
2025-03-13 19:26:38,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8835 secs
2025-03-13 19:26:38,522 [INFO]: {
2025-03-13 19:26:38,522 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:38,522 [INFO]: 	index_param: efSearch=241
2025-03-13 19:26:38,522 [INFO]: 	index_path: knn.index
2025-03-13 19:26:38,522 [INFO]: 	size in bytes: 838916410
2025-03-13 19:26:38,522 [INFO]: 	avg_search_speed_ms: 9.681903820490286
2025-03-13 19:26:38,522 [INFO]: 	99p_search_speed_ms: 14.169175699353218
2025-03-13 19:26:38,522 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:38,522 [INFO]: 	nb vectors: 4264
2025-03-13 19:26:38,522 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:38,522 [INFO]: 	compression ratio: 0.9993087535383889
2025-03-13 19:26:38,522 [INFO]: }
2025-03-13 19:26:38,522 [INFO]: 	>>> Finished "Creating the index" in 73.8850 secs
2025-03-13 19:26:38,522 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9282 secs
2025-03-13 19:26:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 67213 [episode count 1/20]
[retrieval_preprocessing] for episode 6161 [episode count 2/20], we have num_retrieval=np.int64(4332) num_query=np.int64(160)
2025-03-13 19:26:41,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:42,122 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:42
2025-03-13 19:26:42,122 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.90it/s]
2025-03-13 19:26:42,167 [INFO]: There are 4332 embeddings of dim 49152
2025-03-13 19:26:42,167 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0457 secs
2025-03-13 19:26:42,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:42
2025-03-13 19:26:42,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:42,168 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:26:42,168 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:42,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:26:42,168 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:42
2025-03-13 19:26:42,168 [INFO]: 894.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:42,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 19:26:42,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:42
2025-03-13 19:26:42,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:42,169 [INFO]: 	Creating the index 03/13/2025, 19:26:42
2025-03-13 19:26:42,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:42
2025-03-13 19:26:42,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:26:42,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:42
2025-03-13 19:26:42,172 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:26:42,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.82it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.61it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.97it/s]100%|██████████| 18/18 [00:03<00:00,  3.57it/s]100%|██████████| 18/18 [00:03<00:00,  4.96it/s]
2025-03-13 19:26:45,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:45
2025-03-13 19:27:24,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7004 secs
2025-03-13 19:27:24,506 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 19:27:24,506 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-13 19:27:42,341 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8351 secs
2025-03-13 19:27:42,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1712 secs
2025-03-13 19:27:42,344 [INFO]: {
2025-03-13 19:27:42,344 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:42,344 [INFO]: 	index_param: efSearch=161
2025-03-13 19:27:42,344 [INFO]: 	index_path: knn.index
2025-03-13 19:27:42,344 [INFO]: 	size in bytes: 852295150
2025-03-13 19:27:42,344 [INFO]: 	avg_search_speed_ms: 7.599084898489768
2025-03-13 19:27:42,344 [INFO]: 	99p_search_speed_ms: 11.200867244042454
2025-03-13 19:27:42,344 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:42,344 [INFO]: 	nb vectors: 4332
2025-03-13 19:27:42,344 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:42,344 [INFO]: 	compression ratio: 0.9993085798974686
2025-03-13 19:27:42,344 [INFO]: }
2025-03-13 19:27:42,344 [INFO]: 	>>> Finished "Creating the index" in 60.1743 secs
2025-03-13 19:27:42,344 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2221 secs
2025-03-13 19:27:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 6161 [episode count 2/20]
[retrieval_preprocessing] for episode 18832 [episode count 3/20], we have num_retrieval=np.int64(4243) num_query=np.int64(249)
2025-03-13 19:27:43,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:44,250 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:44
2025-03-13 19:27:44,250 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1807.89it/s]
2025-03-13 19:27:44,289 [INFO]: There are 4243 embeddings of dim 49152
2025-03-13 19:27:44,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0391 secs
2025-03-13 19:27:44,289 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:44
2025-03-13 19:27:44,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:44,289 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:27:44,289 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:44,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:44,289 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:44
2025-03-13 19:27:44,289 [INFO]: 875.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:44,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:27:44,289 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:44
2025-03-13 19:27:44,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:44,289 [INFO]: 	Creating the index 03/13/2025, 19:27:44
2025-03-13 19:27:44,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:44
2025-03-13 19:27:44,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:27:44,290 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:44
2025-03-13 19:27:44,290 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:27:44,290 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.43it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.78it/s] 59%|█████▉    | 10/17 [00:00<00:00, 35.54it/s] 94%|█████████▍| 16/17 [00:00<00:00, 42.79it/s]100%|██████████| 17/17 [00:03<00:00,  5.07it/s]
2025-03-13 19:27:47,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:47
2025-03-13 19:28:25,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3609 secs
2025-03-13 19:28:25,009 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 19:28:25,009 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 19:28:46,841 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8321 secs
2025-03-13 19:28:47,056 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7653 secs
2025-03-13 19:28:47,056 [INFO]: {
2025-03-13 19:28:47,056 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:47,056 [INFO]: 	index_param: efSearch=195
2025-03-13 19:28:47,056 [INFO]: 	index_path: knn.index
2025-03-13 19:28:47,056 [INFO]: 	size in bytes: 834784870
2025-03-13 19:28:47,056 [INFO]: 	avg_search_speed_ms: 8.671617751710071
2025-03-13 19:28:47,057 [INFO]: 	99p_search_speed_ms: 20.418286584317684
2025-03-13 19:28:47,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:47,057 [INFO]: 	nb vectors: 4243
2025-03-13 19:28:47,057 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:47,057 [INFO]: 	compression ratio: 0.9993086530185915
2025-03-13 19:28:47,057 [INFO]: }
2025-03-13 19:28:47,057 [INFO]: 	>>> Finished "Creating the index" in 62.7676 secs
2025-03-13 19:28:47,057 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8072 secs
2025-03-13 19:28:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 18832 [episode count 3/20]
[retrieval_preprocessing] for episode 42515 [episode count 4/20], we have num_retrieval=np.int64(4317) num_query=np.int64(175)
2025-03-13 19:28:51,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:52,393 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:52
2025-03-13 19:28:52,394 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.48it/s]
2025-03-13 19:28:52,428 [INFO]: There are 4317 embeddings of dim 49152
2025-03-13 19:28:52,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 19:28:52,428 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:52
2025-03-13 19:28:52,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:52,428 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:28:52,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:28:52,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:28:52,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:52
2025-03-13 19:28:52,429 [INFO]: 890.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:52,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:28:52,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:52
2025-03-13 19:28:52,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:52,429 [INFO]: 	Creating the index 03/13/2025, 19:28:52
2025-03-13 19:28:52,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:52
2025-03-13 19:28:52,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:28:52,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:52
2025-03-13 19:28:52,430 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:28:52,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.60it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.25it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.02it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.58it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.82it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.98it/s] 41%|████      | 7/17 [00:00<00:01,  8.06it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.15it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.27it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.25it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.26it/s] 71%|███████   | 12/17 [00:01<00:00,  8.27it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.24it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.28it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.35it/s] 94%|█████████▍| 16/17 [00:02<00:00,  8.29it/s]100%|██████████| 17/17 [00:05<00:00,  1.17s/it]100%|██████████| 17/17 [00:05<00:00,  3.02it/s]
2025-03-13 19:28:58,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:58
2025-03-13 19:29:38,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8409 secs
2025-03-13 19:29:38,904 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 19:29:38,904 [INFO]: 	Compute fast metrics 03/13/2025, 19:29:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s]
2025-03-13 19:29:58,208 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3032 secs
2025-03-13 19:29:58,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7799 secs
2025-03-13 19:29:58,210 [INFO]: {
2025-03-13 19:29:58,210 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:58,210 [INFO]: 	index_param: efSearch=144
2025-03-13 19:29:58,210 [INFO]: 	index_path: knn.index
2025-03-13 19:29:58,211 [INFO]: 	size in bytes: 849343930
2025-03-13 19:29:58,211 [INFO]: 	avg_search_speed_ms: 7.856842738857387
2025-03-13 19:29:58,211 [INFO]: 	99p_search_speed_ms: 13.756483115721489
2025-03-13 19:29:58,211 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:58,211 [INFO]: 	nb vectors: 4317
2025-03-13 19:29:58,211 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:58,211 [INFO]: 	compression ratio: 0.9993086499128804
2025-03-13 19:29:58,211 [INFO]: }
2025-03-13 19:29:58,211 [INFO]: 	>>> Finished "Creating the index" in 65.7818 secs
2025-03-13 19:29:58,211 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8171 secs
2025-03-13 19:29:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 42515 [episode count 4/20]
[retrieval_preprocessing] for episode 6300 [episode count 5/20], we have num_retrieval=np.int64(4284) num_query=np.int64(208)
2025-03-13 19:29:59,591 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:00,222 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:00
2025-03-13 19:30:00,222 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 988.29it/s]
2025-03-13 19:30:00,266 [INFO]: There are 4284 embeddings of dim 49152
2025-03-13 19:30:00,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0443 secs
2025-03-13 19:30:00,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:00
2025-03-13 19:30:00,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:00,267 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:30:00,267 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:00,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:00,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:00
2025-03-13 19:30:00,267 [INFO]: 884.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:00,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:30:00,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:00
2025-03-13 19:30:00,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:00,267 [INFO]: 	Creating the index 03/13/2025, 19:30:00
2025-03-13 19:30:00,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:00
2025-03-13 19:30:00,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:30:00,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:00
2025-03-13 19:30:00,268 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:30:00,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.25it/s] 41%|████      | 7/17 [00:00<00:00, 35.23it/s] 71%|███████   | 12/17 [00:00<00:00, 41.44it/s]100%|██████████| 17/17 [00:03<00:00,  3.51it/s]100%|██████████| 17/17 [00:03<00:00,  4.89it/s]
2025-03-13 19:30:03,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:03
2025-03-13 19:30:40,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9021 secs
2025-03-13 19:30:40,655 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 19:30:40,655 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 19:31:00,841 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1860 secs
2025-03-13 19:31:00,845 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5766 secs
2025-03-13 19:31:00,845 [INFO]: {
2025-03-13 19:31:00,845 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:00,845 [INFO]: 	index_param: efSearch=159
2025-03-13 19:31:00,845 [INFO]: 	index_path: knn.index
2025-03-13 19:31:00,845 [INFO]: 	size in bytes: 842851330
2025-03-13 19:31:00,845 [INFO]: 	avg_search_speed_ms: 9.60427258657953
2025-03-13 19:31:00,845 [INFO]: 	99p_search_speed_ms: 13.748577765654773
2025-03-13 19:31:00,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:00,845 [INFO]: 	nb vectors: 4284
2025-03-13 19:31:00,845 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:00,845 [INFO]: 	compression ratio: 0.999308706079873
2025-03-13 19:31:00,845 [INFO]: }
2025-03-13 19:31:00,845 [INFO]: 	>>> Finished "Creating the index" in 60.5782 secs
2025-03-13 19:31:00,845 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6232 secs
2025-03-13 19:31:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:31:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 6300 [episode count 5/20]
[retrieval_preprocessing] for episode 28449 [episode count 6/20], we have num_retrieval=np.int64(4256) num_query=np.int64(236)
2025-03-13 19:31:03,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:31:04,437 [INFO]: Launching the whole pipeline 03/13/2025, 19:31:04
2025-03-13 19:31:04,437 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:31:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.58it/s]
2025-03-13 19:31:04,464 [INFO]: There are 4256 embeddings of dim 49152
2025-03-13 19:31:04,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 19:31:04,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:31:04
2025-03-13 19:31:04,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:31:04,464 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:31:04,464 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:31:04,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:31:04,465 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:31:04
2025-03-13 19:31:04,465 [INFO]: 878.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:31:04,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:31:04,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:31:04
2025-03-13 19:31:04,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:31:04,465 [INFO]: 	Creating the index 03/13/2025, 19:31:04
2025-03-13 19:31:04,465 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:31:04
2025-03-13 19:31:04,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:31:04,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:31:04
2025-03-13 19:31:04,466 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:31:04,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.52it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.10it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.34it/s] 41%|████      | 7/17 [00:00<00:00, 10.87it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.41it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.66it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.84it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.11it/s]100%|██████████| 17/17 [00:05<00:00,  1.51it/s]100%|██████████| 17/17 [00:05<00:00,  3.28it/s]
2025-03-13 19:31:09,664 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:09
2025-03-13 19:31:47,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0768 secs
2025-03-13 19:31:47,741 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:31:47,741 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 19:32:09,368 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6265 secs
2025-03-13 19:32:09,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9048 secs
2025-03-13 19:32:09,371 [INFO]: {
2025-03-13 19:32:09,371 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:09,371 [INFO]: 	index_param: efSearch=280
2025-03-13 19:32:09,371 [INFO]: 	index_path: knn.index
2025-03-13 19:32:09,371 [INFO]: 	size in bytes: 837342490
2025-03-13 19:32:09,371 [INFO]: 	avg_search_speed_ms: 9.708864411149282
2025-03-13 19:32:09,371 [INFO]: 	99p_search_speed_ms: 14.970796387642624
2025-03-13 19:32:09,371 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:09,371 [INFO]: 	nb vectors: 4256
2025-03-13 19:32:09,371 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:09,371 [INFO]: 	compression ratio: 0.9993087153620975
2025-03-13 19:32:09,371 [INFO]: }
2025-03-13 19:32:09,371 [INFO]: 	>>> Finished "Creating the index" in 64.9063 secs
2025-03-13 19:32:09,371 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9341 secs
2025-03-13 19:32:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 28449 [episode count 6/20]
[retrieval_preprocessing] for episode 49954 [episode count 7/20], we have num_retrieval=np.int64(4248) num_query=np.int64(244)
2025-03-13 19:32:13,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:13,674 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:13
2025-03-13 19:32:13,674 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.41it/s]
2025-03-13 19:32:13,701 [INFO]: There are 4248 embeddings of dim 49152
2025-03-13 19:32:13,702 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 19:32:13,702 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:13
2025-03-13 19:32:13,702 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:13,702 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:32:13,702 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:32:13,702 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:32:13,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:13
2025-03-13 19:32:13,703 [INFO]: 876.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:13,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 19:32:13,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:13
2025-03-13 19:32:13,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:13,704 [INFO]: 	Creating the index 03/13/2025, 19:32:13
2025-03-13 19:32:13,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:13
2025-03-13 19:32:13,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:32:13,707 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:13
2025-03-13 19:32:13,707 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:32:13,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.24it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.12it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.49it/s] 41%|████      | 7/17 [00:00<00:00, 12.05it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.43it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.72it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.65it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.70it/s]100%|██████████| 17/17 [00:04<00:00,  1.95it/s]100%|██████████| 17/17 [00:04<00:00,  4.10it/s]
2025-03-13 19:32:17,863 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:17
2025-03-13 19:32:57,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7326 secs
2025-03-13 19:32:57,596 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 19:32:57,596 [INFO]: 	Compute fast metrics 03/13/2025, 19:32:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-13 19:33:15,476 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8792 secs
2025-03-13 19:33:15,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7714 secs
2025-03-13 19:33:15,479 [INFO]: {
2025-03-13 19:33:15,479 [INFO]: 	index_key: HNSW15
2025-03-13 19:33:15,479 [INFO]: 	index_param: efSearch=257
2025-03-13 19:33:15,479 [INFO]: 	index_path: knn.index
2025-03-13 19:33:15,479 [INFO]: 	size in bytes: 835768570
2025-03-13 19:33:15,479 [INFO]: 	avg_search_speed_ms: 9.570287341367827
2025-03-13 19:33:15,479 [INFO]: 	99p_search_speed_ms: 15.35840015858411
2025-03-13 19:33:15,479 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:33:15,479 [INFO]: 	nb vectors: 4248
2025-03-13 19:33:15,479 [INFO]: 	vectors dimension: 49152
2025-03-13 19:33:15,479 [INFO]: 	compression ratio: 0.999308677042019
2025-03-13 19:33:15,479 [INFO]: }
2025-03-13 19:33:15,479 [INFO]: 	>>> Finished "Creating the index" in 61.7752 secs
2025-03-13 19:33:15,479 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8052 secs
2025-03-13 19:33:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:33:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 49954 [episode count 7/20]
[retrieval_preprocessing] for episode 5795 [episode count 8/20], we have num_retrieval=np.int64(4276) num_query=np.int64(216)
2025-03-13 19:33:19,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:33:19,659 [INFO]: Launching the whole pipeline 03/13/2025, 19:33:19
2025-03-13 19:33:19,659 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.43it/s]
2025-03-13 19:33:19,685 [INFO]: There are 4276 embeddings of dim 49152
2025-03-13 19:33:19,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 19:33:19,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:33:19
2025-03-13 19:33:19,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:33:19,686 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:33:19,686 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:33:19,686 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:33:19,686 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:33:19
2025-03-13 19:33:19,686 [INFO]: 882.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:33:19,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:33:19,687 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:33:19
2025-03-13 19:33:19,687 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:33:19,687 [INFO]: 	Creating the index 03/13/2025, 19:33:19
2025-03-13 19:33:19,687 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:33:19
2025-03-13 19:33:19,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:33:19,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:33:19
2025-03-13 19:33:19,690 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:33:19,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.62it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.30it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.56it/s] 41%|████      | 7/17 [00:00<00:00, 12.06it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.29it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.51it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.60it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.52it/s]100%|██████████| 17/17 [00:04<00:00,  1.93it/s]100%|██████████| 17/17 [00:04<00:00,  4.07it/s]
2025-03-13 19:33:23,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:33:23
2025-03-13 19:33:58,281 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3987 secs
2025-03-13 19:33:58,281 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 19:33:58,281 [INFO]: 	Compute fast metrics 03/13/2025, 19:33:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 19:34:14,939 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6577 secs
2025-03-13 19:34:14,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2515 secs
2025-03-13 19:34:14,941 [INFO]: {
2025-03-13 19:34:14,941 [INFO]: 	index_key: HNSW15
2025-03-13 19:34:14,941 [INFO]: 	index_param: efSearch=277
2025-03-13 19:34:14,941 [INFO]: 	index_path: knn.index
2025-03-13 19:34:14,941 [INFO]: 	size in bytes: 841277350
2025-03-13 19:34:14,941 [INFO]: 	avg_search_speed_ms: 10.337988494711446
2025-03-13 19:34:14,941 [INFO]: 	99p_search_speed_ms: 14.815361057408154
2025-03-13 19:34:14,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:34:14,941 [INFO]: 	nb vectors: 4276
2025-03-13 19:34:14,942 [INFO]: 	vectors dimension: 49152
2025-03-13 19:34:14,942 [INFO]: 	compression ratio: 0.9993087392641677
2025-03-13 19:34:14,942 [INFO]: }
2025-03-13 19:34:14,942 [INFO]: 	>>> Finished "Creating the index" in 55.2543 secs
2025-03-13 19:34:14,942 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2828 secs
2025-03-13 19:34:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 5795 [episode count 8/20]
[retrieval_preprocessing] for episode 88110 [episode count 9/20], we have num_retrieval=np.int64(4332) num_query=np.int64(160)
2025-03-13 19:34:18,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:18,999 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:18
2025-03-13 19:34:18,999 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1585.15it/s]
2025-03-13 19:34:19,024 [INFO]: There are 4332 embeddings of dim 49152
2025-03-13 19:34:19,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 19:34:19,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:19
2025-03-13 19:34:19,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:19,024 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:34:19,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:34:19,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:34:19,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:19
2025-03-13 19:34:19,024 [INFO]: 894.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:19,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:34:19,025 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:19
2025-03-13 19:34:19,025 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:34:19,025 [INFO]: 	Creating the index 03/13/2025, 19:34:19
2025-03-13 19:34:19,025 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:34:19
2025-03-13 19:34:19,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:34:19,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:19
2025-03-13 19:34:19,025 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:34:19,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.52it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.98it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.20it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.94it/s] 50%|█████     | 9/18 [00:00<00:00, 12.25it/s] 61%|██████    | 11/18 [00:00<00:00, 12.57it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.69it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.60it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.72it/s]100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
2025-03-13 19:34:23,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:23
2025-03-13 19:35:03,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0218 secs
2025-03-13 19:35:03,338 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 19:35:03,338 [INFO]: 	Compute fast metrics 03/13/2025, 19:35:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 19:35:27,363 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0248 secs
2025-03-13 19:35:27,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3402 secs
2025-03-13 19:35:27,366 [INFO]: {
2025-03-13 19:35:27,366 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:27,366 [INFO]: 	index_param: efSearch=244
2025-03-13 19:35:27,366 [INFO]: 	index_path: knn.index
2025-03-13 19:35:27,366 [INFO]: 	size in bytes: 852295150
2025-03-13 19:35:27,366 [INFO]: 	avg_search_speed_ms: 9.678429857299914
2025-03-13 19:35:27,366 [INFO]: 	99p_search_speed_ms: 14.983545308932662
2025-03-13 19:35:27,366 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:27,366 [INFO]: 	nb vectors: 4332
2025-03-13 19:35:27,366 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:27,366 [INFO]: 	compression ratio: 0.9993085798974686
2025-03-13 19:35:27,366 [INFO]: }
2025-03-13 19:35:27,366 [INFO]: 	>>> Finished "Creating the index" in 68.3414 secs
2025-03-13 19:35:27,366 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3666 secs
2025-03-13 19:35:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 88110 [episode count 9/20]
[retrieval_preprocessing] for episode 36018 [episode count 10/20], we have num_retrieval=np.int64(4284) num_query=np.int64(208)
2025-03-13 19:35:30,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:35:30,764 [INFO]: Launching the whole pipeline 03/13/2025, 19:35:30
2025-03-13 19:35:30,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:35:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.41it/s]
2025-03-13 19:35:30,795 [INFO]: There are 4284 embeddings of dim 49152
2025-03-13 19:35:30,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 19:35:30,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:35:30
2025-03-13 19:35:30,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:35:30,795 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:35:30,795 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:35:30,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:35:30,795 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:35:30
2025-03-13 19:35:30,795 [INFO]: 884.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:35:30,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:35:30,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:35:30
2025-03-13 19:35:30,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:35:30,796 [INFO]: 	Creating the index 03/13/2025, 19:35:30
2025-03-13 19:35:30,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:35:30
2025-03-13 19:35:30,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:35:30,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:35:30
2025-03-13 19:35:30,797 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:35:30,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.55it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.34it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.42it/s] 41%|████      | 7/17 [00:00<00:00, 11.90it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.21it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.26it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.47it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.54it/s]100%|██████████| 17/17 [00:04<00:00,  1.74it/s]100%|██████████| 17/17 [00:04<00:00,  3.73it/s]
2025-03-13 19:35:35,357 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:35:35
2025-03-13 19:36:11,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8107 secs
2025-03-13 19:36:11,168 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 19:36:11,168 [INFO]: 	Compute fast metrics 03/13/2025, 19:36:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 19:36:32,276 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1080 secs
2025-03-13 19:36:32,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4822 secs
2025-03-13 19:36:32,279 [INFO]: {
2025-03-13 19:36:32,279 [INFO]: 	index_key: HNSW15
2025-03-13 19:36:32,279 [INFO]: 	index_param: efSearch=262
2025-03-13 19:36:32,279 [INFO]: 	index_path: knn.index
2025-03-13 19:36:32,279 [INFO]: 	size in bytes: 842851330
2025-03-13 19:36:32,279 [INFO]: 	avg_search_speed_ms: 11.59709078970683
2025-03-13 19:36:32,279 [INFO]: 	99p_search_speed_ms: 17.334141894243654
2025-03-13 19:36:32,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:36:32,279 [INFO]: 	nb vectors: 4284
2025-03-13 19:36:32,279 [INFO]: 	vectors dimension: 49152
2025-03-13 19:36:32,279 [INFO]: 	compression ratio: 0.999308706079873
2025-03-13 19:36:32,279 [INFO]: }
2025-03-13 19:36:32,279 [INFO]: 	>>> Finished "Creating the index" in 61.4836 secs
2025-03-13 19:36:32,279 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5148 secs
2025-03-13 19:36:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:36:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 36018 [episode count 10/20]
[retrieval_preprocessing] for episode 52920 [episode count 11/20], we have num_retrieval=np.int64(4282) num_query=np.int64(210)
2025-03-13 19:36:35,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:36,389 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:36
2025-03-13 19:36:36,389 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1108.43it/s]
2025-03-13 19:36:36,455 [INFO]: There are 4282 embeddings of dim 49152
2025-03-13 19:36:36,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0659 secs
2025-03-13 19:36:36,455 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:36
2025-03-13 19:36:36,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:36,456 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:36:36,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:36:36,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:36:36,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:36
2025-03-13 19:36:36,457 [INFO]: 883.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:36,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 19:36:36,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:36
2025-03-13 19:36:36,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:36,457 [INFO]: 	Creating the index 03/13/2025, 19:36:36
2025-03-13 19:36:36,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:36
2025-03-13 19:36:36,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:36:36,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:36
2025-03-13 19:36:36,461 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:36:36,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.33it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.67it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.40it/s] 94%|█████████▍| 16/17 [00:00<00:00, 42.44it/s]100%|██████████| 17/17 [00:03<00:00,  5.17it/s]
2025-03-13 19:36:39,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:36:39
2025-03-13 19:37:19,469 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7110 secs
2025-03-13 19:37:19,470 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 19:37:19,470 [INFO]: 	Compute fast metrics 03/13/2025, 19:37:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.17it/s]
2025-03-13 19:37:36,955 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4850 secs
2025-03-13 19:37:36,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4964 secs
2025-03-13 19:37:36,957 [INFO]: {
2025-03-13 19:37:36,958 [INFO]: 	index_key: HNSW15
2025-03-13 19:37:36,958 [INFO]: 	index_param: efSearch=171
2025-03-13 19:37:36,958 [INFO]: 	index_path: knn.index
2025-03-13 19:37:36,958 [INFO]: 	size in bytes: 842457850
2025-03-13 19:37:36,958 [INFO]: 	avg_search_speed_ms: 7.598223525069733
2025-03-13 19:37:36,958 [INFO]: 	99p_search_speed_ms: 10.917459928896275
2025-03-13 19:37:36,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:37:36,958 [INFO]: 	nb vectors: 4282
2025-03-13 19:37:36,958 [INFO]: 	vectors dimension: 49152
2025-03-13 19:37:36,958 [INFO]: 	compression ratio: 0.9993086965715852
2025-03-13 19:37:36,958 [INFO]: }
2025-03-13 19:37:36,958 [INFO]: 	>>> Finished "Creating the index" in 60.5004 secs
2025-03-13 19:37:36,958 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5685 secs
2025-03-13 19:37:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:37:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 52920 [episode count 11/20]
[retrieval_preprocessing] for episode 78904 [episode count 12/20], we have num_retrieval=np.int64(4301) num_query=np.int64(191)
2025-03-13 19:37:38,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:37:39,315 [INFO]: Launching the whole pipeline 03/13/2025, 19:37:39
2025-03-13 19:37:39,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:37:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.84it/s]
2025-03-13 19:37:39,353 [INFO]: There are 4301 embeddings of dim 49152
2025-03-13 19:37:39,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 19:37:39,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:37:39
2025-03-13 19:37:39,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:37:39,354 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:37:39,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:37:39,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:37:39,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:37:39
2025-03-13 19:37:39,354 [INFO]: 887.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:37:39,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:37:39,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:37:39
2025-03-13 19:37:39,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:37:39,354 [INFO]: 	Creating the index 03/13/2025, 19:37:39
2025-03-13 19:37:39,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:37:39
2025-03-13 19:37:39,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:37:39,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:37:39
2025-03-13 19:37:39,356 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:37:39,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 28.06it/s] 59%|█████▉    | 10/17 [00:00<00:00, 49.45it/s]100%|██████████| 17/17 [00:03<00:00,  4.28it/s]100%|██████████| 17/17 [00:03<00:00,  5.30it/s]
2025-03-13 19:37:42,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:37:42
2025-03-13 19:38:18,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0218 secs
2025-03-13 19:38:18,593 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 19:38:18,593 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.86it/s]
2025-03-13 19:38:39,091 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4983 secs
2025-03-13 19:38:39,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7379 secs
2025-03-13 19:38:39,094 [INFO]: {
2025-03-13 19:38:39,094 [INFO]: 	index_key: HNSW15
2025-03-13 19:38:39,094 [INFO]: 	index_param: efSearch=256
2025-03-13 19:38:39,094 [INFO]: 	index_path: knn.index
2025-03-13 19:38:39,094 [INFO]: 	size in bytes: 846196090
2025-03-13 19:38:39,094 [INFO]: 	avg_search_speed_ms: 10.088818069071886
2025-03-13 19:38:39,094 [INFO]: 	99p_search_speed_ms: 16.010343562811613
2025-03-13 19:38:39,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:38:39,094 [INFO]: 	nb vectors: 4301
2025-03-13 19:38:39,094 [INFO]: 	vectors dimension: 49152
2025-03-13 19:38:39,094 [INFO]: 	compression ratio: 0.9993085739736756
2025-03-13 19:38:39,094 [INFO]: }
2025-03-13 19:38:39,094 [INFO]: 	>>> Finished "Creating the index" in 59.7399 secs
2025-03-13 19:38:39,094 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7792 secs
2025-03-13 19:38:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:38:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 78904 [episode count 12/20]
[retrieval_preprocessing] for episode 89911 [episode count 13/20], we have num_retrieval=np.int64(4030) num_query=np.int64(462)
2025-03-13 19:38:41,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:38:41,832 [INFO]: Launching the whole pipeline 03/13/2025, 19:38:41
2025-03-13 19:38:41,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:38:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1324.38it/s]
2025-03-13 19:38:41,872 [INFO]: There are 4030 embeddings of dim 49152
2025-03-13 19:38:41,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 19:38:41,872 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:38:41
2025-03-13 19:38:41,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:38:41,873 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 19:38:41,873 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:38:41,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:38:41,873 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:38:41
2025-03-13 19:38:41,873 [INFO]: 831.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:38:41,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:38:41,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:38:41
2025-03-13 19:38:41,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:38:41,874 [INFO]: 	Creating the index 03/13/2025, 19:38:41
2025-03-13 19:38:41,874 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:38:41
2025-03-13 19:38:41,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:38:41,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:38:41
2025-03-13 19:38:41,877 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:38:41,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 27.10it/s] 56%|█████▋    | 9/16 [00:00<00:00, 44.07it/s] 88%|████████▊ | 14/16 [00:00<00:00, 44.98it/s]100%|██████████| 16/16 [00:03<00:00,  4.46it/s]
2025-03-13 19:38:45,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:45
2025-03-13 19:39:23,111 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6383 secs
2025-03-13 19:39:23,112 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 19:39:23,112 [INFO]: 	Compute fast metrics 03/13/2025, 19:39:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.64it/s]
2025-03-13 19:39:41,073 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9608 secs
2025-03-13 19:39:41,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1976 secs
2025-03-13 19:39:41,075 [INFO]: {
2025-03-13 19:39:41,075 [INFO]: 	index_key: HNSW15
2025-03-13 19:39:41,075 [INFO]: 	index_param: efSearch=248
2025-03-13 19:39:41,075 [INFO]: 	index_path: knn.index
2025-03-13 19:39:41,075 [INFO]: 	size in bytes: 792878470
2025-03-13 19:39:41,075 [INFO]: 	avg_search_speed_ms: 8.622387510419276
2025-03-13 19:39:41,075 [INFO]: 	99p_search_speed_ms: 12.45105907553808
2025-03-13 19:39:41,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:39:41,075 [INFO]: 	nb vectors: 4030
2025-03-13 19:39:41,075 [INFO]: 	vectors dimension: 49152
2025-03-13 19:39:41,075 [INFO]: 	compression ratio: 0.9993085573379235
2025-03-13 19:39:41,075 [INFO]: }
2025-03-13 19:39:41,075 [INFO]: 	>>> Finished "Creating the index" in 59.2011 secs
2025-03-13 19:39:41,075 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2433 secs
2025-03-13 19:39:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:39:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 89911 [episode count 13/20]
[retrieval_preprocessing] for episode 54977 [episode count 14/20], we have num_retrieval=np.int64(4288) num_query=np.int64(204)
2025-03-13 19:39:45,292 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:39:45,789 [INFO]: Launching the whole pipeline 03/13/2025, 19:39:45
2025-03-13 19:39:45,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:39:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 984.12it/s]
2025-03-13 19:39:45,826 [INFO]: There are 4288 embeddings of dim 49152
2025-03-13 19:39:45,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 19:39:45,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:39:45
2025-03-13 19:39:45,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:39:45,826 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:39:45,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:39:45,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:39:45,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:39:45
2025-03-13 19:39:45,826 [INFO]: 884.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:39:45,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:39:45,827 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:39:45
2025-03-13 19:39:45,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:39:45,827 [INFO]: 	Creating the index 03/13/2025, 19:39:45
2025-03-13 19:39:45,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:39:45
2025-03-13 19:39:45,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:39:45,828 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:39:45
2025-03-13 19:39:45,828 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:39:45,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.77it/s] 53%|█████▎    | 9/17 [00:00<00:00, 44.34it/s] 94%|█████████▍| 16/17 [00:00<00:00, 53.15it/s]100%|██████████| 17/17 [00:03<00:00,  5.44it/s]
2025-03-13 19:39:48,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:39:48
2025-03-13 19:40:24,549 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5902 secs
2025-03-13 19:40:24,549 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 19:40:24,549 [INFO]: 	Compute fast metrics 03/13/2025, 19:40:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.22it/s]
2025-03-13 19:40:42,522 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9727 secs
2025-03-13 19:40:42,524 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6963 secs
2025-03-13 19:40:42,524 [INFO]: {
2025-03-13 19:40:42,524 [INFO]: 	index_key: HNSW15
2025-03-13 19:40:42,524 [INFO]: 	index_param: efSearch=244
2025-03-13 19:40:42,524 [INFO]: 	index_path: knn.index
2025-03-13 19:40:42,524 [INFO]: 	size in bytes: 843638290
2025-03-13 19:40:42,524 [INFO]: 	avg_search_speed_ms: 9.180736933262716
2025-03-13 19:40:42,524 [INFO]: 	99p_search_speed_ms: 14.008330013602965
2025-03-13 19:40:42,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:40:42,524 [INFO]: 	nb vectors: 4288
2025-03-13 19:40:42,524 [INFO]: 	vectors dimension: 49152
2025-03-13 19:40:42,524 [INFO]: 	compression ratio: 0.99930872506984
2025-03-13 19:40:42,524 [INFO]: }
2025-03-13 19:40:42,524 [INFO]: 	>>> Finished "Creating the index" in 56.6978 secs
2025-03-13 19:40:42,524 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7355 secs
2025-03-13 19:40:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:40:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 54977 [episode count 14/20]
[retrieval_preprocessing] for episode 10950 [episode count 15/20], we have num_retrieval=np.int64(4263) num_query=np.int64(229)
2025-03-13 19:40:44,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:40:45,180 [INFO]: Launching the whole pipeline 03/13/2025, 19:40:45
2025-03-13 19:40:45,180 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:40:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 19:40:45,215 [INFO]: There are 4263 embeddings of dim 49152
2025-03-13 19:40:45,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 19:40:45,215 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:40:45
2025-03-13 19:40:45,215 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:40:45,215 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:40:45,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:40:45,215 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:40:45,215 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:40:45
2025-03-13 19:40:45,215 [INFO]: 879.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:40:45,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:40:45,215 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:40:45
2025-03-13 19:40:45,215 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:40:45,215 [INFO]: 	Creating the index 03/13/2025, 19:40:45
2025-03-13 19:40:45,215 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:40:45
2025-03-13 19:40:45,216 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:40:45,216 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:40:45
2025-03-13 19:40:45,216 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:40:45,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.99it/s] 47%|████▋     | 8/17 [00:00<00:00, 40.14it/s] 88%|████████▊ | 15/17 [00:00<00:00, 50.80it/s]100%|██████████| 17/17 [00:03<00:00,  5.60it/s]
2025-03-13 19:40:48,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:40:48
2025-03-13 19:41:21,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5020 secs
2025-03-13 19:41:21,759 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 19:41:21,759 [INFO]: 	Compute fast metrics 03/13/2025, 19:41:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.99it/s]
2025-03-13 19:41:38,073 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3137 secs
2025-03-13 19:41:38,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8584 secs
2025-03-13 19:41:38,075 [INFO]: {
2025-03-13 19:41:38,075 [INFO]: 	index_key: HNSW15
2025-03-13 19:41:38,075 [INFO]: 	index_param: efSearch=250
2025-03-13 19:41:38,075 [INFO]: 	index_path: knn.index
2025-03-13 19:41:38,075 [INFO]: 	size in bytes: 838719670
2025-03-13 19:41:38,075 [INFO]: 	avg_search_speed_ms: 9.43855663414447
2025-03-13 19:41:38,075 [INFO]: 	99p_search_speed_ms: 13.956040795892479
2025-03-13 19:41:38,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:41:38,075 [INFO]: 	nb vectors: 4263
2025-03-13 19:41:38,075 [INFO]: 	vectors dimension: 49152
2025-03-13 19:41:38,075 [INFO]: 	compression ratio: 0.9993087487741882
2025-03-13 19:41:38,075 [INFO]: }
2025-03-13 19:41:38,075 [INFO]: 	>>> Finished "Creating the index" in 52.8597 secs
2025-03-13 19:41:38,075 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8948 secs
2025-03-13 19:41:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:41:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 10950 [episode count 15/20]
[retrieval_preprocessing] for episode 51028 [episode count 16/20], we have num_retrieval=np.int64(4229) num_query=np.int64(263)
2025-03-13 19:41:39,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:41:40,414 [INFO]: Launching the whole pipeline 03/13/2025, 19:41:40
2025-03-13 19:41:40,414 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:41:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 19:41:40,449 [INFO]: There are 4229 embeddings of dim 49152
2025-03-13 19:41:40,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 19:41:40,449 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:41:40
2025-03-13 19:41:40,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:41:40,449 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:41:40,449 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:41:40,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:41:40,449 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:41:40
2025-03-13 19:41:40,449 [INFO]: 872.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:41:40,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:41:40,449 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:41:40
2025-03-13 19:41:40,450 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:41:40,450 [INFO]: 	Creating the index 03/13/2025, 19:41:40
2025-03-13 19:41:40,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:41:40
2025-03-13 19:41:40,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:41:40,450 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:41:40
2025-03-13 19:41:40,451 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:41:40,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.48it/s] 59%|█████▉    | 10/17 [00:00<00:00, 48.59it/s]100%|██████████| 17/17 [00:02<00:00,  5.18it/s]100%|██████████| 17/17 [00:02<00:00,  6.27it/s]
2025-03-13 19:41:43,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:41:43
2025-03-13 19:42:17,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3640 secs
2025-03-13 19:42:17,531 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 19:42:17,531 [INFO]: 	Compute fast metrics 03/13/2025, 19:42:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.92it/s]
2025-03-13 19:42:34,603 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0716 secs
2025-03-13 19:42:34,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1546 secs
2025-03-13 19:42:34,605 [INFO]: {
2025-03-13 19:42:34,605 [INFO]: 	index_key: HNSW15
2025-03-13 19:42:34,605 [INFO]: 	index_param: efSearch=224
2025-03-13 19:42:34,605 [INFO]: 	index_path: knn.index
2025-03-13 19:42:34,605 [INFO]: 	size in bytes: 832030330
2025-03-13 19:42:34,605 [INFO]: 	avg_search_speed_ms: 8.275347146512964
2025-03-13 19:42:34,605 [INFO]: 	99p_search_speed_ms: 11.739099193364382
2025-03-13 19:42:34,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:42:34,605 [INFO]: 	nb vectors: 4229
2025-03-13 19:42:34,605 [INFO]: 	vectors dimension: 49152
2025-03-13 19:42:34,605 [INFO]: 	compression ratio: 0.9993088016394787
2025-03-13 19:42:34,605 [INFO]: }
2025-03-13 19:42:34,605 [INFO]: 	>>> Finished "Creating the index" in 54.1558 secs
2025-03-13 19:42:34,605 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1914 secs
2025-03-13 19:42:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:42:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 51028 [episode count 16/20]
[retrieval_preprocessing] for episode 45018 [episode count 17/20], we have num_retrieval=np.int64(4336) num_query=np.int64(156)
2025-03-13 19:42:36,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:42:37,089 [INFO]: Launching the whole pipeline 03/13/2025, 19:42:37
2025-03-13 19:42:37,090 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:42:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.08it/s]
2025-03-13 19:42:37,277 [INFO]: There are 4336 embeddings of dim 49152
2025-03-13 19:42:37,277 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1877 secs
2025-03-13 19:42:37,277 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:42:37
2025-03-13 19:42:37,277 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:42:37,277 [INFO]: 		-> Add: 2.4 seconds
2025-03-13 19:42:37,277 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:42:37,277 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:42:37,277 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:42:37
2025-03-13 19:42:37,278 [INFO]: 894.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:42:37,278 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:42:37,278 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:42:37
2025-03-13 19:42:37,278 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:42:37,278 [INFO]: 	Creating the index 03/13/2025, 19:42:37
2025-03-13 19:42:37,278 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:42:37
2025-03-13 19:42:37,279 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:42:37,279 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:42:37
2025-03-13 19:42:37,279 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:42:37,279 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.97it/s] 44%|████▍     | 8/18 [00:00<00:00, 43.74it/s] 83%|████████▎ | 15/18 [00:00<00:00, 53.78it/s]100%|██████████| 18/18 [00:03<00:00,  5.96it/s]
2025-03-13 19:42:40,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:42:40
2025-03-13 19:43:15,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7948 secs
2025-03-13 19:43:15,095 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 19:43:15,095 [INFO]: 	Compute fast metrics 03/13/2025, 19:43:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.58it/s]
2025-03-13 19:43:31,872 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7764 secs
2025-03-13 19:43:31,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5951 secs
2025-03-13 19:43:31,874 [INFO]: {
2025-03-13 19:43:31,874 [INFO]: 	index_key: HNSW15
2025-03-13 19:43:31,874 [INFO]: 	index_param: efSearch=261
2025-03-13 19:43:31,874 [INFO]: 	index_path: knn.index
2025-03-13 19:43:31,874 [INFO]: 	size in bytes: 853082110
2025-03-13 19:43:31,874 [INFO]: 	avg_search_speed_ms: 9.568185188794178
2025-03-13 19:43:31,874 [INFO]: 	99p_search_speed_ms: 13.563420046120882
2025-03-13 19:43:31,874 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:43:31,874 [INFO]: 	nb vectors: 4336
2025-03-13 19:43:31,874 [INFO]: 	vectors dimension: 49152
2025-03-13 19:43:31,874 [INFO]: 	compression ratio: 0.9993085987936143
2025-03-13 19:43:31,874 [INFO]: }
2025-03-13 19:43:31,874 [INFO]: 	>>> Finished "Creating the index" in 54.5965 secs
2025-03-13 19:43:31,874 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7846 secs
2025-03-13 19:43:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:43:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 45018 [episode count 17/20]
[retrieval_preprocessing] for episode 5343 [episode count 18/20], we have num_retrieval=np.int64(4255) num_query=np.int64(237)
2025-03-13 19:43:33,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:43:33,984 [INFO]: Launching the whole pipeline 03/13/2025, 19:43:33
2025-03-13 19:43:33,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:43:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1561.54it/s]
2025-03-13 19:43:34,019 [INFO]: There are 4255 embeddings of dim 49152
2025-03-13 19:43:34,019 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 19:43:34,019 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:43:34
2025-03-13 19:43:34,019 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:43:34,019 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:43:34,019 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:43:34,019 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:43:34,019 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:43:34
2025-03-13 19:43:34,019 [INFO]: 878.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:43:34,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:43:34,020 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:43:34
2025-03-13 19:43:34,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:43:34,020 [INFO]: 	Creating the index 03/13/2025, 19:43:34
2025-03-13 19:43:34,020 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:43:34
2025-03-13 19:43:34,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:43:34,021 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:43:34
2025-03-13 19:43:34,021 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:43:34,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.07it/s] 47%|████▋     | 8/17 [00:00<00:00, 42.14it/s] 88%|████████▊ | 15/17 [00:00<00:00, 53.57it/s]100%|██████████| 17/17 [00:02<00:00,  6.36it/s]
2025-03-13 19:43:36,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:43:36
2025-03-13 19:44:10,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9548 secs
2025-03-13 19:44:10,654 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 19:44:10,655 [INFO]: 	Compute fast metrics 03/13/2025, 19:44:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.38it/s]
2025-03-13 19:44:24,208 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5534 secs
2025-03-13 19:44:24,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1895 secs
2025-03-13 19:44:24,210 [INFO]: {
2025-03-13 19:44:24,210 [INFO]: 	index_key: HNSW15
2025-03-13 19:44:24,210 [INFO]: 	index_param: efSearch=244
2025-03-13 19:44:24,210 [INFO]: 	index_path: knn.index
2025-03-13 19:44:24,210 [INFO]: 	size in bytes: 837145750
2025-03-13 19:44:24,210 [INFO]: 	avg_search_speed_ms: 8.35267191333774
2025-03-13 19:44:24,210 [INFO]: 	99p_search_speed_ms: 11.173392243217677
2025-03-13 19:44:24,210 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:44:24,210 [INFO]: 	nb vectors: 4255
2025-03-13 19:44:24,210 [INFO]: 	vectors dimension: 49152
2025-03-13 19:44:24,211 [INFO]: 	compression ratio: 0.9993087105799677
2025-03-13 19:44:24,211 [INFO]: }
2025-03-13 19:44:24,211 [INFO]: 	>>> Finished "Creating the index" in 50.1909 secs
2025-03-13 19:44:24,211 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2264 secs
2025-03-13 19:44:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:44:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 5343 [episode count 18/20]
[retrieval_preprocessing] for episode 75629 [episode count 19/20], we have num_retrieval=np.int64(4222) num_query=np.int64(270)
2025-03-13 19:44:26,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:44:27,093 [INFO]: Launching the whole pipeline 03/13/2025, 19:44:27
2025-03-13 19:44:27,093 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:44:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.31it/s]
2025-03-13 19:44:27,128 [INFO]: There are 4222 embeddings of dim 49152
2025-03-13 19:44:27,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 19:44:27,128 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:44:27
2025-03-13 19:44:27,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:44:27,128 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 19:44:27,128 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:44:27,128 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:44:27,128 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:44:27
2025-03-13 19:44:27,128 [INFO]: 871.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:44:27,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:44:27,129 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:44:27
2025-03-13 19:44:27,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:44:27,129 [INFO]: 	Creating the index 03/13/2025, 19:44:27
2025-03-13 19:44:27,129 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:44:27
2025-03-13 19:44:27,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:44:27,130 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:44:27
2025-03-13 19:44:27,130 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 19:44:27,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.43it/s] 53%|█████▎    | 9/17 [00:00<00:00, 46.66it/s] 94%|█████████▍| 16/17 [00:00<00:00, 54.81it/s]100%|██████████| 17/17 [00:02<00:00,  5.79it/s]
2025-03-13 19:44:30,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:44:30
2025-03-13 19:45:04,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2158 secs
2025-03-13 19:45:04,284 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 19:45:04,285 [INFO]: 	Compute fast metrics 03/13/2025, 19:45:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.63it/s]
2025-03-13 19:45:22,075 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7907 secs
2025-03-13 19:45:22,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9476 secs
2025-03-13 19:45:22,077 [INFO]: {
2025-03-13 19:45:22,077 [INFO]: 	index_key: HNSW15
2025-03-13 19:45:22,078 [INFO]: 	index_param: efSearch=265
2025-03-13 19:45:22,078 [INFO]: 	index_path: knn.index
2025-03-13 19:45:22,078 [INFO]: 	size in bytes: 830653150
2025-03-13 19:45:22,078 [INFO]: 	avg_search_speed_ms: 9.42193728954077
2025-03-13 19:45:22,078 [INFO]: 	99p_search_speed_ms: 13.497650541830808
2025-03-13 19:45:22,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:45:22,078 [INFO]: 	nb vectors: 4222
2025-03-13 19:45:22,078 [INFO]: 	vectors dimension: 49152
2025-03-13 19:45:22,078 [INFO]: 	compression ratio: 0.9993087680459648
2025-03-13 19:45:22,078 [INFO]: }
2025-03-13 19:45:22,078 [INFO]: 	>>> Finished "Creating the index" in 54.9489 secs
2025-03-13 19:45:22,078 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9850 secs
2025-03-13 19:45:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:45:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 75629 [episode count 19/20]
2025-03-13 19:45:24: [retrieval_preprocessing] finished for 4938854758_put_pen_in_cup [chosen_id count 9/196]
2025-03-13 19:45:24: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
