2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5059283044_put_screwdriver_in_drawer_and_close [chosen_id count 0/196]
2025-03-13 14:35:06: [retrieval_preprocessing] we have num_total=3254 embedding_dim=49152
[retrieval_preprocessing] for episode 58369 [episode count 0/20], we have num_retrieval=np.int64(3131) num_query=np.int64(123)
2025-03-13 14:35:08,249 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:08,959 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:08
2025-03-13 14:35:08,960 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 632.34it/s]
2025-03-13 14:35:09,008 [INFO]: There are 3131 embeddings of dim 49152
2025-03-13 14:35:09,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0485 secs
2025-03-13 14:35:09,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:09,009 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:35:09,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:09,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:35:09,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,011 [INFO]: 646.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:09,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0018 secs
2025-03-13 14:35:09,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:09
2025-03-13 14:35:09,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:09,012 [INFO]: 	Creating the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:09
2025-03-13 14:35:09,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0058 secs
2025-03-13 14:35:09,018 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,019 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:35:09,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.22it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.03it/s] 31%|███       | 4/13 [00:00<00:01,  6.68it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.33it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.68it/s] 54%|█████▍    | 7/13 [00:01<00:00,  7.50it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.52it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.90it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.25it/s]100%|██████████| 13/13 [00:06<00:00,  1.07s/it]100%|██████████| 13/13 [00:06<00:00,  2.03it/s]
2025-03-13 14:35:15,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:15
2025-03-13 14:35:55,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0064 secs
2025-03-13 14:35:55,452 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 14:35:55,452 [INFO]: 	Compute fast metrics 03/13/2025, 14:35:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s]
2025-03-13 14:36:13,797 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3450 secs
2025-03-13 14:36:13,801 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7824 secs
2025-03-13 14:36:13,801 [INFO]: {
2025-03-13 14:36:13,801 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:13,801 [INFO]: 	index_param: efSearch=281
2025-03-13 14:36:13,801 [INFO]: 	index_path: knn.index
2025-03-13 14:36:13,801 [INFO]: 	size in bytes: 616004950
2025-03-13 14:36:13,801 [INFO]: 	avg_search_speed_ms: 10.982939977051627
2025-03-13 14:36:13,801 [INFO]: 	99p_search_speed_ms: 19.480074802413565
2025-03-13 14:36:13,801 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:13,801 [INFO]: 	nb vectors: 3131
2025-03-13 14:36:13,801 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:13,801 [INFO]: 	compression ratio: 0.9993095802233407
2025-03-13 14:36:13,801 [INFO]: }
2025-03-13 14:36:13,801 [INFO]: 	>>> Finished "Creating the index" in 64.7895 secs
2025-03-13 14:36:13,801 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8418 secs
2025-03-13 14:36:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 58369 [episode count 0/20]
[retrieval_preprocessing] for episode 71681 [episode count 1/20], we have num_retrieval=np.int64(3109) num_query=np.int64(145)
2025-03-13 14:36:16,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:17,322 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:17
2025-03-13 14:36:17,322 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.81it/s]
2025-03-13 14:36:17,352 [INFO]: There are 3109 embeddings of dim 49152
2025-03-13 14:36:17,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 14:36:17,352 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:17
2025-03-13 14:36:17,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:17,352 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:36:17,352 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:17,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:36:17,352 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:17
2025-03-13 14:36:17,353 [INFO]: 641.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:17,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:17,353 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:17
2025-03-13 14:36:17,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:17,353 [INFO]: 	Creating the index 03/13/2025, 14:36:17
2025-03-13 14:36:17,353 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:17
2025-03-13 14:36:17,354 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:36:17,354 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:17
2025-03-13 14:36:17,354 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:36:17,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.70it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.38it/s] 31%|███       | 4/13 [00:00<00:01,  8.22it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.38it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.98it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.29it/s] 62%|██████▏   | 8/13 [00:01<00:00,  6.90it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.70it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.46it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.32it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.41it/s]100%|██████████| 13/13 [00:04<00:00,  1.11it/s]100%|██████████| 13/13 [00:04<00:00,  2.96it/s]
2025-03-13 14:36:21,756 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:21
2025-03-13 14:37:02,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7660 secs
2025-03-13 14:37:02,523 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 14:37:02,524 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.84it/s]
2025-03-13 14:37:21,036 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5126 secs
2025-03-13 14:37:21,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6847 secs
2025-03-13 14:37:21,039 [INFO]: {
2025-03-13 14:37:21,039 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:21,040 [INFO]: 	index_param: efSearch=223
2025-03-13 14:37:21,040 [INFO]: 	index_path: knn.index
2025-03-13 14:37:21,040 [INFO]: 	size in bytes: 611676490
2025-03-13 14:37:21,040 [INFO]: 	avg_search_speed_ms: 13.36535214519847
2025-03-13 14:37:21,040 [INFO]: 	99p_search_speed_ms: 19.06510639935732
2025-03-13 14:37:21,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:21,040 [INFO]: 	nb vectors: 3109
2025-03-13 14:37:21,040 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:21,040 [INFO]: 	compression ratio: 0.9993097364261948
2025-03-13 14:37:21,040 [INFO]: }
2025-03-13 14:37:21,040 [INFO]: 	>>> Finished "Creating the index" in 63.6869 secs
2025-03-13 14:37:21,040 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7174 secs
2025-03-13 14:37:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 71681 [episode count 1/20]
[retrieval_preprocessing] for episode 36358 [episode count 2/20], we have num_retrieval=np.int64(3105) num_query=np.int64(149)
2025-03-13 14:37:23,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:23,589 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:23
2025-03-13 14:37:23,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.17it/s]
2025-03-13 14:37:23,623 [INFO]: There are 3105 embeddings of dim 49152
2025-03-13 14:37:23,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 14:37:23,623 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:23
2025-03-13 14:37:23,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:23,623 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:37:23,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:23,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:23,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:23
2025-03-13 14:37:23,624 [INFO]: 640.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:23,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:23,624 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:23
2025-03-13 14:37:23,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:23,624 [INFO]: 	Creating the index 03/13/2025, 14:37:23
2025-03-13 14:37:23,624 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:23
2025-03-13 14:37:23,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:37:23,625 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:23
2025-03-13 14:37:23,625 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:37:23,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.01it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.05it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.19it/s]100%|██████████| 13/13 [00:03<00:00,  4.22it/s]
2025-03-13 14:37:26,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:26
2025-03-13 14:38:09,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5647 secs
2025-03-13 14:38:09,275 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 14:38:09,276 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.49it/s]
2025-03-13 14:38:24,282 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0061 secs
2025-03-13 14:38:24,284 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6593 secs
2025-03-13 14:38:24,285 [INFO]: {
2025-03-13 14:38:24,285 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:24,285 [INFO]: 	index_param: efSearch=213
2025-03-13 14:38:24,285 [INFO]: 	index_path: knn.index
2025-03-13 14:38:24,285 [INFO]: 	size in bytes: 610889530
2025-03-13 14:38:24,285 [INFO]: 	avg_search_speed_ms: 12.721091436883363
2025-03-13 14:38:24,285 [INFO]: 	99p_search_speed_ms: 19.64735373621806
2025-03-13 14:38:24,285 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:24,285 [INFO]: 	nb vectors: 3105
2025-03-13 14:38:24,285 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:24,285 [INFO]: 	compression ratio: 0.9993097115283675
2025-03-13 14:38:24,285 [INFO]: }
2025-03-13 14:38:24,285 [INFO]: 	>>> Finished "Creating the index" in 60.6612 secs
2025-03-13 14:38:24,285 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6958 secs
2025-03-13 14:38:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 36358 [episode count 2/20]
[retrieval_preprocessing] for episode 12822 [episode count 3/20], we have num_retrieval=np.int64(2987) num_query=np.int64(267)
2025-03-13 14:38:25,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:26,214 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:26
2025-03-13 14:38:26,214 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1105.80it/s]
2025-03-13 14:38:26,247 [INFO]: There are 2987 embeddings of dim 49152
2025-03-13 14:38:26,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 14:38:26,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:26
2025-03-13 14:38:26,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:26,247 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:38:26,247 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:26,247 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:26,247 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:26
2025-03-13 14:38:26,248 [INFO]: 616.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:26,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:38:26,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:26
2025-03-13 14:38:26,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:26,248 [INFO]: 	Creating the index 03/13/2025, 14:38:26
2025-03-13 14:38:26,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:26
2025-03-13 14:38:26,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:38:26,249 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:26
2025-03-13 14:38:26,249 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:38:26,249 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.37it/s] 50%|█████     | 6/12 [00:00<00:00, 28.38it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.02it/s]
2025-03-13 14:38:29,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:29
2025-03-13 14:39:07,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5731 secs
2025-03-13 14:39:07,814 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 14:39:07,814 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.87it/s]
2025-03-13 14:39:25,393 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5787 secs
2025-03-13 14:39:25,396 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1467 secs
2025-03-13 14:39:25,396 [INFO]: {
2025-03-13 14:39:25,396 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:25,396 [INFO]: 	index_param: efSearch=127
2025-03-13 14:39:25,396 [INFO]: 	index_path: knn.index
2025-03-13 14:39:25,396 [INFO]: 	size in bytes: 587673790
2025-03-13 14:39:25,396 [INFO]: 	avg_search_speed_ms: 10.600193275271076
2025-03-13 14:39:25,396 [INFO]: 	99p_search_speed_ms: 17.763137677684433
2025-03-13 14:39:25,396 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:25,396 [INFO]: 	nb vectors: 2987
2025-03-13 14:39:25,396 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:25,396 [INFO]: 	compression ratio: 0.9993096612322969
2025-03-13 14:39:25,396 [INFO]: }
2025-03-13 14:39:25,396 [INFO]: 	>>> Finished "Creating the index" in 59.1485 secs
2025-03-13 14:39:25,396 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1822 secs
2025-03-13 14:39:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 12822 [episode count 3/20]
[retrieval_preprocessing] for episode 54294 [episode count 4/20], we have num_retrieval=np.int64(3101) num_query=np.int64(153)
2025-03-13 14:39:28,394 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:28,807 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:28
2025-03-13 14:39:28,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.87it/s]
2025-03-13 14:39:28,831 [INFO]: There are 3101 embeddings of dim 49152
2025-03-13 14:39:28,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 14:39:28,832 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:28
2025-03-13 14:39:28,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:28,832 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:39:28,832 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:28,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:39:28,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:28
2025-03-13 14:39:28,832 [INFO]: 640.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:28,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:39:28,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:28
2025-03-13 14:39:28,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:28,832 [INFO]: 	Creating the index 03/13/2025, 14:39:28
2025-03-13 14:39:28,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:28
2025-03-13 14:39:28,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:39:28,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:28
2025-03-13 14:39:28,833 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:39:28,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.10it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.54it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.62it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.58it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.74it/s] 85%|████████▍ | 11/13 [00:01<00:00, 12.37it/s]100%|██████████| 13/13 [00:03<00:00,  2.11it/s]100%|██████████| 13/13 [00:03<00:00,  3.69it/s]
2025-03-13 14:39:32,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:32
2025-03-13 14:40:10,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4941 secs
2025-03-13 14:40:10,859 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 14:40:10,859 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 14:40:29,564 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7050 secs
2025-03-13 14:40:29,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7330 secs
2025-03-13 14:40:29,567 [INFO]: {
2025-03-13 14:40:29,567 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:29,567 [INFO]: 	index_param: efSearch=191
2025-03-13 14:40:29,567 [INFO]: 	index_path: knn.index
2025-03-13 14:40:29,567 [INFO]: 	size in bytes: 610102510
2025-03-13 14:40:29,567 [INFO]: 	avg_search_speed_ms: 9.901400501517081
2025-03-13 14:40:29,567 [INFO]: 	99p_search_speed_ms: 17.724908050149676
2025-03-13 14:40:29,567 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:29,567 [INFO]: 	nb vectors: 3101
2025-03-13 14:40:29,567 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:29,567 [INFO]: 	compression ratio: 0.9993097848425505
2025-03-13 14:40:29,567 [INFO]: }
2025-03-13 14:40:29,567 [INFO]: 	>>> Finished "Creating the index" in 60.7347 secs
2025-03-13 14:40:29,567 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7600 secs
2025-03-13 14:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 54294 [episode count 4/20]
[retrieval_preprocessing] for episode 39963 [episode count 5/20], we have num_retrieval=np.int64(3086) num_query=np.int64(168)
2025-03-13 14:40:31,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:32,322 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:32
2025-03-13 14:40:32,322 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2021.35it/s]
2025-03-13 14:40:32,348 [INFO]: There are 3086 embeddings of dim 49152
2025-03-13 14:40:32,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 14:40:32,348 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:32,348 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:40:32,348 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:32,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:32,348 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,348 [INFO]: 636.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:32,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:40:32,349 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:32
2025-03-13 14:40:32,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:32,349 [INFO]: 	Creating the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,349 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:32
2025-03-13 14:40:32,349 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:40:32,350 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,350 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:40:32,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.11it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.46it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.18it/s] 31%|███       | 4/13 [00:00<00:01,  7.64it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.84it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.00it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.08it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.16it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.28it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.27it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.19it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.37it/s]100%|██████████| 13/13 [00:03<00:00,  1.25it/s]100%|██████████| 13/13 [00:03<00:00,  3.35it/s]
2025-03-13 14:40:36,235 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:36
2025-03-13 14:41:10,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2687 secs
2025-03-13 14:41:10,504 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 14:41:10,505 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  2.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.40it/s]
2025-03-13 14:41:45,127 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6222 secs
2025-03-13 14:41:45,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.7804 secs
2025-03-13 14:41:45,130 [INFO]: {
2025-03-13 14:41:45,130 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:45,130 [INFO]: 	index_param: efSearch=256
2025-03-13 14:41:45,130 [INFO]: 	index_path: knn.index
2025-03-13 14:41:45,130 [INFO]: 	size in bytes: 607151350
2025-03-13 14:41:45,130 [INFO]: 	avg_search_speed_ms: 11.361902264285494
2025-03-13 14:41:45,130 [INFO]: 	99p_search_speed_ms: 20.928891629446298
2025-03-13 14:41:45,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:45,130 [INFO]: 	nb vectors: 3086
2025-03-13 14:41:45,130 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:45,130 [INFO]: 	compression ratio: 0.9993097898901155
2025-03-13 14:41:45,130 [INFO]: }
2025-03-13 14:41:45,130 [INFO]: 	>>> Finished "Creating the index" in 72.7817 secs
2025-03-13 14:41:45,130 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8082 secs
2025-03-13 14:41:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 39963 [episode count 5/20]
[retrieval_preprocessing] for episode 36893 [episode count 6/20], we have num_retrieval=np.int64(3010) num_query=np.int64(244)
2025-03-13 14:41:47,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:48,245 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:48
2025-03-13 14:41:48,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-13 14:41:48,272 [INFO]: There are 3010 embeddings of dim 49152
2025-03-13 14:41:48,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 14:41:48,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:48,273 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:41:48,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:48,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:48,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,273 [INFO]: 621.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:48,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:41:48,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:48
2025-03-13 14:41:48,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:48,273 [INFO]: 	Creating the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:48
2025-03-13 14:41:48,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 14:41:48,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:48
2025-03-13 14:41:48,275 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:41:48,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.83it/s] 33%|███▎      | 4/12 [00:00<00:00, 16.11it/s] 58%|█████▊    | 7/12 [00:00<00:00, 20.19it/s] 83%|████████▎ | 10/12 [00:00<00:00, 20.54it/s]100%|██████████| 12/12 [00:03<00:00,  3.62it/s]
2025-03-13 14:41:51,607 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:51
2025-03-13 14:42:31,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7576 secs
2025-03-13 14:42:31,365 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 14:42:31,366 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 14:42:49,161 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7953 secs
2025-03-13 14:42:49,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8901 secs
2025-03-13 14:42:49,165 [INFO]: {
2025-03-13 14:42:49,165 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:49,165 [INFO]: 	index_param: efSearch=205
2025-03-13 14:42:49,165 [INFO]: 	index_path: knn.index
2025-03-13 14:42:49,165 [INFO]: 	size in bytes: 592198810
2025-03-13 14:42:49,165 [INFO]: 	avg_search_speed_ms: 9.833735574564312
2025-03-13 14:42:49,166 [INFO]: 	99p_search_speed_ms: 14.54466996714473
2025-03-13 14:42:49,166 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:49,166 [INFO]: 	nb vectors: 3010
2025-03-13 14:42:49,166 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:49,166 [INFO]: 	compression ratio: 0.9993098094877968
2025-03-13 14:42:49,166 [INFO]: }
2025-03-13 14:42:49,166 [INFO]: 	>>> Finished "Creating the index" in 60.8925 secs
2025-03-13 14:42:49,166 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9209 secs
2025-03-13 14:42:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 36893 [episode count 6/20]
[retrieval_preprocessing] for episode 76849 [episode count 7/20], we have num_retrieval=np.int64(3143) num_query=np.int64(111)
2025-03-13 14:42:53,609 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:54,311 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:54
2025-03-13 14:42:54,311 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 940.85it/s]
2025-03-13 14:42:54,336 [INFO]: There are 3143 embeddings of dim 49152
2025-03-13 14:42:54,337 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 14:42:54,337 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,337 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:54,337 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:42:54,337 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:54,337 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:54,337 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,337 [INFO]: 648.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:54,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:42:54,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:54
2025-03-13 14:42:54,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:54,337 [INFO]: 	Creating the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,337 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:54
2025-03-13 14:42:54,339 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:42:54,339 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,339 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:42:54,339 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.00it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.51it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.96it/s] 31%|███       | 4/13 [00:00<00:01,  8.24it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.35it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.58it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.46it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.42it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.41it/s]100%|██████████| 13/13 [00:03<00:00,  1.34it/s]100%|██████████| 13/13 [00:03<00:00,  3.42it/s]
2025-03-13 14:42:58,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:58
2025-03-13 14:43:29,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5394 secs
2025-03-13 14:43:29,683 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 14:43:29,684 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 14:43:45,273 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5890 secs
2025-03-13 14:43:45,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9362 secs
2025-03-13 14:43:45,275 [INFO]: {
2025-03-13 14:43:45,275 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:45,275 [INFO]: 	index_param: efSearch=152
2025-03-13 14:43:45,275 [INFO]: 	index_path: knn.index
2025-03-13 14:43:45,275 [INFO]: 	size in bytes: 618365830
2025-03-13 14:43:45,275 [INFO]: 	avg_search_speed_ms: 7.5134167963377205
2025-03-13 14:43:45,275 [INFO]: 	99p_search_speed_ms: 13.084749714471403
2025-03-13 14:43:45,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:45,275 [INFO]: 	nb vectors: 3143
2025-03-13 14:43:45,275 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:45,275 [INFO]: 	compression ratio: 0.9993096546101197
2025-03-13 14:43:45,275 [INFO]: }
2025-03-13 14:43:45,275 [INFO]: 	>>> Finished "Creating the index" in 50.9380 secs
2025-03-13 14:43:45,275 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9641 secs
2025-03-13 14:43:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 76849 [episode count 7/20]
[retrieval_preprocessing] for episode 30259 [episode count 8/20], we have num_retrieval=np.int64(3082) num_query=np.int64(172)
2025-03-13 14:43:47,168 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:47,641 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:47
2025-03-13 14:43:47,641 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2304.56it/s]
2025-03-13 14:43:47,662 [INFO]: There are 3082 embeddings of dim 49152
2025-03-13 14:43:47,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0208 secs
2025-03-13 14:43:47,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:47
2025-03-13 14:43:47,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:47,662 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:43:47,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:47,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:47,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:47
2025-03-13 14:43:47,662 [INFO]: 636.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:47,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:43:47,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:47
2025-03-13 14:43:47,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:47,662 [INFO]: 	Creating the index 03/13/2025, 14:43:47
2025-03-13 14:43:47,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:47
2025-03-13 14:43:47,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:43:47,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:47
2025-03-13 14:43:47,663 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:43:47,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.39it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.34it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.35it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.45it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.75it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.93it/s]100%|██████████| 13/13 [00:03<00:00,  2.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.94it/s]
2025-03-13 14:43:50,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:50
2025-03-13 14:44:23,938 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9704 secs
2025-03-13 14:44:23,938 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 14:44:23,938 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 50%|█████     | 2/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 14:44:46,567 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6281 secs
2025-03-13 14:44:46,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9064 secs
2025-03-13 14:44:46,570 [INFO]: {
2025-03-13 14:44:46,570 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:46,570 [INFO]: 	index_param: efSearch=227
2025-03-13 14:44:46,570 [INFO]: 	index_path: knn.index
2025-03-13 14:44:46,570 [INFO]: 	size in bytes: 606364330
2025-03-13 14:44:46,570 [INFO]: 	avg_search_speed_ms: 10.457136863102225
2025-03-13 14:44:46,570 [INFO]: 	99p_search_speed_ms: 20.48059585504235
2025-03-13 14:44:46,570 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:46,570 [INFO]: 	nb vectors: 3082
2025-03-13 14:44:46,570 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:46,570 [INFO]: 	compression ratio: 0.9993098637579819
2025-03-13 14:44:46,570 [INFO]: }
2025-03-13 14:44:46,570 [INFO]: 	>>> Finished "Creating the index" in 58.9078 secs
2025-03-13 14:44:46,570 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9291 secs
2025-03-13 14:44:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 30259 [episode count 8/20]
[retrieval_preprocessing] for episode 42035 [episode count 9/20], we have num_retrieval=np.int64(3116) num_query=np.int64(138)
2025-03-13 14:44:49,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:50,275 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:50
2025-03-13 14:44:50,275 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.26it/s]
2025-03-13 14:44:50,301 [INFO]: There are 3116 embeddings of dim 49152
2025-03-13 14:44:50,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 14:44:50,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:50,302 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:44:50,302 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:50,302 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:44:50,302 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,302 [INFO]: 643.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:50,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:44:50,302 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:50
2025-03-13 14:44:50,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:50,302 [INFO]: 	Creating the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,302 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:50
2025-03-13 14:44:50,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 14:44:50,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,304 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:44:50,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.38it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.51it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.38it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.98it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.24it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.61it/s]100%|██████████| 13/13 [00:03<00:00,  1.98it/s]100%|██████████| 13/13 [00:03<00:00,  3.51it/s]
2025-03-13 14:44:54,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:54
2025-03-13 14:45:29,250 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2414 secs
2025-03-13 14:45:29,250 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 14:45:29,250 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.39it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.83it/s]
2025-03-13 14:45:50,244 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9942 secs
2025-03-13 14:45:50,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9425 secs
2025-03-13 14:45:50,247 [INFO]: {
2025-03-13 14:45:50,247 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:50,247 [INFO]: 	index_param: efSearch=284
2025-03-13 14:45:50,247 [INFO]: 	index_path: knn.index
2025-03-13 14:45:50,247 [INFO]: 	size in bytes: 613053670
2025-03-13 14:45:50,247 [INFO]: 	avg_search_speed_ms: 11.59821267467454
2025-03-13 14:45:50,247 [INFO]: 	99p_search_speed_ms: 21.804134105332192
2025-03-13 14:45:50,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:50,247 [INFO]: 	nb vectors: 3116
2025-03-13 14:45:50,247 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:50,247 [INFO]: 	compression ratio: 0.999309779843582
2025-03-13 14:45:50,247 [INFO]: }
2025-03-13 14:45:50,247 [INFO]: 	>>> Finished "Creating the index" in 59.9450 secs
2025-03-13 14:45:50,247 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9723 secs
2025-03-13 14:45:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 42035 [episode count 9/20]
[retrieval_preprocessing] for episode 38454 [episode count 10/20], we have num_retrieval=np.int64(3121) num_query=np.int64(133)
2025-03-13 14:45:53,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:54,572 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:54
2025-03-13 14:45:54,572 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1620.67it/s]
2025-03-13 14:45:54,598 [INFO]: There are 3121 embeddings of dim 49152
2025-03-13 14:45:54,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 14:45:54,599 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:54
2025-03-13 14:45:54,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:54,599 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:45:54,599 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:54,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:45:54,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:54
2025-03-13 14:45:54,600 [INFO]: 644.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:54,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:45:54,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:54
2025-03-13 14:45:54,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:54,601 [INFO]: 	Creating the index 03/13/2025, 14:45:54
2025-03-13 14:45:54,601 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:54
2025-03-13 14:45:54,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 14:45:54,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:54
2025-03-13 14:45:54,604 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:45:54,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.55it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.51it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.77it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.46it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.25it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.06it/s]100%|██████████| 13/13 [00:03<00:00,  2.15it/s]100%|██████████| 13/13 [00:03<00:00,  3.80it/s]
2025-03-13 14:45:58,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:58
2025-03-13 14:46:27,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5469 secs
2025-03-13 14:46:27,576 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 14:46:27,576 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 14:46:44,615 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0387 secs
2025-03-13 14:46:44,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0529 secs
2025-03-13 14:46:44,657 [INFO]: {
2025-03-13 14:46:44,658 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:44,658 [INFO]: 	index_param: efSearch=226
2025-03-13 14:46:44,658 [INFO]: 	index_path: knn.index
2025-03-13 14:46:44,658 [INFO]: 	size in bytes: 614037370
2025-03-13 14:46:44,658 [INFO]: 	avg_search_speed_ms: 10.384809248524633
2025-03-13 14:46:44,658 [INFO]: 	99p_search_speed_ms: 17.292398349381983
2025-03-13 14:46:44,658 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:44,658 [INFO]: 	nb vectors: 3121
2025-03-13 14:46:44,658 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:44,658 [INFO]: 	compression ratio: 0.9993098107367635
2025-03-13 14:46:44,658 [INFO]: }
2025-03-13 14:46:44,658 [INFO]: 	>>> Finished "Creating the index" in 50.0573 secs
2025-03-13 14:46:44,658 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0857 secs
2025-03-13 14:46:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 38454 [episode count 10/20]
[retrieval_preprocessing] for episode 70710 [episode count 11/20], we have num_retrieval=np.int64(3057) num_query=np.int64(197)
2025-03-13 14:46:47,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:48,329 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:48
2025-03-13 14:46:48,330 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.69it/s]
2025-03-13 14:46:48,353 [INFO]: There are 3057 embeddings of dim 49152
2025-03-13 14:46:48,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 14:46:48,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:48
2025-03-13 14:46:48,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:48,354 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:46:48,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:48,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:46:48,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:48
2025-03-13 14:46:48,354 [INFO]: 630.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:48,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:46:48,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:48
2025-03-13 14:46:48,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:48,354 [INFO]: 	Creating the index 03/13/2025, 14:46:48
2025-03-13 14:46:48,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:48
2025-03-13 14:46:48,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:46:48,355 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:48
2025-03-13 14:46:48,355 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:46:48,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.87it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.06it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.02it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.24it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.60it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.79it/s]100%|██████████| 13/13 [00:03<00:00,  1.93it/s]100%|██████████| 13/13 [00:03<00:00,  3.40it/s]
2025-03-13 14:46:52,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:52
2025-03-13 14:47:24,134 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9563 secs
2025-03-13 14:47:24,134 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 14:47:24,134 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 14:47:42,671 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5371 secs
2025-03-13 14:47:42,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3188 secs
2025-03-13 14:47:42,674 [INFO]: {
2025-03-13 14:47:42,674 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:42,674 [INFO]: 	index_param: efSearch=283
2025-03-13 14:47:42,674 [INFO]: 	index_path: knn.index
2025-03-13 14:47:42,674 [INFO]: 	size in bytes: 601445710
2025-03-13 14:47:42,674 [INFO]: 	avg_search_speed_ms: 13.167714870130448
2025-03-13 14:47:42,674 [INFO]: 	99p_search_speed_ms: 25.89153453242032
2025-03-13 14:47:42,674 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:42,674 [INFO]: 	nb vectors: 3057
2025-03-13 14:47:42,674 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:42,674 [INFO]: 	compression ratio: 0.9993099061260242
2025-03-13 14:47:42,674 [INFO]: }
2025-03-13 14:47:42,674 [INFO]: 	>>> Finished "Creating the index" in 54.3204 secs
2025-03-13 14:47:42,674 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3449 secs
2025-03-13 14:47:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 70710 [episode count 11/20]
[retrieval_preprocessing] for episode 69696 [episode count 12/20], we have num_retrieval=np.int64(3072) num_query=np.int64(182)
2025-03-13 14:47:46,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:47,601 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:47
2025-03-13 14:47:47,601 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.86it/s]
2025-03-13 14:47:47,630 [INFO]: There are 3072 embeddings of dim 49152
2025-03-13 14:47:47,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 14:47:47,631 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:47,631 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:47:47,631 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:47,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:47,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,631 [INFO]: 634.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:47,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:47:47,631 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:47
2025-03-13 14:47:47,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:47,632 [INFO]: 	Creating the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,632 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:47
2025-03-13 14:47:47,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:47:47,633 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:47
2025-03-13 14:47:47,633 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:47:47,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.62it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.98it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.17it/s] 31%|███       | 4/13 [00:00<00:01,  7.37it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.49it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.53it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.53it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.49it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.47it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.63it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.60it/s]100%|██████████| 13/13 [00:04<00:00,  1.19it/s]100%|██████████| 13/13 [00:04<00:00,  3.17it/s]
2025-03-13 14:47:51,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:51
2025-03-13 14:48:25,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4175 secs
2025-03-13 14:48:25,157 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 14:48:25,157 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 14:48:40,962 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8043 secs
2025-03-13 14:48:41,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6336 secs
2025-03-13 14:48:41,267 [INFO]: {
2025-03-13 14:48:41,267 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:41,267 [INFO]: 	index_param: efSearch=227
2025-03-13 14:48:41,267 [INFO]: 	index_path: knn.index
2025-03-13 14:48:41,267 [INFO]: 	size in bytes: 604396930
2025-03-13 14:48:41,267 [INFO]: 	avg_search_speed_ms: 10.4264724398531
2025-03-13 14:48:41,268 [INFO]: 	99p_search_speed_ms: 18.173095844686024
2025-03-13 14:48:41,268 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:41,268 [INFO]: 	nb vectors: 3072
2025-03-13 14:48:41,268 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:41,268 [INFO]: 	compression ratio: 0.9993098012592486
2025-03-13 14:48:41,268 [INFO]: }
2025-03-13 14:48:41,268 [INFO]: 	>>> Finished "Creating the index" in 53.6362 secs
2025-03-13 14:48:41,268 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6671 secs
2025-03-13 14:48:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 69696 [episode count 12/20]
[retrieval_preprocessing] for episode 10817 [episode count 13/20], we have num_retrieval=np.int64(3104) num_query=np.int64(150)
2025-03-13 14:48:45,457 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:46,773 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:46
2025-03-13 14:48:46,773 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 994.85it/s]
2025-03-13 14:48:46,800 [INFO]: There are 3104 embeddings of dim 49152
2025-03-13 14:48:46,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 14:48:46,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:46
2025-03-13 14:48:46,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:46,800 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:48:46,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:46,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:48:46,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:46
2025-03-13 14:48:46,801 [INFO]: 640.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:46,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:48:46,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:46
2025-03-13 14:48:46,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:46,801 [INFO]: 	Creating the index 03/13/2025, 14:48:46
2025-03-13 14:48:46,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:46
2025-03-13 14:48:46,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:48:46,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:46
2025-03-13 14:48:46,802 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:48:46,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.00it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.50it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.20it/s] 31%|███       | 4/13 [00:00<00:01,  7.57it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.71it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.92it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.98it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.99it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.15it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.20it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.34it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.32it/s]100%|██████████| 13/13 [00:03<00:00,  1.23it/s]100%|██████████| 13/13 [00:03<00:00,  3.30it/s]
2025-03-13 14:48:50,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:50
2025-03-13 14:49:25,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1479 secs
2025-03-13 14:49:25,894 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 14:49:25,894 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 14:49:52,678 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7834 secs
2025-03-13 14:49:53,250 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4477 secs
2025-03-13 14:49:53,250 [INFO]: {
2025-03-13 14:49:53,250 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:53,251 [INFO]: 	index_param: efSearch=193
2025-03-13 14:49:53,251 [INFO]: 	index_path: knn.index
2025-03-13 14:49:53,251 [INFO]: 	size in bytes: 610692790
2025-03-13 14:49:53,251 [INFO]: 	avg_search_speed_ms: 8.92467452271324
2025-03-13 14:49:53,251 [INFO]: 	99p_search_speed_ms: 20.20949362777173
2025-03-13 14:49:53,251 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:53,251 [INFO]: 	nb vectors: 3104
2025-03-13 14:49:53,251 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:53,251 [INFO]: 	compression ratio: 0.9993097052938843
2025-03-13 14:49:53,251 [INFO]: }
2025-03-13 14:49:53,251 [INFO]: 	>>> Finished "Creating the index" in 66.4502 secs
2025-03-13 14:49:53,251 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4779 secs
2025-03-13 14:49:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 10817 [episode count 13/20]
[retrieval_preprocessing] for episode 7746 [episode count 14/20], we have num_retrieval=np.int64(3079) num_query=np.int64(175)
2025-03-13 14:49:56,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:56,850 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:56
2025-03-13 14:49:56,850 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 14:49:56,878 [INFO]: There are 3079 embeddings of dim 49152
2025-03-13 14:49:56,878 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 14:49:56,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:56
2025-03-13 14:49:56,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:56,878 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:49:56,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:56,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:56,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:56
2025-03-13 14:49:56,878 [INFO]: 635.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:56,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:56,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:56
2025-03-13 14:49:56,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:56,879 [INFO]: 	Creating the index 03/13/2025, 14:49:56
2025-03-13 14:49:56,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:56
2025-03-13 14:49:56,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:49:56,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:56
2025-03-13 14:49:56,880 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:49:56,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.74it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.99it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.37it/s] 31%|███       | 4/13 [00:00<00:01,  7.44it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.46it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.43it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.45it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.68it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.62it/s] 92%|█████████▏| 12/13 [00:01<00:00, 10.34it/s]100%|██████████| 13/13 [00:04<00:00,  3.16it/s]
2025-03-13 14:50:01,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:01
2025-03-13 14:50:38,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4275 secs
2025-03-13 14:50:38,433 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 14:50:38,433 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s]
2025-03-13 14:50:56,577 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1434 secs
2025-03-13 14:50:56,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6993 secs
2025-03-13 14:50:56,580 [INFO]: {
2025-03-13 14:50:56,580 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:56,580 [INFO]: 	index_param: efSearch=220
2025-03-13 14:50:56,580 [INFO]: 	index_path: knn.index
2025-03-13 14:50:56,580 [INFO]: 	size in bytes: 605774110
2025-03-13 14:50:56,580 [INFO]: 	avg_search_speed_ms: 11.474812343778567
2025-03-13 14:50:56,580 [INFO]: 	99p_search_speed_ms: 22.115111986640823
2025-03-13 14:50:56,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:56,580 [INFO]: 	nb vectors: 3079
2025-03-13 14:50:56,580 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:56,580 [INFO]: 	compression ratio: 0.9993098450509877
2025-03-13 14:50:56,580 [INFO]: }
2025-03-13 14:50:56,580 [INFO]: 	>>> Finished "Creating the index" in 59.7011 secs
2025-03-13 14:50:56,580 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7294 secs
2025-03-13 14:50:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 7746 [episode count 14/20]
[retrieval_preprocessing] for episode 4170 [episode count 15/20], we have num_retrieval=np.int64(3095) num_query=np.int64(159)
2025-03-13 14:50:59,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:00,330 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:00
2025-03-13 14:51:00,330 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.01it/s]
2025-03-13 14:51:00,355 [INFO]: There are 3095 embeddings of dim 49152
2025-03-13 14:51:00,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 14:51:00,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:00
2025-03-13 14:51:00,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:00,356 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:51:00,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:00,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:00,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:00
2025-03-13 14:51:00,356 [INFO]: 638.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:00,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:51:00,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:00
2025-03-13 14:51:00,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:00,356 [INFO]: 	Creating the index 03/13/2025, 14:51:00
2025-03-13 14:51:00,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:00
2025-03-13 14:51:00,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:51:00,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:00
2025-03-13 14:51:00,358 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:51:00,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.97it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.86it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.68it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.05it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.47it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.01it/s]100%|██████████| 13/13 [00:03<00:00,  2.28it/s]100%|██████████| 13/13 [00:03<00:00,  3.89it/s]
2025-03-13 14:51:03,704 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:03
2025-03-13 14:51:40,807 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1033 secs
2025-03-13 14:51:40,808 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 14:51:40,808 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 14:51:59,889 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0806 secs
2025-03-13 14:52:00,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9944 secs
2025-03-13 14:52:00,353 [INFO]: {
2025-03-13 14:52:00,353 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:00,353 [INFO]: 	index_param: efSearch=203
2025-03-13 14:52:00,353 [INFO]: 	index_path: knn.index
2025-03-13 14:52:00,353 [INFO]: 	size in bytes: 608922070
2025-03-13 14:52:00,353 [INFO]: 	avg_search_speed_ms: 9.813477630910699
2025-03-13 14:52:00,353 [INFO]: 	99p_search_speed_ms: 16.661108499392856
2025-03-13 14:52:00,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:00,353 [INFO]: 	nb vectors: 3095
2025-03-13 14:52:00,353 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:00,353 [INFO]: 	compression ratio: 0.9993097474689988
2025-03-13 14:52:00,353 [INFO]: }
2025-03-13 14:52:00,353 [INFO]: 	>>> Finished "Creating the index" in 59.9969 secs
2025-03-13 14:52:00,353 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0229 secs
2025-03-13 14:52:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 4170 [episode count 15/20]
[retrieval_preprocessing] for episode 68173 [episode count 16/20], we have num_retrieval=np.int64(3071) num_query=np.int64(183)
2025-03-13 14:52:03,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:04,186 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:04
2025-03-13 14:52:04,186 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.04it/s]
2025-03-13 14:52:04,213 [INFO]: There are 3071 embeddings of dim 49152
2025-03-13 14:52:04,214 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 14:52:04,214 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:04
2025-03-13 14:52:04,214 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:04,214 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:52:04,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:04,215 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:52:04,215 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:04
2025-03-13 14:52:04,215 [INFO]: 633.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:04,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:52:04,216 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:04
2025-03-13 14:52:04,216 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:04,216 [INFO]: 	Creating the index 03/13/2025, 14:52:04
2025-03-13 14:52:04,216 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:04
2025-03-13 14:52:04,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:52:04,219 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:04
2025-03-13 14:52:04,219 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:52:04,219 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.45it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.86it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.05it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.99it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.01it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.18it/s]100%|██████████| 13/13 [00:03<00:00,  2.36it/s]100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
2025-03-13 14:52:07,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:07
2025-03-13 14:52:45,661 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2683 secs
2025-03-13 14:52:45,661 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 14:52:45,661 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 14:53:03,447 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7859 secs
2025-03-13 14:53:03,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2307 secs
2025-03-13 14:53:03,450 [INFO]: {
2025-03-13 14:53:03,450 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:03,450 [INFO]: 	index_param: efSearch=210
2025-03-13 14:53:03,450 [INFO]: 	index_path: knn.index
2025-03-13 14:53:03,450 [INFO]: 	size in bytes: 604200190
2025-03-13 14:53:03,450 [INFO]: 	avg_search_speed_ms: 10.01283051646515
2025-03-13 14:53:03,450 [INFO]: 	99p_search_speed_ms: 15.265849870629607
2025-03-13 14:53:03,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:03,450 [INFO]: 	nb vectors: 3071
2025-03-13 14:53:03,450 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:03,450 [INFO]: 	compression ratio: 0.9993097949869894
2025-03-13 14:53:03,450 [INFO]: }
2025-03-13 14:53:03,450 [INFO]: 	>>> Finished "Creating the index" in 59.2342 secs
2025-03-13 14:53:03,450 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2639 secs
2025-03-13 14:53:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 68173 [episode count 16/20]
[retrieval_preprocessing] for episode 63576 [episode count 17/20], we have num_retrieval=np.int64(3103) num_query=np.int64(151)
2025-03-13 14:53:07,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:07,693 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:07
2025-03-13 14:53:07,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.69it/s]
2025-03-13 14:53:07,724 [INFO]: There are 3103 embeddings of dim 49152
2025-03-13 14:53:07,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 14:53:07,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:07
2025-03-13 14:53:07,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:07,724 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:53:07,724 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:07,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:07,724 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:07
2025-03-13 14:53:07,725 [INFO]: 640.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:07,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:53:07,725 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:07
2025-03-13 14:53:07,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:07,725 [INFO]: 	Creating the index 03/13/2025, 14:53:07
2025-03-13 14:53:07,725 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:07
2025-03-13 14:53:07,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:53:07,726 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:07
2025-03-13 14:53:07,726 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:53:07,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.21it/s] 62%|██████▏   | 8/13 [00:00<00:00, 37.62it/s]100%|██████████| 13/13 [00:02<00:00,  3.86it/s]100%|██████████| 13/13 [00:02<00:00,  4.77it/s]
2025-03-13 14:53:10,458 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:10
2025-03-13 14:53:50,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0457 secs
2025-03-13 14:53:50,505 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 14:53:50,505 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.05it/s]
2025-03-13 14:54:05,943 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4379 secs
2025-03-13 14:54:05,946 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2196 secs
2025-03-13 14:54:05,946 [INFO]: {
2025-03-13 14:54:05,946 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:05,946 [INFO]: 	index_param: efSearch=175
2025-03-13 14:54:05,946 [INFO]: 	index_path: knn.index
2025-03-13 14:54:05,946 [INFO]: 	size in bytes: 610496050
2025-03-13 14:54:05,946 [INFO]: 	avg_search_speed_ms: 11.351382278992661
2025-03-13 14:54:05,946 [INFO]: 	99p_search_speed_ms: 20.001947833225135
2025-03-13 14:54:05,946 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:05,946 [INFO]: 	nb vectors: 3103
2025-03-13 14:54:05,946 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:05,946 [INFO]: 	compression ratio: 0.9993096990553829
2025-03-13 14:54:05,946 [INFO]: }
2025-03-13 14:54:05,946 [INFO]: 	>>> Finished "Creating the index" in 58.2212 secs
2025-03-13 14:54:05,946 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2526 secs
2025-03-13 14:54:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 63576 [episode count 17/20]
[retrieval_preprocessing] for episode 14425 [episode count 18/20], we have num_retrieval=np.int64(3130) num_query=np.int64(124)
2025-03-13 14:54:08,024 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:08,457 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:08
2025-03-13 14:54:08,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1382.43it/s]
2025-03-13 14:54:08,490 [INFO]: There are 3130 embeddings of dim 49152
2025-03-13 14:54:08,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 14:54:08,491 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:08
2025-03-13 14:54:08,491 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:08,491 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:54:08,491 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:08,491 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:54:08,491 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:08
2025-03-13 14:54:08,491 [INFO]: 646.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:08,491 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:54:08,491 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:08
2025-03-13 14:54:08,491 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:08,491 [INFO]: 	Creating the index 03/13/2025, 14:54:08
2025-03-13 14:54:08,491 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:08
2025-03-13 14:54:08,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:54:08,492 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:08
2025-03-13 14:54:08,493 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:54:08,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.42it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.69it/s] 85%|████████▍ | 11/13 [00:00<00:00, 37.50it/s]100%|██████████| 13/13 [00:02<00:00,  4.46it/s]
2025-03-13 14:54:11,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:11
2025-03-13 14:55:01,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.3885 secs
2025-03-13 14:55:01,798 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 14:55:01,798 [INFO]: 	Compute fast metrics 03/13/2025, 14:55:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:16,  5.56s/it] 50%|█████     | 2/4 [00:08<00:08,  4.20s/it] 75%|███████▌  | 3/4 [00:13<00:04,  4.64s/it] 75%|███████▌  | 3/4 [00:15<00:05,  5.18s/it]
2025-03-13 14:55:37,133 [INFO]: 	>>> Finished "Compute fast metrics" in 35.3351 secs
2025-03-13 14:55:37,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.6440 secs
2025-03-13 14:55:37,137 [INFO]: {
2025-03-13 14:55:37,137 [INFO]: 	index_key: HNSW15
2025-03-13 14:55:37,137 [INFO]: 	index_param: efSearch=168
2025-03-13 14:55:37,137 [INFO]: 	index_path: knn.index
2025-03-13 14:55:37,137 [INFO]: 	size in bytes: 615808210
2025-03-13 14:55:37,137 [INFO]: 	avg_search_speed_ms: 12.531578464942394
2025-03-13 14:55:37,137 [INFO]: 	99p_search_speed_ms: 18.0684978980571
2025-03-13 14:55:37,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:37,137 [INFO]: 	nb vectors: 3130
2025-03-13 14:55:37,137 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:37,137 [INFO]: 	compression ratio: 0.9993095739986968
2025-03-13 14:55:37,137 [INFO]: }
2025-03-13 14:55:37,137 [INFO]: 	>>> Finished "Creating the index" in 88.6456 secs
2025-03-13 14:55:37,137 [INFO]: >>> Finished "Launching the whole pipeline" in 88.6796 secs
2025-03-13 14:55:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 14425 [episode count 18/20]
[retrieval_preprocessing] for episode 40549 [episode count 19/20], we have num_retrieval=np.int64(3124) num_query=np.int64(130)
2025-03-13 14:55:39,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:40,198 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:40
2025-03-13 14:55:40,198 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1223.90it/s]
2025-03-13 14:55:40,232 [INFO]: There are 3124 embeddings of dim 49152
2025-03-13 14:55:40,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 14:55:40,232 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:40
2025-03-13 14:55:40,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:40,233 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:55:40,233 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:40,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:55:40,233 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:40
2025-03-13 14:55:40,233 [INFO]: 644.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:40,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:55:40,234 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:40
2025-03-13 14:55:40,234 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:40,234 [INFO]: 	Creating the index 03/13/2025, 14:55:40
2025-03-13 14:55:40,234 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:40
2025-03-13 14:55:40,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0036 secs
2025-03-13 14:55:40,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:40
2025-03-13 14:55:40,238 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:55:40,239 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.21it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.06it/s] 31%|███       | 4/13 [00:00<00:01,  8.97it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.95it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.06it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.40it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.69it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.64it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.18it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.64it/s]100%|██████████| 13/13 [00:05<00:00,  1.30s/it]100%|██████████| 13/13 [00:05<00:00,  2.39it/s]
2025-03-13 14:55:45,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:45
2025-03-13 14:56:36,564 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8817 secs
2025-03-13 14:56:36,564 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 14:56:36,565 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.53s/it] 75%|███████▌  | 3/4 [00:01<00:00,  1.84it/s]
2025-03-13 14:56:56,601 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0365 secs
2025-03-13 14:56:56,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3663 secs
2025-03-13 14:56:56,605 [INFO]: {
2025-03-13 14:56:56,605 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:56,605 [INFO]: 	index_param: efSearch=132
2025-03-13 14:56:56,605 [INFO]: 	index_path: knn.index
2025-03-13 14:56:56,605 [INFO]: 	size in bytes: 614627770
2025-03-13 14:56:56,605 [INFO]: 	avg_search_speed_ms: 8.375191651175495
2025-03-13 14:56:56,605 [INFO]: 	99p_search_speed_ms: 21.03774384828284
2025-03-13 14:56:56,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:56,605 [INFO]: 	nb vectors: 3124
2025-03-13 14:56:56,605 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:56,605 [INFO]: 	compression ratio: 0.9993095365671486
2025-03-13 14:56:56,605 [INFO]: }
2025-03-13 14:56:56,605 [INFO]: 	>>> Finished "Creating the index" in 76.3710 secs
2025-03-13 14:56:56,605 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4067 secs
2025-03-13 14:56:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 40549 [episode count 19/20]
2025-03-13 14:56:57: [retrieval_preprocessing] finished for 5059283044_put_screwdriver_in_drawer_and_close [chosen_id count 0/196]
2025-03-13 14:56:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_left_click_mouse [chosen_id count 1/196]
2025-03-13 14:56:59: [retrieval_preprocessing] we have num_total=2311 embedding_dim=49152
[retrieval_preprocessing] for episode 59392 [episode count 0/20], we have num_retrieval=np.int64(2188) num_query=np.int64(123)
2025-03-13 14:56:59,598 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:00,181 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:00
2025-03-13 14:57:00,181 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.35it/s]
2025-03-13 14:57:00,224 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 14:57:00,224 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0432 secs
2025-03-13 14:57:00,225 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:00
2025-03-13 14:57:00,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:00,225 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:57:00,225 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:00,226 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:57:00,226 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:00
2025-03-13 14:57:00,226 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:00,226 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:57:00,227 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:00
2025-03-13 14:57:00,227 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:57:00,227 [INFO]: 	Creating the index 03/13/2025, 14:57:00
2025-03-13 14:57:00,227 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:00
2025-03-13 14:57:00,230 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:57:00,230 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:00
2025-03-13 14:57:00,231 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:57:00,231 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.23it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.60it/s]100%|██████████| 9/9 [00:02<00:00,  2.97it/s]100%|██████████| 9/9 [00:02<00:00,  3.53it/s]
2025-03-13 14:57:02,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:02
2025-03-13 14:57:39,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0279 secs
2025-03-13 14:57:39,816 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 14:57:39,816 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 14:58:04,417 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6009 secs
2025-03-13 14:58:04,419 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1890 secs
2025-03-13 14:58:04,420 [INFO]: {
2025-03-13 14:58:04,420 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:04,420 [INFO]: 	index_param: efSearch=223
2025-03-13 14:58:04,420 [INFO]: 	index_path: knn.index
2025-03-13 14:58:04,420 [INFO]: 	size in bytes: 430475830
2025-03-13 14:58:04,420 [INFO]: 	avg_search_speed_ms: 12.748770690730707
2025-03-13 14:58:04,420 [INFO]: 	99p_search_speed_ms: 23.410822805017215
2025-03-13 14:58:04,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:04,420 [INFO]: 	nb vectors: 2188
2025-03-13 14:58:04,420 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:04,420 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 14:58:04,420 [INFO]: }
2025-03-13 14:58:04,420 [INFO]: 	>>> Finished "Creating the index" in 64.1933 secs
2025-03-13 14:58:04,420 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2395 secs
2025-03-13 14:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 59392 [episode count 0/20]
[retrieval_preprocessing] for episode 36875 [episode count 1/20], we have num_retrieval=np.int64(2203) num_query=np.int64(108)
2025-03-13 14:58:06,263 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:07,253 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:07
2025-03-13 14:58:07,254 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1869.12it/s]
2025-03-13 14:58:07,285 [INFO]: There are 2203 embeddings of dim 49152
2025-03-13 14:58:07,285 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 14:58:07,285 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:07
2025-03-13 14:58:07,285 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:07,285 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:58:07,285 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:07,285 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:58:07,285 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:07
2025-03-13 14:58:07,285 [INFO]: 454.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:07,286 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:58:07,286 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:07
2025-03-13 14:58:07,286 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:07,286 [INFO]: 	Creating the index 03/13/2025, 14:58:07
2025-03-13 14:58:07,286 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:07
2025-03-13 14:58:07,287 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:58:07,287 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:07
2025-03-13 14:58:07,288 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:58:07,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.78it/s] 56%|█████▌    | 5/9 [00:00<00:00, 17.07it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.92it/s]100%|██████████| 9/9 [00:02<00:00,  2.22it/s]100%|██████████| 9/9 [00:02<00:00,  3.14it/s]
2025-03-13 14:58:10,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:10
2025-03-13 14:58:42,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0735 secs
2025-03-13 14:58:42,232 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 14:58:42,232 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.20it/s] 50%|█████     | 2/4 [00:00<00:00,  2.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.68it/s]
2025-03-13 14:59:00,075 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8421 secs
2025-03-13 14:59:00,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7891 secs
2025-03-13 14:59:00,077 [INFO]: {
2025-03-13 14:59:00,077 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:00,077 [INFO]: 	index_param: efSearch=222
2025-03-13 14:59:00,077 [INFO]: 	index_path: knn.index
2025-03-13 14:59:00,077 [INFO]: 	size in bytes: 433426930
2025-03-13 14:59:00,077 [INFO]: 	avg_search_speed_ms: 11.308516192405877
2025-03-13 14:59:00,077 [INFO]: 	99p_search_speed_ms: 17.033960574772205
2025-03-13 14:59:00,077 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:00,077 [INFO]: 	nb vectors: 2203
2025-03-13 14:59:00,077 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:00,077 [INFO]: 	compression ratio: 0.9993089815623594
2025-03-13 14:59:00,077 [INFO]: }
2025-03-13 14:59:00,077 [INFO]: 	>>> Finished "Creating the index" in 52.7911 secs
2025-03-13 14:59:00,077 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8234 secs
2025-03-13 14:59:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 36875 [episode count 1/20]
[retrieval_preprocessing] for episode 86072 [episode count 2/20], we have num_retrieval=np.int64(2167) num_query=np.int64(144)
2025-03-13 14:59:01,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:02,539 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:02
2025-03-13 14:59:02,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1843.65it/s]
2025-03-13 14:59:02,562 [INFO]: There are 2167 embeddings of dim 49152
2025-03-13 14:59:02,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 14:59:02,562 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,562 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:02,562 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:59:02,562 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:02,563 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:59:02,563 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,563 [INFO]: 447.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:02,563 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:59:02,563 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:02
2025-03-13 14:59:02,563 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:02,563 [INFO]: 	Creating the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,563 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:02
2025-03-13 14:59:02,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 14:59:02,565 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:02
2025-03-13 14:59:02,565 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:59:02,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.98it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.65it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.88it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.38it/s]100%|██████████| 9/9 [00:02<00:00,  2.58it/s]100%|██████████| 9/9 [00:02<00:00,  3.71it/s]
2025-03-13 14:59:04,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:04
2025-03-13 14:59:30,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6303 secs
2025-03-13 14:59:30,628 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 14:59:30,628 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 14:59:49,352 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7236 secs
2025-03-13 14:59:49,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7896 secs
2025-03-13 14:59:49,355 [INFO]: {
2025-03-13 14:59:49,355 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:49,355 [INFO]: 	index_param: efSearch=158
2025-03-13 14:59:49,355 [INFO]: 	index_path: knn.index
2025-03-13 14:59:49,355 [INFO]: 	size in bytes: 426344110
2025-03-13 14:59:49,355 [INFO]: 	avg_search_speed_ms: 8.145832017720874
2025-03-13 14:59:49,355 [INFO]: 	99p_search_speed_ms: 12.50869185430929
2025-03-13 14:59:49,355 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:49,355 [INFO]: 	nb vectors: 2167
2025-03-13 14:59:49,355 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:49,355 [INFO]: 	compression ratio: 0.9993090698497042
2025-03-13 14:59:49,355 [INFO]: }
2025-03-13 14:59:49,355 [INFO]: 	>>> Finished "Creating the index" in 46.7921 secs
2025-03-13 14:59:49,355 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8160 secs
2025-03-13 14:59:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 86072 [episode count 2/20]
[retrieval_preprocessing] for episode 14393 [episode count 3/20], we have num_retrieval=np.int64(2186) num_query=np.int64(125)
2025-03-13 14:59:51,824 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:52,247 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:52
2025-03-13 14:59:52,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 986.20it/s]
2025-03-13 14:59:52,275 [INFO]: There are 2186 embeddings of dim 49152
2025-03-13 14:59:52,276 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 14:59:52,276 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:52
2025-03-13 14:59:52,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:52,276 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 14:59:52,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:52,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:52,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:52
2025-03-13 14:59:52,276 [INFO]: 451.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:52,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:59:52,276 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:52
2025-03-13 14:59:52,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:52,276 [INFO]: 	Creating the index 03/13/2025, 14:59:52
2025-03-13 14:59:52,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:52
2025-03-13 14:59:52,278 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:59:52,278 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:52
2025-03-13 14:59:52,278 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:59:52,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.88it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.65it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.01it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.21it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.27it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.68it/s]100%|██████████| 9/9 [00:03<00:00,  1.51it/s]100%|██████████| 9/9 [00:03<00:00,  2.80it/s]
2025-03-13 14:59:55,493 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:55
2025-03-13 15:00:23,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0317 secs
2025-03-13 15:00:23,525 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 15:00:23,525 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 15:00:43,321 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7959 secs
2025-03-13 15:00:43,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0457 secs
2025-03-13 15:00:43,324 [INFO]: {
2025-03-13 15:00:43,324 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:43,324 [INFO]: 	index_param: efSearch=266
2025-03-13 15:00:43,324 [INFO]: 	index_path: knn.index
2025-03-13 15:00:43,324 [INFO]: 	size in bytes: 430082230
2025-03-13 15:00:43,324 [INFO]: 	avg_search_speed_ms: 11.845174364158575
2025-03-13 15:00:43,324 [INFO]: 	99p_search_speed_ms: 22.22277870168905
2025-03-13 15:00:43,324 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:43,324 [INFO]: 	nb vectors: 2186
2025-03-13 15:00:43,324 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:43,324 [INFO]: 	compression ratio: 0.9993091042147917
2025-03-13 15:00:43,324 [INFO]: }
2025-03-13 15:00:43,324 [INFO]: 	>>> Finished "Creating the index" in 51.0475 secs
2025-03-13 15:00:43,324 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0762 secs
2025-03-13 15:00:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 14393 [episode count 3/20]
[retrieval_preprocessing] for episode 6228 [episode count 4/20], we have num_retrieval=np.int64(2218) num_query=np.int64(93)
2025-03-13 15:00:45,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:45,918 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:45
2025-03-13 15:00:45,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1073.81it/s]
2025-03-13 15:00:45,955 [INFO]: There are 2218 embeddings of dim 49152
2025-03-13 15:00:45,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 15:00:45,955 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:45
2025-03-13 15:00:45,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:45,956 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:00:45,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:45,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:00:45,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:45
2025-03-13 15:00:45,956 [INFO]: 457.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:45,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:00:45,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:45
2025-03-13 15:00:45,957 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:45,957 [INFO]: 	Creating the index 03/13/2025, 15:00:45
2025-03-13 15:00:45,957 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:45
2025-03-13 15:00:45,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:00:45,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:45
2025-03-13 15:00:45,959 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:00:45,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.41it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.89it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.02it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.89it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.80it/s]100%|██████████| 9/9 [00:02<00:00,  2.01it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]
2025-03-13 15:00:48,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:48
2025-03-13 15:01:21,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0845 secs
2025-03-13 15:01:21,574 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 15:01:21,575 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 15:01:46,610 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0351 secs
2025-03-13 15:01:46,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6526 secs
2025-03-13 15:01:46,612 [INFO]: {
2025-03-13 15:01:46,612 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:46,612 [INFO]: 	index_param: efSearch=231
2025-03-13 15:01:46,612 [INFO]: 	index_path: knn.index
2025-03-13 15:01:46,612 [INFO]: 	size in bytes: 436378030
2025-03-13 15:01:46,612 [INFO]: 	avg_search_speed_ms: 10.179646502632094
2025-03-13 15:01:46,612 [INFO]: 	99p_search_speed_ms: 23.87752995360641
2025-03-13 15:01:46,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:46,612 [INFO]: 	nb vectors: 2218
2025-03-13 15:01:46,612 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:46,612 [INFO]: 	compression ratio: 0.9993091173723847
2025-03-13 15:01:46,612 [INFO]: }
2025-03-13 15:01:46,612 [INFO]: 	>>> Finished "Creating the index" in 60.6553 secs
2025-03-13 15:01:46,612 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6943 secs
2025-03-13 15:01:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 6228 [episode count 4/20]
[retrieval_preprocessing] for episode 63689 [episode count 5/20], we have num_retrieval=np.int64(2211) num_query=np.int64(100)
2025-03-13 15:01:48,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:48,418 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:48
2025-03-13 15:01:48,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.86it/s]
2025-03-13 15:01:48,444 [INFO]: There are 2211 embeddings of dim 49152
2025-03-13 15:01:48,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 15:01:48,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:48
2025-03-13 15:01:48,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:48,444 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:01:48,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:48,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:01:48,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:48
2025-03-13 15:01:48,444 [INFO]: 456.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:48,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:01:48,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:48
2025-03-13 15:01:48,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:48,444 [INFO]: 	Creating the index 03/13/2025, 15:01:48
2025-03-13 15:01:48,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:48
2025-03-13 15:01:48,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:01:48,445 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:48
2025-03-13 15:01:48,445 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:01:48,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.09it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.24it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.42it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.86it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.65it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.48it/s]100%|██████████| 9/9 [00:02<00:00,  1.96it/s]100%|██████████| 9/9 [00:02<00:00,  3.59it/s]
2025-03-13 15:01:50,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:50
2025-03-13 15:02:15,767 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8098 secs
2025-03-13 15:02:15,767 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 15:02:15,767 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 15:02:39,461 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6935 secs
2025-03-13 15:02:39,464 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0184 secs
2025-03-13 15:02:39,464 [INFO]: {
2025-03-13 15:02:39,464 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:39,464 [INFO]: 	index_param: efSearch=292
2025-03-13 15:02:39,464 [INFO]: 	index_path: knn.index
2025-03-13 15:02:39,464 [INFO]: 	size in bytes: 435000850
2025-03-13 15:02:39,464 [INFO]: 	avg_search_speed_ms: 13.191697896042923
2025-03-13 15:02:39,464 [INFO]: 	99p_search_speed_ms: 22.144420153927054
2025-03-13 15:02:39,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:39,464 [INFO]: 	nb vectors: 2211
2025-03-13 15:02:39,464 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:39,464 [INFO]: 	compression ratio: 0.9993090542236871
2025-03-13 15:02:39,464 [INFO]: }
2025-03-13 15:02:39,464 [INFO]: 	>>> Finished "Creating the index" in 51.0199 secs
2025-03-13 15:02:39,464 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0459 secs
2025-03-13 15:02:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 63689 [episode count 5/20]
[retrieval_preprocessing] for episode 31081 [episode count 6/20], we have num_retrieval=np.int64(2224) num_query=np.int64(87)
2025-03-13 15:02:41,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:42,317 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:42
2025-03-13 15:02:42,317 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 990.16it/s]
2025-03-13 15:02:42,344 [INFO]: There are 2224 embeddings of dim 49152
2025-03-13 15:02:42,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:02:42,344 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:42,344 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:02:42,344 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:42,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:42,344 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,344 [INFO]: 459.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:42,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:02:42,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:42
2025-03-13 15:02:42,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:42,345 [INFO]: 	Creating the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:42
2025-03-13 15:02:42,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:02:42,346 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:42
2025-03-13 15:02:42,346 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:02:42,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.63it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.88it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.81it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.10it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.32it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.74it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.25it/s]
2025-03-13 15:02:45,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:45
2025-03-13 15:03:10,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8497 secs
2025-03-13 15:03:10,970 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 15:03:10,970 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 15:03:31,637 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6673 secs
2025-03-13 15:03:31,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2934 secs
2025-03-13 15:03:31,640 [INFO]: {
2025-03-13 15:03:31,640 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:31,640 [INFO]: 	index_param: efSearch=234
2025-03-13 15:03:31,640 [INFO]: 	index_path: knn.index
2025-03-13 15:03:31,640 [INFO]: 	size in bytes: 437558470
2025-03-13 15:03:31,640 [INFO]: 	avg_search_speed_ms: 9.996851469855756
2025-03-13 15:03:31,640 [INFO]: 	99p_search_speed_ms: 14.242747430689631
2025-03-13 15:03:31,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:31,640 [INFO]: 	nb vectors: 2224
2025-03-13 15:03:31,640 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:31,640 [INFO]: 	compression ratio: 0.9993091711834535
2025-03-13 15:03:31,640 [INFO]: }
2025-03-13 15:03:31,640 [INFO]: 	>>> Finished "Creating the index" in 49.2953 secs
2025-03-13 15:03:31,640 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3228 secs
2025-03-13 15:03:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 31081 [episode count 6/20]
[retrieval_preprocessing] for episode 37322 [episode count 7/20], we have num_retrieval=np.int64(2181) num_query=np.int64(130)
2025-03-13 15:03:33,660 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:34,022 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:34
2025-03-13 15:03:34,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.11it/s]
2025-03-13 15:03:34,049 [INFO]: There are 2181 embeddings of dim 49152
2025-03-13 15:03:34,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:03:34,050 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:34
2025-03-13 15:03:34,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:34,050 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:03:34,050 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:34,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:03:34,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:34
2025-03-13 15:03:34,050 [INFO]: 450.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:34,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:03:34,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:34
2025-03-13 15:03:34,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:34,051 [INFO]: 	Creating the index 03/13/2025, 15:03:34
2025-03-13 15:03:34,051 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:34
2025-03-13 15:03:34,053 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:03:34,053 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:34
2025-03-13 15:03:34,054 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:03:34,054 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.11it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.72it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.01it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.30it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.21it/s]100%|██████████| 9/9 [00:03<00:00,  2.98it/s]
2025-03-13 15:03:37,080 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:37
2025-03-13 15:04:03,699 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6187 secs
2025-03-13 15:04:03,699 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 15:04:03,699 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 50%|█████     | 2/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s]
2025-03-13 15:04:20,761 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0616 secs
2025-03-13 15:04:20,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7093 secs
2025-03-13 15:04:20,763 [INFO]: {
2025-03-13 15:04:20,763 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:20,763 [INFO]: 	index_param: efSearch=214
2025-03-13 15:04:20,763 [INFO]: 	index_path: knn.index
2025-03-13 15:04:20,763 [INFO]: 	size in bytes: 429098530
2025-03-13 15:04:20,763 [INFO]: 	avg_search_speed_ms: 9.87075975207062
2025-03-13 15:04:20,763 [INFO]: 	99p_search_speed_ms: 12.755575943738222
2025-03-13 15:04:20,763 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:20,763 [INFO]: 	nb vectors: 2181
2025-03-13 15:04:20,763 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:20,763 [INFO]: 	compression ratio: 0.9993090584579724
2025-03-13 15:04:20,763 [INFO]: }
2025-03-13 15:04:20,763 [INFO]: 	>>> Finished "Creating the index" in 46.7120 secs
2025-03-13 15:04:20,763 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7414 secs
2025-03-13 15:04:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 37322 [episode count 7/20]
[retrieval_preprocessing] for episode 12809 [episode count 8/20], we have num_retrieval=np.int64(2201) num_query=np.int64(110)
2025-03-13 15:04:22,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:22,620 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:22
2025-03-13 15:04:22,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.78it/s]
2025-03-13 15:04:22,645 [INFO]: There are 2201 embeddings of dim 49152
2025-03-13 15:04:22,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 15:04:22,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:22,645 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:04:22,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:22,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:04:22,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,646 [INFO]: 454.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:22,646 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:04:22,646 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:22
2025-03-13 15:04:22,646 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:22,646 [INFO]: 	Creating the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:22
2025-03-13 15:04:22,648 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:04:22,648 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:22
2025-03-13 15:04:22,648 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:04:22,648 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.64it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.58it/s] 56%|█████▌    | 5/9 [00:00<00:00, 15.84it/s] 78%|███████▊  | 7/9 [00:00<00:00, 16.61it/s]100%|██████████| 9/9 [00:02<00:00,  2.45it/s]100%|██████████| 9/9 [00:02<00:00,  3.71it/s]
2025-03-13 15:04:25,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:25
2025-03-13 15:04:52,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9019 secs
2025-03-13 15:04:52,988 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:04:52,988 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 15:05:10,032 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0435 secs
2025-03-13 15:05:10,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3868 secs
2025-03-13 15:05:10,035 [INFO]: {
2025-03-13 15:05:10,035 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:10,035 [INFO]: 	index_param: efSearch=168
2025-03-13 15:05:10,035 [INFO]: 	index_path: knn.index
2025-03-13 15:05:10,035 [INFO]: 	size in bytes: 433033450
2025-03-13 15:05:10,035 [INFO]: 	avg_search_speed_ms: 7.78896949251075
2025-03-13 15:05:10,035 [INFO]: 	99p_search_speed_ms: 10.47716710483656
2025-03-13 15:05:10,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:10,035 [INFO]: 	nb vectors: 2201
2025-03-13 15:05:10,035 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:10,035 [INFO]: 	compression ratio: 0.9993089633144968
2025-03-13 15:05:10,035 [INFO]: }
2025-03-13 15:05:10,035 [INFO]: 	>>> Finished "Creating the index" in 47.3895 secs
2025-03-13 15:05:10,035 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4149 secs
2025-03-13 15:05:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 12809 [episode count 8/20]
[retrieval_preprocessing] for episode 92685 [episode count 9/20], we have num_retrieval=np.int64(2210) num_query=np.int64(101)
2025-03-13 15:05:12,140 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:12,500 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:12
2025-03-13 15:05:12,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  6.81it/s]100%|██████████| 1/1 [00:00<00:00,  6.76it/s]
2025-03-13 15:05:12,674 [INFO]: There are 2210 embeddings of dim 49152
2025-03-13 15:05:12,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1743 secs
2025-03-13 15:05:12,675 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:12
2025-03-13 15:05:12,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:12,675 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:05:12,675 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:12,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:05:12,675 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:12
2025-03-13 15:05:12,675 [INFO]: 456.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:12,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:05:12,675 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:12
2025-03-13 15:05:12,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:12,675 [INFO]: 	Creating the index 03/13/2025, 15:05:12
2025-03-13 15:05:12,676 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:12
2025-03-13 15:05:12,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:05:12,677 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:12
2025-03-13 15:05:12,678 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:05:12,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.13it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.63it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.24it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.22it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.26it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.19it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.10it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.08it/s]100%|██████████| 9/9 [00:02<00:00,  1.63it/s]100%|██████████| 9/9 [00:02<00:00,  3.35it/s]
2025-03-13 15:05:16,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:16
2025-03-13 15:05:44,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6406 secs
2025-03-13 15:05:44,683 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 15:05:44,683 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 15:06:06,314 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6309 secs
2025-03-13 15:06:06,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6386 secs
2025-03-13 15:06:06,316 [INFO]: {
2025-03-13 15:06:06,316 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:06,316 [INFO]: 	index_param: efSearch=257
2025-03-13 15:06:06,316 [INFO]: 	index_path: knn.index
2025-03-13 15:06:06,316 [INFO]: 	size in bytes: 434804110
2025-03-13 15:06:06,316 [INFO]: 	avg_search_speed_ms: 11.322090588140883
2025-03-13 15:06:06,316 [INFO]: 	99p_search_speed_ms: 19.56328683998434
2025-03-13 15:06:06,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:06,316 [INFO]: 	nb vectors: 2210
2025-03-13 15:06:06,316 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:06,316 [INFO]: 	compression ratio: 0.9993090451697892
2025-03-13 15:06:06,316 [INFO]: }
2025-03-13 15:06:06,316 [INFO]: 	>>> Finished "Creating the index" in 53.6409 secs
2025-03-13 15:06:06,316 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8165 secs
2025-03-13 15:06:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 92685 [episode count 9/20]
[retrieval_preprocessing] for episode 66182 [episode count 10/20], we have num_retrieval=np.int64(2182) num_query=np.int64(129)
2025-03-13 15:06:08,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:09,792 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:09
2025-03-13 15:06:09,792 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-13 15:06:09,817 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 15:06:09,817 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 15:06:09,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,818 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:09,818 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:06:09,818 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:09,818 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:06:09,818 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,818 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:09,819 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:06:09,819 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:09
2025-03-13 15:06:09,819 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:09,819 [INFO]: 	Creating the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,819 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:09
2025-03-13 15:06:09,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:06:09,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,822 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:06:09,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.04it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.25it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.86it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.03it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.22it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.35it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.45it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.52it/s]100%|██████████| 9/9 [00:02<00:00,  1.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.31it/s]
2025-03-13 15:06:12,551 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:12
2025-03-13 15:06:37,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3243 secs
2025-03-13 15:06:37,876 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 15:06:37,876 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-13 15:07:03,478 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6028 secs
2025-03-13 15:07:03,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6579 secs
2025-03-13 15:07:03,480 [INFO]: {
2025-03-13 15:07:03,480 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:03,480 [INFO]: 	index_param: efSearch=235
2025-03-13 15:07:03,480 [INFO]: 	index_path: knn.index
2025-03-13 15:07:03,480 [INFO]: 	size in bytes: 429295270
2025-03-13 15:07:03,480 [INFO]: 	avg_search_speed_ms: 9.674776749004478
2025-03-13 15:07:03,480 [INFO]: 	99p_search_speed_ms: 12.155733909457922
2025-03-13 15:07:03,480 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:03,481 [INFO]: 	nb vectors: 2182
2025-03-13 15:07:03,481 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:03,481 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 15:07:03,481 [INFO]: }
2025-03-13 15:07:03,481 [INFO]: 	>>> Finished "Creating the index" in 53.6613 secs
2025-03-13 15:07:03,481 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6887 secs
2025-03-13 15:07:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 66182 [episode count 10/20]
[retrieval_preprocessing] for episode 21129 [episode count 11/20], we have num_retrieval=np.int64(2191) num_query=np.int64(120)
2025-03-13 15:07:05,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:06,139 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:06
2025-03-13 15:07:06,140 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.90it/s]
2025-03-13 15:07:06,163 [INFO]: There are 2191 embeddings of dim 49152
2025-03-13 15:07:06,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 15:07:06,164 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:06
2025-03-13 15:07:06,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:06,164 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:07:06,164 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:06,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:07:06,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:06
2025-03-13 15:07:06,165 [INFO]: 452.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:06,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:07:06,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:06
2025-03-13 15:07:06,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:06,165 [INFO]: 	Creating the index 03/13/2025, 15:07:06
2025-03-13 15:07:06,166 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:06
2025-03-13 15:07:06,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:07:06,169 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:06
2025-03-13 15:07:06,169 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:07:06,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.65it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.58it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.18it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.86it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.39it/s]100%|██████████| 9/9 [00:02<00:00,  3.26it/s]
2025-03-13 15:07:08,934 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:08
2025-03-13 15:07:46,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7167 secs
2025-03-13 15:07:46,651 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 15:07:46,651 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s]
2025-03-13 15:08:05,750 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0991 secs
2025-03-13 15:08:05,752 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5838 secs
2025-03-13 15:08:05,753 [INFO]: {
2025-03-13 15:08:05,753 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:05,753 [INFO]: 	index_param: efSearch=166
2025-03-13 15:08:05,753 [INFO]: 	index_path: knn.index
2025-03-13 15:08:05,753 [INFO]: 	size in bytes: 431066050
2025-03-13 15:08:05,753 [INFO]: 	avg_search_speed_ms: 8.481920130813117
2025-03-13 15:08:05,753 [INFO]: 	99p_search_speed_ms: 14.28714143112302
2025-03-13 15:08:05,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:05,753 [INFO]: 	nb vectors: 2191
2025-03-13 15:08:05,753 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:05,753 [INFO]: 	compression ratio: 0.9993088715754813
2025-03-13 15:08:05,753 [INFO]: }
2025-03-13 15:08:05,753 [INFO]: 	>>> Finished "Creating the index" in 59.5872 secs
2025-03-13 15:08:05,753 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6133 secs
2025-03-13 15:08:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 21129 [episode count 11/20]
[retrieval_preprocessing] for episode 27283 [episode count 12/20], we have num_retrieval=np.int64(2166) num_query=np.int64(145)
2025-03-13 15:08:07,231 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:07,601 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:07
2025-03-13 15:08:07,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2241.74it/s]
2025-03-13 15:08:07,623 [INFO]: There are 2166 embeddings of dim 49152
2025-03-13 15:08:07,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 15:08:07,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:07
2025-03-13 15:08:07,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:07,624 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:08:07,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:07,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:08:07,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:07
2025-03-13 15:08:07,625 [INFO]: 447.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:07,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:08:07,626 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:07
2025-03-13 15:08:07,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:07,626 [INFO]: 	Creating the index 03/13/2025, 15:08:07
2025-03-13 15:08:07,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:07
2025-03-13 15:08:07,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:08:07,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:07
2025-03-13 15:08:07,630 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:08:07,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.55it/s] 33%|███▎      | 3/9 [00:00<00:00, 12.79it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.96it/s] 78%|███████▊  | 7/9 [00:00<00:00, 14.64it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]100%|██████████| 9/9 [00:02<00:00,  4.45it/s]
2025-03-13 15:08:09,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:09
2025-03-13 15:08:35,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5687 secs
2025-03-13 15:08:35,229 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 15:08:35,229 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 15:08:56,371 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1417 secs
2025-03-13 15:08:56,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7424 secs
2025-03-13 15:08:56,372 [INFO]: {
2025-03-13 15:08:56,373 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:56,373 [INFO]: 	index_param: efSearch=224
2025-03-13 15:08:56,373 [INFO]: 	index_path: knn.index
2025-03-13 15:08:56,373 [INFO]: 	size in bytes: 426147310
2025-03-13 15:08:56,373 [INFO]: 	avg_search_speed_ms: 9.231636315732093
2025-03-13 15:08:56,373 [INFO]: 	99p_search_speed_ms: 12.548621948808432
2025-03-13 15:08:56,373 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:56,373 [INFO]: 	nb vectors: 2166
2025-03-13 15:08:56,373 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:56,373 [INFO]: 	compression ratio: 0.9993092013182014
2025-03-13 15:08:56,373 [INFO]: }
2025-03-13 15:08:56,373 [INFO]: 	>>> Finished "Creating the index" in 48.7465 secs
2025-03-13 15:08:56,373 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7712 secs
2025-03-13 15:08:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 27283 [episode count 12/20]
[retrieval_preprocessing] for episode 33428 [episode count 13/20], we have num_retrieval=np.int64(2204) num_query=np.int64(107)
2025-03-13 15:08:58,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:58,874 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:58
2025-03-13 15:08:58,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2020.38it/s]
2025-03-13 15:08:58,899 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 15:08:58,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 15:08:58,899 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:58
2025-03-13 15:08:58,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:58,899 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:08:58,899 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:58,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:08:58,899 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:58
2025-03-13 15:08:58,899 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:58,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:08:58,900 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:58
2025-03-13 15:08:58,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:58,900 [INFO]: 	Creating the index 03/13/2025, 15:08:58
2025-03-13 15:08:58,900 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:58
2025-03-13 15:08:58,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 15:08:58,901 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:58
2025-03-13 15:08:58,902 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:08:58,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.38it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.94it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.91it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.16it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.35it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.54it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.74it/s]100%|██████████| 9/9 [00:03<00:00,  1.45it/s]100%|██████████| 9/9 [00:03<00:00,  2.98it/s]
2025-03-13 15:09:01,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:01
2025-03-13 15:09:28,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8234 secs
2025-03-13 15:09:28,756 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:09:28,756 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 15:09:47,825 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0691 secs
2025-03-13 15:09:47,843 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9411 secs
2025-03-13 15:09:47,843 [INFO]: {
2025-03-13 15:09:47,843 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:47,843 [INFO]: 	index_param: efSearch=159
2025-03-13 15:09:47,843 [INFO]: 	index_path: knn.index
2025-03-13 15:09:47,843 [INFO]: 	size in bytes: 433623670
2025-03-13 15:09:47,843 [INFO]: 	avg_search_speed_ms: 8.198746554286327
2025-03-13 15:09:47,843 [INFO]: 	99p_search_speed_ms: 13.346871638204897
2025-03-13 15:09:47,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:47,843 [INFO]: 	nb vectors: 2204
2025-03-13 15:09:47,843 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:47,843 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 15:09:47,843 [INFO]: }
2025-03-13 15:09:47,843 [INFO]: 	>>> Finished "Creating the index" in 48.9433 secs
2025-03-13 15:09:47,843 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9691 secs
2025-03-13 15:09:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 33428 [episode count 13/20]
[retrieval_preprocessing] for episode 12987 [episode count 14/20], we have num_retrieval=np.int64(2209) num_query=np.int64(102)
2025-03-13 15:09:49,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:50,023 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:50
2025-03-13 15:09:50,024 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1130.84it/s]
2025-03-13 15:09:50,051 [INFO]: There are 2209 embeddings of dim 49152
2025-03-13 15:09:50,051 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:09:50,051 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:50,051 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:09:50,051 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:50,051 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:50,051 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,052 [INFO]: 455.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:50,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:50,052 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:50
2025-03-13 15:09:50,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:50,052 [INFO]: 	Creating the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,052 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:50
2025-03-13 15:09:50,053 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:09:50,053 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,053 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:09:50,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.73it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.50it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.71it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.25it/s]100%|██████████| 9/9 [00:02<00:00,  2.87it/s]100%|██████████| 9/9 [00:02<00:00,  4.01it/s]
2025-03-13 15:09:52,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:52
2025-03-13 15:10:21,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9555 secs
2025-03-13 15:10:21,263 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:10:21,264 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 15:10:43,718 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4538 secs
2025-03-13 15:10:43,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7460 secs
2025-03-13 15:10:43,799 [INFO]: {
2025-03-13 15:10:43,800 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:43,800 [INFO]: 	index_param: efSearch=201
2025-03-13 15:10:43,800 [INFO]: 	index_path: knn.index
2025-03-13 15:10:43,800 [INFO]: 	size in bytes: 434607370
2025-03-13 15:10:43,800 [INFO]: 	avg_search_speed_ms: 9.281626014178878
2025-03-13 15:10:43,800 [INFO]: 	99p_search_speed_ms: 12.93954582186416
2025-03-13 15:10:43,800 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:43,800 [INFO]: 	nb vectors: 2209
2025-03-13 15:10:43,800 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:43,800 [INFO]: 	compression ratio: 0.9993090361076942
2025-03-13 15:10:43,800 [INFO]: }
2025-03-13 15:10:43,800 [INFO]: 	>>> Finished "Creating the index" in 53.7484 secs
2025-03-13 15:10:43,800 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7766 secs
2025-03-13 15:10:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 12987 [episode count 14/20]
[retrieval_preprocessing] for episode 17237 [episode count 15/20], we have num_retrieval=np.int64(2194) num_query=np.int64(117)
2025-03-13 15:10:45,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:46,264 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:46
2025-03-13 15:10:46,264 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1426.15it/s]
2025-03-13 15:10:46,290 [INFO]: There are 2194 embeddings of dim 49152
2025-03-13 15:10:46,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:10:46,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:46
2025-03-13 15:10:46,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:46,291 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:10:46,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:46,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:46,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:46
2025-03-13 15:10:46,291 [INFO]: 452.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:46,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:10:46,291 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:46
2025-03-13 15:10:46,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:46,291 [INFO]: 	Creating the index 03/13/2025, 15:10:46
2025-03-13 15:10:46,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:46
2025-03-13 15:10:46,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:10:46,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:46
2025-03-13 15:10:46,292 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:10:46,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.85it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.38it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.99it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.31it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.48it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.60it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.77it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.80it/s]100%|██████████| 9/9 [00:02<00:00,  1.80it/s]100%|██████████| 9/9 [00:02<00:00,  3.48it/s]
2025-03-13 15:10:48,884 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:48
2025-03-13 15:11:14,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4468 secs
2025-03-13 15:11:14,332 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 15:11:14,332 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 15:11:34,038 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7061 secs
2025-03-13 15:11:34,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0893 secs
2025-03-13 15:11:34,382 [INFO]: {
2025-03-13 15:11:34,382 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:34,382 [INFO]: 	index_param: efSearch=215
2025-03-13 15:11:34,382 [INFO]: 	index_path: knn.index
2025-03-13 15:11:34,382 [INFO]: 	size in bytes: 431656270
2025-03-13 15:11:34,382 [INFO]: 	avg_search_speed_ms: 10.681940628460442
2025-03-13 15:11:34,382 [INFO]: 	99p_search_speed_ms: 20.99321619607507
2025-03-13 15:11:34,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:34,383 [INFO]: 	nb vectors: 2194
2025-03-13 15:11:34,383 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:34,383 [INFO]: 	compression ratio: 0.9993088991849928
2025-03-13 15:11:34,383 [INFO]: }
2025-03-13 15:11:34,383 [INFO]: 	>>> Finished "Creating the index" in 48.0918 secs
2025-03-13 15:11:34,383 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1189 secs
2025-03-13 15:11:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 17237 [episode count 15/20]
[retrieval_preprocessing] for episode 87080 [episode count 16/20], we have num_retrieval=np.int64(2180) num_query=np.int64(131)
2025-03-13 15:11:36,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:36,941 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:36
2025-03-13 15:11:36,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.05it/s]
2025-03-13 15:11:36,971 [INFO]: There are 2180 embeddings of dim 49152
2025-03-13 15:11:36,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 15:11:36,971 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:36
2025-03-13 15:11:36,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:36,971 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:11:36,971 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:36,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:36,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:36
2025-03-13 15:11:36,972 [INFO]: 449.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:36,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:11:36,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:36
2025-03-13 15:11:36,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:36,972 [INFO]: 	Creating the index 03/13/2025, 15:11:36
2025-03-13 15:11:36,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:36
2025-03-13 15:11:36,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:11:36,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:36
2025-03-13 15:11:36,973 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:11:36,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.80it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.39it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.03it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.67it/s] 56%|█████▌    | 5/9 [00:00<00:00,  5.99it/s] 67%|██████▋   | 6/9 [00:00<00:00,  6.51it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.87it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.12it/s]100%|██████████| 9/9 [00:05<00:00,  1.31s/it]100%|██████████| 9/9 [00:05<00:00,  1.79it/s]
2025-03-13 15:11:42,018 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:42
2025-03-13 15:12:13,352 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3338 secs
2025-03-13 15:12:13,353 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 15:12:13,353 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 15:12:30,736 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3831 secs
2025-03-13 15:12:30,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7651 secs
2025-03-13 15:12:30,738 [INFO]: {
2025-03-13 15:12:30,739 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:30,739 [INFO]: 	index_param: efSearch=216
2025-03-13 15:12:30,739 [INFO]: 	index_path: knn.index
2025-03-13 15:12:30,739 [INFO]: 	size in bytes: 428901790
2025-03-13 15:12:30,739 [INFO]: 	avg_search_speed_ms: 9.709106147225983
2025-03-13 15:12:30,739 [INFO]: 	99p_search_speed_ms: 13.165063145570462
2025-03-13 15:12:30,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:30,739 [INFO]: 	nb vectors: 2180
2025-03-13 15:12:30,739 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:30,739 [INFO]: 	compression ratio: 0.9993090492814217
2025-03-13 15:12:30,739 [INFO]: }
2025-03-13 15:12:30,739 [INFO]: 	>>> Finished "Creating the index" in 53.7669 secs
2025-03-13 15:12:30,739 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7976 secs
2025-03-13 15:12:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 87080 [episode count 16/20]
[retrieval_preprocessing] for episode 31838 [episode count 17/20], we have num_retrieval=np.int64(2196) num_query=np.int64(115)
2025-03-13 15:12:33,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:33,782 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:33
2025-03-13 15:12:33,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2015.52it/s]
2025-03-13 15:12:33,807 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 15:12:33,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 15:12:33,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:33
2025-03-13 15:12:33,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:33,808 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:12:33,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:33,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:12:33,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:33
2025-03-13 15:12:33,808 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:33,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:12:33,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:33
2025-03-13 15:12:33,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:33,809 [INFO]: 	Creating the index 03/13/2025, 15:12:33
2025-03-13 15:12:33,809 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:33
2025-03-13 15:12:33,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 15:12:33,810 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:33
2025-03-13 15:12:33,811 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:12:33,811 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.62it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.72it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.46it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.92it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.53it/s]100%|██████████| 9/9 [00:02<00:00,  2.13it/s]100%|██████████| 9/9 [00:02<00:00,  3.25it/s]
2025-03-13 15:12:36,589 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:36
2025-03-13 15:13:06,002 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4118 secs
2025-03-13 15:13:06,002 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 15:13:06,002 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 15:13:27,126 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1241 secs
2025-03-13 15:13:27,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3180 secs
2025-03-13 15:13:27,129 [INFO]: {
2025-03-13 15:13:27,129 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:27,129 [INFO]: 	index_param: efSearch=215
2025-03-13 15:13:27,129 [INFO]: 	index_path: knn.index
2025-03-13 15:13:27,129 [INFO]: 	size in bytes: 432049750
2025-03-13 15:13:27,129 [INFO]: 	avg_search_speed_ms: 10.678574675694108
2025-03-13 15:13:27,129 [INFO]: 	99p_search_speed_ms: 18.175824992358674
2025-03-13 15:13:27,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:27,129 [INFO]: 	nb vectors: 2196
2025-03-13 15:13:27,129 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:27,129 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 15:13:27,129 [INFO]: }
2025-03-13 15:13:27,129 [INFO]: 	>>> Finished "Creating the index" in 53.3202 secs
2025-03-13 15:13:27,129 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3465 secs
2025-03-13 15:13:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 31838 [episode count 17/20]
[retrieval_preprocessing] for episode 27780 [episode count 18/20], we have num_retrieval=np.int64(2198) num_query=np.int64(113)
2025-03-13 15:13:29,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:29,365 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:29
2025-03-13 15:13:29,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1005.35it/s]
2025-03-13 15:13:29,391 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 15:13:29,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:13:29,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:29
2025-03-13 15:13:29,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:29,392 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:13:29,392 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:29,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:29,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:29
2025-03-13 15:13:29,392 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:29,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:13:29,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:29
2025-03-13 15:13:29,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:29,392 [INFO]: 	Creating the index 03/13/2025, 15:13:29
2025-03-13 15:13:29,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:29
2025-03-13 15:13:29,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:13:29,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:29
2025-03-13 15:13:29,393 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:13:29,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.57it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.94it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.20it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.53it/s]100%|██████████| 9/9 [00:03<00:00,  1.90it/s]100%|██████████| 9/9 [00:03<00:00,  2.83it/s]
2025-03-13 15:13:32,580 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:32
2025-03-13 15:14:01,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6390 secs
2025-03-13 15:14:01,220 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 15:14:01,220 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s]
2025-03-13 15:14:30,002 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7823 secs
2025-03-13 15:14:30,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6107 secs
2025-03-13 15:14:30,004 [INFO]: {
2025-03-13 15:14:30,004 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:30,004 [INFO]: 	index_param: efSearch=248
2025-03-13 15:14:30,004 [INFO]: 	index_path: knn.index
2025-03-13 15:14:30,004 [INFO]: 	size in bytes: 432443230
2025-03-13 15:14:30,004 [INFO]: 	avg_search_speed_ms: 10.468538749124367
2025-03-13 15:14:30,004 [INFO]: 	99p_search_speed_ms: 18.23005971033126
2025-03-13 15:14:30,004 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:30,004 [INFO]: 	nb vectors: 2198
2025-03-13 15:14:30,004 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:30,004 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 15:14:30,004 [INFO]: }
2025-03-13 15:14:30,004 [INFO]: 	>>> Finished "Creating the index" in 60.6122 secs
2025-03-13 15:14:30,004 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6390 secs
2025-03-13 15:14:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 27780 [episode count 18/20]
[retrieval_preprocessing] for episode 40114 [episode count 19/20], we have num_retrieval=np.int64(2200) num_query=np.int64(111)
2025-03-13 15:14:31,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:32,232 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:32
2025-03-13 15:14:32,232 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1329.41it/s]
2025-03-13 15:14:32,261 [INFO]: There are 2200 embeddings of dim 49152
2025-03-13 15:14:32,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:14:32,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:32,262 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:14:32,262 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:32,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:14:32,262 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,263 [INFO]: 454.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:32,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:14:32,263 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:32
2025-03-13 15:14:32,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:32,263 [INFO]: 	Creating the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,263 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:32
2025-03-13 15:14:32,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:14:32,267 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,267 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:14:32,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.36it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.85it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.75it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.48it/s]100%|██████████| 9/9 [00:02<00:00,  2.92it/s]100%|██████████| 9/9 [00:02<00:00,  4.14it/s]
2025-03-13 15:14:34,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:34
2025-03-13 15:15:04,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6763 secs
2025-03-13 15:15:04,123 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 15:15:04,123 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 15:15:22,719 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5965 secs
2025-03-13 15:15:23,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9898 secs
2025-03-13 15:15:23,257 [INFO]: {
2025-03-13 15:15:23,257 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:23,257 [INFO]: 	index_param: efSearch=220
2025-03-13 15:15:23,257 [INFO]: 	index_path: knn.index
2025-03-13 15:15:23,257 [INFO]: 	size in bytes: 432836710
2025-03-13 15:15:23,257 [INFO]: 	avg_search_speed_ms: 10.361121890226794
2025-03-13 15:15:23,258 [INFO]: 	99p_search_speed_ms: 16.381845362484455
2025-03-13 15:15:23,258 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:23,258 [INFO]: 	nb vectors: 2200
2025-03-13 15:15:23,258 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:23,258 [INFO]: 	compression ratio: 0.9993089541781242
2025-03-13 15:15:23,258 [INFO]: }
2025-03-13 15:15:23,258 [INFO]: 	>>> Finished "Creating the index" in 50.9946 secs
2025-03-13 15:15:23,258 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0258 secs
2025-03-13 15:15:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 40114 [episode count 19/20]
2025-03-13 15:15:24: [retrieval_preprocessing] finished for 5207831207_left_click_mouse [chosen_id count 1/196]
2025-03-13 15:15:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_pour_cup_into_bowl [chosen_id count 2/196]
2025-03-13 15:15:34: [retrieval_preprocessing] we have num_total=10734 embedding_dim=49152
[retrieval_preprocessing] for episode 53248 [episode count 0/20], we have num_retrieval=np.int64(10172) num_query=np.int64(562)
2025-03-13 15:15:38,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:40,732 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:40
2025-03-13 15:15:40,732 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.04it/s]
2025-03-13 15:15:40,755 [INFO]: There are 10172 embeddings of dim 49152
2025-03-13 15:15:40,755 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 15:15:40,756 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:40
2025-03-13 15:15:40,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:40,756 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:15:40,756 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:15:40,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:40,756 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:40
2025-03-13 15:15:40,756 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:40,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:15:40,756 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:40
2025-03-13 15:15:40,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:40,756 [INFO]: 	Creating the index 03/13/2025, 15:15:40
2025-03-13 15:15:40,756 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:15:40
2025-03-13 15:15:40,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:15:40,757 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:40
2025-03-13 15:15:40,757 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:15:40,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/42 [00:00<?, ?it/s]  2%|▏         | 1/42 [00:00<00:10,  3.92it/s]  5%|▍         | 2/42 [00:00<00:06,  5.76it/s]  7%|▋         | 3/42 [00:00<00:06,  6.30it/s] 10%|▉         | 4/42 [00:00<00:05,  6.56it/s] 12%|█▏        | 5/42 [00:00<00:05,  6.78it/s] 14%|█▍        | 6/42 [00:00<00:04,  7.55it/s] 19%|█▉        | 8/42 [00:01<00:03,  8.54it/s] 24%|██▍       | 10/42 [00:01<00:03, 10.01it/s] 29%|██▊       | 12/42 [00:01<00:02, 11.73it/s] 33%|███▎      | 14/42 [00:01<00:02, 11.51it/s] 38%|███▊      | 16/42 [00:01<00:02, 10.87it/s] 43%|████▎     | 18/42 [00:01<00:02, 10.53it/s] 48%|████▊     | 20/42 [00:02<00:01, 11.03it/s] 52%|█████▏    | 22/42 [00:08<00:20,  1.01s/it] 62%|██████▏   | 26/42 [00:08<00:08,  1.81it/s] 71%|███████▏  | 30/42 [00:08<00:04,  2.91it/s] 81%|████████  | 34/42 [00:08<00:01,  4.36it/s] 88%|████████▊ | 37/42 [00:08<00:00,  5.72it/s] 95%|█████████▌| 40/42 [00:08<00:00,  7.41it/s]100%|██████████| 42/42 [00:19<00:00,  2.15it/s]
2025-03-13 15:16:00,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:00
2025-03-13 15:17:54,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 114.3651 secs
2025-03-13 15:17:54,684 [INFO]: The best hyperparameters are: efSearch=35
2025-03-13 15:17:54,684 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.44it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 15:18:45,568 [INFO]: 	>>> Finished "Compute fast metrics" in 50.8842 secs
2025-03-13 15:18:45,573 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 184.8162 secs
2025-03-13 15:18:45,574 [INFO]: {
2025-03-13 15:18:45,574 [INFO]: 	index_key: HNSW32
2025-03-13 15:18:45,574 [INFO]: 	index_param: efSearch=35
2025-03-13 15:18:45,574 [INFO]: 	index_path: knn.index
2025-03-13 15:18:45,574 [INFO]: 	size in bytes: 2002661170
2025-03-13 15:18:45,574 [INFO]: 	avg_search_speed_ms: 5.7600118063737895
2025-03-13 15:18:45,574 [INFO]: 	99p_search_speed_ms: 11.729286273475742
2025-03-13 15:18:45,574 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:45,574 [INFO]: 	nb vectors: 10172
2025-03-13 15:18:45,574 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:45,574 [INFO]: 	compression ratio: 0.9986195398196092
2025-03-13 15:18:45,574 [INFO]: }
2025-03-13 15:18:45,574 [INFO]: 	>>> Finished "Creating the index" in 184.8178 secs
2025-03-13 15:18:45,574 [INFO]: >>> Finished "Launching the whole pipeline" in 184.8421 secs
2025-03-13 15:18:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 53248 [episode count 0/20]
[retrieval_preprocessing] for episode 53291 [episode count 1/20], we have num_retrieval=np.int64(10246) num_query=np.int64(488)
2025-03-13 15:18:52,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:53,857 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:53
2025-03-13 15:18:53,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.74it/s]
2025-03-13 15:18:53,886 [INFO]: There are 10246 embeddings of dim 49152
2025-03-13 15:18:53,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 15:18:53,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:53
2025-03-13 15:18:53,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:53,886 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:18:53,886 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:18:53,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:18:53,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:53
2025-03-13 15:18:53,886 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:53,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:18:53,886 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:53
2025-03-13 15:18:53,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:53,887 [INFO]: 	Creating the index 03/13/2025, 15:18:53
2025-03-13 15:18:53,887 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:18:53
2025-03-13 15:18:53,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 15:18:53,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:53
2025-03-13 15:18:53,888 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:18:53,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.55it/s]  7%|▋         | 3/43 [00:00<00:05,  7.88it/s] 12%|█▏        | 5/43 [00:00<00:04,  9.06it/s] 16%|█▋        | 7/43 [00:00<00:03,  9.36it/s] 19%|█▊        | 8/43 [00:00<00:03,  9.46it/s] 21%|██        | 9/43 [00:01<00:03,  9.57it/s] 26%|██▌       | 11/43 [00:01<00:03,  9.95it/s] 30%|███       | 13/43 [00:01<00:02, 10.14it/s] 35%|███▍      | 15/43 [00:01<00:02, 10.14it/s] 40%|███▉      | 17/43 [00:01<00:02, 10.52it/s] 44%|████▍     | 19/43 [00:01<00:02, 10.89it/s] 49%|████▉     | 21/43 [00:09<00:26,  1.19s/it] 53%|█████▎    | 23/43 [00:09<00:16,  1.20it/s] 58%|█████▊    | 25/43 [00:09<00:10,  1.67it/s] 63%|██████▎   | 27/43 [00:09<00:07,  2.23it/s] 67%|██████▋   | 29/43 [00:09<00:04,  2.91it/s] 72%|███████▏  | 31/43 [00:09<00:03,  3.69it/s] 77%|███████▋  | 33/43 [00:10<00:02,  4.56it/s] 81%|████████▏ | 35/43 [00:10<00:01,  5.41it/s] 86%|████████▌ | 37/43 [00:10<00:00,  6.24it/s] 88%|████████▊ | 38/43 [00:10<00:00,  6.65it/s] 91%|█████████ | 39/43 [00:10<00:00,  7.11it/s] 93%|█████████▎| 40/43 [00:10<00:00,  7.58it/s] 98%|█████████▊| 42/43 [00:18<00:01,  1.56s/it]100%|██████████| 43/43 [00:20<00:00,  1.72s/it]100%|██████████| 43/43 [00:20<00:00,  2.07it/s]
2025-03-13 15:19:14,630 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:14
2025-03-13 15:20:35,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.7959 secs
2025-03-13 15:20:35,426 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 15:20:35,426 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 15:21:26,609 [INFO]: 	>>> Finished "Compute fast metrics" in 51.1829 secs
2025-03-13 15:21:26,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.7220 secs
2025-03-13 15:21:26,610 [INFO]: {
2025-03-13 15:21:26,610 [INFO]: 	index_key: HNSW32
2025-03-13 15:21:26,610 [INFO]: 	index_param: efSearch=131
2025-03-13 15:21:26,610 [INFO]: 	index_path: knn.index
2025-03-13 15:21:26,610 [INFO]: 	size in bytes: 2017230378
2025-03-13 15:21:26,610 [INFO]: 	avg_search_speed_ms: 11.0353045365989
2025-03-13 15:21:26,610 [INFO]: 	99p_search_speed_ms: 22.249249753076594
2025-03-13 15:21:26,610 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:26,610 [INFO]: 	nb vectors: 10246
2025-03-13 15:21:26,610 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:26,610 [INFO]: 	compression ratio: 0.998619488368621
2025-03-13 15:21:26,610 [INFO]: }
2025-03-13 15:21:26,610 [INFO]: 	>>> Finished "Creating the index" in 152.7237 secs
2025-03-13 15:21:26,610 [INFO]: >>> Finished "Launching the whole pipeline" in 152.7532 secs
2025-03-13 15:21:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 53291 [episode count 1/20]
[retrieval_preprocessing] for episode 69925 [episode count 2/20], we have num_retrieval=np.int64(10227) num_query=np.int64(507)
2025-03-13 15:21:34,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:37,049 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:37
2025-03-13 15:21:37,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.94it/s]
2025-03-13 15:21:37,075 [INFO]: There are 10227 embeddings of dim 49152
2025-03-13 15:21:37,076 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:21:37,076 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:37
2025-03-13 15:21:37,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:37,076 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:21:37,076 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:21:37,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:21:37,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:37
2025-03-13 15:21:37,076 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:37,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:21:37,076 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:37
2025-03-13 15:21:37,076 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:37,077 [INFO]: 	Creating the index 03/13/2025, 15:21:37
2025-03-13 15:21:37,077 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:21:37
2025-03-13 15:21:37,078 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 15:21:37,078 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:37
2025-03-13 15:21:37,078 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:21:37,078 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:10,  3.87it/s]  5%|▍         | 2/43 [00:00<00:07,  5.75it/s]  7%|▋         | 3/43 [00:00<00:05,  7.03it/s]  9%|▉         | 4/43 [00:00<00:05,  7.41it/s] 12%|█▏        | 5/43 [00:00<00:05,  7.44it/s] 14%|█▍        | 6/43 [00:00<00:04,  7.57it/s] 16%|█▋        | 7/43 [00:00<00:04,  7.66it/s] 19%|█▊        | 8/43 [00:01<00:04,  7.60it/s] 21%|██        | 9/43 [00:01<00:04,  8.04it/s] 23%|██▎       | 10/43 [00:01<00:03,  8.37it/s] 26%|██▌       | 11/43 [00:01<00:03,  8.46it/s] 28%|██▊       | 12/43 [00:01<00:03,  8.25it/s] 30%|███       | 13/43 [00:01<00:03,  8.10it/s] 33%|███▎      | 14/43 [00:01<00:03,  8.00it/s] 35%|███▍      | 15/43 [00:01<00:03,  7.91it/s] 37%|███▋      | 16/43 [00:02<00:03,  7.84it/s] 40%|███▉      | 17/43 [00:02<00:03,  7.90it/s] 42%|████▏     | 18/43 [00:02<00:03,  7.81it/s] 44%|████▍     | 19/43 [00:02<00:03,  7.75it/s] 47%|████▋     | 20/43 [00:02<00:02,  7.87it/s] 49%|████▉     | 21/43 [00:08<00:39,  1.80s/it] 53%|█████▎    | 23/43 [00:08<00:20,  1.01s/it] 58%|█████▊    | 25/43 [00:08<00:11,  1.58it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.33it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.28it/s] 72%|███████▏  | 31/43 [00:09<00:02,  4.37it/s] 77%|███████▋  | 33/43 [00:09<00:01,  5.64it/s] 81%|████████▏ | 35/43 [00:09<00:01,  6.71it/s] 86%|████████▌ | 37/43 [00:09<00:00,  7.72it/s] 91%|█████████ | 39/43 [00:09<00:00,  8.62it/s] 95%|█████████▌| 41/43 [00:09<00:00,  9.50it/s]100%|██████████| 43/43 [00:18<00:00,  1.32s/it]100%|██████████| 43/43 [00:18<00:00,  2.38it/s]
2025-03-13 15:21:55,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:55
2025-03-13 15:23:14,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.1728 secs
2025-03-13 15:23:14,345 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 15:23:14,345 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 15:23:55,107 [INFO]: 	>>> Finished "Compute fast metrics" in 40.7618 secs
2025-03-13 15:23:55,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.0297 secs
2025-03-13 15:23:55,108 [INFO]: {
2025-03-13 15:23:55,108 [INFO]: 	index_key: HNSW32
2025-03-13 15:23:55,108 [INFO]: 	index_param: efSearch=115
2025-03-13 15:23:55,108 [INFO]: 	index_path: knn.index
2025-03-13 15:23:55,108 [INFO]: 	size in bytes: 2013489734
2025-03-13 15:23:55,108 [INFO]: 	avg_search_speed_ms: 9.976802545993731
2025-03-13 15:23:55,108 [INFO]: 	99p_search_speed_ms: 16.493506939150393
2025-03-13 15:23:55,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:55,108 [INFO]: 	nb vectors: 10227
2025-03-13 15:23:55,108 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:55,108 [INFO]: 	compression ratio: 0.9986194526085426
2025-03-13 15:23:55,108 [INFO]: }
2025-03-13 15:23:55,108 [INFO]: 	>>> Finished "Creating the index" in 138.0313 secs
2025-03-13 15:23:55,108 [INFO]: >>> Finished "Launching the whole pipeline" in 138.0584 secs
2025-03-13 15:23:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 69925 [episode count 2/20]
[retrieval_preprocessing] for episode 27029 [episode count 3/20], we have num_retrieval=np.int64(10188) num_query=np.int64(546)
2025-03-13 15:24:03,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:05,901 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:05
2025-03-13 15:24:05,901 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 860.19it/s]
2025-03-13 15:24:05,928 [INFO]: There are 10188 embeddings of dim 49152
2025-03-13 15:24:05,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:24:05,928 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:05,928 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:24:05,928 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:24:05,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:05,928 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,928 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:05,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:24:05,928 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:05
2025-03-13 15:24:05,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:05,929 [INFO]: 	Creating the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,929 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:24:05
2025-03-13 15:24:05,930 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 15:24:05,930 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,930 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:24:05,930 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.49it/s]  7%|▋         | 3/43 [00:00<00:04,  9.49it/s] 14%|█▍        | 6/43 [00:00<00:02, 16.19it/s] 23%|██▎       | 10/43 [00:00<00:01, 21.70it/s] 30%|███       | 13/43 [00:00<00:01, 24.06it/s] 37%|███▋      | 16/43 [00:00<00:01, 25.09it/s] 44%|████▍     | 19/43 [00:00<00:00, 25.82it/s] 51%|█████     | 22/43 [00:07<00:15,  1.36it/s] 56%|█████▌    | 24/43 [00:07<00:11,  1.73it/s] 60%|██████    | 26/43 [00:07<00:07,  2.21it/s] 65%|██████▌   | 28/43 [00:07<00:05,  2.85it/s] 70%|██████▉   | 30/43 [00:08<00:03,  3.65it/s] 74%|███████▍  | 32/43 [00:08<00:02,  4.63it/s] 79%|███████▉  | 34/43 [00:08<00:01,  5.74it/s] 84%|████████▎ | 36/43 [00:08<00:01,  6.96it/s] 88%|████████▊ | 38/43 [00:08<00:00,  8.26it/s] 95%|█████████▌| 41/43 [00:08<00:00, 10.49it/s]100%|██████████| 43/43 [00:18<00:00,  1.31s/it]100%|██████████| 43/43 [00:18<00:00,  2.38it/s]
2025-03-13 15:24:24,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:24
2025-03-13 15:25:50,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.1851 secs
2025-03-13 15:25:50,199 [INFO]: The best hyperparameters are: efSearch=104
2025-03-13 15:25:50,199 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.89it/s]
2025-03-13 15:26:34,014 [INFO]: 	>>> Finished "Compute fast metrics" in 43.8150 secs
2025-03-13 15:26:34,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.0847 secs
2025-03-13 15:26:34,015 [INFO]: {
2025-03-13 15:26:34,015 [INFO]: 	index_key: HNSW32
2025-03-13 15:26:34,015 [INFO]: 	index_param: efSearch=104
2025-03-13 15:26:34,015 [INFO]: 	index_path: knn.index
2025-03-13 15:26:34,015 [INFO]: 	size in bytes: 2005811186
2025-03-13 15:26:34,015 [INFO]: 	avg_search_speed_ms: 12.653540772727773
2025-03-13 15:26:34,015 [INFO]: 	99p_search_speed_ms: 24.288041207473725
2025-03-13 15:26:34,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:34,015 [INFO]: 	nb vectors: 10188
2025-03-13 15:26:34,015 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:34,015 [INFO]: 	compression ratio: 0.9986195699678384
2025-03-13 15:26:34,015 [INFO]: }
2025-03-13 15:26:34,015 [INFO]: 	>>> Finished "Creating the index" in 148.0865 secs
2025-03-13 15:26:34,015 [INFO]: >>> Finished "Launching the whole pipeline" in 148.1137 secs
2025-03-13 15:26:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 27029 [episode count 3/20]
[retrieval_preprocessing] for episode 78209 [episode count 4/20], we have num_retrieval=np.int64(10168) num_query=np.int64(566)
2025-03-13 15:26:39,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:41,348 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:41
2025-03-13 15:26:41,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 970.68it/s]
2025-03-13 15:26:41,384 [INFO]: There are 10168 embeddings of dim 49152
2025-03-13 15:26:41,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 15:26:41,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:41,384 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:26:41,384 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:26:41,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:41,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,384 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:41,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:41,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:41
2025-03-13 15:26:41,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:41,385 [INFO]: 	Creating the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,385 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:26:41
2025-03-13 15:26:41,386 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:26:41,386 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:41
2025-03-13 15:26:41,386 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:26:41,386 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/42 [00:00<?, ?it/s]  2%|▏         | 1/42 [00:00<00:06,  6.46it/s] 12%|█▏        | 5/42 [00:00<00:01, 20.89it/s] 24%|██▍       | 10/42 [00:00<00:01, 29.98it/s] 36%|███▌      | 15/42 [00:00<00:00, 34.12it/s] 45%|████▌     | 19/42 [00:00<00:00, 35.52it/s] 55%|█████▍    | 23/42 [00:07<00:10,  1.80it/s] 67%|██████▋   | 28/42 [00:07<00:04,  2.80it/s] 79%|███████▊  | 33/42 [00:07<00:02,  4.15it/s] 90%|█████████ | 38/42 [00:07<00:00,  5.93it/s]100%|██████████| 42/42 [00:15<00:00,  1.55it/s]100%|██████████| 42/42 [00:15<00:00,  2.79it/s]
2025-03-13 15:26:56,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:56
2025-03-13 15:28:24,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.3646 secs
2025-03-13 15:28:24,791 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 15:28:24,791 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.94it/s]
2025-03-13 15:29:05,625 [INFO]: 	>>> Finished "Compute fast metrics" in 40.8334 secs
2025-03-13 15:29:05,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.2420 secs
2025-03-13 15:29:05,628 [INFO]: {
2025-03-13 15:29:05,628 [INFO]: 	index_key: HNSW32
2025-03-13 15:29:05,628 [INFO]: 	index_param: efSearch=91
2025-03-13 15:29:05,628 [INFO]: 	index_path: knn.index
2025-03-13 15:29:05,628 [INFO]: 	size in bytes: 2001873666
2025-03-13 15:29:05,628 [INFO]: 	avg_search_speed_ms: 9.231291914492887
2025-03-13 15:29:05,628 [INFO]: 	99p_search_speed_ms: 18.019052860327072
2025-03-13 15:29:05,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:05,628 [INFO]: 	nb vectors: 10168
2025-03-13 15:29:05,628 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:05,628 [INFO]: 	compression ratio: 0.998619532267727
2025-03-13 15:29:05,628 [INFO]: }
2025-03-13 15:29:05,628 [INFO]: 	>>> Finished "Creating the index" in 144.2438 secs
2025-03-13 15:29:05,628 [INFO]: >>> Finished "Launching the whole pipeline" in 144.2805 secs
2025-03-13 15:29:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 78209 [episode count 4/20]
[retrieval_preprocessing] for episode 27094 [episode count 5/20], we have num_retrieval=np.int64(10110) num_query=np.int64(624)
2025-03-13 15:29:09,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:11,386 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:11
2025-03-13 15:29:11,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.07it/s]
2025-03-13 15:29:11,432 [INFO]: There are 10110 embeddings of dim 49152
2025-03-13 15:29:11,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0457 secs
2025-03-13 15:29:11,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:11
2025-03-13 15:29:11,433 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:11,433 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:29:11,433 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:29:11,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:29:11,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:11
2025-03-13 15:29:11,433 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:11,434 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:29:11,434 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:11
2025-03-13 15:29:11,434 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:29:11,434 [INFO]: 	Creating the index 03/13/2025, 15:29:11
2025-03-13 15:29:11,434 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:29:11
2025-03-13 15:29:11,437 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0023 secs
2025-03-13 15:29:11,437 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:11
2025-03-13 15:29:11,437 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:29:11,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.50it/s] 15%|█▍        | 6/41 [00:00<00:01, 26.48it/s] 27%|██▋       | 11/41 [00:00<00:00, 33.41it/s] 39%|███▉      | 16/41 [00:00<00:00, 36.80it/s] 51%|█████     | 21/41 [00:06<00:09,  2.02it/s] 63%|██████▎   | 26/41 [00:06<00:04,  3.06it/s] 76%|███████▌  | 31/41 [00:06<00:02,  4.47it/s] 88%|████████▊ | 36/41 [00:06<00:00,  6.33it/s]100%|██████████| 41/41 [00:15<00:00,  1.52it/s]100%|██████████| 41/41 [00:15<00:00,  2.62it/s]
2025-03-13 15:29:27,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:27
2025-03-13 15:30:51,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.1488 secs
2025-03-13 15:30:51,272 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 15:30:51,272 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.54it/s]
2025-03-13 15:31:37,893 [INFO]: 	>>> Finished "Compute fast metrics" in 46.6216 secs
2025-03-13 15:31:37,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.4597 secs
2025-03-13 15:31:37,897 [INFO]: {
2025-03-13 15:31:37,897 [INFO]: 	index_key: HNSW32
2025-03-13 15:31:37,897 [INFO]: 	index_param: efSearch=113
2025-03-13 15:31:37,897 [INFO]: 	index_path: knn.index
2025-03-13 15:31:37,897 [INFO]: 	size in bytes: 1990454730
2025-03-13 15:31:37,897 [INFO]: 	avg_search_speed_ms: 9.734879993945142
2025-03-13 15:31:37,897 [INFO]: 	99p_search_speed_ms: 16.919427942484617
2025-03-13 15:31:37,897 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:37,897 [INFO]: 	nb vectors: 10110
2025-03-13 15:31:37,897 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:37,897 [INFO]: 	compression ratio: 0.9986194863120549
2025-03-13 15:31:37,897 [INFO]: }
2025-03-13 15:31:37,897 [INFO]: 	>>> Finished "Creating the index" in 146.4630 secs
2025-03-13 15:31:37,897 [INFO]: >>> Finished "Launching the whole pipeline" in 146.5107 secs
2025-03-13 15:31:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 27094 [episode count 5/20]
[retrieval_preprocessing] for episode 83114 [episode count 6/20], we have num_retrieval=np.int64(10240) num_query=np.int64(494)
2025-03-13 15:31:42,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:43,778 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:43
2025-03-13 15:31:43,778 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.47it/s]
2025-03-13 15:31:43,810 [INFO]: There are 10240 embeddings of dim 49152
2025-03-13 15:31:43,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 15:31:43,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:43
2025-03-13 15:31:43,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:43,811 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:31:43,811 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:31:43,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:43,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:43
2025-03-13 15:31:43,811 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:43,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:31:43,811 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:43
2025-03-13 15:31:43,811 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:43,811 [INFO]: 	Creating the index 03/13/2025, 15:31:43
2025-03-13 15:31:43,811 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:31:43
2025-03-13 15:31:43,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:31:43,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:43
2025-03-13 15:31:43,812 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:31:43,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.37it/s] 16%|█▋        | 7/43 [00:00<00:01, 31.63it/s] 30%|███       | 13/43 [00:00<00:00, 40.95it/s] 44%|████▍     | 19/43 [00:00<00:00, 45.73it/s] 56%|█████▌    | 24/43 [00:05<00:06,  2.93it/s] 70%|██████▉   | 30/43 [00:05<00:02,  4.51it/s] 84%|████████▎ | 36/43 [00:05<00:01,  6.61it/s] 98%|█████████▊| 42/43 [00:12<00:00,  2.09it/s]100%|██████████| 43/43 [00:14<00:00,  3.06it/s]
2025-03-13 15:31:57,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:57
2025-03-13 15:33:27,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.2211 secs
2025-03-13 15:33:27,093 [INFO]: The best hyperparameters are: efSearch=116
2025-03-13 15:33:27,093 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 15:34:19,767 [INFO]: 	>>> Finished "Compute fast metrics" in 52.6740 secs
2025-03-13 15:34:19,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.9553 secs
2025-03-13 15:34:19,768 [INFO]: {
2025-03-13 15:34:19,768 [INFO]: 	index_key: HNSW32
2025-03-13 15:34:19,768 [INFO]: 	index_param: efSearch=116
2025-03-13 15:34:19,768 [INFO]: 	index_path: knn.index
2025-03-13 15:34:19,768 [INFO]: 	size in bytes: 2016049122
2025-03-13 15:34:19,768 [INFO]: 	avg_search_speed_ms: 11.24617468782557
2025-03-13 15:34:19,768 [INFO]: 	99p_search_speed_ms: 19.31838463060558
2025-03-13 15:34:19,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:19,768 [INFO]: 	nb vectors: 10240
2025-03-13 15:34:19,768 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:19,768 [INFO]: 	compression ratio: 0.9986194770903007
2025-03-13 15:34:19,768 [INFO]: }
2025-03-13 15:34:19,768 [INFO]: 	>>> Finished "Creating the index" in 155.9567 secs
2025-03-13 15:34:19,768 [INFO]: >>> Finished "Launching the whole pipeline" in 155.9901 secs
2025-03-13 15:34:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 83114 [episode count 6/20]
[retrieval_preprocessing] for episode 76339 [episode count 7/20], we have num_retrieval=np.int64(10263) num_query=np.int64(471)
2025-03-13 15:34:23,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:25,645 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:25
2025-03-13 15:34:25,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1876.65it/s]
2025-03-13 15:34:25,681 [INFO]: There are 10263 embeddings of dim 49152
2025-03-13 15:34:25,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 15:34:25,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:25
2025-03-13 15:34:25,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:25,682 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:34:25,682 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:34:25,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:34:25,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:25
2025-03-13 15:34:25,683 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:25,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:34:25,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:25
2025-03-13 15:34:25,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:34:25,683 [INFO]: 	Creating the index 03/13/2025, 15:34:25
2025-03-13 15:34:25,684 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:34:25
2025-03-13 15:34:25,686 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0020 secs
2025-03-13 15:34:25,686 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:25
2025-03-13 15:34:25,686 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:34:25,686 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.65it/s]  9%|▉         | 4/43 [00:00<00:02, 15.35it/s] 16%|█▋        | 7/43 [00:00<00:01, 20.71it/s] 26%|██▌       | 11/43 [00:00<00:01, 25.98it/s] 35%|███▍      | 15/43 [00:00<00:00, 28.59it/s] 44%|████▍     | 19/43 [00:00<00:00, 30.04it/s] 53%|█████▎    | 23/43 [00:07<00:11,  1.76it/s] 65%|██████▌   | 28/43 [00:07<00:05,  2.78it/s] 77%|███████▋  | 33/43 [00:07<00:02,  4.17it/s] 88%|████████▊ | 38/43 [00:07<00:00,  5.99it/s] 98%|█████████▊| 42/43 [00:15<00:00,  1.44it/s]100%|██████████| 43/43 [00:17<00:00,  2.42it/s]
2025-03-13 15:34:43,463 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:43
2025-03-13 15:36:09,641 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.1781 secs
2025-03-13 15:36:09,642 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 15:36:09,642 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 15:36:57,749 [INFO]: 	>>> Finished "Compute fast metrics" in 48.1069 secs
2025-03-13 15:36:57,749 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.0633 secs
2025-03-13 15:36:57,750 [INFO]: {
2025-03-13 15:36:57,750 [INFO]: 	index_key: HNSW32
2025-03-13 15:36:57,750 [INFO]: 	index_param: efSearch=99
2025-03-13 15:36:57,750 [INFO]: 	index_path: knn.index
2025-03-13 15:36:57,750 [INFO]: 	size in bytes: 2020577270
2025-03-13 15:36:57,750 [INFO]: 	avg_search_speed_ms: 11.643659528095505
2025-03-13 15:36:57,750 [INFO]: 	99p_search_speed_ms: 19.689456662163128
2025-03-13 15:36:57,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:57,750 [INFO]: 	nb vectors: 10263
2025-03-13 15:36:57,750 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:57,750 [INFO]: 	compression ratio: 0.9986195202522495
2025-03-13 15:36:57,750 [INFO]: }
2025-03-13 15:36:57,750 [INFO]: 	>>> Finished "Creating the index" in 152.0662 secs
2025-03-13 15:36:57,750 [INFO]: >>> Finished "Launching the whole pipeline" in 152.1051 secs
2025-03-13 15:36:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 76339 [episode count 7/20]
[retrieval_preprocessing] for episode 28934 [episode count 8/20], we have num_retrieval=np.int64(10284) num_query=np.int64(450)
2025-03-13 15:37:02,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:04,271 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:04
2025-03-13 15:37:04,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1250.17it/s]
2025-03-13 15:37:04,303 [INFO]: There are 10284 embeddings of dim 49152
2025-03-13 15:37:04,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 15:37:04,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:04
2025-03-13 15:37:04,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:04,304 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:37:04,304 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:37:04,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:37:04,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:04
2025-03-13 15:37:04,304 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:04,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:37:04,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:04
2025-03-13 15:37:04,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:04,304 [INFO]: 	Creating the index 03/13/2025, 15:37:04
2025-03-13 15:37:04,304 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:37:04
2025-03-13 15:37:04,305 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:37:04,305 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:04
2025-03-13 15:37:04,305 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:37:04,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.30it/s] 12%|█▏        | 5/43 [00:00<00:01, 20.85it/s] 21%|██        | 9/43 [00:00<00:01, 27.90it/s] 33%|███▎      | 14/43 [00:00<00:00, 34.16it/s] 44%|████▍     | 19/43 [00:00<00:00, 38.48it/s] 53%|█████▎    | 23/43 [00:10<00:16,  1.22it/s] 65%|██████▌   | 28/43 [00:10<00:07,  1.89it/s] 77%|███████▋  | 33/43 [00:10<00:03,  2.81it/s] 86%|████████▌ | 37/43 [00:10<00:01,  3.80it/s] 98%|█████████▊| 42/43 [00:19<00:00,  1.34it/s]100%|██████████| 43/43 [00:20<00:00,  2.05it/s]
2025-03-13 15:37:25,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:25
2025-03-13 15:38:51,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.8772 secs
2025-03-13 15:38:51,425 [INFO]: The best hyperparameters are: efSearch=109
2025-03-13 15:38:51,425 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.44it/s]
2025-03-13 15:39:38,163 [INFO]: 	>>> Finished "Compute fast metrics" in 46.7384 secs
2025-03-13 15:39:38,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 153.8585 secs
2025-03-13 15:39:38,164 [INFO]: {
2025-03-13 15:39:38,164 [INFO]: 	index_key: HNSW32
2025-03-13 15:39:38,164 [INFO]: 	index_param: efSearch=109
2025-03-13 15:39:38,164 [INFO]: 	index_path: knn.index
2025-03-13 15:39:38,164 [INFO]: 	size in bytes: 2024711666
2025-03-13 15:39:38,164 [INFO]: 	avg_search_speed_ms: 13.175875764789259
2025-03-13 15:39:38,164 [INFO]: 	99p_search_speed_ms: 26.351902196183794
2025-03-13 15:39:38,164 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:38,164 [INFO]: 	nb vectors: 10284
2025-03-13 15:39:38,164 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:38,164 [INFO]: 	compression ratio: 0.9986195594923786
2025-03-13 15:39:38,164 [INFO]: }
2025-03-13 15:39:38,164 [INFO]: 	>>> Finished "Creating the index" in 153.8598 secs
2025-03-13 15:39:38,164 [INFO]: >>> Finished "Launching the whole pipeline" in 153.8924 secs
2025-03-13 15:39:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 28934 [episode count 8/20]
[retrieval_preprocessing] for episode 39439 [episode count 9/20], we have num_retrieval=np.int64(10130) num_query=np.int64(604)
2025-03-13 15:39:42,069 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:44,681 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:44
2025-03-13 15:39:44,681 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1985.00it/s]
2025-03-13 15:39:44,715 [INFO]: There are 10130 embeddings of dim 49152
2025-03-13 15:39:44,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 15:39:44,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:44
2025-03-13 15:39:44,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:44,716 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:39:44,716 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:39:44,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:39:44,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:44
2025-03-13 15:39:44,717 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:44,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:39:44,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:44
2025-03-13 15:39:44,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:39:44,717 [INFO]: 	Creating the index 03/13/2025, 15:39:44
2025-03-13 15:39:44,717 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:39:44
2025-03-13 15:39:44,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 15:39:44,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:44
2025-03-13 15:39:44,721 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:39:44,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  7.69it/s] 17%|█▋        | 7/41 [00:00<00:01, 33.01it/s] 32%|███▏      | 13/41 [00:00<00:00, 41.94it/s] 46%|████▋     | 19/41 [00:00<00:00, 46.08it/s] 59%|█████▊    | 24/41 [00:05<00:06,  2.57it/s] 71%|███████   | 29/41 [00:05<00:03,  3.74it/s] 83%|████████▎ | 34/41 [00:06<00:01,  5.30it/s] 95%|█████████▌| 39/41 [00:06<00:00,  7.34it/s]100%|██████████| 41/41 [00:14<00:00,  2.77it/s]
2025-03-13 15:39:59,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:59
2025-03-13 15:41:17,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.7425 secs
2025-03-13 15:41:17,276 [INFO]: The best hyperparameters are: efSearch=96
2025-03-13 15:41:17,276 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-13 15:42:06,693 [INFO]: 	>>> Finished "Compute fast metrics" in 49.4171 secs
2025-03-13 15:42:06,697 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.9764 secs
2025-03-13 15:42:06,697 [INFO]: {
2025-03-13 15:42:06,697 [INFO]: 	index_key: HNSW32
2025-03-13 15:42:06,697 [INFO]: 	index_param: efSearch=96
2025-03-13 15:42:06,697 [INFO]: 	index_path: knn.index
2025-03-13 15:42:06,697 [INFO]: 	size in bytes: 1994392378
2025-03-13 15:42:06,697 [INFO]: 	avg_search_speed_ms: 10.94954598058517
2025-03-13 15:42:06,697 [INFO]: 	99p_search_speed_ms: 27.568437941372395
2025-03-13 15:42:06,697 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:06,697 [INFO]: 	nb vectors: 10130
2025-03-13 15:42:06,697 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:06,697 [INFO]: 	compression ratio: 0.9986194602273997
2025-03-13 15:42:06,697 [INFO]: }
2025-03-13 15:42:06,697 [INFO]: 	>>> Finished "Creating the index" in 141.9800 secs
2025-03-13 15:42:06,697 [INFO]: >>> Finished "Launching the whole pipeline" in 142.0160 secs
2025-03-13 15:42:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 39439 [episode count 9/20]
[retrieval_preprocessing] for episode 12618 [episode count 10/20], we have num_retrieval=np.int64(10221) num_query=np.int64(513)
2025-03-13 15:42:11,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:13,729 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:13
2025-03-13 15:42:13,729 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.38it/s]
2025-03-13 15:42:13,783 [INFO]: There are 10221 embeddings of dim 49152
2025-03-13 15:42:13,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0539 secs
2025-03-13 15:42:13,783 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:13
2025-03-13 15:42:13,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:13,783 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:42:13,783 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:42:13,783 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:42:13,783 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:13
2025-03-13 15:42:13,784 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:13,784 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:42:13,784 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:13
2025-03-13 15:42:13,784 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:13,784 [INFO]: 	Creating the index 03/13/2025, 15:42:13
2025-03-13 15:42:13,784 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:42:13
2025-03-13 15:42:13,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 15:42:13,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:13
2025-03-13 15:42:13,786 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:42:13,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.39it/s] 12%|█▏        | 5/43 [00:00<00:01, 19.59it/s] 21%|██        | 9/43 [00:00<00:01, 26.16it/s] 30%|███       | 13/43 [00:00<00:01, 29.84it/s] 40%|███▉      | 17/43 [00:00<00:00, 32.11it/s] 49%|████▉     | 21/43 [00:08<00:15,  1.41it/s] 58%|█████▊    | 25/43 [00:08<00:08,  2.09it/s] 70%|██████▉   | 30/43 [00:08<00:04,  3.24it/s] 79%|███████▉  | 34/43 [00:08<00:02,  4.47it/s] 91%|█████████ | 39/43 [00:08<00:00,  6.48it/s]100%|██████████| 43/43 [00:18<00:00,  1.21it/s]100%|██████████| 43/43 [00:18<00:00,  2.27it/s]
2025-03-13 15:42:32,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:32
2025-03-13 15:43:56,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.7274 secs
2025-03-13 15:43:56,433 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 15:43:56,433 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s]
2025-03-13 15:44:50,511 [INFO]: 	>>> Finished "Compute fast metrics" in 54.0779 secs
2025-03-13 15:44:50,513 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 156.7268 secs
2025-03-13 15:44:50,513 [INFO]: {
2025-03-13 15:44:50,513 [INFO]: 	index_key: HNSW32
2025-03-13 15:44:50,513 [INFO]: 	index_param: efSearch=112
2025-03-13 15:44:50,513 [INFO]: 	index_path: knn.index
2025-03-13 15:44:50,513 [INFO]: 	size in bytes: 2012308478
2025-03-13 15:44:50,513 [INFO]: 	avg_search_speed_ms: 8.671531901215845
2025-03-13 15:44:50,513 [INFO]: 	99p_search_speed_ms: 15.835060905665161
2025-03-13 15:44:50,513 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:50,513 [INFO]: 	nb vectors: 10221
2025-03-13 15:44:50,513 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:50,513 [INFO]: 	compression ratio: 0.9986194412882655
2025-03-13 15:44:50,513 [INFO]: }
2025-03-13 15:44:50,513 [INFO]: 	>>> Finished "Creating the index" in 156.7287 secs
2025-03-13 15:44:50,513 [INFO]: >>> Finished "Launching the whole pipeline" in 156.7839 secs
2025-03-13 15:44:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 12618 [episode count 10/20]
[retrieval_preprocessing] for episode 82884 [episode count 11/20], we have num_retrieval=np.int64(9976) num_query=np.int64(758)
2025-03-13 15:44:57,834 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:59,475 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:59
2025-03-13 15:44:59,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
2025-03-13 15:44:59,505 [INFO]: There are 9976 embeddings of dim 49152
2025-03-13 15:44:59,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:44:59,505 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:59
2025-03-13 15:44:59,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:59,506 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 15:44:59,506 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:44:59,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:44:59,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:59
2025-03-13 15:44:59,506 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:59,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:44:59,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:59
2025-03-13 15:44:59,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:59,506 [INFO]: 	Creating the index 03/13/2025, 15:44:59
2025-03-13 15:44:59,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:59
2025-03-13 15:44:59,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:44:59,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:59
2025-03-13 15:44:59,509 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:44:59,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:07,  5.22it/s]  5%|▍         | 2/41 [00:00<00:05,  7.25it/s] 10%|▉         | 4/41 [00:00<00:04,  8.82it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.07it/s] 17%|█▋        | 7/41 [00:00<00:03,  9.44it/s] 20%|█▉        | 8/41 [00:00<00:03,  9.42it/s] 22%|██▏       | 9/41 [00:01<00:03,  9.49it/s] 27%|██▋       | 11/41 [00:01<00:02, 10.49it/s] 32%|███▏      | 13/41 [00:01<00:02, 10.65it/s] 37%|███▋      | 15/41 [00:01<00:02, 11.27it/s] 41%|████▏     | 17/41 [00:01<00:01, 12.23it/s] 46%|████▋     | 19/41 [00:01<00:01, 13.24it/s] 51%|█████     | 21/41 [00:05<00:13,  1.51it/s] 56%|█████▌    | 23/41 [00:05<00:08,  2.06it/s] 61%|██████    | 25/41 [00:05<00:05,  2.77it/s] 66%|██████▌   | 27/41 [00:06<00:03,  3.61it/s] 71%|███████   | 29/41 [00:06<00:02,  4.57it/s] 76%|███████▌  | 31/41 [00:06<00:01,  5.61it/s] 80%|████████  | 33/41 [00:06<00:01,  6.69it/s] 85%|████████▌ | 35/41 [00:06<00:00,  7.64it/s] 90%|█████████ | 37/41 [00:07<00:00,  8.49it/s] 95%|█████████▌| 39/41 [00:07<00:00,  8.80it/s]100%|██████████| 41/41 [00:12<00:00,  1.24it/s]100%|██████████| 41/41 [00:12<00:00,  3.40it/s]
2025-03-13 15:45:11,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:11
2025-03-13 15:46:29,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.6285 secs
2025-03-13 15:46:29,315 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:46:29,315 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 15:47:16,251 [INFO]: 	>>> Finished "Compute fast metrics" in 46.9359 secs
2025-03-13 15:47:16,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.3218 secs
2025-03-13 15:47:16,831 [INFO]: {
2025-03-13 15:47:16,831 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:16,831 [INFO]: 	index_param: efSearch=206
2025-03-13 15:47:16,831 [INFO]: 	index_path: knn.index
2025-03-13 15:47:16,831 [INFO]: 	size in bytes: 1962719170
2025-03-13 15:47:16,831 [INFO]: 	avg_search_speed_ms: 10.036019588742091
2025-03-13 15:47:16,831 [INFO]: 	99p_search_speed_ms: 18.737645633518653
2025-03-13 15:47:16,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:16,831 [INFO]: 	nb vectors: 9976
2025-03-13 15:47:16,831 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:16,831 [INFO]: 	compression ratio: 0.9993082240084301
2025-03-13 15:47:16,831 [INFO]: }
2025-03-13 15:47:16,831 [INFO]: 	>>> Finished "Creating the index" in 137.3248 secs
2025-03-13 15:47:16,831 [INFO]: >>> Finished "Launching the whole pipeline" in 137.3564 secs
2025-03-13 15:47:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 82884 [episode count 11/20]
[retrieval_preprocessing] for episode 11213 [episode count 12/20], we have num_retrieval=np.int64(10278) num_query=np.int64(456)
2025-03-13 15:47:28,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:30,378 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:30
2025-03-13 15:47:30,378 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.74it/s]
2025-03-13 15:47:30,406 [INFO]: There are 10278 embeddings of dim 49152
2025-03-13 15:47:30,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:47:30,407 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:30
2025-03-13 15:47:30,407 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:30,407 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:47:30,407 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:47:30,407 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:30,407 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:30
2025-03-13 15:47:30,407 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:30,407 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:47:30,407 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:30
2025-03-13 15:47:30,407 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:30,407 [INFO]: 	Creating the index 03/13/2025, 15:47:30
2025-03-13 15:47:30,407 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:47:30
2025-03-13 15:47:30,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 15:47:30,409 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:30
2025-03-13 15:47:30,409 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:47:30,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:12,  3.39it/s]  5%|▍         | 2/43 [00:00<00:16,  2.54it/s] 14%|█▍        | 6/43 [00:00<00:04,  8.52it/s] 21%|██        | 9/43 [00:01<00:04,  7.00it/s] 26%|██▌       | 11/43 [00:02<00:06,  5.26it/s] 28%|██▊       | 12/43 [00:02<00:05,  5.65it/s] 33%|███▎      | 14/43 [00:02<00:04,  6.40it/s] 35%|███▍      | 15/43 [00:02<00:04,  6.13it/s] 37%|███▋      | 16/43 [00:02<00:04,  5.86it/s] 40%|███▉      | 17/43 [00:02<00:04,  5.64it/s] 42%|████▏     | 18/43 [00:03<00:04,  5.55it/s] 44%|████▍     | 19/43 [00:03<00:04,  5.45it/s] 47%|████▋     | 20/43 [00:03<00:04,  5.38it/s] 49%|████▉     | 21/43 [00:09<00:37,  1.73s/it] 51%|█████     | 22/43 [00:09<00:26,  1.28s/it] 53%|█████▎    | 23/43 [00:09<00:19,  1.05it/s] 56%|█████▌    | 24/43 [00:09<00:13,  1.38it/s] 60%|██████    | 26/43 [00:09<00:07,  2.29it/s] 65%|██████▌   | 28/43 [00:10<00:04,  3.37it/s] 67%|██████▋   | 29/43 [00:10<00:03,  3.89it/s] 70%|██████▉   | 30/43 [00:10<00:02,  4.47it/s] 72%|███████▏  | 31/43 [00:10<00:02,  5.09it/s] 74%|███████▍  | 32/43 [00:10<00:01,  5.55it/s] 77%|███████▋  | 33/43 [00:10<00:01,  5.99it/s] 79%|███████▉  | 34/43 [00:10<00:01,  6.64it/s] 81%|████████▏ | 35/43 [00:10<00:01,  6.88it/s] 84%|████████▎ | 36/43 [00:10<00:00,  7.44it/s] 86%|████████▌ | 37/43 [00:11<00:00,  7.00it/s] 88%|████████▊ | 38/43 [00:11<00:00,  6.36it/s] 91%|█████████ | 39/43 [00:11<00:00,  7.07it/s] 93%|█████████▎| 40/43 [00:11<00:00,  7.29it/s] 95%|█████████▌| 41/43 [00:11<00:00,  7.38it/s] 98%|█████████▊| 42/43 [00:20<00:02,  2.74s/it]100%|██████████| 43/43 [00:22<00:00,  2.62s/it]100%|██████████| 43/43 [00:22<00:00,  1.88it/s]
2025-03-13 15:47:53,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:53
2025-03-13 15:49:08,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.2056 secs
2025-03-13 15:49:08,507 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 15:49:08,507 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.98it/s]
2025-03-13 15:50:16,422 [INFO]: 	>>> Finished "Compute fast metrics" in 67.9148 secs
2025-03-13 15:50:16,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 166.0135 secs
2025-03-13 15:50:16,422 [INFO]: {
2025-03-13 15:50:16,422 [INFO]: 	index_key: HNSW32
2025-03-13 15:50:16,422 [INFO]: 	index_param: efSearch=143
2025-03-13 15:50:16,422 [INFO]: 	index_path: knn.index
2025-03-13 15:50:16,422 [INFO]: 	size in bytes: 2023530410
2025-03-13 15:50:16,422 [INFO]: 	avg_search_speed_ms: 11.496616718252243
2025-03-13 15:50:16,422 [INFO]: 	99p_search_speed_ms: 20.616316443774835
2025-03-13 15:50:16,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:16,422 [INFO]: 	nb vectors: 10278
2025-03-13 15:50:16,422 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:16,422 [INFO]: 	compression ratio: 0.9986195482972752
2025-03-13 15:50:16,422 [INFO]: }
2025-03-13 15:50:16,422 [INFO]: 	>>> Finished "Creating the index" in 166.0151 secs
2025-03-13 15:50:16,422 [INFO]: >>> Finished "Launching the whole pipeline" in 166.0442 secs
2025-03-13 15:50:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 11213 [episode count 12/20]
[retrieval_preprocessing] for episode 90721 [episode count 13/20], we have num_retrieval=np.int64(10190) num_query=np.int64(544)
2025-03-13 15:50:26,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:28,983 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:28
2025-03-13 15:50:28,983 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1045.70it/s]
2025-03-13 15:50:29,014 [INFO]: There are 10190 embeddings of dim 49152
2025-03-13 15:50:29,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 15:50:29,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:29
2025-03-13 15:50:29,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:29,015 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:50:29,015 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:50:29,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:50:29,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:29
2025-03-13 15:50:29,016 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:29,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:50:29,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:29
2025-03-13 15:50:29,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:50:29,017 [INFO]: 	Creating the index 03/13/2025, 15:50:29
2025-03-13 15:50:29,017 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:50:29
2025-03-13 15:50:29,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 15:50:29,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:29
2025-03-13 15:50:29,020 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:50:29,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.30it/s]  5%|▍         | 2/43 [00:00<00:06,  6.41it/s]  7%|▋         | 3/43 [00:00<00:05,  7.50it/s]  9%|▉         | 4/43 [00:00<00:04,  8.20it/s] 12%|█▏        | 5/43 [00:00<00:04,  8.74it/s] 14%|█▍        | 6/43 [00:00<00:04,  9.06it/s] 19%|█▊        | 8/43 [00:00<00:03,  9.49it/s] 21%|██        | 9/43 [00:01<00:03,  9.45it/s] 23%|██▎       | 10/43 [00:01<00:03,  9.48it/s] 26%|██▌       | 11/43 [00:01<00:03,  9.58it/s] 30%|███       | 13/43 [00:01<00:02, 10.19it/s] 35%|███▍      | 15/43 [00:01<00:02, 10.38it/s] 40%|███▉      | 17/43 [00:01<00:02, 10.66it/s] 44%|████▍     | 19/43 [00:01<00:02, 10.83it/s] 49%|████▉     | 21/43 [00:08<00:25,  1.14s/it] 51%|█████     | 22/43 [00:08<00:19,  1.06it/s] 56%|█████▌    | 24/43 [00:08<00:12,  1.54it/s] 60%|██████    | 26/43 [00:09<00:07,  2.17it/s] 63%|██████▎   | 27/43 [00:09<00:06,  2.55it/s] 65%|██████▌   | 28/43 [00:09<00:04,  3.03it/s] 67%|██████▋   | 29/43 [00:09<00:03,  3.60it/s] 72%|███████▏  | 31/43 [00:09<00:02,  4.92it/s] 77%|███████▋  | 33/43 [00:09<00:01,  6.26it/s] 81%|████████▏ | 35/43 [00:09<00:01,  7.41it/s] 86%|████████▌ | 37/43 [00:10<00:00,  8.50it/s] 91%|█████████ | 39/43 [00:10<00:00,  9.04it/s] 95%|█████████▌| 41/43 [00:10<00:00,  9.87it/s]100%|██████████| 43/43 [00:21<00:00,  1.78s/it]100%|██████████| 43/43 [00:21<00:00,  2.00it/s]
2025-03-13 15:50:50,557 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:50
2025-03-13 15:52:27,288 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.7305 secs
2025-03-13 15:52:27,289 [INFO]: The best hyperparameters are: efSearch=98
2025-03-13 15:52:27,289 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.63it/s]
2025-03-13 15:53:09,831 [INFO]: 	>>> Finished "Compute fast metrics" in 42.5416 secs
2025-03-13 15:53:09,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.8112 secs
2025-03-13 15:53:09,832 [INFO]: {
2025-03-13 15:53:09,832 [INFO]: 	index_key: HNSW32
2025-03-13 15:53:09,832 [INFO]: 	index_param: efSearch=98
2025-03-13 15:53:09,832 [INFO]: 	index_path: knn.index
2025-03-13 15:53:09,832 [INFO]: 	size in bytes: 2006205194
2025-03-13 15:53:09,832 [INFO]: 	avg_search_speed_ms: 11.821760899215567
2025-03-13 15:53:09,832 [INFO]: 	99p_search_speed_ms: 21.059694443829347
2025-03-13 15:53:09,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:09,832 [INFO]: 	nb vectors: 10190
2025-03-13 15:53:09,832 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:09,832 [INFO]: 	compression ratio: 0.9986194463017625
2025-03-13 15:53:09,832 [INFO]: }
2025-03-13 15:53:09,832 [INFO]: 	>>> Finished "Creating the index" in 160.8149 secs
2025-03-13 15:53:09,832 [INFO]: >>> Finished "Launching the whole pipeline" in 160.8491 secs
2025-03-13 15:53:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 90721 [episode count 13/20]
[retrieval_preprocessing] for episode 87509 [episode count 14/20], we have num_retrieval=np.int64(10291) num_query=np.int64(443)
2025-03-13 15:53:25,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:26,976 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:26
2025-03-13 15:53:26,976 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 15:53:27,004 [INFO]: There are 10291 embeddings of dim 49152
2025-03-13 15:53:27,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:53:27,005 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:27,005 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:53:27,005 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:53:27,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:27,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,005 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:27,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:53:27,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:27
2025-03-13 15:53:27,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:27,005 [INFO]: 	Creating the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,005 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:53:27
2025-03-13 15:53:27,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 15:53:27,007 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:27
2025-03-13 15:53:27,007 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:53:27,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:11,  3.71it/s]  5%|▍         | 2/43 [00:00<00:08,  5.11it/s]  7%|▋         | 3/43 [00:00<00:06,  5.89it/s]  9%|▉         | 4/43 [00:00<00:06,  6.27it/s] 12%|█▏        | 5/43 [00:00<00:05,  6.47it/s] 14%|█▍        | 6/43 [00:00<00:05,  6.55it/s] 16%|█▋        | 7/43 [00:01<00:05,  6.55it/s] 19%|█▊        | 8/43 [00:01<00:05,  6.73it/s] 21%|██        | 9/43 [00:01<00:04,  6.90it/s] 23%|██▎       | 10/43 [00:01<00:04,  6.96it/s] 26%|██▌       | 11/43 [00:01<00:04,  7.21it/s] 28%|██▊       | 12/43 [00:01<00:04,  7.40it/s] 30%|███       | 13/43 [00:01<00:03,  7.62it/s] 33%|███▎      | 14/43 [00:02<00:03,  7.89it/s] 35%|███▍      | 15/43 [00:02<00:03,  8.13it/s] 37%|███▋      | 16/43 [00:02<00:03,  8.30it/s] 40%|███▉      | 17/43 [00:02<00:03,  8.39it/s] 42%|████▏     | 18/43 [00:02<00:03,  8.31it/s] 44%|████▍     | 19/43 [00:02<00:02,  8.26it/s] 47%|████▋     | 20/43 [00:02<00:02,  8.09it/s] 49%|████▉     | 21/43 [00:09<00:46,  2.11s/it] 51%|█████     | 22/43 [00:10<00:39,  1.88s/it] 53%|█████▎    | 23/43 [00:13<00:39,  1.96s/it] 56%|█████▌    | 24/43 [00:13<00:29,  1.54s/it] 60%|██████    | 26/43 [00:13<00:14,  1.18it/s] 65%|██████▌   | 28/43 [00:13<00:08,  1.83it/s] 67%|██████▋   | 29/43 [00:13<00:06,  2.24it/s] 70%|██████▉   | 30/43 [00:14<00:04,  2.74it/s] 72%|███████▏  | 31/43 [00:14<00:03,  3.35it/s] 74%|███████▍  | 32/43 [00:14<00:02,  4.06it/s] 79%|███████▉  | 34/43 [00:14<00:01,  5.62it/s] 84%|████████▎ | 36/43 [00:14<00:01,  6.33it/s] 86%|████████▌ | 37/43 [00:14<00:00,  6.69it/s] 93%|█████████▎| 40/43 [00:14<00:00, 10.37it/s] 98%|█████████▊| 42/43 [00:23<00:01,  1.36s/it]100%|██████████| 43/43 [00:25<00:00,  1.48s/it]100%|██████████| 43/43 [00:25<00:00,  1.71it/s]
2025-03-13 15:53:52,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:52
2025-03-13 15:55:12,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.9267 secs
2025-03-13 15:55:12,117 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 15:55:12,117 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.61s/it] 50%|█████     | 2/4 [00:01<00:01,  1.37it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.60it/s]
2025-03-13 15:55:47,761 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6439 secs
2025-03-13 15:55:48,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.2092 secs
2025-03-13 15:55:48,216 [INFO]: {
2025-03-13 15:55:48,216 [INFO]: 	index_key: HNSW32
2025-03-13 15:55:48,217 [INFO]: 	index_param: efSearch=106
2025-03-13 15:55:48,217 [INFO]: 	index_path: knn.index
2025-03-13 15:55:48,217 [INFO]: 	size in bytes: 2026089926
2025-03-13 15:55:48,217 [INFO]: 	avg_search_speed_ms: 12.931826869471033
2025-03-13 15:55:48,217 [INFO]: 	99p_search_speed_ms: 26.245207514148206
2025-03-13 15:55:48,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:48,217 [INFO]: 	nb vectors: 10291
2025-03-13 15:55:48,217 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:48,217 [INFO]: 	compression ratio: 0.9986195094481705
2025-03-13 15:55:48,217 [INFO]: }
2025-03-13 15:55:48,217 [INFO]: 	>>> Finished "Creating the index" in 141.2119 secs
2025-03-13 15:55:48,217 [INFO]: >>> Finished "Launching the whole pipeline" in 141.2415 secs
2025-03-13 15:55:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 87509 [episode count 14/20]
[retrieval_preprocessing] for episode 13360 [episode count 15/20], we have num_retrieval=np.int64(10235) num_query=np.int64(499)
2025-03-13 15:55:55,971 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:58,412 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:58
2025-03-13 15:55:58,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 955.86it/s]
2025-03-13 15:55:58,438 [INFO]: There are 10235 embeddings of dim 49152
2025-03-13 15:55:58,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:55:58,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:58
2025-03-13 15:55:58,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:58,439 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:55:58,439 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:55:58,439 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:58,439 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:58
2025-03-13 15:55:58,439 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:58,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:55:58,439 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:58
2025-03-13 15:55:58,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:58,439 [INFO]: 	Creating the index 03/13/2025, 15:55:58
2025-03-13 15:55:58,439 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:55:58
2025-03-13 15:55:58,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:55:58,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:58
2025-03-13 15:55:58,440 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:55:58,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.27it/s]  5%|▍         | 2/43 [00:00<00:06,  6.41it/s]  7%|▋         | 3/43 [00:00<00:05,  7.64it/s]  9%|▉         | 4/43 [00:00<00:04,  8.37it/s] 12%|█▏        | 5/43 [00:00<00:04,  8.82it/s] 16%|█▋        | 7/43 [00:00<00:03,  9.41it/s] 19%|█▊        | 8/43 [00:00<00:03,  9.49it/s] 21%|██        | 9/43 [00:01<00:03,  9.52it/s] 23%|██▎       | 10/43 [00:01<00:03,  9.50it/s] 26%|██▌       | 11/43 [00:01<00:03,  9.46it/s] 28%|██▊       | 12/43 [00:01<00:03,  9.57it/s] 30%|███       | 13/43 [00:01<00:03,  9.59it/s] 33%|███▎      | 14/43 [00:01<00:03,  9.57it/s] 35%|███▍      | 15/43 [00:01<00:02,  9.51it/s] 37%|███▋      | 16/43 [00:01<00:02,  9.55it/s] 40%|███▉      | 17/43 [00:01<00:02,  9.57it/s] 42%|████▏     | 18/43 [00:01<00:02,  9.62it/s] 44%|████▍     | 19/43 [00:02<00:02,  9.55it/s] 47%|████▋     | 20/43 [00:02<00:02,  9.58it/s] 49%|████▉     | 21/43 [00:08<00:42,  1.93s/it] 53%|█████▎    | 23/43 [00:08<00:21,  1.09s/it] 58%|█████▊    | 25/43 [00:08<00:12,  1.45it/s] 63%|██████▎   | 27/43 [00:08<00:07,  2.11it/s] 67%|██████▋   | 29/43 [00:09<00:04,  2.92it/s] 72%|███████▏  | 31/43 [00:09<00:03,  3.80it/s] 77%|███████▋  | 33/43 [00:09<00:02,  4.75it/s] 81%|████████▏ | 35/43 [00:09<00:01,  5.74it/s] 86%|████████▌ | 37/43 [00:09<00:00,  6.61it/s] 91%|█████████ | 39/43 [00:10<00:00,  7.40it/s] 95%|█████████▌| 41/43 [00:10<00:00,  7.98it/s] 98%|█████████▊| 42/43 [00:20<00:00,  7.98it/s]100%|██████████| 43/43 [00:21<00:00,  1.84s/it]100%|██████████| 43/43 [00:21<00:00,  1.96it/s]
2025-03-13 15:56:20,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:20
2025-03-13 15:57:34,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.0596 secs
2025-03-13 15:57:34,432 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 15:57:34,432 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.79it/s] 50%|█████     | 2/4 [00:00<00:00,  3.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.58it/s]
2025-03-13 15:58:23,107 [INFO]: 	>>> Finished "Compute fast metrics" in 48.6753 secs
2025-03-13 15:58:23,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.6689 secs
2025-03-13 15:58:23,110 [INFO]: {
2025-03-13 15:58:23,110 [INFO]: 	index_key: HNSW32
2025-03-13 15:58:23,110 [INFO]: 	index_param: efSearch=112
2025-03-13 15:58:23,110 [INFO]: 	index_path: knn.index
2025-03-13 15:58:23,110 [INFO]: 	size in bytes: 2015064742
2025-03-13 15:58:23,110 [INFO]: 	avg_search_speed_ms: 8.682621156468587
2025-03-13 15:58:23,110 [INFO]: 	99p_search_speed_ms: 12.836387164425105
2025-03-13 15:58:23,110 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:23,110 [INFO]: 	nb vectors: 10235
2025-03-13 15:58:23,110 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:23,110 [INFO]: 	compression ratio: 0.9986194676815997
2025-03-13 15:58:23,110 [INFO]: }
2025-03-13 15:58:23,110 [INFO]: 	>>> Finished "Creating the index" in 144.6706 secs
2025-03-13 15:58:23,110 [INFO]: >>> Finished "Launching the whole pipeline" in 144.6977 secs
2025-03-13 15:58:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 13360 [episode count 15/20]
[retrieval_preprocessing] for episode 80954 [episode count 16/20], we have num_retrieval=np.int64(10085) num_query=np.int64(649)
2025-03-13 15:58:30,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:33,248 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:33
2025-03-13 15:58:33,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 982.96it/s]
2025-03-13 15:58:33,276 [INFO]: There are 10085 embeddings of dim 49152
2025-03-13 15:58:33,276 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:58:33,276 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:33,276 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 15:58:33,276 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:58:33,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:58:33,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,277 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:33,277 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:58:33,277 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:33
2025-03-13 15:58:33,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:33,277 [INFO]: 	Creating the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,277 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:58:33
2025-03-13 15:58:33,278 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:58:33,278 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,278 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:58:33,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.95it/s]  7%|▋         | 3/41 [00:00<00:04,  8.85it/s] 10%|▉         | 4/41 [00:00<00:04,  9.05it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.26it/s] 15%|█▍        | 6/41 [00:00<00:03,  9.40it/s] 20%|█▉        | 8/41 [00:00<00:03,  9.76it/s] 24%|██▍       | 10/41 [00:01<00:03, 10.02it/s] 27%|██▋       | 11/41 [00:01<00:03,  9.97it/s] 29%|██▉       | 12/41 [00:01<00:02,  9.86it/s] 32%|███▏      | 13/41 [00:01<00:02,  9.63it/s] 34%|███▍      | 14/41 [00:01<00:02,  9.54it/s] 37%|███▋      | 15/41 [00:01<00:02,  9.57it/s] 39%|███▉      | 16/41 [00:01<00:02,  9.56it/s] 41%|████▏     | 17/41 [00:01<00:02,  9.58it/s] 44%|████▍     | 18/41 [00:01<00:02,  9.63it/s] 46%|████▋     | 19/41 [00:02<00:02,  9.69it/s] 51%|█████     | 21/41 [00:07<00:25,  1.29s/it] 56%|█████▌    | 23/41 [00:07<00:14,  1.23it/s] 61%|██████    | 25/41 [00:07<00:08,  1.84it/s] 66%|██████▌   | 27/41 [00:07<00:05,  2.61it/s] 71%|███████   | 29/41 [00:07<00:03,  3.59it/s] 76%|███████▌  | 31/41 [00:08<00:02,  4.76it/s] 80%|████████  | 33/41 [00:08<00:01,  6.18it/s] 85%|████████▌ | 35/41 [00:08<00:00,  7.74it/s] 90%|█████████ | 37/41 [00:08<00:00,  9.31it/s] 95%|█████████▌| 39/41 [00:08<00:00, 10.02it/s]100%|██████████| 41/41 [00:16<00:00,  1.22s/it]100%|██████████| 41/41 [00:16<00:00,  2.53it/s]
2025-03-13 15:58:49,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:49
2025-03-13 16:00:07,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.9707 secs
2025-03-13 16:00:07,477 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 16:00:07,477 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 16:01:12,833 [INFO]: 	>>> Finished "Compute fast metrics" in 65.3562 secs
2025-03-13 16:01:12,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 159.5590 secs
2025-03-13 16:01:12,837 [INFO]: {
2025-03-13 16:01:12,837 [INFO]: 	index_key: HNSW32
2025-03-13 16:01:12,837 [INFO]: 	index_param: efSearch=137
2025-03-13 16:01:12,837 [INFO]: 	index_path: knn.index
2025-03-13 16:01:12,837 [INFO]: 	size in bytes: 1985532830
2025-03-13 16:01:12,837 [INFO]: 	avg_search_speed_ms: 11.265533042312306
2025-03-13 16:01:12,837 [INFO]: 	99p_search_speed_ms: 21.82324819965288
2025-03-13 16:01:12,837 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:12,837 [INFO]: 	nb vectors: 10085
2025-03-13 16:01:12,837 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:12,837 [INFO]: 	compression ratio: 0.9986194385917054
2025-03-13 16:01:12,837 [INFO]: }
2025-03-13 16:01:12,837 [INFO]: 	>>> Finished "Creating the index" in 159.5604 secs
2025-03-13 16:01:12,837 [INFO]: >>> Finished "Launching the whole pipeline" in 159.5887 secs
2025-03-13 16:01:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 80954 [episode count 16/20]
[retrieval_preprocessing] for episode 65112 [episode count 17/20], we have num_retrieval=np.int64(10227) num_query=np.int64(507)
2025-03-13 16:01:20,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:21,660 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:21
2025-03-13 16:01:21,660 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 941.91it/s]
2025-03-13 16:01:21,688 [INFO]: There are 10227 embeddings of dim 49152
2025-03-13 16:01:21,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 16:01:21,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:21
2025-03-13 16:01:21,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:21,689 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 16:01:21,689 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:01:21,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:01:21,690 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:21
2025-03-13 16:01:21,690 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:21,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:01:21,690 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:21
2025-03-13 16:01:21,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:01:21,691 [INFO]: 	Creating the index 03/13/2025, 16:01:21
2025-03-13 16:01:21,691 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:01:21
2025-03-13 16:01:21,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 16:01:21,694 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:21
2025-03-13 16:01:21,694 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:01:21,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:09,  4.23it/s]  5%|▍         | 2/43 [00:00<00:06,  6.02it/s]  7%|▋         | 3/43 [00:00<00:05,  6.96it/s]  9%|▉         | 4/43 [00:00<00:05,  7.53it/s] 12%|█▏        | 5/43 [00:00<00:04,  7.78it/s] 14%|█▍        | 6/43 [00:00<00:04,  7.97it/s] 16%|█▋        | 7/43 [00:00<00:04,  8.13it/s] 19%|█▊        | 8/43 [00:01<00:04,  8.24it/s] 21%|██        | 9/43 [00:01<00:04,  8.32it/s] 23%|██▎       | 10/43 [00:01<00:03,  8.66it/s] 26%|██▌       | 11/43 [00:01<00:03,  8.58it/s] 28%|██▊       | 12/43 [00:01<00:03,  8.53it/s] 30%|███       | 13/43 [00:01<00:03,  8.55it/s] 33%|███▎      | 14/43 [00:01<00:03,  8.90it/s] 35%|███▍      | 15/43 [00:01<00:03,  8.94it/s] 37%|███▋      | 16/43 [00:01<00:03,  8.79it/s] 40%|███▉      | 17/43 [00:02<00:02,  8.73it/s] 42%|████▏     | 18/43 [00:02<00:02,  8.87it/s] 47%|████▋     | 20/43 [00:02<00:02, 10.22it/s] 49%|████▉     | 21/43 [00:07<00:28,  1.30s/it] 51%|█████     | 22/43 [00:07<00:20,  1.01it/s] 56%|█████▌    | 24/43 [00:07<00:11,  1.66it/s] 60%|██████    | 26/43 [00:07<00:06,  2.44it/s] 65%|██████▌   | 28/43 [00:07<00:04,  3.32it/s] 67%|██████▋   | 29/43 [00:08<00:03,  3.83it/s] 72%|███████▏  | 31/43 [00:08<00:02,  5.02it/s] 77%|███████▋  | 33/43 [00:08<00:01,  6.14it/s] 81%|████████▏ | 35/43 [00:08<00:01,  7.11it/s] 86%|████████▌ | 37/43 [00:08<00:00,  7.90it/s] 91%|█████████ | 39/43 [00:09<00:00,  8.49it/s] 95%|█████████▌| 41/43 [00:09<00:00,  8.93it/s]100%|██████████| 43/43 [00:16<00:00,  1.26s/it]100%|██████████| 43/43 [00:16<00:00,  2.54it/s]
2025-03-13 16:01:38,620 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:38
2025-03-13 16:02:57,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.8792 secs
2025-03-13 16:02:57,500 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 16:02:57,500 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 16:04:23,414 [INFO]: 	>>> Finished "Compute fast metrics" in 85.9140 secs
2025-03-13 16:04:23,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 181.7202 secs
2025-03-13 16:04:23,415 [INFO]: {
2025-03-13 16:04:23,415 [INFO]: 	index_key: HNSW32
2025-03-13 16:04:23,415 [INFO]: 	index_param: efSearch=106
2025-03-13 16:04:23,415 [INFO]: 	index_path: knn.index
2025-03-13 16:04:23,415 [INFO]: 	size in bytes: 2013489734
2025-03-13 16:04:23,415 [INFO]: 	avg_search_speed_ms: 9.28599188344669
2025-03-13 16:04:23,415 [INFO]: 	99p_search_speed_ms: 18.39745587669313
2025-03-13 16:04:23,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:23,415 [INFO]: 	nb vectors: 10227
2025-03-13 16:04:23,415 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:23,415 [INFO]: 	compression ratio: 0.9986194526085426
2025-03-13 16:04:23,415 [INFO]: }
2025-03-13 16:04:23,415 [INFO]: 	>>> Finished "Creating the index" in 181.7238 secs
2025-03-13 16:04:23,415 [INFO]: >>> Finished "Launching the whole pipeline" in 181.7550 secs
2025-03-13 16:04:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 65112 [episode count 17/20]
[retrieval_preprocessing] for episode 81537 [episode count 18/20], we have num_retrieval=np.int64(10138) num_query=np.int64(596)
2025-03-13 16:04:34,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:36,070 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:36
2025-03-13 16:04:36,070 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1669.04it/s]
2025-03-13 16:04:36,096 [INFO]: There are 10138 embeddings of dim 49152
2025-03-13 16:04:36,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 16:04:36,096 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:36,096 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 16:04:36,096 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:04:36,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:04:36,096 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,096 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:36,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:04:36,097 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:36
2025-03-13 16:04:36,097 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:36,097 [INFO]: 	Creating the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,097 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:04:36
2025-03-13 16:04:36,098 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:04:36,098 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,098 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:04:36,098 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.93it/s]  7%|▋         | 3/41 [00:00<00:04,  8.45it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.37it/s] 15%|█▍        | 6/41 [00:00<00:03,  8.98it/s] 17%|█▋        | 7/41 [00:00<00:03,  8.71it/s] 20%|█▉        | 8/41 [00:00<00:03,  8.87it/s] 22%|██▏       | 9/41 [00:01<00:03,  8.98it/s] 24%|██▍       | 10/41 [00:01<00:03,  9.16it/s] 27%|██▋       | 11/41 [00:01<00:03,  9.11it/s] 29%|██▉       | 12/41 [00:01<00:03,  9.31it/s] 32%|███▏      | 13/41 [00:01<00:02,  9.36it/s] 34%|███▍      | 14/41 [00:01<00:02,  9.40it/s] 37%|███▋      | 15/41 [00:01<00:02,  9.42it/s] 39%|███▉      | 16/41 [00:01<00:02,  9.34it/s] 41%|████▏     | 17/41 [00:01<00:02,  9.38it/s] 44%|████▍     | 18/41 [00:01<00:02,  9.29it/s] 46%|████▋     | 19/41 [00:02<00:02,  8.94it/s] 49%|████▉     | 20/41 [00:02<00:02,  8.98it/s] 51%|█████     | 21/41 [00:09<00:44,  2.22s/it] 54%|█████▎    | 22/41 [00:09<00:30,  1.62s/it] 56%|█████▌    | 23/41 [00:09<00:21,  1.20s/it] 59%|█████▊    | 24/41 [00:09<00:14,  1.14it/s] 61%|██████    | 25/41 [00:10<00:10,  1.54it/s] 63%|██████▎   | 26/41 [00:10<00:07,  2.05it/s] 66%|██████▌   | 27/41 [00:10<00:05,  2.68it/s] 68%|██████▊   | 28/41 [00:10<00:03,  3.40it/s] 71%|███████   | 29/41 [00:10<00:02,  4.20it/s] 73%|███████▎  | 30/41 [00:10<00:02,  5.01it/s] 76%|███████▌  | 31/41 [00:10<00:01,  5.87it/s] 78%|███████▊  | 32/41 [00:10<00:01,  6.60it/s] 80%|████████  | 33/41 [00:10<00:01,  7.25it/s] 83%|████████▎ | 34/41 [00:11<00:00,  7.77it/s] 85%|████████▌ | 35/41 [00:11<00:00,  8.28it/s] 90%|█████████ | 37/41 [00:11<00:00,  8.60it/s] 93%|█████████▎| 38/41 [00:11<00:00,  8.90it/s] 98%|█████████▊| 40/41 [00:11<00:00,  9.38it/s]100%|██████████| 41/41 [00:19<00:00,  1.90s/it]100%|██████████| 41/41 [00:19<00:00,  2.09it/s]
2025-03-13 16:04:55,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:55
2025-03-13 16:06:10,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.9564 secs
2025-03-13 16:06:10,664 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 16:06:10,664 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 16:07:11,201 [INFO]: 	>>> Finished "Compute fast metrics" in 60.5368 secs
2025-03-13 16:07:11,204 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.1061 secs
2025-03-13 16:07:11,204 [INFO]: {
2025-03-13 16:07:11,204 [INFO]: 	index_key: HNSW32
2025-03-13 16:07:11,204 [INFO]: 	index_param: efSearch=148
2025-03-13 16:07:11,204 [INFO]: 	index_path: knn.index
2025-03-13 16:07:11,204 [INFO]: 	size in bytes: 1995967386
2025-03-13 16:07:11,204 [INFO]: 	avg_search_speed_ms: 11.402197833414037
2025-03-13 16:07:11,204 [INFO]: 	99p_search_speed_ms: 23.030124958604574
2025-03-13 16:07:11,204 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:11,204 [INFO]: 	nb vectors: 10138
2025-03-13 16:07:11,204 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:11,204 [INFO]: 	compression ratio: 0.9986194754386633
2025-03-13 16:07:11,204 [INFO]: }
2025-03-13 16:07:11,204 [INFO]: 	>>> Finished "Creating the index" in 155.1075 secs
2025-03-13 16:07:11,204 [INFO]: >>> Finished "Launching the whole pipeline" in 155.1344 secs
2025-03-13 16:07:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 81537 [episode count 18/20]
[retrieval_preprocessing] for episode 57027 [episode count 19/20], we have num_retrieval=np.int64(10277) num_query=np.int64(457)
2025-03-13 16:07:19,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:21,807 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:21
2025-03-13 16:07:21,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.56it/s]
2025-03-13 16:07:21,833 [INFO]: There are 10277 embeddings of dim 49152
2025-03-13 16:07:21,834 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:07:21,834 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:21
2025-03-13 16:07:21,834 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:21,834 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 16:07:21,834 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:07:21,834 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:21,834 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:21
2025-03-13 16:07:21,834 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:21,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:21,834 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:21
2025-03-13 16:07:21,834 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:21,834 [INFO]: 	Creating the index 03/13/2025, 16:07:21
2025-03-13 16:07:21,834 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:07:21
2025-03-13 16:07:21,835 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 16:07:21,835 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:21
2025-03-13 16:07:21,836 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 16:07:21,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:11,  3.53it/s]  5%|▍         | 2/43 [00:00<00:08,  5.00it/s]  7%|▋         | 3/43 [00:00<00:06,  5.86it/s]  9%|▉         | 4/43 [00:00<00:06,  6.22it/s] 12%|█▏        | 5/43 [00:00<00:05,  6.48it/s] 14%|█▍        | 6/43 [00:00<00:05,  6.61it/s] 16%|█▋        | 7/43 [00:01<00:05,  6.77it/s] 19%|█▊        | 8/43 [00:01<00:05,  6.91it/s] 21%|██        | 9/43 [00:01<00:04,  7.13it/s] 23%|██▎       | 10/43 [00:01<00:04,  7.20it/s] 26%|██▌       | 11/43 [00:01<00:04,  7.24it/s] 28%|██▊       | 12/43 [00:01<00:04,  7.32it/s] 30%|███       | 13/43 [00:01<00:04,  7.32it/s] 33%|███▎      | 14/43 [00:02<00:03,  7.88it/s] 35%|███▍      | 15/43 [00:02<00:03,  8.21it/s] 37%|███▋      | 16/43 [00:02<00:03,  8.48it/s] 40%|███▉      | 17/43 [00:02<00:02,  8.73it/s] 42%|████▏     | 18/43 [00:02<00:02,  9.05it/s] 47%|████▋     | 20/43 [00:02<00:02,  9.64it/s] 49%|████▉     | 21/43 [00:08<00:31,  1.41s/it] 53%|█████▎    | 23/43 [00:08<00:17,  1.16it/s] 58%|█████▊    | 25/43 [00:08<00:10,  1.74it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.47it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.35it/s] 72%|███████▏  | 31/43 [00:08<00:02,  4.33it/s] 77%|███████▋  | 33/43 [00:09<00:01,  5.36it/s] 81%|████████▏ | 35/43 [00:09<00:01,  6.33it/s] 86%|████████▌ | 37/43 [00:09<00:00,  7.27it/s] 91%|█████████ | 39/43 [00:09<00:00,  8.09it/s] 95%|█████████▌| 41/43 [00:09<00:00,  8.78it/s]100%|██████████| 43/43 [00:17<00:00,  1.29s/it]100%|██████████| 43/43 [00:17<00:00,  2.41it/s]
2025-03-13 16:07:39,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:39
2025-03-13 16:09:00,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.3930 secs
2025-03-13 16:09:00,052 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 16:09:00,052 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 16:10:33,081 [INFO]: 	>>> Finished "Compute fast metrics" in 93.0286 secs
2025-03-13 16:10:34,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 192.2224 secs
2025-03-13 16:10:34,058 [INFO]: {
2025-03-13 16:10:34,059 [INFO]: 	index_key: HNSW32
2025-03-13 16:10:34,059 [INFO]: 	index_param: efSearch=127
2025-03-13 16:10:34,059 [INFO]: 	index_path: knn.index
2025-03-13 16:10:34,059 [INFO]: 	size in bytes: 2023333534
2025-03-13 16:10:34,059 [INFO]: 	avg_search_speed_ms: 12.716240318802102
2025-03-13 16:10:34,059 [INFO]: 	99p_search_speed_ms: 26.332378480583422
2025-03-13 16:10:34,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:34,059 [INFO]: 	nb vectors: 10277
2025-03-13 16:10:34,059 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:34,059 [INFO]: 	compression ratio: 0.9986195464301537
2025-03-13 16:10:34,059 [INFO]: }
2025-03-13 16:10:34,059 [INFO]: 	>>> Finished "Creating the index" in 192.2251 secs
2025-03-13 16:10:34,059 [INFO]: >>> Finished "Launching the whole pipeline" in 192.2525 secs
2025-03-13 16:10:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 57027 [episode count 19/20]
2025-03-13 16:10:37: [retrieval_preprocessing] finished for 5207831207_pour_cup_into_bowl [chosen_id count 2/196]
2025-03-13 16:10:42: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5207831207_stack_cups [chosen_id count 3/196]
2025-03-13 16:10:42: [retrieval_preprocessing] we have num_total=7511 embedding_dim=49152
[retrieval_preprocessing] for episode 69662 [episode count 0/20], we have num_retrieval=np.int64(7194) num_query=np.int64(317)
2025-03-13 16:10:45,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:46,705 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:46
2025-03-13 16:10:46,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 824.03it/s]
2025-03-13 16:10:46,733 [INFO]: There are 7194 embeddings of dim 49152
2025-03-13 16:10:46,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 16:10:46,734 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:46
2025-03-13 16:10:46,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:46,734 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:10:46,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:46,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:10:46,735 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:46
2025-03-13 16:10:46,735 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:46,735 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:10:46,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:46
2025-03-13 16:10:46,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:46,736 [INFO]: 	Creating the index 03/13/2025, 16:10:46
2025-03-13 16:10:46,736 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:46
2025-03-13 16:10:46,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:10:46,739 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:46
2025-03-13 16:10:46,740 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:10:46,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.41it/s]  7%|▋         | 2/30 [00:00<00:03,  7.27it/s] 10%|█         | 3/30 [00:00<00:03,  8.04it/s] 13%|█▎        | 4/30 [00:00<00:03,  8.49it/s] 17%|█▋        | 5/30 [00:00<00:02,  8.78it/s] 20%|██        | 6/30 [00:00<00:02,  8.99it/s] 27%|██▋       | 8/30 [00:00<00:02, 10.12it/s] 30%|███       | 9/30 [00:01<00:02,  8.95it/s] 33%|███▎      | 10/30 [00:01<00:02,  8.54it/s] 40%|████      | 12/30 [00:01<00:01, 10.58it/s] 47%|████▋     | 14/30 [00:01<00:01, 11.80it/s] 53%|█████▎    | 16/30 [00:01<00:01, 11.51it/s] 60%|██████    | 18/30 [00:01<00:01, 11.43it/s] 67%|██████▋   | 20/30 [00:01<00:00, 11.37it/s] 73%|███████▎  | 22/30 [00:06<00:06,  1.28it/s] 77%|███████▋  | 23/30 [00:06<00:04,  1.53it/s] 80%|████████  | 24/30 [00:06<00:03,  1.85it/s] 83%|████████▎ | 25/30 [00:06<00:02,  2.28it/s] 87%|████████▋ | 26/30 [00:06<00:01,  2.80it/s] 90%|█████████ | 27/30 [00:07<00:00,  3.43it/s] 93%|█████████▎| 28/30 [00:07<00:00,  4.14it/s] 97%|█████████▋| 29/30 [00:07<00:00,  4.90it/s]100%|██████████| 30/30 [00:09<00:00,  1.19it/s]100%|██████████| 30/30 [00:09<00:00,  3.10it/s]
2025-03-13 16:10:56,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:56
2025-03-13 16:12:04,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.9574 secs
2025-03-13 16:12:04,386 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 16:12:04,386 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 16:12:50,562 [INFO]: 	>>> Finished "Compute fast metrics" in 46.1757 secs
2025-03-13 16:12:50,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.8242 secs
2025-03-13 16:12:50,564 [INFO]: {
2025-03-13 16:12:50,564 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:50,564 [INFO]: 	index_param: efSearch=183
2025-03-13 16:12:50,564 [INFO]: 	index_path: knn.index
2025-03-13 16:12:50,564 [INFO]: 	size in bytes: 1415377030
2025-03-13 16:12:50,564 [INFO]: 	avg_search_speed_ms: 10.153583551374108
2025-03-13 16:12:50,564 [INFO]: 	99p_search_speed_ms: 13.860933836549519
2025-03-13 16:12:50,564 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:50,564 [INFO]: 	nb vectors: 7194
2025-03-13 16:12:50,564 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:50,564 [INFO]: 	compression ratio: 0.9993082564014762
2025-03-13 16:12:50,564 [INFO]: }
2025-03-13 16:12:50,564 [INFO]: 	>>> Finished "Creating the index" in 123.8284 secs
2025-03-13 16:12:50,564 [INFO]: >>> Finished "Launching the whole pipeline" in 123.8596 secs
2025-03-13 16:12:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 69662 [episode count 0/20]
[retrieval_preprocessing] for episode 45160 [episode count 1/20], we have num_retrieval=np.int64(7223) num_query=np.int64(288)
2025-03-13 16:12:57,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:58,215 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:58
2025-03-13 16:12:58,215 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1092.55it/s]
2025-03-13 16:12:58,242 [INFO]: There are 7223 embeddings of dim 49152
2025-03-13 16:12:58,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:12:58,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:58
2025-03-13 16:12:58,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:58,242 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:12:58,242 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:58,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:58,242 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:58
2025-03-13 16:12:58,243 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:58,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:58,243 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:58
2025-03-13 16:12:58,243 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:58,243 [INFO]: 	Creating the index 03/13/2025, 16:12:58
2025-03-13 16:12:58,243 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:58
2025-03-13 16:12:58,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:12:58,244 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:58
2025-03-13 16:12:58,244 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:12:58,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  4.86it/s] 10%|█         | 3/30 [00:00<00:03,  8.42it/s] 17%|█▋        | 5/30 [00:00<00:02,  9.72it/s] 23%|██▎       | 7/30 [00:00<00:02, 10.30it/s] 30%|███       | 9/30 [00:00<00:01, 10.50it/s] 37%|███▋      | 11/30 [00:01<00:01, 10.67it/s] 43%|████▎     | 13/30 [00:01<00:01, 10.80it/s] 50%|█████     | 15/30 [00:01<00:01, 10.84it/s] 57%|█████▋    | 17/30 [00:01<00:01, 10.55it/s] 63%|██████▎   | 19/30 [00:01<00:01, 10.23it/s] 70%|███████   | 21/30 [00:06<00:06,  1.41it/s] 73%|███████▎  | 22/30 [00:09<00:09,  1.17s/it] 77%|███████▋  | 23/30 [00:13<00:11,  1.69s/it] 80%|████████  | 24/30 [00:14<00:10,  1.75s/it] 83%|████████▎ | 25/30 [00:16<00:08,  1.78s/it] 87%|████████▋ | 26/30 [00:17<00:05,  1.50s/it] 93%|█████████▎| 28/30 [00:17<00:01,  1.13it/s]100%|██████████| 30/30 [00:20<00:00,  1.07s/it]100%|██████████| 30/30 [00:20<00:00,  1.47it/s]
2025-03-13 16:13:18,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:13:18
2025-03-13 16:14:26,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.0108 secs
2025-03-13 16:14:26,681 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:14:26,682 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 50%|█████     | 2/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.43it/s]
2025-03-13 16:15:11,707 [INFO]: 	>>> Finished "Compute fast metrics" in 45.0250 secs
2025-03-13 16:15:11,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.4800 secs
2025-03-13 16:15:11,725 [INFO]: {
2025-03-13 16:15:11,725 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:11,725 [INFO]: 	index_param: efSearch=242
2025-03-13 16:15:11,725 [INFO]: 	index_path: knn.index
2025-03-13 16:15:11,725 [INFO]: 	size in bytes: 1421082670
2025-03-13 16:15:11,725 [INFO]: 	avg_search_speed_ms: 16.092387303916613
2025-03-13 16:15:11,725 [INFO]: 	99p_search_speed_ms: 30.897873577196147
2025-03-13 16:15:11,725 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:11,725 [INFO]: 	nb vectors: 7223
2025-03-13 16:15:11,725 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:11,725 [INFO]: 	compression ratio: 0.9993082133638291
2025-03-13 16:15:11,725 [INFO]: }
2025-03-13 16:15:11,725 [INFO]: 	>>> Finished "Creating the index" in 133.4819 secs
2025-03-13 16:15:11,725 [INFO]: >>> Finished "Launching the whole pipeline" in 133.5094 secs
2025-03-13 16:15:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 45160 [episode count 1/20]
[retrieval_preprocessing] for episode 26816 [episode count 2/20], we have num_retrieval=np.int64(7057) num_query=np.int64(454)
2025-03-13 16:15:18,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:19,535 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:19
2025-03-13 16:15:19,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 931.45it/s]
2025-03-13 16:15:19,580 [INFO]: There are 7057 embeddings of dim 49152
2025-03-13 16:15:19,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0446 secs
2025-03-13 16:15:19,580 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:19
2025-03-13 16:15:19,581 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:19,581 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:15:19,581 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:19,581 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:15:19,581 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:19
2025-03-13 16:15:19,581 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:19,582 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:15:19,582 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:19
2025-03-13 16:15:19,582 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:19,582 [INFO]: 	Creating the index 03/13/2025, 16:15:19
2025-03-13 16:15:19,582 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:19
2025-03-13 16:15:19,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:15:19,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:19
2025-03-13 16:15:19,586 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:15:19,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.21it/s] 21%|██        | 6/29 [00:00<00:00, 26.20it/s] 34%|███▍      | 10/29 [00:00<00:00, 30.89it/s] 52%|█████▏    | 15/29 [00:00<00:00, 35.06it/s] 69%|██████▉   | 20/29 [00:00<00:00, 37.27it/s] 83%|████████▎ | 24/29 [00:07<00:02,  1.91it/s] 93%|█████████▎| 27/29 [00:10<00:01,  1.48it/s]100%|██████████| 29/29 [00:13<00:00,  1.21it/s]100%|██████████| 29/29 [00:13<00:00,  2.18it/s]
2025-03-13 16:15:32,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:32
2025-03-13 16:16:38,158 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.2353 secs
2025-03-13 16:16:38,159 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 16:16:38,159 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.99it/s]
2025-03-13 16:17:42,129 [INFO]: 	>>> Finished "Compute fast metrics" in 63.9702 secs
2025-03-13 16:17:42,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.5507 secs
2025-03-13 16:17:42,137 [INFO]: {
2025-03-13 16:17:42,137 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:42,137 [INFO]: 	index_param: efSearch=239
2025-03-13 16:17:42,137 [INFO]: 	index_path: knn.index
2025-03-13 16:17:42,137 [INFO]: 	size in bytes: 1388422990
2025-03-13 16:17:42,137 [INFO]: 	avg_search_speed_ms: 19.967448983635165
2025-03-13 16:17:42,137 [INFO]: 	99p_search_speed_ms: 28.804376954212785
2025-03-13 16:17:42,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:42,137 [INFO]: 	nb vectors: 7057
2025-03-13 16:17:42,137 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:42,137 [INFO]: 	compression ratio: 0.9993083275003967
2025-03-13 16:17:42,137 [INFO]: }
2025-03-13 16:17:42,137 [INFO]: 	>>> Finished "Creating the index" in 142.5548 secs
2025-03-13 16:17:42,137 [INFO]: >>> Finished "Launching the whole pipeline" in 142.6018 secs
2025-03-13 16:17:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 26816 [episode count 2/20]
[retrieval_preprocessing] for episode 41163 [episode count 3/20], we have num_retrieval=np.int64(7231) num_query=np.int64(280)
2025-03-13 16:17:52,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:54,070 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:54
2025-03-13 16:17:54,070 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 933.10it/s]
2025-03-13 16:17:54,103 [INFO]: There are 7231 embeddings of dim 49152
2025-03-13 16:17:54,103 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 16:17:54,104 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,104 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:54,104 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:17:54,104 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:54,104 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:17:54,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,105 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:54,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:17:54,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:54
2025-03-13 16:17:54,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:54,106 [INFO]: 	Creating the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,106 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:54
2025-03-13 16:17:54,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 16:17:54,110 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,110 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:17:54,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:05,  5.63it/s] 10%|█         | 3/30 [00:00<00:03,  8.82it/s] 17%|█▋        | 5/30 [00:00<00:02,  9.48it/s] 23%|██▎       | 7/30 [00:00<00:02, 10.17it/s] 30%|███       | 9/30 [00:01<00:02,  8.81it/s] 33%|███▎      | 10/30 [00:01<00:02,  8.35it/s] 37%|███▋      | 11/30 [00:01<00:02,  8.11it/s] 40%|████      | 12/30 [00:01<00:02,  7.91it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.88it/s] 47%|████▋     | 14/30 [00:01<00:01,  8.08it/s] 50%|█████     | 15/30 [00:01<00:01,  8.24it/s] 53%|█████▎    | 16/30 [00:01<00:01,  8.29it/s] 57%|█████▋    | 17/30 [00:02<00:01,  8.60it/s] 60%|██████    | 18/30 [00:02<00:01,  8.63it/s] 63%|██████▎   | 19/30 [00:02<00:01,  8.53it/s] 67%|██████▋   | 20/30 [00:02<00:01,  8.62it/s] 70%|███████   | 21/30 [00:07<00:15,  1.72s/it] 73%|███████▎  | 22/30 [00:07<00:09,  1.24s/it] 77%|███████▋  | 23/30 [00:08<00:06,  1.10it/s] 80%|████████  | 24/30 [00:08<00:04,  1.48it/s] 83%|████████▎ | 25/30 [00:08<00:02,  1.97it/s] 87%|████████▋ | 26/30 [00:08<00:01,  2.56it/s] 90%|█████████ | 27/30 [00:08<00:00,  3.26it/s] 93%|█████████▎| 28/30 [00:08<00:00,  4.02it/s] 97%|█████████▋| 29/30 [00:08<00:00,  4.78it/s]100%|██████████| 30/30 [00:11<00:00,  1.10it/s]100%|██████████| 30/30 [00:11<00:00,  2.64it/s]
2025-03-13 16:18:05,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:05
2025-03-13 16:19:26,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.9070 secs
2025-03-13 16:19:26,379 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 16:19:26,379 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s]
2025-03-13 16:20:11,807 [INFO]: 	>>> Finished "Compute fast metrics" in 45.4281 secs
2025-03-13 16:20:11,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.8307 secs
2025-03-13 16:20:11,941 [INFO]: {
2025-03-13 16:20:11,941 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:11,941 [INFO]: 	index_param: efSearch=206
2025-03-13 16:20:11,941 [INFO]: 	index_path: knn.index
2025-03-13 16:20:11,941 [INFO]: 	size in bytes: 1422656650
2025-03-13 16:20:11,941 [INFO]: 	avg_search_speed_ms: 11.630979245311993
2025-03-13 16:20:11,942 [INFO]: 	99p_search_speed_ms: 22.211940507404492
2025-03-13 16:20:11,942 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:11,942 [INFO]: 	nb vectors: 7231
2025-03-13 16:20:11,942 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:11,942 [INFO]: 	compression ratio: 0.9993081942856697
2025-03-13 16:20:11,942 [INFO]: }
2025-03-13 16:20:11,942 [INFO]: 	>>> Finished "Creating the index" in 137.8360 secs
2025-03-13 16:20:11,942 [INFO]: >>> Finished "Launching the whole pipeline" in 137.8719 secs
2025-03-13 16:20:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 41163 [episode count 3/20]
[retrieval_preprocessing] for episode 63721 [episode count 4/20], we have num_retrieval=np.int64(7020) num_query=np.int64(491)
2025-03-13 16:20:19,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:20,259 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:20
2025-03-13 16:20:20,259 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.97it/s]
2025-03-13 16:20:20,288 [INFO]: There are 7020 embeddings of dim 49152
2025-03-13 16:20:20,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 16:20:20,288 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:20
2025-03-13 16:20:20,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:20,289 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:20:20,289 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:20,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:20:20,289 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:20
2025-03-13 16:20:20,289 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:20,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:20:20,290 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:20
2025-03-13 16:20:20,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:20,290 [INFO]: 	Creating the index 03/13/2025, 16:20:20
2025-03-13 16:20:20,290 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:20
2025-03-13 16:20:20,293 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:20:20,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:20
2025-03-13 16:20:20,293 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:20:20,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  5.20it/s] 10%|█         | 3/29 [00:00<00:03,  8.24it/s] 17%|█▋        | 5/29 [00:00<00:02,  9.29it/s] 24%|██▍       | 7/29 [00:00<00:02,  9.62it/s] 28%|██▊       | 8/29 [00:00<00:02,  9.69it/s] 34%|███▍      | 10/29 [00:01<00:01,  9.79it/s] 38%|███▊      | 11/29 [00:01<00:01,  9.82it/s] 41%|████▏     | 12/29 [00:01<00:01,  9.73it/s] 45%|████▍     | 13/29 [00:01<00:01,  9.67it/s] 52%|█████▏    | 15/29 [00:01<00:01, 10.25it/s] 59%|█████▊    | 17/29 [00:01<00:01, 10.42it/s] 66%|██████▌   | 19/29 [00:01<00:00, 10.50it/s] 72%|███████▏  | 21/29 [00:05<00:05,  1.36it/s] 76%|███████▌  | 22/29 [00:06<00:04,  1.63it/s] 83%|████████▎ | 24/29 [00:06<00:02,  2.34it/s] 90%|████████▉ | 26/29 [00:06<00:00,  3.17it/s] 97%|█████████▋| 28/29 [00:06<00:00,  4.09it/s]100%|██████████| 29/29 [00:09<00:00,  1.34it/s]100%|██████████| 29/29 [00:09<00:00,  3.04it/s]
2025-03-13 16:20:29,841 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:29
2025-03-13 16:21:35,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.2479 secs
2025-03-13 16:21:35,090 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 16:21:35,090 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s]
2025-03-13 16:22:10,838 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7486 secs
2025-03-13 16:22:10,840 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.5469 secs
2025-03-13 16:22:10,840 [INFO]: {
2025-03-13 16:22:10,840 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:10,840 [INFO]: 	index_param: efSearch=194
2025-03-13 16:22:10,840 [INFO]: 	index_path: knn.index
2025-03-13 16:22:10,840 [INFO]: 	size in bytes: 1381143490
2025-03-13 16:22:10,840 [INFO]: 	avg_search_speed_ms: 11.284222200842576
2025-03-13 16:22:10,840 [INFO]: 	99p_search_speed_ms: 17.90901491884142
2025-03-13 16:22:10,840 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:10,840 [INFO]: 	nb vectors: 7020
2025-03-13 16:22:10,840 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:10,840 [INFO]: 	compression ratio: 0.9993083050335342
2025-03-13 16:22:10,840 [INFO]: }
2025-03-13 16:22:10,840 [INFO]: 	>>> Finished "Creating the index" in 110.5505 secs
2025-03-13 16:22:10,840 [INFO]: >>> Finished "Launching the whole pipeline" in 110.5811 secs
2025-03-13 16:22:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 63721 [episode count 4/20]
[retrieval_preprocessing] for episode 86297 [episode count 5/20], we have num_retrieval=np.int64(7135) num_query=np.int64(376)
2025-03-13 16:22:17,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:22:18,530 [INFO]: Launching the whole pipeline 03/13/2025, 16:22:18
2025-03-13 16:22:18,530 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:22:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.31it/s]
2025-03-13 16:22:18,569 [INFO]: There are 7135 embeddings of dim 49152
2025-03-13 16:22:18,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 16:22:18,570 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:22:18
2025-03-13 16:22:18,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:22:18,570 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:22:18,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:22:18,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:22:18,571 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:22:18
2025-03-13 16:22:18,571 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:22:18,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:22:18,572 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:22:18
2025-03-13 16:22:18,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:22:18,572 [INFO]: 	Creating the index 03/13/2025, 16:22:18
2025-03-13 16:22:18,572 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:22:18
2025-03-13 16:22:18,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:22:18,574 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:22:18
2025-03-13 16:22:18,575 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:22:18,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:06,  4.58it/s]  7%|▋         | 2/30 [00:00<00:04,  6.10it/s] 10%|█         | 3/30 [00:00<00:04,  6.69it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.05it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.44it/s] 20%|██        | 6/30 [00:00<00:03,  7.68it/s] 23%|██▎       | 7/30 [00:00<00:02,  7.78it/s] 27%|██▋       | 8/30 [00:01<00:02,  7.80it/s] 30%|███       | 9/30 [00:01<00:02,  7.81it/s] 33%|███▎      | 10/30 [00:01<00:02,  7.80it/s] 37%|███▋      | 11/30 [00:01<00:02,  8.16it/s] 40%|████      | 12/30 [00:01<00:02,  8.41it/s] 43%|████▎     | 13/30 [00:01<00:02,  8.44it/s] 47%|████▋     | 14/30 [00:01<00:01,  8.12it/s] 50%|█████     | 15/30 [00:01<00:01,  8.14it/s] 53%|█████▎    | 16/30 [00:02<00:01,  8.17it/s] 57%|█████▋    | 17/30 [00:02<00:01,  8.26it/s] 63%|██████▎   | 19/30 [00:02<00:01,  9.22it/s] 70%|███████   | 21/30 [00:06<00:08,  1.07it/s] 73%|███████▎  | 22/30 [00:06<00:06,  1.32it/s] 77%|███████▋  | 23/30 [00:07<00:04,  1.65it/s] 80%|████████  | 24/30 [00:07<00:02,  2.08it/s] 83%|████████▎ | 25/30 [00:07<00:01,  2.60it/s] 87%|████████▋ | 26/30 [00:07<00:01,  3.23it/s] 90%|█████████ | 27/30 [00:07<00:00,  3.92it/s] 93%|█████████▎| 28/30 [00:07<00:00,  4.70it/s] 97%|█████████▋| 29/30 [00:07<00:00,  5.54it/s]100%|██████████| 30/30 [00:10<00:00,  1.10it/s]100%|██████████| 30/30 [00:10<00:00,  2.90it/s]
2025-03-13 16:22:28,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:28
2025-03-13 16:23:28,389 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.4691 secs
2025-03-13 16:23:28,389 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 16:23:28,389 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 16:24:18,489 [INFO]: 	>>> Finished "Compute fast metrics" in 50.0996 secs
2025-03-13 16:24:18,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.9812 secs
2025-03-13 16:24:18,556 [INFO]: {
2025-03-13 16:24:18,556 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:18,556 [INFO]: 	index_param: efSearch=214
2025-03-13 16:24:18,556 [INFO]: 	index_path: knn.index
2025-03-13 16:24:18,556 [INFO]: 	size in bytes: 1403769070
2025-03-13 16:24:18,556 [INFO]: 	avg_search_speed_ms: 11.493260337671416
2025-03-13 16:24:18,557 [INFO]: 	99p_search_speed_ms: 19.225581623613827
2025-03-13 16:24:18,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:18,557 [INFO]: 	nb vectors: 7135
2025-03-13 16:24:18,557 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:18,557 [INFO]: 	compression ratio: 0.9993082979097124
2025-03-13 16:24:18,557 [INFO]: }
2025-03-13 16:24:18,557 [INFO]: 	>>> Finished "Creating the index" in 119.9850 secs
2025-03-13 16:24:18,557 [INFO]: >>> Finished "Launching the whole pipeline" in 120.0272 secs
2025-03-13 16:24:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 86297 [episode count 5/20]
[retrieval_preprocessing] for episode 35282 [episode count 6/20], we have num_retrieval=np.int64(7137) num_query=np.int64(374)
2025-03-13 16:24:27,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:28,862 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:28
2025-03-13 16:24:28,862 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.81it/s]
2025-03-13 16:24:29,298 [INFO]: There are 7137 embeddings of dim 49152
2025-03-13 16:24:29,299 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4366 secs
2025-03-13 16:24:29,299 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:29
2025-03-13 16:24:29,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:29,299 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:24:29,299 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:29,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:24:29,299 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:29
2025-03-13 16:24:29,300 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:29,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:24:29,300 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:29
2025-03-13 16:24:29,300 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:29,300 [INFO]: 	Creating the index 03/13/2025, 16:24:29
2025-03-13 16:24:29,300 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:29
2025-03-13 16:24:29,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:24:29,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:29
2025-03-13 16:24:29,303 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:24:29,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:06,  4.79it/s]  7%|▋         | 2/30 [00:00<00:04,  6.70it/s] 10%|█         | 3/30 [00:00<00:03,  7.65it/s] 13%|█▎        | 4/30 [00:00<00:03,  8.24it/s] 17%|█▋        | 5/30 [00:00<00:02,  8.61it/s] 20%|██        | 6/30 [00:00<00:02,  8.93it/s] 23%|██▎       | 7/30 [00:00<00:02,  8.87it/s] 27%|██▋       | 8/30 [00:00<00:02,  8.96it/s] 30%|███       | 9/30 [00:01<00:02,  9.05it/s] 33%|███▎      | 10/30 [00:01<00:02,  8.48it/s] 37%|███▋      | 11/30 [00:01<00:02,  8.63it/s] 40%|████      | 12/30 [00:01<00:02,  8.67it/s] 43%|████▎     | 13/30 [00:01<00:01,  8.77it/s] 47%|████▋     | 14/30 [00:01<00:01,  8.78it/s] 50%|█████     | 15/30 [00:01<00:01,  8.87it/s] 53%|█████▎    | 16/30 [00:01<00:01,  8.94it/s] 57%|█████▋    | 17/30 [00:01<00:01,  9.08it/s] 60%|██████    | 18/30 [00:02<00:01,  8.78it/s] 63%|██████▎   | 19/30 [00:02<00:01,  8.63it/s] 67%|██████▋   | 20/30 [00:02<00:01,  8.37it/s] 70%|███████   | 21/30 [00:08<00:17,  1.93s/it] 73%|███████▎  | 22/30 [00:08<00:11,  1.39s/it] 77%|███████▋  | 23/30 [00:08<00:07,  1.01s/it] 80%|████████  | 24/30 [00:08<00:04,  1.35it/s] 83%|████████▎ | 25/30 [00:08<00:02,  1.81it/s] 87%|████████▋ | 26/30 [00:09<00:01,  2.38it/s] 90%|█████████ | 27/30 [00:09<00:00,  3.07it/s] 97%|█████████▋| 29/30 [00:09<00:00,  4.53it/s]100%|██████████| 30/30 [00:11<00:00,  1.35it/s]100%|██████████| 30/30 [00:11<00:00,  2.56it/s]
2025-03-13 16:24:41,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:41
2025-03-13 16:25:41,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.5774 secs
2025-03-13 16:25:41,610 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 16:25:41,610 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 16:26:29,558 [INFO]: 	>>> Finished "Compute fast metrics" in 47.9481 secs
2025-03-13 16:26:29,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.2569 secs
2025-03-13 16:26:29,560 [INFO]: {
2025-03-13 16:26:29,560 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:29,560 [INFO]: 	index_param: efSearch=200
2025-03-13 16:26:29,560 [INFO]: 	index_path: knn.index
2025-03-13 16:26:29,560 [INFO]: 	size in bytes: 1404162610
2025-03-13 16:26:29,560 [INFO]: 	avg_search_speed_ms: 10.221236879605348
2025-03-13 16:26:29,560 [INFO]: 	99p_search_speed_ms: 15.427261102013299
2025-03-13 16:26:29,560 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:29,560 [INFO]: 	nb vectors: 7137
2025-03-13 16:26:29,560 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:29,560 [INFO]: 	compression ratio: 0.999308261028258
2025-03-13 16:26:29,560 [INFO]: }
2025-03-13 16:26:29,560 [INFO]: 	>>> Finished "Creating the index" in 120.2597 secs
2025-03-13 16:26:29,560 [INFO]: >>> Finished "Launching the whole pipeline" in 120.6977 secs
2025-03-13 16:26:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 35282 [episode count 6/20]
[retrieval_preprocessing] for episode 88618 [episode count 7/20], we have num_retrieval=np.int64(7022) num_query=np.int64(489)
2025-03-13 16:26:37,096 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:38,377 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:38
2025-03-13 16:26:38,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1975.65it/s]
2025-03-13 16:26:38,400 [INFO]: There are 7022 embeddings of dim 49152
2025-03-13 16:26:38,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 16:26:38,400 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:38
2025-03-13 16:26:38,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:38,400 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:26:38,400 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:38,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:38,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:38
2025-03-13 16:26:38,401 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:38,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:38,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:38
2025-03-13 16:26:38,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:38,401 [INFO]: 	Creating the index 03/13/2025, 16:26:38
2025-03-13 16:26:38,401 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:38
2025-03-13 16:26:38,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:26:38,402 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:38
2025-03-13 16:26:38,402 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:26:38,402 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:06,  4.55it/s]  7%|▋         | 2/29 [00:00<00:04,  6.23it/s] 10%|█         | 3/29 [00:00<00:03,  7.06it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.62it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.60it/s] 21%|██        | 6/29 [00:00<00:02,  8.21it/s] 28%|██▊       | 8/29 [00:01<00:02,  9.13it/s] 31%|███       | 9/29 [00:01<00:02,  9.28it/s] 34%|███▍      | 10/29 [00:01<00:02,  9.44it/s] 38%|███▊      | 11/29 [00:01<00:01,  9.42it/s] 41%|████▏     | 12/29 [00:01<00:01,  9.41it/s] 45%|████▍     | 13/29 [00:01<00:01,  9.55it/s] 48%|████▊     | 14/29 [00:01<00:01,  9.66it/s] 52%|█████▏    | 15/29 [00:01<00:01,  9.62it/s] 55%|█████▌    | 16/29 [00:01<00:01,  9.55it/s] 59%|█████▊    | 17/29 [00:01<00:01,  9.61it/s] 62%|██████▏   | 18/29 [00:02<00:01,  9.42it/s] 66%|██████▌   | 19/29 [00:02<00:01,  9.44it/s] 72%|███████▏  | 21/29 [00:07<00:09,  1.22s/it] 79%|███████▉  | 23/29 [00:07<00:04,  1.29it/s] 86%|████████▌ | 25/29 [00:07<00:02,  1.91it/s] 93%|█████████▎| 27/29 [00:07<00:00,  2.66it/s]100%|██████████| 29/29 [00:10<00:00,  1.52it/s]100%|██████████| 29/29 [00:10<00:00,  2.84it/s]
2025-03-13 16:26:48,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:48
2025-03-13 16:27:56,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.7148 secs
2025-03-13 16:27:56,348 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:27:56,348 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s]
2025-03-13 16:28:43,057 [INFO]: 	>>> Finished "Compute fast metrics" in 46.7095 secs
2025-03-13 16:28:43,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.2255 secs
2025-03-13 16:28:43,628 [INFO]: {
2025-03-13 16:28:43,628 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:43,628 [INFO]: 	index_param: efSearch=219
2025-03-13 16:28:43,628 [INFO]: 	index_path: knn.index
2025-03-13 16:28:43,628 [INFO]: 	size in bytes: 1381536970
2025-03-13 16:28:43,628 [INFO]: 	avg_search_speed_ms: 11.839863603670128
2025-03-13 16:28:43,628 [INFO]: 	99p_search_speed_ms: 19.82577733695507
2025-03-13 16:28:43,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:43,628 [INFO]: 	nb vectors: 7022
2025-03-13 16:28:43,628 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:43,628 [INFO]: 	compression ratio: 0.999308310945888
2025-03-13 16:28:43,628 [INFO]: }
2025-03-13 16:28:43,628 [INFO]: 	>>> Finished "Creating the index" in 125.2270 secs
2025-03-13 16:28:43,628 [INFO]: >>> Finished "Launching the whole pipeline" in 125.2510 secs
2025-03-13 16:28:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 88618 [episode count 7/20]
[retrieval_preprocessing] for episode 78489 [episode count 8/20], we have num_retrieval=np.int64(7191) num_query=np.int64(320)
2025-03-13 16:28:50,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:52,166 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:52
2025-03-13 16:28:52,166 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1331.10it/s]
2025-03-13 16:28:52,194 [INFO]: There are 7191 embeddings of dim 49152
2025-03-13 16:28:52,194 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 16:28:52,194 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:52
2025-03-13 16:28:52,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:52,194 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:28:52,194 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:52,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:28:52,194 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:52
2025-03-13 16:28:52,195 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:52,195 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:28:52,195 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:52
2025-03-13 16:28:52,195 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:52,195 [INFO]: 	Creating the index 03/13/2025, 16:28:52
2025-03-13 16:28:52,195 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:52
2025-03-13 16:28:52,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:28:52,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:52
2025-03-13 16:28:52,196 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:28:52,196 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:06,  4.53it/s]  7%|▋         | 2/30 [00:00<00:04,  6.55it/s] 10%|█         | 3/30 [00:00<00:03,  7.58it/s] 13%|█▎        | 4/30 [00:00<00:03,  8.18it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.63it/s] 20%|██        | 6/30 [00:00<00:03,  7.61it/s] 23%|██▎       | 7/30 [00:00<00:02,  7.70it/s] 27%|██▋       | 8/30 [00:01<00:02,  7.53it/s] 30%|███       | 9/30 [00:01<00:02,  7.60it/s] 33%|███▎      | 10/30 [00:01<00:02,  7.95it/s] 37%|███▋      | 11/30 [00:01<00:02,  7.92it/s] 40%|████      | 12/30 [00:01<00:02,  7.84it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.89it/s] 47%|████▋     | 14/30 [00:01<00:02,  7.99it/s] 50%|█████     | 15/30 [00:01<00:01,  7.86it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.83it/s] 57%|█████▋    | 17/30 [00:02<00:01,  7.83it/s] 60%|██████    | 18/30 [00:02<00:01,  7.70it/s] 63%|██████▎   | 19/30 [00:02<00:01,  7.62it/s] 67%|██████▋   | 20/30 [00:02<00:01,  7.69it/s] 70%|███████   | 21/30 [00:07<00:14,  1.64s/it] 80%|████████  | 24/30 [00:07<00:04,  1.35it/s] 90%|█████████ | 27/30 [00:08<00:01,  2.34it/s]100%|██████████| 30/30 [00:10<00:00,  1.57it/s]100%|██████████| 30/30 [00:10<00:00,  2.75it/s]
2025-03-13 16:29:03,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:03
2025-03-13 16:30:22,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.2230 secs
2025-03-13 16:30:22,341 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 16:30:22,341 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 16:31:02,554 [INFO]: 	>>> Finished "Compute fast metrics" in 40.2134 secs
2025-03-13 16:31:02,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.3608 secs
2025-03-13 16:31:02,557 [INFO]: {
2025-03-13 16:31:02,557 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:02,557 [INFO]: 	index_param: efSearch=198
2025-03-13 16:31:02,557 [INFO]: 	index_path: knn.index
2025-03-13 16:31:02,557 [INFO]: 	size in bytes: 1414786810
2025-03-13 16:31:02,557 [INFO]: 	avg_search_speed_ms: 13.01782172837799
2025-03-13 16:31:02,557 [INFO]: 	99p_search_speed_ms: 19.521406844723984
2025-03-13 16:31:02,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:02,557 [INFO]: 	nb vectors: 7191
2025-03-13 16:31:02,557 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:02,557 [INFO]: 	compression ratio: 0.9993082477210824
2025-03-13 16:31:02,557 [INFO]: }
2025-03-13 16:31:02,557 [INFO]: 	>>> Finished "Creating the index" in 130.3626 secs
2025-03-13 16:31:02,557 [INFO]: >>> Finished "Launching the whole pipeline" in 130.3918 secs
2025-03-13 16:31:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 78489 [episode count 8/20]
[retrieval_preprocessing] for episode 82673 [episode count 9/20], we have num_retrieval=np.int64(6956) num_query=np.int64(555)
2025-03-13 16:31:06,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:08,256 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:08
2025-03-13 16:31:08,256 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1326.89it/s]
2025-03-13 16:31:08,293 [INFO]: There are 6956 embeddings of dim 49152
2025-03-13 16:31:08,293 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 16:31:08,293 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:08
2025-03-13 16:31:08,293 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:08,293 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:31:08,293 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:08,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:08,293 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:08
2025-03-13 16:31:08,293 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:08,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:31:08,294 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:08
2025-03-13 16:31:08,294 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:08,294 [INFO]: 	Creating the index 03/13/2025, 16:31:08
2025-03-13 16:31:08,294 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:08
2025-03-13 16:31:08,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:31:08,295 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:08
2025-03-13 16:31:08,295 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:31:08,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.36it/s] 14%|█▍        | 4/29 [00:00<00:01, 17.51it/s] 21%|██        | 6/29 [00:00<00:01, 14.62it/s] 28%|██▊       | 8/29 [00:00<00:01, 13.24it/s] 34%|███▍      | 10/29 [00:00<00:01, 12.74it/s] 41%|████▏     | 12/29 [00:00<00:01, 12.65it/s] 48%|████▊     | 14/29 [00:01<00:01, 12.47it/s] 55%|█████▌    | 16/29 [00:01<00:01, 12.45it/s] 62%|██████▏   | 18/29 [00:01<00:00, 12.31it/s] 69%|██████▉   | 20/29 [00:01<00:00, 12.36it/s] 76%|███████▌  | 22/29 [00:06<00:05,  1.36it/s] 83%|████████▎ | 24/29 [00:06<00:02,  1.86it/s] 90%|████████▉ | 26/29 [00:06<00:01,  2.49it/s] 97%|█████████▋| 28/29 [00:06<00:00,  3.23it/s]100%|██████████| 29/29 [00:08<00:00,  3.24it/s]
2025-03-13 16:31:17,250 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:17
2025-03-13 16:32:31,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.8901 secs
2025-03-13 16:32:31,140 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 16:32:31,140 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 16:33:35,785 [INFO]: 	>>> Finished "Compute fast metrics" in 64.6447 secs
2025-03-13 16:33:35,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 147.4928 secs
2025-03-13 16:33:35,788 [INFO]: {
2025-03-13 16:33:35,788 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:35,788 [INFO]: 	index_param: efSearch=181
2025-03-13 16:33:35,788 [INFO]: 	index_path: knn.index
2025-03-13 16:33:35,788 [INFO]: 	size in bytes: 1368551890
2025-03-13 16:33:35,788 [INFO]: 	avg_search_speed_ms: 11.34646771447195
2025-03-13 16:33:35,788 [INFO]: 	99p_search_speed_ms: 19.29768164642154
2025-03-13 16:33:35,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:35,788 [INFO]: 	nb vectors: 6956
2025-03-13 16:33:35,788 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:35,788 [INFO]: 	compression ratio: 0.9993082892896373
2025-03-13 16:33:35,788 [INFO]: }
2025-03-13 16:33:35,788 [INFO]: 	>>> Finished "Creating the index" in 147.4946 secs
2025-03-13 16:33:35,788 [INFO]: >>> Finished "Launching the whole pipeline" in 147.5321 secs
2025-03-13 16:33:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 82673 [episode count 9/20]
[retrieval_preprocessing] for episode 9435 [episode count 10/20], we have num_retrieval=np.int64(7090) num_query=np.int64(421)
2025-03-13 16:33:43,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:45,010 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:45
2025-03-13 16:33:45,011 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.93it/s]
2025-03-13 16:33:45,042 [INFO]: There are 7090 embeddings of dim 49152
2025-03-13 16:33:45,042 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 16:33:45,043 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:45
2025-03-13 16:33:45,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:45,043 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:33:45,043 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:45,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:33:45,044 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:45
2025-03-13 16:33:45,044 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:45,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:33:45,044 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:45
2025-03-13 16:33:45,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:45,045 [INFO]: 	Creating the index 03/13/2025, 16:33:45
2025-03-13 16:33:45,045 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:45
2025-03-13 16:33:45,048 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:33:45,048 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:45
2025-03-13 16:33:45,048 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:33:45,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.84it/s] 17%|█▋        | 5/29 [00:00<00:01, 21.34it/s] 34%|███▍      | 10/29 [00:00<00:00, 29.75it/s] 52%|█████▏    | 15/29 [00:00<00:00, 33.98it/s] 69%|██████▉   | 20/29 [00:00<00:00, 36.37it/s] 83%|████████▎ | 24/29 [00:05<00:01,  2.65it/s] 97%|█████████▋| 28/29 [00:05<00:00,  3.72it/s]100%|██████████| 29/29 [00:07<00:00,  3.79it/s]
2025-03-13 16:33:52,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:52
2025-03-13 16:35:09,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1875 secs
2025-03-13 16:35:09,903 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:35:09,903 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s]
2025-03-13 16:36:01,238 [INFO]: 	>>> Finished "Compute fast metrics" in 51.3352 secs
2025-03-13 16:36:01,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.1932 secs
2025-03-13 16:36:01,242 [INFO]: {
2025-03-13 16:36:01,242 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:01,242 [INFO]: 	index_param: efSearch=157
2025-03-13 16:36:01,242 [INFO]: 	index_path: knn.index
2025-03-13 16:36:01,242 [INFO]: 	size in bytes: 1394915530
2025-03-13 16:36:01,242 [INFO]: 	avg_search_speed_ms: 10.495653172958827
2025-03-13 16:36:01,242 [INFO]: 	99p_search_speed_ms: 14.951605536043646
2025-03-13 16:36:01,242 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:01,242 [INFO]: 	nb vectors: 7090
2025-03-13 16:36:01,242 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:01,242 [INFO]: 	compression ratio: 0.9993083380468206
2025-03-13 16:36:01,242 [INFO]: }
2025-03-13 16:36:01,242 [INFO]: 	>>> Finished "Creating the index" in 136.1974 secs
2025-03-13 16:36:01,242 [INFO]: >>> Finished "Launching the whole pipeline" in 136.2314 secs
2025-03-13 16:36:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 9435 [episode count 10/20]
[retrieval_preprocessing] for episode 9066 [episode count 11/20], we have num_retrieval=np.int64(7113) num_query=np.int64(398)
2025-03-13 16:36:05,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:06,325 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:06
2025-03-13 16:36:06,325 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 953.68it/s]
2025-03-13 16:36:06,360 [INFO]: There are 7113 embeddings of dim 49152
2025-03-13 16:36:06,360 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 16:36:06,360 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:06
2025-03-13 16:36:06,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:06,360 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:36:06,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:06,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:06,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:06
2025-03-13 16:36:06,360 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:06,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:36:06,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:06
2025-03-13 16:36:06,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:06,360 [INFO]: 	Creating the index 03/13/2025, 16:36:06
2025-03-13 16:36:06,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:06
2025-03-13 16:36:06,361 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:36:06,361 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:06
2025-03-13 16:36:06,362 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:36:06,362 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.11it/s] 21%|██        | 6/29 [00:00<00:00, 27.31it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.14it/s] 55%|█████▌    | 16/29 [00:00<00:00, 39.58it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.66it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.72it/s]100%|██████████| 29/29 [00:07<00:00,  2.68it/s]100%|██████████| 29/29 [00:07<00:00,  3.78it/s]
2025-03-13 16:36:14,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:14
2025-03-13 16:37:24,758 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.7230 secs
2025-03-13 16:37:24,758 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 16:37:24,758 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 16:38:17,154 [INFO]: 	>>> Finished "Compute fast metrics" in 52.3950 secs
2025-03-13 16:38:17,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.7942 secs
2025-03-13 16:38:17,156 [INFO]: {
2025-03-13 16:38:17,156 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:17,156 [INFO]: 	index_param: efSearch=204
2025-03-13 16:38:17,156 [INFO]: 	index_path: knn.index
2025-03-13 16:38:17,156 [INFO]: 	size in bytes: 1399440550
2025-03-13 16:38:17,156 [INFO]: 	avg_search_speed_ms: 14.084589803709425
2025-03-13 16:38:17,156 [INFO]: 	99p_search_speed_ms: 21.982297513168305
2025-03-13 16:38:17,156 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:17,156 [INFO]: 	nb vectors: 7113
2025-03-13 16:38:17,156 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:17,156 [INFO]: 	compression ratio: 0.9993084050622943
2025-03-13 16:38:17,156 [INFO]: }
2025-03-13 16:38:17,156 [INFO]: 	>>> Finished "Creating the index" in 130.7959 secs
2025-03-13 16:38:17,156 [INFO]: >>> Finished "Launching the whole pipeline" in 130.8313 secs
2025-03-13 16:38:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 9066 [episode count 11/20]
[retrieval_preprocessing] for episode 85384 [episode count 12/20], we have num_retrieval=np.int64(7227) num_query=np.int64(284)
2025-03-13 16:38:24,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:26,645 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:26
2025-03-13 16:38:26,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 663.03it/s]
2025-03-13 16:38:26,689 [INFO]: There are 7227 embeddings of dim 49152
2025-03-13 16:38:26,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0447 secs
2025-03-13 16:38:26,690 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:26,690 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:38:26,691 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:26,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:38:26,691 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,691 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:26,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:38:26,691 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:26
2025-03-13 16:38:26,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:26,692 [INFO]: 	Creating the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,692 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:26
2025-03-13 16:38:26,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:38:26,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,695 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:38:26,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.81it/s] 13%|█▎        | 4/30 [00:00<00:01, 17.70it/s] 23%|██▎       | 7/30 [00:00<00:01, 21.98it/s] 33%|███▎      | 10/30 [00:00<00:00, 24.24it/s] 43%|████▎     | 13/30 [00:00<00:00, 22.71it/s] 53%|█████▎    | 16/30 [00:00<00:00, 24.32it/s] 63%|██████▎   | 19/30 [00:00<00:00, 25.29it/s] 73%|███████▎  | 22/30 [00:10<00:08,  1.11s/it] 87%|████████▋ | 26/30 [00:10<00:02,  1.43it/s]100%|██████████| 30/30 [00:14<00:00,  1.35it/s]100%|██████████| 30/30 [00:14<00:00,  2.10it/s]
2025-03-13 16:38:40,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:40
2025-03-13 16:39:54,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.8216 secs
2025-03-13 16:39:54,792 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 16:39:54,792 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 16:41:07,214 [INFO]: 	>>> Finished "Compute fast metrics" in 72.4217 secs
2025-03-13 16:41:07,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.5207 secs
2025-03-13 16:41:07,216 [INFO]: {
2025-03-13 16:41:07,216 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:07,216 [INFO]: 	index_param: efSearch=234
2025-03-13 16:41:07,216 [INFO]: 	index_path: knn.index
2025-03-13 16:41:07,216 [INFO]: 	size in bytes: 1421869690
2025-03-13 16:41:07,216 [INFO]: 	avg_search_speed_ms: 13.172179522184221
2025-03-13 16:41:07,216 [INFO]: 	99p_search_speed_ms: 18.22424885816872
2025-03-13 16:41:07,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:07,216 [INFO]: 	nb vectors: 7227
2025-03-13 16:41:07,216 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:07,216 [INFO]: 	compression ratio: 0.9993081827350859
2025-03-13 16:41:07,216 [INFO]: }
2025-03-13 16:41:07,216 [INFO]: 	>>> Finished "Creating the index" in 160.5247 secs
2025-03-13 16:41:07,216 [INFO]: >>> Finished "Launching the whole pipeline" in 160.5716 secs
2025-03-13 16:41:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 85384 [episode count 12/20]
[retrieval_preprocessing] for episode 46585 [episode count 13/20], we have num_retrieval=np.int64(7187) num_query=np.int64(324)
2025-03-13 16:41:11,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:13,057 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:13
2025-03-13 16:41:13,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 927.53it/s]
2025-03-13 16:41:13,095 [INFO]: There are 7187 embeddings of dim 49152
2025-03-13 16:41:13,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 16:41:13,096 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:13,096 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:41:13,096 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:13,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:41:13,097 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,097 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:13,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:41:13,097 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:13
2025-03-13 16:41:13,097 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:13,098 [INFO]: 	Creating the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,098 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:13
2025-03-13 16:41:13,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:41:13,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,101 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:41:13,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:01, 16.42it/s] 23%|██▎       | 7/30 [00:00<00:00, 33.47it/s] 40%|████      | 12/30 [00:00<00:00, 39.05it/s] 57%|█████▋    | 17/30 [00:00<00:00, 40.33it/s] 73%|███████▎  | 22/30 [00:06<00:03,  2.17it/s] 87%|████████▋ | 26/30 [00:06<00:01,  3.03it/s]100%|██████████| 30/30 [00:09<00:00,  2.33it/s]100%|██████████| 30/30 [00:09<00:00,  3.31it/s]
2025-03-13 16:41:22,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:22
2025-03-13 16:42:33,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.5403 secs
2025-03-13 16:42:33,721 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:42:33,721 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 16:43:32,039 [INFO]: 	>>> Finished "Compute fast metrics" in 58.3182 secs
2025-03-13 16:43:32,344 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.2429 secs
2025-03-13 16:43:32,344 [INFO]: {
2025-03-13 16:43:32,345 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:32,345 [INFO]: 	index_param: efSearch=207
2025-03-13 16:43:32,345 [INFO]: 	index_path: knn.index
2025-03-13 16:43:32,345 [INFO]: 	size in bytes: 1413999850
2025-03-13 16:43:32,345 [INFO]: 	avg_search_speed_ms: 14.134198572555041
2025-03-13 16:43:32,345 [INFO]: 	99p_search_speed_ms: 23.225490923505276
2025-03-13 16:43:32,345 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:32,345 [INFO]: 	nb vectors: 7187
2025-03-13 16:43:32,345 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:32,345 [INFO]: 	compression ratio: 0.9993082361359515
2025-03-13 16:43:32,345 [INFO]: }
2025-03-13 16:43:32,345 [INFO]: 	>>> Finished "Creating the index" in 139.2476 secs
2025-03-13 16:43:32,345 [INFO]: >>> Finished "Launching the whole pipeline" in 139.2881 secs
2025-03-13 16:43:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 46585 [episode count 13/20]
[retrieval_preprocessing] for episode 31682 [episode count 14/20], we have num_retrieval=np.int64(7206) num_query=np.int64(305)
2025-03-13 16:43:41,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:43,334 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:43
2025-03-13 16:43:43,334 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.81it/s]
2025-03-13 16:43:43,367 [INFO]: There are 7206 embeddings of dim 49152
2025-03-13 16:43:43,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 16:43:43,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:43
2025-03-13 16:43:43,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:43,368 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:43:43,368 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:43,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:43,368 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:43
2025-03-13 16:43:43,368 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:43,368 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:43:43,368 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:43
2025-03-13 16:43:43,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:43,368 [INFO]: 	Creating the index 03/13/2025, 16:43:43
2025-03-13 16:43:43,368 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:43
2025-03-13 16:43:43,369 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:43:43,369 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:43
2025-03-13 16:43:43,370 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:43:43,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  7.18it/s] 20%|██        | 6/30 [00:00<00:00, 27.77it/s] 37%|███▋      | 11/30 [00:00<00:00, 36.21it/s] 53%|█████▎    | 16/30 [00:00<00:00, 39.77it/s] 70%|███████   | 21/30 [00:04<00:03,  2.88it/s] 87%|████████▋ | 26/30 [00:04<00:00,  4.32it/s]100%|██████████| 30/30 [00:07<00:00,  3.10it/s]100%|██████████| 30/30 [00:07<00:00,  4.26it/s]
2025-03-13 16:43:50,413 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:50
2025-03-13 16:45:04,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.7727 secs
2025-03-13 16:45:04,187 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:45:04,187 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s]
2025-03-13 16:45:58,229 [INFO]: 	>>> Finished "Compute fast metrics" in 54.0426 secs
2025-03-13 16:45:58,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.8620 secs
2025-03-13 16:45:58,232 [INFO]: {
2025-03-13 16:45:58,232 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:58,232 [INFO]: 	index_param: efSearch=212
2025-03-13 16:45:58,232 [INFO]: 	index_path: knn.index
2025-03-13 16:45:58,232 [INFO]: 	size in bytes: 1417737970
2025-03-13 16:45:58,232 [INFO]: 	avg_search_speed_ms: 14.66628556143864
2025-03-13 16:45:58,232 [INFO]: 	99p_search_speed_ms: 24.518299128394567
2025-03-13 16:45:58,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:58,232 [INFO]: 	nb vectors: 7206
2025-03-13 16:45:58,232 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:58,232 [INFO]: 	compression ratio: 0.9993082487591131
2025-03-13 16:45:58,232 [INFO]: }
2025-03-13 16:45:58,232 [INFO]: 	>>> Finished "Creating the index" in 134.8635 secs
2025-03-13 16:45:58,232 [INFO]: >>> Finished "Launching the whole pipeline" in 134.8981 secs
2025-03-13 16:46:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 31682 [episode count 14/20]
[retrieval_preprocessing] for episode 27879 [episode count 15/20], we have num_retrieval=np.int64(7178) num_query=np.int64(333)
2025-03-13 16:46:02,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:03,256 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:03
2025-03-13 16:46:03,256 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.52it/s]
2025-03-13 16:46:03,286 [INFO]: There are 7178 embeddings of dim 49152
2025-03-13 16:46:03,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 16:46:03,287 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:03,287 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:46:03,287 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:03,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:03,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,287 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:03,287 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:46:03,287 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:03
2025-03-13 16:46:03,287 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:03,287 [INFO]: 	Creating the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,287 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:03
2025-03-13 16:46:03,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:46:03,288 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,288 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:46:03,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  7.12it/s] 17%|█▋        | 5/30 [00:00<00:01, 21.62it/s] 33%|███▎      | 10/30 [00:00<00:00, 31.63it/s] 50%|█████     | 15/30 [00:00<00:00, 37.04it/s] 67%|██████▋   | 20/30 [00:00<00:00, 40.07it/s] 83%|████████▎ | 25/30 [00:05<00:01,  2.83it/s]100%|██████████| 30/30 [00:07<00:00,  2.44it/s]100%|██████████| 30/30 [00:07<00:00,  3.82it/s]
2025-03-13 16:46:11,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:11
2025-03-13 16:47:14,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.4334 secs
2025-03-13 16:47:14,575 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 16:47:14,575 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 16:48:21,326 [INFO]: 	>>> Finished "Compute fast metrics" in 66.7508 secs
2025-03-13 16:48:21,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.0402 secs
2025-03-13 16:48:21,329 [INFO]: {
2025-03-13 16:48:21,329 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:21,329 [INFO]: 	index_param: efSearch=205
2025-03-13 16:48:21,329 [INFO]: 	index_path: knn.index
2025-03-13 16:48:21,329 [INFO]: 	size in bytes: 1412229190
2025-03-13 16:48:21,329 [INFO]: 	avg_search_speed_ms: 18.151563124058466
2025-03-13 16:48:21,329 [INFO]: 	99p_search_speed_ms: 25.99764207843691
2025-03-13 16:48:21,329 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:21,329 [INFO]: 	nb vectors: 7178
2025-03-13 16:48:21,329 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:21,329 [INFO]: 	compression ratio: 0.999308210022199
2025-03-13 16:48:21,329 [INFO]: }
2025-03-13 16:48:21,329 [INFO]: 	>>> Finished "Creating the index" in 138.0418 secs
2025-03-13 16:48:21,329 [INFO]: >>> Finished "Launching the whole pipeline" in 138.0726 secs
2025-03-13 16:48:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 27879 [episode count 15/20]
[retrieval_preprocessing] for episode 95404 [episode count 16/20], we have num_retrieval=np.int64(7191) num_query=np.int64(320)
2025-03-13 16:48:25,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:26,620 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:26
2025-03-13 16:48:26,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.98it/s]
2025-03-13 16:48:26,660 [INFO]: There are 7191 embeddings of dim 49152
2025-03-13 16:48:26,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0400 secs
2025-03-13 16:48:26,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:26
2025-03-13 16:48:26,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:26,661 [INFO]: 		-> Add: 4.0 seconds
2025-03-13 16:48:26,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:26,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:26,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:26
2025-03-13 16:48:26,661 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:26,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:26,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:26
2025-03-13 16:48:26,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:26,661 [INFO]: 	Creating the index 03/13/2025, 16:48:26
2025-03-13 16:48:26,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:26
2025-03-13 16:48:26,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:48:26,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:26
2025-03-13 16:48:26,662 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:48:26,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.50it/s] 13%|█▎        | 4/30 [00:00<00:01, 18.56it/s] 27%|██▋       | 8/30 [00:00<00:00, 26.52it/s] 40%|████      | 12/30 [00:00<00:00, 30.19it/s] 53%|█████▎    | 16/30 [00:00<00:00, 33.38it/s] 67%|██████▋   | 20/30 [00:00<00:00, 35.12it/s] 80%|████████  | 24/30 [00:05<00:02,  2.32it/s] 97%|█████████▋| 29/30 [00:05<00:00,  3.62it/s]100%|██████████| 30/30 [00:08<00:00,  3.63it/s]
2025-03-13 16:48:34,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:34
2025-03-13 16:49:41,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.0629 secs
2025-03-13 16:49:41,000 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 16:49:41,000 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.77it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 16:50:52,547 [INFO]: 	>>> Finished "Compute fast metrics" in 71.5470 secs
2025-03-13 16:50:52,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.8872 secs
2025-03-13 16:50:52,550 [INFO]: {
2025-03-13 16:50:52,550 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:52,550 [INFO]: 	index_param: efSearch=226
2025-03-13 16:50:52,550 [INFO]: 	index_path: knn.index
2025-03-13 16:50:52,550 [INFO]: 	size in bytes: 1414786810
2025-03-13 16:50:52,550 [INFO]: 	avg_search_speed_ms: 15.650411490977673
2025-03-13 16:50:52,550 [INFO]: 	99p_search_speed_ms: 21.85510801151395
2025-03-13 16:50:52,550 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:52,550 [INFO]: 	nb vectors: 7191
2025-03-13 16:50:52,550 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:52,550 [INFO]: 	compression ratio: 0.9993082477210824
2025-03-13 16:50:52,550 [INFO]: }
2025-03-13 16:50:52,550 [INFO]: 	>>> Finished "Creating the index" in 145.8888 secs
2025-03-13 16:50:52,550 [INFO]: >>> Finished "Launching the whole pipeline" in 145.9293 secs
2025-03-13 16:50:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 95404 [episode count 16/20]
[retrieval_preprocessing] for episode 75711 [episode count 17/20], we have num_retrieval=np.int64(7186) num_query=np.int64(325)
2025-03-13 16:50:56,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:57,851 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:57
2025-03-13 16:50:57,851 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1370.24it/s]
2025-03-13 16:50:57,886 [INFO]: There are 7186 embeddings of dim 49152
2025-03-13 16:50:57,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 16:50:57,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:57
2025-03-13 16:50:57,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:57,886 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:50:57,886 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:57,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:57,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:57
2025-03-13 16:50:57,886 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:57,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:50:57,886 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:57
2025-03-13 16:50:57,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:57,886 [INFO]: 	Creating the index 03/13/2025, 16:50:57
2025-03-13 16:50:57,886 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:57
2025-03-13 16:50:57,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:50:57,887 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:57
2025-03-13 16:50:57,887 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:50:57,887 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:04,  6.01it/s] 20%|██        | 6/30 [00:00<00:00, 25.71it/s] 37%|███▋      | 11/30 [00:00<00:00, 34.03it/s] 53%|█████▎    | 16/30 [00:00<00:00, 36.87it/s] 70%|███████   | 21/30 [00:05<00:03,  2.54it/s] 80%|████████  | 24/30 [00:05<00:01,  3.09it/s] 87%|████████▋ | 26/30 [00:05<00:01,  3.53it/s] 93%|█████████▎| 28/30 [00:06<00:00,  4.02it/s]100%|██████████| 30/30 [00:09<00:00,  1.60it/s]100%|██████████| 30/30 [00:09<00:00,  3.03it/s]
2025-03-13 16:51:07,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:07
2025-03-13 16:52:21,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.7493 secs
2025-03-13 16:52:21,538 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 16:52:21,538 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 16:53:09,659 [INFO]: 	>>> Finished "Compute fast metrics" in 48.1206 secs
2025-03-13 16:53:09,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.7733 secs
2025-03-13 16:53:09,661 [INFO]: {
2025-03-13 16:53:09,661 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:09,661 [INFO]: 	index_param: efSearch=132
2025-03-13 16:53:09,661 [INFO]: 	index_path: knn.index
2025-03-13 16:53:09,661 [INFO]: 	size in bytes: 1413803110
2025-03-13 16:53:09,661 [INFO]: 	avg_search_speed_ms: 8.306060537681962
2025-03-13 16:53:09,661 [INFO]: 	99p_search_speed_ms: 13.007544022984804
2025-03-13 16:53:09,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:09,661 [INFO]: 	nb vectors: 7186
2025-03-13 16:53:09,661 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:09,661 [INFO]: 	compression ratio: 0.9993082332376536
2025-03-13 16:53:09,661 [INFO]: }
2025-03-13 16:53:09,661 [INFO]: 	>>> Finished "Creating the index" in 131.7747 secs
2025-03-13 16:53:09,661 [INFO]: >>> Finished "Launching the whole pipeline" in 131.8100 secs
2025-03-13 16:53:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 75711 [episode count 17/20]
[retrieval_preprocessing] for episode 12138 [episode count 18/20], we have num_retrieval=np.int64(7104) num_query=np.int64(407)
2025-03-13 16:53:12,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:13,354 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:13
2025-03-13 16:53:13,354 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.36it/s]
2025-03-13 16:53:13,394 [INFO]: There are 7104 embeddings of dim 49152
2025-03-13 16:53:13,394 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0405 secs
2025-03-13 16:53:13,394 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:13
2025-03-13 16:53:13,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:13,395 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:53:13,395 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:13,395 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:13,395 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:13
2025-03-13 16:53:13,395 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:13,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:53:13,395 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:13
2025-03-13 16:53:13,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:13,395 [INFO]: 	Creating the index 03/13/2025, 16:53:13
2025-03-13 16:53:13,395 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:13
2025-03-13 16:53:13,396 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:53:13,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:13
2025-03-13 16:53:13,396 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:53:13,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.09it/s] 17%|█▋        | 5/29 [00:00<00:01, 23.27it/s] 34%|███▍      | 10/29 [00:00<00:00, 32.14it/s] 52%|█████▏    | 15/29 [00:00<00:00, 36.91it/s] 69%|██████▉   | 20/29 [00:00<00:00, 39.33it/s] 83%|████████▎ | 24/29 [00:04<00:01,  2.93it/s]100%|██████████| 29/29 [00:06<00:00,  2.66it/s]100%|██████████| 29/29 [00:06<00:00,  4.19it/s]
2025-03-13 16:53:20,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:20
2025-03-13 16:54:26,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.2838 secs
2025-03-13 16:54:26,602 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 16:54:26,603 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
2025-03-13 16:54:58,005 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4021 secs
2025-03-13 16:54:58,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.6107 secs
2025-03-13 16:54:58,007 [INFO]: {
2025-03-13 16:54:58,007 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:58,007 [INFO]: 	index_param: efSearch=151
2025-03-13 16:54:58,007 [INFO]: 	index_path: knn.index
2025-03-13 16:54:58,007 [INFO]: 	size in bytes: 1397669890
2025-03-13 16:54:58,007 [INFO]: 	avg_search_speed_ms: 9.746706450664844
2025-03-13 16:54:58,007 [INFO]: 	99p_search_speed_ms: 14.012916071806103
2025-03-13 16:54:58,007 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:58,007 [INFO]: 	nb vectors: 7104
2025-03-13 16:54:58,007 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:58,007 [INFO]: 	compression ratio: 0.9993083788905261
2025-03-13 16:54:58,007 [INFO]: }
2025-03-13 16:54:58,007 [INFO]: 	>>> Finished "Creating the index" in 104.6123 secs
2025-03-13 16:54:58,007 [INFO]: >>> Finished "Launching the whole pipeline" in 104.6535 secs
2025-03-13 16:54:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 12138 [episode count 18/20]
[retrieval_preprocessing] for episode 77564 [episode count 19/20], we have num_retrieval=np.int64(7061) num_query=np.int64(450)
2025-03-13 16:55:01,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:03,016 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:03
2025-03-13 16:55:03,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1247.19it/s]
2025-03-13 16:55:03,055 [INFO]: There are 7061 embeddings of dim 49152
2025-03-13 16:55:03,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0391 secs
2025-03-13 16:55:03,056 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:03
2025-03-13 16:55:03,056 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:03,057 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:55:03,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:03,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:55:03,057 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:03
2025-03-13 16:55:03,057 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:03,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:55:03,058 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:03
2025-03-13 16:55:03,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:03,058 [INFO]: 	Creating the index 03/13/2025, 16:55:03
2025-03-13 16:55:03,058 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:03
2025-03-13 16:55:03,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:55:03,062 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:03
2025-03-13 16:55:03,062 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:55:03,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.53it/s] 24%|██▍       | 7/29 [00:00<00:00, 33.95it/s] 41%|████▏     | 12/29 [00:00<00:00, 39.64it/s] 59%|█████▊    | 17/29 [00:00<00:00, 42.29it/s] 76%|███████▌  | 22/29 [00:04<00:02,  2.85it/s] 86%|████████▌ | 25/29 [00:04<00:01,  3.67it/s] 97%|█████████▋| 28/29 [00:05<00:00,  4.75it/s]100%|██████████| 29/29 [00:07<00:00,  3.70it/s]
2025-03-13 16:55:10,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:10
2025-03-13 16:56:12,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.9264 secs
2025-03-13 16:56:12,822 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:56:12,822 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 16:57:12,696 [INFO]: 	>>> Finished "Compute fast metrics" in 59.8734 secs
2025-03-13 16:57:12,698 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.6358 secs
2025-03-13 16:57:12,698 [INFO]: {
2025-03-13 16:57:12,698 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:12,698 [INFO]: 	index_param: efSearch=212
2025-03-13 16:57:12,698 [INFO]: 	index_path: knn.index
2025-03-13 16:57:12,698 [INFO]: 	size in bytes: 1389210010
2025-03-13 16:57:12,698 [INFO]: 	avg_search_speed_ms: 13.477926065008134
2025-03-13 16:57:12,698 [INFO]: 	99p_search_speed_ms: 20.410182585474107
2025-03-13 16:57:12,698 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:12,698 [INFO]: 	nb vectors: 7061
2025-03-13 16:57:12,698 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:12,698 [INFO]: 	compression ratio: 0.999308296086925
2025-03-13 16:57:12,698 [INFO]: }
2025-03-13 16:57:12,698 [INFO]: 	>>> Finished "Creating the index" in 129.6399 secs
2025-03-13 16:57:12,698 [INFO]: >>> Finished "Launching the whole pipeline" in 129.6815 secs
2025-03-13 16:57:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 77564 [episode count 19/20]
2025-03-13 16:57:18: [retrieval_preprocessing] finished for 5207831207_stack_cups [chosen_id count 3/196]
2025-03-13 16:57:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_top_drawer_file_cabinet [chosen_id count 4/196]
2025-03-13 16:57:19: [retrieval_preprocessing] we have num_total=1755 embedding_dim=49152
[retrieval_preprocessing] for episode 47105 [episode count 0/20], we have num_retrieval=np.int64(1672) num_query=np.int64(83)
2025-03-13 16:57:19,539 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:19,904 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:19
2025-03-13 16:57:19,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1265.63it/s]
2025-03-13 16:57:19,935 [INFO]: There are 1672 embeddings of dim 49152
2025-03-13 16:57:19,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 16:57:19,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:19
2025-03-13 16:57:19,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:19,935 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:57:19,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:19,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:19,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:19
2025-03-13 16:57:19,936 [INFO]: 345.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:19,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:57:19,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:19
2025-03-13 16:57:19,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:19,936 [INFO]: 	Creating the index 03/13/2025, 16:57:19
2025-03-13 16:57:19,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:19
2025-03-13 16:57:19,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:57:19,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:19
2025-03-13 16:57:19,937 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:57:19,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  7.66it/s] 71%|███████▏  | 5/7 [00:00<00:00, 23.78it/s]100%|██████████| 7/7 [00:01<00:00,  3.54it/s]
2025-03-13 16:57:21,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:21
2025-03-13 16:57:53,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0971 secs
2025-03-13 16:57:53,016 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:57:53,016 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.80it/s]
2025-03-13 16:58:08,752 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7352 secs
2025-03-13 16:58:08,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8160 secs
2025-03-13 16:58:08,753 [INFO]: {
2025-03-13 16:58:08,753 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:08,754 [INFO]: 	index_param: efSearch=237
2025-03-13 16:58:08,754 [INFO]: 	index_path: knn.index
2025-03-13 16:58:08,754 [INFO]: 	size in bytes: 328955890
2025-03-13 16:58:08,754 [INFO]: 	avg_search_speed_ms: 10.03360080601855
2025-03-13 16:58:08,754 [INFO]: 	99p_search_speed_ms: 19.794295979663726
2025-03-13 16:58:08,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:08,754 [INFO]: 	nb vectors: 1672
2025-03-13 16:58:08,754 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:08,754 [INFO]: 	compression ratio: 0.9993089833412011
2025-03-13 16:58:08,754 [INFO]: }
2025-03-13 16:58:08,754 [INFO]: 	>>> Finished "Creating the index" in 48.8177 secs
2025-03-13 16:58:08,754 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8499 secs
2025-03-13 16:58:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 47105 [episode count 0/20]
[retrieval_preprocessing] for episode 57354 [episode count 1/20], we have num_retrieval=np.int64(1654) num_query=np.int64(101)
2025-03-13 16:58:09,639 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:09,884 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:09
2025-03-13 16:58:09,884 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.46it/s]
2025-03-13 16:58:09,910 [INFO]: There are 1654 embeddings of dim 49152
2025-03-13 16:58:09,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 16:58:09,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:09
2025-03-13 16:58:09,911 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:09,911 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:58:09,911 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:09,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:58:09,911 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:09
2025-03-13 16:58:09,911 [INFO]: 341.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:09,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:58:09,911 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:09
2025-03-13 16:58:09,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:09,911 [INFO]: 	Creating the index 03/13/2025, 16:58:09
2025-03-13 16:58:09,911 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:09
2025-03-13 16:58:09,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:58:09,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:09
2025-03-13 16:58:09,913 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:58:09,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 16.47it/s]100%|██████████| 7/7 [00:01<00:00,  4.58it/s]100%|██████████| 7/7 [00:01<00:00,  4.88it/s]
2025-03-13 16:58:11,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:11
2025-03-13 16:58:33,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.2351 secs
2025-03-13 16:58:33,587 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 16:58:33,587 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 16:58:50,448 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8603 secs
2025-03-13 16:58:50,449 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.5369 secs
2025-03-13 16:58:50,450 [INFO]: {
2025-03-13 16:58:50,450 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:50,450 [INFO]: 	index_param: efSearch=163
2025-03-13 16:58:50,450 [INFO]: 	index_path: knn.index
2025-03-13 16:58:50,450 [INFO]: 	size in bytes: 325414510
2025-03-13 16:58:50,450 [INFO]: 	avg_search_speed_ms: 7.690163527687009
2025-03-13 16:58:50,450 [INFO]: 	99p_search_speed_ms: 13.644656320102513
2025-03-13 16:58:50,450 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:50,450 [INFO]: 	nb vectors: 1654
2025-03-13 16:58:50,450 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:50,450 [INFO]: 	compression ratio: 0.9993089490692962
2025-03-13 16:58:50,450 [INFO]: }
2025-03-13 16:58:50,450 [INFO]: 	>>> Finished "Creating the index" in 40.5384 secs
2025-03-13 16:58:50,450 [INFO]: >>> Finished "Launching the whole pipeline" in 40.5661 secs
2025-03-13 16:58:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 57354 [episode count 1/20]
[retrieval_preprocessing] for episode 55420 [episode count 2/20], we have num_retrieval=np.int64(1653) num_query=np.int64(102)
2025-03-13 16:58:51,119 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:51,347 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:51
2025-03-13 16:58:51,347 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.09it/s]
2025-03-13 16:58:51,376 [INFO]: There are 1653 embeddings of dim 49152
2025-03-13 16:58:51,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:58:51,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:51
2025-03-13 16:58:51,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:51,377 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:58:51,377 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:51,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:58:51,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:51
2025-03-13 16:58:51,377 [INFO]: 341.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:51,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:58:51,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:51
2025-03-13 16:58:51,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:51,377 [INFO]: 	Creating the index 03/13/2025, 16:58:51
2025-03-13 16:58:51,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:51
2025-03-13 16:58:51,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:58:51,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:51
2025-03-13 16:58:51,378 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:58:51,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.56it/s] 71%|███████▏  | 5/7 [00:00<00:00, 23.22it/s]100%|██████████| 7/7 [00:01<00:00,  4.75it/s]
2025-03-13 16:58:52,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:52
2025-03-13 16:59:14,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.3478 secs
2025-03-13 16:59:14,204 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:59:14,204 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.38it/s]
2025-03-13 16:59:35,049 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8451 secs
2025-03-13 16:59:35,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6721 secs
2025-03-13 16:59:35,050 [INFO]: {
2025-03-13 16:59:35,050 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:35,050 [INFO]: 	index_param: efSearch=197
2025-03-13 16:59:35,050 [INFO]: 	index_path: knn.index
2025-03-13 16:59:35,050 [INFO]: 	size in bytes: 325217770
2025-03-13 16:59:35,051 [INFO]: 	avg_search_speed_ms: 7.052310125551571
2025-03-13 16:59:35,051 [INFO]: 	99p_search_speed_ms: 9.66182302450761
2025-03-13 16:59:35,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:35,051 [INFO]: 	nb vectors: 1653
2025-03-13 16:59:35,051 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:35,051 [INFO]: 	compression ratio: 0.9993089369009571
2025-03-13 16:59:35,051 [INFO]: }
2025-03-13 16:59:35,051 [INFO]: 	>>> Finished "Creating the index" in 43.6736 secs
2025-03-13 16:59:35,051 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7032 secs
2025-03-13 16:59:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 55420 [episode count 2/20]
[retrieval_preprocessing] for episode 34944 [episode count 3/20], we have num_retrieval=np.int64(1658) num_query=np.int64(97)
2025-03-13 16:59:35,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:36,084 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:36
2025-03-13 16:59:36,084 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.40it/s]
2025-03-13 16:59:36,108 [INFO]: There are 1658 embeddings of dim 49152
2025-03-13 16:59:36,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 16:59:36,109 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:36
2025-03-13 16:59:36,109 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:36,109 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:59:36,109 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:36,109 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:36,109 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:36
2025-03-13 16:59:36,109 [INFO]: 342.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:36,109 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:59:36,109 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:36
2025-03-13 16:59:36,109 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:36,109 [INFO]: 	Creating the index 03/13/2025, 16:59:36
2025-03-13 16:59:36,109 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:36
2025-03-13 16:59:36,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:59:36,110 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:36
2025-03-13 16:59:36,110 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:59:36,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.60it/s] 86%|████████▌ | 6/7 [00:00<00:00, 28.29it/s]100%|██████████| 7/7 [00:02<00:00,  3.27it/s]
2025-03-13 16:59:38,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:38
2025-03-13 17:00:02,171 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9181 secs
2025-03-13 17:00:02,172 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 17:00:02,172 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-13 17:00:21,519 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3475 secs
2025-03-13 17:00:21,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4112 secs
2025-03-13 17:00:21,522 [INFO]: {
2025-03-13 17:00:21,522 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:21,522 [INFO]: 	index_param: efSearch=215
2025-03-13 17:00:21,522 [INFO]: 	index_path: knn.index
2025-03-13 17:00:21,522 [INFO]: 	size in bytes: 326201470
2025-03-13 17:00:21,522 [INFO]: 	avg_search_speed_ms: 9.948001346268242
2025-03-13 17:00:21,522 [INFO]: 	99p_search_speed_ms: 14.024002710357314
2025-03-13 17:00:21,522 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:21,522 [INFO]: 	nb vectors: 1658
2025-03-13 17:00:21,522 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:21,522 [INFO]: 	compression ratio: 0.9993089975958722
2025-03-13 17:00:21,522 [INFO]: }
2025-03-13 17:00:21,522 [INFO]: 	>>> Finished "Creating the index" in 45.4127 secs
2025-03-13 17:00:21,522 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4375 secs
2025-03-13 17:00:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 34944 [episode count 3/20]
[retrieval_preprocessing] for episode 80016 [episode count 4/20], we have num_retrieval=np.int64(1664) num_query=np.int64(91)
2025-03-13 17:00:22,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:23,329 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:23
2025-03-13 17:00:23,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1624.44it/s]
2025-03-13 17:00:23,355 [INFO]: There are 1664 embeddings of dim 49152
2025-03-13 17:00:23,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:00:23,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:23
2025-03-13 17:00:23,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:23,356 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:00:23,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:23,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:23,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:23
2025-03-13 17:00:23,356 [INFO]: 343.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:23,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:00:23,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:23
2025-03-13 17:00:23,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:23,356 [INFO]: 	Creating the index 03/13/2025, 17:00:23
2025-03-13 17:00:23,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:23
2025-03-13 17:00:23,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:00:23,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:23
2025-03-13 17:00:23,358 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:00:23,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  7.65it/s] 71%|███████▏  | 5/7 [00:00<00:00, 21.02it/s]100%|██████████| 7/7 [00:02<00:00,  2.55it/s]
2025-03-13 17:00:26,111 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:26
2025-03-13 17:00:48,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.5941 secs
2025-03-13 17:00:48,706 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:00:48,706 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 17:01:09,715 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0081 secs
2025-03-13 17:01:09,716 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3585 secs
2025-03-13 17:01:09,716 [INFO]: {
2025-03-13 17:01:09,716 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:09,716 [INFO]: 	index_param: efSearch=235
2025-03-13 17:01:09,716 [INFO]: 	index_path: knn.index
2025-03-13 17:01:09,716 [INFO]: 	size in bytes: 327381910
2025-03-13 17:01:09,716 [INFO]: 	avg_search_speed_ms: 8.41937738377444
2025-03-13 17:01:09,716 [INFO]: 	99p_search_speed_ms: 13.094516093842682
2025-03-13 17:01:09,716 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:09,717 [INFO]: 	nb vectors: 1664
2025-03-13 17:01:09,717 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:09,717 [INFO]: 	compression ratio: 0.9993090699483059
2025-03-13 17:01:09,717 [INFO]: }
2025-03-13 17:01:09,717 [INFO]: 	>>> Finished "Creating the index" in 46.3603 secs
2025-03-13 17:01:09,717 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3872 secs
2025-03-13 17:01:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 80016 [episode count 4/20]
[retrieval_preprocessing] for episode 57756 [episode count 5/20], we have num_retrieval=np.int64(1664) num_query=np.int64(91)
2025-03-13 17:01:10,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:10,960 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:10
2025-03-13 17:01:10,960 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.74it/s]
2025-03-13 17:01:10,990 [INFO]: There are 1664 embeddings of dim 49152
2025-03-13 17:01:10,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 17:01:10,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:10,991 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:01:10,991 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:10,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:01:10,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,991 [INFO]: 343.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:10,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:01:10,991 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:10
2025-03-13 17:01:10,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:10,991 [INFO]: 	Creating the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,991 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:10
2025-03-13 17:01:10,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:01:10,992 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:10
2025-03-13 17:01:10,992 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:01:10,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.69it/s] 86%|████████▌ | 6/7 [00:00<00:00, 31.31it/s]100%|██████████| 7/7 [00:01<00:00,  4.60it/s]
2025-03-13 17:01:12,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:12
2025-03-13 17:01:34,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.4791 secs
2025-03-13 17:01:34,997 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:01:34,997 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 17:01:58,858 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8603 secs
2025-03-13 17:01:58,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8666 secs
2025-03-13 17:01:58,859 [INFO]: {
2025-03-13 17:01:58,859 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:58,859 [INFO]: 	index_param: efSearch=201
2025-03-13 17:01:58,859 [INFO]: 	index_path: knn.index
2025-03-13 17:01:58,859 [INFO]: 	size in bytes: 327381910
2025-03-13 17:01:58,859 [INFO]: 	avg_search_speed_ms: 7.778382053364121
2025-03-13 17:01:58,859 [INFO]: 	99p_search_speed_ms: 11.381568911019723
2025-03-13 17:01:58,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:58,859 [INFO]: 	nb vectors: 1664
2025-03-13 17:01:58,859 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:58,859 [INFO]: 	compression ratio: 0.9993090699483059
2025-03-13 17:01:58,859 [INFO]: }
2025-03-13 17:01:58,859 [INFO]: 	>>> Finished "Creating the index" in 47.8683 secs
2025-03-13 17:01:58,859 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8992 secs
2025-03-13 17:01:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 57756 [episode count 5/20]
[retrieval_preprocessing] for episode 37095 [episode count 6/20], we have num_retrieval=np.int64(1629) num_query=np.int64(126)
2025-03-13 17:01:59,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:00,433 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:00
2025-03-13 17:02:00,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.04it/s]
2025-03-13 17:02:00,459 [INFO]: There are 1629 embeddings of dim 49152
2025-03-13 17:02:00,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:02:00,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:00,460 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:02:00,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:00,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:00,460 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,460 [INFO]: 336.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:00,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:00,460 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:00
2025-03-13 17:02:00,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:00,460 [INFO]: 	Creating the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,460 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:00
2025-03-13 17:02:00,462 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:02:00,462 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,462 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:02:00,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 16.63it/s] 86%|████████▌ | 6/7 [00:00<00:00, 27.68it/s]100%|██████████| 7/7 [00:01<00:00,  4.53it/s]
2025-03-13 17:02:02,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:02
2025-03-13 17:02:26,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6757 secs
2025-03-13 17:02:26,687 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:02:26,687 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.93it/s]
2025-03-13 17:02:42,064 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3770 secs
2025-03-13 17:02:42,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6044 secs
2025-03-13 17:02:42,066 [INFO]: {
2025-03-13 17:02:42,066 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:42,066 [INFO]: 	index_param: efSearch=155
2025-03-13 17:02:42,066 [INFO]: 	index_path: knn.index
2025-03-13 17:02:42,066 [INFO]: 	size in bytes: 320495950
2025-03-13 17:02:42,067 [INFO]: 	avg_search_speed_ms: 8.84580866484734
2025-03-13 17:02:42,067 [INFO]: 	99p_search_speed_ms: 18.55879309587182
2025-03-13 17:02:42,067 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:42,067 [INFO]: 	nb vectors: 1629
2025-03-13 17:02:42,067 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:42,067 [INFO]: 	compression ratio: 0.9993088274594422
2025-03-13 17:02:42,067 [INFO]: }
2025-03-13 17:02:42,067 [INFO]: 	>>> Finished "Creating the index" in 41.6064 secs
2025-03-13 17:02:42,067 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6334 secs
2025-03-13 17:02:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 37095 [episode count 6/20]
[retrieval_preprocessing] for episode 65791 [episode count 7/20], we have num_retrieval=np.int64(1658) num_query=np.int64(97)
2025-03-13 17:02:43,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:44,008 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:44
2025-03-13 17:02:44,009 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-13 17:02:44,039 [INFO]: There are 1658 embeddings of dim 49152
2025-03-13 17:02:44,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:02:44,040 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:44
2025-03-13 17:02:44,040 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:44,040 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:02:44,040 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:44,040 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:44,040 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:44
2025-03-13 17:02:44,040 [INFO]: 342.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:44,040 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:44,040 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:44
2025-03-13 17:02:44,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:44,040 [INFO]: 	Creating the index 03/13/2025, 17:02:44
2025-03-13 17:02:44,040 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:44
2025-03-13 17:02:44,042 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:02:44,042 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:44
2025-03-13 17:02:44,042 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:02:44,042 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.37it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.00it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.97it/s]100%|██████████| 7/7 [00:02<00:00,  2.66it/s]100%|██████████| 7/7 [00:02<00:00,  3.45it/s]
2025-03-13 17:02:46,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:46
2025-03-13 17:03:10,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3181 secs
2025-03-13 17:03:10,395 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:03:10,395 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-13 17:03:30,437 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0415 secs
2025-03-13 17:03:30,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3968 secs
2025-03-13 17:03:30,439 [INFO]: {
2025-03-13 17:03:30,439 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:30,439 [INFO]: 	index_param: efSearch=234
2025-03-13 17:03:30,439 [INFO]: 	index_path: knn.index
2025-03-13 17:03:30,439 [INFO]: 	size in bytes: 326201470
2025-03-13 17:03:30,439 [INFO]: 	avg_search_speed_ms: 8.605642196331205
2025-03-13 17:03:30,439 [INFO]: 	99p_search_speed_ms: 12.362180096097298
2025-03-13 17:03:30,439 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:30,439 [INFO]: 	nb vectors: 1658
2025-03-13 17:03:30,439 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:30,439 [INFO]: 	compression ratio: 0.9993089975958722
2025-03-13 17:03:30,439 [INFO]: }
2025-03-13 17:03:30,439 [INFO]: 	>>> Finished "Creating the index" in 46.3986 secs
2025-03-13 17:03:30,439 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4304 secs
2025-03-13 17:03:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 65791 [episode count 7/20]
[retrieval_preprocessing] for episode 82815 [episode count 8/20], we have num_retrieval=np.int64(1661) num_query=np.int64(94)
2025-03-13 17:03:31,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:32,209 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:32
2025-03-13 17:03:32,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.69it/s]
2025-03-13 17:03:32,234 [INFO]: There are 1661 embeddings of dim 49152
2025-03-13 17:03:32,235 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:03:32,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:32
2025-03-13 17:03:32,235 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:32,235 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:03:32,235 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:32,235 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:03:32,235 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:32
2025-03-13 17:03:32,235 [INFO]: 342.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:32,235 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:03:32,235 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:32
2025-03-13 17:03:32,235 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:32,235 [INFO]: 	Creating the index 03/13/2025, 17:03:32
2025-03-13 17:03:32,235 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:32
2025-03-13 17:03:32,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:03:32,236 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:32
2025-03-13 17:03:32,236 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:03:32,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.13it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.27it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.23it/s]100%|██████████| 7/7 [00:01<00:00,  2.85it/s]100%|██████████| 7/7 [00:01<00:00,  3.67it/s]
2025-03-13 17:03:34,147 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:34
2025-03-13 17:03:54,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7238 secs
2025-03-13 17:03:54,872 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:03:54,872 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 17:04:13,418 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5462 secs
2025-03-13 17:04:13,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1837 secs
2025-03-13 17:04:13,420 [INFO]: {
2025-03-13 17:04:13,420 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:13,420 [INFO]: 	index_param: efSearch=200
2025-03-13 17:04:13,420 [INFO]: 	index_path: knn.index
2025-03-13 17:04:13,420 [INFO]: 	size in bytes: 326791690
2025-03-13 17:04:13,420 [INFO]: 	avg_search_speed_ms: 8.862211081035872
2025-03-13 17:04:13,420 [INFO]: 	99p_search_speed_ms: 18.627262776717547
2025-03-13 17:04:13,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:13,420 [INFO]: 	nb vectors: 1661
2025-03-13 17:04:13,420 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:13,420 [INFO]: 	compression ratio: 0.9993090338374271
2025-03-13 17:04:13,420 [INFO]: }
2025-03-13 17:04:13,420 [INFO]: 	>>> Finished "Creating the index" in 41.1851 secs
2025-03-13 17:04:13,420 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2111 secs
2025-03-13 17:04:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 82815 [episode count 8/20]
[retrieval_preprocessing] for episode 91334 [episode count 9/20], we have num_retrieval=np.int64(1686) num_query=np.int64(69)
2025-03-13 17:04:14,665 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:14,917 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:14
2025-03-13 17:04:14,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1190.89it/s]
2025-03-13 17:04:14,943 [INFO]: There are 1686 embeddings of dim 49152
2025-03-13 17:04:14,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 17:04:14,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:14
2025-03-13 17:04:14,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:14,943 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:04:14,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:14,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:14,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:14
2025-03-13 17:04:14,943 [INFO]: 347.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:14,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:14,944 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:14
2025-03-13 17:04:14,944 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:14,944 [INFO]: 	Creating the index 03/13/2025, 17:04:14
2025-03-13 17:04:14,944 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:14
2025-03-13 17:04:14,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:04:14,945 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:14
2025-03-13 17:04:14,945 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:04:14,945 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.81it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.31it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.32it/s]100%|██████████| 7/7 [00:01<00:00,  3.22it/s]100%|██████████| 7/7 [00:01<00:00,  4.07it/s]
2025-03-13 17:04:16,667 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:16
2025-03-13 17:04:39,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8071 secs
2025-03-13 17:04:39,475 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 17:04:39,475 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 17:04:58,338 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8627 secs
2025-03-13 17:04:58,492 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5470 secs
2025-03-13 17:04:58,492 [INFO]: {
2025-03-13 17:04:58,492 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:58,492 [INFO]: 	index_param: efSearch=292
2025-03-13 17:04:58,492 [INFO]: 	index_path: knn.index
2025-03-13 17:04:58,492 [INFO]: 	size in bytes: 331710370
2025-03-13 17:04:58,492 [INFO]: 	avg_search_speed_ms: 9.82510794250547
2025-03-13 17:04:58,492 [INFO]: 	99p_search_speed_ms: 14.722791786771271
2025-03-13 17:04:58,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:58,493 [INFO]: 	nb vectors: 1686
2025-03-13 17:04:58,493 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:58,493 [INFO]: 	compression ratio: 0.9993087885675688
2025-03-13 17:04:58,493 [INFO]: }
2025-03-13 17:04:58,493 [INFO]: 	>>> Finished "Creating the index" in 43.5491 secs
2025-03-13 17:04:58,493 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5758 secs
2025-03-13 17:04:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 91334 [episode count 9/20]
[retrieval_preprocessing] for episode 56548 [episode count 10/20], we have num_retrieval=np.int64(1686) num_query=np.int64(69)
2025-03-13 17:04:59,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:59,963 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:59
2025-03-13 17:04:59,963 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-13 17:04:59,989 [INFO]: There are 1686 embeddings of dim 49152
2025-03-13 17:04:59,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:04:59,989 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:59
2025-03-13 17:04:59,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:59,989 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:04:59,989 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:59,989 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:59,989 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:59
2025-03-13 17:04:59,989 [INFO]: 347.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:59,989 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:59,989 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:59
2025-03-13 17:04:59,989 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:59,989 [INFO]: 	Creating the index 03/13/2025, 17:04:59
2025-03-13 17:04:59,989 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:59
2025-03-13 17:04:59,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:04:59,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:59
2025-03-13 17:04:59,990 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:04:59,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.01it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.67it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.50it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.76it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.05it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.22it/s]100%|██████████| 7/7 [00:02<00:00,  1.96it/s]100%|██████████| 7/7 [00:02<00:00,  3.35it/s]
2025-03-13 17:05:02,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:02
2025-03-13 17:05:26,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7248 secs
2025-03-13 17:05:26,810 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 17:05:26,810 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s]
2025-03-13 17:05:53,017 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2075 secs
2025-03-13 17:05:53,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0293 secs
2025-03-13 17:05:53,020 [INFO]: {
2025-03-13 17:05:53,020 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:53,020 [INFO]: 	index_param: efSearch=301
2025-03-13 17:05:53,020 [INFO]: 	index_path: knn.index
2025-03-13 17:05:53,020 [INFO]: 	size in bytes: 331710370
2025-03-13 17:05:53,020 [INFO]: 	avg_search_speed_ms: 10.724441005098699
2025-03-13 17:05:53,020 [INFO]: 	99p_search_speed_ms: 22.520903563126915
2025-03-13 17:05:53,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:53,020 [INFO]: 	nb vectors: 1686
2025-03-13 17:05:53,020 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:53,020 [INFO]: 	compression ratio: 0.9993087885675688
2025-03-13 17:05:53,020 [INFO]: }
2025-03-13 17:05:53,020 [INFO]: 	>>> Finished "Creating the index" in 53.0309 secs
2025-03-13 17:05:53,020 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0571 secs
2025-03-13 17:05:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 56548 [episode count 10/20]
[retrieval_preprocessing] for episode 77028 [episode count 11/20], we have num_retrieval=np.int64(1701) num_query=np.int64(54)
2025-03-13 17:05:54,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:55,822 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:55
2025-03-13 17:05:55,822 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1304.60it/s]
2025-03-13 17:05:55,847 [INFO]: There are 1701 embeddings of dim 49152
2025-03-13 17:05:55,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 17:05:55,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:55
2025-03-13 17:05:55,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:55,847 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:05:55,847 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:55,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:55,847 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:55
2025-03-13 17:05:55,847 [INFO]: 351.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:55,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:05:55,848 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:55
2025-03-13 17:05:55,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:55,848 [INFO]: 	Creating the index 03/13/2025, 17:05:55
2025-03-13 17:05:55,848 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:55
2025-03-13 17:05:55,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:05:55,849 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:55
2025-03-13 17:05:55,849 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:05:55,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.03it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.17it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.24it/s]100%|██████████| 7/7 [00:01<00:00,  2.72it/s]100%|██████████| 7/7 [00:01<00:00,  3.52it/s]
2025-03-13 17:05:57,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:57
2025-03-13 17:06:18,599 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7533 secs
2025-03-13 17:06:18,600 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 17:06:18,600 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 17:06:34,161 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5614 secs
2025-03-13 17:06:34,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3145 secs
2025-03-13 17:06:34,163 [INFO]: {
2025-03-13 17:06:34,163 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:34,163 [INFO]: 	index_param: efSearch=228
2025-03-13 17:06:34,163 [INFO]: 	index_path: knn.index
2025-03-13 17:06:34,163 [INFO]: 	size in bytes: 334661470
2025-03-13 17:06:34,163 [INFO]: 	avg_search_speed_ms: 7.696399480259308
2025-03-13 17:06:34,163 [INFO]: 	99p_search_speed_ms: 10.709489127621055
2025-03-13 17:06:34,163 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:34,163 [INFO]: 	nb vectors: 1701
2025-03-13 17:06:34,163 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:34,163 [INFO]: 	compression ratio: 0.9993089673573716
2025-03-13 17:06:34,163 [INFO]: }
2025-03-13 17:06:34,163 [INFO]: 	>>> Finished "Creating the index" in 38.3158 secs
2025-03-13 17:06:34,163 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3418 secs
2025-03-13 17:06:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 77028 [episode count 11/20]
[retrieval_preprocessing] for episode 17662 [episode count 12/20], we have num_retrieval=np.int64(1680) num_query=np.int64(75)
2025-03-13 17:06:35,063 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:35,319 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:35
2025-03-13 17:06:35,319 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.33it/s]
2025-03-13 17:06:35,344 [INFO]: There are 1680 embeddings of dim 49152
2025-03-13 17:06:35,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 17:06:35,344 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:35
2025-03-13 17:06:35,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:35,344 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:06:35,344 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:35,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:06:35,344 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:35
2025-03-13 17:06:35,344 [INFO]: 346.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:35,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:06:35,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:35
2025-03-13 17:06:35,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:35,344 [INFO]: 	Creating the index 03/13/2025, 17:06:35
2025-03-13 17:06:35,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:35
2025-03-13 17:06:35,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:06:35,346 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:35
2025-03-13 17:06:35,346 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:06:35,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.48it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.06it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.50it/s]100%|██████████| 7/7 [00:02<00:00,  2.62it/s]100%|██████████| 7/7 [00:02<00:00,  3.40it/s]
2025-03-13 17:06:37,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:37
2025-03-13 17:06:59,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3826 secs
2025-03-13 17:06:59,792 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:06:59,792 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 17:07:14,724 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9316 secs
2025-03-13 17:07:14,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.3799 secs
2025-03-13 17:07:14,726 [INFO]: {
2025-03-13 17:07:14,726 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:14,726 [INFO]: 	index_param: efSearch=270
2025-03-13 17:07:14,726 [INFO]: 	index_path: knn.index
2025-03-13 17:07:14,726 [INFO]: 	size in bytes: 330529870
2025-03-13 17:07:14,726 [INFO]: 	avg_search_speed_ms: 10.661420987736284
2025-03-13 17:07:14,726 [INFO]: 	99p_search_speed_ms: 18.504201769828796
2025-03-13 17:07:14,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:14,726 [INFO]: 	nb vectors: 1680
2025-03-13 17:07:14,726 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:14,726 [INFO]: 	compression ratio: 0.9993088975589407
2025-03-13 17:07:14,726 [INFO]: }
2025-03-13 17:07:14,726 [INFO]: 	>>> Finished "Creating the index" in 39.3815 secs
2025-03-13 17:07:14,726 [INFO]: >>> Finished "Launching the whole pipeline" in 39.4066 secs
2025-03-13 17:07:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 17662 [episode count 12/20]
[retrieval_preprocessing] for episode 79482 [episode count 13/20], we have num_retrieval=np.int64(1684) num_query=np.int64(71)
2025-03-13 17:07:18,479 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:18,740 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:18
2025-03-13 17:07:18,740 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1752.01it/s]
2025-03-13 17:07:18,763 [INFO]: There are 1684 embeddings of dim 49152
2025-03-13 17:07:18,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 17:07:18,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:18
2025-03-13 17:07:18,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:18,763 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:07:18,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:18,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:07:18,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:18
2025-03-13 17:07:18,763 [INFO]: 347.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:18,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:07:18,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:18
2025-03-13 17:07:18,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:18,763 [INFO]: 	Creating the index 03/13/2025, 17:07:18
2025-03-13 17:07:18,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:18
2025-03-13 17:07:18,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:07:18,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:18
2025-03-13 17:07:18,764 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:07:18,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  7.99it/s] 43%|████▎     | 3/7 [00:00<00:00, 13.18it/s] 71%|███████▏  | 5/7 [00:00<00:00, 14.43it/s]100%|██████████| 7/7 [00:01<00:00,  3.13it/s]100%|██████████| 7/7 [00:01<00:00,  4.14it/s]
2025-03-13 17:07:20,456 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:20
2025-03-13 17:07:40,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.5399 secs
2025-03-13 17:07:40,997 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 17:07:40,997 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 17:08:14,107 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1095 secs
2025-03-13 17:08:14,514 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7494 secs
2025-03-13 17:08:14,514 [INFO]: {
2025-03-13 17:08:14,514 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:14,514 [INFO]: 	index_param: efSearch=260
2025-03-13 17:08:14,515 [INFO]: 	index_path: knn.index
2025-03-13 17:08:14,515 [INFO]: 	size in bytes: 331316890
2025-03-13 17:08:14,515 [INFO]: 	avg_search_speed_ms: 8.91262935594873
2025-03-13 17:08:14,515 [INFO]: 	99p_search_speed_ms: 17.666400931775566
2025-03-13 17:08:14,515 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:14,515 [INFO]: 	nb vectors: 1684
2025-03-13 17:08:14,515 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:14,515 [INFO]: 	compression ratio: 0.9993087644882819
2025-03-13 17:08:14,515 [INFO]: }
2025-03-13 17:08:14,515 [INFO]: 	>>> Finished "Creating the index" in 55.7517 secs
2025-03-13 17:08:14,515 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7750 secs
2025-03-13 17:08:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 79482 [episode count 13/20]
[retrieval_preprocessing] for episode 81542 [episode count 14/20], we have num_retrieval=np.int64(1675) num_query=np.int64(80)
2025-03-13 17:08:15,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:16,017 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:16
2025-03-13 17:08:16,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.83it/s]
2025-03-13 17:08:16,043 [INFO]: There are 1675 embeddings of dim 49152
2025-03-13 17:08:16,043 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:08:16,043 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:16
2025-03-13 17:08:16,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:16,044 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:08:16,044 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:16,044 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:16,044 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:16
2025-03-13 17:08:16,044 [INFO]: 345.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:16,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:08:16,044 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:16
2025-03-13 17:08:16,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:16,044 [INFO]: 	Creating the index 03/13/2025, 17:08:16
2025-03-13 17:08:16,044 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:16
2025-03-13 17:08:16,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:08:16,045 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:16
2025-03-13 17:08:16,045 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:08:16,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.33it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.61it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.14it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.54it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.61it/s] 86%|████████▌ | 6/7 [00:00<00:00,  7.87it/s]100%|██████████| 7/7 [00:02<00:00,  1.30it/s]100%|██████████| 7/7 [00:02<00:00,  2.41it/s]
2025-03-13 17:08:18,950 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:18
2025-03-13 17:08:43,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7590 secs
2025-03-13 17:08:43,710 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 17:08:43,710 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 17:09:00,366 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6564 secs
2025-03-13 17:09:00,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3233 secs
2025-03-13 17:09:00,369 [INFO]: {
2025-03-13 17:09:00,369 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:00,369 [INFO]: 	index_param: efSearch=165
2025-03-13 17:09:00,369 [INFO]: 	index_path: knn.index
2025-03-13 17:09:00,369 [INFO]: 	size in bytes: 329546110
2025-03-13 17:09:00,369 [INFO]: 	avg_search_speed_ms: 8.340252155952273
2025-03-13 17:09:00,369 [INFO]: 	99p_search_speed_ms: 19.989679558202624
2025-03-13 17:09:00,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:00,369 [INFO]: 	nb vectors: 1675
2025-03-13 17:09:00,369 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:00,369 [INFO]: 	compression ratio: 0.9993090193053713
2025-03-13 17:09:00,369 [INFO]: }
2025-03-13 17:09:00,369 [INFO]: 	>>> Finished "Creating the index" in 44.3248 secs
2025-03-13 17:09:00,369 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3520 secs
2025-03-13 17:09:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 81542 [episode count 14/20]
[retrieval_preprocessing] for episode 1355 [episode count 15/20], we have num_retrieval=np.int64(1678) num_query=np.int64(77)
2025-03-13 17:09:02,696 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:02,977 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:02
2025-03-13 17:09:02,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.76it/s]
2025-03-13 17:09:03,004 [INFO]: There are 1678 embeddings of dim 49152
2025-03-13 17:09:03,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:09:03,004 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:03,004 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:09:03,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:03,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:03,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,004 [INFO]: 346.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:03,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:09:03,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:03
2025-03-13 17:09:03,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:03,005 [INFO]: 	Creating the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,005 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:03
2025-03-13 17:09:03,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:09:03,006 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,006 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:09:03,006 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.67it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.75it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.83it/s]100%|██████████| 7/7 [00:02<00:00,  2.45it/s]100%|██████████| 7/7 [00:02<00:00,  3.20it/s]
2025-03-13 17:09:05,200 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:05
2025-03-13 17:09:27,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0025 secs
2025-03-13 17:09:27,204 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 17:09:27,204 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 17:09:48,225 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0215 secs
2025-03-13 17:09:48,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2213 secs
2025-03-13 17:09:48,227 [INFO]: {
2025-03-13 17:09:48,227 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:48,227 [INFO]: 	index_param: efSearch=258
2025-03-13 17:09:48,227 [INFO]: 	index_path: knn.index
2025-03-13 17:09:48,227 [INFO]: 	size in bytes: 330136390
2025-03-13 17:09:48,227 [INFO]: 	avg_search_speed_ms: 10.638791583032605
2025-03-13 17:09:48,227 [INFO]: 	99p_search_speed_ms: 22.433377858251344
2025-03-13 17:09:48,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:48,228 [INFO]: 	nb vectors: 1678
2025-03-13 17:09:48,228 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:48,228 [INFO]: 	compression ratio: 0.999308873523455
2025-03-13 17:09:48,228 [INFO]: }
2025-03-13 17:09:48,228 [INFO]: 	>>> Finished "Creating the index" in 45.2230 secs
2025-03-13 17:09:48,228 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2505 secs
2025-03-13 17:09:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 1355 [episode count 15/20]
[retrieval_preprocessing] for episode 77131 [episode count 16/20], we have num_retrieval=np.int64(1601) num_query=np.int64(154)
2025-03-13 17:09:49,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:50,124 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:50
2025-03-13 17:09:50,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 977.47it/s]
2025-03-13 17:09:50,154 [INFO]: There are 1601 embeddings of dim 49152
2025-03-13 17:09:50,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:09:50,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:50
2025-03-13 17:09:50,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:50,154 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:09:50,154 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:50,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:09:50,154 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:50
2025-03-13 17:09:50,155 [INFO]: 330.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:50,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:09:50,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:50
2025-03-13 17:09:50,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:50,155 [INFO]: 	Creating the index 03/13/2025, 17:09:50
2025-03-13 17:09:50,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:50
2025-03-13 17:09:50,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:09:50,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:50
2025-03-13 17:09:50,156 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:09:50,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.49it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.76it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.41it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.51it/s]100%|██████████| 7/7 [00:02<00:00,  2.61it/s]100%|██████████| 7/7 [00:02<00:00,  3.42it/s]
2025-03-13 17:09:52,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:52
2025-03-13 17:10:15,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3719 secs
2025-03-13 17:10:15,577 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 17:10:15,577 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-13 17:10:36,702 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1250 secs
2025-03-13 17:10:36,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5474 secs
2025-03-13 17:10:36,704 [INFO]: {
2025-03-13 17:10:36,704 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:36,704 [INFO]: 	index_param: efSearch=233
2025-03-13 17:10:36,704 [INFO]: 	index_path: knn.index
2025-03-13 17:10:36,704 [INFO]: 	size in bytes: 314987050
2025-03-13 17:10:36,704 [INFO]: 	avg_search_speed_ms: 7.912516837815836
2025-03-13 17:10:36,704 [INFO]: 	99p_search_speed_ms: 13.149611740373063
2025-03-13 17:10:36,704 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:36,704 [INFO]: 	nb vectors: 1601
2025-03-13 17:10:36,704 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:36,704 [INFO]: 	compression ratio: 0.9993090446099292
2025-03-13 17:10:36,704 [INFO]: }
2025-03-13 17:10:36,704 [INFO]: 	>>> Finished "Creating the index" in 46.5490 secs
2025-03-13 17:10:36,704 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5792 secs
2025-03-13 17:10:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 77131 [episode count 16/20]
[retrieval_preprocessing] for episode 81298 [episode count 17/20], we have num_retrieval=np.int64(1670) num_query=np.int64(85)
2025-03-13 17:10:38,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:39,565 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:39
2025-03-13 17:10:39,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2197.12it/s]
2025-03-13 17:10:39,589 [INFO]: There are 1670 embeddings of dim 49152
2025-03-13 17:10:39,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 17:10:39,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:39
2025-03-13 17:10:39,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:39,590 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:10:39,590 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:39,590 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:10:39,590 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:39
2025-03-13 17:10:39,590 [INFO]: 344.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:39,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:10:39,590 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:39
2025-03-13 17:10:39,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:39,591 [INFO]: 	Creating the index 03/13/2025, 17:10:39
2025-03-13 17:10:39,591 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:39
2025-03-13 17:10:39,593 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:10:39,593 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:39
2025-03-13 17:10:39,593 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:10:39,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.54it/s] 57%|█████▋    | 4/7 [00:00<00:00, 18.07it/s]100%|██████████| 7/7 [00:01<00:00,  4.22it/s]100%|██████████| 7/7 [00:01<00:00,  4.93it/s]
2025-03-13 17:10:41,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:41
2025-03-13 17:11:03,082 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0658 secs
2025-03-13 17:11:03,082 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:11:03,082 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 17:11:27,159 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0773 secs
2025-03-13 17:11:27,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5680 secs
2025-03-13 17:11:27,161 [INFO]: {
2025-03-13 17:11:27,161 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:27,161 [INFO]: 	index_param: efSearch=235
2025-03-13 17:11:27,161 [INFO]: 	index_path: knn.index
2025-03-13 17:11:27,161 [INFO]: 	size in bytes: 328562350
2025-03-13 17:11:27,161 [INFO]: 	avg_search_speed_ms: 8.442882876339796
2025-03-13 17:11:27,161 [INFO]: 	99p_search_speed_ms: 14.919894251506784
2025-03-13 17:11:27,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:27,161 [INFO]: 	nb vectors: 1670
2025-03-13 17:11:27,161 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:27,161 [INFO]: 	compression ratio: 0.9993091417808523
2025-03-13 17:11:27,161 [INFO]: }
2025-03-13 17:11:27,161 [INFO]: 	>>> Finished "Creating the index" in 47.5707 secs
2025-03-13 17:11:27,161 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5959 secs
2025-03-13 17:11:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 81298 [episode count 17/20]
[retrieval_preprocessing] for episode 36398 [episode count 18/20], we have num_retrieval=np.int64(1668) num_query=np.int64(87)
2025-03-13 17:11:28,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:28,676 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:28
2025-03-13 17:11:28,676 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.83it/s]
2025-03-13 17:11:28,701 [INFO]: There are 1668 embeddings of dim 49152
2025-03-13 17:11:28,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:11:28,701 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:28
2025-03-13 17:11:28,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:28,701 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:11:28,701 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:28,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:28,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:28
2025-03-13 17:11:28,701 [INFO]: 344.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:28,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:11:28,701 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:28
2025-03-13 17:11:28,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:28,701 [INFO]: 	Creating the index 03/13/2025, 17:11:28
2025-03-13 17:11:28,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:28
2025-03-13 17:11:28,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:11:28,703 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:28
2025-03-13 17:11:28,703 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:11:28,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.31it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.88it/s] 71%|███████▏  | 5/7 [00:00<00:00, 11.11it/s]100%|██████████| 7/7 [00:02<00:00,  2.67it/s]100%|██████████| 7/7 [00:02<00:00,  3.48it/s]
2025-03-13 17:11:30,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:30
2025-03-13 17:11:52,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.2968 secs
2025-03-13 17:11:52,019 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:11:52,019 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 50%|█████     | 2/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.49it/s]
2025-03-13 17:12:16,078 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0584 secs
2025-03-13 17:12:16,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7615 secs
2025-03-13 17:12:16,465 [INFO]: {
2025-03-13 17:12:16,465 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:16,465 [INFO]: 	index_param: efSearch=176
2025-03-13 17:12:16,465 [INFO]: 	index_path: knn.index
2025-03-13 17:12:16,465 [INFO]: 	size in bytes: 328168870
2025-03-13 17:12:16,465 [INFO]: 	avg_search_speed_ms: 7.649686002951364
2025-03-13 17:12:16,465 [INFO]: 	99p_search_speed_ms: 13.131385152228194
2025-03-13 17:12:16,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:16,466 [INFO]: 	nb vectors: 1668
2025-03-13 17:12:16,466 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:16,466 [INFO]: 	compression ratio: 0.999309117894089
2025-03-13 17:12:16,466 [INFO]: }
2025-03-13 17:12:16,466 [INFO]: 	>>> Finished "Creating the index" in 47.7643 secs
2025-03-13 17:12:16,466 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7899 secs
2025-03-13 17:12:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 36398 [episode count 18/20]
[retrieval_preprocessing] for episode 64833 [episode count 19/20], we have num_retrieval=np.int64(1703) num_query=np.int64(52)
2025-03-13 17:12:18,075 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:18,445 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:18
2025-03-13 17:12:18,445 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2148.72it/s]
2025-03-13 17:12:18,468 [INFO]: There are 1703 embeddings of dim 49152
2025-03-13 17:12:18,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 17:12:18,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:18
2025-03-13 17:12:18,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:18,468 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:12:18,468 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:18,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:18,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:18
2025-03-13 17:12:18,468 [INFO]: 351.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:18,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:12:18,468 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:18
2025-03-13 17:12:18,468 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:18,469 [INFO]: 	Creating the index 03/13/2025, 17:12:18
2025-03-13 17:12:18,469 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:18
2025-03-13 17:12:18,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:12:18,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:18
2025-03-13 17:12:18,470 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:12:18,470 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.30it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.13it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.07it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.27it/s]100%|██████████| 7/7 [00:02<00:00,  1.50it/s]100%|██████████| 7/7 [00:02<00:00,  2.49it/s]
2025-03-13 17:12:21,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:21
2025-03-13 17:12:45,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1691 secs
2025-03-13 17:12:45,455 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 17:12:45,455 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 17:13:05,805 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3504 secs
2025-03-13 17:13:05,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3378 secs
2025-03-13 17:13:05,808 [INFO]: {
2025-03-13 17:13:05,808 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:05,808 [INFO]: 	index_param: efSearch=246
2025-03-13 17:13:05,808 [INFO]: 	index_path: knn.index
2025-03-13 17:13:05,808 [INFO]: 	size in bytes: 335054950
2025-03-13 17:13:05,808 [INFO]: 	avg_search_speed_ms: 9.629304670478657
2025-03-13 17:13:05,808 [INFO]: 	99p_search_speed_ms: 15.064446977339685
2025-03-13 17:13:05,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:05,808 [INFO]: 	nb vectors: 1703
2025-03-13 17:13:05,808 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:05,808 [INFO]: 	compression ratio: 0.9993089909580503
2025-03-13 17:13:05,808 [INFO]: }
2025-03-13 17:13:05,808 [INFO]: 	>>> Finished "Creating the index" in 47.3392 secs
2025-03-13 17:13:05,808 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3630 secs
2025-03-13 17:13:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 64833 [episode count 19/20]
2025-03-13 17:13:06: [retrieval_preprocessing] finished for 5235850418_close_top_drawer_file_cabinet [chosen_id count 4/196]
2025-03-13 17:13:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_top_drawer_left_cabinet [chosen_id count 5/196]
2025-03-13 17:13:08: [retrieval_preprocessing] we have num_total=1637 embedding_dim=49152
[retrieval_preprocessing] for episode 90170 [episode count 0/20], we have num_retrieval=np.int64(1532) num_query=np.int64(105)
2025-03-13 17:13:08,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:08,882 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:08
2025-03-13 17:13:08,882 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.40it/s]
2025-03-13 17:13:08,911 [INFO]: There are 1532 embeddings of dim 49152
2025-03-13 17:13:08,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 17:13:08,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,911 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:08,911 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 17:13:08,911 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:08,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:08,911 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,911 [INFO]: 316.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:08,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:13:08,911 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:08
2025-03-13 17:13:08,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:08,911 [INFO]: 	Creating the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,911 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:08
2025-03-13 17:13:08,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:13:08,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:08
2025-03-13 17:13:08,912 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:13:08,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.25it/s] 29%|██▊       | 2/7 [00:00<00:00,  7.02it/s] 57%|█████▋    | 4/7 [00:00<00:00,  9.69it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.54it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.72it/s]100%|██████████| 7/7 [00:01<00:00,  2.11it/s]100%|██████████| 7/7 [00:02<00:00,  3.50it/s]
2025-03-13 17:13:10,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:10
2025-03-13 17:13:34,138 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.2221 secs
2025-03-13 17:13:34,139 [INFO]: The best hyperparameters are: efSearch=378
2025-03-13 17:13:34,139 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 17:13:55,319 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1804 secs
2025-03-13 17:13:55,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4085 secs
2025-03-13 17:13:55,321 [INFO]: {
2025-03-13 17:13:55,321 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:55,321 [INFO]: 	index_param: efSearch=378
2025-03-13 17:13:55,321 [INFO]: 	index_path: knn.index
2025-03-13 17:13:55,321 [INFO]: 	size in bytes: 301411810
2025-03-13 17:13:55,321 [INFO]: 	avg_search_speed_ms: 10.897621330815268
2025-03-13 17:13:55,321 [INFO]: 	99p_search_speed_ms: 14.517158635426316
2025-03-13 17:13:55,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:55,321 [INFO]: 	nb vectors: 1532
2025-03-13 17:13:55,321 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:55,321 [INFO]: 	compression ratio: 0.9993087397603962
2025-03-13 17:13:55,321 [INFO]: }
2025-03-13 17:13:55,321 [INFO]: 	>>> Finished "Creating the index" in 46.4098 secs
2025-03-13 17:13:55,321 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4392 secs
2025-03-13 17:13:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 90170 [episode count 0/20]
[retrieval_preprocessing] for episode 26697 [episode count 1/20], we have num_retrieval=np.int64(1549) num_query=np.int64(88)
2025-03-13 17:13:56,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:57,095 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:57
2025-03-13 17:13:57,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1829.18it/s]
2025-03-13 17:13:57,122 [INFO]: There are 1549 embeddings of dim 49152
2025-03-13 17:13:57,122 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:13:57,122 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:57
2025-03-13 17:13:57,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:57,122 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:13:57,122 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:57,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:57,122 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:57
2025-03-13 17:13:57,122 [INFO]: 319.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:57,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:13:57,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:57
2025-03-13 17:13:57,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:57,123 [INFO]: 	Creating the index 03/13/2025, 17:13:57
2025-03-13 17:13:57,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:57
2025-03-13 17:13:57,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:13:57,124 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:57
2025-03-13 17:13:57,124 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:13:57,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.40it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.71it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.34it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.16it/s]100%|██████████| 7/7 [00:02<00:00,  2.22it/s]100%|██████████| 7/7 [00:02<00:00,  3.39it/s]
2025-03-13 17:13:59,193 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:59
2025-03-13 17:14:25,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5150 secs
2025-03-13 17:14:25,709 [INFO]: The best hyperparameters are: efSearch=285
2025-03-13 17:14:25,709 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.50it/s] 50%|█████     | 2/4 [00:00<00:00,  4.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.66it/s]
2025-03-13 17:14:41,849 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1397 secs
2025-03-13 17:14:41,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7270 secs
2025-03-13 17:14:41,851 [INFO]: {
2025-03-13 17:14:41,851 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:41,851 [INFO]: 	index_param: efSearch=285
2025-03-13 17:14:41,851 [INFO]: 	index_path: knn.index
2025-03-13 17:14:41,851 [INFO]: 	size in bytes: 304756450
2025-03-13 17:14:41,851 [INFO]: 	avg_search_speed_ms: 11.907334692521198
2025-03-13 17:14:41,851 [INFO]: 	99p_search_speed_ms: 17.761796608101577
2025-03-13 17:14:41,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:41,851 [INFO]: 	nb vectors: 1549
2025-03-13 17:14:41,851 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:41,851 [INFO]: 	compression ratio: 0.9993087660654926
2025-03-13 17:14:41,851 [INFO]: }
2025-03-13 17:14:41,851 [INFO]: 	>>> Finished "Creating the index" in 44.7287 secs
2025-03-13 17:14:41,851 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7563 secs
2025-03-13 17:14:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 26697 [episode count 1/20]
[retrieval_preprocessing] for episode 67694 [episode count 2/20], we have num_retrieval=np.int64(1556) num_query=np.int64(81)
2025-03-13 17:14:43,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:43,494 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:43
2025-03-13 17:14:43,494 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1661.77it/s]
2025-03-13 17:14:43,518 [INFO]: There are 1556 embeddings of dim 49152
2025-03-13 17:14:43,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 17:14:43,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:43
2025-03-13 17:14:43,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:43,518 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:14:43,518 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:43,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:43,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:43
2025-03-13 17:14:43,519 [INFO]: 321.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:43,519 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:14:43,519 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:43
2025-03-13 17:14:43,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:43,519 [INFO]: 	Creating the index 03/13/2025, 17:14:43
2025-03-13 17:14:43,519 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:43
2025-03-13 17:14:43,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:14:43,520 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:43
2025-03-13 17:14:43,520 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:14:43,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.31it/s] 57%|█████▋    | 4/7 [00:00<00:00, 10.91it/s] 86%|████████▌ | 6/7 [00:00<00:00, 12.23it/s]100%|██████████| 7/7 [00:01<00:00,  4.12it/s]
2025-03-13 17:14:45,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:45
2025-03-13 17:15:08,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8698 secs
2025-03-13 17:15:08,090 [INFO]: The best hyperparameters are: efSearch=376
2025-03-13 17:15:08,090 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 17:15:36,121 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0305 secs
2025-03-13 17:15:36,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6022 secs
2025-03-13 17:15:36,122 [INFO]: {
2025-03-13 17:15:36,122 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:36,122 [INFO]: 	index_param: efSearch=376
2025-03-13 17:15:36,122 [INFO]: 	index_path: knn.index
2025-03-13 17:15:36,122 [INFO]: 	size in bytes: 306133630
2025-03-13 17:15:36,122 [INFO]: 	avg_search_speed_ms: 10.082420118241346
2025-03-13 17:15:36,122 [INFO]: 	99p_search_speed_ms: 13.333822269923985
2025-03-13 17:15:36,122 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:36,122 [INFO]: 	nb vectors: 1556
2025-03-13 17:15:36,123 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:36,123 [INFO]: 	compression ratio: 0.9993088573770873
2025-03-13 17:15:36,123 [INFO]: }
2025-03-13 17:15:36,123 [INFO]: 	>>> Finished "Creating the index" in 52.6037 secs
2025-03-13 17:15:36,123 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6282 secs
2025-03-13 17:15:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 67694 [episode count 2/20]
[retrieval_preprocessing] for episode 26707 [episode count 3/20], we have num_retrieval=np.int64(1544) num_query=np.int64(93)
2025-03-13 17:15:37,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:37,717 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:37
2025-03-13 17:15:37,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.85it/s]
2025-03-13 17:15:37,740 [INFO]: There are 1544 embeddings of dim 49152
2025-03-13 17:15:37,740 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 17:15:37,740 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:37
2025-03-13 17:15:37,740 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:37,740 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 17:15:37,740 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:37,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:37,740 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:37
2025-03-13 17:15:37,740 [INFO]: 318.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:37,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:15:37,740 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:37
2025-03-13 17:15:37,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:37,740 [INFO]: 	Creating the index 03/13/2025, 17:15:37
2025-03-13 17:15:37,740 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:37
2025-03-13 17:15:37,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:15:37,741 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:37
2025-03-13 17:15:37,741 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:15:37,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.96it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.39it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.21it/s]100%|██████████| 7/7 [00:01<00:00,  3.61it/s]100%|██████████| 7/7 [00:01<00:00,  4.49it/s]
2025-03-13 17:15:39,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:39
2025-03-13 17:16:07,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2593 secs
2025-03-13 17:16:07,564 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 17:16:07,564 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-13 17:16:25,679 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1157 secs
2025-03-13 17:16:25,681 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9397 secs
2025-03-13 17:16:25,681 [INFO]: {
2025-03-13 17:16:25,681 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:25,681 [INFO]: 	index_param: efSearch=272
2025-03-13 17:16:25,681 [INFO]: 	index_path: knn.index
2025-03-13 17:16:25,681 [INFO]: 	size in bytes: 303772690
2025-03-13 17:16:25,681 [INFO]: 	avg_search_speed_ms: 9.201809104185863
2025-03-13 17:16:25,681 [INFO]: 	99p_search_speed_ms: 16.289355200715374
2025-03-13 17:16:25,681 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:25,681 [INFO]: 	nb vectors: 1544
2025-03-13 17:16:25,681 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:25,681 [INFO]: 	compression ratio: 0.9993088977155912
2025-03-13 17:16:25,681 [INFO]: }
2025-03-13 17:16:25,681 [INFO]: 	>>> Finished "Creating the index" in 47.9411 secs
2025-03-13 17:16:25,681 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9639 secs
2025-03-13 17:16:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 26707 [episode count 3/20]
[retrieval_preprocessing] for episode 57439 [episode count 4/20], we have num_retrieval=np.int64(1563) num_query=np.int64(74)
2025-03-13 17:16:26,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:27,175 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:27
2025-03-13 17:16:27,175 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.27it/s]
2025-03-13 17:16:27,199 [INFO]: There are 1563 embeddings of dim 49152
2025-03-13 17:16:27,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 17:16:27,199 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:27
2025-03-13 17:16:27,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:27,199 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:16:27,199 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:27,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:27,199 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:27
2025-03-13 17:16:27,199 [INFO]: 322.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:27,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:16:27,199 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:27
2025-03-13 17:16:27,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:27,200 [INFO]: 	Creating the index 03/13/2025, 17:16:27
2025-03-13 17:16:27,200 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:27
2025-03-13 17:16:27,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:16:27,201 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:27
2025-03-13 17:16:27,201 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:16:27,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.50it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.78it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.91it/s]100%|██████████| 7/7 [00:01<00:00,  3.10it/s]100%|██████████| 7/7 [00:01<00:00,  3.91it/s]
2025-03-13 17:16:28,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:28
2025-03-13 17:16:51,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8248 secs
2025-03-13 17:16:51,818 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 17:16:51,818 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
2025-03-13 17:17:07,613 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7944 secs
2025-03-13 17:17:07,615 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4137 secs
2025-03-13 17:17:07,615 [INFO]: {
2025-03-13 17:17:07,615 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:07,615 [INFO]: 	index_param: efSearch=297
2025-03-13 17:17:07,615 [INFO]: 	index_path: knn.index
2025-03-13 17:17:07,615 [INFO]: 	size in bytes: 307510810
2025-03-13 17:17:07,615 [INFO]: 	avg_search_speed_ms: 10.364218225818455
2025-03-13 17:17:07,615 [INFO]: 	99p_search_speed_ms: 19.539453135803345
2025-03-13 17:17:07,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:07,615 [INFO]: 	nb vectors: 1563
2025-03-13 17:17:07,615 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:07,615 [INFO]: 	compression ratio: 0.9993089478708082
2025-03-13 17:17:07,615 [INFO]: }
2025-03-13 17:17:07,615 [INFO]: 	>>> Finished "Creating the index" in 40.4152 secs
2025-03-13 17:17:07,615 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4399 secs
2025-03-13 17:17:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 57439 [episode count 4/20]
[retrieval_preprocessing] for episode 90223 [episode count 5/20], we have num_retrieval=np.int64(1557) num_query=np.int64(80)
2025-03-13 17:17:08,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:09,264 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:09
2025-03-13 17:17:09,264 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1313.59it/s]
2025-03-13 17:17:09,294 [INFO]: There are 1557 embeddings of dim 49152
2025-03-13 17:17:09,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:17:09,294 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:09
2025-03-13 17:17:09,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:09,295 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:17:09,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:09,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:17:09,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:09
2025-03-13 17:17:09,296 [INFO]: 321.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:09,296 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:17:09,296 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:09
2025-03-13 17:17:09,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:09,296 [INFO]: 	Creating the index 03/13/2025, 17:17:09
2025-03-13 17:17:09,296 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:09
2025-03-13 17:17:09,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:17:09,299 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:09
2025-03-13 17:17:09,299 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:17:09,299 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.01it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.86it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.64it/s]100%|██████████| 7/7 [00:01<00:00,  2.98it/s]100%|██████████| 7/7 [00:01<00:00,  3.78it/s]
2025-03-13 17:17:11,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:11
2025-03-13 17:17:35,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7988 secs
2025-03-13 17:17:35,955 [INFO]: The best hyperparameters are: efSearch=340
2025-03-13 17:17:35,955 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 17:17:57,367 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4127 secs
2025-03-13 17:17:57,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0697 secs
2025-03-13 17:17:57,369 [INFO]: {
2025-03-13 17:17:57,369 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:57,369 [INFO]: 	index_param: efSearch=340
2025-03-13 17:17:57,369 [INFO]: 	index_path: knn.index
2025-03-13 17:17:57,369 [INFO]: 	size in bytes: 306330370
2025-03-13 17:17:57,369 [INFO]: 	avg_search_speed_ms: 10.730573102580024
2025-03-13 17:17:57,369 [INFO]: 	99p_search_speed_ms: 15.07668531499803
2025-03-13 17:17:57,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:57,369 [INFO]: 	nb vectors: 1557
2025-03-13 17:17:57,369 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:57,369 [INFO]: 	compression ratio: 0.9993088703545783
2025-03-13 17:17:57,369 [INFO]: }
2025-03-13 17:17:57,369 [INFO]: 	>>> Finished "Creating the index" in 48.0731 secs
2025-03-13 17:17:57,369 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1054 secs
2025-03-13 17:17:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 90223 [episode count 5/20]
[retrieval_preprocessing] for episode 65702 [episode count 6/20], we have num_retrieval=np.int64(1555) num_query=np.int64(82)
2025-03-13 17:17:58,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:59,284 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:59
2025-03-13 17:17:59,284 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1382.89it/s]
2025-03-13 17:17:59,311 [INFO]: There are 1555 embeddings of dim 49152
2025-03-13 17:17:59,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:17:59,311 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:59
2025-03-13 17:17:59,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:59,311 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:17:59,311 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:59,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:59,311 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:59
2025-03-13 17:17:59,311 [INFO]: 320.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:59,311 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:17:59,312 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:59
2025-03-13 17:17:59,312 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:59,312 [INFO]: 	Creating the index 03/13/2025, 17:17:59
2025-03-13 17:17:59,312 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:59
2025-03-13 17:17:59,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:17:59,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:59
2025-03-13 17:17:59,313 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:17:59,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.28it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.40it/s] 43%|████▎     | 3/7 [00:00<00:00,  6.70it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.81it/s] 71%|███████▏  | 5/7 [00:00<00:00,  6.76it/s] 86%|████████▌ | 6/7 [00:00<00:00,  6.80it/s]100%|██████████| 7/7 [00:02<00:00,  1.45it/s]100%|██████████| 7/7 [00:02<00:00,  2.58it/s]
2025-03-13 17:18:02,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:02
2025-03-13 17:18:24,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9081 secs
2025-03-13 17:18:24,934 [INFO]: The best hyperparameters are: efSearch=313
2025-03-13 17:18:24,934 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 17:18:40,841 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9067 secs
2025-03-13 17:18:40,843 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5301 secs
2025-03-13 17:18:40,843 [INFO]: {
2025-03-13 17:18:40,843 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:40,843 [INFO]: 	index_param: efSearch=313
2025-03-13 17:18:40,843 [INFO]: 	index_path: knn.index
2025-03-13 17:18:40,843 [INFO]: 	size in bytes: 305936890
2025-03-13 17:18:40,843 [INFO]: 	avg_search_speed_ms: 10.55202803197258
2025-03-13 17:18:40,843 [INFO]: 	99p_search_speed_ms: 19.720110960770384
2025-03-13 17:18:40,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:40,843 [INFO]: 	nb vectors: 1555
2025-03-13 17:18:40,843 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:40,843 [INFO]: 	compression ratio: 0.9993088443829052
2025-03-13 17:18:40,843 [INFO]: }
2025-03-13 17:18:40,843 [INFO]: 	>>> Finished "Creating the index" in 41.5318 secs
2025-03-13 17:18:40,843 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5590 secs
2025-03-13 17:18:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 65702 [episode count 6/20]
[retrieval_preprocessing] for episode 49344 [episode count 7/20], we have num_retrieval=np.int64(1570) num_query=np.int64(67)
2025-03-13 17:18:42,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:42,279 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:42
2025-03-13 17:18:42,279 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.98it/s]
2025-03-13 17:18:42,305 [INFO]: There are 1570 embeddings of dim 49152
2025-03-13 17:18:42,305 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 17:18:42,305 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:42
2025-03-13 17:18:42,305 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:42,305 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:18:42,305 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:42,305 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:18:42,305 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:42
2025-03-13 17:18:42,305 [INFO]: 324.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:42,306 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:18:42,306 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:42
2025-03-13 17:18:42,306 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:42,306 [INFO]: 	Creating the index 03/13/2025, 17:18:42
2025-03-13 17:18:42,306 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:42
2025-03-13 17:18:42,307 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:18:42,307 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:42
2025-03-13 17:18:42,307 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:18:42,307 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.55it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.74it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.73it/s]100%|██████████| 7/7 [00:01<00:00,  3.44it/s]100%|██████████| 7/7 [00:01<00:00,  4.34it/s]
2025-03-13 17:18:43,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:43
2025-03-13 17:19:07,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7396 secs
2025-03-13 17:19:07,663 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 17:19:07,663 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.12it/s] 50%|█████     | 2/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.65it/s]
2025-03-13 17:19:26,559 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8968 secs
2025-03-13 17:19:26,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2543 secs
2025-03-13 17:19:26,561 [INFO]: {
2025-03-13 17:19:26,561 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:26,561 [INFO]: 	index_param: efSearch=317
2025-03-13 17:19:26,561 [INFO]: 	index_path: knn.index
2025-03-13 17:19:26,561 [INFO]: 	size in bytes: 308888050
2025-03-13 17:19:26,561 [INFO]: 	avg_search_speed_ms: 11.030074358119936
2025-03-13 17:19:26,561 [INFO]: 	99p_search_speed_ms: 21.51748774107538
2025-03-13 17:19:26,561 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:26,561 [INFO]: 	nb vectors: 1570
2025-03-13 17:19:26,561 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:26,561 [INFO]: 	compression ratio: 0.9993088434466791
2025-03-13 17:19:26,561 [INFO]: }
2025-03-13 17:19:26,561 [INFO]: 	>>> Finished "Creating the index" in 44.2556 secs
2025-03-13 17:19:26,561 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2823 secs
2025-03-13 17:19:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 49344 [episode count 7/20]
[retrieval_preprocessing] for episode 78018 [episode count 8/20], we have num_retrieval=np.int64(1558) num_query=np.int64(79)
2025-03-13 17:19:27,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:28,123 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:28
2025-03-13 17:19:28,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 928.97it/s]
2025-03-13 17:19:28,150 [INFO]: There are 1558 embeddings of dim 49152
2025-03-13 17:19:28,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:19:28,151 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:28
2025-03-13 17:19:28,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:28,151 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:19:28,151 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:28,151 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:28,151 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:28
2025-03-13 17:19:28,151 [INFO]: 321.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:28,151 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:19:28,151 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:28
2025-03-13 17:19:28,151 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:28,151 [INFO]: 	Creating the index 03/13/2025, 17:19:28
2025-03-13 17:19:28,151 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:28
2025-03-13 17:19:28,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:19:28,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:28
2025-03-13 17:19:28,152 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:19:28,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.40it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.57it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.85it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.84it/s]100%|██████████| 7/7 [00:02<00:00,  2.13it/s]100%|██████████| 7/7 [00:02<00:00,  3.37it/s]
2025-03-13 17:19:30,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:30
2025-03-13 17:19:54,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9650 secs
2025-03-13 17:19:54,199 [INFO]: The best hyperparameters are: efSearch=390
2025-03-13 17:19:54,199 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-13 17:20:12,800 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6007 secs
2025-03-13 17:20:13,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2863 secs
2025-03-13 17:20:13,439 [INFO]: {
2025-03-13 17:20:13,439 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:13,439 [INFO]: 	index_param: efSearch=390
2025-03-13 17:20:13,439 [INFO]: 	index_path: knn.index
2025-03-13 17:20:13,439 [INFO]: 	size in bytes: 306527110
2025-03-13 17:20:13,439 [INFO]: 	avg_search_speed_ms: 11.666102265578324
2025-03-13 17:20:13,439 [INFO]: 	99p_search_speed_ms: 15.881615094840525
2025-03-13 17:20:13,440 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:13,440 [INFO]: 	nb vectors: 1558
2025-03-13 17:20:13,440 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:13,440 [INFO]: 	compression ratio: 0.9993088833154105
2025-03-13 17:20:13,440 [INFO]: }
2025-03-13 17:20:13,440 [INFO]: 	>>> Finished "Creating the index" in 45.2884 secs
2025-03-13 17:20:13,440 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3168 secs
2025-03-13 17:20:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 78018 [episode count 8/20]
[retrieval_preprocessing] for episode 4309 [episode count 9/20], we have num_retrieval=np.int64(1552) num_query=np.int64(85)
2025-03-13 17:20:14,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:15,220 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:15
2025-03-13 17:20:15,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1877.49it/s]
2025-03-13 17:20:15,244 [INFO]: There are 1552 embeddings of dim 49152
2025-03-13 17:20:15,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:20:15,245 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:15
2025-03-13 17:20:15,245 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:15,245 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:20:15,245 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:15,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:15,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:15
2025-03-13 17:20:15,245 [INFO]: 320.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:15,245 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:20:15,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:15
2025-03-13 17:20:15,245 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:15,245 [INFO]: 	Creating the index 03/13/2025, 17:20:15
2025-03-13 17:20:15,245 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:15
2025-03-13 17:20:15,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:20:15,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:15
2025-03-13 17:20:15,247 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:20:15,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.87it/s] 29%|██▊       | 2/7 [00:00<00:00,  7.68it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.58it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.50it/s]100%|██████████| 7/7 [00:01<00:00,  2.72it/s]100%|██████████| 7/7 [00:01<00:00,  3.58it/s]
2025-03-13 17:20:17,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:17
2025-03-13 17:20:42,142 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9375 secs
2025-03-13 17:20:42,142 [INFO]: The best hyperparameters are: efSearch=334
2025-03-13 17:20:42,142 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 17:20:58,359 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2167 secs
2025-03-13 17:20:58,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1143 secs
2025-03-13 17:20:58,361 [INFO]: {
2025-03-13 17:20:58,361 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:58,361 [INFO]: 	index_param: efSearch=334
2025-03-13 17:20:58,361 [INFO]: 	index_path: knn.index
2025-03-13 17:20:58,361 [INFO]: 	size in bytes: 305346670
2025-03-13 17:20:58,361 [INFO]: 	avg_search_speed_ms: 11.736453473382136
2025-03-13 17:20:58,361 [INFO]: 	99p_search_speed_ms: 17.409668727777902
2025-03-13 17:20:58,361 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:58,361 [INFO]: 	nb vectors: 1552
2025-03-13 17:20:58,361 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:58,361 [INFO]: 	compression ratio: 0.9993088052998907
2025-03-13 17:20:58,361 [INFO]: }
2025-03-13 17:20:58,361 [INFO]: 	>>> Finished "Creating the index" in 43.1158 secs
2025-03-13 17:20:58,361 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1414 secs
2025-03-13 17:20:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 4309 [episode count 9/20]
[retrieval_preprocessing] for episode 63788 [episode count 10/20], we have num_retrieval=np.int64(1562) num_query=np.int64(75)
2025-03-13 17:21:00,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:00,501 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:00
2025-03-13 17:21:00,501 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.87it/s]
2025-03-13 17:21:00,527 [INFO]: There are 1562 embeddings of dim 49152
2025-03-13 17:21:00,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:21:00,527 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:00
2025-03-13 17:21:00,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:00,527 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:21:00,527 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:00,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:21:00,527 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:00
2025-03-13 17:21:00,527 [INFO]: 322.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:00,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:21:00,527 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:00
2025-03-13 17:21:00,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:00,527 [INFO]: 	Creating the index 03/13/2025, 17:21:00
2025-03-13 17:21:00,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:00
2025-03-13 17:21:00,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:21:00,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:00
2025-03-13 17:21:00,528 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:21:00,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.72it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.91it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.59it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.95it/s]100%|██████████| 7/7 [00:01<00:00,  3.06it/s]100%|██████████| 7/7 [00:01<00:00,  3.90it/s]
2025-03-13 17:21:02,326 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:02
2025-03-13 17:21:33,594 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2678 secs
2025-03-13 17:21:33,595 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 17:21:33,595 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-13 17:21:53,133 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5379 secs
2025-03-13 17:21:53,134 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6060 secs
2025-03-13 17:21:53,135 [INFO]: {
2025-03-13 17:21:53,135 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:53,135 [INFO]: 	index_param: efSearch=252
2025-03-13 17:21:53,135 [INFO]: 	index_path: knn.index
2025-03-13 17:21:53,135 [INFO]: 	size in bytes: 307314070
2025-03-13 17:21:53,135 [INFO]: 	avg_search_speed_ms: 9.551658362030997
2025-03-13 17:21:53,135 [INFO]: 	99p_search_speed_ms: 21.23338398989289
2025-03-13 17:21:53,135 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:53,135 [INFO]: 	nb vectors: 1562
2025-03-13 17:21:53,135 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:53,135 [INFO]: 	compression ratio: 0.9993089349927909
2025-03-13 17:21:53,135 [INFO]: }
2025-03-13 17:21:53,135 [INFO]: 	>>> Finished "Creating the index" in 52.6074 secs
2025-03-13 17:21:53,135 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6338 secs
2025-03-13 17:21:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 63788 [episode count 10/20]
[retrieval_preprocessing] for episode 57667 [episode count 11/20], we have num_retrieval=np.int64(1544) num_query=np.int64(93)
2025-03-13 17:21:54,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:55,482 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:55
2025-03-13 17:21:55,482 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.98it/s]
2025-03-13 17:21:55,509 [INFO]: There are 1544 embeddings of dim 49152
2025-03-13 17:21:55,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:21:55,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:55,510 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 17:21:55,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:55,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:21:55,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,510 [INFO]: 318.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:55,510 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:21:55,510 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:55
2025-03-13 17:21:55,510 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:55,510 [INFO]: 	Creating the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,510 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:55
2025-03-13 17:21:55,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:21:55,511 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,511 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:21:55,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  4.57it/s] 29%|██▊       | 2/7 [00:00<00:00,  5.69it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.06it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.89it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.45it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.89it/s]100%|██████████| 7/7 [00:01<00:00,  2.25it/s]100%|██████████| 7/7 [00:01<00:00,  3.68it/s]
2025-03-13 17:21:57,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:57
2025-03-13 17:22:19,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3169 secs
2025-03-13 17:22:19,735 [INFO]: The best hyperparameters are: efSearch=360
2025-03-13 17:22:19,735 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 17:22:38,223 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4880 secs
2025-03-13 17:22:38,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7134 secs
2025-03-13 17:22:38,225 [INFO]: {
2025-03-13 17:22:38,225 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:38,225 [INFO]: 	index_param: efSearch=360
2025-03-13 17:22:38,225 [INFO]: 	index_path: knn.index
2025-03-13 17:22:38,225 [INFO]: 	size in bytes: 303772690
2025-03-13 17:22:38,225 [INFO]: 	avg_search_speed_ms: 11.366334787718104
2025-03-13 17:22:38,225 [INFO]: 	99p_search_speed_ms: 18.553069843910645
2025-03-13 17:22:38,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:38,225 [INFO]: 	nb vectors: 1544
2025-03-13 17:22:38,225 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:38,225 [INFO]: 	compression ratio: 0.9993088977155912
2025-03-13 17:22:38,225 [INFO]: }
2025-03-13 17:22:38,225 [INFO]: 	>>> Finished "Creating the index" in 42.7150 secs
2025-03-13 17:22:38,225 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7429 secs
2025-03-13 17:22:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 57667 [episode count 11/20]
[retrieval_preprocessing] for episode 84348 [episode count 12/20], we have num_retrieval=np.int64(1551) num_query=np.int64(86)
2025-03-13 17:22:39,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:39,860 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:39
2025-03-13 17:22:39,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-13 17:22:39,889 [INFO]: There are 1551 embeddings of dim 49152
2025-03-13 17:22:39,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 17:22:39,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:39
2025-03-13 17:22:39,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:39,890 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:22:39,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:39,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:22:39,891 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:39
2025-03-13 17:22:39,891 [INFO]: 320.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:39,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:22:39,891 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:39
2025-03-13 17:22:39,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:39,891 [INFO]: 	Creating the index 03/13/2025, 17:22:39
2025-03-13 17:22:39,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:39
2025-03-13 17:22:39,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:22:39,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:39
2025-03-13 17:22:39,895 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:22:39,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.44it/s] 29%|██▊       | 2/7 [00:00<00:00,  7.63it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.92it/s] 57%|█████▋    | 4/7 [00:00<00:00,  8.24it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.25it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.22it/s]100%|██████████| 7/7 [00:01<00:00,  2.17it/s]100%|██████████| 7/7 [00:01<00:00,  3.67it/s]
2025-03-13 17:22:41,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:41
2025-03-13 17:23:06,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6383 secs
2025-03-13 17:23:06,446 [INFO]: The best hyperparameters are: efSearch=349
2025-03-13 17:23:06,446 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 17:23:25,014 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5673 secs
2025-03-13 17:23:25,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1205 secs
2025-03-13 17:23:25,016 [INFO]: {
2025-03-13 17:23:25,016 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:25,016 [INFO]: 	index_param: efSearch=349
2025-03-13 17:23:25,016 [INFO]: 	index_path: knn.index
2025-03-13 17:23:25,016 [INFO]: 	size in bytes: 305149930
2025-03-13 17:23:25,016 [INFO]: 	avg_search_speed_ms: 10.567221675367424
2025-03-13 17:23:25,016 [INFO]: 	99p_search_speed_ms: 15.566296840552226
2025-03-13 17:23:25,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:25,016 [INFO]: 	nb vectors: 1551
2025-03-13 17:23:25,016 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:25,016 [INFO]: 	compression ratio: 0.9993087922386219
2025-03-13 17:23:25,016 [INFO]: }
2025-03-13 17:23:25,016 [INFO]: 	>>> Finished "Creating the index" in 45.1245 secs
2025-03-13 17:23:25,016 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1555 secs
2025-03-13 17:23:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 84348 [episode count 12/20]
[retrieval_preprocessing] for episode 33141 [episode count 13/20], we have num_retrieval=np.int64(1549) num_query=np.int64(88)
2025-03-13 17:23:26,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:27,209 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:27
2025-03-13 17:23:27,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2087.76it/s]
2025-03-13 17:23:27,236 [INFO]: There are 1549 embeddings of dim 49152
2025-03-13 17:23:27,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:23:27,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:27,237 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:23:27,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:27,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:23:27,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,237 [INFO]: 319.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:27,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:23:27,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:27
2025-03-13 17:23:27,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:27,238 [INFO]: 	Creating the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:27
2025-03-13 17:23:27,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:23:27,242 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:27
2025-03-13 17:23:27,242 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:23:27,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.14it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.68it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.23it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.44it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.70it/s] 86%|████████▌ | 6/7 [00:00<00:00,  7.42it/s]100%|██████████| 7/7 [00:02<00:00,  1.68it/s]100%|██████████| 7/7 [00:02<00:00,  2.95it/s]
2025-03-13 17:23:29,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:29
2025-03-13 17:23:54,695 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0730 secs
2025-03-13 17:23:54,695 [INFO]: The best hyperparameters are: efSearch=335
2025-03-13 17:23:54,695 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-13 17:24:11,379 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6845 secs
2025-03-13 17:24:11,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.1391 secs
2025-03-13 17:24:11,381 [INFO]: {
2025-03-13 17:24:11,381 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:11,381 [INFO]: 	index_param: efSearch=335
2025-03-13 17:24:11,381 [INFO]: 	index_path: knn.index
2025-03-13 17:24:11,381 [INFO]: 	size in bytes: 304756450
2025-03-13 17:24:11,381 [INFO]: 	avg_search_speed_ms: 10.157603137242386
2025-03-13 17:24:11,381 [INFO]: 	99p_search_speed_ms: 15.093320347368715
2025-03-13 17:24:11,381 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:11,381 [INFO]: 	nb vectors: 1549
2025-03-13 17:24:11,381 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:11,381 [INFO]: 	compression ratio: 0.9993087660654926
2025-03-13 17:24:11,381 [INFO]: }
2025-03-13 17:24:11,381 [INFO]: 	>>> Finished "Creating the index" in 44.1430 secs
2025-03-13 17:24:11,381 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1724 secs
2025-03-13 17:24:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 33141 [episode count 13/20]
[retrieval_preprocessing] for episode 17229 [episode count 14/20], we have num_retrieval=np.int64(1560) num_query=np.int64(77)
2025-03-13 17:24:12,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:13,187 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:13
2025-03-13 17:24:13,187 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1578.59it/s]
2025-03-13 17:24:13,212 [INFO]: There are 1560 embeddings of dim 49152
2025-03-13 17:24:13,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:24:13,212 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:13
2025-03-13 17:24:13,213 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:13,213 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:24:13,213 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:13,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:24:13,213 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:13
2025-03-13 17:24:13,213 [INFO]: 321.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:13,214 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:24:13,214 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:13
2025-03-13 17:24:13,214 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:13,214 [INFO]: 	Creating the index 03/13/2025, 17:24:13
2025-03-13 17:24:13,214 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:13
2025-03-13 17:24:13,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:24:13,217 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:13
2025-03-13 17:24:13,218 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:24:13,218 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  3.68it/s] 29%|██▊       | 2/7 [00:00<00:02,  1.86it/s] 57%|█████▋    | 4/7 [00:01<00:01,  2.07it/s] 71%|███████▏  | 5/7 [00:02<00:00,  2.63it/s] 86%|████████▌ | 6/7 [00:02<00:00,  3.30it/s]100%|██████████| 7/7 [00:03<00:00,  1.86it/s]100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
2025-03-13 17:24:16,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:16
2025-03-13 17:24:41,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1597 secs
2025-03-13 17:24:41,634 [INFO]: The best hyperparameters are: efSearch=351
2025-03-13 17:24:41,634 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 17:25:06,758 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1238 secs
2025-03-13 17:25:06,759 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5418 secs
2025-03-13 17:25:06,759 [INFO]: {
2025-03-13 17:25:06,759 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:06,760 [INFO]: 	index_param: efSearch=351
2025-03-13 17:25:06,760 [INFO]: 	index_path: knn.index
2025-03-13 17:25:06,760 [INFO]: 	size in bytes: 306920590
2025-03-13 17:25:06,760 [INFO]: 	avg_search_speed_ms: 10.467913184870834
2025-03-13 17:25:06,760 [INFO]: 	99p_search_speed_ms: 16.633748356252916
2025-03-13 17:25:06,760 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:06,760 [INFO]: 	nb vectors: 1560
2025-03-13 17:25:06,760 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:06,760 [INFO]: 	compression ratio: 0.9993089091872266
2025-03-13 17:25:06,760 [INFO]: }
2025-03-13 17:25:06,760 [INFO]: 	>>> Finished "Creating the index" in 53.5454 secs
2025-03-13 17:25:06,760 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5731 secs
2025-03-13 17:25:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 17229 [episode count 14/20]
[retrieval_preprocessing] for episode 32082 [episode count 15/20], we have num_retrieval=np.int64(1561) num_query=np.int64(76)
2025-03-13 17:25:08,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:08,253 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:08
2025-03-13 17:25:08,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1247.19it/s]
2025-03-13 17:25:08,280 [INFO]: There are 1561 embeddings of dim 49152
2025-03-13 17:25:08,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:25:08,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:08
2025-03-13 17:25:08,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:08,280 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:25:08,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:08,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:08,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:08
2025-03-13 17:25:08,280 [INFO]: 322.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:08,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:25:08,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:08
2025-03-13 17:25:08,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:08,280 [INFO]: 	Creating the index 03/13/2025, 17:25:08
2025-03-13 17:25:08,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:08
2025-03-13 17:25:08,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:25:08,282 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:08
2025-03-13 17:25:08,282 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:25:08,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.11it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.11it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.83it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.79it/s]100%|██████████| 7/7 [00:01<00:00,  2.61it/s]100%|██████████| 7/7 [00:01<00:00,  3.99it/s]
2025-03-13 17:25:10,040 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:10
2025-03-13 17:25:30,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.9014 secs
2025-03-13 17:25:30,942 [INFO]: The best hyperparameters are: efSearch=362
2025-03-13 17:25:30,942 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.19it/s] 50%|█████     | 2/4 [00:00<00:00,  4.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.50it/s]
2025-03-13 17:25:49,307 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3655 secs
2025-03-13 17:25:49,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0273 secs
2025-03-13 17:25:49,309 [INFO]: {
2025-03-13 17:25:49,309 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:49,309 [INFO]: 	index_param: efSearch=362
2025-03-13 17:25:49,309 [INFO]: 	index_path: knn.index
2025-03-13 17:25:49,309 [INFO]: 	size in bytes: 307117330
2025-03-13 17:25:49,309 [INFO]: 	avg_search_speed_ms: 10.351691147752152
2025-03-13 17:25:49,309 [INFO]: 	99p_search_speed_ms: 14.78485354455189
2025-03-13 17:25:49,309 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:49,309 [INFO]: 	nb vectors: 1561
2025-03-13 17:25:49,309 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:49,309 [INFO]: 	compression ratio: 0.9993089220982743
2025-03-13 17:25:49,309 [INFO]: }
2025-03-13 17:25:49,309 [INFO]: 	>>> Finished "Creating the index" in 41.0288 secs
2025-03-13 17:25:49,309 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0559 secs
2025-03-13 17:25:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 32082 [episode count 15/20]
[retrieval_preprocessing] for episode 36186 [episode count 16/20], we have num_retrieval=np.int64(1566) num_query=np.int64(71)
2025-03-13 17:25:50,685 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:50,923 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:50
2025-03-13 17:25:50,923 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2154.24it/s]
2025-03-13 17:25:50,946 [INFO]: There are 1566 embeddings of dim 49152
2025-03-13 17:25:50,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 17:25:50,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:50
2025-03-13 17:25:50,946 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:50,946 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:25:50,946 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:50,946 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:50,946 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:50
2025-03-13 17:25:50,946 [INFO]: 323.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:50,946 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:25:50,946 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:50
2025-03-13 17:25:50,946 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:50,946 [INFO]: 	Creating the index 03/13/2025, 17:25:50
2025-03-13 17:25:50,947 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:50
2025-03-13 17:25:50,947 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:25:50,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:50
2025-03-13 17:25:50,948 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:25:50,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.19it/s] 43%|████▎     | 3/7 [00:00<00:00,  9.22it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.09it/s]100%|██████████| 7/7 [00:01<00:00,  3.36it/s]100%|██████████| 7/7 [00:01<00:00,  4.21it/s]
2025-03-13 17:25:52,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:52
2025-03-13 17:26:17,348 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7343 secs
2025-03-13 17:26:17,348 [INFO]: The best hyperparameters are: efSearch=321
2025-03-13 17:26:17,348 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.64it/s]
2025-03-13 17:26:33,625 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2762 secs
2025-03-13 17:26:33,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9596 secs
2025-03-13 17:26:33,908 [INFO]: {
2025-03-13 17:26:33,908 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:33,908 [INFO]: 	index_param: efSearch=321
2025-03-13 17:26:33,908 [INFO]: 	index_path: knn.index
2025-03-13 17:26:33,908 [INFO]: 	size in bytes: 308101030
2025-03-13 17:26:33,908 [INFO]: 	avg_search_speed_ms: 9.313241788489636
2025-03-13 17:26:33,908 [INFO]: 	99p_search_speed_ms: 11.92699739243835
2025-03-13 17:26:33,908 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:33,908 [INFO]: 	nb vectors: 1566
2025-03-13 17:26:33,908 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:33,908 [INFO]: 	compression ratio: 0.9993089864061798
2025-03-13 17:26:33,908 [INFO]: }
2025-03-13 17:26:33,908 [INFO]: 	>>> Finished "Creating the index" in 42.9618 secs
2025-03-13 17:26:33,908 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9851 secs
2025-03-13 17:26:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 36186 [episode count 16/20]
[retrieval_preprocessing] for episode 83247 [episode count 17/20], we have num_retrieval=np.int64(1546) num_query=np.int64(91)
2025-03-13 17:26:35,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:35,749 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:35
2025-03-13 17:26:35,750 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1814.93it/s]
2025-03-13 17:26:35,774 [INFO]: There are 1546 embeddings of dim 49152
2025-03-13 17:26:35,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 17:26:35,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:35
2025-03-13 17:26:35,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:35,774 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 17:26:35,774 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:35,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:35,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:35
2025-03-13 17:26:35,774 [INFO]: 319.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:35,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:26:35,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:35
2025-03-13 17:26:35,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:35,774 [INFO]: 	Creating the index 03/13/2025, 17:26:35
2025-03-13 17:26:35,774 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:35
2025-03-13 17:26:35,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:26:35,775 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:35
2025-03-13 17:26:35,776 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:26:35,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  4.92it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.13it/s] 57%|█████▋    | 4/7 [00:00<00:00,  8.38it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.46it/s]100%|██████████| 7/7 [00:01<00:00,  3.03it/s]100%|██████████| 7/7 [00:01<00:00,  4.11it/s]
2025-03-13 17:26:37,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:37
2025-03-13 17:26:57,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9237 secs
2025-03-13 17:26:57,406 [INFO]: The best hyperparameters are: efSearch=403
2025-03-13 17:26:57,406 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 17:27:19,079 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6736 secs
2025-03-13 17:27:19,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3055 secs
2025-03-13 17:27:19,081 [INFO]: {
2025-03-13 17:27:19,081 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:19,081 [INFO]: 	index_param: efSearch=403
2025-03-13 17:27:19,081 [INFO]: 	index_path: knn.index
2025-03-13 17:27:19,081 [INFO]: 	size in bytes: 304166170
2025-03-13 17:27:19,081 [INFO]: 	avg_search_speed_ms: 11.345960424216189
2025-03-13 17:27:19,081 [INFO]: 	99p_search_speed_ms: 16.392781462054693
2025-03-13 17:27:19,081 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:19,081 [INFO]: 	nb vectors: 1546
2025-03-13 17:27:19,081 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:19,081 [INFO]: 	compression ratio: 0.9993089238030646
2025-03-13 17:27:19,081 [INFO]: }
2025-03-13 17:27:19,081 [INFO]: 	>>> Finished "Creating the index" in 43.3070 secs
2025-03-13 17:27:19,081 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3319 secs
2025-03-13 17:27:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 83247 [episode count 17/20]
[retrieval_preprocessing] for episode 73347 [episode count 18/20], we have num_retrieval=np.int64(1554) num_query=np.int64(83)
2025-03-13 17:27:20,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:20,683 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:20
2025-03-13 17:27:20,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1843.65it/s]
2025-03-13 17:27:20,706 [INFO]: There are 1554 embeddings of dim 49152
2025-03-13 17:27:20,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 17:27:20,707 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:20
2025-03-13 17:27:20,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:20,707 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:27:20,707 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:20,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:20,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:20
2025-03-13 17:27:20,707 [INFO]: 320.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:20,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:27:20,707 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:20
2025-03-13 17:27:20,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:20,707 [INFO]: 	Creating the index 03/13/2025, 17:27:20
2025-03-13 17:27:20,707 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:20
2025-03-13 17:27:20,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:27:20,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:20
2025-03-13 17:27:20,708 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:27:20,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.51it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.96it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.60it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.61it/s]100%|██████████| 7/7 [00:01<00:00,  2.34it/s]100%|██████████| 7/7 [00:01<00:00,  3.63it/s]
2025-03-13 17:27:22,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:22
2025-03-13 17:27:47,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7200 secs
2025-03-13 17:27:47,361 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 17:27:47,361 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 17:28:02,659 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2979 secs
2025-03-13 17:28:02,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9523 secs
2025-03-13 17:28:02,661 [INFO]: {
2025-03-13 17:28:02,661 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:02,661 [INFO]: 	index_param: efSearch=309
2025-03-13 17:28:02,661 [INFO]: 	index_path: knn.index
2025-03-13 17:28:02,661 [INFO]: 	size in bytes: 305740150
2025-03-13 17:28:02,662 [INFO]: 	avg_search_speed_ms: 10.117312828701005
2025-03-13 17:28:02,662 [INFO]: 	99p_search_speed_ms: 12.877929375972599
2025-03-13 17:28:02,662 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:02,662 [INFO]: 	nb vectors: 1554
2025-03-13 17:28:02,662 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:02,662 [INFO]: 	compression ratio: 0.999308831372
2025-03-13 17:28:02,662 [INFO]: }
2025-03-13 17:28:02,662 [INFO]: 	>>> Finished "Creating the index" in 41.9546 secs
2025-03-13 17:28:02,662 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9787 secs
2025-03-13 17:28:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 73347 [episode count 18/20]
[retrieval_preprocessing] for episode 50893 [episode count 19/20], we have num_retrieval=np.int64(1574) num_query=np.int64(63)
2025-03-13 17:28:04,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:04,455 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:04
2025-03-13 17:28:04,455 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.69it/s]
2025-03-13 17:28:04,478 [INFO]: There are 1574 embeddings of dim 49152
2025-03-13 17:28:04,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 17:28:04,479 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:04
2025-03-13 17:28:04,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:04,479 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:28:04,479 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:04,479 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:04,479 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:04
2025-03-13 17:28:04,479 [INFO]: 324.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:04,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:28:04,479 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:04
2025-03-13 17:28:04,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:04,479 [INFO]: 	Creating the index 03/13/2025, 17:28:04
2025-03-13 17:28:04,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:04
2025-03-13 17:28:04,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:28:04,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:04
2025-03-13 17:28:04,480 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:28:04,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  7.03it/s] 43%|████▎     | 3/7 [00:00<00:00, 10.80it/s] 71%|███████▏  | 5/7 [00:00<00:00, 11.15it/s]100%|██████████| 7/7 [00:01<00:00,  3.29it/s]100%|██████████| 7/7 [00:01<00:00,  4.22it/s]
2025-03-13 17:28:06,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:06
2025-03-13 17:28:28,174 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0310 secs
2025-03-13 17:28:28,175 [INFO]: The best hyperparameters are: efSearch=401
2025-03-13 17:28:28,175 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.65it/s] 50%|█████     | 2/4 [00:00<00:00,  4.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.41it/s]
2025-03-13 17:28:54,812 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6375 secs
2025-03-13 17:28:54,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3333 secs
2025-03-13 17:28:54,814 [INFO]: {
2025-03-13 17:28:54,814 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:54,814 [INFO]: 	index_param: efSearch=401
2025-03-13 17:28:54,814 [INFO]: 	index_path: knn.index
2025-03-13 17:28:54,814 [INFO]: 	size in bytes: 309675010
2025-03-13 17:28:54,814 [INFO]: 	avg_search_speed_ms: 10.09986779624314
2025-03-13 17:28:54,814 [INFO]: 	99p_search_speed_ms: 15.908319181762637
2025-03-13 17:28:54,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:54,814 [INFO]: 	nb vectors: 1574
2025-03-13 17:28:54,814 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:54,814 [INFO]: 	compression ratio: 0.9993088948313912
2025-03-13 17:28:54,814 [INFO]: }
2025-03-13 17:28:54,814 [INFO]: 	>>> Finished "Creating the index" in 50.3346 secs
2025-03-13 17:28:54,814 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3583 secs
2025-03-13 17:28:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 50893 [episode count 19/20]
2025-03-13 17:28:55: [retrieval_preprocessing] finished for 5235850418_close_top_drawer_left_cabinet [chosen_id count 5/196]
2025-03-13 17:28:57: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_top_drawer_right_cabinet [chosen_id count 6/196]
2025-03-13 17:28:57: [retrieval_preprocessing] we have num_total=2173 embedding_dim=49152
[retrieval_preprocessing] for episode 30790 [episode count 0/20], we have num_retrieval=np.int64(2072) num_query=np.int64(101)
2025-03-13 17:28:58,452 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:58,789 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:58
2025-03-13 17:28:58,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1553.45it/s]
2025-03-13 17:28:58,812 [INFO]: There are 2072 embeddings of dim 49152
2025-03-13 17:28:58,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 17:28:58,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:58
2025-03-13 17:28:58,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:58,812 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:28:58,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:58,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:58,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:58
2025-03-13 17:28:58,812 [INFO]: 427.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:58,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:28:58,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:58
2025-03-13 17:28:58,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:58,813 [INFO]: 	Creating the index 03/13/2025, 17:28:58
2025-03-13 17:28:58,813 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:58
2025-03-13 17:28:58,814 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:28:58,814 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:58
2025-03-13 17:28:58,814 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:28:58,814 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.19it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.01it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.73it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.37it/s]100%|██████████| 9/9 [00:01<00:00,  3.57it/s]100%|██████████| 9/9 [00:01<00:00,  4.96it/s]
2025-03-13 17:29:00,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:00
2025-03-13 17:29:35,001 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3693 secs
2025-03-13 17:29:35,002 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 17:29:35,002 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 17:29:52,391 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3887 secs
2025-03-13 17:29:52,760 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9454 secs
2025-03-13 17:29:52,760 [INFO]: {
2025-03-13 17:29:52,760 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:52,760 [INFO]: 	index_param: efSearch=252
2025-03-13 17:29:52,760 [INFO]: 	index_path: knn.index
2025-03-13 17:29:52,760 [INFO]: 	size in bytes: 407653450
2025-03-13 17:29:52,760 [INFO]: 	avg_search_speed_ms: 11.336350132174823
2025-03-13 17:29:52,760 [INFO]: 	99p_search_speed_ms: 16.41754332929849
2025-03-13 17:29:52,760 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:52,760 [INFO]: 	nb vectors: 2072
2025-03-13 17:29:52,760 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:52,760 [INFO]: 	compression ratio: 0.9993090356527095
2025-03-13 17:29:52,761 [INFO]: }
2025-03-13 17:29:52,761 [INFO]: 	>>> Finished "Creating the index" in 53.9480 secs
2025-03-13 17:29:52,761 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9720 secs
2025-03-13 17:29:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 30790 [episode count 0/20]
[retrieval_preprocessing] for episode 14473 [episode count 1/20], we have num_retrieval=np.int64(1981) num_query=np.int64(192)
2025-03-13 17:29:54,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:54,830 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:54
2025-03-13 17:29:54,830 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-13 17:29:54,853 [INFO]: There are 1981 embeddings of dim 49152
2025-03-13 17:29:54,853 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 17:29:54,853 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:54
2025-03-13 17:29:54,853 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:54,853 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:29:54,853 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:54,853 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:54,853 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:54
2025-03-13 17:29:54,853 [INFO]: 408.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:54,854 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:29:54,854 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:54
2025-03-13 17:29:54,854 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:54,854 [INFO]: 	Creating the index 03/13/2025, 17:29:54
2025-03-13 17:29:54,854 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:54
2025-03-13 17:29:54,855 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:29:54,855 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:54
2025-03-13 17:29:54,855 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:29:54,855 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.27it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.67it/s] 62%|██████▎   | 5/8 [00:00<00:00, 12.84it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.36it/s]100%|██████████| 8/8 [00:02<00:00,  3.74it/s]
2025-03-13 17:29:57,000 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:57
2025-03-13 17:30:23,982 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9814 secs
2025-03-13 17:30:23,982 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 17:30:23,982 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.13it/s]
2025-03-13 17:30:48,008 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0254 secs
2025-03-13 17:30:48,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1551 secs
2025-03-13 17:30:48,010 [INFO]: {
2025-03-13 17:30:48,010 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:48,010 [INFO]: 	index_param: efSearch=240
2025-03-13 17:30:48,010 [INFO]: 	index_path: knn.index
2025-03-13 17:30:48,010 [INFO]: 	size in bytes: 389749810
2025-03-13 17:30:48,010 [INFO]: 	avg_search_speed_ms: 9.761777503626945
2025-03-13 17:30:48,010 [INFO]: 	99p_search_speed_ms: 15.799592288676646
2025-03-13 17:30:48,010 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:48,010 [INFO]: 	nb vectors: 1981
2025-03-13 17:30:48,010 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:48,010 [INFO]: 	compression ratio: 0.9993088848458964
2025-03-13 17:30:48,010 [INFO]: }
2025-03-13 17:30:48,010 [INFO]: 	>>> Finished "Creating the index" in 53.1566 secs
2025-03-13 17:30:48,010 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1804 secs
2025-03-13 17:30:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 14473 [episode count 1/20]
[retrieval_preprocessing] for episode 4186 [episode count 2/20], we have num_retrieval=np.int64(2106) num_query=np.int64(67)
2025-03-13 17:30:51,328 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:51,655 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:51
2025-03-13 17:30:51,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.21it/s]
2025-03-13 17:30:51,682 [INFO]: There are 2106 embeddings of dim 49152
2025-03-13 17:30:51,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:30:51,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:51
2025-03-13 17:30:51,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:51,682 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:30:51,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:51,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:51,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:51
2025-03-13 17:30:51,682 [INFO]: 434.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:51,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:30:51,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:51
2025-03-13 17:30:51,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:51,683 [INFO]: 	Creating the index 03/13/2025, 17:30:51
2025-03-13 17:30:51,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:51
2025-03-13 17:30:51,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:30:51,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:51
2025-03-13 17:30:51,684 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:30:51,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.91it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.28it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.98it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.20it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.27it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.34it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.61it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.57it/s]100%|██████████| 9/9 [00:02<00:00,  1.55it/s]100%|██████████| 9/9 [00:02<00:00,  3.11it/s]
2025-03-13 17:30:54,581 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:54
2025-03-13 17:31:33,176 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5948 secs
2025-03-13 17:31:33,176 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 17:31:33,177 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 17:31:57,121 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9440 secs
2025-03-13 17:31:57,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4388 secs
2025-03-13 17:31:57,123 [INFO]: {
2025-03-13 17:31:57,123 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:57,123 [INFO]: 	index_param: efSearch=261
2025-03-13 17:31:57,123 [INFO]: 	index_path: knn.index
2025-03-13 17:31:57,123 [INFO]: 	size in bytes: 414342730
2025-03-13 17:31:57,123 [INFO]: 	avg_search_speed_ms: 12.049174167956394
2025-03-13 17:31:57,123 [INFO]: 	99p_search_speed_ms: 28.045177015010317
2025-03-13 17:31:57,123 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:57,123 [INFO]: 	nb vectors: 2106
2025-03-13 17:31:57,123 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:57,123 [INFO]: 	compression ratio: 0.9993090695714633
2025-03-13 17:31:57,123 [INFO]: }
2025-03-13 17:31:57,123 [INFO]: 	>>> Finished "Creating the index" in 65.4405 secs
2025-03-13 17:31:57,123 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4676 secs
2025-03-13 17:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 4186 [episode count 2/20]
[retrieval_preprocessing] for episode 22782 [episode count 3/20], we have num_retrieval=np.int64(2070) num_query=np.int64(103)
2025-03-13 17:31:58,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:59,054 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:59
2025-03-13 17:31:59,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.17it/s]
2025-03-13 17:31:59,081 [INFO]: There are 2070 embeddings of dim 49152
2025-03-13 17:31:59,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:31:59,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:59
2025-03-13 17:31:59,082 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:59,082 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:31:59,082 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:59,082 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:59,082 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:59
2025-03-13 17:31:59,082 [INFO]: 427.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:59,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:59,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:59
2025-03-13 17:31:59,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:59,082 [INFO]: 	Creating the index 03/13/2025, 17:31:59
2025-03-13 17:31:59,082 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:59
2025-03-13 17:31:59,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:31:59,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:59
2025-03-13 17:31:59,084 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:31:59,084 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.06it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.79it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.62it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.44it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.35it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.13it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.01it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.78it/s]100%|██████████| 9/9 [00:02<00:00,  1.96it/s]100%|██████████| 9/9 [00:02<00:00,  3.81it/s]
2025-03-13 17:32:01,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:01
2025-03-13 17:32:30,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3411 secs
2025-03-13 17:32:30,791 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 17:32:30,791 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 17:32:49,526 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7345 secs
2025-03-13 17:32:49,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4440 secs
2025-03-13 17:32:49,528 [INFO]: {
2025-03-13 17:32:49,528 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:49,528 [INFO]: 	index_param: efSearch=308
2025-03-13 17:32:49,528 [INFO]: 	index_path: knn.index
2025-03-13 17:32:49,528 [INFO]: 	size in bytes: 407259970
2025-03-13 17:32:49,528 [INFO]: 	avg_search_speed_ms: 11.264924089233434
2025-03-13 17:32:49,528 [INFO]: 	99p_search_speed_ms: 15.177470159251238
2025-03-13 17:32:49,528 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:49,528 [INFO]: 	nb vectors: 2070
2025-03-13 17:32:49,528 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:49,528 [INFO]: 	compression ratio: 0.9993090163022896
2025-03-13 17:32:49,528 [INFO]: }
2025-03-13 17:32:49,528 [INFO]: 	>>> Finished "Creating the index" in 50.4458 secs
2025-03-13 17:32:49,528 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4735 secs
2025-03-13 17:32:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 22782 [episode count 3/20]
[retrieval_preprocessing] for episode 2148 [episode count 4/20], we have num_retrieval=np.int64(2058) num_query=np.int64(115)
2025-03-13 17:32:51,406 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:52,004 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:52
2025-03-13 17:32:52,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1866.62it/s]
2025-03-13 17:32:52,028 [INFO]: There are 2058 embeddings of dim 49152
2025-03-13 17:32:52,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 17:32:52,028 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:52
2025-03-13 17:32:52,028 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:52,028 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:32:52,028 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:52,028 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:52,028 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:52
2025-03-13 17:32:52,028 [INFO]: 424.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:52,028 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:32:52,028 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:52
2025-03-13 17:32:52,028 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:52,028 [INFO]: 	Creating the index 03/13/2025, 17:32:52
2025-03-13 17:32:52,028 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:52
2025-03-13 17:32:52,029 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:32:52,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:52
2025-03-13 17:32:52,030 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:32:52,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.60it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.37it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.66it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.78it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.39it/s]100%|██████████| 9/9 [00:02<00:00,  4.28it/s]
2025-03-13 17:32:54,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:54
2025-03-13 17:33:26,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9001 secs
2025-03-13 17:33:26,036 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 17:33:26,036 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.35it/s]
2025-03-13 17:33:48,086 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0500 secs
2025-03-13 17:33:48,088 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0584 secs
2025-03-13 17:33:48,088 [INFO]: {
2025-03-13 17:33:48,088 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:48,088 [INFO]: 	index_param: efSearch=278
2025-03-13 17:33:48,088 [INFO]: 	index_path: knn.index
2025-03-13 17:33:48,089 [INFO]: 	size in bytes: 404899090
2025-03-13 17:33:48,089 [INFO]: 	avg_search_speed_ms: 9.359871494899458
2025-03-13 17:33:48,089 [INFO]: 	99p_search_speed_ms: 13.786141260061404
2025-03-13 17:33:48,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:48,089 [INFO]: 	nb vectors: 2058
2025-03-13 17:33:48,089 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:48,089 [INFO]: 	compression ratio: 0.999308899409974
2025-03-13 17:33:48,089 [INFO]: }
2025-03-13 17:33:48,089 [INFO]: 	>>> Finished "Creating the index" in 56.0603 secs
2025-03-13 17:33:48,089 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0847 secs
2025-03-13 17:33:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 2148 [episode count 4/20]
[retrieval_preprocessing] for episode 55485 [episode count 5/20], we have num_retrieval=np.int64(2089) num_query=np.int64(84)
2025-03-13 17:33:50,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:51,110 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:51
2025-03-13 17:33:51,110 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1918.71it/s]
2025-03-13 17:33:51,137 [INFO]: There are 2089 embeddings of dim 49152
2025-03-13 17:33:51,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 17:33:51,138 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:51
2025-03-13 17:33:51,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:51,138 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:33:51,138 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:51,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:51,138 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:51
2025-03-13 17:33:51,138 [INFO]: 431.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:51,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:33:51,138 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:51
2025-03-13 17:33:51,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:51,138 [INFO]: 	Creating the index 03/13/2025, 17:33:51
2025-03-13 17:33:51,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:51
2025-03-13 17:33:51,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:33:51,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:51
2025-03-13 17:33:51,140 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:33:51,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.47it/s] 22%|██▏       | 2/9 [00:00<00:00,  8.10it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.68it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.12it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.90it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.83it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.75it/s]100%|██████████| 9/9 [00:02<00:00,  1.81it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]
2025-03-13 17:33:53,661 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:53
2025-03-13 17:34:27,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5029 secs
2025-03-13 17:34:27,165 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 17:34:27,165 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 17:34:46,105 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9407 secs
2025-03-13 17:34:46,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9679 secs
2025-03-13 17:34:46,108 [INFO]: {
2025-03-13 17:34:46,108 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:46,108 [INFO]: 	index_param: efSearch=254
2025-03-13 17:34:46,108 [INFO]: 	index_path: knn.index
2025-03-13 17:34:46,108 [INFO]: 	size in bytes: 410998090
2025-03-13 17:34:46,108 [INFO]: 	avg_search_speed_ms: 10.390465089041635
2025-03-13 17:34:46,108 [INFO]: 	99p_search_speed_ms: 13.851008457131684
2025-03-13 17:34:46,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:46,108 [INFO]: 	nb vectors: 2089
2025-03-13 17:34:46,108 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:46,108 [INFO]: 	compression ratio: 0.9993090527500992
2025-03-13 17:34:46,108 [INFO]: }
2025-03-13 17:34:46,108 [INFO]: 	>>> Finished "Creating the index" in 54.9697 secs
2025-03-13 17:34:46,108 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9976 secs
2025-03-13 17:34:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 55485 [episode count 5/20]
[retrieval_preprocessing] for episode 27326 [episode count 6/20], we have num_retrieval=np.int64(2088) num_query=np.int64(85)
2025-03-13 17:34:47,971 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:48,333 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:48
2025-03-13 17:34:48,333 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.14it/s]
2025-03-13 17:34:48,358 [INFO]: There are 2088 embeddings of dim 49152
2025-03-13 17:34:48,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:34:48,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:48
2025-03-13 17:34:48,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:48,359 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:34:48,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:48,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:34:48,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:48
2025-03-13 17:34:48,360 [INFO]: 430.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:48,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:34:48,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:48
2025-03-13 17:34:48,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:48,361 [INFO]: 	Creating the index 03/13/2025, 17:34:48
2025-03-13 17:34:48,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:48
2025-03-13 17:34:48,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:34:48,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:48
2025-03-13 17:34:48,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:34:48,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.23it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.09it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.80it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.33it/s]100%|██████████| 9/9 [00:02<00:00,  2.93it/s]100%|██████████| 9/9 [00:02<00:00,  4.08it/s]
2025-03-13 17:34:50,577 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:50
2025-03-13 17:35:16,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9935 secs
2025-03-13 17:35:16,571 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:35:16,572 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s]
2025-03-13 17:35:39,470 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8978 secs
2025-03-13 17:35:39,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1078 secs
2025-03-13 17:35:39,472 [INFO]: {
2025-03-13 17:35:39,472 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:39,472 [INFO]: 	index_param: efSearch=171
2025-03-13 17:35:39,472 [INFO]: 	index_path: knn.index
2025-03-13 17:35:39,472 [INFO]: 	size in bytes: 410801350
2025-03-13 17:35:39,472 [INFO]: 	avg_search_speed_ms: 8.252886383510468
2025-03-13 17:35:39,472 [INFO]: 	99p_search_speed_ms: 11.872660554945485
2025-03-13 17:35:39,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:39,472 [INFO]: 	nb vectors: 2088
2025-03-13 17:35:39,472 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:39,472 [INFO]: 	compression ratio: 0.9993090431664843
2025-03-13 17:35:39,472 [INFO]: }
2025-03-13 17:35:39,472 [INFO]: 	>>> Finished "Creating the index" in 51.1112 secs
2025-03-13 17:35:39,472 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1393 secs
2025-03-13 17:35:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 27326 [episode count 6/20]
[retrieval_preprocessing] for episode 4900 [episode count 7/20], we have num_retrieval=np.int64(2103) num_query=np.int64(70)
2025-03-13 17:35:40,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:41,329 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:41
2025-03-13 17:35:41,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1331.10it/s]
2025-03-13 17:35:41,363 [INFO]: There are 2103 embeddings of dim 49152
2025-03-13 17:35:41,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 17:35:41,363 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:41,363 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:35:41,363 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:41,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:35:41,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,364 [INFO]: 434.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:41,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:35:41,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:41
2025-03-13 17:35:41,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:41,364 [INFO]: 	Creating the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:41
2025-03-13 17:35:41,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:35:41,366 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:41
2025-03-13 17:35:41,366 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:35:41,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.73it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.30it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.27it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.38it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.88it/s]100%|██████████| 9/9 [00:02<00:00,  2.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.89it/s]
2025-03-13 17:35:43,681 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:43
2025-03-13 17:36:16,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8361 secs
2025-03-13 17:36:16,518 [INFO]: The best hyperparameters are: efSearch=320
2025-03-13 17:36:16,518 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.89it/s]
2025-03-13 17:36:41,833 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3145 secs
2025-03-13 17:36:41,834 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4688 secs
2025-03-13 17:36:41,835 [INFO]: {
2025-03-13 17:36:41,835 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:41,835 [INFO]: 	index_param: efSearch=320
2025-03-13 17:36:41,835 [INFO]: 	index_path: knn.index
2025-03-13 17:36:41,835 [INFO]: 	size in bytes: 413752510
2025-03-13 17:36:41,835 [INFO]: 	avg_search_speed_ms: 11.762044317472506
2025-03-13 17:36:41,835 [INFO]: 	99p_search_speed_ms: 19.55362228909507
2025-03-13 17:36:41,835 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:41,835 [INFO]: 	nb vectors: 2103
2025-03-13 17:36:41,835 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:41,835 [INFO]: 	compression ratio: 0.9993090410496845
2025-03-13 17:36:41,835 [INFO]: }
2025-03-13 17:36:41,835 [INFO]: 	>>> Finished "Creating the index" in 60.4709 secs
2025-03-13 17:36:41,835 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5060 secs
2025-03-13 17:36:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 4900 [episode count 7/20]
[retrieval_preprocessing] for episode 25381 [episode count 8/20], we have num_retrieval=np.int64(1977) num_query=np.int64(196)
2025-03-13 17:36:43,502 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:43,878 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:43
2025-03-13 17:36:43,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.47it/s]
2025-03-13 17:36:43,904 [INFO]: There are 1977 embeddings of dim 49152
2025-03-13 17:36:43,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:36:43,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:43
2025-03-13 17:36:43,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:43,905 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:36:43,905 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:43,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:43,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:43
2025-03-13 17:36:43,905 [INFO]: 408.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:43,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:43,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:43
2025-03-13 17:36:43,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:43,905 [INFO]: 	Creating the index 03/13/2025, 17:36:43
2025-03-13 17:36:43,905 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:43
2025-03-13 17:36:43,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:36:43,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:43
2025-03-13 17:36:43,906 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:36:43,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.27it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.53it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.03it/s] 50%|█████     | 4/8 [00:00<00:00,  7.40it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.52it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.57it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.59it/s]100%|██████████| 8/8 [00:02<00:00,  1.78it/s]100%|██████████| 8/8 [00:02<00:00,  3.28it/s]
2025-03-13 17:36:46,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:46
2025-03-13 17:37:23,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9919 secs
2025-03-13 17:37:23,346 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:37:23,346 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s]
2025-03-13 17:37:39,859 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5126 secs
2025-03-13 17:37:39,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9554 secs
2025-03-13 17:37:39,862 [INFO]: {
2025-03-13 17:37:39,862 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:39,862 [INFO]: 	index_param: efSearch=218
2025-03-13 17:37:39,862 [INFO]: 	index_path: knn.index
2025-03-13 17:37:39,862 [INFO]: 	size in bytes: 388962850
2025-03-13 17:37:39,862 [INFO]: 	avg_search_speed_ms: 9.367797385084998
2025-03-13 17:37:39,862 [INFO]: 	99p_search_speed_ms: 13.118277476169169
2025-03-13 17:37:39,862 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:39,862 [INFO]: 	nb vectors: 1977
2025-03-13 17:37:39,862 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:39,862 [INFO]: 	compression ratio: 0.9993088440194224
2025-03-13 17:37:39,862 [INFO]: }
2025-03-13 17:37:39,862 [INFO]: 	>>> Finished "Creating the index" in 55.9569 secs
2025-03-13 17:37:39,862 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9832 secs
2025-03-13 17:37:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 25381 [episode count 8/20]
[retrieval_preprocessing] for episode 88411 [episode count 9/20], we have num_retrieval=np.int64(2057) num_query=np.int64(116)
2025-03-13 17:37:42,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:42,810 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:42
2025-03-13 17:37:42,810 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.32it/s]
2025-03-13 17:37:42,835 [INFO]: There are 2057 embeddings of dim 49152
2025-03-13 17:37:42,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 17:37:42,835 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:42
2025-03-13 17:37:42,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:42,835 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:37:42,835 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:42,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:37:42,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:42
2025-03-13 17:37:42,835 [INFO]: 424.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:42,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:37:42,836 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:42
2025-03-13 17:37:42,836 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:42,836 [INFO]: 	Creating the index 03/13/2025, 17:37:42
2025-03-13 17:37:42,836 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:42
2025-03-13 17:37:42,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:37:42,837 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:42
2025-03-13 17:37:42,837 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:37:42,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.52it/s] 44%|████▍     | 4/9 [00:00<00:00, 10.96it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.95it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.54it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.55it/s]100%|██████████| 9/9 [00:02<00:00,  2.23it/s]100%|██████████| 9/9 [00:02<00:00,  3.96it/s]
2025-03-13 17:37:45,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:45
2025-03-13 17:38:14,136 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0255 secs
2025-03-13 17:38:14,136 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 17:38:14,136 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s]
2025-03-13 17:38:36,678 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5422 secs
2025-03-13 17:38:37,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3958 secs
2025-03-13 17:38:37,233 [INFO]: {
2025-03-13 17:38:37,233 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:37,233 [INFO]: 	index_param: efSearch=284
2025-03-13 17:38:37,233 [INFO]: 	index_path: knn.index
2025-03-13 17:38:37,233 [INFO]: 	size in bytes: 404702350
2025-03-13 17:38:37,233 [INFO]: 	avg_search_speed_ms: 8.959668225944242
2025-03-13 17:38:37,233 [INFO]: 	99p_search_speed_ms: 13.101066777016957
2025-03-13 17:38:37,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:37,233 [INFO]: 	nb vectors: 2057
2025-03-13 17:38:37,233 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:37,233 [INFO]: 	compression ratio: 0.9993088896073867
2025-03-13 17:38:37,234 [INFO]: }
2025-03-13 17:38:37,234 [INFO]: 	>>> Finished "Creating the index" in 54.3980 secs
2025-03-13 17:38:37,234 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4232 secs
2025-03-13 17:38:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 88411 [episode count 9/20]
[retrieval_preprocessing] for episode 70919 [episode count 10/20], we have num_retrieval=np.int64(2073) num_query=np.int64(100)
2025-03-13 17:38:39,152 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:39,530 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:39
2025-03-13 17:38:39,531 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1414.61it/s]
2025-03-13 17:38:39,553 [INFO]: There are 2073 embeddings of dim 49152
2025-03-13 17:38:39,553 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 17:38:39,553 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,553 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:39,553 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:38:39,553 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:39,553 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:39,553 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,553 [INFO]: 427.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:39,553 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:38:39,553 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:39
2025-03-13 17:38:39,553 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:39,554 [INFO]: 	Creating the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,554 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:39
2025-03-13 17:38:39,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:38:39,555 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:39
2025-03-13 17:38:39,555 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:38:39,555 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.15it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.58it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.40it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.93it/s]100%|██████████| 9/9 [00:02<00:00,  2.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.94it/s]
2025-03-13 17:38:41,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:41
2025-03-13 17:39:16,317 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4737 secs
2025-03-13 17:39:16,317 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 17:39:16,317 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.07it/s] 50%|█████     | 2/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 17:39:34,952 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6345 secs
2025-03-13 17:39:34,954 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3991 secs
2025-03-13 17:39:34,954 [INFO]: {
2025-03-13 17:39:34,954 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:34,954 [INFO]: 	index_param: efSearch=249
2025-03-13 17:39:34,954 [INFO]: 	index_path: knn.index
2025-03-13 17:39:34,954 [INFO]: 	size in bytes: 407850190
2025-03-13 17:39:34,954 [INFO]: 	avg_search_speed_ms: 10.113113905850296
2025-03-13 17:39:34,954 [INFO]: 	99p_search_speed_ms: 16.740589970722798
2025-03-13 17:39:34,954 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:34,954 [INFO]: 	nb vectors: 2073
2025-03-13 17:39:34,954 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:34,954 [INFO]: 	compression ratio: 0.9993090453139178
2025-03-13 17:39:34,954 [INFO]: }
2025-03-13 17:39:34,954 [INFO]: 	>>> Finished "Creating the index" in 55.4005 secs
2025-03-13 17:39:34,954 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4236 secs
2025-03-13 17:39:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 70919 [episode count 10/20]
[retrieval_preprocessing] for episode 42441 [episode count 11/20], we have num_retrieval=np.int64(2073) num_query=np.int64(100)
2025-03-13 17:39:36,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:37,114 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:37
2025-03-13 17:39:37,114 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1850.97it/s]
2025-03-13 17:39:37,138 [INFO]: There are 2073 embeddings of dim 49152
2025-03-13 17:39:37,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:39:37,138 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:37
2025-03-13 17:39:37,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:37,138 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:39:37,138 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:37,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:37,138 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:37
2025-03-13 17:39:37,138 [INFO]: 427.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:37,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:37,138 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:37
2025-03-13 17:39:37,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:37,138 [INFO]: 	Creating the index 03/13/2025, 17:39:37
2025-03-13 17:39:37,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:37
2025-03-13 17:39:37,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:39:37,139 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:37
2025-03-13 17:39:37,140 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:39:37,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.43it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.57it/s] 44%|████▍     | 4/9 [00:00<00:00, 10.02it/s] 67%|██████▋   | 6/9 [00:00<00:00, 10.20it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.20it/s]100%|██████████| 9/9 [00:02<00:00,  2.38it/s]100%|██████████| 9/9 [00:02<00:00,  3.76it/s]
2025-03-13 17:39:39,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:39
2025-03-13 17:40:05,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7371 secs
2025-03-13 17:40:05,273 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 17:40:05,273 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s]
2025-03-13 17:40:35,415 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1421 secs
2025-03-13 17:40:35,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2780 secs
2025-03-13 17:40:35,418 [INFO]: {
2025-03-13 17:40:35,418 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:35,418 [INFO]: 	index_param: efSearch=293
2025-03-13 17:40:35,418 [INFO]: 	index_path: knn.index
2025-03-13 17:40:35,418 [INFO]: 	size in bytes: 407850190
2025-03-13 17:40:35,418 [INFO]: 	avg_search_speed_ms: 11.79217693521114
2025-03-13 17:40:35,418 [INFO]: 	99p_search_speed_ms: 16.180848963558674
2025-03-13 17:40:35,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:35,418 [INFO]: 	nb vectors: 2073
2025-03-13 17:40:35,418 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:35,418 [INFO]: 	compression ratio: 0.9993090453139178
2025-03-13 17:40:35,418 [INFO]: }
2025-03-13 17:40:35,418 [INFO]: 	>>> Finished "Creating the index" in 58.2794 secs
2025-03-13 17:40:35,418 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3034 secs
2025-03-13 17:40:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 42441 [episode count 11/20]
[retrieval_preprocessing] for episode 95154 [episode count 12/20], we have num_retrieval=np.int64(2104) num_query=np.int64(69)
2025-03-13 17:40:37,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:38,226 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:38
2025-03-13 17:40:38,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 926.51it/s]
2025-03-13 17:40:38,263 [INFO]: There are 2104 embeddings of dim 49152
2025-03-13 17:40:38,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 17:40:38,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:38
2025-03-13 17:40:38,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:38,264 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:40:38,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:38,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:40:38,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:38
2025-03-13 17:40:38,264 [INFO]: 434.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:38,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:38,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:38
2025-03-13 17:40:38,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:38,264 [INFO]: 	Creating the index 03/13/2025, 17:40:38
2025-03-13 17:40:38,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:38
2025-03-13 17:40:38,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:40:38,266 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:38
2025-03-13 17:40:38,266 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:40:38,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.03it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.04it/s]100%|██████████| 9/9 [00:01<00:00,  4.67it/s]100%|██████████| 9/9 [00:01<00:00,  5.43it/s]
2025-03-13 17:40:39,929 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:39
2025-03-13 17:41:12,884 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9540 secs
2025-03-13 17:41:12,884 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:41:12,884 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-13 17:41:32,090 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2055 secs
2025-03-13 17:41:32,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8261 secs
2025-03-13 17:41:32,092 [INFO]: {
2025-03-13 17:41:32,092 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:32,092 [INFO]: 	index_param: efSearch=230
2025-03-13 17:41:32,092 [INFO]: 	index_path: knn.index
2025-03-13 17:41:32,092 [INFO]: 	size in bytes: 413949250
2025-03-13 17:41:32,092 [INFO]: 	avg_search_speed_ms: 11.492679705147514
2025-03-13 17:41:32,092 [INFO]: 	99p_search_speed_ms: 16.92696346435696
2025-03-13 17:41:32,092 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:32,092 [INFO]: 	nb vectors: 2104
2025-03-13 17:41:32,092 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:32,092 [INFO]: 	compression ratio: 0.9993090505659812
2025-03-13 17:41:32,092 [INFO]: }
2025-03-13 17:41:32,092 [INFO]: 	>>> Finished "Creating the index" in 53.8282 secs
2025-03-13 17:41:32,092 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8660 secs
2025-03-13 17:41:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 95154 [episode count 12/20]
[retrieval_preprocessing] for episode 27580 [episode count 13/20], we have num_retrieval=np.int64(2085) num_query=np.int64(88)
2025-03-13 17:41:33,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:33,957 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:33
2025-03-13 17:41:33,957 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2192.53it/s]
2025-03-13 17:41:33,980 [INFO]: There are 2085 embeddings of dim 49152
2025-03-13 17:41:33,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:41:33,980 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:33
2025-03-13 17:41:33,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:33,980 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:41:33,981 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:33,981 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:33,981 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:33
2025-03-13 17:41:33,981 [INFO]: 430.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:33,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:41:33,981 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:33
2025-03-13 17:41:33,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:33,981 [INFO]: 	Creating the index 03/13/2025, 17:41:33
2025-03-13 17:41:33,981 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:33
2025-03-13 17:41:33,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:41:33,982 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:33
2025-03-13 17:41:33,982 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:41:33,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.18it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.55it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.38it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.50it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.50it/s]100%|██████████| 9/9 [00:02<00:00,  2.29it/s]100%|██████████| 9/9 [00:02<00:00,  3.88it/s]
2025-03-13 17:41:36,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:36
2025-03-13 17:42:04,850 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5449 secs
2025-03-13 17:42:04,850 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 17:42:04,850 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 17:42:25,830 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9798 secs
2025-03-13 17:42:25,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8503 secs
2025-03-13 17:42:25,832 [INFO]: {
2025-03-13 17:42:25,832 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:25,832 [INFO]: 	index_param: efSearch=242
2025-03-13 17:42:25,832 [INFO]: 	index_path: knn.index
2025-03-13 17:42:25,832 [INFO]: 	size in bytes: 410211130
2025-03-13 17:42:25,832 [INFO]: 	avg_search_speed_ms: 9.191555495122243
2025-03-13 17:42:25,832 [INFO]: 	99p_search_speed_ms: 13.043450191616943
2025-03-13 17:42:25,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:25,832 [INFO]: 	nb vectors: 2085
2025-03-13 17:42:25,832 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:25,832 [INFO]: 	compression ratio: 0.9993090143604831
2025-03-13 17:42:25,832 [INFO]: }
2025-03-13 17:42:25,832 [INFO]: 	>>> Finished "Creating the index" in 51.8516 secs
2025-03-13 17:42:25,832 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8756 secs
2025-03-13 17:42:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 27580 [episode count 13/20]
[retrieval_preprocessing] for episode 46513 [episode count 14/20], we have num_retrieval=np.int64(2081) num_query=np.int64(92)
2025-03-13 17:42:27,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:27,809 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:27
2025-03-13 17:42:27,809 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.74it/s]
2025-03-13 17:42:27,834 [INFO]: There are 2081 embeddings of dim 49152
2025-03-13 17:42:27,834 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:42:27,835 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:27
2025-03-13 17:42:27,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:27,835 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:42:27,835 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:27,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:42:27,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:27
2025-03-13 17:42:27,835 [INFO]: 429.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:27,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:42:27,835 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:27
2025-03-13 17:42:27,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:27,835 [INFO]: 	Creating the index 03/13/2025, 17:42:27
2025-03-13 17:42:27,835 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:27
2025-03-13 17:42:27,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:42:27,836 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:27
2025-03-13 17:42:27,836 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:42:27,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.00it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.82it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.13it/s]100%|██████████| 9/9 [00:01<00:00,  3.25it/s]100%|██████████| 9/9 [00:01<00:00,  4.52it/s]
2025-03-13 17:42:29,830 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:29
2025-03-13 17:43:00,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1835 secs
2025-03-13 17:43:00,014 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 17:43:00,014 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.07it/s]
2025-03-13 17:43:18,348 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3341 secs
2025-03-13 17:43:18,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9017 secs
2025-03-13 17:43:18,738 [INFO]: {
2025-03-13 17:43:18,738 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:18,739 [INFO]: 	index_param: efSearch=236
2025-03-13 17:43:18,739 [INFO]: 	index_path: knn.index
2025-03-13 17:43:18,739 [INFO]: 	size in bytes: 409424170
2025-03-13 17:43:18,739 [INFO]: 	avg_search_speed_ms: 10.639072248731997
2025-03-13 17:43:18,739 [INFO]: 	99p_search_speed_ms: 24.36958418460563
2025-03-13 17:43:18,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:18,739 [INFO]: 	nb vectors: 2081
2025-03-13 17:43:18,739 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:18,739 [INFO]: 	compression ratio: 0.9993089758232886
2025-03-13 17:43:18,739 [INFO]: }
2025-03-13 17:43:18,739 [INFO]: 	>>> Finished "Creating the index" in 50.9040 secs
2025-03-13 17:43:18,739 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9300 secs
2025-03-13 17:43:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 46513 [episode count 14/20]
[retrieval_preprocessing] for episode 998 [episode count 15/20], we have num_retrieval=np.int64(2078) num_query=np.int64(95)
2025-03-13 17:43:20,412 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:20,725 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:20
2025-03-13 17:43:20,725 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1353.44it/s]
2025-03-13 17:43:20,754 [INFO]: There are 2078 embeddings of dim 49152
2025-03-13 17:43:20,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:43:20,755 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:20
2025-03-13 17:43:20,755 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:20,755 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:43:20,755 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:20,755 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:43:20,755 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:20
2025-03-13 17:43:20,755 [INFO]: 428.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:20,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:43:20,756 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:20
2025-03-13 17:43:20,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:20,756 [INFO]: 	Creating the index 03/13/2025, 17:43:20
2025-03-13 17:43:20,756 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:20
2025-03-13 17:43:20,759 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:43:20,759 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:20
2025-03-13 17:43:20,759 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:43:20,759 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.92it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.76it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.58it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.99it/s]100%|██████████| 9/9 [00:01<00:00,  3.27it/s]100%|██████████| 9/9 [00:01<00:00,  4.52it/s]
2025-03-13 17:43:22,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:22
2025-03-13 17:43:52,806 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0520 secs
2025-03-13 17:43:52,806 [INFO]: The best hyperparameters are: efSearch=340
2025-03-13 17:43:52,806 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 17:44:24,730 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9233 secs
2025-03-13 17:44:25,466 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7063 secs
2025-03-13 17:44:25,466 [INFO]: {
2025-03-13 17:44:25,466 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:25,466 [INFO]: 	index_param: efSearch=340
2025-03-13 17:44:25,466 [INFO]: 	index_path: knn.index
2025-03-13 17:44:25,466 [INFO]: 	size in bytes: 408833890
2025-03-13 17:44:25,466 [INFO]: 	avg_search_speed_ms: 10.99331543837152
2025-03-13 17:44:25,466 [INFO]: 	99p_search_speed_ms: 16.043906528502703
2025-03-13 17:44:25,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:25,466 [INFO]: 	nb vectors: 2078
2025-03-13 17:44:25,466 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:25,466 [INFO]: 	compression ratio: 0.9993090934804842
2025-03-13 17:44:25,467 [INFO]: }
2025-03-13 17:44:25,467 [INFO]: 	>>> Finished "Creating the index" in 64.7106 secs
2025-03-13 17:44:25,467 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7414 secs
2025-03-13 17:44:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 998 [episode count 15/20]
[retrieval_preprocessing] for episode 58602 [episode count 16/20], we have num_retrieval=np.int64(2075) num_query=np.int64(98)
2025-03-13 17:44:28,044 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:28,394 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:28
2025-03-13 17:44:28,394 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2328.88it/s]
2025-03-13 17:44:28,419 [INFO]: There are 2075 embeddings of dim 49152
2025-03-13 17:44:28,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:44:28,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:28
2025-03-13 17:44:28,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:28,419 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:44:28,419 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:28,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:28,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:28
2025-03-13 17:44:28,419 [INFO]: 428.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:28,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:44:28,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:28
2025-03-13 17:44:28,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:28,419 [INFO]: 	Creating the index 03/13/2025, 17:44:28
2025-03-13 17:44:28,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:28
2025-03-13 17:44:28,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:44:28,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:28
2025-03-13 17:44:28,420 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:44:28,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.37it/s] 44%|████▍     | 4/9 [00:00<00:00, 17.68it/s] 78%|███████▊  | 7/9 [00:00<00:00, 19.57it/s]100%|██████████| 9/9 [00:01<00:00,  3.55it/s]100%|██████████| 9/9 [00:01<00:00,  4.87it/s]
2025-03-13 17:44:30,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:30
2025-03-13 17:45:09,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9801 secs
2025-03-13 17:45:09,939 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:45:09,939 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 17:45:30,628 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6885 secs
2025-03-13 17:45:30,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2097 secs
2025-03-13 17:45:30,630 [INFO]: {
2025-03-13 17:45:30,630 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:30,630 [INFO]: 	index_param: efSearch=174
2025-03-13 17:45:30,630 [INFO]: 	index_path: knn.index
2025-03-13 17:45:30,630 [INFO]: 	size in bytes: 408243670
2025-03-13 17:45:30,630 [INFO]: 	avg_search_speed_ms: 10.307572497602207
2025-03-13 17:45:30,630 [INFO]: 	99p_search_speed_ms: 17.827543031889903
2025-03-13 17:45:30,630 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:30,630 [INFO]: 	nb vectors: 2075
2025-03-13 17:45:30,630 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:30,630 [INFO]: 	compression ratio: 0.9993090646083992
2025-03-13 17:45:30,630 [INFO]: }
2025-03-13 17:45:30,630 [INFO]: 	>>> Finished "Creating the index" in 62.2111 secs
2025-03-13 17:45:30,630 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2365 secs
2025-03-13 17:45:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 58602 [episode count 16/20]
[retrieval_preprocessing] for episode 18119 [episode count 17/20], we have num_retrieval=np.int64(2071) num_query=np.int64(102)
2025-03-13 17:45:32,251 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:32,684 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:32
2025-03-13 17:45:32,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1188.52it/s]
2025-03-13 17:45:32,712 [INFO]: There are 2071 embeddings of dim 49152
2025-03-13 17:45:32,712 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:45:32,712 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:32
2025-03-13 17:45:32,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:32,712 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:45:32,712 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:32,713 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:32,713 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:32
2025-03-13 17:45:32,713 [INFO]: 427.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:32,713 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:45:32,713 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:32
2025-03-13 17:45:32,713 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:32,713 [INFO]: 	Creating the index 03/13/2025, 17:45:32
2025-03-13 17:45:32,713 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:32
2025-03-13 17:45:32,714 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:45:32,714 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:32
2025-03-13 17:45:32,714 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:45:32,714 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.00it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.57it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.93it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.18it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.09it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.03it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.98it/s]100%|██████████| 9/9 [00:02<00:00,  1.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.48it/s]
2025-03-13 17:45:35,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:35
2025-03-13 17:46:05,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6566 secs
2025-03-13 17:46:05,016 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 17:46:05,016 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-13 17:46:21,483 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4670 secs
2025-03-13 17:46:21,485 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7707 secs
2025-03-13 17:46:21,485 [INFO]: {
2025-03-13 17:46:21,485 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:21,485 [INFO]: 	index_param: efSearch=277
2025-03-13 17:46:21,485 [INFO]: 	index_path: knn.index
2025-03-13 17:46:21,485 [INFO]: 	size in bytes: 407456710
2025-03-13 17:46:21,485 [INFO]: 	avg_search_speed_ms: 10.37499009818998
2025-03-13 17:46:21,485 [INFO]: 	99p_search_speed_ms: 16.990266675129533
2025-03-13 17:46:21,485 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:21,485 [INFO]: 	nb vectors: 2071
2025-03-13 17:46:21,485 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:21,485 [INFO]: 	compression ratio: 0.9993090259821712
2025-03-13 17:46:21,485 [INFO]: }
2025-03-13 17:46:21,485 [INFO]: 	>>> Finished "Creating the index" in 48.7723 secs
2025-03-13 17:46:21,485 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8011 secs
2025-03-13 17:46:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 18119 [episode count 17/20]
[retrieval_preprocessing] for episode 75009 [episode count 18/20], we have num_retrieval=np.int64(2004) num_query=np.int64(169)
2025-03-13 17:46:23,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:23,782 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:23
2025-03-13 17:46:23,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.40it/s]
2025-03-13 17:46:23,808 [INFO]: There are 2004 embeddings of dim 49152
2025-03-13 17:46:23,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:46:23,809 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:23
2025-03-13 17:46:23,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:23,809 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:46:23,809 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:23,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:23,809 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:23
2025-03-13 17:46:23,809 [INFO]: 413.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:23,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:23,809 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:23
2025-03-13 17:46:23,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:23,809 [INFO]: 	Creating the index 03/13/2025, 17:46:23
2025-03-13 17:46:23,809 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:23
2025-03-13 17:46:23,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:46:23,810 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:23
2025-03-13 17:46:23,810 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:46:23,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.30it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.51it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.04it/s] 50%|█████     | 4/8 [00:00<00:00,  7.33it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.50it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.68it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.70it/s]100%|██████████| 8/8 [00:02<00:00,  1.82it/s]100%|██████████| 8/8 [00:02<00:00,  3.33it/s]
2025-03-13 17:46:26,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:26
2025-03-13 17:46:57,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5613 secs
2025-03-13 17:46:57,784 [INFO]: The best hyperparameters are: efSearch=332
2025-03-13 17:46:57,784 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 17:47:17,019 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2353 secs
2025-03-13 17:47:17,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2106 secs
2025-03-13 17:47:17,021 [INFO]: {
2025-03-13 17:47:17,021 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:17,021 [INFO]: 	index_param: efSearch=332
2025-03-13 17:47:17,022 [INFO]: 	index_path: knn.index
2025-03-13 17:47:17,022 [INFO]: 	size in bytes: 394274890
2025-03-13 17:47:17,022 [INFO]: 	avg_search_speed_ms: 11.842276366460606
2025-03-13 17:47:17,022 [INFO]: 	99p_search_speed_ms: 17.294416073709726
2025-03-13 17:47:17,022 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:17,022 [INFO]: 	nb vectors: 2004
2025-03-13 17:47:17,022 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:17,022 [INFO]: 	compression ratio: 0.9993089643624021
2025-03-13 17:47:17,022 [INFO]: }
2025-03-13 17:47:17,022 [INFO]: 	>>> Finished "Creating the index" in 53.2125 secs
2025-03-13 17:47:17,022 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2399 secs
2025-03-13 17:47:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 75009 [episode count 18/20]
[retrieval_preprocessing] for episode 17517 [episode count 19/20], we have num_retrieval=np.int64(2042) num_query=np.int64(131)
2025-03-13 17:47:19,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:20,150 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:20
2025-03-13 17:47:20,150 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 858.78it/s]
2025-03-13 17:47:20,182 [INFO]: There are 2042 embeddings of dim 49152
2025-03-13 17:47:20,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 17:47:20,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:20
2025-03-13 17:47:20,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:20,182 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:47:20,183 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:20,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:47:20,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:20
2025-03-13 17:47:20,183 [INFO]: 421.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:20,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:47:20,184 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:20
2025-03-13 17:47:20,184 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:20,184 [INFO]: 	Creating the index 03/13/2025, 17:47:20
2025-03-13 17:47:20,184 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:20
2025-03-13 17:47:20,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:47:20,187 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:20
2025-03-13 17:47:20,187 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:47:20,187 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.31it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.90it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.43it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.38it/s]100%|██████████| 9/9 [00:02<00:00,  3.09it/s]100%|██████████| 9/9 [00:02<00:00,  4.39it/s]
2025-03-13 17:47:22,243 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:22
2025-03-13 17:47:57,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3488 secs
2025-03-13 17:47:57,592 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 17:47:57,593 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 17:48:20,845 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2520 secs
2025-03-13 17:48:20,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6593 secs
2025-03-13 17:48:20,847 [INFO]: {
2025-03-13 17:48:20,847 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:20,847 [INFO]: 	index_param: efSearch=300
2025-03-13 17:48:20,847 [INFO]: 	index_path: knn.index
2025-03-13 17:48:20,847 [INFO]: 	size in bytes: 401751250
2025-03-13 17:48:20,847 [INFO]: 	avg_search_speed_ms: 9.422925380993421
2025-03-13 17:48:20,847 [INFO]: 	99p_search_speed_ms: 12.990218913182648
2025-03-13 17:48:20,847 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:20,847 [INFO]: 	nb vectors: 2042
2025-03-13 17:48:20,847 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:20,847 [INFO]: 	compression ratio: 0.999308741416486
2025-03-13 17:48:20,847 [INFO]: }
2025-03-13 17:48:20,847 [INFO]: 	>>> Finished "Creating the index" in 60.6630 secs
2025-03-13 17:48:20,847 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6972 secs
2025-03-13 17:48:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 17517 [episode count 19/20]
2025-03-13 17:48:22: [retrieval_preprocessing] finished for 5235850418_close_top_drawer_right_cabinet [chosen_id count 6/196]
2025-03-13 17:48:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_bottom_drawer_right_cabinet [chosen_id count 7/196]
2025-03-13 17:48:24: [retrieval_preprocessing] we have num_total=1885 embedding_dim=49152
[retrieval_preprocessing] for episode 16 [episode count 0/20], we have num_retrieval=np.int64(1759) num_query=np.int64(126)
2025-03-13 17:48:24,851 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:25,125 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:25
2025-03-13 17:48:25,126 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1989.71it/s]
2025-03-13 17:48:25,152 [INFO]: There are 1759 embeddings of dim 49152
2025-03-13 17:48:25,152 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:48:25,152 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:25
2025-03-13 17:48:25,152 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:25,153 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:48:25,153 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:25,153 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:48:25,153 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:25
2025-03-13 17:48:25,153 [INFO]: 363.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:25,154 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:48:25,154 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:25
2025-03-13 17:48:25,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:25,154 [INFO]: 	Creating the index 03/13/2025, 17:48:25
2025-03-13 17:48:25,154 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:25
2025-03-13 17:48:25,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:48:25,158 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:25
2025-03-13 17:48:25,158 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:48:25,158 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.79it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.94it/s] 71%|███████▏  | 5/7 [00:00<00:00, 10.02it/s]100%|██████████| 7/7 [00:01<00:00,  2.89it/s]100%|██████████| 7/7 [00:01<00:00,  3.69it/s]
2025-03-13 17:48:27,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:27
2025-03-13 17:49:03,562 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4966 secs
2025-03-13 17:49:03,562 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:49:03,562 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.14it/s] 50%|█████     | 2/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 17:49:19,204 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6415 secs
2025-03-13 17:49:19,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0477 secs
2025-03-13 17:49:19,206 [INFO]: {
2025-03-13 17:49:19,206 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:19,206 [INFO]: 	index_param: efSearch=206
2025-03-13 17:49:19,206 [INFO]: 	index_path: knn.index
2025-03-13 17:49:19,206 [INFO]: 	size in bytes: 346072690
2025-03-13 17:49:19,206 [INFO]: 	avg_search_speed_ms: 11.223787470332919
2025-03-13 17:49:19,206 [INFO]: 	99p_search_speed_ms: 19.031553179956973
2025-03-13 17:49:19,206 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:19,206 [INFO]: 	nb vectors: 1759
2025-03-13 17:49:19,206 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:19,206 [INFO]: 	compression ratio: 0.9993087637166631
2025-03-13 17:49:19,206 [INFO]: }
2025-03-13 17:49:19,206 [INFO]: 	>>> Finished "Creating the index" in 54.0518 secs
2025-03-13 17:49:19,206 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0804 secs
2025-03-13 17:49:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 16 [episode count 0/20]
[retrieval_preprocessing] for episode 83978 [episode count 1/20], we have num_retrieval=np.int64(1784) num_query=np.int64(101)
2025-03-13 17:49:20,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:21,334 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:21
2025-03-13 17:49:21,334 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.93it/s]
2025-03-13 17:49:21,356 [INFO]: There are 1784 embeddings of dim 49152
2025-03-13 17:49:21,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 17:49:21,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:21
2025-03-13 17:49:21,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:21,356 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:49:21,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:21,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:49:21,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:21
2025-03-13 17:49:21,357 [INFO]: 368.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:21,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:21,357 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:21
2025-03-13 17:49:21,357 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:21,357 [INFO]: 	Creating the index 03/13/2025, 17:49:21
2025-03-13 17:49:21,357 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:21
2025-03-13 17:49:21,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:49:21,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:21
2025-03-13 17:49:21,359 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:49:21,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.12it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.46it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.08it/s] 50%|█████     | 4/8 [00:00<00:00,  8.22it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.95it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.13it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.53it/s]100%|██████████| 8/8 [00:02<00:00,  1.82it/s]100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
2025-03-13 17:49:23,700 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:23
2025-03-13 17:49:54,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7872 secs
2025-03-13 17:49:54,488 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:49:54,488 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 17:50:18,237 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7488 secs
2025-03-13 17:50:18,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0958 secs
2025-03-13 17:50:18,455 [INFO]: {
2025-03-13 17:50:18,455 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:18,455 [INFO]: 	index_param: efSearch=270
2025-03-13 17:50:18,455 [INFO]: 	index_path: knn.index
2025-03-13 17:50:18,455 [INFO]: 	size in bytes: 350991310
2025-03-13 17:50:18,455 [INFO]: 	avg_search_speed_ms: 10.73762215348811
2025-03-13 17:50:18,455 [INFO]: 	99p_search_speed_ms: 14.631758932955563
2025-03-13 17:50:18,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:18,455 [INFO]: 	nb vectors: 1784
2025-03-13 17:50:18,455 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:18,455 [INFO]: 	compression ratio: 0.9993087065317942
2025-03-13 17:50:18,455 [INFO]: }
2025-03-13 17:50:18,455 [INFO]: 	>>> Finished "Creating the index" in 57.0983 secs
2025-03-13 17:50:18,455 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1214 secs
2025-03-13 17:50:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 83978 [episode count 1/20]
[retrieval_preprocessing] for episode 94234 [episode count 2/20], we have num_retrieval=np.int64(1816) num_query=np.int64(69)
2025-03-13 17:50:20,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:21,226 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:21
2025-03-13 17:50:21,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.12it/s]
2025-03-13 17:50:21,256 [INFO]: There are 1816 embeddings of dim 49152
2025-03-13 17:50:21,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 17:50:21,257 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:21,257 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:50:21,257 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:21,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:21,257 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,257 [INFO]: 374.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:21,257 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:50:21,257 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:21
2025-03-13 17:50:21,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:21,257 [INFO]: 	Creating the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,257 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:21
2025-03-13 17:50:21,258 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:50:21,259 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,259 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:50:21,259 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  3.87it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.20it/s] 50%|█████     | 4/8 [00:00<00:00,  7.82it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.02it/s]100%|██████████| 8/8 [00:02<00:00,  2.59it/s]100%|██████████| 8/8 [00:02<00:00,  3.39it/s]
2025-03-13 17:50:23,620 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:23
2025-03-13 17:50:54,326 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7057 secs
2025-03-13 17:50:54,326 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:50:54,326 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.62it/s] 50%|█████     | 2/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 17:51:14,231 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9048 secs
2025-03-13 17:51:14,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9742 secs
2025-03-13 17:51:14,233 [INFO]: {
2025-03-13 17:51:14,233 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:14,233 [INFO]: 	index_param: efSearch=251
2025-03-13 17:51:14,233 [INFO]: 	index_path: knn.index
2025-03-13 17:51:14,233 [INFO]: 	size in bytes: 357287050
2025-03-13 17:51:14,233 [INFO]: 	avg_search_speed_ms: 10.196206829188796
2025-03-13 17:51:14,233 [INFO]: 	99p_search_speed_ms: 14.395378530025482
2025-03-13 17:51:14,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:14,233 [INFO]: 	nb vectors: 1816
2025-03-13 17:51:14,233 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:14,233 [INFO]: 	compression ratio: 0.9993088974257534
2025-03-13 17:51:14,233 [INFO]: }
2025-03-13 17:51:14,233 [INFO]: 	>>> Finished "Creating the index" in 52.9760 secs
2025-03-13 17:51:14,233 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0065 secs
2025-03-13 17:51:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 94234 [episode count 2/20]
[retrieval_preprocessing] for episode 20511 [episode count 3/20], we have num_retrieval=np.int64(1801) num_query=np.int64(84)
2025-03-13 17:51:15,605 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:15,892 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:15
2025-03-13 17:51:15,892 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.85it/s]
2025-03-13 17:51:15,920 [INFO]: There are 1801 embeddings of dim 49152
2025-03-13 17:51:15,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:51:15,921 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:15,921 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:51:15,921 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:15,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:51:15,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,922 [INFO]: 371.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:15,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:51:15,922 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:15
2025-03-13 17:51:15,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:15,923 [INFO]: 	Creating the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,923 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:15
2025-03-13 17:51:15,926 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:51:15,926 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,926 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:51:15,926 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.43it/s] 50%|█████     | 4/8 [00:00<00:00, 18.56it/s] 88%|████████▊ | 7/8 [00:00<00:00, 22.94it/s]100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
2025-03-13 17:51:17,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:17
2025-03-13 17:51:42,630 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9593 secs
2025-03-13 17:51:42,631 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 17:51:42,631 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-13 17:52:01,974 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3436 secs
2025-03-13 17:52:01,976 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0501 secs
2025-03-13 17:52:01,976 [INFO]: {
2025-03-13 17:52:01,976 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:01,976 [INFO]: 	index_param: efSearch=228
2025-03-13 17:52:01,976 [INFO]: 	index_path: knn.index
2025-03-13 17:52:01,976 [INFO]: 	size in bytes: 354335950
2025-03-13 17:52:01,976 [INFO]: 	avg_search_speed_ms: 10.796652251168618
2025-03-13 17:52:01,976 [INFO]: 	99p_search_speed_ms: 15.121083124540746
2025-03-13 17:52:01,976 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:01,976 [INFO]: 	nb vectors: 1801
2025-03-13 17:52:01,976 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:01,976 [INFO]: 	compression ratio: 0.9993087294698717
2025-03-13 17:52:01,976 [INFO]: }
2025-03-13 17:52:01,977 [INFO]: 	>>> Finished "Creating the index" in 46.0537 secs
2025-03-13 17:52:01,977 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0844 secs
2025-03-13 17:52:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 20511 [episode count 3/20]
[retrieval_preprocessing] for episode 57393 [episode count 4/20], we have num_retrieval=np.int64(1794) num_query=np.int64(91)
2025-03-13 17:52:03,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:03,278 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:03
2025-03-13 17:52:03,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1081.01it/s]
2025-03-13 17:52:03,313 [INFO]: There are 1794 embeddings of dim 49152
2025-03-13 17:52:03,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 17:52:03,314 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,314 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:03,314 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:52:03,314 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:03,314 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:03,314 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,314 [INFO]: 370.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:03,314 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:03,314 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:03
2025-03-13 17:52:03,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:03,314 [INFO]: 	Creating the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,314 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:03
2025-03-13 17:52:03,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:52:03,316 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,316 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:52:03,316 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.23it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.00it/s]100%|██████████| 8/8 [00:01<00:00,  5.36it/s]
2025-03-13 17:52:04,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:04
2025-03-13 17:52:34,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7261 secs
2025-03-13 17:52:34,539 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 17:52:34,539 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 17:52:50,996 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4569 secs
2025-03-13 17:52:50,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6817 secs
2025-03-13 17:52:50,998 [INFO]: {
2025-03-13 17:52:50,998 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:50,998 [INFO]: 	index_param: efSearch=219
2025-03-13 17:52:50,998 [INFO]: 	index_path: knn.index
2025-03-13 17:52:50,998 [INFO]: 	size in bytes: 352958770
2025-03-13 17:52:50,998 [INFO]: 	avg_search_speed_ms: 10.751149581873312
2025-03-13 17:52:50,998 [INFO]: 	99p_search_speed_ms: 16.82486068457367
2025-03-13 17:52:50,998 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:50,998 [INFO]: 	nb vectors: 1794
2025-03-13 17:52:50,998 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:50,998 [INFO]: 	compression ratio: 0.9993086501293055
2025-03-13 17:52:50,998 [INFO]: }
2025-03-13 17:52:50,998 [INFO]: 	>>> Finished "Creating the index" in 47.6836 secs
2025-03-13 17:52:50,998 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7198 secs
2025-03-13 17:52:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 57393 [episode count 4/20]
[retrieval_preprocessing] for episode 22594 [episode count 5/20], we have num_retrieval=np.int64(1812) num_query=np.int64(73)
2025-03-13 17:52:52,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:52,695 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:52
2025-03-13 17:52:52,695 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.39it/s]
2025-03-13 17:52:52,724 [INFO]: There are 1812 embeddings of dim 49152
2025-03-13 17:52:52,725 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 17:52:52,725 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:52
2025-03-13 17:52:52,725 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:52,725 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:52:52,725 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:52,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:52:52,725 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:52
2025-03-13 17:52:52,726 [INFO]: 374.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:52,726 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:52:52,726 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:52
2025-03-13 17:52:52,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:52,726 [INFO]: 	Creating the index 03/13/2025, 17:52:52
2025-03-13 17:52:52,726 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:52
2025-03-13 17:52:52,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:52:52,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:52
2025-03-13 17:52:52,728 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:52:52,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.78it/s] 62%|██████▎   | 5/8 [00:00<00:00, 24.79it/s]100%|██████████| 8/8 [00:02<00:00,  3.08it/s]100%|██████████| 8/8 [00:02<00:00,  3.75it/s]
2025-03-13 17:52:54,864 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:54
2025-03-13 17:53:27,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0486 secs
2025-03-13 17:53:27,913 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:53:27,913 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-13 17:53:43,737 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8238 secs
2025-03-13 17:53:43,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0105 secs
2025-03-13 17:53:43,739 [INFO]: {
2025-03-13 17:53:43,739 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:43,739 [INFO]: 	index_param: efSearch=234
2025-03-13 17:53:43,739 [INFO]: 	index_path: knn.index
2025-03-13 17:53:43,739 [INFO]: 	size in bytes: 356500090
2025-03-13 17:53:43,739 [INFO]: 	avg_search_speed_ms: 10.19303372369986
2025-03-13 17:53:43,739 [INFO]: 	99p_search_speed_ms: 16.102271014824517
2025-03-13 17:53:43,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:43,739 [INFO]: 	nb vectors: 1812
2025-03-13 17:53:43,739 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:43,739 [INFO]: 	compression ratio: 0.999308852909406
2025-03-13 17:53:43,739 [INFO]: }
2025-03-13 17:53:43,739 [INFO]: 	>>> Finished "Creating the index" in 51.0131 secs
2025-03-13 17:53:43,739 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0442 secs
2025-03-13 17:53:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 22594 [episode count 5/20]
[retrieval_preprocessing] for episode 12378 [episode count 6/20], we have num_retrieval=np.int64(1796) num_query=np.int64(89)
2025-03-13 17:53:46,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:47,149 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:47
2025-03-13 17:53:47,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1331.10it/s]
2025-03-13 17:53:47,176 [INFO]: There are 1796 embeddings of dim 49152
2025-03-13 17:53:47,177 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:53:47,177 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:47
2025-03-13 17:53:47,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:47,178 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:53:47,178 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:47,178 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:53:47,178 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:47
2025-03-13 17:53:47,179 [INFO]: 370.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:47,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:53:47,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:47
2025-03-13 17:53:47,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:47,180 [INFO]: 	Creating the index 03/13/2025, 17:53:47
2025-03-13 17:53:47,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:47
2025-03-13 17:53:47,183 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:53:47,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:47
2025-03-13 17:53:47,184 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:53:47,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 25.69it/s]100%|██████████| 8/8 [00:01<00:00,  5.00it/s]100%|██████████| 8/8 [00:01<00:00,  5.49it/s]
2025-03-13 17:53:48,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:48
2025-03-13 17:54:19,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1086 secs
2025-03-13 17:54:19,756 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 17:54:19,756 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 17:54:39,589 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8324 secs
2025-03-13 17:54:39,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4062 secs
2025-03-13 17:54:39,590 [INFO]: {
2025-03-13 17:54:39,590 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:39,590 [INFO]: 	index_param: efSearch=229
2025-03-13 17:54:39,590 [INFO]: 	index_path: knn.index
2025-03-13 17:54:39,590 [INFO]: 	size in bytes: 353352250
2025-03-13 17:54:39,590 [INFO]: 	avg_search_speed_ms: 8.835364670357782
2025-03-13 17:54:39,590 [INFO]: 	99p_search_speed_ms: 12.494050860404972
2025-03-13 17:54:39,590 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:39,590 [INFO]: 	nb vectors: 1796
2025-03-13 17:54:39,590 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:39,590 [INFO]: 	compression ratio: 0.9993086728611463
2025-03-13 17:54:39,590 [INFO]: }
2025-03-13 17:54:39,590 [INFO]: 	>>> Finished "Creating the index" in 52.4107 secs
2025-03-13 17:54:39,590 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4416 secs
2025-03-13 17:54:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 12378 [episode count 6/20]
[retrieval_preprocessing] for episode 57487 [episode count 7/20], we have num_retrieval=np.int64(1789) num_query=np.int64(96)
2025-03-13 17:54:42,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:43,456 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:43
2025-03-13 17:54:43,456 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1596.61it/s]
2025-03-13 17:54:43,483 [INFO]: There are 1789 embeddings of dim 49152
2025-03-13 17:54:43,484 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 17:54:43,484 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:43
2025-03-13 17:54:43,484 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:43,484 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:54:43,484 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:43,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:54:43,484 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:43
2025-03-13 17:54:43,484 [INFO]: 369.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:43,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:54:43,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:43
2025-03-13 17:54:43,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:43,484 [INFO]: 	Creating the index 03/13/2025, 17:54:43
2025-03-13 17:54:43,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:43
2025-03-13 17:54:43,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:54:43,486 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:43
2025-03-13 17:54:43,486 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:54:43,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.50it/s] 75%|███████▌  | 6/8 [00:00<00:00, 30.51it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]
2025-03-13 17:54:44,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:44
2025-03-13 17:55:16,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7289 secs
2025-03-13 17:55:16,649 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 17:55:16,649 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 17:55:35,509 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8608 secs
2025-03-13 17:55:35,511 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0252 secs
2025-03-13 17:55:35,511 [INFO]: {
2025-03-13 17:55:35,511 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:35,511 [INFO]: 	index_param: efSearch=242
2025-03-13 17:55:35,511 [INFO]: 	index_path: knn.index
2025-03-13 17:55:35,511 [INFO]: 	size in bytes: 351975010
2025-03-13 17:55:35,511 [INFO]: 	avg_search_speed_ms: 12.266662359477644
2025-03-13 17:55:35,511 [INFO]: 	99p_search_speed_ms: 19.5081925438717
2025-03-13 17:55:35,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:35,511 [INFO]: 	nb vectors: 1789
2025-03-13 17:55:35,511 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:35,511 [INFO]: 	compression ratio: 0.9993087634261307
2025-03-13 17:55:35,511 [INFO]: }
2025-03-13 17:55:35,511 [INFO]: 	>>> Finished "Creating the index" in 52.0268 secs
2025-03-13 17:55:35,511 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0546 secs
2025-03-13 17:55:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 57487 [episode count 7/20]
[retrieval_preprocessing] for episode 26845 [episode count 8/20], we have num_retrieval=np.int64(1825) num_query=np.int64(60)
2025-03-13 17:55:36,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:36,951 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:36
2025-03-13 17:55:36,951 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1876.65it/s]
2025-03-13 17:55:36,976 [INFO]: There are 1825 embeddings of dim 49152
2025-03-13 17:55:36,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:55:36,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:36
2025-03-13 17:55:36,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:36,977 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:55:36,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:36,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:55:36,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:36
2025-03-13 17:55:36,978 [INFO]: 376.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:36,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:55:36,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:36
2025-03-13 17:55:36,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:36,978 [INFO]: 	Creating the index 03/13/2025, 17:55:36
2025-03-13 17:55:36,978 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:36
2025-03-13 17:55:36,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:55:36,982 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:36
2025-03-13 17:55:36,982 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:55:36,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.32it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.12it/s]100%|██████████| 8/8 [00:01<00:00,  5.07it/s]
2025-03-13 17:55:38,564 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:38
2025-03-13 17:56:11,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7403 secs
2025-03-13 17:56:11,306 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 17:56:11,306 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
2025-03-13 17:56:25,812 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5066 secs
2025-03-13 17:56:25,814 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8322 secs
2025-03-13 17:56:25,814 [INFO]: {
2025-03-13 17:56:25,814 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:25,814 [INFO]: 	index_param: efSearch=224
2025-03-13 17:56:25,814 [INFO]: 	index_path: knn.index
2025-03-13 17:56:25,814 [INFO]: 	size in bytes: 359057710
2025-03-13 17:56:25,814 [INFO]: 	avg_search_speed_ms: 11.49301911227876
2025-03-13 17:56:25,814 [INFO]: 	99p_search_speed_ms: 18.293456563260403
2025-03-13 17:56:25,814 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:25,814 [INFO]: 	nb vectors: 1825
2025-03-13 17:56:25,814 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:25,814 [INFO]: 	compression ratio: 0.9993089968740679
2025-03-13 17:56:25,814 [INFO]: }
2025-03-13 17:56:25,814 [INFO]: 	>>> Finished "Creating the index" in 48.8360 secs
2025-03-13 17:56:25,814 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8630 secs
2025-03-13 17:56:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 26845 [episode count 8/20]
[retrieval_preprocessing] for episode 39282 [episode count 9/20], we have num_retrieval=np.int64(1785) num_query=np.int64(100)
2025-03-13 17:56:26,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:26,849 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:26
2025-03-13 17:56:26,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.56it/s]
2025-03-13 17:56:26,882 [INFO]: There are 1785 embeddings of dim 49152
2025-03-13 17:56:26,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 17:56:26,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:26,883 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:56:26,883 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:26,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:56:26,884 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,884 [INFO]: 368.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:26,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:56:26,885 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:26
2025-03-13 17:56:26,885 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:26,885 [INFO]: 	Creating the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,885 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:26
2025-03-13 17:56:26,889 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:56:26,889 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,889 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:56:26,889 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.35it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.08it/s]100%|██████████| 8/8 [00:01<00:00,  5.54it/s]
2025-03-13 17:56:28,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:28
2025-03-13 17:56:57,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6178 secs
2025-03-13 17:56:57,956 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 17:56:57,956 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 17:57:23,783 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8270 secs
2025-03-13 17:57:23,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9269 secs
2025-03-13 17:57:23,816 [INFO]: {
2025-03-13 17:57:23,816 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:23,816 [INFO]: 	index_param: efSearch=328
2025-03-13 17:57:23,816 [INFO]: 	index_path: knn.index
2025-03-13 17:57:23,816 [INFO]: 	size in bytes: 351188050
2025-03-13 17:57:23,816 [INFO]: 	avg_search_speed_ms: 12.722646681598977
2025-03-13 17:57:23,816 [INFO]: 	99p_search_speed_ms: 20.541727158706635
2025-03-13 17:57:23,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:23,816 [INFO]: 	nb vectors: 1785
2025-03-13 17:57:23,816 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:23,816 [INFO]: 	compression ratio: 0.9993087179361598
2025-03-13 17:57:23,816 [INFO]: }
2025-03-13 17:57:23,816 [INFO]: 	>>> Finished "Creating the index" in 56.9315 secs
2025-03-13 17:57:23,816 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9678 secs
2025-03-13 17:57:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 39282 [episode count 9/20]
[retrieval_preprocessing] for episode 76146 [episode count 10/20], we have num_retrieval=np.int64(1784) num_query=np.int64(101)
2025-03-13 17:57:25,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:25,405 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:25
2025-03-13 17:57:25,405 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2170.96it/s]
2025-03-13 17:57:25,432 [INFO]: There are 1784 embeddings of dim 49152
2025-03-13 17:57:25,433 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:57:25,433 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:25
2025-03-13 17:57:25,433 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:25,433 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:57:25,433 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:25,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:25,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:25
2025-03-13 17:57:25,433 [INFO]: 368.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:25,433 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:57:25,433 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:25
2025-03-13 17:57:25,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:25,433 [INFO]: 	Creating the index 03/13/2025, 17:57:25
2025-03-13 17:57:25,433 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:25
2025-03-13 17:57:25,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:57:25,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:25
2025-03-13 17:57:25,434 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:57:25,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.08it/s]100%|██████████| 8/8 [00:01<00:00,  6.12it/s]100%|██████████| 8/8 [00:01<00:00,  6.41it/s]
2025-03-13 17:57:26,687 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:26
2025-03-13 17:58:00,092 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4052 secs
2025-03-13 17:58:00,093 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 17:58:00,093 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-13 17:58:16,291 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1982 secs
2025-03-13 17:58:16,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8582 secs
2025-03-13 17:58:16,292 [INFO]: {
2025-03-13 17:58:16,292 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:16,292 [INFO]: 	index_param: efSearch=203
2025-03-13 17:58:16,292 [INFO]: 	index_path: knn.index
2025-03-13 17:58:16,292 [INFO]: 	size in bytes: 350991310
2025-03-13 17:58:16,292 [INFO]: 	avg_search_speed_ms: 10.375506630799196
2025-03-13 17:58:16,292 [INFO]: 	99p_search_speed_ms: 19.352951969485733
2025-03-13 17:58:16,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:16,292 [INFO]: 	nb vectors: 1784
2025-03-13 17:58:16,292 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:16,292 [INFO]: 	compression ratio: 0.9993087065317942
2025-03-13 17:58:16,293 [INFO]: }
2025-03-13 17:58:16,293 [INFO]: 	>>> Finished "Creating the index" in 50.8594 secs
2025-03-13 17:58:16,293 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8874 secs
2025-03-13 17:58:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 76146 [episode count 10/20]
[retrieval_preprocessing] for episode 15012 [episode count 11/20], we have num_retrieval=np.int64(1662) num_query=np.int64(223)
2025-03-13 17:58:17,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:17,525 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:17
2025-03-13 17:58:17,525 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1105.80it/s]
2025-03-13 17:58:17,553 [INFO]: There are 1662 embeddings of dim 49152
2025-03-13 17:58:17,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:58:17,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:17
2025-03-13 17:58:17,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:17,554 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:58:17,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:17,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:17,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:17
2025-03-13 17:58:17,554 [INFO]: 343.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:17,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:58:17,554 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:17
2025-03-13 17:58:17,554 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:17,554 [INFO]: 	Creating the index 03/13/2025, 17:58:17
2025-03-13 17:58:17,554 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:17
2025-03-13 17:58:17,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:58:17,556 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:17
2025-03-13 17:58:17,556 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:58:17,556 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.13it/s] 71%|███████▏  | 5/7 [00:00<00:00, 24.85it/s]100%|██████████| 7/7 [00:01<00:00,  4.81it/s]
2025-03-13 17:58:19,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:19
2025-03-13 17:58:44,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3569 secs
2025-03-13 17:58:44,371 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 17:58:44,371 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.88it/s]
2025-03-13 17:59:06,826 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4545 secs
2025-03-13 17:59:06,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2713 secs
2025-03-13 17:59:06,827 [INFO]: {
2025-03-13 17:59:06,827 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:06,827 [INFO]: 	index_param: efSearch=281
2025-03-13 17:59:06,827 [INFO]: 	index_path: knn.index
2025-03-13 17:59:06,827 [INFO]: 	size in bytes: 326988430
2025-03-13 17:59:06,827 [INFO]: 	avg_search_speed_ms: 11.561436072056521
2025-03-13 17:59:06,827 [INFO]: 	99p_search_speed_ms: 16.476824637502432
2025-03-13 17:59:06,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:06,827 [INFO]: 	nb vectors: 1662
2025-03-13 17:59:06,827 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:06,827 [INFO]: 	compression ratio: 0.9993090458888714
2025-03-13 17:59:06,827 [INFO]: }
2025-03-13 17:59:06,827 [INFO]: 	>>> Finished "Creating the index" in 49.2730 secs
2025-03-13 17:59:06,827 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3027 secs
2025-03-13 17:59:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 15012 [episode count 11/20]
[retrieval_preprocessing] for episode 60068 [episode count 12/20], we have num_retrieval=np.int64(1717) num_query=np.int64(168)
2025-03-13 17:59:08,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:08,964 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:08
2025-03-13 17:59:08,964 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1667.72it/s]
2025-03-13 17:59:08,994 [INFO]: There are 1717 embeddings of dim 49152
2025-03-13 17:59:08,994 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:59:08,994 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:08
2025-03-13 17:59:08,994 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:08,994 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 17:59:08,994 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:08,994 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:08,994 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:08
2025-03-13 17:59:08,994 [INFO]: 354.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:08,994 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:08,994 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:08
2025-03-13 17:59:08,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:08,994 [INFO]: 	Creating the index 03/13/2025, 17:59:08
2025-03-13 17:59:08,994 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:08
2025-03-13 17:59:08,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:59:08,996 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:08
2025-03-13 17:59:08,996 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:59:08,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.76it/s] 86%|████████▌ | 6/7 [00:00<00:00, 30.82it/s]100%|██████████| 7/7 [00:01<00:00,  4.47it/s]
2025-03-13 17:59:10,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:10
2025-03-13 17:59:38,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8072 secs
2025-03-13 17:59:38,373 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 17:59:38,373 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.43it/s]
2025-03-13 17:59:59,295 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9211 secs
2025-03-13 17:59:59,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3013 secs
2025-03-13 17:59:59,297 [INFO]: {
2025-03-13 17:59:59,297 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:59,297 [INFO]: 	index_param: efSearch=269
2025-03-13 17:59:59,297 [INFO]: 	index_path: knn.index
2025-03-13 17:59:59,297 [INFO]: 	size in bytes: 337809310
2025-03-13 17:59:59,297 [INFO]: 	avg_search_speed_ms: 10.81769368661618
2025-03-13 17:59:59,297 [INFO]: 	99p_search_speed_ms: 15.689366180449722
2025-03-13 17:59:59,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:59,297 [INFO]: 	nb vectors: 1717
2025-03-13 17:59:59,297 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:59,297 [INFO]: 	compression ratio: 0.9993091546233583
2025-03-13 17:59:59,297 [INFO]: }
2025-03-13 17:59:59,297 [INFO]: 	>>> Finished "Creating the index" in 50.3029 secs
2025-03-13 17:59:59,297 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3330 secs
2025-03-13 18:00:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 60068 [episode count 12/20]
[retrieval_preprocessing] for episode 57989 [episode count 13/20], we have num_retrieval=np.int64(1812) num_query=np.int64(73)
2025-03-13 18:00:02,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:02,424 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:02
2025-03-13 18:00:02,424 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.22it/s]
2025-03-13 18:00:02,458 [INFO]: There are 1812 embeddings of dim 49152
2025-03-13 18:00:02,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 18:00:02,458 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:02
2025-03-13 18:00:02,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:02,459 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:00:02,459 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:02,459 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:00:02,459 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:02
2025-03-13 18:00:02,460 [INFO]: 374.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:02,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:00:02,460 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:02
2025-03-13 18:00:02,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:02,461 [INFO]: 	Creating the index 03/13/2025, 18:00:02
2025-03-13 18:00:02,461 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:02
2025-03-13 18:00:02,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:00:02,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:02
2025-03-13 18:00:02,465 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:00:02,465 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.53it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.86it/s]100%|██████████| 8/8 [00:01<00:00,  4.78it/s]
2025-03-13 18:00:04,145 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:04
2025-03-13 18:00:30,172 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0272 secs
2025-03-13 18:00:30,173 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 18:00:30,174 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.51it/s]
2025-03-13 18:00:44,184 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0097 secs
2025-03-13 18:00:44,185 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7208 secs
2025-03-13 18:00:44,185 [INFO]: {
2025-03-13 18:00:44,185 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:44,185 [INFO]: 	index_param: efSearch=153
2025-03-13 18:00:44,185 [INFO]: 	index_path: knn.index
2025-03-13 18:00:44,185 [INFO]: 	size in bytes: 356500090
2025-03-13 18:00:44,186 [INFO]: 	avg_search_speed_ms: 7.906726370068642
2025-03-13 18:00:44,186 [INFO]: 	99p_search_speed_ms: 11.290822159498928
2025-03-13 18:00:44,186 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:44,186 [INFO]: 	nb vectors: 1812
2025-03-13 18:00:44,186 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:44,186 [INFO]: 	compression ratio: 0.999308852909406
2025-03-13 18:00:44,186 [INFO]: }
2025-03-13 18:00:44,186 [INFO]: 	>>> Finished "Creating the index" in 41.7249 secs
2025-03-13 18:00:44,186 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7618 secs
2025-03-13 18:00:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 57989 [episode count 13/20]
[retrieval_preprocessing] for episode 79466 [episode count 14/20], we have num_retrieval=np.int64(1808) num_query=np.int64(77)
2025-03-13 18:00:44,872 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:45,153 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:45
2025-03-13 18:00:45,153 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 18:00:45,182 [INFO]: There are 1808 embeddings of dim 49152
2025-03-13 18:00:45,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:00:45,183 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:45
2025-03-13 18:00:45,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:45,183 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:00:45,183 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:45,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:00:45,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:45
2025-03-13 18:00:45,183 [INFO]: 373.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:45,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:00:45,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:45
2025-03-13 18:00:45,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:45,183 [INFO]: 	Creating the index 03/13/2025, 18:00:45
2025-03-13 18:00:45,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:45
2025-03-13 18:00:45,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:45,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:45
2025-03-13 18:00:45,184 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:00:45,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 16.34it/s] 88%|████████▊ | 7/8 [00:00<00:00, 31.98it/s]100%|██████████| 8/8 [00:01<00:00,  5.24it/s]
2025-03-13 18:00:46,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:46
2025-03-13 18:01:17,281 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5663 secs
2025-03-13 18:01:17,282 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 18:01:17,282 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 18:01:38,376 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0942 secs
2025-03-13 18:01:38,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1931 secs
2025-03-13 18:01:38,378 [INFO]: {
2025-03-13 18:01:38,378 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:38,378 [INFO]: 	index_param: efSearch=273
2025-03-13 18:01:38,378 [INFO]: 	index_path: knn.index
2025-03-13 18:01:38,378 [INFO]: 	size in bytes: 355713130
2025-03-13 18:01:38,378 [INFO]: 	avg_search_speed_ms: 12.319180671712889
2025-03-13 18:01:38,378 [INFO]: 	99p_search_speed_ms: 21.978575082030147
2025-03-13 18:01:38,378 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:38,378 [INFO]: 	nb vectors: 1808
2025-03-13 18:01:38,378 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:38,378 [INFO]: 	compression ratio: 0.9993088081960877
2025-03-13 18:01:38,378 [INFO]: }
2025-03-13 18:01:38,378 [INFO]: 	>>> Finished "Creating the index" in 53.1945 secs
2025-03-13 18:01:38,378 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2249 secs
2025-03-13 18:01:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 79466 [episode count 14/20]
[retrieval_preprocessing] for episode 60311 [episode count 15/20], we have num_retrieval=np.int64(1819) num_query=np.int64(66)
2025-03-13 18:01:39,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:39,608 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:39
2025-03-13 18:01:39,608 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2003.97it/s]
2025-03-13 18:01:39,634 [INFO]: There are 1819 embeddings of dim 49152
2025-03-13 18:01:39,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 18:01:39,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:39
2025-03-13 18:01:39,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:39,636 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:01:39,636 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:39,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:01:39,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:39
2025-03-13 18:01:39,636 [INFO]: 375.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:39,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:01:39,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:39
2025-03-13 18:01:39,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:39,637 [INFO]: 	Creating the index 03/13/2025, 18:01:39
2025-03-13 18:01:39,637 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:39
2025-03-13 18:01:39,640 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:01:39,641 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:39
2025-03-13 18:01:39,641 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:01:39,641 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.57it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.95it/s]100%|██████████| 8/8 [00:01<00:00,  4.87it/s]
2025-03-13 18:01:41,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:41
2025-03-13 18:02:12,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2756 secs
2025-03-13 18:02:12,566 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:02:12,566 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 18:02:31,870 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3038 secs
2025-03-13 18:02:31,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2311 secs
2025-03-13 18:02:31,872 [INFO]: {
2025-03-13 18:02:31,872 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:31,872 [INFO]: 	index_param: efSearch=240
2025-03-13 18:02:31,872 [INFO]: 	index_path: knn.index
2025-03-13 18:02:31,872 [INFO]: 	size in bytes: 357877270
2025-03-13 18:02:31,872 [INFO]: 	avg_search_speed_ms: 9.928484720593206
2025-03-13 18:02:31,872 [INFO]: 	99p_search_speed_ms: 19.008338698185955
2025-03-13 18:02:31,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:31,872 [INFO]: 	nb vectors: 1819
2025-03-13 18:02:31,872 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:31,872 [INFO]: 	compression ratio: 0.9993089306845333
2025-03-13 18:02:31,872 [INFO]: }
2025-03-13 18:02:31,872 [INFO]: 	>>> Finished "Creating the index" in 52.2353 secs
2025-03-13 18:02:31,872 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2643 secs
2025-03-13 18:02:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 60311 [episode count 15/20]
[retrieval_preprocessing] for episode 5018 [episode count 16/20], we have num_retrieval=np.int64(1787) num_query=np.int64(98)
2025-03-13 18:02:32,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:33,118 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:33
2025-03-13 18:02:33,119 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 22.34it/s]
2025-03-13 18:02:33,443 [INFO]: There are 1787 embeddings of dim 49152
2025-03-13 18:02:33,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3243 secs
2025-03-13 18:02:33,443 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:33
2025-03-13 18:02:33,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:33,443 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:02:33,443 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:33,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:02:33,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:33
2025-03-13 18:02:33,444 [INFO]: 368.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:33,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:02:33,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:33
2025-03-13 18:02:33,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:33,444 [INFO]: 	Creating the index 03/13/2025, 18:02:33
2025-03-13 18:02:33,445 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:33
2025-03-13 18:02:33,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:02:33,448 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:33
2025-03-13 18:02:33,448 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:02:33,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.00it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.99it/s]100%|██████████| 8/8 [00:01<00:00,  6.33it/s]
2025-03-13 18:02:35,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:35
2025-03-13 18:03:21,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2161 secs
2025-03-13 18:03:21,393 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 18:03:21,393 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 18:03:36,297 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9034 secs
2025-03-13 18:03:36,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8503 secs
2025-03-13 18:03:36,298 [INFO]: {
2025-03-13 18:03:36,299 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:36,299 [INFO]: 	index_param: efSearch=156
2025-03-13 18:03:36,299 [INFO]: 	index_path: knn.index
2025-03-13 18:03:36,299 [INFO]: 	size in bytes: 351581530
2025-03-13 18:03:36,299 [INFO]: 	avg_search_speed_ms: 8.167644921200216
2025-03-13 18:03:36,299 [INFO]: 	99p_search_speed_ms: 12.208883040584624
2025-03-13 18:03:36,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:36,299 [INFO]: 	nb vectors: 1787
2025-03-13 18:03:36,299 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:36,299 [INFO]: 	compression ratio: 0.9993087407066008
2025-03-13 18:03:36,299 [INFO]: }
2025-03-13 18:03:36,299 [INFO]: 	>>> Finished "Creating the index" in 62.8542 secs
2025-03-13 18:03:36,299 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1801 secs
2025-03-13 18:03:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 5018 [episode count 16/20]
[retrieval_preprocessing] for episode 70378 [episode count 17/20], we have num_retrieval=np.int64(1824) num_query=np.int64(61)
2025-03-13 18:03:37,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:37,439 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:37
2025-03-13 18:03:37,439 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.59it/s]
2025-03-13 18:03:37,467 [INFO]: There are 1824 embeddings of dim 49152
2025-03-13 18:03:37,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:03:37,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:37
2025-03-13 18:03:37,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:37,469 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:03:37,469 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:37,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:03:37,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:37
2025-03-13 18:03:37,469 [INFO]: 376.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:37,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:03:37,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:37
2025-03-13 18:03:37,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:37,470 [INFO]: 	Creating the index 03/13/2025, 18:03:37
2025-03-13 18:03:37,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:37
2025-03-13 18:03:37,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:03:37,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:37
2025-03-13 18:03:37,474 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:03:37,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.64it/s] 88%|████████▊ | 7/8 [00:00<00:00, 34.72it/s]100%|██████████| 8/8 [00:01<00:00,  5.64it/s]
2025-03-13 18:03:38,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:38
2025-03-13 18:04:05,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2814 secs
2025-03-13 18:04:05,180 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:04:05,180 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.72it/s]
2025-03-13 18:04:23,483 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3028 secs
2025-03-13 18:04:23,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0104 secs
2025-03-13 18:04:23,485 [INFO]: {
2025-03-13 18:04:23,485 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:23,485 [INFO]: 	index_param: efSearch=261
2025-03-13 18:04:23,485 [INFO]: 	index_path: knn.index
2025-03-13 18:04:23,485 [INFO]: 	size in bytes: 358860970
2025-03-13 18:04:23,485 [INFO]: 	avg_search_speed_ms: 11.29206529141532
2025-03-13 18:04:23,485 [INFO]: 	99p_search_speed_ms: 15.866752574220298
2025-03-13 18:04:23,485 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:23,485 [INFO]: 	nb vectors: 1824
2025-03-13 18:04:23,485 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:23,485 [INFO]: 	compression ratio: 0.9993089858727183
2025-03-13 18:04:23,485 [INFO]: }
2025-03-13 18:04:23,485 [INFO]: 	>>> Finished "Creating the index" in 46.0145 secs
2025-03-13 18:04:23,485 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0459 secs
2025-03-13 18:04:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 70378 [episode count 17/20]
[retrieval_preprocessing] for episode 57066 [episode count 18/20], we have num_retrieval=np.int64(1825) num_query=np.int64(60)
2025-03-13 18:04:24,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:24,692 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:24
2025-03-13 18:04:24,692 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2192.53it/s]
2025-03-13 18:04:24,718 [INFO]: There are 1825 embeddings of dim 49152
2025-03-13 18:04:24,718 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:04:24,719 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:24
2025-03-13 18:04:24,719 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:24,719 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:04:24,719 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:24,719 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:04:24,719 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:24
2025-03-13 18:04:24,720 [INFO]: 376.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:24,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:04:24,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:24
2025-03-13 18:04:24,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:24,720 [INFO]: 	Creating the index 03/13/2025, 18:04:24
2025-03-13 18:04:24,721 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:24
2025-03-13 18:04:24,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:04:24,724 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:24
2025-03-13 18:04:24,724 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:04:24,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.16it/s] 88%|████████▊ | 7/8 [00:00<00:00, 35.08it/s]100%|██████████| 8/8 [00:01<00:00,  5.98it/s]
2025-03-13 18:04:26,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:26
2025-03-13 18:04:54,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4543 secs
2025-03-13 18:04:54,522 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 18:04:54,522 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.00it/s]
2025-03-13 18:05:16,793 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2708 secs
2025-03-13 18:05:16,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0705 secs
2025-03-13 18:05:16,795 [INFO]: {
2025-03-13 18:05:16,795 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:16,795 [INFO]: 	index_param: efSearch=258
2025-03-13 18:05:16,795 [INFO]: 	index_path: knn.index
2025-03-13 18:05:16,795 [INFO]: 	size in bytes: 359057710
2025-03-13 18:05:16,795 [INFO]: 	avg_search_speed_ms: 10.371100876017092
2025-03-13 18:05:16,795 [INFO]: 	99p_search_speed_ms: 14.080129591748118
2025-03-13 18:05:16,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:16,795 [INFO]: 	nb vectors: 1825
2025-03-13 18:05:16,795 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:16,795 [INFO]: 	compression ratio: 0.9993089968740679
2025-03-13 18:05:16,795 [INFO]: }
2025-03-13 18:05:16,795 [INFO]: 	>>> Finished "Creating the index" in 52.0746 secs
2025-03-13 18:05:16,795 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1034 secs
2025-03-13 18:05:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 57066 [episode count 18/20]
[retrieval_preprocessing] for episode 30529 [episode count 19/20], we have num_retrieval=np.int64(1816) num_query=np.int64(69)
2025-03-13 18:05:17,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:17,994 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:17
2025-03-13 18:05:17,994 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.80it/s]
2025-03-13 18:05:18,024 [INFO]: There are 1816 embeddings of dim 49152
2025-03-13 18:05:18,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:05:18,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:18
2025-03-13 18:05:18,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:18,024 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:05:18,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:18,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:18,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:18
2025-03-13 18:05:18,024 [INFO]: 374.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:18,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:05:18,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:18
2025-03-13 18:05:18,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:18,024 [INFO]: 	Creating the index 03/13/2025, 18:05:18
2025-03-13 18:05:18,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:18
2025-03-13 18:05:18,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:05:18,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:18
2025-03-13 18:05:18,025 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:05:18,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.12it/s] 88%|████████▊ | 7/8 [00:00<00:00, 33.84it/s]100%|██████████| 8/8 [00:01<00:00,  5.93it/s]
2025-03-13 18:05:19,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:19
2025-03-13 18:05:55,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0756 secs
2025-03-13 18:05:55,454 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 18:05:55,454 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-13 18:06:12,390 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9360 secs
2025-03-13 18:06:12,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3658 secs
2025-03-13 18:06:12,391 [INFO]: {
2025-03-13 18:06:12,391 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:12,391 [INFO]: 	index_param: efSearch=230
2025-03-13 18:06:12,391 [INFO]: 	index_path: knn.index
2025-03-13 18:06:12,391 [INFO]: 	size in bytes: 357287050
2025-03-13 18:06:12,391 [INFO]: 	avg_search_speed_ms: 9.941586823745169
2025-03-13 18:06:12,391 [INFO]: 	99p_search_speed_ms: 15.185941464733332
2025-03-13 18:06:12,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:12,391 [INFO]: 	nb vectors: 1816
2025-03-13 18:06:12,391 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:12,391 [INFO]: 	compression ratio: 0.9993088974257534
2025-03-13 18:06:12,391 [INFO]: }
2025-03-13 18:06:12,391 [INFO]: 	>>> Finished "Creating the index" in 54.3670 secs
2025-03-13 18:06:12,391 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3974 secs
2025-03-13 18:06:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 30529 [episode count 19/20]
2025-03-13 18:06:13: [retrieval_preprocessing] finished for 5235850418_close_bottom_drawer_right_cabinet [chosen_id count 7/196]
2025-03-13 18:06:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_open_bottom_drawer_right_file_cabinet [chosen_id count 8/196]
2025-03-13 18:06:14: [retrieval_preprocessing] we have num_total=3702 embedding_dim=49152
[retrieval_preprocessing] for episode 18467 [episode count 0/20], we have num_retrieval=np.int64(3556) num_query=np.int64(146)
2025-03-13 18:06:14,879 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:15,344 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:15
2025-03-13 18:06:15,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.06it/s]
2025-03-13 18:06:15,369 [INFO]: There are 3556 embeddings of dim 49152
2025-03-13 18:06:15,369 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:06:15,369 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:15,369 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:06:15,369 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:15,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:06:15,369 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,369 [INFO]: 733.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:15,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:06:15,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:15
2025-03-13 18:06:15,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:15,369 [INFO]: 	Creating the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,370 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:15
2025-03-13 18:06:15,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:06:15,371 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,371 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:06:15,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.76it/s] 36%|███▌      | 5/14 [00:00<00:00, 23.53it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.03it/s]100%|██████████| 14/14 [00:03<00:00,  4.25it/s]
2025-03-13 18:06:18,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:18
2025-03-13 18:07:09,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.3334 secs
2025-03-13 18:07:09,004 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 18:07:09,004 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.16it/s]
2025-03-13 18:07:28,506 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5016 secs
2025-03-13 18:07:28,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1380 secs
2025-03-13 18:07:28,509 [INFO]: {
2025-03-13 18:07:28,509 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:28,509 [INFO]: 	index_param: efSearch=162
2025-03-13 18:07:28,509 [INFO]: 	index_path: knn.index
2025-03-13 18:07:28,509 [INFO]: 	size in bytes: 699621130
2025-03-13 18:07:28,509 [INFO]: 	avg_search_speed_ms: 8.73752081152621
2025-03-13 18:07:28,509 [INFO]: 	99p_search_speed_ms: 14.364286772906773
2025-03-13 18:07:28,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:28,509 [INFO]: 	nb vectors: 3556
2025-03-13 18:07:28,509 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:28,509 [INFO]: 	compression ratio: 0.9993095091338936
2025-03-13 18:07:28,509 [INFO]: }
2025-03-13 18:07:28,509 [INFO]: 	>>> Finished "Creating the index" in 73.1395 secs
2025-03-13 18:07:28,509 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1651 secs
2025-03-13 18:07:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 18467 [episode count 0/20]
[retrieval_preprocessing] for episode 65602 [episode count 1/20], we have num_retrieval=np.int64(3500) num_query=np.int64(202)
2025-03-13 18:07:30,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:30,570 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:30
2025-03-13 18:07:30,570 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.89it/s]
2025-03-13 18:07:30,599 [INFO]: There are 3500 embeddings of dim 49152
2025-03-13 18:07:30,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:07:30,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:30
2025-03-13 18:07:30,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:30,600 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:07:30,600 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:30,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:30,600 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:30
2025-03-13 18:07:30,600 [INFO]: 722.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:30,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:30,600 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:30
2025-03-13 18:07:30,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:30,600 [INFO]: 	Creating the index 03/13/2025, 18:07:30
2025-03-13 18:07:30,600 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:30
2025-03-13 18:07:30,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:30,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:30
2025-03-13 18:07:30,601 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:07:30,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.79it/s] 50%|█████     | 7/14 [00:00<00:00, 33.64it/s] 86%|████████▌ | 12/14 [00:00<00:00, 37.97it/s]100%|██████████| 14/14 [00:02<00:00,  4.76it/s]
2025-03-13 18:07:33,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:33
2025-03-13 18:08:21,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0396 secs
2025-03-13 18:08:21,795 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 18:08:21,795 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 18:08:51,754 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9595 secs
2025-03-13 18:08:51,757 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.1560 secs
2025-03-13 18:08:51,757 [INFO]: {
2025-03-13 18:08:51,758 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:51,758 [INFO]: 	index_param: efSearch=234
2025-03-13 18:08:51,758 [INFO]: 	index_path: knn.index
2025-03-13 18:08:51,758 [INFO]: 	size in bytes: 688603450
2025-03-13 18:08:51,758 [INFO]: 	avg_search_speed_ms: 10.572743818437559
2025-03-13 18:08:51,758 [INFO]: 	99p_search_speed_ms: 15.336552739609031
2025-03-13 18:08:51,758 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:51,758 [INFO]: 	nb vectors: 3500
2025-03-13 18:08:51,758 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:51,758 [INFO]: 	compression ratio: 0.9993095445571758
2025-03-13 18:08:51,758 [INFO]: }
2025-03-13 18:08:51,758 [INFO]: 	>>> Finished "Creating the index" in 81.1576 secs
2025-03-13 18:08:51,758 [INFO]: >>> Finished "Launching the whole pipeline" in 81.1874 secs
2025-03-13 18:08:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 65602 [episode count 1/20]
[retrieval_preprocessing] for episode 8382 [episode count 2/20], we have num_retrieval=np.int64(3436) num_query=np.int64(266)
2025-03-13 18:08:54,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:54,919 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:54
2025-03-13 18:08:54,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1370.69it/s]
2025-03-13 18:08:54,945 [INFO]: There are 3436 embeddings of dim 49152
2025-03-13 18:08:54,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 18:08:54,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:54
2025-03-13 18:08:54,946 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:54,946 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:08:54,946 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:54,946 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:54,946 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:54
2025-03-13 18:08:54,946 [INFO]: 709.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:54,946 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:54,946 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:54
2025-03-13 18:08:54,946 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:54,946 [INFO]: 	Creating the index 03/13/2025, 18:08:54
2025-03-13 18:08:54,946 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:54
2025-03-13 18:08:54,947 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:08:54,947 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:54
2025-03-13 18:08:54,947 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:08:54,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.55it/s] 50%|█████     | 7/14 [00:00<00:00, 36.09it/s] 86%|████████▌ | 12/14 [00:00<00:00, 42.13it/s]100%|██████████| 14/14 [00:02<00:00,  5.39it/s]
2025-03-13 18:08:57,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:57
2025-03-13 18:09:43,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3701 secs
2025-03-13 18:09:43,921 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:09:43,921 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:10:04,989 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0683 secs
2025-03-13 18:10:04,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0451 secs
2025-03-13 18:10:04,993 [INFO]: {
2025-03-13 18:10:04,993 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:04,993 [INFO]: 	index_param: efSearch=226
2025-03-13 18:10:04,993 [INFO]: 	index_path: knn.index
2025-03-13 18:10:04,993 [INFO]: 	size in bytes: 676011910
2025-03-13 18:10:04,993 [INFO]: 	avg_search_speed_ms: 14.165870853562552
2025-03-13 18:10:04,993 [INFO]: 	99p_search_speed_ms: 26.438227342441692
2025-03-13 18:10:04,993 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:04,993 [INFO]: 	nb vectors: 3436
2025-03-13 18:10:04,993 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:04,993 [INFO]: 	compression ratio: 0.999309447077641
2025-03-13 18:10:04,993 [INFO]: }
2025-03-13 18:10:04,993 [INFO]: 	>>> Finished "Creating the index" in 70.0468 secs
2025-03-13 18:10:04,993 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0743 secs
2025-03-13 18:10:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 8382 [episode count 2/20]
[retrieval_preprocessing] for episode 2144 [episode count 3/20], we have num_retrieval=np.int64(3542) num_query=np.int64(160)
2025-03-13 18:10:08,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:09,000 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:09
2025-03-13 18:10:09,000 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 18:10:09,034 [INFO]: There are 3542 embeddings of dim 49152
2025-03-13 18:10:09,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 18:10:09,035 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:09
2025-03-13 18:10:09,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:09,036 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:10:09,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:09,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:10:09,036 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:09
2025-03-13 18:10:09,036 [INFO]: 731.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:09,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:10:09,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:09
2025-03-13 18:10:09,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:09,037 [INFO]: 	Creating the index 03/13/2025, 18:10:09
2025-03-13 18:10:09,037 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:09
2025-03-13 18:10:09,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:10:09,041 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:09
2025-03-13 18:10:09,041 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:10:09,041 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 16.51it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.73it/s] 71%|███████▏  | 10/14 [00:00<00:00, 33.02it/s]100%|██████████| 14/14 [00:03<00:00,  3.19it/s]100%|██████████| 14/14 [00:03<00:00,  4.48it/s]
2025-03-13 18:10:12,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:12
2025-03-13 18:11:03,028 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8542 secs
2025-03-13 18:11:03,029 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:11:03,029 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-13 18:11:39,529 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5001 secs
2025-03-13 18:11:40,186 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1452 secs
2025-03-13 18:11:40,186 [INFO]: {
2025-03-13 18:11:40,186 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:40,186 [INFO]: 	index_param: efSearch=216
2025-03-13 18:11:40,186 [INFO]: 	index_path: knn.index
2025-03-13 18:11:40,187 [INFO]: 	size in bytes: 696866650
2025-03-13 18:11:40,187 [INFO]: 	avg_search_speed_ms: 9.452028304562043
2025-03-13 18:11:40,187 [INFO]: 	99p_search_speed_ms: 15.480274546425795
2025-03-13 18:11:40,187 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:40,187 [INFO]: 	nb vectors: 3542
2025-03-13 18:11:40,187 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:40,187 [INFO]: 	compression ratio: 0.9993096039249403
2025-03-13 18:11:40,187 [INFO]: }
2025-03-13 18:11:40,187 [INFO]: 	>>> Finished "Creating the index" in 91.1501 secs
2025-03-13 18:11:40,187 [INFO]: >>> Finished "Launching the whole pipeline" in 91.1870 secs
2025-03-13 18:11:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 2144 [episode count 3/20]
[retrieval_preprocessing] for episode 8616 [episode count 4/20], we have num_retrieval=np.int64(3558) num_query=np.int64(144)
2025-03-13 18:11:41,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:42,156 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:42
2025-03-13 18:11:42,156 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1427.12it/s]
2025-03-13 18:11:42,182 [INFO]: There are 3558 embeddings of dim 49152
2025-03-13 18:11:42,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:11:42,183 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:42
2025-03-13 18:11:42,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:42,183 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:11:42,183 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:42,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:42,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:42
2025-03-13 18:11:42,183 [INFO]: 734.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:42,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:11:42,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:42
2025-03-13 18:11:42,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:42,183 [INFO]: 	Creating the index 03/13/2025, 18:11:42
2025-03-13 18:11:42,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:42
2025-03-13 18:11:42,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:11:42,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:42
2025-03-13 18:11:42,184 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:11:42,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.01it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.06it/s] 80%|████████  | 12/15 [00:00<00:00, 40.37it/s]100%|██████████| 15/15 [00:02<00:00,  5.63it/s]
2025-03-13 18:11:44,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:44
2025-03-13 18:12:29,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3616 secs
2025-03-13 18:12:29,215 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 18:12:29,215 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-13 18:12:54,589 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3738 secs
2025-03-13 18:12:54,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4081 secs
2025-03-13 18:12:54,593 [INFO]: {
2025-03-13 18:12:54,593 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:54,593 [INFO]: 	index_param: efSearch=170
2025-03-13 18:12:54,593 [INFO]: 	index_path: knn.index
2025-03-13 18:12:54,593 [INFO]: 	size in bytes: 700014610
2025-03-13 18:12:54,593 [INFO]: 	avg_search_speed_ms: 10.79506625395224
2025-03-13 18:12:54,593 [INFO]: 	99p_search_speed_ms: 17.07456822041422
2025-03-13 18:12:54,593 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:54,593 [INFO]: 	nb vectors: 3558
2025-03-13 18:12:54,593 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:54,593 [INFO]: 	compression ratio: 0.999309520125587
2025-03-13 18:12:54,593 [INFO]: }
2025-03-13 18:12:54,593 [INFO]: 	>>> Finished "Creating the index" in 72.4096 secs
2025-03-13 18:12:54,593 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4370 secs
2025-03-13 18:12:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 8616 [episode count 4/20]
[retrieval_preprocessing] for episode 35338 [episode count 5/20], we have num_retrieval=np.int64(3501) num_query=np.int64(201)
2025-03-13 18:12:56,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:57,616 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:57
2025-03-13 18:12:57,617 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.76it/s]
2025-03-13 18:12:57,652 [INFO]: There are 3501 embeddings of dim 49152
2025-03-13 18:12:57,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 18:12:57,653 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:57
2025-03-13 18:12:57,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:57,653 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:12:57,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:57,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:57,653 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:57
2025-03-13 18:12:57,653 [INFO]: 722.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:57,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:12:57,653 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:57
2025-03-13 18:12:57,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:57,653 [INFO]: 	Creating the index 03/13/2025, 18:12:57
2025-03-13 18:12:57,653 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:57
2025-03-13 18:12:57,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:12:57,654 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:57
2025-03-13 18:12:57,655 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:12:57,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.86it/s] 36%|███▌      | 5/14 [00:00<00:00, 20.71it/s] 64%|██████▍   | 9/14 [00:00<00:00, 27.30it/s]100%|██████████| 14/14 [00:03<00:00,  2.69it/s]100%|██████████| 14/14 [00:03<00:00,  3.54it/s]
2025-03-13 18:13:01,614 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:01
2025-03-13 18:13:43,033 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4192 secs
2025-03-13 18:13:43,034 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:13:43,034 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.53it/s]
2025-03-13 18:14:13,683 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6489 secs
2025-03-13 18:14:13,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0306 secs
2025-03-13 18:14:13,685 [INFO]: {
2025-03-13 18:14:13,685 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:13,685 [INFO]: 	index_param: efSearch=226
2025-03-13 18:14:13,685 [INFO]: 	index_path: knn.index
2025-03-13 18:14:13,685 [INFO]: 	size in bytes: 688800190
2025-03-13 18:14:13,685 [INFO]: 	avg_search_speed_ms: 11.742236464067926
2025-03-13 18:14:13,685 [INFO]: 	99p_search_speed_ms: 15.54135849699378
2025-03-13 18:14:13,685 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:13,685 [INFO]: 	nb vectors: 3501
2025-03-13 18:14:13,686 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:13,686 [INFO]: 	compression ratio: 0.9993095501323831
2025-03-13 18:14:13,686 [INFO]: }
2025-03-13 18:14:13,686 [INFO]: 	>>> Finished "Creating the index" in 76.0324 secs
2025-03-13 18:14:13,686 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0690 secs
2025-03-13 18:14:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 35338 [episode count 5/20]
[retrieval_preprocessing] for episode 4378 [episode count 6/20], we have num_retrieval=np.int64(3524) num_query=np.int64(178)
2025-03-13 18:14:15,787 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:16,460 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:16
2025-03-13 18:14:16,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 18:14:16,486 [INFO]: There are 3524 embeddings of dim 49152
2025-03-13 18:14:16,486 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:14:16,486 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,486 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:16,487 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:14:16,487 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:16,487 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:16,487 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,487 [INFO]: 727.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:16,487 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:16,487 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:16
2025-03-13 18:14:16,487 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:16,487 [INFO]: 	Creating the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,487 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:16
2025-03-13 18:14:16,488 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:14:16,488 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,488 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:14:16,488 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.17it/s] 36%|███▌      | 5/14 [00:00<00:00, 24.92it/s] 64%|██████▍   | 9/14 [00:00<00:00, 29.19it/s] 86%|████████▌ | 12/14 [00:00<00:00, 29.20it/s]100%|██████████| 14/14 [00:03<00:00,  3.52it/s]
2025-03-13 18:14:20,470 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:20
2025-03-13 18:15:09,580 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1098 secs
2025-03-13 18:15:09,581 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:15:09,581 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 18:15:37,077 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4958 secs
2025-03-13 18:15:37,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.5913 secs
2025-03-13 18:15:37,080 [INFO]: {
2025-03-13 18:15:37,080 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:37,080 [INFO]: 	index_param: efSearch=271
2025-03-13 18:15:37,080 [INFO]: 	index_path: knn.index
2025-03-13 18:15:37,080 [INFO]: 	size in bytes: 693325270
2025-03-13 18:15:37,080 [INFO]: 	avg_search_speed_ms: 14.240583843401875
2025-03-13 18:15:37,080 [INFO]: 	99p_search_speed_ms: 26.909884759224955
2025-03-13 18:15:37,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:37,080 [INFO]: 	nb vectors: 3524
2025-03-13 18:15:37,080 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:37,080 [INFO]: 	compression ratio: 0.9993095910091377
2025-03-13 18:15:37,080 [INFO]: }
2025-03-13 18:15:37,080 [INFO]: 	>>> Finished "Creating the index" in 80.5929 secs
2025-03-13 18:15:37,080 [INFO]: >>> Finished "Launching the whole pipeline" in 80.6193 secs
2025-03-13 18:15:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 4378 [episode count 6/20]
[retrieval_preprocessing] for episode 27211 [episode count 7/20], we have num_retrieval=np.int64(3558) num_query=np.int64(144)
2025-03-13 18:15:39,222 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:39,995 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:39
2025-03-13 18:15:39,995 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1456.86it/s]
2025-03-13 18:15:40,026 [INFO]: There are 3558 embeddings of dim 49152
2025-03-13 18:15:40,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 18:15:40,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:40
2025-03-13 18:15:40,027 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:40,027 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:15:40,027 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:40,027 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:15:40,027 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:40
2025-03-13 18:15:40,028 [INFO]: 734.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:40,028 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:15:40,028 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:40
2025-03-13 18:15:40,028 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:40,028 [INFO]: 	Creating the index 03/13/2025, 18:15:40
2025-03-13 18:15:40,029 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:40
2025-03-13 18:15:40,032 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:15:40,032 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:40
2025-03-13 18:15:40,032 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:15:40,033 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.23it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.21it/s] 80%|████████  | 12/15 [00:00<00:00, 38.93it/s]100%|██████████| 15/15 [00:03<00:00,  4.39it/s]
2025-03-13 18:15:43,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:43
2025-03-13 18:16:31,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5870 secs
2025-03-13 18:16:31,042 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:16:31,042 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.20it/s]
2025-03-13 18:17:06,980 [INFO]: 	>>> Finished "Compute fast metrics" in 35.9375 secs
2025-03-13 18:17:06,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.9504 secs
2025-03-13 18:17:06,983 [INFO]: {
2025-03-13 18:17:06,983 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:06,983 [INFO]: 	index_param: efSearch=256
2025-03-13 18:17:06,983 [INFO]: 	index_path: knn.index
2025-03-13 18:17:06,983 [INFO]: 	size in bytes: 700014610
2025-03-13 18:17:06,983 [INFO]: 	avg_search_speed_ms: 11.094642578244226
2025-03-13 18:17:06,983 [INFO]: 	99p_search_speed_ms: 16.852930628228933
2025-03-13 18:17:06,983 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:06,983 [INFO]: 	nb vectors: 3558
2025-03-13 18:17:06,983 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:06,983 [INFO]: 	compression ratio: 0.999309520125587
2025-03-13 18:17:06,983 [INFO]: }
2025-03-13 18:17:06,983 [INFO]: 	>>> Finished "Creating the index" in 86.9544 secs
2025-03-13 18:17:06,983 [INFO]: >>> Finished "Launching the whole pipeline" in 86.9881 secs
2025-03-13 18:17:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 27211 [episode count 7/20]
[retrieval_preprocessing] for episode 23823 [episode count 8/20], we have num_retrieval=np.int64(3499) num_query=np.int64(203)
2025-03-13 18:17:08,773 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:09,869 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:09
2025-03-13 18:17:09,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.85it/s]
2025-03-13 18:17:09,896 [INFO]: There are 3499 embeddings of dim 49152
2025-03-13 18:17:09,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:17:09,896 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:09
2025-03-13 18:17:09,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:09,896 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:17:09,896 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:09,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:09,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:09
2025-03-13 18:17:09,896 [INFO]: 722.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:09,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:17:09,897 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:09
2025-03-13 18:17:09,897 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:09,897 [INFO]: 	Creating the index 03/13/2025, 18:17:09
2025-03-13 18:17:09,897 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:09
2025-03-13 18:17:09,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:17:09,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:09
2025-03-13 18:17:09,898 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:17:09,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.08it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.59it/s] 79%|███████▊  | 11/14 [00:00<00:00, 37.50it/s]100%|██████████| 14/14 [00:03<00:00,  4.55it/s]
2025-03-13 18:17:12,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:12
2025-03-13 18:18:05,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4170 secs
2025-03-13 18:18:05,398 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:18:05,398 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-13 18:18:34,304 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9055 secs
2025-03-13 18:18:34,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.4086 secs
2025-03-13 18:18:34,307 [INFO]: {
2025-03-13 18:18:34,307 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:34,307 [INFO]: 	index_param: efSearch=197
2025-03-13 18:18:34,307 [INFO]: 	index_path: knn.index
2025-03-13 18:18:34,307 [INFO]: 	size in bytes: 688406710
2025-03-13 18:18:34,307 [INFO]: 	avg_search_speed_ms: 8.81699384871798
2025-03-13 18:18:34,307 [INFO]: 	99p_search_speed_ms: 12.053517536260188
2025-03-13 18:18:34,307 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:34,307 [INFO]: 	nb vectors: 3499
2025-03-13 18:18:34,307 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:34,307 [INFO]: 	compression ratio: 0.9993095389787819
2025-03-13 18:18:34,307 [INFO]: }
2025-03-13 18:18:34,307 [INFO]: 	>>> Finished "Creating the index" in 84.4103 secs
2025-03-13 18:18:34,307 [INFO]: >>> Finished "Launching the whole pipeline" in 84.4379 secs
2025-03-13 18:18:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 23823 [episode count 8/20]
[retrieval_preprocessing] for episode 88903 [episode count 9/20], we have num_retrieval=np.int64(3515) num_query=np.int64(187)
2025-03-13 18:18:36,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:36,838 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:36
2025-03-13 18:18:36,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.68it/s]
2025-03-13 18:18:36,870 [INFO]: There are 3515 embeddings of dim 49152
2025-03-13 18:18:36,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 18:18:36,871 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:36
2025-03-13 18:18:36,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:36,872 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:18:36,872 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:36,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:18:36,872 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:36
2025-03-13 18:18:36,872 [INFO]: 725.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:36,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:18:36,873 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:36
2025-03-13 18:18:36,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:36,873 [INFO]: 	Creating the index 03/13/2025, 18:18:36
2025-03-13 18:18:36,873 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:36
2025-03-13 18:18:36,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:18:36,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:36
2025-03-13 18:18:36,876 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:18:36,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.08it/s] 50%|█████     | 7/14 [00:00<00:00, 33.80it/s] 86%|████████▌ | 12/14 [00:00<00:00, 38.97it/s]100%|██████████| 14/14 [00:02<00:00,  4.86it/s]
2025-03-13 18:18:39,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:39
2025-03-13 18:19:29,831 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0647 secs
2025-03-13 18:19:29,831 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 18:19:29,831 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 18:19:58,595 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7633 secs
2025-03-13 18:19:59,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.5498 secs
2025-03-13 18:19:59,426 [INFO]: {
2025-03-13 18:19:59,426 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:59,426 [INFO]: 	index_param: efSearch=198
2025-03-13 18:19:59,426 [INFO]: 	index_path: knn.index
2025-03-13 18:19:59,426 [INFO]: 	size in bytes: 691554610
2025-03-13 18:19:59,427 [INFO]: 	avg_search_speed_ms: 10.098665575920181
2025-03-13 18:19:59,427 [INFO]: 	99p_search_speed_ms: 16.540282955393195
2025-03-13 18:19:59,427 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:59,427 [INFO]: 	nb vectors: 3515
2025-03-13 18:19:59,427 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:59,427 [INFO]: 	compression ratio: 0.9993095411510596
2025-03-13 18:19:59,427 [INFO]: }
2025-03-13 18:19:59,427 [INFO]: 	>>> Finished "Creating the index" in 82.5541 secs
2025-03-13 18:19:59,427 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5890 secs
2025-03-13 18:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 88903 [episode count 9/20]
[retrieval_preprocessing] for episode 45704 [episode count 10/20], we have num_retrieval=np.int64(3526) num_query=np.int64(176)
2025-03-13 18:20:01,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:01,991 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:01
2025-03-13 18:20:01,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1076.29it/s]
2025-03-13 18:20:02,035 [INFO]: There are 3526 embeddings of dim 49152
2025-03-13 18:20:02,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0435 secs
2025-03-13 18:20:02,035 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:02
2025-03-13 18:20:02,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:02,036 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:20:02,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:02,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:20:02,036 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:02
2025-03-13 18:20:02,036 [INFO]: 727.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:02,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:20:02,036 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:02
2025-03-13 18:20:02,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:02,037 [INFO]: 	Creating the index 03/13/2025, 18:20:02
2025-03-13 18:20:02,037 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:02
2025-03-13 18:20:02,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 18:20:02,039 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:02
2025-03-13 18:20:02,039 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:20:02,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.65it/s] 43%|████▎     | 6/14 [00:00<00:00, 26.36it/s] 71%|███████▏  | 10/14 [00:00<00:00, 31.24it/s]100%|██████████| 14/14 [00:02<00:00,  3.59it/s]100%|██████████| 14/14 [00:02<00:00,  4.90it/s]
2025-03-13 18:20:04,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:04
2025-03-13 18:20:52,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0689 secs
2025-03-13 18:20:52,973 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:20:52,974 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 18:21:12,053 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0788 secs
2025-03-13 18:21:12,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0163 secs
2025-03-13 18:21:12,055 [INFO]: {
2025-03-13 18:21:12,056 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:12,056 [INFO]: 	index_param: efSearch=221
2025-03-13 18:21:12,056 [INFO]: 	index_path: knn.index
2025-03-13 18:21:12,056 [INFO]: 	size in bytes: 693718750
2025-03-13 18:21:12,056 [INFO]: 	avg_search_speed_ms: 10.905363178540798
2025-03-13 18:21:12,056 [INFO]: 	99p_search_speed_ms: 17.402937468141317
2025-03-13 18:21:12,056 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:12,056 [INFO]: 	nb vectors: 3526
2025-03-13 18:21:12,056 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:12,056 [INFO]: 	compression ratio: 0.9993096020541465
2025-03-13 18:21:12,056 [INFO]: }
2025-03-13 18:21:12,056 [INFO]: 	>>> Finished "Creating the index" in 70.0191 secs
2025-03-13 18:21:12,056 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0642 secs
2025-03-13 18:21:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 45704 [episode count 10/20]
[retrieval_preprocessing] for episode 47790 [episode count 11/20], we have num_retrieval=np.int64(3503) num_query=np.int64(199)
2025-03-13 18:21:13,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:14,746 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:14
2025-03-13 18:21:14,746 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1688.53it/s]
2025-03-13 18:21:14,775 [INFO]: There are 3503 embeddings of dim 49152
2025-03-13 18:21:14,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 18:21:14,775 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:14
2025-03-13 18:21:14,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:14,776 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:21:14,776 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:14,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:14,776 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:14
2025-03-13 18:21:14,776 [INFO]: 722.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:14,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:21:14,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:14
2025-03-13 18:21:14,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:14,776 [INFO]: 	Creating the index 03/13/2025, 18:21:14
2025-03-13 18:21:14,776 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:14
2025-03-13 18:21:14,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:21:14,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:14
2025-03-13 18:21:14,777 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:21:14,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.16it/s] 50%|█████     | 7/14 [00:00<00:00, 32.61it/s] 93%|█████████▎| 13/14 [00:00<00:00, 40.90it/s]100%|██████████| 14/14 [00:02<00:00,  5.04it/s]
2025-03-13 18:21:17,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:17
2025-03-13 18:21:55,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5932 secs
2025-03-13 18:21:55,155 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 18:21:55,155 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.27it/s]
2025-03-13 18:22:27,164 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0094 secs
2025-03-13 18:22:27,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3893 secs
2025-03-13 18:22:27,167 [INFO]: {
2025-03-13 18:22:27,167 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:27,167 [INFO]: 	index_param: efSearch=255
2025-03-13 18:22:27,167 [INFO]: 	index_path: knn.index
2025-03-13 18:22:27,167 [INFO]: 	size in bytes: 689193730
2025-03-13 18:22:27,167 [INFO]: 	avg_search_speed_ms: 11.393334138194408
2025-03-13 18:22:27,167 [INFO]: 	99p_search_speed_ms: 17.564943488687287
2025-03-13 18:22:27,167 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:27,167 [INFO]: 	nb vectors: 3503
2025-03-13 18:22:27,167 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:27,167 [INFO]: 	compression ratio: 0.999309474275107
2025-03-13 18:22:27,167 [INFO]: }
2025-03-13 18:22:27,167 [INFO]: 	>>> Finished "Creating the index" in 72.3909 secs
2025-03-13 18:22:27,167 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4206 secs
2025-03-13 18:22:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 47790 [episode count 11/20]
[retrieval_preprocessing] for episode 15056 [episode count 12/20], we have num_retrieval=np.int64(3533) num_query=np.int64(169)
2025-03-13 18:22:29,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:30,631 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:30
2025-03-13 18:22:30,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.43it/s]
2025-03-13 18:22:31,066 [INFO]: There are 3533 embeddings of dim 49152
2025-03-13 18:22:31,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4350 secs
2025-03-13 18:22:31,067 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:31
2025-03-13 18:22:31,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:31,067 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:22:31,067 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:31,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:22:31,067 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:31
2025-03-13 18:22:31,067 [INFO]: 729.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:31,068 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:22:31,068 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:31
2025-03-13 18:22:31,068 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:31,068 [INFO]: 	Creating the index 03/13/2025, 18:22:31
2025-03-13 18:22:31,068 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:31
2025-03-13 18:22:31,071 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:22:31,071 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:31
2025-03-13 18:22:31,071 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:22:31,071 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.05it/s] 57%|█████▋    | 8/14 [00:00<00:00, 36.96it/s]100%|██████████| 14/14 [00:02<00:00,  3.87it/s]100%|██████████| 14/14 [00:02<00:00,  4.69it/s]
2025-03-13 18:22:34,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:34
2025-03-13 18:23:19,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3849 secs
2025-03-13 18:23:19,450 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 18:23:19,450 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.23it/s]
2025-03-13 18:23:40,080 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6302 secs
2025-03-13 18:23:40,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0118 secs
2025-03-13 18:23:40,083 [INFO]: {
2025-03-13 18:23:40,083 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:40,083 [INFO]: 	index_param: efSearch=159
2025-03-13 18:23:40,083 [INFO]: 	index_path: knn.index
2025-03-13 18:23:40,083 [INFO]: 	size in bytes: 695095990
2025-03-13 18:23:40,083 [INFO]: 	avg_search_speed_ms: 8.69825446370827
2025-03-13 18:23:40,083 [INFO]: 	99p_search_speed_ms: 13.206667590420693
2025-03-13 18:23:40,083 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:40,083 [INFO]: 	nb vectors: 3533
2025-03-13 18:23:40,083 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:40,083 [INFO]: 	compression ratio: 0.9993095543537807
2025-03-13 18:23:40,083 [INFO]: }
2025-03-13 18:23:40,083 [INFO]: 	>>> Finished "Creating the index" in 69.0153 secs
2025-03-13 18:23:40,083 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4518 secs
2025-03-13 18:23:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 15056 [episode count 12/20]
[retrieval_preprocessing] for episode 21271 [episode count 13/20], we have num_retrieval=np.int64(3551) num_query=np.int64(151)
2025-03-13 18:23:41,631 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:42,416 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:42
2025-03-13 18:23:42,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1912.59it/s]
2025-03-13 18:23:42,444 [INFO]: There are 3551 embeddings of dim 49152
2025-03-13 18:23:42,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:23:42,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:42
2025-03-13 18:23:42,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:42,444 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:23:42,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:42,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:23:42,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:42
2025-03-13 18:23:42,445 [INFO]: 732.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:42,445 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:23:42,445 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:42
2025-03-13 18:23:42,445 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:42,445 [INFO]: 	Creating the index 03/13/2025, 18:23:42
2025-03-13 18:23:42,445 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:42
2025-03-13 18:23:42,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:23:42,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:42
2025-03-13 18:23:42,446 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:23:42,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.50it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.77it/s] 86%|████████▌ | 12/14 [00:00<00:00, 39.21it/s]100%|██████████| 14/14 [00:03<00:00,  4.58it/s]
2025-03-13 18:23:45,509 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:45
2025-03-13 18:24:34,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9676 secs
2025-03-13 18:24:34,477 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:24:34,477 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.73it/s]
2025-03-13 18:24:57,677 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2000 secs
2025-03-13 18:24:57,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2339 secs
2025-03-13 18:24:57,680 [INFO]: {
2025-03-13 18:24:57,680 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:57,680 [INFO]: 	index_param: efSearch=205
2025-03-13 18:24:57,680 [INFO]: 	index_path: knn.index
2025-03-13 18:24:57,680 [INFO]: 	size in bytes: 698637430
2025-03-13 18:24:57,680 [INFO]: 	avg_search_speed_ms: 10.494711725305129
2025-03-13 18:24:57,680 [INFO]: 	99p_search_speed_ms: 16.394887901842594
2025-03-13 18:24:57,680 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:57,680 [INFO]: 	nb vectors: 3551
2025-03-13 18:24:57,680 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:57,680 [INFO]: 	compression ratio: 0.9993094816004919
2025-03-13 18:24:57,680 [INFO]: }
2025-03-13 18:24:57,680 [INFO]: 	>>> Finished "Creating the index" in 75.2355 secs
2025-03-13 18:24:57,680 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2641 secs
2025-03-13 18:24:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 21271 [episode count 13/20]
[retrieval_preprocessing] for episode 87563 [episode count 14/20], we have num_retrieval=np.int64(3538) num_query=np.int64(164)
2025-03-13 18:24:59,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:00,274 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:00
2025-03-13 18:25:00,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 18:25:00,301 [INFO]: There are 3538 embeddings of dim 49152
2025-03-13 18:25:00,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 18:25:00,301 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:00
2025-03-13 18:25:00,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:00,301 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:25:00,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:00,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:25:00,301 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:00
2025-03-13 18:25:00,302 [INFO]: 730.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:00,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:25:00,302 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:00
2025-03-13 18:25:00,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:00,302 [INFO]: 	Creating the index 03/13/2025, 18:25:00
2025-03-13 18:25:00,302 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:00
2025-03-13 18:25:00,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:25:00,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:00
2025-03-13 18:25:00,303 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:25:00,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.52it/s] 43%|████▎     | 6/14 [00:00<00:00, 27.41it/s] 71%|███████▏  | 10/14 [00:00<00:00, 32.40it/s]100%|██████████| 14/14 [00:02<00:00,  3.40it/s]100%|██████████| 14/14 [00:02<00:00,  4.68it/s]
2025-03-13 18:25:03,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:03
2025-03-13 18:25:46,890 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5881 secs
2025-03-13 18:25:46,891 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 18:25:46,891 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 18:26:18,601 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7096 secs
2025-03-13 18:26:18,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3012 secs
2025-03-13 18:26:18,605 [INFO]: {
2025-03-13 18:26:18,605 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:18,605 [INFO]: 	index_param: efSearch=269
2025-03-13 18:26:18,605 [INFO]: 	index_path: knn.index
2025-03-13 18:26:18,605 [INFO]: 	size in bytes: 696079690
2025-03-13 18:26:18,605 [INFO]: 	avg_search_speed_ms: 11.245083209294616
2025-03-13 18:26:18,605 [INFO]: 	99p_search_speed_ms: 16.894202772527933
2025-03-13 18:26:18,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:18,605 [INFO]: 	nb vectors: 3538
2025-03-13 18:26:18,605 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:18,605 [INFO]: 	compression ratio: 0.999309581924449
2025-03-13 18:26:18,605 [INFO]: }
2025-03-13 18:26:18,605 [INFO]: 	>>> Finished "Creating the index" in 78.3036 secs
2025-03-13 18:26:18,605 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3314 secs
2025-03-13 18:26:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 87563 [episode count 14/20]
[retrieval_preprocessing] for episode 17986 [episode count 15/20], we have num_retrieval=np.int64(3440) num_query=np.int64(262)
2025-03-13 18:26:25,350 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:25,882 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:25
2025-03-13 18:26:25,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.41it/s]
2025-03-13 18:26:25,913 [INFO]: There are 3440 embeddings of dim 49152
2025-03-13 18:26:25,914 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 18:26:25,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:25
2025-03-13 18:26:25,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:25,914 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:26:25,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:25,914 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:25,914 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:25
2025-03-13 18:26:25,914 [INFO]: 709.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:25,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:26:25,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:25
2025-03-13 18:26:25,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:25,914 [INFO]: 	Creating the index 03/13/2025, 18:26:25
2025-03-13 18:26:25,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:25
2025-03-13 18:26:25,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:26:25,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:25
2025-03-13 18:26:25,916 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:26:25,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.87it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.41it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.29it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.01it/s] 43%|████▎     | 6/14 [00:00<00:00, 10.63it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.28it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.67it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.23it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.87it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.63it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.50it/s]100%|██████████| 14/14 [00:04<00:00,  1.01s/it]100%|██████████| 14/14 [00:04<00:00,  2.91it/s]
2025-03-13 18:26:30,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:30
2025-03-13 18:27:16,352 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6146 secs
2025-03-13 18:27:16,352 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:27:16,352 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-13 18:27:35,906 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5531 secs
2025-03-13 18:27:35,909 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9931 secs
2025-03-13 18:27:35,909 [INFO]: {
2025-03-13 18:27:35,909 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:35,909 [INFO]: 	index_param: efSearch=203
2025-03-13 18:27:35,909 [INFO]: 	index_path: knn.index
2025-03-13 18:27:35,909 [INFO]: 	size in bytes: 676798930
2025-03-13 18:27:35,909 [INFO]: 	avg_search_speed_ms: 9.469117596877782
2025-03-13 18:27:35,909 [INFO]: 	99p_search_speed_ms: 14.62136955233291
2025-03-13 18:27:35,909 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:35,909 [INFO]: 	nb vectors: 3440
2025-03-13 18:27:35,909 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:35,909 [INFO]: 	compression ratio: 0.9993093812958599
2025-03-13 18:27:35,909 [INFO]: }
2025-03-13 18:27:35,909 [INFO]: 	>>> Finished "Creating the index" in 69.9950 secs
2025-03-13 18:27:35,909 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0268 secs
2025-03-13 18:27:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 17986 [episode count 15/20]
[retrieval_preprocessing] for episode 63046 [episode count 16/20], we have num_retrieval=np.int64(3471) num_query=np.int64(231)
2025-03-13 18:27:39,465 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:39,981 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:39
2025-03-13 18:27:39,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.49it/s]
2025-03-13 18:27:40,012 [INFO]: There are 3471 embeddings of dim 49152
2025-03-13 18:27:40,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 18:27:40,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:40
2025-03-13 18:27:40,013 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:40,013 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:27:40,013 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:40,013 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:27:40,013 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:40
2025-03-13 18:27:40,013 [INFO]: 716.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:40,013 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:27:40,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:40
2025-03-13 18:27:40,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:40,014 [INFO]: 	Creating the index 03/13/2025, 18:27:40
2025-03-13 18:27:40,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:40
2025-03-13 18:27:40,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:27:40,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:40
2025-03-13 18:27:40,018 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:27:40,018 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.54it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.32it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.20it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.72it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.89it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.83it/s] 50%|█████     | 7/14 [00:00<00:00,  8.65it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.57it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.48it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.34it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.22it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.04it/s]100%|██████████| 14/14 [00:04<00:00,  1.23it/s]100%|██████████| 14/14 [00:04<00:00,  3.15it/s]
2025-03-13 18:27:44,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:44
2025-03-13 18:28:31,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4425 secs
2025-03-13 18:28:31,914 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:28:31,914 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-13 18:29:04,091 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1769 secs
2025-03-13 18:29:04,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.0764 secs
2025-03-13 18:29:04,094 [INFO]: {
2025-03-13 18:29:04,094 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:04,094 [INFO]: 	index_param: efSearch=231
2025-03-13 18:29:04,094 [INFO]: 	index_path: knn.index
2025-03-13 18:29:04,094 [INFO]: 	size in bytes: 682897930
2025-03-13 18:29:04,094 [INFO]: 	avg_search_speed_ms: 10.212949299956534
2025-03-13 18:29:04,094 [INFO]: 	99p_search_speed_ms: 20.315175671130426
2025-03-13 18:29:04,094 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:04,094 [INFO]: 	nb vectors: 3471
2025-03-13 18:29:04,094 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:04,094 [INFO]: 	compression ratio: 0.9993094692789595
2025-03-13 18:29:04,094 [INFO]: }
2025-03-13 18:29:04,094 [INFO]: 	>>> Finished "Creating the index" in 84.0803 secs
2025-03-13 18:29:04,094 [INFO]: >>> Finished "Launching the whole pipeline" in 84.1127 secs
2025-03-13 18:29:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 63046 [episode count 16/20]
[retrieval_preprocessing] for episode 42567 [episode count 17/20], we have num_retrieval=np.int64(3538) num_query=np.int64(164)
2025-03-13 18:29:07,383 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:07,854 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:07
2025-03-13 18:29:07,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.58it/s]
2025-03-13 18:29:07,879 [INFO]: There are 3538 embeddings of dim 49152
2025-03-13 18:29:07,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:29:07,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:07
2025-03-13 18:29:07,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:07,879 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:29:07,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:07,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:07,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:07
2025-03-13 18:29:07,880 [INFO]: 730.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:07,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:29:07,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:07
2025-03-13 18:29:07,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:07,880 [INFO]: 	Creating the index 03/13/2025, 18:29:07
2025-03-13 18:29:07,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:07
2025-03-13 18:29:07,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:29:07,881 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:07
2025-03-13 18:29:07,881 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:29:07,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.64it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.34it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.80it/s] 50%|█████     | 7/14 [00:00<00:00, 11.39it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.53it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.18it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.17it/s]100%|██████████| 14/14 [00:03<00:00,  3.71it/s]
2025-03-13 18:29:11,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:11
2025-03-13 18:29:52,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1755 secs
2025-03-13 18:29:52,839 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 18:29:52,839 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 18:30:12,604 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7645 secs
2025-03-13 18:30:12,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0832 secs
2025-03-13 18:30:12,964 [INFO]: {
2025-03-13 18:30:12,964 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:12,965 [INFO]: 	index_param: efSearch=241
2025-03-13 18:30:12,965 [INFO]: 	index_path: knn.index
2025-03-13 18:30:12,965 [INFO]: 	size in bytes: 696079690
2025-03-13 18:30:12,965 [INFO]: 	avg_search_speed_ms: 12.232655181986688
2025-03-13 18:30:12,965 [INFO]: 	99p_search_speed_ms: 19.02989029884339
2025-03-13 18:30:12,965 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:12,965 [INFO]: 	nb vectors: 3538
2025-03-13 18:30:12,965 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:12,965 [INFO]: 	compression ratio: 0.999309581924449
2025-03-13 18:30:12,965 [INFO]: }
2025-03-13 18:30:12,965 [INFO]: 	>>> Finished "Creating the index" in 65.0853 secs
2025-03-13 18:30:12,965 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1108 secs
2025-03-13 18:30:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 42567 [episode count 17/20]
[retrieval_preprocessing] for episode 38888 [episode count 18/20], we have num_retrieval=np.int64(3573) num_query=np.int64(129)
2025-03-13 18:30:16,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:17,546 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:17
2025-03-13 18:30:17,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2195.97it/s]
2025-03-13 18:30:17,570 [INFO]: There are 3573 embeddings of dim 49152
2025-03-13 18:30:17,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 18:30:17,570 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:17
2025-03-13 18:30:17,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:17,570 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:30:17,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:17,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:30:17,571 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:17
2025-03-13 18:30:17,571 [INFO]: 737.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:17,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:30:17,571 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:17
2025-03-13 18:30:17,571 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:17,571 [INFO]: 	Creating the index 03/13/2025, 18:30:17
2025-03-13 18:30:17,571 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:17
2025-03-13 18:30:17,572 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:30:17,572 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:17
2025-03-13 18:30:17,572 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:30:17,572 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.19it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.54it/s] 20%|██        | 3/15 [00:00<00:01,  7.10it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.52it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.71it/s] 40%|████      | 6/15 [00:00<00:01,  7.77it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.01it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.54it/s] 60%|██████    | 9/15 [00:01<00:00,  8.87it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.12it/s] 80%|████████  | 12/15 [00:01<00:00,  8.73it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.43it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.26it/s]100%|██████████| 15/15 [00:04<00:00,  1.25it/s]100%|██████████| 15/15 [00:04<00:00,  3.52it/s]
2025-03-13 18:30:21,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:21
2025-03-13 18:31:08,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4147 secs
2025-03-13 18:31:08,414 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 18:31:08,414 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 18:31:36,330 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9155 secs
2025-03-13 18:31:36,332 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7603 secs
2025-03-13 18:31:36,333 [INFO]: {
2025-03-13 18:31:36,333 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:36,333 [INFO]: 	index_param: efSearch=270
2025-03-13 18:31:36,333 [INFO]: 	index_path: knn.index
2025-03-13 18:31:36,333 [INFO]: 	size in bytes: 702965710
2025-03-13 18:31:36,333 [INFO]: 	avg_search_speed_ms: 12.393306060538361
2025-03-13 18:31:36,333 [INFO]: 	99p_search_speed_ms: 20.9533822955563
2025-03-13 18:31:36,333 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:36,333 [INFO]: 	nb vectors: 3573
2025-03-13 18:31:36,333 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:36,333 [INFO]: 	compression ratio: 0.9993096021710647
2025-03-13 18:31:36,333 [INFO]: }
2025-03-13 18:31:36,333 [INFO]: 	>>> Finished "Creating the index" in 78.7622 secs
2025-03-13 18:31:36,333 [INFO]: >>> Finished "Launching the whole pipeline" in 78.7875 secs
2025-03-13 18:31:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 38888 [episode count 18/20]
[retrieval_preprocessing] for episode 44807 [episode count 19/20], we have num_retrieval=np.int64(3476) num_query=np.int64(226)
2025-03-13 18:31:38,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:39,764 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:39
2025-03-13 18:31:39,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1563.87it/s]
2025-03-13 18:31:39,790 [INFO]: There are 3476 embeddings of dim 49152
2025-03-13 18:31:39,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:31:39,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:39
2025-03-13 18:31:39,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:39,790 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:31:39,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:39,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:31:39,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:39
2025-03-13 18:31:39,790 [INFO]: 717.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:39,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:31:39,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:39
2025-03-13 18:31:39,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:39,790 [INFO]: 	Creating the index 03/13/2025, 18:31:39
2025-03-13 18:31:39,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:39
2025-03-13 18:31:39,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:31:39,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:39
2025-03-13 18:31:39,792 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:31:39,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.70it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.00it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.46it/s] 50%|█████     | 7/14 [00:00<00:00, 11.36it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.40it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.96it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.94it/s]100%|██████████| 14/14 [00:03<00:00,  3.77it/s]
2025-03-13 18:31:43,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:43
2025-03-13 18:32:22,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5202 secs
2025-03-13 18:32:22,036 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:32:22,036 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 18:32:52,453 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4169 secs
2025-03-13 18:32:52,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6645 secs
2025-03-13 18:32:52,456 [INFO]: {
2025-03-13 18:32:52,456 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:52,456 [INFO]: 	index_param: efSearch=261
2025-03-13 18:32:52,456 [INFO]: 	index_path: knn.index
2025-03-13 18:32:52,456 [INFO]: 	size in bytes: 683881690
2025-03-13 18:32:52,456 [INFO]: 	avg_search_speed_ms: 11.18456008578432
2025-03-13 18:32:52,456 [INFO]: 	99p_search_speed_ms: 15.557028132025142
2025-03-13 18:32:52,456 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:52,456 [INFO]: 	nb vectors: 3476
2025-03-13 18:32:52,456 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:52,456 [INFO]: 	compression ratio: 0.9993094097898717
2025-03-13 18:32:52,457 [INFO]: }
2025-03-13 18:32:52,457 [INFO]: 	>>> Finished "Creating the index" in 72.6661 secs
2025-03-13 18:32:52,457 [INFO]: >>> Finished "Launching the whole pipeline" in 72.6924 secs
2025-03-13 18:32:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 44807 [episode count 19/20]
2025-03-13 18:32:55: [retrieval_preprocessing] finished for 5235850418_open_bottom_drawer_right_file_cabinet [chosen_id count 8/196]
2025-03-13 18:32:57: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_bottom_drawer_generic_cabinet [chosen_id count 9/196]
2025-03-13 18:32:57: [retrieval_preprocessing] we have num_total=2079 embedding_dim=49152
[retrieval_preprocessing] for episode 59403 [episode count 0/20], we have num_retrieval=np.int64(2011) num_query=np.int64(68)
2025-03-13 18:32:58,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:58,729 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:58
2025-03-13 18:32:58,729 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.07it/s]
2025-03-13 18:32:58,756 [INFO]: There are 2011 embeddings of dim 49152
2025-03-13 18:32:58,757 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:32:58,757 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:58
2025-03-13 18:32:58,757 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:58,758 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:32:58,758 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:58,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:32:58,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:58
2025-03-13 18:32:58,758 [INFO]: 415.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:58,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:32:58,759 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:58
2025-03-13 18:32:58,759 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:58,759 [INFO]: 	Creating the index 03/13/2025, 18:32:58
2025-03-13 18:32:58,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:58
2025-03-13 18:32:58,761 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:32:58,761 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:58
2025-03-13 18:32:58,761 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:32:58,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.73it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.61it/s] 50%|█████     | 4/8 [00:00<00:00,  8.91it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.09it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.28it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.40it/s]100%|██████████| 8/8 [00:02<00:00,  1.71it/s]100%|██████████| 8/8 [00:02<00:00,  3.24it/s]
2025-03-13 18:33:01,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:01
2025-03-13 18:33:31,286 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0441 secs
2025-03-13 18:33:31,287 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 18:33:31,287 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 18:33:55,277 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9902 secs
2025-03-13 18:33:55,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5177 secs
2025-03-13 18:33:55,279 [INFO]: {
2025-03-13 18:33:55,279 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:55,279 [INFO]: 	index_param: efSearch=272
2025-03-13 18:33:55,279 [INFO]: 	index_path: knn.index
2025-03-13 18:33:55,279 [INFO]: 	size in bytes: 395652130
2025-03-13 18:33:55,279 [INFO]: 	avg_search_speed_ms: 11.016501265061027
2025-03-13 18:33:55,279 [INFO]: 	99p_search_speed_ms: 17.325699739158136
2025-03-13 18:33:55,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:55,279 [INFO]: 	nb vectors: 2011
2025-03-13 18:33:55,279 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:55,279 [INFO]: 	compression ratio: 0.9993088827804364
2025-03-13 18:33:55,279 [INFO]: }
2025-03-13 18:33:55,279 [INFO]: 	>>> Finished "Creating the index" in 56.5199 secs
2025-03-13 18:33:55,279 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5500 secs
2025-03-13 18:33:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 59403 [episode count 0/20]
[retrieval_preprocessing] for episode 49294 [episode count 1/20], we have num_retrieval=np.int64(2020) num_query=np.int64(59)
2025-03-13 18:33:56,784 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:57,204 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:57
2025-03-13 18:33:57,204 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1750.54it/s]
2025-03-13 18:33:57,228 [INFO]: There are 2020 embeddings of dim 49152
2025-03-13 18:33:57,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:33:57,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:57
2025-03-13 18:33:57,229 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:57,229 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:33:57,229 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:57,229 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:33:57,229 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:57
2025-03-13 18:33:57,229 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:57,230 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:33:57,230 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:57
2025-03-13 18:33:57,230 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:57,230 [INFO]: 	Creating the index 03/13/2025, 18:33:57
2025-03-13 18:33:57,230 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:57
2025-03-13 18:33:57,233 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:33:57,234 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:57
2025-03-13 18:33:57,234 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:33:57,234 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.52it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.87it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.45it/s] 50%|█████     | 4/8 [00:00<00:00,  7.89it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.05it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.20it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.25it/s]100%|██████████| 8/8 [00:02<00:00,  1.71it/s]100%|██████████| 8/8 [00:02<00:00,  3.23it/s]
2025-03-13 18:33:59,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:59
2025-03-13 18:34:30,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1174 secs
2025-03-13 18:34:30,842 [INFO]: The best hyperparameters are: efSearch=285
2025-03-13 18:34:30,842 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 18:34:49,134 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2919 secs
2025-03-13 18:34:49,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9026 secs
2025-03-13 18:34:49,137 [INFO]: {
2025-03-13 18:34:49,137 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:49,137 [INFO]: 	index_param: efSearch=285
2025-03-13 18:34:49,137 [INFO]: 	index_path: knn.index
2025-03-13 18:34:49,137 [INFO]: 	size in bytes: 397422850
2025-03-13 18:34:49,137 [INFO]: 	avg_search_speed_ms: 13.077516618848236
2025-03-13 18:34:49,137 [INFO]: 	99p_search_speed_ms: 22.841849699616464
2025-03-13 18:34:49,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:49,137 [INFO]: 	nb vectors: 2020
2025-03-13 18:34:49,137 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:49,137 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-13 18:34:49,137 [INFO]: }
2025-03-13 18:34:49,137 [INFO]: 	>>> Finished "Creating the index" in 51.9067 secs
2025-03-13 18:34:49,137 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9328 secs
2025-03-13 18:34:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 49294 [episode count 1/20]
[retrieval_preprocessing] for episode 61595 [episode count 2/20], we have num_retrieval=np.int64(1967) num_query=np.int64(112)
2025-03-13 18:34:50,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:51,056 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:51
2025-03-13 18:34:51,056 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1270.62it/s]
2025-03-13 18:34:51,082 [INFO]: There are 1967 embeddings of dim 49152
2025-03-13 18:34:51,082 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 18:34:51,083 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:51
2025-03-13 18:34:51,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:51,083 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:34:51,083 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:51,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:34:51,083 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:51
2025-03-13 18:34:51,083 [INFO]: 405.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:51,083 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:51,083 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:51
2025-03-13 18:34:51,083 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:51,083 [INFO]: 	Creating the index 03/13/2025, 18:34:51
2025-03-13 18:34:51,084 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:51
2025-03-13 18:34:51,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:34:51,085 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:51
2025-03-13 18:34:51,085 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:34:51,086 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.77it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.32it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.91it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.72it/s]100%|██████████| 8/8 [00:02<00:00,  3.81it/s]
2025-03-13 18:34:53,193 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:53
2025-03-13 18:35:28,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3468 secs
2025-03-13 18:35:28,541 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:35:28,541 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 18:35:48,616 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0755 secs
2025-03-13 18:35:48,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5349 secs
2025-03-13 18:35:48,620 [INFO]: {
2025-03-13 18:35:48,620 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:48,620 [INFO]: 	index_param: efSearch=222
2025-03-13 18:35:48,620 [INFO]: 	index_path: knn.index
2025-03-13 18:35:48,620 [INFO]: 	size in bytes: 386995450
2025-03-13 18:35:48,620 [INFO]: 	avg_search_speed_ms: 8.839841451163212
2025-03-13 18:35:48,621 [INFO]: 	99p_search_speed_ms: 13.086142390966419
2025-03-13 18:35:48,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:48,621 [INFO]: 	nb vectors: 1967
2025-03-13 18:35:48,621 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:48,621 [INFO]: 	compression ratio: 0.9993087412268026
2025-03-13 18:35:48,621 [INFO]: }
2025-03-13 18:35:48,621 [INFO]: 	>>> Finished "Creating the index" in 57.5371 secs
2025-03-13 18:35:48,621 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5642 secs
2025-03-13 18:35:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 61595 [episode count 2/20]
[retrieval_preprocessing] for episode 28961 [episode count 3/20], we have num_retrieval=np.int64(2014) num_query=np.int64(65)
2025-03-13 18:35:51,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:51,352 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:51
2025-03-13 18:35:51,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1958.13it/s]
2025-03-13 18:35:51,375 [INFO]: There are 2014 embeddings of dim 49152
2025-03-13 18:35:51,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:35:51,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:51
2025-03-13 18:35:51,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:51,376 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:35:51,376 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:51,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:35:51,376 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:51
2025-03-13 18:35:51,376 [INFO]: 415.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:51,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:35:51,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:51
2025-03-13 18:35:51,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:51,376 [INFO]: 	Creating the index 03/13/2025, 18:35:51
2025-03-13 18:35:51,376 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:51
2025-03-13 18:35:51,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:35:51,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:51
2025-03-13 18:35:51,377 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:35:51,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.37it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.69it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.26it/s] 50%|█████     | 4/8 [00:00<00:00,  7.51it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.68it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.80it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.09it/s]100%|██████████| 8/8 [00:02<00:00,  1.84it/s]100%|██████████| 8/8 [00:02<00:00,  3.38it/s]
2025-03-13 18:35:53,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:53
2025-03-13 18:36:16,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9121 secs
2025-03-13 18:36:16,667 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:36:16,667 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 18:36:33,620 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9532 secs
2025-03-13 18:36:33,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2450 secs
2025-03-13 18:36:33,622 [INFO]: {
2025-03-13 18:36:33,622 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:33,622 [INFO]: 	index_param: efSearch=268
2025-03-13 18:36:33,622 [INFO]: 	index_path: knn.index
2025-03-13 18:36:33,622 [INFO]: 	size in bytes: 396242350
2025-03-13 18:36:33,622 [INFO]: 	avg_search_speed_ms: 10.463040856650357
2025-03-13 18:36:33,622 [INFO]: 	99p_search_speed_ms: 16.874926176387827
2025-03-13 18:36:33,622 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:33,622 [INFO]: 	nb vectors: 2014
2025-03-13 18:36:33,622 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:33,622 [INFO]: 	compression ratio: 0.999308912840841
2025-03-13 18:36:33,622 [INFO]: }
2025-03-13 18:36:33,622 [INFO]: 	>>> Finished "Creating the index" in 42.2464 secs
2025-03-13 18:36:33,622 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2704 secs
2025-03-13 18:36:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 28961 [episode count 3/20]
[retrieval_preprocessing] for episode 88711 [episode count 4/20], we have num_retrieval=np.int64(2001) num_query=np.int64(78)
2025-03-13 18:36:36,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:37,275 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:37
2025-03-13 18:36:37,275 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 898.91it/s]
2025-03-13 18:36:37,305 [INFO]: There are 2001 embeddings of dim 49152
2025-03-13 18:36:37,305 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 18:36:37,305 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:37
2025-03-13 18:36:37,305 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:37,305 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:36:37,306 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:37,306 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:36:37,306 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:37
2025-03-13 18:36:37,306 [INFO]: 413.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:37,306 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:36:37,306 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:37
2025-03-13 18:36:37,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:37,307 [INFO]: 	Creating the index 03/13/2025, 18:36:37
2025-03-13 18:36:37,307 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:37
2025-03-13 18:36:37,310 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:36:37,310 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:37
2025-03-13 18:36:37,310 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:36:37,311 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.98it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.39it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.26it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.92it/s]100%|██████████| 8/8 [00:02<00:00,  3.62it/s]
2025-03-13 18:36:39,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:39
2025-03-13 18:37:07,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8354 secs
2025-03-13 18:37:07,366 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 18:37:07,366 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-13 18:37:27,708 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3421 secs
2025-03-13 18:37:27,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3997 secs
2025-03-13 18:37:27,711 [INFO]: {
2025-03-13 18:37:27,711 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:27,711 [INFO]: 	index_param: efSearch=296
2025-03-13 18:37:27,711 [INFO]: 	index_path: knn.index
2025-03-13 18:37:27,711 [INFO]: 	size in bytes: 393684670
2025-03-13 18:37:27,711 [INFO]: 	avg_search_speed_ms: 12.824440636457158
2025-03-13 18:37:27,711 [INFO]: 	99p_search_speed_ms: 22.280658697709455
2025-03-13 18:37:27,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:27,711 [INFO]: 	nb vectors: 2001
2025-03-13 18:37:27,711 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:27,711 [INFO]: 	compression ratio: 0.9993089342290112
2025-03-13 18:37:27,711 [INFO]: }
2025-03-13 18:37:27,711 [INFO]: 	>>> Finished "Creating the index" in 50.4042 secs
2025-03-13 18:37:27,711 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4358 secs
2025-03-13 18:37:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 88711 [episode count 4/20]
[retrieval_preprocessing] for episode 74094 [episode count 5/20], we have num_retrieval=np.int64(2016) num_query=np.int64(63)
2025-03-13 18:37:29,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:29,973 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:29
2025-03-13 18:37:29,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.75it/s]
2025-03-13 18:37:30,001 [INFO]: There are 2016 embeddings of dim 49152
2025-03-13 18:37:30,001 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 18:37:30,001 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,001 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:30,002 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:37:30,002 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:30,002 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:37:30,002 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,002 [INFO]: 416.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:30,002 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:37:30,002 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:30
2025-03-13 18:37:30,002 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:30,002 [INFO]: 	Creating the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,002 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:30
2025-03-13 18:37:30,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:37:30,003 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:30
2025-03-13 18:37:30,003 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:37:30,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.04it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.47it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.60it/s] 50%|█████     | 4/8 [00:00<00:00,  8.25it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.65it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.05it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.28it/s]100%|██████████| 8/8 [00:02<00:00,  1.50it/s]100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
2025-03-13 18:37:32,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:32
2025-03-13 18:38:02,245 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5212 secs
2025-03-13 18:38:02,246 [INFO]: The best hyperparameters are: efSearch=330
2025-03-13 18:38:02,246 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-13 18:38:28,703 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4577 secs
2025-03-13 18:38:28,705 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7014 secs
2025-03-13 18:38:28,705 [INFO]: {
2025-03-13 18:38:28,705 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:28,705 [INFO]: 	index_param: efSearch=330
2025-03-13 18:38:28,705 [INFO]: 	index_path: knn.index
2025-03-13 18:38:28,705 [INFO]: 	size in bytes: 396635830
2025-03-13 18:38:28,705 [INFO]: 	avg_search_speed_ms: 10.634856481858073
2025-03-13 18:38:28,705 [INFO]: 	99p_search_speed_ms: 15.911007926333697
2025-03-13 18:38:28,705 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:28,705 [INFO]: 	nb vectors: 2016
2025-03-13 18:38:28,705 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:28,705 [INFO]: 	compression ratio: 0.9993089328314086
2025-03-13 18:38:28,705 [INFO]: }
2025-03-13 18:38:28,705 [INFO]: 	>>> Finished "Creating the index" in 58.7034 secs
2025-03-13 18:38:28,705 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7323 secs
2025-03-13 18:38:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 74094 [episode count 5/20]
[retrieval_preprocessing] for episode 76480 [episode count 6/20], we have num_retrieval=np.int64(2018) num_query=np.int64(61)
2025-03-13 18:38:30,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:30,219 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:30
2025-03-13 18:38:30,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2079.48it/s]
2025-03-13 18:38:30,249 [INFO]: There are 2018 embeddings of dim 49152
2025-03-13 18:38:30,249 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:38:30,249 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:30
2025-03-13 18:38:30,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:30,249 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:38:30,249 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:30,249 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:38:30,249 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:30
2025-03-13 18:38:30,249 [INFO]: 416.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:30,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:38:30,249 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:30
2025-03-13 18:38:30,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:30,250 [INFO]: 	Creating the index 03/13/2025, 18:38:30
2025-03-13 18:38:30,250 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:30
2025-03-13 18:38:30,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 18:38:30,251 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:30
2025-03-13 18:38:30,252 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:38:30,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.00it/s]100%|██████████| 8/8 [00:01<00:00,  4.37it/s]100%|██████████| 8/8 [00:01<00:00,  4.81it/s]
2025-03-13 18:38:31,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:31
2025-03-13 18:38:53,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0693 secs
2025-03-13 18:38:53,991 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 18:38:53,991 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s]
2025-03-13 18:39:10,749 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7580 secs
2025-03-13 18:39:10,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.4998 secs
2025-03-13 18:39:10,751 [INFO]: {
2025-03-13 18:39:10,751 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:10,751 [INFO]: 	index_param: efSearch=167
2025-03-13 18:39:10,751 [INFO]: 	index_path: knn.index
2025-03-13 18:39:10,751 [INFO]: 	size in bytes: 397029310
2025-03-13 18:39:10,752 [INFO]: 	avg_search_speed_ms: 11.11102572357696
2025-03-13 18:39:10,752 [INFO]: 	99p_search_speed_ms: 16.651082579046488
2025-03-13 18:39:10,752 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:10,752 [INFO]: 	nb vectors: 2018
2025-03-13 18:39:10,752 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:10,752 [INFO]: 	compression ratio: 0.9993089527823525
2025-03-13 18:39:10,752 [INFO]: }
2025-03-13 18:39:10,752 [INFO]: 	>>> Finished "Creating the index" in 40.5020 secs
2025-03-13 18:39:10,752 [INFO]: >>> Finished "Launching the whole pipeline" in 40.5328 secs
2025-03-13 18:39:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 76480 [episode count 6/20]
[retrieval_preprocessing] for episode 44256 [episode count 7/20], we have num_retrieval=np.int64(1964) num_query=np.int64(115)
2025-03-13 18:39:11,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:12,179 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:12
2025-03-13 18:39:12,179 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.59it/s]
2025-03-13 18:39:12,207 [INFO]: There are 1964 embeddings of dim 49152
2025-03-13 18:39:12,207 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:39:12,207 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:12
2025-03-13 18:39:12,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:12,207 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:39:12,207 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:12,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:39:12,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:12
2025-03-13 18:39:12,207 [INFO]: 405.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:12,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:39:12,207 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:12
2025-03-13 18:39:12,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:12,208 [INFO]: 	Creating the index 03/13/2025, 18:39:12
2025-03-13 18:39:12,208 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:12
2025-03-13 18:39:12,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:39:12,209 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:12
2025-03-13 18:39:12,209 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:39:12,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.08it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.40it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.53it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.59it/s]100%|██████████| 8/8 [00:02<00:00,  3.30it/s]
2025-03-13 18:39:14,639 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:14
2025-03-13 18:39:43,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2650 secs
2025-03-13 18:39:43,905 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 18:39:43,905 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 18:39:58,639 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7337 secs
2025-03-13 18:39:58,858 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6495 secs
2025-03-13 18:39:58,859 [INFO]: {
2025-03-13 18:39:58,859 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:58,859 [INFO]: 	index_param: efSearch=251
2025-03-13 18:39:58,859 [INFO]: 	index_path: knn.index
2025-03-13 18:39:58,859 [INFO]: 	size in bytes: 386405230
2025-03-13 18:39:58,859 [INFO]: 	avg_search_speed_ms: 10.834843162467395
2025-03-13 18:39:58,859 [INFO]: 	99p_search_speed_ms: 19.437381927855313
2025-03-13 18:39:58,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:58,859 [INFO]: 	nb vectors: 1964
2025-03-13 18:39:58,859 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:58,859 [INFO]: 	compression ratio: 0.999308710184901
2025-03-13 18:39:58,859 [INFO]: }
2025-03-13 18:39:58,860 [INFO]: 	>>> Finished "Creating the index" in 46.6520 secs
2025-03-13 18:39:58,860 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6804 secs
2025-03-13 18:39:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 44256 [episode count 7/20]
[retrieval_preprocessing] for episode 60670 [episode count 8/20], we have num_retrieval=np.int64(2010) num_query=np.int64(69)
2025-03-13 18:40:00,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:00,955 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:00
2025-03-13 18:40:00,955 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.81it/s]
2025-03-13 18:40:00,981 [INFO]: There are 2010 embeddings of dim 49152
2025-03-13 18:40:00,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:40:00,981 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:00
2025-03-13 18:40:00,981 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:00,981 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:40:00,981 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:00,981 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:40:00,981 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:00
2025-03-13 18:40:00,982 [INFO]: 414.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:00,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:40:00,982 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:00
2025-03-13 18:40:00,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:00,982 [INFO]: 	Creating the index 03/13/2025, 18:40:00
2025-03-13 18:40:00,982 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:00
2025-03-13 18:40:00,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:40:00,983 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:00
2025-03-13 18:40:00,983 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:40:00,983 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.84it/s] 38%|███▊      | 3/8 [00:00<00:00, 11.54it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.61it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.68it/s]100%|██████████| 8/8 [00:01<00:00,  4.12it/s]
2025-03-13 18:40:02,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:02
2025-03-13 18:40:34,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7289 secs
2025-03-13 18:40:34,662 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:40:34,662 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-13 18:40:53,610 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9482 secs
2025-03-13 18:40:54,358 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3747 secs
2025-03-13 18:40:54,358 [INFO]: {
2025-03-13 18:40:54,358 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:54,359 [INFO]: 	index_param: efSearch=261
2025-03-13 18:40:54,359 [INFO]: 	index_path: knn.index
2025-03-13 18:40:54,359 [INFO]: 	size in bytes: 395455390
2025-03-13 18:40:54,359 [INFO]: 	avg_search_speed_ms: 9.512319307522645
2025-03-13 18:40:54,359 [INFO]: 	99p_search_speed_ms: 13.743699411861598
2025-03-13 18:40:54,359 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:54,359 [INFO]: 	nb vectors: 2010
2025-03-13 18:40:54,359 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:54,359 [INFO]: 	compression ratio: 0.9993088727403614
2025-03-13 18:40:54,359 [INFO]: }
2025-03-13 18:40:54,359 [INFO]: 	>>> Finished "Creating the index" in 53.3772 secs
2025-03-13 18:40:54,359 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4039 secs
2025-03-13 18:40:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 60670 [episode count 8/20]
[retrieval_preprocessing] for episode 89360 [episode count 9/20], we have num_retrieval=np.int64(1992) num_query=np.int64(87)
2025-03-13 18:40:55,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:56,094 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:56
2025-03-13 18:40:56,094 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2010.69it/s]
2025-03-13 18:40:56,120 [INFO]: There are 1992 embeddings of dim 49152
2025-03-13 18:40:56,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:40:56,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:56
2025-03-13 18:40:56,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:56,121 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:40:56,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:56,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:40:56,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:56
2025-03-13 18:40:56,121 [INFO]: 411.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:56,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:40:56,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:56
2025-03-13 18:40:56,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:56,122 [INFO]: 	Creating the index 03/13/2025, 18:40:56
2025-03-13 18:40:56,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:56
2025-03-13 18:40:56,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:40:56,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:56
2025-03-13 18:40:56,126 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:40:56,126 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.03it/s] 25%|██▌       | 2/8 [00:00<00:00,  8.92it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.73it/s] 50%|█████     | 4/8 [00:00<00:00,  9.09it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.22it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.46it/s]100%|██████████| 8/8 [00:02<00:00,  2.33it/s]100%|██████████| 8/8 [00:02<00:00,  3.67it/s]
2025-03-13 18:40:58,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:58
2025-03-13 18:41:26,772 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4573 secs
2025-03-13 18:41:26,772 [INFO]: The best hyperparameters are: efSearch=323
2025-03-13 18:41:26,772 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-13 18:41:48,880 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1080 secs
2025-03-13 18:41:48,882 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7567 secs
2025-03-13 18:41:48,882 [INFO]: {
2025-03-13 18:41:48,882 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:48,882 [INFO]: 	index_param: efSearch=323
2025-03-13 18:41:48,882 [INFO]: 	index_path: knn.index
2025-03-13 18:41:48,882 [INFO]: 	size in bytes: 391914010
2025-03-13 18:41:48,882 [INFO]: 	avg_search_speed_ms: 12.823369758478247
2025-03-13 18:41:48,883 [INFO]: 	99p_search_speed_ms: 22.400473349262032
2025-03-13 18:41:48,883 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:48,883 [INFO]: 	nb vectors: 1992
2025-03-13 18:41:48,883 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:48,883 [INFO]: 	compression ratio: 0.9993088432842705
2025-03-13 18:41:48,883 [INFO]: }
2025-03-13 18:41:48,883 [INFO]: 	>>> Finished "Creating the index" in 52.7603 secs
2025-03-13 18:41:48,883 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7884 secs
2025-03-13 18:41:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 89360 [episode count 9/20]
[retrieval_preprocessing] for episode 42288 [episode count 10/20], we have num_retrieval=np.int64(2009) num_query=np.int64(70)
2025-03-13 18:41:51,121 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:51,466 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:51
2025-03-13 18:41:51,466 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1028.52it/s]
2025-03-13 18:41:51,493 [INFO]: There are 2009 embeddings of dim 49152
2025-03-13 18:41:51,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 18:41:51,493 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:51
2025-03-13 18:41:51,493 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:51,494 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:41:51,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:51,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:41:51,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:51
2025-03-13 18:41:51,494 [INFO]: 414.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:51,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:41:51,495 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:51
2025-03-13 18:41:51,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:51,495 [INFO]: 	Creating the index 03/13/2025, 18:41:51
2025-03-13 18:41:51,495 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:51
2025-03-13 18:41:51,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:41:51,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:51
2025-03-13 18:41:51,498 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:41:51,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.47it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.99it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.62it/s] 50%|█████     | 4/8 [00:00<00:00,  8.12it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.33it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.44it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.51it/s]100%|██████████| 8/8 [00:02<00:00,  1.75it/s]100%|██████████| 8/8 [00:02<00:00,  3.31it/s]
2025-03-13 18:41:53,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:53
2025-03-13 18:42:19,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8703 secs
2025-03-13 18:42:19,794 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 18:42:19,794 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.58it/s] 50%|█████     | 2/4 [00:00<00:00,  5.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 18:42:38,130 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3357 secs
2025-03-13 18:42:38,131 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6332 secs
2025-03-13 18:42:38,131 [INFO]: {
2025-03-13 18:42:38,131 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:38,132 [INFO]: 	index_param: efSearch=309
2025-03-13 18:42:38,132 [INFO]: 	index_path: knn.index
2025-03-13 18:42:38,132 [INFO]: 	size in bytes: 395258650
2025-03-13 18:42:38,132 [INFO]: 	avg_search_speed_ms: 13.784441469332137
2025-03-13 18:42:38,132 [INFO]: 	99p_search_speed_ms: 19.984323473181576
2025-03-13 18:42:38,132 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:38,132 [INFO]: 	nb vectors: 2009
2025-03-13 18:42:38,132 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:38,132 [INFO]: 	compression ratio: 0.9993088626902915
2025-03-13 18:42:38,132 [INFO]: }
2025-03-13 18:42:38,132 [INFO]: 	>>> Finished "Creating the index" in 46.6367 secs
2025-03-13 18:42:38,132 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6660 secs
2025-03-13 18:42:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 42288 [episode count 10/20]
[retrieval_preprocessing] for episode 81610 [episode count 11/20], we have num_retrieval=np.int64(1776) num_query=np.int64(303)
2025-03-13 18:42:39,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:39,979 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:39
2025-03-13 18:42:39,979 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.05it/s]
2025-03-13 18:42:40,004 [INFO]: There are 1776 embeddings of dim 49152
2025-03-13 18:42:40,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:42:40,005 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:40,005 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:42:40,005 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:40,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:42:40,005 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,005 [INFO]: 366.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:40,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:42:40,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:40
2025-03-13 18:42:40,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:40,006 [INFO]: 	Creating the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:40
2025-03-13 18:42:40,009 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:42:40,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,009 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:42:40,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.16it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.44it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.63it/s] 57%|█████▋    | 4/7 [00:00<00:00,  8.26it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.79it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.02it/s]100%|██████████| 7/7 [00:02<00:00,  1.78it/s]100%|██████████| 7/7 [00:02<00:00,  3.14it/s]
2025-03-13 18:42:42,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:42
2025-03-13 18:43:11,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9725 secs
2025-03-13 18:43:11,229 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 18:43:11,229 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.04it/s] 50%|█████     | 2/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.38it/s]
2025-03-13 18:43:28,936 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7078 secs
2025-03-13 18:43:28,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9288 secs
2025-03-13 18:43:28,938 [INFO]: {
2025-03-13 18:43:28,938 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:28,938 [INFO]: 	index_param: efSearch=314
2025-03-13 18:43:28,938 [INFO]: 	index_path: knn.index
2025-03-13 18:43:28,938 [INFO]: 	size in bytes: 349417330
2025-03-13 18:43:28,938 [INFO]: 	avg_search_speed_ms: 11.308217835007499
2025-03-13 18:43:28,938 [INFO]: 	99p_search_speed_ms: 16.45394339226186
2025-03-13 18:43:28,938 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:28,938 [INFO]: 	nb vectors: 1776
2025-03-13 18:43:28,938 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:28,938 [INFO]: 	compression ratio: 0.9993087864302552
2025-03-13 18:43:28,938 [INFO]: }
2025-03-13 18:43:28,938 [INFO]: 	>>> Finished "Creating the index" in 48.9325 secs
2025-03-13 18:43:28,938 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9598 secs
2025-03-13 18:43:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 81610 [episode count 11/20]
[retrieval_preprocessing] for episode 18069 [episode count 12/20], we have num_retrieval=np.int64(1961) num_query=np.int64(118)
2025-03-13 18:43:32,536 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:32,799 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:32
2025-03-13 18:43:32,799 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2281.99it/s]
2025-03-13 18:43:32,824 [INFO]: There are 1961 embeddings of dim 49152
2025-03-13 18:43:32,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 18:43:32,824 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:32
2025-03-13 18:43:32,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:32,824 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:43:32,824 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:32,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:32,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:32
2025-03-13 18:43:32,824 [INFO]: 404.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:32,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:32,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:32
2025-03-13 18:43:32,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:32,824 [INFO]: 	Creating the index 03/13/2025, 18:43:32
2025-03-13 18:43:32,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:32
2025-03-13 18:43:32,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:43:32,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:32
2025-03-13 18:43:32,826 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:43:32,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.43it/s] 38%|███▊      | 3/8 [00:00<00:00, 10.66it/s] 62%|██████▎   | 5/8 [00:00<00:00, 11.89it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.65it/s]100%|██████████| 8/8 [00:01<00:00,  4.53it/s]
2025-03-13 18:43:34,598 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:34
2025-03-13 18:43:59,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9369 secs
2025-03-13 18:43:59,536 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 18:43:59,536 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 18:44:15,987 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4515 secs
2025-03-13 18:44:15,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1640 secs
2025-03-13 18:44:15,990 [INFO]: {
2025-03-13 18:44:15,990 [INFO]: 	index_key: HNSW15
2025-03-13 18:44:15,990 [INFO]: 	index_param: efSearch=276
2025-03-13 18:44:15,990 [INFO]: 	index_path: knn.index
2025-03-13 18:44:15,990 [INFO]: 	size in bytes: 385815010
2025-03-13 18:44:15,990 [INFO]: 	avg_search_speed_ms: 10.629535419124156
2025-03-13 18:44:15,990 [INFO]: 	99p_search_speed_ms: 18.033850798383355
2025-03-13 18:44:15,990 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:15,990 [INFO]: 	nb vectors: 1961
2025-03-13 18:44:15,990 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:15,990 [INFO]: 	compression ratio: 0.9993086790480236
2025-03-13 18:44:15,990 [INFO]: }
2025-03-13 18:44:15,990 [INFO]: 	>>> Finished "Creating the index" in 43.1655 secs
2025-03-13 18:44:15,990 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1907 secs
2025-03-13 18:44:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 18069 [episode count 12/20]
[retrieval_preprocessing] for episode 13987 [episode count 13/20], we have num_retrieval=np.int64(1955) num_query=np.int64(124)
2025-03-13 18:44:18,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:19,182 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:19
2025-03-13 18:44:19,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.54it/s]
2025-03-13 18:44:19,208 [INFO]: There are 1955 embeddings of dim 49152
2025-03-13 18:44:19,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:44:19,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:19,208 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:44:19,208 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:44:19,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:44:19,208 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,208 [INFO]: 403.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:19,208 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:44:19,208 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:19
2025-03-13 18:44:19,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:19,208 [INFO]: 	Creating the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,208 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:44:19
2025-03-13 18:44:19,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:44:19,209 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,209 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:44:19,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.72it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.59it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.40it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.92it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.46it/s]100%|██████████| 8/8 [00:02<00:00,  3.81it/s]
2025-03-13 18:44:21,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:21
2025-03-13 18:44:47,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2509 secs
2025-03-13 18:44:47,567 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 18:44:47,567 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s]
2025-03-13 18:45:11,524 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9572 secs
2025-03-13 18:45:11,526 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3164 secs
2025-03-13 18:45:11,526 [INFO]: {
2025-03-13 18:45:11,526 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:11,526 [INFO]: 	index_param: efSearch=314
2025-03-13 18:45:11,526 [INFO]: 	index_path: knn.index
2025-03-13 18:45:11,526 [INFO]: 	size in bytes: 384634570
2025-03-13 18:45:11,526 [INFO]: 	avg_search_speed_ms: 10.586439364308875
2025-03-13 18:45:11,526 [INFO]: 	99p_search_speed_ms: 18.08200684376059
2025-03-13 18:45:11,526 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:11,526 [INFO]: 	nb vectors: 1955
2025-03-13 18:45:11,526 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:11,526 [INFO]: 	compression ratio: 0.9993086164875924
2025-03-13 18:45:11,526 [INFO]: }
2025-03-13 18:45:11,526 [INFO]: 	>>> Finished "Creating the index" in 52.3178 secs
2025-03-13 18:45:11,526 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3441 secs
2025-03-13 18:45:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 13987 [episode count 13/20]
[retrieval_preprocessing] for episode 59116 [episode count 14/20], we have num_retrieval=np.int64(1990) num_query=np.int64(89)
2025-03-13 18:45:13,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:13,998 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:13
2025-03-13 18:45:13,998 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 18:45:14,026 [INFO]: There are 1990 embeddings of dim 49152
2025-03-13 18:45:14,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 18:45:14,026 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,027 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:14,027 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:45:14,027 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:14,027 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:45:14,027 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,027 [INFO]: 410.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:14,028 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:45:14,028 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:14
2025-03-13 18:45:14,028 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:14,028 [INFO]: 	Creating the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,028 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:14
2025-03-13 18:45:14,031 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:45:14,032 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,032 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:45:14,032 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.32it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.73it/s] 50%|█████     | 4/8 [00:00<00:00,  9.40it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.90it/s]100%|██████████| 8/8 [00:02<00:00,  2.60it/s]100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
2025-03-13 18:45:16,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:16
2025-03-13 18:45:40,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2871 secs
2025-03-13 18:45:40,586 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 18:45:40,586 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 50%|█████     | 2/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s]
2025-03-13 18:45:56,828 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2415 secs
2025-03-13 18:45:56,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7981 secs
2025-03-13 18:45:56,830 [INFO]: {
2025-03-13 18:45:56,830 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:56,830 [INFO]: 	index_param: efSearch=276
2025-03-13 18:45:56,830 [INFO]: 	index_path: knn.index
2025-03-13 18:45:56,830 [INFO]: 	size in bytes: 391520530
2025-03-13 18:45:56,830 [INFO]: 	avg_search_speed_ms: 11.017647541604017
2025-03-13 18:45:56,830 [INFO]: 	99p_search_speed_ms: 15.950699828099458
2025-03-13 18:45:56,830 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:56,830 [INFO]: 	nb vectors: 1990
2025-03-13 18:45:56,830 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:56,830 [INFO]: 	compression ratio: 0.999308822962617
2025-03-13 18:45:56,830 [INFO]: }
2025-03-13 18:45:56,830 [INFO]: 	>>> Finished "Creating the index" in 42.8021 secs
2025-03-13 18:45:56,830 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8317 secs
2025-03-13 18:45:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 59116 [episode count 14/20]
[retrieval_preprocessing] for episode 91525 [episode count 15/20], we have num_retrieval=np.int64(1856) num_query=np.int64(223)
2025-03-13 18:45:58,664 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:59,178 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:59
2025-03-13 18:45:59,178 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1626.96it/s]
2025-03-13 18:45:59,203 [INFO]: There are 1856 embeddings of dim 49152
2025-03-13 18:45:59,204 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 18:45:59,204 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:59
2025-03-13 18:45:59,204 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:59,204 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:45:59,204 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:59,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:45:59,205 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:59
2025-03-13 18:45:59,205 [INFO]: 383.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:59,205 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:45:59,205 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:59
2025-03-13 18:45:59,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:59,206 [INFO]: 	Creating the index 03/13/2025, 18:45:59
2025-03-13 18:45:59,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:59
2025-03-13 18:45:59,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:45:59,209 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:59
2025-03-13 18:45:59,209 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:45:59,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.56it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.75it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.23it/s] 50%|█████     | 4/8 [00:00<00:00,  7.50it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.70it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.87it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.91it/s]100%|██████████| 8/8 [00:02<00:00,  1.90it/s]100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
2025-03-13 18:46:01,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:01
2025-03-13 18:46:29,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3980 secs
2025-03-13 18:46:29,991 [INFO]: The best hyperparameters are: efSearch=325
2025-03-13 18:46:29,991 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 50%|█████     | 2/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s]
2025-03-13 18:46:54,731 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7400 secs
2025-03-13 18:46:54,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5238 secs
2025-03-13 18:46:54,733 [INFO]: {
2025-03-13 18:46:54,733 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:54,733 [INFO]: 	index_param: efSearch=325
2025-03-13 18:46:54,733 [INFO]: 	index_path: knn.index
2025-03-13 18:46:54,733 [INFO]: 	size in bytes: 365156710
2025-03-13 18:46:54,733 [INFO]: 	avg_search_speed_ms: 11.546268595936853
2025-03-13 18:46:54,733 [INFO]: 	99p_search_speed_ms: 19.074575998820368
2025-03-13 18:46:54,733 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:54,733 [INFO]: 	nb vectors: 1856
2025-03-13 18:46:54,733 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:54,733 [INFO]: 	compression ratio: 0.9993091678364612
2025-03-13 18:46:54,733 [INFO]: }
2025-03-13 18:46:54,733 [INFO]: 	>>> Finished "Creating the index" in 55.5276 secs
2025-03-13 18:46:54,733 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5553 secs
2025-03-13 18:46:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 91525 [episode count 15/20]
[retrieval_preprocessing] for episode 91537 [episode count 16/20], we have num_retrieval=np.int64(1955) num_query=np.int64(124)
2025-03-13 18:46:58,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:58,794 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:58
2025-03-13 18:46:58,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.93it/s]
2025-03-13 18:46:58,823 [INFO]: There are 1955 embeddings of dim 49152
2025-03-13 18:46:58,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 18:46:58,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:58,823 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:46:58,823 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:58,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:46:58,823 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,823 [INFO]: 403.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:58,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:46:58,823 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:58
2025-03-13 18:46:58,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:58,824 [INFO]: 	Creating the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:58
2025-03-13 18:46:58,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:46:58,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,825 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:46:58,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.89it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.22it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.66it/s] 50%|█████     | 4/8 [00:00<00:00,  8.01it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.13it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.24it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.24it/s]100%|██████████| 8/8 [00:02<00:00,  1.82it/s]100%|██████████| 8/8 [00:02<00:00,  3.40it/s]
2025-03-13 18:47:01,185 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:01
2025-03-13 18:47:32,615 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4301 secs
2025-03-13 18:47:32,615 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 18:47:32,615 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s]
2025-03-13 18:47:53,307 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6909 secs
2025-03-13 18:47:53,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4843 secs
2025-03-13 18:47:53,309 [INFO]: {
2025-03-13 18:47:53,309 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:53,309 [INFO]: 	index_param: efSearch=297
2025-03-13 18:47:53,309 [INFO]: 	index_path: knn.index
2025-03-13 18:47:53,309 [INFO]: 	size in bytes: 384634570
2025-03-13 18:47:53,310 [INFO]: 	avg_search_speed_ms: 10.52292396608544
2025-03-13 18:47:53,310 [INFO]: 	99p_search_speed_ms: 20.09239424485713
2025-03-13 18:47:53,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:53,310 [INFO]: 	nb vectors: 1955
2025-03-13 18:47:53,310 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:53,310 [INFO]: 	compression ratio: 0.9993086164875924
2025-03-13 18:47:53,310 [INFO]: }
2025-03-13 18:47:53,310 [INFO]: 	>>> Finished "Creating the index" in 54.4861 secs
2025-03-13 18:47:53,310 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5151 secs
2025-03-13 18:47:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 91537 [episode count 16/20]
[retrieval_preprocessing] for episode 81347 [episode count 17/20], we have num_retrieval=np.int64(2021) num_query=np.int64(58)
2025-03-13 18:47:56,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:57,213 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:57
2025-03-13 18:47:57,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.15it/s]
2025-03-13 18:47:57,240 [INFO]: There are 2021 embeddings of dim 49152
2025-03-13 18:47:57,241 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 18:47:57,241 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:57
2025-03-13 18:47:57,241 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:57,241 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:47:57,241 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:57,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:47:57,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:57
2025-03-13 18:47:57,241 [INFO]: 417.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:57,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:47:57,241 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:57
2025-03-13 18:47:57,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:57,241 [INFO]: 	Creating the index 03/13/2025, 18:47:57
2025-03-13 18:47:57,241 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:57
2025-03-13 18:47:57,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:47:57,243 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:57
2025-03-13 18:47:57,243 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:47:57,243 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.51it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.72it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.46it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.79it/s]100%|██████████| 8/8 [00:02<00:00,  2.24it/s]100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
2025-03-13 18:47:59,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:59
2025-03-13 18:48:31,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5384 secs
2025-03-13 18:48:31,130 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 18:48:31,130 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s]
2025-03-13 18:48:52,153 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0223 secs
2025-03-13 18:48:52,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9122 secs
2025-03-13 18:48:52,155 [INFO]: {
2025-03-13 18:48:52,155 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:52,155 [INFO]: 	index_param: efSearch=289
2025-03-13 18:48:52,155 [INFO]: 	index_path: knn.index
2025-03-13 18:48:52,155 [INFO]: 	size in bytes: 397619590
2025-03-13 18:48:52,155 [INFO]: 	avg_search_speed_ms: 10.924086604301927
2025-03-13 18:48:52,155 [INFO]: 	99p_search_speed_ms: 18.034463992808014
2025-03-13 18:48:52,155 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:52,155 [INFO]: 	nb vectors: 2021
2025-03-13 18:48:52,155 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:52,155 [INFO]: 	compression ratio: 0.9993088318410066
2025-03-13 18:48:52,155 [INFO]: }
2025-03-13 18:48:52,155 [INFO]: 	>>> Finished "Creating the index" in 54.9139 secs
2025-03-13 18:48:52,155 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9423 secs
2025-03-13 18:48:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 81347 [episode count 17/20]
[retrieval_preprocessing] for episode 54426 [episode count 18/20], we have num_retrieval=np.int64(1958) num_query=np.int64(121)
2025-03-13 18:48:53,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:53,980 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:53
2025-03-13 18:48:53,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1344.76it/s]
2025-03-13 18:48:54,009 [INFO]: There are 1958 embeddings of dim 49152
2025-03-13 18:48:54,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:48:54,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:54
2025-03-13 18:48:54,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:54,010 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:48:54,010 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:54,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:48:54,010 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:54
2025-03-13 18:48:54,011 [INFO]: 404.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:54,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:48:54,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:54
2025-03-13 18:48:54,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:54,011 [INFO]: 	Creating the index 03/13/2025, 18:48:54
2025-03-13 18:48:54,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:54
2025-03-13 18:48:54,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:48:54,015 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:54
2025-03-13 18:48:54,015 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:48:54,015 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.42it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.74it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.40it/s] 50%|█████     | 4/8 [00:00<00:00,  7.68it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.92it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.48it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.85it/s]100%|██████████| 8/8 [00:02<00:00,  2.08it/s]100%|██████████| 8/8 [00:02<00:00,  3.74it/s]
2025-03-13 18:48:56,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:56
2025-03-13 18:49:27,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6546 secs
2025-03-13 18:49:27,820 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 18:49:27,820 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
2025-03-13 18:49:51,340 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5192 secs
2025-03-13 18:49:51,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3265 secs
2025-03-13 18:49:51,342 [INFO]: {
2025-03-13 18:49:51,342 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:51,342 [INFO]: 	index_param: efSearch=304
2025-03-13 18:49:51,342 [INFO]: 	index_path: knn.index
2025-03-13 18:49:51,342 [INFO]: 	size in bytes: 385224790
2025-03-13 18:49:51,342 [INFO]: 	avg_search_speed_ms: 10.45134012215618
2025-03-13 18:49:51,342 [INFO]: 	99p_search_speed_ms: 15.569586111232638
2025-03-13 18:49:51,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:51,342 [INFO]: 	nb vectors: 1958
2025-03-13 18:49:51,342 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:51,342 [INFO]: 	compression ratio: 0.9993086478157338
2025-03-13 18:49:51,342 [INFO]: }
2025-03-13 18:49:51,342 [INFO]: 	>>> Finished "Creating the index" in 57.3303 secs
2025-03-13 18:49:51,342 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3615 secs
2025-03-13 18:49:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 54426 [episode count 18/20]
[retrieval_preprocessing] for episode 83123 [episode count 19/20], we have num_retrieval=np.int64(2007) num_query=np.int64(72)
2025-03-13 18:49:53,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:54,505 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:54
2025-03-13 18:49:54,505 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.48it/s]
2025-03-13 18:49:54,536 [INFO]: There are 2007 embeddings of dim 49152
2025-03-13 18:49:54,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 18:49:54,536 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:54
2025-03-13 18:49:54,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:54,537 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:49:54,537 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:54,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:49:54,537 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:54
2025-03-13 18:49:54,537 [INFO]: 414.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:54,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:49:54,538 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:54
2025-03-13 18:49:54,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:54,538 [INFO]: 	Creating the index 03/13/2025, 18:49:54
2025-03-13 18:49:54,538 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:54
2025-03-13 18:49:54,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:49:54,541 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:54
2025-03-13 18:49:54,542 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:49:54,542 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.31it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.53it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.04it/s] 50%|█████     | 4/8 [00:00<00:00,  7.25it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.55it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.62it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.65it/s]100%|██████████| 8/8 [00:02<00:00,  1.83it/s]100%|██████████| 8/8 [00:02<00:00,  3.34it/s]
2025-03-13 18:49:56,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:56
2025-03-13 18:50:21,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3213 secs
2025-03-13 18:50:21,268 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 18:50:21,268 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 18:50:37,172 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9034 secs
2025-03-13 18:50:37,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6316 secs
2025-03-13 18:50:37,173 [INFO]: {
2025-03-13 18:50:37,173 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:37,173 [INFO]: 	index_param: efSearch=290
2025-03-13 18:50:37,173 [INFO]: 	index_path: knn.index
2025-03-13 18:50:37,173 [INFO]: 	size in bytes: 394865170
2025-03-13 18:50:37,173 [INFO]: 	avg_search_speed_ms: 10.917547962874353
2025-03-13 18:50:37,173 [INFO]: 	99p_search_speed_ms: 19.16181624401361
2025-03-13 18:50:37,173 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:37,173 [INFO]: 	nb vectors: 2007
2025-03-13 18:50:37,173 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:37,173 [INFO]: 	compression ratio: 0.9993088425601073
2025-03-13 18:50:37,173 [INFO]: }
2025-03-13 18:50:37,173 [INFO]: 	>>> Finished "Creating the index" in 42.6353 secs
2025-03-13 18:50:37,173 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6684 secs
2025-03-13 18:50:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 83123 [episode count 19/20]
2025-03-13 18:50:37: [retrieval_preprocessing] finished for 5235850418_close_bottom_drawer_generic_cabinet [chosen_id count 9/196]
2025-03-13 18:50:37: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
